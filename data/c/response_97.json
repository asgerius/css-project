[{"tags": ["python", "c++", "c", "jupyter-notebook", "jupyterhub"], "answers": [{"comments": [{"owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "edited": false, "score": 0, "creation_date": 1479376554, "post_id": 40651615, "comment_id": 68534692, "body": "Oh, thanks for the good news! I would really appreciate it if you could backup your answer with some reference that supports it."}], "tags": [], "owner": {"reputation": 26037, "user_id": 542190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bb1f122c476561bb9a98a1523e8b5e?s=128&d=identicon&r=PG", "display_name": "filmor", "link": "https://stackoverflow.com/users/542190/filmor"}, "is_accepted": true, "score": 1, "last_activity_date": 1479377181, "last_edit_date": 1479377181, "creation_date": 1479376300, "answer_id": 40651615, "question_id": 40644469, "link": "https://stackoverflow.com/questions/40644469/is-jupyterhub-kernel-safe-across-users/40651615#40651615", "title": "Is JupyterHub kernel safe across users?", "body": "<p>Even if you were using straight Jupyter Notebook instead of JupyterHub, each kernel is a single process, that runs kind of independent of the notebook server. Crashes of individual kernels will not take down the notebook server.</p>\n\n<p>Check out the <a href=\"http://jupyter.readthedocs.io/en/latest/architecture/how_jupyter_ipython_work.html\" rel=\"nofollow noreferrer\">architecture documentation</a>. We've been running a setup with a single Jupyter Notebook instance (not even JupyterHub, because Windows :/) for about 3 years now. The only problems occuring are due to resource constraints (e.g. single kernel takes up a lot of memory), but that's solvable on both the OS and organisational level.</p>\n"}], "owner": {"reputation": 20880, "user_id": 1317944, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/OcBMY.png?s=128&g=1", "display_name": "The Quantum Physicist", "link": "https://stackoverflow.com/users/1317944/the-quantum-physicist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 40651615, "answer_count": 1, "score": 1, "last_activity_date": 1479377181, "creation_date": 1479340597, "last_edit_date": 1479376082, "question_id": 40644469, "link": "https://stackoverflow.com/questions/40644469/is-jupyterhub-kernel-safe-across-users", "title": "Is JupyterHub kernel safe across users?", "body": "<p>I'm using JupyterHub to share computational power of a big computer among some users. The software that's primarily used is a <code>ctypes</code> extension Python script that uses a sophisticated C/C++ code. This code isn't invulnerable to memory problems and crashes.</p>\n\n<p><strong>My question is:</strong> If a low-level problem happens with one user and his kernel gets, say, a segmentation fault, will that crash the main server by design and get all users to lose their kernel information? Or is it designed to create a new server for every user that logs in, so that such problems don't happen?</p>\n"}, {"tags": ["c", "process", "posix", "semaphore"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1479340780, "post_id": 40644239, "comment_id": 68520932, "body": "You need to initialize one of the semaphores with zero instead of both with one."}, {"owner": {"reputation": 179, "user_id": 6275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sqYLd.png?s=128&g=1", "display_name": "man0s", "link": "https://stackoverflow.com/users/6275376/man0s"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1479341663, "post_id": 40644239, "comment_id": 68521218, "body": "@JonathanLeffler Thanks! that helped a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 6275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sqYLd.png?s=128&g=1", "display_name": "man0s", "link": "https://stackoverflow.com/users/6275376/man0s"}, "edited": false, "score": 0, "creation_date": 1479402915, "post_id": 40644838, "comment_id": 68553254, "body": "That&#39;s the answer i was looking for!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1479346625, "last_edit_date": 1479346625, "creation_date": 1479342968, "answer_id": 40644838, "question_id": 40644239, "link": "https://stackoverflow.com/questions/40644239/posix-semaphores-between-child-and-parent-processes/40644838#40644838", "title": "POSIX semaphores between child and parent processes", "body": "<p>As noted in a comment, you need to initialize the first semaphore (renamed <code>sem1</code> for symmetry with <code>sem2</code> in the code below) to <code>0</code> instead of <code>1</code> so that the parent process gets to go first.</p>\n\n<p>The child and parent process comments were misplaced (the parent gets a non-zero result from <code>fork()</code> and so works in the <code>if</code>).  This version produces the desired output even without any calls to <code>usleep()</code>.  Nominally, only one of the processes needs to use <code>sem_close()</code> and <code>sem_unlink()</code>, but since you don't check for or report any errors, you don't notice the calls that fail.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(void)\n{\n    int i;\n    char *p;\n    sem_t *sem1; // First semaphore\n    sem_t *sem2; // Second semaphore\n\n    // create, initialize semaphores\n    sem1 = sem_open(\"/semaphore1\", O_CREAT,  0644, 0);\n    sem2 = sem_open(\"/semaphore2\", O_CREAT,  0644, 1);\n\n    if (fork()) // Parent process\n    {\n        for (i = 0; i &lt; 10; i++)\n        {\n            sem_wait(sem2); // Lock the semaphore\n            for (p = \"ab\"; *p; p++)\n            {\n                write(1, p, 1);\n                //usleep(100);\n            }\n            sem_post(sem1); // Release the semaphore lock\n        }\n        wait(NULL);\n    }\n    else // Child process\n    {\n        for (i = 0; i &lt; 10; i++)\n        {\n            sem_wait(sem1); // Lock the semaphore\n            for (p = \"cd\\n\"; *p; p++)\n            {\n                write(1, p, 1);\n                //usleep(100);\n            }\n            sem_post(sem2); // Release the semaphore lock\n        }\n    }\n\n    // Close the Semaphores\n    sem_close(sem1);\n    sem_unlink(\"/semaphore1\");\n    sem_close(sem2);\n    sem_unlink(\"/semaphore2\");\n    return 0;\n}\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>abcd\nabcd\nabcd\nabcd\nabcd\nabcd\nabcd\nabcd\nabcd\nabcd\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sqYLd.png?s=128&g=1", "display_name": "man0s", "link": "https://stackoverflow.com/users/6275376/man0s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2033, "favorite_count": 2, "accepted_answer_id": 40644838, "answer_count": 1, "score": 2, "last_activity_date": 1479346625, "creation_date": 1479339264, "last_edit_date": 1479339627, "question_id": 40644239, "link": "https://stackoverflow.com/questions/40644239/posix-semaphores-between-child-and-parent-processes", "title": "POSIX semaphores between child and parent processes", "body": "<p>Im trying to learn semaphores and how they work between processes, so i wanted to create a program that prints 10 times the string \"abcd\" from two separate for() loops. One for() contains the \"ab\" string while the other one contains the \"cd\" string. I thought the code was fine but apparently its not. I would appreciate if you could point out anything wrong or if i got something misunderstood.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>int main(void)\n{\n\nint i;\nchar *p;\nsem_t *sem; //First semaphore\nsem_t *sem2; //Second semaphore\n\n//create, initialize semaphores\nsem = sem_open(\"/semaphore1\", O_CREAT,  0644, 1);\nsem2 = sem_open(\"/semaphore2\", O_CREAT,  0644, 1);\n\nif (fork()) //Child process\n{\n     for (i=0;i&lt;10;i++)\n     {\n        sem_wait(sem2); //Lock the semaphore\n        for (p=\"ab\"; *p; p++)\n        {\n            write(1, p, 1);\n            usleep(100);\n        }\n        sem_post(sem); //Release the semaphore lock\n     }\n     wait(NULL);\n}\nelse //Parent process\n{\n     for (i=0;i&lt;10;i++)\n     {\n        sem_wait(sem); //Lock the semaphore\n        for (p=\"cd\\n\"; *p; p++)\n        {\n            write(1, p, 1);\n            usleep(100);\n        }\n        sem_post(sem2); //Release the semaphore lock\n     }\n}\n\n//Close the Semaphores\nsem_close(sem);\nsem_unlink(\"/semaphore1\");\nsem_close(sem2);\nsem_unlink(\"/semaphore2\");\nreturn 0;\n}\n</code></pre>\n\n<p>And one of the outputs:</p>\n\n<pre><code>abcd\ncadb\ncadb\ncadb\ncabd\ncabd\ncabd\ncadb\ncabd\ncadb\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "string-concatenation"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1479339034, "post_id": 40644112, "comment_id": 68520442, "body": "where do you think the new string &quot;&lt;childproces&gt; 1&quot; is going to be stored. strcat_s failed becuase you tried to add characters to the buffer - check the return value of srcat_s"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1479339895, "post_id": 40644112, "comment_id": 68520683, "body": "@Y.E.S.  It is unclear what you are going to get in the array    lpCommandLine. Show its result content."}, {"owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "edited": false, "score": 0, "creation_date": 1479339992, "post_id": 40644112, "comment_id": 68520700, "body": "I want it to be stored in lpCommandLine. In child_names array 0th string is &quot;ChildProj1.exe&quot; and i want lpCommandLine[0] to be &quot;ChildProj1.exe 1&quot;.  So do you suggest to allocate memory for each child_names indexes for 16 chars which means ChildProj1.exe + 3 (for blank and 1 and \\0)"}, {"owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1479340112, "post_id": 40644112, "comment_id": 68520723, "body": "@vlad-from-moscow it is not necessary to know what i am trying to do with lpCommandLine array. All i want is concatenate &quot; 1&quot; with strings of array child_names and copy each string to lpCommandLine array."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1479342064, "post_id": 40644112, "comment_id": 68521334, "body": "@Y.E.S. It seems I have understood what you want. See my answer.:)"}], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "edited": false, "score": 0, "creation_date": 1479339228, "post_id": 40644172, "comment_id": 68520495, "body": "I want to store strings in that array, already tried char[ ][ ], char** but didn&#39;t work."}, {"owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "edited": false, "score": 0, "creation_date": 1479340463, "post_id": 40644172, "comment_id": 68520829, "body": "with char* child_names[ ], i tried to print each element and it printed correctly with this code <code>printf(&quot;%s&quot;, child_names[i]);</code>. It prints each string like this but when i want to do concatenating things go crazy."}], "tags": [], "owner": {"reputation": 563, "user_id": 1092688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc131329fdd2933c5b1ab7c9bd07f5ab?s=128&d=identicon&r=PG", "display_name": "Eric M.", "link": "https://stackoverflow.com/users/1092688/eric-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1479338920, "creation_date": 1479338920, "answer_id": 40644172, "question_id": 40644112, "link": "https://stackoverflow.com/questions/40644112/getting-first-string-from-string-array-in-c/40644172#40644172", "title": "Getting first string from string array in c", "body": "<p>Instead of <code>char * child_names[]</code> did you mean something like <code>char[][] child_names</code>, <code>char[] * child_names</code>, or <code>char ** child_names</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1479339278, "post_id": 40644229, "comment_id": 68520511, "body": "your issue about childname[0] = &#39;C&#39; is a red herring. YOu just need to display it as a string rather than a char in the debugger"}, {"owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "edited": false, "score": 0, "creation_date": 1479339618, "post_id": 40644229, "comment_id": 68520608, "body": "I just tried it now and in buff there is only &quot;\\0&quot; it says. If you have time you can try it with your compiler, i wonder if there is a problem with my compiler now."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1479339222, "creation_date": 1479339222, "answer_id": 40644229, "question_id": 40644112, "link": "https://stackoverflow.com/questions/40644112/getting-first-string-from-string-array-in-c/40644229#40644229", "title": "Getting first string from string array in c", "body": "<p>to do the string concat do</p>\n\n<pre><code>size_t sz = strlen(child_names[i]) + 3; // space, '1' and \\0\nchar *buff = malloc(sz); \nstrcat_s(buff,sz,child_names[i]);\nstrcat_s(buff,sz,\" 1\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1479900851, "last_edit_date": 1479900851, "creation_date": 1479342015, "answer_id": 40644717, "question_id": 40644112, "link": "https://stackoverflow.com/questions/40644112/getting-first-string-from-string-array-in-c/40644717#40644717", "title": "Getting first string from string array in c", "body": "<p>From your description it follows that you want to get strings like this</p>\n\n<pre><code>\"childname.exe c\"\n</code></pre>\n\n<p>However this loop</p>\n\n<pre><code>for (i = 0; i &lt; NO_OF_PROCESS; i++)\n{\n    strcat_s(child_names[i], strlen(child_names[i]), \" 1\");\n    strcpy_s(lpCommandLine[i], strlen(lpCommandLine[i]), child_names[i]);\n}\n</code></pre>\n\n<p>does not do what you want.</p>\n\n<p>This loop has undefined behavior because in this statement</p>\n\n<pre><code>    strcat_s(child_names[i], strlen(child_names[i]), \" 1\");\n</code></pre>\n\n<p>there is an attempt to modify a string literal. You may not change string literals neither in C nor in C++.</p>\n\n<p>Moreover in this statement</p>\n\n<pre><code>    strcpy_s(lpCommandLine[i], strlen(lpCommandLine[i]), child_names[i]);\n</code></pre>\n\n<p>this call</p>\n\n<pre><code>strlen(lpCommandLine[i])\n</code></pre>\n\n<p>also has undefined behavior because array pointed to by this pointer <code>lpCommandLine[i]</code> does not has the terminating zero.</p>\n\n<p>There is no any need to use the functions <code>strcat_s</code> and <code>strcpy_s</code>. It is much better to use standard function <code>strcat</code> and <code>strcpy</code>.</p>\n\n<p>What you is the following that is shown in this demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define NO_OF_PROCESS   3\n\nint main(void) \n{\n    const char * child_names[]= \n    {\n        \"ChildProj1.exe\", \n        \"ChildProj2.exe\", \n        \"ChildProj3.exe\" \n    };\n\n    const char *s = \" 1\";\n    size_t n = strlen( s );\n\n    char* lpCommandLine[NO_OF_PROCESS];\n\n    for ( int i = 0; i &lt; NO_OF_PROCESS; i++ )\n    {\n        lpCommandLine[i] = ( char * )malloc( strlen( child_names[i] ) + n + 1 );\n    }\n\n    for ( int i = 0; i &lt; NO_OF_PROCESS; i++ )\n    {\n        strcpy( lpCommandLine[i], child_names[i] );\n        strcat( lpCommandLine[i],  s );\n    }\n\n    for ( int i = 0; i &lt; NO_OF_PROCESS; i++ ) puts( lpCommandLine[i] );\n\nfor ( int i = 0; i &lt; NO_OF_PROCESS; i++ ) free( lpCommandLine[i] );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>ChildProj1.exe 1\nChildProj2.exe 1\nChildProj3.exe 1\n</code></pre>\n"}], "owner": {"reputation": 724, "user_id": 4832664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/186f35c343e496cc6c55e2f6b3b6f961?s=128&d=identicon&r=PG&f=1", "display_name": "Y.E.S.", "link": "https://stackoverflow.com/users/4832664/y-e-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 40644717, "answer_count": 3, "score": 2, "last_activity_date": 1479900851, "creation_date": 1479338609, "last_edit_date": 1479340851, "question_id": 40644112, "link": "https://stackoverflow.com/questions/40644112/getting-first-string-from-string-array-in-c", "title": "Getting first string from string array in c", "body": "<p>I am trying to create processes for my project. I will pas arguments to child process from parent and the argument will change in time, so i wanted to make a try first with passing 1 to the child. The string format should be like this \"childname.exe c\" where c represents random character (in this case it is 1 for just trial).</p>\n\n<p>I created a childname array and and all i wanted was concatenate the new string with childname string and copy it to another string array(lpCommandLine variable). When i debugged the code below i saw that child_name[0] (when i is equal to 0) returns only 'C' although i expected it to return \"ChildProj1.exe\". Is there a point that i missed or how to do it in c?</p>\n\n<p>here there is a image of what i getin debugger: <a href=\"https://i.stack.imgur.com/vIBZQ.jpg\" rel=\"nofollow noreferrer\">here stored values of in variables</a></p>\n\n<pre><code>#define NO_OF_PROCESS 3\n\nchar *child_names[]= {\"ChildProj1.exe\", \"ChildProj2.exe\", \"ChildProj3.exe\" };\nchar* lpCommandLine[NO_OF_PROCESS];\nint i;\n\n    for (i = 0; i &lt; NO_OF_PROCESS; i++)\n        lpCommandLine[i] = (char *)malloc(sizeof(char) * 16);\n\n\n    for (i = 0; i &lt; NO_OF_PROCESS; i++)\n    {\n        strcat_s(child_names[i], strlen(child_names[i]), \" 1\");\n        strcpy_s(lpCommandLine[i], strlen(lpCommandLine[i]), child_names[i]);\n    }\n</code></pre>\n"}, {"tags": ["c", "linux", "fork", "mkfifo"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1479338459, "post_id": 40643932, "comment_id": 68520232, "body": "FIFOs are rarely used and therefore buggy, and even their as-specified behavior is bizarre relative to everything else.  You will be happier using &quot;Unix domain&quot; sockets (<code>man 7 unix</code>)."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1479338532, "post_id": 40643932, "comment_id": 68520257, "body": "Having said that, you may get <i>less</i> peculiar behavior if you actually write to / read from the FIFO."}, {"owner": {"reputation": 105, "user_id": 5845929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e66abb9eab5c49e8cc2d36aa169639b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis Spi", "link": "https://stackoverflow.com/users/5845929/vaggelis-spi"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1479338694, "post_id": 40643932, "comment_id": 68520318, "body": "sadly i cannot do eitherwise since it&#39;s a part for a project. gonna attempt to read and write to it as you said"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1479345188, "post_id": 40643932, "comment_id": 68522181, "body": "Your output shows the sequencing but not the timing of the outputs. Neither process&#39;s <code>open()</code>  returns until the other&#39;s is called, but thereafter, the sequence depends on the whims of the scheduler; it is not deterministic."}, {"owner": {"reputation": 105, "user_id": 5845929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e66abb9eab5c49e8cc2d36aa169639b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis Spi", "link": "https://stackoverflow.com/users/5845929/vaggelis-spi"}, "edited": false, "score": 0, "creation_date": 1479377184, "post_id": 40643932, "comment_id": 68535192, "body": "the message &quot;fifo opened on child&quot; on the first execution is printed instantly and then i wait a couple of seconds since parent woke up"}, {"owner": {"reputation": 105, "user_id": 5845929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e66abb9eab5c49e8cc2d36aa169639b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis Spi", "link": "https://stackoverflow.com/users/5845929/vaggelis-spi"}, "edited": false, "score": 0, "creation_date": 1479393166, "post_id": 40643932, "comment_id": 68546231, "body": "well it might sound weird but today it works right. When i run the exact same code parent sleep and the child wait till parent wakes up to open the fifo"}], "owner": {"reputation": 105, "user_id": 5845929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e66abb9eab5c49e8cc2d36aa169639b?s=128&d=identicon&r=PG&f=1", "display_name": "Vaggelis Spi", "link": "https://stackoverflow.com/users/5845929/vaggelis-spi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494008957, "creation_date": 1479337620, "last_edit_date": 1494008957, "question_id": 40643932, "link": "https://stackoverflow.com/questions/40643932/strange-behaviour-of-opening-fifo-first-in-parent-and-then-in-child", "title": "Strange behaviour of opening fifo first in parent and then in child", "body": "<p>So i have been lately playing with fifo's and forks in C and i am a bit confused. I have the following code running in 2 different devices and i take different results every time.</p>\n\n<p>The code is :</p>\n\n<pre><code>#define MAX_BUF 1024\nint main(int argc, char const *argv[]) {\n  int fd,rc,bytes_in,pid,status;\n  char buf[256];\n  struct pollfd fdarray [1];\n\n  mkfifo(\"out.fifo\", 0700);\n\n  if (fork() == 0) {\n\n    fd = open(\"out.fifo\", O_WRONLY, 0);\n    printf(\"fifo opened on child\\n\" );\n    exit(1);\n  }\n\n    printf(\"parent is gonna sleep\\n\" );\n    sleep(10);\n    printf(\"parent woke up\\n\" );\n    fd = open(\"out.fifo\", O_RDONLY, 0);\n    printf(\"fifo opened on father\\n\" );\n    return 0;\n}\n</code></pre>\n\n<p>And i run this code in 2 different devices. Both devices run debian 8. The result in each one is the following.</p>\n\n<p>For the first one:</p>\n\n<pre><code>parent is gonna sleep\nfifo opened on child\nparent woke up\nfifo opened on father\n</code></pre>\n\n<p>And for the second one</p>\n\n<pre><code>parent is gonna sleep\nparent woke up\nfifo opened on father\nfifo opened on child\n</code></pre>\n\n<p>So this seems strange. Normally in both devices it should either wait for parent to woke up or maybe an error should occur because as it is stated in the man page of fifo </p>\n\n<pre><code>opening for write-only will fail with ENXIO (no such \ndevice or address) unless the other end has already been opened.\n</code></pre>\n\n<p>Instead in my device it runs the child process first opening the fifo. On the other device it just waits. Can someone explain me why is this happening? Am i doing something wrong?</p>\n\n<p><strong>\u0395DIT:</strong> Well it might sound weird but today it works right. When i run the exact same code the parent sleeps and the child waits till parent wakes up to open the fifo</p>\n"}, {"tags": ["c", "windows", "ssl", "openssl", "libcrypto"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1479343412, "post_id": 40643490, "comment_id": 68521685, "body": "Also see <a href=\"http://stackoverflow.com/q/24959340\">Which directory is the openssldir?</a>, <a href=\"http://stackoverflow.com/q/38337740\">How to change OPENSSLDIR on Ubuntu?</a> and <a href=\"http://stackoverflow.com/q/21477210\">Correct location of openssl.cnf file?</a>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1479344665, "post_id": 40643490, "comment_id": 68522033, "body": "Also see <a href=\"https://mta.openssl.org/pipermail/openssl-users/2016-November/004854.html\" rel=\"nofollow noreferrer\">CONF-less OpenSSL configuration?</a> on the OpenSSL mailing list. I have been meaning to ask about that for some time."}], "owner": {"reputation": 2336, "user_id": 1618406, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9fba98cb45aca3fe5f263540f6079214?s=128&d=identicon&r=PG", "display_name": "Tom Seddon", "link": "https://stackoverflow.com/users/1618406/tom-seddon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1276, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479335161, "creation_date": 1479335161, "question_id": 40643490, "link": "https://stackoverflow.com/questions/40643490/what-does-openssl-use-openssldir-for", "title": "What does OpenSSL use OPENSSLDIR for?", "body": "<p>I'm using a library that uses OpenSSL, which I haven't used before.</p>\n\n<p>When building OpenSSL 1.1.0, you can supply the configure script with the absolute path the OpenSSL folder. (The default for a 32-bit Windows build is <code>C:\\Program Files (x86)\\Common Files\\SSL</code>.)</p>\n\n<p>This absolute folder name then ends up in the libcrypto library. (There seem to be two main uses of this: <a href=\"https://github.com/openssl/openssl/blob/master/crypto/x509/by_dir.c#L71\" rel=\"nofollow noreferrer\">some stuff in the X509 code</a>, and in <a href=\"https://github.com/openssl/openssl/blob/master/crypto/engine/eng_list.c#L326\" rel=\"nofollow noreferrer\">the \"engines\" system</a>.)</p>\n\n<p>My code is itself a library, to be provided as a DLL for use by 3rd party software, so the idea of having absolute paths baked into it seems a bit unappealing.</p>\n\n<p>But I downloaded <a href=\"http://www.npcglib.org/~stathis/blog/precompiled-openssl/\" rel=\"nofollow noreferrer\">some guy's binary build of OpenSSL</a> and that had references to <code>D:\\opensource\\openssl-dist-1.1.0b-vs2015\\openssl-x64-shared-debug-vs2015\\lib\\engines-1_1</code>... even though I doubt many computers have that folder.</p>\n\n<p>So should I just be ignoring this?</p>\n\n<p>Should I be doing something to stop OpenSSL accessing these paths at runtime?</p>\n\n<p>Should I be configuring them at runtime somehow?</p>\n\n<p>(I imagine something similar with apply to OS X. For Linux I will probably just have my library link with the system version of OpenSSL.)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 6, "creation_date": 1479332974, "post_id": 40642957, "comment_id": 68517978, "body": "<code>tm_mon</code> is zero based."}, {"owner": {"reputation": 6673, "user_id": 287592, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ivBC8.png?s=128&g=1", "display_name": "Matthew Hoggan", "link": "https://stackoverflow.com/users/287592/matthew-hoggan"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1479333079, "post_id": 40642957, "comment_id": 68518039, "body": "@tkausl please post that as the answer."}, {"owner": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "edited": false, "score": 0, "creation_date": 1479333116, "post_id": 40642957, "comment_id": 68518062, "body": "More here: <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/time.h.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/7908799/xsh/time.h.html</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479333490, "post_id": 40642957, "comment_id": 68518232, "body": "Nit: <code>time_t</code> is not defined to be <code>unsigned long</code>.  Could use <code>printf(&quot;sec = %llds\\n&quot;, (long long) gps_epoch_to_epoch_diff);</code> for greater portability and avoid a <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">y2038</a> problem."}], "answers": [{"tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": true, "score": 5, "last_activity_date": 1479333179, "creation_date": 1479333179, "answer_id": 40643047, "question_id": 40642957, "link": "https://stackoverflow.com/questions/40642957/timegm-on-struct-tm-where-year-70-mon-1-mday-1-does-not-return-0-seconds/40643047#40643047", "title": "timegm on struct tm: Where year = 70 mon = 1 mday = 1 does not return 0 seconds?", "body": "<pre><code>tm.tm_year = 70;\ntm.tm_mon = 1;\ntm.tm_mday = 1;\n</code></pre>\n\n<p>You are using <code>1</code> as month, which is february, as <a href=\"http://www.cplusplus.com/reference/ctime/tm/\" rel=\"nofollow noreferrer\">tm_mon is zero-based</a>. Use <code>0</code> and you should get your desired result.</p>\n"}], "owner": {"reputation": 6673, "user_id": 287592, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ivBC8.png?s=128&g=1", "display_name": "Matthew Hoggan", "link": "https://stackoverflow.com/users/287592/matthew-hoggan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 40643047, "answer_count": 1, "score": 0, "last_activity_date": 1479333179, "creation_date": 1479332830, "question_id": 40642957, "link": "https://stackoverflow.com/questions/40642957/timegm-on-struct-tm-where-year-70-mon-1-mday-1-does-not-return-0-seconds", "title": "timegm on struct tm: Where year = 70 mon = 1 mday = 1 does not return 0 seconds?", "body": "<p>Given the following:</p>\n\n<pre><code>struct tm tm;\ntime_t gps_epoch_to_epoch_diff;\n\nmemset(&amp;tm, 0, sizeof(struct tm));\ntm.tm_year = 70;\ntm.tm_mon = 1;\ntm.tm_mday = 1;\n\ngps_epoch_to_epoch_diff = timegm(&amp;tm);\nprintf(\"sec = %lus\\n\", gps_epoch_to_epoch_diff);\n</code></pre>\n\n<p>I would expect the output to be </p>\n\n<blockquote>\n  <p>sec = 0s</p>\n</blockquote>\n\n<p>However, I am getting:</p>\n\n<blockquote>\n  <p>sec = 2678400s</p>\n</blockquote>\n\n<p>Why?</p>\n"}, {"tags": ["c", "arrays", "string", "integer", "cs50"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1479400582, "post_id": 40642786, "comment_id": 68551756, "body": "You will run into this same conversion over and over again. It is well worth taking a look at <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\"><b>ASCII Table &amp; Description</b></a> to understand exactly why <i>character</i> <code>&#39;0&#39;</code> is actually <i>decimal</i> <code>48</code>. That is why the conversion <code>&#39;char_val&#39; - &#39;0&#39;</code> provides a proper conversion to the decimal value for the character representation."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7169810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/851879789423723345ac3e9b26072ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Marcello Scattolini", "link": "https://stackoverflow.com/users/7169810/marcello-scattolini"}, "edited": false, "score": 0, "creation_date": 1479332785, "post_id": 40642817, "comment_id": 68517888, "body": "the compiler returns:  credit.c:21:33: error: incompatible integer to pointer conversion passing &#39;char&#39; to parameter of type &#39;const char *&#39;; take the address with &amp;       [-Werror,-Wint-conversion]             cc_digits[i] = atoi(cc_string[i]);                                 ^~~~~~~~~~~~                                 &amp; /usr/include/stdlib.h:147:30: note: passing argument to parameter &#39;__nptr&#39; here extern int atoi (const char *__nptr)                              ^"}], "tags": [], "owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1479332273, "creation_date": 1479332273, "answer_id": 40642817, "question_id": 40642786, "link": "https://stackoverflow.com/questions/40642786/rough-times-trying-to-convert-string-to-integers-array/40642817#40642817", "title": "Rough times trying to convert string to integers array", "body": "<p>Instead of casting to int with <code>(int)</code>, use <a href=\"https://en.wikibooks.org/wiki/C_Programming/C_Reference/stdlib.h/atoi\" rel=\"nofollow noreferrer\">atoi()</a></p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7169810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/851879789423723345ac3e9b26072ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Marcello Scattolini", "link": "https://stackoverflow.com/users/7169810/marcello-scattolini"}, "edited": false, "score": 0, "creation_date": 1479339232, "post_id": 40643032, "comment_id": 68520497, "body": "Grigor, thank you so much. Very helpful indeed, brother."}], "tags": [], "owner": {"reputation": 1494, "user_id": 4608341, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a999fbef69237425f8537ea518f97be4?s=128&d=identicon&r=PG&f=1", "display_name": "grigor", "link": "https://stackoverflow.com/users/4608341/grigor"}, "is_accepted": true, "score": 1, "last_activity_date": 1479333111, "creation_date": 1479333111, "answer_id": 40643032, "question_id": 40642786, "link": "https://stackoverflow.com/questions/40642786/rough-times-trying-to-convert-string-to-integers-array/40643032#40643032", "title": "Rough times trying to convert string to integers array", "body": "<p>Instead of <code>cc_digits[i] = (int) cc_string[i]</code> try <code>cc_digits[i] = cc_string[i] - '0'</code> If you just cast to <code>int</code> you'll get the ASCII code for the character, but if you subtract the code of character <code>0</code> then you should get the actual digit.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 7169810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/851879789423723345ac3e9b26072ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Marcello Scattolini", "link": "https://stackoverflow.com/users/7169810/marcello-scattolini"}, "is_accepted": false, "score": 0, "last_activity_date": 1479408068, "last_edit_date": 1479408068, "creation_date": 1479336988, "answer_id": 40643826, "question_id": 40642786, "link": "https://stackoverflow.com/questions/40642786/rough-times-trying-to-convert-string-to-integers-array/40643826#40643826", "title": "Rough times trying to convert string to integers array", "body": "<p>Found the solution, want to share with you guys.Thank you all for the help, time and learnings.</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main (void)\n\n{\n    long long cc_num;\n    int array_dig[15];\n    int static sum_evens, sum_odds, sum_tot, valid = 0;\n    printf(\"Enter your credit card number for validation: \\n\");\n    cc_num = GetLongLong();\n\n    for (int i=15; i &gt;= 0; i--)\n        {\n            array_dig[i] = cc_num % 10;\n            cc_num = cc_num / 10;\n\n            //Sanity check\n            printf(\"pos %d = %d\\n\", i, array_dig[i]);\n        }\n\n    //Summing digits\n    for (int j=0; j &lt; 16; j++)\n        {\n            if (j % 2 == 0)\n            {\n            sum_evens += array_dig[j];\n\n            //Sanity check\n            printf(\"sum_evens = %d/n\", sum_evens);\n            }\n\n            else if (j % 2 == 1)\n                {\n                    if (array_dig[j] &lt; 5)\n                    {\n                        sum_odds += 2 * array_dig[j];\n\n                        //Sanity check\n                        printf(\"sum_odds for char &lt; 5 = %d\\n\", sum_odds);\n                    }\n                    else\n                    {\n                        sum_odds += (2 * array_dig[j]) % 10 + 1;\n\n                        //Sanity check\n                        printf(\"sum_odds for char &gt;= 5 = %d\\n\", sum_odds);\n                    }\n                }\n        }\n\n         sum_tot = sum_evens + sum_odds;\n\n         //Validation (if sum % 10 = 0 it is valid)\n         valid = sum_tot % 10;\n         printf(\"sum_tot = %d, valid = %d \\n\", sum_tot, valid);\n            if (valid % 10 == 0)\n                {\n                    printf(\"Valid credit card \\n\");\n                }\n            else\n                {\n                    printf(\"Invalid credit card\\n\");\n                }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 7169810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/851879789423723345ac3e9b26072ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Marcello Scattolini", "link": "https://stackoverflow.com/users/7169810/marcello-scattolini"}, "is_accepted": false, "score": 0, "last_activity_date": 1479420828, "creation_date": 1479420828, "answer_id": 40666009, "question_id": 40642786, "link": "https://stackoverflow.com/questions/40642786/rough-times-trying-to-convert-string-to-integers-array/40666009#40666009", "title": "Rough times trying to convert string to integers array", "body": "<p>Not so soon. =(\nProgram looses precision when passes values (digits) to the long long variable cc_num.</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (void)\n\n{\n    long long cc_num;\n    char cc_num_str[15];\n\n    int static sum_evens, sum_odds, sum_tot, valid = 0;\n    int static size;\n    do\n        {\n            printf(\"Enter your credit card number for validation: \\n\");\n            cc_num = GetLongLong();\n            sprintf(cc_num_str, \"%lld\", cc_num);\n            size = strlen (cc_num_str);\n        }\n    while (cc_num &lt; 1 || cc_num &gt; 9999999999999999 || size &lt; 13 || size &gt; 16);\n\n    int array_dig[size];\n\n    for (int i = size - 1; i &gt;= 0; i--)\n        {\n            array_dig[i] = cc_num % 10;\n            cc_num = cc_num / 10;\n\n            //Sanity check\n            printf(\"pos %d = %d\\n\", i, array_dig[i]);\n        }\n\n    //Summing digits\n    for (int j=0; j &lt; size; j++)\n        {\n            if (j % 2 == 0)\n            {\n            sum_evens += array_dig[j];\n\n            //Sanity check\n            printf(\"sum_evens = %d/n\", sum_evens);\n            }\n\n            else if (j % 2 == 1)\n                {\n                    if (array_dig[j] &lt; 5)\n                    {\n                        sum_odds += 2 * array_dig[j];\n\n                        //Sanity check\n                        printf(\"sum_odds for char &lt; 5 = %d\\n\", sum_odds);\n                    }\n                    else\n                    {\n                        sum_odds += (2 * array_dig[j]) % 10 + 1;\n\n                        //Sanity check\n                        printf(\"sum_odds for char &gt;= 5 = %d\\n\", sum_odds);\n                    }\n                }\n        }\n\n         sum_tot = sum_evens + sum_odds;\n\n         //Validation (if sum % 10 = 0 it is valid)\n         valid = sum_tot % 10;\n         printf(\"sum_tot = %d, valid = %d \\n\", sum_tot, valid);\n            if (valid % 10 == 0)\n                {\n                    //code that will verifies card type (to be written)\n\n                    printf(\"Valid credit card \\n\");\n                }\n\n            else\n                {\n                    printf(\"Invalid. \\n\");\n                }\n    return 0;    \n}\n</code></pre>\n\n<p>Here is the output:</p>\n\n<pre><code> Enter your credit card number for validation: \n    1234567809874366\n    pos 15 = 8\n    pos 14 = 3\n    pos 13 = 6\n    pos 12 = 9\n    pos 11 = 5\n    pos 10 = 8\n    pos 9 = 9\n    pos 8 = 0\n    pos 7 = 8\n    pos 6 = 7\n    pos 5 = 6\n    pos 4 = 5\n    pos 3 = 4\n    pos 2 = 3\n    pos 1 = 2\n    pos 0 = 1\n    sum_evens = 1/nsum_odds for char &lt; 5 = 4\n    sum_evens = 4/nsum_odds for char &lt; 5 = 12\n    sum_evens = 9/nsum_odds for char &gt;= 5 = 15\n    sum_evens = 16/nsum_odds for char &gt;= 5 = 22\n    sum_evens = 16/nsum_odds for char &gt;= 5 = 31\n    sum_evens = 24/nsum_odds for char &gt;= 5 = 32\n    sum_evens = 33/nsum_odds for char &gt;= 5 = 35\n    sum_evens = 36/nsum_odds for char &gt;= 5 = 42\n    sum_tot = 78, valid = 8 \n    Invalid.  \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7169810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/851879789423723345ac3e9b26072ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Marcello Scattolini", "link": "https://stackoverflow.com/users/7169810/marcello-scattolini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "closed_date": 1479739501, "accepted_answer_id": 40643032, "answer_count": 4, "score": 0, "last_activity_date": 1479500085, "creation_date": 1479332168, "last_edit_date": 1479500085, "question_id": 40642786, "link": "https://stackoverflow.com/questions/40642786/rough-times-trying-to-convert-string-to-integers-array", "closed_reason": "Not suitable for this site", "title": "Rough times trying to convert string to integers array", "body": "<p>Basically the program will ask for user credit card number, capture it inside a string, convert a string to an integer array (so I can validate credit card number, for later digit sums and multiplying).</p>\n\n<p>I need a variable with integers array and the code below stores ASCII values.</p>\n\n<p>Tried reading lots of posts, but didn't get it.</p>\n\n<p>I'd appreciate any help, so I could sleep again =)\nCordially,</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main (void)\n{\n\nstring cc_string;\n\nprintf(\"Please enter a credit card number:\\n\");\n\n//Captures credit card string\ncc_string = GetString();\n\n// Array of credit card digits integers \nint cc_digits[16];\n\n    for (int i = 0; i&lt;= 15; i++)\n        {   \n            cc_digits[i] = (int) cc_string[i];\n            //Just checking what value has been stored\n            printf(\"position %d with %d \\n\", i, cc_digits[i]);\n        }\n\n//to be continued\n\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "x86-64", "padding", "gcc6"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1479332242, "post_id": 40642765, "comment_id": 68517634, "body": "That looks like a syntax error to me. Is this C++ or something?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1479332297, "post_id": 40642765, "comment_id": 68517663, "body": "It&#39;s not a bug. In C every struct member can have unspecified padding after it. Why is this a problem?"}, {"owner": {"reputation": 2440, "user_id": 2676096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b1178790d916aa2177656a70aba28f86?s=128&d=identicon&r=PG&f=1", "display_name": "Banex", "link": "https://stackoverflow.com/users/2676096/banex"}, "edited": false, "score": 0, "creation_date": 1479332427, "post_id": 40642765, "comment_id": 68517714, "body": "Look into <code>#pragma pack(1)</code> but make sure it&#39;s what you really need and want."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1479332428, "post_id": 40642765, "comment_id": 68517715, "body": "<a href=\"http://stackoverflow.com/questions/2554229/memory-alignment-within-gcc-structs\" title=\"memory alignment within gcc structs\">stackoverflow.com/questions/2554229/&hellip;</a>"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1479332576, "post_id": 40642765, "comment_id": 68517782, "body": "@pm100 : no I don\u2019t want to require padding. I want no padding at all."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1479332706, "post_id": 40642765, "comment_id": 68517841, "body": "you want alignment that is different from the default, the default alignment is with a lot of empty space in it as you have seem, this is done for performance reasons. So you have to say what alignment you want"}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1479333386, "post_id": 40642765, "comment_id": 68518184, "body": "I hope you are not trying to index a struct?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479334509, "post_id": 40642765, "comment_id": 68518708, "body": "Struct definitions cannot contain initializers in C"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1479334915, "post_id": 40642765, "comment_id": 68518899, "body": "@Fredrik : what do you mean by <code>index</code>\u202f?"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479335213, "post_id": 40642765, "comment_id": 68519038, "body": "@M.M : didn\u2019t you noticed I\u2019m using gcc extensions\u202f?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479335418, "post_id": 40642765, "comment_id": 68519113, "body": "XY problem. <b>why</b> do you want to pack the <code>struct</code>? If that&#39;s for storing or serialisation: define the frame format and use shifts for serialisation."}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479335685, "post_id": 40642765, "comment_id": 68519234, "body": "@Olaf : I want a buffer with most of it\u2018s content fixed allocated on stack."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479336246, "post_id": 40642765, "comment_id": 68519439, "body": "Can you re-org the structure, putting <code>unsigned __int128 i</code> first?"}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479336377, "post_id": 40642765, "comment_id": 68519507, "body": "@chux : the aim of the structure is to get<code>i</code>crossing a 32 bytes boundary in the final buffer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479336504, "post_id": 40642765, "comment_id": 68519556, "body": "Interesting!  What goal does crossing a 32 byte boundary with <code>__int128</code> achieve that would not be made with say with <code>char x[32]</code>?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479336657, "post_id": 40642765, "comment_id": 68519611, "body": "&quot;fixed allocated on stack&quot; is an oxymoron. The stack is highly dynamic by definition. It is not clear why you don&#39;t use the correct and portable way and serialise the struct field-by-field with bitshifts."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479336776, "post_id": 40642765, "comment_id": 68519653, "body": "Hmmm Looks like &quot;code&quot; being put on a stack, maybe the first call from <code>main()</code> to set up some &quot;protection&quot; or &quot;hack&quot;."}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479337109, "post_id": 40642765, "comment_id": 68519787, "body": "@chux : because I need to perform 128 bits computations\u202f?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479337299, "post_id": 40642765, "comment_id": 68519865, "body": "Crossing a 32 byte boundary is not needed to perform 128 bits computations.  Still wondering about that <a href=\"http://stackoverflow.com/questions/40642765/how-to-tell-gcc-to-disable-padding-inside-struct?noredirect=1#comment68519507_40642765\">need</a>."}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479375754, "post_id": 40642765, "comment_id": 68534094, "body": "@chux : I want to bruteforce a parser which normally does not parse past 32 bytes boundaries. It\u2019s simpler to simply do <code>i++</code> in that case."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 3, "creation_date": 1507516963, "post_id": 40642765, "comment_id": 80225442, "body": "This is by no means a duplicate of <a href=\"https://stackoverflow.com/questions/2554229/memory-alignment-within-gcc-structs\" title=\"memory alignment within gcc structs\">stackoverflow.com/questions/2554229/&hellip;</a> Voting to reopen."}], "answers": [{"comments": [{"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1479333655, "post_id": 40642888, "comment_id": 68518316, "body": "@MichaelPetch : finally found the issue : atribute was the correct spell in my language. Sorry for this automatic spell checker error."}], "tags": [], "owner": {"reputation": 4277, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "is_accepted": true, "score": 30, "last_activity_date": 1479332868, "last_edit_date": 1479332868, "creation_date": 1479332520, "answer_id": 40642888, "question_id": 40642765, "link": "https://stackoverflow.com/questions/40642765/how-to-tell-gcc-to-disable-padding-inside-struct/40642888#40642888", "title": "How to tell gcc to disable padding inside struct?", "body": "<p>In GCC you can use <code>__attribute__((packed))</code> like this:</p>\n\n<pre><code>// sizeof(x) == 8\nstruct x\n{\n    char x;\n    int a;\n};\n\n// sizeof(y) == 5\nstruct y\n{\n    char x;\n    int a;\n} __attribute__((packed));\n</code></pre>\n\n<p>See <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/gcc/Type-Attributes.html\" rel=\"noreferrer\">doc</a>.</p>\n\n<p>Also if you rely on the addresses of struct fields, take a look at the <code>offsetof</code> macro. Maybe you don't need to pack the structure at all.</p>\n"}, {"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1479334632, "post_id": 40643199, "comment_id": 68518765, "body": "I suspect from the usage in the OPs question that reordering isn&#39;t a valid option since he is using the struct to store machine instructions. In his case straight out enabling packing (to 1 byte) is the best option IMHO."}, {"owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1479335026, "post_id": 40643199, "comment_id": 68518955, "body": "@MichaelPetch : Yep, and the aim of my struct is to get<code>i</code>crossing a 32 bytes boundary."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1479333873, "creation_date": 1479333873, "answer_id": 40643199, "question_id": 40642765, "link": "https://stackoverflow.com/questions/40642765/how-to-tell-gcc-to-disable-padding-inside-struct/40643199#40643199", "title": "How to tell gcc to disable padding inside struct?", "body": "<p>The fields within the <code>struct</code> are padded in an implementation defined manner.  </p>\n\n<p>That being said, fields are typically aligned on an offest which is a multiple of the size of the data member (or array element if the member is an array) in question.  So a 16 bit field starts on a 2 byte offset, 32 bit field starts on a 4 byte offset, and so forth.</p>\n\n<p>If you reorder the fields in your <code>struct</code> to adhere to this guideline, you can typically avoid having any internal padding within the <code>struct</code> (although you may end up with some trailing padding).</p>\n\n<p>By putting the fields at the proper offset, there can be performance gains over forcefully packing the <code>struct</code>.</p>\n\n<p>For more details, see <a href=\"http://www.catb.org/esr/structure-packing\" rel=\"nofollow noreferrer\">this article on structure packing</a>.</p>\n\n<p>While using the above techniques are not guaranteed, they tend to work in most cases.</p>\n"}, {"tags": [], "owner": {"reputation": 1014, "user_id": 6047952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a56a0a74a9848b8796170a9bce83e9fa?s=128&d=identicon&r=PG", "display_name": "infixed", "link": "https://stackoverflow.com/users/6047952/infixed"}, "is_accepted": false, "score": 6, "last_activity_date": 1479335304, "creation_date": 1479335304, "answer_id": 40643512, "question_id": 40642765, "link": "https://stackoverflow.com/questions/40642765/how-to-tell-gcc-to-disable-padding-inside-struct/40643512#40643512", "title": "How to tell gcc to disable padding inside struct?", "body": "<p>As touched on by @Banex</p>\n\n<pre><code>#pragma pack(push,1)\nstruct\n{\n        char a;\n        int b;\n        long long c;\n} foo;\n#pragma pack(pop)\n</code></pre>\n\n<p>The <code>#pragma pack(push,1)</code> pushes the current packing mode internally, and sets packing to 1, no padding</p>\n\n<p>The <code>#pragma pack(pop)</code>  restores the previous packing</p>\n\n<p>Supposedly compatible with Microsoft's syntax</p>\n\n<p><a href=\"http://gcc.gnu.org/onlinedocs/gcc-4.4.4/gcc/Structure_002dPacking-Pragmas.html\" rel=\"noreferrer\">http://gcc.gnu.org/onlinedocs/gcc-4.4.4/gcc/Structure_002dPacking-Pragmas.html</a></p>\n"}], "owner": {"reputation": 2409, "user_id": 2284570, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9bd1d26aad2cfb7ece066d94c128d529?s=128&d=identicon&r=PG", "display_name": "user2284570", "link": "https://stackoverflow.com/users/2284570/user2284570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22180, "favorite_count": 0, "closed_date": 1479335287, "accepted_answer_id": 40642888, "answer_count": 3, "score": 10, "last_activity_date": 1527790481, "creation_date": 1479332095, "last_edit_date": 1527790481, "question_id": 40642765, "link": "https://stackoverflow.com/questions/40642765/how-to-tell-gcc-to-disable-padding-inside-struct", "closed_reason": "Duplicate", "title": "How to tell gcc to disable padding inside struct?", "body": "<p>I\u2019m unsure on whether it\u2019s normal or it\u2019s a compiler bug but I have a C struct with lot of members.\u202fAmong of them, there\u2019s,\u00a0:</p>\n\n<pre><code>struct list {\n    ...  \n    ...\n    const unsigned char nop=0x90; // 27 bytes since the begining of the structure\n    const unsigned char jump=0xeb; // 28 bytes since the begining of the structure\n    const unsigned char hlt=0xf4; // 29 bytes since the begining of the structure\n    unsigned __int128 i=0xeb90eb90eb90eb90f4f4 // should start at the 30th byte, but get aligned on a 16 byte boundary and starts on the 32th byte instead\n    const unsigned char data=0x66; // should start at the 46th byte, but start on the 48th instead.\n}; // end of struct list.\n</code></pre>\n\n<p>I had a hard time to find  out why my program wasn\u2019t working, but I finally found <strong>there\u2019s a 2 bytes gap between <code>hlt</code>and <code>i</code></strong> which is set to 0x0. This means that the <code>i</code> is getting aligned.<br>\nThis is very clear when I printf that part of the structure, because with\u00a0:</p>\n\n<pre><code>for(int i=28;i&lt;35;i++)\n    printf(\"%02hhX\",buf[i]);\n</code></pre>\n\n<p>I get <code>EBF40000EB90EB90</code> on the screen.</p>\n\n<p>I tried things like <code>volatile struct list data;</code>in my program, but it didn\u2019t changed the alignment problem.</p>\n\n<p>So is there a <code>#pragma</code> or a <code>__attribute__</code>to tell gcc to not align <code>i</code> inside <code>struct list</code>type\u202f?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1479332076, "post_id": 40642744, "comment_id": 68517553, "body": "Ex 1: <code>char c[5];</code> not initialized.  Add <code>char c[5] = &#39;\\0&#39;;</code> Ex 2: Missing null character in <code>c[]</code>.  Hmm  looks like home work rather than your own code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479332224, "post_id": 40642744, "comment_id": 68517622, "body": "Example 4 is the only one that works properly, because the array passed contains the <code>&#39;\\0&#39;</code> terminator that is required of a &quot;string&quot;. If any other example worked it was &quot;lucky&quot; to find that terminator by accident, not by design."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1479332248, "post_id": 40642744, "comment_id": 68517636, "body": "Regarding ex2: if I make the size <code>c[7]</code> and don&#39;t change anything, it will still print <code>abcde</code>, so I&#39;m not sure I follow."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479332492, "post_id": 40642744, "comment_id": 68517746, "body": "@WeatherVane so if I want to do something like <code>print_s((char*) &quot;abc&quot;)</code>, then C compiler will create an array like: <code>[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;\\0&#39;]</code>? Why doesn&#39;t this also happen with array declaration, e.g. if I declare c[6], why is c[5] not automatically set to <code>\\0</code>?"}, {"owner": {"reputation": 3193, "user_id": 2694511, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/2e9aw.png?s=128&g=1", "display_name": "Spencer D", "link": "https://stackoverflow.com/users/2694511/spencer-d"}, "edited": false, "score": 0, "creation_date": 1479332497, "post_id": 40642744, "comment_id": 68517748, "body": "@emihir0, in that case, it is likely that the value at c[6] (for a 7 char array) is already populated with a null byte to terminate the string. However, this is not necessarily standard behavior across all machines, so just because initializing the char array with an extra byte seems to resolve the issue on your end does not mean it is the proper solution, as it will most likely not be cross-compatible."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1479332499, "post_id": 40642744, "comment_id": 68517749, "body": "@emihir0 Just because it doesn&#39;t totally explode in that one test you did does not mean the code is correct. In C this is called Undefined Behaviour. Code with UB has unpredictable behaviour. It may appear to &quot;work&quot; sometimes but then blow up next time."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1479332614, "post_id": 40642744, "comment_id": 68517798, "body": "<code>why is c[5] not automatically set to \\0</code>. You need to read the C standard. It&#39;s not defined to initialise like that (assuming your variable is auto/local and not static/global)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479332735, "post_id": 40642744, "comment_id": 68517860, "body": "@emihir0 please do some googling, it&#39;s already been explained <i>ad infinitum</i> out there. But yes, <code>&quot;abc&quot;</code> is a <b>string literal</b> which has the <code>&#39;\\0&#39;</code> terminator applied, so <code>sizeof(&quot;abc&quot;)</code> will be <code>4</code>."}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1479332776, "post_id": 40642744, "comment_id": 68517884, "body": "So if this array was global, does that mean it would be initialised to <code>\\0</code> (ie. <code>c[5]</code>)?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479332908, "post_id": 40642744, "comment_id": 68517950, "body": "No, global is irrelevant, if you initialise each element of an array in the fashion of your question, no <code>&#39;0&#39;</code> is supplied unless you explicity put one, because the compiler does not know you intend it to be a &quot;string&quot;. It may be for some other purpose."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1479333619, "post_id": 40642744, "comment_id": 68518294, "body": "Global variables have static storage, which means they will be initialized to 0 (in the case of an array, all elements will be 0)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1479334538, "post_id": 40642744, "comment_id": 68518725, "body": "Why do you say Example 2 is working as expected? What happened to the <code>e</code> in <code>c[4]</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1479334589, "post_id": 40642744, "comment_id": 68518745, "body": "FYI, you don&#39;t need to cast <code>c</code> to <code>(char *)</code>. When you pass an array to a function, it&#39;s automatically converted to a pointer."}], "answers": [{"tags": [], "owner": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "is_accepted": false, "score": 6, "last_activity_date": 1479332494, "creation_date": 1479332494, "answer_id": 40642881, "question_id": 40642744, "link": "https://stackoverflow.com/questions/40642744/why-do-i-have-inconsistent-behaviour-using-fprintf/40642881#40642881", "title": "Why do I have inconsistent behaviour using fprintf?", "body": "<p>Please note that when you declare character arrays and initialize their elements one-by-one, you need to provide values for the characters continuously starting from the first one, and the last character should be given a null <code>'\\0'</code> value.</p>\n\n<p>Example:</p>\n\n<pre><code>char a[6];\na[0]='a';\na[1]='b';\na[2]='c';\na[3]='d';\na[4]='\\0';\n</code></pre>\n\n<p>This would declare the array <code>a</code> as the string <code>\"abcd\"</code>.</p>\n\n<p>If you fail to initialize in a similar way, your string is prone to getting garbage character values, which cannot be correctly interpreted by any I/O function, and would give unexpected results.</p>\n"}, {"tags": [], "owner": {"reputation": 13754, "user_id": 2567, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/de6ac81f92c0062a00a387a8eb2025e5?s=128&d=identicon&r=PG&f=1", "display_name": "Dana the Sane", "link": "https://stackoverflow.com/users/2567/dana-the-sane"}, "is_accepted": false, "score": 0, "last_activity_date": 1479333674, "last_edit_date": 1479333674, "creation_date": 1479333281, "answer_id": 40643069, "question_id": 40642744, "link": "https://stackoverflow.com/questions/40642744/why-do-i-have-inconsistent-behaviour-using-fprintf/40643069#40643069", "title": "Why do I have inconsistent behaviour using fprintf?", "body": "<p>Section '7.19.6.1 The fprintf function 8(s)', top of page 280, of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">ISO/IEC 9899 C standard</a> I looked at has the following to say about strings printed by <code>fprintf()</code> (using the <code>%s</code> format specifier):</p>\n\n<blockquote>\n  <p>Characters from the array are written up to (but not including) the terminating null character. If the\n  precision is specified, no more than that many bytes are written. <em>If the\n  precision is not specified or is greater than the size of the array, the array shall\n  contain a null character</em> (emphasis mine).</p>\n</blockquote>\n\n<p>Even the behaviour you note as 'expected' is unspecified if the NUL terminator is absent. The behaviour you are seeing is dependent the implementation of the compiler and that of the system your code is running on. On different system or with a different compiler, you are likely to get a different result for your examples 1-3.</p>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1479390624, "creation_date": 1479331993, "last_edit_date": 1479390624, "question_id": 40642744, "link": "https://stackoverflow.com/questions/40642744/why-do-i-have-inconsistent-behaviour-using-fprintf", "title": "Why do I have inconsistent behaviour using fprintf?", "body": "<p>As far as I know, <code>fprintf</code> takes an pointer to a array of chars as an argument, and prints it. I don't know \"when\" it stops though. Take the following examples:</p>\n\n<p>Assume: <code>print_s</code> is</p>\n\n<pre><code>void print_s(const char* s) {\n    fprintf(stdout,\"%s\",s);\n}\n</code></pre>\n\n<p>Example 1:</p>\n\n<pre><code>char c[6];\nc[0] = 'a';\nc[1] = 'b';\nc[2] = 'c';\nc[3] = 'd';\nc[4] = 'e';\nprint_s((char*) c);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>abcd // e not printed!\n</code></pre>\n\n<p>Example 2:</p>\n\n<pre><code>char c[6];\nc[0] = 'a';\nc[1] = 'b';\nc[2] = 'c';\nc[3] = 'd';\nc[4] = 'e';\nc[5] = 'b';\nprint_s((char*) c);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>abcdb // works as expected\n</code></pre>\n\n<p>Example 3:</p>\n\n<pre><code>char c[6];\nc[0] = 'a';\nc[2] = 'c';\nc[3] = 'd';\nc[4] = 'e';\nprint_s((char*) c);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>a&lt;someGarbage&gt;cd // works as expected\n</code></pre>\n\n<p>Example 4:</p>\n\n<pre><code>char c[6];\nc[0] = 'a';\nc[1] = 'b';\nc[2] = 'c';\nc[3] = 'd';\nc[4] = 'e';\nc[5] = '\\0';\nprint_s((char*) c);\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>abcde // works as expected\n</code></pre>\n"}, {"tags": ["c", "linux", "unix"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479330805, "post_id": 40642390, "comment_id": 68516908, "body": "Why are you assigning <code>NULL</code> to an <code>int</code>? And you have some internal file reading loops which are not even checking for <code>EOF</code>. The code is a complete mess."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1479330951, "post_id": 40642390, "comment_id": 68516964, "body": "what is this supposed to do: <code>read(passFD, passUser, numPass);</code> ? BTW: fgets() is your friend."}, {"owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "edited": false, "score": 0, "creation_date": 1479331071, "post_id": 40642390, "comment_id": 68517021, "body": "NULL is there because I used to have it as a char and forgot to change it. Also, not all loops would need to check for EOF, only the one that will be reading until the end of the line. For example, reading in the user name will never reach EOF so it&#39;s pointless to check."}, {"owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "edited": false, "score": 0, "creation_date": 1479331112, "post_id": 40642390, "comment_id": 68517038, "body": "That stores the username of the current line in the file to the passUser array"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1479331148, "post_id": 40642390, "comment_id": 68517054, "body": "&quot;reading in the user name will never reach EOF so it&#39;s pointless to check&quot; ha, ha, ha, ha, ha, ha"}, {"owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "edited": false, "score": 0, "creation_date": 1479331233, "post_id": 40642390, "comment_id": 68517101, "body": "is that wrong? I figured since the username is the first thing in the file followed by a colon and other information that it couldn&#39;t reach eof in that loop."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1479331820, "post_id": 40642390, "comment_id": 68517417, "body": "Why are you opening the same file with both <code>open</code> and <code>fopen</code>? On the first iteration of the <code>while</code> loop, you test <code>readPass != EOF</code> when <code>readPass</code> hasn&#39;t been initialized. The usual idiom to read by characters is <code>while ((readPass = fgetc(pass)) != EOF) { &#47;* ... *&#47; }</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479332335, "post_id": 40642390, "comment_id": 68517683, "body": "<code>read(passFD, passUser, numPass);             passUser[numPass - 1] = &#39;\\0&#39;;</code> --&gt; weak code.  Code should check the return value of <code>read()</code> before using <code>passUser</code>."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "edited": false, "score": 0, "creation_date": 1479331604, "post_id": 40642597, "comment_id": 68517300, "body": "Thanks! That worked. I just figured since the user name is the first thing in the file that I wouldn&#39;t have to check for EOF there. I also thought that the outer loop would catch it if EOF was found in a previous iteration of the loop. Guess I was wrong."}], "tags": [], "owner": {"reputation": 137, "user_id": 2138882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3880e37d76097b1003dbac5fd54872?s=128&d=identicon&r=PG&f=1", "display_name": "Forrest", "link": "https://stackoverflow.com/users/2138882/forrest"}, "is_accepted": true, "score": 1, "last_activity_date": 1479331426, "creation_date": 1479331426, "answer_id": 40642597, "question_id": 40642390, "link": "https://stackoverflow.com/questions/40642390/while-reading-through-the-password-file-the-program-never-encounters-eof/40642597#40642597", "title": "While reading through the password file, the program never encounters EOF", "body": "<p>You're probably getting stuck in one of the other while loops. Make sure each while loop is checking for EOF, particularly:</p>\n\n<pre><code>while (readPass != ':' &amp;&amp; readPass != EOF)\n            {\n                readPass = fgetc(pass);\n                numPass += 1;\n            }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "edited": false, "score": 0, "creation_date": 1479331891, "post_id": 40642628, "comment_id": 68517452, "body": "I&#39;ll keep that in my for the future, however this is for an assignment for class and I was supposed to write as much of it as possible (within reason) by myself."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1479338305, "post_id": 40642628, "comment_id": 68520185, "body": "In a real program, you should use <code>getpwnam</code> not only because it does the parsing for you, but because it will pick up accounts from NIS, LDAP, etc. if the system has been configured that way."}], "tags": [], "owner": {"reputation": 3184, "user_id": 6710751, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qmR1W.jpg?s=128&g=1", "display_name": "Striezel", "link": "https://stackoverflow.com/users/6710751/striezel"}, "is_accepted": false, "score": 3, "last_activity_date": 1479332255, "last_edit_date": 1479332255, "creation_date": 1479331551, "answer_id": 40642628, "question_id": 40642390, "link": "https://stackoverflow.com/questions/40642390/while-reading-through-the-password-file-the-program-never-encounters-eof/40642628#40642628", "title": "While reading through the password file, the program never encounters EOF", "body": "<p>Searching for a user by reading the <code>/etc/passwd</code> file all by yourself is fine, if you have no other option. However, the better approach is to use an existing function that can do that for you: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getpwnam.html\" rel=\"nofollow noreferrer\">getpwnam()</a> from the header <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/pwd.h.html\" rel=\"nofollow noreferrer\">pwd.h</a>. No need to reinvent stuff that already has been done and works.</p>\n\n<p>Possible code could look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;errno.h&gt;\n\nint main()\n{\n  //reset errno to be able to detect errors\n  errno = 0;\n  struct passwd * result = getpwnam(\"username\");\n  //Return value NULL could either mean error or \"user not found\".\n  if (result == NULL)\n  {\n    //If errno is not zero, then an error occurred while getpwnam() was called.\n    if (errno != 0)\n      printf(\"An error occurred while searching for the user.\\n\");\n    //Otherwise the user just does not exist.\n    else\n      printf(\"User does not exist!\\n\");\n  }\n  //Not NULL: user was found.\n  else\n  {\n    printf(\"User exists.\\n\");\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5983936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f18e39a7a69e45e1ece200f3af10a2?s=128&d=identicon&r=PG&f=1", "display_name": "SPFort", "link": "https://stackoverflow.com/users/5983936/spfort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 40642597, "answer_count": 2, "score": 0, "last_activity_date": 1479332255, "creation_date": 1479330670, "question_id": 40642390, "link": "https://stackoverflow.com/questions/40642390/while-reading-through-the-password-file-the-program-never-encounters-eof", "title": "While reading through the password file, the program never encounters EOF", "body": "<p>Part of the program that I'm currently writing needs to check whether or not a user exists (this is for a unix system). However, while reading through the password file for users, EOF is never reached, therefore creating an endless loop. What could I be doing wrong?</p>\n\n<pre><code>        int readPass;\n\n        int userExists = 0; // 0 means user doesn't exist, 1 means they do\n\n        // open password file to read in usernames\n        int passFD = open(\"/etc/passwd\", O_RDONLY);\n\n        // open password file to read character by character\n        FILE* pass = fopen(\"/etc/passwd\", \"r\");\n\n        // c-string to store usernames\n        char passUser[100];\n\n        // read through the password file\n        while (readPass != EOF)\n        {\n            int numPass = 0;\n\n            // read until reaching a colon, this is the username of the current line\n            while (readPass != ':')\n            {\n                readPass = fgetc(pass);\n                numPass += 1;\n            }\n            // store username is a c-string\n            read(passFD, passUser, numPass);\n            passUser[numPass - 1] = '\\0';\n\n            // if the user exists, stop checking\n            if ((strcmp(passUser, argv[user])) == 0)\n            {\n                userExists = 1;\n                break;\n            }\n\n            // read junk until next line\n            readPass = NULL;\n            int junksRead = 0;\n            char passJunk[100];\n            while (junksRead &lt; 6)\n            {\n                numPass = 0;\n                readPass = NULL;\n                while (readPass != ':' &amp;&amp; readPass != '\\n' &amp;&amp; readPass != EOF)\n                {\n                    readPass = fgetc(pass);\n                    numPass += 1;\n                    //printf(\"%c\\n\", readPass);\n                }\n                read(passFD, passJunk, numPass);\n                junksRead += 1;\n            }\n        }\n\n        // if the user doesn't exist, end the program\n        if (userExists == 0)\n        {\n            printf(\"%s does not exist\\n\", argv[user]);\n            return 0;\n        }`\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation", "bit-shift"], "comments": [{"owner": {"reputation": 2864, "user_id": 1196369, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/16777b8b25858df69e496a07abfab395?s=128&d=identicon&r=PG", "display_name": "mickadoo", "link": "https://stackoverflow.com/users/1196369/mickadoo"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479329527, "post_id": 40642036, "comment_id": 68516226, "body": "@M.M Edited for clarity"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479330164, "post_id": 40642036, "comment_id": 68516570, "body": "Your implementation is shifting in a <code>1</code> bit to a signed value that already has all bits set to <code>1</code>. So no change. Too many answers now ahead of my <code>(~0u)&gt;&gt;20</code>"}], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479367061, "post_id": 40642076, "comment_id": 68528976, "body": "<code>~0</code> and <code>0</code> are both already of type int and no promotion happens. Your version is not completely correct, the cast should be done before the bitwise not."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479393002, "post_id": 40642076, "comment_id": 68546094, "body": "@2501 it&#39;s the shift operation that&#39;s causing the problem.  My version results in an unsigned or logical right shift."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479457986, "post_id": 40642076, "comment_id": 68575113, "body": "Your answer says that ~0 is promoted to int, but that is not correct, as the type of 0 is already int."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1479476090, "last_edit_date": 1479476090, "creation_date": 1479329533, "answer_id": 40642076, "question_id": 40642036, "link": "https://stackoverflow.com/questions/40642036/bitshift-on-assignment-has-no-effect-on-the-variable/40642076#40642076", "title": "Bitshift on assignment has no effect on the variable", "body": "<p>Try casting like this.  ~0 is <s>promoted to</s> int which is signed so it's carrying the sign bit when you shift</p>\n\n<pre><code>unsigned leftmost1 = ((unsigned)(~0)&gt;&gt;20);\nprintf(\"leftmost1 %u\\n\", leftmost1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479329787, "post_id": 40642078, "comment_id": 68516370, "body": "Fair enough, but outside of language-lawyering those aren&#39;t opposites. I meant &quot;unspecified by the standard&quot;."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1479330988, "post_id": 40642078, "comment_id": 68516979, "body": "The standard does specify , and it specifies that the implementation must document its choices. This is an important difference from saying that the behaviour could be effectively random."}, {"owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479332952, "post_id": 40642078, "comment_id": 68517969, "body": "Even if correct, you are being pedantic: my point is that the standard doesn&#39;t <i>specify the exact behavior</i>, and requires the implementation to <i>specify</i> it. Maybe you call that &quot;specified behavior&quot; but it&#39;s just semantics - to me it is correct to say &quot;it is not specified in the standard&quot;. Yes I understand this is different from <i>UB</i> or something which isn&#39;t even mentioned in the standard."}], "tags": [], "owner": {"reputation": 50907, "user_id": 149138, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cfd457233c8ebbab383475fc097442d9?s=128&d=identicon&r=PG", "display_name": "BeeOnRope", "link": "https://stackoverflow.com/users/149138/beeonrope"}, "is_accepted": true, "score": 6, "last_activity_date": 1479329635, "last_edit_date": 1479329635, "creation_date": 1479329536, "answer_id": 40642078, "question_id": 40642036, "link": "https://stackoverflow.com/questions/40642036/bitshift-on-assignment-has-no-effect-on-the-variable/40642078#40642078", "title": "Bitshift on assignment has no effect on the variable", "body": "<p>In the first case, you are doing a <em>signed right shift</em>, because <code>~0</code> results in a signed value. The exact behavior of signed right shifts is implementation-defined, but most platforms, including yours, extend the sign bit, so the shift is a no-op for your input of \"all ones\".</p>\n\n<p>In the second case, you are doing an unsigned right shift, since <code>leftmost1</code> is an <code>unsigned</code> value. So you shift in zeros from the left.</p>\n\n<p>If you wanted to do an unsigned shift without the intermediate assignmetn, you can do:</p>\n\n<pre><code>(~0u) &gt;&gt; 20\n</code></pre>\n\n<p>Where the <code>u</code> suffix indicates an unsigned literal.</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 2, "last_activity_date": 1479329919, "last_edit_date": 1479329919, "creation_date": 1479329609, "answer_id": 40642091, "question_id": 40642036, "link": "https://stackoverflow.com/questions/40642036/bitshift-on-assignment-has-no-effect-on-the-variable/40642091#40642091", "title": "Bitshift on assignment has no effect on the variable", "body": "<p><code>0</code> has type <code>int</code>. <code>~0</code> is <code>-1</code> on a typical two's complement machine. Right-shifting a negative number has implementation-defined results, but a common choice is to shift in <code>1</code> bits, which for <code>-1</code> leaves the number unchanged (i.e. <code>-1 &gt;&gt; anything</code> is <code>-1</code> again).</p>\n\n<p>You can fix this by writing <code>0u</code> (which is a literal of type <code>unsigned int</code>). This forces the operations to be done in <code>unsigned int</code>, as in your second example:</p>\n\n<pre><code>unsigned leftmost1 = ~0;\n</code></pre>\n\n<p>This line is equivalent to <code>unsigned leftmost1 = -1</code>, which implicitly converts -1 (a signed int) to <code>UINT_MAX</code>. The following operation (<code>leftmost1 &gt;&gt; 20</code>) then uses unsigned arithmetic.</p>\n"}, {"tags": [], "owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "is_accepted": false, "score": 3, "last_activity_date": 1479329696, "creation_date": 1479329696, "answer_id": 40642113, "question_id": 40642036, "link": "https://stackoverflow.com/questions/40642036/bitshift-on-assignment-has-no-effect-on-the-variable/40642113#40642113", "title": "Bitshift on assignment has no effect on the variable", "body": "<p><code>~0</code> is an <code>int</code>.  So your first piece of code isn't equivalent to the second, it's equivalent to</p>\n\n<pre><code>int tmp = ~0;\ntmp = tmp &gt;&gt; 20;\nunsigned leftmost1 = tmp;\n</code></pre>\n\n<p>You're seeing the results of sign extension when you right-shift a negative number.</p>\n"}], "owner": {"reputation": 2864, "user_id": 1196369, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/16777b8b25858df69e496a07abfab395?s=128&d=identicon&r=PG", "display_name": "mickadoo", "link": "https://stackoverflow.com/users/1196369/mickadoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 40642078, "answer_count": 4, "score": 1, "last_activity_date": 1479476090, "creation_date": 1479329351, "last_edit_date": 1495542283, "question_id": 40642036, "link": "https://stackoverflow.com/questions/40642036/bitshift-on-assignment-has-no-effect-on-the-variable", "title": "Bitshift on assignment has no effect on the variable", "body": "<p>I thought I'd found something similar in <a href=\"https://stackoverflow.com/questions/6367379/why-hasnt-my-variable-changed-after-applying-a-bit-shift-operator-to-it\">this answer</a> but in that case they weren't assigning the result of the expression to the variable. In my case I am assigning it but the bitshift part of the expression has no effect.</p>\n\n<pre><code>unsigned leftmost1 = ((~0)&gt;&gt;20);\nprintf(\"leftmost1 %u\\n\", leftmost1);\n</code></pre>\n\n<p>Returns</p>\n\n<pre><code>leftmost1 4294967295\n</code></pre>\n\n<p>Whereas</p>\n\n<pre><code>unsigned leftmost1 = ~0;\nleftmost1 = leftmost1 &gt;&gt; 20;\nprintf(\"leftmost1 %u\\n\", leftmost1);\n</code></pre>\n\n<p>Gives me</p>\n\n<pre><code>leftmost1 4095\n</code></pre>\n\n<p>I would expect separating the logic into two lines would have no impact, why are the results different?</p>\n"}, {"tags": ["c", "function", "c-strings"], "comments": [{"owner": {"reputation": 1006, "user_id": 3888756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPnk1.jpg?s=128&g=1", "display_name": "DigitalNinja", "link": "https://stackoverflow.com/users/3888756/digitalninja"}, "edited": false, "score": 0, "creation_date": 1479329060, "post_id": 40641838, "comment_id": 68515947, "body": "Do the &quot;bar graphs&quot; have to be printed next to each other or just after each input? Have you learned arrays?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479329428, "post_id": 40641838, "comment_id": 68516162, "body": "So far so good: but you need to call the function 5 times, once for each of the 5 values you have entered, such as <code>graph(chart1);</code> and so on. Change the function (and its prototype) to a <code>void</code> type, no need to return any value. For starters just print how many asterisks, like <code>void graph(int numberOfAsterisks){ printf(&quot;%d\\n&quot;, numberOfAsterisks);}</code>. Then do as they say, and make a loop inside the function to print that number of asterisks (and a <code>newline</code>)."}, {"owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 0, "creation_date": 1479330474, "post_id": 40641838, "comment_id": 68516729, "body": "I have the program working without using a function now its just a matter of converting what I have to a program using a function."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479332733, "post_id": 40641838, "comment_id": 68517858, "body": "Could go directly with <code>printf(&quot;%.*s\\n&quot;, width_up_to_50, &quot;*** 50 stars ***&quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 0, "creation_date": 1479335061, "post_id": 40643275, "comment_id": 68518973, "body": "Perfect! How do I increment my count though? I have played around and can only get it to display 1. on each line"}, {"owner": {"reputation": 763, "user_id": 4778343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kDMZU.jpg?s=128&g=1", "display_name": "Stefan Golubovi\u0107", "link": "https://stackoverflow.com/users/4778343/stefan-golubovi%c4%87"}, "reply_to_user": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 0, "creation_date": 1479335631, "post_id": 40643275, "comment_id": 68519204, "body": "@MissAnnThropic use global variable <code>int cnt=0</code> which you would increment inside <code>graph</code> function, and than print it. Other option is to have counter as local static variable inside <code>graph</code> function (<code>static int cnt=0</code>)."}], "tags": [], "owner": {"reputation": 763, "user_id": 4778343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kDMZU.jpg?s=128&g=1", "display_name": "Stefan Golubovi\u0107", "link": "https://stackoverflow.com/users/4778343/stefan-golubovi%c4%87"}, "is_accepted": true, "score": 1, "last_activity_date": 1479334214, "creation_date": 1479334214, "answer_id": 40643275, "question_id": 40641838, "link": "https://stackoverflow.com/questions/40641838/a-program-that-prints-the-number-of-asterisks-that-the-user-inputs-using-a-funct/40643275#40643275", "title": "A program that prints the number of asterisks that the user inputs using a function and passing value to the function", "body": "<p><code>main</code> is also a function, so you don't have problems with functions.</p>\n\n<p>All you need to do now is put your code that's repeating into <code>graph</code> function like this:</p>\n\n<pre><code>void graph(int numberOfAsterisks) {\n    printf(\"1. %d| \", numberOfAsterisks);\n    for( i=0; i&lt; numberOfAsterisks; i++)\n    {\n        printf(\"*\");\n    }\n}\n</code></pre>\n\n<p>And then just call <code>graph(chart1)</code> (<em>for example</em>) in <code>main</code>.</p>\n"}], "owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4817, "favorite_count": 0, "accepted_answer_id": 40643275, "answer_count": 1, "score": 0, "last_activity_date": 1479342292, "creation_date": 1479328641, "last_edit_date": 1479342292, "question_id": 40641838, "link": "https://stackoverflow.com/questions/40641838/a-program-that-prints-the-number-of-asterisks-that-the-user-inputs-using-a-funct", "title": "A program that prints the number of asterisks that the user inputs using a function and passing value to the function", "body": "<p>A part of an assignment I have due. The assignment states - </p>\n\n<p>Write a program that prints 5 bar graphs with asterisks. A function that accepts the length (number of asterisks) should be created and then called 5 different times to print the graphs. Use input validation to make sure that a user enters a positive number that is less than or equal to 50. Create a function that accepts an integer value representing the amount of asterisks to print. Only 1 value should be passed to the function. Use a for loop inside the function to print the number of asterisks that corresponds to the number passed to the function</p>\n\n<p>I have this so far but I am struggling pretty badly when it comes to functions. I am unsure of what my next step would be and how to print the number of asterisks inputted by the user. </p>\n\n<p>Thank you for your help. I am just a student! </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//function prototype\nvoid graph(int numberOfAsterisks);\n\nint main(void){\n// declare variables for length of each chart\nint chart1;\nint chart2;\nint chart3;\nint chart4;\nint chart5;\n// declare loop variable\nint i;\n\n// prompt the user and get lengths of each graph do/while to repeat if invalid\ndo {\nprintf(\"How long is chart 1? \");\nscanf(\"%d\", &amp;chart1);\n} while (chart1 &gt;= 50);\n\ndo {\nprintf(\"How long is chart 2? \");\nscanf(\"%d\", &amp;chart2);\n} while (chart2 &gt;= 50);\n\ndo {\nprintf(\"How long is chart 3? \");\nscanf(\"%d\", &amp;chart3);\n} while (chart3 &gt;= 50);\n\ndo {\nprintf(\"How long is chart 4? \");\nscanf(\"%d\", &amp;chart4);\n} while (chart4 &gt;= 50);\n\ndo {\nprintf(\"How long is chart 5? \");\nscanf(\"%d\", &amp;chart5);\n} while (chart5 &gt;= 50);\n\n//blank space\nprintf(\"\\n\");\n\n// display numbers of asterisks\n\n    printf(\"1. %d| \", chart1);\n        for( i=0; i&lt; chart1; i++)\n        {\n             printf(\"*\");\n        }\n\n    printf(\"\\n\");\n    printf(\"1. %d| \", chart2);\n    for( i=0; i&lt; chart2; i++)\n        {\n             printf(\"*\");\n        }\n\n    printf(\"\\n\");\n    printf(\"1. %d| \", chart3);\n    for( i=0; i&lt; chart3; i++)\n        {\n             printf(\"*\");\n        }\n\n    printf(\"\\n\");\n    printf(\"1. %d| \", chart4);\n    for( i=0; i&lt; chart4; i++)\n        {\n             printf(\"*\");\n        }\n\n    printf(\"\\n\");\n    printf(\"1. %d| \", chart5);\n    for( i=0; i&lt; chart5; i++)\n        {\n             printf(\"*\");\n        }\n\n    printf(\"\\n\");\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1479326920, "post_id": 40641283, "comment_id": 68514701, "body": "This question seems somehow the same <a href=\"https://stackoverflow.com/questions/33231470/how-to-find-actual-end-of-char-array-in-c-containing-zeros-in-the-middle/33232025#33232025\">like this one</a>"}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "edited": false, "score": 2, "creation_date": 1479327133, "post_id": 40641283, "comment_id": 68514816, "body": "BTW: The <i>size</i> of the array is 100. You are asking for the length of the <i>string</i>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1479327236, "post_id": 40641283, "comment_id": 68514868, "body": "None of those three lines are your problem. You have no idea about strlen. That&#39;s the whole problem. Who told you about &#39;\\0&#39; and it&#39;s usage ?"}, {"owner": {"reputation": 3363, "user_id": 2555321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/071cc8bdde247f6fc8798768afbf5c76?s=128&d=identicon&r=PG", "display_name": "Marcs", "link": "https://stackoverflow.com/users/2555321/marcs"}, "edited": false, "score": 0, "creation_date": 1479327826, "post_id": 40641283, "comment_id": 68515228, "body": "<i>The C library function size_t strlen(const char *str) computes the length of the string str up to, but not including the terminating null character.</i> <code>\\0</code> is the <i>terminating null character</i>, hence <code>strlen(msg)</code> equals 4."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1479328687, "post_id": 40641283, "comment_id": 68515742, "body": "<code>\u2019</code> look like smart quotes and not <code>&#39;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 228875, "user_id": 84651, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b5ab789d3e28d1fad880f3fd1765b66?s=128&d=identicon&r=PG", "display_name": "Justin Niessner", "link": "https://stackoverflow.com/users/84651/justin-niessner"}, "is_accepted": false, "score": 4, "last_activity_date": 1479326725, "creation_date": 1479326725, "answer_id": 40641315, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language/40641315#40641315", "title": "what is the length of this array? c language", "body": "<p><code>strlen</code> will stop counting as soon as it hits a null terminator (as C uses null terminated strings and expects to only find them at the end of a string). </p>\n\n<p>You have four characters before your first null terminator, therefore the length is 4.</p>\n"}, {"tags": [], "owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "is_accepted": false, "score": 4, "last_activity_date": 1479328727, "last_edit_date": 1479328727, "creation_date": 1479327124, "answer_id": 40641427, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language/40641427#40641427", "title": "what is the length of this array? c language", "body": "<p><code>strlen</code> returns 4 because the (first) <strong>string</strong> in <code>msg</code> is terminated by the <code>\\0</code> at <code>msg[4]</code>. However, the <strong>array</strong> <code>msg</code> has a length of 100 <code>char</code>s because it was declared as such.</p>\n"}, {"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1479327475, "post_id": 40641469, "comment_id": 68515002, "body": "No is not. One is to type 0 another one is to type &#39;\\0&#39;, for the last one you hit keyboard 4 times. So NO, there was no typo...."}], "tags": [], "owner": {"reputation": 9511, "user_id": 7023590, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/82052fbf0815ce82c4eded8fd941be14?s=128&d=identicon&r=PG&f=1", "display_name": "MarianD", "link": "https://stackoverflow.com/users/7023590/mariand"}, "is_accepted": false, "score": 1, "last_activity_date": 1479327236, "creation_date": 1479327236, "answer_id": 40641469, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language/40641469#40641469", "title": "what is the length of this array? c language", "body": "<p>Maybe it is typo in your</p>\n\n<pre><code>char msg[100] = {\u2019C\u2019,\u2019P\u2019,\u2019R\u2019,\u2018E\u2019,\u2018\\0\u2019,\u20182\u2019,\u20188\u2019, \u20188\u2019,\u2018\\0\u2019};\n</code></pre>\n\n<p>and you wanted</p>\n\n<pre><code>char msg[100] = {\u2019C\u2019,\u2019P\u2019,\u2019R\u2019,\u2018E\u2019,\u20180\u2019,\u20182\u2019,\u20188\u2019, \u20188\u2019,\u2018\\0\u2019};\n</code></pre>\n\n<p>(plainly: <code>CPRE0288</code>), so binary <code>0</code> (instead of the <em>character representation of 0</em> , i. e. <code>'0'</code>) <em>prematurely</em> finishes your string. </p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1479341095, "post_id": 40642566, "comment_id": 68521033, "body": "<code>msg</code> is <i>populated</i> with 100 bytes, the first 9 of which are explicitly given in the initializer, but the remainder are initialized to 0."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1479345379, "post_id": 40642566, "comment_id": 68522222, "body": "Yes but the OP&#39;s statement that he expected the result to be 9 makes me think he was asking &quot;how do I find out how many array elements were explicitly initialized?&quot;, which is not something that we can find out with C code - what if he had a bunch of trailing zeroes in the explicitly initialized variables?"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1479331259, "creation_date": 1479331259, "answer_id": 40642566, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language/40642566#40642566", "title": "what is the length of this array? c language", "body": "<p>You cannot assume that the return value of <code>strlen</code> represents the size of an array.</p>\n\n<p><code>strlen</code> will take a pointer to the start of a string and increment the pointer while looking for a null terminator; once it finds that, it returns the counter (i.e. number of increments before the null was found).</p>\n\n<p>You declared <code>msg</code> to be of length 100, but only populated 9 elements in the array.  <code>sizeof(msg)</code> will be 100.  </p>\n\n<p>Are you actually asking \"how can I find out how many values are initialized in an array\"? There's really no answer to that.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1479334654, "creation_date": 1479334654, "answer_id": 40643367, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language/40643367#40643367", "title": "what is the length of this array? c language", "body": "<p>Remember that in C, a <em>string</em> is simply a sequence of character values followed by a zero-valued terminator.  Strings are stored in arrays of <code>char</code> (or <code>wchar_t</code> for wide strings), but not every array of <code>char</code> (or <code>wchar_t</code>) is a string.  To store a string that's <code>N</code> characters long, you need an array with <em>at least</em> <code>N + 1</code> elements to account for the terminator.  </p>\n\n<p><code>strlen</code> returns the number of characters in the string starting at the specified address up to the zero terminator.  </p>\n\n<p>To get the size (in bytes) of the <code>msg</code> array, use the <code>sizeof</code> operator:</p>\n\n<pre><code>char msg[100] = {'C','P','R','E','\\0','2','8','8','\\0'};    \nsize_t my_length = strlen( msg );\nsize_t my_size = sizeof msg;\n\nif ( my_length &gt;= my_size )\n  // whoopsie\n</code></pre>\n\n<p>In this case, you're actually storing two strings in one array (<code>\"CPRE\"</code> and <code>\"288\"</code>).  </p>\n\n<p>The <em>size</em> of the <code>msg</code> array is 100 (as given by the declaration).</p>\n\n<p>The length of the <em>string</em> <code>\"CPRE\"</code> starting at <code>msg[0]</code> is 4, since you have a zero terminator in the fifth element of the array (<code>'\\0' == 0</code>).  </p>\n\n<p>The length of the string <code>\"288\"</code> starting at <code>msg[5]</code> is 3 since you have another zero terminator in the ninth element of the array.   </p>\n"}], "owner": {"reputation": 41, "user_id": 4127898, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-gb5dYKHOOv4/AAAAAAAAAAI/AAAAAAAABbQ/HhnK-tOCunQ/photo.jpg?sz=128", "display_name": "chenyin", "link": "https://stackoverflow.com/users/4127898/chenyin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 40643367, "answer_count": 5, "score": 0, "last_activity_date": 1479334654, "creation_date": 1479326639, "question_id": 40641283, "link": "https://stackoverflow.com/questions/40641283/what-is-the-length-of-this-array-c-language", "title": "what is the length of this array? c language", "body": "<pre><code>char msg[100] = {\u2019C\u2019,\u2019P\u2019,\u2019R\u2019,\u2018E\u2019,\u2018\\0\u2019,\u20182\u2019,\u20188\u2019, \u20188\u2019,\u2018\\0\u2019};\nint my_length = 0xFFFFFFFF;\nmy_length = strlen(msg);\n</code></pre>\n\n<p>I thought it is nine, however, the answer is 4. anyone can explain? thanks</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 5, "creation_date": 1479326590, "post_id": 40641234, "comment_id": 68514516, "body": "<code>read</code> and <code>recv</code> aren&#39;t guaranteed to return as many bytes as requested. You gotta check their return values, and keep reading until you&#39;ve found the end of what you want to read. Similarly, <code>write</code> (and <code>send</code>?) might not send as many bytes as requested. You gotta check its return value and call it in a loop."}, {"owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1479326662, "post_id": 40641234, "comment_id": 68514561, "body": "could you give some example? appreciate it!"}], "answers": [{"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1479328059, "post_id": 40641338, "comment_id": 68515351, "body": "It used to be that FTP clients would lose the end of files. I think it happened when the FIN packet arrived before the final data packet. As such, I think it&#39;s important to check that you received everything you should have received. That means the second snippet requires an additional check (e.g. the sender must provide the length of the message or a sentinel, and the receiver must check the length or for the sentinel)"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1479328904, "post_id": 40641338, "comment_id": 68515867, "body": "@ikegami Certainly that would be a good idea in a more structured setting. The example here was mostly to show how to use read in a loop. If there were other constraints on the type or shape of the data that was being sent around, you&#39;d definitely need to update this!"}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 4, "last_activity_date": 1479326783, "creation_date": 1479326783, "answer_id": 40641338, "question_id": 40641234, "link": "https://stackoverflow.com/questions/40641234/in-c-socket-why-my-server-cant-receive-the-whole-content/40641338#40641338", "title": "In c socket, why my server can&#39;t receive the whole content?", "body": "<p>The <code>read</code> and <code>write</code> functions are not guaranteed to send or receive the entire message with a single call. Instead, you're expected to sit in a loop, writing the message incrementally until everything has been sent and reading everything incrementally until everything has been read. For example, if you know <em>exactly</em> how much has been sent, you can do this:</p>\n\n<pre><code>char recvBuffer[BUFFER_SIZE];\nint  bytesRead = 0;\n\nwhile (bytesRead &lt; BUFFER_SIZE) {\n    int readThisTime = read(file, recvBuffer + bytesRead, BUFFER_SIZE - bytesRead);\n    if (readThisTime == -1) {\n       // handle error...\n    }\n    bytesRead += readThisTime;\n}\n</code></pre>\n\n<p>If you don't know exactly how much has been sent, try this:</p>\n\n<pre><code>char recvBuffer[BUFFER_SIZE];\nint  bytesRead = 0;\n\nwhile (bytesRead &lt; BUFFER_SIZE) {\n    int readThisTime = read(file, recvBuffer + bytesRead, BUFFER_SIZE - bytesRead);\n    if (readThisTime == -1) {\n       // handle error...\n    }\n    if (readThisTime == 0) break; // Done!\n\n    bytesRead += readThisTime;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "edited": false, "score": 1, "creation_date": 1479338214, "post_id": 40641997, "comment_id": 68520156, "body": "TCP is a byte stream. You can send whatever you want, as long as you read it in the same order that it is sent. TCP may transmit multiple items together on the wire, but your code should not rely on that. In my example, the client sends a 32-bit filename size, then the filename characters, then a 32-bit file size, then the file data. The server reads the 32-bit filename length, then the filename characters, then the 32-bit file size, then the file data. If you need to handle files &gt; 2GB in size, use a 64-bit file size instead."}, {"owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "edited": false, "score": 0, "creation_date": 1479340128, "post_id": 40641997, "comment_id": 68520730, "body": "you are so helpful!"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 2, "last_activity_date": 1479329735, "last_edit_date": 1479329735, "creation_date": 1479329215, "answer_id": 40641997, "question_id": 40641234, "link": "https://stackoverflow.com/questions/40641234/in-c-socket-why-my-server-cant-receive-the-whole-content/40641997#40641997", "title": "In c socket, why my server can&#39;t receive the whole content?", "body": "<p>You are ignoring the return values of <code>send()</code> and <code>recv()</code>.  You MUST check return values!</p>\n\n<p>When sending the file, <code>lengsize</code> receives how many bytes were actually read from the file.  Your client is sending too many bytes when <code>lengsize</code> is &lt; 8192 (typically the last block of the file if the file size is not an even multiple of 8192).</p>\n\n<p>But more importantly, although the client is telling the server the file size, the server is ignoring it to know when to stop reading.  The server is also ignoring the return value of <code>recv()</code> to know how many bytes were actually received so it knows how many bytes can safely be written to the output file.</p>\n\n<p>Try something more like this instead:</p>\n\n<p>common:</p>\n\n<pre><code>int readData(int s, void *buf, int buflen)\n{\n    int total = 0;\n    char *pbuf = (char*) buf;\n    while (buflen &gt; 0) {\n        int numread = recv(s, pbuf, buflen, 0);\n        if (numread &lt;= 0) return numread;\n        pbuf += numread;\n        buflen -= numread;\n        total += numread;\n    }\n    return total;\n}\n\nint sendData(int s, void *buf, int buflen)\n{\n    int total = 0;\n    char *pbuf = (char*) buf;\n    while (buflen &gt; 0) {\n        int numsent = send(s, pbuf, buflen, 0);\n        if (numsent &lt;= 0) return numsent;\n        pbuf += numsent;\n        buflen -= numsent;\n        total += numsent;\n    }\n    return total;\n}\n\nint readInt32(int s, int32_t *value)\n{\n    int res = readData(s, value, sizeof(*value));\n    if (res &gt; 0) *value = ntohl(*value);\n    return res;\n}\n\nint sendInt32(int s, int32_t value)\n{\n    value = htonl(value);\n    return sendData(s, &amp;value, sizeof(value));\n}\n\nchar* readStr(int s)\n{\n    int32_t size;\n    if (readInt32(s, &amp;size) &lt;= 0)\n        return NULL;\n\n    char *str = malloc(size+1);\n    if (!str)\n         return NULL;\n\n    if (readData(s, str, size) &lt;= 0) {\n        free(str);\n        return NULL;\n    }\n    str[size] = '\\0';\n\n    return str;\n}\n\nint sendStr(int s, const char *str)\n{\n    int len = strlen(str);\n    int res = sendInt32(s, len);\n    if (res &gt; 0)\n        res = sendData(s, str, len);\n    return res;\n}\n</code></pre>\n\n<p>server:</p>\n\n<pre><code>char buffer[8192];\n\nchar *name = readStr(connfd);\nif (!name) {\n    // error handling ...\n    sendStr(connfd, \"Socket read error\");\n    return;\n}\nprintf(\"name:%s\\n\", name);\n\nint32_t filesize;\nif (readInt32(connfd, &amp;filesize) &lt;= 0) {\n    // error handling ...\n    free(name);\n    sendStr(connfd, \"Socket read error\");\n    return;\n}\nprintf(\"size:%d\\n\", filesize);\n\nif ((stream = fopen(name, \"wb\")) == NULL) {\n    // error handling ...\n    printf(\"The file was not opened!\\n\");\n    free(name);\n    sendStr(connfd, \"File not opened\");\n    return;\n}\n\nwhile (filesize &gt; 0) {\n    int numread = readData(connfd, buf, min(filesize, sizeof(buffer)));\n    if (numread &lt;= 0) {\n        // error handling ...\n        close(stream);\n        free(name);\n        sendStr(connfd, \"Socket read error\");\n        return;\n    }\n\n    printf(\"buf:%.*s\\n\", numread, buf);\n\n    if (fwrite(buf, 1, numread, stream) != numread) {\n        // error handling ...\n        close(stream);\n        free(name);\n        sendStr(connfd, \"File write error\");\n        return;\n    }\n\n    filesize -= numread;\n}\n\nfclose(stream);\nfree(name);\n\nsendStr(connfd, \"OK\");\n</code></pre>\n\n<p>client:</p>\n\n<pre><code>char buffer[8192];\n\nstruct stat st;\nif (stat( put_name, &amp;st ) != 0) {\n    // error handling ...\n    exit(0);\n}\n\nif ((stream = fopen(put_name, \"rb\")) == NULL) {\n    // error handling ...\n    printf(\"The file was not opened!\\n\");\n    exit(0);\n}\n\nif (sendStr(fd, put_name) &lt;= 0) {\n    // error handling ...\n    close(stream);\n    exit(0);\n}\n\nint32_t filesize = st.st_size;\nif (sendInt32(fd, filesize) &lt;= 0) {\n    // error handling ...\n    close(stream);\n    exit(0);\n}\n\nint lengsize;\nwhile (filesize &gt; 0) {\n    lengsize = fread(buffer, 1, min(filesize , sizeof(buffer)), stream);\n    if (lengsize &lt;= 0) {\n        printf(\"Read File Failed\\n\");\n        // error handling ...\n        close(stream);\n        exit(0);\n    }\n\n    if (sendData(fd, buffer, lengsize) &lt;= 0) {\n        printf(\"Send File Failed\\n\");\n        // error handling ...\n        close(stream);\n        exit(0);\n    }\n\n    filesize -= lengsize;\n}\n\nclose(stream);\n\nchar *resp = readStr(fd);\nif (!resp) {\n    // error handling ...\n    exit(0);\n}\n\nif (strcmp(resp, \"OK\") == 0)\n    printf(\"Send File OK\\n\");\nelse\n    printf(\"Send File Failed: %s\\n\", resp);\n\nfree(resp);\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 6785719, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/81e5943f52540ee336f631da4ffd6f53?s=128&d=identicon&r=PG&f=1", "display_name": "Weiheng Li", "link": "https://stackoverflow.com/users/6785719/weiheng-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 40641997, "answer_count": 2, "score": 0, "last_activity_date": 1479329735, "creation_date": 1479326448, "last_edit_date": 1479326599, "question_id": 40641234, "link": "https://stackoverflow.com/questions/40641234/in-c-socket-why-my-server-cant-receive-the-whole-content", "title": "In c socket, why my server can&#39;t receive the whole content?", "body": "<p>I am new in this field, and writing one server and client, but it really confusing that I can't get all the content, but some small clip. \nMy server code:</p>\n\n<pre><code>        read(connfd, name, 20);\n        //recv(connfd,name,1024,0);\n        char* a=name;\n        while(a[0]!='\\n'){\n            a++;\n        }\n        a[0]='\\0';\n        printf(\"name:%s\\n\", name);\n        read(connfd, size, 20);\n        printf(\"size:%s\\n\", size);\n        recv(connfd,buf,8192,0);\n        printf(\"buf:%s\\n\", buf);\n        if((stream = fopen(name,\"w+t\"))==NULL){\n            printf(\"The file was not opened! \\n\");\n        }\n        int write_length = fwrite(buf,sizeof(char),8192,stream);\n        bzero(buf,8192);\n        if(put){\n        char *res=\"OK\\n\";\n        write(connfd, res, 1024);\n        }\n        fclose(stream);\n</code></pre>\n\n<p>and my client code is:</p>\n\n<pre><code>char buffer[8192];\nbzero(buffer,8192);\nchar * put=\"PUT\\n\";\nif ((write(fd, put, 8192)) &lt;= 0) {\n    if (errno != EINTR) {\n        fprintf(stderr, \"Write error: %s\\n\", strerror(errno));\n        exit(0);\n    }\n}\nstruct stat st ;\nstat( put_name, &amp;st );\nchar str[100];\nsprintf(str, \"%d\", st.st_size);\nint len;\nchar *current=NULL;\nlen=strlen(put_name);   \n\nchar sendname[1024];\nstrcpy(sendname,put_name);\nstrcat(sendname,\"\\n\");\nwrite(fd, sendname, 10);\nstrcat(str,\"\\n\");\nwrite(fd, str, 10);\nFILE *stream;\nif((stream = fopen(put_name,\"r\"))==NULL)\n{\n    printf(\"The file was not opened! \\n\");\n    exit(1);\n}\nint lengsize = 0;\nwhile((lengsize = fread(buffer,1,8192,stream)) &gt; 0){\n    if(send(fd,buffer,8192,0)&lt;0){\n        printf(\"Send File is Failed\\n\");\n        break;\n    }\n    bzero(buffer, 8192);\n}\n</code></pre>\n\n<p>Now, I can send all content, but can receive part of them. for example, on my mac, server can receive name but the <code>str</code> is neglected, when I printf the str in the server, it shows the content of file. and the content of file is not the whole file content. Some content disappear. Could you tell me why?</p>\n"}, {"tags": ["c", "segmentation-fault", "intel", "sse", "intrinsics"], "comments": [{"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 4, "creation_date": 1479325849, "post_id": 40640976, "comment_id": 68514059, "body": "Are you sure your program actually crashes at the instruction you cited, or is the compiler just optimizing the rest of the loop away if you remove the <code>_mm_cvtss_f32()</code> line (it doesn&#39;t have any other visible side effects)? Potential failure causes would be improper alignment of the <code>a</code> and <code>b</code> arrays since you are using aligned load instructions. Are you sure they are 16-byte aligned? On contemporary Intel hardware, there is very little performance difference between 16-byte aligned and unaligned loads (the <code>movaps</code> has a shorter instruction encoding than <code>movups</code>, but that&#39;s about it)."}, {"owner": {"reputation": 122, "user_id": 843147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b107c995012b4bb07acc0c83fdbae3e3?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/843147/simon"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479326727, "post_id": 40640976, "comment_id": 68514601, "body": "Thank you, I changed the <code>load</code> to a <code>loadu</code> and it seems to work now!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479327162, "post_id": 40640976, "comment_id": 68514825, "body": "@JasonR: Their encoding is the same length.  <a href=\"http://www.felixcloutier.com/x86/MOVAPS.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/MOVAPS.html</a> vs. <a href=\"http://www.felixcloutier.com/x86/MOVUPS.html\" rel=\"nofollow noreferrer\">felixcloutier.com/x86/MOVUPS.html</a>.  If you were comparing disassembly, did one of them have a REX prefix, or a different addressing mode?  Anyway, they perform identically when the data is aligned at run-time, but when L1 cache read bandwidth is a bottleneck, aligned loads have an advantage.  It&#39;s a good idea to make sure your data is aligned when it&#39;s cheap."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1479327287, "post_id": 40640976, "comment_id": 68514895, "body": "Also, @Simon: take the HADD instructions out of the loop, and do the horizontal sum at the end.  Use <code>_mm_add_ps</code> to keep add the vector of results to a vector accumulator.  (Preferably unroll with multiple vector accumulators to hide the latency of the add to the accumulator, so it doesn&#39;t bottleneck on the latency of the loop-carried dependency chain.  Auto-vectorization might work well here, esp. if you tell the compiler the pointers are aligned.)"}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1479327821, "post_id": 40640976, "comment_id": 68515224, "body": "@PeterCordes: I definitely defer to your expansive x86 expertise. I didn&#39;t realize that aligned loads had any remaining advantages nowadays. Do you have a reference for the L1-cache-read-bandwidth issue that you pointed out above?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479328187, "post_id": 40640976, "comment_id": 68515421, "body": "@JasonR: I forget where exactly I read this, but a load that crosses a cache-line boundary needs to access both lines.  The hardware takes care of this with only a small latency penalty, and also a throughput penalty since it takes two cache read-port operations.  Page-splits are even worse:  Hundreds of cycles latency until Skylake (5 cycles).  Unaligned loads are no more expensive when no cache-line boundary is crossed, though.  So if your data is almost always aligned at run-time, it makes sense to use MOVUPS.  No wasted time checking for alignment, and fast-enough in the rare case."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479328320, "post_id": 40640976, "comment_id": 68515512, "body": "@JasonR: Also, IIRC Intel&#39;s optimization manual mentions that unaligned 32B YMM loads or stores are subject to false dependencies, or something like that.  I&#39;d have to look it up since I forget the details, but apparently memory disambiguation doesn&#39;t work as well for 32B unaligned as for 32B aligned (or 16B unaligned).  I can&#39;t remember if this applies to only SnB/IvB (where 32B memory ops are split in two), or also HSW/SKL."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479328523, "post_id": 40640976, "comment_id": 68515646, "body": "@JasonR: Oh and also, <code>_mm_load_ps</code> can be folded into a memory operand for SUBPS, but <code>loadu</code> can only be used as a memory operand with AVX.  Without AVX, the compiler must emit a separate MOVUPS instruction (unless it can prove that the addresses will in fact always be aligned at run-time).  Separate load instructions increase code size and fused-domain uop count, since they can micro-fuse (<a href=\"http://stackoverflow.com/questions/26046634/micro-fusion-and-addressing-modes/31027695#31027695\">except for indexed addressing modes on some SnB-family CPUs</a>)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479328824, "post_id": 40640976, "comment_id": 68515826, "body": "@JasonR: So there&#39;s no advantage to ever actually using a MOVAPS instruction in asm vs. a MOVUPS, except to detect misaligned data while tuning code that you think should only be using aligned.  But there are advantages to actually aligning your data.  There are also advantages to telling the compiler about this, especially when auto-vectorizing instead of doing it manually with intrinsics.  (gcc likes to fully-unroll intro loops to do scalar until an aligned pointer is reached.  So promising the compiler that the input is already aligned avoids a lot of code bloat.)"}, {"owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "edited": false, "score": 1, "creation_date": 1479329336, "post_id": 40640976, "comment_id": 68516107, "body": "Thanks for the detailed breakdown!"}, {"owner": {"reputation": 122, "user_id": 843147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b107c995012b4bb07acc0c83fdbae3e3?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/843147/simon"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479337817, "post_id": 40640976, "comment_id": 68520048, "body": "@ JasonR and @Peter Corders, I can&#39;t begin to thank you both enough! I unrolled my loop and performed all my additions at the end and that effectively increased my speedup by 25%! Although I&#39;m not proficient enough in SSE/AVX intrinsics to fully understand your discussion, I learned a lot from this. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 10060, "user_id": 919747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/291c33625deabed28aea713a55208c3f?s=128&d=identicon&r=PG", "display_name": "Jason R", "link": "https://stackoverflow.com/users/919747/jason-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1479397042, "creation_date": 1479397042, "answer_id": 40659013, "question_id": 40640976, "link": "https://stackoverflow.com/questions/40640976/sse-simd-segmentation-fault-when-using-resulting-float/40659013#40659013", "title": "SSE SIMD Segmentation Fault when using resulting float", "body": "<p>Are you sure your program actually crashes at the instruction you cited, or is the compiler just optimizing the rest of the loop away if you remove the _mm_cvtss_f32() line (it doesn't have any other visible side effects)? Potential failure causes would be improper alignment of the a and b arrays since you are using aligned load instructions. Are you sure they are 16-byte aligned? On contemporary Intel hardware, there is very little performance difference between 16-byte aligned and unaligned loads (see the comments on the question above for a discussion of the issue).</p>\n\n<p>I mentioned in my original comment that <code>movaps</code> has a shorter encoding than <code>movups</code>. <strong>This is not correct.</strong> I was thinking instead of <code>movaps</code> versus <code>movapd</code>, which do the same memory transfer, only they're labeled as being for single-precision and double-precision data, respectively. In practice, they do the same thing, but <code>movaps</code> has a shorter encoding.</p>\n"}], "owner": {"reputation": 122, "user_id": 843147, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b107c995012b4bb07acc0c83fdbae3e3?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/843147/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 2, "accepted_answer_id": 40659013, "answer_count": 1, "score": 0, "last_activity_date": 1479397042, "creation_date": 1479325553, "question_id": 40640976, "link": "https://stackoverflow.com/questions/40640976/sse-simd-segmentation-fault-when-using-resulting-float", "title": "SSE SIMD Segmentation Fault when using resulting float", "body": "<p>I'm trying to use Intel Intrinsics to perform an operation quickly on a <code>float</code> array. The operations themselves seem to work fine; however, when I try to get the result of the operation into a standard C variable I get a SEGFAULT. If I comment the indicated line below out, the program runs. If I save the result of the indicated line, but do not manipulate it in any way, the program runs fine. It is only when I try to (in any way) interact with the result of <code>_mm_cvtss_f32(C)</code> that my program crashes. Any ideas?</p>\n\n<pre><code>float proc(float *a, float *b, int n, int c, int width) {\n    // Operation: SUM: (A - B) ^ 2\n    __m128 A, B, C;\n    float total = 0;\n    for (int d = 0, k = 0; k &lt; c; d += width, k++) {\n        for (int i = 0; i &lt; n / 4 * 4; i += 4) {\n            A = _mm_load_ps(&amp;a[i + d]);\n            B = _mm_load_ps(&amp;b[i + d]);\n            C = _mm_sub_ps(A, B);\n            C = _mm_mul_ps(C, C);\n            C = _mm_hadd_ps(C, C);\n            C = _mm_hadd_ps(C, C);\n            total += _mm_cvtss_f32(C); // SEGFAULT HERE\n        }\n        for (int i = n / 4 * 4; i &lt; n; i++) {\n            int diff = a[i + d] - b[i + d];\n            total += diff * diff;\n        }\n    }\n    return total;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "struct", "arm"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479325771, "post_id": 40640948, "comment_id": 68514020, "body": "What keeps you from cleanly serialising the <code>struct</code>?"}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479325843, "post_id": 40640948, "comment_id": 68514055, "body": "@Olaf - Padding bytes. I need packed structs so I can canonically know the data structure. This data file is going to be read by a different platform (probably python) on a different architecture (x86). Dealing with data-files where the format is dependent on the vagaries of compiler struct padding is /NOT/ fun."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479325976, "post_id": 40640948, "comment_id": 68514145, "body": "What about &quot;<b>cleanly</b> serialising&quot; was not clear? Type-punning is certainly <b>not</b> clean."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479326062, "post_id": 40640948, "comment_id": 68514206, "body": "How else /do/ you serialize a struct, then? I can&#39;t afford manually shifting everything out or more copying. FWIW, I have approximately 100 clock cycles per byte. Also, while I have access to a <code>malloc()</code>, my heap is very limited, so it&#39;d be very much preferred if everything was statically allocated."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479326325, "post_id": 40640948, "comment_id": 68514362, "body": "&quot;I can&#39;t afford manually shifting everything out&quot; - did you profile? With a good modern compiler like gcc, it is less costly than you might think - presuming you use a standard pattern! I still have to see code your statement is true for such like logging. After all, you have to read that log somehow lateron; if that is not the same as the writer, your reader depends on the same format/endianess and packing (which is not guaranteed). Oh, and if you really need 100 clocks/byte, your code is really poorly written; as a raw estimation, it takes at most 10 clocks done properly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479326708, "post_id": 40640948, "comment_id": 68514594, "body": "As a sidenote: If you use a heap, you very likely do something else wrong. In embedded systems, using a heap is far my most times a bad idea. Use either static memory or pools."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479326812, "post_id": 40640948, "comment_id": 68514656, "body": "@laf Profile with what? Did you read the question? This is on a <a href=\"http://www.atmel.com/devices/ATSAM4SD32B.aspx\" rel=\"nofollow noreferrer\">sam4s</a>. There are no profilers available.. I&#39;m running FreeRTOS (ergo, the heap, I wouldn&#39;t use one otherwise), but under some memory pressure. 100 clocks/byte is my ceiling for keeping up with the data rate, not my actual use, and there is a bunch of other housekeeping/interrupts stuff going on."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479327077, "post_id": 40640948, "comment_id": 68514789, "body": "@olaf Really, the question isn&#39;t &quot;how do you think I should implement this thing (given the fact that there are a pile of requirements that aren&#39;t enumerated in the question)&quot;. I just want to know what the heck GCC means when it says my struct member accesses are unaligned, because I&#39;m pretty sure they are aligned."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1479327989, "post_id": 40640948, "comment_id": 68515319, "body": "You might&#39;ve misunderstood what <code>packed</code> means: setting the alignment of all structure members to the minimum possible value, 1."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479328112, "post_id": 40640948, "comment_id": 68515380, "body": "Yes, I have understand that. I&#39;m then placing the struct members so that things that are 4 bytes wide are after 4 1-byte members, etc, so the alignment works. Basically, I&#39;m doing <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">catb.org/esr/structure-packing</a>"}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479328243, "post_id": 40640948, "comment_id": 68515461, "body": "For the example struct, assuming the struct instantiation starts on a aligned boundary (<code>aligned(4)</code>), the first <code>uint32_t</code> member will be at offset 0, followed by 4, 8, 12, 16, 20, the <code>uint64_t</code> member is at offset 24 (which is 8-byte aligned), and then there are 4 single-byte members the alignment of which is not critical. Am I missing something here?"}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1479328597, "post_id": 40640948, "comment_id": 68515677, "body": "On most sane platforms, the compiler aligns structures to the largest alignment requirement of any member. This is logical because the first member must be aligned, and a host of other reasons. Is that not the case with Cortex-M4?"}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1479328672, "post_id": 40640948, "comment_id": 68515735, "body": "@MichaelFoukarakis I have no freaking idea. I would assume so, but for some reason, my struct that starts with a <code>uint32_t</code> produces a warning that said <code>uint32_t</code> is not aligned. Even if I use the GCC directive that explicitly forces 4-byte alignment, I <i>stll</i> get the warning. At this point, I&#39;m looking at the disassembly, and I&#39;m relatively confident it&#39;s a compiler bug."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479333158, "post_id": 40640948, "comment_id": 68518080, "body": "@FakeName: Since I learned reading, I try to use it. The Cortex-M4 has a cycle counter built-in in most - if not all - implementations. You say there is no DWT? Did you check? I did not say to use a full-size profiler. Nevertheless, a simple look at the assembly code would suffice here. Most arithmetic operations, including arbitratry bitshifts take 1 clock cycle. plus the or, which takes another cycle, plus a store and 1 load at worst (1/4 for <code>uint32_t</code>). Some clocks for a loop can be spent (or unroll it, so there is no overhead)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479333259, "post_id": 40640948, "comment_id": 68518128, "body": "That means your CPU might require value to be naturally aligned. It might work without that, but then, it reads the fields byte-wise and assembles them for <b>every</b> access. Which is exactly what serialisation does, but (once more:) <b>for every access</b>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1479333624, "post_id": 40640948, "comment_id": 68518299, "body": "@MichaelFoukarakis: It is left to the integrator of the CPU core. And it is only supported for the basic accesses, not e.g. load/store multiple, double, etc. Which can cause trouble with optimisations. Smaller MCUs often spare the extra gates for the alignment unit. Which is inefficient anyway, as it only supports 1/2/4 byte accesses, thus has to use 3 (instead of the minimum 2 accesses) for an odd-address aligned word access."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479340758, "post_id": 40640948, "comment_id": 68520923, "body": "@Olaf - I&#39;m genuinely not sure what you point is, at this point. I can make sure the buffers I&#39;m using for this stuff is statically allocated, and by structuring things nicely, I actually managed to avoid a incidental copy in one place. The data is written into my output structure in larger chunks (32-bit writes for most of the members), and then read out in a single pass, without needing any shifting or anything."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479340849, "post_id": 40640948, "comment_id": 68520948, "body": "So..... yes, I think the current approach I&#39;m taking is optimimal, given the constraints I have (which are completely irrelevant to the question, by the way). The question was, in it&#39;s entirety &quot;why does GCC emit this warning for what I&#39;m confident is a correctly aligned struct&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479327273, "post_id": 40641449, "comment_id": 68514885, "body": "How can a struct containing only 32 bit values <i>not</i> have the values aligned on 32 bit boundaries?"}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479327650, "post_id": 40641449, "comment_id": 68515117, "body": "Wait. Does the the packed flag affect the instantiation of the variable somehow? I&#39;ve told the compiler to not add padding bytes (which is <i>all</i> the <code>__attribute__((packed))</code> does, afict). If the struct is instantiated on a non-aligned address, it would be an issue, but the warning is being thrown on the struct definition, not an instantiation."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "edited": false, "score": 0, "creation_date": 1479327850, "post_id": 40641449, "comment_id": 68515244, "body": "Ok, even specifying <code>struct adc_samples_t { int32_t adc_samples[6]; } __attribute__((packed, aligned(4)));</code> doesn&#39;t make the warning go away. With that attribute, I <i>do</i> have 32 bit alignment."}], "tags": [], "owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "is_accepted": false, "score": 4, "last_activity_date": 1479331801, "last_edit_date": 1479331801, "creation_date": 1479327190, "answer_id": 40641449, "question_id": 40640948, "link": "https://stackoverflow.com/questions/40640948/overeager-struct-packing-warnings-with-attribute-packed/40641449#40641449", "title": "Overeager struct packing warnings with `__attribute__((packed))`?", "body": "<blockquote>\n  <p>I assumed that 32-bit alignment was all that was needed for optimal component positioning on 32-bit ARM</p>\n</blockquote>\n\n<p>It is.</p>\n\n<p>But you don't <em>have</em> 32-bit alignment here <em>[in the originally-asked question]</em> <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Type-Attributes.html#Common-Type-Attributes\" rel=\"nofollow noreferrer\">because</a>:</p>\n\n<blockquote>\n  <p>Specifying the <code>packed</code> attribute for <code>struct</code> and <code>union</code> types is equivalent to specifying the <code>packed</code> attribute on each of the structure or union members.</p>\n</blockquote>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html#Common-Variable-Attributes\" rel=\"nofollow noreferrer\">given that</a>:</p>\n\n<blockquote>\n  <p>The <code>packed</code> attribute specifies that a variable or structure field should have the smallest possible alignment\u2014one byte for a variable, and one bit for a field, unless you specify a larger value with the <code>aligned</code> attribute.</p>\n</blockquote>\n\n<p>In other words, if you still want a packed structure to still have some minimum alignment after you've forced the alignment of all members, and thus the type itself, to nothing, you need to specify so - the fact that that might not actually make <code>-Wpacked</code> shut up is a different matter - GCC may well just spit that out reflexively before it actually considers any further alignment modifiers.</p>\n\n<p>Note that in terms of serialisation, you don't necessarily need to pack it anyway. The members fit in 9 words exactly, so the only compiler padding anywhere is an extra word at the end to round the total size up to 40 bytes, since <code>acq_time</code> forces the struct to a natural alignment of 8. Unless you want to operate on a whole array of these things at once, you can get away with simply ignoring that and still treating the members as one 36-byte chunk.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479333774, "post_id": 40642005, "comment_id": 68518380, "body": "ANd you think <b>that</b> latter is faster than the clean way? Btw: the compiler <b>has</b> to generate the worst-case code if it does not know the placement in advance (which it does for a statically aligned <code>struct</code> in the same function, but not if you e.g. pass it by pointer."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479340618, "post_id": 40642005, "comment_id": 68520888, "body": "Everything I&#39;m doing (here) is statically defined, so I can guarantee the first code version will be used. You keep mentioning the &quot;clean&quot; way, that I have yet to see."}, {"owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479340944, "post_id": 40642005, "comment_id": 68520981, "body": "If there is a better, &quot;cleaner&quot; way to serialize a struct then unioning it with a byte array, I&#39;m all ears, but I haven&#39;t seen it. Manual, explicit serializing by shifting out each member would be horrible and messy and involve a lot of repeated boiler-plate code, and I can&#39;t see any way that could be regarded as an improvement."}], "tags": [], "owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "is_accepted": true, "score": 2, "last_activity_date": 1479329245, "creation_date": 1479329245, "answer_id": 40642005, "question_id": 40640948, "link": "https://stackoverflow.com/questions/40640948/overeager-struct-packing-warnings-with-attribute-packed/40642005#40642005", "title": "Overeager struct packing warnings with `__attribute__((packed))`?", "body": "<p>Ok, at this point, I'm somewhat confident that the warning is being emitted in error.</p>\n\n<p>I have a statically defined instance of the struct, and at one point I zero it:</p>\n\n<pre><code>adc_sample_set running_average;\nint accumulated_samples;\n\ninline void zero_average_buf(void)\n{\n\n    accumulated_samples = 0;\n\n    running_average.adc_samples[0] = 0;\n    running_average.adc_samples[1] = 0;\n    running_average.adc_samples[2] = 0;\n    running_average.adc_samples[3] = 0;\n    running_average.adc_samples[4] = 0;\n    running_average.adc_samples[5] = 0;\n\n    running_average.overrun = 0;\n\n    running_average.acq_time = 0;\n\n}\n</code></pre>\n\n<p>The disassembly for the function is the follows:</p>\n\n<pre><code>{\n004005F8   push {r3, lr}         \n    accumulated_samples = 0;\n004005FA   movs r2, #0       \n004005FC   ldr  r3, [pc, #36]        \n004005FE   str  r2, [r3]         \n    running_average.adc_samples[0] = 0;\n00400600   ldr  r3, [pc, #36]        \n00400602   str  r2, [r3]         \n    running_average.adc_samples[1] = 0;\n00400604   str  r2, [r3, #4]         \n    running_average.adc_samples[2] = 0;\n00400606   str  r2, [r3, #8]         \n    running_average.adc_samples[3] = 0;\n00400608   str  r2, [r3, #12]        \n    running_average.adc_samples[4] = 0;\n0040060A   str  r2, [r3, #16]        \n    running_average.adc_samples[5] = 0;\n0040060C   str  r2, [r3, #20]        \n    running_average.overrun = 0;\n0040060E   strb.w   r2, [r3, #32]        \n    running_average.acq_time = 0;\n00400612   movs r0, #0       \n00400614   movs r1, #0       \n00400616   strd r0, r1, [r3, #24]        \n</code></pre>\n\n<p>Note that <code>r3</code> in the above is <code>0x2001ef70</code>, which is indeed 4-byte aligned. <code>r2</code> is the literal value <code>0</code>.</p>\n\n<p>The <code>str</code> opcode <em>requires</em> 4-byte alignment. The <code>strd</code> opcode only requires 4 byte alignment as well, since it appears to really be two sequential 4-byte operations, though I don't know how it actually works internally.</p>\n\n<hr>\n\n<p>If I intentionally mis-align my struct, to force the slow-path copy operation:</p>\n\n<pre><code>typedef struct adc_samples_t\n{\n    int8_t  overrun;\n    int32_t adc_samples[6];\n\n    uint64_t acq_time;\n\n\n    uint8_t padding_1;\n    uint8_t padding_2;\n    uint8_t padding_3;\n\n} __attribute__((packed, aligned(8))) adc_sample_set;\n</code></pre>\n\n<p>I get the following assembly:</p>\n\n<pre><code>{\n00400658   push {r3, lr}         \n    accumulated_samples = 0;\n0040065A   movs r3, #0       \n0040065C   ldr  r2, [pc, #84]        \n0040065E   str  r3, [r2]         \n    running_average.adc_samples[0] = 0;\n00400660   ldr  r2, [pc, #84]        \n00400662   strb r3, [r2, #1]         \n00400664   strb r3, [r2, #2]         \n00400666   strb r3, [r2, #3]         \n00400668   strb r3, [r2, #4]         \n    running_average.adc_samples[1] = 0;\n0040066A   strb r3, [r2, #5]         \n0040066C   strb r3, [r2, #6]         \n0040066E   strb r3, [r2, #7]         \n00400670   strb r3, [r2, #8]         \n    running_average.adc_samples[2] = 0;\n00400672   strb r3, [r2, #9]         \n00400674   strb r3, [r2, #10]        \n00400676   strb r3, [r2, #11]        \n00400678   strb r3, [r2, #12]        \n    running_average.adc_samples[3] = 0;\n0040067A   strb r3, [r2, #13]        \n0040067C   strb r3, [r2, #14]        \n0040067E   strb r3, [r2, #15]        \n00400680   strb r3, [r2, #16]        \n    running_average.adc_samples[4] = 0;\n00400682   strb r3, [r2, #17]        \n00400684   strb r3, [r2, #18]        \n00400686   strb r3, [r2, #19]        \n00400688   strb r3, [r2, #20]        \n    running_average.adc_samples[5] = 0;\n0040068A   strb r3, [r2, #21]        \n0040068C   strb r3, [r2, #22]        \n0040068E   strb r3, [r2, #23]        \n00400690   strb r3, [r2, #24]        \n    running_average.overrun = 0;\n00400692   mov  r1, r2       \n00400694   strb r3, [r1], #25        \n    running_average.acq_time = 0;\n00400698   strb r3, [r2, #25]        \n0040069A   strb r3, [r1, #1]         \n0040069C   strb r3, [r1, #2]         \n0040069E   strb r3, [r1, #3]         \n004006A0   strb r3, [r1, #4]         \n004006A2   strb r3, [r1, #5]         \n004006A4   strb r3, [r1, #6]         \n004006A6   strb r3, [r1, #7]    \n</code></pre>\n\n<p>So, pretty clearly, I'm getting the proper aligned-copy behaviour with my original struct definition, <strong>despite</strong> the compiler apparently incorrectly warning that it will result in inefficient accesses.</p>\n"}], "owner": {"reputation": 4535, "user_id": 268006, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbd9d461a54696a1e51d697e38b3b96e?s=128&d=identicon&r=PG", "display_name": "Fake Name", "link": "https://stackoverflow.com/users/268006/fake-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2762, "favorite_count": 0, "accepted_answer_id": 40642005, "answer_count": 2, "score": 4, "last_activity_date": 1479331801, "creation_date": 1479325463, "last_edit_date": 1479327974, "question_id": 40640948, "link": "https://stackoverflow.com/questions/40640948/overeager-struct-packing-warnings-with-attribute-packed", "title": "Overeager struct packing warnings with `__attribute__((packed))`?", "body": "<p>I'm implementing a binary logging system on a 32 bit ARM mcu (Atmel SAM4SD32C, a Cortex-M4/ARMv7E-M part), and in the process of designing my data structures. My goal is to describe the log format as a packed struct, and simply union the struct with a char array, for writing to the log device (a SD card, via FatFS, in this case).</p>\n\n<p>Basically, I have a very simple struct:</p>\n\n<pre><code>typedef struct adc_samples_t\n{\n    int32_t adc_samples[6];\n\n    uint64_t acq_time;\n\n    int8_t  overrun;\n    uint8_t padding_1;\n    uint8_t padding_2;\n    uint8_t padding_3;\n\n} __attribute__((packed, aligned(4))) adc_sample_set;\n</code></pre>\n\n<p>Now, my architecture is 32 bits, so as far as I understand, access to any member /other/ then the <code>overrun</code> member should be 32-bit aligned, and therefore not have an extra overhead. Furthermore, the <code>aligned(4)</code> attribute should force any instantiations of the struct to be on a 32-bit aligned boundary.</p>\n\n<p>However, compiling the above struct definition produces a pile of warnings:</p>\n\n<pre><code>        In file included from ../src/main.c:13:0:\n&lt;snip&gt;\\src\\fs\\fs-logger.h(10,10): warning: packed attribute causes inefficient alignment for 'adc_samples' [-Wattributes]\n          int32_t adc_samples[6];\n                  ^\n&lt;snip&gt;\\src\\fs\\fs-logger.h(12,11): warning: packed attribute causes inefficient alignment for 'acq_time' [-Wattributes]\n          uint64_t acq_time;\n</code></pre>\n\n<p>As far as I know (and I'm now realizing this is a big assumption), I assumed that 32-bit alignment was all that was needed for optimal component positioning on 32 bit arm. <strike>Oddly, the only member that does /not/ produce warnings are the <code>overrun</code> and <code>padding_X</code> members, which I don't understand the causes for.</strike> (Ok, the <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0553a/BABFAIGG.html\" rel=\"nofollow noreferrer\">ARM docs</a> say <code>Byte accesses are always aligned.</code>)</p>\n\n<p>What, exactly, is going on here? I assume (possibly incorrectly) that the struct instantiation will be on 4 bytes boundaries. Does the compiler require a more broad alignment (on 8 byte boundaries)?</p>\n\n<hr>\n\n<p>Edit: Ok, digging into the ARM docs (the magic words here were \"Cortex-M4 alignment\":</p>\n\n<blockquote>\n  <p>3.3.5. Address alignment</p>\n  \n  <p>An aligned access is an operation where a word-aligned address is used for a word, dual word, or multiple word access, or where a halfword-aligned address is used for a halfword access. Byte accesses are always aligned.</p>\n  \n  <p>The Cortex-M4 processor supports unaligned access only for the following instructions:</p>\n  \n  <p>LDR, LDRT<br>\n  LDRH, LDRHT<br>\n  LDRSH, LDRSHT<br>\n  STR, STRT<br>\n  STRH, STRHT  </p>\n  \n  <p>All other load and store instructions generate a UsageFault exception if they perform an unaligned access, and therefore their accesses must be address aligned. For more information about UsageFaults see Fault handling.</p>\n  \n  <p>Unaligned accesses are usually slower than aligned accesses. In addition, some memory regions might not support unaligned accesses. Therefore, ARM recommends that programmers ensure that accesses are aligned. To trap \n  accidental generation of unaligned accesses, use the UNALIGN_TRP bit in the Configuration and Control Register, see Configuration and Control Register.</p>\n</blockquote>\n\n<p>How is my 32-bit aligned value not word-aligned? The user guide defines \"Aligned\" as the following:</p>\n\n<blockquote>\n  <p>Aligned<br>\n  A data item stored at an address that is divisible by the\n  number of bytes that defines the data size is said to be aligned.\n  Aligned words and halfwords have addresses that are divisible by four\n  and two respectively. The terms word-aligned and halfword-aligned\n  therefore stipulate addresses that are divisible by four and two\n  respectively.</p>\n</blockquote>\n"}, {"tags": ["c", "ascii"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1479324799, "post_id": 40640745, "comment_id": 68513497, "body": "Because you used the wrong specifier. You print <code>char</code>s with <code>%c</code>, not <code>%d</code>."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1479324921, "post_id": 40640745, "comment_id": 68513559, "body": "@StoryTeller Not if you want to see the numeric value."}, {"owner": {"reputation": 146, "user_id": 4165293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7c675f68c8e71197046542093a319c?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/4165293/stefan"}, "edited": false, "score": 2, "creation_date": 1479325008, "post_id": 40640745, "comment_id": 68513608, "body": "c=1 for the same reason s=1"}, {"owner": {"reputation": 279, "user_id": 5407986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/44a5f0cfe31645448e3589f4667cf930?s=128&d=identicon&r=PG", "display_name": "Lupe", "link": "https://stackoverflow.com/users/5407986/lupe"}, "edited": false, "score": 2, "creation_date": 1479325013, "post_id": 40640745, "comment_id": 68513611, "body": "(On your machine) Char is 8 bits. Int is 32 bits. The difference is that 65537 fully fits in int but not char. You get 1 because 65537 % (2^8) = 1."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1479325018, "post_id": 40640745, "comment_id": 68513616, "body": "The conversion from int to char is implementation defined. Apparently your implementation converts 65537(int) to 1(char). <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.3p3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.3.1.3p3</a>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1479325043, "post_id": 40640745, "comment_id": 68513633, "body": "What size (in bytes) is <code>char</code>? What size (in bytes) is <code>int</code>? What are the max values of each of those types? What happens when a number overflows?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1479325083, "post_id": 40640745, "comment_id": 68513657, "body": "@aschepler, and we know the OP <i>meant</i> to do it how?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1479325214, "post_id": 40640745, "comment_id": 68513722, "body": "@StoryTeller - It doesn&#39;t matter if he meant it.   The question asks &quot;why does the code output &lt;X&gt;, not &quot;why doesn&#39;t the code output the thing that you might think I meant to have it output instead&quot;."}, {"owner": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "edited": false, "score": 0, "creation_date": 1479325284, "post_id": 40640745, "comment_id": 68513760, "body": "Shouldn&#39;t one use %hhd to output numeric value of a char instead of just %d?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479325299, "post_id": 40640745, "comment_id": 68513769, "body": "@BadZen, &quot;You used the wrong specifier&quot; is just as valid a response to &quot;&quot;why does the code output &lt;X&gt;&quot;."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1479325338, "post_id": 40640745, "comment_id": 68513792, "body": "Hint: the <a href=\"https://en.wikipedia.org/wiki/Binary_number#Counting_in_binary\" rel=\"nofollow noreferrer\">binary representation</a> of 65537 is 10000000000000001."}, {"owner": {"reputation": 279, "user_id": 5407986, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/44a5f0cfe31645448e3589f4667cf930?s=128&d=identicon&r=PG", "display_name": "Lupe", "link": "https://stackoverflow.com/users/5407986/lupe"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1479325360, "post_id": 40640745, "comment_id": 68513802, "body": "@StoryTeller, This looks like a homework problem. It&#39;s not unreasonable to assume he means to print out the numeric value because all of the other things he prints out are numbers."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479325378, "post_id": 40640745, "comment_id": 68513813, "body": "Also, int to char truncation <i>is</i> well-defined.   See <a href=\"http://stackoverflow.com/questions/5881895/truncating-an-int-to-char-is-it-defined\" title=\"truncating an int to char is it defined\">stackoverflow.com/questions/5881895/&hellip;</a>.   We also know <code>sizeof(char) == 1</code>, so this isn&#39;t platform-specific."}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1479326639, "post_id": 40640745, "comment_id": 68514545, "body": "StoryTeller thanks for the help , but I got this assignment from my teacher , im supposed to write down what the given code is printing and explain why , @BadZen thanks for being extremly helpful . but can you be more specific as im only 1 hour deep into C , I mean like verbly explaining this in what approach would you go?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "edited": false, "score": 0, "creation_date": 1479326923, "post_id": 40640745, "comment_id": 68514704, "body": "@Byteventurer: That&#39;s somewhat true. Problem is <code>char</code> has implementation-defined signed-ness, so it is not clear if it should be <code>%hhu</code>. But nevertheless, <code>%d</code> is correct, too due to integer promotion."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 2, "creation_date": 1479327004, "post_id": 40640745, "comment_id": 68514746, "body": "@BadZen: if <code>char</code> is signed, it is implementation defined, it only is &quot;well defined&quot; if we know what the implementation is and how it handles this. The linked question is about <code>unsigned char</code>!"}, {"owner": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479327760, "post_id": 40640745, "comment_id": 68515184, "body": "@Olaf: Yeah, knew about the signed-ness, I was just using &quot;d&quot; because it is used here. I didn&#39;t know not writing &quot;hh&quot; is valid, though, thanks. What is the point of using &quot;hh&quot; then, if it is being promoted?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479328029, "post_id": 40640745, "comment_id": 68515338, "body": "Ook.  @Olaf is correct.   I forgot <code>char</code> could be signed, is the issue.  Been doing too much Go. :)   There&#39;s actually a famous crypto bug (in a Blowfish implementation) about this, so should have remembered!"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1479332507, "post_id": 40640745, "comment_id": 68517754, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18276225/convert-int-to-short-in-c\">convert int to short in C</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "edited": false, "score": 0, "creation_date": 1479332578, "post_id": 40640745, "comment_id": 68517783, "body": "@Byteventurer: 1) Never use <code>char</code> if you intend to do arithmetics. Use <code>unsigned char</code> or <code>signed char</code> explicitly. It is good practice to use the plain <code>char</code> only for characters where it does not matter much (and the libraries expect <code>char</code>). For fixed width (e.g. 8 bit integers), you should never use the standard integer types, but the fixed width types from <code>stdint.h</code>. 2) Good point, I don&#39;t use these functions in my projects, so I never thought if it makes any difference. ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479332584, "post_id": 40640745, "comment_id": 68517786, "body": "In general, one should use the correct conversion type specifier, even if it does not matter much (sorry, but that&#39;s the best I can come up with here). It makes more difference for the <code>scanf</code> family. It does matter for <code>unsigned short</code> and 16 bit <code>int</code>."}, {"owner": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479333223, "post_id": 40640745, "comment_id": 68518109, "body": "@Olaf I guess it makes a difference for scanf only then, thanks. I do understand the signed-ness of char, as I said, I was just confused about the format specifier."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "edited": false, "score": 0, "creation_date": 1479333976, "post_id": 40640745, "comment_id": 68518486, "body": "@Byteventurer: I&#39;d be careful about such assumptions. There might be combinations of numbers of bits/byte, number of bits for the standard types, encoding, etc. which indeed make a difference. Just because I cannot instantly state one, does not mean there is none."}, {"owner": {"reputation": 1417, "user_id": 1597897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3soCY.jpg?s=128&g=1", "display_name": "Franko Leon Tokali\u0107", "link": "https://stackoverflow.com/users/1597897/franko-leon-tokali%c4%87"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479334295, "post_id": 40640745, "comment_id": 68518623, "body": "@Olaf Oh, I see, okay."}, {"owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "edited": false, "score": 0, "creation_date": 1479570908, "post_id": 40640745, "comment_id": 68619055, "body": "Hi all its the OP , I didnt write this code , I was only instructed by the teacher to analyse it ,"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1479327215, "last_edit_date": 1479327215, "creation_date": 1479326032, "answer_id": 40641109, "question_id": 40640745, "link": "https://stackoverflow.com/questions/40640745/c-help-me-in-understanding-this-ascii-prob/40641109#40641109", "title": "C ,help me in understanding this ASCII prob", "body": "<p>If to output the variable <code>i</code> in hex representation like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    int i = 65537;\n\n    printf( \"%#0x\\n\", i );\n\n    return 0;\n}\n</code></pre>\n\n<p>then you will see that it looks like</p>\n\n<pre><code>0x10001\n</code></pre>\n\n<p>Type <code>char</code> always occupies one byte. Thus in this assignment</p>\n\n<pre><code>char c = (char)i;\n</code></pre>\n\n<p>one byte of the object <code>i</code></p>\n\n<pre><code>0x10001\n     ^^\n</code></pre>\n\n<p>is stored in the variable <code>c</code>. </p>\n\n<p>In the <code>printf</code> statement in your program </p>\n\n<pre><code>printf(\"s = %u, i = %d, f = %f, c = %d\\n\", s,i,f,c);\n                                ^^^^^^\n</code></pre>\n\n<p>it is outputted using type specifier <code>%d</code>.  So its internal value is outputted as an integer of type <code>int</code>.</p>\n\n<p>Usually objects of the type <code>unsigned short</code> occupy two bytes. Thus in this assignment</p>\n\n<pre><code>unsigned short s = (unsigned short)i;\n</code></pre>\n\n<p>the value in the first two bytes of object <code>i</code> </p>\n\n<pre><code>0x10001\n   ^^^^\n</code></pre>\n\n<p>will be assigned to variable <code>s</code>.</p>\n\n<p>So <code>c</code> and <code>s</code> the both will have value 1.</p>\n"}], "owner": {"reputation": 170, "user_id": 7169387, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XXqRp.png?s=128&g=1", "display_name": "Yuval", "link": "https://stackoverflow.com/users/7169387/yuval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1479327654, "creation_date": 1479324755, "last_edit_date": 1479327654, "question_id": 40640745, "link": "https://stackoverflow.com/questions/40640745/c-help-me-in-understanding-this-ascii-prob", "title": "C ,help me in understanding this ASCII prob", "body": "<p>This code will print: </p>\n\n<blockquote>\n  <p>s = 1, i = 65537, f = 65537.000000, c = 1</p>\n</blockquote>\n\n<p>I need help in understanding why is it printing c=1.</p>\n\n<p>The code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  // Standard input-output library\n#include &lt;stdlib.h&gt; // Standard general utilities library\n\nint main(void) {\n   int i = 65537;\n   unsigned short s = (unsigned short)i;\n   float f = (float)i;\n   char c = (char)i;\n   printf(\"s = %u, i = %d, f = %f, c = %d\\n\", s,i,f,c);\n   system(\"PAUSE\");\n   return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "2d", "assign"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1479324115, "post_id": 40640530, "comment_id": 68513137, "body": "<code>strncpy(Ats[kiekis], Zodis, 59); Ats[kiekis][59] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479324134, "post_id": 40640530, "comment_id": 68513154, "body": "In <code>Ats[kiekis] = Zodis;</code> you cannot copy a string to a simple 2-D array like this, please use <code>strcpy(Ats[kiekis], Zodis)</code> or as the above comment."}, {"owner": {"reputation": 21, "user_id": 7167837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96528873c8417de3e08153a3a2f51fef?s=128&d=identicon&r=PG&f=1", "display_name": "Tukkas", "link": "https://stackoverflow.com/users/7167837/tukkas"}, "edited": false, "score": 0, "creation_date": 1479324396, "post_id": 40640530, "comment_id": 68513292, "body": "I can&#39;t believe I forgot that in C strcpy function needs to be used... Thank You! By the way, could any of You explain how this line works: &quot;(i = 0; 1 == sscanf(eilute + i, &quot;%s%n&quot;, Zodis, &amp;l)&quot;? I&#39;ve found it on another thread on this website, but it wasn&#39;t explained very well."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1479324709, "post_id": 40640530, "comment_id": 68513455, "body": "<code>1 == sscanf(eilute + i, &quot;%s%n&quot;, Zodis, &amp;l)</code> checks that <code>sscanf</code> returned 1. That function returns how many format specifiers it successfully read. <code>%n</code> is used to get how many characters were read so far. So this one line checks the string was read successfully, and gets its length."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479324755, "post_id": 40640530, "comment_id": 68513476, "body": "Ask for <a href=\"https://en.wikipedia.org/wiki/Yoda_conditions\" rel=\"nofollow noreferrer\">Yoda conditions</a>, when the constant value is put first. The <code>scanf</code> family of functions all return the number of items successfully converted. The programmer is right to do this - absolutely essential when reading input data. Although it is actually wrong: there are <b><i>two</i></b> input items. So <code>2== ...</code>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479324997, "post_id": 40640530, "comment_id": 68513599, "body": "@WeatherVane <code>%n</code> is special. <code>1 ==...</code> is correct."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1479325246, "post_id": 40640530, "comment_id": 68513740, "body": "@StoryTeller thanks missed that. I was wondering why you deleted a similar comment."}, {"owner": {"reputation": 21, "user_id": 7167837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96528873c8417de3e08153a3a2f51fef?s=128&d=identicon&r=PG&f=1", "display_name": "Tukkas", "link": "https://stackoverflow.com/users/7167837/tukkas"}, "edited": false, "score": 0, "creation_date": 1479325721, "post_id": 40640530, "comment_id": 68513995, "body": "Thank You all for the explanation!"}, {"owner": {"reputation": 11, "user_id": 7164811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c289ab54f993b2069777303595674b96?s=128&d=identicon&r=PG&f=1", "display_name": "kiwe", "link": "https://stackoverflow.com/users/7164811/kiwe"}, "edited": false, "score": 0, "creation_date": 1479348712, "post_id": 40640530, "comment_id": 68523114, "body": "you should check out @nmichaels answer: <a href=\"http://stackoverflow.com/questions/5008029/how-can-i-write-a-string-into-a-two-dimensional-array-in-c#5008067\" title=\"how can i write a string into a two dimensional array in c%235008067\">stackoverflow.com/questions/5008029/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 7167837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96528873c8417de3e08153a3a2f51fef?s=128&d=identicon&r=PG&f=1", "display_name": "Tukkas", "link": "https://stackoverflow.com/users/7167837/tukkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479323958, "creation_date": 1479323958, "question_id": 40640530, "link": "https://stackoverflow.com/questions/40640530/cant-figure-out-how-to-assign-a-word-from-char-array-to-another-2d-char-array", "title": "Can&#39;t figure out how to assign a word from char array to another 2D char array (C lang.)", "body": "<p>I'm trying to save a word from one char array to another 2D char array, but for some reason I get this error: \"assignment to expression with array type\". Does any of You know how to fix this? I'd be extremely thankful.</p>\n\n<p>I get the error at \"<code>Ats[kiekis] = Zodis;</code>\" and I pass arguments to function like this:</p>\n\n<p>\"<code>Palindromas(eilute, Zodis, Ats, kiekis);</code>\"`</p>\n\n<p>Function:</p>\n\n<pre><code>void Palindromas(char eilute[256], char Zodis[50], char Ats[20][60], int kiekis)\n{\n    int i, j, ilgis, l, Index;\n\nfor (i = 0; 1 == sscanf(eilute + i, \"%s%n\", Zodis, &amp;l); i =+ l)\n{\n    ilgis = strlen(Zodis);\n\n    Index = 1;\n\n    for (j = 0; j &lt; ilgis; j++)\n    {\n        if (Zodis[j] != Zodis[ilgis - j - 1])\n        {\n            Index = 0;\n            kiekis++;\n        }\n    }\n\n    if (Index == 1)\n    {\n        Ats[kiekis] = Zodis;\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c", "gstreamer"], "comments": [{"owner": {"reputation": 732, "user_id": 148173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd780d9709725de13bee7cf092f2ef?s=128&d=identicon&r=PG", "display_name": "chub", "link": "https://stackoverflow.com/users/148173/chub"}, "edited": false, "score": 0, "creation_date": 1479396278, "post_id": 40640414, "comment_id": 68548636, "body": "you could use audioparse to do the packetisation gst-launch-1.0 filesrc location=test.pcm  !  audioparse raw-format=s16le channels=2 rate=44100 format=raw  ! alsasink"}, {"owner": {"reputation": 1, "user_id": 7169212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2882dc7ab2c1fdf1f0a9c6663d6a6b?s=128&d=identicon&r=PG&f=1", "display_name": "SimonB", "link": "https://stackoverflow.com/users/7169212/simonb"}, "reply_to_user": {"reputation": 732, "user_id": 148173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd780d9709725de13bee7cf092f2ef?s=128&d=identicon&r=PG", "display_name": "chub", "link": "https://stackoverflow.com/users/148173/chub"}, "edited": false, "score": 0, "creation_date": 1479401412, "post_id": 40640414, "comment_id": 68552313, "body": "I think you misunderstood the problem. The file &#39;test.pcm&#39; is only used to demonstrate the use of Sound_WriteFrame(). There may not even be a local file."}, {"owner": {"reputation": 732, "user_id": 148173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd780d9709725de13bee7cf092f2ef?s=128&d=identicon&r=PG", "display_name": "chub", "link": "https://stackoverflow.com/users/148173/chub"}, "edited": false, "score": 0, "creation_date": 1479434216, "post_id": 40640414, "comment_id": 68567194, "body": "I think you misunderstood my answer ;-) , <a href=\"https://gstreamer.freedesktop.org/data/doc/gstreamer/head/gst-plugins-bad-plugins/html/gst-plugins-bad-plugins-rawaudioparse.html#GstRawAudioParse\" rel=\"nofollow noreferrer\">audioparse/rawaudioparse</a> ensure proper buffer size from data stream"}, {"owner": {"reputation": 1, "user_id": 7169212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2882dc7ab2c1fdf1f0a9c6663d6a6b?s=128&d=identicon&r=PG&f=1", "display_name": "SimonB", "link": "https://stackoverflow.com/users/7169212/simonb"}, "reply_to_user": {"reputation": 732, "user_id": 148173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd780d9709725de13bee7cf092f2ef?s=128&d=identicon&r=PG", "display_name": "chub", "link": "https://stackoverflow.com/users/148173/chub"}, "edited": false, "score": 0, "creation_date": 1479495407, "post_id": 40640414, "comment_id": 68598829, "body": "It was the &#39;filesrc&#39; part that got me thinking that, but perhaps you used that in order do demonstrate the audioparse bit?"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 6460902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e65723214ba1e6b29dd568fb5025410?s=128&d=identicon&r=PG", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/6460902/nicolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1479410846, "creation_date": 1479410846, "answer_id": 40663413, "question_id": 40640414, "link": "https://stackoverflow.com/questions/40640414/using-gstreamer-to-play-raw-pcm-data/40663413#40663413", "title": "Using GStreamer to play raw PCM-data", "body": "<p>You are using GStreamer 0.10 Caps fields in something that looks like GStreamer 1.0 Code. For you interest, width/depth/signed has been replaced by a single field called format. See the documentation for the complete list, the name in caps is the same as the enumeration, but without the namespace GST_AUDIO_FORMAT_.</p>\n\n<p><a href=\"https://gstreamer.freedesktop.org/data/doc/gstreamer/head/gst-plugins-base-libs/html/gst-plugins-base-libs-gstaudio.html#GstAudioFormat\" rel=\"nofollow noreferrer\">https://gstreamer.freedesktop.org/data/doc/gstreamer/head/gst-plugins-base-libs/html/gst-plugins-base-libs-gstaudio.html#GstAudioFormat</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7169212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f2882dc7ab2c1fdf1f0a9c6663d6a6b?s=128&d=identicon&r=PG&f=1", "display_name": "SimonB", "link": "https://stackoverflow.com/users/7169212/simonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 875, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479495799, "creation_date": 1479323579, "last_edit_date": 1479418097, "question_id": 40640414, "link": "https://stackoverflow.com/questions/40640414/using-gstreamer-to-play-raw-pcm-data", "title": "Using GStreamer to play raw PCM-data", "body": "<p>Ok, I have written some code below that is supposed to open and audio output device, and whenever actual PCM-data is available I would call Sound_WriteFrame() and pile up more data to be played.</p>\n\n<p>The data is raw, with no headers, so when I call Sound_Open() I pass this information to let GStreamer know what kind of data that will arrive.</p>\n\n<p>This code does not work - Frankly I have no idea what I am <em>doing</em>, I find GStreamer a bit difficult to work with, I would hope that could change eventually.</p>\n\n<p>I am using GStreamer 1.0. Help is appreciated.</p>\n\n<pre><code>#include &lt;gstreamer-1.0/gst/gst.h&gt;\n#include &lt;gstreamer-1.0/gst/gstelement.h&gt;\n#include &lt;gtk/gtk.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct _sound_t {\n    GstElement *source, *sink, *pipeline;\n    GMemoryInputStream *giostream;\n    GstPad *sourcepad;\n    GstCaps *gcaps;\n    int bDeviceOpen;\n} SOUND_CTX;\n\nint Sound_Close(SOUND_CTX *p){\n    printf(\"Closing\\n\");\n    gst_element_set_state(p-&gt;pipeline, GST_STATE_NULL);\n    return 1;\n}\n\nvoid Sound_SetState(SOUND_CTX *p, GstState state){\n    GstStateChangeReturn r = gst_element_set_state(p-&gt;pipeline, state);\n    switch(r){\n        case GST_STATE_CHANGE_FAILURE: printf(\"GST_STATE_CHANGE_FAILURE\\n\"); break;\n        case GST_STATE_CHANGE_SUCCESS: printf(\"GST_STATE_CHANGE_SUCCESS\\n\"); break;\n        case GST_STATE_CHANGE_ASYNC: printf(\"GST_STATE_CHANGE_ASYNC\\n\"); break;\n        case GST_STATE_CHANGE_NO_PREROLL: printf(\"GST_STATE_CHANGE_NO_PREROLL\\n\"); break;\n        default: printf(\"Unknown state\\n\"); break;\n    }\n    return;\n}\n\nint Sound_Open(SOUND_CTX *p, int nSamplesPerSec, int nChannels){\n\n    p-&gt;source = gst_element_factory_make(\"giostreamsrc\", \"source\");\n    p-&gt;giostream = G_MEMORY_INPUT_STREAM(g_memory_input_stream_new());\n    g_object_set(G_OBJECT(p-&gt;source), \"stream\", G_INPUT_STREAM(p-&gt;giostream), NULL);\n    p-&gt;sourcepad = gst_element_get_static_pad(p-&gt;source, \"src\");\n\n    p-&gt;gcaps = gst_caps_new_simple(\n        \"audio/x-raw\",\n        \"rate\", G_TYPE_INT, nSamplesPerSec,\n        \"channels\", G_TYPE_INT, nChannels,\n        \"width\", G_TYPE_INT, 16,\n        \"depth\", G_TYPE_INT, 16,\n        \"signed\", G_TYPE_BOOLEAN, TRUE,\n        NULL\n    );\n\n    gst_pad_set_caps(p-&gt;sourcepad, p-&gt;gcaps);\n    gst_object_unref(p-&gt;sourcepad);\n\n    p-&gt;sink = gst_element_factory_make(\"alsasink\", \"sink\");\n    p-&gt;pipeline = gst_pipeline_new(\"pipeline_name\");\n    gst_bin_add_many(GST_BIN(p-&gt;pipeline), p-&gt;source, p-&gt;sink, NULL);\n    gst_element_link_many(p-&gt;source, p-&gt;sink, NULL);\n\n    Sound_SetState(p, GST_STATE_PLAYING);\n\n    return 1;\n}\n\nint Sound_WriteFrame(SOUND_CTX *p, void *lpData, unsigned int size){\n    g_memory_input_stream_add_data(\n        G_MEMORY_INPUT_STREAM(p-&gt;giostream),\n        lpData, size, NULL\n    );\n    return 0;\n}\n\nint timer_callback(const void *data){\n    g_main_loop_quit((GMainLoop *)data);\n    return FALSE;\n}\n\n\n\nint main(int argc, char *argv[]){\n    gst_init(&amp;argc, &amp;argv);\n    GMainLoop *loop = NULL;\n    SOUND_CTX a;\n    memset(&amp;a, 0x00, sizeof(SOUND_CTX));\n    if(Sound_Open(&amp;a, 44100, 2)){\n        FILE *handle;\n        unsigned char tmp[4096];\n        if((handle = fopen(\"test.pcm\", \"rb\")) != NULL){\n            while(fread(tmp, 1, sizeof(tmp), handle) == sizeof(tmp)){\n                Sound_WriteFrame(&amp;a, tmp, sizeof(tmp));\n            }\n            fclose(handle);\n        }\n    }\n\n    loop = g_main_loop_new(NULL, FALSE);\n    g_timeout_add(5500, (GSourceFunc)timer_callback, loop);\n    g_main_loop_run(loop);\n    Sound_Close(&amp;a);\n    g_main_loop_unref(loop);\n\n    return 0;\n}\n</code></pre>\n\n<p>Ok, so here is an updated source, there is however no sound coming out of the speakers</p>\n\n<pre><code>#include &lt;gstreamer-1.0/gst/gst.h&gt;\n#include &lt;gstreamer-1.0/gst/gstelement.h&gt;\n#include &lt;gstreamer-1.0/gst/app/gstappsrc.h&gt;\n#include &lt;gtk/gtk.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct _sound_t {\n    GstElement *sink, *pipeline;\n    GstAppSrc *src;\n    GstCaps *pcm_caps;\n} SOUND_CTX;\n\nint Sound_Close(SOUND_CTX *p){\n    printf(\"Closing\\n\");\n    gst_element_set_state(p-&gt;pipeline, GST_STATE_NULL);\n    return 1;\n}\n\nvoid Sound_SetState(SOUND_CTX *p, GstState state){\n    GstStateChangeReturn r = gst_element_set_state(p-&gt;pipeline, state);\n    switch(r){\n        case GST_STATE_CHANGE_FAILURE: printf(\"GST_STATE_CHANGE_FAILURE\\n\"); break;\n        case GST_STATE_CHANGE_SUCCESS: printf(\"GST_STATE_CHANGE_SUCCESS\\n\"); break;\n        case GST_STATE_CHANGE_ASYNC: printf(\"GST_STATE_CHANGE_ASYNC\\n\"); break;\n        case GST_STATE_CHANGE_NO_PREROLL: printf(\"GST_STATE_CHANGE_NO_PREROLL\\n\"); break;\n        default: printf(\"Unknown state\\n\"); break;\n    }\n    return;\n}\n\nint Sound_Open(SOUND_CTX *p, int nSamplesPerSec, int nChannels){\n\n    p-&gt;pipeline = gst_pipeline_new(\"pipeline_name\");\n    p-&gt;sink = gst_element_factory_make(\"alsasink\", \"sink\");\n\n    p-&gt;src = (GstAppSrc*) gst_element_factory_make(\"appsrc\", \"source\");\n    gst_app_src_set_stream_type(p-&gt;src, GST_APP_STREAM_TYPE_STREAM);\n\n    // I am hardcoding the format, channels, and rate for now\n    p-&gt;pcm_caps = gst_caps_from_string(\"audio/x-raw,format=S16LE,rate=44100,channels=2\");\n    gst_app_src_set_caps(p-&gt;src, p-&gt;pcm_caps);\n\n    gst_bin_add_many(GST_BIN(p-&gt;pipeline), (GstElement*)p-&gt;src, p-&gt;sink, NULL);\n    gst_element_link_many((GstElement*)p-&gt;src, p-&gt;sink, NULL);\n\n    Sound_SetState(p, GST_STATE_PLAYING);\n\n    return 1;\n}\n\nint Sound_WriteFrame(SOUND_CTX *p, void *lpData, unsigned int size){\n    GstBuffer *buf = NULL;\n    void *lpHeapData = NULL;\n    if((lpHeapData = g_malloc(size)) == NULL) return 0;\n    memcpy(lpHeapData, lpData, size);\n    buf = gst_buffer_new_wrapped(lpHeapData, size);\n    if(buf == NULL){\n        g_free(lpHeapData);\n        return 0;\n    }\n    gst_app_src_push_buffer(p-&gt;src, buf);\n    return 0;\n}\n\nint timer_callback(const void *data){\n    g_main_loop_quit((GMainLoop *)data);\n    return FALSE;\n}\n\n\n\nint main(int argc, char *argv[]){\n    gst_init(&amp;argc, &amp;argv);\n    GMainLoop *loop = NULL;\n    SOUND_CTX a;\n    memset(&amp;a, 0x00, sizeof(SOUND_CTX));\n    if(Sound_Open(&amp;a, 44100, 2)){\n        FILE *handle;\n        unsigned char tmp[4096];\n        if((handle = fopen(\"test.pcm\", \"rb\")) != NULL){\n            while(fread(tmp, 1, sizeof(tmp), handle) == sizeof(tmp)){\n                Sound_WriteFrame(&amp;a, tmp, sizeof(tmp));\n            }\n            fclose(handle);\n        }\n    }\n\n    loop = g_main_loop_new(NULL, FALSE);\n    g_timeout_add(5500, (GSourceFunc)timer_callback, loop);\n    g_main_loop_run(loop);\n    Sound_Close(&amp;a);\n    g_main_loop_unref(loop);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "switch-statement"], "comments": [{"owner": {"reputation": 774, "user_id": 1953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38132eb8b7c38897f20a82f5274a79ba?s=128&d=identicon&r=PG", "display_name": "Muzer", "link": "https://stackoverflow.com/users/1953158/muzer"}, "edited": false, "score": 3, "creation_date": 1479322088, "post_id": 40639923, "comment_id": 68511973, "body": "You&#39;re missing <code>break</code>s in the <code>inverseescape</code> case statement."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1479322436, "post_id": 40639923, "comment_id": 68512173, "body": "the function: <code>getline()</code> is a well known system function, exposed in the stdio.h header file.  it has the syntax: <code>ssize_t getline(char **lineptr, size_t *n, FILE *stream);</code>   Strongly suggest using a unique name for your function."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 774, "user_id": 1953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38132eb8b7c38897f20a82f5274a79ba?s=128&d=identicon&r=PG", "display_name": "Muzer", "link": "https://stackoverflow.com/users/1953158/muzer"}, "edited": false, "score": 0, "creation_date": 1479322511, "post_id": 40639923, "comment_id": 68512235, "body": "@Muzer Im so dumb... First time using switch.... Thanks for the help."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1479322556, "post_id": 40639923, "comment_id": 68512256, "body": "@user3629249 I will keep that in mind."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "reply_to_user": {"reputation": 774, "user_id": 1953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38132eb8b7c38897f20a82f5274a79ba?s=128&d=identicon&r=PG", "display_name": "Muzer", "link": "https://stackoverflow.com/users/1953158/muzer"}, "edited": false, "score": 0, "creation_date": 1479322598, "post_id": 40639923, "comment_id": 68512283, "body": "@Muzer Could you post it as answer so i can mark your answer as &quot;answer&quot; ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1479322602, "post_id": 40639923, "comment_id": 68512284, "body": "suggest replacing the call to <code>getline()</code> with a call to <code>fgets()</code> then removing the function: <code>getline()</code> from your code"}, {"owner": {"reputation": 774, "user_id": 1953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38132eb8b7c38897f20a82f5274a79ba?s=128&d=identicon&r=PG", "display_name": "Muzer", "link": "https://stackoverflow.com/users/1953158/muzer"}, "edited": false, "score": 0, "creation_date": 1479322814, "post_id": 40639923, "comment_id": 68512409, "body": "@MuhamedCicak done."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1482229911, "post_id": 40639923, "comment_id": 69679825, "body": "I strongly recommend you to familiarize with a debugger. Once you step through your unescaping function (a string as simple as <code>&quot;\\n&quot;</code> will be enough), you&#39;ll clearly see all the mistakes you made."}, {"owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "edited": false, "score": 0, "creation_date": 1482429860, "post_id": 40639923, "comment_id": 69780810, "body": "Thank you for the recommendation. Actually, i am using debugger a lot (now). But i wasn&#39;t when i asked this question. And it is a lot easier to find this kinds of bugs (than asking on stackoverflow)."}], "answers": [{"tags": [], "owner": {"reputation": 774, "user_id": 1953158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38132eb8b7c38897f20a82f5274a79ba?s=128&d=identicon&r=PG", "display_name": "Muzer", "link": "https://stackoverflow.com/users/1953158/muzer"}, "is_accepted": true, "score": 2, "last_activity_date": 1479322799, "creation_date": 1479322799, "answer_id": 40640187, "question_id": 40639923, "link": "https://stackoverflow.com/questions/40639923/kr-book-3-2-exercise-escape-function/40640187#40640187", "title": "K&amp;R Book 3-2 Exercise (escape function)", "body": "<p>You're missing the <code>break</code> in the <code>inverseescape</code> case statement. <code>case</code>'s behaviour has the curious property of <em>falling through</em> to the statement below unless you explicitly <code>break</code> out of the <code>case</code>. In this case it's falling through to your <code>default</code> case and setting the output to the input.</p>\n"}], "owner": {"reputation": 1181, "user_id": 5911206, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QTN3f.jpg?s=128&g=1", "display_name": "Silidrone", "link": "https://stackoverflow.com/users/5911206/silidrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 40640187, "answer_count": 1, "score": 0, "last_activity_date": 1479328104, "creation_date": 1479321985, "last_edit_date": 1592644375, "question_id": 40639923, "link": "https://stackoverflow.com/questions/40639923/kr-book-3-2-exercise-escape-function", "title": "K&amp;R Book 3-2 Exercise (escape function)", "body": "<blockquote>\n<p>Write a function escape(s,t) that converts characters like newline and\ntab into visible escape sequences like \\n and \\t as it copies the\nstring t to s. Use a switch. Write a function for the other direction\nas well, converting escape sequences into the real characters.</p>\n</blockquote>\n<p>This is the Exercise 3-2 from K&amp;R book. So I tried to do it. My escape function works properly. But my inverseescape is giving me the same answer as the escape function is giving. Here is the code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#define MCC 100\n\nvoid espace(int* str,int* t);\nvoid inverseescape(int * str,int *t);\nvoid getline(int*);\n\nint main(void){\n    int firstarr[MCC];\n    int secondarr[MCC];\n    int thirdarr[MCC];\n    getline(firstarr);\n    espace(firstarr,secondarr);\n    printf(&quot;-----------AFTER ESCAPE------------\\n&quot;);\n    for(int g=0;secondarr[g];g++){\n        printf(&quot;%c&quot;,secondarr[g]);\n    }\n    inverseescape(secondarr,thirdarr);\n    printf(&quot;\\n-----------AFTER INVERSEESCAPE------------\\n&quot;);\n    for(int g=0;thirdarr[g];g++){\n        printf(&quot;%c&quot;,thirdarr[g]);\n    }\n    return 0;\n}\n\nvoid getline(int* arr){\n    int i=0;\n    int c=0;\n    while((c=getchar())!=EOF){\n        arr[i]=c;\n        arr[i+1]=0;\n        i++;\n    }\n}\n\nvoid espace(int* string,int* target){\n    int i = 0;\n    int j = 0;\n    while(string[i]){\n        switch(string[i]){\n            case '\\a':\n                target[j]='\\\\';\n                target[++j]='a';\n                target[++j]=0;\n                break;\n            case '\\b':\n                target[j]='\\\\';\n                target[++j]='b';\n                target[++j]=0;\n                break;\n            case '\\t':\n                target[j]='\\\\';\n                target[++j]='t';\n                target[++j]=0;\n                break;\n            case '\\n':\n                target[j]='\\\\';\n                target[++j]='n';\n                target[++j]=0;\n                break;\n            case '\\v':\n                target[j]='\\\\';\n                target[++j]='v';\n                target[++j]=0;\n                break;\n            case '\\f':\n                target[j]='\\\\';\n                target[++j]='f';\n                target[++j]=0;\n                break;\n            case '\\r':\n                target[j]='\\\\';\n                target[++j]='r';\n                target[++j]=0;\n                break;\n            case '\\&quot;':\n                target[j]='\\\\';\n                target[++j]='\\&quot;';\n                target[++j]=0;\n                break;\n            case '\\'':\n                target[j]='\\\\';\n                target[++j]='\\'';\n                target[++j]=0;\n                break;\n            case '\\?':\n                target[j]='\\\\';\n                target[++j]='\\?';\n                target[++j]=0;\n                break;\n            case '\\\\':\n                target[j]='\\\\';\n                target[++j]='\\\\';\n                target[++j]=0;\n                break;\n            default:\n                target[j]=string[i];\n                target[++j]=0;\n                break;\n        }\n        i++;\n    }\n}\n\nvoid inverseescape(int* string,int* target){\n    int i = 0;\n    while(string[i]){\n        switch(string[i]){\n            case '\\\\':\n            switch(string[i+1]){\n                case 'a':\n                target[i]='\\a';\n                case 'b':\n                target[i]='\\b';\n                case 't':\n                target[i]='\\t';\n                case 'n':\n                target[i]='\\n';\n                case 'v':\n                target[i]='\\v';\n                case 'f':\n                target[i]='\\f';\n                case 'r':\n                target[i]='\\r';\n                case '\\&quot;':\n                target[i]='\\&quot;';\n                case '\\'':\n                target[i]='\\'';\n                case '\\?':\n                target[i]='\\?';\n                case '\\\\':\n                target[i]='\\\\';\n            }\n            default:\n            target[i]=string[i];\n        }\n        target[++i]=0;\n    }\n}\n</code></pre>\n<p>I am using switch statement first time (and probably last) so the code is not well-written (i guess).</p>\n<p>Input:</p>\n<blockquote>\n<p>shadow</p>\n<p>of</p>\n<p>the</p>\n<p>beast</p>\n</blockquote>\n<p>Output:</p>\n<blockquote>\n<p>-----------AFTER ESCAPE------------</p>\n<p>shadow\\nof\\nthe\\nbeast</p>\n<p>-----------AFTER INVERSEESCAPE------------</p>\n<p>shadow\\nof\\nthe\\nbeast</p>\n</blockquote>\n"}, {"tags": ["c", "string", "function", "find", "substring"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479322008, "post_id": 40639901, "comment_id": 68511923, "body": "Shouldn&#39;t the index in <code>&quot;hotdog&quot;</code> be <code>3</code>? Array indices in C start at <code>0</code>. This would be in tune with library functions such as <code>strcspn</code> which return an index into a string."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1479322066, "post_id": 40639901, "comment_id": 68511961, "body": "@user6913230  Are you from Canada Ontario?:)"}], "owner": {"user_type": "does_not_exist", "display_name": "user6913230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1479322159, "answer_count": 0, "score": 0, "last_activity_date": 1479321913, "creation_date": 1479321913, "question_id": 40639901, "link": "https://stackoverflow.com/questions/40639901/a-c-function-to-find-the-first-occurence-of-a-substring", "closed_reason": "Duplicate", "title": "A C function to find the first occurence of a substring", "body": "<p>HI there so I am trying to write a function that can find the first occurrence and that will return an integer that represents the index of the substring that is found. so for instance if the substring i was trying to find is 'dog' and the string is 'hotdog' it would return 4. if no substring is found, then it should return -1. also no using the function strstr. This is the function im working with</p>\n\n<pre><code>int findSubString(char original[], char toFind(){\n</code></pre>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1479321402, "post_id": 40639720, "comment_id": 68511591, "body": "So what is the problem?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479321578, "post_id": 40639720, "comment_id": 68511685, "body": "Please take note of compiler warnings: you have missed <code>#include &lt;stdlib.h&gt;</code> and <code>#include &lt;conio.h&gt;</code>."}, {"owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 0, "creation_date": 1479321614, "post_id": 40639720, "comment_id": 68511703, "body": "it just wait ,to press a key i want it to print infinite times and end when i pressed the fixed key char in this case &#39;n&#39; :)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479321657, "post_id": 40639720, "comment_id": 68511730, "body": "Then have a look at <code>kbhit()</code> function. When it returns non-0, you can then call <code>getch</code> non-blocking."}, {"owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 0, "creation_date": 1479322053, "post_id": 40639720, "comment_id": 68511954, "body": "sir,i tried using it ,but didn&#39;t worked out (this was question asked me in my test couple of days back we have not yet taught the kbhit() function  and i&#39;m pretty sure the teacher didn&#39;t want us to do it that way) is there any else way we have been taught  getch,putchar,getche function. Thanks for your time:)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479322357, "post_id": 40639720, "comment_id": 68512124, "body": "Not unless you can find a way to change keyboard input to non-blocking, which I suspect you won&#39;t be expected to do. If you have <code>conio</code> then <code>kbhit</code> is provided exactly for your needs."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479322458, "post_id": 40639720, "comment_id": 68512193, "body": "Your additional requirement in comments is unclear: do you want <code>Hello</code> to be printed infinite times while the program is waiting for a key to be pressed?"}, {"owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 0, "creation_date": 1479323575, "post_id": 40639720, "comment_id": 68512843, "body": "Thanks you very much :) vane and anon"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479324694, "post_id": 40639720, "comment_id": 68513445, "body": "This is not possible with the standard C library."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 0, "creation_date": 1479324287, "post_id": 40640256, "comment_id": 68513239, "body": "while(!kbhit()) what does this &quot;!&quot; means"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 1, "creation_date": 1479324334, "post_id": 40640256, "comment_id": 68513263, "body": "It means <code>while(kbhit() == 0)</code>. The <code>!</code> is a boolean <code>NOT</code> operator. In other words, not true, in this case true is any non-zero value which is returned by <code>kbhit()</code> when a key is waiting to be read. In C, any non-0 value is implicitly true, and 0 is false."}, {"owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "edited": false, "score": 1, "creation_date": 1479324660, "post_id": 40640256, "comment_id": 68513429, "body": "Thank you so much appreciate it."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1479323019, "creation_date": 1479323019, "answer_id": 40640256, "question_id": 40639720, "link": "https://stackoverflow.com/questions/40639720/infinite-loop-till-key-pressed/40640256#40640256", "title": "Infinite loop till key pressed", "body": "<p>This is a little different, to show you a simple solution. But if you are not allowed to use <code>kbhit</code> you are stuck.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;              // include the library header\n\nint main(void)                  // correct signature for main\n{\n    int c = 0;                  // note getch() returns `int` type\n    while(c != 'n')             // until correct key is pressed\n    {\n        do {                    // forever\n            printf(\"Hello\\n\");\n        } while(!kbhit());      // until a key press detected\n        c = getch();            // fetch that key press\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Remember, it only tests for lower-case <code>n</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 5405158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf7ae818548c0ff2e0c021a38b2f46b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sir Barksalot", "link": "https://stackoverflow.com/users/5405158/sir-barksalot"}, "is_accepted": false, "score": 0, "last_activity_date": 1479323951, "last_edit_date": 1479323951, "creation_date": 1479323300, "answer_id": 40640327, "question_id": 40639720, "link": "https://stackoverflow.com/questions/40639720/infinite-loop-till-key-pressed/40640327#40640327", "title": "Infinite loop till key pressed", "body": "<p>Try this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\nint main(void) {\n    char c='y';\n    while(c!='n') {\n        while(!kbhit()) {\n            printf(\"Hello\\n\");\n        }\n        c=getch();\n    }\n}\n</code></pre>\n\n<p>Please note that I have not compiled this as <i>conio.h</i> is not available to me right now.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1479323883, "last_edit_date": 1479323883, "creation_date": 1479323366, "answer_id": 40640350, "question_id": 40639720, "link": "https://stackoverflow.com/questions/40639720/infinite-loop-till-key-pressed/40640350#40640350", "title": "Infinite loop till key pressed", "body": "<p>the posted code does not compile!</p>\n\n<p>The following code will do the job.</p>\n\n<p>Notice that the <code>goto</code> is eliminated</p>\n\n<p>Notice that the unneeded variables are eliminated</p>\n\n<p>Notice that the appropriate header files are included</p>\n\n<p>Notice the signature for the main() function is corrected</p>\n\n<pre><code>#include &lt;stdio.h&gt; // printf()\n#include &lt;conio.h&gt; // getch() kbhit() &lt;-- use correct header file\n\nint main( void )          // &lt;-- use valid signature\n{\n                          // &lt;-- eliminate unneeded variables\n    while(1)              // &lt;-- non-confusing (and simple) loop statement\n    {\n        printf(\"Hello\\n\");\n\n        if( kbhit() )\n        { // then some key has been pressed\n            if( 'n' == getch() )\n            { // then 'n' key has been pressed\n                break;        // &lt;-- exit the loop\n            }\n        }\n    }\n} // end function: main\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7049372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2274c82604a3c317cdac2bce9d07370e?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7049372/maddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "accepted_answer_id": 40640256, "answer_count": 3, "score": 0, "last_activity_date": 1479326079, "creation_date": 1479321298, "last_edit_date": 1479326079, "question_id": 40639720, "link": "https://stackoverflow.com/questions/40639720/infinite-loop-till-key-pressed", "title": "Infinite loop till key pressed", "body": "<pre><code>#include &lt;stdio.h&gt;\nvoid main()\n{\n    int a=1;\n    char c;\n    x:for(a=1;a!=0;a++)\n    {\n        printf(\"Hello\\n\");\n        c=getch();\n        if(c=='n')\n            exit(0);\n        else\n            goto x;\n    }\n}\n</code></pre>\n\n<p>//please assist me with this program by using primary operators only  </p>\n"}, {"tags": ["c", "memory", "memory-management", "linux-kernel", "kmalloc"], "comments": [{"owner": {"reputation": 62518, "user_id": 469300, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f8256aabf1f8938bc2356b1fbeb227f4?s=128&d=identicon&r=PG", "display_name": "slezica", "link": "https://stackoverflow.com/users/469300/slezica"}, "edited": false, "score": 0, "creation_date": 1479321113, "post_id": 40639615, "comment_id": 68511458, "body": "Welcome to StackOverflow! I added some space to your question, and made the title slightly more telling. Hope you don&#39;t mind the edits"}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1479321254, "post_id": 40639615, "comment_id": 68511531, "body": "<a href=\"https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt\" rel=\"nofollow noreferrer\">Hugepages</a>?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1479345831, "post_id": 40639615, "comment_id": 68522371, "body": "You left it unstated, and it may be obvious to some people, but you&#39;re looking for <i>physical</i> memory that is contiguous, rather than <i>virtual</i> memory.  The distinction is important."}, {"owner": {"reputation": 19, "user_id": 3008394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c383593bb1974e91f01209952c2ca8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/3008394/kanishka"}, "edited": false, "score": 0, "creation_date": 1479362270, "post_id": 40639615, "comment_id": 68526780, "body": "I meant, I cannot split the individual  chunks into smaller size that I can get using kernel mallocs."}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1479367057, "post_id": 40639615, "comment_id": 68528973, "body": "<i>&quot;I meant, I cannot split the individual chunks ...&quot;</i> -- No, that does not clarify your intentions.  <i>&quot;are there inbuilt functions to manage this allocated memory&quot;</i> -- Why would you have a driver allocate so much memory that it has to be <i>&quot;managed&quot;</i>?  BTW your consistent avoidance of (or failure to) distinguishing between virtual or physical memory in your SO posts is troubling."}, {"owner": {"reputation": 19, "user_id": 3008394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c383593bb1974e91f01209952c2ca8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/3008394/kanishka"}, "edited": false, "score": 0, "creation_date": 1479720164, "post_id": 40639615, "comment_id": 68660374, "body": "I need physically contiguous memory not virtual, and in case of my driver currently its creating multiple thousand entries (@time of IO) almost in parallel throughout execution. Currently I am managing it using a pool of my data structure, but I want to see if using a huge chunk of physically contiguous memory would improve its performance, which theoretically should happen."}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1496143837, "post_id": 40639615, "comment_id": 75529881, "body": "@Kanishka I would love to know why you need these massive multiple chunks of continuous memory.  Is it because network packets appear in memory faster than they can be processed?"}, {"owner": {"reputation": 19, "user_id": 3008394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c383593bb1974e91f01209952c2ca8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/3008394/kanishka"}, "edited": false, "score": 0, "creation_date": 1497531869, "post_id": 40639615, "comment_id": 76125067, "body": "My application has two parts, once the system has come up and all the drivers are in place first part of my app takes up almost all the memory to manage it by itself. due to this second part where the new network driver needed kmalloc&#39;d memory in run time fails. I was trying to create a pool out of this kmalloc&#39;d memory before the other part claims all that is left."}, {"owner": {"reputation": 19, "user_id": 3008394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c383593bb1974e91f01209952c2ca8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/3008394/kanishka"}, "edited": false, "score": 0, "creation_date": 1497532107, "post_id": 40639615, "comment_id": 76125255, "body": "As of now I have found a brute force approach to get this chunk bymaking sure the kmalloc&#39;d memory address is contiguous. So its working for now but I am open to any better solution."}], "owner": {"reputation": 19, "user_id": 3008394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c383593bb1974e91f01209952c2ca8ad?s=128&d=identicon&r=PG&f=1", "display_name": "Kanishka", "link": "https://stackoverflow.com/users/3008394/kanishka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479346370, "creation_date": 1479320958, "last_edit_date": 1479346370, "question_id": 40639615, "link": "https://stackoverflow.com/questions/40639615/driver-requires-large-chunks-of-contiguous-physical-memory", "title": "Driver requires large chunks of contiguous physical memory", "body": "<p>I need to modify a network adapter driver to increase its performance for my use, and I need a huge physical memory chunk to be contiguous.</p>\n\n<p>I will need several of these chunks based on the number of ports.  Each chunk should be around 64MB.</p>\n\n<p>Currently I am looking at my option to be CMA and bootmem.   </p>\n\n<p>Is there any other option for same and I haven't used any of it till date so can someone give me a direction on how to use it? as in are there inbuilt functions to manage this allocated memory or will I have to manage it all in my driver?</p>\n"}, {"tags": ["c", "function", "choice"], "comments": [{"owner": {"reputation": 1087, "user_id": 6735993, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4VUOVvCKbP4/AAAAAAAAAAI/AAAAAAAAADM/bX54ajsqcOE/photo.jpg?sz=128", "display_name": "Hypnic Jerk", "link": "https://stackoverflow.com/users/6735993/hypnic-jerk"}, "edited": false, "score": 0, "creation_date": 1479320706, "post_id": 40639482, "comment_id": 68511258, "body": "You will need to <code>scanf</code> for the user input, and based on that input, <code>if(userInput == 1)</code>, call the function that corresponds to it."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 1, "creation_date": 1479323326, "post_id": 40639565, "comment_id": 68512692, "body": "This is exactly what I needed.  Thank you very much. Everything is working perfectly now!"}], "tags": [], "owner": {"reputation": 26971, "user_id": 3073272, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hofYF.jpg?s=128&g=1", "display_name": "GorvGoyl", "link": "https://stackoverflow.com/users/3073272/gorvgoyl"}, "is_accepted": true, "score": 0, "last_activity_date": 1479320798, "creation_date": 1479320798, "answer_id": 40639565, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options/40639565#40639565", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>you should use Switch case.</p>\n\n<pre><code>    switch(choice) {\n     case 1: //first for loop\n     break;\n     case 2: //second for loop\n     break;\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 0, "creation_date": 1479323278, "post_id": 40639574, "comment_id": 68512668, "body": "Thank you! That line was very helpful."}, {"owner": {"reputation": 563, "user_id": 1092688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc131329fdd2933c5b1ab7c9bd07f5ab?s=128&d=identicon&r=PG", "display_name": "Eric M.", "link": "https://stackoverflow.com/users/1092688/eric-m"}, "reply_to_user": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "edited": false, "score": 0, "creation_date": 1479323686, "post_id": 40639574, "comment_id": 68512895, "body": "@MissAnnThropic I&#39;m glad. Still, you should implement the functions like I and other suggested or you&#39;re not going to get full credit :)"}], "tags": [], "owner": {"reputation": 563, "user_id": 1092688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc131329fdd2933c5b1ab7c9bd07f5ab?s=128&d=identicon&r=PG", "display_name": "Eric M.", "link": "https://stackoverflow.com/users/1092688/eric-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1479320832, "creation_date": 1479320832, "answer_id": 40639574, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options/40639574#40639574", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>Looks like you are missing a couple of points here. Firstly, you have not yet written any functions. Try looking <a href=\"https://www.tutorialspoint.com/cprogramming/c_functions.htm\" rel=\"nofollow noreferrer\">here</a> to gain some insight on that front.</p>\n\n<p>Secondly, to make a choice based on user input you need to actually get that input somehow. You'll probably want to use <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_scanf.htm\" rel=\"nofollow noreferrer\">scanf</a>.</p>\n\n<p>Lastly, once you have the user's input (say, in a variable declared as <code>int input;</code>) you can use <a href=\"https://www.tutorialspoint.com/cprogramming/if_else_statement_in_c.htm\" rel=\"nofollow noreferrer\">if</a> to control the flow of your program based on that variable like this:</p>\n\n<pre><code>if(input == 1){\n    greet();\n}\nelse {\n    countDown();\n}\n</code></pre>\n\n<p>Cheers! If you have any further questions feel free to comment below.</p>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 2915499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whqGg.jpg?s=128&g=1", "display_name": "Azade Farshad", "link": "https://stackoverflow.com/users/2915499/azade-farshad"}, "is_accepted": false, "score": 2, "last_activity_date": 1479321136, "creation_date": 1479321136, "answer_id": 40639678, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options/40639678#40639678", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>You should read the input from user's keyboard:</p>\n\n<pre><code>int c;\nc = getchar();\nif (c == '1')\n{\n// display greeting and name 4 times\nfor(i=1;i&lt;=4;i++)\n{\n    printf(\"Hi, my name is Bridget\\n\");\n}\n}\nif (c == '2')\n{\n// display countdown\nfor(i=10;i&gt;=0;--i)\n{\n    printf(\"%d\\n\", i);\n}\n}\nprintf(\"Blastoff!\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 5857961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/93ba2c3b5a8e2b0e119a11d9be8847b3?s=128&d=identicon&r=PG", "display_name": "Akaitenshi", "link": "https://stackoverflow.com/users/5857961/akaitenshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1479322645, "last_edit_date": 1479322645, "creation_date": 1479322250, "answer_id": 40640018, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options/40640018#40640018", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>First of all you haven't actually declared you functions. Functions in C should be declared like the <code>main</code> function is. For more info in this see <a href=\"https://www.tutorialspoint.com/cprogramming/c_functions.htm\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>// display greeting and name 4 times\nvoid greeting(){\n    for(i=1;i&lt;=4;i++)\n    {\n        printf(\"Hi, my name is Bridget\\n\");\n    }\n}\n\nvoid countdown() {\n// display countdown\n    for(i=10;i&gt;=0;--i)\n    {\n        printf(\"%d\\n\", i);\n    }\n        printf(\"Blastoff!\");\n}\n</code></pre>\n\n<p>To get the user's input the most common way is by keyboard. <code>scanf</code> accomplishes that in C. Details on <code>scanf</code> <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_scanf.htm\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>int main(void){\n  int i, choice;\n\n  //prompt the user to make a choice\n  // You don't need 2 printf for the newlines stick them to one.\n  printf(\"What would you like to do?\\n  1. Print my name\\n  2. Count down from 10\\n\\n\");\n\n  //This takes the user's input and puts it in the variable choice\n  scanf(%d, &amp;choice);\n}\n</code></pre>\n\n<p>Lastly to decide what to do based on the user input you can use either an <code>if then else</code> statement or a <code>switch</code>. I will provide a solution with an <code>if</code> statement and you can figure the one with the <code>switch</code> on your own. Your final code should look like this.</p>\n\n<pre><code>int main(void){\n    int i, choice;\n\n    //prompt the user to make a choice\n    // You don't need 2 printf for the newlines stick them to one.\n    printf(\"What would you like to do?\\n  1. Print my name\\n  2. Count down from 10\\n\\n\");\n\n    //This takes the user's input and puts it in the variable choice\n    scanf(%d, &amp;choice);\n\n    if(choice == 1){\n      greeting();\n    }else{\n      countdown();\n    }\n}\n\n// display greeting and name 4 times\nvoid greeting(){\n    for(i=1;i&lt;=4;i++)\n    {\n        printf(\"Hi, my name is Bridget\\n\");\n    }\n}\n\nvoid countdown() {\n// display countdown\n    for(i=10;i&gt;=0;--i)\n    {\n        printf(\"%d\\n\", i);\n    }\n        printf(\"Blastoff!\");\n} \n</code></pre>\n\n<p>Bear in mind that this code has a lot of flaws (error checking mainly) but I guess your assigment is not about that.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 3821972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/57CKU.jpg?s=128&g=1", "display_name": "Kedriik", "link": "https://stackoverflow.com/users/3821972/kedriik"}, "is_accepted": false, "score": 0, "last_activity_date": 1479323982, "last_edit_date": 1479323982, "creation_date": 1479323527, "answer_id": 40640405, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options/40640405#40640405", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>First of all you need to include libraries with function you will need. You do this by </p>\n\n<pre><code>#include &lt;someLibrary.h&gt;\n</code></pre>\n\n<p>at the beggining of you document. Libraries mostly have .h extension. Always look for them if you try to do something. You consider them to have best performance and functionality as possible (not always true). </p>\n\n<p>What is next you declare your functions. Function has name, arguments which are going into it, body in which they do something and return value (can be float, int, char etc). If function doesnt return anything, they return void (dont have <strong><em>return</em></strong> at the end). You declare functions before <strong><em>main()</em></strong> with only types of arguments. Whole body is after main (it is better looking). </p>\n\n<p>If you declared function with arguments, you have to provide these arguments to function in () brackets. Even if no arguments are needed, you use them like <strong><em>getch()</em></strong> in example below. Note that function become what it return. If you declared some new variables in function they will be visible only in function. On the other hand function will not see any variable from other function (main too). If you want so, declare global variables (not recommended).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;  //libraries\n\nvoid function1(int);\nfloat function2(float);  //declaration of functions\n\nint main()\n{   \nchar decision;\nprintf(\"press 'a' to run function1, press 'b' to run function2\\n\");\ndecision=getch();     //first see getch()? look in google for functionality and library !\n    int someInt=10;\n    float someFloat=11;\n\n     if(decision== 'a')\n    {\n     function1(someInt);\n    }\n    else if(decision == 'b')\n    {\n     printf(\"%f\", funcion2(someFloat));  //example that function become what    they return\n    }\n    else \n    {\n     printf(\"No decision has been made\");\n    }\ngetch();   //program will wait for any key press\nreturn 0;\n}\n\nvoid function1(int param1)\n{\n  //print your stuff               // this function return void, so doesnt have return; statement\n} \nfloat function2(float param1)\n{\n return 2*param1;                 //this function have to return some float\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7134696, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d4fcf7a0a3d1c8db018238f7e23bf7?s=128&d=identicon&r=PG&f=1", "display_name": "User_Unknown_3458", "link": "https://stackoverflow.com/users/7134696/user-unknown-3458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4069, "favorite_count": 0, "accepted_answer_id": 40639565, "answer_count": 5, "score": 2, "last_activity_date": 1479323982, "creation_date": 1479320549, "question_id": 40639482, "link": "https://stackoverflow.com/questions/40639482/assignment-to-write-a-program-that-gives-the-user-a-choice-between-two-options", "title": "Assignment to write a program that gives the user a choice between two options - C", "body": "<p>I have an assignment due and I am drawing a blank on what exactly to do... I'm sure it is simple but I havent quite gotten the hang of things yet. The assignment is  -</p>\n\n<p>Write a program that gives the user 2 menu options: either call a function that will print a greeting and your name 4 times or call a function that will count down from 10 to 0 and then print \"Blastoff!\". Both functions should use for loops to print the appropriate output.</p>\n\n<p>I have the prompt and the functions done so far... but I am unsure of how to display one or the other depending on the choice the user makes. Thank you for your help. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void){\n// declare counter variable\nint i;\n\n\n// prompt the user to make a choice\n    printf(\"What would you like to do?\\n  1. Print my name\\n  2. Count down from 10\\n\");    \n    printf(\"\\n\");\n\n// display greeting and name 4 times\n    for(i=1;i&lt;=4;i++)\n    {\n        printf(\"Hi, my name is Bridget\\n\");\n    }\n\n\n// display countdown\n    for(i=10;i&gt;=0;--i)\n    {\n        printf(\"%d\\n\", i);\n    }\n        printf(\"Blastoff!\");\n\n\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1479320194, "post_id": 40639360, "comment_id": 68510984, "body": "First thing when you open a file is to check that it did open. Without that the rest is useless."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479320571, "post_id": 40639360, "comment_id": 68511180, "body": "Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show an example input, the expected output, and the actual output. Also, please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>."}, {"owner": {"reputation": 26717, "user_id": 5352399, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh3.googleusercontent.com/-Rk_dLwN-xPY/AAAAAAAAAAI/AAAAAAAAAC8/DtCya1W9lX4/photo.jpg?sz=128", "display_name": "Wasi Ahmad", "link": "https://stackoverflow.com/users/5352399/wasi-ahmad"}, "edited": false, "score": 0, "creation_date": 1479320829, "post_id": 40639360, "comment_id": 68511330, "body": "I guess the problem is in - **mat. How &quot;c[z]=(float)atof(mat[i][j]);&quot; this statement would work??"}, {"owner": {"reputation": 58, "user_id": 7088356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1161053253943141/picture?type=large", "display_name": "Daniel Zaksevski", "link": "https://stackoverflow.com/users/7088356/daniel-zaksevski"}, "edited": false, "score": 0, "creation_date": 1479321118, "post_id": 40639360, "comment_id": 68511461, "body": "1. Yes I checked if it opens correctly just didn&#39;t include it 2. I will read, thank you. 3. Yes I can think of that myself, I&#39;m asking how to fix that"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479329188, "post_id": 40639360, "comment_id": 68516022, "body": "You did not allocate any memory for the pointer <code>mat</code> to point to"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479329345, "post_id": 40639360, "comment_id": 68516114, "body": "It would help if you show an example of the file contents"}], "owner": {"reputation": 58, "user_id": 7088356, "user_type": "registered", "profile_image": "https://graph.facebook.com/1161053253943141/picture?type=large", "display_name": "Daniel Zaksevski", "link": "https://stackoverflow.com/users/7088356/daniel-zaksevski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479326506, "creation_date": 1479320110, "last_edit_date": 1479326506, "question_id": 40639360, "link": "https://stackoverflow.com/questions/40639360/converting-char-array-to-floating-point", "title": "Converting char array to floating point", "body": "<p>So I have this char array taken from a .txt file (a matrix exactly) and I'm trying to covert it to a floating point two-dimensional array. </p>\n\n<pre><code>char c[MAX]=\"\";\nint x=0;\nfloat **mat;\n\nscanf (\"%s\", name);\nFILE* f=fopen(name, \"r+\");\n\nfor (int p=0; !feof(f); p++){\n    c[p] = fgetc(f);\n    if (isdigit(c[p])) x++;\n}\nfor (int z=0; z&lt;2*x; z++){\n    for (int i=0; i&lt;x/2; i++){\n        for (int j=0; j&lt;x/2; j++){\n            if (isdigit(c[z])) \n                c[z]=(float)atof(mat[i][j]);\n        }\n    }\n}\n</code></pre>\n\n<p>All I get is that the .exe file is not responding. I know it's because I'm not doing it right</p>\n"}, {"tags": ["c", "runtime-error", "gsl"], "comments": [{"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1479320136, "post_id": 40639262, "comment_id": 68510953, "body": "I don&#39;t know gsl, but the initialization looks strange to me. <code>gsl_matrix_set( A, i, 0, ... )</code> is called twice for 1 &lt;= i &lt; nr and <code>gsl_matrix_set( A, 0, j, ... )</code> is never called for 1 &lt;= j &lt; nc: Maybe it should be <code>for( i=0;...)</code> and <code>for( j=1;...)</code> in the second loop"}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1479320383, "post_id": 40639262, "comment_id": 68511076, "body": "That seems to get rid of the error!"}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1479320413, "post_id": 40639262, "comment_id": 68511091, "body": "If it&#39;s so, should I post it as an answer?"}, {"owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "reply_to_user": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1479320436, "post_id": 40639262, "comment_id": 68511100, "body": "@IngoLeonhardt Sure! I&#39;ll mark resolved"}], "answers": [{"tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 0, "last_activity_date": 1479320830, "creation_date": 1479320830, "answer_id": 40639573, "question_id": 40639262, "link": "https://stackoverflow.com/questions/40639262/conditional-jump-or-move-depends-on-uninitialised-values-using-gsl-matrix-se/40639573#40639573", "title": "Conditional jump or move depends on uninitialised value(s) - using gsl_matrix_set", "body": "<p>In the second part of your initialization, the start values of <code>i</code> and <code>j</code> are mismatched. So you call <code>gsl_matrix_set( A, i, 0, ... )</code> twice for 1 &lt;= i &lt; nr and you never call <code>gsl_matrix_set( A, 0, j, ... )</code> for 1 &lt;= j &lt; nc.</p>\n\n<p>Just change that part of the initialization to </p>\n\n<pre><code>for(i = 0; i &lt; nr; i++){\n   for(j = 1; j &lt; nc; j++){\n      gsl_matrix_set(A, i, j, 1.0 / (double)(i + j + 1)); \n   }  \n}\n</code></pre>\n"}], "owner": {"reputation": 4348, "user_id": 3435610, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IBOFX.jpg?s=128&g=1", "display_name": "Sara Tibbetts", "link": "https://stackoverflow.com/users/3435610/sara-tibbetts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40639573, "answer_count": 1, "score": 0, "last_activity_date": 1479320830, "creation_date": 1479319806, "question_id": 40639262, "link": "https://stackoverflow.com/questions/40639262/conditional-jump-or-move-depends-on-uninitialised-values-using-gsl-matrix-se", "title": "Conditional jump or move depends on uninitialised value(s) - using gsl_matrix_set", "body": "<p>I am trying to use the GSL library in C and am running into trouble.  </p>\n\n<p>I am allocating space for my matrices and vectors: </p>\n\n<pre><code>A   = gsl_matrix_alloc(nr, nc); /* Data matrix */\ntau = gsl_vector_alloc(nc);     /* required place holder for GSL */\n</code></pre>\n\n<p>Then I am initializing <code>A</code>: </p>\n\n<pre><code>for(i = 0; i &lt; nr; i++){\n  gsl_matrix_set(A, i, 0, 1.0); \n}\n\nfor(i = 1; i &lt; nr; i++){\n  for(j = 0; j &lt; nc; j++){\n    gsl_matrix_set(A, i, j, 1.0 / (double)(i + j + 1)); \n  }\n}\n</code></pre>\n\n<p>I am then erroring on this line: </p>\n\n<pre><code>gsl_linalg_QR_decomp(A, tau);\n</code></pre>\n\n<p>with the following error: </p>\n\n<pre><code>==901== Conditional jump or move depends on uninitialised value(s)\n==901==    at 0x3E8920AE0E: cblas_dnrm2 (in /usr/lib64/libgslcblas.so.0.0.0)\n==901==    by 0x3E88EA779A: gsl_linalg_householder_transform (in /usr/lib64/libgsl.so.0.14.0)\n==901==    by 0x3E88EA1305: gsl_linalg_QR_decomp (in /usr/lib64/libgsl.so.0.14.0)\n==901==    by 0x400FF3: GE_FindPoint (hw8.c:145)\n==901==    by 0x400DF4: main (hw8.c:66)\n==901==  Uninitialised value was created by a heap allocation\n==901==    at 0x4A06A2E: malloc (vg_replace_malloc.c:270)\n==901==    by 0x3E88E4CFD4: gsl_block_alloc (in /usr/lib64/libgsl.so.0.14.0)\n==901==    by 0x3E88EB1768: gsl_matrix_alloc (in /usr/lib64/libgsl.so.0.14.0)\n==901==    by 0x400EBB: GE_FindPoint (hw8.c:110)\n==901==    by 0x400DF4: main (hw8.c:66)\n</code></pre>\n\n<p>Line 110 points to the line allocating <code>A</code>: <code>A   = gsl_matrix_alloc(nr, nc);</code></p>\n\n<p>In this case, <code>nc = 3</code> and <code>nr = 3840</code>. What would cause this error?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1479319458, "post_id": 40639097, "comment_id": 68510566, "body": "You reserve 2 <code>char</code>s for each number, but the <code>-</code> sign in -26 and -35  also ocupies space."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1479319466, "post_id": 40639097, "comment_id": 68510572, "body": "Actual output? Expected output? Maybe you just have a problem with the sign."}, {"owner": {"reputation": 203, "user_id": 6676967, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/153a9a8998bb1840ee40f1d3b430b825?s=128&d=identicon&r=PG&f=1", "display_name": "Abu", "link": "https://stackoverflow.com/users/6676967/abu"}, "edited": false, "score": 0, "creation_date": 1479319575, "post_id": 40639097, "comment_id": 68510641, "body": "Expected output &quot;10-26357-35&quot;"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1479319624, "post_id": 40639097, "comment_id": 68510673, "body": "@Abu - Then allocate space for the sign! 2 chars is not enough for <code>-26</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1479320434, "post_id": 40639097, "comment_id": 68511098, "body": "you have a 1 digit number too, do you expect this to work with 12345,1,425,8888888, or is it only 1,2 or 3 character numbers (including sign)"}], "answers": [{"comments": [{"owner": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "edited": false, "score": 1, "creation_date": 1479320575, "post_id": 40639347, "comment_id": 68511181, "body": "Your solution prints an extra padding <code>0</code> in the output: <code>10-263507-35</code>. OP asked for <code>10-26357-35</code>."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "edited": false, "score": 0, "creation_date": 1479321963, "post_id": 40639347, "comment_id": 68511894, "body": "@skrtbhtngr - Thanks for noticing. Don&#39;t know why I assumed that OP actually wanted the zeros. Anyway I posted an alternative solution now."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479324214, "post_id": 40639347, "comment_id": 68513197, "body": "For a general solution, better to use the C spec&#39;s matching type and specifier :  <code>int16_t</code> with <code>&quot;%&quot;PRTd16</code> <i>or</i> <code>short</code> with  <code>&quot;%hd&quot;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479324413, "post_id": 40639347, "comment_id": 68513298, "body": "Minor: <code>if (cnt &lt;= 0 || ... </code> --&gt; <code>if (cnt &lt; 0 || ... </code>.  Of course will not make a difference in this case, but a more correct general test of <code>snprintf()</code> result - which is <i>good</i> that you showed."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 2, "last_activity_date": 1479322466, "last_edit_date": 1479322466, "creation_date": 1479320062, "answer_id": 40639347, "question_id": 40639097, "link": "https://stackoverflow.com/questions/40639097/converting-signed-integer-array-to-char-array/40639347#40639347", "title": "converting signed integer array to char array", "body": "<p>You have to take the sign into account. In other words - you can't just assume all numbers to be 2 chars width.</p>\n\n<p>Try something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n   int16_t frame_i[5] = {10, -26, 35, 7, -35};\n   size_t i;\n   char *s = malloc(5*3+1);  // Allocate memory to hold 3 chars for each number\n\n   char *tmp = s;            // Add a tmp pointer to know how far you are\n\n   for(i = 0; i&lt;5; i++) {\n    if (frame_i[i] &gt;= 0)     // Check the sign\n    {\n        snprintf(tmp, 3, \"%02hd\", frame_i[i]);  // Requires 2 chars\n        tmp += 2;\n    }\n    else\n    {\n        snprintf(tmp, 4, \"%03hd\", frame_i[i]);   // Requires 3 chars\n        tmp += 3;\n    }\n   }\n\n   // Print the result\n   printf(\"%s\\n\", s);\n\n   // Release memory\n   free(s);\n\n   return 0;\n}\n</code></pre>\n\n<p>Notice that the solution only works for numbers in the range -99 to 99 and that it will put a <code>0</code> in front of number in the range -9 to 9.</p>\n\n<p>A more general (and simpler) solution which handles a wider range and doesn't add <code>0</code> in front can be obtained by utilizing that <code>snprintf</code> returns the number of characters printed. Something like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_STRING_SIZE 1000\n\nint main(void) {\n   int16_t frame_i[5] = {10, -26, 35, 7, -35};\n   size_t i;\n   int size_available = MAX_STRING_SIZE;\n   int cnt;\n   char *s = malloc(MAX_STRING_SIZE);\n   char *tmp = s;\n   for(i = 0; i&lt;5; i++) {\n    cnt = snprintf(tmp, size_available, \"%hd\", frame_i[i]);\n    if (cnt &lt;= 0 || cnt &gt;= size_available)\n    {\n        printf(\"Error - snprintf failed or string too short\\n\");\n        free(s);\n        return(0);\n    }\n    size_available -= cnt;\n    tmp += cnt;\n   }\n   printf(\"%s\\n\", s);\n   free(s);\n   return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2076, "user_id": 1866196, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/TrCUq.png?s=128&g=1", "display_name": "skrtbhtngr", "link": "https://stackoverflow.com/users/1866196/skrtbhtngr"}, "is_accepted": false, "score": 0, "last_activity_date": 1479321058, "last_edit_date": 1479321058, "creation_date": 1479320434, "answer_id": 40639452, "question_id": 40639097, "link": "https://stackoverflow.com/questions/40639097/converting-signed-integer-array-to-char-array/40639452#40639452", "title": "converting signed integer array to char array", "body": "<p>Here is what you need to do:</p>\n\n<ul>\n<li>When allocating space for the string, give 6 bytes for each array element because you can have at most 6 digits in a signed 16-bit integer (like, -32768) and you are storing digits as a character, not a number.</li>\n<li>You have to adjust the next position for writing according to the digit-length of the number. </li>\n<li>Remember that when you use <code>snprintf</code>, the unwritten characters in the string will be <code>'\\0'</code>, so you would not get a continuous string if you leave gaps in the string while writing to it.</li>\n<li>Also note that the second argument value in <code>snprintf</code>, the <code>n</code> must be one greater than the maximum width number you want to put (for accommodating <code>'\\0'</code>.</li>\n</ul>\n\n<p>This would work in <strong>your</strong> case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n       int16_t frame_i[5] = {10, -26, 35, 7, -35};\n       size_t i, j;\n       char *s = malloc(5*3+1);\n       for(i = 0, j=0; i&lt;5; i++) {\n           snprintf(s + j, 4, \"%hd\", frame_i[i]);\n           if(frame_i[i]&lt;0 &amp;&amp; frame_i[i]&lt;=-10)\n                j+=3;\n           else if(frame_i[i]&lt;0)\n                j+=2;\n           else if(frame_i[i] &lt; 10)\n                j+=1;\n           else\n                j+=2;\n       }\n       printf(\"%s\",s);\n       return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 6676967, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/153a9a8998bb1840ee40f1d3b430b825?s=128&d=identicon&r=PG&f=1", "display_name": "Abu", "link": "https://stackoverflow.com/users/6676967/abu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 40639347, "answer_count": 2, "score": -1, "last_activity_date": 1479322466, "creation_date": 1479319227, "last_edit_date": 1479319546, "question_id": 40639097, "link": "https://stackoverflow.com/questions/40639097/converting-signed-integer-array-to-char-array", "title": "converting signed integer array to char array", "body": "<p>I am trying to convert an signed integer array to character pointer. I wrote a sample programe like below. \nExpected output be \"10-26357-35\"\nPlease help me.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n   int16_t frame_i[5] = {10, -26, 35, 7, -35};\n   size_t i;\n   char *s = malloc(5*2+1);\n   for(i = 0; i&lt;5; i++) {\n    snprintf(s + i * 2, 3, \"%hd\", frame_i[i]);\n   }\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479319167, "post_id": 40639001, "comment_id": 68510369, "body": "Windows <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd743680(v=vs.85).aspx\" rel=\"nofollow noreferrer\">playsound function</a> does exist. An example is shown on the man page. Note too it says <i>&quot;The SND_ASYNC flag causes PlaySound to return immediately without waiting for the sound to finish playing.&quot;</i>. You will need to <code>#include &lt;windows.h&gt;</code> and link the library mentioned too."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1479319312, "post_id": 40639001, "comment_id": 68510474, "body": "You must have some code to share if you&#39;ve <i>tried to use the playsound function</i>. Have you included the winmm library in your compiler settings - and included it in your code?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1479319339, "post_id": 40639001, "comment_id": 68510493, "body": "<a href=\"http://stackoverflow.com/a/1565518/2419128\">stackoverflow.com/a/1565518/2419128</a>"}, {"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 2, "creation_date": 1479319798, "post_id": 40639001, "comment_id": 68510752, "body": "Welcome to Stack Overflow. Please check out <a href=\"http://stackoverflow.com/tour\">the tour</a>, and thoroughly read <a href=\"http://stackoverflow.com/help\">the help pages</a> - in particular, <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a>, <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">&quot;How do I ask a good question?&quot;</a> and <a href=\"http://stackoverflow.com/help/mcve\">&quot;How to create a Minimal, Complete, and Verifiable example&quot;</a>. As-is, your question is off-topic for this site."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479319891, "post_id": 40639001, "comment_id": 68510807, "body": "The function <code>playsound()</code> which you use does not exist, the one I linked is named <code>PlaySound()</code>."}, {"owner": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "edited": false, "score": 0, "creation_date": 1479412907, "post_id": 40639001, "comment_id": 68559102, "body": "Weather Vane: So I found out that my problem was that I completely ignored the fact that I need the winmm library.  The function does exist.  I am just a novice :)"}, {"owner": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "edited": false, "score": 0, "creation_date": 1479413058, "post_id": 40639001, "comment_id": 68559194, "body": "Plus, I also had playsound() ranther than PlaySound().  And thank you for reminding me of the winmm library, dbmitch.  Finally, I am sorry if this question was off-topic, etc.  I have no idea what I am doing. Clearly."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "edited": false, "score": 0, "creation_date": 1479413151, "post_id": 40639180, "comment_id": 68559252, "body": "Thank you! I am new to programming, so SDL was not even something I was aware of."}], "tags": [], "owner": {"reputation": 59, "user_id": 7163213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bafe7055fd433398f4507fa2638657?s=128&d=identicon&r=PG&f=1", "display_name": "A. Grenouilloux", "link": "https://stackoverflow.com/users/7163213/a-grenouilloux"}, "is_accepted": false, "score": 0, "last_activity_date": 1479319465, "creation_date": 1479319465, "answer_id": 40639180, "question_id": 40639001, "link": "https://stackoverflow.com/questions/40639001/how-to-get-a-c-program-to-play-a-sound-file/40639180#40639180", "title": "How to get a C program to play a sound file?", "body": "<p>I would suggest looking into the <a href=\"http://www.libsdl.org/\" rel=\"nofollow noreferrer\">SDL</a> which is a very reliable, widespread and cross-platform library. It has many features providing low-level control over the IO devices (keyboard, controller, mouse, graphics via OpenGL, sound...).</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "edited": false, "score": 0, "creation_date": 1479413102, "post_id": 40639806, "comment_id": 68559218, "body": "Thank you! I did not know that PlaySound() can only play one sound at a time."}, {"owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "reply_to_user": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "edited": false, "score": 0, "creation_date": 1479413595, "post_id": 40639806, "comment_id": 68559485, "body": "Nothin&#39; says thanks like an upvote :) As a side comment, if you do end up going the OpenAL route, know that setting it up is a major pain in the ass, but once it works it&#39;ll fulfill all your audio needs."}], "tags": [], "owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "is_accepted": false, "score": 0, "last_activity_date": 1479321592, "last_edit_date": 1495535569, "creation_date": 1479321592, "answer_id": 40639806, "question_id": 40639001, "link": "https://stackoverflow.com/questions/40639001/how-to-get-a-c-program-to-play-a-sound-file/40639806#40639806", "title": "How to get a C program to play a sound file?", "body": "<p>I encountered a similar issue with a game I'm working on - if by chance you are using the Win32 API (windows.h), you should be able to leverage the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd743680(v=vs.85).aspx\" rel=\"nofollow noreferrer\">PlaySound</a> function, however it can only ever play (mix) <a href=\"https://stackoverflow.com/questions/30144635/how-to-play-more-than-1-wav-sounds-in-c-at-the-same-time-using-playsound-or\">one sound at a time</a> (e.g. no music and sound effects). Note that as Weather Vane pointed out in his comment, capitalization matters (PlaySound vs playsound). If you only need one sound and you're using the Win32 API, figuring out the PlaySound() function would be the easiest. Here's a <a href=\"https://stackoverflow.com/questions/1565439/how-to-playsound-in-c-using-windows-api\">SO question</a> that has a basic example which should work in C.</p>\n\n<p>I ended up using <a href=\"https://en.wikipedia.org/wiki/OpenAL\" rel=\"nofollow noreferrer\">OpenAL</a> (analogous to OpenGL) which allows you to play several sounds at once. I'd suggest searching for some simple, complete examples.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11134261, "user_type": "registered", "profile_image": "https://graph.facebook.com/2248538378719527/picture?type=large", "display_name": "Bishal Bashyal", "link": "https://stackoverflow.com/users/11134261/bishal-bashyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1551418094, "creation_date": 1551418094, "answer_id": 54938441, "question_id": 40639001, "link": "https://stackoverflow.com/questions/40639001/how-to-get-a-c-program-to-play-a-sound-file/54938441#54938441", "title": "How to get a C program to play a sound file?", "body": "<p>I just like getting into need, Follow this:\nInclude this header file:</p>\n\n<p>mmsystem.h</p>\n\n<p>In the main type this:\nPlaySound(TEXT(\"NameOfAudio.wav\"),NULL,SND_LOOP);</p>\n\n<p>Put the wav file you want to play in the folder that contains the project file and you are good to go!</p>\n"}], "owner": {"reputation": 19, "user_id": 7168994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3f79c59bd64972d399fc3cfd9b39033?s=128&d=identicon&r=PG&f=1", "display_name": "Jennifer", "link": "https://stackoverflow.com/users/7168994/jennifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4762, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1551418094, "creation_date": 1479318851, "last_edit_date": 1479540956, "question_id": 40639001, "link": "https://stackoverflow.com/questions/40639001/how-to-get-a-c-program-to-play-a-sound-file", "title": "How to get a C program to play a sound file?", "body": "<p>I have created the game snake in C that will run on Windows. I want to add sounds when the user hits certain keys or if the snake does certain things.</p>\n\n<p>I know how to do this in C on MacOS but I don't know how to do it on Windows.</p>\n\n<p>I tried to compile using a <code>playsound()</code> function I found on Google but I get an error message that indicates that playsound doesn't exist.</p>\n\n<p>I tried to play the sound played by Windows when you type control G into run  but this led me down a horrible rabbit hole of never ending and not helpful code.  </p>\n\n<p>I have no code to post at this time.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1479318665, "post_id": 40638929, "comment_id": 68510050, "body": "Do you know what is <code>char </code> and <code>char *</code>?"}, {"owner": {"reputation": 23, "user_id": 6771640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4260f1bbd257e0345129abf6e16c7f7f?s=128&d=identicon&r=PG&f=1", "display_name": "Emil Mein", "link": "https://stackoverflow.com/users/6771640/emil-mein"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1479318750, "post_id": 40638929, "comment_id": 68510098, "body": "yeah I know but what is the difference? char is type of variable and char* is a pointer of char type"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1479318784, "post_id": 40638929, "comment_id": 68510124, "body": "@EmilMein No, both <code>char</code> and <code>char*</code> are types. Different types. Same with <code>ASturct</code> (whatevfer that is) and <code>ASturct*</code>. Two types, but two different types. You can a variable of type <code>ASturct</code> and another variable of type <code>ASturct*</code>."}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1479318801, "post_id": 40638929, "comment_id": 68510134, "body": "Now think both just as data types and answer your own question."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479318922, "post_id": 40638929, "comment_id": 68510220, "body": "Oh, and unless you&#39;re declaring <code>array</code> as an argument to a function, you can&#39;t have an empty size for arrays."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479319002, "post_id": 40638929, "comment_id": 68510271, "body": "Finally, you probably need to <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">find a good beginners book</a> and start reading from the beginning."}, {"owner": {"reputation": 23, "user_id": 6771640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4260f1bbd257e0345129abf6e16c7f7f?s=128&d=identicon&r=PG&f=1", "display_name": "Emil Mein", "link": "https://stackoverflow.com/users/6771640/emil-mein"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479319117, "post_id": 40638929, "comment_id": 68510343, "body": "@Some programmer dude But if you create array(first or 2nd) i will get pointer to the first element and elements are represented by pointers (like from definition array is a set of pointers)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479319457, "post_id": 40638929, "comment_id": 68510563, "body": "No you are misunderstanding how arrays work. They can <i>decay</i> to a pointer to its first element. But an array is not by itself a pointer. And each element in an array is a <i>value</i> and not a pointer (unless the value <i>is</i> a pointer, like in the second example you show)."}], "answers": [{"tags": [], "owner": {"reputation": 26971, "user_id": 3073272, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hofYF.jpg?s=128&g=1", "display_name": "GorvGoyl", "link": "https://stackoverflow.com/users/3073272/gorvgoyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1479318795, "last_edit_date": 1479318795, "creation_date": 1479318683, "answer_id": 40638954, "question_id": 40638929, "link": "https://stackoverflow.com/questions/40638929/difference-between-asturct-arr-and-asturct-arr/40638954#40638954", "title": "Difference between ASturct arr[] and ASturct * arr[]", "body": "<pre><code>ASturct  array[]\n</code></pre>\n\n<p>Above one is array of type ASturct .  </p>\n\n<pre><code>ASturct * array[]\n</code></pre>\n\n<p>And this one is array of pointers (which are of type ASturct).</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6771640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4260f1bbd257e0345129abf6e16c7f7f?s=128&d=identicon&r=PG&f=1", "display_name": "Emil Mein", "link": "https://stackoverflow.com/users/6771640/emil-mein"}, "edited": false, "score": 0, "creation_date": 1479320079, "post_id": 40639286, "comment_id": 68510916, "body": "Thank you for help."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1479319874, "creation_date": 1479319874, "answer_id": 40639286, "question_id": 40638929, "link": "https://stackoverflow.com/questions/40638929/difference-between-asturct-arr-and-asturct-arr/40639286#40639286", "title": "Difference between ASturct arr[] and ASturct * arr[]", "body": "<p>You seem to have a basic misunderstanding about how arrays and pointers work.</p>\n\n<p>Lets take a very simple example:</p>\n\n<pre><code>int a = 1;\nint b = 2;\nint c = 3;\n\nint array1[3] = { a, b, c };\n</code></pre>\n\n<p>The above code creates an array of three <code>int</code> values. In memory it will look something like</p>\n\n<pre>\n+---+---+---+\n| 1 | 2 | 3 |\n+---+---+---+\n</pre>\n\n<p>The variables <code>a</code>, <code>b</code> and <code>c</code> are not anywhere in the array, the values of those variables were copied into the array when the array was initialized.</p>\n\n<p>Now lets take a <strong><em>very different</em></strong> example:</p>\n\n<pre><code>int a = 1;\nint b = 2;\nint c = 3;\n\nint *array2[3] = { &amp;a, &amp;b, &amp;c };\n</code></pre>\n\n<p>Now we have an array <em>of pointers</em>, and initialize each element to point to the variables <code>a</code>, <code>b</code> and <code>c</code>. It will look something like this in memory</p>\n\n<pre>\n+----+----+----+\n| &a | &b | &c |\n+----+----+----+\n |    |    |\n |    |    v\n |    |    +---+\n |    |    | 3 |\n |    |    +---+\n |    v    \n |    +---+\n |    | 2 |\n |    +---+\n |\n v\n +---+\n | 1 |\n +---+\n</pre>\n\n<p>Both <code>array1</code> and <code>array2</code> in the example above are array with three elements, but the similarities end there. The type and value of each element in the arrays are very different from each other. For <code>array1</code> each element is a single <code>int</code>, it holds a number (like e.g. <code>1</code> for <code>array1[0]</code>). For <code>array2</code> each element is a <em>pointer</em> to an <code>int</code> value, and its value is the address of that <code>int</code> value.</p>\n"}], "owner": {"reputation": 23, "user_id": 6771640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4260f1bbd257e0345129abf6e16c7f7f?s=128&d=identicon&r=PG&f=1", "display_name": "Emil Mein", "link": "https://stackoverflow.com/users/6771640/emil-mein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 40639286, "answer_count": 2, "score": -2, "last_activity_date": 1479319874, "creation_date": 1479318605, "last_edit_date": 1479318772, "question_id": 40638929, "link": "https://stackoverflow.com/questions/40638929/difference-between-asturct-arr-and-asturct-arr", "title": "Difference between ASturct arr[] and ASturct * arr[]", "body": "<p>What is difference between ASturct arr[] and ASturct* arr[]? </p>\n\n<pre><code>ASturct array[]\nASturct * array[]\n</code></pre>\n\n<p>Thanks for answer!</p>\n"}, {"tags": ["c", "fork", "wait", "mkfifo"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479318598, "post_id": 40638908, "comment_id": 68510002, "body": "It won&#39;t even compile. <code>fork</code> is not a function call"}, {"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479318675, "post_id": 40638908, "comment_id": 68510058, "body": "oops yeah sorry I&#39; ll edit"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479318732, "post_id": 40638908, "comment_id": 68510086, "body": "Don&#39;t just edit. Post the full code."}, {"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479319132, "post_id": 40638908, "comment_id": 68510352, "body": "But it&#39;s kind of a theoretical question. What would you do in this case, how to wait for the first process to exit."}, {"owner": {"reputation": 944, "user_id": 388647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c525b8ff119dc1b65cb2d8bd47f7e1?s=128&d=identicon&r=PG", "display_name": "Torkel Bj&#248;rnson-Langen", "link": "https://stackoverflow.com/users/388647/torkel-bj%c3%b8rnson-langen"}, "edited": false, "score": 0, "creation_date": 1479319222, "post_id": 40638908, "comment_id": 68510418, "body": "At least post code that compiles! See: <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "edited": false, "score": 0, "creation_date": 1479319649, "post_id": 40638908, "comment_id": 68510689, "body": "Ok sorry for that. I will make sure next time, I was kind in a hurry!"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 1, "creation_date": 1479319717, "post_id": 40638908, "comment_id": 68510715, "body": "Why don&#39;t you use <code>waitpid</code> with the <code>WNOHANG</code> option to loop through the <code>pid</code> list?"}, {"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479320154, "post_id": 40638908, "comment_id": 68510966, "body": "@DavidCullen I ran through the manual and found this : <code>WNOHANG     return immediately if no child has exited.</code>. Would you mind explaining how would this help? Maybe I&#39;m not quite grasping what it does."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479320315, "post_id": 40638908, "comment_id": 68511037, "body": "You use the <code>WNOHANG</code> option to poll the children to see if one has exited. If one has exited, <code>waitpid</code> will return a non-zero value. Then you use the <code>pid</code> to determine which FIFO to read."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "edited": false, "score": 0, "creation_date": 1479319426, "post_id": 40639066, "comment_id": 68510541, "body": "In case the first process has exited,  the parent process continues, and reads from the fifo the data the first process has written, what happens if the rest of the processes haven&#39;t finished their jobs and the parent wants to read from them? Is there a way for it to wait for them as well?"}, {"owner": {"reputation": 944, "user_id": 388647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c525b8ff119dc1b65cb2d8bd47f7e1?s=128&d=identicon&r=PG", "display_name": "Torkel Bj&#248;rnson-Langen", "link": "https://stackoverflow.com/users/388647/torkel-bj%c3%b8rnson-langen"}, "reply_to_user": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "edited": false, "score": 0, "creation_date": 1479319781, "post_id": 40639066, "comment_id": 68510739, "body": "That is a different question. I&#39;m not sure I understand your question. Maybe you should read some basic theory on the topic. You can wait for a specific child with <code>waitpid(pid, NULL, 0)</code>."}, {"owner": {"reputation": 944, "user_id": 388647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c525b8ff119dc1b65cb2d8bd47f7e1?s=128&d=identicon&r=PG", "display_name": "Torkel Bj&#248;rnson-Langen", "link": "https://stackoverflow.com/users/388647/torkel-bj%c3%b8rnson-langen"}, "reply_to_user": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "edited": false, "score": 0, "creation_date": 1479319996, "post_id": 40639066, "comment_id": 68510862, "body": "&quot;What happens if the rest of the processes haven&#39;t finished their jobs and the parent wants to read from them?&quot;. That depends how many bytes you read from the FIFO. If you read more bytes than the child has written, <code>read()</code> will normally block."}, {"owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "edited": false, "score": 0, "creation_date": 1479320036, "post_id": 40639066, "comment_id": 68510893, "body": "OK, I&#39;ll check if it works correctly and if it does I&#39;m gonna upvote your answer. Thanks."}], "tags": [], "owner": {"reputation": 944, "user_id": 388647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44c525b8ff119dc1b65cb2d8bd47f7e1?s=128&d=identicon&r=PG", "display_name": "Torkel Bj&#248;rnson-Langen", "link": "https://stackoverflow.com/users/388647/torkel-bj%c3%b8rnson-langen"}, "is_accepted": true, "score": 1, "last_activity_date": 1479319112, "creation_date": 1479319112, "answer_id": 40639066, "question_id": 40638908, "link": "https://stackoverflow.com/questions/40638908/multiple-forks-wait-for-the-first-to-finish/40639066#40639066", "title": "Multiple forks, wait for the first to finish", "body": "<p>Just use <code>wait(NULL)</code>. As the documentation says, it will wait until one of its children terminate. So it will do what you want, i.e.: wait for the first child to finish.</p>\n"}], "owner": {"reputation": 31, "user_id": 5810752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uJKrq.jpg?s=128&g=1", "display_name": "Q_M", "link": "https://stackoverflow.com/users/5810752/q-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 40639066, "answer_count": 1, "score": 0, "last_activity_date": 1479319460, "creation_date": 1479318534, "last_edit_date": 1479319460, "question_id": 40638908, "link": "https://stackoverflow.com/questions/40638908/multiple-forks-wait-for-the-first-to-finish", "title": "Multiple forks, wait for the first to finish", "body": "<p>I'm kind of new to all the <code>fork</code>, <code>exec</code> and <code>wait</code> functions. I have an assignment, which requires I <code>fork</code> my main process i times and then use all the children to write on to different fifos for each process. For example, if I have 3 children, I'll have to write to 3 different fifos. Then, my parent process has to wait for the first one to finish writing on any fifo, and read the data from that specific fifo. What baffled me is that my parent process has to wait for the first to finish and not for all the processes to finish. If I had to wait for all, I would use <code>while(wait(NULL)&gt;0)</code>. However what do you do in this case? I've written a sample code below:</p>\n\n<pre><code>pid_t *pid;\nint    i;\n\npid = malloc(sizeof(pid_t)*children);\nfor(i=0;i&lt;children;i++)\n{\n     if((pid[i]=fork())&lt;0)\n     { /* error */ }\n\n     if(pid[i]==0)\n     {\n          //WriteOnFifos\n          return 0;\n     }\n     else\n     {\n           //wait for the first process to finish\n     }\n }\n</code></pre>\n\n<p>Thanks in advance. Any help would be appreciated. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 2, "creation_date": 1479318493, "post_id": 40638774, "comment_id": 68509932, "body": "You need to set the file position (using <code>fseek</code>) correctly."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1479318535, "post_id": 40638774, "comment_id": 68509948, "body": "Why are you using 1 instead of <code>SEEK_CUR</code>?, even if they are the same, is hard to read."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1479318684, "post_id": 40638774, "comment_id": 68510063, "body": "@KeineLust Because that&#39;s what the <a href=\"http://www.studytonight.com/c/program-to-reverse-content-of-file.php\" rel=\"nofollow noreferrer\">code OP copied from</a> used. OP, try to understand what the code does instead of copying code and expecting others to fix it."}, {"owner": {"reputation": 553, "user_id": 2759575, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39d5aacf9250bec78b7be64711247a65?s=128&d=identicon&r=PG&f=1", "display_name": "user2759575", "link": "https://stackoverflow.com/users/2759575/user2759575"}, "edited": false, "score": 0, "creation_date": 1479318783, "post_id": 40638774, "comment_id": 68510122, "body": "Correct ;) They return the same thing in this case."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1479318793, "post_id": 40638774, "comment_id": 68510127, "body": "you need to seek to the end of the file before the second loop. Your extra garbage is because you read the file then step backwards. Your first loop begins with the file at EOF, you need to position on the last char"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1479318859, "post_id": 40638774, "comment_id": 68510176, "body": "@interjay, ahhh, ok, what an ugly code :("}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479320340, "post_id": 40638774, "comment_id": 68511054, "body": "<code>fseek(file, -2L, 1);</code> is UB ; &quot;For a text stream, either offset shall be zero, or offset shall be a value returned by an earlier successful call to the ftell function ...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3125979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2AFKV.png?s=128&g=1", "display_name": "jbmillard", "link": "https://stackoverflow.com/users/3125979/jbmillard"}, "is_accepted": true, "score": 0, "last_activity_date": 1479318850, "creation_date": 1479318850, "answer_id": 40639002, "question_id": 40638774, "link": "https://stackoverflow.com/questions/40638774/fgetc-loop-returning-wrong-result/40639002#40639002", "title": "fgetc loop returning wrong result", "body": "<p>It's not clear what state things are left in by count_characters().  Also at the end of the first loop, you should be at the beginning of the file (actually before it).  In the second loop, you keep moving backward.</p>\n\n<p>I'd set a buffer size and read the buffers from the file.  For small files, read the whole thing (your algorithm should account for files smaller than the buffer).  That would seem easier to me.</p>\n"}], "owner": {"reputation": 553, "user_id": 2759575, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/39d5aacf9250bec78b7be64711247a65?s=128&d=identicon&r=PG&f=1", "display_name": "user2759575", "link": "https://stackoverflow.com/users/2759575/user2759575"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 40639002, "answer_count": 1, "score": -1, "last_activity_date": 1479318850, "creation_date": 1479318111, "question_id": 40638774, "link": "https://stackoverflow.com/questions/40638774/fgetc-loop-returning-wrong-result", "title": "fgetc loop returning wrong result", "body": "<p>I'm using fgetc and a character-counting method to loop through a file of characters and return them in reverse order. Two unexpected things happen when I try and do so. When I paste a second iteration of the loop below the first it returns a very different, wacky result. As well, the first loop returns the correct result except for an additional character at the start.</p>\n\n<p>For example, if the file contains the string 'Hello' the first iteration will return <code>5olleH</code> and the second <code>HeHeHeHeHeHeHeHeHeHeHeHeHeHe</code>. The correct result would be <code>olleH</code> for both loops.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>FILE *file = fopen( argv[1], \"r\" );    \ncount = count_characters(file);\nint originalCount = count;\n\nwhile(count){\n\nch = fgetc(file);\nprintf(\"%c\", ch);\nfseek(file, -2L, 1);   // shifts the pointer to the previous character\ncount--;\n\n}\n\ncount = originalCount;\n\nwhile(count){\n\nch = fgetc(file);\nprintf(\"%c\", ch);\nfseek(file, -2L, 1);   // shifts the pointer to the previous character\ncount--;\n\n}\n</code></pre>\n"}, {"tags": ["c", "string", "char"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1479318006, "post_id": 40638703, "comment_id": 68509664, "body": "It&#39;s a single character. <code>user_guess == &#39;K&#39;</code> would work just fine. Why are you over-complicating? And yeah, you can use <code>switch&#47;case</code> statement."}, {"owner": {"reputation": 1812, "user_id": 4305712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YMMqA.png?s=128&g=1", "display_name": "Patricio Sard", "link": "https://stackoverflow.com/users/4305712/patricio-sard"}, "edited": false, "score": 0, "creation_date": 1479318010, "post_id": 40638703, "comment_id": 68509668, "body": "Try with &#39;S&#39; instead of &quot;S&quot; and so on... <code>&quot;&quot;</code> is for strings, <code>&#39;&#39;</code> is for characters"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1812, "user_id": 4305712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YMMqA.png?s=128&g=1", "display_name": "Patricio Sard", "link": "https://stackoverflow.com/users/4305712/patricio-sard"}, "edited": false, "score": 0, "creation_date": 1479318152, "post_id": 40638703, "comment_id": 68509739, "body": "@OiciTrap <code>strcmp</code> is not working with characters.."}, {"owner": {"reputation": 1812, "user_id": 4305712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/YMMqA.png?s=128&g=1", "display_name": "Patricio Sard", "link": "https://stackoverflow.com/users/4305712/patricio-sard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479318264, "post_id": 40638703, "comment_id": 68509805, "body": "Then do what @EugeneSh. recommended or change the user input to string instead of a character, that way you will be able to use <code>strcmp</code>, but you would have to change every <code>&#39;S&#39;</code>, <code>&#39;K&#39;</code>... to <code>&quot;S&quot;</code>, <code>&quot;K&quot;</code>... etc"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479319544, "post_id": 40638703, "comment_id": 68510625, "body": "BTW, instead of mapping the user input to the computer generated choice, do it the other way round, that&#39;s probably easier. Hint: <code>char choices[] = &#39;SKP&#39;;</code> ... ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": false, "score": 1, "last_activity_date": 1479318996, "last_edit_date": 1479318996, "creation_date": 1479318600, "answer_id": 40638923, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c/40638923#40638923", "title": "Comparing multiple characters in C", "body": "<p>Either do </p>\n\n<pre><code>char user_guess[2], ... /* C-\"strings\" are '0'-terminated, \n                           that why you always need one more `char`. */\n\n...\n\nscanf(\"%1s\", user_guess); /* Scan in ONLY 1 char! */\n\n...\n\nif (strcmp(user_guess, \"S\") == 0 || ...\n</code></pre>\n\n<p>or </p>\n\n<pre><code>char user_guess, ...\n\n...\n\nscanf(\"%c\", &amp;user_guess);\n\n...\n\nif (user_guess == 'S') || ... /* Mind the SINGLE quotes! */\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479318911, "post_id": 40638966, "comment_id": 68510211, "body": "&quot;<i>So it won&#39;t work with what you want ...</i>&quot; Why? It will, just do the preparation correctly."}, {"owner": {"reputation": 541, "user_id": 5110035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CwEM7.jpg?s=128&g=1", "display_name": "MichaelMMeskhi", "link": "https://stackoverflow.com/users/5110035/michaelmmeskhi"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479318992, "post_id": 40638966, "comment_id": 68510266, "body": "Because it&#39;s comparing strings and returning 0 is they are same. But you want to compare only 3 characters so might as well do it via conditionals."}, {"owner": {"reputation": 541, "user_id": 5110035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CwEM7.jpg?s=128&g=1", "display_name": "MichaelMMeskhi", "link": "https://stackoverflow.com/users/5110035/michaelmmeskhi"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479319322, "post_id": 40638966, "comment_id": 68510486, "body": "I understand I was just trying to suggest that the other way is over complex. But it&#39;s good that you asked this."}], "tags": [], "owner": {"reputation": 541, "user_id": 5110035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CwEM7.jpg?s=128&g=1", "display_name": "MichaelMMeskhi", "link": "https://stackoverflow.com/users/5110035/michaelmmeskhi"}, "is_accepted": false, "score": 1, "last_activity_date": 1479318721, "creation_date": 1479318721, "answer_id": 40638966, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c/40638966#40638966", "title": "Comparing multiple characters in C", "body": "<p>Don't over complicate something so simple!</p>\n\n<p>Just do <code>if(user_guess == 'S' || user_guess == 's')</code></p>\n\n<p><code>strcmp()</code> does this:</p>\n\n<ul>\n<li><p>if Return value &lt; 0 then it indicates str1 is less than str2.</p></li>\n<li><p>if Return value > 0 then it indicates str2 is less than str1.</p></li>\n<li><p>if Return value = 0 then it indicates str1 is equal to str2.</p></li>\n</ul>\n\n<p>So it won't work with what you want and plus it's too complex for such a simple program :)</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1479319130, "post_id": 40639040, "comment_id": 68510348, "body": "Wrapping <code>user_guess</code> by <code>toupper()</code>/<code>tolower()</code> removes three more lines."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479319685, "post_id": 40639040, "comment_id": 68510703, "body": "@alk Sure does."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 1, "last_activity_date": 1479320344, "last_edit_date": 1479320344, "creation_date": 1479318980, "answer_id": 40639040, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c/40639040#40639040", "title": "Comparing multiple characters in C", "body": "<p>An easier way to do the reading and logic (that looks better) is to scan to a char then do a switch statement:</p>\n\n<pre><code>scanf(\"%c\",&amp;user_guess);\n\nswitch (user_guess) {\n    case 'S':\n    case 's':\n        user_number=0;\n        break;\n    case 'K':\n    case 'k':\n        user_number=1;\n        break;\n    case 'P':\n    case 'p':\n        user_number=2;\n        break;\n    default:\n        // You can even do some error handling in here!\n}\n</code></pre>\n\n<p>As suggested by @alk below, you can also remove some lines by using <code>tolower</code> or <code>toupper</code> to convert the case, then you only need to deal with one letter case per letter.</p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 5405158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf7ae818548c0ff2e0c021a38b2f46b5?s=128&d=identicon&r=PG&f=1", "display_name": "Sir Barksalot", "link": "https://stackoverflow.com/users/5405158/sir-barksalot"}, "is_accepted": false, "score": 1, "last_activity_date": 1479319258, "creation_date": 1479319258, "answer_id": 40639107, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c/40639107#40639107", "title": "Comparing multiple characters in C", "body": "<p>No need for <i>user_guess</i> and <i>computer_guess</i> to be string.</p>\n\n<pre><code>int comp_number,user_number;\nchar user_guess, computer_guess;    \n\nprintf(\"Please enter S (for stone) or K (for Knife) or P (for Paper).\\n\");\nscanf(\"%c\",&amp;user_guess);\ncomp_number = rand() % 3;\n\n/*\n o = stone\n 1 = kinfe\n 2 = paper\n*/\n\nif(user_guess == 'S' || user_guess == 's'){\n    user_number=0;\n    printf(\"You chose Stone\\n\");\n}\nelse if(user_guess == 'K' || user_guess == 'k'){\n    user_number=1;\n    printf(\"You chose Knife\\n\");\n}\nelse{\n    user_number=2;\n    printf(\"You chose Paper\\n\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 1, "last_activity_date": 1479319770, "creation_date": 1479319770, "answer_id": 40639251, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c/40639251#40639251", "title": "Comparing multiple characters in C", "body": "<p>It can be done using <em>ternary-condition</em> operator as well.</p>\n\n<pre><code>scanf(\" %c\",&amp;user_guess);\nint user_number = tolower(user_guess) == 's' ? 0\n                : tolower(user_guess) == 'k' ? 1\n                : tolower(user_guess) == 'p' ? 2\n                : -1; // for error handling\n</code></pre>\n"}], "owner": {"reputation": 854, "user_id": 6012145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/J7riG.jpg?s=128&g=1", "display_name": "Bob Kimani", "link": "https://stackoverflow.com/users/6012145/bob-kimani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2001, "favorite_count": 0, "accepted_answer_id": 40639040, "answer_count": 5, "score": 3, "last_activity_date": 1479320344, "creation_date": 1479317915, "question_id": 40638703, "link": "https://stackoverflow.com/questions/40638703/comparing-multiple-characters-in-c", "title": "Comparing multiple characters in C", "body": "<p>I am making a <strong>stone knife paper</strong> game.(<em>Rock Paper Scissors</em>) In this assignment we have been asked to use numbers for comparison purposes. Hence the need for converting users input '<strong>S</strong>' or '<strong>K</strong>' or '<strong>P</strong>' to <strong>0 , 1 ,2</strong> repectively.I have run into trouble using the <strong>strcmp</strong> funtion which doesn't seem to work due to my limited understanding of pointers and characters.</p>\n\n<pre><code>int comp_number,user_number;\nchar user_guess[1], computer_guess[1];    \nprintf(\"Please enter S (for stone) or K (for Knife) or P (for Paper).\\n\");\n\n    scanf(\"%c\",&amp;user_guess);\n\n    comp_number = rand() % 3;\n\n    /*\n     o = stone\n     1 = kinfe\n     2 = paper\n    */\n\n\n    if(strcmp(user_guess,\"S\")==0 || strcmp(user_guess,\"s\")==0){\n\n        user_number=0;\n\n    }else if(strcmp(user_guess,\"K\")==0 || strcmp(user_guess,\"k\")==0){\n\n        user_number=1;\n\n    }else{\n\n        user_number=2;\n    }\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479320503, "post_id": 40638666, "comment_id": 68511133, "body": "What kind of sockets?"}, {"owner": {"reputation": 123, "user_id": 2306078, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d758b489d1e8d3f2fddba799be3c3e9c?s=128&d=identicon&r=PG", "display_name": "bhargava_sg", "link": "https://stackoverflow.com/users/2306078/bhargava-sg"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479322034, "post_id": 40638666, "comment_id": 68511940, "body": "Thread 1 opens a tcp socket and thread 2 opens a can(controller area network) socket"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1479322205, "post_id": 40638666, "comment_id": 68512034, "body": "Posix sockets I assume?"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479323178, "post_id": 40638666, "comment_id": 68512607, "body": "I am guessing that you are using some kind of embedded operating system running on an 8-bit micro-controller if the maximum file descriptor value is 127. Don&#39;t close the sockets. There should be no need."}, {"owner": {"reputation": 123, "user_id": 2306078, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d758b489d1e8d3f2fddba799be3c3e9c?s=128&d=identicon&r=PG", "display_name": "bhargava_sg", "link": "https://stackoverflow.com/users/2306078/bhargava-sg"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479323871, "post_id": 40638666, "comment_id": 68513014, "body": "@DavidCullen, I am running 32 bit linux on an ARM processor. I was returning the sockfd as int8_t and that explains the 127 limit. But I still want to know how I can make sure the fd number does not grow. The software architecture is such that every message is sent as a new connection so I can not change that."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479325310, "post_id": 40638666, "comment_id": 68513774, "body": "Try calling <code>shutdown</code> with <code>SHUT_RDWR</code> before the <code>close</code> on the TCP socket. When you create the CAN socket, what do you pass to the <code>socket</code> call?"}, {"owner": {"reputation": 123, "user_id": 2306078, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d758b489d1e8d3f2fddba799be3c3e9c?s=128&d=identicon&r=PG", "display_name": "bhargava_sg", "link": "https://stackoverflow.com/users/2306078/bhargava-sg"}, "reply_to_user": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479325686, "post_id": 40638666, "comment_id": 68513979, "body": "@DavidCullen , I use <code>socket(PF_CAN, SOCK_RAW, CAN_RAW)</code>"}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 0, "creation_date": 1479326043, "post_id": 40638666, "comment_id": 68514200, "body": "Try the <code>shutdown</code> with <code>SHUT_RDWR</code> on the CAN socket, but check the return value. Read <a href=\"https://linux.die.net/man/3/shutdown\" rel=\"nofollow noreferrer\">the man page for shutdown</a> to see the expected return values. Who wrote the code for the CAN extensions? Do you have the source?"}], "answers": [{"tags": [], "owner": {"reputation": 4277, "user_id": 1492351, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/27b06d1b6cdf815e86752a61b67435e0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Andriyanov", "link": "https://stackoverflow.com/users/1492351/oleg-andriyanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1479325865, "creation_date": 1479325865, "answer_id": 40641062, "question_id": 40638666, "link": "https://stackoverflow.com/questions/40638666/creating-socket-file-descriptorssock-fd-in-a-multi-threaded-application/40641062#40641062", "title": "Creating socket file descriptors(sock fd) in a multi-threaded application", "body": "<p>The gaps in socket descriptor values are not an evidence of a resource leak. Allocating a file descriptor is a thread-safe operation (probably, as are all system calls).  If you close each socket properly, there will be no leaks.</p>\n\n<p>You can monitor how the number of open file descriptor changes with the following command:</p>\n\n<pre><code>watch --interval=0.5 \"sh -c 'lsof -p YOUR_PROGRAM_PID_HERE | wc -l'\"\n</code></pre>\n\n<p>If the number grows, then probably there are some sockets (or other FDs) not closing.</p>\n\n<p>If you are still not sure if there are descriptor leaks, you may try to count number of open file descriptor programmatically at the exit of your program, either by examining number of entries at /proc/self/fd directory, or by repeatedly trying to close all descriptors and counting how many calls did not return <code>EBADF</code> error. If this number is different each time, then probably there are leaks.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 2306078, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d758b489d1e8d3f2fddba799be3c3e9c?s=128&d=identicon&r=PG", "display_name": "bhargava_sg", "link": "https://stackoverflow.com/users/2306078/bhargava-sg"}, "is_accepted": true, "score": 0, "last_activity_date": 1479413870, "creation_date": 1479413870, "answer_id": 40664247, "question_id": 40638666, "link": "https://stackoverflow.com/questions/40638666/creating-socket-file-descriptorssock-fd-in-a-multi-threaded-application/40664247#40664247", "title": "Creating socket file descriptors(sock fd) in a multi-threaded application", "body": "<p>Turns out, in the can code at one condition I was not closing the fd!</p>\n"}], "owner": {"reputation": 123, "user_id": 2306078, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d758b489d1e8d3f2fddba799be3c3e9c?s=128&d=identicon&r=PG", "display_name": "bhargava_sg", "link": "https://stackoverflow.com/users/2306078/bhargava-sg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 40664247, "answer_count": 2, "score": 0, "last_activity_date": 1479413870, "creation_date": 1479317814, "last_edit_date": 1479323890, "question_id": 40638666, "link": "https://stackoverflow.com/questions/40638666/creating-socket-file-descriptorssock-fd-in-a-multi-threaded-application", "title": "Creating socket file descriptors(sock fd) in a multi-threaded application", "body": "<p>I have a multi-threaded application having 2 threads. Each thread services a different interface. Whenever a message needs to be sent out through an interface, the corresponding thread opens a socket(gets a fd) and sends the  message and closes the fd. The problem is, when I have both the threads running, the sockets are not getting reused, I see fd number to increase inside /proc//fd. I can also verify this from the logs. </p>\n\n<p>The believe the problem is that the thread requests a fd even before the other thread closes it's fd. So the OS returns the next available fd number and this keeps going on. </p>\n\n<p>Thread 1 opens a tcp socket and thread 2 opens a can(controller area network) socket</p>\n\n<pre><code>time    thread1      thread2\n 0       req fd       idle\n 1       fd 1         req fd\n 2       close fd1    fd 2\n 3       req fd       close fd 2\n 4       fd 3         req fd\n 5       close fd 3   fd 4\n</code></pre>\n\n<p>I believe this is what it would look like if I were to write it down. How can I make sure that the fd number doesn't keep growing?  I am running 32 bit linux on an ARM processor.</p>\n"}, {"tags": ["c", "windows", "visual-studio", "visual-studio-2008", "cmake"], "answers": [{"tags": [], "owner": {"reputation": 2013, "user_id": 344159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80787ec11793e168ac24d71ded48b3e7?s=128&d=identicon&r=PG", "display_name": "Oliver Zendel", "link": "https://stackoverflow.com/users/344159/oliver-zendel"}, "is_accepted": false, "score": 0, "last_activity_date": 1520440385, "last_edit_date": 1520440385, "creation_date": 1499766250, "answer_id": 45030920, "question_id": 40638613, "link": "https://stackoverflow.com/questions/40638613/windows-cmake-cannot-find-memset-or-other-standard-functions/45030920#45030920", "title": "Windows cmake cannot find memset or other standard functions", "body": "<p>Remove the linker -nodefaultlib option; this can be set in the IDE GUI at Linker / Input / Ignore All Default Libraries / No</p>\n"}], "owner": {"reputation": 653, "user_id": 1467398, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3142b1089e1d2677de44962108d4c817?s=128&d=identicon&r=PG", "display_name": "Daniel Schreij", "link": "https://stackoverflow.com/users/1467398/daniel-schreij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 778, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520440385, "creation_date": 1479317625, "question_id": 40638613, "link": "https://stackoverflow.com/questions/40638613/windows-cmake-cannot-find-memset-or-other-standard-functions", "title": "Windows cmake cannot find memset or other standard functions", "body": "<p>I am compiling a collection of packages using cmake, often for which I write my own CMakeLists.txt. I have to compile them both using Visual Studio 9 2008 and Visual Studio 14 2015</p>\n\n<p>For VS2015 compilation often completes without problems, but with VS2008 I frequently bump into the problem that cmake doesn't link to or include some standard msvc libraries (or msvc runtime libraries to be specific). As a result, it cannot find <code>memset()</code> if it is called by a module. One of these modules is glew, which has the following output:</p>\n\n<pre><code>Scanning dependencies of target glew\n[  8%] Building C object CMakeFiles/glew.dir/C_/Users/Daniel/OneDrive/src/glew-2.0.0/src/glew.c.obj\nglew.c\n[ 16%] Building RC object CMakeFiles/glew.dir/C_/Users/Daniel/OneDrive/src/glew-2.0.0/build/glew.rc.res\nMicrosoft (R) Windows (R) Resource Compiler Version 6.1.7600.16385\nCopyright (C) Microsoft Corporation.  All rights reserved.\n\n[ 25%] Linking C shared library bin\\glew32.dll\n   Creating library lib\\glew32.lib and object lib\\glew32.exp\nglew.c.obj : error LNK2019: unresolved external symbol memset referenced in function glewContextInit\nbin\\glew32.dll : fatal error LNK1120: 1 unresolved externals\nLINK failed. with 1120\nNMAKE : fatal error U1077: 'C:\\ProgramData\\chocolatey\\lib\\cmake.portable\\tools\\cmake-3.6.1-win32-x86\\bin\\cmake.exe' : return code '0xffffffff'\nStop.\nNMAKE : fatal error U1077: '\"C:\\Users\\Daniel\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9.0\\VC\\Bin\\amd64\\nmake.exe\"' : return code '0x2'\nStop.\nNMAKE : fatal error U1077: '\"C:\\Users\\Daniel\\AppData\\Local\\Programs\\Common\\Microsoft\\Visual C++ for Python\\9.0\\VC\\Bin\\amd64\\nmake.exe\"' : return code '0x2'\nStop.\n</code></pre>\n\n<p>I know I have to <a href=\"https://msdn.microsoft.com/en-us/library/abx4dbyh(v=vs.90).aspx\" rel=\"nofollow noreferrer\">include the libcmt.lib or msvcrt.lib</a> (+headers) to the project, but I have no idea how to. I found some leads <a href=\"https://cmake.org/Wiki/CMake_FAQ#How_can_I_build_my_MSVC_application_with_a_static_runtime.3F\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://braintrekking.wordpress.com/2013/04/27/dll-hell-how-to-include-microsoft-redistributable-runtime-libraries-in-your-cmakecpack-project/\" rel=\"nofollow noreferrer\">here</a> but none have lead me anywhere so far. \nIs there also a way I could do this when calling cmake from the command line (and thus without having to edit or patch the CMakeLists.txt files themselves)?\nThanks for any insights!</p>\n"}, {"tags": ["c", "assembly", "arm", "constraints", "inline-assembly"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1479325958, "post_id": 40638326, "comment_id": 68514135, "body": "No, &quot;r&quot; doesn&#39;t mean read-only, it just means &quot;general purpose register&quot;. Arguments that you specify in the input list are read only, no matter what constraint you use."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1479329915, "post_id": 40638326, "comment_id": 68516439, "body": "See <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#InputOperands\" rel=\"nofollow noreferrer\">this</a> for details about input parameters and <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html#Simple-Constraints\" rel=\"nofollow noreferrer\">this</a> for details of simple constraints (like <code>&quot;r&quot;</code>).  You might also want to look <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Machine-Constraints.html\" rel=\"nofollow noreferrer\">here</a> for constraints specific to the &quot;ARM Family.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "edited": false, "score": 0, "creation_date": 1479482864, "post_id": 40640852, "comment_id": 68591315, "body": "The combination of early-clobber and read-write is significant as if 2 inputs have the same value they can be the same register."}], "tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": false, "score": 2, "last_activity_date": 1479328218, "last_edit_date": 1479328218, "creation_date": 1479325141, "answer_id": 40640852, "question_id": 40638326, "link": "https://stackoverflow.com/questions/40638326/inline-assembly-clarification-of-constraint-modifiers/40640852#40640852", "title": "Inline assembly: clarification of constraint modifiers", "body": "<p>Read-only refers to the use of the operand in assembly code. The assembly code can only read from the operand, and it must do so before any normal output operand (not an early clobber or a read/write operand) is written. This is because, as you've seen, the same register can be allocated to both an input and output operand. The assumption is that inputs are fully consumed before any output is written, which is normally the case for an assembly instruction.</p>\n\n<p>I don't think using an early-clobber modifier <code>&amp;</code> with an read/write modifier <code>+</code> has any effect since a register allocated to a read/write operand can't be used for anything else.</p>\n\n<p>Here's how I'd write your code:</p>\n\n<pre><code>unsigned power = 1;\nasm (\n    \"    CBZ   %[exp],done%=             \\n\\t\"\n    \"loop%=:                             \\n\\t\"\n    \"    LSRS  %[exp],%[exp],1           \\n\\t\"\n    \"    IT    CS                        \\n\\t\"\n    \"    MULCS %[power],%[power],%[base] \\n\\t\"\n    \"    MUL   %[base],%[base],%[base]   \\n\\t\"\n    \"    BNE   loop%=                    \\n\\t\"\n    \"done%=:                                 \"\n    : [power] \"+r\" (power),\n      [base]  \"+r\" (base),\n      [exp]   \"+r\" (exp)\n    :\n    : \"cc\"\n    ) ;\n</code></pre>\n\n<p>Note the transformation of putting the loop test at the end of the loop, saving one instruction. Without it the code doesn't have any obvious improvement over what the compiler can generate.  I also let the compiler do the initialization of the register used for the <code>power</code> operand.  There's a small chance it will be able to allocate a register that already has the value 1 in it.</p>\n"}, {"comments": [{"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 1, "creation_date": 1480890747, "post_id": 40955906, "comment_id": 69138451, "body": "I think I prefer &quot;<code>&quot;=r&quot;(x)</code>: On input to the asm, the contents of this register are undefined (unless combined with a matching input constraint), and on output, the register will contain the value for the variable <code>x</code>. And &quot;<code>&quot;+r&quot;(x)</code>: The existing value of <code>x</code> is passed as input, which may be updated by the asm instructions.&quot;  And &quot;See also the <code>&amp;</code> modifier to prevent input and output constraints from sharing registers.&quot;"}, {"owner": {"reputation": 71, "user_id": 6195583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0RdoX.jpg?s=128&g=1", "display_name": "Dan Lewis", "link": "https://stackoverflow.com/users/6195583/dan-lewis"}, "reply_to_user": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1480908338, "post_id": 40955906, "comment_id": 69142873, "body": "David, I&#39;m confused by &quot;(unless combined with a matching input constraint)&quot;. I thought that anything listed as an Input Operand was by definition &quot;read-only&quot; and thus would be in conflict with listing the same thing as an Output Operand. Or do I misunderstand what you mean?"}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1480909992, "post_id": 40955906, "comment_id": 69143193, "body": "As discussed <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#InputOperands\" rel=\"nofollow noreferrer\">here</a>, input constraints can be digits.  So <code>asm(&quot;&quot; : &quot;=r&quot;(x) : &quot;0&quot; (y));</code>  means that <code>y</code> is an input and goes into the same place as parameter #0.  Or to put it another way: On input, the register will contain <code>y</code>, and on output it will contain <code>x</code>.  This also means that <code>asm(&quot;&quot; : &quot;=r&quot;(x) : &quot;0&quot; (x));</code> is a synonym for <code>asm(&quot;&quot; : &quot;+r&quot;(x));</code>."}, {"owner": {"reputation": 6093, "user_id": 2189500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/109f747845a9ce762a1fff72eb8cf6f3?s=128&d=identicon&r=PG", "display_name": "David Wohlferd", "link": "https://stackoverflow.com/users/2189500/david-wohlferd"}, "edited": false, "score": 0, "creation_date": 1480910746, "post_id": 40955906, "comment_id": 69143348, "body": "For an entertaining and educational bit of code (if not particularly practical), look at <a href=\"http://stackoverflow.com/a/24841962/2189500\">this</a> which allows you to &#39;swap&#39; the values of 2 variables without using a single line of assembler.  And yes, I&#39;m stretching the definition of &#39;swap.&#39;  A lot.  For example if you printf the 2 variables, &#39;swap&#39; them, then printf them again, while <i>you</i> may not have to write any assembler, the compiler will just end up doing it for you."}], "tags": [], "owner": {"reputation": 71, "user_id": 6195583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0RdoX.jpg?s=128&g=1", "display_name": "Dan Lewis", "link": "https://stackoverflow.com/users/6195583/dan-lewis"}, "is_accepted": false, "score": 1, "last_activity_date": 1480831272, "creation_date": 1480831272, "answer_id": 40955906, "question_id": 40638326, "link": "https://stackoverflow.com/questions/40638326/inline-assembly-clarification-of-constraint-modifiers/40955906#40955906", "title": "Inline assembly: clarification of constraint modifiers", "body": "<p>Thanks to all of you for the clarification. Just to be sure that I have it right, would it be correct to say that the choice between \"=r\" and \"+r\" for an output operand comes down to how the corresponding register is <strong><em>first</em></strong> used in the assembly template? I.e.,</p>\n\n<p><strong>\"=r\":  The first use of the register is as a write-only output of an instruction.</strong> </p>\n\n<p><em>The register may be re-used later by another instruction as an input or output. Adding an early clobber constraint (e.g., \"=&amp;r\") prevents the compiler from assigning a register that was previously used as an input operand.</em></p>\n\n<p><strong>\"+r\":  The first use of the register is as an input to an instruction, but the register is used again later as an output.</strong></p>\n\n<p>Best,</p>\n\n<p>Dan</p>\n"}], "owner": {"reputation": 71, "user_id": 6195583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0RdoX.jpg?s=128&g=1", "display_name": "Dan Lewis", "link": "https://stackoverflow.com/users/6195583/dan-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1480831272, "creation_date": 1479316670, "last_edit_date": 1479318971, "question_id": 40638326, "link": "https://stackoverflow.com/questions/40638326/inline-assembly-clarification-of-constraint-modifiers", "title": "Inline assembly: clarification of constraint modifiers", "body": "<p>Two questions:</p>\n\n<p>(1) If I understand ARM inline assembly correctly, a constraint of \"r\" says that the instruction operand can only be a core register and that by default is a read-only operand. However, I've noticed that if the same instruction has an output operand with the constraint \"=r\", the compiler may re-use the same register. This seems to violate the \"read-only\" attribute. So my question is: Does \"read-only\" refer to the register, or to the C variable that it is connected to?</p>\n\n<p>(2) Is it correct to say that presence of \"&amp;\" in the constraint of \"=&amp;r\" simply requires that the register chosen for the output operand must not be the same as one of the input operand registers? My question relates to the code below used to compute the integer power function: i.e., are the \"&amp;\" constraint modifiers necessary/appropriate?</p>\n\n<pre><code>asm (\n\"    MOV   %[power],1                \\n\\t\"\n\"loop%=:                             \\n\\t\"\n\"    CBZ   %[exp],done%=             \\n\\t\"\n\"    LSRS  %[exp],%[exp],1           \\n\\t\"\n\"    IT    CS                        \\n\\t\"\n\"    MULCS %[power],%[power],%[base] \\n\\t\"\n\"    MUL   %[base],%[base],%[base]   \\n\\t\"\n\"    B     loop%=                    \\n\\t\"\n\"done%=:                                 \"\n: [power] \"+&amp;r\" (power)\n  [base]  \"+&amp;r\" (base)\n  [exp]   \"+&amp;r\" (exp)\n:\n: \"cc\"\n) ;\n</code></pre>\n\n<p>Thanks!\nDan</p>\n"}, {"tags": ["c", "string", "pointers", "multidimensional-array", "struct"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479316599, "post_id": 40638256, "comment_id": 68508768, "body": "You have conceptual issue: You <i>cannot</i> store <b><i>four</i></b> <code>char</code> arrays (<code>{&quot;Ab\\0&quot;, &quot;Cd\\0&quot;, &quot;Ef\\0&quot;, &quot;Gh\\0&quot;};</code> here) under  <b><i>one</i></b> <code>char</code>-pointer (<code>char *text;</code> here) only, at least not in sane way. The compiler warnings are a hint to this issue."}, {"owner": {"reputation": 2063, "user_id": 473890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f99ad93b98334809733352b22922d6d?s=128&d=identicon&r=PG", "display_name": "xZise", "link": "https://stackoverflow.com/users/473890/xzise"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479316861, "post_id": 40638256, "comment_id": 68508940, "body": "That is basically what I&#39;m asking: How else can I store them in a struct?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479316863, "post_id": 40638256, "comment_id": 68508942, "body": "OT: <code>&quot;Ab\\0&quot;</code> is represented internally as <code>{&#39;A&#39;, &#39;b&#39;, &#39;\\0&#39;, &#39;\\0&#39;}</code>, so you probably do not want to place the <code>&#39;\\0&#39;</code> explicitly."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479316932, "post_id": 40638256, "comment_id": 68508994, "body": "It&#39;s not a matter of whether you use a struct or not. The conceptual mistake lies in trying to use just a <code>char*</code>, which would point to exactly <b><i>one</i></b> <code>char</code>, or exactly <b><i>one</i></b> a C-&quot;string&quot;."}, {"owner": {"reputation": 2063, "user_id": 473890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f99ad93b98334809733352b22922d6d?s=128&d=identicon&r=PG", "display_name": "xZise", "link": "https://stackoverflow.com/users/473890/xzise"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479317056, "post_id": 40638256, "comment_id": 68509080, "body": "I don&#39;t understand what you are trying to say. I don&#39;t question the existence of a <code>struct</code>. I&#39;m asking on how I can store this array in the <code>struct</code>, and it doesn&#39;t need to be a <code>char*</code>, but otherwise I wouldn&#39;t have this example code."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1479317169, "post_id": 40638256, "comment_id": 68509166, "body": "Change the member <code>char * text</code> to be a <code>char (*)[3]</code> as well: Make it <code>char (*text)[3]</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479317447, "post_id": 40638256, "comment_id": 68509346, "body": "Referring my other comment (<a href=\"http://stackoverflow.com/questions/40638256/store-multidimensional-array-in-struct#comment68508942_40638256\" title=\"store multidimensional array in struct%23comment68508942_40638256\">stackoverflow.com/questions/40638256/&hellip;</a>): The strings in the initialiser are of size <b><i>4</i></b>. So you actually want the member (and the function parameter)  to be <code>char(*text)[4]</code>. Or remove the explicit <code>&#39;\\0&#39;</code> and do just: <code>...=  {&quot;Ab&quot;, &quot;Cd&quot;, &quot;Ef&quot;, &quot;Gh&quot;};</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1479317463, "post_id": 40638256, "comment_id": 68509355, "body": "when ever calling any of the heap memory allocation functions: (malloc, calloc, realloc), always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1479318479, "post_id": 40638256, "comment_id": 68509925, "body": "@xZise What is the sense to keep a pointer to an array in the structure? In this case either all objects of the structure type will point to the same array or for each object of the structure type you have to create an array that will be pointed to by the structure data member."}], "answers": [{"comments": [{"owner": {"reputation": 2063, "user_id": 473890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f99ad93b98334809733352b22922d6d?s=128&d=identicon&r=PG", "display_name": "xZise", "link": "https://stackoverflow.com/users/473890/xzise"}, "edited": false, "score": 0, "creation_date": 1479318478, "post_id": 40638425, "comment_id": 68509924, "body": "I almost got it but placed the brackets wrongly (used <code>*(text[3])</code>). Appreciate the additional comments, though this code was only to extract the issue I had."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 2063, "user_id": 473890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f99ad93b98334809733352b22922d6d?s=128&d=identicon&r=PG", "display_name": "xZise", "link": "https://stackoverflow.com/users/473890/xzise"}, "edited": false, "score": 0, "creation_date": 1479318684, "post_id": 40638425, "comment_id": 68510061, "body": "I know @xZise, that&#39;s why my last sentence! I had to look it up myself, that&#39;s why I linked you the answer I checked before writing this answer! :) Good question by the way, very refreshing!"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 1, "last_activity_date": 1479318097, "last_edit_date": 1495541624, "creation_date": 1479317042, "answer_id": 40638425, "question_id": 40638256, "link": "https://stackoverflow.com/questions/40638256/store-multidimensional-array-in-struct/40638425#40638425", "title": "Store multidimensional array in struct", "body": "<p>Use:</p>\n\n<pre><code>char (*text)[3];\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>char *\n</code></pre>\n\n<p>since what you want here is a pointer to your 2D array, not a pointer to single <code>char</code>. Read more in <a href=\"https://stackoverflow.com/questions/14808908/c-pointer-to-two-dimensional-array\">C pointer to two dimensional array</a>. </p>\n\n<p>Of course, it is suggested to use a define, or something similar for your dimension, instead of the hardcoded 3, like in my example.</p>\n\n<hr>\n\n<p>Min. Example:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n#define M 3\n\nstruct payload_s {\n    size_t length;\n    char (*text)[M]; // change the member!\n};\n\ntypedef struct payload_s payload;\n\n// not need for null terminators in the strings,\n// it will be placed automatically\nstatic char some_text[4][M] = {\"Ab\", \"Cd\", \"Ef\", \"Gh\"};\n\n// change the prototype as well\npayload* create_payload(char (*text)[M], size_t length)\n{\n    payload *p = malloc(sizeof *p);\n    p-&gt;text = text;\n    p-&gt;length = length;\n    return p;\n}\n\nint main()\n{\n    payload *p = create_payload(some_text, 4);\n    for (size_t i = 0; i &lt; p-&gt;length; ++i)\n        // no need to print the address now\n        // also 'zu' should be used for 'size_t'\n        printf(\"%zu: %s\\n\", i, p-&gt;text[i]);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ gcc -Wall main.c \nGeorgioss-MacBook-Pro:~ gsamaras$ ./a.out \n0: Ab\n1: Cd\n2: Ef\n3: Gh\n</code></pre>\n\n<hr>\n\n<p>PS - Check what <code>malloc()</code> returns, to see if the memory was actually allocated (of course on real code, not in min. egs).</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1479320062, "last_edit_date": 1479320062, "creation_date": 1479317217, "answer_id": 40638494, "question_id": 40638256, "link": "https://stackoverflow.com/questions/40638256/store-multidimensional-array-in-struct/40638494#40638494", "title": "Store multidimensional array in struct", "body": "<p>this line:</p>\n\n<pre><code>static char some_text[4][3] = {\"Ab\\0\", \"Cd\\0\", \"Ef\\0\", \"Gh\\0\"};\n</code></pre>\n\n<p>is trying to initialize an array of 3 bytes in each entry with values that are 4 bytes in each entry.</p>\n\n<p>note: \"AB\\0\" is 4 bytes because declaring a char array Always appends a NUL byte to the end of the array.</p>\n\n<p>Suggest:</p>\n\n<pre><code>static char some_text[4][3] = {\"Ab\", \"Cd\", \"Ef\", \"Gh\"};\n</code></pre>\n\n<p>The call to <code>printf()</code> contains several errors, which your compiler should have told you about.</p>\n\n<p>The field: <code>char *text;</code>  is actually pointing to a 2D array, so should be declared accordingly.</p>\n\n<p>Need to perform error checking on the call to <code>malloc()</code>.</p>\n\n<p>here is a version of the code, will all (reasonable) corrections applied.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct payload_s \n{\n    size_t length;\n    char **text;\n};\n\n\nstatic char *some_text[] = {\"Ab\", \"Cd\", \"Ef\", \"Gh\"};\n\nstruct payload_s* create_payload(char **text, size_t length)\n{\n    payload *p = malloc(sizeof (struct payload_s));\n    if( !p )\n    {\n        perror( \"malloc for instance of payload failed\" );\n        exit( EXIT_FAILURE );\n    }\n\n    // implied else, malloc successful\n\n    p-&gt;text = text;\n    p-&gt;length = length;\n    return p;\n}\n\nint main( void )\n{\n    //payload *p = create_payload(some_text, 4);\n    payload *p = create_payload(some_text, sizeof(some_text) / sizeof( *some_text ) );\n    for (size_t i = 0; i &lt; p-&gt;length; ++i)\n        printf(\"%lu: %s\\n\", i, p-&gt;text[i]);\n}\n</code></pre>\n\n<p>The result of the above code is:</p>\n\n<pre><code>0: Ab\n1: Cd\n2: Ef\n3: Gh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1479320614, "creation_date": 1479320614, "answer_id": 40639504, "question_id": 40638256, "link": "https://stackoverflow.com/questions/40638256/store-multidimensional-array-in-struct/40639504#40639504", "title": "Store multidimensional array in struct", "body": "<p>You are using incompatible pointers that can not be converted implicitly to each other.</p>\n\n<p>Character array <code>some_text</code> declared like</p>\n\n<pre><code>static char some_text[4][3] = {\"Ab\\0\", \"Cd\\0\", \"Ef\\0\", \"Gh\\0\"};\n</code></pre>\n\n<p>when it is used in expression as for example used as an argument it is implicitly converted to pointer to its first element and has type <code>char ( * )[3]</code>. It si not the same as pointer of type <code>char *</code>.</p>\n\n<p>It looks like you need a structure with a flexible array. </p>\n\n<p>Here is a demonstrative program that shows how such a structure can be used.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define N   3\n\nstruct payload_s \n{\n    size_t length;\n    char text[][N];\n};\n\nstruct payload_s * create_payload( char( *text )[N], size_t length )\n{\n    struct payload_s *p = malloc( sizeof( struct payload_s ) + \n                                  length * sizeof( char[N] ) );\n\n    p-&gt;length = length;\n\n    for ( size_t i = 0; i &lt; length; i++ ) strcpy( p-&gt;text[i], text[i] );\n\n    return p;\n}\n\nvoid free_payload( struct payload_s *p )\n{\n    free( p );\n}\n\nint main(void) \n{\n    char some_text[4][N] = {\"Ab\", \"Cd\", \"Ef\", \"Gh\"};\n    char another_text[5][N] = {\"Bb\", \"Dd\", \"Ff\", \"Hh\", \"Jj\"};\n\n    struct payload_s *p1 = create_payload( some_text, \n        sizeof( some_text ) / sizeof( *some_text ) );\n\n    struct payload_s *p2 = create_payload( another_text, \n        sizeof( another_text ) / sizeof( *another_text ) );\n\n    for ( size_t i = 0; i &lt; p1-&gt;length; i++ )\n    {\n        printf( \"%s \", p1-&gt;text[i] );\n    }\n    printf( \"\\n\" );\n\n    for ( size_t i = 0; i &lt; p2-&gt;length; i++ )\n    {\n        printf( \"%s \", p2-&gt;text[i] );\n    }\n    printf( \"\\n\" );\n\n    free_payload( p2 );\n    free_payload( p1 );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>Ab Cd Ef Gh \nBb Dd Ff Hh Jj \n</code></pre>\n"}], "owner": {"reputation": 2063, "user_id": 473890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5f99ad93b98334809733352b22922d6d?s=128&d=identicon&r=PG", "display_name": "xZise", "link": "https://stackoverflow.com/users/473890/xzise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "accepted_answer_id": 40638425, "answer_count": 3, "score": 1, "last_activity_date": 1479328462, "creation_date": 1479316417, "last_edit_date": 1479328462, "question_id": 40638256, "link": "https://stackoverflow.com/questions/40638256/store-multidimensional-array-in-struct", "title": "Store multidimensional array in struct", "body": "<p>I have a two dimensional array where the first dimension has a variable length but the second dimension is fixed. Now in a function call I could do something like <code>char foo[][3]</code> but what is the corresponding definition in a <code>struct</code>?</p>\n\n<p>So in the example code I expected it to print each string in a line, but as expected it treats the stored pointer as a single dimensional array.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct payload_s {\n    size_t length;\n    char *text;\n};\n\ntypedef struct payload_s payload;\n\nstatic char some_text[4][3] = {\"Ab\", \"Cd\", \"Ef\", \"Gh\"};\n\npayload* create_payload(char *text, size_t length)\n{\n    payload *p = malloc(sizeof *p);\n    p-&gt;text = text;\n    p-&gt;length = length;\n    return p;\n}\n\nint main()\n{\n    payload *p = create_payload(some_text, 4);\n    for (size_t i = 0; i &lt; p-&gt;length; ++i)\n        printf(\"%zu: %s\\n\", i, &amp;p-&gt;text[i]);\n}\n</code></pre>\n\n<p>I mainly noticed this because of a warning:</p>\n\n<pre><code>strut.c: In function \u2018main\u2019:\nstrut.c:23:33: warning: passing argument 1 of \u2018create_payload\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n     payload *p = create_payload(some_text, 4);\n                                 ^~~~~~~~~\nstrut.c:13:10: note: expected \u2018char *\u2019 but argument is of type \u2018char (*)[3]\u2019\n payload* create_payload(char *text, size_t length)\n          ^~~~~~~~~~~~~~\n</code></pre>\n\n<p>I can get rid of this warning when the function is actually defined as <code>payload* create_payload(char text[][3], size_t length)</code>, but then there is a warning a few lines later and the behavior didn't change:</p>\n\n<pre><code>strut.c: In function \u2018create_payload\u2019:\nstrut.c:16:13: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n     p-&gt;text = text;\n             ^\n</code></pre>\n\n<p>Is the only solution to manually increment the pointer by the length of each value?</p>\n"}, {"tags": ["python", "c", "uart"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479316910, "post_id": 40638036, "comment_id": 68508975, "body": "We won&#39;t write the code for you. What have you done so far? Have you done any research on serial communication with C?"}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479317149, "post_id": 40638036, "comment_id": 68509143, "body": "I already did that and i am not waiting for anyone to write  code for me, i just need some idea, however there is no answer and no idea  at  all,"}, {"owner": {"reputation": 4975, "user_id": 2323393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52f68fba51eda4b59593a83a3c1250?s=128&d=identicon&r=PG", "display_name": "scotty3785", "link": "https://stackoverflow.com/users/2323393/scotty3785"}, "edited": false, "score": 0, "creation_date": 1479317655, "post_id": 40638036, "comment_id": 68509476, "body": "Why no read it using python? Seems like a fools errand"}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "edited": false, "score": 0, "creation_date": 1479319087, "post_id": 40638036, "comment_id": 68510325, "body": "I just need to enter my hello then use it in a code c that is  it really, but i don&#39;t  find the best way to do that."}, {"owner": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1479320006, "post_id": 40638036, "comment_id": 68510870, "body": "PySerial should use in background some C library so check its source code."}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "reply_to_user": {"reputation": 92215, "user_id": 1832058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/relWs.jpg?s=128&g=1", "display_name": "furas", "link": "https://stackoverflow.com/users/1832058/furas"}, "edited": false, "score": 0, "creation_date": 1479322657, "post_id": 40638036, "comment_id": 68512307, "body": "Thank you very much @furas"}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1479341126, "post_id": 40638036, "comment_id": 68521048, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7385228/serial-port-rs232-communication-with-visual-c-2010\">Serial Port (RS232) communication with Visual C++ 2010</a>"}], "owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479316807, "creation_date": 1479315840, "last_edit_date": 1479316807, "question_id": 40638036, "link": "https://stackoverflow.com/questions/40638036/how-to-read-a-string-from-a-port-communication", "title": "how to read a string from a port communication?", "body": "<p>I am really a beginner, \nI send a string  'hello' from a serial Port communication to my module. For that I use Python and Pyserial. </p>\n\n<pre><code>import serial\n\nser = serial.Serial(\n    port='COM4', \\\n    baudrate= 230400  # open serial port\n)\n\nprint(ser.name)         # check which port was really used\n#ser.write(b'hello\\n')     # write a string\n#str=ser.readline()\n\nwhile True:\n    print(ser.read(30).decode())\nser.close()             # close ports\n</code></pre>\n\n<p>Now I need to recover that string by using my module  then read it on the communication port by using C language.</p>\n\n<p>I would be very grateful really if you could help me please. </p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1479315942, "post_id": 40638030, "comment_id": 68508316, "body": "It reads the first <code>sizeof(size_t)</code> bytes at the memory location. If someone wrote the size of the memory block there, you can read it from the location."}, {"owner": {"reputation": 607, "user_id": 1316213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaae34cff87878329ac8a8a1bb7f368?s=128&d=identicon&r=PG", "display_name": "Youssef G.", "link": "https://stackoverflow.com/users/1316213/youssef-g"}, "edited": false, "score": 0, "creation_date": 1479316182, "post_id": 40638030, "comment_id": 68508500, "body": "you would use &quot;&amp;&quot; to get the pointer. &quot;*&quot; deferences the pointer and gets your value."}, {"owner": {"reputation": 87, "user_id": 7133242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/shyRU.jpg?s=128&g=1", "display_name": "rafiya", "link": "https://stackoverflow.com/users/7133242/rafiya"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479316280, "post_id": 40638030, "comment_id": 68508559, "body": "@mch thanks for your response So if I used *(int *)mem, this would read the first sizeof(int) bytes at the location?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1479316335, "post_id": 40638030, "comment_id": 68508597, "body": "You cannot test memory to see if it&#39;s there or not. You need to know by some other means."}, {"owner": {"reputation": 87, "user_id": 7133242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/shyRU.jpg?s=128&g=1", "display_name": "rafiya", "link": "https://stackoverflow.com/users/7133242/rafiya"}, "reply_to_user": {"reputation": 607, "user_id": 1316213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaae34cff87878329ac8a8a1bb7f368?s=128&d=identicon&r=PG", "display_name": "Youssef G.", "link": "https://stackoverflow.com/users/1316213/youssef-g"}, "edited": false, "score": 0, "creation_date": 1479316373, "post_id": 40638030, "comment_id": 68508627, "body": "@YoussefG. right but I was confused by the series of two asterisks. so I know (size_t *)ptr would be casting pointer into size_t value. However don&#39;t intuitively understand what the second asterisk does here"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1479316501, "post_id": 40638030, "comment_id": 68508703, "body": "<code>(size_t *)ptr</code> casts <code>ptr</code> to a pointer to <code>size_t</code> (aka <code>size_t *</code>), the * before this expression dereference the pointer to get the value."}, {"owner": {"reputation": 87, "user_id": 7133242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/shyRU.jpg?s=128&g=1", "display_name": "rafiya", "link": "https://stackoverflow.com/users/7133242/rafiya"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479316562, "post_id": 40638030, "comment_id": 68508746, "body": "@mch wow that finally makes sense. thanks."}, {"owner": {"reputation": 607, "user_id": 1316213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecaae34cff87878329ac8a8a1bb7f368?s=128&d=identicon&r=PG", "display_name": "Youssef G.", "link": "https://stackoverflow.com/users/1316213/youssef-g"}, "edited": false, "score": 0, "creation_date": 1479316845, "post_id": 40638030, "comment_id": 68508928, "body": "Actually its casting it to a &quot;size *&quot;.  for example if your ptr was originally a (void *), it gives a type that can be derefenced.  it equivalent to declaring ptr like this: size_t * ptr;.  After that everything is like normal pointer ref/deref."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1479326954, "creation_date": 1479326954, "answer_id": 40641379, "question_id": 40638030, "link": "https://stackoverflow.com/questions/40638030/can-i-use-typecasts-in-c-to-get-the-size-of-memory-at-a-pointer-to-an-address/40641379#40641379", "title": "Can I use typecasts in C to get the size of memory at a pointer to an address?", "body": "<p>There is <em>no</em> general way to determine the size of the allocated memory to which a given pointer points. or even whether it points to a valid object. There might be some system-specific ways to determine something similar, but they're likely to be unreliable -- and they can't determine that a pointer points to a valid object, but not to the one that it's supposed to point to.</p>\n\n<p>You'll just have to keep careful track of this information yourself.</p>\n\n<p>The method you describe:</p>\n\n<pre><code>file_size = *(size_t *)ptr;\n</code></pre>\n\n<p>can work <em>if</em> the memory happens to have been allocated by something that specifically stores the size at the beginning of the allocated region -- but only if you already know that <code>ptr</code> is valid.</p>\n\n<p><code>ptr</code> could be a pointer of any type (other than a function pointer). The cast <code>(size_t *)</code> <em>converts</em> the value of <code>ptr</code> so you can treat it as a pointer to a <code>size_t</code> object (<code>size_t</code> is an unsigned integer type used to represent sizes).  Dereferencing that <code>size_t*</code> value with the <code>*</code> dereference operator gives you the value of the <code>size_t</code> object.</p>\n\n<p>Here's an example of a hypothetical allocation function that might work this way:</p>\n\n<pre><code>void *allocate(size_t size) {\n    void *result = malloc(sizeof (size_t) + size);\n    if (result != NULL) {\n        *(size_t*)result = size;\n    }\n    return result;\n}\n</code></pre>\n\n<p>and a function that gives you the currently allocated size:</p>\n\n<pre><code>size_t curr_size(void *ptr) {\n    return *(size_t*)ptr;\n}\n</code></pre>\n\n<p><strong>NOTE</strong> that this ignores alignment issues. If you're allocating memory for something that requires stricter alignment that <code>size_t</code> does, this can fail badly.</p>\n"}], "owner": {"reputation": 87, "user_id": 7133242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/shyRU.jpg?s=128&g=1", "display_name": "rafiya", "link": "https://stackoverflow.com/users/7133242/rafiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "accepted_answer_id": 40641379, "answer_count": 1, "score": 2, "last_activity_date": 1479326954, "creation_date": 1479315822, "last_edit_date": 1479316268, "question_id": 40638030, "link": "https://stackoverflow.com/questions/40638030/can-i-use-typecasts-in-c-to-get-the-size-of-memory-at-a-pointer-to-an-address", "title": "Can I use typecasts in C to get the size of memory at a pointer to an address?", "body": "<p>I'm trying to use shared memory segments in POSIX and am having a lot of trouble figuring out if there is memory at a certain address. </p>\n\n<p>I saw a solution that uses <code>file_size = *(size_t *)ptr</code></p>\n\n<p>Where ptr is the returned pointer from some call to <code>mmap (.... )</code></p>\n\n<p>I don't really understand how this works. What does <code>*(size_t *)</code> typecasting do? I assume it <code>(size_t)*var</code> would cast the value at pointer var to a <code>size_t</code> type. But then, when I put another asterisk... this would give me a pointer again, wouldn't it? </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 834, "user_id": 7131047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1cf5eb86c98bcf94e80e722fff20e?s=128&d=identicon&r=PG&f=1", "display_name": "Fefux", "link": "https://stackoverflow.com/users/7131047/fefux"}, "edited": false, "score": 3, "creation_date": 1479314972, "post_id": 40637529, "comment_id": 68507654, "body": "This is not enough to answer. Are input, name, acct, amt initialized? Did you check if malloc return NULL or not? I see you don&#39;t check how many characters fscanf reads... Post also your code which initializes all your arguments"}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 1, "creation_date": 1479315029, "post_id": 40637529, "comment_id": 68507692, "body": "Did you allocate memory for all those values?  Show us how you call <code>load_data</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1479315676, "post_id": 40637529, "comment_id": 68508133, "body": "OT: <code>acct = a;</code> and <code>amt = b;</code> are useless, as the functions is left anyway, and their values are lost. They are just copies of the values pass to the functions."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479315755, "post_id": 40637529, "comment_id": 68508190, "body": "OT^2 : All those <code>i</code>s and <code>n</code>s should be <code>size_t</code> not <code>int</code>."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1479315938, "post_id": 40637529, "comment_id": 68508314, "body": "OT^3: Doing <code>name[i]</code> instead of  <code>*(name+i)</code> is more common, more clear, less misunderstandable, error-prone."}, {"owner": {"reputation": 13, "user_id": 7168591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82dca920f80a21219fce34fbfba24224?s=128&d=identicon&r=PG&f=1", "display_name": "Gtt123", "link": "https://stackoverflow.com/users/7168591/gtt123"}, "edited": false, "score": 0, "creation_date": 1479319813, "post_id": 40637529, "comment_id": 68510763, "body": "This is an assignment in class to practice pointer so i can&#39;t use any [ ] bracket"}, {"owner": {"reputation": 432, "user_id": 415380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca3ac132a345bc2a6a7f9f14386977?s=128&d=identicon&r=PG", "display_name": "tribeca", "link": "https://stackoverflow.com/users/415380/tribeca"}, "edited": false, "score": 0, "creation_date": 1479327795, "post_id": 40637529, "comment_id": 68515203, "body": "<code>name[i] = NULL;</code> is just the same as <code>*(name+i) = NULL;</code> it can be useful to know that when thinking about pointer arithmetic."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1479315794, "post_id": 40637946, "comment_id": 68508223, "body": "What do the pointers in your <code>char **name</code> array of character pointers point to?"}, {"owner": {"reputation": 432, "user_id": 415380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca3ac132a345bc2a6a7f9f14386977?s=128&d=identicon&r=PG", "display_name": "tribeca", "link": "https://stackoverflow.com/users/415380/tribeca"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1479317039, "post_id": 40637946, "comment_id": 68509066, "body": "In this example char **name is a pointer to more pointers. If you look later you will see that the name array is being filled with n pointers to n blocks of memory (allocated by malloc) for use in the load_data function."}, {"owner": {"reputation": 13, "user_id": 7168591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82dca920f80a21219fce34fbfba24224?s=128&d=identicon&r=PG&f=1", "display_name": "Gtt123", "link": "https://stackoverflow.com/users/7168591/gtt123"}, "edited": false, "score": 0, "creation_date": 1479324218, "post_id": 40637946, "comment_id": 68513200, "body": "I added my main function"}, {"owner": {"reputation": 432, "user_id": 415380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca3ac132a345bc2a6a7f9f14386977?s=128&d=identicon&r=PG", "display_name": "tribeca", "link": "https://stackoverflow.com/users/415380/tribeca"}, "edited": false, "score": 0, "creation_date": 1479327514, "post_id": 40637946, "comment_id": 68515033, "body": "Hello Gtt123, as I said your problem is that you have not correctly initialised the name character pointer array. name is a pointer to a block of memory that contains pointers. <code>name = malloc(10*sizeof(char*));</code> is the pointer to your pointers then you can allocate separate space for each element... <code>*(name+0) = malloc(128);</code> or <code>name[0] = malloc(128);</code> allocates 128 bytes to the first element. Otherwise you should skip a set number of bytes each time around the loop <code>char *name; name=malloc(10*128*sizeof(char)); for (int i=0;i&lt;10;i++){sscanf(file,&quot;%s&quot;,name);name=name+(128);}</code>"}], "tags": [], "owner": {"reputation": 432, "user_id": 415380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfca3ac132a345bc2a6a7f9f14386977?s=128&d=identicon&r=PG", "display_name": "tribeca", "link": "https://stackoverflow.com/users/415380/tribeca"}, "is_accepted": true, "score": 1, "last_activity_date": 1479374176, "last_edit_date": 1479374176, "creation_date": 1479315590, "answer_id": 40637946, "question_id": 40637529, "link": "https://stackoverflow.com/questions/40637529/reading-file-using-fscanf-is-not-working-in-c/40637946#40637946", "title": "Reading file using fscanf is not working in c?", "body": "<p>I expect that you have not properly prepared the arrays before calling the function... the below main function will work with your code:</p>\n\n<pre><code>int main(int argc, char* argv[]) {\n    int n = 10;\n    char ** name = malloc(n * sizeof(char*));\n    int* acct = malloc(n * sizeof(int));\n    float* amt = malloc(n * sizeof(float));\n    for (int i = 0; i &lt; n; i++) {\n        // this is allocating some space for each line\n        // this is quite bad you should range check.\n        name[i] = malloc(256);\n    }\n    load_data(\"\", name, acct, amt, n);\n    print_data(name, acct, amt, n);\n    // TODO: free everything\n}\n</code></pre>\n\n<p>in <code>load_data</code>: <code>a</code> and <code>b</code> are not required and as <code>amt</code> and <code>acct</code> are \"passed by value\" there is no need to restore their values at the end of your function. That is to say that the values in all your arguments will be discarded when this function returns only the values that are \"pointed to\" are updated.</p>\n\n<p>Example input.txt file:</p>\n\n<pre><code>Adam 1 900.9\nDaniel 2  800.8\nJoe 3       700.7\nFoo 4 600.6\nBar 5 500.5\nAlice 6 400.4\nBob 7 300.3\nNick 8 200.2\nEve 9 100.1\n</code></pre>\n\n<p>After altering your code slightly (see below) the above input file does work, here is the output I get:</p>\n\n<pre><code>$ ./test 5 5 5\nName      Account No.  Amount\nAdam      1             900.90\nName      Account No.  Amount\nDaniel    2             800.80\nName      Account No.  Amount\nJoe       3             700.70\nName      Account No.  Amount\nFoo       4             600.60\nName      Account No.  Amount\nBar       5             500.50\n</code></pre>\n\n<p>Updated main function based on the one you provided in the question:</p>\n\n<pre><code>int main(int argc, char **argv) {\n    char *input = \"input.txt\";\n    int *account;\n    char **name;\n    float *balance;\n    int count;\n    int check;\n    int i;\n\n    if (argc &lt; 4 || argc &gt; 4) {\n        printf(\"Insufficient arguments. Check your command line arguments\\n\");\n        return 1;\n    }\n    count = atoi(*(argv + 2));\n    name = malloc(sizeof(char *) * count);\n    for (i = 0; i &lt; count; i ++) {\n        *(name+i) = malloc(20);\n    }\n    account = malloc(sizeof(int) * count);\n    balance = malloc(sizeof(float) * count);\n\n    check = load_data(input, name, account, balance, count);\n    if (check == 0) {\n        printf(\"File cannot be open\\n\");\n    }\n\n    print_data(name, account, balance, count);\n\n    free(balance);\n    free(account);\n    for (i = 0; i &lt; count; i++) {\n        free(*(name+i));\n    }\n    free(name);\n    return 0;\n}\n</code></pre>\n\n<p>... also in <code>load_data</code> I changed <code>i &lt; 9</code> to <code>i &lt; n</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7168591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82dca920f80a21219fce34fbfba24224?s=128&d=identicon&r=PG&f=1", "display_name": "Gtt123", "link": "https://stackoverflow.com/users/7168591/gtt123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 40637946, "answer_count": 1, "score": 1, "last_activity_date": 1479374176, "creation_date": 1479314450, "last_edit_date": 1479340521, "question_id": 40637529, "link": "https://stackoverflow.com/questions/40637529/reading-file-using-fscanf-is-not-working-in-c", "title": "Reading file using fscanf is not working in c?", "body": "<pre><code>int main(int argc, char **argv) {\n    char *input = \"input.txt\";\n    int *account;\n    char **name;\n    float *balance;\n    int count;\n    int check;\n\n    if (argc &lt; 4 || argc &gt; 4) {\n        printf(\"Insufficient arguments. Check your command line arguments\\n\");\n        return 1;\n    }\n    count = atoi(*(argv + 2));\n    name = malloc(sizeof(char) * 20 * count);\n    account = malloc(sizeof(int) * count);\n    balance = malloc(sizeof(float) * count);\n\n    check = load_data(input, name, account, balance, count);\n    if (check == 0) {\n        printf(\"File cannot be open\\n\");\n    }\n\n    print_data(name, account, balance, count);\n\n    free(name);\n    return 0;\n} \n\n//load data from input file the according arrays\nint load_data(char *input, char **name, int *acct, float *amt, int n) {\n    int *a = acct;\n    float *b = amt;\n    FILE *file = fopen(\"input.txt\", \"r\");\n    int i;\n\n    if (file == NULL) {\n        return 0;\n    } else {\n        for (i = 0; i &lt; 9; i++, acct++, amt++) {\n            fscanf(file, \"%s %d %f\", *(name + i), acct, amt);\n        }\n    }\n    fclose(file);\n    acct = a; //return pointer to original position\n    amt = b;\n    return 1;\n}\n\n//print data from arrays\nvoid print_data(char **name, int *acct, float *amt, int n) {\n    int i;\n    for (i = 0; i &lt; n; i++) {\n        printf(\"%-10s%-13s%s\\n\", \"Name\", \"Account No.\", \"Amount\");\n        printf(\"%-10s%-13d%7.2f\\n\", *(name + i), *(acct + i), *(amt + i));\n    }\n}\n</code></pre>\n\n<p>I have this <code>load_data</code> function that suppose to read from a file and store the data values in different pointers, but for some reason when I print out using <code>print_data</code> function, the pointer contain all null and 0? (Please answer using pointers arithmetic and not array)</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 1, "creation_date": 1479312138, "post_id": 40636632, "comment_id": 68505611, "body": "As always with debugging C programs, run the program in a debugger and see where the segfault happens. Also inspect some of the values; are you dereferencing null somewhere?"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 1, "creation_date": 1479312263, "post_id": 40636632, "comment_id": 68505690, "body": "&quot;main gives a segmentation fault&quot; is simply not enough information for us to answer your question. Either you specify exactly which line of code gives the segmentation fault, or - preferably - do some debugging, investigate the problem a little deeper, and - if still needed - come back with a more accurate description of the problem that you&#39;re experiencing."}, {"owner": {"reputation": 73, "user_id": 7107008, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8fa9fe5aa37c6db4e5f03a8fcac0b55d?s=128&d=identicon&r=PG&f=1", "display_name": "embedded_crysis", "link": "https://stackoverflow.com/users/7107008/embedded-crysis"}, "edited": false, "score": 0, "creation_date": 1479312389, "post_id": 40636632, "comment_id": 68505793, "body": "will return with more info, if I don&#39;t solve it. But yes I found out that ret_sig == NULL. Thanks, robot commenter :) :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479312390, "post_id": 40636632, "comment_id": 68505795, "body": "Can youn post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479312396, "post_id": 40636632, "comment_id": 68505804, "body": "I suspect <code>sigpq_heapify(q,0);</code> fails when <code>q-&gt;size == 0</code>.  Still, not enough info"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1479312425, "post_id": 40636632, "comment_id": 68505830, "body": "There&#39;s too little information for anyone to be able to re-produce or diagnose the problem. However, my gut tells me it is most likely <a href=\"http://stackoverflow.com/questions/39486797/dynamic-memory-access-only-works-inside-function\">this bug</a> again."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 2, "creation_date": 1479312448, "post_id": 40636632, "comment_id": 68505848, "body": "C parameters are passed by value.  When you call <code>pop</code> with <code>ret_sig</code>, you are passing a copy of the pointer. When <code>pop</code> modifies <code>ret_sig</code>, it is modifying the local copy, which does not affect the copy that the caller has.  You need to pass a pointer to the pointer (or change the function to return the pointer instead of the <code>int</code>)."}, {"owner": {"reputation": 73, "user_id": 7107008, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8fa9fe5aa37c6db4e5f03a8fcac0b55d?s=128&d=identicon&r=PG&f=1", "display_name": "embedded_crysis", "link": "https://stackoverflow.com/users/7107008/embedded-crysis"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1479312653, "post_id": 40636632, "comment_id": 68506000, "body": "@pat Ah that sounds perfect."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1479397349, "post_id": 40636632, "comment_id": 68549464, "body": "You check that the pointer to structure is not null, but you don&#39;t check actually if the pointer to the functions is not null.... This can be the problem, but you only provide a code snippet, and nothing that can be compiled and tested locally, see comment by @embedded_crysis, and write a complete example to illustrate how you receive the <code>SIGSEGV</code>."}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479314696, "post_id": 40636917, "comment_id": 68507462, "body": "Nit picking: At least on language level there is no &quot;<i>pass ... by reference</i>&quot; in C."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479314855, "post_id": 40636917, "comment_id": 68507573, "body": "@alk. True, C always passes parameters by value. In this case, <code>&amp;ret_val</code> is passed by value, which effectively (explicitly) passes <code>ret_val</code> by reference."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1479317560, "post_id": 40636917, "comment_id": 68509423, "body": "Unless you count arrays, which are passed by reference because they decay into pointers automagically."}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 2, "last_activity_date": 1479313140, "last_edit_date": 1479313140, "creation_date": 1479312663, "answer_id": 40636917, "question_id": 40636632, "link": "https://stackoverflow.com/questions/40636632/why-cant-i-call-function-pointer-from-returned-struct-in-c/40636917#40636917", "title": "Why can&#39;t I call function pointer from returned struct in C?", "body": "<p>You need to explicitly pass <code>ret_sig</code> by reference.</p>\n\n<pre><code>int pop(SigPQ *q, Bsig** ret_sig){\n    if (q-&gt;size &lt; 1){\n        return 0;\n    }\n    Bsig* signal = q-&gt;signals[0];\n    assert(signal);\n    q-&gt;signals[0] = q-&gt;signals[q-&gt;size-1];\n    q-&gt;size--;\n    sigpq_heapify(q,0);\n\n    if(signal-&gt;on_pop){\n        signal-&gt;on_pop-&gt;do_on_pop(signal);\n    }\n    *ret_sig = signal;\n    return 1;\n}\n</code></pre>\n\n<p>And pass the address of <code>ret_sig</code></p>\n\n<pre><code>Bsig *ret_sig;\npop(pq,&amp;ret_sig);\n</code></pre>\n\n<p>Or change the function to return the pointer instead of an <code>int</code> (which is cleaner):</p>\n\n<pre><code>Bsig *pop(SigPQ *q){\n    if (q-&gt;size &lt; 1){\n        return NULL;\n    }\n    Bsig* signal = q-&gt;signals[0];\n    assert(signal);\n    q-&gt;signals[0] = q-&gt;signals[q-&gt;size-1];\n    q-&gt;size--;\n    sigpq_heapify(q,0);\n\n    if(signal-&gt;on_pop){\n        signal-&gt;on_pop-&gt;do_on_pop(signal);\n    }\n    return signal;\n}\n</code></pre>\n\n<p>And assign the return value:</p>\n\n<pre><code>Bsig *ret_sig = pop(pq);\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7107008, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8fa9fe5aa37c6db4e5f03a8fcac0b55d?s=128&d=identicon&r=PG&f=1", "display_name": "embedded_crysis", "link": "https://stackoverflow.com/users/7107008/embedded-crysis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40636917, "answer_count": 1, "score": 1, "last_activity_date": 1479313140, "creation_date": 1479312002, "question_id": 40636632, "link": "https://stackoverflow.com/questions/40636632/why-cant-i-call-function-pointer-from-returned-struct-in-c", "title": "Why can&#39;t I call function pointer from returned struct in C?", "body": "<p>Ok so I've only been doing C a few weeks and I have some problems. I have a priority queue filled with <code>Bsig</code> pointers. As an added feature, I want that whenever a <code>Bsig</code> is popped, we execute a custom function.</p>\n\n<pre><code>typedef struct bsig{\n// some more fields here, but they're not important\n    struct onpop_t *on_pop;\n} Bsig;\n\ntypedef struct onpop_t {\n    struct onpop_t *next;\n    int (*do_on_pop)(Bsig *caller);\n} Onpop;\n\nint pop(SigPQ *q, Bsig* ret_sig){\n    if (q-&gt;size &lt; 1){\n        return 0;\n    }\n    Bsig* signal = q-&gt;signals[0];\n    assert(signal);\n    q-&gt;signals[0] = q-&gt;signals[q-&gt;size-1];\n    q-&gt;size--;\n    sigpq_heapify(q,0);\n\n    if(signal-&gt;on_pop){\n        signal-&gt;on_pop-&gt;do_on_pop(signal);\n    }\n    ret_sig = signal;\n    return 1;\n}\n</code></pre>\n\n<p>So essentially, whenever we call pop, the do_on_pop function should be launched. Furthermore, pop takes a signal pointer which is overwritten by whatever is popped from the queue. All this happens in two files included by main.c. The following is from main (where <code>testpop</code> is a custom function that juts prints something random - it is declared and defined in the main.c file):</p>\n\n<pre><code>Bsig *sig1 = new_signal(1000, 0);\nOnpop *onpop1 = malloc(sizeof(Onpop));\nonpop1-&gt;do_on_pop = &amp;testpop;\nsig1-&gt;on_pop = onpop1;\npush(pq, sig1);\n\nBsig *ret_sig;\npop(pq,ret_sig);\n</code></pre>\n\n<p>So far so good - the custom function <code>testpop</code> gets called. But</p>\n\n<pre><code>ret_sig-&gt;on_pop-&gt;do_on_pop(ret_sig);\n</code></pre>\n\n<p>from main gives a segmentation fault! I don't understand why. The ret_sig address and the signal address should be the same, and the function call is the same - the only difference is that one is called from main and one is called from the included .c file. Can anyone shed a light?</p>\n"}, {"tags": ["c++", "c", "fft", "fftw", "pruning"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1479312666, "post_id": 40636327, "comment_id": 68506013, "body": "Did you compile your test code with optimisation enabled, e.g. <code>gcc -O3 ...</code> ?"}, {"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1479313135, "post_id": 40636327, "comment_id": 68506346, "body": "@PaulR I&#39;m compiling using Visual Studio 2013 in Release mode. I have edited the post accordingly."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1479313642, "post_id": 40636327, "comment_id": 68506693, "body": "@JackOLantern You can have the FFT calculations themselves run multithreaded.  See <a href=\"http://www.fftw.org/doc/Multi_002dthreaded-FFTW.html#Multi_002dthreaded-FFTW\" rel=\"nofollow noreferrer\">fftw.org/doc/&hellip;</a>  And that&#39;s what those CPUs are <i>for</i>.  Using them isn&#39;t &quot;cheating&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 1, "creation_date": 1479313493, "post_id": 40636949, "comment_id": 68506604, "body": "Thank you very much for your answer. However, and conceptually, I&#39;m primarily interested in speeding up the two <code>for</code> loops, rather than the <code>fftw</code>s. I have edited my post, adding an OpenMP solution for the two <code>for</code> loops, but I&#39;m feeling like I&#39;m making an unfair comparison: the two FFTWs are sequential, while the <code>for</code> loops are multi-threaded."}, {"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 0, "creation_date": 1479483684, "post_id": 40636949, "comment_id": 68591875, "body": "I was finally able to improve my code. I have posted a full answer. Thank you for your interest."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 5, "last_activity_date": 1479312726, "creation_date": 1479312726, "answer_id": 40636949, "question_id": 40636327, "link": "https://stackoverflow.com/questions/40636327/accelerating-fftw-pruning-to-avoid-massive-zero-padding/40636949#40636949", "title": "Accelerating FFTW pruning to avoid massive zero padding", "body": "<p>Several options to run faster:</p>\n\n<ol>\n<li><p>Run multi-threaded if you're only running single-threaded and have multiple cores available.</p></li>\n<li><p>Create and save an FFTW wisdom file, especially if the FFT dimensions are known in advance.  Use <code>FFTW_EXHAUSTIVE</code>, and reload the FFTW wisdom instead of recalculating it every time.  This is also important if you want your results to be consistent.  Since FFTW may compute FFTs differently with different calculated wisdom, and the wisdom results aren't necessarily going to always be the same, different runs of your process may produce different results when both are given identical input data.</p></li>\n<li><p>If you're on x86, run 64-bit.  The FFTW algorithm is extremely register-intensive, and an x86 CPU running in 64-bit mode has a lot more general-purpose registers available than it does when running in 32-bit mode.</p></li>\n<li><p>Since the FFTW algorithm is so register intensive, I've had good success improving FFTW performance by compiling FFTW with compiler options that <em>prevent</em> the use of prefetching and prevent the implicit inlining of functions.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 1, "creation_date": 1479393498, "post_id": 40651318, "comment_id": 68546468, "body": "Your first suggestion significantly improves the timing of the third step, see EDIT #3 to my post. Loop unrolling does not help further improving the result. Many thanks for your answer."}, {"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 0, "creation_date": 1479394241, "post_id": 40651318, "comment_id": 68547042, "body": "For the successful <code>for</code> loop exchange you suggested, multi-threading just worsens the results."}, {"owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 1, "creation_date": 1479483653, "post_id": 40651318, "comment_id": 68591854, "body": "Finally, I have been successful to improve my code, also following your suggestions. I have provided a full answer below. Thank you for your interest."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "edited": false, "score": 0, "creation_date": 1479483970, "post_id": 40651318, "comment_id": 68592086, "body": "@JackOLantern: great - thanks for following up on this and writing up your findings - could be very useful to other readers in the future!"}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1479375855, "last_edit_date": 1479375855, "creation_date": 1479375530, "answer_id": 40651318, "question_id": 40636327, "link": "https://stackoverflow.com/questions/40636327/accelerating-fftw-pruning-to-avoid-massive-zero-padding/40651318#40651318", "title": "Accelerating FFTW pruning to avoid massive zero padding", "body": "<p>For the third step you might want to try switching the order of the loops:</p>\n\n<pre><code>for (int p = 0; p &lt; N; p++) {\n    for (int k = 0; k &lt; K; k++) {\n        h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n        h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n    }\n}\n</code></pre>\n\n<p>since it's generally more beneficial to have the store addresses be contiguous than the load addresses.</p>\n\n<p>Either way you have a cache-unfriendly access pattern though. You could try working with blocks to improve this, e.g. assuming N is a multiple of 4:</p>\n\n<pre><code>for (int p = 0; p &lt; N; p += 4) {\n    for (int k = 0; k &lt; K; k++) {\n        for (int p0 = 0; p0 &lt; 4; p0++) {\n            h_xhatpruning[(p + p0) * K + k][0] = h_xhatpruning_temp[(p + p0) + k * N][0];\n            h_xhatpruning[(p + p0) * K + k][1] = h_xhatpruning_temp[(p + p0) + k * N][1];\n        }\n    }\n}\n</code></pre>\n\n<p>This should help to reduce the churn of cache lines somewhat. If it does then maybe also experiment with block sizes other than 4 to see if there is a \"sweet spot\".</p>\n"}, {"tags": [], "owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "is_accepted": false, "score": 1, "last_activity_date": 1479483552, "creation_date": 1479483552, "answer_id": 40680928, "question_id": 40636327, "link": "https://stackoverflow.com/questions/40636327/accelerating-fftw-pruning-to-avoid-massive-zero-padding/40680928#40680928", "title": "Accelerating FFTW pruning to avoid massive zero padding", "body": "<p>Also following Paul R's comments, I have improved my code. Now, the alternative approach is faster than the standard (zero padded) one. Below is the full C++ script. For step #1 and #3, I have commented other tried solutions, which have shown to be slower or as fast as the uncommented one. I have priviledged non-nested <code>for</code> loops, also in view of a simpler future CUDA parallelization. I'm not yet using multi-threading for FFTW.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     /* srand, rand */\n#include &lt;time.h&gt;       /* time */\n#include &lt;math.h&gt;\n#include &lt;fstream&gt;\n\n#include &lt;omp.h&gt;\n\n#include &lt;fftw3.h&gt;\n\n#include \"TimingCPU.h\"\n\n#define PI_d            3.141592653589793\n\n/******************/\n/* STEP #1 ON CPU */\n/******************/\nvoid step1CPU(fftw_complex * __restrict h_xpruning, const fftw_complex * __restrict h_x, const int N, const int K) {\n\n//  double factor = -2. * PI_d / (K * N);\n//  int n;\n//  omp_set_nested(1);\n//#pragma omp parallel for private(n) num_threads(4)\n//  for (int k = 0; k &lt; K; k++) {\n//      double arg1 = factor * k;\n//#pragma omp parallel for num_threads(4)\n//      for (n = 0; n &lt; N; n++) {\n//          double arg = arg1 * n;\n//          double cosarg = cos(arg);\n//          double sinarg = sin(arg);\n//          h_xpruning[k * N + n][0] = h_x[n][0] * cosarg - h_x[n][1] * sinarg;\n//          h_xpruning[k * N + n][1] = h_x[n][0] * sinarg + h_x[n][1] * cosarg;\n//      }\n//  }\n\n    //double factor = -2. * PI_d / (K * N);\n    //int k;\n    //omp_set_nested(1);\n    //#pragma omp parallel for private(k) num_threads(4)\n    //for (int n = 0; n &lt; N; n++) {\n    //  double arg1 = factor * n;\n    //  #pragma omp parallel for num_threads(4)\n    //  for (k = 0; k &lt; K; k++) {\n    //      double arg = arg1 * k;\n    //      double cosarg = cos(arg);\n    //      double sinarg = sin(arg);\n    //      h_xpruning[k * N + n][0] = h_x[n][0] * cosarg - h_x[n][1] * sinarg;\n    //      h_xpruning[k * N + n][1] = h_x[n][0] * sinarg + h_x[n][1] * cosarg;\n    //  }\n    //}\n\n    //double factor = -2. * PI_d / (K * N);\n    //for (int k = 0; k &lt; K; k++) {\n    //  double arg1 = factor * k;\n    //  for (int n = 0; n &lt; N; n++) {\n    //      double arg = arg1 * n;\n    //      double cosarg = cos(arg);\n    //      double sinarg = sin(arg);\n    //      h_xpruning[k * N + n][0] = h_x[n][0] * cosarg - h_x[n][1] * sinarg;\n    //      h_xpruning[k * N + n][1] = h_x[n][0] * sinarg + h_x[n][1] * cosarg;\n    //  }\n    //}\n\n    //double factor = -2. * PI_d / (K * N);\n    //for (int n = 0; n &lt; N; n++) {\n    //  double arg1 = factor * n;\n    //  for (int k = 0; k &lt; K; k++) {\n    //      double arg = arg1 * k;\n    //      double cosarg = cos(arg);\n    //      double sinarg = sin(arg);\n    //      h_xpruning[k * N + n][0] = h_x[n][0] * cosarg - h_x[n][1] * sinarg;\n    //      h_xpruning[k * N + n][1] = h_x[n][0] * sinarg + h_x[n][1] * cosarg;\n    //  }\n    //}\n\n    double factor = -2. * PI_d / (K * N);\n    #pragma omp parallel for num_threads(8)\n    for (int n = 0; n &lt; K * N; n++) {\n        int row = n / N;\n        int col = n % N;\n        double arg = factor * row * col;\n        double cosarg = cos(arg);\n        double sinarg = sin(arg);\n        h_xpruning[n][0] = h_x[col][0] * cosarg - h_x[col][1] * sinarg;\n        h_xpruning[n][1] = h_x[col][0] * sinarg + h_x[col][1] * cosarg;\n    }\n}\n\n/******************/\n/* STEP #3 ON CPU */\n/******************/\nvoid step3CPU(fftw_complex * __restrict h_xhatpruning, const fftw_complex * __restrict h_xhatpruning_temp, const int N, const int K) {\n\n    //int k;\n    //omp_set_nested(1);\n    //#pragma omp parallel for private(k) num_threads(4)\n    //for (int p = 0; p &lt; N; p++) {\n    //  #pragma omp parallel for num_threads(4)\n    //  for (k = 0; k &lt; K; k++) {\n    //      h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n    //      h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n    //  }\n    //} \n\n    //int p;\n    //omp_set_nested(1);\n    //#pragma omp parallel for private(p) num_threads(4)\n    //for (int k = 0; k &lt; K; k++) {\n    //  #pragma omp parallel for num_threads(4)\n    //  for (p = 0; p &lt; N; p++) {\n    //      h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n    //      h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n    //  }\n    //}\n\n    //for (int p = 0; p &lt; N; p++) {\n    //  for (int k = 0; k &lt; K; k++) {\n    //      h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n    //      h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n    //  }\n    //}\n\n    //for (int k = 0; k &lt; K; k++) {\n    //  for (int p = 0; p &lt; N; p++) {\n    //      h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n    //      h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n    //  }\n    //}\n\n    #pragma omp parallel for num_threads(8)\n    for (int p = 0; p &lt; K * N; p++) {\n        int col = p % N;\n        int row = p / K;\n        h_xhatpruning[col * K + row][0] = h_xhatpruning_temp[col + row * N][0];\n        h_xhatpruning[col * K + row][1] = h_xhatpruning_temp[col + row * N][1];\n    }\n\n    //for (int p = 0; p &lt; N; p += 2) {\n    //  for (int k = 0; k &lt; K; k++) {\n    //      for (int p0 = 0; p0 &lt; 2; p0++) {\n    //          h_xhatpruning[(p + p0) * K + k][0] = h_xhatpruning_temp[(p + p0) + k * N][0];\n    //          h_xhatpruning[(p + p0) * K + k][1] = h_xhatpruning_temp[(p + p0) + k * N][1];\n    //      }\n    //  }\n    //}\n\n}\n\n/********/\n/* MAIN */\n/********/\nvoid main() {\n\n    int N = 10;\n    int K = 100000;\n\n    // --- CPU memory allocations\n    fftw_complex *h_x = (fftw_complex *)malloc(N     * sizeof(fftw_complex));\n    fftw_complex *h_xzp = (fftw_complex *)calloc(N * K, sizeof(fftw_complex));\n    fftw_complex *h_xpruning = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhatpruning = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhatpruning_temp = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhat = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    //double2        *h_xhatGPU = (double2 *)malloc(N * K * sizeof(double2));\n\n\n    // --- Random number generation of the data sequence on the CPU - moving the data from CPU to GPU\n    srand(time(NULL));\n    for (int k = 0; k &lt; N; k++) {\n        h_x[k][0] = (double)rand() / (double)RAND_MAX;\n        h_x[k][1] = (double)rand() / (double)RAND_MAX;\n    }\n    //gpuErrchk(cudaMemcpy(d_x, h_x, N * sizeof(double2), cudaMemcpyHostToDevice));\n\n    memcpy(h_xzp, h_x, N * sizeof(fftw_complex));\n\n    // --- FFTW and cuFFT plans\n    fftw_plan h_plan_zp      = fftw_plan_dft_1d(N * K, h_xzp, h_xhat, FFTW_FORWARD, FFTW_ESTIMATE);\n    fftw_plan h_plan_pruning = fftw_plan_many_dft(1, &amp;N, K, h_xpruning, NULL, 1, N, h_xhatpruning_temp, NULL, 1, N, FFTW_FORWARD, FFTW_ESTIMATE);\n\n    double totalTimeCPU = 0., totalTimeGPU = 0.;\n    double partialTimeCPU, partialTimeGPU;\n\n    /****************************/\n    /* STANDARD APPROACH ON CPU */\n    /****************************/\n    printf(\"Number of processors available = %i\\n\", omp_get_num_procs());\n    printf(\"Number of threads              = %i\\n\", omp_get_max_threads());\n\n    TimingCPU timerCPU;\n    timerCPU.StartCounter();\n    fftw_execute(h_plan_zp);\n    printf(\"\\nStadard on CPU: \\t \\t %f\\n\", timerCPU.GetCounter());\n\n    /******************/\n    /* STEP #1 ON CPU */\n    /******************/\n    timerCPU.StartCounter();\n    step1CPU(h_xpruning, h_x, N, K);\n    partialTimeCPU = timerCPU.GetCounter();\n    totalTimeCPU = totalTimeCPU + partialTimeCPU;\n    printf(\"\\nOptimized first step CPU: \\t %f\\n\", totalTimeCPU);\n\n    /******************/\n    /* STEP #2 ON CPU */\n    /******************/\n    timerCPU.StartCounter();\n    fftw_execute(h_plan_pruning);\n    partialTimeCPU = timerCPU.GetCounter();\n    totalTimeCPU = totalTimeCPU + partialTimeCPU;\n    printf(\"Optimized second step CPU: \\t %f\\n\", timerCPU.GetCounter());\n\n    /******************/\n    /* STEP #3 ON CPU */\n    /******************/\n    timerCPU.StartCounter();\n    step3CPU(h_xhatpruning, h_xhatpruning_temp, N, K);\n    partialTimeCPU = timerCPU.GetCounter();\n    totalTimeCPU = totalTimeCPU + partialTimeCPU;\n    printf(\"Optimized third step CPU: \\t %f\\n\", partialTimeCPU);\n\n    printf(\"Total time CPU: \\t \\t %f\\n\", totalTimeCPU);\n\n    double rmserror = 0., norm = 0.;\n    for (int n = 0; n &lt; N; n++) {\n        rmserror = rmserror + (h_xhatpruning[n][0] - h_xhat[n][0]) * (h_xhatpruning[n][0] - h_xhat[n][0]) + (h_xhatpruning[n][1] - h_xhat[n][1]) * (h_xhatpruning[n][1] - h_xhat[n][1]);\n        norm = norm + h_xhat[n][0] * h_xhat[n][0] + h_xhat[n][1] * h_xhat[n][1];\n    }\n    printf(\"\\nrmserror %f\\n\", 100. * sqrt(rmserror / norm));\n\n    fftw_destroy_plan(h_plan_zp);\n\n}\n</code></pre>\n\n<p>For the case</p>\n\n<pre><code>N = 10\nK = 100000\n</code></pre>\n\n<p>my timing is the following</p>\n\n<pre><code>Stadard on CPU:                  23.895417\n\nOptimized first step CPU:        4.472087\nOptimized second step CPU:       4.926603\nOptimized third step CPU:        2.394958\nTotal time CPU:                  11.793648\n</code></pre>\n"}], "owner": {"reputation": 18443, "user_id": 1886641, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UsR5f.png?s=128&g=1", "display_name": "Vitality", "link": "https://stackoverflow.com/users/1886641/vitality"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 40651318, "answer_count": 3, "score": 7, "last_activity_date": 1479483552, "creation_date": 1479311214, "last_edit_date": 1479482928, "question_id": 40636327, "link": "https://stackoverflow.com/questions/40636327/accelerating-fftw-pruning-to-avoid-massive-zero-padding", "title": "Accelerating FFTW pruning to avoid massive zero padding", "body": "<p>Suppose that I have a sequence <code>x(n)</code> which is <code>K * N</code> long and that only the first <code>N</code> elements are different from zero. I'm assuming that <code>N &lt;&lt; K</code>, say, for example, <code>N = 10</code> and <code>K = 100000</code>. I want to calculate the FFT, by FFTW, of such a sequence. This is equivalent to having a sequence of length <code>N</code> and having a zero padding to <code>K * N</code>. Since <code>N</code> and <code>K</code> may be \"large\", I have a significant zero padding. I'm exploring if I can save some computation time avoid explicit zero padding.</p>\n\n<p><strong>The case <code>K = 2</code></strong></p>\n\n<p>Let us begin by considering the case <code>K = 2</code>. In this case, the DFT of <code>x(n)</code> can be written as</p>\n\n<p><a href=\"https://i.stack.imgur.com/ODbjw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ODbjw.png\" alt=\"enter image description here\"></a></p>\n\n<p>If <code>k</code> is even, namely <code>k = 2 * m</code>, then</p>\n\n<p><a href=\"https://i.stack.imgur.com/EQqRZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EQqRZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>which means that such values of the DFT can be calculated through an FFT of a sequence of length <code>N</code>, and not <code>K * N</code>.</p>\n\n<p>If <code>k</code> is odd, namely <code>k = 2 * m + 1</code>, then</p>\n\n<p><a href=\"https://i.stack.imgur.com/nnupQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nnupQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>which means that such values of the DFT can be again calculated through an FFT of a sequence of length <code>N</code>, and not <code>K * N</code>.</p>\n\n<p>So, in conclusion, I can exchange a single FFT of length <code>2 * N</code> with <code>2</code> FFTs of length <code>N</code>.</p>\n\n<p><strong>The case of arbitrary <code>K</code></strong></p>\n\n<p>In this case, we have</p>\n\n<p><a href=\"https://i.stack.imgur.com/SeGX4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SeGX4.png\" alt=\"enter image description here\"></a>  </p>\n\n<p>On writing <code>k = m * K + t</code>, we have</p>\n\n<p><a href=\"https://i.stack.imgur.com/o699P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o699P.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, in conclusion, I can exchange a single FFT of length <code>K * N</code> with <code>K</code> FFTs of length <code>N</code>. Since the FFTW has <code>fftw_plan_many_dft</code>, I can expect to have some gaining against the case of a single FFT.</p>\n\n<p>To verify that, I have set up the following code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;     /* srand, rand */\n#include &lt;time.h&gt;       /* time */\n#include &lt;math.h&gt;\n#include &lt;fstream&gt;\n\n#include &lt;fftw3.h&gt;\n\n#include \"TimingCPU.h\"\n\n#define PI_d            3.141592653589793\n\nvoid main() {\n\n    const int N = 10;\n    const int K = 100000;\n\n    fftw_plan plan_zp;\n\n    fftw_complex *h_x = (fftw_complex *)malloc(N     * sizeof(fftw_complex));\n    fftw_complex *h_xzp = (fftw_complex *)calloc(N * K, sizeof(fftw_complex));\n    fftw_complex *h_xpruning = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhatpruning = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhatpruning_temp = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n    fftw_complex *h_xhat = (fftw_complex *)malloc(N * K * sizeof(fftw_complex));\n\n    // --- Random number generation of the data sequence\n    srand(time(NULL));\n    for (int k = 0; k &lt; N; k++) {\n        h_x[k][0] = (double)rand() / (double)RAND_MAX;\n        h_x[k][1] = (double)rand() / (double)RAND_MAX;\n    }\n\n    memcpy(h_xzp, h_x, N * sizeof(fftw_complex));\n\n    plan_zp = fftw_plan_dft_1d(N * K, h_xzp, h_xhat, FFTW_FORWARD, FFTW_ESTIMATE);\n    fftw_plan plan_pruning = fftw_plan_many_dft(1, &amp;N, K, h_xpruning, NULL, 1, N, h_xhatpruning_temp, NULL, 1, N, FFTW_FORWARD, FFTW_ESTIMATE);\n\n    TimingCPU timerCPU;\n    timerCPU.StartCounter();\n    fftw_execute(plan_zp);\n    printf(\"Stadard %f\\n\", timerCPU.GetCounter());\n\n    timerCPU.StartCounter();\n    double factor = -2. * PI_d / (K * N);\n    for (int k = 0; k &lt; K; k++) {\n        double arg1 = factor * k;\n        for (int n = 0; n &lt; N; n++) {\n            double arg = arg1 * n;\n            double cosarg = cos(arg);\n            double sinarg = sin(arg);\n            h_xpruning[k * N + n][0] = h_x[n][0] * cosarg - h_x[n][1] * sinarg;\n            h_xpruning[k * N + n][1] = h_x[n][0] * sinarg + h_x[n][1] * cosarg;\n        }\n    }\n    printf(\"Optimized first step %f\\n\", timerCPU.GetCounter());\n\n    timerCPU.StartCounter();\n    fftw_execute(plan_pruning);\n    printf(\"Optimized second step %f\\n\", timerCPU.GetCounter());\n    timerCPU.StartCounter();\n    for (int k = 0; k &lt; K; k++) {\n        for (int p = 0; p &lt; N; p++) {\n            h_xhatpruning[p * K + k][0] = h_xhatpruning_temp[p + k * N][0];\n            h_xhatpruning[p * K + k][1] = h_xhatpruning_temp[p + k * N][1];\n        }\n    }\n    printf(\"Optimized third step %f\\n\", timerCPU.GetCounter());\n\n    double rmserror = 0., norm = 0.;\n    for (int n = 0; n &lt; N; n++) {\n        rmserror = rmserror + (h_xhatpruning[n][0] - h_xhat[n][0]) * (h_xhatpruning[n][0] - h_xhat[n][0]) + (h_xhatpruning[n][1] - h_xhat[n][1]) * (h_xhatpruning[n][1] - h_xhat[n][1]);\n        norm = norm + h_xhat[n][0] * h_xhat[n][0] + h_xhat[n][1] * h_xhat[n][1];\n    }\n    printf(\"rmserror %f\\n\", 100. * sqrt(rmserror / norm));\n\n    fftw_destroy_plan(plan_zp);\n\n}\n</code></pre>\n\n<p>The approach I have developed consists of three steps:</p>\n\n<ol>\n<li>Multiplying the input sequence by \"twiddle\" complex exponentials;</li>\n<li>Performing the <code>fftw_many</code>;</li>\n<li>Reorganizing the results.</li>\n</ol>\n\n<p>The <code>fftw_many</code> is faster than the single FFTW on <code>K * N</code> input points. However, steps #1 and #3 completely destroy such a gain. I would expect that steps #1 and #3 be computationally much lighter than step #2.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>How is it possible that steps #1 and #3 a so computationally more demanding than step #2?</li>\n<li>How can I improve steps #1 and #3 to have a net gain against the \"standard\" approach?</li>\n</ol>\n\n<p>Thank you very much for any hint.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I'm working with Visual Studio 2013 and compiling in Release mode.</p>\n"}, {"tags": ["c", "ungetc"], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 1566078, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/158a4e727c15b73635419096a8b89031?s=128&d=identicon&r=PG", "display_name": "mfloris", "link": "https://stackoverflow.com/users/1566078/mfloris"}, "is_accepted": false, "score": 0, "last_activity_date": 1480332109, "creation_date": 1480332109, "answer_id": 40843103, "question_id": 40636180, "link": "https://stackoverflow.com/questions/40636180/wrap-ungetc-without-puts-gets-and-streams-in-general/40843103#40843103", "title": "wrap ungetc() without puts() gets() and streams in general", "body": "<p>Here is how I solved it. I created a more complex struct for the file handle that contains not only the handle itself but also the file name, the file size and a buffer that holds the whole content of the file. It should only load the part of the file that I need but mine is an embedded application and I know I won't be opening big files so I didn't bother.</p>\n\n<p>Then once you have the \"stream\" it's trivial to pop chars in and out.</p>\n\n<pre><code>typedef struct _myfile {\n      _FS_HANDLE        handle; /* file descriptor */\n      CHAR*             fname;  /* file name */\n      UINT32            fsize;  /* file size */\n      CHAR*             buffer; /* file buffer */\n  } *my_FILE;\n\nint my_ungetc(int c, my_FILE stream)\n{\n    if (stream)\n    {\n        UINT32 pointer = _fs_tell(stream-&gt;handle);\n        if (pointer &gt; 0)\n        {\n            _fs_seek(stream-&gt;handle,pointer - 1);\n            stream-&gt;buffer[pointer - 1] = c;\n            return c;\n        }\n    }\n    else\n    {\n        printf(\"ERROR! stream is NULL!\\r\\n\");\n    }\n    return EOF;\n}\n\nvoid *my_fopen(const char *filename, const char *mode)\n{\n    my_FILE fp = _mem_alloc(sizeof(struct _myfile));\n    fp-&gt;fname = strdup(filename);\n    if (mode == \"r\")\n    {\n        fp-&gt;handle = _fs_open((CHAR*)filename, OPEN_READ);\n        if (fp-&gt;handle) fp-&gt;fsize = _get_size_with_handle(fp-&gt;handle);\n        if (fp-&gt;fsize)\n        {\n            fp-&gt;buffer = _mem_alloc(fp-&gt;fsize);\n            if (fp-&gt;buffer)\n            {\n                if (_fs_read(fp-&gt;handle,fp-&gt;buffer,fp-&gt;fsize))\n                {\n                    _fs_seek(fp-&gt;handle,0);\n                }\n                else\n                {\n                    printf(\"ERROR: unable to read %d bytes from %s\\r\\n\",fp-&gt;fsize,filename);\n                }\n            }\n            else\n            {\n                printf(\"ERROR in my_fopen(\\\"%s\\\",\\\"r\\\"): could not alloc %d bytes for buffer\\r\\n\",filename,fp-&gt;fsize);\n            }\n        }\n        else\n        {\n            fp-&gt;buffer = NULL;\n            printf(\"File \\\"%s\\\" is empty\\r\\n\");\n        }\n        return fp;\n    }\n    else if (mode == \"w\")\n    {\n        fp-&gt;handle = _fs_open((CHAR*)filename, OPEN_WRITE);\n        if (fp-&gt;handle) fp-&gt;fsize = _get_size_with_handle(fp-&gt;handle);\n        fp-&gt;buffer = NULL;\n        return fp;\n    }\n    else\n    {\n        printf(\"File open mode %s not supported\\r\\n\",mode);\n        return NULL;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 1566078, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/158a4e727c15b73635419096a8b89031?s=128&d=identicon&r=PG", "display_name": "mfloris", "link": "https://stackoverflow.com/users/1566078/mfloris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1480332109, "creation_date": 1479310812, "question_id": 40636180, "link": "https://stackoverflow.com/questions/40636180/wrap-ungetc-without-puts-gets-and-streams-in-general", "title": "wrap ungetc() without puts() gets() and streams in general", "body": "<p>I'm porting net-snmp to an embedded platform that only has limited access to the filesystem and I stumbled upon a big problem. There's a part of the core code that uses the ungetc() function, which I don't have. There are of course 2 solutions:</p>\n\n<p>A) write my own ungetc() using what I have</p>\n\n<p>B) modify net-snmp code in order to achieve the same result without ungetc()</p>\n\n<p>Solution (B) will be eventually discussed in the net-snmp coders mailing list since requires deep understanding of the library's internals, so let's please focus on feasibility of (A)</p>\n\n<p>What I have on my embedded system is:</p>\n\n<pre><code>fopen()\nfclose()\nfcreate()\nfwrite()\nfread()\nfdelete()\nfclear()\nfcopy()\nffindfirst()\nffindnext()\nfrename()\nfgetsize()\nftell()\nfseek()\nfgetc()\nfgets()\n</code></pre>\n\n<p>The main difference is that my file functions work with INT32* file handles instead of FILE* types. I don't have the FILE* type.</p>\n\n<p>What the ungetc() function does is to basically \"put back the char in the stream\" , either the char that it just read or another one.</p>\n\n<p>In the first case the solution is easy, I rewind the pointer with fseek() one position backwards.</p>\n\n<p>But in the second case I have a problem. I would be modifying the stream and not the file, except I don't have streams! I'm reading the file directly.</p>\n\n<p>With ungetc() you can do something like</p>\n\n<pre><code>FILE *fp = fopen(\"file.txt\", \"r\");\nint c = getc (fp);\nif( c == 'a' ) ungetc ('b', fp);\n</code></pre>\n\n<p>If \"file.txt\" contains \"abcdefghi\", a subsequent read with gets() will read \"bbcdefghi\" and not \"abcdefghi\" because the content IN THE STREAM has been changed, but not the file!</p>\n\n<p>How can I replicate this behavior if I don't have \"streams\" ? My getc() and gets() read from an INT32* file handle and I don't have a puts() or putc() equivalent.</p>\n\n<p>I can only write with fwrite() but that alters the content on the NV memory.</p>\n\n<p>Thank you for your insight</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 846, "user_id": 3874053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xr2Gk.jpg?s=128&g=1", "display_name": "Jacobr365", "link": "https://stackoverflow.com/users/3874053/jacobr365"}, "edited": false, "score": 1, "creation_date": 1479310502, "post_id": 40636045, "comment_id": 68504463, "body": "The question is how to print &quot;Hello__Dhaka!&quot;  where &#39;_&#39; is a space, right? and is this c or c#?"}, {"owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "edited": false, "score": 2, "creation_date": 1479310522, "post_id": 40636045, "comment_id": 68504476, "body": "what made you think tagging java and C# would be beneficial?"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 2, "creation_date": 1479310543, "post_id": 40636045, "comment_id": 68504489, "body": "Why isn&#39;t C++ tagged? I feel offended."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1479310544, "post_id": 40636045, "comment_id": 68504490, "body": "Just add the blank space where you want it. What&#39;s the problem ?"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1479310838, "post_id": 40636045, "comment_id": 68504695, "body": "If you are running your code in an online compiler the problem is probably on the display side and not in your code. The output is sent to a HTML page, and in HTML consequtive whitespace characters are displayed as a single space character."}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1479310999, "post_id": 40636045, "comment_id": 68504800, "body": "Try and use this service to test your code: <a href=\"https://www.tutorialspoint.com/compile_c_online.php\" rel=\"nofollow noreferrer\">tutorialspoint.com/compile_c_online.php</a>  It will show 2 spaces"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479311170, "post_id": 40636045, "comment_id": 68504917, "body": "Where do you run your program? What platform ? Apparently nobody is able to reproduce your problem."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1479312038, "creation_date": 1479312038, "answer_id": 40636647, "question_id": 40636045, "link": "https://stackoverflow.com/questions/40636045/how-can-i-add-blank-space-inside-printf-in-c-programming/40636647#40636647", "title": "How can i add blank space inside printf in c programming?", "body": "<p><code>printf(\"Hello  Dhaka!\");</code> adds 2 spaces, since it contains 2 spaces. </p>\n\n<p>The problem must be related to your output. Perhaps the console uses some strange font that is not fixed-width.</p>\n"}], "owner": {"reputation": 1, "user_id": 6116895, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-urYnTxBDXlQ/AAAAAAAAAAI/AAAAAAAAABU/qUO4TthKwtw/photo.jpg?sz=128", "display_name": "Md Asadullah", "link": "https://stackoverflow.com/users/6116895/md-asadullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "closed_date": 1479312273, "answer_count": 1, "score": -8, "last_activity_date": 1479312038, "creation_date": 1479310398, "last_edit_date": 1479310524, "question_id": 40636045, "link": "https://stackoverflow.com/questions/40636045/how-can-i-add-blank-space-inside-printf-in-c-programming", "closed_reason": "Needs details or clarity", "title": "How can i add blank space inside printf in c programming?", "body": "<p>I want to add two blank space inside c programming print statement. I have try but it always count one single space. How can i add another one ?? If i use \\t then it count 4 space as set.</p>\n\n<pre><code>printf(\"Hello  Dhaka!\");\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1479309322, "post_id": 40635513, "comment_id": 68503581, "body": "You get this error when trying to <i>link</i> it. It will compile fine."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1479308930, "creation_date": 1479308930, "answer_id": 40635539, "question_id": 40635513, "link": "https://stackoverflow.com/questions/40635513/undefined-reference-to-power/40635539#40635539", "title": "Undefined reference to power", "body": "<p>You <em>declared</em> <code>power</code> but you need to <em>implement</em> it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint power(int m, int n)\n{\n  .. your code goes here\n}\n\nint main()\n{\n    printf(\"%d\", power(2,5));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7049116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8626e533dfc27b8d3f2d38f9f1661043?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Baron", "link": "https://stackoverflow.com/users/7049116/jordan-baron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1479308976, "answer_count": 1, "score": -1, "last_activity_date": 1479308930, "creation_date": 1479308871, "question_id": 40635513, "link": "https://stackoverflow.com/questions/40635513/undefined-reference-to-power", "closed_reason": "Duplicate", "title": "Undefined reference to power", "body": "<p>I get an <code>Undefined reference</code> error when trying to compile this code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint power(int m, int n);\n\nint main()\n{\n    printf(\"%d\", power(2,5));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "lua", "openssl", "ffi", "luajit"], "owner": {"reputation": 66, "user_id": 6780332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjvzc.png?s=128&g=1", "display_name": "botwhytho", "link": "https://stackoverflow.com/users/6780332/botwhytho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479308837, "creation_date": 1479308837, "question_id": 40635500, "link": "https://stackoverflow.com/questions/40635500/getting-an-unexpected-symbol-not-found-error-when-trying-to-base64-encode-a-st", "title": "Getting an unexpected &#39;Symbol not found&#39; error when trying to Base64 encode a string with LuaJIT FFI bindings to OpenSSL&#39;s BIO_f_base64()", "body": "<p>I am trying to convert this example (found <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/BIO_f_base64.html\" rel=\"nofollow noreferrer\">here</a>) from the openssl documentation to work with LuaJIT's FFI. Scroll down for complete Lua code.</p>\n\n<pre><code>BIO *bio, *b64;\nchar message[] = \"Hello World \\n\";\n\nb64 = BIO_new(BIO_f_base64());\nbio = BIO_new_fp(stdout, BIO_NOCLOSE);\nBIO_push(b64, bio);\nBIO_write(b64, message, strlen(message));\nBIO_flush(b64);\n\nBIO_free_all(b64);\n</code></pre>\n\n<p>But when I get to this line in the code <code>ssl.BIO_flush(b64)</code>I am getting the error below (running this from the LuaJIT interpreter and not a file)\n<code>\nstdin:1: Symbol not found: BIO_flush\nstack traceback:\n        [C]: in function '__index'\n        stdin:1: in main chunk\n        [C]: at 0x0ac2cdd2f176\n</code></p>\n\n<p>I understand that there are many other ways to do base64 encoding and at this point I have switched to a pure Lua solution. I still would like to understand why I'm getting this error because in part I'm working on this project to learn more about the LuaJIT FFI interface and openssl is already a dependency for libcurl which I am already using (hitting various APIs with OAth and I want to keep my dependencies as lean as possible).</p>\n\n<p>I have already been successful at using openssl's <code>HMAC()</code> authentication function (found <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/hmac.html\" rel=\"nofollow noreferrer\">here)</a> from LuaJIT's FFI so through reading documentation and trial and error I am pretty familiar with LuaJIT's FFI interface. Lua code below. I had to navigate through <em>MANY</em> openssl header files to get to this <code>ffi.cdef[[]]</code> but seems like maybe I'm still missing something. Any help would be appreciated.</p>\n\n<p><strong>EDIT</strong>: Just to test if the <code>BIO_flush()</code> is somehow optional, I've also excluded that line and gone all the way through my code with no errors but then I check the output file and it is blank.</p>\n\n<pre><code>ffi = require \"ffi\"\n\nffi.cdef[[\ntypedef struct bio_method_st BIO_METHOD;\ntypedef struct bio_st BIO;\n\ntypedef void bio_info_cb(BIO *, int, const char *, int, long, long);\nstruct crypto_ex_data_st { struct stack_st_void *sk; };\ntypedef struct crypto_ex_data_st CRYPTO_EX_DATA;\ntypedef void CRYPTO_RWLOCK;\n\ntypedef long (*BIO_callback_fn)(BIO *b, int oper, const char *argp, int argi,long argl, long ret);\ntypedef long (*BIO_callback_fn_ex)(BIO *b, int oper, const char *argp,size_t len, int argi,long argl, int ret, size_t *processed);\n\nstruct bio_st { const BIO_METHOD *method; BIO_callback_fn callback; BIO_callback_fn_ex callback_ex; char *cb_arg;int init; int shutdown; int flags;int retry_reason; int num; void *ptr; struct bio_st *next_bio;struct bio_st *prev_bio;int references; uint64_t num_read; uint64_t num_write; CRYPTO_EX_DATA ex_data; CRYPTO_RWLOCK *lock; };\nstruct bio_method_st { int type; const char *name; int (*bwrite) (BIO *, const char *, size_t, size_t *); int (*bwrite_old) (BIO *, const char *, int); int (*bread) (BIO *, char *, size_t, size_t *); int (*bread_old) (BIO *, char *, int); int (*bputs) (BIO *, const char *); int (*bgets) (BIO *, char *, int); long (*ctrl) (BIO *, int, long, void *); int (*create) (BIO *); int (*destroy) (BIO *); long (*callback_ctrl) (BIO *, int, bio_info_cb *); };\n\ntypedef struct { char *fpos; void *base; unsigned short handle; short flags; short unget; unsigned long alloc; unsigned short buffincrement; } FILE;\n\nBIO *BIO_new(BIO_METHOD *type);\nBIO *BIO_new_fp(FILE *stream, int close_flag);\nBIO *BIO_push(BIO *b, BIO *append);\nint BIO_write(BIO *b, const void *data, int dlen);\nint BIO_read(BIO *b, void *buf, int len);\nint BIO_flush(BIO *b);\nvoid BIO_free_all(BIO *a);\n\nBIO_METHOD *BIO_f_base64(void);\n\nFILE *fopen(const char *filename, const char *mode);\nint fprintf(FILE *stream, const char *format, ...);\nint fclose(FILE *stream);\n]]\n\nBIO_NOCLOSE = 0 --# define BIO_NOCLOSE 0x00\nBIO_CLOSE = 1 --# define BIO_CLOSE 0x01\n\nssl = ffi.load('/usr/lib/libssl.so')\nf = ffi.C.fopen(\"/tmp/test\", \"a+\")\nbio = ffi.new('BIO')\nb64 = ffi.new('BIO')\nstr = \"Hello World\"\nb64 = ssl.BIO_new(ssl.BIO_f_base64())\nbio = ssl.BIO_new_fp(f, BIO_NOCLOSE)\nssl.BIO_push(b64, bio)\n=ssl.BIO_write(b64, str, #str) --This yields 11 in the Lua interpreter. This function returns an int with the number of bytes successfully written so apparently the string was written to the file.\nssl.BIO_flush(b64)\nssl.BIO_free_all(b64)\n\nffi.C.fclose(f)\n</code></pre>\n"}, {"tags": ["c", "stdin", "stdio", "getchar"], "comments": [{"owner": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 0, "creation_date": 1479308231, "post_id": 40635205, "comment_id": 68502765, "body": "Did you try <code>fflush(stdin);</code> after the statement where you call <code>getchar()</code>?"}, {"owner": {"reputation": 453, "user_id": 6241663, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/56720fce8efd8ed0e57f51fdb2cea92e?s=128&d=identicon&r=PG&f=1", "display_name": "transiti0nary", "link": "https://stackoverflow.com/users/6241663/transiti0nary"}, "reply_to_user": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 0, "creation_date": 1479308415, "post_id": 40635205, "comment_id": 68502908, "body": "yeah that didn&#39;t do anything"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 5, "creation_date": 1479308619, "post_id": 40635205, "comment_id": 68503076, "body": "@VHS You know it is a really bad advice? <code>fflush(stdin);</code> is invoking undefined behavior."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 8660, "user_id": 5749570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d2d0247d580de0aae4511d84551f10?s=128&d=identicon&r=PG&f=1", "display_name": "VHS", "link": "https://stackoverflow.com/users/5749570/vhs"}, "edited": false, "score": 0, "creation_date": 1479309338, "post_id": 40635205, "comment_id": 68503590, "body": "@VHS: Please read <a href=\"http://stackoverflow.com/questions/2979209/using-fflushstdin\">Using <code>fflush(stdin)</code></a> for a more nuanced story about <code>fflush(stdin)</code> \u2014 it is defined on Windows when using the Microsoft C run time libraries, but it is otherwise not portable."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1479310320, "post_id": 40635205, "comment_id": 68504324, "body": "It is definitively not trivial to parse input (data in general), so writing such an helper (yours is broken as good chars are lost, return them when input is correct) is very common."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479313223, "post_id": 40635205, "comment_id": 68506417, "body": "Note: Better to use <code>int input = getchar();</code> rather than <code>char input = getchar();</code>, just like code did in <code>iflush()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479313028, "post_id": 40635349, "comment_id": 68506268, "body": "Very nice except &quot;reading just one char, then an array 2 chars would be sufficient&quot;.   Usually to read one <code>char</code>, folks don&#39;t count the <code>\\n</code>. Likely need at least 3 for the: character, line-feed and null character.  Recommend buffer sizes twice what you think the maximum should be.  256 is nice for user input."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479313283, "post_id": 40635349, "comment_id": 68506464, "body": "<code>fgets()</code> would only store the <code>\\n</code> if there&#39;s no room in the buffer. So, 2 is sufficient: 1 char and the zero byte. So when reading one char (even if it&#39;s a newline) 2 byte buffer size is good enough."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479313590, "post_id": 40635349, "comment_id": 68506663, "body": "True, yet the <code>&#39;\\n&#39;</code> remains in <code>stdin</code> for the next input operation - something OP appears to want to avoid should a user under <code>&quot;y\\n&quot;</code> to read just &quot;one&quot; character.  If code needs to read one character at a time including <code>&#39;\\n&#39;</code>, just use <code>fgetc()</code> - this handles reading the null character, which is problematic with  <code>fgets()</code>."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479314000, "post_id": 40635349, "comment_id": 68506941, "body": "I have modified it slightly in order to handle that. Thanks."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1479319316, "post_id": 40635349, "comment_id": 68510477, "body": "Using strcspn () like that is bad advice as it is possible to read lines with no trailing newline character."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1479319465, "post_id": 40635349, "comment_id": 68510569, "body": "@BjornA. It&#39;s not. If there&#39;s no trailing newline, it&#39;ll simply overwrite the null byte."}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1479319595, "post_id": 40635349, "comment_id": 68510660, "body": "Usr: what happens  if the input is a single char or a line longer than the buffer?"}, {"owner": {"reputation": 1056, "user_id": 4319483, "user_type": "registered", "profile_image": "https://graph.facebook.com/668992100/picture?type=large", "display_name": "Bjorn A.", "link": "https://stackoverflow.com/users/4319483/bjorn-a"}, "edited": false, "score": 0, "creation_date": 1479319959, "post_id": 40635349, "comment_id": 68510841, "body": "@usr, forget my bad comment."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1479313938, "last_edit_date": 1479313938, "creation_date": 1479308440, "answer_id": 40635349, "question_id": 40635205, "link": "https://stackoverflow.com/questions/40635205/how-to-stop-enter-character-getting-stuck-in-buffer-c/40635349#40635349", "title": "How to stop enter character getting stuck in buffer? C", "body": "<blockquote>\n  <p>I'm left wondering why this is happening in the first place?</p>\n</blockquote>\n\n<p>It's because when you can characters with <code>%c</code> (or <code>fgetc()</code>), it doesn't ignore ay of the whitespaces in the input stream.\nSome format specifiers, for example <code>%d</code>, ignore any whitespaces left in the input stream. So, it's not a problem. But <code>%c</code> doesn't ignore it.\nHence, you typically use those \"eat\" functions.</p>\n\n<p>Think if you are scanning a whitespace character (such as <em>space</em>, newline, etc), how'd you able to scan it using <code>scanf()</code>?\nObviously, there are different and <em>better</em> ways such as using <code>fgets()</code>.</p>\n\n<blockquote>\n  <p>I'm very new to C and am keen to be sure I'm learning good habits.</p>\n</blockquote>\n\n<p>My suggestion is to avoid <code>scanf()</code> completely. Instead use <a href=\"http://man7.org/linux/man-pages/man3/fgetc.3.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> to read a line and then you can parse that line using <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a>. Please read: <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">Why does everyone say not to use scanf? What should I use instead?</a></p>\n\n<p>One thing to be aware about <code>fgets()</code> is if you input buffer has enough space, then it'll read the newline character as well,\nwhich you would want to avoid in most user inputs. So, you need to check if the last character is a newline and then remove it.</p>\n\n<p>You can achieve it using <code>strcspn()</code> function such as:</p>\n\n<pre><code>char line[256];\nif (fgets(line, sizeof line, stdin) == NULL) {\n    /* handle failure */\n}\nline[strcspn(line, \"\\n\")] = 0; /* remove the newline char if present */\n</code></pre>\n\n<p>If you are mainly interested in reading just one char, then an array 3 chars would be sufficient. Still using a larger buffer doesn't hurt:</p>\n\n<pre><code>char line[256];\nchar ch;\nif (fgets(line, sizeof line, stdin) == NULL) {\n    /* handle failure */\n}\nif (sscanf(line, \"%c\", &amp;ch) != 1) {\n    /* handle failure */        \n}\n/* Now you can use 'ch' to check if it's 'y' */\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 6241663, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/56720fce8efd8ed0e57f51fdb2cea92e?s=128&d=identicon&r=PG&f=1", "display_name": "transiti0nary", "link": "https://stackoverflow.com/users/6241663/transiti0nary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1348, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1479313938, "creation_date": 1479308049, "last_edit_date": 1479308915, "question_id": 40635205, "link": "https://stackoverflow.com/questions/40635205/how-to-stop-enter-character-getting-stuck-in-buffer-c", "title": "How to stop enter character getting stuck in buffer? C", "body": "<p>So in the following bit of code I'm reading an option from the user to then decide whether to perform a given action:</p>\n\n<pre><code>printf(\"Do you want to execute %s: \", exe);\n\nchar input = getchar();\n\nif (input == 'y') {\n    return execute(exe);\n} return 0;\n</code></pre>\n\n<p>The problem I'm having is that after the line <code>char input = getchar()</code> a character (I'm assuming an enter key or newline) gets stuck in <code>stdin</code>, and a future call to <code>fgets()</code> (reading from <code>stdin</code>) from my <code>execute()</code> function therefore eats up this stuck character and doesn't prompt the user for the required input. </p>\n\n<p>Now I can define the following function to 'eat' any stray characters for me if called before calling <code>execute()</code>...</p>\n\n<pre><code>void iflush() {\n    int c;\n\n    while ((c = getchar()) != EOF &amp;&amp; c != '\\n') {\n        continue;\n    }\n}\n</code></pre>\n\n<p>... and this solves the problem. But I'm left wondering why this is happening in the first place? Is there a more 'proper' way of getting a <code>char</code> from <code>stdin</code> without causing this stray character which then messes up my other methods? I'm very new to C and am keen to be sure I'm learning good habits.</p>\n\n<p>It seems odd that I have to add a helper method, even if simple, to prevent errors in my program just from recording some user input. I've tried using <code>fgetc()</code> also but same problem.</p>\n"}, {"tags": ["c", "filesystems", "persistence"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479309531, "post_id": 40635113, "comment_id": 68503753, "body": "The best design in terms of what ?"}, {"owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "edited": false, "score": 0, "creation_date": 1479324275, "post_id": 40635113, "comment_id": 68513237, "body": "This question seems way too broad."}], "owner": {"reputation": 1287, "user_id": 3766079, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fd9798ad5e76108e44e570d42dc735a9?s=128&d=identicon&r=PG&f=1", "display_name": "harrythomas", "link": "https://stackoverflow.com/users/3766079/harrythomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479307762, "creation_date": 1479307762, "question_id": 40635113, "link": "https://stackoverflow.com/questions/40635113/design-for-ramdisk-file-system", "title": "Design for RAMDisk file system?", "body": "<p>I am writing a RAMDisk (A filesystem in RAM with overall size less than 10 MB) as a part of my project. It should work just like a normal file system by allocating blocks of size 4KB in RAM. I am free to choose any design such as FAT, ext4 etc. The only issue is I need to persist this file system and read it back from disk when I restart my program later.</p>\n\n<p>I want to know what is the best design to write such kind of a file system considering two important aspects in mind.</p>\n\n<ol>\n<li><p>It is very small (10 MB max - Not more than 500 files)</p></li>\n<li><p>All structures (metadata) will contains pointers and I need to persist everything to hard disk.</p></li>\n</ol>\n\n<p>What is the best design for such a file system?</p>\n"}, {"tags": ["c", "arrays", "struct", "malloc", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1479307902, "post_id": 40635071, "comment_id": 68502536, "body": "For a real surprise, try <code>container arr[ARR_SIZE];</code> without the star, and see that you don&#39;t have to use <code>malloc</code> at all to get an array."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1479311878, "post_id": 40635071, "comment_id": 68505424, "body": "You are declaring an arry of pointers, in a way that does not require <code>malloc()</code>. You <b><i>might</i></b> have to <code>malloc()</code> what they point to; or you might not, depending on how/whether you dclare that"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479307912, "post_id": 40635106, "comment_id": 68502545, "body": "@SeanBright In general, that&#39;s correct, but not very relevant to <i>this</i> case, right?"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1479307974, "post_id": 40635106, "comment_id": 68502589, "body": "OP is asking why he doesn&#39;t have to allocate the array with malloc. I think it&#39;s perfectly relevant. (I deleted my previous comment because I noticed he already mentioned stack/heap in his question)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1479308222, "post_id": 40635106, "comment_id": 68502755, "body": "@SeanBright I still fail to see why that is relevant. an operation like <code>arr[i] = &amp;arr2[i];</code> would take the heap out of context completely, right?"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "edited": false, "score": 0, "creation_date": 1479308286, "post_id": 40635106, "comment_id": 68502812, "body": "Then I guess we agree to disagree."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1479308362, "last_edit_date": 1479308362, "creation_date": 1479307740, "answer_id": 40635106, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array/40635106#40635106", "title": "Don&#39;t I have to malloc() this array?", "body": "<p><code>container* arr[ARR_SIZE];</code> tells the <em>compiler</em> to allocate an array of <code>ARR_SIZE</code> <strong>elements of type</strong> <code>container*</code> and compiler allocates the memory accordingly.</p>\n\n<p>In other words, this is similar to saying <code>int x[5] = 0;</code> where compiler allocates enough space for an array of 5 <code>int</code>s. In your case, compiler allocates enough space for <code>ARR_SIZE</code> number of pointers, <code>container*</code> and that is it. Now, it's upto you to make those pointers <em>point to</em> valid memory location. For that, you can either</p>\n\n<ul>\n<li>use memory allocator functions (which allocates memory from <em>heap</em>, as you mentioned)</li>\n<li>assign the address of other variables of the same type (does not need allocation from heap, anyway).</li>\n</ul>\n\n<p>So, the bottom line, you don't need to allocate any memory <em>for</em> the array. For each individual array elements, you need to allocate memory using memory allocator functions as you want each elements to point to <em>valid</em> memory.</p>\n"}, {"comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 2, "creation_date": 1479314016, "post_id": 40635258, "comment_id": 68506949, "body": "Worth noting that such thing as <i>stack</i> is a compiler-implementation detail which is not dictated by the C language standard."}], "tags": [], "owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "is_accepted": false, "score": 4, "last_activity_date": 1479317382, "last_edit_date": 1479317382, "creation_date": 1479308191, "answer_id": 40635258, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array/40635258#40635258", "title": "Don&#39;t I have to malloc() this array?", "body": "<p>Right beneath your declaration of <code>arr</code>, you have the following:</p>\n\n<pre><code>int i;\n</code></pre>\n\n<p>Which reserves enough space <em>(probably on the \"stack\")</em> to store an <code>int</code>. Does this \"feel\" wrong to you as well?</p>\n\n<p>The declaration of <code>arr</code> is no different. The compiler allocates enough space <em>(probably on the \"stack\")</em> for a <code>ARR_SIZE</code> element array of <code>container *</code>s.</p>\n"}, {"tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": false, "score": 3, "last_activity_date": 1479308546, "creation_date": 1479308546, "answer_id": 40635387, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array/40635387#40635387", "title": "Don&#39;t I have to malloc() this array?", "body": "<p>You can choose either one of the following options:</p>\n\n<hr>\n\n<pre><code>int i;\ncontainer** arr = malloc(sizeof(container*)*ARR_SIZE);\nfor (i=0; i&lt;ARR_SIZE; i++)\n    arr[i] = malloc(sizeof(container));\n// do stuff...\nfor(i=0; i&lt;ARR_SIZE; i++)\n    free(arr[i]);\nfree(arr);\n</code></pre>\n\n<hr>\n\n<pre><code>int i;\ncontainer* arr[ARR_SIZE];\nfor (i=0; i&lt;ARR_SIZE; i++)\n    arr[i] = malloc(sizeof(container));\n// do stuff...\nfor(i=0; i&lt;ARR_SIZE; i++)\n        free(arr[i]);\n</code></pre>\n\n<hr>\n\n<pre><code>container arr[ARR_SIZE];\n// do stuff...\n</code></pre>\n\n<hr>\n\n<p>Since <code>ARR_SIZE</code> is constant, you may as well choose the last option.</p>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1479311095, "post_id": 40636121, "comment_id": 68504865, "body": "Two lines, with <code>arr[i]= malloc( sizeof( container ); if ( NULL == arr[i])...</code> works just fine, doesn&#39;t need 4 levels of parenthesis, and is thus <i>much, much</i> less bug-prone.  Stuffing an assignment into a conditional clause saves a line for a textbook at the cost of being much harder to maintain and much more likely to have bugs."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1479311317, "post_id": 40636121, "comment_id": 68505009, "body": "@AndrewHenle Cheers. I modified it."}], "tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": true, "score": 2, "last_activity_date": 1479312411, "last_edit_date": 1479312411, "creation_date": 1479310613, "answer_id": 40636121, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array/40636121#40636121", "title": "Don&#39;t I have to malloc() this array?", "body": "<p>Since <code>ARR_SIZE</code> is fixed member of the dynamic array <code>*arr[ARR_SIZE]</code>, you no longer have to allocate memory for the whole array, but just the elements within it, as they are flexible in this case.</p>\n\n<p>When you <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_malloc.htm\" rel=\"nofollow noreferrer\"><code>malloc</code></a> any sort of dynamic array, it is safe to always check the return value of the <code>void*</code> pointer returned from <code>malloc</code>. Additionally, when you <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_free.htm\" rel=\"nofollow noreferrer\"><code>free</code></a> each element, it is even safer to set each member to <code>NULL</code> again, to prevent the pointer from accessing memory again. </p>\n\n<p>Illustrated through this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define ARR_SIZE 100\n\ntypedef struct {\n    int data1;\n    int data2;\n    int data3;\n    // ...etc...\n} container_t;\n\nint\nmain(void) {\n    container_t *arr[ARR_SIZE];\n    int i;\n\n    for (i = 0; i &lt; ARR_SIZE; i++) {\n        arr[i] = malloc(sizeof(container_t));\n        if (arr[i] == NULL) {\n            printf(\"Malloc Problem here\\n\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    for (i = 0; i &lt; ARR_SIZE; i++) {\n        if (arr[i]) {\n            free(arr[i]);\n            arr[i] = NULL;\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "is_accepted": false, "score": 4, "last_activity_date": 1521021004, "last_edit_date": 1521021004, "creation_date": 1479312799, "answer_id": 40636977, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array/40636977#40636977", "title": "Don&#39;t I have to malloc() this array?", "body": "<blockquote>\n  <p>When I malloc() something, I'm reserving memory space on the heap, right?</p>\n</blockquote>\n\n<p>Don't say that, the heap is an implementation detail. You're <em>dynamically allocating memory</em>. You're also responsible for dynamically freeing it again.</p>\n\n<blockquote>\n  <p>But my container* arr[ARR_SIZE]; call</p>\n</blockquote>\n\n<p>It's not a call, it's a declaration.</p>\n\n<blockquote>\n  <p>creates the array on the stack. </p>\n</blockquote>\n\n<p>Don't say that either, the stack is also an implementation detail.</p>\n\n<p>You're declaring a local (here an array of pointers) with automatic scope, and the compiler is responsible for managing its memory and lifetime.</p>\n\n<p>Its lifetime isn't dynamic, because it becomes unreachable as soon as you reach the <code>}</code> at the end of the enclosing block, and so the compiler can handle it for you deterministically.</p>\n\n<p>All local variables behave the same here:</p>\n\n<pre><code>{\n  int i;\n  double d[2];\n} /* neither i nor d are reachable after here,\n     so the compiler takes care of releasing any storage */\n</code></pre>\n\n<blockquote>\n  <p>So... the array of container* pointers exists on the stack,</p>\n</blockquote>\n\n<p>Consider the simpler declaration <code>container c;</code>. This is a local with automatic scope, and the compiler takes care of (de)allocation as discussed.</p>\n\n<p>Now consider <code>container *p;</code>. This is <em>also</em> a local variable with automatic scope, but the variable is a pointer. You still need to point it <em>at</em> something manually, and if the thing you point it at was returned from <code>malloc</code>, you'll need to <code>free</code> it yourself.</p>\n\n<p>Further consider a simple array <code>container a[2];</code>. Now you have a local <em>array</em> with automatic scope, containing two instances of your <code>container</code> type. Both instances have the same lifetime, it's still managed by the compiler. You can access <code>a[0]</code> and <code>a[1]</code> and pretty much anything else is illegal.</p>\n\n<blockquote>\n  <p>and all of those container* pointers point to a container struct on the heap. Is that correct?</p>\n</blockquote>\n\n<p>No. Finally consider <code>container* ap[2]</code>. Again we have a local array with automatic scope, containing two <em>pointers</em>. The type of the pointer is <em>pointer-to-container</em>, and the lifetime of the <em>pointers</em> is managed by the compiler. However, the pointers don't <em>point</em> at anything yet, and it'll be your responsibility to decide what to point them at, and figure out what lifetime that <em>pointed-at</em> thing has.</p>\n\n<p>Once you do</p>\n\n<pre><code>ap[i] = malloc(sizeof(*ap[i]));\n</code></pre>\n\n<p>(you don't need to cast, and it's generally safer to avoid naming the type explicitly, in case you change it later and allocate the wrong size), you've allocated an object which you're responsible for freeing. You've also pointed one of the pointers in your array at this object, but that doesn't somehow change the lifetime of the pointer itself. The array just goes out of scope like usual <em>wherever</em> its pointers point.</p>\n"}], "owner": {"reputation": 965, "user_id": 4040743, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/hAIWy.jpg?s=128&g=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/4040743/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1362, "favorite_count": 0, "accepted_answer_id": 40636121, "answer_count": 5, "score": 3, "last_activity_date": 1521021004, "creation_date": 1479307635, "last_edit_date": 1479390449, "question_id": 40635071, "link": "https://stackoverflow.com/questions/40635071/dont-i-have-to-malloc-this-array", "title": "Don&#39;t I have to malloc() this array?", "body": "<p>I'm struggling to learn the C rules of malloc() / free().  Consider the below code, which runs just fine.  (On Linux, compiled with GCC.)  Specifically, I'm wondering about the <code>arr</code> array.  I get that you have to malloc for all the struct elements <em>within</em> the array... <strong><em>but why don't you have to malloc for the array</em></strong> <strong><em>itself</em></strong>?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#define ARR_SIZE 100\n\ntypedef struct containerStruct{\n    int data1;\n    int data2;\n    int data3;\n    // ...etc...\n} container;\n\nint main(){\n\n    container* arr[ARR_SIZE];       // Don't I have to malloc this?\n\n    int i;\n    for(i=0; i&lt;ARR_SIZE; i++){\n            arr[i] = (container*) malloc (sizeof(container));   // I get why I have to malloc() here\n    }\n\n    ...do stuff...\n\n    for(i=0; i&lt;ARR_SIZE; i++){\n            free(arr[i]);        // I get why I have to free() here\n    }\n\n    // Don't I have to free(arr) ?\n    return 0;\n}\n</code></pre>\n\n<p>I'm guessing that the <code>container* arr[ARR_SIZE];</code> line tells the compiler all it needs to know to carve out the space in memory for the array, which is why this code works.</p>\n\n<p>But it still doesn't \"feel\" right, somehow.  When I malloc() something, I'm reserving memory space on the heap, right?  But my <code>container* arr[ARR_SIZE];</code> call creates the array on the stack.  So... the array of container* porters exists on the stack, and all of those container* pointers point to a container struct on the heap.  Is that correct?</p>\n"}, {"tags": ["c", "ipc", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 2333, "user_id": 2179300, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0e07c421cc157c2187549c5f0154226d?s=128&d=identicon&r=PG", "display_name": "Bodo Thiesen", "link": "https://stackoverflow.com/users/2179300/bodo-thiesen"}, "edited": false, "score": 2, "creation_date": 1479936912, "post_id": 40754069, "comment_id": 68772923, "body": "It should be noted that &quot;need not be initialized&quot; doesn&#39;t mean, the implementation is forbidden to initialize it. So, the posted code might just have worked all time, because it always ran on a system, that initialized the data to 0. But the next system, the code is ported to, might not do it, and then the code crashes or misbehaves in suble ways."}], "tags": [], "owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "is_accepted": true, "score": 5, "last_activity_date": 1479860562, "creation_date": 1479860562, "answer_id": 40754069, "question_id": 40635042, "link": "https://stackoverflow.com/questions/40635042/is-it-correct-to-call-semget-followed-by-semop-without-calling-semctl/40754069#40754069", "title": "Is it correct to call semget() followed by semop() without calling semctl()?", "body": "<p>Your understanding is correct, the code is not portable. The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/semget.html\" rel=\"nofollow noreferrer\">POSIX.1-2008 specification of <code>semget</code></a> does not require the semaphore to be initialized:</p>\n\n<blockquote>\n  <p>Upon creation, the <strong>semid_ds</strong> data structure associated with the new\n  semaphore identifier is initialized as follows:</p>\n  \n  <ul>\n  <li><p>In the operation permissions structure <code>sem_perm.cuid</code>, <code>sem_perm.uid</code>,  <code>sem_perm.cgid</code>, and <code>sem_perm.gid</code> shall be set to the\n  effective user ID and effective group ID, respectively, of the calling\n  process.</p></li>\n  <li><p>The low-order 9 bits of <code>sem_perm.mode</code> shall be set to the low-order 9 bits of <code>semflg</code>.</p></li>\n  <li><p>The variable <code>sem_nsems</code> shall be set to the value of <code>nsems</code>.</p></li>\n  <li><p>The variable <code>sem_otime</code> shall be set to 0 and <code>sem_ctime</code> shall be set to the current time, as described in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_07_01\" rel=\"nofollow noreferrer\">IPC General Description</a>.</p></li>\n  <li><p>The data structure associated with each semaphore in the set <strong>need not be initialized</strong>. The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/semctl.html\" rel=\"nofollow noreferrer\"><code>semctl()</code></a> function with the command SETVAL or\n  SETALL can be used to initialize each semaphore.</p></li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "is_accepted": false, "score": 2, "last_activity_date": 1480029847, "last_edit_date": 1495542271, "creation_date": 1480029847, "answer_id": 40795718, "question_id": 40635042, "link": "https://stackoverflow.com/questions/40635042/is-it-correct-to-call-semget-followed-by-semop-without-calling-semctl/40795718#40795718", "title": "Is it correct to call semget() followed by semop() without calling semctl()?", "body": "<h1>Disclaimer</h1>\n\n<p>This was not supposed to be an answer, but it wouldn't fit in the comments as it kept growing...</p>\n\n<hr>\n\n<h1>The Technical Domain</h1>\n\n<p><a href=\"https://stackoverflow.com/users/164344/tim\"><strong>Tim</strong></a> <a href=\"https://stackoverflow.com/a/40754069/1928852\">answers</a> your question pretty well in the technical domain (<em>which is what SO is all about</em>). However, I'm feeling <em>philosophical</em> tonight and I think that the source of your doubt may be more subtle: I think that your question is more about <em>the context and the author</em> than it is about the code. </p>\n\n<hr>\n\n<h1>A Load of Personal Opinions</h1>\n\n<p>From what you posted:</p>\n\n<blockquote>\n  <p><strong>Semaphore initialization</strong></p>\n  \n  <p><em>The values of the semaphores in a newly created set are indeterminate.</em> (POSIX.1-2001 and POSIX.1-2008 are explicit on this point, although POSIX.1-2008 notes that a future version of the standard may require an implementation to initialize the semaphores to 0.) <strong>Although Linux, like many other implementations, initializes the semaphore values to 0, a portable application cannot rely on this: it should explicitly initialize the semaphores to the desired values.</strong></p>\n</blockquote>\n\n<p>You're following a guide which has the title: \"<em>Beej's Guide to Unix IPC</em>\". Some <strong>very</strong> important things should pop out when you read a title like that:</p>\n\n<ol>\n<li><p>it's a one person view of something - it's <strong>his</strong> way of doing it. Specifically, a person named Brian Hall that goes by the nickname of \"Beej\".</p></li>\n<li><p>it specifically says it's for Unix (Linux actually, see bellow).</p></li>\n<li><p>if you read <a href=\"http://beej.us/brian_beej_hall_resume.pdf\" rel=\"nofollow noreferrer\">Beej's resume</a>(PDF), you'll see that by the range of domains he has knowledge in, he's no simple programmer. He's a <strong>tinkerer</strong>, and tinkerers do whatever the hell they want. That's why they're the clever dudes - they make lots of mistakes, thus, they learn a whole lot more than others.</p></li>\n</ol>\n\n<p>Therefore, the author may do anything he wants and he may write whatever he wants in the paper - that includes using platform specific features/bugs/traps/standards/etc. There's a <a href=\"http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html#platform\" rel=\"nofollow noreferrer\">part in the article</a> that explicitly tells you the <em>POSIXey</em> nature of the article and the platform in which this code is meant to be compiled and run:</p>\n\n<blockquote>\n  <p><strong>1.1. Audience</strong> </p>\n  \n  <p>If you know C or C++ and are pretty good using a Unix environment (<strong>or other POSIXey</strong> environment that supports these system calls) these documents are for you. </p>\n  \n  <p>(...)</p>\n  \n  <p><strong>1.2. Platform and Compiler</strong></p>\n  \n  <p>The examples in this document were <strong>compiled under Linux using gcc</strong>. They should compile anywhere a good Unix compiler is available.</p>\n</blockquote>\n\n<p>Again, more loads of personal opinion: he's saying that he's using <strong>Linux</strong> and <strong>gcc</strong>. So, the title could have been rewritten as:</p>\n\n<h2>Unreliable Hacker's Guide to Linux IPC programming using GCC</h2>\n\n<p>That sounds a lot like a <a href=\"https://en.wikipedia.org/wiki/Rusty_Russell\" rel=\"nofollow noreferrer\">Rusty Russell</a>'s article title! (Another tinkerer, by the way). Anyway, <strong>with a title like that, would you really be concerned about POSIX?</strong></p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1187, "favorite_count": 0, "accepted_answer_id": 40754069, "answer_count": 2, "score": 4, "last_activity_date": 1480029847, "creation_date": 1479307571, "question_id": 40635042, "link": "https://stackoverflow.com/questions/40635042/is-it-correct-to-call-semget-followed-by-semop-without-calling-semctl", "title": "Is it correct to call semget() followed by semop() without calling semctl()?", "body": "<p>I was going through the example program for semaphores in <a href=\"http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html#semsamp\" rel=\"nofollow noreferrer\">Beej's Guide to Unix IPC</a>.</p>\n\n<p>The example program contains the following semaphore initialization code. I am only posting a snippet from it that is relevant to the question. To see the complete code, visit the link I have provided above.</p>\n\n<pre><code>/*\n** initsem() -- more-than-inspired by W. Richard Stevens' UNIX Network\n** Programming 2nd edition, volume 2, lockvsem.c, page 295.\n*/\nint initsem(key_t key, int nsems)  /* key from ftok() */\n{\n    int i;\n    union semun arg;\n    struct semid_ds buf;\n    struct sembuf sb;\n    int semid;\n\n    semid = semget(key, nsems, IPC_CREAT | IPC_EXCL | 0666);\n\n    if (semid &gt;= 0) { /* we got it first */\n        sb.sem_op = 1; sb.sem_flg = 0;\n        arg.val = 1;\n\n        printf(\"press return\\n\"); getchar();\n\n        for(sb.sem_num = 0; sb.sem_num &lt; nsems; sb.sem_num++) { \n            /* do a semop() to \"free\" the semaphores. */\n            /* this sets the sem_otime field, as needed below. */\n            if (semop(semid, &amp;sb, 1) == -1) {\n                int e = errno;\n                semctl(semid, 0, IPC_RMID); /* clean up */\n                errno = e;\n                return -1; /* error, check errno */\n            }\n        }\n</code></pre>\n\n<p>Here is what I am unable to understand. Once <code>semget()</code> creates semaphores and returns successfully with a valid semaphore ID, the semaphores themselves are uninitialized and in an indeterminate state. This is confirmed by the man page of <code>semget</code>.</p>\n\n<blockquote>\n  <p><strong>Semaphore initialization</strong></p>\n  \n  <p>The values of the semaphores in a newly created set are indeterminate.  (POSIX.1-2001 and POSIX.1-2008 are explicit on this point, although POSIX.1-2008 notes that a future version of the standard may\n  require an implementation to initialize the semaphores to 0.)  Although Linux, like many other implementations, initializes the semaphore values to 0, a portable application cannot rely  on  this:  it\n  should explicitly initialize the semaphores to the desired values.</p>\n  \n  <p>Initialization can be done using semctl(2) SETVAL or SETALL operation.  Where multiple peers do not know who will be the first to initialize the set, checking for a nonzero sem_otime in the associated\n  data structure retrieved by a semctl(2) IPC_STAT operation can be used to avoid races.</p>\n</blockquote>\n\n<p>But in the above code <code>semctl()</code> was not called to initialize the semaphores. Instead, <code>semop()</code> was called with <code>sem_op</code> = <code>1</code>, which according to the man page of <code>semop</code> does the following.</p>\n\n<blockquote>\n  <p>If sem_op is a positive integer, the operation adds this value to the semaphore value (semval).  Furthermore, if SEM_UNDO is specified for this operation, the system subtracts the  value  sem_op  from\n  the semaphore adjustment (semadj) value for this semaphore.  This operation can always proceed\u2014it never forces a thread to wait.  The calling process must have alter permission on the semaphore set.</p>\n</blockquote>\n\n<p>But without initialization, <code>semval</code> was indeterminate. So adding <code>1</code> to it still leaves it indeterminate.</p>\n\n<p>Is this code incorrect or is my understanding incorrect? If my understanding is incorrect, could you please explain me why this code is correct?</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "gpio", "adc"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1479309237, "post_id": 40634947, "comment_id": 68503523, "body": "Why not expose them as character devices that emit raw binary data? Or you could use a HID-like protocol with the devices."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "reply_to_user": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 1, "creation_date": 1479329101, "post_id": 40634947, "comment_id": 68515972, "body": "Subsystem is called Industrial IO (IIO). @IgnacioVazquez-Abrams because there is a specific subsystem for such sensors."}, {"owner": {"reputation": 57058, "user_id": 476681, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/v9mVv.jpg?s=128&g=1", "display_name": "B\u0408\u043e\u0432\u0438\u045b", "link": "https://stackoverflow.com/users/476681/b%d0%88%d0%be%d0%b2%d0%b8%d1%9b"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1488390131, "post_id": 40634947, "comment_id": 72212603, "body": "@0andriy   To simplify search: <a href=\"https://stackoverflow.com/questions/tagged/iio\">iio</a>, although not many questions"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479307303, "creation_date": 1479307303, "question_id": 40634947, "link": "https://stackoverflow.com/questions/40634947/what-linux-kernel-subsytem-allows-reading-of-a-uint16-t-from-userspace", "title": "What Linux kernel subsytem allows reading of a uint16_t from userspace?", "body": "<p>I'm writing a few kernel modules (as part of porting Linux to a new ARM board).</p>\n\n<p>Most of what I want to expose to userspace fits nicely into the /sys/class/gpio and /sys/class/leds subsystems.</p>\n\n<p>I have a couple of 12 bit ADCs which I want to expose to userspace.</p>\n\n<p>Which subsystem should I use for this?</p>\n\n<p>(Worst-case is exposing them as a character devices which stream the values as newline separated decimal values.  The two ADCs are part of a multi-function-device, accessed over an i2c bus by reading two 16-bit registers.)</p>\n\n<p>I tried returning <code>42</code> from a gpio module's <code>gpio_chip.get</code> function pointer, but it was changed to <code>1</code> by the time it reached userspace.</p>\n"}, {"tags": ["c", "pointers", "shared-libraries", "function-pointers"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1479309351, "post_id": 40634772, "comment_id": 68503596, "body": "It&#39;s not very clear what you&#39;re trying to achieve. What would assigning <code>spi_write</code> to the parameter accomplish? What <i>is</i> <code>spi_write</code>? (Also, when you write <code>x = y;</code>, you&#39;re &quot;assigning y to x&quot;, not the other way around.)"}], "answers": [{"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 0, "last_activity_date": 1479308317, "last_edit_date": 1479308317, "creation_date": 1479307633, "answer_id": 40635070, "question_id": 40634772, "link": "https://stackoverflow.com/questions/40634772/error-while-passing-function-pointer-as-parameter/40635070#40635070", "title": "Error while Passing function pointer as parameter", "body": "<pre><code>extern int send_data(int (*func_pointer)(&amp;data_buffer)); //is the declaration correct\n</code></pre>\n\n<p>The parameter of a function must be a type. Types use <code>*</code> to indicate that it is a pointer. So <code>&amp;data_buffer</code> is incorrect in a declaration.</p>\n\n<p>Also note that in C, unlike C++, a struct name is not a type, you need to combine it with the keyword <code>struct</code> (or use a typedef). So use:</p>\n\n<pre><code>extern int send_data(int (*func_pointer)(struct data_buffer *));\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7017277, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/126fe2db99a033095642278b216357aa?s=128&d=identicon&r=PG&f=1", "display_name": "sampat nayak", "link": "https://stackoverflow.com/users/7017277/sampat-nayak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 40635070, "answer_count": 1, "score": 0, "last_activity_date": 1479308317, "creation_date": 1479306846, "question_id": 40634772, "link": "https://stackoverflow.com/questions/40634772/error-while-passing-function-pointer-as-parameter", "title": "Error while Passing function pointer as parameter", "body": "<p>I have a program which will call a function present in a library. The arguments of the function is a function pointer.</p>\n\n<p>Helloworld.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n#include \"helloworld.h\"\n\nstruct data_buffer\n   {\n        char name[10];\n   }data;\n\nint main()\n  {\n     int result; \n\n     int (*func_pointer)(&amp;data_buffer); //function pointer which takes structure as parameter\n\n      result=send_data(func_ponter); //error\n\n      func_pointer(&amp;data_buffer);  //call the SPI write\n\n  }\n</code></pre>\n\n<p>helloworld.h</p>\n\n<pre><code>#ifndef HELLOWORLD_H\n#define HELLOWORLD_H\n\n/* Some cross-platform definitions generated by autotools */\n#if HAVE_CONFIG_H\n#  include &lt;config.h&gt;\n#endif /* HAVE_CONFIG_H */\n/*\n * Example function\n */\n\nstruct data_buffer;\n\nextern int send_data(int (*func_pointer)(&amp;data_buffer)); //is the declaration correct\n\n#endif \n</code></pre>\n\n<p>libexample.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n\nint send_data(int (*func_pointer)(&amp;data_buffer)) //error \n{\n\nfunc_pointer=spi_write();  // assigning the function pointer to SPI WRITE function\nreturn;\n}\n</code></pre>\n\n<p>so my aim of the project is to send a function pointer as the parameter to  send_data function. in the library program the function pointer must be assigned to spi_write() function and then the SPI_Write can be called with the help of function pointer in the  Helloworld program.</p>\n"}, {"tags": ["c", "mutex", "multicore", "mutual-exclusion"], "comments": [{"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1479310363, "post_id": 40634614, "comment_id": 68504364, "body": "It depends on if operations on <code>uint8_t</code> are atomic. Usually on <code>int</code> they are, but I don&#39;t know about <code>uint8_t</code> on your system."}, {"owner": {"reputation": 21, "user_id": 7167779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade1d180a09c9075a2c53d4bc236636f?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/7167779/steven"}, "reply_to_user": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1479314424, "post_id": 40634614, "comment_id": 68507245, "body": "I believe that this implementation would work even if the operations on <code>uint8_t</code> weren&#39;t atomic (because we only care if the status is equal to zero or it is not)."}, {"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 1, "creation_date": 1479315302, "post_id": 40634614, "comment_id": 68507863, "body": "Keep in mind that modern hardware is allowed to re-order memory accesses under circumstances... How do you ensure that the other core does not see <code>mstatus == 1</code> until after all the data has been written? You need at least some memory barriers, if not a full mutex approach."}, {"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "reply_to_user": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1479488549, "post_id": 40634614, "comment_id": 68595076, "body": "@Steven It&#39;s not that simple. Some processors might write the variable bit by bit, clear it before writing, store garbage in it temporarily, use bitshifts, logic operators, etc. Furthermore, your compiler (and sometimes your processor, as @twalberg noted) may reorder memory accesses to increase performance, however this can be avoided using a simple <code>volatile</code> on the <code>mstatus</code>. However, as I explained, This is useless if operations on <code>uint8_t</code> aren&#39;t atomic."}, {"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1479489156, "post_id": 40634614, "comment_id": 68595415, "body": "@Steven Now, on most processors common operations on <code>uint8_t</code> (At least read and write) <i>are</i> atomic, and your code would work as expected (given you define <code>mstatus</code> <code>volatile</code>), so you should be alright. Otherwise, you&#39;ll have to use C11, or if that&#39;s not possible something platform specific, like linux&#39;s <code>futex</code> or GCC&#39;s <code>__atomic</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 0, "last_activity_date": 1500826160, "creation_date": 1500826160, "answer_id": 45267191, "question_id": 40634614, "link": "https://stackoverflow.com/questions/40634614/simple-c-mutual-exclusion-implementation-in-a-dual-core-amp-system/45267191#45267191", "title": "Simple C mutual exclusion implementation in a dual core AMP system", "body": "<p>Mutexes are not only about control of the data that is directly affected but also about guarantees that the threads mutually see other data consistently. C before C11 does not have the definitions and tools to even speak about this, and you would be completely dependent on architecture specific behavior.</p>\n\n<p>What could happen here in your setting, e.g, is that by some architecture bias, changes to the <code>status</code> field may be visible to the other thread, where changes to the <code>mdata</code> fields might not be yet transferred (think of cache hierarchies, word alignment ...).</p>\n\n<p>So, no, you shouldn't do this, unless you know exactly would data consistency model is implemented for your platform.</p>\n\n<p>And the minimum requirement to make this work on <em>any</em> platform is to qualify your variables as <code>volatile</code>, because otherwise an optimizing compiler might pretend that no changes to any data can occur from outside the current function.</p>\n"}], "owner": {"reputation": 21, "user_id": 7167779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ade1d180a09c9075a2c53d4bc236636f?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/7167779/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1500826160, "creation_date": 1479306399, "question_id": 40634614, "link": "https://stackoverflow.com/questions/40634614/simple-c-mutual-exclusion-implementation-in-a-dual-core-amp-system", "title": "Simple C mutual exclusion implementation in a dual core AMP system", "body": "<p>I am working with the Zynq-7000 SoC - developing a dual core (CPU0, CPU1) application. I want to use the shared on-chip memory (OCM) with cache disabled for bidirectional data exchanging between the cores. My idea is to set the data sharing in the following manner:</p>\n\n<pre><code>typedef struct\n{\n  uint8_t mstatus;\n  uint8_t[10] mdata;\n} mailbox;\n\nmailbox core0mbox;\nmailbox core1mbox;\n</code></pre>\n\n<p>Structure <code>mailbox</code> holds a buffer for storing the data (<code>mdata</code>) and its status (<code>mstatus</code>). The status may be equal to <code>0</code> or <code>1</code> (in general - a zero value indicates that the data has been processed by the receiver and new data may be written into the buffer; a non-zero value indicates that the data has not been processed by the receiver yet). There are two mailboxes - <code>core0mbox</code> (stores the data received by core 0 from core 1) and <code>core1mbox</code> (stores the data received by core 1 from core 0), both stored in the OCM.</p>\n\n<p>When the core 0 wants to send the data, it polls the status flag <code>core1mbox.mstatus</code></p>\n\n<ul>\n<li>if it is equal to zero, the core fills the buffer associated with <code>core1mbox</code> with data and then sets the flag associated with <code>core1mbox</code> to <code>1</code></li>\n<li>if it has a non-zero value, the core cannot send the data</li>\n</ul>\n\n<p>When the core 1 wants to send the data, it polls the status flag <code>core0mbox.mstatus</code></p>\n\n<ul>\n<li>if it is equal to zero, the core fills the buffer associated with <code>core0mbox</code> with data and then sets the flag associated with <code>core0mbox</code> to <code>1</code></li>\n<li>if it has a non-zero value, the core cannot send the data</li>\n</ul>\n\n<p>The core 0 periodically polls the <code>core0mbox.mstatus</code> - if it has a non-zero value, then the core 0 processes the data and after finishing it sets <code>core0mbox.mstatus</code> to <code>0</code>.</p>\n\n<p>The core 1 periodically polls the <code>core1mbox.mstatus</code> - if it has a non-zero value, then the core 1 processes the data and after finishing it sets <code>core1mbox.mstatus</code> to <code>0</code>.</p>\n\n<p>My question is - could this scheme lead to an undetermined behavior of the system (e.g. data corruption) due to problems caused by the concurrent accesses? I know that this scheme could not work if the status flag could have more values (problems due to non-atomic write/read operation) or if there would be a larger number of cores in the system, but it seems to work well for the situation described.</p>\n"}, {"tags": ["c", "pointers", "char", "strcpy"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1479306341, "post_id": 40634573, "comment_id": 68501430, "body": "Hint: <code>char texto;</code> is not what you want."}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479306423, "post_id": 40634573, "comment_id": 68501479, "body": "and what do I want?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479306448, "post_id": 40634573, "comment_id": 68501498, "body": "<code>texto = &quot;Hola&quot;;</code>...you tell me? :)"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1479306451, "post_id": 40634573, "comment_id": 68501503, "body": "A little star... ;)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1479306452, "post_id": 40634573, "comment_id": 68501504, "body": "Out of interest, could you use C++, where such things are easier?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479306487, "post_id": 40634573, "comment_id": 68501534, "body": "see <a href=\"http://stackoverflow.com/a/40631662/2173917\">this</a>, specifically #2"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1479306507, "post_id": 40634573, "comment_id": 68501547, "body": "@Bathsheba don&#39;t go over to the dark side. ;)"}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479306634, "post_id": 40634573, "comment_id": 68501655, "body": "Sourav Ghosh I didn&#39;t put it like that because in my actual program I define first the variable <code>texto</code>, and then I give it its value way down the program with snprintf, wanted it to look as much as the program as possible. Bathsheba, I can&#39;t use C++, it&#39;s for a class where I am supposed to learn C."}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479306751, "post_id": 40634573, "comment_id": 68501743, "body": "I initialized the variable in my big program like <code>char texto[128];  memset(texto , 0, sizeof(texto));</code> and then changed its value with snprintf as the program went along. So I dont think #2 applies even though to the actual thing even though it could to the example."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1479306853, "post_id": 40634573, "comment_id": 68501815, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3131319/how-to-correctly-assign-a-new-string-value\">How to correctly assign a new string value?</a>"}, {"owner": {"reputation": 2202, "user_id": 6544931, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3sbO-9nfAm0/AAAAAAAAAAI/AAAAAAAAABQ/g0E6_EKA2U4/photo.jpg?sz=128", "display_name": "Akash Mahapatra", "link": "https://stackoverflow.com/users/6544931/akash-mahapatra"}, "edited": false, "score": 0, "creation_date": 1479306856, "post_id": 40634573, "comment_id": 68501820, "body": "Think about , a char and a collection of chars :) There must be some difference in the usage."}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479307009, "post_id": 40634573, "comment_id": 68501923, "body": "LPs, I had already seen that thread, it does not resolve my question since they are working with struct and not pointers."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1479307248, "post_id": 40634573, "comment_id": 68502094, "body": "It uses arrays of chars, sturct is only a container in that case. You should take a look to <a href=\"http://stackoverflow.com/questions/1461432/what-is-array-decaying\">this post</a> too"}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 2, "creation_date": 1479307303, "post_id": 40634573, "comment_id": 68502136, "body": "Heed the compiler warnings, the compiler is your friend."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1479307350, "post_id": 40634573, "comment_id": 68502166, "body": "<a href=\"http://ideone.com/YhC2WR\" rel=\"nofollow noreferrer\">example of modify</a>"}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479307593, "post_id": 40634573, "comment_id": 68502344, "body": "LPs, I am not sure how what says in the struct thread can help with pointers, or how the last thread you put could help either, really cool information though. Could you be more explicit in how you think it would help? I really dont see any code that could be used for my example, but then again I haven&#39;t been at it for long."}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479307842, "post_id": 40634573, "comment_id": 68502491, "body": "Thanks BLUEPIXY! It works! Do you know why you dont have to add the &amp; before the variable?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1479308022, "post_id": 40634573, "comment_id": 68502617, "body": "Arrays are treated as pointers when passing to functions."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1479308481, "post_id": 40634573, "comment_id": 68502965, "body": "<a href=\"http://ideone.com/YhC2WR\" rel=\"nofollow noreferrer\">example if you want allocate by malloc at inside function.</a>"}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1479308967, "post_id": 40634573, "comment_id": 68503325, "body": "Thanks BLUEPIXY. You could write your answer again below so that I can close this thread as solved :)"}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1479311914, "post_id": 40636275, "comment_id": 68505452, "body": "Now would be a good time to demonstrate the importance of free()"}, {"owner": {"reputation": 130, "user_id": 7083585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/im60o.png?s=128&g=1", "display_name": "\u90ed\u6625\u6797", "link": "https://stackoverflow.com/users/7083585/%e9%83%ad%e6%98%a5%e6%9e%97"}, "reply_to_user": {"reputation": 273, "user_id": 3722559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50ae714cac6c3fe6897729aca735eaea?s=128&d=identicon&r=PG&f=1", "display_name": "schil227", "link": "https://stackoverflow.com/users/3722559/schil227"}, "edited": false, "score": 0, "creation_date": 1479314209, "post_id": 40636275, "comment_id": 68507085, "body": "free() is very important as C doesn&#39;t have garbage collection feature. How can I forget that? Hmm..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479335150, "post_id": 40636275, "comment_id": 68519008, "body": "Curious why cast <code>(char *)</code> in <code>char *texto = (char *)malloc(SIZE);</code> versus just simply <code>char *texto = malloc(SIZE);</code>?  Certainly <code>char *texto = malloc(SIZE);</code> is legal C."}, {"owner": {"reputation": 130, "user_id": 7083585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/im60o.png?s=128&g=1", "display_name": "\u90ed\u6625\u6797", "link": "https://stackoverflow.com/users/7083585/%e9%83%ad%e6%98%a5%e6%9e%97"}, "edited": false, "score": 0, "creation_date": 1479354822, "post_id": 40636275, "comment_id": 68524477, "body": "For sake of compatibility with C++, we use char *texto = (char *)malloc(SIZE)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1479355430, "post_id": 40636275, "comment_id": 68524594, "body": "You could use <code>char texto[SIZE];</code> inside the function (or in both cases really)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1479355459, "post_id": 40636275, "comment_id": 68524604, "body": "<code>texto = &quot;Hola;&quot;</code> leaks memory and then <code>free(texto)</code> is undefined behaviour.  <code>=</code> is different to <code>strcpy</code>."}, {"owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "edited": false, "score": 0, "creation_date": 1480881972, "post_id": 40636275, "comment_id": 69135442, "body": "Why is it necessary to use free(texto), thought that since sum_and_diff is a function on it&#39;s own the memory used by it would be deleted on its own."}], "tags": [], "owner": {"reputation": 130, "user_id": 7083585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/im60o.png?s=128&g=1", "display_name": "\u90ed\u6625\u6797", "link": "https://stackoverflow.com/users/7083585/%e9%83%ad%e6%98%a5%e6%9e%97"}, "is_accepted": true, "score": -1, "last_activity_date": 1479355115, "last_edit_date": 1479355115, "creation_date": 1479311079, "answer_id": 40636275, "question_id": 40634573, "link": "https://stackoverflow.com/questions/40634573/char-pointers-and-strcpy-in-c/40636275#40636275", "title": "char pointers and strcpy in C", "body": "<p>Declaring a pointer to char without allocation is a mistake.\nYou see my code.\n    [c]</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define SIZE    8\n\nint sum_and_diff (int a, int b, int *res, char *text);\n\nint main(void)\n{\n    int b = 2;\n    int diff;\n    char *texto = (char *)malloc(SIZE);\n    if (!texto)\n        abort();\n    printf(\"La suma de 5 y %d es %d\\n\", b, sum_and_diff(5, b, &amp;diff, texto));\n    printf(\"La diferencia de 5 y %d es %d\\n\", b, diff);\n    printf(\"El texto es %s\\n\", texto);\n    free(texto);\n}\n\nint sum_and_diff (int a, int b, int *res, char *text)\n{\n    char *texto = (char *)malloc(SIZE);\n    int sum;\n    if (!texto)\n        abort();\n    sum = a + b;\n    *res = a - b;\n    texto = \"Hola\";\n    strcpy(text, texto);\n    free(texto);\n    return sum;\n}\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 5513902, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bc64ae929f2dcff6720c1e76e8b7c5be?s=128&d=identicon&r=PG&f=1", "display_name": "M.O.", "link": "https://stackoverflow.com/users/5513902/m-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 40636275, "answer_count": 1, "score": 3, "last_activity_date": 1479355115, "creation_date": 1479306279, "last_edit_date": 1479308888, "question_id": 40634573, "link": "https://stackoverflow.com/questions/40634573/char-pointers-and-strcpy-in-c", "title": "char pointers and strcpy in C", "body": "<p>First let me start saying I have read all the questions related to this subject and can't find a solution for my problem. All the answers seem to be to stop using pointers and chars(which I need to do) or are about other structures. </p>\n\n<p>I need to create a function that returns an integer, but also saves the steps of the process, which I will save as characters using snprintf and pointers. I will leave the basic idea but it's way more complicated than what I will put.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nint sum_and_diff (int a, int b, int *res, char *text);\n\nint main(void){\n    int b = 2;\n    int diff;\n    char texto;\n\n    printf(\"La suma de 5 y %d es %d\\n\", b, sum_and_diff(5, b, &amp;diff, &amp;texto));\n    printf(\"La diferencia de 5 y %d es %d\\n\", b, diff);\n    printf(\"El texto es %s\\n\", texto);\n}\n\n\n\nint sum_and_diff (int a, int b, int *res, char *text){\n    char texto;\n    int sum;\n\n    //text = malloc(sizeof(char) * 254);\n    //text = (char *)malloc(sizeof(char) * 254);\n    sum = a + b;\n    *res = a - b;\n    texto = \"Hola\";\n    strcpy(*text, texto);\n    //strcpy(text, texto);\n    return sum;\n}\n</code></pre>\n\n<p>I wanted to use this example because it shows how you can use pointers inside of a function to get more information, the same procedure used to get diff is not working for the character type. </p>\n\n<p>The only difference with my actual program is that the variable \"texto\" gets its character value from snprintf (does what I need it to do, I have checked by priting the variable inside the function). The problem is in getting the pointer to point to the variable.</p>\n\n<p>Thanks! I am using gcc 4.9 to compile if it makes a difference. The things that are commented are things I have tried that haven't worked, have also tried some other slight variations from those.</p>\n"}, {"tags": ["c", "gcc", "c-preprocessor", "static-analysis"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 2, "creation_date": 1479305884, "post_id": 40634173, "comment_id": 68501076, "body": "Are you sure you aren&#39;t mixing the preprocessor and compiler? The preprocessor only replaces your <code>defines</code> (and <code>includes</code> and other macros) it does not perform any kind of optimizations. That is the compiler&#39;s job."}], "answers": [{"tags": [], "owner": {"reputation": 6049, "user_id": 1595323, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2dd4e62d8f84c5dee2d68ba35393f266?s=128&d=identicon&r=PG", "display_name": "Konstantin Vladimirov", "link": "https://stackoverflow.com/users/1595323/konstantin-vladimirov"}, "is_accepted": false, "score": 3, "last_activity_date": 1479306163, "creation_date": 1479306163, "answer_id": 40634541, "question_id": 40634173, "link": "https://stackoverflow.com/questions/40634173/gcc-preprocessor-plus-static-analysis/40634541#40634541", "title": "GCC preprocessor PLUS static analysis?", "body": "<p>GCC do not optimize preprocessed C code. After preprocessing, this code translates to high-level IR (GIMPLE), where most optimizations are applied, before lowering to low-level IR like RTL.</p>\n\n<p>What do you want is optimized GIMPLE dump to look up these to constants. You shall use optimized tree dump like this:</p>\n\n<pre><code>gcc -O2 -fdump-tree-optimized test.c -S\n</code></pre>\n\n<p>Then look for file like test.c.211t.optimized (number 211 may differ and depends on gcc version). Gimple code is very similar to primitive C, so you will have no problems to read your constants from it.</p>\n"}, {"tags": [], "owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "is_accepted": true, "score": 2, "last_activity_date": 1479314328, "last_edit_date": 1479314328, "creation_date": 1479313022, "answer_id": 40637059, "question_id": 40634173, "link": "https://stackoverflow.com/questions/40634173/gcc-preprocessor-plus-static-analysis/40637059#40637059", "title": "GCC preprocessor PLUS static analysis?", "body": "<p>Most compilers run the preprocessor to get a text string for the program source, and then parse that to compiler internal data structures.  Once the program is parsed, you cannot see what the compiler does to the code (well, maybe the compiler has some kind of debugging dump, but you cannot count on that).</p>\n\n<p>To do what you want, you need to do <a href=\"https://en.wikipedia.org/wiki/Partial_evaluation\" rel=\"nofollow noreferrer\">partial evaluation</a> of the code at the location of the expanded macro.  No standard compiler will help you do this.</p>\n\n<p>You need a <a href=\"https://en.wikipedia.org/wiki/Program_transformation\" rel=\"nofollow noreferrer\">program transformation system (PTS)</a>, which is tool that parses source code, applies code transformations, and then will regenerate the modified source text.     A good PTS will let you write sets of source-to-source transformation rules to be applied, each rule in the form of:</p>\n\n<pre><code> when you see *this*, then replace it by *that* if *condition* is true\n</code></pre>\n\n<p>To do simple constant folding, you need rules like:</p>\n\n<pre><code>  rule  simplify_times_zero(e: power): product -&gt; product\n       \" \\e * 0 \" -&gt;  \" \\e \";\n</code></pre>\n\n<p>which handles the special (algebraic) case of multiplying something times zero.\nYou obviously need a bunch of these rules, more below.</p>\n\n<p>Your PTS must also be able to read the specific dialect of C or C++ you are using, and be able to resolve any identifier to its definition (otherwise the cannot know that E is constant where it used).    </p>\n\n<p>The only PTS I know of that can <a href=\"http://www.semanticdesigns.com/Products/FrontEnds/CppFrontEnd.html\" rel=\"nofollow noreferrer\">parse many C or C++ dialects</a>, and carry out macro expansions, is our <a href=\"http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html\" rel=\"nofollow noreferrer\">DMS Software Reengineering Toolkit</a>.  It accepts rules using the syntax of the above example.</p>\n\n<p>The additional rules you need are rules that actually do arithmetic:</p>\n\n<pre><code>rule fold_addition(c1: INT32CONSTANT, c2: INT32CONSTANT): product -&gt; product =\n     \" \\c1 + \\c2 \" -&gt;  int32_multiply(c1,c2);\n</code></pre>\n\n<p>where int32_multiply is a function that does the math.  You need one of these for each operator and operand type, that honor the rules of the C and C++ language. </p>\n\n<p>You also need rules that do substitution of known values:</p>\n\n<pre><code>rule substitute_defined_constant(i: IDENTIFIER): primitive -&gt; primitive\n  \" \\i \" -&gt;  macro_definition_value(i) if  is_defined_constant(i);\n</code></pre>\n\n<p>where is_defined_constant looks up and identifier in the symbol table built by DMS's front end for macro definitions, and checks that i is macro of the form of \"define i \" at the point where i is referenced.  By writing this as a conditional, the macro_definition_value function isn't called unless the macro definition value actually exists.   The raw symbol table support is provided by DMS's C and C++ front ends.</p>\n\n<p>With this set of rules, and a rule strategy that applies these rules to the macro expansion point of interest, DMS should be able to \"fold\" the equation into the form you expressed.   Now, all the transforms are done on DMS's internal representations of the program, but DMS can prettyprint the result so you could actually see this.</p>\n\n<p>As a general capability in a development UI, this might be pretty useful.  To actually set all this up and make it work in practice is probably a few days; DMS is a complex system, and C and C++ don't help.  </p>\n\n<p>If you are only going to do this once or twice, you are likely better off just biting the bullet and doing it by hand (or as another answer suggests, use a debugging to inspect the output of the compiler if that works out).   If it is a daily task, the PTS solution is likely a real time (and accuracy) saver.</p>\n"}], "owner": {"reputation": 221, "user_id": 854139, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/79dc0d1a37a8c96b50191190e6499fa9?s=128&d=identicon&r=PG", "display_name": "Perlator", "link": "https://stackoverflow.com/users/854139/perlator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 40637059, "answer_count": 2, "score": 2, "last_activity_date": 1479314328, "creation_date": 1479305171, "last_edit_date": 1495539958, "question_id": 40634173, "link": "https://stackoverflow.com/questions/40634173/gcc-preprocessor-plus-static-analysis", "title": "GCC preprocessor PLUS static analysis?", "body": "<p>I am aware of how to <a href=\"https://stackoverflow.com/questions/3916979/how-to-run-the-gcc-preprocessor-to-get-the-code-after-macros-like-define-are-ex\">run the gcc preprocessor</a>. Gcc evidently performs a static analysis/optimization of the code, because if you e.g. add two constants, or shift a constant, the resulting assembly code is the same whether you keep \"a = constant &lt;&lt; 3\" or if you perform that operation manually and have \"a = shifted_constant\" in the code.</p>\n\n<p>Given this slice from a SHA256 code,</p>\n\n<pre><code>  A=0x6a09e667;\n  B=0xbb67ae85;\n  C=0x3c6ef372;\n  D=0xa54ff53a;\n  E=0x510e527f;\n  F=0x9b05688c;\n  G=0x1f83d9ab;\n  H=0x5be0cd19;\n\n  P(A, B, C, D, E, F, G, H, W[ 0], 0x428a2f98);\n</code></pre>\n\n<p>after running gcc -E I get</p>\n\n<pre><code> { tmp = ((((E) &gt;&gt; (6)) | ((E) &lt;&lt; (32-(6)))) ^ (((E) &gt;&gt; (11))\n       | ((E) &lt;&lt; (32-(11)))) ^ (((E) &gt;&gt; (25)) | ((E) &lt;&lt; (32-(25)))))\n       + (G ^ (E &amp; (F ^ G))) + 0x428a2f98 + W[ 0]; D += (tmp + H);\n   H  += tmp + ((((A) &gt;&gt; (2)) | ((A) &lt;&lt; (32-(2)))) ^ (((A) &gt;&gt; (13))\n       | ((A) &lt;&lt; (32-(13)))) ^ (((A) &gt;&gt; (22)) | ((A) &lt;&lt; (32-(22)))))\n       + ((A &amp; B) | (C &amp; (A | B))); };\n</code></pre>\n\n<p>For the P-line, which is a nested macro of macros.</p>\n\n<p>That's nice, but I would like to have a more digested result, where constants have been replaced, constant arithmetics have been performed etc.\nSo if I got instead of the above something like this:</p>\n\n<pre><code>{ tmp = hex_constant1 + W[0]; D += (tmp + 0x5be0cd19); H += tmp + hex_constant2; };\n</code></pre>\n\n<p>It would be much more to my liking. I hadn't the patience to manually compute the expressions, but basically they should fold to two hex constants.</p>\n\n<p>Is there any tool / command line option to perform this?</p>\n"}, {"tags": ["c", "operating-system", "mutex", "semaphore", "producer-consumer"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1479305781, "post_id": 40634116, "comment_id": 68501000, "body": "Please read the manual page. Better that the explanation here and will be complete"}], "answers": [{"tags": [], "owner": {"reputation": 20930, "user_id": 6881240, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dc1e27d7e9a3de2ca8e257cb7c72ff4a?s=128&d=identicon&r=PG&f=1", "display_name": "kabanus", "link": "https://stackoverflow.com/users/6881240/kabanus"}, "is_accepted": false, "score": 1, "last_activity_date": 1479306122, "last_edit_date": 1479306122, "creation_date": 1479305257, "answer_id": 40634208, "question_id": 40634116, "link": "https://stackoverflow.com/questions/40634116/what-are-the-meanings-of-parameters-passed-to-sem-init-in-semaphoresoperating/40634208#40634208", "title": "What are the meanings of parameters passed to sem_init() in Semaphores(Operating Systems)?", "body": "<p>Please have a look at <a href=\"http://man7.org/linux/man-pages/man3/sem_init.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/sem_init.3.html</a>. Regarding the second argument:</p>\n\n<blockquote>\n  <p>The pshared argument indicates whether this semaphore is to be shared \n  between the threads of a process, or between processes.</p>\n</blockquote>\n\n<p>This is essentially Boolean, but read the link for more info. If you're really threading than this should always be 0, in extreme cases you use threading code on different processes use non-zero.</p>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 6243989, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/okExe.jpg?s=128&g=1", "display_name": "NaveeNeo", "link": "https://stackoverflow.com/users/6243989/naveeneo"}, "edited": false, "score": 0, "creation_date": 1479305911, "post_id": 40634326, "comment_id": 68501089, "body": "I never thought it can be a command-line statement. I was trying to solve it according t c-language&#39;s point of view."}, {"owner": {"reputation": 409, "user_id": 3415821, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/698e7f6547b4565c18f25d9120ef4e48?s=128&d=identicon&r=PG&f=1", "display_name": "Hrishikesh Goyal", "link": "https://stackoverflow.com/users/3415821/hrishikesh-goyal"}, "reply_to_user": {"reputation": 195, "user_id": 6243989, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/okExe.jpg?s=128&g=1", "display_name": "NaveeNeo", "link": "https://stackoverflow.com/users/6243989/naveeneo"}, "edited": false, "score": 0, "creation_date": 1479306212, "post_id": 40634326, "comment_id": 68501343, "body": "its probably a system call. OS provides system call utility in C language because Linux kernel itself has written in C language."}], "tags": [], "owner": {"reputation": 409, "user_id": 3415821, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/698e7f6547b4565c18f25d9120ef4e48?s=128&d=identicon&r=PG&f=1", "display_name": "Hrishikesh Goyal", "link": "https://stackoverflow.com/users/3415821/hrishikesh-goyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1479305565, "creation_date": 1479305565, "answer_id": 40634326, "question_id": 40634116, "link": "https://stackoverflow.com/questions/40634116/what-are-the-meanings-of-parameters-passed-to-sem-init-in-semaphoresoperating/40634326#40634326", "title": "What are the meanings of parameters passed to sem_init() in Semaphores(Operating Systems)?", "body": "<p>Always try to read Linux documentation(<code>man &lt;command or system_call&gt;</code>) for these type of doubts.</p>\n\n<p>for your case <code>man sem_init</code><br>\n sem_init() initializes the unnamed semaphore at the address pointed\n       to by sem.  The value argument specifies the initial value for the\n       semaphore. </p>\n\n<p>web <a href=\"https://linux.die.net/man/\" rel=\"nofollow noreferrer\">link</a> of the man pages</p>\n"}], "owner": {"reputation": 195, "user_id": 6243989, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/okExe.jpg?s=128&g=1", "display_name": "NaveeNeo", "link": "https://stackoverflow.com/users/6243989/naveeneo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4332, "favorite_count": 0, "accepted_answer_id": 40634326, "answer_count": 2, "score": 3, "last_activity_date": 1479306122, "creation_date": 1479304982, "question_id": 40634116, "link": "https://stackoverflow.com/questions/40634116/what-are-the-meanings-of-parameters-passed-to-sem-init-in-semaphoresoperating", "title": "What are the meanings of parameters passed to sem_init() in Semaphores(Operating Systems)?", "body": "<p>Consider the code snippet given below :</p>\n\n<pre><code>    #include &lt;pthread.h&gt;\n    #include &lt;semaphore.h&gt;\n\n    sem_t empty;\n    sem_t full;\n    sem_t mutex;\n\n    int main(int argc, char *argv[]) \n    {\n    int MAX = 10;//Size of the Buffer\n    sem_init(&amp;empty, 0, MAX);\n    sem_init(&amp;full, 0, 0);\n    sem_init(&amp;mutex, 0, 1);\n\n    return 0;\n    }\n</code></pre>\n\n<p>Only the required code,I have mentioned above. It's a part of Producer-Consumer Code. What are the meanings of each parameters in sem_init()? I could make out that 1st parameter is the address of the semaphore variable and 3rd one is it's value.</p>\n\n<p><strong>Why the 2nd parameter is always 0? What does that mean?</strong></p>\n\n<p>Are we specifying critical value for the semaphore to wait using 2nd parameter?</p>\n\n<pre><code>    wait(S) {\n    while (S &lt;= 0 )\n    ; // busy wait\n    S--;\n    }\n</code></pre>\n\n<p>If I pass 3 as 2nd parameter to sem_init(), does the while loop in wait(S) will be changed to</p>\n\n<pre><code>while (S &lt;= 3 )\n</code></pre>\n\n<p>like this?</p>\n"}, {"tags": ["c", "avr", "cpu-registers", "atmega", "atmel"], "comments": [{"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1479304425, "post_id": 40633833, "comment_id": 68500100, "body": "Why do you not use the standard files provided with gcc for avr? In addition: If you write some initialization for pins with something like your  pin_write method, you waste a lot of code only for the start phase of your prog. All this can be done by template code in compile time instead of acting with each pin alone. Set the ddr and port register once not 8 times for the same job."}, {"owner": {"reputation": 1048, "user_id": 2251982, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6da93065fa9fdeb11fc261e68a5763d9?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/2251982/sean"}, "reply_to_user": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "edited": false, "score": 0, "creation_date": 1479308097, "post_id": 40633833, "comment_id": 68502659, "body": "@Klaus, what standard files do you refer to? I wasn&#39;t aware of existing code to do what I want to do.  Also, I&#39;m not concerned with startup optimisation at this stage - but thanks for the advice."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479319153, "post_id": 40633833, "comment_id": 68510361, "body": "That looks like quite a waste of precious RAM and ROM space to me. Your question is not on-topic here. We are noi discussion site and it is too opiniated. Edit: sorry I had the last sentenc in mind. Please provide more details what is wrong. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1048, "user_id": 2251982, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6da93065fa9fdeb11fc261e68a5763d9?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/2251982/sean"}, "edited": false, "score": 0, "creation_date": 1479315775, "post_id": 40636073, "comment_id": 68508206, "body": "Thanks, that did it!"}], "tags": [], "owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "is_accepted": true, "score": 1, "last_activity_date": 1479310467, "creation_date": 1479310467, "answer_id": 40636073, "question_id": 40633833, "link": "https://stackoverflow.com/questions/40633833/implementing-pin-numbers-in-avr-microcontroller-similar-to-arduino/40636073#40636073", "title": "Implementing pin numbers in AVR microcontroller similar to Arduino", "body": "<p>The reason to why your code does not work is this step:</p>\n\n<pre><code>uint8_t port_out_register = *(pin_port_out_regs[pin]);\n</code></pre>\n\n<p>You want to write to a hardware register located at a specific address. To do this you need to:</p>\n\n<pre><code>*(pin_port_out_regs[pin]) = some_value;\n</code></pre>\n\n<p>Otherwise you will just modify stack memory to no gain.</p>\n\n<p>Try to change to this instead:</p>\n\n<pre><code>void pin_write(uint8_t pin, uint8_t level)\n{\n    uint8_t *port_out_register = pin_port_out_regs[pin];\n    uint8_t mask = pin_bits[pin];\n\n    if (level == LOW) {\n        *port_out_register &amp;= ~mask;\n    } else {\n        *port_out_register |= mask;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "is_accepted": false, "score": 2, "last_activity_date": 1479324822, "last_edit_date": 1479324822, "creation_date": 1479324422, "answer_id": 40640656, "question_id": 40633833, "link": "https://stackoverflow.com/questions/40633833/implementing-pin-numbers-in-avr-microcontroller-similar-to-arduino/40640656#40640656", "title": "Implementing pin numbers in AVR microcontroller similar to Arduino", "body": "<p>As answer to the comment I gave:</p>\n\n<blockquote>\n  <p>what standard files do you refer to?</p>\n</blockquote>\n\n<p>From avr-gcc with installed avrlibc is a standard set of files for each controller available.</p>\n\n<p>If your code is something like:</p>\n\n<pre><code>#include &lt;avr/io.h&gt;  // automatic include correct io from device like\n                     // &lt;avr/iom32u4.h&gt; in your case. That file defines\n                     // all registers and pin descriptions and also irq\n                     // vectors!\n\n// So you can write:\nint main()\n{\n     DDRA= 1 &lt;&lt; PA4;  // enable output Pin 4 on Port A\n     PORTA= 1 &lt;&lt; PA4; // set output Pin4 on Port A high\n\n     // and normally on startup all needed output pins will be \n     // set with only one instruction like:\n     // To set Pin 2..4 as output\n     DDRA= ( 1 &lt;&lt; PA4) | ( 1 &lt;&lt; PA3 ) | ( 1 &lt;&lt; PA2 );\n}\n</code></pre>\n\n<p>Make a simple <code>PORTA= 1 &lt;&lt; PA4</code> to a function call is a lot of waste. And defining your own register names and pin names is useless. All the pins are already defined as you can see.</p>\n\n<p>Your idea to have only a logical port number which is located \"somewhere\" on a magic defined port looks not very natural to me. If you design a circuit and the software, you have to deal with the pins as described in the datasheet. There is no \"logical pin number\". This idea helps for nothing but for bigger code size :-)</p>\n\n<p>In addition you have to remember which pins have also multiple functions like for uarts and all the other hardware stuff. So moving to another device will always need a review on pin / port usage. Here a logical port number is also a complicating layer between the hardware and the natural way of software.</p>\n"}], "owner": {"reputation": 1048, "user_id": 2251982, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6da93065fa9fdeb11fc261e68a5763d9?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/2251982/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 40636073, "answer_count": 2, "score": 0, "last_activity_date": 1479324822, "creation_date": 1479304164, "question_id": 40633833, "link": "https://stackoverflow.com/questions/40633833/implementing-pin-numbers-in-avr-microcontroller-similar-to-arduino", "title": "Implementing pin numbers in AVR microcontroller similar to Arduino", "body": "<p>I'd like to implement something similar to Arduino's pin numbers for an Atmel ATMega32U4. I've looked at Arduino's <code>digitalWrite</code> command and associated source files to see how they do it, but I think this is slightly convoluted so I wanted to implement a more basic version.</p>\n\n<p>The idea is to have integers 1 to n that represent each of the I/O pins on the AVR chip. I started with an array of pointers to the addresses of the DDR/PORT registers, where the index would represent the pin:</p>\n\n<pre><code>volatile uint8_t *pin_port_dir_regs[] = {\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    &amp;DDRE,            // PIN_7\n    &amp;DDRB,            // PIN_8\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    0,                // NOT USED\n    &amp;DDRB,            // PIN_15\n    &amp;DDRB             // PIN_16\n};\n\nvolatile uint8_t *pin_port_out_regs[] = {\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    &amp;PORTE,            // PIN_7\n    &amp;PORTB,            // PIN_8\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    0,                 // NOT USED\n    &amp;PORTB,            // PIN_15\n    &amp;PORTB             // PIN_16\n};\n</code></pre>\n\n<p>I also need to know the bit numbers in each of the DDRx/PORTx registers, so I created another array:</p>\n\n<pre><code>const uint8_t pin_bits[] = {\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(6),  // PIN_7\n    _BV(4),  // PIN_8\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // NOT USED\n    _BV(0),  // PIN_14\n    _BV(1),  // PIN_15\n    _BV(3)   // PIN_16\n};\n</code></pre>\n\n<p>To set the pin mode and write to the pins, I created the following functions:</p>\n\n<pre><code>void pin_mode(uint8_t pin, uint8_t direction) {\n    // defeference the pointer to the direction register\n    uint8_t port_dir_register = *(pin_port_dir_regs[pin]);\n\n    // get pin mask\n    uint8_t mask = pin_bits[pin];\n\n    // set its mode\n    if (direction == INPUT) {\n        port_dir_register &amp;= ~mask;\n    } else {\n        port_dir_register |= mask;\n    }\n}\n\nvoid pin_write(uint8_t pin, uint8_t level) {\n    // defeference the pointer to the output register\n    uint8_t port_out_register = *(pin_port_out_regs[pin]);\n\n    // get pin mask\n    uint8_t mask = pin_bits[pin];\n\n    // set output\n    if (level == LOW) {\n        port_out_register &amp;= ~mask;\n    } else {\n        port_out_register |= mask;\n    }\n}\n</code></pre>\n\n<p>What's supposed to happen is that you would call e.g. <code>pin_mode(7, OUTPUT)</code> to set pin 7 as an output, and then <code>pin_write(7, HIGH)</code> to set the output to 1 (where OUTPUT and HIGH are predefined macros). The code compiles and uploads to the AVR successfully, but when I test the output it doesn't respond. I guess I must be writing to <em>some</em> memory location, but not the one corresponding to the intended registers. Does anyone see a problem with the way I am trying to do this?</p>\n"}, {"tags": ["c", "list", "opengl", "sprite", "contiguous"], "answers": [{"tags": [], "owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": true, "score": 2, "last_activity_date": 1479307053, "creation_date": 1479307053, "answer_id": 40634854, "question_id": 40633785, "link": "https://stackoverflow.com/questions/40633785/opengl-allocating-data-to-a-list-in-c-and-using-it-in-glbufferdata-doesnt-wor/40634854#40634854", "title": "OpenGL - Allocating data to a list in C and using it in glBufferData doesn&#39;t work correctly", "body": "<p>What you create in your list struct is a continuous memory of <strong>pointers</strong> to the data, not a continuous memory containing the data. OpenGL expects you to pass an array containing the data (e.g., the <code>vertices</code> array in your first code sample).</p>\n"}], "owner": {"reputation": 258, "user_id": 2981488, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0d3792d4ae54085257f43aeea252c1be?s=128&d=identicon&r=PG&f=1", "display_name": "lefti", "link": "https://stackoverflow.com/users/2981488/lefti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 40634854, "answer_count": 1, "score": 0, "last_activity_date": 1479307053, "creation_date": 1479304022, "question_id": 40633785, "link": "https://stackoverflow.com/questions/40633785/opengl-allocating-data-to-a-list-in-c-and-using-it-in-glbufferdata-doesnt-wor", "title": "OpenGL - Allocating data to a list in C and using it in glBufferData doesn&#39;t work correctly", "body": "<p>I have a problem when pushing back data to a list and then using this list in OpenGL glBufferData.</p>\n\n<p>I have a simple OpenGL scene, where I draw 3 sprites using 3 different spritebatches. It works when I allocate memory for the vertices beforehand and then use this vertex array for the sprite vertices, then pushing back to the list. But what I want is to push back the sprite vertices directly into the list, which doesn't work and I only get 3 triangles (half sprites).</p>\n\n<p>sb->vertices is a list.</p>\n\n<p>This works and draws 3 sprites:</p>\n\n<pre><code>void add_verts(sprite_batch* sb, sprite* s[])\n{\n    int cv = 0; // Current vertex\n\n    vertex* vertices; // Allocate memory for vertices\n    vertices = malloc(sb-&gt;sprite_count * sizeof(vertex) * 6); // Each sprite has 6 vertices\n\n    for(unsigned int i = 0; i &lt; sb-&gt;sprite_count; i++)\n    {\n        // Top right\n        vertices[cv++] = s[i]-&gt;tr;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);      \n\n        // Top left\n        vertices[cv++] = s[i]-&gt;tl;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);\n\n        // Bottom left\n        vertices[cv++] = s[i]-&gt;bl;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);      \n\n        // Bottom left\n        vertices[cv++] = s[i]-&gt;bl;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);\n\n        // Bottom right\n        vertices[cv++] = s[i]-&gt;br;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);\n\n        // Top right\n        vertices[cv++] = s[i]-&gt;tr;\n        list_push_back(sb-&gt;vertices, &amp;vertices[cv-1]);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SPyH9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SPyH9.jpg\" alt=\"Working version\"></a></p>\n\n<p>This doesn't work and draws only 3 half-sprites:</p>\n\n<pre><code>void add_verts(sprite_batch* sb, sprite* s[])\n{\n    for(unsigned int i = 0; i &lt; sb-&gt;sprite_count; i++)\n    {    \n        // Top right\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;tr);\n\n        // Top left\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;tl);\n\n        // Bottom left\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;bl);\n\n        // Bottom left\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;bl);\n\n        // Bottom right\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;br);\n\n        // Top right\n        list_push_back(sb-&gt;vertices, &amp;s[i]-&gt;tr);\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OjRSi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OjRSi.jpg\" alt=\"Not working\"></a></p>\n\n<p>I thought pushing back to the list like this would give contiguous block of memory which I could use in glBufferData.</p>\n\n<p>Here is how I call glBufferData():</p>\n\n<pre><code>glBufferData(GL_ARRAY_BUFFER, sb-&gt;vertices-&gt;num_items * sizeof(vertex), list_get(sb-&gt;vertices, 0), GL_STATIC_DRAW);\n</code></pre>\n\n<p>This is the code for the list:</p>\n\n<pre><code>typedef struct \n{\n    int num_items;\n    int num_slots;\n    void** items;\n} list;\n\nstatic void list_reserve_more(list* l) \n{\n    if (l-&gt;num_items &gt; l-&gt;num_slots) \n    {\n        l-&gt;num_slots = ceil((l-&gt;num_slots + 1) * 1.5);\n        l-&gt;items = realloc(l-&gt;items, sizeof(void*) * l-&gt;num_slots);\n    }\n}\n\nvoid list_push_back(list* l, void* item)\n{\n    l-&gt;num_items++;\n    list_reserve_more(l);\n    l-&gt;items[l-&gt;num_items-1] = item;\n}\n\nvoid* list_get(list* l, int index) \n{\n\n    if (index &lt; 0) { printf(\"Index out of bounds\"); return NULL; }\n    if (index &gt;= l-&gt;num_items) { printf(\"Index out of bounds\"); return NULL; }\n\n    return l-&gt;items[index]; \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "valgrind"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1479303260, "post_id": 40633352, "comment_id": 68499291, "body": "<code>retVal-&gt;numbers = malloc (n * m * sizeof (int*));</code> --&gt; <code>retVal-&gt;numbers = malloc (n * m * sizeof (int));</code>, <code>retVal-&gt;pointToNext = malloc(sizeof(struct MatrixObject*));</code> --&gt; <code>retVal-&gt;pointToNext = NULL;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1479363520, "post_id": 40633352, "comment_id": 68527302, "body": "the number of heap memory allocations must match the number of calls to <code>free()</code>  Currently there are 6 more allocations than there are <code>free()</code>s  Fix that problem and the memory leaks will go away"}, {"owner": {"reputation": 47, "user_id": 7123932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845c89550814df626ae4156e4a92bebe?s=128&d=identicon&r=PG&f=1", "display_name": "shade254", "link": "https://stackoverflow.com/users/7123932/shade254"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479414575, "post_id": 40633352, "comment_id": 68559951, "body": "@BLUEPIXY Thanks a lot man, that was leak I was looking for, you saved me a few another hours of solving this. I owe you one :)"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7123932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845c89550814df626ae4156e4a92bebe?s=128&d=identicon&r=PG&f=1", "display_name": "shade254", "link": "https://stackoverflow.com/users/7123932/shade254"}, "edited": false, "score": 0, "creation_date": 1479414335, "post_id": 40634227, "comment_id": 68559825, "body": "Thanks a lot for contributing, actually my problem here was solved by simply setting value of retVal-&gt;pointToNext to NULL (as mentioned above). But now I can see all these other potential errors and bad practices in my code. I am glad you pointed that out, I will try to make it right in my next piece of code."}], "tags": [], "owner": {"reputation": 54, "user_id": 7163930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RhLx1l46_nY/AAAAAAAAAAI/AAAAAAAAAA0/Xd7Dp12FUV8/photo.jpg?sz=128", "display_name": "BahJiy", "link": "https://stackoverflow.com/users/7163930/bahjiy"}, "is_accepted": false, "score": 0, "last_activity_date": 1479305325, "creation_date": 1479305325, "answer_id": 40634227, "question_id": 40633352, "link": "https://stackoverflow.com/questions/40633352/valgrind-blocks-lost-where-to-free/40634227#40634227", "title": "Valgrind blocks lost, where to free?", "body": "<p>The first that I see is</p>\n\n<pre><code>struct MtrixObject *newMatrixObject (size_t n, size_t m) {\n\n//...\n\nretVal-&gt;pointToNext = malloc(sizeof(struct MatrixObject*));\nif (retVal-&gt;pointToNext == NULL) {\n    free (retVal);\n    return NULL;\n}\n</code></pre>\n\n<p>The retVal's Number was never free in the error checking block. Remember that freeing a struct doesn't free any variables inside that was initialized by malloc</p>\n\n<p>In your main, matrix or actualMatrix wasn't free.\nIt looks like you are creating a default matrix, actualMatrix, and editing it then setting a pointer, pointToNext, to point the the edited matrix. Afterward, you are setting the actualMatrix back to default matrix. (Is this a LinkedList I'm seeing here?)</p>\n\n<p>This mean you have a chain of matricies that are not free at the end. You should probably try</p>\n\n<pre><code>struct MatrixObject *temp;\nwhile (matrix != NULL) {\n    temp = matrix.pointToNext;\n    free(matrix);\n    matrix = temp;\n}\n</code></pre>\n\n<p>This will go through all the matrix after that first matrix and free them.</p>\n\n<p>Note that I have no idea what printMatrix does as it was never in your code. It could be that you free the matrices in there.</p>\n\n<p>And one last comment, because you are calling errorHandle() in methods, there is a high chance if there are some errors, you are not freeing some mallocs</p>\n\n<pre><code>void multiplyMatrix(struct MatrixObject *matrix1, struct MatrixObject *matrix2){\n    int newColumns = matrix2-&gt;columns;\n    int newRows = matrix1-&gt;rows;\n    int* newNumbers = malloc(newColumns * newRows * sizeof(*newNumbers));\n    int counter = 0;\n    if(matrix1-&gt;columns != matrix2-&gt;rows){\n        errorHandle();\n    }\n//...\n</code></pre>\n\n<p>Here, errorHandle was called, but there is almost no way for you too free newNumbers as it was never passed in as a reference. This means that it will just float around and never get clean.</p>\n\n<p>I recommend allocating for newNumbers after the errorHandle</p>\n"}], "owner": {"reputation": 47, "user_id": 7123932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845c89550814df626ae4156e4a92bebe?s=128&d=identicon&r=PG&f=1", "display_name": "shade254", "link": "https://stackoverflow.com/users/7123932/shade254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1378, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479305325, "creation_date": 1479302770, "question_id": 40633352, "link": "https://stackoverflow.com/questions/40633352/valgrind-blocks-lost-where-to-free", "title": "Valgrind blocks lost, where to free?", "body": "<p>I am trying to do a program which will be able to multiply and add matrix expressions with operator preference and so on.\nI completed the program and it works, however I got a few errors in valgrind after completion. It is clear that this is because of bad usage of free() near the pointer to next matrix. But I am not able to work out how to do it correctly. Could somebody please help me, I will be very grateful for that. </p>\n\n<p><strong>Here is my code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"files.h\"\nstruct MatrixObject *matrix;\n\n\nstruct MatrixObject{\n    size_t rows; \n    size_t columns;\n    int *numbers;\n    struct MatrixObject *pointToNext;\n    char sign;\n};\n\nstruct MatrixObject *newMatrixObject (size_t n, size_t m) {\n\n    struct MatrixObject *retVal = malloc (sizeof (struct MatrixObject));\n    if (retVal == NULL)\n        return NULL;\n\n    retVal-&gt;numbers = malloc (n * m * sizeof (int*));\n    if (retVal-&gt;numbers == NULL) {\n        free (retVal);\n        return NULL;\n    }\n\n    retVal-&gt;pointToNext = malloc(sizeof(struct MatrixObject*));\n    if (retVal-&gt;pointToNext == NULL) {\n        free (retVal);\n        return NULL;\n    }\n\n\n    retVal-&gt;rows = n;\n    retVal-&gt;columns = m;\n    return retVal;\n}\n\nstruct MatrixObject* getMatrixArray(){\n    struct MatrixObject *object;\n    int m, n;   \n    if(scanf(\"%d %d\", &amp;n, &amp;m) != 2){\n        errorHandle();\n    }\n    if(n&lt;0 || m&lt;0){\n        errorHandle();\n    }\n\n    object = newMatrixObject(n, m);\n    for(int i = 0;i&lt;n;i++){\n        for(int j = 0;j&lt;m;j++){\n            if(fscanf(stdin, \"%d\", &amp;(object-&gt;numbers[(i*m)+j]))!=1){\n                errorHandle();\n            }\n        }\n    }\n\n    char temp;\n    int res;\n    while((res=fscanf(stdin, \"%c\", &amp;temp))!=EOF){\n        if(res!=1){\n            errorHandle();\n        }\n        if(temp == '*' || temp == '+' || temp == '-'){\n            object-&gt;sign = temp;\n            object-&gt;pointToNext = getMatrixArray();\n            return object;\n        }\n\n    }\n\n    object-&gt;sign = 0;\n    object-&gt;pointToNext = 0;\n    return object;\n}\n\nvoid multiplyMatrix(struct MatrixObject *matrix1, struct MatrixObject *matrix2){\n    int newColumns = matrix2-&gt;columns;\n    int newRows = matrix1-&gt;rows;\n    int* newNumbers = malloc(newColumns * newRows * sizeof(*newNumbers));\n    int counter = 0;\n    if(matrix1-&gt;columns != matrix2-&gt;rows){\n        errorHandle();\n    }\n\n\n    for(int i = 0;i&lt;newRows;i++){\n        for(int k = 0;k&lt;newColumns;k++){\n\n\n            int sum = 0;\n\n            for(int j = 0;j&lt;matrix1-&gt;columns;j++){\n                sum+= ((matrix1-&gt;numbers)[(i*matrix1-&gt;columns)+j]) * ((matrix2-&gt;numbers)[(j*matrix2-&gt;columns)+k]);\n            }       \n            newNumbers[counter] = sum;\n            counter++;\n        }\n    }   \n    struct MatrixObject mat = *matrix2;\n    free(matrix2-&gt;numbers);\n    free(matrix2);\n    matrix1-&gt;pointToNext = mat.pointToNext;\n    matrix1-&gt;sign = mat.sign;\n\n\n    free(matrix1-&gt;numbers);\n    matrix1-&gt;numbers = newNumbers;\n    matrix1-&gt;columns = newColumns;\n    matrix1-&gt;rows = newRows;\n\n}\n\nvoid addMatrix(struct MatrixObject *matrix1, struct MatrixObject *matrix2, char sign){\n    if(matrix1-&gt;columns != matrix2-&gt;columns || matrix1-&gt;rows != matrix2-&gt;rows){\n        errorHandle();\n    }\n    int columns = matrix1-&gt;columns;\n    int rows = matrix2-&gt;rows;\n    int* newNumbers = malloc(rows*columns*sizeof(*newNumbers));\n\n    for(int i = 0;i&lt;rows;i++){\n        for(int j = 0;j&lt;columns;j++){\n            if(sign == '+'){\n                newNumbers[i*columns + j] = matrix1-&gt;numbers[i*columns + j] + matrix2-&gt;numbers[i*columns + j];\n            }else{\n                newNumbers[i*columns + j] = matrix1-&gt;numbers[i*columns + j] - matrix2-&gt;numbers[i*columns + j];\n            }\n        }\n    }\n\n\n    struct MatrixObject mat = *matrix2;\n    free(matrix2-&gt;numbers);\n    free(matrix2);\n    matrix1-&gt;pointToNext = mat.pointToNext;\n    matrix1-&gt;sign = mat.sign;\n\n    free(matrix1-&gt;numbers);\n    matrix1-&gt;numbers = newNumbers;\n}\n\n\nint main(int argc, char *argv[])\n{\n\n    struct MatrixObject *actualMatrix;\n    matrix = getMatrixArray();\n    actualMatrix = matrix;\n    while(actualMatrix-&gt;pointToNext != 0){\n        if(actualMatrix-&gt;sign == '*'){\n            multiplyMatrix(actualMatrix, actualMatrix-&gt;pointToNext);\n\n        }   \n        else{\n            actualMatrix = actualMatrix-&gt;pointToNext;\n        }\n    }\n\n    printMatrix(matrix);\n\n    actualMatrix = matrix;\n    while(actualMatrix-&gt;pointToNext != 0){\n        if(actualMatrix-&gt;sign == '+' || actualMatrix-&gt;sign == '-'){\n            addMatrix(actualMatrix, actualMatrix-&gt;pointToNext, actualMatrix-&gt;sign);\n        }\n    }\n\n    printMatrix(matrix);    \n    return 0;\n}\n</code></pre>\n\n<p><strong>Here is output from my valgrind:</strong></p>\n\n<pre><code>==30650== \n==30650== HEAP SUMMARY:\n==30650==     in use at exit: 88 bytes in 6 blocks\n==30650==   total heap usage: 17 allocs, 11 frees, 2,416 bytes allocated\n==30650== \n==30650== Searching for pointers to 6 not-freed blocks\n==30650== Checked 65,936 bytes\n==30650== \n==30650== 8 bytes in 1 blocks are definitely lost in loss record 1 of 6\n==30650==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30650==    by 0x400C59: newMatrixObject (main.c:32)\n==30650==    by 0x400D0F: getMatrixArray (main.c:54)\n==30650==    by 0x40133F: main (main.c:177)\n==30650== \n==30650== 8 bytes in 1 blocks are definitely lost in loss record 2 of 6\n==30650==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30650==    by 0x400C59: newMatrixObject (main.c:32)\n==30650==    by 0x400D0F: getMatrixArray (main.c:54)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x40133F: main (main.c:177)\n==30650== \n==30650== 8 bytes in 1 blocks are definitely lost in loss record 3 of 6\n==30650==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30650==    by 0x400C59: newMatrixObject (main.c:32)\n==30650==    by 0x400D0F: getMatrixArray (main.c:54)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x40133F: main (main.c:177)\n==30650== \n==30650== 8 bytes in 1 blocks are definitely lost in loss record 4 of 6\n==30650==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==30650==    by 0x400C59: newMatrixObject (main.c:32)\n==30650==    by 0x400D0F: getMatrixArray (main.c:54)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x400DC3: getMatrixArray (main.c:71)\n==30650==    by 0x40133F: main (main.c:177)\n==30650== \n==30650== LEAK SUMMARY:\n==30650==    definitely lost: 32 bytes in 4 blocks\n==30650==    indirectly lost: 0 bytes in 0 blocks\n==30650==      possibly lost: 0 bytes in 0 blocks\n==30650==    still reachable: 56 bytes in 2 blocks\n==30650==         suppressed: 0 bytes in 0 blocks\n==30650== Reachable blocks (those to which a pointer was found) are not shown.\n==30650== To see them, rerun with: --leak-check=full --show-leak-kinds=all\n==30650== \n==30650== ERROR SUMMARY: 4 errors from 4 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p><strong>Here is some info for number lines:</strong></p>\n\n<pre><code>32: retVal-&gt;pointToNext = malloc(sizeof(struct MatrixObject*));\n54: object = newMatrixObject(n, m);\n71: object-&gt;pointToNext = getMatrixArray();\n177:matrix = getMatrixArray();\n</code></pre>\n"}, {"tags": ["objective-c", "c", "integer", "literals"], "comments": [{"owner": {"reputation": 12687, "user_id": 2809095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705cfb2d48f12159ebae7d0275355a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Iwillnotexist Idonotexist", "link": "https://stackoverflow.com/users/2809095/iwillnotexist-idonotexist"}, "edited": false, "score": 46, "creation_date": 1479302465, "post_id": 40633059, "comment_id": 68498749, "body": "Clarity and readability of the code. You can&#39;t put , or &#39; as separators in C, so the next best thing is computing the value from a multiplication. ^ is an unrelated operator in C - exclusive OR."}, {"owner": {"reputation": 1003, "user_id": 2970167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/430125970e20d55eda3a6a6b015cd4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Idali", "link": "https://stackoverflow.com/users/2970167/idali"}, "edited": false, "score": 54, "creation_date": 1479307305, "post_id": 40633059, "comment_id": 68502137, "body": "it especially used for durations like : 2*60*60 .. its easy to notice that is for 2hours.."}, {"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 53, "creation_date": 1479309482, "post_id": 40633059, "comment_id": 68503706, "body": "For one I suspect  1,000,000,000 is not valid syntax"}, {"owner": {"reputation": 3181, "user_id": 1986513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6fe697c4e898b884198a25103bb4f9e?s=128&d=identicon&r=PG", "display_name": "Taemyr", "link": "https://stackoverflow.com/users/1986513/taemyr"}, "reply_to_user": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 2, "creation_date": 1479310688, "post_id": 40633059, "comment_id": 68504585, "body": "@Paparazzi Even if it was valid syntax, the syntax would have to be localized.  In large parts of the world &#39;,&#39; is the decimal mark."}, {"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "edited": false, "score": 15, "creation_date": 1479312312, "post_id": 40633059, "comment_id": 68505731, "body": "By the way, modern programming languages have alternative way to write the same, e.g. in Swift <code>1_000_000_000</code>. However, with time constants this is more difficult. It&#39;s more readable to write <code>30 * 60</code> (30 minutes in seconds) than to write <code>1800</code>. There are actually languages that will allow you to write units, e.g. <code>meters</code>, allowing you to protect yourself against bad assignments."}, {"owner": {"reputation": 3853, "user_id": 1833960, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/92d42253747f8ee3a83465dc04126f93?s=128&d=identicon&r=PG", "display_name": "George Sovetov", "link": "https://stackoverflow.com/users/1833960/george-sovetov"}, "edited": false, "score": 0, "creation_date": 1479320428, "post_id": 40633059, "comment_id": 68511096, "body": "One more slight advantage of 1000*1000*1000 over 1000^3 (if power operator exists in language) is that it&#39;s easier to see order of magnitude quickly."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 2, "creation_date": 1479320442, "post_id": 40633059, "comment_id": 68511105, "body": "For the same reason <code>1.0f &#47; 255</code> is more readable than <code>0.0039215689f</code>. See this <a href=\"http://stackoverflow.com/questions/22621241/what-does-the-constant-0-0039215689-represent\">post</a>."}, {"owner": {"reputation": 3853, "user_id": 1833960, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/92d42253747f8ee3a83465dc04126f93?s=128&d=identicon&r=PG", "display_name": "George Sovetov", "link": "https://stackoverflow.com/users/1833960/george-sovetov"}, "edited": false, "score": 0, "creation_date": 1479320757, "post_id": 40633059, "comment_id": 68511291, "body": "Also, as a side note, if there of a lot of work with physical units, look for libraries which provide classes for units to write, for example, <code>1000 * Kilometers</code> or <code>15_min</code>."}, {"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 29, "creation_date": 1479321318, "post_id": 40633059, "comment_id": 68511554, "body": "<code>^</code> is an XOR, not an exponent or power operator."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "reply_to_user": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 0, "creation_date": 1479321552, "post_id": 40633059, "comment_id": 68511664, "body": "@DavidLively See <a href=\"http://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000#comment68498749_40633059\">this comment</a>."}, {"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "reply_to_user": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 11, "creation_date": 1479331370, "post_id": 40633059, "comment_id": 68517171, "body": "@Paparazzi: In C++, <code>1,000,000,000</code> is valid syntax, and evalues to <code>0</code>."}, {"owner": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "edited": false, "score": 5, "creation_date": 1479333358, "post_id": 40633059, "comment_id": 68518175, "body": "as for me it&#39;s more comfortable to see 1e9 than 1000*1000*1000 :)"}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 0, "creation_date": 1479334204, "post_id": 40633059, "comment_id": 68518577, "body": "Are you asking about C or Objective C?"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "edited": false, "score": 1, "creation_date": 1479336486, "post_id": 40633059, "comment_id": 68519548, "body": "@kot331107: well but that would be a <code>double</code> literal, not an <code>int</code>."}, {"owner": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1479338925, "post_id": 40633059, "comment_id": 68520399, "body": "@MatteoItalia uhm...so you can cast it to int in place if you need :)"}, {"owner": {"reputation": 1557, "user_id": 1156377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0tsJk.jpg?s=128&g=1", "display_name": "Mark K Cowan", "link": "https://stackoverflow.com/users/1156377/mark-k-cowan"}, "edited": false, "score": 4, "creation_date": 1479340112, "post_id": 40633059, "comment_id": 68520725, "body": "<code>(1,000,000,000) == 0</code>"}, {"owner": {"reputation": 4503, "user_id": 1345959, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/993c78d24d979bd4e9aaea30c065e932?s=128&d=identicon&r=PG", "display_name": "Ela782", "link": "https://stackoverflow.com/users/1345959/ela782"}, "reply_to_user": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 3, "creation_date": 1479340927, "post_id": 40633059, "comment_id": 68520975, "body": "@Paparazzi, @MooingDuck: C++ now supports <code>1&#39;000&#39;000</code>!"}, {"owner": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "reply_to_user": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "edited": false, "score": 0, "creation_date": 1479353506, "post_id": 40633059, "comment_id": 68524195, "body": "@kot331107 - You ever heard of rounding error?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "edited": false, "score": 1, "creation_date": 1479356676, "post_id": 40633059, "comment_id": 68524958, "body": "@Hot Licks C specifies the minimum precision and range of <code>double</code>.  The <code>double</code> of @kot331107, <code>1e9</code>, is in range and exactly representable as a <code>double</code>, so no rounding error occurs when converting to a 32(plus)-bit integer.  Larger values may have rounding issues."}, {"owner": {"reputation": 13754, "user_id": 2113226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gPovY.png?s=128&g=1", "display_name": "Digital Trauma", "link": "https://stackoverflow.com/users/2113226/digital-trauma"}, "edited": false, "score": 1, "creation_date": 1479359821, "post_id": 40633059, "comment_id": 68525878, "body": "FWIW, The gcc preprocessor will accept <code>#define BILLION 1000 ## 000 ## 000</code>, though the compiler won&#39;t accept <code>1000 ## 000 ## 000</code> as a literal.  Not sure if this applies to objective-c or not."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1479366398, "post_id": 40633059, "comment_id": 68528615, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14220217/representing-big-numbers-in-source-code-for-readability\">Representing big numbers in source code for readability?</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1479366500, "post_id": 40633059, "comment_id": 68528664, "body": "related: <a href=\"http://stackoverflow.com/a/7696341/995714\">Why does the C parser not allow spaces between the digits of an integer literal?</a>, <a href=\"http://stackoverflow.com/a/27768020/995714\">Why was the space character not chosen for C++14 digit separators?</a>"}, {"owner": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "reply_to_user": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "edited": false, "score": 0, "creation_date": 1479378518, "post_id": 40633059, "comment_id": 68536177, "body": "@HotLicks rounding error with (int)1e9 ?"}, {"owner": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "reply_to_user": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "edited": false, "score": 0, "creation_date": 1479387221, "post_id": 40633059, "comment_id": 68541861, "body": "@kot331107 - Maybe not for that value, but if you habitually use the scheme you will get bit."}, {"owner": {"reputation": 428, "user_id": 5109951, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UFB--BLf8OM/AAAAAAAAAAI/AAAAAAAAAIg/T6jwl5ZEHYE/photo.jpg?sz=128", "display_name": "kot331107", "link": "https://stackoverflow.com/users/5109951/kot331107"}, "reply_to_user": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "edited": false, "score": 0, "creation_date": 1479387495, "post_id": 40633059, "comment_id": 68542049, "body": "@HotLicks Agree, but this certain value 1e9."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1575613502, "post_id": 40633059, "comment_id": 104633073, "body": "I like how Perl allows you to use <code>_</code> in numeric literal. <code>0x24_0000_0000</code> and <code>123_456</code> are perfectly legitimate literals in Perl."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1614295664, "post_id": 40633059, "comment_id": 117349922, "body": "Related: <a href=\"https://stackoverflow.com/q/66354756\">Why does long long n = 2000*2000*2000*2000; overflow?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 2523553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db4022a3f0d8e550473e873721f311bf?s=128&d=identicon&r=PG", "display_name": "MD.", "link": "https://stackoverflow.com/users/2523553/md"}, "edited": false, "score": 3, "creation_date": 1479302635, "post_id": 40633146, "comment_id": 68498862, "body": "sir, i&#39;m not clear how 1003^3 is 1003. Google and Mac Calculator shows 1000^3 = 1,000,000,000.  can you explain?"}, {"owner": {"reputation": 8813, "user_id": 1812788, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Zn2AX.jpg?s=128&g=1", "display_name": "Tam&#225;s Zahola", "link": "https://stackoverflow.com/users/1812788/tam%c3%a1s-zahola"}, "edited": false, "score": 59, "creation_date": 1479302700, "post_id": 40633146, "comment_id": 68498919, "body": "The <code>^</code> operator means XOR in C/C++/Objective-C etc. In calculators it usually means x-to-the-y power."}, {"owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 5, "creation_date": 1479314447, "post_id": 40633146, "comment_id": 68507260, "body": "Bah, the bits of 1000 and 3 do not overlap.  This looks <i>so</i> wrong."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "edited": false, "score": 22, "creation_date": 1479314757, "post_id": 40633146, "comment_id": 68507509, "body": "The bits do overlap. But not the 1&#39;s. :-]"}, {"owner": {"reputation": 3402, "user_id": 1841533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9c40aae4572d0d306ac3fbcc6ac9d9?s=128&d=identicon&r=PG", "display_name": "Olivier Dulac", "link": "https://stackoverflow.com/users/1841533/olivier-dulac"}, "reply_to_user": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "edited": false, "score": 6, "creation_date": 1479319854, "post_id": 40633146, "comment_id": 68510785, "body": "@Yakk: indeed, it looks so wrong ! ... I hope many people won&#39;t think that &quot;A^B&quot; always gives A+B   (but I fear some might...)"}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "edited": false, "score": 0, "creation_date": 1479326405, "post_id": 40633146, "comment_id": 68514402, "body": "I&#39;ll add an explanation."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1479355323, "post_id": 40633146, "comment_id": 68524569, "body": "Fun fact: XOR <b>is</b> add-without-carry (in binary, not decimal digits)."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "edited": false, "score": 1, "creation_date": 1479359602, "post_id": 40633146, "comment_id": 68525805, "body": "Not really a fun-fact. When I started developing computers, it wasn&#39;t unusual to build adder yourself from gates. However, it sounds like &quot;nearly a adder&quot;, but gives wrong results in 99 % of all cases adding two 16-bit numbers."}, {"owner": {"reputation": 842, "user_id": 1853967, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Qmbdz.jpg?s=128&g=1", "display_name": "ayane_m", "link": "https://stackoverflow.com/users/1853967/ayane-m"}, "edited": false, "score": 0, "creation_date": 1479372560, "post_id": 40633146, "comment_id": 68531929, "body": "@AminNegm-Awad XOR certainly does give wrong results in 99% of all cases adding two 16-bit numbers. In fact, it is only correct (100 * (3/4)^n) percent of the time when adding two n-bit numbers."}, {"owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "reply_to_user": {"reputation": 842, "user_id": 1853967, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Qmbdz.jpg?s=128&g=1", "display_name": "ayane_m", "link": "https://stackoverflow.com/users/1853967/ayane-m"}, "edited": false, "score": 0, "creation_date": 1479410036, "post_id": 40633146, "comment_id": 68557405, "body": "@\u5f69\u97f3M This is exactly the way I calculated that."}, {"owner": {"reputation": 4809, "user_id": 686184, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/39070f4d752dc965b716275da4e66b50?s=128&d=identicon&r=PG", "display_name": "pqnet", "link": "https://stackoverflow.com/users/686184/pqnet"}, "reply_to_user": {"reputation": 3402, "user_id": 1841533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9c40aae4572d0d306ac3fbcc6ac9d9?s=128&d=identicon&r=PG", "display_name": "Olivier Dulac", "link": "https://stackoverflow.com/users/1841533/olivier-dulac"}, "edited": false, "score": 3, "creation_date": 1541282240, "post_id": 40633146, "comment_id": 93164874, "body": "@OlivierDulac if people think that A^B means A+B and write the former instead of the latter to look smart and end up doing mistakes, they don&#39;t deserve to be programmers"}], "tags": [], "owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "is_accepted": false, "score": 73, "last_activity_date": 1479326682, "last_edit_date": 1479326682, "creation_date": 1479302197, "answer_id": 40633146, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40633146#40633146", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<blockquote>\n  <p>Why not <code>1000^3</code>?</p>\n</blockquote>\n\n<p>The result of <code>1000^3</code> is 1003. <code>^</code> is the bit-XOR operator.</p>\n\n<p>Even it does not deal with the Q itself, I add a clarification. <code>x^y</code> does <em>not</em> always evaluate to <code>x+y</code> as it does in the questioner's example. You have to xor every bit. In the case of the example:</p>\n\n<pre><code>1111101000\u2082 (1000\u2081\u2080)\n0000000011\u2082 (3\u2081\u2080)\n1111101011\u2082 (1003\u2081\u2080)\n</code></pre>\n\n<p>But</p>\n\n<pre><code>1111101001\u2082 (1001\u2081\u2080)\n0000000011\u2082 (3\u2081\u2080)\n1111101010\u2082 (1002\u2081\u2080)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 652, "user_id": 5106759, "user_type": "registered", "profile_image": "https://graph.facebook.com/959139744106160/picture?type=large", "display_name": "Madars Vi", "link": "https://stackoverflow.com/users/5106759/madars-vi"}, "is_accepted": false, "score": 7, "last_activity_date": 1480936022, "last_edit_date": 1480936022, "creation_date": 1479302372, "answer_id": 40633211, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40633211#40633211", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>Might be simpler to read and get some associations with the <code>1,000,000,000</code> form. </p>\n\n<p>From technical aspect I guess there is no difference between the direct number or multiplication. The compiler will generate it as constant billion number anyway.</p>\n\n<p>If you speak about objective-c, then <code>1000^3</code> won't work because there is no such syntax for pow (it is xor). Instead, <code>pow()</code> function can be used. But in that case, it will not be optimal, it will be a runtime function call not a compiler generated constant.</p>\n"}, {"comments": [{"owner": {"reputation": 215, "user_id": 4406754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280c38f4cc343f0f3be19b35d2195c91?s=128&d=identicon&r=PG&f=1", "display_name": "jamesqf", "link": "https://stackoverflow.com/users/4406754/jamesqf"}, "edited": false, "score": 13, "creation_date": 1479317335, "post_id": 40633261, "comment_id": 68509278, "body": "And in languages that do have an exponentiation operator, it isn&#39;t necessarily &#39;^&#39;.  In Fortran, for instance, it&#39;s &#39;**&#39;."}, {"owner": {"reputation": 3402, "user_id": 1841533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9c40aae4572d0d306ac3fbcc6ac9d9?s=128&d=identicon&r=PG", "display_name": "Olivier Dulac", "link": "https://stackoverflow.com/users/1841533/olivier-dulac"}, "edited": false, "score": 4, "creation_date": 1479320032, "post_id": 40633261, "comment_id": 68510889, "body": "You should also include a link pointing to the important caveat, given in answer below, from @chux : <a href=\"http://stackoverflow.com/a/40637622/1841533\">stackoverflow.com/a/40637622/1841533</a> (especially as the OP tagged &quot;c&quot;, which is very susceptible to this &#39;righ-hand side operation seem to have all terms limited to a smaller type, and therefore the multiplication may overflow&#39; problem).  <a href=\"https://www.securecoding.cert.org/confluence/display/c/INT32-C.+Ensure+that+operations+on+signed+integers+do+not+result+in+overflow\" rel=\"nofollow noreferrer\">securecoding.cert.org/confluence/display/c/&hellip;</a> may help avoiding those in the general case?"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 4, "creation_date": 1479321155, "post_id": 40633261, "comment_id": 68511486, "body": "Also we should note that the computation is done at compile time. The C Standard requires the implementation to be able to compute constant expressions at compile-time for various features of the language and we can safely assume it is true when a constant expression is used like in this example."}, {"owner": {"reputation": 19090, "user_id": 138772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32504cb73cc05b26335a43219fff3a79?s=128&d=identicon&r=PG", "display_name": "JAB", "link": "https://stackoverflow.com/users/138772/jab"}, "edited": false, "score": 13, "creation_date": 1479324336, "post_id": 40633261, "comment_id": 68513265, "body": "Storing amount of memory as a double? That seems like a potential source of error."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1479331043, "post_id": 40633261, "comment_id": 68517004, "body": "<a href=\"http://softwareengineering.stackexchange.com/questions/331388/why-was-the-caret-used-for-xor-instead-of-exponentiation\">Here&#39;s a question I asked about the caret operator being chosen for XOR</a> that might explain a few things."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 19090, "user_id": 138772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32504cb73cc05b26335a43219fff3a79?s=128&d=identicon&r=PG", "display_name": "JAB", "link": "https://stackoverflow.com/users/138772/jab"}, "edited": false, "score": 0, "creation_date": 1479340694, "post_id": 40633261, "comment_id": 68520910, "body": "@JAB: All integer values up to and including 9,007,199,254,740,992 are precisely representable.  Machines don&#39;t generally have that much memory yet, and if one considers hard drive space that&#39;s often allocated in chunks of 4096 bytes, so the number of such blocks in a machine with up to 36,893,488,147,419,103,232 bytes of storage.  Perhaps some such machines exist, but they&#39;re certainly not commonplace as of 2016."}, {"owner": {"reputation": 19090, "user_id": 138772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32504cb73cc05b26335a43219fff3a79?s=128&d=identicon&r=PG", "display_name": "JAB", "link": "https://stackoverflow.com/users/138772/jab"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 7, "creation_date": 1479340807, "post_id": 40633261, "comment_id": 68520939, "body": "@supercat I&#39;m aware of that, but by using double you could have a case where, say, you want a portion of the memory range, you divide by <code>x</code> to get the size of the subrange... and suddenly you have a fractional byte, which may require additional logic to compensate for."}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "reply_to_user": {"reputation": 19090, "user_id": 138772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32504cb73cc05b26335a43219fff3a79?s=128&d=identicon&r=PG", "display_name": "JAB", "link": "https://stackoverflow.com/users/138772/jab"}, "edited": false, "score": 0, "creation_date": 1479352480, "post_id": 40633261, "comment_id": 68523969, "body": "@JAB &quot;What, did you think we wanted full bytes?  We only need a nybble or two.&quot;"}, {"owner": {"reputation": 1247, "user_id": 9107647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a43594ef3d74c11a31be7f9d5ebddc0?s=128&d=identicon&r=PG&f=1", "display_name": "Humphrey Winnebago", "link": "https://stackoverflow.com/users/9107647/humphrey-winnebago"}, "edited": false, "score": 0, "creation_date": 1574466312, "post_id": 40633261, "comment_id": 104256606, "body": "@PiotrFalkowski  Note that C++11 has new syntax allowing the use of apostrophes to notate literals <code>1&#39;000&#39;000&#39;000</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1580682457, "post_id": 40633261, "comment_id": 106167279, "body": "Note however that <code>double storageBytes = 1024 * 1024 * 1024 * 1024;</code> will fail on most current hardware as the expression will cause arithmetic overflow. One would have to write <code>double storageBytes = 1024. * 1024 * 1024 * 1024;</code>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1614240552, "post_id": 40633261, "comment_id": 117326538, "body": "@chqrlie nstead of <code>double storageBytes = 1024. * 1024 * 1024 * 1024;</code> you may want to use hex float: <code>double memoryBytes = 0x1p40;</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1614256161, "post_id": 40633261, "comment_id": 117333582, "body": "@phuclv: hex floats are a good and readable option to express simple multiples of powers of 2 on systems that support them. For powers of 10, <code>double storageBytes = 1e40;</code> is obvious. For other cases supporting <code>_</code> as a digit grouping character would be a simple extension, compatible with the C preprocessor, unlike the C++ single quote syntax <code>double storageBytes = 123_456_789_000.;</code> This syntax is very common in c-like languages such as java, javascript, etc."}], "tags": [], "owner": {"reputation": 1908, "user_id": 3922292, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ffb081fc356588670e7de48462fbcd86?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Falkowski", "link": "https://stackoverflow.com/users/3922292/piotr-falkowski"}, "is_accepted": true, "score": 203, "last_activity_date": 1614468997, "last_edit_date": 1614468997, "creation_date": 1479302515, "answer_id": 40633261, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40633261#40633261", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>One reason to declare constants in a multiplicative way is to improve readability, while the run-time performance is not affected.\nAlso, to indicate that the writer was thinking in a multiplicative manner about the number.</p>\n<p>Consider this:</p>\n<pre class=\"lang-c prettyprint-override\"><code>double memoryBytes = 1024 * 1024 * 1024;\n</code></pre>\n<p>It's clearly better than:</p>\n<pre class=\"lang-c prettyprint-override\"><code>double memoryBytes = 1073741824;\n</code></pre>\n<p>as the latter doesn't look, at first glance, the third power of 1024.</p>\n<p>As Amin Negm-Awad mentioned, the <code>^</code> operator is the binary <code>XOR</code>. Many languages lack the built-in, compile-time exponentiation operator, hence the multiplication.</p>\n"}, {"comments": [{"owner": {"reputation": 1127, "user_id": 78739, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/064896cd753c7f5ea919522f3e64e2b8?s=128&d=identicon&r=PG", "display_name": "iheartcsharp", "link": "https://stackoverflow.com/users/78739/iheartcsharp"}, "edited": false, "score": 5, "creation_date": 1479310828, "post_id": 40633305, "comment_id": 68504686, "body": "FYI, there is a concept of digit separators that I learned about recently. Java has had it for a while now, and C# 7.0 may get it. I wish all languages would have this eye-candy feature. :)"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1479320153, "post_id": 40633305, "comment_id": 68510963, "body": "Depending on the context using <code>1,000,000,000</code> wouldn&#39;t produce a syntax error, it would just mean something else. For example <code>CMTimeMakeWithSeconds( newDurationSeconds, 1,000,000,000 )</code>"}, {"owner": {"reputation": 7653, "user_id": 1306322, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9ZslE.png?s=128&g=1", "display_name": "user1306322", "link": "https://stackoverflow.com/users/1306322/user1306322"}, "reply_to_user": {"reputation": 1127, "user_id": 78739, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/064896cd753c7f5ea919522f3e64e2b8?s=128&d=identicon&r=PG", "display_name": "iheartcsharp", "link": "https://stackoverflow.com/users/78739/iheartcsharp"}, "edited": false, "score": 2, "creation_date": 1479323329, "post_id": 40633305, "comment_id": 68512695, "body": "@JMS10 C# already has it if you install VS15 preview version, can be written as <code>1_000_000_000</code>"}, {"owner": {"reputation": 41280, "user_id": 344286, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3827b2facd01ed6a64a96df00d4b877a?s=128&d=identicon&r=PG", "display_name": "Wayne Werner", "link": "https://stackoverflow.com/users/344286/wayne-werner"}, "edited": false, "score": 2, "creation_date": 1479331894, "post_id": 40633305, "comment_id": 68517455, "body": "Python is getting <code>_</code> as the separator, too :)"}, {"owner": {"reputation": 3771, "user_id": 5386374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Justin Time - Reinstate Monica", "link": "https://stackoverflow.com/users/5386374/justin-time-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1479353362, "post_id": 40633305, "comment_id": 68524168, "body": "And C++ recently got the <code>&#39;</code> separator, in C++14, so you can use <code>1&#39;000&#39;000&#39;000</code>.  (It was chosen because <code>1,000,000,000</code> could be misinterpreted as the comma operator or 4 distinct parameters, and <code>_1_000_000_000</code> is a valid (but probably bad) variable name.)"}], "tags": [], "owner": {"reputation": 8813, "user_id": 1812788, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Zn2AX.jpg?s=128&g=1", "display_name": "Tam&#225;s Zahola", "link": "https://stackoverflow.com/users/1812788/tam%c3%a1s-zahola"}, "is_accepted": false, "score": 51, "last_activity_date": 1479302632, "creation_date": 1479302632, "answer_id": 40633305, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40633305#40633305", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>For readability. </p>\n\n<p>Placing commas and spaces between the zeros (<code>1 000 000 000</code> or <code>1,000,000,000</code>) would produce a syntax error, and having <code>1000000000</code> in the code makes it hard to see exactly how many zeros are there. </p>\n\n<p><code>1000*1000*1000</code> makes it apparent that it's 10^9, because our eyes can process the chunks more easily. Also, there's no runtime cost, because the compiler will replace it with the constant <code>1000000000</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 117929, "user_id": 669586, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/wxf3D.png?s=128&g=1", "display_name": "Sulthan", "link": "https://stackoverflow.com/users/669586/sulthan"}, "edited": false, "score": 0, "creation_date": 1479312404, "post_id": 40636209, "comment_id": 68505814, "body": "Many modern programming languages have the same, e.g. Swift. Nothing new."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 0, "creation_date": 1479343933, "post_id": 40636209, "comment_id": 68521843, "body": "AFAIK, this comes from Perl. PL/M used $ for the same purpose, e.g: 0100$0010B"}, {"owner": {"reputation": 1920, "user_id": 353434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PPAd.png?s=128&g=1", "display_name": "johncip", "link": "https://stackoverflow.com/users/353434/johncip"}, "edited": false, "score": 1, "creation_date": 1479351734, "post_id": 40636209, "comment_id": 68523794, "body": "It <i>is</i> fairly new, though. The Java feature is perhaps 5 years old. Most other languages supporting this syntax are pretty new -- Swift itself is only a few years old. Python adds support in 3.6, which hasn&#39;t been released yet."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479355587, "post_id": 40636209, "comment_id": 68524647, "body": "C++14 has this with <code>1&#39;000000&#39;000</code>.  I find it most handy for writing constants in binary: <code>0b11&#39;10&#39;01&#39;00</code> or something for a shuffle or blend control arg to an intrinsic."}, {"owner": {"reputation": 3613, "user_id": 760306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067a27004eed2579320f3e61c37f34d5?s=128&d=identicon&r=PG", "display_name": "Johannes Pille", "link": "https://stackoverflow.com/users/760306/johannes-pille"}, "reply_to_user": {"reputation": 7070, "user_id": 2359271, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/y1Mud.gif?s=128&g=1", "display_name": "Air", "link": "https://stackoverflow.com/users/2359271/air"}, "edited": false, "score": 0, "creation_date": 1479376813, "post_id": 40636209, "comment_id": 68534902, "body": "@Air: See the revision history of this. It was a non-post."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1479376957, "post_id": 40636209, "comment_id": 68535016, "body": "Ada has supported underlines in integer literals for 33 years now."}, {"owner": {"reputation": 1351, "user_id": 3323394, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/hPS1U.jpg?s=128&g=1", "display_name": "Arthur Hv", "link": "https://stackoverflow.com/users/3323394/arthur-hv"}, "edited": false, "score": 0, "creation_date": 1479376961, "post_id": 40636209, "comment_id": 68535021, "body": "Python 3.6: 10**9 or 1000**3. Unless I missed some important update, numbers can only be digits."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479377497, "post_id": 40636209, "comment_id": 68535418, "body": "Btw, I think writing <code>1000000000</code> or <code>1000*1000*1000</code> is equivalent in C, requiring the identical compile-time overflow diagnostics if applicable (a value within the type&#39;s representable values is a compile-time constraint for constants as well as for constant expressions)."}, {"owner": {"reputation": 39406, "user_id": 371250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WKvHm.png?s=128&g=1", "display_name": "ninjalj", "link": "https://stackoverflow.com/users/371250/ninjalj"}, "edited": false, "score": 1, "creation_date": 1479410845, "post_id": 40636209, "comment_id": 68557874, "body": "@djechlin: I&#39;ve taken the liberty of adding more information, roughly in chronological order. I was mistaken before, judging by the Project Coin thread, Stephen Colebourne probably took the idea of underscore in integer literals from Fandom and/or Ruby. Ruby probably took the idea from Perl, and Perl from Ada."}, {"owner": {"reputation": 7070, "user_id": 2359271, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/y1Mud.gif?s=128&g=1", "display_name": "Air", "link": "https://stackoverflow.com/users/2359271/air"}, "edited": false, "score": 0, "creation_date": 1479427078, "post_id": 40636209, "comment_id": 68565472, "body": "Now that we&#39;re well past something that could be relegated to a comment, I retract all past comments and votes. The king is dead, long live the king!"}], "tags": [], "owner": {"reputation": 54577, "user_id": 1339987, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/76aa5ba88e0d95b6480113239fe50008?s=128&d=identicon&r=PG", "display_name": "djechlin", "link": "https://stackoverflow.com/users/1339987/djechlin"}, "is_accepted": false, "score": 27, "last_activity_date": 1479412196, "last_edit_date": 1479412196, "creation_date": 1479310898, "answer_id": 40636209, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40636209#40636209", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>For readability. For comparison, Java supports <code>_</code> in numbers to improve readability (first proposed by Stephen Colebourne as a <a href=\"http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000932.html\" rel=\"noreferrer\">reply to Derek Foster's PROPOSAL: Binary Literals</a> for Project Coin/JSR 334) . One would write <code>1_000_000_000</code> here.</p>\n\n<p>In roughly chronological order, from oldest support to newest:</p>\n\n<ul>\n<li>XPL: <code>\"(1)1111 1111\"</code> (<a href=\"http://teampli.net/XPL/ld020.html\" rel=\"noreferrer\">apparently not for decimal values, only for bitstrings representing binary, quartal, octal or hexadecimal values</a>)</li>\n<li>PL/M: <code>1$000$000</code></li>\n<li>Ada: <code>1_000_000_000</code></li>\n<li>Perl: likewise</li>\n<li>Ruby: likewise</li>\n<li>Fantom (previously Fan): likewise</li>\n<li>Java 7: likewise</li>\n<li>Swift: (same?)</li>\n<li>Python 3.6</li>\n<li>C++14: <code>1'000'000'000</code></li>\n</ul>\n\n<p>It's a relatively new feature for languages to realize they ought to support (and then there's Perl). As in chux@'s excellent answer, <code>1000*1000...</code> is a partial solution but opens the programmer up to bugs from overflowing the multiplication even if the final result is a large type.</p>\n"}, {"comments": [{"owner": {"reputation": 3402, "user_id": 1841533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9c40aae4572d0d306ac3fbcc6ac9d9?s=128&d=identicon&r=PG", "display_name": "Olivier Dulac", "link": "https://stackoverflow.com/users/1841533/olivier-dulac"}, "edited": false, "score": 5, "creation_date": 1479320295, "post_id": 40637622, "comment_id": 68511025, "body": "Very important remark !  <a href=\"https://www.securecoding.cert.org/confluence/display/c/INT32-C.+Ensure+that+operations+on+signed+integers+do+not+result+in+overflow\" rel=\"nofollow noreferrer\">securecoding.cert.org/confluence/display/c/&hellip;</a> may help in a lot of cases?"}, {"owner": {"reputation": 3116, "user_id": 463687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eXUNI.jpg?s=128&g=1", "display_name": "Edgar Bonet", "link": "https://stackoverflow.com/users/463687/edgar-bonet"}, "edited": false, "score": 2, "creation_date": 1479376611, "post_id": 40637622, "comment_id": 68534749, "body": "A <code>double</code> can exactly represent all integers up to 2^53 \u2248 9e15."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3116, "user_id": 463687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eXUNI.jpg?s=128&g=1", "display_name": "Edgar Bonet", "link": "https://stackoverflow.com/users/463687/edgar-bonet"}, "edited": false, "score": 3, "creation_date": 1479395661, "post_id": 40637622, "comment_id": 68548133, "body": "@EdgarBonet True that <a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format#IEEE_754_double-precision_binary_floating-point_format:_binary64\" rel=\"nofollow noreferrer\">binary64</a> can represent whole number up to about 9e15.  But C does not specify <code>double</code> use of binary64, even though it is very commonly used.  Per the C spec, values up to 1e9 or so are exactly representable.  It depends if you want to code to spec or rely on common practice."}, {"owner": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 0, "creation_date": 1479406362, "post_id": 40637622, "comment_id": 68555310, "body": "@chux Why does &#39;long long Duration =  1 trillion&#39; overflow if you get there with multiplication, but not otherwise?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 5, "creation_date": 1479407122, "post_id": 40637622, "comment_id": 68555733, "body": "@Patrick Both <code>1000</code> and <code>1000000000000</code> are <i>integer constants</i>.  Each independently with have  the  type selected from <code>int</code>, <code>long</code> or <code>long long</code>.  The compiler uses the first type of those 3 in which the <i>integer constant</i> fits.  <code>1000 * 1000 * 1000 * 1000</code> is done with <code>int</code> math as each <code>1000</code> in an <code>int</code>.  The product overflows with 32-bit <code>int</code>.  <code>1000000000000</code>  is certainly representable as a <code>long long</code> (or possibly narrower)  - no overflow.  The type of the target <code>long long Duration</code> does not affect this &quot;right side of the =&quot; detemrination."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1500908611, "post_id": 40637622, "comment_id": 77530281, "body": "Placing the wider type first in the multiplication is important. With 16-bit <code>int</code>,  <code>long x = 1000 * 1000 * 1000L;</code> would overflow, while <code>long x = 1000L * 1000 * 1000;</code> would not."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 73, "last_activity_date": 1614469438, "last_edit_date": 1614469438, "creation_date": 1479314672, "answer_id": 40637622, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40637622#40637622", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>There are reasons <em>not</em> to use <code>1000 * 1000 * 1000</code>.</p>\n<p>With 16-bit <code>int</code>, <code>1000 * 1000</code> overflows. So using <code> 1000 * 1000 * 1000</code> reduces portability.</p>\n<p>With 32-bit <code>int</code>, the following first line of code overflows.</p>\n<pre class=\"lang-c prettyprint-override\"><code>long long Duration = 1000 * 1000 * 1000 * 1000;  // overflow\nlong long Duration = 1000000000000;  // no overflow, hard to read\n</code></pre>\n<p>Suggest that the lead value matches the type of the destination for readability, portability <em>and</em> correctness.</p>\n<pre class=\"lang-c prettyprint-override\"><code>double Duration = 1000.0 * 1000 * 1000;\nlong long Duration = 1000LL * 1000 * 1000 * 1000;\n</code></pre>\n<p>Also could simple use <code>e</code> notation for values that are exactly representable as a <code>double</code>.  Of course this leads to knowing if <code>double</code> can exactly represent the whole number value - something of concern with values greater than 1e9.  (See <code>DBL_EPSILON</code> and <code>DBL_DIG</code>).</p>\n<pre class=\"lang-c prettyprint-override\"><code>long Duration = 1000000000;\n// vs.\nlong Duration = 1e9;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 978, "user_id": 1166306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b850cb558316dcd3cdb6e447531b4e0d?s=128&d=identicon&r=PG", "display_name": "pjvandehaar", "link": "https://stackoverflow.com/users/1166306/pjvandehaar"}, "edited": false, "score": 1, "creation_date": 1480755844, "post_id": 40651779, "comment_id": 69102521, "body": "@pjvandehaar I would not recommend learning a language by reading Wikipedia articles."}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1479376762, "creation_date": 1479376762, "answer_id": 40651779, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/40651779#40651779", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>To illustrate the  reasons consider the following test program:</p>\n\n<pre><code>$ cat comma-expr.c &amp;&amp; gcc -o comma-expr comma-expr.c &amp;&amp; ./comma-expr\n#include &lt;stdio.h&gt;\n\n#define BILLION1 (1,000,000,000)\n#define BILLION2 (1000^3)\n\nint main()\n{\n        printf(\"%d, %d\\n\", BILLION1, BILLION2);\n}\n0, 1003\n$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2652, "user_id": 4564515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90733097a656c664a472c437678aad42?s=128&d=identicon&r=PG&f=1", "display_name": "jschultz410", "link": "https://stackoverflow.com/users/4564515/jschultz410"}, "is_accepted": false, "score": 0, "last_activity_date": 1614469492, "last_edit_date": 1614469492, "creation_date": 1497931099, "answer_id": 44643588, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c/44643588#44643588", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>Another way to achieve a similar effect in C for decimal numbers is to use literal floating point notation -- so long as a double can represent the number you want without any loss of precision.</p>\n<p>IEEE 754 64-bit double can represent any non-negative integer &lt;= 2^53 without problem.  Typically, long double (80 or 128 bits) can go even further than that.  The conversions will be done at compile time, so there is no runtime overhead and you will likely get warnings if there is an unexpected loss of precision and you have a good compiler.</p>\n<pre class=\"lang-c prettyprint-override\"><code>long lots_of_secs = 1e9;\n</code></pre>\n"}], "owner": {"reputation": 32649, "user_id": 316469, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b88514bd3cdfab33fa64342aa1fcdc9?s=128&d=identicon&r=PG", "display_name": "Duck", "link": "https://stackoverflow.com/users/316469/duck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14042, "favorite_count": 11, "accepted_answer_id": 40633261, "answer_count": 8, "score": 143, "last_activity_date": 1614469492, "creation_date": 1479301967, "last_edit_date": 1614468911, "question_id": 40633059, "link": "https://stackoverflow.com/questions/40633059/why-write-1-000-000-000-as-100010001000-in-c", "title": "Why write 1,000,000,000 as 1000*1000*1000 in C?", "body": "<p>In code created by Apple, there is this line:</p>\n<pre class=\"lang-c prettyprint-override\"><code>CMTimeMakeWithSeconds( newDurationSeconds, 1000*1000*1000 )\n</code></pre>\n<p>Is there any reason to express <code>1,000,000,000</code> as <code>1000*1000*1000</code>?</p>\n<p>Why not <code>1000^3</code> for that matter?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 2, "creation_date": 1479300466, "post_id": 40632496, "comment_id": 68497535, "body": "Type it into <a href=\"http://cdecl.ridiculousfish.com\" rel=\"nofollow noreferrer\">cdecl.ridiculousfish.com</a> ...."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479300496, "post_id": 40632496, "comment_id": 68497556, "body": "<code>f</code> is an array of 3 pointers to function, each returning pointer to an array of <code>5</code> chars."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479302236, "post_id": 40632496, "comment_id": 68498610, "body": "It includes a deprecated non prototype-style function declaration."}, {"owner": {"reputation": 2202, "user_id": 6544931, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3sbO-9nfAm0/AAAAAAAAAAI/AAAAAAAAABQ/g0E6_EKA2U4/photo.jpg?sz=128", "display_name": "Akash Mahapatra", "link": "https://stackoverflow.com/users/6544931/akash-mahapatra"}, "edited": false, "score": 0, "creation_date": 1479305376, "post_id": 40632496, "comment_id": 68500757, "body": "These kind of complex statements are not used in real time coding. The motive would have been to test your  knowledge specifically of operators and their precedence :)"}], "answers": [{"tags": [], "owner": {"reputation": 2202, "user_id": 6544931, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3sbO-9nfAm0/AAAAAAAAAAI/AAAAAAAAABQ/g0E6_EKA2U4/photo.jpg?sz=128", "display_name": "Akash Mahapatra", "link": "https://stackoverflow.com/users/6544931/akash-mahapatra"}, "is_accepted": true, "score": 10, "last_activity_date": 1531206284, "last_edit_date": 1531206284, "creation_date": 1479300504, "answer_id": 40632562, "question_id": 40632496, "link": "https://stackoverflow.com/questions/40632496/complex-declaration-in-c-programming-language/40632562#40632562", "title": "Complex declaration in C- Programming language", "body": "<p>Simply break the declaration into parts.<br/>\nThe inner most pair of braces : ( * f[3] ) means 'f' is an array of 3 elements which are pointers.<br/></p>\n\n<p><code>( *f )()</code> means 'f' is a pointer to function, so<br/>\n<code>( * f[3] ) ()</code>  means f is an array of 3 pointers to function.</p>\n\n<p><code>( * ( * f[3] ) ())</code> means f is an array of 3 pointers to function returning a pointer.</p>\n\n<p>Hence, </p>\n\n<pre><code>char ( * ( * f[3] ) ()) [5]  ;\n</code></pre>\n\n<p>means f is an array of 3 pointers to function returning a pointer to array of 5 characters</p>\n"}], "owner": {"reputation": 41, "user_id": 7137694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627c42daeb7fd6de99d67bbc19061bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Vidhi", "link": "https://stackoverflow.com/users/7137694/vidhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "closed_date": 1479301113, "accepted_answer_id": 40632562, "answer_count": 1, "score": 3, "last_activity_date": 1531206284, "creation_date": 1479300294, "last_edit_date": 1479305982, "question_id": 40632496, "link": "https://stackoverflow.com/questions/40632496/complex-declaration-in-c-programming-language", "closed_reason": "Duplicate", "title": "Complex declaration in C- Programming language", "body": "<p>I came across a very complex declaration which I could not understand:</p>\n\n<pre><code>char ( * ( * f[3]) ()) [5] ;\n</code></pre>\n\n<p>I want to know how to determine what is being declared.<br/>\nAlso, since this question was asked to me in an interview, I want to know whether these kind of codes are actually used in the software industry ?</p>\n\n<p>If not, then what is purpose of asking ?</p>\n"}, {"tags": ["c", "pointers", "struct", "function-parameter"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1479297617, "post_id": 40631631, "comment_id": 68495698, "body": "In the first snippet : <code>char title;</code> -&gt; <code>char *title;</code>"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 3, "creation_date": 1479297638, "post_id": 40631631, "comment_id": 68495712, "body": "Yes there is a difference. One will work, and one will not work."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1479297684, "post_id": 40631631, "comment_id": 68495737, "body": "@SamVarshavchik one might work*"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1479297694, "post_id": 40631631, "comment_id": 68495740, "body": "Are you really compiling c++? I strongly suspect you don&#39;t"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479298727, "post_id": 40631631, "comment_id": 68496387, "body": "<code>struct Book *obj2 = malloc(sizeof(struct obj2));</code> won&#39;t compile, please show the actual code."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1479301228, "post_id": 40631631, "comment_id": 68497990, "body": "Note: there is a <code>;</code> missing after the first <code>}</code> ."}, {"owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479301580, "post_id": 40631631, "comment_id": 68498184, "body": "Are you kidding me, im aksing for the difference, this is an example."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479301955, "post_id": 40631631, "comment_id": 68498406, "body": "There are no references in C!"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479298850, "post_id": 40631662, "comment_id": 68496454, "body": "Lets say i did initialize the pointer to an address, whjat would the difference be then?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479298905, "post_id": 40631662, "comment_id": 68496483, "body": "@EmilM&#248;llerRinggaard what is <code>an address</code>? is it <i>valid</i>? How do you know?"}, {"owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479298944, "post_id": 40631662, "comment_id": 68496511, "body": "It&#39;s on a microprocessor and it compiles, so i think it works"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479298954, "post_id": 40631662, "comment_id": 68496517, "body": "in general, as long as you pass a valid pointer, id does not matter whether it is the address of a scalar or a pointer variable itself."}, {"owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479299024, "post_id": 40631662, "comment_id": 68496580, "body": "Okay, would you recommend not using a pointer to the struct, and just pass in the &amp;structobject ?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 1, "creation_date": 1479299086, "post_id": 40631662, "comment_id": 68496623, "body": "@EmilM&#248;llerRinggaard That depends, both are valid. The rule of thumb is, if you can avoid using dynamic memory allocation <code>malloc()</code> and family, avoid them. Use them only when necessary."}, {"owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479299210, "post_id": 40631662, "comment_id": 68496708, "body": "One last question - Have it even more valid, to avoid dynamic memory allocation on a microcontroller then on a desktop for instance?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 1, "creation_date": 1479299300, "post_id": 40631662, "comment_id": 68496771, "body": "@EmilM&#248;llerRinggaard I&#39;d say, yes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "edited": false, "score": 0, "creation_date": 1479302123, "post_id": 40631662, "comment_id": 68498532, "body": "@EmilM&#248;llerRinggaard: &quot;It&#39;s on a microprocessor and it compiles, so i think it works&quot; - If things were <b>that</b> simple! The nasty thing which makes this a very wrong assumption is called &quot;Halting Problem&quot;. Simply put: Even if your code compiles without warnings - let alone errors - does not guarantee anything about its correctness."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1479298628, "last_edit_date": 1479298628, "creation_date": 1479297616, "answer_id": 40631662, "question_id": 40631631, "link": "https://stackoverflow.com/questions/40631631/using-pointers-or-references-to-struct/40631662#40631662", "title": "Using pointers or references to struct", "body": "<p>In case of</p>\n\n<pre><code> struct book obj1;\n setBook(&amp;obj);\n</code></pre>\n\n<p>you're passing a valid address<sup>#1</sup> to the function, so the behaviour is defined.</p>\n\n<p>On the other hand,</p>\n\n<pre><code>struct Book *obj2;\nsetBook(obj2);\n</code></pre>\n\n<p>you're passing an unitialized pointer<sup>#2</sup>, accessing which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>That said, the member <code>char title;</code> should be <code>char *title;</code>, as the <em>string literal</em>, when used as initializer, decays to the pointer to the first element, so you'll need a pointer on the LHS.</p>\n\n<hr>\n\n<p>#1 -- <code>obj1</code> is an automatic local variable, and address of that variable is a valid address in the scope.</p>\n\n<p>#2 --  <code>struct Book *obj2;</code> defines a pointer and again, <code>obj2</code> being an automatic local variable, it is not implicitly initialized to anything. So, the initial value (i.e., the memory address at which the pointer points) is indeterminate and pretty well <em>invalid</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 4, "last_activity_date": 1479297661, "creation_date": 1479297661, "answer_id": 40631677, "question_id": 40631631, "link": "https://stackoverflow.com/questions/40631631/using-pointers-or-references-to-struct/40631677#40631677", "title": "Using pointers or references to struct", "body": "<pre><code>struct Book *obj2;\n</code></pre>\n\n<p>in <code>main</code> is just a pointer with an indeterminate value. It doesn't point to anything you allocated. You can dereference it, but that's undefined behavior.</p>\n\n<pre><code>struct Book obj1;\n</code></pre>\n\n<p>allocates a <code>struct Book</code>. You can use its address and modify its members.</p>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li><code>title</code> from <code>struct Book</code> is a <code>char</code>, which can only hold one character, not a string (i.e., a pointer). Use <code>char *</code> or <code>const char *</code> instead.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 2879844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dedd829c22695a9f820044a20d9af900?s=128&d=identicon&r=PG&f=1", "display_name": "user2879844", "link": "https://stackoverflow.com/users/2879844/user2879844"}, "is_accepted": false, "score": 0, "last_activity_date": 1479300195, "creation_date": 1479300195, "answer_id": 40632470, "question_id": 40631631, "link": "https://stackoverflow.com/questions/40631631/using-pointers-or-references-to-struct/40632470#40632470", "title": "Using pointers or references to struct", "body": "<p>In the first case you are passing a variable of type 'struct Book'  to 'setBook function. Since you declared the variable hence total memory occupied by obj1 -s sizeof(setBook) i.e. sizeof(char)+sizeof(int) which is equal to 5 bytes. hence you can access as \nobj1 .title(1 byte) and obj1.pages(4 bytes).</p>\n\n<p>NOTE:- Assuming int is 4 byte long.</p>\n\n<p>Let's see what happen in second scenario.</p>\n\n<p>struct Book *obj2;\nobj2 size id 4 bytes since it is a general pointer.The field is not divided either and hence we cannot access the field.</p>\n\n<p>Hence,\nIn second scenario, you need to allocate is dynamically before trying to use the members.The allocation will result in proper sized and properly divided field. </p>\n"}], "owner": {"reputation": 99, "user_id": 2876690, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/1110370362/picture?type=large", "display_name": "Emil M&#248;ller Ringgaard", "link": "https://stackoverflow.com/users/2876690/emil-m%c3%b8ller-ringgaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40631662, "answer_count": 3, "score": 0, "last_activity_date": 1479300195, "creation_date": 1479297519, "last_edit_date": 1479298653, "question_id": 40631631, "link": "https://stackoverflow.com/questions/40631631/using-pointers-or-references-to-struct", "title": "Using pointers or references to struct", "body": "<p>Me and my friend is using structs in our code (our code is separate from each other). Lets take the following example:</p>\n\n<pre><code>struct Book {\n     char title;\n     int pages;\n}\n\nvoid setBook(struct Book *tempBook) {\n     tempBook-&gt;title = \"NiceTitle\";\n     tempBook-&gt;pages = 50;\n}\n</code></pre>\n\n<p>The above code is pretty straight forward. The thing is, is there any difference in having these two mains:</p>\n\n<pre><code> int main() {\n     struct book obj1;\n     setBook(&amp;obj);\n    }\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>int main() {\n    struct Book *obj2;\n    setBook(obj2);\n}\n</code></pre>\n\n<p>EDIT: \nI was not clear in my statement. I have initialized the pinter to</p>\n\n<pre><code>struct Book *obj2 = malloc(sizeof(struct obj2));\n</code></pre>\n"}, {"tags": ["c", "pointers", "subtraction", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479298130, "post_id": 40631057, "comment_id": 68496023, "body": "&quot;Both refer to memory address&quot; - Not according to the standard. Could as well be hashes to a database."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1479301183, "post_id": 40631057, "comment_id": 68497965, "body": "The reason you don&#39;t have the ability to compare or take differences between pointers do different types is because they might not even be on the same address space. For example in Harvard architecture pointer to function and pointer to data lie in different spaces and 1 can be valid address on both. Similarly in those architectures constants might be put in the same space as code and 2 distinct arrays of type <code>const int*</code> and <code>int*</code> might have exactly the same address. In DOS near pointers might be exactly the same but they might be pointed to different segments."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479303947, "post_id": 40631057, "comment_id": 68499761, "body": "@Olaf What makes you say that? n1570, 6.5.3.2/3: &quot;The unary &amp; operator yields the address of its operand.&quot; What type of memory is addressed is unspecified, true; it may be a database, or flash, or a toilet paper roll. But it is memory which is byte-wise addressable. The sentence &quot;Both [valid pointers] refer to memory address[es]&quot; is perfectly correct in any conceivable way. By the way, we can safely conclude from the numerical values of the addresses that any hashing algorithm would be deeply flawed; Occam&#39;s razor makes me biased towards a linear memory model."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479318022, "post_id": 40631057, "comment_id": 68509672, "body": "The question in the duplicate link is related but not the same: The other program involved two pointers of the same type, making the program compile and run. This one here violates a constraint though which is diagnosed by the compiler."}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479297116, "post_id": 40631080, "comment_id": 68495368, "body": "Make &quot;array&quot; &quot;object&quot;: It is legal to compute offsets of struct members."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1479297483, "post_id": 40631080, "comment_id": 68495618, "body": "@PeterA.Schneider: That&#39;s what <code>offsetof</code> is for. Can you provide a reference to where the standard allows this for pointers? IIRC, there is no such exception (and the implementtion of <code>offsetof</code> is implementation-specific."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479298014, "post_id": 40631080, "comment_id": 68495953, "body": "You are right, directly subtracting pointers to members is not allowed (and often wouldn&#39;t make sense, due to different types and padding). I wanted to express that they do have a guaranteed relation to each other in memory, as opposed to unrelated objects. But that doesn&#39;t make it valid to subtract unconverted pointers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479298256, "post_id": 40631080, "comment_id": 68496092, "body": "@PeterA.Schneider: What do you mean with &quot;guranteed relation&quot;? It is UB, so what guarantee would be there?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479298788, "post_id": 40631080, "comment_id": 68496418, "body": "@Olaf I mean exactly that. As you correctly said, it&#39;s possible to establish a member&#39;s address offset to the struct&#39;s address, and hence their address, and that member is guaranteed to be there for every struct of that type (compiled with the same compiler and settings). This guarantee does not exist for unrelated objects. You can take the struct&#39;s address and cast it to an integer (if possible), add the offset, cast it to the member&#39;s type pointer and access it. Nothing about that is undefined. After converting to integers you can also subtract the two and always get the offset."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479299257, "post_id": 40631080, "comment_id": 68496736, "body": "&quot;You can take the struct&#39;s address ...&quot; - No that invokes undefined behaviour! Conversion to/from an integer is implementation defined, but once you do arithmetics on that value and cast that back to a pointer, you invoke UB. Also for a second reason: you may only convert a pointer types to an integer and back to <b>the same type</b>."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479299413, "post_id": 40631080, "comment_id": 68496855, "body": "@Olaf I&#39;ll answer to that in my own answer."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1479301977, "post_id": 40631080, "comment_id": 68498421, "body": "A minor nitpick: I think the attempt to subtract two pointers of incompatible type is what the standard calls a <i>constraint violation</i> (the violated rule appears in the <i>Constraints</i> section of 6.5.6 in n1570). A <i>constraint</i> in standardese is a violation of the language rules which a conformant compiler must diagnose at compile time. That&#39;s why the OP cannot compile and run his program but correctly gets the reported errors. UB is not possible because no executable is produced."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479302538, "post_id": 40631080, "comment_id": 68498799, "body": "@PeterA.Schneider Whoa...that&#39;s not a nitpick, I kind of missed that point... Need to update, thanks for noticing.."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479318073, "post_id": 40631080, "comment_id": 68509698, "body": "@PeterA.Schneider: Nitpick on the nitpick: It <b>would invoke UB</b>. With some more effort, one can produce code which lets the compiler not detect this situation, so he cannot show a diagnostic message (e.g. a cast). That would not change the UB, just silence the constraint disagnostic. Btw.: The standard only uses the term &quot;diagnostic message&quot;, not &quot;error&quot; or &quot;warning&quot;. It also does not disallow generating code for such violations."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479318182, "post_id": 40631080, "comment_id": 68509764, "body": "@Olaf How would you go about fooling the static type analysis for expressions? (Oh, I see what you mean -- with a cast. That changes the type of the expression though, and removes that particular constraint violation.)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479319852, "post_id": 40631080, "comment_id": 68510782, "body": "@PeterA.Schneider: It does not remove the UB, though."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 9, "last_activity_date": 1479302708, "last_edit_date": 1479302708, "creation_date": 1479296001, "answer_id": 40631080, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631080#40631080", "title": "Subtraction between pointers of different type", "body": "<p>Nopes, this is not possible.</p>\n\n<p><strong>First,</strong> you can only subtract pointers of (to) \"compatible\" types, an <code>int</code> and a <code>char</code> are not compatible types here. Hence the subtraction is not possible.</p>\n\n<p>That said, even if both are pointers to compatible type, then also, the following comes into picture. </p>\n\n<p><strong>So, secondly</strong> You cannot just subtract two arbitrary pointers, they need to be essentially part of (address for elements of) the same array. Othweise, it invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>. </p>\n\n<p>Quoting <code>C11</code>, chapter \u00a76.5.6, <em>Additive operators</em></p>\n\n<blockquote>\n  <p>When two pointers are subtracted, both shall point to elements of the same array object,\n  or one past the last element of the array object; the result is the difference of the\n  subscripts of the two array elements. [....]</p>\n</blockquote>\n\n<p><strong>Thirdly,</strong> another important point, the result of subtraction of two pointers is of type <code>ptrdiff_t</code>, a signed integer type.</p>\n\n<blockquote>\n  <p>[...] The size of the result is implementation-defined,\n  and its type (a signed integer type) is <code>ptrdiff_t</code> defined in the <code>&lt;stddef.h&gt;</code> header. [...]</p>\n</blockquote>\n\n<p>so, to print the result, you need to use <code>%td</code> format specifier.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479298671, "post_id": 40631216, "comment_id": 68496346, "body": "The standard does not define how the conversion is done, if it is in any way meaningful. Less does it define what the difference of such converted pointers is. So the result of this difference is completely useless."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1479299035, "post_id": 40631216, "comment_id": 68496588, "body": "@Olaf Well, looking at the numerical values of addresses allows you, for example, to reverse-engineer a dynamic allocator; or inject code through a buffer overflow. I would not call that useless. <i>The standard is not the world; it is the smallest common denominator.</i>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479299443, "post_id": 40631216, "comment_id": 68496871, "body": "We don&#39;t have any details about the specific implementation, thus the standard is only what we have here. Said that, it is a question about standard behaviour!"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479300486, "post_id": 40631216, "comment_id": 68497547, "body": "@Olaf I don&#39;t see the word &quot;standard&quot; in the question; the question appears wholly pragmatic: &quot;Why I can&#39;t subtract a pointer of type (int *) and one of type (char *). Both refer to memory address.. What should I do in order to calculate the distance, in bytes, between the two?? &quot; It is a perfectly reasonable question to ask, and it has a perfectly reasonable answer (which I gave here)."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479301081, "post_id": 40631216, "comment_id": 68497909, "body": "@Olaf And Re &quot;We don&#39;t have any details about the specific implementation&quot;: But we do -- the OP posted two addresses of local variables, 5 bytes apart, high in the address range. This points to a stack at the end of the address space growing up..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479301740, "post_id": 40631216, "comment_id": 68498288, "body": "I know quite some embedded systems which have Flash in that location. That&#39;s no proof at all. Less, as we don&#39;t even know which platform it is. Better don&#39;t make assumptions an stick to the information given."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479304475, "post_id": 40631216, "comment_id": 68500139, "body": "@Olaf I couldn&#39;t care less about the underlying hardware of that byte-addressable read-write memory. What I said about the stack is observation, not assumption. What you said was an assumption, not an observation, and right: We should not make those."}, {"owner": {"reputation": 338, "user_id": 4712324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WL3dX.jpg?s=128&g=1", "display_name": "fedemengo", "link": "https://stackoverflow.com/users/4712324/fedemengo"}, "edited": false, "score": 0, "creation_date": 1479398312, "post_id": 40631216, "comment_id": 68550178, "body": "@PeterA.Schneider you exactly understand what I meant with the question! Very interesting topic"}], "tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1479317802, "last_edit_date": 1479317802, "creation_date": 1479296392, "answer_id": 40631216, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631216#40631216", "title": "Subtraction between pointers of different type", "body": "<p>On a standard PC nothing keeps you from casting both pointers to an integer type which can hold the pointer value, and subtracting the two integers.</p>\n\n<p>Such an integer type is not guaranteed to exist on all architectures (but on many common systems it does) &mdash; imagine segmented memory with more information than just a single number. If the integer type doesn't fit, the behavior of the cast is undefined.</p>\n\n<p>From the standard draft n1570, 6.3.2.3/6:</p>\n\n<blockquote>\n  <p>Any pointer type may be converted to an integer type. Except as\n  previously specified, the result is implementation-defined. If the\n  result cannot be represented in the integer type, the behavior is\n  undefined. The result need not be in the range of values of any\n  integer type.</p>\n</blockquote>\n\n<p>Often the difference between addresses will be what one expects (variables declared in succession are next to each other in memory) and can be used to tell the direction the stack grows etc.</p>\n\n<hr>\n\n<p>It may be interesting to explore what else you can do with integers and pointers.</p>\n\n<p>Olaf commented that if you \"cast [an arithmetic computation result] back to a pointer, you invoke UB.\" That is not necessarily so; it depends on the integer value. The standard draft says the following in 6.3.2.3/5:</p>\n\n<blockquote>\n  <p>An integer may be converted <strong>to any pointer type.</strong> Except as previously\n  specified, the result is <strong>implementation-defined,</strong> might not be\n  correctly aligned, might not point to an entity of the referenced\n  type, and might be a trap representation </p>\n</blockquote>\n\n<p>(Emphasis by me.) If we compute the address of a struct member by adding an offset to the struct's address we have obviously taken care of the mentioned issues, so it's up to the implementation. It is certainly not UB; a good many embedded systems would fail if we couldn't use an integer -> pointer conversion, and access that memory through the resulting pointer. We must make sure that the system allows it, and that the addresses are sound.</p>\n\n<p>The paragraph has a footnote:</p>\n\n<blockquote>\n  <p>The mapping functions for converting a pointer to an integer or an integer to a pointer are intended to\n  be consistent with the addressing structure of the execution environment.</p>\n</blockquote>\n\n<p>That is, they are meant to <em>not surprise the user</em>. While in theory the addresses of unrelated objects adjacent in memory could be projected to wildly different integer values, they are not supposed to. A user can for example reasonably expect that linear memory is projected into a linear integer number space, keeping ordering and distances.</p>\n\n<p><hr>\nI should also emphasize (as I did in one comment) that the standard is not the world. It must accommodate and give guarantees for a wide range of machines. Therefore <em>the standard can only be the smallest common denominator.</em> If we can narrow the range of architectures we consider, we can make much better guarantees. </p>\n\n<p>One common example is the possible presence of trap values in integer registers, or flags indicating a read from an uninitialized register, which also traps; these are responsible for a wide range of UB cases in the standard which simply do not apply, for example, to your PC.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479298714, "post_id": 40631319, "comment_id": 68496380, "body": "Subtracting <code>void *</code> is UB."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479302691, "post_id": 40631319, "comment_id": 68498911, "body": "@Olaf It is, I believe, not UB. It is a <i>constraint violation,</i> which a conformant compiler must diagnose at compile time (the constraint is that it shall hold that &quot;both operands are pointers to qualified or unqualified versions of compatible <b>complete object types.&quot;)</b> This constraint is also the reason the OP cannot compile (and hence not run). Implementations are free to permit this as an extension, and in fact two which are widely used do, gcc and icc. The result does not, of course, expose undefined behavior."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479303200, "post_id": 40631319, "comment_id": 68499261, "body": "@Olaf As a clarification to my last comment: Re &quot;The result does not, of course, expose undefined behavior&quot;: As long as they point into the same array."}, {"owner": {"reputation": 137, "user_id": 2138882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3880e37d76097b1003dbac5fd54872?s=128&d=identicon&r=PG&f=1", "display_name": "Forrest", "link": "https://stackoverflow.com/users/2138882/forrest"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479328129, "post_id": 40631319, "comment_id": 68515391, "body": "@Olaf would you suggest type casting to (char *) instead then?  I&#39;m simply trying to provide an option for the OP to explore how his computer is storing variables.  As I point out it&#39;s dangerous, but the value lies in understanding your computer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479334163, "post_id": 40631319, "comment_id": 68518559, "body": "@ForrestKoch: Problem does not change by a cast. And there is no knowledge gained in seeing the address difference of two <b>specific</b> variables for a <b>specific</b> example, a <b>specific</b> implementation, <b>specific</b> optimisation setting, a <b>specific</b> compiler version, a <b>specific</b> architecture, ... A good introductory book about compiler construction would gain way more knowledge."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479334538, "post_id": 40631319, "comment_id": 68518724, "body": "@PeterA.Schneider: As I already wrote elsewhere: There is no need for a constraint violation the compiler does not generate code (which then invokes UB). The only requirement is to emit a diagnostic message."}], "tags": [], "owner": {"reputation": 137, "user_id": 2138882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3880e37d76097b1003dbac5fd54872?s=128&d=identicon&r=PG&f=1", "display_name": "Forrest", "link": "https://stackoverflow.com/users/2138882/forrest"}, "is_accepted": false, "score": 0, "last_activity_date": 1479296694, "creation_date": 1479296694, "answer_id": 40631319, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631319#40631319", "title": "Subtraction between pointers of different type", "body": "<p>Try typecasting each address to <code>void *</code></p>\n\n<p><code>long int distance = (void *)&amp;a - (void *)&amp;data[5];</code></p>\n\n<p>As others will point out, this is dangerous and undefined, but if you're just exploring how memory works, it should be fine.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479298411, "post_id": 40631330, "comment_id": 68496185, "body": "&quot;You shouldn&#39;t ...&quot; - that&#39;s not a weak disallowance, but a clear <b>don&#39;t</b>."}, {"owner": {"reputation": 504, "user_id": 5097473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c46c48a9d610a31cc11fd8a3cf1aac9?s=128&d=identicon&r=PG", "display_name": "Vel", "link": "https://stackoverflow.com/users/5097473/vel"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479298486, "post_id": 40631330, "comment_id": 68496223, "body": "Right! I will edit that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479300246, "post_id": 40631330, "comment_id": 68497383, "body": "You actually don&#39;t get &quot;offsets&quot; as in &quot;difference between memory addresses&quot;, but the difference in indexes between the elements of the array (any other difference between pointers is disallowed anyway)."}], "tags": [], "owner": {"reputation": 504, "user_id": 5097473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c46c48a9d610a31cc11fd8a3cf1aac9?s=128&d=identicon&r=PG", "display_name": "Vel", "link": "https://stackoverflow.com/users/5097473/vel"}, "is_accepted": false, "score": 0, "last_activity_date": 1479298497, "last_edit_date": 1479298497, "creation_date": 1479296721, "answer_id": 40631330, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631330#40631330", "title": "Subtraction between pointers of different type", "body": "<p>This is because pointer arithmetic is about offsets.\nFor example, if you have an array and a pointer to that array like:</p>\n\n<pre><code>int array[3] = { 1, 2, 3};\nint *ptr = array;\n</code></pre>\n\n<p>and then you increment ptr, you expect next value from the array, e.g. array[0] after array[1], no matter what type is stored in that. So when you substract pointers you don't get e.g. bytes, but offset.</p>\n\n<p>Don't substract pointers that are not the part of the same array.</p>\n"}, {"comments": [{"owner": {"reputation": 338, "user_id": 4712324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WL3dX.jpg?s=128&g=1", "display_name": "fedemengo", "link": "https://stackoverflow.com/users/4712324/fedemengo"}, "edited": false, "score": 0, "creation_date": 1479398956, "post_id": 40631457, "comment_id": 68550649, "body": "Ok I was aware I could get some error in calculation, but I though I could get some result from the difference instead of getting that compilation error"}], "tags": [], "owner": {"reputation": 159, "user_id": 2879844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dedd829c22695a9f820044a20d9af900?s=128&d=identicon&r=PG&f=1", "display_name": "user2879844", "link": "https://stackoverflow.com/users/2879844/user2879844"}, "is_accepted": false, "score": 0, "last_activity_date": 1479297064, "creation_date": 1479297064, "answer_id": 40631457, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631457#40631457", "title": "Subtraction between pointers of different type", "body": "<p>The size of int and size of char pointers are different.In a system where int size is 4 bytes if you will do int_pointer++ it will increase address by 4 bytes while it will increment address by 1 byte in case of char_ptr. Hence you might be getting error.</p>\n"}, {"comments": [{"owner": {"reputation": 338, "user_id": 4712324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WL3dX.jpg?s=128&g=1", "display_name": "fedemengo", "link": "https://stackoverflow.com/users/4712324/fedemengo"}, "edited": false, "score": 0, "creation_date": 1479398807, "post_id": 40631528, "comment_id": 68550537, "body": "<i>&quot;How could you divide the difference in byte address by the size of the object being pointed to when the pointers being subtractedare referring to differently sized objects?&quot;</i> as you said is just for experimentation purpose. In this case, the unknown object type you&#39;re referring is the one stored between the two address I get (0x7fff5661aac8, 0x7fff5661aac9, 0x7fff5661aaca, 0x7fff5661aacb)? Or it would be the type (int *and char *) that in some cases might be unknown a priori? EDIT: or both?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 338, "user_id": 4712324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WL3dX.jpg?s=128&g=1", "display_name": "fedemengo", "link": "https://stackoverflow.com/users/4712324/fedemengo"}, "edited": false, "score": 0, "creation_date": 1479402186, "post_id": 40631528, "comment_id": 68552784, "body": "In your case, for your experiment, you can just use <code>long int distance = (char *)&amp;a - &amp;data[5];</code> to subtract two <code>char *</code>s. A <code>char *</code> points to the smallest addressable object, which is a &quot;byte&quot; in C terminology, and is likely to be the same as a common parlance &quot;byte&quot; unless you have a somewhat exotic computing environment."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 2, "last_activity_date": 1479297222, "creation_date": 1479297222, "answer_id": 40631528, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631528#40631528", "title": "Subtraction between pointers of different type", "body": "<p>Pointer subtraction is only defined for pointers within the same array (or just past the last element of an array).  Any other use is undefined behavior. Let's ignore that for your experimentation.</p>\n\n<p>When two pointers of the same type to elements of the same array object are subtracted, the result is the difference of the array indices. You could add that signed integer result (of type <code>ptrdiff_t</code>) to the first pointer and get the value of the second pointer, or subtract the result from the second pointer and get the value of the first pointer.  So in effect, the result is the difference in the byte address of the two pointers divided by the size of the object being pointed to. This is why it makes no sense to allow subtraction of pointers of incompatible type, particularly when the referenced object types are of different size.  How could you divide the difference in byte address by the size of the object being pointed to when the pointers being subtractedare referring to differently sized objects?</p>\n\n<p>Still, for experimentation purposes, you can cast both pointers (pointing to different objects) to <code>char *</code> and subtract them, and many compilers will just give you the difference in their byte address as a number.  However, the result could overflow an integer of <code>ptrdiff_t</code>.  Alternatively, you can convert both pointers to an integer of type <code>intptr_t</code> and subtract the integers to get the difference in byte address.  Again, it's theoretically possible that the result of the subtraction could overflow an integer of type <code>intptr_t</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 3, "creation_date": 1479298338, "post_id": 40631783, "comment_id": 68496135, "body": "Conversions from pointers to integer is implementation defined and may cause undefined behavior in case of trap representations (6.3.2.3 &#167;5). Also types uintptr_t or intptr_t should be preferred for pointer storage as they are, unlike ptrdiff_t, explicitly defined for this purpose (7.20.1.4&#167;1)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479298859, "post_id": 40631783, "comment_id": 68496455, "body": "&quot;Now if ptr was 100, what will ptr2 be? Correct, it will be 105. But now look at that code:&quot; - Wrong. It will invoke undefined behaviour, unless it points to (or exactly past) the same array."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479298934, "post_id": 40631783, "comment_id": 68496503, "body": "@2501 Secondly: Any pointer fits into <code>ptrdiff_t</code> by definition as I can always subtract <code>(ptrdiff_t)0</code> from another pointer, thus casting a pointer to <code>ptrdiff_t</code> is always save and can never fail. Also <code>ptrdiff_t</code> is older than <code>uintptr_t</code> and thus far wider supported. And that the result of this conversion is implementation defined it totally irrelevant here, as you cannot do anything meaningful with diff anyway."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479299159, "post_id": 40631783, "comment_id": 68496675, "body": "@Olaf No, it will not invoke undefined behavior, it <b>could</b> invoke undefined, but as you don&#39;t know what <code>ptr</code> is (who says it isn&#39;t a pointer to an array of 100 <code>uint32_t</code> values?) you cannot make claims like that. Please refrain from commenting on the basis of things you <i>do not know</i>, only make comments on the basis of things that <i>you do know</i>. And you just don&#39;t know what <code>ptr</code> is in my code, as <code>...</code> is a place holder."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479299632, "post_id": 40631783, "comment_id": 68497004, "body": "You should have read the whole comment of mine! Problem is you don&#39;t show exactly this relevant part in your answer, thus my comment is correct as it stands. I&#39;m not a clairvoyant and most beginners aren&#39;t either. If you provide incomplete answers, comments pointing at the missing parts are to be expected. If you don&#39;t like them, be clear about what you mean!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 2, "creation_date": 1479300031, "post_id": 40631783, "comment_id": 68497243, "body": "<code>(ptrdiff_t)0</code> when used in pointer context, is a <i>null pointer constant</i>. Difference between any valid pointer and a <i>null pointer</i> is undefined behaviour. Thus you prove nothing. And no, <code>ptrdiff_t</code> is <b>not</b> guaranteed to hold a pointer. Feel free to provide a reference to where ste standard states different. As @2501 wrote, only <code>(u)intptr_t</code> are guaranteed to hold a pointer. But only for conversion from/to, not arithmetics. Don&#39;t confuse the abstract machine with a specific implementation."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479300418, "post_id": 40631783, "comment_id": 68497504, "body": "@Olaf <code>ptrdiff_t</code> is an int value. <code>ptridiff_t p = 0</code> is no different than <code>int i = 0</code>. <code>ptrdiff_t</code> has no special meaning, other than that the standard says that any possible pointer difference will fit into it. <code>ptrdiff_t</code> is not a NULL pointer, it is an integer of unknown size whose value is 0. And the standard doesn&#39;t have to define that <code>ptrdiff_t</code> can hold any pointer as that is logically derived by the guarantee that it can hold any pointer diff."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1479301402, "post_id": 40631783, "comment_id": 68498094, "body": "Please note that I mostly agree with your answer and I have not downvoted it. But in favor of improving it, I have posted that first comment. SO is a collaboration, remember that."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479301439, "post_id": 40631783, "comment_id": 68498111, "body": "&quot;any possible pointer difference will fit into it.&quot; - Which does not imply it will fitz a pointer itself! The allowed difference of pointer can be smaller than the size of a pointer. Just consider a 68000 system, where the max. size of an array could well fit into an <code>int16_t</code> (the 68000 was a 16 bit CPU with 32 bit registers and operations), but pointers were 32 bit (24 + 8 unused actually). And, again, <code>(ptrdiff_t)0</code> is <b>not the same</b> as <code>ptrdiff_t p</code>. You should be less careless when it comes to relevant details."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479302991, "post_id": 40631783, "comment_id": 68499116, "body": "<code>ptrdiff_t diff = (void *)ptr2 - (void *)ptr1;</code> is a compile time error: <code>error: pointer of type &#39;void *&#39; used in subtraction [-Werror=pointer-arith]</code>."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479303242, "post_id": 40631783, "comment_id": 68499283, "body": "@mch If you tell your compiler to report that kind of pointer arithmetic as an error (that&#39;s what the option <code>-Werror=pointer-arith</code> does!), then of course it will be an error. But under normal circumstances it is not. See here, you can even run that code online and it runs just fine: <a href=\"http://rextester.com/MFVL71506\" rel=\"nofollow noreferrer\">rextester.com/MFVL71506</a>"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479303432, "post_id": 40631783, "comment_id": 68499412, "body": "@Mecki look at the warning <code>warning: arithmetic on pointers to void is a GNU extension</code>."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1479303870, "post_id": 40631783, "comment_id": 68499718, "body": "@mch Yes, you are correct, this is not standard, albeit widely supported by almost all compilers. If you tell your compiler to allow GNU extensions, you also don&#39;t get a warning ; of course the compiler will complain if you tell it t strictly enforce ISO-C. I point that out in my reply."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479306315, "post_id": 40631783, "comment_id": 68501409, "body": "@Olaf The maximum size of an array in C is only defined by the size of <code>size_t</code>. Something like segmented memory may limit the maximum linear mem block, but segments are alien to C and memory can very well cross segment borders. It&#39;s task of the compiler/OS to handle such situations.  My C compiler for 68000 says <code>size_t</code> is 32 bit and <code>ptrdiff_t</code> is always the signed integer type that <code>size_t</code> is. Also note that <code>[u]intptr_t</code> are optional types (7.20.1.4), the compiler may not even know these, but <code>ptrdiff_t</code> is a mandatory type and the only type you can thus rely to be present."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1479306527, "post_id": 40631783, "comment_id": 68501567, "body": "@2501 Also if you had read 7.20.1.4, you&#39;d know that <code>[u]intptr</code> are optional type, you cannot rely that they even exist, a compiler is ISO C conform if it never heard of that type. <code>ptrdiff_t</code> is a mandatory type, every compiler aiming at standard compatibility must support it. So it&#39;s the only type guaranteed to be portable and should there ever be a platform where a pointer does not fit into <code>ptrdiff_t</code>, then hell would break lose. Most operating system can impossibly even run on such a platform. I prefer to show working code then nitpicking on standards, which really helps nobody on earth."}, {"owner": {"reputation": 5819, "user_id": 2109038, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ve1RL.jpg?s=128&g=1", "display_name": "Confused", "link": "https://stackoverflow.com/users/2109038/confused"}, "edited": false, "score": 0, "creation_date": 1479308641, "post_id": 40631783, "comment_id": 68503088, "body": "To those complaining about this answer: It is the only answer I understand to be addressing the core request of the OP: &quot;I&#39;m trying to find the distance in memory between two variables.&quot; And does a remarkable job of explaining a lot about pointers and memory."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5819, "user_id": 2109038, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ve1RL.jpg?s=128&g=1", "display_name": "Confused", "link": "https://stackoverflow.com/users/2109038/confused"}, "edited": false, "score": 0, "creation_date": 1479314264, "post_id": 40631783, "comment_id": 68507118, "body": "@Confused: Understandability does not allow incorrectness or carelessness."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479314544, "post_id": 40631783, "comment_id": 68507339, "body": "@Mecki: I cited values from an older compiler. <code>size_t</code> defines the max. <b>size</b> of an array in bytes. <code>ptrdiff_t</code> the max. difference of two pointer in terms of indexes. Said that, an architecture may allow <code>SIZE_MAX</code> to be 32767, i.e. what a 16 bit <code>ptrdiff_t</code> can represent, yet use 32 bit (or 20 bit) pointers. See 8086. There is no need to put something into my words. I did not mention segmentation at all and there is no need for that. <code>(u)intptr_t</code> are the <b>only</b> integers guaranteed to hold any pointer type (indirectly, as they strictly require first a conversion to <code>void *</code>). ..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479314646, "post_id": 40631783, "comment_id": 68507416, "body": "... they are optional for the simple reason that there might be no conversion from pointer to integer, as that is implementation defined. Any modern compiler will provide them if the architecture allows for them. It is much like making the fixed-width types optional. Let that apart, you still don&#39;t provide a reference where the standard allows arithmetic on such a converted pointer and back. Even for standard integer types, there is only the conversion from/to of the same type allowed and nothing about changing the value."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479315279, "post_id": 40631783, "comment_id": 68507848, "body": "@Olaf You say <code>I cited values from an older compiler.</code> but then you argue on the latest C standard (how would that fit together) and one comment later you say <code>Any modern compiler ....</code>  Okay, what are we talking about here? An abstract, theoretical standard? An old compiler nobody uses anymore? Or &quot;any modern compiler&quot;? You jump wherever it pleases you. Well, any modern compiler will have <code>ptrdiff_t</code> where any pointer fits as this type is widely used in million of C code lines and some of these even pre-dates the latest standard by several years."}, {"owner": {"reputation": 5819, "user_id": 2109038, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ve1RL.jpg?s=128&g=1", "display_name": "Confused", "link": "https://stackoverflow.com/users/2109038/confused"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479315280, "post_id": 40631783, "comment_id": 68507849, "body": "Nonsense, @Olaf. On all counts. If you&#39;re so wise on this, write a better answer. The principles, processes and practicalities of finding the distance between variable pointers is understandable in this answer, which makes it brilliant, and correct, regardless of whatever you&#39;re talking about, which is completely incomprehensible in the comments format. You&#39;re well past the point where writing your own answer would be a far better way to make your points. This cramped and unformatted space isn&#39;t helping you articulate whatever you&#39;re trying to say."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1479315291, "post_id": 40631783, "comment_id": 68507854, "body": "The original question is &quot;how do I do that&quot; and I&#39;m pretty sure my answer is exactly the correct and working answer to that question. Everything else nitpicking about theoretical situations nobody cares for as they just don&#39;t relate to this concrete question at all. If the poster say &quot;Your code doesn&#39;t work on my 8086&quot;, thenwe can talk, but other than that you are just wasting time arguing a perfectly valid answer because... well, only God knows! You are talking to someone who still coded on a 8086 (just for the record - I still have one at home)."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479315886, "post_id": 40631783, "comment_id": 68508285, "body": "@Olaf Facts are: (1) Code using <code>[u]intptr_t</code> is not guaranteed to be portable among ISO conform compilers. (2) Code using <code>ptrdiff_t</code> is portable among all ISO conform compilers. (3) No compiler that I am aware of and that is ISO conform (and that may even have a <code>[u]intptr_t</code> data type) has a <code>ptrdiff_t</code> type where not all possible pointers would fit. The fact, that this could <i>theoretically</i> exist (which I still doubt as it makes no sense in so many aspects, even if the standard doesn&#39;t enforce it) is just like pink elephants could theoretically exist, when I said they are gray."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1479316960, "post_id": 40631783, "comment_id": 68509015, "body": "1-2) Using <code>ptrdiff_t</code> is? Wow, theat&#39;s quite a false statement. At least you are guaranteed to get an error message if <code>(u)intptr_t</code> is not available. Which is no way guaranteed for the other types. 3) You should do some embedded programming then. Btw: That&#39;s the vast majority of systems. And I know about at least <b>one</b> pink elephant."}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479323449, "post_id": 40631783, "comment_id": 68512773, "body": "@Olaf I also do embedded programming, I do that very often and I never had a problem with <code>ptrdiff_t</code>. Okay, how about that: Show me an ISO compiler for any platform of your choice, where casting a pointer to <code>ptrdiff_t</code> and back to a pointer will not result in the same pointer as before. Just one, and I take everything back, you are right, I fix my reply. If you can&#39;t, please refrain from commenting this question as then you are nitpicking and not helpful at all and SO is all about being helpful."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479323853, "post_id": 40631783, "comment_id": 68513003, "body": "@Mecki: I don&#39;t see any sense fighting wilfull ignorance. There are indeed quite some compilers which do, let alone there is absolutely no use <b>not</b> to use the types specifically designated to this. But comfortably, you ignored my other - much more relevant issues. I&#39;m done here, but I will not stop commenting incorrect answers at <b>my</b> will."}], "tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": false, "score": 1, "last_activity_date": 1479305004, "last_edit_date": 1479305004, "creation_date": 1479297971, "answer_id": 40631783, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type/40631783#40631783", "title": "Subtraction between pointers of different type", "body": "<pre><code>uint8_t * ptr = ...;\nuint8_t * ptr2 = ptr + 5;\n</code></pre>\n\n<p>Now if <code>ptr</code> was <code>100</code>, what will <code>ptr2</code> be? Correct, it will be <code>105</code>. But now look at that code:</p>\n\n<pre><code>uint32_t * ptr = ...;\nuint32_t * ptr2 = ptr + 5;\n</code></pre>\n\n<p>Again, if <code>ptr</code> was <code>100</code>, what will <code>ptr2</code> be? Wrong! It won't be <code>105</code>, it will be <code>120</code>.</p>\n\n<p>Why? Pointer arithmetic is not integer arithmetic!</p>\n\n<pre><code>ptr2 = ptr + 5;\n</code></pre>\n\n<p>Actually means:</p>\n\n<pre><code>ptr2 = int_to_ptr(ptr_to_int(ptr) + (sizeof(ptr) * 5));\n</code></pre>\n\n<p>Functions <code>int_to_ptr</code> and <code>ptr_to_int</code> don't really exist, I'm just using them for demonstration purpose, so you better understand what is going on between the scenes.</p>\n\n<p>So if you subtract two pointers, the result is not the difference of their addresses, it's the number of <strong>elements</strong> between them:</p>\n\n<pre><code>uint32_t test[50];\nptrdiff_t diff = &amp;test[20] - &amp;test[10];\n</code></pre>\n\n<p><code>diff</code> will be 10, as there are 10 elements in between them (one element is one <code>uint32_t</code> value) but that doesn't mean there are 10 bytes between <code>test[10]</code> and <code>test[20]</code>, there are 40 bytes between them as every <code>uint32_t</code> value takes up 4 bytes of memory.</p>\n\n<p><em>Now you may understand why subtracting pointers of different types makes no sense, as different types have different element sizes and what shall such a subtraction then return?</em></p>\n\n<p>If you want how many bytes are in between two pointers, you need to cast them both to a data type that has one-byte elements (e.g. <code>uint8_t *</code> or <code>char *</code> would work) or cast them to <code>void *</code> (GNU extension but many compilers support that as well), which means the data type is unknown and thus the element size is unknown as well and in that case the compiler will byte-sized elements. So this may work:</p>\n\n<pre><code>ptrdiff_t diff = (void *)ptr2 - (void *)ptr1;\n</code></pre>\n\n<p>yet this</p>\n\n<pre><code>ptrdiff_t diff = (char *)ptr2 - (char *)ptr1;\n</code></pre>\n\n<p>is more portable.</p>\n\n<p>It will compile, it will deliver an result. If that result is meaningful, that's a different topic. Unless both pointers point to the same memory \"object\" (same struct, same array, same allocated memory region), it is not, as the standard says that in that case, the result is undefined. That means <code>diff</code> could (legally) have any value, so a compiler may as well always set <code>diff</code> to 0 in that case, that would be allowed by the standards.</p>\n\n<p>If you want defined behavior, try this instead:</p>\n\n<pre><code>ptrdiff_t diff = (ptrdiff_t)ptr2 - (ptrdiff_t)ptr1;\n</code></pre>\n\n<p>That is legal and defined. Every pointer can be casted to an int value and <code>ptrdiff_t</code> is an int value, one that is guaranteed to big enough so that every pointer can fit into it (don't ever use <code>int</code> or <code>long</code> for that purpose, they do not make any such guarantee!). This code converts both pointers to integers and then subtract them. I still don't see anything useful you can do with <code>diff</code> now, but that code at least will deliver a defined result, yet maybe not the result you might be expecting.</p>\n"}], "owner": {"reputation": 338, "user_id": 4712324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WL3dX.jpg?s=128&g=1", "display_name": "fedemengo", "link": "https://stackoverflow.com/users/4712324/fedemengo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3725, "favorite_count": 2, "closed_date": 1479299827, "accepted_answer_id": 40631080, "answer_count": 7, "score": 4, "last_activity_date": 1479317802, "creation_date": 1479295927, "last_edit_date": 1479298790, "question_id": 40631057, "link": "https://stackoverflow.com/questions/40631057/subtraction-between-pointers-of-different-type", "closed_reason": "Duplicate", "title": "Subtraction between pointers of different type", "body": "<p>I'm trying to find the distance in memory between two variables. Specifically I need to find the distance between a char[] array and an int.</p>\n\n<pre><code>    char data[5];\n    int a = 0;\n\n    printf(\"%p\\n%p\\n\", &amp;data[5], &amp;a);\n\n    long int distance = &amp;a - &amp;data[5];\n\n    printf(\"%ld\\n\", distance);\n</code></pre>\n\n<p>When I run my my program without the last two lines I get the proper memory address of the two variables, something like this:</p>\n\n<pre><code>   0x7fff5661aac7\n   0x7fff5661aacc\n</code></pre>\n\n<p>Now I understand, if I'm not wrong, that there are 5 bytes of distance between the two (0x7fff5661aac8, 0x7fff5661aac9, 0x7fff5661aaca, 0x7fff5661aacb, 0x7fff5661aacc).</p>\n\n<p>Why I can't subtract a pointer of type (int *) and one of type (char *). Both refer to memory address.. What should I do in order to calculate the distance, in bytes, between the two?? I tried casting one of the two pointers but it's not working.</p>\n\n<p>I get: \"<em>error: 'char *' and 'int *' are not pointers to compatible types</em>\". Thanks to everyone will help me</p>\n"}, {"tags": ["c", "linux", "sockets", "tcp"], "comments": [{"owner": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "edited": false, "score": 0, "creation_date": 1479296496, "post_id": 40633552, "comment_id": 68499363, "body": "You do realize that 127.0.0.1 is not your LAN ip address or your WAN ip address right? It is the loopback address on your computer, every single computer has that IP address embedded in them and it is reserved for exactly that use so it can&#39;t be used as an ip address to advertise to its neighbours."}, {"owner": {"reputation": 25, "user_id": 4988632, "user_type": "registered", "profile_image": "https://graph.facebook.com/1401645060165482/picture?type=large", "display_name": "Kevin Zhu", "link": "https://stackoverflow.com/users/4988632/kevin-zhu"}, "reply_to_user": {"reputation": 482, "user_id": 1925992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b72aef1238e23c76d98f7cc5192f52?s=128&d=identicon&r=PG", "display_name": "ojs", "link": "https://stackoverflow.com/users/1925992/ojs"}, "edited": false, "score": 0, "creation_date": 1479297692, "post_id": 40633552, "comment_id": 68499364, "body": "This two programs is running in same PC,So use the loopback address! When they running in CentOS ,will get 0.0.0.0,;When they running in Ubnutu,they program one can get the program two IP is :127.0.0.1          That&#39;s my question:why and how to fix it?"}], "answers": [{"tags": [], "owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "is_accepted": true, "score": 4, "last_activity_date": 1479308027, "creation_date": 1479308027, "answer_id": 40635195, "question_id": 40633552, "link": "https://stackoverflow.com/questions/40633552/linux-c-programming-to-get-client-ip-always-get-0-0-0-0/40635195#40635195", "title": "Linux C programming to get Client IP always get 0.0.0.0", "body": "<p>The server misses to set <code>addr_len</code> to the size of <code>client_addr</code> before the call to <code>accept()</code>.</p>\n\n<p>To fix this add</p>\n\n<pre><code>addr_len = sizeof client_addr;\n</code></pre>\n\n<p>before calling <code>accept()</code>.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1479303304, "question_id": 323683}, "owner": {"reputation": 25, "user_id": 4988632, "user_type": "registered", "profile_image": "https://graph.facebook.com/1401645060165482/picture?type=large", "display_name": "Kevin Zhu", "link": "https://stackoverflow.com/users/4988632/kevin-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "accepted_answer_id": 40635195, "answer_count": 1, "score": 1, "last_activity_date": 1479308050, "creation_date": 1479295829, "last_edit_date": 1479308050, "question_id": 40633552, "link": "https://stackoverflow.com/questions/40633552/linux-c-programming-to-get-client-ip-always-get-0-0-0-0", "title": "Linux C programming to get Client IP always get 0.0.0.0", "body": "<p>When i try to get client IP,I always get 0.0.0.0 when program running in CentOS,But when the some code running in Ubuntu,It will get the right IP :127.0.0.1\nI don't understand that's why.</p>\n\n<p>Please pardon My English.</p>\n\n<p>Here is the code one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n #include &lt;arpa/inet.h&gt;\n//#include &lt;netinet/ip.h&gt; /* superset of previous */\n#define BUF_LEN 1024\n\n\nint main(int argc, char const *argv[])\n{\n    int sockfd=0;\n    int bind_ret=0;\n    int listen_ret=0;\n    int accept_ret=0;\n    int read_ret=0;\n    int write_ret=0;\n    socklen_t addr_len=0;\n\n    char buf[BUF_LEN+1]={0};\n\n    struct sockaddr_in client_addr;\n    struct sockaddr_in ser_addr ={\n                        .sin_family= AF_INET,/* address family: AF_INET */\n                        .sin_port=htons(8888),   /* port in network byte order */\n                        .sin_addr.s_addr=inet_addr(\"127.0.0.1\"),  /* internet address */\n                        };  \n//////////////////socket//////////////////////////////////\n    sockfd=socket(AF_INET ,SOCK_STREAM,0);\n    if (0&gt;sockfd){\n        perror(\"socket\");\n        return -1;\n    }\n////////////////////bind/////////////////////////////////\n    bind_ret=bind(sockfd, (const struct sockaddr *)&amp;ser_addr,sizeof(ser_addr));\n    if(0&gt;bind_ret){\n        perror(\"bind\");\n        return -1;\n    }\n//////////////////listen//////////////////////////////////\n    listen_ret=listen(sockfd,10);\n    if(0&gt;listen_ret){\n        perror(\"listen\");\n        return -1;\n    }\n//////////////////accept//////////////////////////////////\n    accept_ret=accept(sockfd,(struct sockaddr *)&amp;client_addr,&amp;addr_len);\n    if(0&gt;accept_ret){\n        perror(\"accept\");\n        return -1;\n    }\n//////////////////operation_data/////////////////////////////// \n    while(read_ret=read(accept_ret,buf,1024)){      //read data,until no data or error\n        if(read_ret&lt;0) {\n            perror(\"Socket read failed\");\n            return -5;\n        }\n\n        printf(\"receive:%s\\n\", buf);\n        write_ret=write(accept_ret,buf,read_ret);\n        if(write_ret!=read_ret){\n            perror(\"write\");\n            return -1;\n        }\n    }\n    //char *inet_ntoa(client_addr.sin_addr);\n    char * ip_add =inet_ntoa(client_addr.sin_addr);\n    int port=client_addr.sin_port;\n\n    printf(\"IP:%s  PORT:%d\\n\", ip_add,port);\n    close(client_addr);\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n\n<p>And code two:</p>\n\n<pre><code>  #include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;          /* See NOTES */\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n #include &lt;arpa/inet.h&gt;\n#define BUF_LEN 1024\n\nint main(int argc,char const **argv){\n    int sockfd=0;\n    int all_ret=0;\n    socklen_t addr_len=0;\n\n    char buf[BUF_LEN+1]={0};\n\n\n    struct sockaddr_in addr={\n                        .sin_family=AF_INET,/* address family: AF_INET */\n                        .sin_port=htons(8888),   /* port in network byte order */\n                        .sin_addr.s_addr=inet_addr(\"127.0.0.1\"), /* internet address */\n                        };\n    char * ip_add =inet_ntoa(addr.sin_addr);\n    printf(\"IP:%s \\n\", ip_add);\n//////////////////socket//////////////////////////////////\n    sockfd=socket(AF_INET ,SOCK_STREAM,0);\n    if (0&gt;sockfd){\n        perror(\"socket\");\n        return -1;\n    }\n//////////////////connection//////////////////////////////////\n    // int connect(int sockfd, const struct sockaddr *addr,socklen_t addrlen);\n    addr_len=sizeof(addr);\n    all_ret=connect(sockfd, (const struct sockaddr *)&amp;addr,addr_len);\n    if (0&gt;all_ret){\n        perror(\"connect\");\n        return -1;\n    }\n//////////////////data send//////////////////////////////////\n    all_ret=write(sockfd,\"test_by_kevin\",14);\n    if (0&gt;all_ret){\n        perror(\"write\");\n        return -1;\n    }\n    printf(\"write:%d\\n\",all_ret );\n//////////////////data receive//////////////////////////////////\n    all_ret=read(sockfd,buf,1024);\n    if(all_ret&lt;0){\n       perror(\"Socket read failed\");\n       return -1;\n    }\n    printf(\"%s\\n\",buf);\n\n    close(sockfd);\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "for-loop"], "comments": [{"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 3, "creation_date": 1479295520, "post_id": 40630910, "comment_id": 68494391, "body": "please keep <code>case &#39;m&#39;: case &#39;M&#39;:</code> in separate lines."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1479295716, "post_id": 40630910, "comment_id": 68494506, "body": "<code>switch (argc &gt; 1 &amp;&amp; argv[1][1]) {</code> should be <code>if(argc &gt; 1) switch (argv[1][1]) {</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479298919, "post_id": 40630910, "comment_id": 68496488, "body": "Please edit your question and show us an example of input and expected output."}, {"owner": {"reputation": 363, "user_id": 7076117, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/19f92f550f5ad535b38eac668d7b4e10?s=128&d=identicon&r=PG&f=1", "display_name": "zimek-atomek", "link": "https://stackoverflow.com/users/7076117/zimek-atomek"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479302456, "post_id": 40630910, "comment_id": 68498744, "body": "@MichaelWalz Maybe something like this."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479303468, "post_id": 40630910, "comment_id": 68499431, "body": "@zimek-atomek and what output do you expect ?"}], "answers": [{"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1480149963, "last_edit_date": 1480149963, "creation_date": 1480149399, "answer_id": 40816503, "question_id": 40630910, "link": "https://stackoverflow.com/questions/40630910/setting-number-of-looping/40816503#40816503", "title": "Setting number of looping", "body": "<p>From looking at how you have the problem setup, it looks like you are confusing iterating over the character that are part of the input, and the array that holds the frequency of the characters read.</p>\n\n<p>For starters, to make your code readable, don't use magic numbers in your code, e.g. <code>32</code> and <code>126</code>. Instead use the characters you are attempting to represent, e.g. <code></code> (<em>space</em>) and <code>~</code> (<em>tilde</em>). For example, instead of using:</p>\n\n<pre><code>for(j=32; j&lt;126; j++){\n</code></pre>\n\n<p>you could use:</p>\n\n<pre><code>for(j = ' '; j &lt; '~'; j++){\n</code></pre>\n\n<p>That too has it's pitfalls. Why? You don't want to loop over characters, you actually want to loop over the elements in your <code>count</code> array that hold the frequency each character occurs in input. In other words, you need an array holding at minimum <code>95</code> integers which will hold the frequency each character occurs in your input. Since you know how may characters that will be, don't obscure it behind <code>32</code> to <code>126</code>, just declare a constant for your array size (maybe called <code>ARSZ</code>) in <code>tools.h</code>, e.g.</p>\n\n<pre><code>#define ARSZ 95\n</code></pre>\n\n<p>Then after reading your input and filling the <code>count</code> array, it is just a matter of iterating over the <code>count</code> array once to get either the <code>mostoften</code> or <code>leastoften</code> number. Further, since you have a constant for the number of elements in <code>count</code> you do NOT need to pass the size of <code>count</code> to <code>mostoften</code> and <code>leastoften</code> -- you already know how many elements are present, <code>95</code>. (see below for notes on iterating only over the characters present in input)</p>\n\n<p>(if the array size is Not constant (and you are not passing an array with a sentinel like a <em>nul-terminated</em> string) or the number of elements you need to iterate over is not known at compile time, then you DO need to pass the size of the array to the functions.</p>\n\n<p>(and another quick aside, C generally uses all lower-case for variable names, reserving all upper-case for constants and macros. You will not ordinarily see <em>MixedCase</em> or <em>camelCase</em> variable names in C, leave that for C++)</p>\n\n<p>Next, while you should use <code>getopt</code> for processing command line arguments, you can use a quick hack of checking the second character of the arguments at issue, but you need to validate you have at least one argument to check and that the argument isn't an <em>empty-string</em>. Basically, you want to check:</p>\n\n<pre><code>if (argc &gt; 1 &amp;&amp; *argv[1])  /* check argc &amp; not empty-string */\n    switch (argv[1][1]) {\n        case 'm':\n            mostoften (count);\n            break;\n        case 'M':\n            mostoften (count);\n            break;\n        case 'l':\n            leastoften (count);\n            break;\n        case 'L':\n            leastoften (count);\n            break;\n        default:\n            fprintf (stderr, \"warning: unrecognized option, using 'mostoften'.\\n\");\n            mostoften (count);\n    }\nelse {\n    fprintf (stderr, \"warning: no option given using 'mostoften'.\\n\");\n    mostoften (count);\n}\n</code></pre>\n\n<p><em>note</em>: you can't put two constant conditions together for any single case of your <code>switch</code> (some compilers provide non-standard extensions). Also note, you do not need a <code>break</code> in the <code>default</code> case, there is no fall-through possible.</p>\n\n<p>Putting it altogether, you could write your <code>tools.h</code> similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\n#define ARSZ 95\n\nint mostoften (int *a);\nint leastoften (int *a);\n</code></pre>\n\n<p>Your <code>tools.c</code> as:</p>\n\n<pre><code>#include \"tools.h\"\n\nint mostoften (int *a) {\n\n    int i, max = INT_MIN, cha = '0';\n\n    for (i = 0; i &lt; ARSZ; i++)\n        if (a[i] &gt; max) {\n            max = a[i];\n            cha = i + ' ';\n        }\n\n    printf (\"char '%c' : %d times\\n\", cha, max);\n\n    return max;\n}\n\nint leastoften (int *a) {\n\n    int i, min = INT_MAX, cha = '0';\n\n    for (i = 0; i &lt; ARSZ; i++)\n        if (a[i] &lt; min) {\n            min = a[i];\n            cha = i + ' ';\n        }\n\n    printf (\"char '%c' : %d times\\n\", cha, min);\n\n    return min;\n}\n</code></pre>\n\n<p>You do know that if the <code>max</code> or <code>min</code> is the same for 2 different characters, you will select the first, and in the case of <code>leastoften</code> you will always select the first character with <code>0</code> frequency. To correct this problem, you will need to keep a second array (or 2D array, or struct) that tracks which characters were present in the input and only consider the frequency for those characters.</p>\n\n<p>Finally, your <code>main.c</code> could be written something like:</p>\n\n<pre><code>#include \"tools.h\"\n\nint main (int argc, char **argv) {\n\n    int c = 0, count[ARSZ] = {0};\n\n    while ((c = getchar ()) != EOF)\n        if (' ' &lt;= c &amp;&amp; c &lt;= '~')\n            count[c - ' ']++;\n\n    if (argc &gt; 1 &amp;&amp; *argv[1])  /* check argc &amp; not empty-string */\n        switch (argv[1][1]) {\n            case 'm':\n                mostoften (count);\n                break;\n            case 'M':\n                mostoften (count);\n                break;\n            case 'l':\n                leastoften (count);\n                break;\n            case 'L':\n                leastoften (count);\n                break;\n            default:\n                fprintf (stderr, \"warning: unrecognized option, using \"\n                                 \"'mostoften'.\\n\");\n                mostoften (count);\n        }\n    else {\n        fprintf (stderr, \"warning: no option given using 'mostoften'.\\n\");\n        mostoften (count);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>There are many different ways to accomplish this task, but given your initial code, this keeps with what appeared to be your intent. Look it over and let me know if you have any questions. If you want the easiest way to track the characters present in your input without using a struct, then simply declaring <code>count</code> as <code>count[ARSZ][2]</code> and using the additional element to indicate which characters were present would do. (you can pass the array to your functions as <code>int a[][2]</code> or <code>int (*a)[2]</code>) Good luck.</p>\n"}], "owner": {"reputation": 363, "user_id": 7076117, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/19f92f550f5ad535b38eac668d7b4e10?s=128&d=identicon&r=PG&f=1", "display_name": "zimek-atomek", "link": "https://stackoverflow.com/users/7076117/zimek-atomek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480210720, "creation_date": 1479295436, "last_edit_date": 1479302416, "question_id": 40630910, "link": "https://stackoverflow.com/questions/40630910/setting-number-of-looping", "title": "Setting number of looping", "body": "<p>I have problem. I need functions in <strong>tool.c</strong> file to loop only number of times that are required. Like it stops after looping thru whole input. My teacher said I should pass second argument, but class finished and I don't know how it should look.</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"tools.h\"\n\nint main(int argc, char *argv[]) {\n    int count[256] = { 0 };\n    int c;\n    while ( (c=getchar())!=EOF ){\n        count[c]++;\n    }\n    switch (argc &gt; 1 &amp;&amp; argv[1][1]) {\n    case 'm': case 'M':\n        mostOften(count);\n        break;\n    case 'l': case 'L':\n        leastOften(count);\n        break;\n    default:\n        mostOften(count);\n        break;\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>tools.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n#include \"tools.h\"\n\nvoid mostOften(int *s) {\n    int j, a = 0;\n    int max=0, cha;\n    for(j=32; j&lt;126; j++){\n        if(s[j]&gt;max) {\n                max=s[j];\n                cha=j;\n        }\n    a++;\n    }\n    printf(\"char %c: %d times\\n\", cha, max);\n}\n\nvoid leastOften(int *s) {\n    int j, a = 0;\n    int min=INT_MAX, cha;\n    for(j=32; j&lt;126; j++){\n        if(s[j] &amp;&amp; s[j]&lt;=min) {\n                min=s[j];\n                cha=j;\n        }\n    a++;\n    }\n    printf(\"char %c: %d times\\n\", cha, min);\n}\n</code></pre>\n\n<p>For example if I input </p>\n\n<blockquote>\n  <p>paragraph</p>\n</blockquote>\n\n<p>I want it to loop only 9 times, basically I need to set some if statment to stop looping   </p>\n"}, {"tags": ["c", "windows", "batch-file"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6811411"}, "edited": false, "score": 0, "creation_date": 1479301529, "post_id": 40630852, "comment_id": 68498155, "body": "This doesn&#39;t sound like a batch related question. Include this line to your batch to show args <code>Echo Args:%* &amp; Pause</code> to see if there are any args. Otherwise it&#39;s C/c++/whatever related. &#39;"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1479336264, "post_id": 40630852, "comment_id": 68519452, "body": "The command line is passed via the lpCommandLine parameter.  Just concatenate the arguments separated by spaces into the string you pass for that parameter.  It&#39;s unclear if that&#39;s the issue or if you don&#39;t know how to handle parameters in the batch file itself which is a very different question.  You should clarify.  This may help: <a href=\"http://stackoverflow.com/questions/25919451/use-createprocess-to-run-a-batch-file\" title=\"use createprocess to run a batch file\">stackoverflow.com/questions/25919451/&hellip;</a>"}, {"owner": {"reputation": 81, "user_id": 6795671, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/cf2ee5f75853b3ca6db442e7a2e57bf4?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/6795671/rrr"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1479369072, "post_id": 40630852, "comment_id": 68529997, "body": "But in lpCommandLine parameter can i pass a set of strings as parameters. For example, &quot;abc=20 xyz=10&quot; and &quot;def=5 ggg=15&quot; are two arguments to be passed. My question is does having spaces (&quot; &quot;) within the strings will be a problem and  how do i pass them as two separate arguments? @RetiredNinja"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1479390128, "post_id": 40630852, "comment_id": 68543873, "body": "If you have spaces in your arguments you need to enclose them in quotes.  It&#39;s not a bad idea to just do that for all arguments just in case."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6795671, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/cf2ee5f75853b3ca6db442e7a2e57bf4?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/6795671/rrr"}, "edited": false, "score": 0, "creation_date": 1479381056, "post_id": 40643581, "comment_id": 68537871, "body": "I wanted to know how to pass arguments while using createProcess()"}], "tags": [], "owner": {"reputation": 191, "user_id": 7169640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fa5e42bf9b12d75965433ca5402118?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/7169640/marcus"}, "is_accepted": false, "score": 0, "last_activity_date": 1479335641, "creation_date": 1479335641, "answer_id": 40643581, "question_id": 40630852, "link": "https://stackoverflow.com/questions/40630852/how-to-provide-arguments-to-a-batch-file-which-is-called-by-a-process-created-by/40643581#40643581", "title": "How to provide arguments to a batch file which is called by a process created by createProcess() function?", "body": "<p>Could you use _spawnlp instead:</p>\n\n<pre><code>if (_spawnlp(_P_WAIT,\"C:\\\\myfile.bat\",\"myfile.bat\",\"arg1-as-text\",\"arg2-as-text\",NULL) != 0)\n    {\n    reportError(\"Error running myfile.bat\");\n    }\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6795671, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/cf2ee5f75853b3ca6db442e7a2e57bf4?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/6795671/rrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479381168, "creation_date": 1479295248, "last_edit_date": 1479381168, "question_id": 40630852, "link": "https://stackoverflow.com/questions/40630852/how-to-provide-arguments-to-a-batch-file-which-is-called-by-a-process-created-by", "title": "How to provide arguments to a batch file which is called by a process created by createProcess() function?", "body": "<p>Assume that the batch file is executed by the process created by the createProcess() function. The path of the file is given as the first argument to the createProcess() function. How can i pass arguments to this batch file?</p>\n\n<p>Does using lpCommandLine parameter to pass arguments result in any problem if the parameters are strings which contain spaces within them? \nFor example, \"abc=20 xyz=10\" and \"def=5 ggg=15\" are two arguments to be passed. My question is does having spaces (\" \") within the string will be a problem and how do i pass them as two separate arguments?</p>\n"}, {"tags": ["c++", "c", "multithreading", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 1566, "user_id": 4847311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fbb34e156577e5c3a5b3b3d1b30f83?s=128&d=identicon&r=PG", "display_name": "Sven Nilsson", "link": "https://stackoverflow.com/users/4847311/sven-nilsson"}, "edited": false, "score": 0, "creation_date": 1479296160, "post_id": 40630833, "comment_id": 68494758, "body": "printf can slow it down very much if you print lots of data. Remove the printf and instead increment a counter to count the number of items that would have been printed. Then print value of the counter after the loops finished. Does this make it faster?"}, {"owner": {"reputation": 925, "user_id": 6478256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BNq9q.jpg?s=128&g=1", "display_name": "ilotXXI", "link": "https://stackoverflow.com/users/6478256/ilotxxi"}, "edited": false, "score": 0, "creation_date": 1479296178, "post_id": 40630833, "comment_id": 68494764, "body": "How do you measure the time? Does it include the input time?"}], "owner": {"reputation": 45, "user_id": 6298516, "user_type": "registered", "profile_image": "https://graph.facebook.com/945421782242224/picture?type=large", "display_name": "Makoto Daiwa Ambara", "link": "https://stackoverflow.com/users/6298516/makoto-daiwa-ambara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479295479, "creation_date": 1479295190, "last_edit_date": 1479295479, "question_id": 40630833, "link": "https://stackoverflow.com/questions/40630833/openmp-multithread-parallel-programming", "title": "OpenMP Multithread Parallel Programming", "body": "<p>My parallel program have same time compared to serial program and I don't know why (both 7.3s for small data 43s for big data, so there is no acceleration). But I guess it caused of printf? But my teacher ask me keep to use printf.\nAnd 1 more, is there a way to parallel the input procedure? Because it also takes much time. (With some trick like delete the number after read, etc xD)</p>\n\n<pre><code>void input(int ***a, int set){\n int i,j;\n FILE *f;\nswitch(set){\n    case 1: f = fopen(\"dataset1.txt\",\"r\");break;\n    case 2: f = fopen(\"dataset2.txt\",\"r\");break;\n    case 3: f = fopen(\"dataset3.txt\",\"r\");break;\n    case 4: f = fopen(\"dataset4.txt\",\"r\");break;\n    case 5: f = fopen(\"dataset5.txt\",\"r\");break;\n    case 6: f = fopen(\"dataset6.txt\",\"r\");break;\n    case 7: f = fopen(\"dataset7.txt\",\"r\");break;\n    case 8: f = fopen(\"dataset8.txt\",\"r\");break;\n    case 9: f = fopen(\"dataset9.txt\",\"r\");break;\n    case 10: f = fopen(\"dataset10.txt\",\"r\");break;\n}\nfor(i=0;i&lt;s;i++)\n    for(j=0;j&lt;s;j++)\n        fscanf(f,\"%d \",&amp;(*a)[i][j]);\nfclose(f);\n}\n\nserial code:\n    void rangeCheck(int **a){\n      int i,j;\n      for(i=0;i&lt;s;i++)\n        for(j=0;j&lt;s;j++)\n         if(a[i][j]&gt;=min &amp;&amp; a[i][j]&lt;=max)\n           printf(\"(%d,%d) \",i,j);\n    }\n\nparallel code:\n    void rangeCheck(const int **a){\n      int i,chunk,id,p=4;\n      chunk = (s%p==0) ? s/p : s/p+1;\n      #pragma omp parallel private(i,id)\n      {\n        id = omp_get_thread_num();\n        #pragma omp for schedule (static,chunk)\n          for(i=0;i&lt;s;i++){\n            int j;\n            for(j=0;j&lt;s;j++)\n              if(a[i][j]&gt;=min &amp;&amp; a[i][j]&lt;=max)\n                printf(\"(%d,%d) \",i,j);\n          }\n      }\n}\n</code></pre>\n"}, {"tags": ["android", "c++", "c", "string"], "comments": [{"owner": {"reputation": 5455, "user_id": 4115625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2688a9684db617a20f9da3959e5890d7?s=128&d=identicon&r=PG&f=1", "display_name": "Danh", "link": "https://stackoverflow.com/users/4115625/danh"}, "edited": false, "score": 1, "creation_date": 1479295041, "post_id": 40630688, "comment_id": 68494105, "body": "<code>.text</code> is used for code"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1479295045, "post_id": 40630688, "comment_id": 68494107, "body": "What compiler are you using? Is this C code or C++ code? What optimization settings are you using?"}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479295527, "post_id": 40630688, "comment_id": 68494395, "body": "It is C++, flags are nothing really special. Just -Os. Compiler is clang 4.9 if I remember correctly (ndk r13b)"}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1479296119, "post_id": 40630688, "comment_id": 68494728, "body": "GCC should always have string pooling enabled if you do not have the -fwritable-strings flag set. Make sure that clang has string pooling enabled by default."}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479297279, "post_id": 40630688, "comment_id": 68495482, "body": "I used and online tool with GCC, and I got same results. Ill investigate the flags you told me."}], "answers": [{"comments": [{"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479296738, "post_id": 40631204, "comment_id": 68495117, "body": "I understand, but my real code has longer string, I did the math that I should save around 1kB of strings, the strange thing is that the size is EXACTLY the same. I did an online example with same results."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "reply_to_user": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 1, "creation_date": 1479298684, "post_id": 40631204, "comment_id": 68496357, "body": "Remember that the executable size is quite likely to be a round number of pages.  I don&#39;t know how big a &quot;page&quot; is in this context, but 4k is quite possible."}], "tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1479296362, "creation_date": 1479296362, "answer_id": 40631204, "question_id": 40630688, "link": "https://stackoverflow.com/questions/40630688/strange-behaviour-of-const-char-storage-in-libraries-so-files/40631204#40631204", "title": "Strange behaviour of `const char *` storage in libraries .so files", "body": "<p>You are only saving 19 bytes per string, but at the cost of passing an additional argument to what looks like a varargs function.  At a minimum that is a load address and a push.</p>\n\n<p>Let me guess, <code>ALOGE</code> is actually a macro?</p>\n\n<p>I don't think you need a DEFINE - you need a function (<em>not</em> inline) like:</p>\n\n<pre><code>void BadParameter(const char * paramName)\n{\n    ALOGE(\"Error in parameter %s\", paramName);\n}\n</code></pre>\n\n<p>... and replace all the calls with that.</p>\n"}, {"comments": [{"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479302656, "post_id": 40632081, "comment_id": 68498877, "body": "Oh thank you now I understand! Aparently, there is a magic 4k size bloat in the cases (4096 exactly), so maybe that is the reason. If you don&#39;t manage to reduce the code size a full page, the compiler still allocates the page in <code>.rodata</code> filed in with 0 even if the page only holds a byte. So I should either reduce further my strings, or don&#39;t do anything at all. Tomorrow I&#39;ll check with the proper code to see the amount of pages of .rodata."}, {"owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479349789, "post_id": 40632081, "comment_id": 68523360, "body": "Indeed I was using 0x66f8 in my <code>.rodata</code>. With my optimizations, 0x60f0. But since pages are 0x1000 in size, I did not see the size drop at all. But it is good to know that these optimizations are possible!"}, {"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "edited": false, "score": 0, "creation_date": 1479371211, "post_id": 40632081, "comment_id": 68531199, "body": "@DarkZeros Nevertheless - it works, and, probably, may be helpful in the future along with some other tricks or optimizations."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 2, "last_activity_date": 1479300018, "last_edit_date": 1479300018, "creation_date": 1479298915, "answer_id": 40632081, "question_id": 40630688, "link": "https://stackoverflow.com/questions/40630688/strange-behaviour-of-const-char-storage-in-libraries-so-files/40632081#40632081", "title": "Strange behaviour of `const char *` storage in libraries .so files", "body": "<p>All your expectations are fairly correct, but test cases are not sufficient to demonstrate the effect. First of all binary executable files have a notion of a \"segment/section alignment\" (or something like this). In brief it means that first bytes of different sections can be placed only at file offsets that are a multiples of some value (e.g. decimal <code>512</code>). Unused space between sections is filled with zeros to meet this requirement. And all data that were provided by your test cases don't exhaust that padding and as result you can not feel real difference. Next - if you want to compare effect more clearly - you shouldn't link against startup code, i.e. you should build dynamic library with minimal number of references instead of regular executable.</p>\n\n<p>Next, my test program. It differs a bit from your one. But not so conceptually.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#if defined(_SPLIT)\n#define LOG(str) printf(\"Very very very loooo-o-o-o-o-o-o-ooooong prefix %s\", str )\n#elif defined(_NO_SPLIT)\n#define LOG(str) printf(\"Very very very loooo-o-o-o-o-o-o-ooooong prefix \" str )\n#else\n#error \"Don't know what you want.\"\n#endif\n\nint foo(void) {\n    LOG(\"aaaaaaaa\");\n    LOG(\"bbbbbbbb\");\n    LOG(\"cccccccc\");\n    LOG(\"dddddddd\");\n    LOG(\"eeeeeeee\");\n    LOG(\"ffffffff\");\n    LOG(\"gggggggg\");\n    LOG(\"hhhhhhhh\");\n    LOG(\"iiiiiiii\");\n    LOG(\"jjjjjjjj\");\n    LOG(\"kkkkkkkk\");\n    LOG(\"llllllll\");\n    LOG(\"mmmmmmmm\");\n    LOG(\"nnnnnnnn\");\n    LOG(\"oooooooo\");\n    LOG(\"pppppppp\");\n    LOG(\"qqqqqqqq\");\n    LOG(\"rrrrrrrr\");\n    LOG(\"ssssssss\");\n    LOG(\"tttttttt\");\n    LOG(\"uuuuuuuu\");\n    LOG(\"vvvvvvvv\");\n    LOG(\"wwwwwwww\");\n    LOG(\"xxxxxxxx\");\n    LOG(\"yyyyyyyy\");\n    LOG(\"zzzzzzzz\");\n    return 0;\n}\n</code></pre>\n\n<p>Then, lets create dynamic libraries:</p>\n\n<pre><code>$ gcc --shared -fPIC -o t_no_split.so -D_NO_SPLIT test.c\n$ gcc --shared -fPIC -o t_split.so -D_SPLIT test.c\n</code></pre>\n\n<p>And compare sizes:</p>\n\n<pre><code>-rwxr-xr-x  1 sysuser sysuser   12098 Nov 16 14:19 t_no_split.so\n-rwxr-xr-x  1 sysuser sysuser    8002 Nov 16 14:19 t_split.so\n</code></pre>\n\n<p>IMO, there is really notable difference. And, being honest, I've not checked per-section sizes, but anyway you can do it by yourself.</p>\n\n<p>Of course it doesn't mean that not splitted string use <code>12098 - 8002</code> bytes more than splitted ones. It just means that compiler / linker is obliged to use more space for <code>t_no_split.so</code> than for <code>t_split.so</code>. And this bloating is definitely caused by the difference in string sizes. Another interesting thing - splits even neutralize small bloating of machine code caused by passing a second argument to <code>printf()</code>.</p>\n\n<p>P.S. My machine is x64 Linux, GCC 4.8.4.</p>\n"}], "owner": {"reputation": 7967, "user_id": 741692, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1300d6b45404082362f2d0f05de23640?s=128&d=identicon&r=PG&f=1", "display_name": "DarkZeros", "link": "https://stackoverflow.com/users/741692/darkzeros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 40632081, "answer_count": 2, "score": 1, "last_activity_date": 1479300018, "creation_date": 1479294772, "last_edit_date": 1479297210, "question_id": 40630688, "link": "https://stackoverflow.com/questions/40630688/strange-behaviour-of-const-char-storage-in-libraries-so-files", "title": "Strange behaviour of `const char *` storage in libraries .so files", "body": "<p>I have a library that I use in Android, though I am quite sure the problem is not specific to Android.\nThis library contains a bunch of error codes I print to logcat, and all of them consist of a constant string.</p>\n\n<pre><code>...\nif(...){ALOGE(\"Error in parameter XXXXXX\");}\nif(...){ALOGE(\"Error in parameter YYYYYY\");}\nif(...){ALOGE(\"Error in parameter ZZZZZZ\");}\n...\n</code></pre>\n\n<p>Today I noticed I have a big amount of data in my .rodata section (around 16kB). So I run a <code>strings mylib.so</code> and I got a bunch of those strings.</p>\n\n<pre><code>Error in parameter XXXXXX\nError in parameter YYYYYY\nError in parameter ZZZZZZ\n</code></pre>\n\n<p>I though, that with a small extra cost of printing (which should be fine, since these codes are rarely used), I could save a lot in space if I split the string in 2 parts. Then the compiler should do the job and group in a single string the common part. Since the compiler have a duplicated string removal optimization step (CLANG and GCC).</p>\n\n<p>I did it this way: (I have MANY of these, but they all have a pattern like this, I know I should use a define (but this was a quick test))</p>\n\n<pre><code>...\nif(...){ALOGE(\"Error in parameter %s\",\"XXXXXX\");}\nif(...){ALOGE(\"Error in parameter %s\",\"YYYYYY\");}\nif(...){ALOGE(\"Error in parameter %s\",\"ZZZZZZ\");}\n...\n</code></pre>\n\n<p>What I found is that:</p>\n\n<ol>\n<li>The library is EXACTLY the same size. <code>.rodata</code> is now much smaller, but <code>.text</code> increased by almost the same amount. (a few bytes difference only)</li>\n<li><code>strings</code> command prints now 1 time only the <code>\"Error in parameter %s\"</code> string, and the separated parts. So there is no string merging taking place.</li>\n<li>Does not seem to matter if I Compile in 32bits, 64bits, etc..</li>\n</ol>\n\n<p>So, what is going on here? How can I fix? Any guidance? What is the compiler doing?\nThanks</p>\n\n<p><strong>Extra data:</strong></p>\n\n<ul>\n<li>Compiler CLANG 4.9 (4.8 does same result).  </li>\n<li>Flags: -Os -fexceptions\n-std=c++11 -fvisivility=hidden</li>\n</ul>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I created an online example test using GCC same results <a href=\"http://www.tutorialspoint.com/compile_c_online.php?PID=0Bw_CjBb95KQMaVJiMnBxMU40SXM\" rel=\"nofollow noreferrer\">Online GCC</a></p>\n\n<p>Split:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int a = rand()%7;\n    switch(a){\n        case 0: printf(\"Hello, %s!\\n\",\"Anna\"); break;\n        case 1: printf(\"Hello, %s!\\n\",\"Bob\"); break;\n        case 2: printf(\"Hello, %s!\\n\",\"Clark\"); break;\n        case 3: printf(\"Hello, %s!\\n\",\"Danniel\"); break;\n        case 4: printf(\"Hello, %s!\\n\",\"Edison\"); break;\n        case 5: printf(\"Hello, %s!\\n\",\"Foo\"); break;\n        case 6: printf(\"Hello, %s!\\n\",\"Garret\"); break;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>NonSplit:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int a = rand()%7;\n    switch(a){\n        case 0: printf(\"Hello, Anna!\\n\"); break;\n        case 1: printf(\"Hello, Bob!\\n\"); break;\n        case 2: printf(\"Hello, Clark!\\n\"); break;\n        case 3: printf(\"Hello, Danniel!\\n\"); break;\n        case 4: printf(\"Hello, Edison!\\n\"); break;\n        case 5: printf(\"Hello, Foo!\\n\"); break;\n        case 6: printf(\"Hello, Garret!\\n\"); break;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc -Os -o main main.c\ngcc -Os -o main2 main2.c\n</code></pre>\n\n<p>Sizes:</p>\n\n<pre><code>-rwxr-xr-x 1 20446 20446 8560 Nov 16 11:43 main                     \n-rw-r--r-- 1 20446 20446  478 Nov 16 11:41 main.c \n-rwxr-xr-x 1 20446 20446 8560 Nov 16 11:42 main2   \n-rw-r--r-- 1 20446 20446  443 Nov 16 11:39 main2.c\n</code></pre>\n\n<p>Strings:</p>\n\n<pre><code>    strings main2 | grep \"Hello\"                                  \nHello, Anna!                                                          \nHello, Bob!                                                          \nHello, Clark!                                                         \nHello, Danniel!                                                       \nHello, Edison!                                                       \nHello, Foo!                                                         \nHello, Garret!\n\n    strings main | grep \"Hello\"                                  \nHello, %s!                                                          \n</code></pre>\n"}, {"tags": ["c++", "c", "qt", "dll"], "comments": [{"owner": {"reputation": 1243, "user_id": 1129815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lROzF.jpg?s=128&g=1", "display_name": "Steeve", "link": "https://stackoverflow.com/users/1129815/steeve"}, "edited": false, "score": 0, "creation_date": 1479304313, "post_id": 40630323, "comment_id": 68500028, "body": "Too little information, you will need to show us the code where you are loading &amp; using this dll."}, {"owner": {"reputation": 1, "user_id": 6333767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619ed4f9a7d09b8c3dd8ab07077d9bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Kamui", "link": "https://stackoverflow.com/users/6333767/kamui"}, "reply_to_user": {"reputation": 1243, "user_id": 1129815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lROzF.jpg?s=128&g=1", "display_name": "Steeve", "link": "https://stackoverflow.com/users/1129815/steeve"}, "edited": false, "score": 0, "creation_date": 1479376724, "post_id": 40630323, "comment_id": 68534836, "body": "Added the usage of the dll"}], "owner": {"reputation": 1, "user_id": 6333767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619ed4f9a7d09b8c3dd8ab07077d9bc6?s=128&d=identicon&r=PG&f=1", "display_name": "Kamui", "link": "https://stackoverflow.com/users/6333767/kamui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479376683, "creation_date": 1479293701, "last_edit_date": 1495540417, "question_id": 40630323, "link": "https://stackoverflow.com/questions/40630323/translating-a-qt-api-into-a-plain-c-dll-for-labview", "title": "Translating a Qt API into a Plain C DLL for LabView", "body": "<p>I want to write a plain C DLL to connect to a SOAP server to read/write data there. (Needs to be plain C because this DLL will be used in LabView)</p>\n\n<p>I have to use an API, which is written in Qt. This API provides all sorts of methods to establish said connection. So all I got to do is basically translate the APIs functionality into C.</p>\n\n<p>I tried to do this like this:</p>\n\n<p><em>in the header file</em></p>\n\n<pre><code>typedef void* plainc_testlistwrapper;\n#ifdef __cplusplus\nextern \"C\"{\n#endif\n__declspec(dllexport) plainc_testlistwrapper testlistwrapper_init(const char* srv);\n__declspec(dllexport) void testlistwrapper_destroy(plainc_testlistwrapper tlw);\n__declspec(dllexport) const char *testlistwrapper_get_admin(plainc_testlistwrapper self);\n\n#ifdef __cplusplus\n}\n#endif // EXTERN C\n</code></pre>\n\n<p><em>in the cpp file</em></p>\n\n<pre><code>__declspec(dllexport) plainc_testlistwrapper testlistwrapper_init(const char* srv)\n{\n    return new TestListWrapper(TestListWrapper::SoapSecure, QString::fromUtf8(srv));\n}\n\n__declspec(dllexport) void testlistwrapper_destroy(plainc_testlistwrapper tlw)\n{\n    TestListWrapper* toDelete = static_cast&lt;TestListWrapper*&gt;(tlw);\n    delete toDelete;\n}\n\n\n//This function will give back the servers admin without the need to be logged in.\n__declspec(dllexport) const char* testlistwrapper_get_admin(plainc_testlistwrapper self)\n{\n    TestListWrapper* tmp = static_cast&lt;TestListWrapper*&gt;(self);\n    return tmp-&gt;serverAdministrator().toStdString().c_str();\n}\n</code></pre>\n\n<p><strong>as seen here:</strong> <a href=\"https://stackoverflow.com/questions/2744181/how-to-call-c-function-from-c#2744206\">How to call C++ function from C</a></p>\n\n<p><strong>Problem that made me ask here</strong></p>\n\n<p>Compiling this code into a DLL works just fine (mingw_4.9.2 32bit , Qt 5.6.1)\nBut when I'm trying to use some of the code in another application (Qt console application to be more specific), I just get a black terminal with the _ symbol blinking. When i try to debug the code nothing happens and the debugger just says the application is running.</p>\n\n<p>I hope I didn't forgot to mention anything important.</p>\n\n<p>Thanks in advance for your answers!</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I included the library as following</p>\n\n<pre><code>INCLUDEPATH += C:/Path/to/Lib/PlainCLib\nLIBS += -LC:/Path/to/Lib/PlainCLib/debug -lPlainCLib\n</code></pre>\n\n<p>In the <strong>main.cpp</strong> i simply did</p>\n\n<pre><code>#include \"plainclib.h\"\n</code></pre>\n\n<p>When I then add <strong>any</strong> kind of method from the lib, the idle terminal appears. I emphasize any because I added an add-method just to be sure its not the implemented API which looks like this:</p>\n\n<pre><code>__declspec(dllexport) int add(int a, int b){return a+b;}\n</code></pre>\n\n<p>I called the add method like this:</p>\n\n<pre><code>std::cout &lt;&lt; add(5, 7) &lt;&lt; std::endl;\n</code></pre>\n\n<p><strong>Note:</strong> The inclusion of the API, which needs to be translated, is correct as I used this API in other projects successfully.</p>\n"}, {"tags": ["c", "embedded", "compound-assignment"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1479293491, "post_id": 40630169, "comment_id": 68493097, "body": "The code you show and link to is for an embedded system. Setting and clearing bits might make different things happen in the hardware. So it&#39;s possible it is split up that way to trigger different hardware events."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479293577, "post_id": 40630169, "comment_id": 68493153, "body": "Also, in C++ you have to consider things like operator overloading."}, {"owner": {"reputation": 27011, "user_id": 1490355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/296f0478cb1b6724e3f862ace601fa99?s=128&d=identicon&r=PG", "display_name": "SingerOfTheFall", "link": "https://stackoverflow.com/users/1490355/singerofthefall"}, "edited": false, "score": 2, "creation_date": 1479293582, "post_id": 40630169, "comment_id": 68493160, "body": "<code>IER</code> in your example is a processor register, so it may be used at each cycle. Maybe this is the reason."}, {"owner": {"reputation": 7082, "user_id": 98636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e73eaf09b8cb5de02dc2077f7ab0259?s=128&d=identicon&r=PG", "display_name": "Elemental", "link": "https://stackoverflow.com/users/98636/elemental"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479293671, "post_id": 40630169, "comment_id": 68493225, "body": "@Someprogrammerdude - you should write that comment as an answer; it is correct, valid and generally useful to others who may be confused by the same examples"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479294105, "post_id": 40630169, "comment_id": 68493505, "body": "That close vote for &quot;primarily opinion-based&quot; reason is not valid."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479294125, "post_id": 40630169, "comment_id": 68493522, "body": "You could provide some context otherwise this seems like a too broad question."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1479294214, "post_id": 40630169, "comment_id": 68493580, "body": "@2501 I think the link with the excerpt of the code is enough for the context."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1479294325, "post_id": 40630169, "comment_id": 68493649, "body": "@AndrejsCainikovs OP should explain that he/she is interested in that particular architecture. As the question and the tags stand, it appears that the question is about C and/or C++ in general, and the link serves only as a code source."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1479294373, "post_id": 40630169, "comment_id": 68493681, "body": "@2501 Well yes, I totally agree on this."}, {"owner": {"reputation": 503, "user_id": 5329451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef87290065ac1f837f8a145801ed89a5?s=128&d=identicon&r=PG&f=1", "display_name": "JJM Driessen", "link": "https://stackoverflow.com/users/5329451/jjm-driessen"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479294475, "post_id": 40630169, "comment_id": 68493753, "body": "@Some programmer dude. Thanks. I did not consider that the fact I&#39;m dealing with embedded systems is relevant. I will consider it part of the answer. The other part would then be related to distinguishing between variables and registers, I suppose?"}, {"owner": {"reputation": 503, "user_id": 5329451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef87290065ac1f837f8a145801ed89a5?s=128&d=identicon&r=PG&f=1", "display_name": "JJM Driessen", "link": "https://stackoverflow.com/users/5329451/jjm-driessen"}, "edited": false, "score": 0, "creation_date": 1479295859, "post_id": 40630169, "comment_id": 68494587, "body": "Can those that vote for &quot;primarily opinion based&quot; elucidate their vote such that I can improve my question? It will be appreciated."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1479303550, "post_id": 40630169, "comment_id": 68499495, "body": "@JJMDriessen I have updated my answer with <i>distinguishing between variables and registers</i> part."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479323340, "post_id": 40630169, "comment_id": 68512702, "body": "There is no &quot;embedded C&quot;. And please don&#39;t add redundant information in the title, that&#39;s what the tags are for."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479324177, "post_id": 40630169, "comment_id": 68513180, "body": "There is no guarantee the single assignment (resp. any other expression) will be atomic either."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479335961, "post_id": 40630169, "comment_id": 68519338, "body": "<code>IER |= 0x002; IER &amp;= 0x002;</code> has a sequence point in between.  So the first will be done before the second.  Consider an alternative <code>IER &amp;= 0x002; IER |= 0x002;</code>.  The first pair insures <code>IER</code> has at least 1 bit set before clearing others.    The 2nd insures all bits are zero except <i>maybe</i> one.  Then it sets a bit.  The second scenario prevents any interrupt (IER&lt;-- Interrupt enable register), while the first always allows an interrupt.  If that interrupt was a debug handle, it would be hard to step through code in the 2nd case."}], "answers": [{"tags": [], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "is_accepted": false, "score": 6, "last_activity_date": 1479308935, "last_edit_date": 1479308935, "creation_date": 1479293787, "answer_id": 40630362, "question_id": 40630169, "link": "https://stackoverflow.com/questions/40630169/purpose-of-subsequent-use-of-or-and-and-compound-assignment-operators-on-registe/40630362#40630362", "title": "Purpose of subsequent use of OR and AND compound assignment operators on registers", "body": "<p>Of course, sequence of two following commands:</p>\n\n<pre><code>A |= 0x02;\nA &amp;= 0x02;\n</code></pre>\n\n<p>Is identical to:</p>\n\n<pre><code>A = 0x02;\n</code></pre>\n\n<p>Unless the <code>A</code> is not a variable, but a hardware register. In this case you need to refer to the MCU/CPU (or mapped peripheral) manual to check why exactly this sequence is required.</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p><strong>Variable vs Hardware register</strong></p>\n\n<p>In the comments above, OP asked how to <em>distinguish between variables and registers</em>.</p>\n\n<p>This is quite easy. All you need to do is to look at the definition. While typical variable would be defined as something like:</p>\n\n<pre><code>unsigned char A;\n</code></pre>\n\n<p>Hardware register definition will look similar to:</p>\n\n<pre><code>#define A (*(volatile uint16_t *)(0x1234))\n</code></pre>\n\n<p>Here, <code>A</code> is defined as a value of a hardware register, mapped to address at <code>0x1234</code>. Every microcontroller or CPU has it's own unique set of hardware registers, and it <em>will</em> vary not only between different kind of architectures and models, but also between different manufacturers. If the source code is not well documented, the only way to tell what particular hardware register is about is to look into hardware datasheet. Also, some advanced architectures can <em>map</em> hardware registers from some peripherals into CPU address space, so that it is possible to access hardware registers of external components in the same way.</p>\n\n<p>Note the <code>volatile</code> keyword. From the <a href=\"https://en.wikipedia.org/wiki/Volatile_(computer_programming)\" rel=\"nofollow noreferrer\">wiki</a>:</p>\n\n<blockquote>\n  <p>This keyword prevents an optimizing compiler from optimizing away subsequent reads or writes and thus incorrectly reusing a stale value or omitting writes. Volatile values primarily arise in hardware access (memory-mapped I/O), where reading from or writing to memory is used to communicate with peripheral devices, and in threading, where a different thread may have modified a value.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1479309685, "post_id": 40630803, "comment_id": 68503856, "body": "&quot;A |= 0x02; is same as A = 0x02;&quot;  Only if A is zero. There is nothing in the question indicating that this is the case. Also <code>0x12345600 &amp; 0x2</code> gives 0."}], "tags": [], "owner": {"reputation": 159, "user_id": 2879844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dedd829c22695a9f820044a20d9af900?s=128&d=identicon&r=PG&f=1", "display_name": "user2879844", "link": "https://stackoverflow.com/users/2879844/user2879844"}, "is_accepted": false, "score": -2, "last_activity_date": 1479295068, "creation_date": 1479295068, "answer_id": 40630803, "question_id": 40630169, "link": "https://stackoverflow.com/questions/40630169/purpose-of-subsequent-use-of-or-and-and-compound-assignment-operators-on-registe/40630803#40630803", "title": "Purpose of subsequent use of OR and AND compound assignment operators on registers", "body": "<p>A |= 0x02;\nis same as \nA = 0x02;</p>\n\n<p>A &amp;=0x2 stills equal to zero (A=0 assumption)</p>\n\n<p>if both A and B are one byte value.But there are cases where it is not equal to one byte, in these scenario all of these operators have different properties.</p>\n\n<p>I am taking example of 4-byte value.</p>\n\n<p>A=0x12345600</p>\n\n<p>A |= 0x2 equals  0x12345602\nwhereas \nA &amp;= 0x2 equals  0x12345600\nand\nA = 0x2  equals  0x00000002</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1479307206, "creation_date": 1479307206, "answer_id": 40634921, "question_id": 40630169, "link": "https://stackoverflow.com/questions/40630169/purpose-of-subsequent-use-of-or-and-and-compound-assignment-operators-on-registe/40634921#40634921", "title": "Purpose of subsequent use of OR and AND compound assignment operators on registers", "body": "<p>In case the variable is a hardware register, which seems to be the case, the variables are <code>volatile</code>. Writing a bit followed by clearing a bit, is then not the same thing as just writing a value.</p>\n\n<p>Hardware registers don't always behave like plain RAM variables. It is not certain that writing a zero clears a bit. Flag and status registers in particular can have certain conditions, such as \"this flag is cleared by writing to the bit, followed by a read to the register\". In other cases, flags could be cleared by simply reading the register. </p>\n\n<p>This is very common for flag/status registers user for serial communication peripherals such as SPI or UART.</p>\n\n<p>Also, note that there's no guarantee that <code>A = B;</code> results in a single instruction. More likely it results in: \"load B\", \"store B in A\". If you need things to be atomic, you must always disassemble the code to see what you actually ended up with.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1479401508, "creation_date": 1479401508, "answer_id": 40660655, "question_id": 40630169, "link": "https://stackoverflow.com/questions/40630169/purpose-of-subsequent-use-of-or-and-and-compound-assignment-operators-on-registe/40660655#40660655", "title": "Purpose of subsequent use of OR and AND compound assignment operators on registers", "body": "<p>There possibly are circumstances for hardware registers where certain bit sequences are necessary of have \"special\" behaviour, although it is hard to see what that might be in this particular instance.  </p>\n\n<p>Do not underestimate the probability of code you find on the Internet to be nonsense, even if it is from the chip vendor's site.  Looking at the documentation it seems likley that the author has read this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/psESb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/psESb.png\" alt=\"enter image description here\"></a></p>\n\n<p>and has been confused by the reference to OR IER/AND IER - they do enable and disable interrupts but so does the MOV IER instruction <em>atomically</em>. which is what the direct assignment will do.</p>\n\n<p>There is a later example on that same page:</p>\n\n<pre><code>IER |= M_INT2;\nIER &amp;= MINT2;                         // Set \"global\" priority\n</code></pre>\n\n<p>Where the operands differ; so perhaps the author simply has a generalised pattern and is sticking with it.</p>\n"}], "owner": {"reputation": 503, "user_id": 5329451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef87290065ac1f837f8a145801ed89a5?s=128&d=identicon&r=PG&f=1", "display_name": "JJM Driessen", "link": "https://stackoverflow.com/users/5329451/jjm-driessen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 4, "score": 7, "last_activity_date": 1479401508, "creation_date": 1479293268, "last_edit_date": 1479323381, "question_id": 40630169, "link": "https://stackoverflow.com/questions/40630169/purpose-of-subsequent-use-of-or-and-and-compound-assignment-operators-on-registe", "title": "Purpose of subsequent use of OR and AND compound assignment operators on registers", "body": "<p>In C and C++ code, in particular that for embedded systems, I regularly stumble upon assignments that take the following shape:</p>\n\n<pre><code>A |= B;\nA &amp;= B;\n</code></pre>\n\n<p>Not sure if relevant, but A and B are registers here. See an example here:\n<a href=\"http://processors.wiki.ti.com/index.php/Interrupt_Nesting_on_C28x#Example_Code\" rel=\"nofollow noreferrer\">http://processors.wiki.ti.com/index.php/Interrupt_Nesting_on_C28x#Example_Code</a>\nThe following lines appear:</p>\n\n<pre><code>IER |= 0x002;\nIER &amp;= 0x002;\n</code></pre>\n\n<p>However, these <em>subsequent</em> assignments seem identical to the <em>single</em> assignment</p>\n\n<pre><code>A = B;\n</code></pre>\n\n<p>Except for the fact that, theoretically, the former can in some cases be interrupted between both lines, but this does not seem to play an important role in most codes.</p>\n\n<p>Is there an advantage of using the former over the latter, or is there another difference that I fail to see?</p>\n"}, {"tags": ["c", "plugins", "metadata", "gstreamer"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1479293260, "post_id": 40630098, "comment_id": 68492935, "body": "You have described the problem you try to solve. Now what is your question? What have you tried? How did your attempt work or not work? Lastly, what have you tried? How did or didn&#39;t your attempt work? And please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, as well as learn how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2714, "user_id": 1496237, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/V12VS.jpg?s=128&g=1", "display_name": "mpr", "link": "https://stackoverflow.com/users/1496237/mpr"}, "is_accepted": false, "score": 0, "last_activity_date": 1479333708, "creation_date": 1479333708, "answer_id": 40643168, "question_id": 40630098, "link": "https://stackoverflow.com/questions/40630098/there-is-a-standard-template-of-gstreamer-metadata-already-defined/40643168#40643168", "title": "There is a standard template of gstreamer metadata already defined?", "body": "<p>I'm not aware of any generic meta type that you could piggy back on, unfortunately.  If you'd like to share with us what type of data you're trying to pass someone may be able to to suggest a workaround.</p>\n\n<p>Here's a sample Meta API we ended up doing to pass a simple GstClockTime value.</p>\n\n<p>gstmark.h</p>\n\n<pre><code>#ifndef __GST_MARK_H__\n#define __GST_MARK_H__\n\n#include &lt;gst/gst.h&gt;\n#include &lt;gst/gstmeta.h&gt;\n\nG_BEGIN_DECLS\n\ntypedef struct _GstMetaMarking GstMetaMarking;\n\nstruct _GstMetaMarking {\n    GstMeta meta;\n    GstClockTime in_timestamp;\n};\n\nGType gst_meta_marking_api_get_type (void);\nconst GstMetaInfo* gst_meta_marking_get_info (void);\n#define GST_META_MARKING_GET(buf) ((GstMetaMarking *)gst_buffer_get_meta(buf,gst_meta_marking_api_get_type()))\n#define GST_META_MARKING_ADD(buf) ((GstMetaMarking *)gst_buffer_add_meta(buf,gst_meta_marking_get_info(),(gpointer)NULL))\n\nG_END_DECLS\n\n#endif\n</code></pre>\n\n<p>gstmark.c</p>\n\n<pre><code>#include \"gstmark.h\"\n\nGType\ngst_meta_marking_api_get_type (void)\n{\n  static volatile GType type;\n  static const gchar *tags[] = { NULL };\n\n  if (g_once_init_enter (&amp;type)) {\n    GType _type = gst_meta_api_type_register (\"GstMetaMarkingAPI\", tags);\n    g_once_init_leave (&amp;type, _type);\n  }\n  return type;\n}\n\ngboolean\ngst_meta_marking_init(GstMeta *meta, gpointer params, GstBuffer *buffer)\n{\n    GstMetaMarking* marking_meta = (GstMetaMarking*)meta;\n\n    marking_meta-&gt;in_timestamp = GST_CLOCK_TIME_NONE;\n\n    return TRUE;\n}\n\ngboolean\ngst_meta_marking_transform (GstBuffer *dest_buf,\n                             GstMeta *src_meta,\n                             GstBuffer *src_buf,\n                             GQuark type,\n                             gpointer data) {\n    GstMeta* dest_meta = GST_META_MARKING_ADD(dest_buf);\n\n    GstMetaMarking* src_meta_marking = (GstMetaMarking*)src_meta;\n    GstMetaMarking* dest_meta_marking = (GstMetaMarking*)dest_meta;\n\n    dest_meta_marking-&gt;in_timestamp = src_meta_marking-&gt;in_timestamp;\n\n    return TRUE;\n}\n\nvoid\ngst_meta_marking_free (GstMeta *meta, GstBuffer *buffer) {\n}\n\nconst GstMetaInfo *\ngst_meta_marking_get_info (void)\n{\n  static const GstMetaInfo *meta_info = NULL;\n\n  if (g_once_init_enter (&amp;meta_info)) {\n    const GstMetaInfo *meta =\n        gst_meta_register (gst_meta_marking_api_get_type (), \"GstMetaMarking\",\n        sizeof (GstMetaMarking), (GstMetaInitFunction)gst_meta_marking_init,\n        (GstMetaFreeFunction)gst_meta_marking_free, (GstMetaTransformFunction) gst_meta_marking_transform);\n    g_once_init_leave (&amp;meta_info, meta);\n  }\n  return meta_info;\n}\n</code></pre>\n\n<p>Then to add the metadata:</p>\n\n<pre><code>GstMetaMarking* meta = GST_META_MARKING_ADD(in);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7103702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66406ea2d342e8111297f154973eb68b?s=128&d=identicon&r=PG&f=1", "display_name": "Claudio F.", "link": "https://stackoverflow.com/users/7103702/claudio-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1604, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1479333708, "creation_date": 1479293090, "last_edit_date": 1479293906, "question_id": 40630098, "link": "https://stackoverflow.com/questions/40630098/there-is-a-standard-template-of-gstreamer-metadata-already-defined", "title": "There is a standard template of gstreamer metadata already defined?", "body": "<p>I'm writing a gstreamer-1.0 plugin in c.\nI would need to pass a parameter through the pipeline from one plugin to another by passing through other elements. I want to use metadata. I just have to transmit a \"double\" type variable and would like to avoid having to define a new metadata and its API. I tried to search a list of metadata already defined but have not found anything.</p>\n\n<p>My question is:\nThere is a metadata already defined that has these characteristics ?</p>\n"}, {"tags": ["c++", "c", "struct", "overloading", "idioms"], "comments": [{"owner": {"reputation": 12896, "user_id": 104774, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gQmt5.jpg?s=128&g=1", "display_name": "stefaanv", "link": "https://stackoverflow.com/users/104774/stefaanv"}, "edited": false, "score": 0, "creation_date": 1479293669, "post_id": 40629989, "comment_id": 68493221, "body": "No answer, because I didn&#39;t have to solve something similar, just a thought: using the struct doesn&#39;t seem that inconvenient, writing <code>x = foo;</code> or <code>x = foo.value;</code> doesn&#39;t make a huge difference.  And you can still use <code>auto&amp; v = foo.value;</code>if that would make the code clearer. Just make sure to document why you introduced the structs."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1479294387, "post_id": 40629989, "comment_id": 68493689, "body": "Using structs to separate different types of <code>int</code> values is viable in C. However, C doesn&#39;t have name mangling and hence no function overloading, so you would need different function names regardless."}, {"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 0, "creation_date": 1479295049, "post_id": 40629989, "comment_id": 68494110, "body": "<code>strong typedef</code> is something we do not have. But you can always Create a wrapper <code>IntClass</code> taking some user tag and define <code>operator int</code>  ?"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 12896, "user_id": 104774, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gQmt5.jpg?s=128&g=1", "display_name": "stefaanv", "link": "https://stackoverflow.com/users/104774/stefaanv"}, "edited": false, "score": 0, "creation_date": 1479295534, "post_id": 40629989, "comment_id": 68494402, "body": "@stefaanv: Well, you see, some of the code is not mine, so I have to force that on other people; and some of them will use int&#39;s due to other code, so they&#39;ll have to reconcile wrapped and unwrapped int&#39;s etc."}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1479337814, "post_id": 40629989, "comment_id": 68520044, "body": "Why not a tag to disambiguate the call like the standard template library does with <code>std::allocator_arg_t</code>? That would be... Well, standard. :-)"}, {"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "reply_to_user": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 1, "creation_date": 1479340449, "post_id": 40629989, "comment_id": 68520826, "body": "@skypjack: Can you be more specific/provide a link?"}, {"owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "edited": false, "score": 0, "creation_date": 1479365204, "post_id": 40629989, "comment_id": 68528028, "body": "@einpoklum I&#39;m adding an answer with those details."}], "answers": [{"comments": [{"owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 0, "creation_date": 1479296259, "post_id": 40630937, "comment_id": 68494822, "body": "I like this... but: 1. How is that different than wrapping with a struct, other than the definition of various operators? 2. What about going back to int? 3. It&#39;s problematic for me to create a dependency on Boost, even if only to include a header."}, {"owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "reply_to_user": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "edited": false, "score": 1, "creation_date": 1479296791, "post_id": 40630937, "comment_id": 68495156, "body": "@einpoklum 1. Looks like no difference here. Boost just defined all the operators for you not to do extra work. 2. Do you mean <code>int c = a;</code>, where <code>a</code> is strongly typedef&#39;ed? It works without any explicit casts. 3. OK, boost is often an unwanted dependency. As a workaround, you might compile <code>#include &lt;boost&#47;strong_typedef.hpp&gt;</code> (this only line) with <code>g++ -E</code> or similar option of your compiler and include the output into your project as one more header."}], "tags": [], "owner": {"reputation": 7393, "user_id": 1690777, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/18ef5bab4c70735313d86c7240e4abed?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1690777/sergey"}, "is_accepted": false, "score": 2, "last_activity_date": 1479296228, "last_edit_date": 1479296228, "creation_date": 1479295524, "answer_id": 40630937, "question_id": 40629989, "link": "https://stackoverflow.com/questions/40629989/pros-and-cons-of-wrapping-a-number-in-a-struct-to-avoid-implicit-conversions/40630937#40630937", "title": "Pros and cons of wrapping a number in a struct to avoid implicit conversions", "body": "<p>The following is not an answer for your exact question, but <code>BOOST_STRONG_TYPEDEF</code> seems to work well for creating incompatible typedefs:</p>\n\n<pre><code>#include &lt;boost/strong_typedef.hpp&gt;\n// Only the header is required. No linking, no runtime dependencies.\n\nBOOST_STRONG_TYPEDEF(int, foo_t);\nBOOST_STRONG_TYPEDEF(int, bar_t);\n\nvoid create_baz(foo_t foo, bar_t bar = static_cast&lt;bar_t&gt;(1)) {}\nvoid create_baz(bar_t bar) {}\n\nint main()\n{\n    // Assigning (or initializing with) literals seems to be \n    // the only inconvenient thing about strong typedefs.\n    foo_t a = static_cast&lt;foo_t&gt;(1);\n    foo_t b = static_cast&lt;foo_t&gt;(2);\n\n    a = b; // Operators work well.\n    std::cout &lt;&lt; a+b &lt;&lt; std::endl; // Even overloaded ones.\n\n    create_baz(a); // No errors, no ambiguity.\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44996, "user_id": 4987285, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/7063d966c8dfa84aefbd06786824090e?s=128&d=identicon&r=PG", "display_name": "skypjack", "link": "https://stackoverflow.com/users/4987285/skypjack"}, "is_accepted": false, "score": 1, "last_activity_date": 1479368108, "last_edit_date": 1479368108, "creation_date": 1479366165, "answer_id": 40648597, "question_id": 40629989, "link": "https://stackoverflow.com/questions/40629989/pros-and-cons-of-wrapping-a-number-in-a-struct-to-avoid-implicit-conversions/40648597#40648597", "title": "Pros and cons of wrapping a number in a struct to avoid implicit conversions", "body": "<p>A common, basic and obvious technique to disambiguate a function call is adding an extra, parameter and rely on overloading.<br>\nIt's so common that even a few classes in the standard template library uses it.</p>\n\n<p>As an example, consider what's the purpose of <a href=\"http://en.cppreference.com/w/cpp/memory/allocator_arg_t\" rel=\"nofollow\"><code>std::allocator_arg_t</code></a>:</p>\n\n<blockquote>\n  <p>[...] an empty class type used to disambiguate the overloads of constructors and member functions of allocator-aware objects [...]</p>\n</blockquote>\n\n<p>It is used by <code>std::function</code>, <code>std::tuple</code>, <code>std::promise</code> and <code>std::packaged_task</code>.</p>\n\n<p>You can easily look at the lists of constructors of those classes to know how it is used.</p>\n\n<p>Another example is the postfix increment/decrement operator.<br>\nIt has a <em>dummy</em> <code>int</code> parameter that helps to differentiate the function declaration from the the prefix increment/decrement operator.<br>\nThat is:</p>\n\n<pre><code>T&amp;\u00a0operator++(T&amp;)\n</code></pre>\n\n<p>Versus:</p>\n\n<pre><code>T&amp;\u00a0operator++(T&amp;, int)\n</code></pre>\n\n<p>Here the call doesn't require you to provide that extra parameter and it serves only to disambiguate the function declarations actually, so it is a contrived example.</p>\n\n<p>Anyway, what can you do in your case?<br>\nYou can define a <em>tag</em> like this one:</p>\n\n<pre><code>struct bar_arg_t {};\n</code></pre>\n\n<p>And use it in the second function declaration:</p>\n\n<pre><code>baz_t create_baz(bar_arg_t, bar_t bar);\n</code></pre>\n\n<p>That is nothing more than an empty class, a dummy parameter the purpose of which is to help you disambiguating the call.</p>\n"}], "owner": {"reputation": 85518, "user_id": 1593077, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/10c44e0d9568e48d05708ae196ad936f?s=128&d=identicon&r=PG", "display_name": "einpoklum", "link": "https://stackoverflow.com/users/1593077/einpoklum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1479368108, "creation_date": 1479292790, "last_edit_date": 1479305090, "question_id": 40629989, "link": "https://stackoverflow.com/questions/40629989/pros-and-cons-of-wrapping-a-number-in-a-struct-to-avoid-implicit-conversions", "title": "Pros and cons of wrapping a number in a struct to avoid implicit conversions", "body": "<p>I'm writing a small library with the following:</p>\n\n<pre><code>using foo_t = int;\nusing bar_t = int;\n\nbaz_t create_baz(foo_t foo, bar_t bar = default_bar);\n</code></pre>\n\n<p>and I also want to have a <code>create_baz</code> function which only takes a bar: </p>\n\n<pre><code>baz_t create_baz(bar_t bar);\n</code></pre>\n\n<p>but that will collide with the defaulted first version of create_baz - since <code>foo_t</code> and <code>bar_t</code> are the same. So, I was thinking: Perhaps I should have</p>\n\n<pre><code>struct foo_t { int value; }\nstruct bar_t { int value; }\n</code></pre>\n\n<p>(or just wrap one of them in a struct), so that the types will be different, and even incompatible, and I'll be have that second <code>create_baz</code>.</p>\n\n<p>Now, obviously a struct is less convenient to use. But are there other pros and cons I should take into account about this decision?</p>\n\n<p>My question is mainly about C++ but I suppose that's also somewhat relevant in C (ignoring the second parameter of the first function).</p>\n"}, {"tags": ["c", "bit-manipulation", "ternary-operator"], "comments": [{"owner": {"reputation": 51325, "user_id": 474349, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZMmIm.png?s=128&g=1", "display_name": "Hong Ooi", "link": "https://stackoverflow.com/users/474349/hong-ooi"}, "edited": false, "score": 0, "creation_date": 1479292977, "post_id": 40629878, "comment_id": 68492747, "body": "<code>i = b</code> or <code>i == b</code>?"}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "reply_to_user": {"reputation": 51325, "user_id": 474349, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ZMmIm.png?s=128&g=1", "display_name": "Hong Ooi", "link": "https://stackoverflow.com/users/474349/hong-ooi"}, "edited": false, "score": 0, "creation_date": 1479293045, "post_id": 40629878, "comment_id": 68492804, "body": "@HongOoi <code>i = (b ? (i | mask) : (i &amp; ~mask))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 806, "user_id": 1038336, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3ce63a4e23c6cb5d968c1c68be1646b7?s=128&d=identicon&r=PG", "display_name": "Guilherme Campos Hazan", "link": "https://stackoverflow.com/users/1038336/guilherme-campos-hazan"}, "edited": false, "score": 0, "creation_date": 1479293760, "post_id": 40630333, "comment_id": 68493289, "body": "I tested in Java, if you want, i can post the test code in java that shows that it really works"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479293802, "post_id": 40630333, "comment_id": 68493317, "body": "Now the question is: what is worse in terms of performance loss, branching or multiplying ?"}, {"owner": {"reputation": 806, "user_id": 1038336, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3ce63a4e23c6cb5d968c1c68be1646b7?s=128&d=identicon&r=PG", "display_name": "Guilherme Campos Hazan", "link": "https://stackoverflow.com/users/1038336/guilherme-campos-hazan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479293838, "post_id": 40630333, "comment_id": 68493347, "body": "In my tests, i used i = 101 (binary), mask = 110 (binary)"}, {"owner": {"reputation": 806, "user_id": 1038336, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3ce63a4e23c6cb5d968c1c68be1646b7?s=128&d=identicon&r=PG", "display_name": "Guilherme Campos Hazan", "link": "https://stackoverflow.com/users/1038336/guilherme-campos-hazan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479293911, "post_id": 40630333, "comment_id": 68493385, "body": "You can easily find that adding both codes and running them 1 million times each, and measuring the time."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1479293919, "post_id": 40630333, "comment_id": 68493389, "body": "You can trivially rewrite the multiplication as a negation and a bitwise AND, in case you have slow multiplications (typically this is worth rewriting that way)"}], "tags": [], "owner": {"reputation": 806, "user_id": 1038336, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3ce63a4e23c6cb5d968c1c68be1646b7?s=128&d=identicon&r=PG", "display_name": "Guilherme Campos Hazan", "link": "https://stackoverflow.com/users/1038336/guilherme-campos-hazan"}, "is_accepted": false, "score": 5, "last_activity_date": 1479293715, "creation_date": 1479293715, "answer_id": 40630333, "question_id": 40629878, "link": "https://stackoverflow.com/questions/40629878/optimising-i-b-i-mask-i-mask/40630333#40630333", "title": "Optimising &quot;i = b ? (i | mask) : (i &amp; ~mask)&quot;", "body": "<p>The idea here is to replace the branch by a multiplication, where we can zero each side depending on the value of b:</p>\n\n<pre><code>i = (i | (mask * b)) &amp; (~mask | (mask * b));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1479294605, "post_id": 40630542, "comment_id": 68493847, "body": "This also follows from Guilherme&#39;s answer and using that or distributes over and"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1479295230, "post_id": 40630542, "comment_id": 68494232, "body": "@harold Is your comment accidentally missing something? End of it seems weird."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 0, "creation_date": 1479295408, "post_id": 40630542, "comment_id": 68494325, "body": "No I just didn&#39;t format it clearly, I mean that OR distributes over AND"}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 5, "last_activity_date": 1479294320, "creation_date": 1479294320, "answer_id": 40630542, "question_id": 40629878, "link": "https://stackoverflow.com/questions/40629878/optimising-i-b-i-mask-i-mask/40630542#40630542", "title": "Optimising &quot;i = b ? (i | mask) : (i &amp; ~mask)&quot;", "body": "<p>Another alternative: Always set bits to 0 (left part) and optionally set bits to 1 (right part).</p>\n\n<pre><code>i = (i &amp; ~mask) | (mask * b);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1479305299, "post_id": 40631136, "comment_id": 68500714, "body": "<code>-b</code> and <code>-1u</code> isn&#39;t the same thing though. If <code>b</code> is a small integer type of any signedness, you end up with a negative number temporarily. Unlike <code>-1u</code> which is always a positive number. It won&#39;t be a problem in this specific case, but would have been disastrous in code like <code>(mask &amp; -b) &lt;&lt; n</code>."}, {"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1479306850, "post_id": 40631136, "comment_id": 68501811, "body": "@Lundin Right, there is actually a problem with the code in my answer if <code>b</code> is narrower than <code>int</code> and the platform doesn&#39;t use two&#39;s complement. In this case, an additional cast <code>-(unsigned)b</code> is needed."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": false, "score": 6, "last_activity_date": 1479297195, "last_edit_date": 1479297195, "creation_date": 1479296178, "answer_id": 40631136, "question_id": 40629878, "link": "https://stackoverflow.com/questions/40629878/optimising-i-b-i-mask-i-mask/40631136#40631136", "title": "Optimising &quot;i = b ? (i | mask) : (i &amp; ~mask)&quot;", "body": "<p>Exploiting the fact that <code>-1u</code> is the value with all bits set:</p>\n\n<pre><code>i = (i &amp; ~mask) | (mask &amp; -b);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>i ^= (i ^ -b) &amp; mask;\n</code></pre>\n\n<p>The second approach reduces the number of operations and code size. The first approach may still be faster on a superscalar architecture because some operations can be executed in parallel.</p>\n"}, {"comments": [{"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1479309766, "post_id": 40634128, "comment_id": 68503915, "body": "Thanks, I like this readable approach.  If <code>i</code> is PORTA on an AVR, would this cause a GPIO glitch?  Or are the two statements merged into one during compilation?  I <i>expect</i> that PORTA is marked volatile to stop that happening."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 1, "creation_date": 1479309973, "post_id": 40634128, "comment_id": 68504073, "body": "@chrisdew It would cause the GPIO to go low for a couple of clock ticks. The compiler is not allowed to optimize the code since <code>PORTA</code> would be a volatile register. On some hardwares, GPIO ports may need a few clock ticks to stabilize though."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1479305034, "creation_date": 1479305034, "answer_id": 40634128, "question_id": 40629878, "link": "https://stackoverflow.com/questions/40629878/optimising-i-b-i-mask-i-mask/40634128#40634128", "title": "Optimising &quot;i = b ? (i | mask) : (i &amp; ~mask)&quot;", "body": "<p>The most readable way is to do this in several steps - doing so won't affect performance but improve readability. </p>\n\n<p>As is always the case with bit-wise operators, you must be careful with implicit type promotions. For example, careless use of <code>~</code> tends to create implicit promotion bugs. (The <code>?:</code> operator also silently promotes the result by balancing the 2nd and 3rd operands with each other.)</p>\n\n<p>Readable, portable, safe code:</p>\n\n<pre><code>uintx_t i = ... ;\nuintx_t b = ... ;  // 1 or 0\n\ni &amp;= (uintx_t)~mask;   // always clear the bit\ni |= mask * b;         // if b is 1, set the bit, otherwise OR with 0\n</code></pre>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 2, "accepted_answer_id": 40630542, "answer_count": 4, "score": 4, "last_activity_date": 1479308649, "creation_date": 1479292477, "last_edit_date": 1479308649, "question_id": 40629878, "link": "https://stackoverflow.com/questions/40629878/optimising-i-b-i-mask-i-mask", "title": "Optimising &quot;i = b ? (i | mask) : (i &amp; ~mask)&quot;", "body": "<p>I want to be able to set or clear (multiple) bits of a <code>uintX_t t</code>.</p>\n\n<p><code>i</code> is a runtime variable (<code>uintX_t</code>).\n<code>b</code> is a runtime variable (<code>uintX_t</code>) which is constrained to be <code>0</code> or <code>1</code>.</p>\n\n<p><code>mask</code> is a compile-time constant.</p>\n\n<p>Is there a better way than:</p>\n\n<pre><code>i = b ? (i | mask) : (i &amp; ~mask)\n</code></pre>\n\n<p>I'm looking to avoid branching, if that's possible.  Target is ARM, if it matters.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 698, "user_id": 4110629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZZl7k.jpg?s=128&g=1", "display_name": "Mrudav Shukla", "link": "https://stackoverflow.com/users/4110629/mrudav-shukla"}, "edited": false, "score": 0, "creation_date": 1479306991, "post_id": 40629773, "comment_id": 68501910, "body": "Consider incrementing value of &quot;count&quot; in the third while loop."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 2138882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3880e37d76097b1003dbac5fd54872?s=128&d=identicon&r=PG&f=1", "display_name": "Forrest", "link": "https://stackoverflow.com/users/2138882/forrest"}, "is_accepted": false, "score": 1, "last_activity_date": 1479293948, "last_edit_date": 1479293948, "creation_date": 1479293070, "answer_id": 40630093, "question_id": 40629773, "link": "https://stackoverflow.com/questions/40629773/the-code-does-not-seem-to-execute-properly/40630093#40630093", "title": "The code does not seem to execute properly", "body": "<p>When I execute this it does not get stuck on the <code>while(valid == 0)</code> loop, it gets stuck in the 1st <code>while(count &lt; 5)</code> because you do not increment count inside this loop.</p>\n\n<p>There are a few other things that pop out immediately to me in this code that I might as well point out.</p>\n\n<ul>\n<li><p>You can automatically have all elements of an array set to 0 by declaring like <code>int array[10] = {0}</code>.  There are a few ways of doing this (including for loops), but you don't need to manually type each one out like you do in lines 11-18</p></li>\n<li><p>Arrays are 0 indexed in c, so you start counting from 0, not 1</p></li>\n<li><p>You increment i at the beginning of the while loop (line 26) before it is accessed.  Thus meaning the first index actually being used is 2 (remember it should be 0)</p></li>\n<li><p>If you are limiting your number of students to 200, you should make sure  the user doesn't enter in a number larger than this.</p></li>\n</ul>\n\n<p>EDIT:</p>\n\n<ul>\n<li>You will also need to reset <code>valid</code> to 0 before the <code>while(valid == 0)</code> loop (you could also just do <code>while(!valid)</code> btw)</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7166877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479293948, "creation_date": 1479292193, "last_edit_date": 1479292247, "question_id": 40629773, "link": "https://stackoverflow.com/questions/40629773/the-code-does-not-seem-to-execute-properly", "title": "The code does not seem to execute properly", "body": "<p>Gets stuck inside of the valid = 0 while loop where it does not get passed scanf and keeps asking for input. The program was designed to accept an integer value for the GPA and then calculate the frequency of each gpa among what had been given.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int amount, i, count, valid;\n    int GPA[200], GPAFreq[4];\n\n    valid = 0;\n    i = 1;\n    count = 1;\n\n    GPA[1] = 0; GPA[6] = 0;\n    GPA[2] = 0; GPA[7] = 0;\n    GPA[3] = 0; GPA[8] = 0;\n    GPA[4] = 0; GPA[9] = 0;\n    GPA[5] = 0; GPA[10] = 0;\n\n    GPAFreq[1] = 0; GPAFreq[3] = 0;\n    GPAFreq[2] = 0; GPAFreq[4] = 0;\n\n\n    printf(\"Enter the number of students: \");\n    scanf(\"%d\", &amp;amount);\n\n    while ( i &lt; (amount + 1))\n    {\n        i += 1;\n        while (valid == 0)\n        {\n            printf(\"%d\", GPA[i]);\n            if ( (GPA[i] == 4) || (GPA[i] == 3) || (GPA[i] == 2) || (GPA[i] == 1) )\n            {\n                valid = 1;  \n            }\n            else\n            {\n                printf(\"GPA of student # %d is: \", i);\n                scanf(\"%d\", &amp;GPA[i]);\n            }\n        }\n        count = 1;\n        while (count &lt; 5)\n        {\n            if (GPA[i] == count)\n            {\n                GPAFreq[count] +=1;\n            }\n        }       \n    }\n\n    count = 1;\n    while (count &lt; 5)\n    {\n        printf(\"\\nGPA %d --- %d student(s).\", count, GPAFreq[count]);\n        count += 1;\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "recursion", "reverse"], "comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 2, "creation_date": 1479292344, "post_id": 40629678, "comment_id": 68492326, "body": "You should pass <code>strlen(st2)</code> to <code>recurse_reverse</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1479292472, "post_id": 40629678, "comment_id": 68492414, "body": "One of the first chars you swap is the <code>&#39;\\0&#39;</code> which becomes the end of the string."}, {"owner": {"reputation": 203, "user_id": 6846552, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7713aa0b75eb19586038408883c08c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mynicks", "link": "https://stackoverflow.com/users/6846552/mynicks"}, "edited": false, "score": 0, "creation_date": 1479295306, "post_id": 40629678, "comment_id": 68494271, "body": "The only purpose of st1 is to display the old value.Delete please st1 and review the code, i did not expect it would confuse you.  The function prototype  of recurse_reverse supposed to be : void recurse_reverse(char s[], int size);   Let&#39;s say that st1[9] does not exist, strcpy() does not exist and st2[9] =&quot;abcdefg&quot;, which i want to be reversed. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1479292628, "post_id": 40629817, "comment_id": 68492519, "body": "@Jean-Fran&#231;oisFabre C standard uses the term &quot;null character&quot; to denote <code>&#39;\\0&#39;</code>. So, I don&#39;t see any issue with calling it &quot;null byte&quot; or any ambiguity."}, {"owner": {"reputation": 203, "user_id": 6846552, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7713aa0b75eb19586038408883c08c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mynicks", "link": "https://stackoverflow.com/users/6846552/mynicks"}, "edited": false, "score": 0, "creation_date": 1479295925, "post_id": 40629817, "comment_id": 68494623, "body": "please check my comment right below my code. I should have placed it here, but i made a mistake. Also, after seeing your response ,by deductive reasoning i typed recurse_reverse(st2,strlen(st2)); and worked like a charm."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1479300921, "post_id": 40629817, "comment_id": 68497827, "body": "@usr duly noted, I never know how to call it. At least not <code>NULL</code>. at least that answer is good but I was angry at the 2 other ones. I just wanted to know how it would turn out."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 5, "last_activity_date": 1479292378, "last_edit_date": 1479292378, "creation_date": 1479292318, "answer_id": 40629817, "question_id": 40629678, "link": "https://stackoverflow.com/questions/40629678/recursion-reverse-string-in-its-position/40629817#40629817", "title": "Recursion: Reverse string in its position", "body": "<p>You are swapping the 2 zero bytes at the end of <code>st1</code>. Hence, the <code>st2</code> starts with a null byte and thus the printf() isn't printing anything.\nYou just need to fix your argument passing. Instead of</p>\n\n<pre><code>recurse_reverse(st2,9);\n</code></pre>\n\n<p>do</p>\n\n<pre><code>recurse_reverse(st2,strlen(st1));\n</code></pre>\n\n<p>You probably want to add logic to make sure your destination array <code>st2</code> has sufficient space.</p>\n"}, {"comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 2, "creation_date": 1479297763, "post_id": 40629925, "comment_id": 68495788, "body": "While this code snippet may solve the question, including an explanation <a href=\"//meta.stackexchange.com/q/114762\">really helps</a> to improve the quality of your post. Remember that you are answering the question for readers in the future, not just the person asking now!  Please <a href=\"https://stackoverflow.com/posts/40629925/edit\">edit</a> your answer to add explanation, and give an indication of what limitations and assumptions apply."}], "tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": false, "score": 1, "last_activity_date": 1479292615, "creation_date": 1479292615, "answer_id": 40629925, "question_id": 40629678, "link": "https://stackoverflow.com/questions/40629678/recursion-reverse-string-in-its-position/40629925#40629925", "title": "Recursion: Reverse string in its position", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid swap( char* s1, char *s2);\n\nvoid recurse_reverse(char s[], int sz)\n{\n    int i=0,j = sz-1;\n    if(i&lt;j)\n    {\n        swap(&amp;s[i],&amp;s[j]);\n        recurse_reverse(s+1, sz-2);\n\n    }\n}\n\n\nvoid swap( char* s1, char *s2)\n{\n    char tmp;\n    tmp = *s1;\n    *s1 = *s2;\n    *s2 = tmp;\n}\n\n\nint main(void)\n{\n    char st1[9] = \"abcdefg\", st2[9];\n    int len=0;\n    strcpy(st2,st1);\n    len =strlen(st2);\n    recurse_reverse(st2,len);\n    printf(\"s1 = %s\\ns2 = %s\",st1,st2);\n    printf(\"\\n\" );\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1751, "user_id": 2959769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9WfJf.jpg?s=128&g=1", "display_name": "Vinay Shukla", "link": "https://stackoverflow.com/users/2959769/vinay-shukla"}, "is_accepted": false, "score": 3, "last_activity_date": 1479294360, "last_edit_date": 1479294360, "creation_date": 1479293133, "answer_id": 40630121, "question_id": 40629678, "link": "https://stackoverflow.com/questions/40629678/recursion-reverse-string-in-its-position/40630121#40630121", "title": "Recursion: Reverse string in its position", "body": "<p>I added a <code>printf</code> statement to debug the issue and got the below output. You are trying to access 9th variable which is a terminated null character <code>\\0</code> hence you only get <code>\\0</code> as output and not the actual reversed string.</p>\n\n<p>Instead of hardcoding the size of string you can use <code>strlen</code> to get the string length. </p>\n\n<pre><code>1st char = a and 9th char is \u2592\n1st char = b and 9th char is\n1st char = c and 9th char is g\n1st char = d and 9th char is f\ns1 = abcdefg\ns2 = \u2592\n</code></pre>\n\n<p><strong>Solution</strong></p>\n\n<p>Intended code change</p>\n\n<pre><code>recurse_reverse(st2,strlen(st1));\n</code></pre>\n\n<p><strong>Output</strong> </p>\n\n<pre><code>1st char = a and 9th char 9th char is g\n1st char = b and 9th char 9th char is f\n1st char = c and 9th char 9th char is e\ns1 = abcdefg\ns2 = gfedcba\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 6846552, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7713aa0b75eb19586038408883c08c0?s=128&d=identicon&r=PG&f=1", "display_name": "Mynicks", "link": "https://stackoverflow.com/users/6846552/mynicks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 40629817, "answer_count": 3, "score": 4, "last_activity_date": 1484174925, "creation_date": 1479291934, "last_edit_date": 1484174925, "question_id": 40629678, "link": "https://stackoverflow.com/questions/40629678/recursion-reverse-string-in-its-position", "title": "Recursion: Reverse string in its position", "body": "<p>Recursion. I checked other online solutions and they seem to be pretty much identical to mine.\nThe code should reverse the string (in its position) but it does not. E.g when input is st2 = \"abcdefg\" the output is an empty string. I was expecting st2 = \"gfedcba\". What am i missing? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nvoid recurse_reverse(char s[], int sz)\n{\n    int i=0,j = sz -1;\n    if(i&lt;j)\n    {\n        swap(&amp;s[i],&amp;s[j]);\n        recurse_reverse(s+1, sz-2);\n\n    }\n}\n\n\nvoid swap( char* s1, char *s2)\n{\n    char tmp;\n    tmp = *s1;\n    *s1 = *s2;\n    *s2 = tmp;\n}\n\n\nint main(void)\n{\n    char st1[9] = \"abcdefg\", st2[9];\n    strcpy(st2,st1);\n    recurse_reverse(st2,9);\n    printf(\"s1 = %s\\ns2 = %s\",st1,st2);\n    printf(\"\\n\" );\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1479291602, "post_id": 40629494, "comment_id": 68491781, "body": "You are using integer division. Try <code>avg = sum &#47;6.0;</code>"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1479302136, "post_id": 40629494, "comment_id": 68498541, "body": "It is even written in your homework description that you have to cast to float. (even if its <code>(float)</code> and not <code>float()</code>). Count yourself lucky that people were willing to help even if you ignore the task given..."}, {"owner": {"reputation": 53, "user_id": 6825441, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/af9bd2ffef4166030a3175db0d812721?s=128&d=identicon&r=PG&f=1", "display_name": "sls1981", "link": "https://stackoverflow.com/users/6825441/sls1981"}, "edited": false, "score": 0, "creation_date": 1479464614, "post_id": 40629494, "comment_id": 68579249, "body": "LOL in case it wasn&#39;t clear Kami, I hadn&#39;t realised I had ignored a task. As I say, I am useless at this, despite trying extremely hard. I don&#39;t mind admitting I am not intelligent enough in that way to fully understand C programming. I only have another three weeks on this module but I have tried my best the whole way. It just hasn&#39;t clicked - but it is not for the want of trying. :)"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1505360735, "last_edit_date": 1505360735, "creation_date": 1479291559, "answer_id": 40629538, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages/40629538#40629538", "title": "Array additions and averages", "body": "<p>Your array isn't large enough to hold 6 numbers. </p>\n\n<p>Change </p>\n\n<pre><code>   int numArr[5];\n</code></pre>\n\n<p>to</p>\n\n<pre><code>   int numArr[6];\n</code></pre>\n\n<p>Currently, you are accessing the array out-of-bunds, resulting in <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behaviour</a>.</p>\n\n<p>There are couple other problems too:<br>\n1) You are not summing the array elements<br>\n2) You are doing integer division  </p>\n\n<p>Fix it, it'd look like:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nint main(void) {\n\n   int numArr[6];\n   int i, sum = 0;\n   float avg;\n\n   printf(\"\\nEnter 6 elements : \\n\");\n\n   for (i = 0; i &lt; 6; i++)\n      scanf(\"%d\", &amp;numArr[i]);\n\n   for (i = 0; i &lt; 6; i++) {\n      sum = sum + numArr[i]; /* was summing `i` instead of numArr[i] */\n   }\n   avg = sum /6.0;   /* was doing integer division */\n   printf(\"The sum is : %d\", sum);   \n   printf(\"The mean value is : %f\", avg); \n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1479302355, "post_id": 40629575, "comment_id": 68498686, "body": "What about the explicit cast to float that was required? And the array is too small, too."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 2, "last_activity_date": 1479291671, "creation_date": 1479291671, "answer_id": 40629575, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages/40629575#40629575", "title": "Array additions and averages", "body": "<pre><code>sum = sum + i;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>sum = sum + numArr[i];\n</code></pre>\n\n<p>Array elements should be added.</p>\n\n<p>Later</p>\n\n<pre><code>avg = sum/6.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 904, "user_id": 3445412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a550cf434eff5b7d6177128845c9c58?s=128&d=identicon&r=PG&f=1", "display_name": "Aayush Anand", "link": "https://stackoverflow.com/users/3445412/aayush-anand"}, "is_accepted": false, "score": 1, "last_activity_date": 1479291736, "creation_date": 1479291736, "answer_id": 40629597, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages/40629597#40629597", "title": "Array additions and averages", "body": "<pre><code>for (i = 0; i &lt; 6; i++) {\n  sum = sum + numArr[i];\n}\navg = (float)sum /6;\n</code></pre>\n\n<p><br/><br/> Notice <b>numArr[i]</b></p>\n"}, {"tags": [], "owner": {"reputation": 2040, "user_id": 5939079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d6ff8fc2f032cf9d4e34de6eb60940?s=128&d=identicon&r=PG&f=1", "display_name": "cokceken", "link": "https://stackoverflow.com/users/5939079/cokceken"}, "is_accepted": false, "score": 1, "last_activity_date": 1479291805, "creation_date": 1479291805, "answer_id": 40629621, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages/40629621#40629621", "title": "Array additions and averages", "body": "<pre><code>int numArr[5];\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>int numArr[6];\n</code></pre>\n\n<p>and </p>\n\n<pre><code>for (i = 0; i &lt; 6; i++) {\n  sum = sum + i;\n}\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for (i = 0; i &lt; 6; i++) {\n  sum = sum + numArr[i];\n}   \n</code></pre>\n\n<p>and</p>\n\n<pre><code>avg = sum /6;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>avg = sum/6.0 //because division of integer by an integer results by integer value. So we divide integer with a float (6.0) value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48960, "user_id": 2522554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cebe27d4fdd15bb1fb77bab95ff493?s=128&d=identicon&r=PG", "display_name": "bansi", "link": "https://stackoverflow.com/users/2522554/bansi"}, "edited": false, "score": 0, "creation_date": 1479292088, "post_id": 40629631, "comment_id": 68492125, "body": "like the <code>( float )sum</code> the question specifically asks to do that"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1479292117, "last_edit_date": 1479292117, "creation_date": 1479291831, "answer_id": 40629631, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages/40629631#40629631", "title": "Array additions and averages", "body": "<blockquote>\n  <p>'Write a program that inputs <strong>6</strong> integers</p>\n</blockquote>\n\n<pre><code>int numArr[5];\n         ^^^^^\n</code></pre>\n\n<p>Change this loop</p>\n\n<pre><code> for (i = 0; i &lt; 6; i++) {\n      sum = sum + i;\n   }\n</code></pre>\n\n<p>like</p>\n\n<pre><code> for (i = 0; i &lt; 6; i++) {\n      sum = sum + numArr[I];\n   }\n</code></pre>\n\n<p>And change this statement</p>\n\n<pre><code>avg = sum /6;\n</code></pre>\n\n<p>the following way</p>\n\n<pre><code>avg = ( float )sum /6;\n</code></pre>\n\n<p>And you forgot to output all elements of the array.</p>\n\n<p>Take into account that according to the C Standard the function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>and you may remove header <code>&lt;math.h&gt;</code> because neither declaration is used from this header in your program.</p>\n"}], "owner": {"reputation": 53, "user_id": 6825441, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/af9bd2ffef4166030a3175db0d812721?s=128&d=identicon&r=PG&f=1", "display_name": "sls1981", "link": "https://stackoverflow.com/users/6825441/sls1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1505360735, "creation_date": 1479291453, "question_id": 40629494, "link": "https://stackoverflow.com/questions/40629494/array-additions-and-averages", "title": "Array additions and averages", "body": "<p>So this weeks homework is to: 'Write a program that inputs 6 integers and puts them into an Array. The program\nthen prints out the following: A list of all Array elements, from 0 to 5 and the sum and\nmean value of all elements. NB The mean value of the array elements will not\nnecessarily be an integer. In order to convert an integer into a real (float) use\ncasting:\nTo turn the integer \u2018x\u2019 into a float use float(x)\nE.g.:\nAverage = float(sum)/number of elements ;\n(In this case the number of elements is 6)'</p>\n\n<p>Not quite sure what I am doing wrong here but my code seems to give back incorrect answers and I can't figure out why.</p>\n\n<p>Any suggestions would be greatly appreciated. I feel like I am going to fail this module as I have struggled with it since the introduction of functions, etc.</p>\n\n<p>Anyway, here is my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;math.h&gt;\n\nint main() {\n\n   int numArr[5];\n   int i, sum = 0;\n   float avg;\n\n   printf(\"\\nEnter 6 elements : \\n\");\n\n   for (i = 0; i &lt; 6; i++)\n      scanf(\"%d\", &amp;numArr[i]);\n\n   for (i = 0; i &lt; 6; i++) {\n      sum = sum + i;\n   }\n   avg = sum /6;\n\n   printf(\"The sum is : %d\", sum);\n\n   printf(\"The mean value is : %f\", avg);\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "header", "include", "typedef", "ifndef"], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 3035795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0de03a52efb58c255ed1aa5dc8ce4a69?s=128&d=identicon&r=PG", "display_name": "Risinek", "link": "https://stackoverflow.com/users/3035795/risinek"}, "edited": false, "score": 0, "creation_date": 1479293098, "post_id": 40629530, "comment_id": 68492835, "body": "Thanks, that answered my question. So There is no simple solution than remaking HEADER files or breaking best practices and include headerA.h before headerB.h in headerB.c"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 286, "user_id": 3035795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0de03a52efb58c255ed1aa5dc8ce4a69?s=128&d=identicon&r=PG", "display_name": "Risinek", "link": "https://stackoverflow.com/users/3035795/risinek"}, "edited": false, "score": 0, "creation_date": 1479302633, "post_id": 40629530, "comment_id": 68498858, "body": "@Risinek Circular dependency is bad design. If you include something you derive something from there, there is no reason why the thing you include also needs something from you."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1479292661, "last_edit_date": 1479292661, "creation_date": 1479291537, "answer_id": 40629530, "question_id": 40629479, "link": "https://stackoverflow.com/questions/40629479/c-header-file-ifndef-include-error/40629530#40629530", "title": "C header file #ifndef #include error", "body": "<p>You have a <em>circular dependency</em>. Header file <code>headerA.h</code> depends on <code>headerB.h</code> which depends on <code>headerA.h</code> and so on and on.</p>\n\n<p>You need to break that dependency, for example by <em>not</em> including <code>headerB.h</code> in <code>headerA.h</code>. It's not needed (nothing in <code>headerA.h</code> needs anything from <code>headerB.h</code>).</p>\n\n<hr>\n\n<p>If you have to include <code>headerB.h</code> (as stated in your recent edit) then you first should reconsider how you use your header files, and what definition you place where. Perhaps move the definition of <code>MyInt</code> to <code>headerB.h</code>? Or have more header files, like one for type-aliases (like your <code>MyInt</code> which I personally see no use for), one for structures and one for variable declarations?</p>\n\n<p>If that's not possible then you could try by changing the order of definitions and the include, like</p>\n\n<pre><code>#ifndef HEADERA_H\n#define HEADERA_H\n\n// Define type alias first, and other things needed by headerB.h\ntypedef int MyInt;\n\n// Then include the header file needing the above definitions\n#include \"headerB.h\"\n\nTFoo foo;\n... some other structures from headerB.h ...\n\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 286, "user_id": 3035795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0de03a52efb58c255ed1aa5dc8ce4a69?s=128&d=identicon&r=PG", "display_name": "Risinek", "link": "https://stackoverflow.com/users/3035795/risinek"}, "edited": false, "score": 0, "creation_date": 1479291957, "post_id": 40629600, "comment_id": 68492030, "body": "thats not solution for my problem, becouse in headerA.h I need other structures and functions from headerA.h. I edited question"}], "tags": [], "owner": {"reputation": 512, "user_id": 2283378, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5487c63a74459b59f23cb7c3d74c07dc?s=128&d=identicon&r=PG", "display_name": "Juan Ch&#244;", "link": "https://stackoverflow.com/users/2283378/juan-ch%c3%b4"}, "is_accepted": false, "score": 0, "last_activity_date": 1479291739, "creation_date": 1479291739, "answer_id": 40629600, "question_id": 40629479, "link": "https://stackoverflow.com/questions/40629479/c-header-file-ifndef-include-error/40629600#40629600", "title": "C header file #ifndef #include error", "body": "<p>Just drop the line</p>\n\n<pre><code>#include \"headerB.h\"\n</code></pre>\n\n<p>from file headerA.h</p>\n"}], "owner": {"reputation": 286, "user_id": 3035795, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0de03a52efb58c255ed1aa5dc8ce4a69?s=128&d=identicon&r=PG", "display_name": "Risinek", "link": "https://stackoverflow.com/users/3035795/risinek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "accepted_answer_id": 40629530, "answer_count": 2, "score": -2, "last_activity_date": 1479292661, "creation_date": 1479291389, "last_edit_date": 1479291839, "question_id": 40629479, "link": "https://stackoverflow.com/questions/40629479/c-header-file-ifndef-include-error", "title": "C header file #ifndef #include error", "body": "<p>I'm trying to figure out, how to use C headers with #ifndef and #include.\nLets say I have these two header files:</p>\n\n<p><strong>headerA.h:</strong></p>\n\n<pre><code>#ifndef HEADERA_H\n#define HEADERA_H\n\n#include \"headerB.h\"\n\ntypedef int MyInt;\nTFoo foo;\n... some other structures from headerB.h ...\n\n#endif\n</code></pre>\n\n<p><strong>headerB.h</strong></p>\n\n<pre><code>#ifndef HEADERB_H\n#define HEADERB_H\n\n#include \"headerA.h\"\n\ntypedef struct foo{\n    MyInt x;\n} TFoo;\n\n#endif\n</code></pre>\n\n<p><strong>headerA.c</strong></p>\n\n<pre><code>#include \"headerA.h\"\n\n... some code ...\n</code></pre>\n\n<p><strong>headerB.c</strong></p>\n\n<pre><code>#include \"headerB.h\"\n\n... some code ...\n</code></pre>\n\n<p>When compiling headerB.c, it says </p>\n\n<pre><code>In file included from headerB.h,\n                 from headerB.c:\nheaderA.h: error: unknown type name \u2018MyInt\u2019\n</code></pre>\n\n<p>I think, it's becouse when <strong>headerB.h</strong> is compiling, it defines <strong>HEADERB_H</strong> and then, when <strong>headerA.h</strong> wants to include <strong>headerB.h</strong>, the <code>#ifndef HEADERA_H</code> is false = skips including.</p>\n\n<p>What is the best practice here? I just read, that best practice is to do all <code>#include</code> directives in header files, but in this situation it looks like a problem.</p>\n\n<p>EDIT: Ok, sorry for misleading you. This is just and example from bigger project with more files.</p>\n"}, {"tags": ["python", "c", "uart"], "comments": [{"owner": {"reputation": 1207, "user_id": 5480526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Hj01gbNGkXk/AAAAAAAAAAI/AAAAAAAAAQg/gKDDaDE7gjw/photo.jpg?sz=128", "display_name": "Sven Festersen", "link": "https://stackoverflow.com/users/5480526/sven-festersen"}, "edited": false, "score": 0, "creation_date": 1479291771, "post_id": 40629326, "comment_id": 68491895, "body": "I&#39;m not sure I understand what the problem is exactly. Where do you want to read the string &quot;hello&quot;? On your device? Or does the device send a string &quot;hello&quot; that you want to read in Python? Please make your question more specific."}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "reply_to_user": {"reputation": 1207, "user_id": 5480526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Hj01gbNGkXk/AAAAAAAAAAI/AAAAAAAAAQg/gKDDaDE7gjw/photo.jpg?sz=128", "display_name": "Sven Festersen", "link": "https://stackoverflow.com/users/5480526/sven-festersen"}, "edited": false, "score": 0, "creation_date": 1479291994, "post_id": 40629326, "comment_id": 68492048, "body": "I send the string hello, my device is already able to write it, however how could I recover that string from the COM4, by using my device in order to read it. is it clear now?"}, {"owner": {"reputation": 1207, "user_id": 5480526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Hj01gbNGkXk/AAAAAAAAAAI/AAAAAAAAAQg/gKDDaDE7gjw/photo.jpg?sz=128", "display_name": "Sven Festersen", "link": "https://stackoverflow.com/users/5480526/sven-festersen"}, "edited": false, "score": 0, "creation_date": 1479292179, "post_id": 40629326, "comment_id": 68492204, "body": "So you want to read the data on COM4 from your device? If that is the case, this is not a Python question, but a C question (you say that your device is running a C program). Unfortunately, I&#39;m not a C expert and don&#39;t have a quick answer for that problem..."}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "reply_to_user": {"reputation": 1207, "user_id": 5480526, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Hj01gbNGkXk/AAAAAAAAAAI/AAAAAAAAAQg/gKDDaDE7gjw/photo.jpg?sz=128", "display_name": "Sven Festersen", "link": "https://stackoverflow.com/users/5480526/sven-festersen"}, "edited": false, "score": 0, "creation_date": 1479292247, "post_id": 40629326, "comment_id": 68492254, "body": "@Sven Feestersen, thank you very much i must edit my question"}, {"owner": {"reputation": 4826, "user_id": 193789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/a17cc57e47435930a48f7c80bcd53863?s=128&d=identicon&r=PG", "display_name": "kebs", "link": "https://stackoverflow.com/users/193789/kebs"}, "edited": false, "score": 0, "creation_date": 1479292341, "post_id": 40629326, "comment_id": 68492325, "body": "Please add tag:python"}, {"owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "edited": false, "score": 0, "creation_date": 1479315242, "post_id": 40629326, "comment_id": 68507836, "body": "I don&#39;t receive any answer, there is no one  that can help me please."}], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 4718289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-m4tk_1agyL4/AAAAAAAAAAI/AAAAAAAAAAA/TqX2AIvgCR0/photo.jpg?sz=128", "display_name": "da66en", "link": "https://stackoverflow.com/users/4718289/da66en"}, "is_accepted": false, "score": 0, "last_activity_date": 1479343122, "creation_date": 1479343122, "answer_id": 40644853, "question_id": 40629326, "link": "https://stackoverflow.com/questions/40629326/how-to-read-data-that-is-written-from-a-communication-port/40644853#40644853", "title": "how to read data that is written from a communication Port?", "body": "<p>This process differs based on the operating system.  Here's a good library that supports Linux and Windows:\n<a href=\"http://www.teuniz.net/RS-232/\" rel=\"nofollow noreferrer\">http://www.teuniz.net/RS-232/</a></p>\n"}], "owner": {"reputation": 19, "user_id": 7161303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4549cbed03d6aea41212d777979234c?s=128&d=identicon&r=PG&f=1", "display_name": "user7161303", "link": "https://stackoverflow.com/users/7161303/user7161303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479343122, "creation_date": 1479291043, "last_edit_date": 1479292426, "question_id": 40629326, "link": "https://stackoverflow.com/questions/40629326/how-to-read-data-that-is-written-from-a-communication-port", "title": "how to read data that is written from a communication Port?", "body": "<p>I try to make communication between my device and python code via COM4 a communication port:  pyserial communication.\nSo at first I try to send and write a hello then to read the output of my device, \nBut the problem for me is how to read the hello that is sent firstly. I mean that I want to read the string  hello on COM4 from my device</p>\n\n<pre><code> import serial\n    ser = serial.Serial(\n        port='COM4',\\\n        baudrate= 230400)  # open serial port\n    print(ser.name)         # check which port was really used\n    #ser.write(b'hello\\n')     # write a string\n    #str=ser.readline()\n    while True:\n        print(ser.read(30).decode())\n    ser.close()             # close ports\n</code></pre>\n\n<p>The code of my device is written in C language.</p>\n\n<p>I would be very grateful if you could guide me please. </p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "edited": false, "score": 0, "creation_date": 1479291070, "post_id": 40629051, "comment_id": 68491437, "body": "This may not be your error (as they&#39;re equal on many platforms), but you&#39;re supposed to use <code>AF_INET</code> only for the <code>sockaddr_in</code> structures, and use <code>PF_INET</code> instead when calling <code>socket()</code>."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1479291533, "post_id": 40629051, "comment_id": 68491736, "body": "you don&#39;t check if <code>listen</code> fails."}], "answers": [{"comments": [{"owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "reply_to_user": {"reputation": 105, "user_id": 6415767, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/544779e928b0aa7e7c2e84f77cde2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pirates", "link": "https://stackoverflow.com/users/6415767/pirates"}, "edited": false, "score": 1, "creation_date": 1479293215, "post_id": 40629647, "comment_id": 68492914, "body": "@Pirates Also, here is my omission - you should use <code>_Exit() &#47; _exit()</code> instead of traditional <code>exit()</code>. See <a href=\"http://stackoverflow.com/q/2329640/2878070\">here</a> for details."}], "tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 2, "last_activity_date": 1479293237, "last_edit_date": 1479293237, "creation_date": 1479291866, "answer_id": 40629647, "question_id": 40629051, "link": "https://stackoverflow.com/questions/40629051/i-am-getting-a-operation-not-supported-error/40629647#40629647", "title": "I am getting a Operation not supported error", "body": "<p>You should terminate child process when the game becomes finished. But instead you are trying to iterate over <code>accept()</code> loop using already closed <code>sock</code> descriptor:</p>\n\n<pre><code>if(pid == 0)\n{\n    //close the listening port, play hangman\n    close(sock);\n    play_hangman (fd, fd);            \n    // child has done its job, terminate immediately\n    _Exit(0);\n}\n//else, it is parent, ignore child and guest, listen for more guests to make more children with\nelse {\n    close (fd);\n}\n</code></pre>\n\n<p>Probably when your child is running <code>play_hangman()</code> value that is stored in <code>sock</code> may be reused for some another file, since we've closed that descriptor before. And that new file is definitely not a listening socket. As result <code>accept()</code> fails with <code>Operation not supported</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 6415767, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/544779e928b0aa7e7c2e84f77cde2f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Pirates", "link": "https://stackoverflow.com/users/6415767/pirates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2702, "favorite_count": 0, "accepted_answer_id": 40629647, "answer_count": 1, "score": 1, "last_activity_date": 1479293237, "creation_date": 1479290344, "question_id": 40629051, "link": "https://stackoverflow.com/questions/40629051/i-am-getting-a-operation-not-supported-error", "title": "I am getting a Operation not supported error", "body": "<p>I am using Ubuntu on virtual box and I have a virtual hangman game using a server and client. Multiple clients can connect to the server at once but when the the game is finished this is the error that comes up on the server \"accepting connection:Operation not supported\"</p>\n\n<p>Here is my code</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;syslog.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n\nextern time_t time ();\n\nint maxlives = 12;\nchar *word [] = {\n# include \"words\"\n};\n# define NUM_OF_WORDS (sizeof (word) / sizeof (word [0]))\n# define MAXLEN 80 /* Maximum size in the world of Any string */\n# define HANGMAN_TCP_PORT 1066\n\nint main ()\n{\nint sock, fd, client_len;\npid_t pid;\nstruct sockaddr_in server, client;\n\nsrand ((int) time ((long *) 0)); /* randomize the seed */\n\nsock = socket (AF_INET, SOCK_STREAM, 0);//0 or IPPROTO_TCP\nif (sock &lt;0) { //This error checking is the code Stevens wraps in his Socket Function etc\n    perror (\"creating stream socket\");\n    exit (1);\n}\n\nserver.sin_family = AF_INET;\nserver.sin_addr.s_addr = htonl(INADDR_ANY);\nserver.sin_port = htons(HANGMAN_TCP_PORT);\n\nif (bind(sock, (struct sockaddr *) &amp; server, sizeof(server)) &lt;0) {\n    perror (\"binding socket\");\n    exit (2);\n}\n\nlisten (sock, 5);\n\nwhile (1) {\n    client_len = sizeof (client);\n    if ((fd = accept (sock, (struct sockaddr *) &amp;client, &amp;client_len)) &lt;0) \n            {\n        perror (\"accepting connection\");\n        exit (3);\n    }\n    else\n    {   \n        //make a child using fork();\n        // fork();\n        pid = fork();\n\n    //if id == 0, it is child           \n    if(pid ==0)\n        {\n        //close the listening port, play hangman\n          close(sock);\n              play_hangman (fd, fd);            \n\n        close(fd);\n    }\n    //else, it is parent, ignore child and guest, listen for more guests to make more children with\n       else {\n    close (fd);\n  }\n   }\n  }\n close(fd);\n  }\n\n /* ---------------- Play_hangman () ---------------------*/\n\nplay_hangman (int in, int out)\n{\n   char * whole_word, part_word [MAXLEN],\nguess[MAXLEN], outbuf [MAXLEN];\n\nint lives = maxlives;\nint game_state = 'I';//I = Incomplete\nint i, good_guess, word_length;\nchar hostname[MAXLEN];\n\ngethostname (hostname, MAXLEN);\nsprintf(outbuf, \"Playing hangman on host% s: \\n \\n\", hostname);\nwrite(out, outbuf, strlen (outbuf));\n\n/* Pick a word at random from the list */\nwhole_word = word[rand() % NUM_OF_WORDS];\nword_length = strlen(whole_word);\nsyslog (LOG_USER | LOG_INFO, \"server chose hangman word %s\", whole_word);\n\n/* No letters are guessed Initially */\nfor (i = 0; i &lt;word_length; i++)\n    part_word[i]='-';\n\npart_word[i] = '\\0';\n\nsprintf (outbuf, \"%s %d \\n\", part_word, lives);\nwrite (out, outbuf, strlen(outbuf));\n\nwhile (game_state == 'I')\n/* Get a letter from player guess */\n{\n    while (read (in, guess, MAXLEN) &lt;0) {\n        if (errno != EINTR)\n            exit (4);\n        printf (\"re-read the startin \\n\");\n        } /* Re-start read () if interrupted by signal */\ngood_guess = 0;\nfor (i = 0; i &lt;word_length; i++) {\n    if (guess [0] == whole_word [i]) {\n    good_guess = 1;\n    part_word [i] = whole_word [i];\n    }\n}\nif (! good_guess) lives--;\nif (strcmp (whole_word, part_word) == 0)\n    game_state = 'W'; /* W ==&gt; User Won */\nelse if (lives == 0) {\n    game_state = 'L'; /* L ==&gt; User Lost */\n    strcpy (part_word, whole_word); /* User Show the word */\n}\nsprintf (outbuf, \"%s %d \\n\", part_word, lives);\nwrite (out, outbuf, strlen (outbuf));\n}\n}\n</code></pre>\n\n<p>I found out the problem seems to be here</p>\n\n<p>//HERE</p>\n\n<pre><code>while (1) {\n    client_len = sizeof (client);\n    if ((fd = accept (sock, (struct sockaddr *) &amp;client, &amp;client_len)) &lt;0) \n            {\n\n         perror (\"accepting connection\"); \n        exit (3);\n    }\n    else\n    {   \n        //make a child using fork();\n        // fork();\n        pid = fork();\n</code></pre>\n\n<p>//HERE</p>\n\n<p>But I don't know what is wrong or how to fix this error.</p>\n"}, {"tags": ["c", "linker", "shared-libraries"], "comments": [{"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 1, "creation_date": 1479293069, "post_id": 40629041, "comment_id": 68492819, "body": "I don&#39;t think there&#39;s a way to achieve this without resorting to dlsym or dlmopen."}], "owner": {"reputation": 610, "user_id": 3343043, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/748cbcb324fd3e0dc2d80cd9fa5682b0?s=128&d=identicon&r=PG&f=1", "display_name": "wesolyromek", "link": "https://stackoverflow.com/users/3343043/wesolyromek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479290318, "creation_date": 1479290318, "question_id": 40629041, "link": "https://stackoverflow.com/questions/40629041/loading-two-different-versions-of-the-same-shared-library", "title": "Loading two different versions of the same shared library", "body": "<p>I'm in a situation that's quite similar to the following. There's <code>libA.so</code> that depending on some compile time flags exhibits slightly different behaviour (it's an external lib, and I can't modify the source). Then, I have <code>libB.so</code> that depends on <code>libA.so</code> (compiled with say <code>-DVALUE=1</code>), and in my executable I depend both on <code>libB.so</code>, as well as on <code>libA.so</code>, but compiled with <code>-DVALUE=0</code>. However, once I launch it, ld resolves all symbols with one of <code>libA.so</code> versions, so both my executable and <code>libB.so</code> are using the same functions.</p>\n\n<p>Is there any way to specify that I want to load resolve undefined symbols of <code>libB.so</code> only using its dependencies? I've tried using <code>-Wl,-Bgroup</code> flag when building <code>libB.so</code>, but it didn't change anything. I know there's <code>dlmopen</code> that can load the library in a new namespace, but I'd like to have it loaded automatically at startup.</p>\n\n<p>I'm attaching a set of files that reproduce the behaviour:</p>\n\n<p>libA.so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define _STR(x) #x\n#define STR(x) _STR(x)\n\n#ifndef VALUE\n#define VALUE default\n#endif\n\nvoid func2() {\n    printf(STR(VALUE) \"\\n\");\n}\n\nvoid func() {\n    func2();\n}\n</code></pre>\n\n<p>libB.so:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern void func(void);\n\nvoid b_func() {\n    func();\n}\n</code></pre>\n\n<p>executable:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern void b_func(void);\nextern void func(void);\n\nint main() {\n    func();    // should print \"default\"\n    b_func();  // should print \"other\"\n}\n</code></pre>\n\n<p>build commands:</p>\n\n<pre><code>gcc -fPIC -shared A.c -o libA.so\ngcc -fPIC -shared -DVALUE=other A.c -o libA2.so\ngcc -fPIC -shared B.c -L. -lA2 -o libB.so\ngcc main.c -L. -lA -lB -o main\n</code></pre>\n\n<p>Curiously, it all works fine on OS X.</p>\n"}, {"tags": ["android", "c", "linux", "wifi-direct"], "owner": {"reputation": 89, "user_id": 7131886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb18127c335f1c14f93f3cd52f16887a?s=128&d=identicon&r=PG&f=1", "display_name": "Aodren BARY", "link": "https://stackoverflow.com/users/7131886/aodren-bary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1391, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1479391728, "creation_date": 1479290156, "last_edit_date": 1479391728, "question_id": 40628973, "link": "https://stackoverflow.com/questions/40628973/wi-fi-direct-between-android-and-linux", "title": "Wi-Fi Direct between android and Linux", "body": "<p>I have a little problem to connect a linux with Android using <a href=\"https://en.wikipedia.org/wiki/Wi-Fi_Direct\" rel=\"nofollow noreferrer\">Wi-Fi Direct</a>. <br />\n<br /> \nOn my Linux : I use : <br /></p>\n\n<pre><code>p2p_find\np2p_peers\np2p_prov_disc &lt;ANDROID:MAC&gt; keypad\n</code></pre>\n\n<p>I got the response :\n<code>P2P-PROV-DISC-SHOW-PIN 96:35:0a:d5:83:e8 44779443</code></p>\n\n<p>On Android I use this code :</p>\n\n<pre><code>bsend.setOnClickListener(new View.OnClickListener(){\n        @Override\n        public void onClick(View v)\n        {\n            System.out.println(\"Click Connection :\");\n            WifiP2pConfig config = new WifiP2pConfig();\n            if (peers.size() == 0)\n            {\n                System.out.println(\"No peers found , MAC test : 00:e0:4c:61:0f:d0\");\n                config.deviceAddress = \"00:e0:4c:61:0f:d0\";\n            }\n            else \n            {\n                WifiP2pDevice device = (WifiP2pDevice) peers.get(0);\n                config.deviceAddress = device.deviceAddress;\n                System.out.println(\"Connection to: \" + config.deviceAddress);\n            }\n            config.wps.setup = WpsInfo.DISPLAY;\n            config.wps.pin = pin.getText().toString();\n            config.groupOwnerIntent = 0;\n            mManager.connect(mChannel, config, new WifiP2pManager.ActionListener() {\n                @Override\n                public void onSuccess() {\n                    System.out.println(\"Connection Suceess\");\n                }\n                @Override\n                public void onFailure(int i) {\n                    Toast.makeText(MainActivity.this, \"Connect failed. Retry.\",\n                            Toast.LENGTH_SHORT).show();\n                    System.out.println(i);\n                    System.out.println(\"Connection failed\");\n                }\n            });\n        }\n    });\n</code></pre>\n\n<p>On my Logcat I got :</p>\n\n<pre><code>Click Connection :\ncode :44779443\nConnection to: 00:e0:4c:61:0f:d0\n2\nConnection failed\n</code></pre>\n\n<p>ifconfig on my Linux :<code>HWaddr 00:e0:4c:61:0f:d0</code></p>\n\n<p>I am new with Android, I don't know if can't print a \"errno\" coresponding to my failure code. And I dont see in the class <a href=\"https://developer.android.com/reference/android/net/wifi/p2p/WifiP2pManager.html\" rel=\"nofollow noreferrer\">WifiP2pManager</a> an interface for a callback function failure connection.</p>\n\n<p>Edit: I also tried <code>config.wps.setup = WpsInfo.KEYPAD;</code> and I think it's more accurate.</p>\n\n<p>Edit:I'm stupid, that worked fine, it's just i push twice the connect button (yeah I thought I mistaken somewhere with event managament).<Br />\nSo i used PBC method now : <br /></p>\n\n<pre><code>config.wps.setup = WpsInfo.PBC;\nconfig.groupOwnerIntent = 0;\n</code></pre>\n\n<p>After that I created a Socket :</p>\n\n<pre><code>new Thread(new Runnable() {\n    @Override\n    public void run() {\n        try {\n        Socket socket = new Socket(\"192.168.0.1\", 4242);\n        if (socket.isConnected())\n        {\n            System.out.println(\"Connection ok\");\n        }\n        else\n            System.out.println(\"connection failed\");\n        }catch (IOException e)\n        {\n             System.out.println(e);\n        }\n\n    }\n}).start();\n</code></pre>\n\n<p>But I got :<code>java.net.ConnectException: failed to connect to /192.168.0.1 (port 4242): connect failed: ENETUNREACH (Network is unreachable)</code><br />\nWhy on my c program basically i made :</p>\n\n<pre><code>-&gt; connection to wpa_supplicant using wpa_ctrl.c\n-&gt; PING REQUEST to wpa_supplicant, reponse : PONG\n-&gt; P2p find\n-&gt; socket, bind , listen... No error return\n-&gt; p2p peer FIRST ( i dont manage all device for now)\n-&gt; p2p_prov_disc MAC::address pbc\n-&gt; using Select for checking Connection for accept\n</code></pre>\n\n<p>If I got a connection Success why I got Network unreachable?\nAnd when I click to connect I go in the callack function OnpeersAvailable and no in OnConnectionInfoAvailable...</p>\n"}, {"tags": ["c", "arrays", "malloc", "dynamic-allocation"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479290191, "post_id": 40628961, "comment_id": 68490865, "body": "try running a memory debugger like valgrind first."}], "answers": [{"tags": [], "owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "is_accepted": false, "score": 0, "last_activity_date": 1479290742, "creation_date": 1479290742, "answer_id": 40629220, "question_id": 40628961, "link": "https://stackoverflow.com/questions/40628961/allocate-dynamic-structure-array/40629220#40629220", "title": "allocate dynamic structure array", "body": "<p><em>(BTW, in C you don't need to cast the return value of <code>malloc()</code>: If it doesn't compile without a cast, you've made a mistake)</em></p>\n\n<p>The code you find weird involves allocating all arrays in a single buffer: This allows for better \"memory locality\" (i.e. related things being together in memory) at the price of not being able to modify arrays individually: It's good for performance but only useful for data that is initialized once and does not change over time (or at least, whose size does not change over time).</p>\n\n<p>It also allows you to free the whole thing with only one call to <code>free()</code> and makes error handling much simpler (since you don't have to check that all <code>malloc()</code> calls in a loop succeed, and if not, free all calls that had succeeded so far and not others...)</p>\n"}], "owner": {"reputation": 65, "user_id": 4636923, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ce0fa96b33c949435736d6a4e99d4ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Marien", "link": "https://stackoverflow.com/users/4636923/marien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479290742, "creation_date": 1479290134, "question_id": 40628961, "link": "https://stackoverflow.com/questions/40628961/allocate-dynamic-structure-array", "title": "allocate dynamic structure array", "body": "<p>I'm trying to use dynamic array of a structure containning dynamic array.\nThe allocation is done in the function build_resuts and the memory is freed in the function free_data.</p>\n\n<p>Am I doing this correctly ?</p>\n\n<pre><code>typedef struct InputResultsLine \n{\n    long registered;\n    long *candidates;\n} InputResultsLine;\n\nvoid func()\n{\n    InputResultsLine *data, totals;\n    int nbPollingPlaces = 10;\n\n    build_results(&amp;data, &amp;totals,  5, nbPollingPlaces);     \n\n    free_data(&amp;data, &amp;totals, nbPollingPlaces); \n}\n\nvoid build_results(InputResultsLine **data, InputResultsLine *totals, int nbCandidates, int nbPollingPlaces)\n{   \n    int i;\n    InputResultsLine *ptrCurrentLine;\n\n    totals-&gt;candidates = (long*) malloc(nbCandidates * sizeof(long));       \n\n    *data = (InputResultsLine*) malloc(nbPollingPlaces * sizeof(InputResultsLine));\n\n    for(i = 0; i &lt; nbPollingPlaces; i++)\n    {       \n        ptrCurrentLine = &amp;((*data)[i]);\n        ptrCurrentLine-&gt;candidates = (long*) malloc(nbCandidates * sizeof(long));\n\n        // [...]    \n    }   \n}\n\nvoid free_data(InputResultsLine **data, InputResultsLine *totals, int nbPollingPlaces)\n{\n    int i;  \n\n    for(i = 0; i &lt; nbPollingPlaces; i++)\n    {\n        free(((*data)[i]).candidates);\n    }\n\n    free(totals-&gt;candidates);\n    free(*data);\n}\n</code></pre>\n\n<p>I saw samples where the allocation was like :</p>\n\n<pre><code>*data = (InputResultsLine*) malloc(nbPollingPlaces * (sizeof(InputResultsLine) + nbCandidates * sizeof(long)));\n</code></pre>\n\n<p>So i'm not sure how I should do and why :</p>\n"}, {"tags": ["c", "variadic-functions"], "answers": [{"comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479289916, "post_id": 40628824, "comment_id": 68490660, "body": "The variadic macro should expand to <code>S_PASS</code> to match the return value of the empty function."}, {"owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479289929, "post_id": 40628824, "comment_id": 68490670, "body": "Yea, that would mostly be the same as the second variant. Yet, is that correct? Can I just declare variadic params to a function and never use va_start and va_end?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1479290034, "post_id": 40628824, "comment_id": 68490748, "body": "@mch Yes you&#39;re correct. Updated answer accordingly."}, {"owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479290114, "post_id": 40628824, "comment_id": 68490808, "body": "Ah yea now I see. Sounds pretty good to me. And how would I handle such function-style macro definitions, when I have a header that declares these logging functions?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479290136, "post_id": 40628824, "comment_id": 68490825, "body": "@baeda No it&#39;s <i>not</i> the same as the second variant of your. In your second variant there is still a function call. If using the macro in my answer there&#39;s no function call, just a value that the compiler might be able to optimize out if you don&#39;t use it."}, {"owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479291224, "post_id": 40628824, "comment_id": 68491540, "body": "@Someprogrammerdude The only issue I am having with this (and sadly I didn&#39;t know this up front) is that the code base using this logger is also taking function pointers to it in various places. So replacing the whole thing with a macro is out of the question."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479291331, "post_id": 40628824, "comment_id": 68491622, "body": "@baeda Updated my answer. Please update your question with this information as well."}, {"owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479292005, "post_id": 40628824, "comment_id": 68492058, "body": "@Someprogrammerdude Okay fine. That leads me back to the original question: when I declare a function with variadic params, is it then ok to not call va_start and va_end?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 1, "creation_date": 1479292355, "post_id": 40628824, "comment_id": 68492331, "body": "@baeda  Yes it&#39;s okay not to &quot;call&quot; the <code>va</code> macros."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1479291320, "last_edit_date": 1479291320, "creation_date": 1479289777, "answer_id": 40628824, "question_id": 40628685, "link": "https://stackoverflow.com/questions/40628685/variadic-logger-dispatcher/40628824#40628824", "title": "Variadic logger dispatcher", "body": "<p>If <em>no</em> logging was enabled, I would suggest you instead had simply an empty function, or maybe a variadic macro that expands to <code>S_PASS</code>.</p>\n\n<p>Perhaps something like</p>\n\n<pre><code>#if defined(LOG_UART) || defined(LOG_SYS)\ninline int32_t logf(const char *fmt, ...)\n{\n    // Your original code here...\n}\n#else\n# define logf(x, ...) S_PASS\n#endif\n</code></pre>\n\n<hr>\n\n<p>The above is if you define the function in your header. If you only have a declaration in your header with the definition in a source file it's almost the same.</p>\n\n<p>Header file:</p>\n\n<pre><code>#if defined(LOG_UART) || defined(LOG_SYS)\nint32_t logf(const char *fmt, ...);\n#else\n# define logf(x, ...) S_PASS\n#endif\n</code></pre>\n\n<p>Source file:</p>\n\n<pre><code>#if defined(LOG_UART) || defined(LOG_SYS)\ninline int32_t logf(const char *fmt, ...)\n{\n    // Your original code here...\n}\n#endif\n</code></pre>\n\n<hr>\n\n<p>After your comment about function pointers, then the best solution is probably to have a inline function function which <em>only</em> does <code>return</code>S_PASS`:</p>\n\n<pre><code>#if defined(LOG_UART) || defined(LOG_SYS)\nint32_t logf(const char *fmt, ...);\n#else\ninline int32_t logf(const char *fmt, ...) { return S_PASS; }\n#endif\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "edited": false, "score": 0, "creation_date": 1479290593, "post_id": 40628997, "comment_id": 68491116, "body": "Very useful info about copying the va_list and wrapping in separate vlogf!"}], "tags": [], "owner": {"reputation": 6288, "user_id": 1455631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9b8e88a8dbed8a574ed79d075c3f924?s=128&d=identicon&r=PG", "display_name": "Medinoc", "link": "https://stackoverflow.com/users/1455631/medinoc"}, "is_accepted": false, "score": 1, "last_activity_date": 1479290226, "creation_date": 1479290226, "answer_id": 40628997, "question_id": 40628685, "link": "https://stackoverflow.com/questions/40628685/variadic-logger-dispatcher/40628997#40628997", "title": "Variadic logger dispatcher", "body": "<p>It's a bit of a moot point because you're shooting yourself in the foot when you propose <em>only</em> a variadic function. Your variadic function should always be a wrapper to a <code>va_list</code> one:</p>\n\n<pre><code>int32_t vlogf(const char *fmt, va_list va);\n\nint32_t logf(const char *fmt, ...)\n{\n    int32_t res;\n    va_list va;\n    va_start(va, fmt);\n\n    res = vlogf(fmt, va);\n\n    va_end(va);\n}\n</code></pre>\n\n<p>In addition, you're not supposed to use the same <code>va_list</code> twice, so if both macros are defined, you need to <code>va_copy</code> it:</p>\n\n<pre><code>int32_t vlogf(const char *fmt, va_list va)\n{\n    i32        res;\n\n    res = S_PASS;\n\n#if defined(LOG_UART) &amp;&amp; defined(LOG_SYS)\n\n    /*Can't use the same va_list twice: */\n    /*If both are defined, need to use va_copy*/\n    {\n        va_list    va2;\n        va_copy(va2, va);\n\n        res = Uart_vprintf(fmt, va);\n        if (res != S_PASS) goto exit2;\n\n        res = System_vprintf(fmt, va);\n    exit2:\n        va_end(va2);\n    }\n    if (res != S_PASS) goto exit;\n\n#elif defined(LOG_UART)\n    res = Uart_vprintf(fmt, va);\n    if (res != S_PASS) goto exit;\n#elif defined(LOG_SYS)\n    res = System_vprintf(fmt, va);\n    if (res != S_PASS) goto exit;\n#endif /* LOG_SYS */\n\nexit:\n    return res;\n}\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 3493080, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/128Cm.png?s=128&g=1", "display_name": "baeda", "link": "https://stackoverflow.com/users/3493080/baeda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 40628824, "answer_count": 2, "score": 1, "last_activity_date": 1479292895, "creation_date": 1479289470, "last_edit_date": 1479292895, "question_id": 40628685, "link": "https://stackoverflow.com/questions/40628685/variadic-logger-dispatcher", "title": "Variadic logger dispatcher", "body": "<p>I am implementing sort of a logging dispatcher, i.e. <code>int32_t logf(const char *fmt, ...);</code> which outputs to different logging targets, depending on which options it was compiled with.</p>\n\n<p>The following is a boiled down excerpt.</p>\n\n<pre><code>int32_t logf(const char *fmt, ...)\n{\n    va_list    va;\n    i32        res;\n\n    va_start(va, fmt);\n\n    res = S_PASS;\n\n#ifdef LOG_UART\n    res = Uart_vprintf(fmt, va);\n    if (res != S_PASS) goto exit;\n#endif /* LOG_UART */\n\n#ifdef LOG_SYS\n    res = System_vprintf(fmt, va);\n    if (res != S_PASS) goto exit;\n#endif /* LOG_SYS */\n\nexit:\n    va_end(va);\n\n    return res;\n}\n</code></pre>\n\n<p>Now... If no options are given, the logger would (and actually is intended to) be a null-logger. However, do I then still need the calls to <code>va_start()</code> and <code>va_end()</code> in there?</p>\n\n<p>In other words (ignoring -Wunused-label for a second), is this correct:</p>\n\n<pre><code>int32_t logf(const char *fmt, ...)\n{\n    va_list    va;\n    i32        res;\n\n    va_start(va, fmt);\n\n    res = S_PASS;\n\nexit:\n    va_end(va);\n\n    return res;\n}\n</code></pre>\n\n<p>...or this?</p>\n\n<pre><code>int32_t logf(const char *fmt, ...)\n{\n    i32        res;\n\n    res = S_PASS;\n\n    return res;\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The resulting <em>empty</em> function implementation cannot be replaced by a function-style macro like <code>#define logf(fmt, ...) S_PASS;</code>.</p>\n\n<p>The existing code base has defined <code>typedef int32_t(*logFunc)(const char *fmt, ...);</code> and therefore pointers to logf must be storable. </p>\n"}, {"tags": ["c", "sonarqube"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479290029, "post_id": 40628509, "comment_id": 68490739, "body": "I wonder where this tool gets its rules from. Seems like some home-brewed coding standard. I don&#39;t see why casting to <code>(void)</code> would ever be dangerous or harmful. Do they give a rationale for it?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479290179, "post_id": 40628509, "comment_id": 68490858, "body": "Consider for example <code>(void) func();</code> versus <code>func()</code>. The former means &quot;yes I know that the function returns a value but I have chosen to ignore it&quot;. While the latter means &quot;either I don&#39;t know that the function returns a value, or I have just forgotten to check it, or possibly I&#39;m just ignoring it&quot;. The former is good and safe, self-documenting code. The latter is bad practice and a potential bug."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479290413, "post_id": 40628509, "comment_id": 68490993, "body": "@Lundin MISRA has the same rule."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479297697, "post_id": 40628509, "comment_id": 68495743, "body": "@2501 No, MISRA-C has an explicit exception for such cases. See MISRA-C:2012 2.2 regarding dead code: &quot;Exception. A cast to void is assumed to indicate a value that is intentionally not being used. The cast is therefore not dead code itself. It is treated as using its operand which is therefore also not dead code.&quot;."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479297966, "post_id": 40628509, "comment_id": 68495918, "body": "@Lundin  I was using the 2004 version. Can you check if 2012 has the same rule: <i>Rule 14.2 (required):  All non-null statements shall either: have at least one side-effect however executed, or (a) cause control flow to change.</i> ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479298581, "post_id": 40628509, "comment_id": 68496293, "body": "@2501 As far as I can tell, 2012 2.2 replaces 2004 14.2. The document now speaks of both &quot;unreachable code&quot; (rule 2.1, code which is never executed) and &quot;dead code&quot; (rule 2.2, null statements, statements with no side-effects etc)."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479298766, "post_id": 40628509, "comment_id": 68496409, "body": "@Lundin Thanks. It seems sonarqube is using 2004 then."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479299374, "post_id": 40628509, "comment_id": 68496823, "body": "@2501 It is not really clear if this was a MISRA 2004 violation. I have a faint memory of someone bringing up the case of void casts with the committee. The quoted exception was not part of the 2012 draft, so maybe this was added during the 2012 review."}], "owner": {"reputation": 31, "user_id": 7166531, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BE0H3GRxcIk/AAAAAAAAAAI/AAAAAAAAEeA/cR8O6DRZZyE/photo.jpg?sz=128", "display_name": "Patrik Brattstr&#246;m", "link": "https://stackoverflow.com/users/7166531/patrik-brattstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1479292361, "creation_date": 1479288939, "question_id": 40628509, "link": "https://stackoverflow.com/questions/40628509/sonarqube-rule-cs905-void-cast-violation", "title": "SonarQube rule c:S905 void cast violation", "body": "<p>We are using the sonarqube C plugin and have some problems with rule c:S905. The rule make sense and we want to keep it as a critical issue. But we get a lot of violations of this rule when void casting unused parameters in functions, for example in a callback or third party api:s. \nExample:</p>\n\n<pre><code>void handleRequest( Address          sender,\n                    Msg               * request)\n{\n    (void)sender; // Not used in function, but wanted in api. Cast to avoid compiler warning\n\n    ... //Do something\n}\n</code></pre>\n\n<p>Does anyone have a suggestion of how to solve this in a good way? </p>\n"}, {"tags": ["c", "floating-point", "avx"], "comments": [{"owner": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "edited": false, "score": 0, "creation_date": 1479289394, "post_id": 40628195, "comment_id": 68490331, "body": "Too tired for a full answer, but look at sse intrinsics. Also do const vector &amp;u etc to help the compiler."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1479289663, "post_id": 40628195, "comment_id": 68490491, "body": "Actually that is &quot;very few instructions&quot; - you can remove some of the overhead though by making your function <code>inline</code>. Also <code>clang</code> with <code>-O3</code> seems to do a better job with this than <code>gcc</code>: <a href=\"https://godbolt.org/g/QRNOsL\" rel=\"nofollow noreferrer\">godbolt.org/g/QRNOsL</a>"}, {"owner": {"reputation": 173, "user_id": 2124204, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/21eadff82773c96a88b5e8772295c03f?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/2124204/fabio"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1479290471, "post_id": 40628195, "comment_id": 68491032, "body": "@PaulR well at this point why not macros?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1479290544, "post_id": 40628195, "comment_id": 68491078, "body": "@Fabio: macros offer no real advantage over inline functions, and have a few disadvantages too."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 1, "creation_date": 1479293563, "post_id": 40628195, "comment_id": 68493144, "body": "Using AoS layout is generally a bad idea to begin with"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1479315604, "post_id": 40628195, "comment_id": 68508073, "body": "@PaulR: clang&#39;s output isn&#39;t &quot;safe&quot; :/  It can raise FP exceptions that it shouldn&#39;t if there&#39;s garbage in the high halves of the input registers (which the ABI does allow).  It needs to zero the high halves before it can use <code>addps</code>.  It could also slow down if the upper-half results are denormal, which matters even if you don&#39;t care about FP exceptions, unless you have DAZ and FTZ enabled.  (But without <code>-ffast-math</code>, the compile can&#39;t assume either of those.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "edited": false, "score": 1, "creation_date": 1479316006, "post_id": 40628195, "comment_id": 68508358, "body": "@starmole: First of all, this is C question.  Second, passing this struct by const-reference would be strictly worse when it doesn&#39;t inline.  The x86-64 SysV ABI passes this struct by value packed into an XMM register, so it&#39;s all set for a SIMD add.  Passing in memory might help dumb compilers, but gcc still does a bad job passing it by pointer (compared to clang which does a good job in that case (<a href=\"https://godbolt.org/g/YbwF6t\" rel=\"nofollow noreferrer\">godbolt.org/g/YbwF6t</a>); loading with MOVQ solves its failure to zero-extend.  It should probably use MOVSD though, in case some CPUs care about FP vs. int loads.)"}, {"owner": {"reputation": 173, "user_id": 2124204, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/21eadff82773c96a88b5e8772295c03f?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/2124204/fabio"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479410957, "post_id": 40628195, "comment_id": 68557940, "body": "@PeterCordes the link you included in your comment is really useful. I can do online optimization of my code. Thanks!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479412270, "post_id": 40628195, "comment_id": 68558688, "body": "You can do the same thing locally by looking at the asm output (see <a href=\"http://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output\">this Q&amp;A</a>), but yeah Matt Godbolt&#39;s site is pretty damn cool, and has a nicer UI when the code is small enough that you don&#39;t need to search for the right symbol after ever recompile."}, {"owner": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479797797, "post_id": 40628195, "comment_id": 68697092, "body": "@PeterCordes Yes I missed the C. And the keeping floats in the struct. So what is the right answer? The only thing I can think of then is turn the function into a #define. What do you suggest?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "edited": false, "score": 0, "creation_date": 1479798546, "post_id": 40628195, "comment_id": 68697399, "body": "@starmole: Already posted my proposed optimal ABI-compliant implementation <a href=\"http://stackoverflow.com/questions/40628195/data-alignment-in-structure-and-avx-optimization?noredirect=1#comment68507860_40630047\">as a comment on Maxim&#39;s answer</a>.  Obviously it would be much more efficient when inlined, so the compiler could take care of the upper halves of the registers and use just one ADDPS.  Most of the cost of a stand-alone implementation is either unpacking/repacking or zeroing the upper halves!  You don&#39;t need macros just to inline code these days; a <code>static inline</code> function is good."}, {"owner": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479799467, "post_id": 40628195, "comment_id": 68697792, "body": "@PeterCordes It&#39;s the right assembly for that case, but how do you get the compiler to emit it? In this case gcc? How to do it portable?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 4682, "user_id": 360270, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/1gH9s.jpg?s=128&g=1", "display_name": "starmole", "link": "https://stackoverflow.com/users/360270/starmole"}, "edited": false, "score": 0, "creation_date": 1479800200, "post_id": 40628195, "comment_id": 68698181, "body": "@starmole: you inline it, or use <code>-flto</code> so it can be inlined at link-time.  Or if you need an efficient stand-alone definition (maybe to pass as a callback to something in another library?), and you can live with extra FP exceptions, you could just write the stand-alone definition entirely in asm.  (No point using inline-asm; you don&#39;t want the compiler to use an inline-asm definition for any case where it <i>can</i> inline.) ..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479800205, "post_id": 40628195, "comment_id": 68698184, "body": "...   Perhaps you could do something like declare the function as taking <code>struct</code> args that have 4 float members to it doesn&#39;t think there are any unused vector elements.  But IDK if you have to just flat-out lie to the compiler (callers see a prototype that doesn&#39;t match the definition), or if the right amout of casting can do anything useful.  IDK, it doesn&#39;t seem worth worrying about unless you have a specific use-case where it can&#39;t inline to one instruction."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 2124204, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/21eadff82773c96a88b5e8772295c03f?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/2124204/fabio"}, "edited": false, "score": 0, "creation_date": 1479293242, "post_id": 40630047, "comment_id": 68492923, "body": "For the application I am intended to, I need just 2D vectors and float type is enough. However your example was ok to understand (and maybe overcome) the issue. Thank you very much! F"}, {"owner": {"reputation": 173, "user_id": 2124204, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/21eadff82773c96a88b5e8772295c03f?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/2124204/fabio"}, "edited": false, "score": 0, "creation_date": 1479294318, "post_id": 40630047, "comment_id": 68493648, "body": "I wonder where I can find low level instruction reference. For instance it would be possible with just one instruction to compute the total of u*v, and doing the square root, something like a=sqrt(u[0]*v[0]+u[1]*v[1]+...)?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479315217, "post_id": 40630047, "comment_id": 68507824, "body": "What the crap?  That asm is garbage.  Hard to believe it&#39;s actually from gcc 5.4 <code>-O3</code>.  Both adds are done separately with scalar.  4 separate stores to the stack, and a store-forwarding stall to load the result with MOVLPS after separate MOVSS stores.  (And MOVLPS has a false dependency on the destination register; MOVSD would be faster.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479315298, "post_id": 40630047, "comment_id": 68507860, "body": "Optimal would be something like <code>movq %xmm0, %xmm0</code> / <code>movq %xmm1, %xmm1</code> or similar to zero the high halves, then <code>addps %xmm1, %xmm0</code> / <code>ret</code>.  You could write something like that with intrinsics."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1479315354, "post_id": 40630047, "comment_id": 68507904, "body": "@PeterCordes Yep, it could just ignore the unused packed floats in the xmm registers."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1479316165, "post_id": 40630047, "comment_id": 68508481, "body": "It can&#39;t ignore them, it does have to zero them because the ABI allows them to be garbage on input, leading to spurious FP exceptions or slowdowns from denormals.  But after zeroing them, then yes it can do what clang unsafely does (see comments on the question)."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1479293371, "last_edit_date": 1479293371, "creation_date": 1479292935, "answer_id": 40630047, "question_id": 40628195, "link": "https://stackoverflow.com/questions/40628195/data-alignment-in-structure-and-avx-optimization/40630047#40630047", "title": "data alignment in structure and avx optimization", "body": "<p>gcc can generate better code when using the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html\" rel=\"nofollow noreferrer\">Vector Instructions through Built-in Functions</a>:</p>\n\n<pre><code>typedef float v2f __attribute__((vector_size(8)));\n\nv2f add(v2f u, v2f v) {\n  return u + v;\n}\n</code></pre>\n\n<p>Produces:</p>\n\n<pre><code>add(float __vector(2), float __vector(2)):\n    movlps  %xmm0, -32(%rsp)\n    movlps  %xmm1, -40(%rsp)\n    movss   -32(%rsp), %xmm0\n    addss   -40(%rsp), %xmm0\n    movss   %xmm0, -56(%rsp)\n    movss   -28(%rsp), %xmm0\n    addss   -36(%rsp), %xmm0\n    movss   %xmm0, -52(%rsp)\n    movlps  -56(%rsp), %xmm0\n    ret\n</code></pre>\n\n<p>Which is still innefficient because it performs element-wise addition.</p>\n\n<hr>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions\" rel=\"nofollow noreferrer\">xmm registers are 128-bit wide</a>, so that to fully utilize them the code needs to operate on 128-bit units.</p>\n\n<p>In 3D graphics the coordinates are usually 4-element float vectors <code>{x, y, z, w}</code> and that makes xmm registers a perfect fit. E.g.:</p>\n\n<pre><code>typedef float v4f __attribute__((vector_size(16)));\n\nv4f add(v4f u, v4f v) {\n    return u + v;\n}\n</code></pre>\n\n<p>That produces the following assembly for function <code>add</code>:</p>\n\n<pre><code>add(float __vector(4), float __vector(4)):\n    addps   %xmm1, %xmm0\n    ret\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 2124204, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/21eadff82773c96a88b5e8772295c03f?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/2124204/fabio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479293371, "creation_date": 1479288088, "question_id": 40628195, "link": "https://stackoverflow.com/questions/40628195/data-alignment-in-structure-and-avx-optimization", "title": "data alignment in structure and avx optimization", "body": "<p>I'm trying to figure out what is the best (maybe avx?) optimization for this code</p>\n\n<pre><code>typedef struct {\n  float x;\n  float y;\n} vector;\n\nvector add(vector u, vector v){\n  return (vector){u.x+v.x, u.y+v.y};\n}\n</code></pre>\n\n<p>running <code>gcc -S code.c</code> gives a quite long assembly code</p>\n\n<pre><code>    .file   \"code.c\"\n    .text\n    .globl  add\n    .type   add, @function\nadd:\n.LFB0:\n    .cfi_startproc\n    pushq   %rbp\n    .cfi_def_cfa_offset 16\n    .cfi_offset 6, -16\n    movq    %rsp, %rbp\n    .cfi_def_cfa_register 6\n    movq    %rdi, -8(%rbp)\n    movss   16(%rbp), %xmm1\n    movss   48(%rbp), %xmm0\n    addss   %xmm0, %xmm1\n    movss   32(%rbp), %xmm2\n    movss   64(%rbp), %xmm0\n    addss   %xmm2, %xmm0\n    movq    -8(%rbp), %rax\n    movss   %xmm1, (%rax)\n    movq    -8(%rbp), %rax\n    movss   %xmm0, 16(%rax)\n    movq    -8(%rbp), %rax\n    popq    %rbp\n    .cfi_def_cfa 7, 8\n    ret\n    .cfi_endproc\n.LFE0:\n    .size   add, .-add\n    .ident  \"GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609\"\n    .section    .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p>while I expected very few instructions for a so simple task. Could someone help me to optimize this kind of code, while keeping float types?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "ruby", "ruby-native-extensions"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479284810, "post_id": 40627086, "comment_id": 68487562, "body": "Please <a href=\"https://stackoverflow.com/posts/40627086/edit\">edit</a> your question to include at least some of the code directly.  I&#39;m not going to follow random external links."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479285563, "post_id": 40627086, "comment_id": 68488013, "body": "@MartinBonner I debated adding any code when writing the question, but left it out since I was unsure if it would be of any benefit without more context. I&#39;ve since included the line that the core dump says is causing the segfault."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479290395, "post_id": 40627086, "comment_id": 68490977, "body": "Right, so with high probability <code>yyParser</code> is null.  Options:  try inserting <code>assert(yyParser!=NULL);</code> on the line before, or run ruby under gdb and step through your code."}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479290415, "post_id": 40627086, "comment_id": 68490995, "body": "... or add lots of debugging printf statements."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479313172, "post_id": 40627086, "comment_id": 68506375, "body": "@MartinBonner I added <code>assert(yyParser!=NULL);</code> on the line before, but it&#39;s still segfaulting on <code>assert( yypParser-&gt;yytos!=0 );</code>. It seems as though accessing the property is causing the segfault. I&#39;m confused by the fact that it&#39;s suddenly doing this now that it&#39;s being called as a ruby extension but continues to work fine as a standalone library."}, {"owner": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479435446, "post_id": 40627086, "comment_id": 68567486, "body": "I compiled your standalone library for x86_64 (once with clang, once with gcc). The compiler showed some warnings, and the code segfaulted reading <code>yypParser</code> just as you describe. The segfault did not occur in a 32-bit build. The warnings hint towards the cause of the problem -- calling undeclared functions across file boundaries guesses the types wrong."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479485127, "post_id": 40627086, "comment_id": 68592939, "body": "@RJHunter how were you able to control 32/64 bit build? Or were you building just the c library, not the ruby wrapper library? Also, thank you for taking a look!"}, {"owner": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 0, "creation_date": 1479504449, "post_id": 40627086, "comment_id": 68603020, "body": "Just building the C library, no Ruby involved. In my environment, the default build was 64-bit, so a plain old <code>make</code> showed the warnings and the segfault. I expect you&#39;re seeing a difference in Ruby vs non-Ruby because the two builds use a different compiler command-line (CFLAGS etc)."}, {"owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "reply_to_user": {"reputation": 2599, "user_id": 39223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/39e19e0acb0d2809f60f57cec9b50512?s=128&d=identicon&r=PG", "display_name": "RJHunter", "link": "https://stackoverflow.com/users/39223/rjhunter"}, "edited": false, "score": 1, "creation_date": 1479538866, "post_id": 40627086, "comment_id": 68610234, "body": "@RJHunter your comment lead me to the solution! The compiler guessed the wrong type, but wouldn&#39;t have if the header file for the parser specified the functions defined. <code>parser.c</code> is generated by <a href=\"http://www.hwaci.com/sw/lemon/\" rel=\"nofollow noreferrer\">lemon</a> which has an option to make the file compatible with <a href=\"http://www.hwaci.com/sw/mkhdr/\" rel=\"nofollow noreferrer\">makeheaders</a>, a program that generates <code>parser.h</code> <i>with</i> function definitions. Some minor tweaking was necessary to fix up <code>parser.h</code>, but once done and linked correctly it no longer has to guess and <i>presto</i>, it works!"}, {"owner": {"reputation": 1959, "user_id": 1207554, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/02bed14d16954900634cb83771445dc0?s=128&d=identicon&r=PG", "display_name": "Douglas G. Allen", "link": "https://stackoverflow.com/users/1207554/douglas-g-allen"}, "edited": false, "score": 0, "creation_date": 1484098392, "post_id": 40627086, "comment_id": 70367413, "body": "Taking your code as it is from the github repo I find that it fails to compile from to start with checking for fast_numerizer/fast_numerizer.h... no  I look and it&#39;s an empty folder. I must have missed something. Getting late and my eyes are tired of reading bright web pages. Do you use darker themes? Most developers do. Can I change this here?"}], "owner": {"reputation": 6168, "user_id": 435460, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e2d224ddec1592dc623f013100685da0?s=128&d=identicon&r=PG", "display_name": "JesseBuesking", "link": "https://stackoverflow.com/users/435460/jessebuesking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479285792, "creation_date": 1479284394, "last_edit_date": 1479285792, "question_id": 40627086, "link": "https://stackoverflow.com/questions/40627086/ruby-native-wrap-c-library-segfault", "title": "ruby native wrap c library segfault", "body": "<p>I'm attempting to wrap a small <a href=\"https://github.com/JesseBuesking/fast_numerizer\" rel=\"nofollow noreferrer\">library I've written in c</a>, and I think I'm on the home stretch to getting it working. The library has some pretty solid tests around it, and I've ran it through valgrind to remove any memory leaks and glaring issues. It works pretty solid on it's own.</p>\n\n<p>However, when I attempt to wrap it using ruby it segfaults. <a href=\"https://github.com/JesseBuesking/example_project\" rel=\"nofollow noreferrer\">Here's an example project</a> that wraps the library. When the tests in that project are ran, the call to the library segfaults. Running it results in a core abort which I've loaded in gdb to debug, but I'm not sure what's wrong. The core dump says the issue is <a href=\"https://github.com/JesseBuesking/fast_numerizer/blob/0bc243d79224adf8cdbd1477bf2806d2a2df6bc8/parser.c#L1919\" rel=\"nofollow noreferrer\">on this line</a>, but I have no idea what's causing it since the information given is pretty sparse and the code runs well if I run the tests in c land.</p>\n\n<p><em>The line that the core dump says is segfaulting</em>:</p>\n\n<pre><code>assert( yypParser-&gt;yytos!=0 );\n</code></pre>\n\n<p>You can reproduce it by running <code>rake</code> from the root directory which kicks of a process that ultimately generates a shared object that is loaded by the tests. I'm hoping someone with more experience in c can take a look and potentially point me in the right direction.</p>\n\n<p>Please let me know if any more information is needed.</p>\n\n<p><em>Snippet from the core dump</em>:</p>\n\n<pre><code>#0  0x00007f150caa2c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007f150caa6028 in __GI_abort () at abort.c:89\n#2  0x00007f150dba8d8d in die () at error.c:407\n#3  rb_bug_context (ctx=ctx@entry=0x7f150f3b1b80, fmt=fmt@entry=0x7f150dbe2f6a \"Segmentation fault at %p\") at error.c:437\n#4  0x00007f150daa45ce in sigsegv (sig=&lt;optimized out&gt;, info=0x7f150f3b1cb0, ctx=0x7f150f3b1b80) at signal.c:890\n#5  &lt;signal handler called&gt;\n#6  0x00007f150b96b02b in Parse (yyp=0xf9925e0, yymajor=20, yyminor=..., state=0x7ffe17b6a3a0) at parser.c:1919\n#7  0x00007f150b96b8e8 in numerize (data=data@entry=0x7f150b96c1aa \"one\", state=state@entry=0x7ffe17b6a3a0) at ../../../../ext/example_project/fast_numerizer/fast_numerizer.c:102\n#8  0x00007f150b960e0b in example_project_c_code_function () at ../../../../ext/example_project/./example_project.c:11\n</code></pre>\n"}, {"tags": ["c++", "c", "puzzle"], "comments": [{"owner": {"reputation": 41796, "user_id": 1870232, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rbI29.jpg?s=128&g=1", "display_name": "P0W", "link": "https://stackoverflow.com/users/1870232/p0w"}, "edited": false, "score": 0, "creation_date": 1479284045, "post_id": 40626961, "comment_id": 68487183, "body": "For modern processors those are all single operations"}, {"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1479285070, "post_id": 40626961, "comment_id": 68487714, "body": "And if this random number generator is better than <a href=\"http://dilbert.com/strip/2001-10-25\" rel=\"nofollow noreferrer\">dilbert.com/strip/2001-10-25</a>, then the cost of calling it will dwarf anything else."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479285801, "post_id": 40626961, "comment_id": 68488143, "body": "Did you forget the <code>break</code> statements after each case ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479286334, "post_id": 40626961, "comment_id": 68488444, "body": "@KapilBhandari and what&#39;s the cost of calling <code>randomNumber()</code>?"}, {"owner": {"reputation": 179, "user_id": 6260281, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98b615ebc4c21424fb3557d6fd7b256a?s=128&d=identicon&r=PG&f=1", "display_name": "del_champ", "link": "https://stackoverflow.com/users/6260281/del-champ"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479286450, "post_id": 40626961, "comment_id": 68488515, "body": "@MichaelWalz : Lets Assume the cost of calling randomNumber to be 0. i have edited the Question again ."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479287057, "post_id": 40626961, "comment_id": 68488854, "body": "@KapilBhandari what is <i>F2Fs</i> ??"}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1479284410, "post_id": 40627017, "comment_id": 68487361, "body": "This is nitpicking, but pseudo random number generators typically have side-effects, so you should have call to <code>randomNumber();</code> to be truly equal with original function."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1479284613, "post_id": 40627017, "comment_id": 68487454, "body": "@user694733 Good point.  However, I am going to assume that <code>randomNumber()</code> is an ideal random (and not pseudo-random) number generator. ;)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1479286184, "post_id": 40627017, "comment_id": 68488351, "body": "@jamesdlin the OP has edited his question, there are <code>break</code> statements now, so this answer is no longer an answer."}], "tags": [], "owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "is_accepted": false, "score": 8, "last_activity_date": 1479286597, "last_edit_date": 1479286597, "creation_date": 1479284129, "answer_id": 40627017, "question_id": 40626961, "link": "https://stackoverflow.com/questions/40626961/reducing-the-weight-of-this-function-by-means-of-code/40627017#40627017", "title": "Reducing the weight of this Function by means of Code", "body": "<p>As originally written, the <code>switch</code> block had no <code>break</code> statements, so the returned value would always be the result of the last case, regardless of the random number generated.  The whole function therefore could have been simplified to:</p>\n\n<pre><code>int function1(int a,int b,int c, int d, int e)\n{\n   return e;\n}\n</code></pre>\n\n<hr>\n\n<p>The current version could be adjusted to:</p>\n\n<pre><code>int function1(int a,int b,int c, int d, int e)\n{\n    switch(randomNumber())\n    {\n       case 0: return a+b;\n       case 1: return c+d;\n       default: return e;\n    }\n}\n</code></pre>\n\n<p>which by your metrics would result in one fewer variable assignment per case. (However, any decent compiler would have optimized it away anyway.)</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 179, "user_id": 6260281, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98b615ebc4c21424fb3557d6fd7b256a?s=128&d=identicon&r=PG&f=1", "display_name": "del_champ", "link": "https://stackoverflow.com/users/6260281/del-champ"}, "edited": false, "score": 0, "creation_date": 1479287231, "post_id": 40627361, "comment_id": 68488982, "body": "@KapilBhandari: you are not supposed to edit the original question with corrections from the answers and comments, it makes the whole discussion inconsistent.  Btw, for consistency, unless you make all cases perform a direct <code>return</code>, you should have a <code>break;</code> statement in the <code>default</code> cause as well: this would make the code a tad more resistant to further edits and quicker to analyze visually."}, {"owner": {"reputation": 179, "user_id": 6260281, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98b615ebc4c21424fb3557d6fd7b256a?s=128&d=identicon&r=PG&f=1", "display_name": "del_champ", "link": "https://stackoverflow.com/users/6260281/del-champ"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1479287448, "post_id": 40627361, "comment_id": 68489125, "body": "@chqrlie : Will keep in mind for future Questions Thanks"}], "tags": [], "owner": {"reputation": 1, "user_id": 7162660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a71912dc028accd6231efe9b84b72a?s=128&d=identicon&r=PG&f=1", "display_name": "LeonardoGaleazzi", "link": "https://stackoverflow.com/users/7162660/leonardogaleazzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1479285421, "creation_date": 1479285421, "answer_id": 40627361, "question_id": 40626961, "link": "https://stackoverflow.com/questions/40626961/reducing-the-weight-of-this-function-by-means-of-code/40627361#40627361", "title": "Reducing the weight of this Function by means of Code", "body": "<p>You can reduce 1 Operation by not asigning no, and use the return value of the randomNumber() directly in you switch, also you forgot the break after the switch's cases unless it was intentional.</p>\n\n<pre><code>    switch(randomNumber())\n   {\n   case 0: returnNumber = a+b;break;\n   case 1: returnNumber = c+d;break;\n   default: returnNumber = e;\n   }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1479287731, "creation_date": 1479287731, "answer_id": 40628089, "question_id": 40626961, "link": "https://stackoverflow.com/questions/40626961/reducing-the-weight-of-this-function-by-means-of-code/40628089#40628089", "title": "Reducing the weight of this Function by means of Code", "body": "<p>The cost of these operations cannot be assessed without a look at the actual code generated. And the code generation depends on many factors such as the choice of target, compiler and compilation options. Optimizing compilers can reorganize the code to improve efficiency or reduce code size, micro-optimizing at the statement level such as what is requested here is a moot point.</p>\n\n<p>Furthermore, the cost of the function call and that of the <code>switch</code> dispatch are likely to dwarf the minuscule timings of the single operations.</p>\n\n<p>Storing the result in a local variable or returning it directly should make no difference for modern optimizing compilers, it is mostly a matter of coding conventions.</p>\n\n<p>If local coding conventions specify that there should be a single <code>return</code> statement, use this:</p>\n\n<pre><code>// the prototype for randomNumber should come from a header file\nint randomNumber(void); //Some Random Number Generator Function\n\nint function1(int a, int b, int c, int d, int e) {\n    int returnNumber;\n\n    switch (randomNumber()) {\n      case 0:\n        returnNumber = a + b;\n        break;\n      case 1:\n        returnNumber = c + d;\n        break;\n      default:\n        returnNumber = e;\n        break;\n    }\n    return returnNumber;\n}\n</code></pre>\n\n<p>If you can have multiple <code>return</code> statements, use the simpler version:</p>\n\n<pre><code>int function1(int a, int b, int c, int d, int e) {\n    switch (randomNumber()) {\n      case 0:\n        return a + b;\n      case 1:\n        return c + d;\n      default:\n        return e;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6260281, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/98b615ebc4c21424fb3557d6fd7b256a?s=128&d=identicon&r=PG&f=1", "display_name": "del_champ", "link": "https://stackoverflow.com/users/6260281/del-champ"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1479287731, "creation_date": 1479283909, "last_edit_date": 1479286793, "question_id": 40626961, "link": "https://stackoverflow.com/questions/40626961/reducing-the-weight-of-this-function-by-means-of-code", "title": "Reducing the weight of this Function by means of Code", "body": "<p>Consider the Following Function taking into account</p>\n\n<ol>\n<li>addition costs you 4 Operations</li>\n<li>assignment costs 1 Operations</li>\n<li>Comparision costs 1 Operations</li>\n</ol>\n\n<p>Calculation of the above function will cost 14 Operations</p>\n\n<pre><code>int function1(int a,int b,int c, int d, int e)\n{\nint returnNumber;\n//int no = randomNumber(); //Some Random Number Generator Function , Lets Assume the cost of this function to be 0 for simplicity purpose\n\nswitch(randomNumber())\n   {\n   case 0: returnNumber = a+b;  // costs 6 Operations , Case Check costs 1, assignment costs 1 and addition costs 4\n           break;\n   case 1: returnNumber = c+d;  // Costs 6 Operations \n           break;\n   default: returnNumber = e;   // costs 2 Operations\n   }\n return returnNumber;\n}\n</code></pre>\n\n<p>Total Cost of this Function is 14 Operations , Is there any code which can do the same thing as well as reduce the cost of this function atleast by 1 ?</p>\n\n<p><strong>EDIT 1</strong>\nAdded the Break Statement in Switch Statements as well as assignment of variable no to a randomNumber generator function</p>\n\n<p><strong>EDIT 2</strong> i came across this question from a friend of mine who happened to have faced this question in the F2Fs , i wonder if this question has a solution or not , since i havent been able to find any till Now.</p>\n"}, {"tags": ["c", "valgrind"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 5, "last_activity_date": 1479283897, "creation_date": 1479283897, "answer_id": 40626958, "question_id": 40626924, "link": "https://stackoverflow.com/questions/40626924/getting-syscall-param-execveargv-points-to-unaddressable-bytes-in-valgrind/40626958#40626958", "title": "Getting &quot;Syscall param execve(argv) points to unaddressable byte(s)&quot; in valgrind", "body": "<p>The argument list must be terminated by a <code>NULL</code> pointer. Add one element to the <code>run_arguments</code> array, and have it be a <code>NULL</code> pointer.</p>\n\n<p>Without the null pointer argument, the <code>exec</code> functions will go out of bounds in their search for the terminator, and will treat every non-null element as an argument that should be passed to the program. That leads to <em>undefined behavior</em>.</p>\n\n<p>This is clearly noted in <a href=\"http://man7.org/linux/man-pages/man3/exec.3.html\" rel=\"noreferrer\">the <code>exec</code> manual page</a>.</p>\n"}], "owner": {"reputation": 603, "user_id": 1927609, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4qWkg.png?s=128&g=1", "display_name": "fakedad", "link": "https://stackoverflow.com/users/1927609/fakedad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4871, "favorite_count": 1, "accepted_answer_id": 40626958, "answer_count": 1, "score": 2, "last_activity_date": 1479283897, "creation_date": 1479283755, "question_id": 40626924, "link": "https://stackoverflow.com/questions/40626924/getting-syscall-param-execveargv-points-to-unaddressable-bytes-in-valgrind", "title": "Getting &quot;Syscall param execve(argv) points to unaddressable byte(s)&quot; in valgrind", "body": "<p>Running the following C program with <code>valgrind --leak-check=yes</code> results in valgrind giving an output indicating that</p>\n\n<pre><code>Syscall param execve(argv) points to unaddressable byte(s)\n</code></pre>\n\n<p>The program is as follows:</p>\n\n<pre><code>int main() {\n  const int NUM_ARGS = 3;\n  char** run_arguments = malloc(sizeof(char*)*NUM_ARGS);\n  run_arguments[0] = \"ls\";\n  run_arguments[1] = \"-l\";\n  run_arguments[2] = \"--color\";\n  char* full_path = \"/bin/ls\";\n  int pid = fork();\n  if (pid == 0)\n    execv(full_path,run_arguments);\n  else {\n    int status;\n    waitpid(pid,&amp;status,WUNTRACED);\n    free(run_arguments);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>According to valgrind, the problem occurs on the line <code>execv(full_path,run_arguments);</code>, and the problem originates from the <code>malloc</code> done on the line <code>char** run_arguments = malloc(sizeof(char*)*NUM_ARGS);</code>. </p>\n\n<p>What mistake have I made that causes valgrind to give this output?</p>\n"}, {"tags": ["c", "glibc"], "comments": [{"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1479281693, "post_id": 40626189, "comment_id": 68486156, "body": "Don&#39;t. :) You&#39;re asking for problems. Good question though."}, {"owner": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "edited": false, "score": 0, "creation_date": 1479686185, "post_id": 40626189, "comment_id": 68649746, "body": "When I said &#39;wrap&#39; I meant to write a new wrapper function such as <code>ToUpper()</code> that calls through to <code>toupper()</code>, and change your code to call the wrapper. Then you can add your own code inside the wrapper to fix just about anything. It&#39;s a good general policy."}], "answers": [{"comments": [{"owner": {"reputation": 1243, "user_id": 1487773, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gnHdG.png?s=128&g=1", "display_name": "Igor Liferenko", "link": "https://stackoverflow.com/users/1487773/igor-liferenko"}, "edited": false, "score": 0, "creation_date": 1479457329, "post_id": 40626341, "comment_id": 68574803, "body": "How to make char unsigned by default without using <code>-funsigned-char</code> gcc option? I don&#39;t want to type each time, or create aliases and stuff. I just want to use the command <code>gcc</code> and have this behavior by default. Maybe there is a config file or a pragma to be put directly into a program?"}, {"owner": {"reputation": 1243, "user_id": 1487773, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gnHdG.png?s=128&g=1", "display_name": "Igor Liferenko", "link": "https://stackoverflow.com/users/1487773/igor-liferenko"}, "edited": false, "score": 0, "creation_date": 1479457939, "post_id": 40626341, "comment_id": 68575102, "body": "Why argument type of <code>putchar()</code>, <code>fputc()</code> and <code>putc()</code> is not <code>char</code>, but argument type of <code>putwchar()</code>, <code>fputwc()</code> and <code>putwc()</code> is <code>wchar_t</code>? Also, why in example from man <code>mbstowcs</code> the variable of type <code>wchar_t</code> is passed to <code>iswlower()</code> ? This contradicts to the fact that <code>iswlower()</code> takes <code>wint_t</code>. Is the example wrong?"}, {"owner": {"reputation": 9213, "user_id": 1105562, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oV4rn.jpg?s=128&g=1", "display_name": "david.pfx", "link": "https://stackoverflow.com/users/1105562/david-pfx"}, "reply_to_user": {"reputation": 1243, "user_id": 1487773, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gnHdG.png?s=128&g=1", "display_name": "Igor Liferenko", "link": "https://stackoverflow.com/users/1487773/igor-liferenko"}, "edited": false, "score": 0, "creation_date": 1479686264, "post_id": 40626341, "comment_id": 68649766, "body": "@IgorLiferenko: That one is worth another question on its own."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1479281478, "creation_date": 1479281478, "answer_id": 40626341, "question_id": 40626189, "link": "https://stackoverflow.com/questions/40626189/how-to-wrap-glibc-library-functions-to-automatically-use-unsigned-char-and-wc/40626341#40626341", "title": "How to wrap glibc library functions to automatically use &#39;unsigned char&#39; and &#39;wchar_t&#39;?", "body": "<p>You can pass a command line option to the compiler to make <code>char</code> unsigned by default. Changing the interface to standard library functions by redefining <code>char</code> with macros and typedefs is not the correct way to achieve your goal.</p>\n\n<p>For gcc and clang, use <code>-funsigned-char</code>.</p>\n\n<p>For Visual-C++, use <code>-J</code> or <code>/J</code>.</p>\n\n<p>The wide character type <code>wchar_t</code> is system specific, it typically 32-bit wide on linux systems and wherever the glibc is used, but only 16-bit wide for the Microsoft tools for historical reasons.  Changing this type will cause compatibility problems between the compiler and the libraries, don't even think about it.</p>\n"}], "owner": {"reputation": 1243, "user_id": 1487773, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/gnHdG.png?s=128&g=1", "display_name": "Igor Liferenko", "link": "https://stackoverflow.com/users/1487773/igor-liferenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 40626341, "answer_count": 1, "score": 2, "last_activity_date": 1479281478, "creation_date": 1479280790, "last_edit_date": 1495535569, "question_id": 40626189, "link": "https://stackoverflow.com/questions/40626189/how-to-wrap-glibc-library-functions-to-automatically-use-unsigned-char-and-wc", "title": "How to wrap glibc library functions to automatically use &#39;unsigned char&#39; and &#39;wchar_t&#39;?", "body": "<p>I always use <code>char</code> as <code>unsigned char</code> and <code>wchar_t</code> as <code>wint_t</code>. Given that, does there exist a solution to change function interfaces to use those types with or without recompiling glibc? See also this question: <a href=\"https://stackoverflow.com/questions/40601645/how-to-change-wchar-h-to-make-wchar-t-the-same-type-as-wint-t\">How to change wchar.h to make wchar_t the same type as wint_t?</a></p>\n"}, {"tags": ["c", "arrays", "sorting", "command-line"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479280415, "post_id": 40626066, "comment_id": 68485485, "body": "You have a nested <code>main()</code>...whoa?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1479280419, "post_id": 40626066, "comment_id": 68485488, "body": "I doubt your code can compile... You have 2 <code>main</code> function one nested into the other..."}, {"owner": {"reputation": 423, "user_id": 5411898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6d618f8dcf098e37377ff48dd932f4cc?s=128&d=identicon&r=PG&f=1", "display_name": "Sean83", "link": "https://stackoverflow.com/users/5411898/sean83"}, "edited": false, "score": 0, "creation_date": 1479280469, "post_id": 40626066, "comment_id": 68485515, "body": "It is very difficult to see due to indentation."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1479280942, "post_id": 40626066, "comment_id": 68485762, "body": "See <a href=\"http://stackoverflow.com/documentation/c/1285/command-line-arguments#t=201611160718523067357\">stackoverflow.com/documentation/c/1285/&hellip;</a> for information about command line arguments. You current use of <code>argc</code> is wrong."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6861322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa09dedb4422dac1c3d028ce55d8539b?s=128&d=identicon&r=PG&f=1", "display_name": "JadC", "link": "https://stackoverflow.com/users/6861322/jadc"}, "edited": false, "score": 0, "creation_date": 1479282938, "post_id": 40626457, "comment_id": 68486712, "body": "If the user does not enter a number when running the code, it stops the program. How would I make it where it continuously asks for a number until the user gives a number? Would I change the first if statement to a while loop?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 19, "user_id": 6861322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa09dedb4422dac1c3d028ce55d8539b?s=128&d=identicon&r=PG&f=1", "display_name": "JadC", "link": "https://stackoverflow.com/users/6861322/jadc"}, "edited": false, "score": 0, "creation_date": 1479284343, "post_id": 40626457, "comment_id": 68487330, "body": "@MasoCB - No, don&#39;t change the first <code>if</code> to a <code>while</code>. You can add an <code>else</code> to the first <code>if</code> and then make a <code>while</code> inside the <code>else</code> part. In the <code>while</code> you would use <code>scanf</code> and check the return value to be 1."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1479281942, "creation_date": 1479281942, "answer_id": 40626457, "question_id": 40626066, "link": "https://stackoverflow.com/questions/40626066/making-arrays-user-input-specific-for-bubble-sort/40626457#40626457", "title": "Making arrays user input specific for bubble sort?", "body": "<p>There are a number of issues with your code</p>\n\n<p>1) The use of <code>argc</code> is wrong. <code>argc</code> is not the value of an argument. It is the number of arguments (including program name).</p>\n\n<p>2) There is a nested <code>main</code> inside <code>main</code>. Don't do that.</p>\n\n<p>3) You never call the bubble sort function. Add it.</p>\n\n<p>So a minor rewrite of your program:</p>\n\n<pre><code>int randu(void);\nvoid bubble(int *, int);\nvoid swap(int *, int *);\n\nint main(int argc, char *argv[]) {\n\n  int num1;\n\n  if ((argc &lt; 2) ||\n      (sscanf(argv[1], \"%d\", &amp;num1) != 1) ||\n      (num1 &lt; 2) ||\n      (num1 &gt; 10000)) {\n    printf(\"You must give a number in range 2-10.000 as input\\n\");\n    return 0;\n  }\n\n  int x[num1], i;\n  for(i=0;i&lt;num1;i++) {\n    x[i]=randu();\n  }\n\n  printf(\"Here are %d numbers\\n\", num1);\n  for (i=0;i&lt;num1;i++) {\n    printf(\"%d\\n\",x[i]);\n  }\n\n  // Call the sort function    \n  bubble(x, num1);\n\n  printf(\"Here are %d numbers sorted\\n\", num1);\n  for (i=0;i&lt;num1;i++) {\n    printf(\"%d\\n\",x[i]);\n  }\n  return 0;\n}\n\nint randu(void) {\n  static int seed=17;\n  seed=(25179*seed+13849)%65536;\n  return seed;\n}\n\nvoid bubble(int a[], int num1){\n  int i,j;\n  for (i=0;i&lt;num1-1;i++)\n    for(j=num1-1;i&lt;j;j--)\n      if(a[j-1]&gt;a[j])\n        swap(&amp;a[j-1],&amp;a[j]);\n}\n\nvoid swap(int *a, int *b){\n  int temp;\n  temp=*a;\n  *a=*b;\n  *b=temp;\n}\n</code></pre>\n\n<blockquote>\n  <p>\"prog 5\" gives the output:</p>\n</blockquote>\n\n<pre><code>Here are 5 numbers\n48676\n38117\n52608\n17049\n29820\nHere are 5 numbers sorted\n17049\n29820\n38117\n48676\n52608\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6861322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa09dedb4422dac1c3d028ce55d8539b?s=128&d=identicon&r=PG&f=1", "display_name": "JadC", "link": "https://stackoverflow.com/users/6861322/jadc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479281942, "creation_date": 1479280272, "question_id": 40626066, "link": "https://stackoverflow.com/questions/40626066/making-arrays-user-input-specific-for-bubble-sort", "title": "Making arrays user input specific for bubble sort?", "body": "<p>I'm learning to how to use command line arguments to get a number to decide how many elements are in an array to organize. The random number generator is supposed to take the user's number and generate that many random numbers, then sort them with the bubble sort. \nBut the number cannot be less than 2 or greater than 10,000.\nI keep getting Segmentation fault (core dumped) or I'm able to enter any number (including a number less than 2 or greater than 10,000) and it does nothing.\nI'm sure it is the first part of the code that is wrong, not the subprograms and definitions, but I don't know how to fix it.  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n\nint randu(void);\nvoid bubble(int *, int);\nvoid swap(int *, int *);\nint main(int argc, char *argv[]) {\n\n   int num1;\n\n   if (argc&lt;2) {\n    printf(\"Number must be between 2 and 10000.\\n\");\n    printf(\"Enter a number to sort.\\n\");\n    scanf(\"%d\", &amp;num1);\n   }\n   if (argc&gt;10000) {\n    printf(\"Number must be between 2 and 10000.\\n\");\n    printf(\"Enter a number to sort.\\n\");\n    scanf(\"%d\", &amp;num1);\n   }\n    sscanf(argv[1], \"%d\", &amp;num1);\n\n\n   int main(void) {\n   int x[num1], i;\n   for(i=0;i&lt;num1;i++)\n    x[i]=randu();\n   printf(\"Here are %d numbers\\n\", num1);\n   for (i=0;i&lt;num1;i++)\n    printf(\"%d\\n\",x[i]);\n   }\n\n   }\n   int randu(void) {\n   static int seed=17;\n   seed=(25179*seed+13849)%65536;\n   return seed;\n   }\n   void bubble(int a[], int num1){\n   int i,j;\n   for (i=0;i&lt;num1-1;i++)\n    for(j=num1-1;i&lt;j;j--)\n    if(a[j-1]&gt;a[j])\n    swap(&amp;a[j-1],&amp;a[j]);\n   }\n   void swap(int *a, int *b){\n   int temp;\n   temp=*a;\n   *a=*b;\n   *b=temp;\n   }\n</code></pre>\n"}, {"tags": ["objective-c", "c", "macos", "process", "macos-sierra"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479280134, "post_id": 40626018, "comment_id": 68485351, "body": "Please show your research/debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 355, "user_id": 3564870, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5d831d51593148fed829724b20747d28?s=128&d=identicon&r=PG&f=1", "display_name": "user3564870", "link": "https://stackoverflow.com/users/3564870/user3564870"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1479282100, "post_id": 40626018, "comment_id": 68486366, "body": "Added some more details."}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 3564870, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5d831d51593148fed829724b20747d28?s=128&d=identicon&r=PG&f=1", "display_name": "user3564870", "link": "https://stackoverflow.com/users/3564870/user3564870"}, "is_accepted": true, "score": 0, "last_activity_date": 1479933672, "last_edit_date": 1495542400, "creation_date": 1479933672, "answer_id": 40773804, "question_id": 40626018, "link": "https://stackoverflow.com/questions/40626018/given-a-process-id-determine-if-the-process-is-a-windowed-process-on-a-mac/40773804#40773804", "title": "Given a Process ID, determine if the process is a windowed process on a Mac", "body": "<p>Here's how you can determine if a process has a window:</p>\n\n<p>The UiProcesses() method will create an array of processIDs for processes with windows. </p>\n\n<pre><code>CFArrayRef UiProcesses()\n{\n    CFArrayRef  orderedwindows = CGWindowListCopyWindowInfo(kCGWindowListOptionAll, kCGNullWindowID);\n    CFIndex count = CFArrayGetCount (orderedwindows);\n    CFMutableArrayRef uiProcess = CFArrayCreateMutable (kCFAllocatorDefault , count,  &amp;kCFTypeArrayCallBacks);\n    for (CFIndex i = 0; i &lt; count; i++)\n    {\n        if (orderedwindows)\n        {\n            CFDictionaryRef windowsdescription = (CFDictionaryRef)CFArrayGetValueAtIndex(orderedwindows, i);\n            CFNumberRef windowownerpid  = (CFNumberRef)CFDictionaryGetValue (windowsdescription, CFSTR(\"kCGWindowOwnerPID\"));\n            CFArrayAppendValue (uiProcess, windowownerpid);\n\n        }\n    }\n    return uiProcess;\n}\n</code></pre>\n\n<p>Source: <a href=\"https://stackoverflow.com/questions/7545695/how-to-identify-if-the-process-in-user-interface-process\">How to Identify if the process in User Interface Process?</a></p>\n"}], "owner": {"reputation": 355, "user_id": 3564870, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5d831d51593148fed829724b20747d28?s=128&d=identicon&r=PG&f=1", "display_name": "user3564870", "link": "https://stackoverflow.com/users/3564870/user3564870"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40773804, "answer_count": 1, "score": 1, "last_activity_date": 1479933672, "creation_date": 1479280119, "last_edit_date": 1495535417, "question_id": 40626018, "link": "https://stackoverflow.com/questions/40626018/given-a-process-id-determine-if-the-process-is-a-windowed-process-on-a-mac", "title": "Given a Process ID, determine if the process is a windowed process on a Mac", "body": "<p>Need a way to programmatically determine if a process is a windowed process using the process ID. This needs to work for both user and system processes. </p>\n\n<p>With the crude method below, one could determine if a user process is windowed. However, this has a major flaw, it will only work for user processes, not system.</p>\n\n<pre><code>- (BOOL)processIsWindowed:(pid_t)processID {\n    for (NSRunningApplication app in [[NSWorkspace sharedWorkspace] runningApplications]) {\n        if(app.processIdentifier == processID &amp;&amp; (app.activationPolicy == NSApplicationActivationPolicyRegular)){\n            return YES;\n        }\n    }\n    return NO;\n}\n</code></pre>\n\n<p>Using:</p>\n\n<pre><code>static int GetBSDProcessList(kinfo_proc **procList, size_t *procCount){}\n</code></pre>\n\n<p>from \n<a href=\"https://stackoverflow.com/questions/3786684/using-nsworkspace-to-get-all-running-processes\">Using NSWorkspace to get all running processes</a></p>\n\n<p>will list all processes, but I can't immediatgely see a way to determine if it is a windowed process.</p>\n\n<p>A process listed by the above method has flags <code>(i.e. process-&gt;kp_proc.p_flags)</code> but I don't see any flags listed: <a href=\"https://opensource.apple.com/source/xnu/xnu-1456.1.26/bsd/sys/proc.h\" rel=\"nofollow noreferrer\">https://opensource.apple.com/source/xnu/xnu-1456.1.26/bsd/sys/proc.h</a> that might indicate it as a windowed process.</p>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1479279366, "post_id": 40625795, "comment_id": 68484997, "body": "how about <a href=\"https://linux.die.net/man/3/round\" rel=\"nofollow noreferrer\">this</a>?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1479280920, "post_id": 40625795, "comment_id": 68485747, "body": "did you even google for &quot;c casting float to int&quot;?"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1479281473, "post_id": 40625795, "comment_id": 68486026, "body": "In the title of this question you are asking for a cast to <i>unsigned</i> int, but a temperature, if measured in Celsius or Fahrenheit, could have a negative value."}, {"owner": {"reputation": 832, "user_id": 2060696, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/011523ef809ae1e9f993303731169619?s=128&d=identicon&r=PG", "display_name": "Gutanoth", "link": "https://stackoverflow.com/users/2060696/gutanoth"}, "edited": false, "score": 0, "creation_date": 1479281876, "post_id": 40625795, "comment_id": 68486254, "body": "Yes, however, the dht11 has a range from 0 to 50 degrees celcius"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479283469, "post_id": 40625795, "comment_id": 68486943, "body": "<i>&quot;The DHT sensor outputs these values as floats...&quot;</i> The DHT11 outputs 5 8-bit fields (2 for humidity, 2 for temperature, 1 for parity). Each pair comprises an integer byte and a fraction byte. All you need to do is ignore the fraction byte (or round up the integer byte if &gt;= 0x80). What has floating point got to do with it?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1479288713, "post_id": 40625795, "comment_id": 68489921, "body": "there&#39;s no difference between casting from float to int or unsigned int"}], "answers": [{"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1479279642, "post_id": 40625826, "comment_id": 68485121, "body": "Why are you using <i>unsigned</i>?"}, {"owner": {"reputation": 1148, "user_id": 4593781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q3DAn.jpg?s=128&g=1", "display_name": "Muhammad Faizan Uddin", "link": "https://stackoverflow.com/users/4593781/muhammad-faizan-uddin"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1479279668, "post_id": 40625826, "comment_id": 68485133, "body": "That&#39;s the OP&#39;s requirement!"}, {"owner": {"reputation": 9645, "user_id": 1465553, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5b559f395549789c041652429444dc0a?s=128&d=identicon&r=PG", "display_name": "Saurav Sahu", "link": "https://stackoverflow.com/users/1465553/saurav-sahu"}, "edited": false, "score": 0, "creation_date": 1479279737, "post_id": 40625826, "comment_id": 68485169, "body": "Try casting negative number. It gives unexpected result."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 2, "creation_date": 1479280180, "post_id": 40625826, "comment_id": 68485373, "body": "Well, that&#39;s ok for measuring humidity, but the temperature (even in a room) could be negative (in &#176;C or F)..."}, {"owner": {"reputation": 5309, "user_id": 877329, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0b5c9fa7b8fa8139c1330b5fbbd5f934?s=128&d=identicon&r=PG", "display_name": "user877329", "link": "https://stackoverflow.com/users/877329/user877329"}, "edited": false, "score": 0, "creation_date": 1479280760, "post_id": 40625826, "comment_id": 68485655, "body": "@MuhammadFaizanUddin You should round values correctly 24.9 =&gt; 25."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1479280959, "post_id": 40625826, "comment_id": 68485770, "body": "@MuhammadFaizanUddin Your edit is not valid in C, anyway, even if fahrenheit could be negative, the question is &quot;Float to unsigned integer in C&quot;, seems like a correct answer to me."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 2, "creation_date": 1479281626, "post_id": 40625826, "comment_id": 68486113, "body": "@KeineLust Fair enough, that&#39;s a problem of OP&#39;s question."}], "tags": [], "owner": {"reputation": 1148, "user_id": 4593781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q3DAn.jpg?s=128&g=1", "display_name": "Muhammad Faizan Uddin", "link": "https://stackoverflow.com/users/4593781/muhammad-faizan-uddin"}, "is_accepted": false, "score": 0, "last_activity_date": 1479280549, "last_edit_date": 1479280549, "creation_date": 1479279391, "answer_id": 40625826, "question_id": 40625795, "link": "https://stackoverflow.com/questions/40625795/float-to-unsigned-integer-in-c/40625826#40625826", "title": "Float to unsigned integer in C", "body": "<p>Try:</p>\n\n<pre><code>float x = 24.3 ;\nunsigned int y;\ny = (unsigned int) x;\n</code></pre>\n\n<p>for -ve values, <code>unsigned int n = static_cast&lt;unsigned int&gt;(static_cast&lt;int&gt;(-1.3));</code> can help</p>\n"}], "owner": {"reputation": 832, "user_id": 2060696, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/011523ef809ae1e9f993303731169619?s=128&d=identicon&r=PG", "display_name": "Gutanoth", "link": "https://stackoverflow.com/users/2060696/gutanoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4130, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1479386991, "creation_date": 1479279264, "last_edit_date": 1479281995, "question_id": 40625795, "link": "https://stackoverflow.com/questions/40625795/float-to-unsigned-integer-in-c", "title": "Float to unsigned integer in C", "body": "<p>Currently I am using a DHT11 sensor to measure temp and humidity in a room. The DHT sensor outputs these values as floats, however, I would like to send values as integers (24.3 degrees would be 24 for example). I'm having a hard time finding a way to do this. </p>\n\n<p>The reason why I ask for an unsigned integer, is because the DHT range is from 0 to 50 degrees celcius, there is no need for a signed integer</p>\n"}, {"tags": ["c", "assembly", "arm"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1479283776, "post_id": 40625733, "comment_id": 68487077, "body": "@Lundin: My comment was incorrect. I&#39;d somehow missed the <code>str</code> at the end."}, {"owner": {"reputation": 161, "user_id": 2813237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817e3c71873996ee0f9e9dd9f5acf6f7?s=128&d=identicon&r=PG", "display_name": "BasavarajaMS", "link": "https://stackoverflow.com/users/2813237/basavarajams"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1479284031, "post_id": 40625733, "comment_id": 68487178, "body": "@Michael Can you please explain for the third instruction &quot;str     w0, [x1]&quot;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1479284808, "post_id": 40625733, "comment_id": 68487561, "body": "@Michael Ah, so did I. It ended up as a comment because of some edit goof-up. The question has been restored now."}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1479310835, "post_id": 40625733, "comment_id": 68504689, "body": "@BasavarajaMS is your target hardware the Apple A9?"}], "answers": [{"tags": [], "owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1479288811, "last_edit_date": 1479288811, "creation_date": 1479287150, "answer_id": 40627893, "question_id": 40625733, "link": "https://stackoverflow.com/questions/40625733/conversion-of-arm-code-into-c/40627893#40627893", "title": "Conversion of ARM code into C", "body": "<blockquote>\n  <p>When i cross checked with it by compiler it given differnet result as mov and movs</p>\n</blockquote>\n\n<p>It sounds to me like you compiled the C code with a compiler targetting AArch32, but the assembly code you've shown looks like it was written for AArch64.\nHere's what I get when I compile with ARM64 GCC 5.4 and optimization level <code>O3</code> (comments added by me):</p>\n\n<pre><code>    mov     x0, 32            @ x0 = 0x20\n    mov     w1, 24            @ w1 = 0x18\n    movk    x0, 0x40, lsl 16  @ x0[31:16] = 0x40 \n    movk    w1, 0x20, lsl 16  @ w1[31:16] = 0x20\n    str     w1, [x0]\n</code></pre>\n\n<blockquote>\n  <p>How to create ldr in c?</p>\n</blockquote>\n\n<p>I can't see any good reason why you'd want the compiler to generate an <code>LDR</code> in this case.<br>\n<code>LDR reg,=value</code> is a <em>pseudo-instruction</em> that allows you to load immediates that cannot be encoded directly in the instruction word. The assembler achieves this by placing the value (e.g. <code>0x200018</code>) in a <a href=\"http://www.keil.com/support/man/docs/armasm/armasm_dom1359731147760.htm\" rel=\"nofollow noreferrer\"><em>literal pool</em></a>, and then replacing <code>ldr w0, =0x200018</code> with a PC-relative load from that literal pool (i.e. something like <code>ldr w0,[pc,#offset_to_value]</code>). Accessing memory is slow, so the compiler generated another sequence of instructions for you that achieves the same thing in a more efficient manner.</p>\n\n<p>Pseudo-instructions are mainly a convenience for humans writing assembly code, making the code easier for them or their colleagues to read/write/maintain. Unlike a human being, a compiler doesn't get fatigued by repeating the same task over and over, and therefore doesn't have as much need for conveniences like that.</p>\n\n<p>TL;DR: The compiler will generate what it thinks is the best (according to the current optimization level) instruction sequence. Also, that particular form of <code>LDR</code> is a pseudo-instruction, so you might not be able to get a compiler to generate it even if you disable all optimizations.</p>\n"}], "owner": {"reputation": 161, "user_id": 2813237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817e3c71873996ee0f9e9dd9f5acf6f7?s=128&d=identicon&r=PG", "display_name": "BasavarajaMS", "link": "https://stackoverflow.com/users/2813237/basavarajams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479288811, "creation_date": 1479279023, "last_edit_date": 1479283225, "question_id": 40625733, "link": "https://stackoverflow.com/questions/40625733/conversion-of-arm-code-into-c", "title": "Conversion of ARM code into C", "body": "<p>Here is my assembly code for A9,</p>\n\n<pre><code>ldr     x1, = 0x400020                // Const value may be address also\nldr     w0, = 0x200018     // Const value may be address also \nstr     w0, [x1]\n</code></pre>\n\n<p>The below one is expected output ?</p>\n\n<pre><code>*((u32 *)0x400020) = 0x200018;    \n</code></pre>\n\n<p>When i cross checked with it by compiler it given differnet result as mov and movs insted of ldr. How to create ldr in c? </p>\n"}, {"tags": ["c", "solaris", "linker-errors"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479280463, "post_id": 40625619, "comment_id": 68485513, "body": "Looks like C with deprecated function signature to me. Why the C++ tag? Why the Linux tag when asking about Solaris?"}, {"owner": {"reputation": 955, "user_id": 2526833, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVqZO.jpg?s=128&g=1", "display_name": "Brightshine", "link": "https://stackoverflow.com/users/2526833/brightshine"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479281862, "post_id": 40625619, "comment_id": 68486244, "body": "@Olaf I have removed unnecessary tags. What I need is outb() function implementation on Solaris, not a general solution for undefined symbol !"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479282719, "post_id": 40625619, "comment_id": 68486630, "body": "Read the dup ! There is nothing special about &quot;outb&quot;. If it is declared in the headers, it should be in the library, too!"}, {"owner": {"reputation": 955, "user_id": 2526833, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVqZO.jpg?s=128&g=1", "display_name": "Brightshine", "link": "https://stackoverflow.com/users/2526833/brightshine"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1479290474, "post_id": 40625619, "comment_id": 68491036, "body": "Yes, I think it is nothing special. But that&#39;s why I got confused. Man page never mention about where it is...  Do you have any suggestion except for extracting each symbols for all .a and .so in my system ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1479301735, "post_id": 40625619, "comment_id": 68498285, "body": "This question is not a duplicate of the linked quesiton.  A review of the uses and the definition of <code>outb</code> on OpenSolaris code at <a href=\"http://src.illumos.org/source/search?q=outb&amp;defs=&amp;refs=&amp;path=&amp;hist=&amp;project=illumos-gate\" rel=\"nofollow noreferrer\">src.illumos.org/source/&hellip;</a> seems to indicate that <code>outb</code> is a kernel-only function on Solaris.  Note also that the <a href=\"https://docs.oracle.com/cd/E19455-01/806-0639/6j9vsttt2/index.html\" rel=\"nofollow noreferrer\">man page for outb</a> does not list the user-space library needed to link.  Finally, the man page is in &quot;man pages section 9F: DDI and DKI <b>Kernel Functions</b>&quot;"}], "owner": {"reputation": 955, "user_id": 2526833, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FVqZO.jpg?s=128&g=1", "display_name": "Brightshine", "link": "https://stackoverflow.com/users/2526833/brightshine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "closed_date": 1479280719, "answer_count": 0, "score": 2, "last_activity_date": 1479281679, "creation_date": 1479278480, "last_edit_date": 1479281679, "question_id": 40625619, "link": "https://stackoverflow.com/questions/40625619/port-i-o-function-outb-on-solaris", "closed_reason": "Duplicate", "title": "Port I/O function (outb) on Solaris", "body": "<p>I am porting code from Linux to Solaris(OmniOS v11 r151018), and get link error due to there is no port I/O implementation</p>\n\n<p>This is simplest sample code:</p>\n\n<pre><code>#if defined(__linux__)\n#include &lt;sys/io.h&gt;\n#elif defined(__sun)\n#include &lt;sys/ddi.h&gt;\n#include &lt;sys/sunddi.h&gt;\n#endif\n\nint main() {\n        int port = 0;\n        unsigned char value = 0;\n\n#if defined(__linux__)\n        outb(value,port);\n#elif defined(__sun)\n        outb(port,value);\n#endif\n\n        return 0;\n}\n</code></pre>\n\n<p>It will compile success on Linux, but get outb undefined symbol on Solaris:</p>\n\n<pre><code>$ gcc main.c\nUndefined                    first referenced\n symbol                             in file\noutb                                /var/tmp//ccC6aqoL.o\nld: fatal: symbol referencing errors. No output written to a.out\ncollect2: ld returned 1 exit status\n</code></pre>\n\n<p>Could someone help me to solve link error? Which library should I link with?</p>\n"}, {"tags": ["c", "makefile", "linker"], "answers": [{"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1479289114, "post_id": 40625220, "comment_id": 68490166, "body": "Aren&#39;t you supposed to sort objects before reversing them?"}], "tags": [], "owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "is_accepted": false, "score": 1, "last_activity_date": 1479306656, "last_edit_date": 1479306656, "creation_date": 1479276722, "answer_id": 40625220, "question_id": 40625024, "link": "https://stackoverflow.com/questions/40625024/sorting-object-files-in-gcc-makefile-in-descending-order/40625220#40625220", "title": "Sorting object files in gcc makefile in descending order", "body": "<p>There is no simple way to reverse the order of a list of words built into GNU make.</p>\n\n<p>You can either use the shell's <code>sort</code> function to do it, like this:</p>\n\n<pre><code>OBJECTS := $(shell for w in $(OBJECTS_UNSORTED); do echo $$w; done | sort -r)\n</code></pre>\n\n<p>Or, you can create a recursive function macro in GNU make to do it, like this:</p>\n\n<pre><code>reverse = $(if $1,$(call reverse,$(wordlist 2,999999,$1)) $(firstword $1))\n\nOBJECTS := $(call reverse,$(sort $(OBJECTS_UNSORTED)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 1, "last_activity_date": 1479288760, "last_edit_date": 1479288760, "creation_date": 1479288449, "answer_id": 40628326, "question_id": 40625024, "link": "https://stackoverflow.com/questions/40625024/sorting-object-files-in-gcc-makefile-in-descending-order/40628326#40628326", "title": "Sorting object files in gcc makefile in descending order", "body": "<p>This can be achieved by defining a function that prepends a word to a variable. By calling this function for each word of a variable that holds sorted words, the words are effectively reversed:</p>\n\n<pre><code>OBJECTS_SORTED := $(sort $(OBJECTS))\n\ndefine Prepend\nOBJECTS_SORTED_REVERSE := $1 $(OBJECTS_SORTED_REVERSE)\nendef\n\n$(foreach variable,$(OBJECTS_SORTED),$(eval $(call Prepend,$(variable))))\n\n$(info $(OBJECTS_SORTED_REVERSE))\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5216147, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1f5bf39cda86cb312ec2a6d226933e6b?s=128&d=identicon&r=PG&f=1", "display_name": "gabbar", "link": "https://stackoverflow.com/users/5216147/gabbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1479306656, "creation_date": 1479275845, "question_id": 40625024, "link": "https://stackoverflow.com/questions/40625024/sorting-object-files-in-gcc-makefile-in-descending-order", "title": "Sorting object files in gcc makefile in descending order", "body": "<p>In my Makefile currently all the object files are sorted alphabetically using </p>\n\n<p>OBJECTS   =$(sort $(OBJECTS_UNSORTED)) in Makefile. </p>\n\n<p>I want to sort the files in descending order Is there is a way possible to it?\nTried the below options but they do not work -</p>\n\n<p>OBJECTS   =$((sort -r) $(OBJECTS_UNSORTED))</p>\n"}, {"tags": ["c", "pointers", "perfect-numbers"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1479275731, "post_id": 40624995, "comment_id": 68483531, "body": "Questions seeking debugging help (\u2018<b>why isn&#39;t this code working?</b>\u2019) must include the desired behaviour, a specific problem or error and the shortest code necessary to reproduce it <b>in the question itself</b>. Questions without <b>a clear problem statement</b> are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 3, "creation_date": 1479275824, "post_id": 40624995, "comment_id": 68483567, "body": "Why on earth are you <code>malloc</code>ing a single <code>int</code>?!"}, {"owner": {"reputation": 699, "user_id": 5921207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hRLIM.jpg?s=128&g=1", "display_name": "Falla Coulibaly", "link": "https://stackoverflow.com/users/5921207/falla-coulibaly"}, "edited": false, "score": 0, "creation_date": 1479275966, "post_id": 40624995, "comment_id": 68483623, "body": "If you can&#39;t run it then look at what your compiler has to say!"}, {"owner": {"reputation": 1, "user_id": 7165705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa9c91153f62bd39c5e148a2acfd607?s=128&d=identicon&r=PG&f=1", "display_name": "user7165705", "link": "https://stackoverflow.com/users/7165705/user7165705"}, "edited": false, "score": 0, "creation_date": 1479276393, "post_id": 40624995, "comment_id": 68483778, "body": "In the compiler there&#39;s no error, but the result can&#39;t displayed. In the compiler displayed:  The List of Perfect Number Give me the lastest number(start from 1):"}, {"owner": {"reputation": 1, "user_id": 7165705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa9c91153f62bd39c5e148a2acfd607?s=128&d=identicon&r=PG&f=1", "display_name": "user7165705", "link": "https://stackoverflow.com/users/7165705/user7165705"}, "edited": false, "score": 0, "creation_date": 1479276467, "post_id": 40624995, "comment_id": 68483812, "body": "I use malloc to cast the pointer"}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1479276563, "post_id": 40624995, "comment_id": 68483861, "body": "@user7165705 No, you use a cast to cast the pointer. You use <code>malloc</code> to dynamically allocate memory for a single <code>int</code>, which is entirely unnecessary."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1479277215, "post_id": 40624995, "comment_id": 68484104, "body": "The inner loop never executes the first time around, after which <code>*sum != x</code> and nothing is output.  Then you exit your program before looping again.  This is not the only thing wrong with your program."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1479286232, "post_id": 40624995, "comment_id": 68488378, "body": "learn how to use the debugger."}], "answers": [{"tags": [], "owner": {"reputation": 32921, "user_id": 5771269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be6a5b618f5bd197150a6186318beba7?s=128&d=identicon&r=PG&f=1", "display_name": "cdlane", "link": "https://stackoverflow.com/users/5771269/cdlane"}, "is_accepted": false, "score": 1, "last_activity_date": 1479284678, "creation_date": 1479284678, "answer_id": 40627162, "question_id": 40624995, "link": "https://stackoverflow.com/questions/40624995/c-program-to-make-a-list-of-perfect-numbers/40627162#40627162", "title": "C Program to make a list of perfect numbers", "body": "<p>The good news is that you have most of the statements you need, you just have several of them in the wrong order (and toss that pointer stuff -- this is math!):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    unsigned n;\n\n    printf(\"The List of Perfect Number\\n\");\n    printf(\"Give me the lastest number (start from 1): \");\n\n    (void) scanf(\"%u\", &amp;n);\n\n    for (unsigned x = 1; x &lt;= n; x++)\n    {\n        unsigned sum = 0;\n\n        for (unsigned i = 1; i &lt;= x / 2; i++)\n        {\n            if (x % i == 0)\n            {\n                sum += i;\n            }\n        }\n\n        if (sum == x)\n        {\n            printf(\"%d\\n\", x);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The bad news is you'll not get more than four perfect numbers with code like this due to poor performance.  It's possible to compute twice as many in reasonable time (before coming up against the size limit of <strong>C</strong>'s integer types) but you need to approach it differently.  Specifically, read about <a href=\"https://en.wikipedia.org/wiki/Mersenne_prime\" rel=\"nofollow noreferrer\">Mersenne primes</a>, and their relationship to perfect numbers, as well as the <a href=\"https://en.wikipedia.org/wiki/Lucas%E2%80%93Lehmer_primality_test\" rel=\"nofollow noreferrer\">Lucas-Lehmer test</a> for Mersenne numbers.  It takes more thought, but, surprisingly, not too much more code. </p>\n"}], "owner": {"reputation": 1, "user_id": 7165705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa9c91153f62bd39c5e148a2acfd607?s=128&d=identicon&r=PG&f=1", "display_name": "user7165705", "link": "https://stackoverflow.com/users/7165705/user7165705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "closed_date": 1480136939, "answer_count": 1, "score": -6, "last_activity_date": 1479317416, "creation_date": 1479275699, "last_edit_date": 1479317416, "question_id": 40624995, "link": "https://stackoverflow.com/questions/40624995/c-program-to-make-a-list-of-perfect-numbers", "closed_reason": "Not suitable for this site", "title": "C Program to make a list of perfect numbers", "body": "<p>I tried to code this but I can't run it. Please help me to check what's wrong in my code. The results I want, examples:</p>\n\n<pre><code>The List of Perfect Number\nGive me the lastest number(start from 1): 100\n6 28\n</code></pre>\n\n<p>This is a <strong>C</strong> program that <strong>uses pointers</strong>:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    int i, x, n, *sum;\n\n    printf(\"The List of Perfect Number\\n\");\n    printf(\"Give me the lastest number(start from 1):  \");\n    scanf(\"%d\", &amp;n);\n\n    sum = (int *) malloc(sizeof(int));\n    *sum = 0;\n\n    for(x=1;x&lt;=n;x++)\n    {\n        for(i=1; i&lt;x; i++)\n        {\n            if(x%i == 0)\n            {\n                *sum+=i;\n            }\n        }\n        if(*sum == x)\n            printf(\"%d\", x);\n        free(sum);\n     return 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "pointers", "strtok", "strcmp"], "answers": [{"tags": [], "owner": {"reputation": 1188, "user_id": 2690448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0037da493fb4842d30effa9a9e76860?s=128&d=identicon&r=PG&f=1", "display_name": "jaeheung", "link": "https://stackoverflow.com/users/2690448/jaeheung"}, "is_accepted": false, "score": 0, "last_activity_date": 1479279774, "creation_date": 1479279774, "answer_id": 40625915, "question_id": 40624822, "link": "https://stackoverflow.com/questions/40624822/c-no-output-printing-after-changing-strtok-to-incorporate-strcmp/40625915#40625915", "title": "C - No output printing after changing strtok to incorporate strcmp", "body": "<p>Your program doesn't work because you didn't close the while loop properly.\nTry this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid filter_spaces(char* string);\nvoid upper_case(char string[]);\n\nint main()\n{\n    char c, string[201];\n    int i = 0, k = 0, j = 0;\n    char strip[] = \",.:;?!\";\n    char* phrases[1000];\n    int tally = 0;\n\n    printf(\"What gibberish shall I parse?\\n\");\n\n    while((c = getchar()) != EOF)  //while loop for getting characters from stdin\n        string[i++] = c;\n\n    string[i] = '\\0';  //insert NULL at end of string\n    filter_spaces(string);\n    upper_case(string);\n    char *phrase = strtok(string, strip);\n\n    puts(\"\\nThe phrases entered are: \");\n\n    /*\n    for (token = strtok(string, strip); token; token = strtok(NULL, strip))\n    {\n        puts(token);\n    }\n    */\n\n    while(phrase != '\\0')\n    {\n        phrases[i++] = strdup(phrase);\n        phrase = strtok(NULL, strip);\n    }\n\n    for(k=0; k&lt;i-1; k++)\n    {\n        for(j = k+1; j&lt;k; j++)\n        {\n            if(strcmp(phrases[k], phrases[j])==0)\n            {\n                tally = tally++;  //add to phrases[k] count\n            }\n            else\n            {\n                printf(\"&lt;%s&gt;\\n\", phrase); //print and continue on\n            }                       \n        }\n    }\n\n    return 0;\n}\n\nvoid upper_case(char string[])\n{\n    int c = 0;\n\n    while (string[c] != '\\0')\n    {\n        if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z')\n        {\n            string[c] = string[c] - 32;\n        }\n        c++;\n    }\n}\n\nvoid filter_spaces(char* string)\n{\n    int i,x;\n    for(i=x=1; string[i]; ++i)\n        if(string[i]!=' ' || string[i+1]!=' ')\n            string[x++] = string[i];\n    string[x] = '\\0';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": true, "score": 0, "last_activity_date": 1479292981, "last_edit_date": 1479292981, "creation_date": 1479284740, "answer_id": 40627177, "question_id": 40624822, "link": "https://stackoverflow.com/questions/40624822/c-no-output-printing-after-changing-strtok-to-incorporate-strcmp/40627177#40627177", "title": "C - No output printing after changing strtok to incorporate strcmp", "body": "<p>Hope it would helps you. Your logic to count repeated and print unique character was wrong.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid filter_spaces(char* string);\nvoid upper_case(char string[]);\n\nint main()\n{\n    char c, string[201];\n    int i = 0, k = 0, j = 0;\n    char strip[] = \" ,.:;?!\";\n    char* phrases[1000];\n    int tally = 0;\n\n    printf(\"What gibberish shall I parse?\\n\");\n\n    while((c = getchar()) != '\\n')  //while loop for getting characters from stdin\n        string[i++] = c;\n\n    string[i] = '\\0';  //insert NULL at end of string\n    filter_spaces(string);\n    upper_case(string);\n    char *phrase = strtok(string, strip);\n\n    puts(\"\\nThe phrases entered are: \");\n\n    /*\n    for (token = strtok(string, strip); token; token = strtok(NULL, strip))\n    {\n        puts(token);\n    }\n    */\n\n    i=0;    \n    while(phrase != '\\0')\n    {\n        phrases[i] = strdup(phrase);\n\n        int flag=0;\n        for(k=0; k&lt;i; k++)\n        {\n           if(strcmp(phrases[k], phrase)==0)\n           {\n                tally = tally++;  //add to phrases[k] count\n                flag=1;\n                break;\n           }\n        }\n        if(flag==0)\n        {       \n           printf(\"**** %s \\n\", phrase); //print and continue on\n        }\n        phrase = strtok(NULL, strip);\n        ++i;\n    }\n    printf(\"Total Number of repeated Words = %d\\n\",tally);\n\n    return 0;\n}\n\nvoid upper_case(char string[])\n{\n    int c = 0;\n\n    while (string[c] != '\\0')\n    {\n        if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z')\n        {\n            string[c] = string[c] - 32;\n        }\n        c++;\n    }\n}\n\nvoid filter_spaces(char* string)\n{\n    int i,x;\n    for(i=x=1; string[i]; ++i)\n        if(string[i]!=' ' || string[i+1]!=' ')\n            string[x++] = string[i];\n    string[x] = '\\0';\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4941677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07a00c28243e7b1932e2368a4d426922?s=128&d=identicon&r=PG&f=1", "display_name": "Inertial Observer", "link": "https://stackoverflow.com/users/4941677/inertial-observer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 40627177, "answer_count": 2, "score": 0, "last_activity_date": 1479292981, "creation_date": 1479274870, "question_id": 40624822, "link": "https://stackoverflow.com/questions/40624822/c-no-output-printing-after-changing-strtok-to-incorporate-strcmp", "title": "C - No output printing after changing strtok to incorporate strcmp", "body": "<p>My intention is to create a loop where the tokens <code>phrases</code> are compared. If the phrase is unique (not the same as any others) then it is printed and if the phrase is not unique then <code>tally</code> increases by one and the repeat phrase is not printed. So each phrase is printed only once and later I'll add code to show how many times each phrase was counted. </p>\n\n<p>The program compiles without errors and when it runs there is no output, the program ends and exits. The functions <code>filter_spaces</code> and <code>upper_case</code> are working fine, and it did print the phrases before I changed <code>for (token = strtok(string, strip); token; token = strtok(NULL, strip))</code> to the <code>for</code> loops.  </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;string.h&gt;\n\n    void filter_spaces(char* string);\n    void upper_case(char string[]);\n\n    int main(){\n\n        char c, string[201];\n        int i = 0, k=0, j=0;\n        char strip[] = \",.:;?!\";\n        char* phrases[1000];\n        int tally = 0;\n\n\n        printf(\"What gibberish shall I parse?\\n\");\n\n        while((c = getchar()) != EOF)  //while loop for getting characters from stdin\n\n            string[i++] = c;\n            string[i] = '\\0';  //insert NULL at end of string\n            filter_spaces(string);\n            upper_case(string);\n            char *phrase = strtok(string, strip);\n\n            puts(\"\\nThe phrases entered are: \");\n\n            /*for (token = strtok(string, strip); token; token = strtok(NULL, strip))\n              {\n                puts(token);\n              }\n             */\n\n            while(phrase != '\\0')\n            {\n                phrases[i++] = strdup(phrase);\n                phrase = strtok(NULL, strip);\n\n            for(k=0; k&lt;i-1; k++)\n             {\n                for(j = k+1; j&lt;k; j++)\n                {\n                    if(strcmp(phrases[k], phrases[j])==0)\n                    {\n                        tally = tally++;  //add to phrases[k] count\n                    }\n                    else\n                    {\n                        printf(\"&lt;%s&gt;\\n\", phrase); //print and continue on\n                    }                       \n                 }\n              }\n           } \n\n    return 0;\n    }\n    void upper_case(char string[])\n    {\n      int c = 0;\n\n      while (string[c] != '\\0')\n      {\n        if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z')\n        {\n          string[c] = string[c] - 32;\n         }\n         c++;\n      }\n    }\n\n    void filter_spaces(char* string)\n    {\n      int i,x;\n      for(i=x=1; string[i]; ++i)\n        if(string[i]!=' ' || string[i+1]!=' ')\n          string[x++] = string[i];\n      string[x] = '\\0';\n    }\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 4270, "user_id": 2707359, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8754698c78ca3a082e1593688a9df99c?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2707359/ilya"}, "edited": false, "score": 0, "creation_date": 1479275460, "post_id": 40624821, "comment_id": 68483422, "body": "Have you tried to use debugger? Have you tried to add traces? Just print <code>x</code> in the loop to understand what happens!"}], "owner": {"reputation": 11, "user_id": 7083514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffad1274c8ec58ce1606ea723245d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "Vikrant Pradhan", "link": "https://stackoverflow.com/users/7083514/vikrant-pradhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 1, "closed_date": 1479275450, "answer_count": 0, "score": 1, "last_activity_date": 1479274864, "creation_date": 1479274864, "question_id": 40624821, "link": "https://stackoverflow.com/questions/40624821/the-code-below-not-working-as-intended", "closed_reason": "Duplicate", "title": "the code below not working as intended", "body": "<p>I have written this piece of code as an exercise. It counts the bits used to store integer in one's system.</p>\n\n<p>The code here worked fine and gives correct output when I define \n<strong>unsigned int x</strong>,\n but when I define just <strong>int x</strong> it does not produce any result at all. \nThe program compiles without any error or warnings but does not display anything on the terminal when declaring <strong>x</strong> as just <strong>int</strong></p>\n\n<pre><code>int int_size ()\n{\n    int x = ~0;\n    char bit_count = 0;\n    while ( x != 0 )\n    {\n        x &gt;&gt;= 1;\n        bit_count++;\n    }\n    return bit_count;\n}\n</code></pre>\n\n<p>It works fine with the unsigned <strong>int x</strong> declaration. I am just curious to know why it behaves wierdly when using the <strong>signed int</strong> declaration.</p>\n\n<p>F.Y.I - I m using <strong>CODE::BLOCKS</strong> IDE with the <strong>gcc compiler</strong>.</p>\n"}, {"tags": ["c", "format", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479269622, "post_id": 40623863, "comment_id": 68481663, "body": "<code>&quot;%lf %lf %lf %[^\\n]s%*c&quot;</code> --&gt; <code>&quot;%lf %lf %lf%199[^\\n]%*c&quot;</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1479269976, "post_id": 40623863, "comment_id": 68481728, "body": "The rewind is unnecessary; a file opened for reading has the read position set to the start of the file anyway."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1479270046, "post_id": 40623863, "comment_id": 68481741, "body": "I&#39;m puzzled how your loop reads 5 lines, not 3 lines.  I&#39;m also puzzled about why the third line is labelled the fourth line. Are you looking to read only lines with the trailing comment?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479270061, "post_id": 40623863, "comment_id": 68481749, "body": "Also <code>*temp = 0; fscanf(fp1,format,&amp;value1,&amp;value2,&amp;value3,temp);</code> and Check return value of fcsnf."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479272094, "post_id": 40624054, "comment_id": 68482340, "body": "&quot;...explicitly ask for three doubles separated by spaces&quot; --&gt; OP&#39;s format did not require space anywhere in the file."}, {"owner": {"reputation": 116, "user_id": 7165193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89db2d175f8f02b6a4eaccdb5b0c034f?s=128&d=identicon&r=PG&f=1", "display_name": "GReaperEx", "link": "https://stackoverflow.com/users/7165193/greaperex"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479272470, "post_id": 40624054, "comment_id": 68482461, "body": "Strictly speaking, no. Practically, yes. If they didn&#39;t use any spaces, or any other separating character for that matter, how would fscanf know when the next number starts? Is &quot;1.101.01&quot; broken into &quot;1.1&quot; and &quot;1.01&quot; or &quot;1.101&quot; and &quot;0.01&quot;. Something to think about..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1479272604, "post_id": 40624054, "comment_id": 68482510, "body": "<code>&quot;123+456-789&quot;</code> uses no separating character, each character is part of the textual coding of the 3 numbers.  <code>1.101.01&quot;</code> is 2 FP numbers, <code>1.101</code> and <code>0.01</code>.  Certainly spaces help, but they are not explicitly asked for as this answer asserts.   IAC, the spaces have little to do with OP&#39;s issues.  A space in a <code>scanf()</code> format, unless in <code>[]</code> scanset or modifiers, matches <b>0</b> or more white-space."}], "tags": [], "owner": {"reputation": 116, "user_id": 7165193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89db2d175f8f02b6a4eaccdb5b0c034f?s=128&d=identicon&r=PG&f=1", "display_name": "GReaperEx", "link": "https://stackoverflow.com/users/7165193/greaperex"}, "is_accepted": true, "score": 1, "last_activity_date": 1479274734, "last_edit_date": 1479274734, "creation_date": 1479270152, "answer_id": 40624054, "question_id": 40623863, "link": "https://stackoverflow.com/questions/40623863/fscanf-format-specifier-columnwise-numeric-data-ending-with-or-without-a-comme/40624054#40624054", "title": "fscanf format specifier - columnwise numeric data ending with or without a comment string", "body": "<p>Well, of course it fails, since you explicitly ask for three doubles separated by spaces, then another space, then some arbitrarily long text, then another character( newline ).</p>\n\n<p>You need to make the comment optional. Use a combination of <code>fscanf()</code> and <code>fgets()</code>:</p>\n\n<pre><code>char format[] = \"%lf %lf %lf\";\n\nfscanf(fp1, format, &amp;value1, &amp;value2, &amp;value3);\n\nif (fgets(temp, 200, fp1)) {\n    temp[strcspn(temp, \"\\n\")] = '\\0';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1479276318, "last_edit_date": 1495535559, "creation_date": 1479276318, "answer_id": 40625137, "question_id": 40623863, "link": "https://stackoverflow.com/questions/40623863/fscanf-format-specifier-columnwise-numeric-data-ending-with-or-without-a-comme/40625137#40625137", "title": "fscanf format specifier - columnwise numeric data ending with or without a comment string", "body": "<p>The problem is subtle.  In a <code>scanf()</code>-family format string, a space indicates 0 or more white space characters, which means blanks, tabs or newlines.  Also, all format specifiers except <code>%c</code>, <code>%[\u2026]</code> and <code>%n</code> skip optional leading white space.  And the functions do not care in the slightest about newlines in the white space (newlines only matter in scan-sets).  If you need line oriented input, then you should read the lines with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> or POSIX's <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> and then process the string with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a>.</p>\n\n<p>Your format string is:</p>\n\n<pre><code>char format[] = \"%lf %lf %lf %[^\\n]s%*c\";\n</code></pre>\n\n<p>When the code reaches the data lines:</p>\n\n<pre><code>2.00 2.1 2.4 \n4.00 4.1 4.4 //this is fourth line\n</code></pre>\n\n<p>the format reads the three numbers <code>2.00</code>, <code>2.1</code> and <code>2.4</code>; it then scans for some white space, reading the newline, and finds the <code>4</code> of <code>4.00</code>, then processes the scan-set up to the newline, and then reads and discards the newline with <code>%*c</code>.</p>\n\n<p>If you wanted to stick with <code>scanf()</code> or <code>fscanf()</code> regardless, part of the fix would be to remove the space before the scan-set.  You would also need to analyze the return value from <code>fscanf()</code>, more or less as shown below.  Note that when there is no comment, the newline would be left in the input buffer, but the next <code>fscanf()</code> would skip the newline before next number.</p>\n\n<p>However, you are best off moving to line-based input.  When you use <code>sscanf()</code> instead of the direct file scanning functions, you can leave the space in the format string.  Part of the fix is to check how many values were successfully scanned.  For ease of comprehension of the output, I surround the comment material with square brackets in the format string.</p>\n\n<p>Extracting your code into something resembling an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>) and reading from standard input instead of a file stream that you open, you can end up with code like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char line[4096];\n\n    while (fgets(line, sizeof(line), stdin) != 0)\n    {\n        char temp[200];\n        double value1 = 0.00, value2 = 0.00, value3 = 0.00;\n        char format[] = \"%lf %lf %lf %[^\\n]s%*c\";\n        int nf = sscanf(line, format, &amp;value1, &amp;value2, &amp;value3, temp);\n        if (nf == 4)\n            printf(\"Comment: %lf,%lf,%lf - [%s]\\n\", value1, value2, value3, temp);\n        else if (nf == 3)\n            printf(\"Plain:   %lf,%lf,%lf\\n\", value1, value2, value3);\n        else\n        {\n            line[strcspn(line, \"\\n\")] = '\\0';\n            printf(\"Invalid: [%s]\\n\", line);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Example run:</p>\n\n<pre><code>Comment: 1.000000,1.100000,1.400000 - [//this is first line ]\nPlain:   2.000000,2.100000,2.400000\nComment: 4.000000,4.100000,4.400000 - [//this is fourth line]\nPlain:   3.000000,3.100000,3.400000\nComment: 5.000000,5.100000,5.400000 - [//this is fifth line]\n</code></pre>\n\n<p>Interestingly, the data copied from the question has a blank at the end of the second line.  An earlier version of the code omitted the space before the scan-set in the format string.  The second line then showed up as a comment line, not a plain line, and all the comments included the leading space.  Beware: <code>scanf()</code> format strings are incredibly difficult to master.</p>\n"}], "owner": {"reputation": 69, "user_id": 6629069, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159d6b4c6d339e66f3329ac4a3591987?s=128&d=identicon&r=PG&f=1", "display_name": "DevBee", "link": "https://stackoverflow.com/users/6629069/devbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 40624054, "answer_count": 2, "score": 0, "last_activity_date": 1479276318, "creation_date": 1479268918, "last_edit_date": 1479269218, "question_id": 40623863, "link": "https://stackoverflow.com/questions/40623863/fscanf-format-specifier-columnwise-numeric-data-ending-with-or-without-a-comme", "title": "fscanf format specifier - columnwise numeric data ending with or without a comment string", "body": "<p>I have a datafile with say 3 columns containing float numbers (assume number columns are fixed for now) but the last column is a string of characters that contains spaces (but in a single line).</p>\n\n<p>The problem am facing is not all lines of text file may contain the last comment string, otherwise using </p>\n\n<p><code>fscanf(&lt;file pointer&gt;, %f %f %f %[^\\n]%*c,&amp;var1,&amp;var2,&amp;var3,temp)</code> works</p>\n\n<p>as below: (for 3 rows of data)</p>\n\n<pre><code>FILE *fp1=NULL;\nprintf(\"HELLO\\n\");\ndouble value1 = 0.00,value2 = 0.00,value3=0.00;\nint i=0;\nchar temp[200];\n\nfp1 = fopen(textfile,\"r\");\nrewind(fp1);\nif(fp1 == 0)    { \n    perror(\"ERROR OPENING FILE \");\n    return ;\n}\nchar format[] = \"%lf %lf %lf %[^\\n]s%*c\";\ni=3;\nwhile(i--)\n{\n    fscanf(fp1,format,&amp;value1,&amp;value2,&amp;value3,temp) ;\n    printf(\"%lf,%lf,%lf - \",value1,value2,value3);\n    printf(\"%s\\n\",temp);\n}\nfclose(fp1);\n</code></pre>\n\n<hr>\n\n<p>Above code works for if each row contains a comment as last column, but lines are getting combined if the comment is not there at the end of row.</p>\n\n<h2>For example, it fails for file with data below:</h2>\n\n<pre><code>1.00 1.1 1.4 //this is first line \n2.00 2.1 2.4 \n4.00 4.1 4.4 //this is fourth line\n3.00 3.1 3.4\n5.00 5.1 5.4 //this is fifth line\n</code></pre>\n\n<h2>And gives output as:</h2>\n\n<pre><code>HELLO\n1.000000,1.100000,1.400000 - //this is first line\n2.000000,2.100000,2.400000 - 4.00 4.1 4.4 //this is fourth line\n3.000000,3.100000,3.400000 - 5.00 5.1 5.4 //this is fifth line\n</code></pre>\n\n<p>Hope my issue is clear. </p>\n"}, {"tags": ["c", "arrays", "file", "matrix", "multidimensional-array"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479268793, "post_id": 40623800, "comment_id": 68481487, "body": "<code>fscanf(f,&quot;%c&quot;,&amp;matrix[i][j]);</code> --&gt; <code>fscanf(f,&quot; %c&quot;,&amp;matrix[i][j]);</code> ? Show example of file."}, {"owner": {"reputation": 47, "user_id": 4538566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2PR1.png?s=128&g=1", "display_name": "Harjot Singh", "link": "https://stackoverflow.com/users/4538566/harjot-singh"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479269072, "post_id": 40623800, "comment_id": 68481548, "body": "Yes that worked, thank you so much. Out of curiosity, how does this make the difference?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1479269784, "post_id": 40623800, "comment_id": 68481694, "body": "Skip the previous white-spaces (newline)."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 7165193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89db2d175f8f02b6a4eaccdb5b0c034f?s=128&d=identicon&r=PG&f=1", "display_name": "GReaperEx", "link": "https://stackoverflow.com/users/7165193/greaperex"}, "is_accepted": true, "score": 2, "last_activity_date": 1479272444, "last_edit_date": 1479272444, "creation_date": 1479269076, "answer_id": 40623885, "question_id": 40623800, "link": "https://stackoverflow.com/questions/40623800/reading-characters-from-a-text-file-in-c-and-storing-in-2d-array-problems/40623885#40623885", "title": "Reading characters from a text file in c and storing in 2d array problems", "body": "<p>You didn't specify how your file is structured, so I will just assume that you're accidentally reading in any present blank characters (such as space, newline, tab etc).</p>\n\n<p>Use <code>\" %c\"</code> for <code>fscanf</code> instead. Notice the extra space before <code>'%'</code>, that is important. It tells <code>fscanf</code> to ignore any white-space characters.</p>\n"}], "owner": {"reputation": 47, "user_id": 4538566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2PR1.png?s=128&g=1", "display_name": "Harjot Singh", "link": "https://stackoverflow.com/users/4538566/harjot-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 40623885, "answer_count": 1, "score": 0, "last_activity_date": 1479278898, "creation_date": 1479268516, "last_edit_date": 1479278898, "question_id": 40623800, "link": "https://stackoverflow.com/questions/40623800/reading-characters-from-a-text-file-in-c-and-storing-in-2d-array-problems", "title": "Reading characters from a text file in c and storing in 2d array problems", "body": "<p>The code below is given 3 arguments in the command line, the text file, the # of rows in the matrix and the # of columns in the matrix. The file I pass in has 10 rows and 12 columns. If I pass 10(for rows) and 12(for columns) in the command line, for some reason it outputs up until the 8th index row and 7th index column. If i pass 11 and 13 it will output the full matrix plus the @ symbol at the end. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) \n{\n    FILE *f;\n    int i = 0,j = 0;\n\n    if(argc != 4)\n    {\n        printf(\"You did not enter a file name and/or rows/columns.\");\n    }\n    else\n    {\n        int rows = atoi(argv[2])  ;\n        int columns = atoi(argv[3]) ;\n        char matrix[rows][columns];\n\n        f = fopen(argv[1], \"r\");\n        if(f == NULL)\n        {\n            printf(\"Invalid File\");\n        }\n        else\n        {\n            for(i = 0 ; i &lt; rows ; i++)\n            {\n                for(j = 0 ; j &lt; columns ; j++)\n                {\n                    fscanf(f,\"%c\",&amp;matrix[i][j]);               \n                    printf(\"%c\", matrix[i][j]);\n                }       \n            }\n        }\n\n        fclose(f);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop", "switch-statement"], "comments": [{"owner": {"reputation": 13, "user_id": 7050813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d96462b90aeab9f83fdadf57adfa3c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7050813/andrew"}, "edited": false, "score": 0, "creation_date": 1479267927, "post_id": 40623635, "comment_id": 68481263, "body": "if you reach this page, my fix was change the first scanf from <code>scanf(&quot;%c&quot;,&amp;option)</code> to <code>scanf(&quot;  %c&quot;,&amp;option)</code>. I added a space before `  %c`"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 7045778, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-O2D8aUiiCO4/AAAAAAAAAAI/AAAAAAAAAEY/_dOwZgx1zNo/photo.jpg?sz=128", "display_name": "Darshan b", "link": "https://stackoverflow.com/users/7045778/darshan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1479291693, "creation_date": 1479291693, "answer_id": 40629584, "question_id": 40623635, "link": "https://stackoverflow.com/questions/40623635/after-the-first-loop-run-i-get-stuck-at-the-default-case-inside-the-switch/40629584#40629584", "title": "After the first loop run, i get stuck at the default case inside the switch", "body": "<p>When you are reading a character using scanf - you will input y and press . y will be assigned to option (ie option - Y) and  will be in buffer. when you call scanf next time  present in the buffer will be assigned to option hence goes to the default case.\nto avoid this leave a space before %c in scanf. this does not happen in case of integers or float.</p>\n"}], "owner": {"reputation": 13, "user_id": 7050813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d96462b90aeab9f83fdadf57adfa3c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7050813/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479291693, "creation_date": 1479267381, "last_edit_date": 1479267574, "question_id": 40623635, "link": "https://stackoverflow.com/questions/40623635/after-the-first-loop-run-i-get-stuck-at-the-default-case-inside-the-switch", "title": "After the first loop run, i get stuck at the default case inside the switch", "body": "<p>1.For some reason i get stuck at the default case after the first loop run, does not matter what I input 'y' or 'n'.</p>\n\n<pre><code>    while(edit==1){\n\n        option='\\0';\n        printf(\"Would you like to edit?(y or n)\\n\");\n        scanf(\"%c\",&amp;option);\n        getchar();\n\n          // getchar() so if forces scanf()\n\n        switch(option){\n\n            // first run is flawless\n\n            case 'y':\n                printf(\"What would like to edit?\\n\");\n                printf(\"1)Edit an entire line.\\n\");\n                printf(\"2)Edit a substring of a line.\\n\");\n\n                scanf(\"%c\",&amp;option);\n\n                if(option=='1'){\n\n                } else if(option =='2'){\n\n                    printf(\"What word to change :\");\n                    scanf(\"%s\",toFind);\n\n                    printf(\"What would to change \\\"%s\\\" to :\", toFind);\n                    scanf(\"%s\",replaceWith);\n\n                    printf(\"which line to search :\");\n                    scanf(\"%d\",&amp;line);\n\n                    replaceInString(buffer[line], toFind, replaceWith);\n                    printBuffer(buffer);\n\n                } else printf(\"Invalid input!!!\\nTry again\\n\");\n                edit=1;\n                break;\n\n            case 'n':\n                edit=0;\n                printBuffer(buffer);\n                break;\n\n            default:\n                printf(\"Invalid input!!!\\nTry again\\n\");\n                // first run is fine then i get stuck here.\n        }\n    }\n</code></pre>\n"}]