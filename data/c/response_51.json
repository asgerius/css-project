[{"tags": ["c"], "comments": [{"owner": {"reputation": 20231, "user_id": 1342730, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/36543a7316596ec6e930bc8c996bf14b?s=128&d=identicon&r=PG", "display_name": "mathematician1975", "link": "https://stackoverflow.com/users/1342730/mathematician1975"}, "edited": false, "score": 2, "creation_date": 1451520104, "post_id": 34539109, "comment_id": 56820495, "body": "It is telling you that you are invoking undefined behaviour - this is because you are reading beyond the limits of your array"}, {"owner": {"reputation": 46031, "user_id": 906773, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/100001846242483/picture?type=large", "display_name": "Jesse Good", "link": "https://stackoverflow.com/users/906773/jesse-good"}, "edited": false, "score": 1, "creation_date": 1451520180, "post_id": 34539109, "comment_id": 56820516, "body": "You know arrays are zero-indexed? <code>0</code> to <code>14</code> are valid indexes."}, {"owner": {"reputation": 1571, "user_id": 689242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jz42l.jpg?s=128&g=1", "display_name": "71GA", "link": "https://stackoverflow.com/users/689242/71ga"}, "edited": false, "score": 0, "creation_date": 1451520647, "post_id": 34539109, "comment_id": 56820652, "body": "Jesus. I forgot the basics... It starts with 0!!! =) Thank you guys."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1451520758, "last_edit_date": 1451520758, "creation_date": 1451520135, "answer_id": 34539148, "question_id": 34539109, "link": "https://stackoverflow.com/questions/34539109/warning-undefined-behavior-waggressive-loop-optimizations/34539148#34539148", "title": "WARNING - &quot;Undefined behavior [-Waggressive-loop-optimizations]&quot;", "body": "<p>In the second case, code accessed <code>posiljka[sizeof(posiljka)/sizeof(posiljka[0])]</code> which is outside the array bounds.</p>\n\n<p>In this case, <code>sizeof(posiljka)/sizeof(posiljka[0])</code> is <code>15</code>, so <code>posiljka[15]</code> is one pass the array element containing the null character.</p>\n\n<p>That code \"works\" is undefined behavior.</p>\n\n<hr>\n\n<p>An interesting aspect of undefined behavior is that a compiler, when it is using \"aggressive-loop-optimizations\", can sometimes detect this out array access.  Since it is UB, the compiler could skip attempting <code>posiljka[15]</code> (Or it might not on Tuesdays.), thus doing the loop in 1 less iterations than directed.  </p>\n"}, {"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 2, "last_activity_date": 1451520196, "creation_date": 1451520196, "answer_id": 34539163, "question_id": 34539109, "link": "https://stackoverflow.com/questions/34539109/warning-undefined-behavior-waggressive-loop-optimizations/34539163#34539163", "title": "WARNING - &quot;Undefined behavior [-Waggressive-loop-optimizations]&quot;", "body": "<p>The last element of your array is at index <code>sizeof(posiljka)/sizeof(posiljka[0]) - 1</code>. If you change <code>&lt;</code> with <code>&lt;=</code>, the last iteration of your loop with try to access:</p>\n\n<pre><code> THR = posiljka[sizeof(posiljka)/sizeof(posiljka[0])];\n</code></pre>\n\n<p>that is one past the last element of your array. Accessing an element outside of an array invokes undefined behavior and the compiler is kind to tell you.</p>\n\n<blockquote>\n  <p>The program works</p>\n</blockquote>\n\n<p>No, it does not. You program is erroneous and it can crash in a further execution or if compiled with a different compiler.</p>\n"}], "owner": {"reputation": 1571, "user_id": 689242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Jz42l.jpg?s=128&g=1", "display_name": "71GA", "link": "https://stackoverflow.com/users/689242/71ga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 34539163, "answer_count": 2, "score": 0, "last_activity_date": 1451520758, "creation_date": 1451519932, "question_id": 34539109, "link": "https://stackoverflow.com/questions/34539109/warning-undefined-behavior-waggressive-loop-optimizations", "title": "WARNING - &quot;Undefined behavior [-Waggressive-loop-optimizations]&quot;", "body": "<p>I am trying to send my string of characters through UART using C programming language. I do it by loading my characters into THR register one by one like this: </p>\n\n<pre><code>unsigned char posiljka[] = \"Ziga Lausegger\";    \n\nwhile(1){\n\n    for ( int i = 0 ; i &lt; ( sizeof(posiljka)/sizeof(posiljka[0]) ) ; ++i ){\n        THR = posiljka[i];\n    }\n</code></pre>\n\n<p>This compiles and works completely fine. When I change <code>&lt;</code> in the for statement to <code>&lt;=</code> my program looks like this:</p>\n\n<pre><code>unsigned char posiljka[] = \"Ziga Lausegger\";    \n\nwhile(1){\n\n    for ( int i = 0 ; i &lt;= ( sizeof(posiljka)/sizeof(posiljka[0]) ) ; ++i ){\n        THR = posiljka[i];\n    }\n</code></pre>\n\n<p>and produces a warning during compilation: </p>\n\n<pre><code>/home/ziga/Dropbox/workspace/mikrokrmilniki/LPC4088/primeri/delujoci/010-uart&gt; make -j2\ncompiling main.c (gcc)\nmain.c: In function 'main':\nmain.c:48:18: warning: iteration 15u invokes undefined behavior [-Waggressive-loop-optimizations]\n    THR = posiljka[i];\n                  ^\nmain.c:42:3: note: containing loop\n   for ( int i = 0 ; i &lt;= ( sizeof(posiljka)/sizeof(posiljka[0]) ) ; ++i ){\n   ^\nlinking executable.elf (gcc)\n\n*****\n***** You must modify vector checksum value in *.bin and *.hex files.\n*****\n\narm-none-eabi-size executable.elf\n   text    data     bss     dec     hex filename\n  26496     188     464   27148    6a0c executable.elf\n*** Finished ***\n</code></pre>\n\n<p>The program works, but I still want to know what does this warning mean?</p>\n"}, {"tags": ["c", "newline", "scanf"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1451518597, "post_id": 34538887, "comment_id": 56820114, "body": "How many lines do you want to read?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1451518977, "post_id": 34538887, "comment_id": 56820219, "body": "In my experience, C&#39;s <code>scan</code> functions are never the right solution. I always just <code>fgets()</code> a big string and do the interpretation myself."}, {"owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1451518984, "post_id": 34538887, "comment_id": 56820220, "body": "@ElliottFrisch , thank you for your reply. All of them, what&#39;s preventing me from moving on to figuring out hotkey combos work in C IS this issue. I want the program to keep going line after enter key  after line and so on, of input until i issue a key-combo to bring up a save, exit, etc. dialog. I am a beginner."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 1, "creation_date": 1451519280, "post_id": 34538887, "comment_id": 56820297, "body": "If you want to work with lines like that; take a look at <a href=\"https://en.wikipedia.org/wiki/GNU_Readline\" rel=\"nofollow noreferrer\">GNU readline</a> or <a href=\"http://thrysoee.dk/editline/\" rel=\"nofollow noreferrer\">editline</a>. And, for key-combos (and terminal manipulation) I&#39;d suggest <a href=\"https://www.gnu.org/software/ncurses/\" rel=\"nofollow noreferrer\">ncurses</a> and/or <a href=\"http://linux.die.net/man/3/termios\" rel=\"nofollow noreferrer\"><code>termios</code></a>."}, {"owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1451519477, "post_id": 34538887, "comment_id": 56820349, "body": "@ElliottFrisch , Thanks again, I am looking at ncurses but still a bit dense, i almost have a handle on colors though. I tried the recursive trick with the above which was goofy and fun but ultimately meh."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 1, "creation_date": 1451520399, "post_id": 34538887, "comment_id": 56820585, "body": "You changed <code>%d</code> to <code>&amp;d</code>. Oops!"}, {"owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1451520472, "post_id": 34538887, "comment_id": 56820607, "body": "@Kaz yeah but it still seemed to work. Is that odd? I though &amp; would return address?"}, {"owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1451520839, "post_id": 34538887, "comment_id": 56820702, "body": "@Kaz both <code>%d</code> and <code>&amp;d</code> work. =p i am confuzed."}, {"owner": {"reputation": 16916, "user_id": 1562138, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/qwj5I.png?s=128&g=1", "display_name": "fvgs", "link": "https://stackoverflow.com/users/1562138/fvgs"}, "edited": false, "score": 1, "creation_date": 1451523161, "post_id": 34538887, "comment_id": 56821280, "body": "The first argument you pass to <code>scanf()</code> is a format string. A format string is used in many functions such as <code>scanf()</code> and <code>printf()</code>. I suggest doing some reading on format strings for better understanding how they work. That said, <code>%d</code> serves as a format specifier for the format string which makes it &quot;special&quot; when found within a format string. <code>&amp;d</code> on the other hand is just plain text in the context of a format string. Note that <code>&amp;</code>, in the context of a format string or any other string, is just a character and does not function like the address-of operator."}, {"owner": {"reputation": 16916, "user_id": 1562138, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/qwj5I.png?s=128&g=1", "display_name": "fvgs", "link": "https://stackoverflow.com/users/1562138/fvgs"}, "edited": false, "score": 1, "creation_date": 1451523253, "post_id": 34538887, "comment_id": 56821299, "body": "The fact that there is no observable difference between your use of <code>%d</code> and <code>&amp;d</code> in the format string is to be expected since you don&#39;t seem to be doing anything with the variable <code>i</code>. Again, I suggest looking into how format strings work in order to understand why this is the case. But in the context of your example, it makes sense, and would be expected, for you to be using <code>%d</code> (or a similar format specifier) rather than <code>&amp;d</code> which doesn&#39;t really make sense in this context."}], "answers": [{"tags": [], "owner": {"reputation": 16916, "user_id": 1562138, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/qwj5I.png?s=128&g=1", "display_name": "fvgs", "link": "https://stackoverflow.com/users/1562138/fvgs"}, "is_accepted": true, "score": 1, "last_activity_date": 1451523375, "last_edit_date": 1451523375, "creation_date": 1451519457, "answer_id": 34539043, "question_id": 34538887, "link": "https://stackoverflow.com/questions/34538887/surviving-enter-carriage-return-in-c/34539043#34539043", "title": "Surviving Enter/carriage return in C", "body": "<p>When you call <code>scanf()</code> the program will block, waiting for console input. Thus, once you press enter, the input you submitted will be read in and <code>scanf()</code> will return. Once <code>scanf()</code> returns, your program will continue to execute. In the example you gave, there is no more code to execute after <code>scanf()</code> returns. Therefore, the <code>main()</code> function implicitly returns 0 and causes your program to exit.</p>\n\n<p>If you want to continue reading in lines of input, you can do something like the following:</p>\n\n<pre><code>while (true) {\n    scanf(\"%d\", &amp;i);\n}\n</code></pre>\n\n<p>In practice, there are better ways to do this, as Elliot Frisch mentioned. But in principle, this is what I think you're trying to do.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "edited": false, "score": 0, "creation_date": 1451520684, "post_id": 34539144, "comment_id": 56820667, "body": "Thanks for this as well, I would green check but hexturtle won out."}, {"owner": {"reputation": 6675, "user_id": 854742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc3befe29d589c7c34fd1600affc041?s=128&d=identicon&r=PG", "display_name": "Carey Gregory", "link": "https://stackoverflow.com/users/854742/carey-gregory"}, "edited": false, "score": 1, "creation_date": 1451522126, "post_id": 34539144, "comment_id": 56821026, "body": "<code>fgets</code> is vastly superior to <code>scanf(&quot;%s&quot;</code> if all you want to do is read input line by line. Using <code>scanf</code> for that is the hard, slow, inefficient way to do it."}], "tags": [], "owner": {"reputation": 1337, "user_id": 2116768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/INWvO.png?s=128&g=1", "display_name": "Dylan Kirkby", "link": "https://stackoverflow.com/users/2116768/dylan-kirkby"}, "is_accepted": false, "score": 1, "last_activity_date": 1451520680, "last_edit_date": 1451520680, "creation_date": 1451520103, "answer_id": 34539144, "question_id": 34538887, "link": "https://stackoverflow.com/questions/34538887/surviving-enter-carriage-return-in-c/34539144#34539144", "title": "Surviving Enter/carriage return in C", "body": "<p>The <code>fread()</code> function does what you say you want.  It will read a specified number of bytes or until it reaches an EOF, which is inputted to the keyboard with a CTRL+D on unix.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n#define MAX_STR_LEN 500\n\nint main()\n{\n    // Declare a char array to read into\n    char str[MAX_STR_LEN + 1];\n\n    // Read into the char array until MAX_STR_LEN bytes\n    // have been read or EOF\n    fread(str, 1, MAX_STR_LEN, stdin);\n\n    // Null Terminate and print what we read in\n    str[MAX_STR_LEN] = '\\0';\n    printf(\"%s\", str);\n    fflush(stdout);\n}\n</code></pre>\n\n<p>This downside is you don't get the fancy <code>scanf</code> format specifiers.  You just have to deal with the big resultant string yourself.</p>\n\n<p>But realize this: in the background, <code>fread()</code> is making multiple <code>read()</code> system calls, which return after each newline.  So I don't think there is anything to be gained from a single function that survives newlines.</p>\n\n<p>In practice, what I've found the best solution to \"read past newlines\" is to read a file line-by-line.  That can be done with the more elegant code below, and if you really need the resulting strings concatenated, just use <code>strcat()</code> on the strings as they come.</p>\n\n<pre><code>while (EOF != scanf(\"%s\", &amp;str)) {\n   // Do something\n}\n</code></pre>\n\n<p>But the code above does what you are asking.</p>\n"}], "owner": {"reputation": 117, "user_id": 5119585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avLF5.png?s=128&g=1", "display_name": "moonbutt74", "link": "https://stackoverflow.com/users/5119585/moonbutt74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 34539043, "answer_count": 2, "score": -2, "last_activity_date": 1451525456, "creation_date": 1451518298, "last_edit_date": 1451525456, "question_id": 34538887, "link": "https://stackoverflow.com/questions/34538887/surviving-enter-carriage-return-in-c", "title": "Surviving Enter/carriage return in C", "body": "<pre><code># make test\ncc     test.c   -o test\n# ./test\nI am a happy yam until i hit return...\n# ./test\nbecause it ends my [BLEEPING] program....\n# ./test\nOOOH  how my blood doth burn !!!  ...doth? ...doest? ...meh...\n# cat test.c\n#include \"usual_suspects.h\"\n\nint main()\n{\n    int i;\n    scanf( \"%d\", &amp;i);\n}\n# echo 'So, how do I continue onto the next line\n&gt; without terminating the program? Not a wrapping function but,surviving\n&gt; hitting the enter key?\n</code></pre>\n\n<p>Not quite the Dornishman's wife but hey, I'm low budget and half-brained. xD\nis scanf the write way (see what i did there) to go with this?</p>\n\n<p><strong>UPDATE- as per answer a la hexturtle</strong></p>\n\n<pre><code># make test\ncc     test.c   -o test\n# ./test\nWell blow me down, a cross-eyed clown !\nSaid a can of yams imported from Spain.\nIf i had a bucket to spit,       \nI'd sorely say frak-it and quit !\nWhilst watching my brine wash away\n        with the rain. xD\n^C\n# YES !!!!!!!!!\nbash: YES: command not found\n# cat test.c\n#include \"usual_suspects.h\"\n\nint main()\n{\n    int i;\n    while (true) {\n        scanf(\"&amp;d\", &amp;i);\n    }\n}\n</code></pre>\n\n<p><strong>Final edit, promise =D</strong>\nOKAY, This is as small as it get's i think.</p>\n\n<pre><code>#include \"usual_suspects.h\"\n    int main()\n    {\n        while (true) {         \n        scanf(\"%d\");\n        }\n    }\n</code></pre>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1451518437, "post_id": 34538869, "comment_id": 56820071, "body": "What are you expecting to happen when the last element is deleted? You could have some &quot;pointer to the first element&quot; that goes to NULL. Or you could have a sentinel at the beginning of the list whose <code>next</code> goes to NULL. But you have to have some way to represent the fact that the list is empty, and I don&#39;t see how your code does that."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 3, "creation_date": 1451518628, "post_id": 34538869, "comment_id": 56820120, "body": "The line <code>strncpy(newPtr-&gt;fdetails,fdetails,sizeof(Waiting));</code> is surely using the wrong size..."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 1, "creation_date": 1451518856, "post_id": 34538869, "comment_id": 56820187, "body": "Do you initialize your list with a NULL pointer at the start of your program?"}, {"owner": {"reputation": 179, "user_id": 5708284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/341bc8f7e677b87a53b8c43235b62aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Mostafa Abdulrazic", "link": "https://stackoverflow.com/users/5708284/mostafa-abdulrazic"}, "edited": false, "score": 0, "creation_date": 1451518972, "post_id": 34538869, "comment_id": 56820217, "body": "Yes I do, sorry forgot to put the code for it"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1451519656, "post_id": 34538869, "comment_id": 56820396, "body": "@DavidSchwartz he has a pointer to (typedeffed) pointer, but does not exploit its full potential."}, {"owner": {"reputation": 965, "user_id": 633525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh1Al.png?s=128&g=1", "display_name": "darklion", "link": "https://stackoverflow.com/users/633525/darklion"}, "edited": false, "score": 1, "creation_date": 1451534514, "post_id": 34538869, "comment_id": 56823660, "body": "I cannot see anything in your code which would cause an error when the last element of a list is deleted. But it will definitely crash if you give it an empty list (ie: one with *waitingPtr = NULL) which could happen depending on the rest of your code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1451554078, "post_id": 34538869, "comment_id": 56829854, "body": "It appears your difficulty deleting the last node is set in motion when you call <code>AddToWaitList</code> for your <i>first</i> node. Any time you create/delete the <i>first</i> node, you must pass the <i>pointer address</i> of your list to the function where the creation occurs. Otherwise, you are simply operating on a <i>copy</i> of the pointer passed. When you go to removed the last (<i>first</i>) node, you most likely receive a segmentation fault. I suspect if you examine your <code>next</code>, <code>prev</code> chain of pointers for your list, you will find a stray pointer surrounding your first node. Step through it carefully."}, {"owner": {"reputation": 179, "user_id": 5708284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/341bc8f7e677b87a53b8c43235b62aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Mostafa Abdulrazic", "link": "https://stackoverflow.com/users/5708284/mostafa-abdulrazic"}, "edited": false, "score": 0, "creation_date": 1451571596, "post_id": 34538869, "comment_id": 56837005, "body": "Can someone post the code? I am seriously confused :/"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1451591908, "post_id": 34538869, "comment_id": 56844501, "body": "Here is an annotated example of a <a href=\"http://pastebin.com/BirWtkvb\" rel=\"nofollow noreferrer\"><b>singly-linked circular list</b></a> that should help. Look at <code>void delete_list (lline *list)</code>, and <code>void delete_node (lline **list, size_t nth)</code>. Also look at <code>lline *insert_node (lline **list, char *s, size_t n)</code> and <code>lline *create_node (char *s, size_t n)</code>"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1518678587, "post_id": 34538869, "comment_id": 84605847, "body": "With what arguments are you calling <code>AddToWaitList</code> and <code>RemoveFromWaiting</code>?"}], "owner": {"reputation": 179, "user_id": 5708284, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/341bc8f7e677b87a53b8c43235b62aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Mostafa Abdulrazic", "link": "https://stackoverflow.com/users/5708284/mostafa-abdulrazic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451547688, "creation_date": 1451518175, "last_edit_date": 1451547688, "question_id": 34538869, "link": "https://stackoverflow.com/questions/34538869/deleting-last-element-in-an-ordered-linked-list-in-c", "title": "Deleting last element in an ordered linked list in C", "body": "<p>I have a linked list that organizes the data in ascending order based on one of its values (each node has more than one variable saved).  I delete the node from the linked list based on a criteria.  Thing is, it works and it removes each node when the condition is met but when it comes to the last element it always crashes when it removes it and I have no idea why. I have searched everywhere for it and tried different approaches but non helped so </p>\n\n<blockquote>\n  <p>I was hoping someone could tell me what is causing this crashing by looking at my code.</p>\n</blockquote>\n\n<p>Here's my delete function:</p>\n\n<pre><code>void RemoveFromWaiting(wPtr *waitingPtr,int MinsToLand)\n{\n    wPtr previousPtr;\n    wPtr currentPtr;\n    wPtr tempPtr;\n\n    if(MinsToLand == (*waitingPtr)-&gt;MinsToLand)\n    {\n        tempPtr=*waitingPtr;\n        *waitingPtr=(*waitingPtr)-&gt;nextPtr;\n        free(tempPtr);\n\n    }\n    else\n    {\n        previousPtr=*waitingPtr;\n        currentPtr=(*waitingPtr)-&gt;nextPtr;\n\n        while(currentPtr!=NULL &amp;&amp; currentPtr-&gt;MinsToLand != MinsToLand)\n        {\n            previousPtr=currentPtr;\n            currentPtr=currentPtr-&gt;nextPtr;\n        }\n\n        if(currentPtr!=NULL)\n        {\n            tempPtr=currentPtr;\n            previousPtr-&gt;nextPtr=currentPtr-&gt;nextPtr;\n            free(tempPtr);\n        }\n    }\n}\n</code></pre>\n\n<p>If it is of any use here's the structure and the function that adds the values to the list in the first place:</p>\n\n<pre><code>struct WaitingList{\n    char fdetails[10];\n    int ArrivalTimeHours;\n    int ArrivalTimeMins;\n    int MinsToLand;\n    int MinsForFuel;\n    int passengers;\n    struct WaitingList *nextPtr;\n};\n\ntypedef struct WaitingList Waiting;\ntypedef Waiting *wPtr;\n\nvoid AddToWaitList(wPtr *waitingPtr, char fdetails[], int ArrivalTimeHours, \n    int ArrivalTimeMins, int MinsToLand, int MinsForFuel, int passengers)\n{\n    wPtr newPtr;\n    wPtr previousPtr;\n    wPtr currentPtr;\n\n    newPtr=malloc(sizeof(Waiting));\n\n    if( newPtr!=NULL)\n    {\n        strncpy(newPtr-&gt;fdetails,fdetails,sizeof(Waiting));\n        newPtr-&gt;ArrivalTimeHours=ArrivalTimeHours;\n        newPtr-&gt;ArrivalTimeMins=ArrivalTimeMins;\n        newPtr-&gt;MinsForFuel=MinsForFuel;\n        newPtr-&gt;MinsToLand=MinsToLand;\n        newPtr-&gt;passengers=passengers;\n        newPtr-&gt;nextPtr=NULL;\n\n        previousPtr=NULL;\n        currentPtr=*waitingPtr;\n\n        while(currentPtr!=NULL &amp;&amp; MinsToLand &gt; currentPtr-&gt;MinsToLand)\n        {\n            previousPtr=currentPtr;\n            currentPtr=currentPtr-&gt;nextPtr;\n        }\n\n        if(previousPtr==NULL)\n        {\n            newPtr-&gt;nextPtr=*waitingPtr;\n            *waitingPtr=newPtr;\n        }\n        else\n        {\n            previousPtr-&gt;nextPtr=newPtr;\n            newPtr-&gt;nextPtr=currentPtr;\n        }\n    }\n}\n</code></pre>\n\n<p>I basically delete one of the nodes when the variable <code>MinsToLand</code> entered to the function is equal to one of the same value in one of the nodes. My function does that already but when it's deleting the last element in crashes.</p>\n"}, {"tags": ["c", "string", "gcc", "unicode", "ncurses"], "comments": [{"owner": {"reputation": 1075, "user_id": 2539954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1ef914985b0030db224fbb296d0c9d0a?s=128&d=identicon&r=PG", "display_name": "Erik Nyquist", "link": "https://stackoverflow.com/users/2539954/erik-nyquist"}, "edited": false, "score": 1, "creation_date": 1451520843, "post_id": 34538814, "comment_id": 56820704, "body": "can you post the code you are using to print?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1451521034, "post_id": 34538814, "comment_id": 56820755, "body": "Have you considered using the ncurses <code>border</code> function?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1451522604, "post_id": 34538814, "comment_id": 56821146, "body": "Also, you don&#39;t need <code>-finput-charset=UTF-8</code>, first because it will be the default and second because there is not a single non-ascii character in your source code (or at least, the part you are sharing with us), and that is what <code>-finput-charset</code> refers to: the character set of the source code itself."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1451522493, "creation_date": 1451522493, "answer_id": 34539462, "question_id": 34538814, "link": "https://stackoverflow.com/questions/34538814/print-unicode-characters-in-c-using-ncurses/34539462#34539462", "title": "Print Unicode characters in C, using ncurses", "body": "<p><code>ncurses</code> defines the values <code>ACS_HLINE</code>, <code>ACS_VLINE</code>, <code>ACS_ULCORNER</code>, <code>ACS_URCORNER</code>, <code>ACS_LLCORNER</code> and <code>ACS_LRCORNER</code>. You can use those constants in <code>addch</code> and friends, which should result in your seeing the expected box characters. (There's lots more ACS characters; you'll find a complete list in <code>man addch</code>.)</p>\n\n<p><code>ncurses</code> needs to know what it is drawing because it needs to know exactly where the cursor is all the time. Outputting console control sequences is not a good idea; if ncurses knows how to handle the sequence, it has its own abstraction for the feature and you should use that abstraction. The ACS (\"alternate character set\") defines are one of those abstractions.</p>\n"}, {"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 2, "last_activity_date": 1451526518, "creation_date": 1451526518, "answer_id": 34539942, "question_id": 34538814, "link": "https://stackoverflow.com/questions/34538814/print-unicode-characters-in-c-using-ncurses/34539942#34539942", "title": "Print Unicode characters in C, using ncurses", "body": "<p>A few issues:</p>\n\n<ul>\n<li>if your program writes something like <code>\"\\e(0\\x6a\\e(B\"</code> using <a href=\"http://invisible-island.net/ncurses/man/curs_addstr.3x.html\" rel=\"nofollow\">addstr</a>, then ncurses (<em>any</em> curses implementation) will translate the individual characters to printable form as described in the <a href=\"http://invisible-island.net/ncurses/man/curs_addch.3x.html#h3-Adding-characters\" rel=\"nofollow\">addch</a> manual page.</li>\n<li>ncurses supports line-drawing for commonly-used pseudo-graphics using symbols (such as <code>ACS_HLINE</code>) which are predefined characters with the <code>A_ALTCHARSET</code> attribute combined.  You can read about those in the <a href=\"http://invisible-island.net/ncurses/man/curs_addch.3x.html#h3-Line-Graphics\" rel=\"nofollow\"><em>Line Graphics</em></a> section of the <code>addch</code> manual page.</li>\n<li>the code <code>0x6a</code> is ASCII <code>j</code>, which (given a VT100-style mapping) would be the lower left corner.  The curses symbol for that is <code>ACS_LRCORNER</code>.</li>\n<li>you cannot write the line-drawing characters with <code>addstr</code>; instead <code>addch</code>, <a href=\"http://invisible-island.net/ncurses/man/curs_addchstr.3x.html\" rel=\"nofollow\"><code>addchstr</code></a> are useful.  There are also functions oriented to line-drawing (see <a href=\"http://invisible-island.net/ncurses/man/curs_border.3x.html\" rel=\"nofollow\"><code>box</code></a> and friends).</li>\n<li><p>running in Ubuntu, your locale encoding is probably UTF-8.  To make your program work properly, it should initialize the locale as described in the <a href=\"http://invisible-island.net/ncurses/man/ncurses.3x.html#h3-Initialization\" rel=\"nofollow\">Initialization</a> section of the ncurses manual page.  In particular:</p>\n\n<p>setlocale(LC_ALL, \"\");</p>\n\n<p>Also, your program should link against the ncurses<strong>w</strong> library (<code>-lncursesw</code>) to use UTF-8, rather than just ncurses (<code>-lncurses</code>).</p></li>\n<li>when compiling on Ubuntu, to use the proper header definitions, you should define <code>_GNU_SOURCE</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 512403, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/2STna.png?s=128&g=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/512403/isaac"}, "is_accepted": false, "score": 2, "last_activity_date": 1581352598, "creation_date": 1581352598, "answer_id": 60154631, "question_id": 34538814, "link": "https://stackoverflow.com/questions/34538814/print-unicode-characters-in-c-using-ncurses/60154631#60154631", "title": "Print Unicode characters in C, using ncurses", "body": "<p>BTW, maybe I'm probably arriving somewhat late to the party but I'll give you some insight that might or not shed some light and skills for your \"box drawing\" needs.</p>\n\n<p>As of 2020 I'm involved in a funny project on my own mixing Swift + Ncurses (under OSX for now, but thinking about mixing it with linux). Apparently it works flawlessly.</p>\n\n<p>The thing is, as I'm using Swift, internally it all reduces to \"importing .h and .c\" files from some Darwin.ncurses library the MacOS Xcode/runtime offers.</p>\n\n<p>That means (I hope) my newly acquired skills might be useful for you because apparently we're using the very same .h and .c files for our ncurses needs. (or at least they should be really similar)</p>\n\n<p>Said that:</p>\n\n<hr>\n\n<p>As of now, I \"ignored\" ACS_corner chars (I can't find them under swift/Xcode/Darwin.ncurses runtime !!!) in favour of pure UTF \"corner chars\", which also exist in the unicode pointspace, look:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Box-drawing_character\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Box-drawing_character</a></p>\n\n<p>What does it mean? Whenever I want to use some drawing box chars around I just copy&amp;paste pure UTF-8 chars into my strings, and I send these very strings onto addstr. </p>\n\n<p>Why does it work? Because as someone also answered above, before initializing ncurses with initscr(), I just claimed \"I want a proper locale support\" in the form of a setlocale(LC_ALL, \"\"); line.</p>\n\n<p>What did I achieve? Apparently pure magic. And very comfortable one, as I just copy paste box chars inside my normal strings. At least under Darwin.ncurses/OSX Mojave I'm getting, not only \"bounding box chars\", but also full UTF8 support.</p>\n\n<p>Try the \"setlocale(LC_ALL, \"\"); initscr();\" approach and tell us if \"drawing boxes\" works also for you under a pure C environment just using UTF8 bounding box chars.</p>\n\n<p>Greetings and happy ncursing!</p>\n"}], "owner": {"reputation": 65, "user_id": 5615949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08fd4d4707cc46ce0a3d275f7ee9c7cf?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Lajoie", "link": "https://stackoverflow.com/users/5615949/jon-lajoie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3759, "favorite_count": 3, "answer_count": 3, "score": 5, "last_activity_date": 1581352598, "creation_date": 1451517890, "last_edit_date": 1451518979, "question_id": 34538814, "link": "https://stackoverflow.com/questions/34538814/print-unicode-characters-in-c-using-ncurses", "title": "Print Unicode characters in C, using ncurses", "body": "<p>I have to draw a box in C, using ncurses;</p>\n\n<p>First, I have defined some values for simplicity:</p>\n\n<pre><code>#define RB \"\\e(0\\x6a\\e(B\"  (ASCII 188,Right bottom, for example)\n</code></pre>\n\n<p>I have compiled with gcc, over Ubuntu, with <code>-finput-charset=UTF-8</code> flag.</p>\n\n<p>But, if I try to print with addstr or printw, I get the hexa code.\nWhat I`m doing wrong?</p>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 5, "creation_date": 1451517193, "post_id": 34538694, "comment_id": 56819633, "body": "You never set the initial values of the array to something useful (such as <code>0</code>) so it contains random values."}, {"owner": {"reputation": 1, "user_id": 5648482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Doob", "link": "https://stackoverflow.com/users/5648482/joseph-doob"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1451517316, "post_id": 34538694, "comment_id": 56819679, "body": "Excuse me, Also the constant R is equal to 256"}, {"owner": {"reputation": 1, "user_id": 5648482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Doob", "link": "https://stackoverflow.com/users/5648482/joseph-doob"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1451517352, "post_id": 34538694, "comment_id": 56819696, "body": "@Jongware what is the best way to do that?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1451517575, "post_id": 34538694, "comment_id": 56819776, "body": "<code>int freqcounts[R] = { 0 };</code>"}, {"owner": {"reputation": 1, "user_id": 5648482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Doob", "link": "https://stackoverflow.com/users/5648482/joseph-doob"}, "edited": false, "score": 0, "creation_date": 1451517625, "post_id": 34538694, "comment_id": 56819796, "body": "Figured it out. Thanks alot!"}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1451607982, "post_id": 34538694, "comment_id": 56847985, "body": "Your build process and/or IDE should help you find these mistakes. Try the /Wall switch for your compiler (if it has it, or something similar, to amp up the warnings). Also, try a <a href=\"https://en.wikipedia.org/wiki/Lint_(software)\" rel=\"nofollow noreferrer\">lint</a> program like <a href=\"http://www.splint.org/\" rel=\"nofollow noreferrer\">SPLint</a>, which does say &quot;Value freqcounts[] used before definition&quot; to <code>freqcounts[ch]++;</code>. It could be a bit much to learn right away. If so, come back to it."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1451563337, "creation_date": 1451563337, "answer_id": 34546261, "question_id": 34538694, "link": "https://stackoverflow.com/questions/34538694/getting-weird-characters-using-getc/34546261#34546261", "title": "Getting weird characters using getc?", "body": "<p>the main problem is the array: freqcounts[] is not initialized to all 0s.  </p>\n\n<p>Suggest declaring it as follows:</p>\n\n<pre><code>int freqcounts[R] = {0};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5648482, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joseph Doob", "link": "https://stackoverflow.com/users/5648482/joseph-doob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1451563337, "creation_date": 1451517062, "question_id": 34538694, "link": "https://stackoverflow.com/questions/34538694/getting-weird-characters-using-getc", "title": "Getting weird characters using getc?", "body": "<p>So I'm starting to implement a Huffman tree, and to do that, I'm trying to get character values from stdin or a input file. The input file (just a string \"cheese\") is being added to the array freqcounts, where the index of freqcounts that is being added to is the ascii conversion of the character it reads. Now, it does that for the string (e is added to index 101, etc.) But then there are all these random characters (towards the end of the array, I think they might be null characters?) Being added, with numbers in the tens of thousands. Can anyone explain to me what's going on?</p>\n\n<pre><code>    int main(int argc, const char * argv[]) {\n    int ch; //character to be used for getch\n    int freqcounts[R];\n    while(1){\n        /*Something weird going on in here*/\n        /*I'm getting the proper characters (supposed to be cheese) but then there are all these random nullesque characters\n         with absurd counts that is fucking up my linked list*/\n        ch=getc(stdin);\n        if (ch == EOF){ //eof\n            freqcounts[0]=1;\n            break;\n        }\n        else{\n            freqcounts[ch]++;\n        }\n    }\n    for (int i=0; i&lt; R; i++){\n        printf(\"%d\", freqcounts[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "eclipse", "declaration", "indexer"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1451563760, "post_id": 34538597, "comment_id": 56834089, "body": "you might try only defining the value in one place, probably in a .c file, and have the header files <code>extern</code> that definition"}, {"owner": {"reputation": 737, "user_id": 1263343, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HYgqv.jpg?s=128&g=1", "display_name": "codenaugh", "link": "https://stackoverflow.com/users/1263343/codenaugh"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1451577415, "post_id": 34538597, "comment_id": 56839378, "body": "I&#39;d like a solution that does not require changing any code"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1451651031, "post_id": 34538597, "comment_id": 56854918, "body": "The &#39;complete me&#39; operation depends on the &#39;tags&#39; file and the tags file will have every tag defined in the project.   I do not know of any way to limit the &#39;complete me&#39; to only look at the current file + #included header files"}, {"owner": {"reputation": 15761, "user_id": 1504556, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fdeaf6c510d511137faafdf8c790c21a?s=128&d=identicon&r=PG", "display_name": "peterh", "link": "https://stackoverflow.com/users/1504556/peterh"}, "edited": false, "score": 0, "creation_date": 1452502410, "post_id": 34538597, "comment_id": 57180473, "body": "As a side comment: I believe you are setting yourself up for trouble by trying to attempt to use Eclipse for this particular use case (you would want to build and deploy on Solaris but actually never leave your Windows-based IDE, right ?). I&#39;m pretty certain that NetBeans (with its <a href=\"https://netbeans.org/kb/docs/cnd/remotedev-tutorial.html\" rel=\"nofollow noreferrer\">Remote C/C++ development feature</a>) will be a much better fit for you."}, {"owner": {"reputation": 737, "user_id": 1263343, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HYgqv.jpg?s=128&g=1", "display_name": "codenaugh", "link": "https://stackoverflow.com/users/1263343/codenaugh"}, "edited": false, "score": 0, "creation_date": 1452505474, "post_id": 34538597, "comment_id": 57182350, "body": "I&#39;ll look into that Pete, thanks"}], "owner": {"reputation": 737, "user_id": 1263343, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HYgqv.jpg?s=128&g=1", "display_name": "codenaugh", "link": "https://stackoverflow.com/users/1263343/codenaugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1451516559, "creation_date": 1451516559, "question_id": 34538597, "link": "https://stackoverflow.com/questions/34538597/forcing-eclipse-indexer-to-always-use-specific-header-file-when-opening-declarat", "title": "Forcing eclipse indexer to always use specific header file when opening declaration", "body": "<p>I've got a very huge C project that is meant to be built on Solaris. I use a Windows PC for most of my work, ssh'ing into a solaris box when I need to make edits and build the code. </p>\n\n<p>I've recently imported the project into Eclipse (Luna) on my Windows machine from GitHub for ease of traversing the code. One problem I'm having is that the indexer cannot seem to determine which header file a particular declaration is coming from... I mean it's not able to tell that an enum in alarm.c can be found in alarm.h (as alarm.h is included in alarm.c), because that same enum (ERROR, for example) can be found in a couple other header files in another part of the project. See the image for what happens when I press F3 on one of the enums with multiple declarations in the project:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DZKtA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DZKtA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way to force the indexer to always use alarm.h when it has anything to do with alarm.c source code? Can I have it ignore the rest of the project? It would really aide in getting rid of the thousands of \"errors\" in the project which are specifically related to \"multiple declarations found\" by the indexer.</p>\n"}, {"tags": ["c", "function", "scope"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 4, "creation_date": 1451516176, "post_id": 34538460, "comment_id": 56819303, "body": "That&#39;s precisely what static functions are for."}], "answers": [{"tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": false, "score": 0, "last_activity_date": 1451516675, "last_edit_date": 1451516675, "creation_date": 1451515943, "answer_id": 34538481, "question_id": 34538460, "link": "https://stackoverflow.com/questions/34538460/scope-of-function-access-in-c/34538481#34538481", "title": "Scope of Function access in C", "body": "<p>Make such internal function <code>static</code> and keep it just in <code>.c</code> file.</p>\n\n<p>See <a href=\"https://en.wikibooks.org/wiki/C_Programming/Procedures_and_functions#Static_functions\" rel=\"nofollow\">static functions</a>:</p>\n\n<blockquote>\n  <p>If a function is to be called only from within the file in which it is declared, it is appropriate to declare it as a static function. When a function is declared static, the compiler will now compile to an object file in a way that prevents the function from being called from code in other files.</p>\n</blockquote>\n\n<p>Or in the C standard:</p>\n\n<blockquote>\n  <p><strong>6.2.2 Linkages of identifiers</strong><br>...<br>\n  If the declaration of a file scope identifier for an object or a function contains the storage-class\n  specifier <code>static</code>, the identifier has internal linkage.<sup>1</sup></p>\n  \n  <hr>\n  \n  <p><sup>1</sup> A function declaration can contain the storage-class specifier static only if it is at file scope ....</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2963, "user_id": 1855442, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61b99c64abe73180373944232b0c734f?s=128&d=identicon&r=PG", "display_name": "Pradheep", "link": "https://stackoverflow.com/users/1855442/pradheep"}, "is_accepted": false, "score": 0, "last_activity_date": 1451515982, "creation_date": 1451515982, "answer_id": 34538488, "question_id": 34538460, "link": "https://stackoverflow.com/questions/34538460/scope-of-function-access-in-c/34538488#34538488", "title": "Scope of Function access in C", "body": "<p>Yes its ok to make some of the functions not available in the header file.</p>\n\n<p>The other options are to separate the header files into 2. One for internal use and other for external user.</p>\n\n<p>Apart from that also you can declare the functions static making them not visible outside the file scope</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451529042, "post_id": 34538561, "comment_id": 56822565, "body": "A function (or any name in general) only need to be declared seperately from its definition if it is used before the latter. Normal practise is to define them before usage. This avoids redundancy (this cannot be avoided for names with external linkage)."}], "tags": [], "owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "is_accepted": true, "score": 0, "last_activity_date": 1451516372, "last_edit_date": 1592644375, "creation_date": 1451516372, "answer_id": 34538561, "question_id": 34538460, "link": "https://stackoverflow.com/questions/34538460/scope-of-function-access-in-c/34538561#34538561", "title": "Scope of Function access in C", "body": "<p>That's pretty much what you would do in this case and add static to the declared functions. You would declare your public functions in the .h file and the private functions in the .c file.</p>\n<p>Let's say you had a .h and .c file as such:</p>\n<h3>SomeFile.h</h3>\n<pre><code>void doSomething1(void);\nvoid doSomething2(void);\n</code></pre>\n<h3>SomeFile.c</h3>\n<pre><code>static void doSomething3(void);\nstatic void doSomething4(void);\n//These functions can be called by anyone\nvoid doSomething1(void)\n{\n    //function guts here\n}\nvoid doSomething2(void)\n{\n    //function guts here\n}\n//These functions can only be called inside this file\nstatic void doSomething3(void)\n{\n    //function guts here\n}\nstatic void doSomething4(void)\n{\n    //function guts here\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 0, "last_activity_date": 1451516654, "creation_date": 1451516654, "answer_id": 34538614, "question_id": 34538460, "link": "https://stackoverflow.com/questions/34538460/scope-of-function-access-in-c/34538614#34538614", "title": "Scope of Function access in C", "body": "<p>Declare these functions directly in the <code>.c</code> file as static functions and provide the definitions of the functions in the same file:</p>\n\n<p>\u00ccn the .c file:</p>\n\n<pre><code>static void internal_func1(void);\nstatic int interal_func2(int a);\n\nstatic void internal_func1(void)\n{\n   /* body of internal_func1 */\n}\n\nstatic int interal_func2(int a)\n{\n   /* body of internal_func2 */\n}\n</code></pre>\n\n<p>Adding the <code>static</code> keyword makes these functions invisible to other source files (the function identifier will have <em>internal linkage</em>).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5562628"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 34538561, "answer_count": 4, "score": 0, "last_activity_date": 1451516675, "creation_date": 1451515804, "question_id": 34538460, "link": "https://stackoverflow.com/questions/34538460/scope-of-function-access-in-c", "title": "Scope of Function access in C", "body": "<p>Suppose I have a function that I want to use internally such as <code>private</code> in Java or C++, but I am writing in C. In this case, I have a header file and a <code>c</code> file implementation and the <code>c</code> file has several functions that should not be available to the end user. Is it ok for me to not declare these functions in the header file in order to prevent access to them or is this bad practice / is there a better way? </p>\n"}, {"tags": ["c", "ubuntu", "makefile"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451514985, "post_id": 34538285, "comment_id": 56818906, "body": "Do you have <code>curses</code> library installed? Does the program contain <code>configure</code> script?"}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451515063, "post_id": 34538285, "comment_id": 56818931, "body": "@EugeneSh. I used ./configure in order to obtain the makefile. How can I install the curses library?"}, {"owner": {"reputation": 321, "user_id": 2063220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1kwkW.png?s=128&g=1", "display_name": "Sergey Salnikov", "link": "https://stackoverflow.com/users/2063220/sergey-salnikov"}, "edited": false, "score": 0, "creation_date": 1451515081, "post_id": 34538285, "comment_id": 56818937, "body": "<code>sudo apt-get install libncurses5-dev</code>. And read the documentation (if any) for your program for other dependencies."}, {"owner": {"reputation": 341, "user_id": 1566443, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e0a40af043dd0cd852faa502fde0cc8e?s=128&d=identicon&r=PG", "display_name": "Mehran Meidani", "link": "https://stackoverflow.com/users/1566443/mehran-meidani"}, "edited": false, "score": 1, "creation_date": 1451515091, "post_id": 34538285, "comment_id": 56818943, "body": "You should link some libraries. Compile with these parameters <code>-ltermcap -lncurses</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451515096, "post_id": 34538285, "comment_id": 56818947, "body": "Well, if it passed <code>configure</code>, the required libs should be ok.. Unless it warned you about it."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "reply_to_user": {"reputation": 321, "user_id": 2063220, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1kwkW.png?s=128&g=1", "display_name": "Sergey Salnikov", "link": "https://stackoverflow.com/users/2063220/sergey-salnikov"}, "edited": false, "score": 0, "creation_date": 1451515259, "post_id": 34538285, "comment_id": 56819002, "body": "@SergeySalnikov I run it but it tell me libncurses5-dev is already the newest version"}], "answers": [{"comments": [{"owner": {"reputation": 1138, "user_id": 2685239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b377571ae1b0f324171100cfab8c7df?s=128&d=identicon&r=PG&f=1", "display_name": "mariusm", "link": "https://stackoverflow.com/users/2685239/mariusm"}, "edited": false, "score": 1, "creation_date": 1524224215, "post_id": 34540841, "comment_id": 86897201, "body": "I had to add <code>-ltermcap</code> in addition to <code>-lncurses</code> to solve tputs reference."}], "tags": [], "owner": {"reputation": 2805, "user_id": 4568212, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EFy85.jpg?s=128&g=1", "display_name": "Punit Vara", "link": "https://stackoverflow.com/users/4568212/punit-vara"}, "is_accepted": true, "score": 1, "last_activity_date": 1524549639, "last_edit_date": 1524549639, "creation_date": 1451534785, "answer_id": 34540841, "question_id": 34538285, "link": "https://stackoverflow.com/questions/34538285/issue-with-makefile-on-ubuntu/34540841#34540841", "title": "Issue with makefile on Ubuntu", "body": "<p>You have used <code>tputs</code> in c program so you must have use <code>#include &lt;curses.h&gt;</code> and <code>#include &lt;term.h&gt;</code>. Undefined reference is <em>linker error</em>. In Makefile while compiling c program you should link <code>-lcurses</code> or <code>-lncurses</code>. Add similar line to your Makefile. compile with appropriate linking library.</p>\n\n<p>For example </p>\n\n<pre><code>gcc file.c -o output_file -lcurses -ltermcap\n</code></pre>\n\n<p>or</p>\n\n<pre><code>gcc file.c -o output_file -lcurses -ltermcap\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 34540841, "answer_count": 1, "score": -1, "last_activity_date": 1524549639, "creation_date": 1451514763, "last_edit_date": 1451515937, "question_id": 34538285, "link": "https://stackoverflow.com/questions/34538285/issue-with-makefile-on-ubuntu", "title": "Issue with makefile on Ubuntu", "body": "<p>I am trying to install a program that consist of a folder with some C files. I run the makefile but i get the following error:</p>\n\n<pre><code>/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1128: undefined reference to `tgoto'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1129: undefined reference to `tputs'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1138: undefined reference to `tputs'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1145: undefined reference to `tputs'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1154: undefined reference to `tputs'\nreadline/libreadline.a(display.o): In function `delete_chars':\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1182: undefined reference to `tgoto'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1183: undefined reference to `tputs'\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/display.c:1189: undefined reference to `tputs'\nreadline/libreadline.a(signals.o): In function `cr':\n/home/silviu/Desktop/tipsy-2.2.3d/code/readline/signals.c:301: undefined reference to `tputs'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Do you know how can I solve it? (on Ubuntu)</p>\n"}, {"tags": ["c", "arrays", "for-loop"], "comments": [{"owner": {"reputation": 341, "user_id": 1566443, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e0a40af043dd0cd852faa502fde0cc8e?s=128&d=identicon&r=PG", "display_name": "Mehran Meidani", "link": "https://stackoverflow.com/users/1566443/mehran-meidani"}, "edited": false, "score": 2, "creation_date": 1451514928, "post_id": 34538266, "comment_id": 56818883, "body": "Could you please post the prototype of text2? Also you&#39;ll get runtime error because of the <code>text(abc, characters[abc]);</code>."}, {"owner": {"reputation": 575, "user_id": 5057200, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/998722690147651/picture?type=large", "display_name": "Sparkm4n", "link": "https://stackoverflow.com/users/5057200/sparkm4n"}, "reply_to_user": {"reputation": 341, "user_id": 1566443, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e0a40af043dd0cd852faa502fde0cc8e?s=128&d=identicon&r=PG", "display_name": "Mehran Meidani", "link": "https://stackoverflow.com/users/1566443/mehran-meidani"}, "edited": false, "score": 0, "creation_date": 1451515498, "post_id": 34538266, "comment_id": 56819075, "body": "yes , it&#39;s a header file by the way, the code is: void color2(int i, int j, int f); and void text2(int i, int j, char* f);"}, {"owner": {"reputation": 341, "user_id": 1566443, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e0a40af043dd0cd852faa502fde0cc8e?s=128&d=identicon&r=PG", "display_name": "Mehran Meidani", "link": "https://stackoverflow.com/users/1566443/mehran-meidani"}, "edited": false, "score": 0, "creation_date": 1451515669, "post_id": 34538266, "comment_id": 56819137, "body": "<code>numbers[horizontal]</code> is char, but you are trying to pass it as char*. change your text2&#39;s last parameter to char f."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451516433, "post_id": 34538266, "comment_id": 56819386, "body": "You don&#39;t need to put <code>\\0</code> at the end of a string literal, it&#39;s done automatically."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451516549, "post_id": 34538266, "comment_id": 56819425, "body": "I suspect <code>text2</code> expects the third argument to be a string, not a single character."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451516636, "post_id": 34538266, "comment_id": 56819453, "body": "@Sparkm4n There&#39;s probably another function in the API that you can use to display a single character at a position, instead of a string of text. Look for a function name like <code>char2</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451516690, "post_id": 34538266, "comment_id": 56819470, "body": "Can you post a link to the documentation of this API?"}, {"owner": {"reputation": 6091, "user_id": 933198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25a22103fd3210fdfa142843c7777ff1?s=128&d=identicon&r=PG", "display_name": "Lee Taylor", "link": "https://stackoverflow.com/users/933198/lee-taylor"}, "edited": false, "score": 0, "creation_date": 1451524610, "post_id": 34538266, "comment_id": 56821666, "body": "It&#39;s a shame that the compiler you&#39;re using doesn&#39;t tell you the line number with the problem, or even the function where the issue lies..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451538870, "post_id": 34538266, "comment_id": 56824753, "body": "There appear to be 2 possible sources for the error: <code>text2(horizontal, vertical, numbers[horizontal]);</code> and <code>text(abc, characters[abc]);</code>. Unless you can provide the prototypes or definitions for both functions, all anyone can do it guess at what the problem is. That said, I suspect that @Barmar is correct in the assessment that the function throwing the error is expecting a string and not a character. Please see: <a href=\"http://stackoverflow.com/help/mcve\"><b>How to create a Minimal, Complete, and Verifiable example</b></a>.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 533, "user_id": 5175308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca56770cccafc148ec217c8c2ec65253?s=128&d=identicon&r=PG&f=1", "display_name": "Parttimereaper", "link": "https://stackoverflow.com/users/5175308/parttimereaper"}, "is_accepted": true, "score": 2, "last_activity_date": 1452271674, "last_edit_date": 1452271674, "creation_date": 1451514905, "answer_id": 34538304, "question_id": 34538266, "link": "https://stackoverflow.com/questions/34538266/pass-a-value-from-char-array-to-bos-function-in-c/34538304#34538304", "title": "pass a value from char array to BoS function in c", "body": "<p>You need to dereference your pointer. Presumably in one of the functions you are calling, probably in text2() or text(). Can't tell you more without knowing more about the specifications of the functions.</p>\n"}], "owner": {"reputation": 575, "user_id": 5057200, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/998722690147651/picture?type=large", "display_name": "Sparkm4n", "link": "https://stackoverflow.com/users/5057200/sparkm4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1451949435, "accepted_answer_id": 34538304, "answer_count": 1, "score": 0, "last_activity_date": 1462656993, "creation_date": 1451514644, "last_edit_date": 1462656993, "question_id": 34538266, "link": "https://stackoverflow.com/questions/34538266/pass-a-value-from-char-array-to-bos-function-in-c", "closed_reason": "Not suitable for this site", "title": "pass a value from char array to BoS function in c", "body": "<p>I'm still struggling with my program that should print out characters in board of symbols.<br/>\nThe compiler says:</p>\n\n<blockquote>\n  <p>char parameter is not compatible with type char*</p>\n</blockquote>\n\n<p><br/>Here is my code:</p>\n\n<pre><code>char characters[12] = {\"ABCDEFGHIJ\\0\"};\nchar numbers[12] = {\"0123456789\\0\"};\n\nfor (int vertical = 2; vertical&lt;12; vertical++) {\n    for (int horizontal = 1; horizontal&lt;2; horizontal++) {\n        text2(horizontal, vertical, numbers[horizontal]);\n        color2(horizontal, vertical, BLUE);         \n    }       \n}\n\nfor (int abc = 170; abc &lt; 180; abc++) {\n    color(abc, BLUE);\n    text(abc, characters[abc]);\n}\n</code></pre>\n\n<p>It should actually print out only one character per pass.\nhere are both functions </p>\n\n<pre><code>void color2(int i, int j, int f) {\n    sprintf_s(nachricht, \"&gt;&gt;# %d %d 0x%x\\n\", i, j, f);\n    sendMessage( nachricht );\nvoid text2(int i, int j, char* f) {\n    sprintf_s(nachricht, \"&gt;&gt;#T %d %d %s\\n\", i, j, f);\n    sendMessage( nachricht );\n}\n</code></pre>\n\n<p>color2 colors the fields and text2 shows charachters on fields\nand here is the code of function sendMessage which is included in both mentioned functions</p>\n\n<pre><code>int sendMessage(char *sendbuf ) {\n    WSADATA wsaData;\n    SOCKET ConnectSocket = INVALID_SOCKET;\n    struct addrinfo *result = NULL,\n        *ptr = NULL,\n        hints;\n    int iResult;\n    int recvbuflen = DEFAULT_BUFLEN;\n    char recvbuf[DEFAULT_BUFLEN];\n\n    // Initialize Winsock\n    iResult = WSAStartup(MAKEWORD(2,2), &amp;wsaData);\n    if (iResult != 0) {\n        printf(\"WSAStartup failed with error: %d\\n\", iResult);\n        return 1;\n    }\n\n    ZeroMemory( &amp;hints, sizeof(hints) );\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_STREAM;\n    hints.ai_protocol = IPPROTO_TCP;\n\n    // Resolve the server address and port\n    iResult = getaddrinfo(\"localhost\", DEFAULT_PORT, &amp;hints, &amp;result);\n    if ( iResult != 0 ) {\n        printf(\"getaddrinfo failed with error: %d\\n\", iResult);\n        WSACleanup();\n        return 1;\n    }\n\n    // Attempt to connect to an address until one succeeds\n    for(ptr=result; ptr != NULL ;ptr=ptr-&gt;ai_next) {\n\n        // Create a SOCKET for connecting to server\n        ConnectSocket = socket(ptr-&gt;ai_family, ptr-&gt;ai_socktype, \n            ptr-&gt;ai_protocol);\n        if (ConnectSocket == INVALID_SOCKET) {\n            printf(\"socket failed with error: %ld\\n\", WSAGetLastError());\n            WSACleanup();\n            return 1;\n        }\n\n        // Connect to server.\n        iResult = connect( ConnectSocket, ptr-&gt;ai_addr, (int)ptr-&gt;ai_addrlen);\n        if (iResult == SOCKET_ERROR) {\n            closesocket(ConnectSocket);\n            ConnectSocket = INVALID_SOCKET;\n            continue;\n        }\n        if( verbose ) printf(\"socket connected\\n\");\n        break;\n    }\n\n    freeaddrinfo(result);\n\n    if (ConnectSocket == INVALID_SOCKET) {\n        terminate(\"Unable to connect to server!\\n\");\n    }\n\n    // Send an initial buffer\n    iResult = send( ConnectSocket, sendbuf, (int)strlen(sendbuf), 0 );\n    if (iResult == SOCKET_ERROR) {\n        printf(\"send failed with error: %d\\n\", WSAGetLastError());\n        closesocket(ConnectSocket);\n        WSACleanup();\n        return 1;\n    }\n\n    if( verbose ) printf(\"Bytes Sent: %ld\\n\", iResult);\n\n    // shutdown the connection since no more data will be sent\n    iResult = shutdown(ConnectSocket, SD_SEND);\n    if (iResult == SOCKET_ERROR) {\n        printf(\"shutdown failed with error: %d\\n\", WSAGetLastError());\n        closesocket(ConnectSocket);\n        WSACleanup();\n        return 1;\n    }\n\n    answer[0] = '\\0';\n    // Receive until the peer closes the connection\n    do {\n\n\n        iResult = recv(ConnectSocket, recvbuf, recvbuflen, 0);\n        if ( iResult &gt; 0 ) {\n            recvbuf[iResult] = '\\0';\n            if( verbose ) printf(\"Bytes received: %d %s\\n\", iResult, recvbuf);\n            strcat_s( answer, recvbuf );\n            //printf(\"&gt;&gt;&gt;%s&lt;&lt;&lt;\\n\", answer );\n        } else if ( iResult == 0 ) {\n            if( verbose ) printf(\"Connection closed\\n\");\n        } else\n            printf(\"recv failed with error: %d\\n\", WSAGetLastError());\n\n    } while( iResult &gt; 0 );\n\n    // cleanup\n    closesocket(ConnectSocket);\n    WSACleanup();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller", "pic", "microchip"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451512036, "post_id": 34537735, "comment_id": 56817577, "body": "<code>char pins[4]</code> should be <code>char pins[5]</code>..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451512066, "post_id": 34537735, "comment_id": 56817592, "body": "also, <code>000000</code> is not a 6-bit value...."}, {"owner": {"reputation": 151, "user_id": 2708495, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/45e3ac6960dfb649df5a951a5b17a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "coolestDisplayName", "link": "https://stackoverflow.com/users/2708495/coolestdisplayname"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451512391, "post_id": 34537735, "comment_id": 56817747, "body": "Ah, thanks for that! Aside from that, is that an okay strategy for what I&#39;m trying to do?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451512834, "post_id": 34537735, "comment_id": 56817951, "body": "I am pretty sure you can write the port as a byte/word rather than individual bits..Like <code>LATB=0x5A</code>"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1451513081, "post_id": 34537735, "comment_id": 56818062, "body": "Your approach is ok in general. But the shown code will not quite work for a number of reasons.1. Those are not binary literals that you have shown in the <code>pins</code> array definition. The C standard does not define binary literals at all. gcc does have an extension for that (but not sure if that is your compiler). 2. You cannot access bits in a <code>char</code> with array notation. You need to use masking (<code>&amp;</code>) and optionally shifting (<code>&lt;&lt;</code> and <code>&gt;&gt;</code>)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1451513186, "post_id": 34537735, "comment_id": 56818103, "body": "@kaylum There is a bit-field option as well..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1451513426, "post_id": 34537735, "comment_id": 56818213, "body": "@EugeneSh.Yes, agreed. Good point."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1451515025, "post_id": 34537735, "comment_id": 56818915, "body": "Are you trying to create an array where each element has the same value as its index?  (That&#39;s not what you actually did but it seems like that was your intention.)  If that&#39;s true then wouldn&#39;t it be simpler to just use the index value directly, rather than as an index into an array?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1451515312, "post_id": 34537735, "comment_id": 56819014, "body": "Should the &quot;Set 3&quot; command set bits 4 and 5, as you have shown?  Or should it really set bits 0 and 1, as I would expect.  In other words, is LATB0 the least significant bit or is LATB5 the least significant bit?  Or, are you trying to reverse the order of the bits for some reason?"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1451515947, "post_id": 34537735, "comment_id": 56819225, "body": "I suspect your pseudo code could be as simple as: <code>if command=&quot;Set 3&quot; then LATBbits = 3;</code>.  Why do you think it needs to be more complicated than that?"}, {"owner": {"reputation": 151, "user_id": 2708495, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/45e3ac6960dfb649df5a951a5b17a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "coolestDisplayName", "link": "https://stackoverflow.com/users/2708495/coolestdisplayname"}, "reply_to_user": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1451532189, "post_id": 34537735, "comment_id": 56823188, "body": "@kkrambo Interesting. Thanks for this tip! I think I am overcomplicating it. So, I could do something like <code>if command=&quot;Set 3&quot; then LATBbits = pins[3];</code> ? Does pins[3] need to be something like 0b000011 rather than just 000011? Thanks guys! Still learning but this is certainly fun stuff!"}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1451534978, "post_id": 34537735, "comment_id": 56823753, "body": "Why do you need the array?  Just set LATBbits = 3."}, {"owner": {"reputation": 24405, "user_id": 99354, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b6ee96d3a17fcbd2bd24210eb7caf441?s=128&d=identicon&r=PG&f=1", "display_name": "Marco van de Voort", "link": "https://stackoverflow.com/users/99354/marco-van-de-voort"}, "edited": false, "score": 0, "creation_date": 1451669201, "post_id": 34537735, "comment_id": 56859814, "body": "I solved such an issue for the 16-bit range (pic24/dspic33) series once. Maybe it helps: <a href=\"http://www.microchip.com/forums/m794597.aspx\" rel=\"nofollow noreferrer\">microchip.com/forums/m794597.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "reply_to_user": {"reputation": 6505, "user_id": 3059097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b82e3e2f10c9983fb609e74224d078?s=128&d=identicon&r=PG", "display_name": "casey", "link": "https://stackoverflow.com/users/3059097/casey"}, "edited": false, "score": 0, "creation_date": 1451588672, "post_id": 34548980, "comment_id": 56843567, "body": "Thanks @casey.  I&#39;ve updated my answer.  I&#39;ve probably never used octal literals and had forgotten that the leading zeroes are interpreted that way."}, {"owner": {"reputation": 24405, "user_id": 99354, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b6ee96d3a17fcbd2bd24210eb7caf441?s=128&d=identicon&r=PG&f=1", "display_name": "Marco van de Voort", "link": "https://stackoverflow.com/users/99354/marco-van-de-voort"}, "edited": false, "score": 0, "creation_date": 1451669297, "post_id": 34548980, "comment_id": 56859841, "body": "This requires that you always program all bits of the LAT at once, and their old state is never important. One needs a form of atomic XOR for the better solution. That exists for the pic24/33f range, but I don&#39;t know if it exists for 8-bit too."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1451703496, "post_id": 34548980, "comment_id": 56868008, "body": "bitfields are evil and should never be used. there is no guarantee of ordering or alignment, it is implementation defined, not assumed to port from one compiler to another nor from one version of the same compiler to another. for the same reason you should never use structs across compile domains.  using an approach like this carries the baggage of maybe having to re-write it from time to time. So you are gambling with an approach like this, maybe it works long enough or maybe you have to keep re-doing it. Understand this and what your other choices are.  When it goes bad it goes really bad"}, {"owner": {"reputation": 258, "user_id": 1582568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674c7c60f49b427d1b8f8d5c175221e4?s=128&d=identicon&r=PG", "display_name": "user1582568", "link": "https://stackoverflow.com/users/1582568/user1582568"}, "edited": false, "score": 0, "creation_date": 1451778793, "post_id": 34548980, "comment_id": 56888757, "body": "Bitfields are the only good way to set individual port pins on the 8 bit devices. Also be aware that some 8 bit devices have only the port register, which can lead to problems when writing one bit and getting spurious changes on other bits (due to the read modify write sequence). This is not a problem on your micro though as long as you always read the port and write to the latch register."}], "tags": [], "owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "is_accepted": false, "score": 3, "last_activity_date": 1451588428, "last_edit_date": 1451588428, "creation_date": 1451578990, "answer_id": 34548980, "question_id": 34537735, "link": "https://stackoverflow.com/questions/34537735/using-an-array-to-store-pin-bits/34548980#34548980", "title": "Using an array to store pin bits", "body": "<p>You are on the wrong track for many reasons.</p>\n\n<p><strong>Wrong track #1</strong>:  In your array definition, the C compiler will not interpret values like <code>000011</code> as binary.  It will interpret that as octal because of the leading zeroes.  So <code>000011</code> is octal which is decimal 9.  So your array contains the values zero, one, eight, nine, and sixty-four.</p>\n\n<p>You might be able to write the value like <code>0b000011</code> to tell the compiler that the value is binary.  But that is not standard C and many C compilers do not support that.  You'll have to check whether your compiler supports that convention.</p>\n\n<p><strong>Wrong track #2</strong>:  Your intention was to create an array containing the values 0, 1, 2, 3, 4.  Notice that the value of each member of the array is equal to the index of that member.  This array is pointless.  Just use the index value directly rather than as an index into an array which simply returns the original index value.</p>\n\n<p><strong>Wrong track #3</strong>:  When you set <code>LATBbits.LATB0 = pins[3][0];</code> you are trying to reference a one-dimensional array as if it were a two-dimensional array.  You can't do that.  You cannot use an extra array dimension specifier on a value to pull out a bit from that value.  The C language doesn't work that way.</p>\n\n<p><strong>Wrong track #4</strong>:  Just because LATBbits has bitfields defined, it doesn't mean that you cannot set LATBbits directly.  In other words, you don't have to set the bits individually.  You can set all the bits at once simply by setting LATBbits directly.</p>\n\n<p><strong>Wrong track #5</strong>: You wrote that LATB4 and LATB5 will be set to 1.  But those are not the least significant bits of LATBbits.  LATB0 and LATB1 are the least significant bits and those are the ones that will be set when you set LATBBits = 0b000011.</p>\n\n<p><strong>The right track</strong>:  Take a look at the definition of LATBbits.  I found this online, make sure it matches the definition in your header file.</p>\n\n<pre><code>//==============================================================================\n//        LATB Bits\n\nextern __at(0x0F8A) __sfr LATB;\n\ntypedef struct\n  {\n  unsigned LATB0                : 1;\n  unsigned LATB1                : 1;\n  unsigned LATB2                : 1;\n  unsigned LATB3                : 1;\n  unsigned LATB4                : 1;\n  unsigned LATB5                : 1;\n  unsigned LATB6                : 1;\n  unsigned LATB7                : 1;\n  } __LATBbits_t;\n\nextern __at(0x0F8A) volatile __LATBbits_t LATBbits;\n\n#define _LATB0                  0x01\n#define _LATB1                  0x02\n#define _LATB2                  0x04\n#define _LATB3                  0x08\n#define _LATB4                  0x10\n#define _LATB5                  0x20\n#define _LATB6                  0x40\n#define _LATB7                  0x80\n</code></pre>\n\n<p>I'm pretty sure that your entire example pseudo code can be reduced to this.</p>\n\n<pre><code>if command=\"Set 3\" then {\n    LATB = 3;\n}\n</code></pre>\n\n<p>There is no need for the array and there is no need to set the bits individually.  You could set either <code>LATB</code> or <code>LATBbits</code> (They're two different names for the same memory mapped register).  Setting LATB (or LATBbits) = 3 will result in LATB0 and LATB1 being set and the other bits being cleared.</p>\n\n<p>If the LATB value did not match the command value then it might be useful to use an array to lookup the LATB value.  For example, suppose you really do want LATB4 and LATB5 set when command is 3.  In that case, you should use the _LATBx definitions to define the array like this:</p>\n\n<pre><code>char pins[] = {\n    0,                  // All bits clear\n    (_LATB0),           // Bit 0 set\n    (_LATB1),           // Bit 1 set\n    (_LATB4 | _LATB5),  // Bit 4 and Bit 5 set\n    (_LATB2)            // Bit 2 set\n}\n</code></pre>\n\n<p>Then you could set LATB from the array like this.</p>\n\n<pre><code>LATB = pins[3];\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 2708495, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/45e3ac6960dfb649df5a951a5b17a3dc?s=128&d=identicon&r=PG&f=1", "display_name": "coolestDisplayName", "link": "https://stackoverflow.com/users/2708495/coolestdisplayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1194, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1451842333, "creation_date": 1451511989, "question_id": 34537735, "link": "https://stackoverflow.com/questions/34537735/using-an-array-to-store-pin-bits", "title": "Using an array to store pin bits", "body": "<p>Just trying to make sure I'm on the correct track here. I'm trying to store lots of 6-bit bytes into an array to control a parallel device with my PIC18F2550.</p>\n\n<p>My array:</p>\n\n<pre><code>char pins[4] = {\n        000000, //0\n        000001, //1\n        000010, //2\n        000011, //3\n        000100 //4\n}\n</code></pre>\n\n<p>Later in my code, I want to be able to enter a command such as \n\"Set 3\" which will set pins RB0-RB5 to 000011 respectively.</p>\n\n<p>PSEUDO CODE:</p>\n\n<pre><code>if command=\"Set 3\" then find pins[3]{\nLATBbits.LATB0 = pins[3][0];\nLATBbits.LATB1 = pins[3][1];\nLATBbits.LATB2 = pins[3][2];\nLATBbits.LATB3 = pins[3][3];\nLATBbits.LATB4 = pins[3][4];\nLATBbits.LATB5 = pins[3][5];\n}\n</code></pre>\n\n<p>which will give:</p>\n\n<pre><code>{\n LATBbits.LATB0 = 0;\n LATBbits.LATB1 = 0;\n LATBbits.LATB2 = 0;\n LATBbits.LATB3 = 0;\n LATBbits.LATB4 = 1;\n LATBbits.LATB5 = 1;\n}\n</code></pre>\n\n<p>Is this an appropriate way to create this? Am I on the right track? Do you have suggestions on a better way to create an efficient array to control a 6bit parallel device with many settings?</p>\n\n<p>Thanks everyone!</p>\n"}, {"tags": ["c", "linux", "gcc"], "comments": [{"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 10, "creation_date": 1451511388, "post_id": 34537589, "comment_id": 56817298, "body": "Get rid of the semicolon after main()."}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "reply_to_user": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451511571, "post_id": 34537589, "comment_id": 56817369, "body": "Thank you very much. I can already see this being a rough month or two while I get all the basics and fundamentals down."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1451511747, "post_id": 34537589, "comment_id": 56817445, "body": "Also get rid of the 1 in your declaration of <code>argv</code>.  You can use <code>char *argv[]</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451511447, "post_id": 34537618, "comment_id": 56817317, "body": "Why would OP need the braces?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1451511539, "post_id": 34537618, "comment_id": 56817355, "body": "@SergeyA - It is just good programming style and also removes the problem when somebody adds to the if statement and forgets to add the braces. Most coding styles I have worked with have made them mandatory"}, {"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1451511640, "post_id": 34537618, "comment_id": 56817401, "body": "So my &quot;if&quot; statement should read?       if {argc &gt; 1}"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451511691, "post_id": 34537618, "comment_id": 56817425, "body": "I find it a <b>bad</b> programming style. What is even more important, I find a bad habit to enforce your personal preferences."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451511796, "post_id": 34537618, "comment_id": 56817463, "body": "@SergeyA - ESA has this standard along with others. Coding standards help to prevent programming errors now and in the future. Also try to make the code consistent between developers."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 1, "creation_date": 1451511828, "post_id": 34537618, "comment_id": 56817472, "body": "@bluerojo <code>if (...) { ....} else {...}</code>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1451511840, "post_id": 34537618, "comment_id": 56817476, "body": "The <code>argv</code> declaration should be <code>char *argv[]</code>."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1451511900, "post_id": 34537618, "comment_id": 56817506, "body": "@TomKarzes - Thanks - I thought I removed it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451511953, "post_id": 34537618, "comment_id": 56817533, "body": "@EdHeal, &#39;don&#39;t sweat over small stuff&#39;. This is one of the perfect example of small stuff."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451512025, "post_id": 34537618, "comment_id": 56817570, "body": "@SergeyA - Coding standards lead to less error prone code."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451512112, "post_id": 34537618, "comment_id": 56817611, "body": "@EdHeal, there are standards which do this. There are also standards that simply express personal preference of their authors, with no justifiable benefit. The braces thing (as well as where to put them - same line or next line) is one of those."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451512172, "post_id": 34537618, "comment_id": 56817638, "body": "How can it be a standard if it is up to the whim of the author?"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1451512184, "post_id": 34537618, "comment_id": 56817645, "body": "@TomKarzes in an ideal world it&#39;d be <code>char * argv[static argc]</code>, but interestingly I don&#39;t know if that&#39;s technically legal for <code>main</code>..."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451512589, "post_id": 34537618, "comment_id": 56817843, "body": "@SergeyA - If you are interested here is the link <a href=\"http://www.esa.int/TEC/Software_engineering_and_standardisation/TECRFBUXBQE_0.html\" rel=\"nofollow noreferrer\">esa.int/TEC/Software_engineering_and_standardisation/&hellip;</a>"}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": true, "score": 3, "last_activity_date": 1451511871, "last_edit_date": 1451511871, "creation_date": 1451511410, "answer_id": 34537618, "question_id": 34537589, "link": "https://stackoverflow.com/questions/34537589/error-compiling-very-simple-c-program/34537618#34537618", "title": "Error compiling very simple C program", "body": "<p>The line</p>\n\n<pre><code>int main (int argc, char *argv[1]);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>int main (int argc, char *argv[])\n</code></pre>\n\n<p>(without the semi-colon).</p>\n\n<p>Also consider using braces in the <code>if</code> statement.</p>\n"}, {"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1451511853, "post_id": 34537671, "comment_id": 56817486, "body": "The <code>argv</code> declaration should be <code>char *argv[]</code>."}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1451511962, "post_id": 34537671, "comment_id": 56817539, "body": "My mistake...I apologize.  It&#39;s been 20 years since I wrote anything in C."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1451512390, "post_id": 34537671, "comment_id": 56817746, "body": "While <code>int main (int argc, char *argv[1])</code> can be misleading, it&#39;s not wrong and is perfectly valid. The type of <code>argv</code> is <code>char**</code>. So <code>int main (int argc, char *argv[1])</code>, <code>int main (int argc, char *argv[])</code>, <code>int main (int argc, char **argv)</code>, <code>int main (int argc, char *argv[79])</code>, etc are all equivalent."}], "tags": [], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "is_accepted": false, "score": 2, "last_activity_date": 1451511661, "creation_date": 1451511661, "answer_id": 34537671, "question_id": 34537589, "link": "https://stackoverflow.com/questions/34537589/error-compiling-very-simple-c-program/34537671#34537671", "title": "Error compiling very simple C program", "body": "<p>Been a very long time since I used C, but I beleive it should be this:  </p>\n\n<pre><code>/* hello.c*/\n#include &lt;stdio.h&gt;\nint main (int argc, char *argv[1])\n{\n  if (argc &gt; 1){\n    printf(\"greetings %s.\\n\", argv[1]);\n}\n  else{\n    printf(\"Please tell me your name.\\n\");\n}\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "edited": false, "score": 0, "creation_date": 1451512403, "post_id": 34537768, "comment_id": 56817752, "body": "Thank you for the description and background information."}], "tags": [], "owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "is_accepted": false, "score": 2, "last_activity_date": 1451513351, "last_edit_date": 1451513351, "creation_date": 1451512127, "answer_id": 34537768, "question_id": 34537589, "link": "https://stackoverflow.com/questions/34537589/error-compiling-very-simple-c-program/34537768#34537768", "title": "Error compiling very simple C program", "body": "<p>Basically in 'C' each statement, or declaration/definition is terminated with semicolon (unless it is some special one). On the global space (not in a function) you can only declare/define (declaration states that something with some type exists and name it while the definition also states it's content).</p>\n\n<p>The line </p>\n\n<pre><code>int main (int argc, char *argv[1]);\n</code></pre>\n\n<p>Simply declares a function and not define it (the code you've written on the next line is not counted but it's interpreted as the next declaration/definition - which is not).</p>\n\n<p>So in your case the semicolon must be after the function definition. Something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main (int argc, char *argv[1])\n{\n  if (argc &gt; 1)\n    printf(\"greetings %s.\\n\", argv[1]);\n  else\n    printf(\"Please tell me your name.\\n\");\n  return 0;\n};\n</code></pre>\n\n<p>Although if you look at the standard you'll see that the last semicolon is not needed. This is because 'C' have a special tolerance toward function types. As you see the function 'main' is not defined by using equal sign ('=') (as most other types) but instead directly using code in brackets ('{' [code] '}').</p>\n\n<p>Another thing important to know is that all array/function types are treated differently in functions. In case of a parameter with such type, it's silently 'adjusted' to \"pointer to\"/\"pointer to function returning\". And in case of return value - compiler error (such thing is not allowed). Which means your 'main' function type will actually be:</p>\n\n<pre><code>int (int, char **)\n</code></pre>\n\n<p>And I suggest you don't fool your code readers and actually write the function type as it's actually is.</p>\n\n<p>I don't claim my description is 1:1 with the standard or anything - I just explain the things as I see them.</p>\n\n<p><em>For some reason even putting the last semicolon is not a problem. I guess that is possible because in 'C' you can also have those empty statements (where like you only have the terminating semicolon).</em></p>\n"}], "owner": {"reputation": 644, "user_id": 5637073, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uJwNl.png?s=128&g=1", "display_name": "IT_User", "link": "https://stackoverflow.com/users/5637073/it-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "closed_date": 1451514256, "accepted_answer_id": 34537618, "answer_count": 3, "score": 2, "last_activity_date": 1451513351, "creation_date": 1451511287, "last_edit_date": 1451513229, "question_id": 34537589, "link": "https://stackoverflow.com/questions/34537589/error-compiling-very-simple-c-program", "closed_reason": "Not suitable for this site", "title": "Error compiling very simple C program", "body": "<p>I decided I am going to teach myself \"C\" and saw a very simple \"sample\" program on a tutorial website, that I figured I would build off of it while I learn. The code is below</p>\n\n<pre><code>/* hello.c*/\n#include &lt;stdio.h&gt;\nint main (int argc, char *argv[1]);\n{\n  if (argc &gt; 1)\n    printf(\"greetings %s.\\n\", argv[1]);\n  else\n    printf(\"Please tell me your name.\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>I am trying to compile with the following command</p>\n\n<pre><code>gcc -Wall -o hello_program hello.c\n</code></pre>\n\n<p>I am receiving the following error whenever I attempt to compile.</p>\n\n<p>\"hello.c:5: error: expected identifier or '(' before '{' token\"</p>\n\n<p>I have been doing some googling and have not come up with a solid answer. I am 100% new to C (Linux/Bash/Unix is my world) and programming languages in general. The error message leads me to believe that the compiler fails at line 5, and that it wants '(' before the '{', I just cannot seem to get the right order. Thank you for the assistance.</p>\n"}, {"tags": ["c", "random", "tournament"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1451508910, "post_id": 34537076, "comment_id": 56816112, "body": "You do not need the &quot;good evening&quot; - It might be the middle of the day where the person is reading this!"}, {"owner": {"reputation": 11, "user_id": 5732099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757889295334901b6bc386858f53ec43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Torvalds", "link": "https://stackoverflow.com/users/5732099/m-torvalds"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451509101, "post_id": 34537076, "comment_id": 56816220, "body": "Sorry, it&#39;s a bad habit of mine. Thank you for the information!"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1451509200, "post_id": 34537076, "comment_id": 56816266, "body": "&quot;how I could save this information&quot;, you need to design a data structure to store the generated data. For example you can have an array of teams where each array entry is a list of players."}, {"owner": {"reputation": 11, "user_id": 5732099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757889295334901b6bc386858f53ec43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Torvalds", "link": "https://stackoverflow.com/users/5732099/m-torvalds"}, "edited": false, "score": 0, "creation_date": 1451509334, "post_id": 34537076, "comment_id": 56816319, "body": "I already thought of this. So I&#39;d need to say if they&#39;re Team One, they need to be saved to Team One&#39;s array, am I right? Sorry, I&#39;m a bit new to all this."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1451509403, "post_id": 34537076, "comment_id": 56816361, "body": "Yes that&#39;ll be a good start."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451510975, "post_id": 34537076, "comment_id": 56817125, "body": "Could you read the information from a text file in the first place? It would be so much easier than typing it in every time you run the program."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1518437071, "creation_date": 1518437071, "answer_id": 48746105, "question_id": 34537076, "link": "https://stackoverflow.com/questions/34537076/team-and-fight-randomizer-in-c/48746105#48746105", "title": "Team and Fight Randomizer in C", "body": "<p>Before basing something on the given code, you should correct the errors in it, which are within the counting of team members and the printing of the counts. While you're at it, you could make it work also for more than four teams, e. g.:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\u2026\n    int Spielerteam[mitglieder];                // team of the player\n    int Teamstaerke[teams];                     // team member counts\n    memset(Teamstaerke, 0, sizeof Teamstaerke); // zero the counts\n\n    for (int i = 0; i &lt; mitglieder; i++) \n    {    // print array\n        int random_number = rand() % teams;\n        int tp = random_number + 1;\n        Spielerteam[i] = tp;            // save player's team information\n        Teamstaerke[random_number]++;   // count the member\n        printf(\"Team %d - Spieler: %d\\n \", tp, array[i] + 1);      \n    }\n\n    for (int i = 0; i &lt; teams; i++) \n        printf(\"%s%d Mitglieder in Team %d\",\n                i ? i+1 == teams ? \" und \" : \", \" : \"\\n\", Teamstaerke[i], i+1);\n    puts(\"\");\n</code></pre>\n\n<p>After that, the team each player <code>array[i] + 1</code> belongs to is saved in <code>Spielerteam[i]</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 5732099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757889295334901b6bc386858f53ec43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Torvalds", "link": "https://stackoverflow.com/users/5732099/m-torvalds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1518437071, "creation_date": 1451508794, "last_edit_date": 1451512800, "question_id": 34537076, "link": "https://stackoverflow.com/questions/34537076/team-and-fight-randomizer-in-c", "title": "Team and Fight Randomizer in C", "body": "<p>I'm trying to make a program, which puts a given amount of players in a given amount of teams. Afterwards they should be randomly chosen (eg. you roll the \"dice\" and Team 3's Player 42 and shall fight against Team 4's Player 22 (All the players are randomly put in the different teams, which are limited to the choice of the Gamemaster)).</p>\n\n<p>In my code I have the basic output and structure. It says something like:</p>\n\n<p>Team 1 now owns Player 43\nTeam 2 now owns Player 12\nTeam 4 now owns Player 1\nTeam 3 now owns Player 54</p>\n\n<p>But my question is, how - based on the code - I could save this information and how can I (afterwards) let the players randomly fight? Members of the same team should NOT be able to fight each other and after each fight I want the players to be somehow on a \"blacklist\" where they can't be rolled anymore.</p>\n\n<p>My code so far</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() \n{\n    int mitglieder, teams, teameins = 0, teamzwei = 0, teamdrei = 0, teamvier = 0;\n\n    printf(\"Teamcreation\\n\");\n    printf(\"\\nNumber of Players: \");\n    scanf(\"%d\", &amp;mitglieder);\n    printf(\"\\nNumber of Teams: \");\n    scanf(\"%d\", &amp;teams);\n    printf(\"\\nThere are \");\n    printf(\"%d\", mitglieder);\n    printf(\" Player in \");\n    printf(\"%d\", teams);\n    printf(\" Teams. \\n\");\n\n    int array[mitglieder];\n\n    for (int i = 0; i &lt; mitglieder; i++) \n    {     // fill array\n        array[i] = i;               \n    }\n\n    printf(\"The Player are in the following Teams: \\n \");\n\n    for (int i = 0; i &lt; mitglieder; i++) \n    {    // shuffle array\n        int temp = array[i];\n        int randomIndex = rand() % mitglieder;\n\n        array[i]           = array[randomIndex];\n        array[randomIndex] = temp;\n    }\n\n    for (int i = 0; i &lt; mitglieder; i++) \n    {    // print array\n        int random_number = rand() % teams + 1;\n        int tp = random_number;\n\n        if(tp == 1) \n        {\n            teameins+1;\n        }\n        else if(tp == 2) \n        {\n            teamzwei+1;\n        }\n        else if(tp == 3) \n        {\n            teamdrei+1;\n        }\n        else if(tp == 4) \n        {\n            teamvier+1;                         \n        }\n\n        printf(\"Team %d - Spieler: %d\\n \",random_number,array[i] + 1);      \n    }\n\n    if( (teamvier == 0) &amp;&amp; (teamdrei == 0) ) \n    {\n        printf(\"\\n%d Mitglieder in Team 1 und %d Mitglieder in Team2\",teameins,teamzwei);\n    }\n    else if((teamvier == 0) &amp;&amp; (teamdrei &lt; 0)) \n    {\n        printf(\"\\n%d Mitglieder in Team 1, %d Mitglieder in Team2 und %d Mitglieder in Team3.\",teameins,teamzwei,teamdrei);\n    }\n    else if(teamvier &lt; 0) \n    {\n        printf(\"\\n%d Mitglieder in Team 1, %d Mitglieder in Team2, %d Mitglieder in Team 3 und %d Mitglieder in Team4.\",teameins,teamzwei,teamdrei,teamvier);\n    }\n\n    return 0;\n}\n</code></pre>\n\n\n"}, {"tags": ["c++", "c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 6, "creation_date": 1451507556, "post_id": 34536797, "comment_id": 56815401, "body": "&quot;&quot;my_array&quot; is effectively a char pointer&quot; this is incorrect"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1451507592, "post_id": 34536797, "comment_id": 56815420, "body": "What do you get if you compiler C code with a Java compiler? Please read the C-tag info page. C and C++ are different languages. A simple search for &quot;C C++ differences&quot; will answer your question. And there is a good reason an array is called &quot;array&quot; and not &quot;pointer&quot; (and vice-versa)."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1451507627, "post_id": 34536797, "comment_id": 56815439, "body": "@Slava Well, that depends on the context since it can decay to a <code>char*</code> but it can also just be a <code>char[5]</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 4, "creation_date": 1451507657, "post_id": 34536797, "comment_id": 56815470, "body": "@cad: Yes, it <b>decays</b> (i.e. is automatically converto to a point er to ist first element). But is <b>is</b> not the same as a pointer."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451507827, "post_id": 34536797, "comment_id": 56815568, "body": "@cad literal <code>0</code> can decay to <code>nullptr</code> but you cannot say 0 is effectively a <code>nullptr</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451507829, "post_id": 34536797, "comment_id": 56815571, "body": "And casting a function pointer to/from an object pointer is undefined behaviour in C."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1451507948, "post_id": 34536797, "comment_id": 56815656, "body": "@Slava: IIRC, it is some C legacy that C++ also treats <code>0</code> assigned to a pointer as a <i>null pointer constant</i>. C++11 added the <code>nullptr</code> keyword to get eventually (within the next 2-3 decades:-( rid of this nonsense. I wish C11 had followed that."}, {"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451508033, "post_id": 34536797, "comment_id": 56815695, "body": "So in my code when it compiles in c, but not in c++, it&#39;s because c++ flat out says I can&#39;t do that, while c just didn&#39;t define the behavior of my code? Also, why would I have to put a &quot;&amp;&quot; operator to convert my_array from char[5] to function pointer?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1451508113, "post_id": 34536797, "comment_id": 56815736, "body": "The need to use a cast should be a clear indicator you did something wrong. Do not use a cast unless you <b>fully</b> understand all implications! There is a reason your compiler warns about type missmatches. And enable warnings; your C compiler should complain, too."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451508480, "post_id": 34536797, "comment_id": 56815915, "body": "And just because your code compiles does not mean it is correct. Please informs us if you found a tool/language which can proof that for every non-trivial program and terminates properly within - say - some months (preferably less)."}], "answers": [{"comments": [{"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451508154, "post_id": 34536887, "comment_id": 56815760, "body": "That answers most of it, but I still don&#39;t understand why &quot;pFunc pFunc2 = (pFunc)my_array;&quot; would not work?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451508312, "post_id": 34536887, "comment_id": 56815840, "body": "@MyUsername112358: As I already commented on your question: Think about the meaning of the word &quot;undefined&quot;, as in <i>undefined behaviour</i>."}, {"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451508560, "post_id": 34536887, "comment_id": 56815953, "body": "I thought the undefined behavior was casting &amp;my_array to char*? What I don&#39;t understand is why is &quot;char* b = &amp;my_array;&quot; undefined behavior, yet the only way I can cast my_array to function pointer is by using &amp;my_array that way: &quot;pFunc pFunc1 = (pFunc)&amp;my_array;&quot;, and yet this doesn&#39;t work: pFunc pFunc2 = (pFunc)my_array;."}, {"owner": {"reputation": 2629, "user_id": 1051292, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89cce8b59e351225f874e8d24c9215f4?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1051292/kevin"}, "reply_to_user": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451509367, "post_id": 34536887, "comment_id": 56816338, "body": "@MyUsername112358 Have you ever thought for a second about what you were trying to do? &quot;only way I can cast my_array to function pointer&quot;, I mean, what? Why would you ever want to cast a char array to a function pointer? I can not imagine <b>any</b> use case for that..."}, {"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451509559, "post_id": 34536887, "comment_id": 56816469, "body": "So that I can execute those arrays at runtime, as I said in my original post... I&#39;m injecting code in a running executable, I replace 5 bytes of the executable by a jump to my own function in the code I injected. I store those 5 bytes in a char array. My function do it&#39;s thing, then executes the 5 bytes at the end before returning to the executable. That way I can execute my function without modifying in any way the targeted executable. Not sure why you thought that was relevant to ask, but here you go."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1451508986, "last_edit_date": 1451508986, "creation_date": 1451507800, "answer_id": 34536887, "question_id": 34536797, "link": "https://stackoverflow.com/questions/34536797/questions-about-address-of-operator-and-arrays-in-c-and-c/34536887#34536887", "title": "Questions about &quot;Address-of operator&quot; (&amp;) and arrays in c and c++", "body": "<p>When an array is defined then space is allocated for its element in memory. The whole space, in your case <code>5</code> bytes, is allocated for array. Therefore, space is allocated for arrays elements as well as array itself.  </p>\n\n<p>It should be noted that an array is not a pointer and vice-versa. <code>my_array</code> is an array and not a pointer. In most cases an array convert to a pointer to its first element, but it does not imply that arrays are pointers.</p>\n\n<p>The address of array <code>my_array</code> is of type <code>char (*)[5]</code>, a pointer to an array of 5 <code>char</code>s. It is incompatible with type <code>char **</code> and <code>pFunct</code>. Assigning incompatible pointer types causes error.</p>\n"}, {"comments": [{"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1451509993, "post_id": 34537199, "comment_id": 56816683, "body": "&quot;because C allows implicit conversion between unrelated pointer types&quot; - it doesn&#39;t. It&#39;s a constraint violation that requires a diagnostic. GCC just happens to issue a warning rather than an error."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1451510318, "post_id": 34537199, "comment_id": 56816820, "body": "@T.C. It requires a diagnostic, but GCC is still &quot;allowed&quot; to let the code compile."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "reply_to_user": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1451510367, "post_id": 34537199, "comment_id": 56816844, "body": "@PCLuddite By that logic, C &quot;allows&quot; everything under the sun."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1451510487, "post_id": 34537199, "comment_id": 56816902, "body": "Updated to mention that a warning is required to be emitted in C."}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451511293, "post_id": 34537199, "comment_id": 56817265, "body": "Best answer so far. However, on the function pointers, you are a bit incorrect: Casts to/from function pointers from/to other types are not guaranteed to work in any way, since a function pointer can be a fundamentally different beast than a data pointer. I remember that on PPC Macs, a function pointer actually consisted of <i>two</i> pointers, one to point to the global data table (TOC), the other to point to the code. You cannot cast a <code>char*</code> to such a function pointer. I guess, <code>gcc</code> allows that because the linux people need and use it (take a look at libdl)."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1451512384, "post_id": 34537199, "comment_id": 56817744, "body": "Yes, GCC and MSVC both allow such conversions, but I edited to note that it is not required to work."}, {"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451512836, "post_id": 34537199, "comment_id": 56817953, "body": "&quot;but either way the result is unlikely to be anything useful.&quot;. In my case I have to execute variable bytes at runtime, I&#39;m not sure how I could do that any other way?"}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "edited": false, "score": 0, "creation_date": 1451513438, "post_id": 34537199, "comment_id": 56818218, "body": "If you&#39;re trying to attack some sort of code injection vulnerability then you&#39;ve moved out of the realm of &quot;how does C++ work?&quot; and into the realm of &quot;how does this particular implementation happen to implement the constructs required by C++?&quot;.  Unless this is to learn about application security, I can&#39;t think of any legitimate reason to create a something like that."}, {"owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "edited": false, "score": 0, "creation_date": 1451514266, "post_id": 34537199, "comment_id": 56818598, "body": "I&#39;m adding capabilities to a specific program I don&#39;t have the source code of (not for commercial use, just for me). I inject my code in it at runtime, replace 5 bytes (which I save in a char array) by a jump to my own function, my function does it&#39;s thing (mainly intercept some data and do stuff) then at the end of my function I simply execute the 5 bytes previously saved. That way, the program works exactly as if I didn&#39;t modify anything."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 0, "creation_date": 1451518538, "post_id": 34537199, "comment_id": 56820102, "body": "This is still not right. Neither the C nor the C++ standard distinguishes between &quot;warnings&quot; and &quot;errors&quot;. The requirement is simply &quot;a diagnostic&quot;, which can be anything the implementation says is one, including, say, the character <code>a</code>. It&#39;s up to the implementation to decide which problems result in errors and which in warnings (the one exception: in C, a source file containing an unskipped <code>#error</code> directive must not be successfully translated)."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 4, "last_activity_date": 1451511939, "last_edit_date": 1451511939, "creation_date": 1451509389, "answer_id": 34537199, "question_id": 34536797, "link": "https://stackoverflow.com/questions/34536797/questions-about-address-of-operator-and-arrays-in-c-and-c/34537199#34537199", "title": "Questions about &quot;Address-of operator&quot; (&amp;) and arrays in c and c++", "body": "<p>An array in C++ is not a pointer.  When a pointer of the appropriate type is initialized using the array's name (such as when the array is passed to a function argument of the appropriate pointer type), it will decay into a pointer, but it is not itself a pointer.</p>\n\n<p>When you declare <code>char my_array[5]</code>, you are creating an array of 5 <code>char</code>s; no pointer is created, but a <code>char[5]</code> exists and can be pointed to by other pointers.</p>\n\n<p>If you do <code>char* a = my_array;</code>, <code>my_array</code> will decay into a pointer; a new <code>char*</code> is created pointing to the first element of <code>my_array</code>.<br>\n<code>char* b = &amp;my_array;</code> fails because <code>my_array</code> isn't a <code>char</code>, and thus <code>&amp;my_array</code> isn't a <code>char*</code>.  <code>char** d = &amp;my_array;</code> fails since <code>my_array</code> isn't a <code>char*</code>, and thus <code>&amp;my_array</code> isn't a <code>char**</code>.  <code>&amp;my_array</code> is a <code>char (*)[5]</code> (pointer to an array of 5 <code>char</code>s).  These \"work\" in C because C only requires the compiler issue a warning for implicit conversion between unrelated pointer types, but C++ does not allow these implicit conversions at all; they result in a compilation error.  You need an explicit cast in C++, but even then the behavior is undefined if you dereference the resulting pointer.</p>\n\n<p>Finally, <code>pFunc pFunc1 = (pFunc)&amp;my_array;</code> \"works\" on platforms that represent function pointers and object pointers similarly (most modern systems), but it isn't required to work on all platforms.  Again, using the resulting pointer will invoke undefined behavior.<br>\n<code>pFunc pFunc2 = (pFunc)my_array;</code> actually compiles as well using GCC, but fails to compile under MSVC.  I'm not actually sure which compiler's behavior is correct, but either way the result is unlikely to be anything useful.</p>\n"}], "owner": {"reputation": 1147, "user_id": 3137789, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b65ef8041f0b9d2a25d50ba550cb9fe9?s=128&d=identicon&r=PG&f=1", "display_name": "MyUsername112358", "link": "https://stackoverflow.com/users/3137789/myusername112358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 34537199, "answer_count": 2, "score": 1, "last_activity_date": 1451511939, "creation_date": 1451507433, "question_id": 34536797, "link": "https://stackoverflow.com/questions/34536797/questions-about-address-of-operator-and-arrays-in-c-and-c", "title": "Questions about &quot;Address-of operator&quot; (&amp;) and arrays in c and c++", "body": "<p>I found a difference when compiling in c versus when I compile in c++ that I don't fully understand... Let's say I declare an array of char of size 5:</p>\n\n<pre><code>char my_array[5];\n</code></pre>\n\n<p>From my understanding, \"my_array\" is effectively a char pointer, which allows me to do this:</p>\n\n<pre><code>char* a = my_array;\n</code></pre>\n\n<p>Now, I understand that when I declared my array, I allocated 5 bytes only (one for each values in it), which means that \"&amp;my_array\" should not exist, because there is no allocated memory for a pointer to my_array. To prove that, I did this:</p>\n\n<pre><code>char* b = &amp;my_array; // compiler error in c++, not in c\nchar** c = &amp;my_array; // compiler error in c++, not in c\n</code></pre>\n\n<p>I don't get the difference, why would c allow that? Still, let's say I want to convert my char[5] to char*, without using the method for a, I found that I can also do:</p>\n\n<pre><code>char* c = (char*)&amp;my_array; // works both in c and c++\n</code></pre>\n\n<p>That one I really don't understand. Have I not determined that \"&amp;my_array\" doesn't exist? More alarmingly, these 2 lines returns the same exact value:</p>\n\n<pre><code>// a and c have the same value (both in c and c++)\nchar* a = my_array;\nchar* c = (char*)&amp;my_array;\n</code></pre>\n\n<p>Next, let's say I want to execute those 5 bytes at run-time, so I declare a new type:</p>\n\n<pre><code>// pFunc is a pointer to function returning void\ntypedef void (*pFunc)();\n</code></pre>\n\n<p>Then I tried declaring a pointer to function that would execute my array of bytes:</p>\n\n<pre><code>pFunc pFunc1 = (pFunc)&amp;my_array; // works, but I don't really understand why\npFunc pFunc2 = (pFunc)my_array;  // compiler error in c++, not in c\n</code></pre>\n\n<p>Suddenly, not only is &amp;my_array compiling without problem, but it's also the only way to make this works in c++ (that I know of). Anyone mind explaining to me what is going on? Here is the full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef void (*pFunc)();\n\nint main()\n{\n    char my_array[5];\n\n    char* a = my_array;\n    char* b = &amp;my_array; // compiler error in c++, not in c\n    char* c = (char*)&amp;my_array;\n    char** d = &amp;my_array; // compiler error in c++, not in c\n    char** e = (char**)&amp;my_array;\n\n    pFunc pFunc1 = (pFunc)&amp;my_array; // works, but I don't really understand why\n    pFunc pFunc2 = (pFunc)my_array;  // compiler error in c++, not in c\n\n    printf(\"char*:\\n\");\n    printf(\"0x%X\\n\", a);\n    printf(\"0x%X\\n\", b);\n    printf(\"0x%X\\n\", c);\n    printf(\"0x%X\\n\", d);\n    printf(\"0x%X\\n\", e);\n    printf(\"\\n\");\n\n    while(1);\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "mpi", "send", "distributed-computing"], "comments": [{"owner": {"reputation": 1398, "user_id": 601409, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ec12784ac7ae1a91bd223ae176a5244?s=128&d=identicon&r=PG&f=1", "display_name": "EkcenierK", "link": "https://stackoverflow.com/users/601409/ekcenierk"}, "edited": false, "score": 2, "creation_date": 1451507493, "post_id": 34536780, "comment_id": 56815366, "body": "Have you tried using a debugger?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1398, "user_id": 601409, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ec12784ac7ae1a91bd223ae176a5244?s=128&d=identicon&r=PG&f=1", "display_name": "EkcenierK", "link": "https://stackoverflow.com/users/601409/ekcenierk"}, "edited": false, "score": 0, "creation_date": 1451507668, "post_id": 34536780, "comment_id": 56815481, "body": "Hmm @KLibby I am updating."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451507672, "post_id": 34536780, "comment_id": 56815484, "body": "Where does it <i>hung</i>?  At what line of code?  Do you mean the function never returns?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451507771, "post_id": 34536780, "comment_id": 56815538, "body": "Yes @ryyker, the function does not return."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1451509560, "post_id": 34536780, "comment_id": 56816470, "body": "@Gernot1976 I wish you were right, but no, updated the question, tried to save some space there, sorry :)"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451510802, "post_id": 34536780, "comment_id": 56817044, "body": "Did you initialized <code>gridPtr</code>?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451511008, "post_id": 34536780, "comment_id": 56817137, "body": "@MartinZabel every <code>gridPtr</code> has the expected values on their respective 4x4 submatrix. :/"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1451511055, "post_id": 34536780, "comment_id": 56817155, "body": "There is no 2D array in your code."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451511140, "post_id": 34536780, "comment_id": 56817192, "body": "@Olaf when I am saying a 2D array, I am referring to the double pointers that are later being malloc&#39;ed, aren&#39;t I? The pointers are the very first lines of my code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1451511223, "post_id": 34536780, "comment_id": 56817231, "body": "A pointer is not an array and vice versa. Don&#39;t be misslead by indexing operator which is overloaded for pointers and arrays. There are different semantics. A pointer to a true 2D array (i.e. a matrix) would look like <code>int (*ip)[4]</code> (pointer to the first row of the array), or <code>int (*p2da)[4][5]</code> (true pointer to 2D array, but less intuitive to use)."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451511271, "post_id": 34536780, "comment_id": 56817255, "body": "I see @Olaf, but still it&#39;s not clear to me how I should fix the code.. :/ Any insight please?"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451511349, "post_id": 34536780, "comment_id": 56817284, "body": "Just to be sure. You initialized <code>grid</code> but not <code>gridPtr</code> in line 5."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451511452, "post_id": 34536780, "comment_id": 56817323, "body": "<code>gridPtr</code> is a pointer to the grid, thus its initialization is this: <code>gridPtr = grid;</code>. I also updated my question, thanks @MartinZabel!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451511462, "post_id": 34536780, "comment_id": 56817325, "body": "TL;DR for today - sorry. But segfaults are typical for problems with (multiple) indirection. I&#39;d check in that direction."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451511519, "post_id": 34536780, "comment_id": 56817347, "body": "I am trying @Olaf, thanks for the help so far!"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1451511690, "post_id": 34536780, "comment_id": 56817424, "body": "A downvvote for what? I keep improving this question SO hard! The post is rather long and you say that I should add more code?! I have included all the relevant parts!., if I have forgotten any please let me know!"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451512225, "post_id": 34536780, "comment_id": 56817657, "body": "I didn&#39;t downvoted it. But, the relationship between <code>N</code> and <code>N_glob</code> is missing. Also note, that you only gather only one row from each rank. Is this intended?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451512420, "post_id": 34536780, "comment_id": 56817760, "body": "@MartinZabel thanks, I updated! Well the goal is to ultimately gather all the submatrices in the global matrix, but I wanted to start from somewhere!"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 1, "creation_date": 1451514168, "post_id": 34536780, "comment_id": 56818559, "body": "You should remove EDIT_2, _3 and _4 because the pointer arithmetic is broken. <code>&amp;(gridPtr[0])</code> as well as <code>&amp;(global_grid[0])</code> return a pointer to the first row-pointer allocated at <code>A = malloc(M * sizeof (float*));</code> within <code>allocate2d</code>. That is not the data space. You should try <code>gridPtr[0]</code> and <code>global_grid[0]</code> instead, because these actually point to the first row in the data space."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451553799, "post_id": 34536780, "comment_id": 56829734, "body": "@MartinZabel good idea, but it didn&#39;t work either, see my edit!"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451555972, "post_id": 34536780, "comment_id": 56830694, "body": "<code>global_grid</code> is already a pointer. Just do <code>if(id==0) { global_grid = allocate2d(...); } else {global_grid = NULL;}</code>"}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1451559624, "post_id": 34536780, "comment_id": 56832415, "body": "@gsamaras: Imagine someone in the future is having a similar problem and search turns up this question. Do you think they will have <i>any</i> hope of understanding it? This is a <a href=\"https://stackoverflow.com\">Stack Overflow</a> question, not a changelog or you personal interactive debugging session. Could you do something about this please?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1451560003, "post_id": 34536780, "comment_id": 56832552, "body": "@talonmies you are right. I updated my question, hope it&#39;s better now. If you have any suggestions please let me know."}], "answers": [{"comments": [{"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1451556308, "post_id": 34544655, "comment_id": 56830850, "body": "You are right Martin thanks! So how should my <code>MPI_Gather()</code> look like?"}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "reply_to_user": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1451556502, "post_id": 34544655, "comment_id": 56830934, "body": "@gsamaras Added call to <code>MPI_Gather</code>."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "edited": false, "score": 0, "creation_date": 1451559099, "post_id": 34544655, "comment_id": 56832164, "body": "Martin thanks, that did the trick. Now I have to actually send the data I need to the global matrix, thus I need some explanation. Only the first MPI_Gather does work, while the one in the else case does nothing? After experimenting a bit, it seems like not. I also did a follow-up question here: <a href=\"http://stackoverflow.com/questions/34545278/mpi-gather-the-central-elements-into-a-global-matrix\" title=\"mpi gather the central elements into a global matrix\">stackoverflow.com/questions/34545278/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "is_accepted": true, "score": 4, "last_activity_date": 1451556462, "last_edit_date": 1451556462, "creation_date": 1451556227, "answer_id": 34544655, "question_id": 34536780, "link": "https://stackoverflow.com/questions/34536780/mpi-gather-2d-array/34544655#34544655", "title": "MPI_Gather 2D array", "body": "<p>The variable <code>global_grid</code> is not initialized in ranks other than rank 0. Thus, this equation</p>\n\n<pre><code>&amp;(global_grid[0][0])\n</code></pre>\n\n<p>or this one:</p>\n\n<pre><code>global_grid[0]\n</code></pre>\n\n<p>leads to a segmentation fault, because it tries to access the first element of global_grid.</p>\n\n<p>Just make two calls to <code>MPI_Gather</code>, one for rank 0 and one for the other ones:</p>\n\n<pre><code>if(id == 0) {\n    MPI_Gather(gridPtr[0], 1, rowType, global_grid[0], 1, rowType, 0, MPI_COMM_WORLD);\n} else {\n    MPI_Gather(gridPtr[0], 1, rowType, NULL, 0, rowType, 0, MPI_COMM_WORLD);\n}\n</code></pre>\n"}], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3605, "favorite_count": 0, "accepted_answer_id": 34544655, "answer_count": 1, "score": 1, "last_activity_date": 1451559846, "creation_date": 1451507369, "last_edit_date": 1495542719, "question_id": 34536780, "link": "https://stackoverflow.com/questions/34536780/mpi-gather-2d-array", "title": "MPI_Gather 2D array", "body": "<p><code>N</code> is 4, so is <code>N_glob</code>. It happens to be of the same size. <code>p</code> is 4.</p>\n\n<p>Here is a small portion of the code:</p>\n\n<pre><code>float **global_grid;\nfloat **gridPtr; \nlengthSubN = N/pSqrt;\nsubN = lengthSubN + 2;\ngrid = allocate2D(grid, subN, subN);\n..\nMPI_Type_contiguous(lengthSubN, MPI_FLOAT, &amp;rowType);\nMPI_Type_commit(&amp;rowType);\n..\ngridPtr = grid;\n..\nMPI_Barrier(MPI_COMM_WORLD);\nif(id == 0) {\n    global_grid = allocate2D(global_grid, N_glob, N_glob);\n}\nMPI_Barrier(MPI_COMM_WORLD);\nMPI_Gather(&amp;(gridPtr[0][0]), 1, rowType,\n           &amp;(global_grid[0][0]), 1, rowType, 0, MPI_COMM_WORLD);\nMPI_Barrier(MPI_COMM_WORLD);\nif(id == 0)\n    print(global_grid, N_glob, N_glob);\n</code></pre>\n\n<p>where I have <code>p</code> submatrices and I am trying to gather them all in the root process, where the global matrix waits for them. However, it will just throw an error, any ideas?</p>\n\n<p>I am receiving a seg fault:</p>\n\n<blockquote>\n  <p>BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES\n  PID 29058 RUNNING AT linux16\n  EXIT CODE: 139\n  YOUR APPLICATION TERMINATED WITH THE EXIT STRING: Segmentation fault (signal 11)</p>\n</blockquote>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>I found this question <a href=\"https://stackoverflow.com/questions/16569567/mpi-gather-segmentation-fault\">MPI_Gather segmentation fault</a> and I initialized <code>global_grid</code> to NULL, but no luck. However, if I do:</p>\n\n<pre><code>//if(id == 0) {\n    global_grid = allocate2D(global_grid, N_glob, N_glob);\n//}\n</code></pre>\n\n<p>then everything works. But shouldn't the global matrix live only in the root process?</p>\n\n<hr>\n\n<p>EDIT_2:</p>\n\n<p>IF I do:</p>\n\n<pre><code>if(id == 0) {\n    global_grid = allocate2D(global_grid, N_glob, N_glob);\n} else {\n    global_grid = NULL;\n}\n</code></pre>\n\n<p>then it will crash here:</p>\n\n<pre><code>MPI_Gather(&amp;gridPtr[0][0], 1, rowType,\n                global_grid[0], 1, rowType, 0, MPI_COMM_WORLD);\n</code></pre>\n"}, {"tags": ["c", "linux", "select", "makefile", "32bit-64bit"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451507818, "post_id": 34536722, "comment_id": 56815561, "body": "Why do you use <code>select(sock_no+1...</code> instead of <code>select(sock_no...</code>?"}, {"owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451508140, "post_id": 34536722, "comment_id": 56815752, "body": "@ryyker because select goes over the nfds descriptos ( from 0 to nfds -1 ), according to:  <a href=\"http://www.freebsd.org/cgi/man.cgi?select\" rel=\"nofollow noreferrer\">freebsd.org/cgi/man.cgi?select</a>  ( see lines 5-6 in DESCRIPTION )"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451508356, "post_id": 34536722, "comment_id": 56815858, "body": "I have always just used the actual value for socket in that argument.  Have not seen the <code>-1</code> .  There may be a difference in the windows sockets definition for <code>select()</code>  You are on Linux then?  I had not yet noticed."}, {"owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451508534, "post_id": 34536722, "comment_id": 56815943, "body": "@ryyker Yes of course, sorry for not mentioning - i&#39;m in linux dist (kubuntu), on 64 bit architecture"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1451508971, "post_id": 34536722, "comment_id": 56816151, "body": "Windows (winsock) ignores the first argument to select and tests all descriptors in all the fd_sets regardless."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3692497"}, "edited": false, "score": 0, "creation_date": 1451508309, "post_id": 34536916, "comment_id": 56815837, "body": "That would wait for all sockets up to <code>sock_no - 1</code> according to the man pages."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1451509973, "post_id": 34536916, "comment_id": 56816672, "body": "He&#39;s only setting one socket (<code>sock_no</code>) in the fd_set, so <code>sock_no + 1</code> is clearly correct..."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1451510174, "last_edit_date": 1495542186, "creation_date": 1451507944, "answer_id": 34536916, "question_id": 34536722, "link": "https://stackoverflow.com/questions/34536722/select-fails-when-adding-m32-flag-to-makefile/34536916#34536916", "title": "select() fails when adding m32 flag to Makefile", "body": "<p><strong><em>EDIT</em></strong><br>\nDid you determine the maximum number of fd's?  </p>\n\n<p>In general, determine the max number, then pass it to select:  </p>\n\n<pre><code>  int maxfd;\n\n  for (i = 0, maxfd = 0; i &lt; nclients; i++)\n  {\n    FD_SET(sock[i], &amp;read_fds);\n    if (sock[i] &gt; maxfd)\n        maxfd = sock[i];\n  }\n\n  select(maxfd + 1, ........); \n</code></pre>\n\n<p>If you have not determined what maxfd is, then it could be problematic.  </p>\n\n<p>( From <strong><em><a href=\"https://stackoverflow.com/a/22601341/645128\">discussion here</a></em></strong>   )</p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451510958, "post_id": 34537306, "comment_id": 56817118, "body": "OP has not confirmed it yet, but it appears your answer more specifically addresses the issue."}, {"owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "edited": false, "score": 0, "creation_date": 1451553850, "post_id": 34537306, "comment_id": 56829745, "body": "@chris-dodd  This is probably it, i&#39;ll check it later when arriving home.  One last question -  If i want timeout value to use only &quot; tv_sec &quot; param, what should i set in &quot;tv_usec&quot; one? will just 0 will cause any other behaviour rather than using &quot;tv_sec&quot; param as the timeout value?  Many thanks"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1451592762, "post_id": 34537306, "comment_id": 56844737, "body": "<code>tv_usec</code> should always be in the range 0..999999 -- it&#39;s for the fraction of a second part if you don&#39;t want a timeout that is exactly an integral number of seconds.  Note that both <code>tv_sec</code> and <code>tv_usec</code> are integers."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 3, "last_activity_date": 1451509898, "creation_date": 1451509898, "answer_id": 34537306, "question_id": 34536722, "link": "https://stackoverflow.com/questions/34536722/select-fails-when-adding-m32-flag-to-makefile/34537306#34537306", "title": "select() fails when adding m32 flag to Makefile", "body": "<p>You're not setting the <code>tv_usec</code> field of the timeout argument, so it will contain some garbage (whatever happened to be on the stack where <code>timeout_value</code> was allocated).  If that random garbage happens to be a negative number, you'll get the <code>EINVAL</code> invalid argument error.  If it happens to be ok, you won't.  Minor changes to things (like using <code>-m32</code> or not) will tend to change this.</p>\n"}], "owner": {"reputation": 1073, "user_id": 3025555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3ccd8b728b1fcaef8ad6b4526dec433a?s=128&d=identicon&r=PG&f=1", "display_name": "Adiel", "link": "https://stackoverflow.com/users/3025555/adiel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 34537306, "answer_count": 2, "score": 1, "last_activity_date": 1451510174, "creation_date": 1451507076, "last_edit_date": 1451509501, "question_id": 34536722, "link": "https://stackoverflow.com/questions/34536722/select-fails-when-adding-m32-flag-to-makefile", "title": "select() fails when adding m32 flag to Makefile", "body": "<p>i have the following code, which simply creates udp socket to listen\nto a multicast group.</p>\n\n<p>I'm compiling it using gcc, with -c -g flags, on x64 machine.\nWhen adding -m32 flag to linking &amp; compiling phases in Makefile,\n<strong>select()</strong> call is failing with <strong>Invalid Argument</strong>.</p>\n\n<p>After debugging a little bit with and without the flag, i found out that \nusing the flag i get all the same values for all variables, except:</p>\n\n<p><strong>readfds: 0x80.. (repeats 31 times) - WITH -m32 flag</strong></p>\n\n<p><strong>readfds: 0x80.. (repeats 15 times) - without the flag</strong></p>\n\n<p><strong>sock.sin_zero: 0x5c, 0xD5, 0xff, and some other weird values WITH -m32 flag</strong></p>\n\n<p><strong>sock.sin_zero: 0x0,0x0,0x20,0x0,0x0 - without the flag</strong></p>\n\n<p><em>All variables reading is done inside the file loop, right after FD_SET</em></p>\n\n<p>I don't really understand why does it changes at whole (as 32 bit program\nsuppose to run just fine on 64 bit machines) , or why does select() returns\n<strong>Invalid Argument</strong> in that case.</p>\n\n<p>could someone please help?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;linux/socket.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include \"radio_listener.h\"\n\nint main_loop(int argc, char *argv[])\n{\n    int sock_no = 0;\n    struct sockaddr_in sock;\n    socklen_t sock_size;\n    fd_set readfds;\n\n    struct ip_mreq mreq_ip;\n    uint16_t mreq_port = 0;\n\n    char buffer[BUFF_SIZE];\n    struct timeval timeout_value;\n\n    if(VALID_ARGC != argc)\n    {\n        fprintf(stderr, \"usage: %s &lt;mc_address&gt; &lt;udp_port&gt;\\n\", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    mreq_port = atoi(argv[2]);\n\n    /* Initialize a socket */\n    sock_no = socket(AF_INET, SOCK_DGRAM, 0);\n    if(sock_no &lt; 0)\n    {\n        perror(\"socket() failed!\");\n        exit(1);\n    }\n    sock.sin_family = AF_INET;\n    sock.sin_addr.s_addr = htonl(INADDR_ANY);\n    sock.sin_port = htons(mreq_port);\n    sock_size = sizeof(sock);\n\n    bind(sock_no, (struct sockaddr *)&amp;sock, sizeof(sock));\n\n    /* Initialize the Multicast request */\n    mreq_ip.imr_multiaddr.s_addr = inet_addr(argv[1]);\n    mreq_ip.imr_interface.s_addr = htonl(INADDR_ANY);    \n\n    setsockopt(sock_no, IPPROTO_IP, IP_ADD_MEMBERSHIP, &amp;mreq_ip, sizeof(mreq_ip));\n\n    while (1)\n    {\n        timeout_value.tv_sec = TIMEOUT_VAL;\n        FD_ZERO(&amp;readfds);\n        FD_SET(sock_no, &amp;readfds);\n        int retval = select(sock_no+1, &amp;readfds, NULL, NULL, &amp;timeout_value);\n\n        if(-1 == retval)\n        {\n            perror(\"select() failed!\");\n            close(sock);\n            exit(1);\n        }\n        if(0 == retval)\n        {\n            printf(\"Timeout - Closing socket and exiting\\n\");\n            break;\n        }\n\n        if(recvfrom(sock_no, buffer, BUFF_SIZE, 0, (struct sockaddr *)&amp;sock, &amp;sock_size) &lt; 0)\n        {\n            perror(\"recvfrom() failed!\");\n            close(sock);\n            exit(1);\n        }\n\n        printf(\"%s\", buffer);\n    }\n\n    close(sock);\n    return EXIT_SUCCESS;\n}\n\nint main(int argc, char *argv[])\n{\n    int rc = 0;\n    rc = main_loop(argc, argv);\n\n    return rc;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "io", "edit"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1451506255, "post_id": 34536508, "comment_id": 56814723, "body": "When I google the title question, there are numerous avenues to follow."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451506492, "post_id": 34536508, "comment_id": 56814832, "body": "But the code posted has an error already: asssuming that <code>fclose</code> successfully closed the file. That&#39;s very important when writing to a file: <code>if (fclose(fp)) &#47;* report error *&#47;</code>"}, {"owner": {"reputation": 10605, "user_id": 2476755, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pXGb5.png?s=128&g=1", "display_name": "royhowie", "link": "https://stackoverflow.com/users/2476755/royhowie"}, "edited": false, "score": 1, "creation_date": 1451507424, "post_id": 34536508, "comment_id": 56815330, "body": "This is so much more easily done with the shell, e.g., with <code>sed</code>. Do you have to do it with C?"}, {"owner": {"reputation": 33, "user_id": 5731849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1036934023029657/picture?type=large", "display_name": "Manuel Cruz", "link": "https://stackoverflow.com/users/5731849/manuel-cruz"}, "edited": false, "score": 0, "creation_date": 1451508291, "post_id": 34536508, "comment_id": 56815831, "body": "I&#39;ve read tons of posts about it but none are actually helping me at all.  Will try to use &quot;r&quot; first then &quot;w&quot;  Will look into that error  It has to be with C"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 10605, "user_id": 2476755, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pXGb5.png?s=128&g=1", "display_name": "royhowie", "link": "https://stackoverflow.com/users/2476755/royhowie"}, "edited": false, "score": 0, "creation_date": 1451513065, "post_id": 34536508, "comment_id": 56818054, "body": "As @royhowie mentions, the shell solutions is fairly simple, just <code>sed -i &#39;s&#47;400,300: (255,255,255) #FFFFFF&#47;400,300: (000,000,000) #000000&#47;&#39; filename</code>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1451516518, "post_id": 34536508, "comment_id": 56819413, "body": "&quot;Tons of posts&quot; did not help you - including the one @ryyker points to below: <a href=\"http://stackoverflow.com/q/1832757/2564301\">stackoverflow.com/q/1832757/2564301</a>? Then you may need to <a href=\"https://stackoverflow.com/posts/34536508/edit\">edit</a> your post and add what exactly fails, at what point."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1451520048, "post_id": 34536508, "comment_id": 56820480, "body": "That post does seem to lay out exactly what to use and what is required to solve the problem. @ManuelCruz, attempt a solution with the suggestions provided, if you run into problems, post what you have attempted and we are happy to help further."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451511827, "post_id": 34536626, "comment_id": 56817471, "body": "<i>You cannot write specific line of txt file in general</i>...   Are you sure?  <b><i><a href=\"http://stackoverflow.com/a/1832769/645128\">hint</a></i></b>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1451516331, "post_id": 34536626, "comment_id": 56819354, "body": "Note that OP uses the same 3-digit format for the new line. So <i>in this particular case</i> it can be done. You say this ought to work but nothing more. Care to back it up with code?"}], "tags": [], "owner": {"reputation": 404, "user_id": 5660344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d721885d6a520f30f2209e26e81f0990?s=128&d=identicon&r=PG", "display_name": "Anton Gorev", "link": "https://stackoverflow.com/users/5660344/anton-gorev"}, "is_accepted": false, "score": 0, "last_activity_date": 1451506543, "creation_date": 1451506543, "answer_id": 34536626, "question_id": 34536508, "link": "https://stackoverflow.com/questions/34536508/how-to-edit-a-specific-line-of-a-txt-file-in-c/34536626#34536626", "title": "How to edit a specific line of a txt file in C", "body": "<p>You cannot write specific line of txt file in general.</p>\n\n<p>Actually, txt file is just a sequence of bytes. Every line separated by each other just by special symbol '\\n' (or symbols '\\r', '\\n': there are two approaches).</p>\n\n<p>So, if you rewrite some line, you have to move data (lines) remained in the file just after your new line.</p>\n\n<p>But if your new line has the same length as before, you can write it over old line without any worries.</p>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 5725688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-90qf6WFjRI4/AAAAAAAAAAI/AAAAAAAAABU/66rMOR3gVOA/photo.jpg?sz=128", "display_name": "Austin Derrow-Pinion", "link": "https://stackoverflow.com/users/5725688/austin-derrow-pinion"}, "is_accepted": false, "score": 0, "last_activity_date": 1451506905, "creation_date": 1451506905, "answer_id": 34536693, "question_id": 34536508, "link": "https://stackoverflow.com/questions/34536508/how-to-edit-a-specific-line-of-a-txt-file-in-c/34536693#34536693", "title": "How to edit a specific line of a txt file in C", "body": "<p>The best approach I can think of for something like this is to open the file in read only mode and then copy everything to a new folder by opening a new file in 'w+' mode. Then you go line by line in the read file until you find a line that you wish to change, then you rewrite the line yourself in the new copy file. Then skip that line in the read file and continue on.\nAfter the copy file is what you want, you can replace the name of it to the original file name you want it to have. Then it will act as if you edited the file like you wanted to.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1451532265, "last_edit_date": 1495541043, "creation_date": 1451531575, "answer_id": 34540502, "question_id": 34536508, "link": "https://stackoverflow.com/questions/34536508/how-to-edit-a-specific-line-of-a-txt-file-in-c/34540502#34540502", "title": "How to edit a specific line of a txt file in C", "body": "<p>What you are missing is somewhat conceptual, and somewhat related to <code>fopen</code>. When you think about opening a file with <code>fopen</code>, you need to pay particular attention to the effect of the <em>file modes</em>. If you look carefully at the <em>man page</em> regarding either <code>\"w\"</code> or <code>\"w+\"</code>. In both cases the existing file is <em>truncated</em>. To <code>0-length</code> in the case of <code>\"w\"</code>.</p>\n\n<p>To avoid this issue, one approach is to read the entire file into a buffer and then make changes to the buffer, writing the modified buffer back to the original filename. This avoids the possibility to attempting to insert/delete bytes without rewriting the remainder of the file.</p>\n\n<p>To handle reading the file into a buffer, the link posted <a href=\"https://stackoverflow.com/questions/1832757/overwriting-a-specific-line-on-a-text-file\"><strong>overwriting a specific line on a text file?</strong></a>, provides a roadmap to changing a single line in a file. Your case is different. You want to find/replace <em>All</em> occurrences of a particular pattern. (that is where the <em>truncation</em> issue posses challenges) However much of the solution there can be applied to reading the file itself into a buffer. Specifically the use of <code>fseek</code> and <code>ftell</code>.</p>\n\n<p>Using <code>fseek</code> and <code>ftell</code> provides a simply way to determine the size (or length) of the file that can then be used to allocate space to hold the entire file in memory. Below is one approach to a simple function that takes the address of a character pointer and a file pointer, then using <code>fseek</code> and <code>ftell</code> allocates the required memory to hold the file and then reads the file into the buffer (<code>filebuf</code>) in a single operation with <code>fread</code>. The buffer is filled, in place, and also returned. A pointer to the file length <code>fplen</code> is passed to the function so the length is made available back in the calling function (<code>main()</code> in this case). Returning a pointer to the buffer on success (<code>NULL</code> otherwise) will allow assignment of the return, if desired, and a way to determine success/failure of the read:</p>\n\n<pre><code>char *read_file_into_buf (char **filebuf, long *fplen, FILE *fp)\n{\n    fseek (fp, 0, SEEK_END);\n    if ((*fplen = ftell (fp)) == -1) {  /* get file length */\n        fprintf (stderr, \"error: unable to determine file length.\\n\");\n        return NULL;\n    }\n    fseek (fp, 0, SEEK_SET);  /* allocate memory for file */\n    if (!(*filebuf = calloc (*fplen, sizeof *filebuf))) {\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        return NULL;\n    }\n\n    /* read entire file into filebuf */\n    if (!fread (*filebuf, sizeof *filebuf, *fplen, fp)) {\n        fprintf (stderr, \"error: file read failed.\\n\");\n        return NULL;\n    }\n\n    return *filebuf;\n}\n</code></pre>\n\n<p>Once you have the file in memory, the second piece of the puzzle is simply to scan through the buffer and make the replacements you need. Here there are a number of different tweaks you can apply to optimize the search/replace, but the following is just a straight forward basic search/replace where the only optimization attempt is a comparison of the starting character before using the normal <code>string.h</code> string comparison functions to check for your specified search string. The function returns the number of replacements made so you can determine whether a write out to the original filename is required:</p>\n\n<pre><code>unsigned find_replace_text (char *find, char *rep, char *buf, long sz)\n{\n    long i;\n    unsigned rpc = 0;\n    size_t j, flen, rlen;\n\n    flen = strlen (find);\n    rlen = strlen (rep);\n\n    for (i = 0; i &lt; sz; i++) {\n        /* if char doesn't match first in find, continue */\n        if (buf[i] != *find) continue;\n\n        /* if find found, replace with rep */\n        if (strncmp (&amp;buf[i], find, flen) == 0) {\n            for (j = 0; buf[i + j] &amp;&amp; j &lt; rlen; j++)\n                buf[i + j] = rep[j];\n            if (buf[i + j])\n            rpc++;\n        }\n    }\n\n    return rpc;\n}\n</code></pre>\n\n<p>Putting all the pieces together in a short example program using your sample data could be written as follows. The program expects the filename as the first argument (or it will read from <code>stdin</code> and write to <code>stdout</code> by default if no filename is given). There are always additional validation checks you can include as well:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n\nchar *read_file_into_buf (char **filebuf, long *fplen, FILE *fp);\nunsigned find_replace_text (char *find, char *rep, char *buf, long sz);\n\nint main (int argc, char **argv) {\n\n    char *srchstr = \"400,300\";\n    char *repstr = \"400,300: (000,000,000) #000000\";\n    char *filebuf = NULL;\n    long int fplen = 0;\n    FILE *fp = NULL;\n\n    /* open file for reading (default stdin) */\n    fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open */\n        fprintf (stderr, \"error: file open failed '%s'\\n\", argv[1]);\n        return 1;\n    }\n\n    if (!read_file_into_buf (&amp;filebuf, &amp;fplen, fp)) return 1;\n    if (fplen &lt; 1 || fplen &gt;= INT_MAX) { /* validate file length */\n        fprintf (stderr, \"error: length of file invalid for fwrite use.\\n\");\n        return 1;\n    }\n    if (fp != stdin) fclose (fp);\n\n    /* find/replace text in filebuf */\n    if (!find_replace_text (srchstr, repstr, filebuf, fplen)) {\n        printf (\"no replacements made.\\n\");\n        return 0;\n    }\n\n    /* open file for writing (default stdout) */\n    fp = argc &gt; 1 ? fopen (argv[1], \"w\") : stdout;\n\n    if (!fp) {  /* validate file open */\n        fprintf (stderr, \"error: file open failed '%s'\\n\", argv[1]);\n        return 1;\n    }\n\n    /* write modified filebuf back to filename */\n    if (fwrite (filebuf, sizeof *filebuf, (size_t)fplen, fp) != (size_t)fplen) {\n        fprintf (stderr, \"error: file write failed.\\n\");\n        return 1;\n    }\n    if (fp != stdout) \n        if (fclose (fp) == EOF) {\n            fprintf (stderr, \"error: fclose() returned EOF\\n\");\n            return 1;\n        }\n\n    free (filebuf);\n\n    return 0;\n}\n</code></pre>\n\n<p>Just include the functions at the bottom of the file. You can then:</p>\n\n<p><strong>Compile</strong></p>\n\n<pre><code>gcc -Wall -Wextra -O3 -o bin/fread_file fread_file.c\n</code></pre>\n\n<p>(or use the equivalent compile string with your compiler)</p>\n\n<p><strong>Input File</strong></p>\n\n<pre><code>$ cat dat/rbgtst.txt\n400,280: (234,163,097) #EAA361\n400,300: (255,255,255) #FFFFFF\n400,320: (064,101,160) #4065A0\n400,340: (220,194,110) #DCC26E\n</code></pre>\n\n<p><strong>Use/File After Replacement</strong></p>\n\n<pre><code>$ ./bin/fread_file dat/rbgtst.txt\n$ cat dat/rbgtst.txt\n400,280: (234,163,097) #EAA361\n400,300: (000,000,000) #000000\n400,320: (064,101,160) #4065A0\n400,340: (220,194,110) #DCC26E\n</code></pre>\n\n<p>or reading from <code>stdin</code> writing to <code>stdout</code>:</p>\n\n<pre><code>$ ./bin/fread_file &lt;dat/rbgtst.txt\n400,280: (234,163,097) #EAA361\n400,300: (000,000,000) #000000\n400,320: (064,101,160) #4065A0\n400,340: (220,194,110) #DCC26E\n</code></pre>\n\n<p><strong>Memory/Error Check</strong></p>\n\n<p>In any code your write that dynamically allocates memory, you have 2 responsibilites regarding any block of memory allocated: (1) always preserves a pointer to the starting address for the block of memory so, (2) it can be freed when it is no longer needed. </p>\n\n<p>It is imperative that you use a memory error checking program to insure you haven't written beyond/outside your allocated block of memory, attempted to read or base a jump on an unintitialized value and finally to confirm that you have freed all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are many subtle ways to misuse a new block of memory. Using a memory error checker allows you to identify any problems and validate proper use of of the memory you allocate rather than finding out a problem exist through a <code>segfault</code>. There are similar memory checkers for every platform. They are all simple to use, just run your program through it. E.g.:</p>\n\n<pre><code>$ valgrind ./bin/fread_file dat/rbgtst.txt\n==13768== Memcheck, a memory error detector\n==13768== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.\n==13768== Using Valgrind-3.8.1 and LibVEX; rerun with -h for copyright info\n==13768== Command: ./bin/fread_file dat/rbgtst.txt\n==13768==\n==13768==\n==13768== HEAP SUMMARY:\n==13768==     in use at exit: 0 bytes in 0 blocks\n==13768==   total heap usage: 3 allocs, 3 frees, 2,128 bytes allocated\n==13768==\n==13768== All heap blocks were freed -- no leaks are possible\n==13768==\n==13768== For counts of detected and suppressed errors, rerun with: -v\n==13768== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)\n</code></pre>\n\n<p>You want to confirm <code>All heap blocks were freed -- no leaks are possible</code> and <code>ERROR SUMMARY: 0 errors from 0 contexts</code> (ignore the <em>suppressed</em> note which simply relates to missing <em>debug</em> symbol files not installed on my system)</p>\n\n<p>Look over the code and understand what it is doing. This isn't presented as the only way of doing what you are attempting to do, but it is presented as an example of how to approach the problem while avoiding a number of pitfalls inherent in trying to change a line-at-a-time in an existing file utilizing offsets and a number of reads/writes to the file. Let me know if you have questions.</p>\n"}], "owner": {"reputation": 33, "user_id": 5731849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1036934023029657/picture?type=large", "display_name": "Manuel Cruz", "link": "https://stackoverflow.com/users/5731849/manuel-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8835, "favorite_count": 0, "accepted_answer_id": 34540502, "answer_count": 3, "score": 0, "last_activity_date": 1451532265, "creation_date": 1451506063, "last_edit_date": 1451527754, "question_id": 34536508, "link": "https://stackoverflow.com/questions/34536508/how-to-edit-a-specific-line-of-a-txt-file-in-c", "title": "How to edit a specific line of a txt file in C", "body": "<p>I am currently trying to edit specific lines of .txt file in C. The file that im using looks like this :</p>\n\n<p><a href=\"http://i.stack.imgur.com/G3dj4.jpg\" rel=\"nofollow\">Pixel location and RGB Color</a></p>\n\n<p>Now lets say I want to change whats written on the specific line that its highlighted on the image:</p>\n\n<p>400,300: (255,255,255) #FFFFFF</p>\n\n<p>into this:</p>\n\n<p>400,300: (000,000,000) #000000</p>\n\n<p>Basically, im trying to create a black dot in specific pixels, in this case on 400,300. This is what i have of code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    const char *filename = \"sample.txt\";\n    int x = 400;\n    int y = 300;\n\n    FILE *fp;\n    fp = fopen(filename, \"w+\");\n\n    // Algorithm that reads all the file\n\n    // If(\"Operation that reads\" == x+\",\"+y)\n    // {\n    //     Replace the line information after where it starts with \"400,300\"\n    //     Like this : 400,300: (000,000,000) #000000\n    // }\n\n\n    // Algorithm that saves the file with the changes.\n\n\n    fclose(fp)\n    printf(\"Ok - File %s saved\\n\", filename);\n    return 0;\n</code></pre>\n\n<p>Creating, opening and editing .txt files is kind of new for me so I dont know what to do, the more i read about it, the more confused I get. How do I approach this problem and what code would fit here?</p>\n\n<p>Update 1:</p>\n\n<pre><code>FILE *fp;\nfp = fopen(filename, \"w+\");\n\nif ( fp == NULL )\n{\n    printf(\"Error while opening file\"); \n}   \n</code></pre>\n\n<p>Ok so after reading what you have placed below i came up with an idea but still needs work. I would print everything from the file to a char array. After that i would search in each slot for the specific line of code that I was looking for and keep the number slot. After that, i would go to array, run it, and when it comes to that specific slot, i would replace the needed data. Now all i needed to do is to swap the information thats in the file for the one thats in the array, save the file and problem solved. But im getting erros in the code and im missing the bits of code that would clear the txt file and save the new data.</p>\n\n<p>Update 2:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\nint x,y;\nint k = 0;\nint noline; // Used to locate which line is the string im looking for\nchar search; // Used to compare with each string\nchar blackcode = (char)000; // In RGB, Black uses (000,000,000)\nchar blackhexcode = (char)000000; // The hexcode for black is #000000\nconst char *filename = \"sample.txt\";\nchar* strings[480000]; // Since its a 800x600 resolution picture, it needs that many lines.\nchar line[30]; // Space created to store whats inside each line of the file before transfering\nchar temp;\n\nFILE * fp;\nfp= fopen(filename, \"r+\");\n\nif ( fp == NULL )\n{\n    printf(\"Error while opening file\"); \n}   \nelse\n{\n    while(fgets(line, sizeof line, fp))\n    {       \n        strings[k]=strdup(line); // ERROR HERE! What Am I missing?\n        k++;\n    }\n\n    for(k = 0; k&lt; sizeof strings; k++)\n    {\n        temp = scanf(\"%[^:]s\", strings[k]);\n        search = (\"%s,%s\",x,y);\n\n        if(temp = search)\n        {\n            noline = k;\n        }\n        else\n        {\n            printf(\"Error : Wrong Coordinates\");\n        }\n    }\n\n    for(k = 0; k &lt; sizeof strings; k++)\n    {\n        if(k == noline)\n        {\n            strings[k] = (\"%d,%d: (%s,%s,%s) #%s\", x, y, blackcode, blackcode, blackcode, blackhexcode); // ERROR HERE! What did i did wrong?\n        }\n    }\n\n    // Code that cleans the txt file and saves the array back to txt file\n}\nfclose(fp);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "scanf", "format-specifiers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1451505873, "post_id": 34536426, "comment_id": 56814552, "body": "<code>scanf(&quot;%c&quot;, &amp;c2);</code> --&gt; <code>scanf(&quot; %c&quot;, &amp;c2);</code> with the space just like the first usage. The <code>%d</code> format skips whitespace, the <code>%c</code> format does not. The <code>space</code> makes it do so."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451506066, "post_id": 34536426, "comment_id": 56814629, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9562218/c-multiple-scanfs-when-i-enter-in-a-value-for-one-scanf-it-skips-the-second-s\">C: Multiple scanf&#39;s, when I enter in a value for one scanf it skips the second scanf</a>"}, {"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451506229, "post_id": 34536426, "comment_id": 56814707, "body": "no it&#39;s not... I have gone through that and after that i asked this question"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451506053, "post_id": 34536481, "comment_id": 56814624, "body": "I already know how to make that work, but I want to know that what difference is being created when I&#39;m using %d format specifier. And specially the reason for it."}, {"owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "reply_to_user": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 2, "creation_date": 1451506109, "post_id": 34536481, "comment_id": 56814652, "body": "@rajaTHEKING The new line cannot be parsed as an int which makes the diffrence in this case."}, {"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451506558, "post_id": 34536481, "comment_id": 56814869, "body": "okay, I think that the new line can&#39;t be parsed into int because its a character (&#39;\\n&#39;) .. right?"}, {"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451506904, "post_id": 34536481, "comment_id": 56815047, "body": "And if this is the reason then all the next inputs which are character should also not be parsed as the int."}, {"owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "reply_to_user": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451507248, "post_id": 34536481, "comment_id": 56815229, "body": "@rajaTHEKING It looks for the number character (0-9) and views the newline character as a separator between the two formatting flags as it also would  a space. If you decided you wanted to use the character &#39;q&#39; to separate the two numbers you would get like in this  string <code>1q2</code>, you would get 1 and 0 as an answer because it comes to a character that is not a number or a separator and thus is junk so it just gives you 0 back because what you tried to put in the formatting flag doesn&#39;t make sense.."}], "tags": [], "owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "is_accepted": false, "score": 0, "last_activity_date": 1451505951, "creation_date": 1451505951, "answer_id": 34536481, "question_id": 34536426, "link": "https://stackoverflow.com/questions/34536426/scanf-function-with-different-format-specifier/34536481#34536481", "title": "scanf() function with different format specifier", "body": "<p>It's reading the new line as the newline is a character. Simply changing <code>scanf(\"%c\", &amp;c2);</code> to <code>scanf(\" %c\", &amp;c2);</code> will make it work.</p>\n\n<p>So in your code:\n    #include</p>\n\n<pre><code>int main()\n{\n    char c1, c2;\n    printf(\"\\n Enter characters one : \");\n    scanf(\" %c\", &amp;c1);\n    printf(\"\\n Enter character two : \");\n    scanf(\" %c\", &amp;c2);\n    printf(\"\\n The the characters are %c and %c \", c1, c2);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451509667, "post_id": 34537031, "comment_id": 56816529, "body": "from where do you get to see <code>C11 standard, chapter &#167;7.21.6.2</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451509832, "post_id": 34537031, "comment_id": 56816601, "body": "@rajaTHEKING Sorry I did not get you. What do you mean <i>from where</i>? It is in the standard document. I&#39;ve N1570. Which one you&#39;re referring to? Based on the revision, chapter numbering maybe slightly different."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451509836, "post_id": 34537031, "comment_id": 56816604, "body": "@raja THE KING 2  I googled &quot;Input white-space characters (as specified by&quot; and came up with many hits including <a href=\"http://www.gnu.org/software/libc/manual/html_node/String-Input-Conversions.html\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451510042, "post_id": 34537031, "comment_id": 56816702, "body": "@SouravGhosh I was just asking for the link of that <code>C11 standard</code>. So that I can use that to refer many other things. Anyways thanks a lot for your answer"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 1, "creation_date": 1451510301, "post_id": 34537031, "comment_id": 56816812, "body": "@rajaTHEKING I see. Actual standard document costs money because you&#39;ve to buy it, however the draft versions are pretty good, too. You can find an <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">online version</a> here."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1451509029, "last_edit_date": 1451509029, "creation_date": 1451508562, "answer_id": 34537031, "question_id": 34536426, "link": "https://stackoverflow.com/questions/34536426/scanf-function-with-different-format-specifier/34537031#34537031", "title": "scanf() function with different format specifier", "body": "<p>To answer your question, let's have a look at <code>C11</code> standard, chapter \u00a77.21.6.2</p>\n\n<blockquote>\n  <p>Input white-space characters (as specified by the <code>isspace</code> function) are skipped, unless\n  the specification includes a <code>[</code>, <code>c</code>, or <code>n</code> specifier.</p>\n</blockquote>\n\n<p>So, when you have a <code>newline</code> (<code>'\\n'</code>, which is indeed a white-space character) left in the input buffer, </p>\n\n<ul>\n<li><p>in case of <code>scanf(\"%c\", &amp;charVar);</code>, the newline is considered as the input, so the second scanf <em>skips</em> asking for the input from user.</p></li>\n<li><p>in the case of <code>scanf(\"%d\", &amp;intVar);</code> the leftover <code>newline</code> is <em>skipped</em> and it wait for the <em>integer</em> input to appear, so it <em>stops and asks</em> the user for the input.</p></li>\n</ul>\n\n<p>However, FWIW, in later case, if you input a non-whitespace <em>character</em> and press <kbd>ENTER</kbd>, the <em>char</em> input will be considered as an <em>input</em>, causing a matching failure.</p>\n\n<p>Related</p>\n\n<blockquote>\n  <p>[...] If\n  the input item is not a matching sequence, the execution of the directive fails: this\n  condition is a matching failure.</p>\n</blockquote>\n"}], "owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 1, "accepted_answer_id": 34537031, "answer_count": 2, "score": 1, "last_activity_date": 1451509029, "creation_date": 1451505736, "last_edit_date": 1451508670, "question_id": 34536426, "link": "https://stackoverflow.com/questions/34536426/scanf-function-with-different-format-specifier", "title": "scanf() function with different format specifier", "body": "<p>Below is a program which accepts two character and prints them</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char c1, c2;\n    printf(\"\\n Enter characters one : \");\n    scanf(\" %c\", &amp;c1);\n    printf(\"\\n Enter character two : \");\n    scanf(\"%c\", &amp;c2);\n    printf(\"\\n The the characters are %c and %c \", c1, c2);\n    return 0;\n}\n</code></pre>\n\n<p>Now one output instance is :-</p>\n\n<pre><code>Enter two characters : a\nThe the characters are a and\n</code></pre>\n\n<p>The problem is that I haven't given any space between two format specifier <code>%c</code>\nHere I pressed 'a' and then '\\n' which gets stored into c1 and c2 respectively. And thus I got output which was not accepted.</p>\n\n<p>I know how to correct this problem.</p>\n\n<p>Now I make the same program for the integers :-</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int a, b;\n    printf(\"\\n Enter two numbers : \");\n    scanf(\"%d%d\", &amp;a, &amp;b);\n    printf(\"\\n The two numbers are %d and %d \", a, b);\n    return 0;\n}\n</code></pre>\n\n<p>Here we will not found any problem.</p>\n\n<p>I think this time we didn't encounter problem because the second input we give is <code>'\\n'</code> or space which is not any integer and thus we get a failure in the reading from the <code>scanf()</code> function so the input buffer is still active and if we press the next input as integer then it gets stored into variable <code>'b'</code>.</p>\n\n<p>Can you tell me the reason which I thought is correct or not?</p>\n\n<p>Now if it is correct then what will happen if I press again a character. Then also it should not get stored into the variable <code>'b'</code> but this time 0 gets stored into variable <code>'b'</code>.</p>\n\n<p>So my question is that what is the reason for proper behavior of the program when I'm trying to make the same program with <code>%d</code></p>\n"}, {"tags": ["c", "arrays", "pointers", "scanf"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451505015, "post_id": 34536228, "comment_id": 56814135, "body": "You could do with checking the return value from <code>sscanf</code>"}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451505409, "post_id": 34536228, "comment_id": 56814348, "body": "<code>sscanf</code>returns the right number of words for each line, but you&#39;re right, I should still check. But still, why is &amp;parameters[i].command of type &#39;unsigned char **&#39;. Where did the second pointer come from?"}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "edited": false, "score": 0, "creation_date": 1451505522, "post_id": 34536228, "comment_id": 56814397, "body": "If I use <code>parameters[i].command</code> without the &amp; the program crashes during sscanf after compiling."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451505546, "post_id": 34536228, "comment_id": 56814406, "body": "Argument 3 is not <code>%s</code>, it is <code>%d</code>. Did you post the question right? You say it works perfectly, but &quot;ends up with&quot; that, but it&#39;s compiler warning, surely? So why run the code?"}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "edited": false, "score": 0, "creation_date": 1451505978, "post_id": 34536228, "comment_id": 56814596, "body": "Yes, I did post the question right. I get the same warning for argument 2, which actually is <code>%d</code> as well. So I have to allocate memory for each pointer in the array? How would I do this correctly?"}], "answers": [{"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1451505581, "post_id": 34536373, "comment_id": 56814422, "body": "Perhaps change the format string in the <code>sscanf</code> so that the buffer does not overrun"}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "edited": false, "score": 0, "creation_date": 1451506496, "post_id": 34536373, "comment_id": 56814833, "body": "Thank you for your long post. This is a project I share with two other guys and sadly I can&#39;t change the type of command_t. Also command_t is guaranteed to be between 2 - max. 30 characters. If I wanted to use your second approach and use <code>malloc</code>, where would I have to allocate the memory for <code>parameters[i].command</code>? Before sscanf?"}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "edited": false, "score": 0, "creation_date": 1451507567, "post_id": 34536373, "comment_id": 56815409, "body": "Okay, so I tried the following:                                                                <code>while(fgets(line, sizeof(line), fp) != 0) {     parameters[i].befehl = malloc(sizeof(unsigned char));     sscanf(line, &quot;%s %d %d&quot;,parameters[i].befehl,&amp;parameters[i].p1,&amp;parameters[i].p2&zwnj;&#8203;);     i++;     printf(&quot;\\n %s&quot;, parameters[i].befehl);     }</code>                                                                                                                 But sscanf still crashes. Where did I go wrong? Do I have to allocate memory for the whole array?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1451507635, "post_id": 34536373, "comment_id": 56815448, "body": "<code>malloc(sizeof(unsigned char))</code> allocates memory to hold only one character. Use something like <code>malloc(100)</code>."}, {"owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "edited": false, "score": 0, "creation_date": 1451507808, "post_id": 34536373, "comment_id": 56815557, "body": "Damn, this did it. Didn&#39;t think far enough, thank you so much :)"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451507915, "post_id": 34536373, "comment_id": 56815630, "body": "And the technique not to overrun the buffer and do not to use <code>free</code> somewhere down the line"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1451516980, "post_id": 34536373, "comment_id": 56819558, "body": "If you&#39;re using POSIX 2008 or later, you can use the <code>m</code> modifer to get scanf to malloc the memory for you: <code>sscanf(line, &quot;%ms%d%d&quot;, &amp;parameters[i].command,</code>...  In this case you want the <code>&amp;</code> as scanf expects a pointer to a pointer."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 1, "last_activity_date": 1451505667, "last_edit_date": 1451505667, "creation_date": 1451505516, "answer_id": 34536373, "question_id": 34536228, "link": "https://stackoverflow.com/questions/34536228/sscanf-to-array-of-struct/34536373#34536373", "title": "sscanf to array of struct", "body": "<p>I see couple of errors with the program -- one syntactic and one semantic.</p>\n\n<p>The syntax error can be fixed by using:</p>\n\n<pre><code>sscanf(line, \"%s %d %d\", parameters[i].command, &amp;parameters[i].p1, &amp;parameters[i].p2);\n//                      ^^ Remove the &amp;\n</code></pre>\n\n<p>However, the greater problem is that you haven't allocated any memory for <code>parameters[i].command</code> before reading data into it.</p>\n\n<p>There are couple of ways to solve the problem.</p>\n\n<ol>\n<li>Make command a fixed size array.</li>\n<li>Allocate memory for command by using <code>malloc</code>.</li>\n</ol>\n\n<p>If you are going to use some hard coded number for the size of the array, I suggest using the first approach. Then, you don't have to worry about memory allocation and deallcation.</p>\n\n<p>Change </p>\n\n<pre><code>typedef unsigned char* command_t;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>typedef unsigned char command_t[100]; // Make it large enough for your need.\n</code></pre>\n\n<p>Make sure to prevent reading into command more characters that it can hold.</p>\n\n<pre><code>sscanf(line, \"%99s %d %d\", parameters[i].command, &amp;parameters[i].p1, &amp;parameters[i].p2);\n//             ^^ Specify the maximum number of characters to read\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5731855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ba62f36d367f29395ead4832b4271c2?s=128&d=identicon&r=PG&f=1", "display_name": "The Handler", "link": "https://stackoverflow.com/users/5731855/the-handler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2345, "favorite_count": 0, "accepted_answer_id": 34536373, "answer_count": 1, "score": 2, "last_activity_date": 1451505667, "creation_date": 1451504922, "question_id": 34536228, "link": "https://stackoverflow.com/questions/34536228/sscanf-to-array-of-struct", "title": "sscanf to array of struct", "body": "<p>I'm trying to use sscanf to copy a line of formatted text into an array of structs.</p>\n\n<p>Now this works perfectly, but I end up getting this warning:</p>\n\n<p>Format '%s' expects argument of type 'char *', but argument 3 has type 'unsigned char **'.</p>\n\n<p>These are the typedefs I want to use:</p>\n\n<pre><code> typedef unsigned char* command_t;\n typedef struct {\n    command_t command;\n    int p1;\n    int p2;\n} parameters_t;\n</code></pre>\n\n<p>And this is the relevant part of the code: </p>\n\n<pre><code>    paramters_t parameters[100];\n\n    while(fgets(line, sizeof(line), fp) != 0) {\n      sscanf(line, \"%s %d %d\",&amp;parameters[i].command,&amp;parameters[i].p1,&amp;parameters[i].p2);\n      i++;\n    }\n</code></pre>\n\n<p>So how come &amp;parameters[i].command is a double pointer?\nAny explanation is greatly appreciated! </p>\n"}, {"tags": ["c", "struct", "core-audio"], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 4539349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10153090868819066/picture?type=large", "display_name": "Alexander Bollbach", "link": "https://stackoverflow.com/users/4539349/alexander-bollbach"}, "edited": false, "score": 0, "creation_date": 1451504803, "post_id": 34536145, "comment_id": 56814037, "body": "that gets the same error.  What is weird is i could easily say `MyAUGraphPlayer player = { 0 }&#39; in a function and its fine but simply trying to make that play a globally declared constant leads to this error."}, {"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "reply_to_user": {"reputation": 639, "user_id": 4539349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10153090868819066/picture?type=large", "display_name": "Alexander Bollbach", "link": "https://stackoverflow.com/users/4539349/alexander-bollbach"}, "edited": false, "score": 0, "creation_date": 1451504971, "post_id": 34536145, "comment_id": 56814115, "body": "@AlexanderBollbach Sorry, I didn\u2019t think properly about your problem. Answer updated..."}], "tags": [], "owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "is_accepted": false, "score": 1, "last_activity_date": 1451504956, "last_edit_date": 1451504956, "creation_date": 1451504630, "answer_id": 34536145, "question_id": 34536081, "link": "https://stackoverflow.com/questions/34536081/accessing-a-struct-as-a-global-var-in-a-m-file/34536145#34536145", "title": "Accessing a Struct as a Global Var in a .m file", "body": "<p>You can only initialise a variable when you first declare it. By the time your method gets called it\u2019s already to late for initialisation.</p>\n\n<p>What you are trying to do here is interpreted as an assignment by the compiler (only a <code>=</code> after the declaration is an initialisation!) \u2013 and the right hand value is a block here. This is what leads to a compiler error. </p>\n\n<p>You\u2019ll have to do it by hand (or not all).</p>\n"}, {"comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1451506078, "post_id": 34536245, "comment_id": 56814636, "body": "<code>player = (MyAUGraphPlayer) { 0 }</code> is an assignment and not initialisation, but never mind."}], "tags": [], "owner": {"reputation": 26765, "user_id": 1218876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679708c15794f000fd74726531235442?s=128&d=identicon&r=PG", "display_name": "Kurt Revis", "link": "https://stackoverflow.com/users/1218876/kurt-revis"}, "is_accepted": true, "score": 2, "last_activity_date": 1451509019, "last_edit_date": 1451509019, "creation_date": 1451504973, "answer_id": 34536245, "question_id": 34536081, "link": "https://stackoverflow.com/questions/34536081/accessing-a-struct-as-a-global-var-in-a-m-file/34536245#34536245", "title": "Accessing a Struct as a Global Var in a .m file", "body": "<p>First: <code>player</code> is not a global variable. It is an instance variable (ivar) of <code>SpeechGraph</code>.</p>\n\n<p>Second: In modern Objective-C, instance variables are initialized to 0 in newly <code>alloc</code>ed objects, by default. There is no need to set this value to 0 again. See <a href=\"https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithObjects/WorkingwithObjects.html#//apple_ref/doc/uid/TP40011210-CH4-SW7\" rel=\"nofollow\">Programming With Objective-C</a>, \"Working with Objects\", \"Objects Are Created Dynamically\".</p>\n\n<p>Third: If you really need to set the value, <code>player = (MyAUGraphPlayer) { 0 };</code> should work. (This is an assignment, not an initialization. <a href=\"https://gustedt.wordpress.com/2010/12/12/assignment-and-initialization/\" rel=\"nofollow\">More about the difference.</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 639, "user_id": 4539349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10153090868819066/picture?type=large", "display_name": "Alexander Bollbach", "link": "https://stackoverflow.com/users/4539349/alexander-bollbach"}, "edited": false, "score": 0, "creation_date": 1451505399, "post_id": 34536282, "comment_id": 56814342, "body": "is memset necessary?  I recall something about structs having all their fields &#39;zeroed&#39; out if they are declared locally and not zeroed out if they are a class member variable?  If that is the case than memset is called for, no?"}, {"owner": {"reputation": 4455, "user_id": 1313967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msDex.jpg?s=128&g=1", "display_name": "dave234", "link": "https://stackoverflow.com/users/1313967/dave234"}, "reply_to_user": {"reputation": 639, "user_id": 4539349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10153090868819066/picture?type=large", "display_name": "Alexander Bollbach", "link": "https://stackoverflow.com/users/4539349/alexander-bollbach"}, "edited": false, "score": 0, "creation_date": 1451505699, "post_id": 34536282, "comment_id": 56814476, "body": "I think objective c objects&#39; ivars have all of their bits zeroed out when they&#39;re initialized.  Local variables definitely do not.  I personally just initialize everything all the time either way, just to be safe."}], "tags": [], "owner": {"reputation": 4455, "user_id": 1313967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/msDex.jpg?s=128&g=1", "display_name": "dave234", "link": "https://stackoverflow.com/users/1313967/dave234"}, "is_accepted": false, "score": 0, "last_activity_date": 1451505117, "creation_date": 1451505117, "answer_id": 34536282, "question_id": 34536081, "link": "https://stackoverflow.com/questions/34536081/accessing-a-struct-as-a-global-var-in-a-m-file/34536282#34536282", "title": "Accessing a Struct as a Global Var in a .m file", "body": "<p>I think you can only initialize a struct that way when declaring it. </p>\n\n<blockquote>\n  <p>MyAUGraphPlayer player = { 0 };</p>\n</blockquote>\n\n<p>In your case you should use memset like this.</p>\n\n<blockquote>\n  <p>memset(&amp;player,0,sizeof(MyAUGraphPlayer));</p>\n</blockquote>\n"}], "owner": {"reputation": 639, "user_id": 4539349, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10153090868819066/picture?type=large", "display_name": "Alexander Bollbach", "link": "https://stackoverflow.com/users/4539349/alexander-bollbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 34536245, "answer_count": 3, "score": 1, "last_activity_date": 1451509019, "creation_date": 1451504343, "last_edit_date": 1451508389, "question_id": 34536081, "link": "https://stackoverflow.com/questions/34536081/accessing-a-struct-as-a-global-var-in-a-m-file", "title": "Accessing a Struct as a Global Var in a .m file", "body": "<p>I have a struct that contains pointers to values that must be used in several functions throughout my class.  I typedef defined the type in the header,</p>\n\n<pre><code>typedef struct MyAUGraphPlayer {\n    AUGraph graph;\n    AudioUnit speechAU;\n } MyAUGraphPlayer;\n</code></pre>\n\n<p>and declared it in the .m,</p>\n\n<pre><code>@implementation SpeechGraph {\n    MyAUGraphPlayer player;\n}\n</code></pre>\n\n<p>However when trying to initialize it, I get the error `Unexpected expression' from this code (the error is on the line player = ...)</p>\n\n<pre><code>- (void)setup { \n   player = { 0 };\n   CreateMyAUGraph(&amp;player);\n}\n</code></pre>\n\n<p>The player variable is recognized as a MyAUGraph type but doing the conventional { 0 } assignment leads to a compile-time error.  </p>\n\n<p>I have built this Core-Audio code fine in a command line project but now I'm attempting to build a UI around it and apparently some of the mixing between the C core stuff and object oriented stuff is causing some confusion for me.  I would greatly appreciate some help.</p>\n"}, {"tags": ["c", "inet-ntop"], "answers": [{"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 3, "last_activity_date": 1451502673, "creation_date": 1451502673, "answer_id": 34535679, "question_id": 34535611, "link": "https://stackoverflow.com/questions/34535611/inet-ntop-repeatedly-looping-ip/34535679#34535679", "title": "inet_ntop repeatedly looping IP", "body": "<p>There's a bug in your code causing this.</p>\n\n<pre><code>for(result = host_list; result != NULL; result = host_list-&gt;ai_next)\n</code></pre>\n\n<p>needs to be</p>\n\n<pre><code>for(result = host_list; result != NULL; result = result-&gt;ai_next)\n</code></pre>\n\n<p>Your <code>freeaddrinfo(result)</code> also must be changed to <code>freeaddrinfo(host_list)</code></p>\n"}], "owner": {"reputation": 158, "user_id": 4301771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d2a1242f69afc90351bb662f8c51bc0?s=128&d=identicon&r=PG&f=1", "display_name": "dlismore", "link": "https://stackoverflow.com/users/4301771/dlismore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 34535679, "answer_count": 1, "score": 2, "last_activity_date": 1451502673, "creation_date": 1451502388, "question_id": 34535611, "link": "https://stackoverflow.com/questions/34535611/inet-ntop-repeatedly-looping-ip", "title": "inet_ntop repeatedly looping IP", "body": "<p>I'm trying to build a tool to gather information about IP addresses based on domain names. I've been using inet_ntop to achieve this and is generally working quite well for most domains. When I try it on sites like google.com or amazon.com the same IP address seems to get printed repeatedly. </p>\n\n<p>Example Output:\n Host: google.com\n IPv4: 54.239.17.6\n IPv4: 54.239.17.6\n IPv4: 54.239.17.6\n IPv4: 54.239.17.6\n IPv4: 54.239.17.6\n IPv4: 54.239.17.6\n ....</p>\n\n<p>I was wondering if anyone has experienced this, am I doing something wrong or is this something to do with how the sites are configured.</p>\n\n<pre><code>error = getaddrinfo(domain, \"80\", &amp;host_info, &amp;host_list);\n        // if error exists exit gracefully\n        if(error != 0)\n        {\n            print_conn_err(error);\n            return EXIT_FAILURE;\n        }\n        // print the domain string array\n        printf(\"Host: %s\\n\", domain);\n        // print IP addresses relating to domain name\n        printf(\"IP Address(s):\\n\");\n            for(result = host_list; result != NULL; result = host_list-&gt;ai_next)\n        {\n            void * address;\n            char * ip_version;\n            // if result is IPv4 address\n            if(result-&gt;ai_family == AF_INET)\n            {\n                struct sockaddr_in * ipv4 = (struct sockaddr_in *)result-&gt;ai_addr;\n                address = &amp;(ipv4-&gt;sin_addr);\n                ip_version = \"IPv4\";\n            }\n            else if(result-&gt;ai_family == AF_INET6)\n            {\n                struct sockaddr_in6 * ipv6 = (struct sockaddr_in6 *)result-&gt;ai_addr;\n                address = &amp;(ipv6-&gt;sin6_addr);\n                ip_version = \"IPv6\";\n            }\n            else\n            {\n                printf(\"%s\", \"Not a valid IP addresses \\n.\");\n                return EXIT_FAILURE;\n            }\n            // convert the IP to a string and print it:\n            inet_ntop(result-&gt;ai_family, address, ip_address, sizeof ip_address);\n            printf(\"  %s: %s\\n\", ip_version, ip_address);\n        }\n        freeaddrinfo(result);\n</code></pre>\n\n<p>One idea I thought of was to check the current IP with the previous IP and break the loop. This seems like quite a hacky solution though. </p>\n"}, {"tags": ["c", "arrays", "pointers", "struct", "scanf"], "comments": [{"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1451502188, "post_id": 34535523, "comment_id": 56812790, "body": "Safe or portable? Which is your question about?  Both? They are not exactly the same thing.  Nonportable constructs can be perfectly safe. (Safe here, not safe over there.)"}, {"owner": {"reputation": 41, "user_id": 5731774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e82ae438dfe3fd437d7ae8980622d94?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/5731774/some-guy"}, "reply_to_user": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1451502264, "post_id": 34535523, "comment_id": 56812834, "body": "Both. How safe and how portable it is."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1451502334, "post_id": 34535523, "comment_id": 56812865, "body": "Alignment is implementation defined, so there may be padding bytes."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451502478, "post_id": 34535523, "comment_id": 56812927, "body": "Looks like a security failure: passing a format string unchecked, not using <code>const</code> qualifier, relying on a specific layout&amp;endianess, wildly casting types (what is your problem with automatic type checking?). If some co-worker gave me such code, it would be high time for a serious talk."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1451502637, "post_id": 34535523, "comment_id": 56812989, "body": "Vector types like ones defined in <code>arm_neon.h</code> has a well defined structure and (I believe) is safe for this use, because it has well defined relationship to an array equivalent. I guess this should also be the case fro gcc vector extensions."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1451502792, "post_id": 34535523, "comment_id": 56813061, "body": "@user3528438: OP asks about standard compliance and portability. Additionally, that is not a machine-specific type, but a <code>struct</code> without any such guarantees."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451502912, "post_id": 34535523, "comment_id": 56813120, "body": "Just out of curiosity: how do you think a format-string for the given <code>struct</code> would look like? You only pass one argument to <code>scanf</code>, but have to read two values. This is an XY-problem. You might want to checkout nanopb or similar (de)serialisation libraries (or write your own)."}, {"owner": {"reputation": 41, "user_id": 5731774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e82ae438dfe3fd437d7ae8980622d94?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/5731774/some-guy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451503290, "post_id": 34535523, "comment_id": 56813307, "body": "@Olaf format string would be <code>%f</code>, and it would be scanned <code>n</code> times."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451504347, "post_id": 34535523, "comment_id": 56813847, "body": "@SomeGuy: You should provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Anyway, my clear advice will not change: this is awful code, hard to maintain and eror-prone at best. It also is not portable at least. If it invokes UB may be discussed, but not the other issues. In short: <b>do not</b>! Use proper (de)serialisation, that is an XY-problem with a much better solution (see nanopb for a better approach)."}, {"owner": {"reputation": 10605, "user_id": 2476755, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pXGb5.png?s=128&g=1", "display_name": "royhowie", "link": "https://stackoverflow.com/users/2476755/royhowie"}, "edited": false, "score": 0, "creation_date": 1451507696, "post_id": 34535523, "comment_id": 56815501, "body": "Definitely the weirdest code formatting I&#39;ve seen this week."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 10605, "user_id": 2476755, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pXGb5.png?s=128&g=1", "display_name": "royhowie", "link": "https://stackoverflow.com/users/2476755/royhowie"}, "edited": false, "score": 0, "creation_date": 1451510600, "post_id": 34535523, "comment_id": 56816950, "body": "@royhowie: It is fitting for the semantics;-{. But you should see more code, if you really think this is very bad. Welcome to the Coding Style Horror Show."}], "answers": [{"comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451502567, "post_id": 34535623, "comment_id": 56812958, "body": "I thought every pointer type can be converted to <code>char*</code>? I am more worried about <code>scanf</code> writing to a <code>char*</code> ."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451502648, "post_id": 34535623, "comment_id": 56812998, "body": "While I agree this is terrible code, I&#39;m not sure if it really is UB if the scanned data matches the type of the original pointer (yet I have no idea how a proper format string would look like), Can you elaborate? (No discussion this code is a no-go)"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451502696, "post_id": 34535623, "comment_id": 56813021, "body": "@cad: maybe it can (I think so, but <code>void</code> was introduced into the language, among other things, because of conversion problems). The issue is a <code>char *</code>inside the scanf to access objects of type <code>struct V2f</code>."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451502769, "post_id": 34535623, "comment_id": 56813050, "body": "So you mean that what I mentioned that <code>scanf</code> writes to a <code>float</code> through a <code>char*</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451502779, "post_id": 34535623, "comment_id": 56813055, "body": "Yes, any pointer to an object type can be converted to <code>char *</code>.  The result of such a conversion is well-defined (C2011 6.3.2.3/7).  One could perhaps argue that converting through an intermediate <code>void *</code> makes it problematic, but I&#39;m inclined to reject that interpretation."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1451502997, "post_id": 34535623, "comment_id": 56813159, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p28\" rel=\"nofollow noreferrer\">C2011 6.2.5p28</a> does not specify compatability between pointers to struct and pointers to char."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1451503265, "post_id": 34535623, "comment_id": 56813292, "body": "@cad: As I would refuse code like that IRL, I&#39;m actually curious about the chain of proof this is <b>technically</b> UB. I think this might even be <b>technically</b> allowed. There are just too many definition holes in the standard when it comes to <code>void *</code> and <code>char *</code>. So I try to view the original object&#39;s type and what <code>scanf</code> actually reads. That&#39;s why I&#39;m very much interested in the format string for the given <code>struct</code>. It&#39;s more a matter of <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p6\" rel=\"nofollow noreferrer\">6.5p6</a>."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 1, "last_activity_date": 1451502460, "creation_date": 1451502460, "answer_id": 34535623, "question_id": 34535523, "link": "https://stackoverflow.com/questions/34535523/is-it-safe-to-scan-a-struct-of-n-members-of-same-type-as-an-array/34535623#34535623", "title": "Is it safe to scan a struct of N members of same type as an array?", "body": "<p>Not safe, not portable: conversion from <code>struct V2f *</code> to <code>void *</code> and then to <code>char *</code> invokes Undefined Behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5731774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e82ae438dfe3fd437d7ae8980622d94?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/5731774/some-guy"}, "edited": false, "score": 0, "creation_date": 1451503679, "post_id": 34535815, "comment_id": 56813495, "body": "But floats are 32-bit wide, not 16-bit wide. So no padding, right? Or at least, no padding on 99% of devices?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 41, "user_id": 5731774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e82ae438dfe3fd437d7ae8980622d94?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/5731774/some-guy"}, "edited": false, "score": 0, "creation_date": 1451524210, "post_id": 34535815, "comment_id": 56821556, "body": "48 bit machine with 32 bit floats"}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": true, "score": 3, "last_activity_date": 1451503248, "creation_date": 1451503248, "answer_id": 34535815, "question_id": 34535523, "link": "https://stackoverflow.com/questions/34535523/is-it-safe-to-scan-a-struct-of-n-members-of-same-type-as-an-array/34535815#34535815", "title": "Is it safe to scan a struct of N members of same type as an array?", "body": "<p>Generally speaking, this is not safe or portable:</p>\n\n<blockquote>\n  <h3>C.11 6.7.2.1 Structure and union specifiers</h3>\n  \n  <ol start=\"14\">\n  <li>Each non-bit-field member of a structure or union object is aligned in an implementation defined\n  manner appropriate to its type.</li>\n  <li>Within a structure object, the non-bit-field members and the units in which bit-fields\n  reside have addresses that increase in the order in which they are declared. ... There may be unnamed\n  padding within a structure object, but not at its beginning.</li>\n  </ol>\n</blockquote>\n\n<p>A given implementation may decide that for structures, every other float should be 16 bits away from the previous float, while for arrays it leaves them contiguous.</p>\n\n<p>The more portable solution would be to just pass in the addresses, either as an array, or variable arguments:</p>\n\n<pre><code>bool scan_addr_array (void *addrs[], size_t N, const char *fmt);\nbool scan_addr_va (const char *fmt, ... /* NULL terminated */);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5731774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e82ae438dfe3fd437d7ae8980622d94?s=128&d=identicon&r=PG&f=1", "display_name": "Some Guy", "link": "https://stackoverflow.com/users/5731774/some-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34535815, "answer_count": 2, "score": 2, "last_activity_date": 1451503248, "creation_date": 1451502005, "question_id": 34535523, "link": "https://stackoverflow.com/questions/34535523/is-it-safe-to-scan-a-struct-of-n-members-of-same-type-as-an-array", "title": "Is it safe to scan a struct of N members of same type as an array?", "body": "<p>I have this struct:</p>\n\n<pre><code>typedef struct V2f {\n    float x, y; } V2f;\n</code></pre>\n\n<p>On my machine (64-bit Lubuntu 15.10) I can scan it using this function without any problems:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\nbool scan_struct_as_arr(void *dst, int n, size_t sz, char *format) {\n    for(int i = 0; i &lt; n; ++i) {\n        if(!scanf(format, (char *) dst + i * sz)) {\n            fputs(\"Failed to scan struct as an array\", stderr);\n            return false; } }\n    return true; }\n</code></pre>\n\n<p>How much is this behaviour portable and why?</p>\n\n<p>Could one trust this code if only variables of size 4 or 8 are used?</p>\n"}, {"tags": ["c", "math", "floating-point", "floating-accuracy"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451501396, "post_id": 34535278, "comment_id": 56812374, "body": "If you want accuracy, ditch <code>float</code> and move to <code>double</code> asap, or even <code>long double</code> if your compiler supports 80-bit real number representation."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451501628, "post_id": 34535278, "comment_id": 56812489, "body": "That is not a realistic option for performance reasons, all intermediate computation must occur at the &quot;native precision&quot; of the input and result. I&#39;ll edit that requirement into the question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451501742, "post_id": 34535278, "comment_id": 56812558, "body": "<code>double</code> is more native than <code>float</code>, which is now only suitable for some very restricted systems like embedded."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451501886, "post_id": 34535278, "comment_id": 56812627, "body": "Your question is &quot;most accurate way&quot; so I suggest you cut to the chase and not have to go through your tests all over again."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1451502028, "post_id": 34535278, "comment_id": 56812713, "body": "By &quot;native&quot; I meant &quot;the same type as used in the function prototype&quot;. There are commonly used platforms (GPUs) where <code>float</code> operations can have <i>significantly</i> higher throughput than <code>double</code> operations, and on many platform including x86 with AVX there is no convenient way to use any type wider than <code>double</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451502083, "post_id": 34535278, "comment_id": 56812738, "body": "So you <i>can</i> use <code>double</code> for better accuracy."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451502171, "post_id": 34535278, "comment_id": 56812784, "body": "@WeatherVane &quot;Most accurate&quot; under the constraints I outlined. I have clarified the question with regard to the use of higher precision in intermediate computations, what other clarifications do you think would be needed."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451502329, "post_id": 34535278, "comment_id": 56812864, "body": "Yes, all platforms I am considering do have <code>double</code> support but it may be up to 32x slower than <code>float</code>, so not practical given the need for high performance. In addition I am using the <code>float</code> version as an experimental platform for the <code>double</code> version, and there is no hardware support for any higher precision beyond <code>double</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451502517, "post_id": 34535278, "comment_id": 56812938, "body": "Please make your mind up. Do you want <code>double</code> or do you want <code>float</code>? Do you want <i>speed</i> or do you want <i>accuracy</i>? You said, in the question, before moving to <code>double</code>. My first comment stands."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1451502692, "post_id": 34535278, "comment_id": 56813019, "body": "I want the best accuracy <i>under the constraints stated</i>, that is, without totally screwing performance. The question as written is about the <code>float</code> case, but I am intending to re-use the same algorithm for <code>double</code> later, as I mentioned at the start of the question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451513917, "post_id": 34535278, "comment_id": 56818430, "body": "My assessment of your <code>my_asinhf()</code> using <code>#if !USE_RECIPROCAL</code> is also worst case error of about 1 <a href=\"https://en.wikipedia.org/wiki/Unit_in_the_last_place\" rel=\"nofollow noreferrer\">ULP</a> at <code>a == 7.517228127e-01</code> and an average error of 1/8 ULP.  I do not think a <i>more</i> accurate answer is feasible with approaches used.  Perhaps a <a href=\"https://en.wikipedia.org/wiki/Minimax_approximation_algorithm\" rel=\"nofollow noreferrer\">Minimax</a> polynomial?"}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1451514618, "post_id": 34535278, "comment_id": 56818738, "body": "A minimax polynomial is certainly a possibility I considered, and is my usual &quot;plan B&quot; for such issues. But before I go there, I wanted to check whether I am missing something regarding possible re-arrangements of the arithmetic. For example, is there an arrangement where either a <code>sqrt</code> or <code>rsqrt</code> (a contracting operation) is used late, rather than early in the computation? Can FMA be used more effectively than it currently is to improve accuracy? Is there a way to implement <code>sqrt1pm1</code> that would help accuracy (I have no practical experience with that function)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451514690, "post_id": 34535278, "comment_id": 56818763, "body": "I&#39;m unclear on the value of accuracy versus speed. May I surmise correctly that you want maximum ULP error about 0.5-0.6-ish and better speed performance, using your posted solution as the function to beat?  Or do you want 2x+ speed and allowing a couple up to 2.0 ULP ?"}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1451515332, "post_id": 34535278, "comment_id": 56819024, "body": "Ideally I would like to retain the performance of my posted variants, but achieve better accuracy. I will take any accuracy improvement I can get, e.g. 0.2 ulp better than the current code. If a more accurate solution would require, say, a couple more FMAs, I could live with the performance impact. Conversely I am hoping someone can find a way to exploit a fast <code>rsqrt</code>. Getting to a faithfully-rounded implementation (&lt; 1 ulp) would be great. My current thinking is that shooting for any bound tighter than that would definitely mean negatively impacting performance, which I want to avoid."}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451600989, "post_id": 34535278, "comment_id": 56846760, "body": "@chux After spending considerable additional time researching this, the only solution I found that reduces the error further than my variant <code>#if !USE_RECIPROCAL</code> is to compute the input to <code>log1pf()</code> as a double-float <code>arg_hi, arg_lo</code>, then compute <code>asinh()</code> as  <code>fmaf (arg_lo, 1.0f&#47;(1.0f+arg_hi), log1pf (arg_hi))</code>. When using a correctly rounded <code>log1pf()</code> this reduces the error in <code>asinhf()</code> to 1 ulp. This is not practical from a performance perspective because it requires either higher precision or expensive double-float computation for the argument transformation."}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "edited": false, "score": 0, "creation_date": 1451624501, "post_id": 34535278, "comment_id": 56850122, "body": "Why the specific constraint that the implementation reduce computing <code>asinhf</code> to computing <code>log1pf</code>?"}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1451625787, "post_id": 34535278, "comment_id": 56850308, "body": "That is a very common way of computing <code>asinh()</code>, and happens to be the one I am currently exploring in detail. The attractiveness of such a general approach is that one can build implementations for various math functions from just a few building blocks, with inverse hyperbolic functions in particular being mapped back to <code>log1p()</code>. Since the difficult arguments for <code>asinh()</code> are all small, one could use a minimax polynomial for those, but that would be a yet another code branch (not advantageous if the goal is a vectorizable implementation), and worthy of a separate question."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451918913, "post_id": 34535278, "comment_id": 56932558, "body": "Are you familiar with <a href=\"http://perso.ens-lyon.fr/jean-michel.muller/Intro-to-TMD.htm\" rel=\"nofollow noreferrer\">Table Maker&#39;s Dilemma</a>?"}, {"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1451922772, "post_id": 34535278, "comment_id": 56934992, "body": "I am very much familiar with TMD, how does this figure into my question, though?"}], "answers": [{"comments": [{"owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "edited": false, "score": 0, "creation_date": 1451578968, "post_id": 34548547, "comment_id": 56839994, "body": "My question is about minimizing the error incurred <i>on top of</i> the error due to <code>log1pf()</code>. With a correctly rounded <code>log1pf()</code>, my two <code>asinhf()</code> variants have maximum error of 1.49486 and 1.50805 ulp, respectively. With a faithfully rounded <code>log1pf()</code> [max error of 0.88383 ulp], the error in <code>asinhf()</code> grows to 1.70243 / 1.72481 ulp. With your prosed variant used in conjunction with a correctly rounded <code>log1pf()</code> the maximum error in <code>asinhf()</code> is  1.54368 ulp, so <i>higher</i> than with either of my two current variants."}], "tags": [], "owner": {"reputation": 7214, "user_id": 392585, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5ac7b1da0f2e9107b5020f88023a15e5?s=128&d=identicon&r=PG", "display_name": "Simon Byrne", "link": "https://stackoverflow.com/users/392585/simon-byrne"}, "is_accepted": false, "score": 1, "last_activity_date": 1451576394, "creation_date": 1451576394, "answer_id": 34548547, "question_id": 34535278, "link": "https://stackoverflow.com/questions/34535278/most-accurate-way-to-compute-asinhf-from-log1pf/34548547#34548547", "title": "Most accurate way to compute asinhf() from log1pf()?", "body": "<p>Firstly, you may want to look into the accuracy and speed of your <code>log1pf</code> function: these can vary a bit between libms (I've found the OS X math functions to be fast, the glibc ones to be slower but typically correctly rounded).</p>\n\n<p>Openlibm, based on the BSD libm, which in turn is based on Sun's fdlibm, use multiple approaches by range, but the main bit is <a href=\"https://github.com/JuliaLang/openlibm/blob/5cd80c4b1c2e1ac5b95f44e76520f4d47f53e00a/src/s_asinhf.c#L46\" rel=\"nofollow\">the relation</a>:</p>\n\n<pre><code>t = x*x;\nw = log1pf(fabsf(x)+t/(one+sqrtf(one+t)));\n</code></pre>\n\n<p>You may also want to try compiling with the <code>-fno-math-errno</code> option, which disables  the old System V error codes for <code>sqrt</code> (IEEE-754 exceptions will still work).</p>\n"}, {"tags": [], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "is_accepted": true, "score": 1, "last_activity_date": 1451926213, "last_edit_date": 1451926213, "creation_date": 1451629471, "answer_id": 34554048, "question_id": 34535278, "link": "https://stackoverflow.com/questions/34535278/most-accurate-way-to-compute-asinhf-from-log1pf/34554048#34554048", "title": "Most accurate way to compute asinhf() from log1pf()?", "body": "<p>After various additional experiments, I have convinced myself that a simple argument transformation <em>that does not use higher precision than the argument and result</em> cannot achieve a tighter error bound than the one achieved by the first variant in the code I posted. </p>\n\n<p>Since my question is about minimizing the error for the argument transformation which is incurred in addition to the error in <code>log1pf()</code> itself, the most straightforward approach to use for <em>experimentation</em> is to utilize a correctly rounded implementation of that logarithm function. Note that a correctly-rounded implementation is highly unlikely to exist in the context of a high-performance environment. According to the works of J.-M. Muller et. al., to produce accurate single-precision results, x86 extended precision computation should be sufficient, for example</p>\n\n<pre><code>float accurate_log1pf (float a)\n{\n    float res;\n    __asm fldln2;\n    __asm fld     dword ptr [a];\n    __asm fyl2xp1;\n    __asm fst     dword ptr [res];\n    __asm fcompp;\n    return res;\n}\n</code></pre>\n\n<p>An implementation of <code>asinhf()</code> using the first variant from my question then looks as follows:</p>\n\n<pre><code>float my_asinhf (float a)\n{\n    float fa, s, t;\n    fa = fabsf (a);\n    if (fa &gt;= 0x1.0p64f) { // prevent overflow in intermediate computation\n        t = log1pf (fa) + 0x1.62e430p-1f; // log(2)\n    } else {\n        t = fmaf (fa / (1.0f + sqrtf (fmaf (fa, fa, 1.0f))), fa, fa);\n        t = accurate_log1pf (t);\n    }\n    return copysignf (t, a); // restore sign\n}\n</code></pre>\n\n<p>Testing with all 2<sup>32</sup> IEEE-754 single-precision operands shows that the maximum error of 1.49486070 ulp occurs at \u00b1<code>0x1.ff5022p-9</code> and there are 353,521,140 incorrectly rounded results. What happens if the entire argument transformation uses double-precision arithmetic? The code changes to</p>\n\n<pre><code>float my_asinhf (float a)\n{\n    float fa, s, t;\n    fa = fabsf (a);\n    if (fa &gt;= 0x1.0p64f) { // prevent overflow in intermediate computation\n        t = log1pf (fa) + 0x1.62e430p-1f; // log(2)\n    } else {\n        double tt = fa;\n        tt = fma (tt / (1.0 + sqrt (fma (tt, tt, 1.0))), tt, tt);\n        t = (float)tt;\n        t = accurate_log1pf (t);\n    }\n    return copysignf (t, a); // restore sign\n}\n</code></pre>\n\n<p>However, the error bound does not improve with this change! The maximum error of 1.49486070 ulp still occurs at \u00b1<code>0x1.ff5022p-9</code> and there are now 350,971,046 incorrectly rounded results, slightly fewer than before. The issue seems to be that a <code>float</code> operand cannot convey enough information to <code>log1pf()</code> to produce more accurate results. A similar problem occurs when computing <code>sinf()</code> and <code>cosf()</code>. If the reduced argument, represented as a correctly rounded <code>float</code> operand, is passed to the core polynomials, the resulting error in <code>sinf()</code> and <code>cosf()</code> is just a tad under 1.5 ulp, just as we are observing here with <code>my_asinhf()</code>.</p>\n\n<p>One solution is to compute the transformed argument to higher than single precision, for example as a double-float operand pair (a useful brief overwiew of double-float techniques can be found in <a href=\"http://andrewthall.org/papers/df64_qf128.pdf\" rel=\"nofollow\">this paper by Andrew Thall</a>). In this case, we can use the additional information to perform linear interpolation on the result, based on the knowledge that the derivative of the logarithm is the reciprocal. This gives us:</p>\n\n<pre><code>float my_asinhf (float a)\n{\n    float fa, s, t;\n    fa = fabsf (a);\n    if (fa &gt;= 0x1.0p64f) { // prevent overflow in intermediate computation\n        t = log1pf (fa) + 0x1.62e430p-1f; // log(2)\n    } else {\n        double tt = fa;\n        tt = fma (tt / (1.0 + sqrt (fma (tt, tt, 1.0))), tt, tt);\n        t = (float)tt;                // \"head\" of double-float\n        s = (float)(tt - (double)t);  // \"tail\" of double-float\n        t = fmaf (s, 1.0f / (1.0f + t), accurate_log1pf (t)); // interpolate\n    }\n    return copysignf (t, a); // restore sign\n}\n</code></pre>\n\n<p>Exhaustive test of this version indicates that the maximum error has been reduced to 0.99999948 ulp, it occurs at \u00b1<code>0x1.deeea0p-22</code>. There are 349,653,534 incorrectly rounded results. A faithfully-rounded implementation of <code>asinhf()</code> has been achieved.</p>\n\n<p>Unfortunately, the practical utility of this result is limited. Depending on HW platform, the throughput of arithmetic operations on <code>double</code> may only be 1/2 to 1/32 of the throughput of <code>float</code> operations. The double-precision computation can be replaced with double-float computation, but this would incur very significant cost as well. Lastly, my approach here was to use the single-precision implementation as a proving ground for subsequent double-precision work, and many hardware platforms (certainly all the ones I am interested in) do not offer hardware support for a numeric format with higher precision than IEEE-754 <code>binary64</code> (double precision). Therefore any solution should not require higher-precision arithmetic in intermediate computation.</p>\n\n<p>Since all the troublesome arguments in the case of <code>asinhf()</code> are small in magnitude, one could [partially?] address the accuracy issue by using a polynomial minimax approximation for the region around the origin. As this would create another code branch, it would likely make vectorization more difficult.</p>\n"}], "owner": {"reputation": 19034, "user_id": 780717, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eead3a6ab011b880ca6ec354ca00f0b3?s=128&d=identicon&r=PG", "display_name": "njuffa", "link": "https://stackoverflow.com/users/780717/njuffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 34554048, "answer_count": 2, "score": 7, "last_activity_date": 1451926213, "creation_date": 1451500930, "last_edit_date": 1451590158, "question_id": 34535278, "link": "https://stackoverflow.com/questions/34535278/most-accurate-way-to-compute-asinhf-from-log1pf", "title": "Most accurate way to compute asinhf() from log1pf()?", "body": "<p>The inverse hyperbolic function <code>asinh()</code> is closely related to the natural logarithm. I am trying to determine the most accurate way to compute <code>asinh()</code> from the C99 standard math function <code>log1p()</code>. For ease of experimentation, I am limiting myself to IEEE-754 single-precision computation right now, that is I am looking at <code>asinhf()</code> and <code>log1pf()</code>. I intend to re-use the exact same algorithm for double precision computation, i.e. <code>asinh()</code> and <code>log1p()</code>, later.</p>\n\n<p>My primary goal is to minimize ulp error, the secondary goal is to minimize the number of incorrectly rounded results, under the constraint that the improved code would at most be minimally slower than the versions posted below. Any incremental improvement to accuracy, say 0.2 ulp, would be welcome. Adding a couple of FMAs (fused multiply-adds) would be fine, on the other hand I am hoping someone could identify a solution which employs a fast <code>rsqrtf()</code> (reciprocal square root). </p>\n\n<p>The resulting C99 code should lend itself to vectorization, possibly by some minor straightforward transformations. All intermediate computation <em>must</em> occur at the precision of the function argument and result, as any switch to higher precision may have a severe negative performance impact. The code must work correctly both with IEEE-754 denormal support and in FTZ (flush to zero) mode.</p>\n\n<p>So far, I have identified the following two candidate implementations. Note that the code may be easily transformed into a branchless vectorizable version with a single call to <code>log1pf()</code>, but I have not done so at this stage to avoid unnecessary obfuscation.</p>\n\n<pre><code>/* for a &gt;= 0, asinh(a) = log (a + sqrt (a*a+1))\n                        = log1p (a + (sqrt (a*a+1) - 1))\n                        = log1p (a + sqrt1pm1 (a*a))\n                        = log1p (a + (a*a / (1 + sqrt(a*a + 1))))\n                        = log1p (a + a * (a / (1 + sqrt(a*a + 1))))\n                        = log1p (fma (a / (1 + sqrt(a*a + 1)), a, a)\n                        = log1p (fma (1 / (1/a + sqrt(1/a*a + 1)), a, a)\n*/\nfloat my_asinhf (float a)\n{\n    float fa, t;\n    fa = fabsf (a);\n#if !USE_RECIPROCAL\n    if (fa &gt;= 0x1.0p64f) { // prevent overflow in intermediate computation\n        t = log1pf (fa) + 0x1.62e430p-1f; // log(2)\n    } else {\n        t = fmaf (fa / (1.0f + sqrtf (fmaf (fa, fa, 1.0f))), fa, fa);\n        t = log1pf (t);\n    }\n#else // USE_RECIPROCAL\n    if (fa &gt; 0x1.0p126f) { // prevent underflow in intermediate computation\n        t = log1pf (fa) + 0x1.62e430p-1f; // log(2)\n    } else {\n        t = 1.0f / fa;\n        t = fmaf (1.0f / (t + sqrtf (fmaf (t, t, 1.0f))), fa, fa);\n        t = log1pf (t);\n    }\n#endif // USE_RECIPROCAL\n    return copysignf (t, a); // restore sign\n}\n</code></pre>\n\n<p>With a particular <code>log1pf()</code> implementation that is accurate to &lt; 0.6 ulps, I am observing the following error statistics when testing exhaustively across all 2<sup>32</sup> possible IEEE-754 single-precision inputs. When <code>USE_RECIPROCAL = 0</code>, the maximum error is 1.49486 ulp, and there are 353,587,822 incorrectly rounded results. With <code>USE_RECIPROCAL = 1</code>, the maximum error is 1.50805 ulp, and there are only 77,569,390 incorrectly rounded results. </p>\n\n<p>In terms of performance, the variant <code>USE_RECIPROCAL = 0</code> will be faster if reciprocals and full divisions take roughly the same amount of time, but the variant <code>USE_RECIPROCAL = 1</code> could be faster if very fast reciprocal support is available.</p>\n\n<p>Answers can assume that all basic arithmetic, including  FMA (fused multiply-add) is correctly rounded according to IEEE-754 round-to-nearest-or-even mode. <em>In addition</em>, faster, nearly correctly rounded, versions of reciprocal and <code>rsqrtf()</code> <em>may</em> be available, where \"nearly correctly rounded\" means the maximum ulp error will be limited to something like 0.53 ulps and the overwhelming majority of results, say > 95%, are correctly rounded. Basic arithmetic with directed roundings <em>may</em> be available at no additional cost to performance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1451500070, "post_id": 34535022, "comment_id": 56811762, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1451500321, "post_id": 34535022, "comment_id": 56811860, "body": "In fact, it reports any odd number as prime."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451500384, "post_id": 34535022, "comment_id": 56811888, "body": "You have to test <i>all</i> the divisors before you can report it as prime, not just the first divisor."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451500516, "post_id": 34535022, "comment_id": 56811949, "body": "My <a href=\"http://stackoverflow.com/questions/34455888/prime-numbers-in-c-language/34456837#34456837\">previous answer</a> which shows two different methods."}, {"owner": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1451500552, "post_id": 34535022, "comment_id": 56811962, "body": "Take out the second else statement and only report prime if it gets all the way through the loop."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1451501828, "post_id": 34535022, "comment_id": 56812600, "body": "@new_programmer  Take into account that you marked a bad code as the best answer.:)"}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1451500481, "last_edit_date": 1451500481, "creation_date": 1451500145, "answer_id": 34535074, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number/34535074#34535074", "title": "Bug in C program written to check prime number", "body": "<p>Remove the <code>else</code> part from <code>for</code> and put these lines after the loop  </p>\n\n<pre><code>if( i == number/2)\n    printf(\"The given number %d is a prime number \\n\",number);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451500783, "post_id": 34535150, "comment_id": 56812062, "body": "The <code>else</code> part not necessary, since you already set <code>isPrime = true</code>"}], "tags": [], "owner": {"reputation": 1875, "user_id": 5057191, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d3a861c87b46363f63080839bbc699f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. E", "link": "https://stackoverflow.com/users/5057191/mr-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1451503243, "last_edit_date": 1451503243, "creation_date": 1451500422, "answer_id": 34535150, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number/34535150#34535150", "title": "Bug in C program written to check prime number", "body": "<p>You should use a flag to know when it's a prime number (Or it will break as soon as it test a single number that's not divisor of <code>number</code>)</p>\n\n<pre><code>bool isPrime = true;\nfor(i=2;i&lt;number/2;i++){\n    if(number%i==0)\n    {\n      isPrime = false;\n      break;\n    }\n}\nif (isPrime){\n    printf(\"The given number %d is a prime number \\n\",number);\n}\nelse {\n    printf(\"The given number %d is not a prime number \\n\",number);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 4585201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cab6e9e5524e6a3394f4ac92c1adb7ad?s=128&d=identicon&r=PG&f=1", "display_name": "Rajnish", "link": "https://stackoverflow.com/users/4585201/rajnish"}, "is_accepted": false, "score": 0, "last_activity_date": 1451501151, "creation_date": 1451501151, "answer_id": 34535326, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number/34535326#34535326", "title": "Bug in C program written to check prime number", "body": "<blockquote>\n  <p>This code has lot of problems</p>\n</blockquote>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n  int number,i;\n  printf(\"Enter the number to be checked\\n\");\n  scanf(\"%d\",&amp;number);\n  for(i=2;i&lt;number/2;i++){\n    if(number%i==0)\n    {\n      printf(\"The given number %d is not a prime number \\n\",number);\n      break;\n    }\n    else\n    {\n      printf(\"The given number %d is a prime number \\n\",number);\n      break;\n    }\n  }\n  return 0; \n}\n</code></pre>\n\n<p>Say you entered 5, so it enterd <code>for loop first iteration i=2</code> </p>\n\n<p><code>if(number%i==0)</code> i.e <code>5%2==0</code> which is obviously <strong>false</strong> now your code goes to <code>else</code> condition and <code>print</code> and <code>break</code></p>\n\n<blockquote>\n  <p>So what this break do is, it stops execution of innermost loop, as u have only one loop your execution stops and hence you get wrong answer not just for multiples of 5 but for many other inputs.</p>\n  \n  <blockquote>\n    <p><code>else</code> condition should not be inside loop</p>\n  </blockquote>\n</blockquote>\n\n<p><strong>A simple code would be</strong></p>\n\n<pre><code> #include &lt;stdio.h&gt;\n    int main()\n    {\n      int n, i, flag=0;\n      printf(\"Enter a positive integer: \");\n      scanf(\"%d\",&amp;n);\n      for(i=2;i&lt;=n/2;++i)\n      {\n          if(n%i==0)\n          {\n              flag=1;\n              break;\n          }\n      }\n      if (flag==0)\n          printf(\"%d is a prime number.\",n);\n      else\n          printf(\"%d is not a prime number.\",n);\n      return 0;\n    }\n</code></pre>\n\n<blockquote>\n  <p><strong>You should learn how to use if-else conditioning and use of break statements</strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451503001, "post_id": 34535418, "comment_id": 56813163, "body": "@chqrlie It is a typo that the initial value of i was 2. As for the scanf then there is no need to check the result because number is initialized by 0."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451503600, "post_id": 34535418, "comment_id": 56813454, "body": "<i>&quot;no need to check the result [of <code>scanf</code>]&quot;</i> is poor advice for beginners."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451503705, "post_id": 34535418, "comment_id": 56813507, "body": "@WeatherVane In my opinion it is a very good advice for a beginner.:)  When he will learn scanf in detail he can use some other approach. There is no any need to make the program more complicated."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451503901, "post_id": 34535418, "comment_id": 56813608, "body": "Start as you mean to continue."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451504047, "post_id": 34535418, "comment_id": 56813685, "body": "@WeatherVane Among presented here programs my program is the best.:) Nobody can write such clear code as me, unemployeed.:)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451508462, "post_id": 34535418, "comment_id": 56815907, "body": "Your <i>perfect</i> code fails for prime number <code>4294967291</code>. It prints <code>The given number 4294967291 is not a prime number</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451510228, "post_id": 34535418, "comment_id": 56816781, "body": "@chqrlie 4294967291 is not valid object of type unsigned int. If it is very important to you to check the valid input you can to complicate the code of the input. But it has nothing common with the code that determinates whether a number is prime."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451510444, "post_id": 34535418, "comment_id": 56816884, "body": "@VladfromMoscow:  You must be kidding, <code>4294967291</code>, in hex <code>0xfffffffb</code> is a perfectly valid 32 bit <code>unsigned int</code>... I&#39;m assuming your machine <code>int</code> has at least 32 bits <code>;-)</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451512298, "post_id": 34535418, "comment_id": 56817706, "body": "@chqrlie Oh, I forgot that it is unsigned int. I refered to INT_MAX.:)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451539046, "post_id": 34535418, "comment_id": 56824797, "body": "@VladfromMoscow: yes, the problem is integer overflow, <code>4294967291</code> is larger than the largest 32 bit square. Using a division is much slower. There is a clever method for a single test for all <code>unsigned int</code> values:  <code>i * i - 1 &lt; x</code>."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1451512252, "last_edit_date": 1451512252, "creation_date": 1451501591, "answer_id": 34535418, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number/34535418#34535418", "title": "Bug in C program written to check prime number", "body": "<p>There are several bugs in the program.</p>\n\n<p>The first one is that you do not check whether the entered number is positive. So if the user will enter a negative number the program will report nothing.</p>\n\n<p>The second bug is that if the user will enter 1, 2, 3, or 4 then the program again will report nothing.</p>\n\n<p>The third bug is that you exit the loop after its first iteration.</p>\n\n<p>Take into account that according to the C Standard function main without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>The program can look the following way</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    unsigned int number = 0;\n\n    printf(\"Enter the number to be checked: \");\n    scanf( \"%u\", &amp;number );\n\n\n    int prime = number == 2 || ( number % 2 &amp;&amp; number != 1 );\n\n    for ( unsigned int i = 3; prime &amp;&amp; i &lt;= number / i; i += 2 )\n    {\n        prime = number % i;\n    }\n\n    if ( prime )\n    {\n        printf( \"The given number %u is a prime number \\n\", number );\n    }\n    else\n    {\n        printf( \"The given number %u is not a prime number \\n\", number );\n    }\n\n    return 0; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 0, "last_activity_date": 1451503059, "creation_date": 1451503059, "answer_id": 34535762, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number/34535762#34535762", "title": "Bug in C program written to check prime number", "body": "<p>So, a couple of things...</p>\n\n<p>The main problem is that you're breaking out of your loop early whether the number is divisible by <code>i</code> or not:</p>\n\n<pre><code>if ( num % i == 0 )\n  break;\nelse\n  break;\n</code></pre>\n\n<p>You only want to break out of the loop early if the number is evenly divisible by <code>i</code>; otherwise, you check the against the next value of <code>i</code>:</p>\n\n<pre><code>for ( i = 2 ; i &lt; number/2; i++ )\n{\n  if ( num % i == 0 )\n    break;\n}\n</code></pre>\n\n<p>After the loop, check to see if <code>i</code> is less than <code>number / 2</code>; if it is, then <code>number</code> is not prime:</p>\n\n<pre><code>if ( i &lt; number / 2 )\n  // number is not prime\nelse\n  // number is prime\n</code></pre>\n\n<p>There are a couple of ways you can speed up your primality test.  First of all, you only need to test up to the square root of <code>number</code>, rather than <code>number / 2</code>.  Secondly, you can eliminate checks against even numbers; if a number is divisible by <code>2</code>, then it's divisible by any even number, so you only need to check against <code>2</code> once.  In code:</p>\n\n<pre><code>int prime = 0; // initially false\n\nif ( number == 2 ) // 2 is a special case, check separately\n{\n  prime = 1;\n}\nelse if ( number &lt; 2 || number % 2 == 0 )\n{\n  prime = 0; // negative numbers, 0, 1, and even numbers are not prime\n}\nelse\n{\n  prime = 1; // assume prime to begin with\n  for ( int i = 3; prime &amp;&amp; i * i &lt; number; i += 2 ) // continue while prime is true\n  {                                                  // and i is less than sqrt(number)\n    prime = number % i;\n  }\n}\n\nprintf( \"%d is%s prime\\n\", number, prime ? \"\" : \" not\" ); \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5731729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63aa6bd655ecbaf3ab24399de3cddcc7?s=128&d=identicon&r=PG&f=1", "display_name": "new_programmer", "link": "https://stackoverflow.com/users/5731729/new-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 34535762, "answer_count": 5, "score": -1, "last_activity_date": 1451512252, "creation_date": 1451499935, "last_edit_date": 1451502402, "question_id": 34535022, "link": "https://stackoverflow.com/questions/34535022/bug-in-c-program-written-to-check-prime-number", "title": "Bug in C program written to check prime number", "body": "<p>I have written following program to check if given number is prime or not. But somehow program gives multiples of 5 like 15,25 as prime numbers. Where is bug? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int number, i;\n\n    printf(\"Enter the number to be checked\\n\");\n    scanf(\"%d\", &amp;number);\n    for (i = 2; i &lt; number / 2; i++) {\n        if (number % i == 0) {\n            printf(\"The given number %d is not a prime number \\n\", number);\n            break;\n        } else {\n            printf(\"The given number %d is a prime number \\n\", number);\n            break;\n        }\n    }\n    return 0; \n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2012", "warnings"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1451499341, "post_id": 34534852, "comment_id": 56811435, "body": "<code>%d</code> expects an <code>int</code> argument. To print a pointer use <code>%p</code>. Please read the man-page of <code>printf</code> or search for &quot;printf format string&quot;!"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 8, "last_activity_date": 1451499338, "creation_date": 1451499338, "answer_id": 34534882, "question_id": 34534852, "link": "https://stackoverflow.com/questions/34534852/warning-c4477-in-visual-studio-2015/34534882#34534882", "title": "Warning C4477 in Visual Studio 2015", "body": "<p>Because you are using incorrect format specifier. <code>%d</code> is to print an <code>int</code>. To print pointers use <code>%p</code> and cast to <code>void*</code>:</p>\n\n<pre><code>printf(\"Address of num: %p Value: %d\\n\", (void*)&amp;num, num);\nprintf(\"Address of pi: %p Value: %p\\n\", (void*)&amp;pi, (void*)pi);\n</code></pre>\n\n<p>The cast to <code>void*</code> is needed because variadic functions don't do any type conversions from <code>type *</code> to <code>void *</code> as required for <code>%p</code>. Quoting the standard:</p>\n\n<p><em>7.21.6 Formatted input/output functions (C11 draft)</em></p>\n\n<blockquote>\n  <p>p The argument shall be a pointer to void. The value of the pointer is\n  converted to a sequence of printing characters, in an\n  implementation-defined manner.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 251, "user_id": 5491857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8LRRv.png?s=128&g=1", "display_name": "Henri Socha", "link": "https://stackoverflow.com/users/5491857/henri-socha"}, "is_accepted": false, "score": 1, "last_activity_date": 1485821869, "creation_date": 1485821869, "answer_id": 41947722, "question_id": 34534852, "link": "https://stackoverflow.com/questions/34534852/warning-c4477-in-visual-studio-2015/41947722#41947722", "title": "Warning C4477 in Visual Studio 2015", "body": "<p>Said another way, your argument &amp;num (or in the form (void *) &amp;num) is telling the compiler that you wish to pass in to the function the address of num, not the value of num. The printf function with it's %d format specifier is expected a value, not an address. The complaint is the compiler realizing this difference.</p>\n\n<p>Note: in the 32 bit work, an address and an int are both 32 bits and so things (i.e. the %d) would just work. But, in the 64 bit world, an int is still 32 bits long but an address is 64 bits. I.E. you can't accurately represent the value of the pointer with a %d. That's why %p got created. It (the compiler) is smart enough to handle a %p parameter as a 32 bit quantity when compiled for 32 bits and a 64 bit quantity when compiled for 64 bits.</p>\n\n<p>Read up on computer architecture, hardware stacks and their bit sizes. While you're at it you may also wish to understand the difference between little endian and big endian.</p>\n"}], "owner": {"reputation": 170, "user_id": 3970215, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/52f435adcbf4b73dbf24bca03ceb2dec?s=128&d=identicon&r=PG&f=1", "display_name": "Adonaim", "link": "https://stackoverflow.com/users/3970215/adonaim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14105, "favorite_count": 0, "accepted_answer_id": 34534882, "answer_count": 2, "score": 2, "last_activity_date": 1485821869, "creation_date": 1451499166, "last_edit_date": 1463074139, "question_id": 34534852, "link": "https://stackoverflow.com/questions/34534852/warning-c4477-in-visual-studio-2015", "title": "Warning C4477 in Visual Studio 2015", "body": "<p>When I compile the following code, Visual studio shows warning of C4477. Why this warning generated by visual studio? And How can I fix this code?</p>\n\n<p>warning : warning C4477: 'printf' : format string '%d' requires an argument of type 'int', but variadic argument 1 has type 'int *'</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int num = 0;\n    int *pi = &amp;num;\n\n    printf(\"Address of num: %d Value: %d\\n\", &amp;num, num);\n    printf(\"Address of pi: %d Value: %d\\n\", &amp;pi, pi);\n\n    return 0x0;\n}\n</code></pre>\n"}, {"tags": ["c", "ipc", "shared-memory"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451498939, "post_id": 34534683, "comment_id": 56811265, "body": "1) There is no &quot;array of <code>struct</code>&quot;. You have a pointer to pointer to <code>struct</code>, but likely want a &quot;pointer to <code>struct</code>&quot; according to your title. 2) Do not cast the result of <code>malloc</code> &amp; friends in C. 3) Not sure, but if <code>val</code> is the shared array, why do you set the pointers to &quot;private&quot; memory? 4) You apparently have problems with the multiple indirection in various places."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451499185, "post_id": 34534833, "comment_id": 56811362, "body": "Maybe one should add that <code>malloc</code> never provides shared memory, but only private."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451581632, "post_id": 34534833, "comment_id": 56841038, "body": "Clarified that <code>malloc()</code> allocates only private memory."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1451581559, "last_edit_date": 1451581559, "creation_date": 1451499061, "answer_id": 34534833, "question_id": 34534683, "link": "https://stackoverflow.com/questions/34534683/shared-memory-with-array-of-structs/34534833#34534833", "title": "Shared memory with array of structs", "body": "<p>You want to share the <code>struct</code>s between processes, but instead you are sharing only <em>pointers</em> to structs.  If those pointed to <code>struct</code>s that were allocated and initialized before the fork then they would be valid in both processes, but would point to different copies of the <code>struct</code>s (<code>malloc()</code> allocates only private memory, never shared).  As it is, however, the pointers are only valid in the child, which is the one performing the <code>malloc()</code>.</p>\n\n<p>So, instead of an array of pointers, allocate an array of structs:</p>\n\n<pre><code>val_t *val;\n\n/* ... */\n\nsize = sizeof(val_t) * LEN;\n\n/* ... */\n\nval = (val_t *) shmat(shmid, 0, 0);\n</code></pre>\n\n<p>If you do it this way, moreover, there is no need to <code>malloc()</code> (or <code>free()</code>) individual <code>struct</code>s.</p>\n"}, {"tags": [], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "is_accepted": false, "score": 1, "last_activity_date": 1451502714, "last_edit_date": 1451502714, "creation_date": 1451501862, "answer_id": 34535480, "question_id": 34534683, "link": "https://stackoverflow.com/questions/34534683/shared-memory-with-array-of-structs/34535480#34535480", "title": "Shared memory with array of structs", "body": "<p>In,</p>\n\n<pre><code>val = (val_t **) shmat(shmid, 0, 0);\n</code></pre>\n\n<p><code>val</code> points to an array of type <code>val_t*</code> in shared memory. This <em>can</em> be accessed in another process that attaches to the same shared memory segment.</p>\n\n<p>But in,</p>\n\n<pre><code>val[i] = (val_t *) malloc(sizeof(val_t));\n</code></pre>\n\n<p><code>val[i]</code> points to memory allocated by <code>malloc()</code> which is private to a process. This pointer <em>cannot</em> be accessed in a different process. Hence the <code>Segmentation fault</code> when you do this in the child process.</p>\n\n<pre><code>val[0]-&gt;val = 3;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1451503283, "creation_date": 1451503283, "answer_id": 34535822, "question_id": 34534683, "link": "https://stackoverflow.com/questions/34534683/shared-memory-with-array-of-structs/34535822#34535822", "title": "Shared memory with array of structs", "body": "<p>The problem is that you're not sharing an array of structs, you're sharing an array of pointers to structs, and those pointers point into non-shared memory you allocate with malloc.  You want code more like:</p>\n\n<pre><code>val_t   *val;\nsize = sizeof(val_t) * LEN;\n\nif (fork() == 0) {\n    if ((shmid = shmget(key, size, IPC_CREAT | IPC_EXCL | 0666)) == -1) {\n        perror(\"shmget\");\n        exit(1); }\n\n    val = (val_t *) shmat(shmid, 0, 0);\n    if (val == (val_t *)(-1)) {\n        perror(\"shmat\");\n        exit(1); }\n\n    for (i = 0; i &lt; LEN; i++) {\n        val[i].val = i; }\n</code></pre>\n\n<p>That is, use an array of structs, rather than an array of pointers to structs.</p>\n\n<p>Note that this will only work as long as your structs (and thus your shared memory) <em>never</em> have any pointers in them -- even if the pointers were to point at shared memory, it might be at different addresses in the different processes.</p>\n"}], "owner": {"reputation": 77, "user_id": 5726436, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1a87991abf916274cadb1a4dd4c8652?s=128&d=identicon&r=PG&f=1", "display_name": "Damian H", "link": "https://stackoverflow.com/users/5726436/damian-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4038, "favorite_count": 0, "accepted_answer_id": 34535822, "answer_count": 3, "score": 0, "last_activity_date": 1451581559, "creation_date": 1451498409, "question_id": 34534683, "link": "https://stackoverflow.com/questions/34534683/shared-memory-with-array-of-structs", "title": "Shared memory with array of structs", "body": "<p>I'm using an array of structs for share data between two process. The program after 3 secs raise an <code>Segmentation fault</code> error, when I try to access to the shared memory into the parent process. Why the data is not correctly shared?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n\n#define LEN     3\n\ntypedef struct {\n    int val;\n} val_t;\n\nint\nmain (int argc, char *argv[])\n{\n    key_t   key;\n    int     shmid, i, size;\n    val_t   **val;\n\n    if ((key = ftok(argv[0], 'D')) == -1) {\n        perror(\"ftok\");\n        exit(1);\n    }\n\n    size = sizeof(val_t *) * LEN;\n\n    if (fork() == 0) {\n        if ((shmid = shmget(key, size, IPC_CREAT | IPC_EXCL | 0666)) == -1) {\n            perror(\"shmget\");\n            exit(1);\n        }\n\n        val = (val_t **) shmat(shmid, 0, 0);\n        if (val == (val_t **)(-1)) {\n            perror(\"shmat\");\n            exit(1);\n        }\n\n        for (i = 0; i &lt; LEN; i++) {\n            val[i] = (val_t *) malloc(sizeof(val_t));\n            val[i]-&gt;val = i;\n        }\n\n        while (val[0]-&gt;val != 3)\n            sleep(1);\n\n        if (shmdt(val) == -1) {\n            perror(\"shmdt\");\n            exit(1);\n        }\n        shmctl(shmid, IPC_RMID, NULL);\n    }\n    else {\n        sleep(3);\n\n         if ((shmid = shmget(key, size, IPC_EXCL)) == -1) {\n            perror(\"shmget\");\n            exit(1);\n        }\n\n        val = (val_t **) shmat(shmid, 0, 0);\n        if (val == (val_t **)(-1)) {\n            perror(\"shmat\");\n            exit(1);\n        }\n\n        printf(\"%d\\n\", val[0]-&gt;val);\n        val[0]-&gt;val = 3;\n\n        if (shmdt(val) == -1) {\n            perror(\"shmdt\");\n            exit(1);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "visual-studio", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451497516, "post_id": 34534344, "comment_id": 56810496, "body": "A pointer is no an array (and vice versa)."}], "answers": [{"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 1, "last_activity_date": 1451497193, "creation_date": 1451497193, "answer_id": 34534387, "question_id": 34534344, "link": "https://stackoverflow.com/questions/34534344/creating-array-of-structures-in-c/34534387#34534387", "title": "creating array of structures in c", "body": "<pre><code>abc *t;\n</code></pre>\n\n<p>here <code>t</code> is a pointer and it is not initialized. To initialize it:</p>\n\n<pre><code>scanf(\"%d\", &amp;stru);\nt = malloc(stru * sizeof *t)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5728292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf1de9ca2af1008811f01ac2c95d0633?s=128&d=identicon&r=PG&f=1", "display_name": "tal889", "link": "https://stackoverflow.com/users/5728292/tal889"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 34534387, "answer_count": 1, "score": -1, "last_activity_date": 1451497193, "creation_date": 1451497037, "question_id": 34534344, "link": "https://stackoverflow.com/questions/34534344/creating-array-of-structures-in-c", "title": "creating array of structures in c", "body": "<p>i am tryaing to create an array of structures from an input i get\nlike if the user enter 5 \nso i need to bulid 5 structures and initializing them\nthis is my sturct in a header file</p>\n\n<pre><code>typedef struct abc\n {\npnt* head;\nint number;\nint number2;\nfloat sum;\n}abc;\n</code></pre>\n\n<p>and in my main file\ni put </p>\n\n<pre><code>abc *t;\n\n\nprintf_s(\"How many strucures?:\\n\");\nscanf_s(\"%d\", &amp;stru);\nfor (i = 0; i &lt; stru; i++)\n{\n    t[i].head = NULL;\n    t[i].number = 0;\n    t[i].number2 = i;\n    t[i].sum = 0;\n}\n</code></pre>\n\n<p>and i get \n\"uninitialized local variable 't' used\"</p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 4, "creation_date": 1451496774, "post_id": 34534221, "comment_id": 56810104, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc in C</a>"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1451496818, "post_id": 34534221, "comment_id": 56810133, "body": "Why are rows and columns floating-point variables!?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1451496880, "post_id": 34534221, "comment_id": 56810169, "body": "@cad Just in case he has a <b>really</b> big matrix. :)"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451496935, "post_id": 34534221, "comment_id": 56810205, "body": "@Barmar It could be a really <b><i>ragged</i></b> matrix."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451496967, "post_id": 34534221, "comment_id": 56810221, "body": "<code>if(matrix != NULL)</code> needs to take more drastic action than skipping the immediate code block and carrying on to use the <code>NULL</code> value <code>matrix</code>."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1451496984, "post_id": 34534221, "comment_id": 56810233, "body": "Where does it crash? Post the line number."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451497075, "post_id": 34534221, "comment_id": 56810288, "body": "There is no <i>matrix</i> (aka 2D array) in you code. And use spaces in you code!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451497086, "post_id": 34534221, "comment_id": 56810290, "body": "<code>computeDeterminant()</code> never frees all the memory that it allocates. And since you call it recursively, you may be running out of heap space for a large array."}], "answers": [{"tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 3, "last_activity_date": 1451499716, "last_edit_date": 1451499716, "creation_date": 1451496947, "answer_id": 34534323, "question_id": 34534221, "link": "https://stackoverflow.com/questions/34534221/matrix-segmentation-fault/34534323#34534323", "title": "Matrix Segmentation Fault", "body": "<p>You allocated <code>col=end; b[k]=(double*) calloc (col,sizeof (double));</code> but you accesed to <code>b[i][end]</code> in loop <code>for(j=start;j&lt;=end-1;j++){ b[i][j]=b[i][j+1]; }</code> in function. <code>computeDeterminant</code>. Either you set <code>col=end+1;</code> or you change <code>&lt;=</code> by <code>&lt;</code>.</p>\n\n<pre><code>if(matrix == NULL)\n    return 0.0;\n\nrow = end;\ncol = end;\ndouble ** b=(double **) malloc (row*sizeof (double*));\nfor(k=0; k&lt;row ;k++){\n    b[k]=(double*) calloc (col,sizeof (double));\n}\n\nfor(i=0;i&lt;end;i++){\n    for(j=0;j&lt;end;j++){    \n        b[i][j]=matrix[i][j];\n    }\n}\n\nfor(i=0;i&lt;end-1;i++){ // i&lt;end-1 bcause of i+1  \n    for(j=1;j&lt;end;j++){ // j&lt;end\n       b[i][j]=b[i+1][j];\n    }\n}\n\nfor(i=0;i&lt;end;i++){ // i&lt;end\n    for(j=start;j&lt;end-1;j++){ // j&lt;end-1 bcause of j+1\n        b[i][j]=b[i][j+1];\n    }\n}\n</code></pre>\n\n<p>Further you should free the memory you allocated for <code>b</code> in function <code>computeDeterminant</code></p>\n\n<pre><code>if (end-1==2){\n    s = b[1][1]*b[2][2]-b[1][2]*b[2][1];\n}\nelse{\n    for (j=0;j&lt;end-1;j++){\n        s=s+pw(1+j)*b[1][j]*computeDeterminant(end-1,j,b);\n    }\n}\n\nfor(k=0; k&lt;row ;k++){\n    free( b[k] );\n}\nfree(b);\n\nreturn s;\n</code></pre>\n\n<p>In function <code>sum</code> there is a similar problem:</p>\n\n<pre><code>double sum(int n,double **matrix)\n{\n    int j;\n    double s=0;\n\n    if(n&gt;2)\n    {\n        // for(j=1;j&lt;=n;j++) &lt;- change this\n        for(j=1;j&lt;n;j++)\n               //^\n            s=s+pw(1+j)*matrix[1][j]*computeDeterminant(n, j, matrix);\n        return s;\n    }\n    else\n        return matrix[1][1]*matrix[2][2]-matrix[1][2]*matrix[2][1];\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5306654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c737febe4da2c49777586a72970a6e9?s=128&d=identicon&r=PG&f=1", "display_name": "flama", "link": "https://stackoverflow.com/users/5306654/flama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 34534323, "answer_count": 1, "score": 3, "last_activity_date": 1451499716, "creation_date": 1451496562, "last_edit_date": 1451497111, "question_id": 34534221, "link": "https://stackoverflow.com/questions/34534221/matrix-segmentation-fault", "title": "Matrix Segmentation Fault", "body": "<p>I am trying to write a code that calculates the determinant for an nXn matrix.\nFor a 3x3 matrix the code works well, but on a 4X4 matrix or bigger the program crashes. \nCan you tell me what I am doing wrong?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ndouble sum(int n, double **matrix);\n\nint main(){\n\n    double row, col, size;\n\n    int i,j,k;\n\n    FILE *fd=fopen(\"input10.txt\",\"r\");\n\n    fscanf(fd,\"%lf\", &amp;size);\n\n    row = size;\n    col = size;\n\n        double ** matrix=(double **) malloc (row*sizeof (double*));\n\n        if(matrix != NULL){\n            for(k=0; k&lt;row ;k++){\n                matrix[k]=(double*) calloc (col,sizeof (double));\n        }\n    }\n\n\n    for(i=0; i&lt;row; i++){\n        for(j=0; j&lt;col; j++){\n            fscanf(fd,\"%lf\",&amp;matrix[i][j]);\n\n        }\n    }\n    printf(\"%.2le\",sum(size,matrix));  \n\n    return 0;\n}\n\ndouble computeDeterminant(unsigned char end, unsigned char start, double **matrix)\n{\n    int i,j,k;\n    double s=0;\n\n    double row, col;\n    row = end;\n    col = end;\n    double ** b=(double **) malloc (row*sizeof (double*));\n\n        if(matrix != NULL){\n            for(k=0; k&lt;row ;k++){\n                b[k]=(double*) calloc (col,sizeof (double));\n        }\n    }\n\n\n    for(i=0;i&lt;end;i++){\n        for(j=0;j&lt;end;j++){     \n            b[i][j]=matrix[i][j];\n        }\n    }\n\n    for(i=0;i&lt;end-1;i++){   \n        for(j=1;j&lt;=end;j++){\n            b[i][j]=b[i+1][j];\n        }\n    }\n\n\n    for(i=0;i&lt;end-1;i++){\n        for(j=start;j&lt;=end-1;j++){\n            b[i][j]=b[i][j+1];\n        }\n    }\n\n\n    if (end-1==2){\n        return b[1][1]*b[2][2]-b[1][2]*b[2][1];\n    }\n    else{\n        for (j=0;j&lt;end-1;j++){\n            s=s+pw(1+j)*b[1][j]*computeDeterminant(end-1,j,b);\n        }return s;\n    }\n}\n\ndouble sum(int n,double **matrix)\n{\n    int j;\n    double s=0;\n\n    if(n&gt;2)\n    {\n        for(j=1;j&lt;=n;j++)\n            s=s+pw(1+j)*matrix[1][j]*computeDeterminant(n, j, matrix);\n        return s;\n    }\n    else\n        return matrix[1][1]*matrix[2][2]-matrix[1][2]*matrix[2][1];\n}\n\nint pw(int y)\n{\n     return (y%2)==0?1:-1; \n}\n</code></pre>\n"}, {"tags": ["c", "linux", "linker", "sdl-2", "udev"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451496492, "post_id": 34534136, "comment_id": 56809964, "body": "If your program does not depend on anything in <code>libusb</code>, as your first example demonstrates, then why are you linking against that library?"}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451496612, "post_id": 34534136, "comment_id": 56810027, "body": "@JohnBollinger This is a minimal example, my actual project does need both libraries."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451498782, "post_id": 34534136, "comment_id": 56811192, "body": "@JohnBollinger Just FYI, -ludev is enough - seems that it&#39;s not -lusb that is to blame (but it does bring in udev on the way)."}, {"owner": {"reputation": 116, "user_id": 1638843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ec3cbb9cbd3d292c1abff8d93d1087?s=128&d=identicon&r=PG", "display_name": "kepstin", "link": "https://stackoverflow.com/users/1638843/kepstin"}, "edited": false, "score": 1, "creation_date": 1451500704, "post_id": 34534136, "comment_id": 56812025, "body": "Very strange, this looks like a very environment-specific problem. Based on the traceback you&#39;re using mesa - the &#39;loader_get_pci_id_for_fd&#39; function is the one that looks up which driver to pull in for your hardware. An interesting thing is that mesa actually uses dlopen() to load libudev.so; you need to check library paths to make sure it loaded the same one as you linked!"}], "answers": [{"comments": [{"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1451498310, "post_id": 34534599, "comment_id": 56810928, "body": "The -rpath stuff is just what I&#39;m getting from <code>pkg-config --libs</code>, but that&#39;s fairly standard for how things are packaged in NixOS. I&#39;ll look deeper into it though."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1451499044, "post_id": 34534599, "comment_id": 56811307, "body": "I&#39;ve simplified the GCC calls and the same still happens, so it at least doesn&#39;t seem to be how I calling <code>gcc</code>."}, {"owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "edited": false, "score": 0, "creation_date": 1451501001, "post_id": 34534599, "comment_id": 56812167, "body": "This answer pointed me in the right direction, and as @kepstin mentions - mesa uses dlopen to open udev. The real problem here is the environment I was building in was linking against a <i>different</i> udev from the systems currently running udev. If I link against exactly the same version as what is running, then all is well. I&#39;ll have to find a way to get my build environment set up correctly, but thank god we&#39;ve finally found the problem!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1451498055, "creation_date": 1451498055, "answer_id": 34534599, "question_id": 34534136, "link": "https://stackoverflow.com/questions/34534136/why-does-linking-against-both-sdl2-and-udev-cause-a-segmentation-fault/34534599#34534599", "title": "Why does linking against both sdl2 and udev cause a segmentation fault?", "body": "<p>If a program's behavior differs depending only on how it is linked, then that must result from different function implementations being [dynamically] linked in one case and the other.  Beyond that, to answer in any detail would require examining details of <em>all</em> the libraries involved.</p>\n\n<p>Nevertheless, at this point I am inclined to observe that you apparently are relying heavily on RPATHs, which is highly questionable.  It is especially questionable that you appear to be resolving the C standard library via RPATH (as is evident from the first line of your back trace) instead of using the system's version.</p>\n\n<p>It would be best to influence dynamic linking by configuring the dynamic linker, instead of by embedding RPATHs in your program or libraries.  If the objective is to use different libraries than the system's defaults, then you might find it useful to establish an alternative chroot environment in which your program could run.  Under all circumstances, be certain that the compiler, static linker, dynamic linker, all libraries on which your program relies, and the program itself all agree about which version of each library is to be used.</p>\n"}], "owner": {"reputation": 5992, "user_id": 74497, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0d4a7e6c8edd88e835508df8397592e5?s=128&d=identicon&r=PG", "display_name": "ocharles", "link": "https://stackoverflow.com/users/74497/ocharles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 34534599, "answer_count": 1, "score": 3, "last_activity_date": 1451499140, "creation_date": 1451496211, "last_edit_date": 1451499140, "question_id": 34534136, "link": "https://stackoverflow.com/questions/34534136/why-does-linking-against-both-sdl2-and-udev-cause-a-segmentation-fault", "title": "Why does linking against both sdl2 and udev cause a segmentation fault?", "body": "<p>I have the following really dumb C program:</p>\n\n<pre><code>#include &lt;SDL2/SDL.h&gt;\n\nint main () {\n  SDL_Init(SDL_INIT_VIDEO);\n}\n</code></pre>\n\n<p>If I compile it and link against <code>sdl2</code>, all is well:</p>\n\n<pre><code>[nix-shell:~/work/on-the-limit]$ gcc oddity.c -lSDL2 -o oddity\n\n[nix-shell:~/work/on-the-limit]$ ./oddity \n</code></pre>\n\n<p>However, if I also link against <code>udev</code>...</p>\n\n<pre><code>[nix-shell:~/work/on-the-limit]$ gcc oddity.c -lSDL2 -ludev -o oddity\n\n[nix-shell:~/work/on-the-limit]$ ./oddity \nSegmentation fault\n</code></pre>\n\n<p>... a segmentation fault happens.</p>\n\n<p><code>gdb</code> has the following to say:</p>\n\n<pre><code>[nix-shell:~/work/on-the-limit]$ gdb ./oddity \nGNU gdb (GDB) 7.10\nCopyright (C) 2015 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-unknown-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from ./oddity...done.\n(gdb) run\nStarting program: /home/ollie/work/on-the-limit/oddity \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/nix/store/npfsi1d9ka8zwnxzn3sr08hbwvpapyk7-glibc-2.21/lib/libthread_db.so.1\".\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff736b36a in strlen () from /nix/store/483br9kb3f5igsgmb6aqsjhl2ipj2bxr-glibc-2.21/lib/libc.so.6\n(gdb) bt\n#0  0x00007ffff736b36a in strlen () from /nix/store/483br9kb3f5igsgmb6aqsjhl2ipj2bxr-glibc-2.21/lib/libc.so.6\n#1  0x00007ffff7fbb54b in strpcpy () from /nix/store/m3k7v0cy7zh6qbjqhrxgd36p105qqf0q-systemd-217/lib/libudev.so.1\n#2  0x00007ffff7fbb6b3 in strscpy () from /nix/store/m3k7v0cy7zh6qbjqhrxgd36p105qqf0q-systemd-217/lib/libudev.so.1\n#3  0x00007ffff7fb8f3d in device_new_from_parent.isra.7.lto_priv () from /nix/store/m3k7v0cy7zh6qbjqhrxgd36p105qqf0q-systemd-217/lib/libudev.so.1\n#4  0x00007ffff7fb6140 in udev_device_get_parent () from /nix/store/m3k7v0cy7zh6qbjqhrxgd36p105qqf0q-systemd-217/lib/libudev.so.1\n#5  0x00007ffff4c9b85a in loader_get_pci_id_for_fd () from /run/opengl-driver/lib/libGL.so.1\n#6  0x00007ffff4c9be68 in loader_get_driver_for_fd () from /run/opengl-driver/lib/libGL.so.1\n#7  0x00007ffff4c95126 in dri2CreateScreen () from /run/opengl-driver/lib/libGL.so.1\n#8  0x00007ffff4c748d4 in __glXInitialize () from /run/opengl-driver/lib/libGL.so.1\n#9  0x00007ffff4c70c1b in GetGLXPrivScreenConfig.part.2 () from /run/opengl-driver/lib/libGL.so.1\n#10 0x00007ffff4c70d4d in glXChooseVisual () from /run/opengl-driver/lib/libGL.so.1\n#11 0x00007ffff7b92288 in X11_GL_LoadLibrary () from /nix/store/qcf0jg20x3fnb09p4xc1y5dsbz84m7h9-SDL2-2.0.3/lib/libSDL2-2.0.so.0\n#12 0x00007ffff7b89567 in SDL_CreateWindow_REAL () from /nix/store/qcf0jg20x3fnb09p4xc1y5dsbz84m7h9-SDL2-2.0.3/lib/libSDL2-2.0.so.0\n#13 0x00007ffff7b89180 in SDL_VideoInit_REAL () from /nix/store/qcf0jg20x3fnb09p4xc1y5dsbz84m7h9-SDL2-2.0.3/lib/libSDL2-2.0.so.0\n#14 0x00007ffff7ac8317 in SDL_Init_REAL () from /nix/store/qcf0jg20x3fnb09p4xc1y5dsbz84m7h9-SDL2-2.0.3/lib/libSDL2-2.0.so.0\n#15 0x00000000004008b6 in main () at oddity.c:4\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451496145, "post_id": 34534092, "comment_id": 56809775, "body": "Yes, it&#39;s a string. It&#39;s empty, since the first character is null."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1451496231, "post_id": 34534092, "comment_id": 56809831, "body": "In C, a &quot;string&quot; is a NUL-terminated array of characters. Does that help?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451497256, "post_id": 34534092, "comment_id": 56810373, "body": "C does not have a string type. And there is not output function called, so it doesn&#39;t print anything."}], "answers": [{"comments": [{"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451496367, "post_id": 34534121, "comment_id": 56809904, "body": "In C, global variables are initialized to zero. Nothing else is."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1451496423, "post_id": 34534121, "comment_id": 56809933, "body": "@ouah: Nips, I was thinking about static storage. My bad, will edit"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451496487, "post_id": 34534121, "comment_id": 56809962, "body": "<i>&quot; <code>str4</code> is an array of <code>char</code>s, so yes: it&#39;s a string&quot;</i> Being an array doesn&#39;t make it a string. It has to have the nul."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451499084, "post_id": 34534121, "comment_id": 56811323, "body": "@Turn Disagree with latter part of &quot;global variables are initialized to zero. <i>Nothing else is</i>&quot;.  <code>static</code> variables local to a function without an explicit initialization are initialized just like globals."}, {"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451499180, "post_id": 34534121, "comment_id": 56811357, "body": "Yeah, I knew someone would ding me on that. I consider them as global vars that are only accessible to the function where they are declared."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451555714, "post_id": 34534121, "comment_id": 56830581, "body": "@Turn: well, once allocated their storage duration is the same as a global, and perhaps optimization might even put them in the <code>bss</code> section. But that level of detail is far beyond the actual scope of the question anyway"}, {"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1451581113, "post_id": 34534121, "comment_id": 56840848, "body": "@EliasVanOotegem Agreed. But I meant even in terms of coding style, while occasionally they have good uses, their use is often a sign of something that could have been done in a cleaner manner."}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 2, "last_activity_date": 1451496520, "last_edit_date": 1451496520, "creation_date": 1451496151, "answer_id": 34534121, "question_id": 34534092, "link": "https://stackoverflow.com/questions/34534092/identification-is-that-a-string/34534121#34534121", "title": "Identification: Is that a string?", "body": "<p><code>str4</code> is an array of <code>char</code>'s, so yes: it can be a string. You're initializing it to <code>{0}</code>. This means the first element in the array is being initialized to a terminating nul character (the end of a string), the result being: <code>str4</code> is a valid, albeit empty, string. Implicitly, the rest of the array will be initialized to 0, too BTW.</p>\n\n<p>Printing this string is the same as printing an empty string:</p>\n\n<pre><code>printf(\"\");\n</code></pre>\n\n<p>The code you posted is <em>exactly</em> the same as this:</p>\n\n<pre><code>char str4[100] = \"\";\n//or this\nchar str4[100] = {0, 0, '\\0'};//'\\0' is the same as 0\n//or even\nchar str4[] = {0, 0, ..., 0};//100 0's is just a pain to write...\n</code></pre>\n\n<p>Or, in case of a global variable:</p>\n\n<pre><code>char str4[100];\n</code></pre>\n\n<p>simply because objects that have static storage are initialized to their nul-values (integer compatible types are initialized to 0, pointers to <code>NULL</code>):</p>\n\n<blockquote>\n  <p>If an object that has static storage duration is not initialized explicitly, it is initialized implicitly as if every member that has arithmetic type were assigned 0 and every member that has pointer type were assigned a null pointer constant.</p>\n</blockquote>\n\n<p>Either way, the short answer is: <strong><em><code>str4</code> is an empty string.</em></strong></p>\n"}, {"tags": [], "owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "is_accepted": false, "score": 1, "last_activity_date": 1451496401, "last_edit_date": 1451496401, "creation_date": 1451496193, "answer_id": 34534131, "question_id": 34534092, "link": "https://stackoverflow.com/questions/34534092/identification-is-that-a-string/34534131#34534131", "title": "Identification: Is that a string?", "body": "<p>In C a string is just an array of bytes that follows a particular convention, namely that the array of bytes be terminated by a null character. In this case, if you try to print <code>str4</code> with something like <code>printf</code>, you'll find it looks like an empty string because the first byte is a null character, terminating it immediately.</p>\n"}, {"tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 1, "last_activity_date": 1451496206, "creation_date": 1451496206, "answer_id": 34534133, "question_id": 34534092, "link": "https://stackoverflow.com/questions/34534092/identification-is-that-a-string/34534133#34534133", "title": "Identification: Is that a string?", "body": "<p>By definition in C a string is <em>a contiguous sequence of characters terminated by and including the first null character</em>.  So here you array also represents a string of length <code>0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1451498065, "last_edit_date": 1451498065, "creation_date": 1451496566, "answer_id": 34534223, "question_id": 34534092, "link": "https://stackoverflow.com/questions/34534092/identification-is-that-a-string/34534223#34534223", "title": "Identification: Is that a string?", "body": "<blockquote>\n  <p>I dont know if that a string or an array...</p>\n</blockquote>\n\n<p>It is definitely an array. It can also be a string since a string is an array of characters terminated by a null character in C.</p>\n\n<p>You can use it as an array:</p>\n\n<pre><code>char str4[100] = { 0 };\nstr4[0] = 'a';\n</code></pre>\n\n<p>You can also use it as a string:</p>\n\n<pre><code>if ( strcmp(str4, \"ABC\") == 0 )\n{\n   // This string contains \"ABC\"\n}\n</code></pre>\n\n<p><strong>When an array of characters is not a string</strong></p>\n\n<p>You can create an array of characters that cannot be used like a string.</p>\n\n<pre><code>char str[4] = { 'a', 'b', 'c', 'd' };\nif ( str[0] == 'a' ) // OK\n{\n   // Do something\n}\n\nif ( strcmp(str, \"ABC\") == 0 ) // Problem. str does not have a null character.\n                               // It cannot be used like a string.\n{\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5573870, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/57c42773dce8ea190a3c91a642581776?s=128&d=identicon&r=PG&f=1", "display_name": "Ruslan Ver", "link": "https://stackoverflow.com/users/5573870/ruslan-ver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1451498065, "creation_date": 1451496007, "last_edit_date": 1451496057, "question_id": 34534092, "link": "https://stackoverflow.com/questions/34534092/identification-is-that-a-string", "title": "Identification: Is that a string?", "body": "<p>I dont know if that a string or an array...</p>\n\n<pre><code>char str4[100] = { 0 };\n</code></pre>\n\n<p>That code is a string?</p>\n\n<p>If yes what it printing?</p>\n"}, {"tags": ["c", "tree"], "comments": [{"owner": {"reputation": 6455, "user_id": 2363967, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e456a6a8bd35a0e65c22d202b48ccfa4?s=128&d=identicon&r=PG", "display_name": "Andrew Williamson", "link": "https://stackoverflow.com/users/2363967/andrew-williamson"}, "edited": false, "score": 1, "creation_date": 1451495125, "post_id": 34533745, "comment_id": 56809222, "body": "Can you clarify the question please?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1451495754, "post_id": 34533745, "comment_id": 56809580, "body": "So traverse the tree with preorder traversal and connect. What&#39;s the problem?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451495941, "post_id": 34533745, "comment_id": 56809674, "body": "I&#39;m voting to close this question as off-topic because SO is no coding service."}, {"owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451501174, "post_id": 34533745, "comment_id": 56812248, "body": "@Olaf sir i totally understand your point,i don&#39;t have the code which i tried at that time else would have pasted it for correction."}, {"owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "reply_to_user": {"reputation": 6455, "user_id": 2363967, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e456a6a8bd35a0e65c22d202b48ccfa4?s=128&d=identicon&r=PG", "display_name": "Andrew Williamson", "link": "https://stackoverflow.com/users/2363967/andrew-williamson"}, "edited": false, "score": 0, "creation_date": 1451501288, "post_id": 34533745, "comment_id": 56812305, "body": "@AndrewWilliamson actually every node in the tree has an extra pointer namely &quot;next&quot;,in every node this pointer should point to its pre order predecessor. i.e if  1 2 3 4 is the preorder traversal  then 1&#39;s next should point to 2 and so on"}, {"owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451501596, "post_id": 34533745, "comment_id": 56812473, "body": "@EugeneSh. sorry sir but i&#39;m not able to figure out how to connect it ."}, {"owner": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451503905, "post_id": 34533745, "comment_id": 56813611, "body": "To clarify the question, please edit the question instead of posting comments. Especially fix this &quot;Pres order successor&quot;. To get an answer, please described what your idea was."}, {"owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "reply_to_user": {"reputation": 3448, "user_id": 5466118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5af41e2f2230c199ad274d363eda32?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Zabel", "link": "https://stackoverflow.com/users/5466118/martin-zabel"}, "edited": false, "score": 0, "creation_date": 1451509588, "post_id": 34533745, "comment_id": 56816484, "body": "@MartinZabel will keep your words in mind from next time"}, {"owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451509727, "post_id": 34533745, "comment_id": 56816557, "body": "thank you guys @Olaf,@Andrew Williamson,@EugeneSh,@Martin Zabel :)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451510405, "post_id": 34536620, "comment_id": 56816865, "body": "In general an iterative approach is preferable, as it has deterministic CPU stack behaviour. For this example you do not need a manual stack. If you reach a leave just move up the newly estaqblish up-link chain, provided the <code>next</code> (<code>up</code> would be a better name for tree-nodes) pointer is properly initialised to a <i>null pointer</i>). Anyway, the correct way is to set the parent-link when a node is inserted, not afterwards."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 0, "last_activity_date": 1451506513, "creation_date": 1451506513, "answer_id": 34536620, "question_id": 34533745, "link": "https://stackoverflow.com/questions/34533745/connect-preorder-predecessor-with-its-successor-in-a-binary-search-tree/34536620#34536620", "title": "Connect preorder predecessor with its successor in a binary search tree", "body": "<p>As Eugene said: <em>So traverse the tree with preorder traversal and connect.</em> To do that, you need to know which node, if any, you visited last.</p>\n\n<p>You can do that with the usual recursive approach by passing a reference to the previous node. This must be the address of a variable that is valid throughout the recursion, because the previous node is not necessarily closer to the root. You could use a global variable, but a variable created in a wrapper function may be better:</p>\n\n<pre><code>void connect_r(struct node *node, struct node **whence)\n{\n    if (node) {\n        if (*whence) (*whence)-&gt;next = node;\n        *whence = node;\n\n        connect_r(node-&gt;left, whence);\n        connect_r(node-&gt;right, whence);\n    }\n}\n\nvoid connect(struct node *head)\n{\n    struct node *p = NULL;\n\n    connect_r(head, &amp;p);\n    if (p) p-&gt;next = NULL;\n}\n</code></pre>\n\n<p>The pointer <code>p</code> in <code>connect</code>, whose address is passed to the recursive function <code>connect_r</code> holds the node whose <code>next</code> pointer should be updated next. The update doesn't happen on the first visited node. and the <code>next</code> member of the last visited node must explicitly be set to <code>NULL</code> after the recursion.</p>\n\n<p>Alternatively, you can connect the nodes iteratively by using a stack:</p>\n\n<pre><code>void connect(struct node *head)\n{\n    struct node *p = NULL;\n    struct node **prev = &amp;p;\n\n    struct node *stack[32];    // To do: Prevent overflow\n    size_t nstack = 0;\n\n    if (head) stack[nstack++] = head;\n\n    while (nstack) {\n        struct node *node = stack[--nstack];\n\n        *prev = node;\n        prev = &amp;node-&gt;next;\n\n        if (node-&gt;right) stack[nstack++] = node-&gt;right;\n        if (node-&gt;left) stack[nstack++] = node-&gt;left;\n    }\n\n    *prev = NULL;\n}\n</code></pre>\n\n<p>The connected <code>next</code> pointers are a snapshot of the current tree. Insertions, deletions and rearrangements of nodes will render the <code>next</code> chain invalid. (But it can be made valid again by calling <code>connect</code> provided that the tree's left and right links are consistent.)</p>\n"}], "owner": {"reputation": 13, "user_id": 3756147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ab47bef07340f0d53b6f8bbdcafcb0?s=128&d=identicon&r=PG", "display_name": "Saurabh Pandey", "link": "https://stackoverflow.com/users/3756147/saurabh-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 34536620, "answer_count": 1, "score": -1, "last_activity_date": 1451509438, "creation_date": 1451494675, "last_edit_date": 1451509438, "question_id": 34533745, "link": "https://stackoverflow.com/questions/34533745/connect-preorder-predecessor-with-its-successor-in-a-binary-search-tree", "title": "Connect preorder predecessor with its successor in a binary search tree", "body": "<p>Actually in an interview i was asked to write a code through which every node in a binary search tree is having a extra pointer namely \"next\" we have to connect this pointer  of every node to its pre order successor ,can any one suggest me the code as i was not able to do so. the tree nodes has above structure :-</p>\n\n<pre><code> struct node {\n        int data ;\n        struct node *left,*right;\n        struct node *next; //this pointer should point to pre order successor \n        };\n</code></pre>\n\n<p>thank you .</p>\n\n<p>Cracked the the solution thanks to you guys ,below is the whole code written in c :-</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node\n{\n        int data;\n        struct node *left,*right,*next;\n};\n\nstruct node* getNode(int data)\n{\n        struct node* temp=(struct node*)malloc(sizeof(struct node));\n        temp-&gt;left=temp-&gt;right=NULL;\n        temp-&gt;data=data;\n        return temp;\n}\n\nvoid insert(struct node**root,int data)\n{\n    if(!*root)\n    {\n        *root=(struct node*)malloc(sizeof(struct node));\n        (*root)-&gt;left=(*root)-&gt;right=NULL;\n        (*root)-&gt;data=data;\n    }\n    else if(data&lt;(*root)-&gt;data)\n        insert(&amp;((*root)-&gt;left),data);\n    else if(data&gt;(*root)-&gt;data)\n        insert(&amp;((*root)-&gt;right),data);\n}\n\nstruct node* preorderSuccessor(struct node* root,struct node* p)\n{\n    int top,i;\n    struct node *arr[20];\n    if(!root || !p)\n        return NULL;\n    if(p-&gt;left)\n        return p-&gt;left;\n    if(p-&gt;right)\n        return p-&gt;right;\n    top=-1;\n    while(root-&gt;data!=p-&gt;data)\n    {\n        arr[++top]=root;\n        if(p-&gt;data&lt;root-&gt;data)\n            root=root-&gt;left;\n        else\n            root=root-&gt;right;\n    }\n    for(i=top;i&gt;=0;i--)\n    {\n        if(arr[i]-&gt;right)\n        {\n            if(p!=arr[i]-&gt;right)\n                return arr[i]-&gt;right;\n        }\n        p=arr[i];\n    }\n    return NULL;\n\n}\n\nvoid connect(struct node* parent,struct node *r)\n{\n        if(r)\n        {       connect(parent ,r-&gt;left);    \n                r-&gt;next = preorderSuccessor(parent,r);\n                connect(parent,r-&gt;right);\n        }\n}\n\n\nint main()\n{\n        struct node* root=NULL,*temp=NULL;\n        int arr[]={10,11,2,3,9,8,4,5},size,i;\n        size=sizeof(arr)/sizeof(arr[0]);\n\n        for(i=0;i&lt;size;i++) \n          insert(&amp;root,arr[i]);\n        connect(root,root);\n        struct node *ptr = root;\n        while(ptr){\n          // -1 is printed if there is no successor\n          printf(\"Next of %d is %d \\n\", ptr-&gt;data, ptr-&gt;next? ptr-&gt;next-&gt;data: -1);\n          ptr = ptr-&gt;next;\n        }\n\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1451494510, "post_id": 34533681, "comment_id": 56808880, "body": "Isn&#39;t that what calling functions is all about? If you want to use <code>goto</code> so much you should consider old 1970&#39;s BASIC."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 4, "creation_date": 1451494632, "post_id": 34533681, "comment_id": 56808942, "body": "Why are you basically writing assembly in C? <b>Use functions.</b> If you have to access a lot of global state, put the relevant pieces in a structure, and pass a pointer to it to the functions.  If you mark the functions <code>static</code>, they may well be inlined, and effectively achieve what you&#39;re trying to do; but with the added benefit of not being a freaking unmaintainable disaster."}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1451494639, "post_id": 34533681, "comment_id": 56808946, "body": "@JoachimPileborg See what I said about function calls in my original post. Think of my &quot;SOMEWHERE&quot; code as a place when I work on not just y but many other variables. Passing each of them as arguments would be very inefficient."}, {"owner": {"reputation": 568, "user_id": 4157408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b6a712c8ad167e7331cef927d46a2?s=128&d=identicon&r=PG&f=1", "display_name": "void_ptr", "link": "https://stackoverflow.com/users/4157408/void-ptr"}, "edited": false, "score": 2, "creation_date": 1451494657, "post_id": 34533681, "comment_id": 56808953, "body": "Just make all your variables global, so that you can access them from anywhere. I mean, this design is already terrible. Can&#39;t make it much worse."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1451494696, "post_id": 34533681, "comment_id": 56808983, "body": "You do know about structures? One structure to collect all related variables, and then just pass the structure (or a pointer to it)."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451494735, "post_id": 34533681, "comment_id": 56809004, "body": "Which architecture? If x86, stop worrying about argument-passing inefficiencies."}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451494921, "post_id": 34533681, "comment_id": 56809096, "body": "Yes, this is very close to assembly as I am writing code for an embedded platform. I am staying close to low-level instructions available on my target architecture using intrinsics but going all the way to assembly would be overkill. Function calls with many arguments or a struct for all my variables would both be too inefficient. And using globals, well, that&#39;s quite a step further down in the &quot;terrible design&quot; route..."}, {"owner": {"reputation": 1952, "user_id": 1366211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/493108c081e68e071d26ead12a3918b1?s=128&d=identicon&r=PG", "display_name": "mittmemo", "link": "https://stackoverflow.com/users/1366211/mittmemo"}, "edited": false, "score": 0, "creation_date": 1451494964, "post_id": 34533681, "comment_id": 56809126, "body": "And what&#39;s your gripe with structs?"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451495044, "post_id": 34533681, "comment_id": 56809176, "body": "The gripe with structs is that accessing each variable in my structs is one more load. This quickly becomes too costly for the app I am writing where each cycle counts."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451495069, "post_id": 34533681, "comment_id": 56809191, "body": "A slightly less horrid approach might be to use macro&#39;s and an enum field in a loop. That would allow you to <i>&quot;simulate&quot;</i> the jumping back and forth without using functions. While I know you&#39;re on an embedded platform, the occasional function isn&#39;t always a bad thing. Perhaps consider using a struct instead of loose variables, and pass a single pointer as argument instead?"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451495191, "post_id": 34533681, "comment_id": 56809256, "body": "Yes, macro is yet another option. That one I can&#39;t do here because the SOMEWHERE code I jump to is pretty large and I need to jump to it from many places. Instruction cache misses start being an issue."}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 1, "creation_date": 1451495532, "post_id": 34533681, "comment_id": 56809440, "body": "Would love to hear why this question is down-voted by the way. The coding practice for high-level code and low-level embedded code, both of which I write regularly, are just not always the same once trying to write code that runs as efficiently as possible."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1451495667, "post_id": 34533681, "comment_id": 56809523, "body": "&quot;Passing each of them as arguments would be very inefficient&quot;. Measured much?"}, {"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 1, "creation_date": 1451496088, "post_id": 34533681, "comment_id": 56809742, "body": "To get forward: <b>What&#39;s your CPU?</b>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1451496358, "post_id": 34533681, "comment_id": 56809897, "body": "@Lolo: Even on embedded platforms there is no need to write such code. Spaghetti have to be on a plate with a good sauce, but not in source code. Others already gave you enough information how to write correct code (<code>static</code> functions, global variables). If your platform is <b>that</b> small and you only have a crappy compiler, keep the C expressions simple. Otherwise use Assembler directly; that would still be better readable than what you want to accomplish. Because Assembler is designed for this, C not. Condolences to whoever has to read such code."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 2, "creation_date": 1451496790, "post_id": 34533681, "comment_id": 56810117, "body": "@dlask: In another comment he mentions a cache, so the CPU cannot be <b>that</b> small. I think OP either has an XY-problem or has no experience with &quot;modern&quot; (i.e. since 2000) compilers. Also that sounds like premature optimisation, as he does not provide any proof clean code will be too slow."}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451496920, "post_id": 34533681, "comment_id": 56810198, "body": "The target processor is a proprietary DSP. The compiler is everything but crappy and staying in C with intrinsics rather than assembly is immensely preferable. Again, I <i>do</i> agree that every single alternate approach that has been suggested is cleaner; it just ends up less efficient in the end. The only approach just as efficient as my current approach (efficiency wise) is to use globals and I am not clear why this is a better coding approach."}, {"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 0, "creation_date": 1451497123, "post_id": 34533681, "comment_id": 56810308, "body": "You can have your variables collected in a global structure. In this case you have a single global name but the access time to individual variables stays unchanged because their addresses can be resolved in the compile time. Moreover, it&#39;s meaningless to simulate function calls when standard function calls can be used directly."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451500053, "post_id": 34533681, "comment_id": 56811755, "body": "&quot;Would love to hear why this question is down-voted by the way&quot; -- NMDV, but I speculate that part of the reason is that you seem not to want an answer, at least not to the question you have actually posed.  What you seem really to be trying to do is to justify your rather horrible code.  Moreover, to do so you are making questionable assertions and adding extra conditions as you go."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451500489, "post_id": 34533681, "comment_id": 56811935, "body": "If indeed there is no &quot;fast enough&quot; for your program, so that truly every cycle counts, then you probably want to be hacking the critical parts in assembly.  Or you want a skilled assembly programmer for the target architecture hacking them, anyway."}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451500568, "post_id": 34533681, "comment_id": 56811973, "body": "@JohnBollinger Thanks for the insight. I see how this can be perceived as my trying to get my ugly solution endorsed, which really isn&#39;t my intent. Perhaps clearer would have been to ask simply: &quot;Is there a way in C to express what many assembly languages support with the concept of a call and return statements.&quot; The answer to that is: &quot;No, other than a function call with no argument, which doesn&#39;t prevent variables to be accessible unless they are global&quot;"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "reply_to_user": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 0, "creation_date": 1451500881, "post_id": 34533681, "comment_id": 56812109, "body": "@dlask Thanks. One global name only for the struct is clean. Though the compiler will figure out the addresses for accessing the struct elements, these will still turn into load and store to that struct as opposed to keeping content in registers. I agree that function calls make the code much more readable: I am not arguing this point."}, {"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 0, "creation_date": 1451501647, "post_id": 34533681, "comment_id": 56812501, "body": "How many variables are there? How many registers?"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451517522, "post_id": 34533681, "comment_id": 56819756, "body": "Around 24 general purpose registers. The time critical code I work on fills most of these registers with the variables and temp calculations needed in the inner loop. Looking at all these comments again, I realize that the &quot;cold shower&quot; I got on my question comes in part from the fact that my question is narrowly focused on discussing the usage of C for very time-critical code, self contained code where I am staying as close to assembly as I can while leveraging the compiler for instruction scheduling and register allocation."}], "answers": [{"comments": [{"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451495383, "post_id": 34533908, "comment_id": 56809362, "body": "I agree it is a cleaner approach coding wise. I am staying away from this approach as each variable access is another memory load and/or store on a system where memory bandwidth is already the bottleneck."}, {"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "reply_to_user": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451495719, "post_id": 34533908, "comment_id": 56809556, "body": "Not clear. You have to access your variables anyway. If you make your structure global, for example, and access the variables directly from the called function there is no difference in the variable access time. In other words, why don&#39;t you use a function?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 1, "creation_date": 1451495914, "post_id": 34533908, "comment_id": 56809656, "body": "@Lolo: you seem determined not to use structs, and dismiss them as less efficient. In theory they are, but a lot of compilers have found clever ways to optimize struct member access in such a way that they perform (almost) identical to variables. Have you looked into how your compiler might help you in this case (ie what optimization options you have: eg inline functions and the equivalent of <code>-fomit-frame-pointer</code> for your compiler)"}, {"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1451496524, "post_id": 34533908, "comment_id": 56809986, "body": "@EliasVanOotegem Yes, I do look at the disassembly generated by the compiler directly to see how close the assembly gets from what I need. Inlining function isn&#39;t something I want here for the same reason that macros won&#39;t work for me either: larger code with cache instruction misses. And structs do get translated in memory load and store for each access, something that doesn&#39;t add up to what I need in my end. I use regularly every single approach that has been suggested so far here (structs, macros, inlining). This is just a place where none of these meet my need."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 0, "creation_date": 1451497053, "post_id": 34533908, "comment_id": 56810274, "body": "@Lolo: Just covering the basics, I&#39;m not saying you didn&#39;t look at the disassembly, just trying some rubber-ducking :). That being said, I&#39;m not sure if we&#39;ll be able to help in any way. I&#39;m beginning to think you&#39;re sort of looking for somebody to say that the code you&#39;re writing is acceptable. Maybe in your very specific case it is, but I&#39;m sure you&#39;ll understand why it&#39;s making most of us cringe :)"}, {"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451497257, "post_id": 34533908, "comment_id": 56810374, "body": "@EliasVanOotegem No, the code is not acceptable. ;-)"}], "tags": [], "owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "is_accepted": false, "score": 0, "last_activity_date": 1451495253, "creation_date": 1451495253, "answer_id": 34533908, "question_id": 34533681, "link": "https://stackoverflow.com/questions/34533681/any-jump-with-return-instruction-in-c/34533908#34533908", "title": "Any jump with return instruction in C?", "body": "<p>Let's have the variables collected in a structure:</p>\n\n<pre><code>struct data_t {\n    int a;\n    int b;\n    /* and so on */\n    int x;\n    int y;\n};\n</code></pre>\n\n<p>Let's have the repeated code defined in a function:</p>\n\n<pre><code>void func(struct data_t* data) {\n    data-&gt;y = data-&gt;x;\n    /* and so on */\n}\n</code></pre>\n\n<p>Let's have the function used:</p>\n\n<pre><code>struct data_t data = {1, 2, ..., 24, 25};\nfunc(&amp;data);\ndata.x += 1;\nfunc(&amp;data);\n/* and so on */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1451495691, "last_edit_date": 1451495691, "creation_date": 1451495349, "answer_id": 34533934, "question_id": 34533681, "link": "https://stackoverflow.com/questions/34533681/any-jump-with-return-instruction-in-c/34533934#34533934", "title": "Any jump with return instruction in C?", "body": "<p>C has <code>setjmp()</code> / <code>longjmp()</code>, which can support what you describe.  Do not use them.  Even more, however, do not rely on your current approach, which is not standard C, and which is terribly poor form.</p>\n\n<p>What you describe is what functions are for.  If you have a lot of data that you must share between the caller and callee, then either</p>\n\n<ul>\n<li>record them in file-scope variables so that both functions can access them directly, or</li>\n<li>create one or more complex data types (presumably <code>struct</code>s) with which to hold and organize the data, and give the callee access by passing a pointer to such a <code>struct</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1451497039, "creation_date": 1451497039, "answer_id": 34534346, "question_id": 34533681, "link": "https://stackoverflow.com/questions/34533681/any-jump-with-return-instruction-in-c/34534346#34534346", "title": "Any jump with return instruction in C?", "body": "<p>A state machine can be written like this:</p>\n\n<pre><code>typedef enum { start, stop, state1, ... } state;\n\nstate s = start;\nwhile (s != stop) {\n switch (s) {\n case start:\n   do_stuff; // lots of code\n   // computed goto\n   s = cond ? state23 : state45;\n   break;\n   ...\n</code></pre>\n\n<p>Need a call stack?</p>\n\n<pre><code> state stack[42]; int sp=0;\n ...\n    do_stuff;\n    stack[sp++] = state33;\n    s = state45; // call\n    break;\n  case state33:\n\n  case state45:\n    do_processing; // some code\n    s = stack[--sp]; // ret\n    break;\n</code></pre>\n\n<p>You should only do this after you benchmark your time-critical code sections and find that the normal function call mechanism is indeed the bottleneck.</p>\n"}, {"comments": [{"owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "edited": false, "score": 1, "creation_date": 1518476414, "post_id": 48741628, "comment_id": 84514993, "body": "Wow. I had forgotten about this question that I got hammered for. Though I am no longer in need for this, I believe your suggested approach is exactly what I was after. It implements the flow I described and doesn&#39;t require to make variables global."}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1518421546, "creation_date": 1518421546, "answer_id": 48741628, "question_id": 34533681, "link": "https://stackoverflow.com/questions/34533681/any-jump-with-return-instruction-in-c/48741628#48741628", "title": "Any jump with return instruction in C?", "body": "<blockquote>\n  <p>Is there something more elegant and less cumbersome?</p>\n</blockquote>\n\n<p>You are obviously using GCC, as the <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">computed goto statement</a> is a GCC extension. With GCC we can use a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Nested-Functions.html\" rel=\"nofollow noreferrer\">nested function</a> and access local variables without needing to pass them as arguments:</p>\n\n<pre><code>{\n    int x, y;\n\n    void SOMEWHERE()\n    {\n        y = x;\n        //...\n    }\n\n    //...\n    SOMEWHERE();\n    //...\n    x += 1;\n    //...\n    SOMEWHERE();\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 3361, "user_id": 91208, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e643d47c57b984078c3b67560f7649b6?s=128&d=identicon&r=PG", "display_name": "Lolo", "link": "https://stackoverflow.com/users/91208/lolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 48741628, "answer_count": 4, "score": -3, "last_activity_date": 1518421546, "creation_date": 1451494436, "last_edit_date": 1452712033, "question_id": 34533681, "link": "https://stackoverflow.com/questions/34533681/any-jump-with-return-instruction-in-c", "title": "Any jump with return instruction in C?", "body": "<p>I have multiple locations in my code where I want to be able to jump to one specific location <em>and</em> return to where I was before.</p>\n\n<p>A function calls provides that control flow but is not an option for me as I want the code I branch to to access a number of variables and passing all of them as arguments to the function call wouldn't be practical or efficient.</p>\n\n<p>And the <code>goto</code> statement is only built to take a label, i.e. expected to be a one-way ticket.</p>\n\n<p>Currently I am achieving what I need with the following:</p>\n\n<pre><code>void *return_addr;\nint x,y;\n...\nreturn_addr=&amp;&amp;RETURN_0;\ngoto SOMEWHERE;\nRETURN_0:\n...\nx+=1;\n...\nreturn_addr=&amp;&amp;RETURN_1;\ngoto SOMEWHERE;\nRETURN_1:\n...\n\n\nSOMEWHERE:\ny=x;\n...\ngoto *return_addr;\n</code></pre>\n\n<p>Is there something more elegant and less cumbersome?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1451493963, "post_id": 34533530, "comment_id": 56808582, "body": "Always show your input in questions concerning I/O."}, {"owner": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "edited": false, "score": 1, "creation_date": 1451493993, "post_id": 34533530, "comment_id": 56808602, "body": "this can help you -  <a href=\"http://stackoverflow.com/questions/24099976/taking-two-characters-consecutively-in-c\" title=\"taking two characters consecutively in c\">stackoverflow.com/questions/24099976/&hellip;</a>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451494416, "post_id": 34533530, "comment_id": 56808828, "body": "The result is perfectly valid: <code>scanf</code> is reading 2 characters: <code>{a}{\\n}</code>, and so the output will be <i>&quot;[..]characters are {a} and {\\n}&quot;</i>. Perfectly valid and predictable"}, {"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451494492, "post_id": 34533530, "comment_id": 56808867, "body": "@EliasVanOotegem @nos And what difference is being created just by adding a space between the two <code>%c</code>?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451494695, "post_id": 34533530, "comment_id": 56808980, "body": "@rajaTHEKING: the leading space in <code>scanf</code> skips over all whitespace characters that might be in the buffer (including newlines). Alternatively you can use something like this: <code>%[^\\n]</code>. All format specifiers automatically skip whitespace, except for <code>%c</code>, <code>%[]</code> and <code>%n</code>. There&#39;s a lot of ways to tackle these kind of situations either way, most of them will end with saying that you should avoid <code>scanf</code> whenever you can"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "edited": false, "score": 0, "creation_date": 1451494319, "post_id": 34533572, "comment_id": 56808772, "body": "In the comment they say that while giving the inputs I&#39;m entering a and &#39;\\n&#39;.. So what difference your code is creating ?"}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 1, "last_activity_date": 1451494431, "last_edit_date": 1451494431, "creation_date": 1451494012, "answer_id": 34533572, "question_id": 34533530, "link": "https://stackoverflow.com/questions/34533530/c-program-to-accept-two-characters/34533572#34533572", "title": "C program to accept two characters", "body": "<p>Try</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char c1, c2;\n    printf(\"\\n Enter two characters : \");\n    scanf(\" %c %c\", &amp;c1, &amp;c2);\n    printf(\"\\n The the characters are %c and %c \", c1, c2);\n    return 0;\n}\n</code></pre>\n\n<p>The space between the <code>%c</code> consumes the trailing left out newline <code>\\n</code> character.</p>\n"}, {"comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1451494641, "post_id": 34533576, "comment_id": 56808948, "body": ".. perhaps check the return value from <code>scanf</code>"}], "tags": [], "owner": {"reputation": 29294, "user_id": 2659313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9828b91aef4c2b3cf14f3501e0a20e33?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2659313/mohit-jain"}, "is_accepted": true, "score": 2, "last_activity_date": 1451494462, "last_edit_date": 1495542683, "creation_date": 1451494020, "answer_id": 34533576, "question_id": 34533530, "link": "https://stackoverflow.com/questions/34533530/c-program-to-accept-two-characters/34533576#34533576", "title": "C program to accept two characters", "body": "<p>Use the following:</p>\n\n<pre><code>scanf(\" %c %c\", &amp;c1, &amp;c2);\n/*     ^  ^               */\n</code></pre>\n\n<p>When you hit return key after first character, <code>'\\n'</code> is read in <code>b</code>. Using space before <code>%c</code> instructs to ignore any white-space(space, tab, newline etc).</p>\n\n<p>Further read: <a href=\"https://stackoverflow.com/questions/6582322/what-does-space-in-scanf-mean\">What does space in scanf mean</a></p>\n"}, {"comments": [{"owner": {"reputation": 5964, "user_id": 18882, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1f4862a8f8c91e2ad84b28cf074f4dd5?s=128&d=identicon&r=PG", "display_name": "Steve Fallows", "link": "https://stackoverflow.com/users/18882/steve-fallows"}, "edited": false, "score": 0, "creation_date": 1451494447, "post_id": 34533597, "comment_id": 56808842, "body": "The space you added in the format string is what changed things."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "reply_to_user": {"reputation": 5964, "user_id": 18882, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1f4862a8f8c91e2ad84b28cf074f4dd5?s=128&d=identicon&r=PG", "display_name": "Steve Fallows", "link": "https://stackoverflow.com/users/18882/steve-fallows"}, "edited": false, "score": 0, "creation_date": 1451494560, "post_id": 34533597, "comment_id": 56808898, "body": "yup I got it, my mistake."}], "tags": [], "owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "is_accepted": false, "score": 0, "last_activity_date": 1451494785, "last_edit_date": 1451494785, "creation_date": 1451494094, "answer_id": 34533597, "question_id": 34533530, "link": "https://stackoverflow.com/questions/34533530/c-program-to-accept-two-characters/34533597#34533597", "title": "C program to accept two characters", "body": "<p>add a space in between <code>%c</code> in <code>scanf()</code> function. When you press enter eg. <code>\\n</code> after first input <code>c1</code>, it gets stored in <code>c2</code> in your case. By using space in between <code>%c</code> instructs to ignore any white-space(space, tab, newline etc). </p>\n\n<pre><code>  #include&lt;stdio.h&gt;\n    int main()\n    {\n        char c1, c2;\n        printf(\"\\n Enter two characters : \");\n        scanf(\"%c %c\",&amp;c1,&amp;c2);\n        printf(\"\\n The the characters are %c and %c \", c1, c2);\n        return 0;\n    }\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5224677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a01b043922a805e69984a08f9399284b?s=128&d=identicon&r=PG&f=1", "display_name": "raja THE KING", "link": "https://stackoverflow.com/users/5224677/raja-the-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2831, "favorite_count": 0, "accepted_answer_id": 34533576, "answer_count": 3, "score": 2, "last_activity_date": 1451494785, "creation_date": 1451493878, "last_edit_date": 1451494217, "question_id": 34533530, "link": "https://stackoverflow.com/questions/34533530/c-program-to-accept-two-characters", "title": "C program to accept two characters", "body": "<p>I'm trying to make a C program which accepts two character consecutively and then print them, but I'm getting some anomaly in the output.</p>\n\n<p>The program </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char c1, c2;\n    printf(\"\\n Enter two characters : \");\n    scanf(\"%c%c\", &amp;c1, &amp;c2);\n    printf(\"\\n The the characters are %c and %c \", c1, c2);\n    return 0;\n}\n</code></pre>\n\n<p>The output </p>\n\n<blockquote>\n  <p>Enter two characters : a<BR>  The the characters are a and</p>\n</blockquote>\n\n<p>In the output without asking for the second character it is directly going to the next <code>printf()</code> statement. Why is this happening?</p>\n"}, {"tags": ["c", "assembly", "nasm"], "comments": [{"owner": {"reputation": 7695, "user_id": 1881196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474cd12efa0089277b12d6e6dc43eea?s=128&d=identicon&r=PG", "display_name": "dlask", "link": "https://stackoverflow.com/users/1881196/dlask"}, "edited": false, "score": 0, "creation_date": 1451494540, "post_id": 34533511, "comment_id": 56808887, "body": "Are you looking for <code>n</code> at the right address? What&#39;s exactly the behaviour of <code>push eax</code>?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1451658314, "post_id": 34533511, "comment_id": 56856784, "body": "This can read outside <code>s1</code> (and potentially segfault) if <code>s2</code> is much longer than <code>s1</code>, unless <code>memcmp</code> always goes in increasing order and never reads any bytes past where a <code>&#39;\\0&#39;</code> in <code>s1</code> doesn&#39;t match something else in <code>s2</code>.  A vectorized <code>memcpy</code> that uses unaligned loads of 16B chunks or something can easily read past the end of <code>s1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 2, "last_activity_date": 1451494241, "creation_date": 1451494241, "answer_id": 34533635, "question_id": 34533511, "link": "https://stackoverflow.com/questions/34533511/issues-with-implementing-strstr-in-nasm/34533635#34533635", "title": "Issues with implementing strstr in NASM", "body": "<p>After pushing <code>eax</code> on the stack, <code>esp</code> points to that memory location. The line</p>\n\n<pre><code>push    dword[esp + 4]\n</code></pre>\n\n<p>will not <code>push</code> the value of <code>n</code> but the value pushed beforehand.<br>\nReplace the line with</p>\n\n<pre><code>push dword[esp]\n</code></pre>\n\n<p>and try again.</p>\n"}], "owner": {"reputation": 45, "user_id": 4027142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a83ba4a6f3f4b62f15398b4804a8714?s=128&d=identicon&r=PG&f=1", "display_name": "anna-bass", "link": "https://stackoverflow.com/users/4027142/anna-bass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 34533635, "answer_count": 1, "score": 0, "last_activity_date": 1451497544, "creation_date": 1451493790, "last_edit_date": 1451497544, "question_id": 34533511, "link": "https://stackoverflow.com/questions/34533511/issues-with-implementing-strstr-in-nasm", "title": "Issues with implementing strstr in NASM", "body": "<p>I've been struggling with implementing the following <em>strstr</em> function in NASM:</p>\n\n<pre><code>char *strstr(const char *s1, const char *s2) {\n    size_t n = strlen(s2);\n    while(*s1)\n        if(!memcmp(s1++,s2,n))\n            return s1-1;\n    return 0;\n}\n</code></pre>\n\n<p>So far I have the following code:</p>\n\n<pre><code>global _mystrstr\nextern _strlen\nextern _memcmp\n_mystrstr:\n\n    ; prologue goes here\n\n    ; moving s1 to edi and s2 to esi    \n    ; pushing n onto the stack and jumping to the loop\n\n    ; while(*s1)\n    .while_loop:\n        cmp     byte[edi], 0\n        je      .return_null\n        ; memcmp(s1++,s2,n)\n        push    dword[esp + 4]\n        push    esi\n        push    edi\n        call    _memcmp\n        add     esp, 12\n        inc     edi\n        ; if(!memcmp(s1++,s2,n))\n        cmp     eax, 0\n        jne     .while_loop\n        jmp     .return_value\n\n    .return_value:\n        ; blah blah\n\n    .return_null:\n        ; standard stuff goes here\n</code></pre>\n\n<p>For some reason <em>memcmp</em> never returns 0. I've tested it with <em>printf</em> by printing out the values that eax holds, and it's always either 1 or -1. Could anyone point out what I could possibly be doing wrong here?</p>\n"}, {"tags": ["python", "c", "sockets", "serialization", "ctypes"], "comments": [{"owner": {"reputation": 159764, "user_id": 2141635, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/f6yNV.jpg?s=128&g=1", "display_name": "Padraic Cunningham", "link": "https://stackoverflow.com/users/2141635/padraic-cunningham"}, "edited": false, "score": 0, "creation_date": 1451493877, "post_id": 34533409, "comment_id": 56808528, "body": "do it in c and use cython?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "edited": false, "score": 0, "creation_date": 1451506389, "post_id": 34536012, "comment_id": 56814793, "body": "Thanks for your reply. Although I know the number of elements is a fixed number in Python, I cannot change the format of the C struct because the length of <code>ce</code> and <code>syms</code> need to be dynamically allocated in C. Under this restriction, can I still define <code>Packet</code> the way you proposed?"}, {"owner": {"reputation": 3562, "user_id": 2275418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I70aa.jpg?s=128&g=1", "display_name": "Markku K.", "link": "https://stackoverflow.com/users/2275418/markku-k"}, "reply_to_user": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "edited": false, "score": 0, "creation_date": 1451507098, "post_id": 34536012, "comment_id": 56815150, "body": "Probably, but it depends. If you do a naive dump of your original Packet struct in a C program, it will write out an int, followed by two pointers. The data for the <code>ce</code> and <code>syms</code> fields will be kept elsewhere. However, most useful C programs would actually be written to dump the data, rather than the values of the pointers. If you are only exchanging data between python programs, then you don&#39;t have to worry about that."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "reply_to_user": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "edited": false, "score": 0, "creation_date": 1451520993, "post_id": 34536012, "comment_id": 56820739, "body": "@YeLi, no you cannot use this <code>Packet</code> definition. <code>POINTER(c_ubyte)</code> is 4 or 8 bytes, depending on the pointer size. <code>c_ubyte * N</code>  is N bytes. You also can&#39;t send the struct as a buffer (BTW, the pointer cast is unnecessary; ctypes objects support the buffer protocol) because the pointers are meaningless outside of your process. You need to create a new buffer that has the <code>id</code>, array size N, and data arrays concatenated. I&#39;d use a <code>bytearray</code>."}, {"owner": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "edited": false, "score": 0, "creation_date": 1451526700, "post_id": 34536012, "comment_id": 56822093, "body": "@erysun, thanks for pointing this out. Yes, you&#39;re correct. I had to serialize the bytes pointed by <code>ce</code> and <code>syms</code> manually."}], "tags": [], "owner": {"reputation": 3562, "user_id": 2275418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I70aa.jpg?s=128&g=1", "display_name": "Markku K.", "link": "https://stackoverflow.com/users/2275418/markku-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1451504025, "creation_date": 1451504025, "answer_id": 34536012, "question_id": 34533409, "link": "https://stackoverflow.com/questions/34533409/serializing-a-c-struct-in-python-and-sending-over-a-socket/34536012#34536012", "title": "Serializing a C struct in Python and sending over a socket", "body": "<p>First off, if you know the number of elements to be N, I would suggest changing your structure to this:</p>\n\n<pre><code>class Packet(Structure):\n    _fields_ = [(\"id\", c_int),\n                (\"ce\", c_ubyte * N),\n                (\"syms\", c_ubyte * N)]\n</code></pre>\n\n<p>Next, if you only want to send the struct data, you don't need to pickle the whole thing. Just send the packet data:</p>\n\n<pre><code>p = Packet()\np.id = 555\n...\n# cast the struct to a pointer to a char array\npdata = ctypes.cast(ctypes.byref(p), ctypes.POINTER(ctypes.c_char * ctypes.sizeof(p)))\n# now you can just save/send the struct data\nsomeSocketObject.send(pdata.contents.raw)\n</code></pre>\n\n<p>To read the data on the other side:</p>\n\n<pre><code>p = Packet()\nraw = someSocketObject.read(ctypes.sizeof(p))\nctypes.memmove(ctypes.pointer(p),raw,ctypes.sizeof(p))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1451530476, "post_id": 34540023, "comment_id": 56822826, "body": "Using <code>pktbuf = bytearray()</code> allows the bufer to grow in place (i.e. C <code>realloc</code>) with the <code>+=</code> operations."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1451530514, "post_id": 34540023, "comment_id": 56822832, "body": "Also, in <code>serialize</code> using <code>struct.pack</code> and <code>string_at</code> is unnecessary. All ctypes objects implement the buffer protocol. They can be appended directly to the <code>bytearray</code>, e.g. <code>pktbuf += pkt_p[0].id</code>. For the pointers, create a <code>c_char</code> array <i>without copying</i> to a new string (unlike <code>string_at</code>), so it only has to get copied once to store it in the buffer, e.g. <code>pktbuf += cast(pkt_p[0].ce, POINTER(c_char * size_g))[0]</code>."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 1, "creation_date": 1451531143, "post_id": 34540023, "comment_id": 56822963, "body": "In <code>deserialize</code> you can use <code>pkt_p[0].id = c_int.from_buffer_copy(pktstr)</code> instead of <code>struct.unpack</code>. For the arrays you should use the <code>offset</code> parameter of <code>from_buffer_copy</code> to avoid the temporary copy made by a slice, and you don&#39;t need the intervening <code>cast</code>, e.g. <code>pkt_p[0].ce = (c_ubyte * size_g).from_buffer_copy(pktstr, sizeof(c_int))</code> and <code>pkt_p[0].syms = (c_ubyte * size_p).from_buffer_copy(pktstr, sizeof(c_int) + size_g)</code>."}, {"owner": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1451531934, "post_id": 34540023, "comment_id": 56823141, "body": "@eryksun, these are really helpful suggestions on the performance of the code! Learnt a lot! Thanks."}], "tags": [], "owner": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "is_accepted": true, "score": 1, "last_activity_date": 1451527617, "last_edit_date": 1451527617, "creation_date": 1451527205, "answer_id": 34540023, "question_id": 34533409, "link": "https://stackoverflow.com/questions/34533409/serializing-a-c-struct-in-python-and-sending-over-a-socket/34540023#34540023", "title": "Serializing a C struct in Python and sending over a socket", "body": "<p>Finally I figured out the following way to manually serialize the `Packet' instance without using pickle. </p>\n\n<pre><code>def serialize(pkt_p, size_g, size_p):\n    \"\"\" Serialize Packet instance\n        size_g - number of elements pointed by ce\n        size_p - number of elements pointed by syms\n        Return a byte stream\n    \"\"\" \n    pktstr = b''\n    pktstr += struct.pack('i', pkt_p.contents.id)\n    pktstr += string_at(pkt_p.contents.ce, size_g)\n    pktstr += string_at(pkt_p.contents.syms, size_p)\n    return pktstr\n\ndef deserialize(pkt_p, pktstr, size_g, size_p):\n    \"\"\" De-serialize pktstr and fill a POINTER(Packet)\n    \"\"\"\n    pkt_p.contents.id = struct.unpack('i', pktstr[0:4])[0]\n    ce = (c_ubyte * size_g).from_buffer_copy(pktstr[4:4+size_g])\n    pkt_p.contents.ce = cast(ce, POINTER(c_ubyte))\n    syms = (c_ubyte * size_p).from_buffer_copy(pktstr[-size_p:])\n    pkt_p.contents.syms = cast(syms, POINTER(c_ubyte))\n</code></pre>\n\n<p>The <code>string_at()</code> and the <code>from_buffer_copy()</code> functions are the key.</p>\n"}], "owner": {"reputation": 123, "user_id": 1339329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6585c5fa2e66df6491b598b54d338976?s=128&d=identicon&r=PG", "display_name": "leeyee", "link": "https://stackoverflow.com/users/1339329/leeyee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3961, "favorite_count": 1, "accepted_answer_id": 34540023, "answer_count": 2, "score": 3, "last_activity_date": 1451527617, "creation_date": 1451493415, "question_id": 34533409, "link": "https://stackoverflow.com/questions/34533409/serializing-a-c-struct-in-python-and-sending-over-a-socket", "title": "Serializing a C struct in Python and sending over a socket", "body": "<p>I'm trying to serializing the following C struct</p>\n\n<pre><code>struct packet\n{\n    int id;\n    unsigned char *ce;\n    unsigned char *syms;\n};\n</code></pre>\n\n<p>in Python and send it over a socket. The number of elements pointed by <code>ce</code> and <code>syms</code> are known to be <code>N</code>. Currently I'm doing this way. First, I wrap the struct using ctypes to</p>\n\n<pre><code>class Packet(Structure):\n    _fields_ = [(\"id\",  c_int),\n                (\"ce\", POINTER(c_ubyte)),\n                (\"syms\", POINTER(c_ubyte))]\n</code></pre>\n\n<p>Then, I populate an object of the following class using its <code>fill_data</code> function from a <code>ctypes.POINTER(Packet)</code>:</p>\n\n<pre><code>class DataLoad:\n    def __init__(self):\n        self.id = -1\n        self.ce = []\n        self.syms = []\n\n    def fill_data(self, pkt_p):\n        \"\"\" pkt_p is POINTER(Packet)\n        \"\"\"\n        self.id = pkt_p.contents.id\n        self.ce = []\n        for i in range(N):\n            self.ce.append(pkt_p.contents.ce[i])\n        self.syms = []\n        for i in range(N):\n            self.syms.append(pkt_p.contents.syms[i])\n</code></pre>\n\n<p>Finally, I simply use <code>pickle.dumps(DataLoad)</code> to generate a byte stream and send.</p>\n\n<p>This approach works well. However, it seems to be quite slow. One reason I can see is that <code>pickle.dumps</code> bring much overhead. For example, if the C struct is only 1024 bytes, I may have to send almost 4000 bytes for each struct using pickle. Also, packing/populating DataLoad also takes time.</p>\n\n<p>So my question is, do I have other better choices to serialize this C struct in python and send? I would prefer to avoid pickle and populate a separate class instance. Thanks.</p>\n"}, {"tags": ["c", "locale"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1451493656, "post_id": 34533339, "comment_id": 56808406, "body": "Just saw that.  Comment deleted."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1451493784, "post_id": 34533339, "comment_id": 56808480, "body": "data is not null terminated.  You will need to null terminate it to print it."}, {"owner": {"reputation": 682, "user_id": 791892, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/30d0eda0ccb196be77f051fcf64385e8?s=128&d=identicon&r=PG", "display_name": "trupanka", "link": "https://stackoverflow.com/users/791892/trupanka"}, "edited": false, "score": 1, "creation_date": 1451493948, "post_id": 34533339, "comment_id": 56808571, "body": "Why I do? From glibc&#39;s manual: <code>fgetws (wchar_t *WS, int COUNT, FILE *STREAM)</code> You must supply COUNT wide characters worth of space in WS, but the number of characters read is at most COUNT - 1. The extra character space is used to hold the null wide character at the end of the string."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451494617, "post_id": 34533339, "comment_id": 56808933, "body": "The code looks OK. Except the <code>printf</code> thing that looks fishy. Have you tried some <code>w</code> versions of it? MS might have some screwed up implementation of <code>%ls</code>..(is it MS, btw??)"}, {"owner": {"reputation": 682, "user_id": 791892, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/30d0eda0ccb196be77f051fcf64385e8?s=128&d=identicon&r=PG", "display_name": "trupanka", "link": "https://stackoverflow.com/users/791892/trupanka"}, "edited": false, "score": 0, "creation_date": 1451497341, "post_id": 34533339, "comment_id": 56810411, "body": "No problems on machine with gcc 5.2 and glibc-2.21. The problem reveals with glibc-2.22"}], "answers": [{"comments": [{"owner": {"reputation": 682, "user_id": 791892, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/30d0eda0ccb196be77f051fcf64385e8?s=128&d=identicon&r=PG", "display_name": "trupanka", "link": "https://stackoverflow.com/users/791892/trupanka"}, "edited": false, "score": 0, "creation_date": 1451496802, "post_id": 34534182, "comment_id": 56810126, "body": "Thank you. But I figured out it&#39;s issue with glibc-2.22. With glibc-2.21 this code compiles and runs fine."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1451496412, "creation_date": 1451496412, "answer_id": 34534182, "question_id": 34533339, "link": "https://stackoverflow.com/questions/34533339/segfault-reading-wide-oriented-stream-with-locale-settings/34534182#34534182", "title": "segfault reading wide-oriented stream with locale settings", "body": "<p>Suspect <code>fgetws(data, 2, stdin)</code> is broken.</p>\n\n<p><code>fgetws()</code>, using such a small buffer should, at most, read 1 <code>wchar_t</code> from <code>stdin</code> and append a termanting <code>(wchar_t) '\\0'</code>.</p>\n\n<p>As usual, when code fails mysteriously, best to check return from the functions to see if they are as expected.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;wchar.h&gt;\n\n#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;wchar.h&gt;\n\nstatic const int N = 2;\n\nint main(void) {\n  char *p = setlocale(LC_ALL, \"\");\n  assert(p);\n\n  wchar_t data[N];\n  wchar_t *s = fgetws(data, N, stdin);\n  assert(s); \n\n  int i = printf(\"%ls\\n\", data);\n  assert(i == 2);\n\n  i = fclose(stdin);\n  assert(i == 0);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 682, "user_id": 791892, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/30d0eda0ccb196be77f051fcf64385e8?s=128&d=identicon&r=PG", "display_name": "trupanka", "link": "https://stackoverflow.com/users/791892/trupanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1451496412, "creation_date": 1451493157, "question_id": 34533339, "link": "https://stackoverflow.com/questions/34533339/segfault-reading-wide-oriented-stream-with-locale-settings", "title": "segfault reading wide-oriented stream with locale settings", "body": "<p>I have problem in program with locale and reading from stdin with <code>fgetws</code> function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;wchar.h&gt;\n\nstatic const int N = 2;\n\nint main(void) {\n  setlocale(LC_ALL, \"\");\n  wchar_t data[N];\n  fgetws(data, N, stdin);\n  printf(\"%ls\\n\", data);\n  /* fclose(stdin); */\n  return 0;\n}\n</code></pre>\n\n<p>When input is long enough (5 or more chars) I get segfault if I don't close <code>stdin</code> before <code>return</code>. Why is that? What is wrong with this program?</p>\n"}, {"tags": ["c", "string", "visual-studio", "strcpy", "strcat"], "answers": [{"comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1451492667, "post_id": 34533189, "comment_id": 56807839, "body": "I wish all bugs were this easy!"}, {"owner": {"reputation": 45, "user_id": 4201746, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/571e4b9193ff852a53634732502b0038?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4201746/john"}, "edited": false, "score": 0, "creation_date": 1451492701, "post_id": 34533189, "comment_id": 56807861, "body": "Cant believe it happeaned to me lol, tnx! :)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451493016, "post_id": 34533189, "comment_id": 56808034, "body": "If you compiled with <code>-Wall -Wextra -Werror</code>, you would get a more pertinent diagnostic for invoking an unprototyped function... Actually you seem to use Microsoft tools, maybe <code>-W4</code> can help."}], "tags": [], "owner": {"reputation": 326, "user_id": 4164964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70bd4909742348c82b83a229c8b8484b?s=128&d=identicon&r=PG&f=1", "display_name": "9y7h0n", "link": "https://stackoverflow.com/users/4164964/9y7h0n"}, "is_accepted": true, "score": 2, "last_activity_date": 1451492514, "creation_date": 1451492514, "answer_id": 34533189, "question_id": 34533128, "link": "https://stackoverflow.com/questions/34533128/using-strcat-more-than-1-time-link2019/34533189#34533189", "title": "using strcat more than 1 time - link2019", "body": "<p>The third time, you spelled it <code>srtcat</code>. Correct to <code>strcat</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1451492519, "creation_date": 1451492519, "answer_id": 34533193, "question_id": 34533128, "link": "https://stackoverflow.com/questions/34533128/using-strcat-more-than-1-time-link2019/34533193#34533193", "title": "using strcat more than 1 time - link2019", "body": "<p>You have a typo on the third line: <code>srtcat</code> instead of <code>strcat</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 4201746, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/571e4b9193ff852a53634732502b0038?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4201746/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1451553413, "accepted_answer_id": 34533189, "answer_count": 2, "score": 1, "last_activity_date": 1451492519, "creation_date": 1451492295, "question_id": 34533128, "link": "https://stackoverflow.com/questions/34533128/using-strcat-more-than-1-time-link2019", "closed_reason": "Not suitable for this site", "title": "using strcat more than 1 time - link2019", "body": "<p>I'm trying to use strcat 2 time in a row.<br>\nwhen I compile first 2 lines it's works, but when I added the third line I get:<br>\n    \"Error  LNK2019 unresolved external symbol _srtcat referenced in function _StartUpFunc \"</p>\n\n<pre><code>strcpy(msg2sent, \"Hello\");\nstrcat(msg2sent, temp_username);\nsrtcat(msg2sent, \", welcome to the session.\");\n</code></pre>\n\n<p>what can be the reason?\nIm using VS15</p>\n"}, {"tags": ["c++", "c", "arduino"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1451492090, "post_id": 34532941, "comment_id": 56807537, "body": "Please post the code.  What does the documentation say about the delay limitations?  This seems to be a runtime question.  You have indicated the expected and actual output.  The next (and major) requirement for stackoverflow,com, is the source code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451492167, "post_id": 34532941, "comment_id": 56807577, "body": "Are you calling it as <code>delay(60000)</code> or something like <code>delay(60*1000)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5718798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35910f3397a131358716839170d8aa0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mufaro Shumba", "link": "https://stackoverflow.com/users/5718798/mufaro-shumba"}, "edited": false, "score": 0, "creation_date": 1451492466, "post_id": 34533050, "comment_id": 56807730, "body": "Then it should work, but what I have decided to do was to split up my values and look through and that seems to work perfectly. But thank you for the response."}], "tags": [], "owner": {"reputation": 131, "user_id": 3957251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R8YPS.png?s=128&g=1", "display_name": "William Schaller", "link": "https://stackoverflow.com/users/3957251/william-schaller"}, "is_accepted": false, "score": 3, "last_activity_date": 1451581360, "last_edit_date": 1495541256, "creation_date": 1451492012, "answer_id": 34533050, "question_id": 34532941, "link": "https://stackoverflow.com/questions/34532941/in-arduino-is-there-a-maximum-delay-time-when-using-the-fuctiondelay/34533050#34533050", "title": "In Arduino is there a Maximum delay time when using the fuction(Delay)", "body": "<p>From the <a href=\"https://www.arduino.cc/en/Reference/Delay\" rel=\"nofollow noreferrer\">arduino reference page for delay</a> the parameter for <em>delay</em> is an <em>unsigned long</em></p>\n\n<p>Unsigned longs <a href=\"https://www.arduino.cc/en/Reference/UnsignedLong\" rel=\"nofollow noreferrer\">on the arduino</a> can reach from 0 to 4,294,967,295.</p>\n\n<p>It is likely that the number being passed to 'delay' is being interpreted as an int. This would mean the delay is limited to a max of 32,767.</p>\n\n<p>You should explicitly declare your delay value as an unsigned long <a href=\"https://stackoverflow.com/questions/19167272/my-arduino-stops-after-1-minute-wait\">like the solution in this post</a>. </p>\n\n<pre><code>unsigned long seconds = 1000L; //Notice the L \nunsigned long minutes = seconds * 60;\n\ndelay(minutes); //for 60,000 milliseconds\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1451492571, "creation_date": 1451492571, "answer_id": 34533207, "question_id": 34532941, "link": "https://stackoverflow.com/questions/34532941/in-arduino-is-there-a-maximum-delay-time-when-using-the-fuctiondelay/34533207#34533207", "title": "In Arduino is there a Maximum delay time when using the fuction(Delay)", "body": "<p>given this link: <a href=\"https://www.arduino.cc/en/Reference/DelayMicroseconds\" rel=\"nofollow\">https://www.arduino.cc/en/Reference/DelayMicroseconds</a></p>\n\n<p>Currently, the largest value that will produce an accurate delay is 16383. This could change in future Arduino releases. For delays longer than a few thousand microseconds, you should use delay() instead. </p>\n\n<p>all of which seems to indicate that the function is only paying attention to the lower 14 bits.</p>\n\n<p>So even in the longer delay function: <code>delay()</code>  it is likely that only the lower 14 bits are being utilized.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10582960, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/143563ead7699466dfd0ea16f16c243c?s=128&d=identicon&r=PG", "display_name": "Shamsher Raja", "link": "https://stackoverflow.com/users/10582960/shamsher-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1540937688, "creation_date": 1540937688, "answer_id": 53073651, "question_id": 34532941, "link": "https://stackoverflow.com/questions/34532941/in-arduino-is-there-a-maximum-delay-time-when-using-the-fuctiondelay/53073651#53073651", "title": "In Arduino is there a Maximum delay time when using the fuction(Delay)", "body": "<p>Why not use certain delay like 10000 (10 sec) and increase a dummy variable by 1, and then when dummy varable reaches your desired delay period do your thing. Like dummy variable is 1 is 10 sec, when it's 20 that will be 20x10= 200 secs and so on. this  can go long way.</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 3837914, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dd422dc623db0cdbf4e8fa779daf66fb?s=128&d=identicon&r=PG&f=1", "display_name": "Dr. Azzy", "link": "https://stackoverflow.com/users/3837914/dr-azzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1595051110, "creation_date": 1595051110, "answer_id": 62965111, "question_id": 34532941, "link": "https://stackoverflow.com/questions/34532941/in-arduino-is-there-a-maximum-delay-time-when-using-the-fuctiondelay/62965111#62965111", "title": "In Arduino is there a Maximum delay time when using the fuction(Delay)", "body": "<p>Yeesh... someone cited this thread elsewhere, here is the correct explanation:</p>\n<p>delay() takes an unsigned long (32-bit number between 0 and 2^32-1, or about 4.2 billion). And delay(60000) works fine.\nThere are two ways that one could get into trouble trying to pass numbers larger than those used in blink, but smaller than 4.2 billion to\ndelay()</p>\n<p>First,  if you generate the number on the spot by multiplying numbers together, for example delay(60*1000);</p>\n<p>Both of these numbers will default to int (16-bit signed integer from -32768 to 32767), so that multiplication will overflow that\u2026 leaving you with -5536 if my math serves me\u2026 Then, that gets converted to an unsigned long, leaving you with 2^32-5536, or, well, approximately 4.2 billion.</p>\n<p>Solution is simple - explicitly tell the compiler that you intend for that literal to be an unsigned long, by putting UL after one of the numbers (the other will be automatically promoted to unsigned long to match):</p>\n<p>delay(60UL*1000);</p>\n<p>The other way an arduino user could get in trouble here (really, the same way, only through a different route) would be if they assigned the delay to a data type that couldn\u2019t fit it, for example:</p>\n<p>int time=60000; //this ends up as -5536 too...</p>\n<p>\u2026</p>\n<p>delay(time); //same result!</p>\n<p>Solution is also quite simple - just declare time as an unsigned long, instead of int.</p>\n<p>Note that the first case (but not the second), where the constant expression generates an overflow, would actually generate a compiler warning\u2026. Except, arduino turns off compiler warnings by default. You can turn them back on in File -&gt; preferences. Sometimes it will warn about things that are fine, but when you see warnings, and it\u2019s not doing what you want, the warnings are a good place to start looking.</p>\n<p>Background on delayMicroseconds()</p>\n<p>The issue with delayMicroseconds() having the maximum length of 16383 is unrelated - that limitation is because delayMicroseconds is, under the hood, implemented completely differently from delay(). delay() is based on micros() and the millis timer system (a hardware timer is configured prior to setup() being called, with the overflow interrupt incrementing a global count of milliseconds; millis() uses that count, and micros uses that plus the current count on the timer). delayMicroseconds, however, needs much higher accuracy than that method could achieve (micros takes something like 7-8us to return, and has resolution of 4us, since the timer in question runs off the 16MHz clock with /64 prescale); it's implemented by counting clock cycles. It takes an unsigned int (16-bit) instead of unsigned long, first off. It multiplies the requested delay by 4 (for 16MHz clock, at least), converting it into the number of iterations of a loop written in inline assembler that takes 4 clock cycles per iteration. So that's where the apparent 14-bit limit comes from: the number of 4-cycle loops has to fit in 16 bits, so the number of microseconds is 1/4th that (assuming 16 MHz system clock - so an 8 MHz pro mini, for example, you could specify twice as long of a delay to delayMicroseconds()!). On an (admittedly rare) 20 MHz one, the longest delay would be around 13000 ((2^16-1)/(20/4=5)) Long before that, though, you're better off just doing a while loop that checks micros()...</p>\n"}], "owner": {"reputation": 61, "user_id": 5718798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35910f3397a131358716839170d8aa0f?s=128&d=identicon&r=PG&f=1", "display_name": "Mufaro Shumba", "link": "https://stackoverflow.com/users/5718798/mufaro-shumba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11097, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1595051110, "creation_date": 1451491589, "last_edit_date": 1451491994, "question_id": 34532941, "link": "https://stackoverflow.com/questions/34532941/in-arduino-is-there-a-maximum-delay-time-when-using-the-fuctiondelay", "title": "In Arduino is there a Maximum delay time when using the fuction(Delay)", "body": "<pre><code>{\n    digitalWrite(13, HIGH);   // turn the LED on (HIGH is the voltage level)\n    delay(1000);              // wait for a second\n    digitalWrite(13, LOW);    // turn the LED off by making the voltage LOW\n    delay(1000);              // wait for a second\n}\n</code></pre>\n\n<p>I am trying to set the Delay to 60,000 but when outputting it to the Arduino after 1 minute passes the light does not switch on.</p>\n"}, {"tags": ["c", "compiler-errors", "linker", "linker-errors"], "comments": [{"owner": {"reputation": 97003, "user_id": 142434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGcat.jpg?s=128&g=1", "display_name": "Stephen Canon", "link": "https://stackoverflow.com/users/142434/stephen-canon"}, "edited": false, "score": 1, "creation_date": 1451490297, "post_id": 34532528, "comment_id": 56806509, "body": "These are functions implemented in libgcc, which is a library providing implementations of basic operations not supported by the hardware you are targeting (64-bit division in this case).  You&#39;ll either need to provide your own implementations, or avoid those operations, or link with that library."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1451490708, "post_id": 34532528, "comment_id": 56806769, "body": "Wasn&#39;t it a border effect of freestanding compilation?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 1, "creation_date": 1451490800, "post_id": 34532528, "comment_id": 56806819, "body": "Just guessing, compiling with <code>-ffast-math</code> might make gcc use builtin functions for <code>long long</code> operations. Otherwise, you&#39;d have to link with <code>divdi3.o</code>."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1451490835, "post_id": 34532528, "comment_id": 56806837, "body": "@Jean-BaptisteYun&#232;s Indirectly, but <code>-ffreestanding</code> is required since it&#39;s kernel stuff."}, {"owner": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1451491244, "post_id": 34532528, "comment_id": 56807073, "body": "@YSC, I tried <code>-ffast-math</code> but sadly it didn&#39;t seem to affect the outcome.. Where could I find <code>divdi3.o</code>? I searched my whole system but couldn&#39;t find a file of that name."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451491793, "post_id": 34532528, "comment_id": 56807379, "body": "This question has nothing to do with [c++]; tag removed."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451491884, "post_id": 34532528, "comment_id": 56807425, "body": "Which version of GCC are you using?  Inasmuch as the answer may hinge on details of the available options and GCC&#39;s handling of them, the compiler version is important."}, {"owner": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1451492019, "post_id": 34532528, "comment_id": 56807499, "body": "@JohnBollinger gcc 4.8.4 and ld 2.24"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1451497142, "post_id": 34532528, "comment_id": 56810317, "body": "Did you tried __divti3 (or i was completely wrong)?"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1451494317, "post_id": 34533469, "comment_id": 56808771, "body": "The static and dynamic versions of libgcc provide the same functions."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1451493657, "creation_date": 1451493657, "answer_id": 34533469, "question_id": 34532528, "link": "https://stackoverflow.com/questions/34532528/undefined-reference-to-divdi3/34533469#34533469", "title": "Undefined reference to &#39;__divdi3&#39;", "body": "<p>Per this link: <a href=\"https://gcc.gnu.org/onlinedocs/gcc-3.3/gccint/Library-Calls.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc-3.3/gccint/Library-Calls.html</a></p>\n\n<p>the functions of interest are defined in the <code>libgcc.a</code> library. (not in the <code>libgcc.so</code> library.)</p>\n\n<p>I think your code will use the libgcc.a library if your link step contains the <code>-static</code> parameter</p>\n\n<p>However, this link: <a href=\"https://sourceware.org/ml/crossgcc/2006-04/msg00000.html\" rel=\"nofollow\">https://sourceware.org/ml/crossgcc/2006-04/msg00000.html</a></p>\n\n<p>has the following to say:</p>\n\n<p>Typically you link with gcc instead of ld to avoid just these types of problems.</p>\n\n<p>I would either change it to link using gcc, or add the proper -L and -l options to get it to use the proper libgcc</p>\n"}, {"tags": [], "owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "is_accepted": false, "score": 0, "last_activity_date": 1451493993, "creation_date": 1451493993, "answer_id": 34533566, "question_id": 34532528, "link": "https://stackoverflow.com/questions/34532528/undefined-reference-to-divdi3/34533566#34533566", "title": "Undefined reference to &#39;__divdi3&#39;", "body": "<p>It seems that you are using the wrong function:</p>\n\n<p>\u2014 Runtime Function: long __divdi3 (long a, long b)</p>\n\n<p>I guess that the correct function is:</p>\n\n<p>\u2014 Runtime Function: long long __divti3 (long long a, long long b)</p>\n\n<p>(<a href=\"https://gcc.gnu.org/onlinedocs/gccint/Integer-library-routines.html#Integer-library-routines\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gccint/Integer-library-routines.html#Integer-library-routines</a>)</p>\n\n<p>Unfortunately I'm not sure if is implemented in your gcc version.</p>\n"}, {"comments": [{"owner": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "edited": false, "score": 0, "creation_date": 1451494559, "post_id": 34533569, "comment_id": 56808897, "body": "Thanks for the detailed answer! using the following command line still results in the same error though; <code>gcc static-libgcc -lgcc -ffreestanding -c kernel&#47;util.c -o kernel&#47;util.o </code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "edited": false, "score": 0, "creation_date": 1451494753, "post_id": 34533569, "comment_id": 56809011, "body": "Sorry if I was unclear: the options are for <code>gcc</code>, and it is desirable to use <code>gcc</code> as the linker driver.  To facilitate that, you can use gcc&#39;s <code>-Wl</code> option to pass options through to the linker."}, {"owner": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "edited": false, "score": 0, "creation_date": 1451495005, "post_id": 34533569, "comment_id": 56809152, "body": "I&#39;m afraid I have to use ld separately.. Is there no other way"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "edited": false, "score": 0, "creation_date": 1451496233, "post_id": 34533569, "comment_id": 56809834, "body": "@RandomUser and why is that?  You can have a separate link step that runs the linker via <code>gcc</code>, and you can feed any options you like to it.  Why do you need to run it directly?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1451499305, "post_id": 34533569, "comment_id": 56811421, "body": "If function in question were <code>printf</code>, then this topic becomes much less controversial."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 20, "last_activity_date": 1451494000, "creation_date": 1451494000, "answer_id": 34533569, "question_id": 34532528, "link": "https://stackoverflow.com/questions/34532528/undefined-reference-to-divdi3/34533569#34533569", "title": "Undefined reference to &#39;__divdi3&#39;", "body": "<p>When building code for an architecture that does not provide hardware support for the data type GCC uses as [<code>unsigned</code>] <code>long long</code>, GCC generates code for arithmetic operations on values of that type that involves calling functions provided by its own support library, <code>libgcc</code>.  The <code>__divdi3()</code> etc. are among those.  This is not the only way GCC could do it, but it is well suited to GCC's aim of supporting many architectures.</p>\n\n<p>When instructed to act as a freestanding compiler, GCC does not automatically link libgcc, with the result that no implementation of these functions is automatically provided.  This has been the subject of previous complaints, such as <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=16470\" rel=\"noreferrer\">this one</a> and <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=32501\" rel=\"noreferrer\">this later one</a>.  The GCC maintainers take the position that this is not a GCC flaw, and that it does not render GCC non-conforming.  I find their reasoning questionable, but it's unlikely to change.  At minimum, this is a quality of implementation issue.</p>\n\n<p>I do see where the GCC maintainers are coming from, however: a freestanding environment provides next to none of the standard library, and must not interpret most function calls except according to the code presented to it.  What, then, if that code contains explicit calls to functions with the same names as some of those in libgcc?  Unless the user explicitly says he wants libgcc, the compiler should not assume that it is those versions of the functions that are wanted.  The problem, though, is that if <em>the compiler</em> inserts such calls, then not only does it know which implementations are intended, but the result is wrong if an incompatible one is linked instead.  Thus, this is a problem of GCC's own making.</p>\n\n<p>The bottom line is that you can explicitly request that libgcc be linked.  You will want to specify that it be linked statically, as you cannot rely on a dynamic linker in your context.  These additional link options should do it:</p>\n\n<pre><code>-static-libgcc -lgcc\n</code></pre>\n\n<p>Alternatively, you could write your own implementations of those functions, or crib the source from GCC, but I don't see why you would prefer either of those options.</p>\n"}], "owner": {"reputation": 4159, "user_id": 3549636, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/454bd8f54ba8652969b1d4b41dcadbc4?s=128&d=identicon&r=PG&f=1", "display_name": "DividedByZero", "link": "https://stackoverflow.com/users/3549636/dividedbyzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13034, "favorite_count": 4, "accepted_answer_id": 34533569, "answer_count": 3, "score": 14, "last_activity_date": 1451494000, "creation_date": 1451490058, "last_edit_date": 1451492065, "question_id": 34532528, "link": "https://stackoverflow.com/questions/34532528/undefined-reference-to-divdi3", "title": "Undefined reference to &#39;__divdi3&#39;", "body": "<p>Upon linking some code that performs division and modulo operations on an integer of type <code>long long</code> I receive the following two errors:</p>\n\n<pre><code>util.c:(.text+0x1af): undefined reference to '__divdi3'\nutil.c:(.text+0x1ef): undefined reference to '__moddi3'\n</code></pre>\n\n<p>I have also tried using <code>unsigned long long</code>, however that results in the following error:</p>\n\n<pre><code>util.c:(.text+0x1af): undefined reference to '__udivdi3'\nutil.c:(.text+0x1ef): undefined reference to '__umoddi3'\n</code></pre>\n\n<p>Replacing the <code>long long</code> with <code>int</code> or <code>long</code> fixes the problem, but I need to use <code>unsigned long long</code>.</p>\n\n<p>I am using the following command line to compile and link the program:</p>\n\n<pre><code>gcc -ffreestanding -c kernel/util.c -o kernel/util.o\nld -o kernel32.bin -Ttext 0x500 kernel/util.o kernel/kernel.o --oformat binary\n</code></pre>\n\n<p>and this is the function:</p>\n\n<pre><code>char* itoa(unsigned long long i, char b[]){\n    if (i == 0){\n        b[0] = '0';\n        b[1] = '\\0';\n        return b;\n    }\n    char const digit[] = \"0123456789\";\n    char* p = b;\n    if (i &lt; 0){\n        *p++ = '-';\n        i *= -1;\n    }\n    unsigned long long shifter = i;\n    while (shifter){\n        ++p;\n        shifter = shifter / 10;\n    }\n    *p = '\\0';\n    while (i){\n        *--p = digit[i % 10];\n        i = i / 10;\n    }\n    return b;\n}\n</code></pre>\n\n<p>Clearly, the compiler is referencing <code>__udivdi3</code> to divide the integer but the linker can't find it..</p>\n\n<p>By the way, the binary is to be used as a 32 bit operating system and therefore lacks many standard libraries</p>\n\n<p>EDIT: I am using gcc 4.8.4 and ld 2.24</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 7, "creation_date": 1451490094, "post_id": 34532503, "comment_id": 56806397, "body": "<code>new char[strlen(str)];</code> should be <code>new char[strlen(str)+1];</code> to allow for the null character"}, {"owner": {"reputation": 1691, "user_id": 4355012, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cc9e7a6a654cb5f9d877dae44f90b948?s=128&d=identicon&r=PG&f=1", "display_name": "Kamajii", "link": "https://stackoverflow.com/users/4355012/kamajii"}, "edited": false, "score": 0, "creation_date": 1451490240, "post_id": 34532503, "comment_id": 56806477, "body": "What is your concept of &#39;empty&#39;? All you actually do is replace one single character in the allocated memory by a nil byte. Also mind you&#39;re allocating to little memory as pointed out by Ed Heal."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 3, "creation_date": 1451490240, "post_id": 34532503, "comment_id": 56806479, "body": "I don&#39;t really agree with people negativating this question. This guy&#39;s trying to understand the concepts and people are not estimulating him to do that. I think the problem are people who asks for homework done."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "reply_to_user": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 1, "creation_date": 1451490326, "post_id": 34532503, "comment_id": 56806528, "body": "@Paulo I aggree, there are too many people on stack now that downvote for whatever reason and do not even bother to explain why."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1451490364, "post_id": 34532503, "comment_id": 56806555, "body": "The very first <code>strlen</code> call is undefined behaviour. str is not a nul-terminated string."}, {"owner": {"reputation": 1691, "user_id": 4355012, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cc9e7a6a654cb5f9d877dae44f90b948?s=128&d=identicon&r=PG&f=1", "display_name": "Kamajii", "link": "https://stackoverflow.com/users/4355012/kamajii"}, "edited": false, "score": 1, "creation_date": 1451490367, "post_id": 34532503, "comment_id": 56806558, "body": "Surely, but there is plenty of excellent literature on these beginner&#39;s topics. Also, there is so few information given in his question that each and every single answer can only be a guess, imho."}, {"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1451490463, "post_id": 34532503, "comment_id": 56806620, "body": "I think we should warn him here at the comments what he should do, instead of down voting him. OR, we could down vote him and explain the reason as @Slava said."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451490503, "post_id": 34532503, "comment_id": 56806652, "body": "the string that <code>cstr</code> holds is now 5 chars long, but the memory allocated of <code>cstr</code> isn&#39;t. That block was allocated, and is never freed by you (it will probably be deallocated when your program terminates though). for that, you need to <code>delete</code> the variable"}, {"owner": {"reputation": 1691, "user_id": 4355012, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/cc9e7a6a654cb5f9d877dae44f90b948?s=128&d=identicon&r=PG&f=1", "display_name": "Kamajii", "link": "https://stackoverflow.com/users/4355012/kamajii"}, "edited": false, "score": 0, "creation_date": 1451490564, "post_id": 34532503, "comment_id": 56806684, "body": "Not delete[] but delete, that was not allocated using the array allocator. Yes, the memory is released at program termination by standard."}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1451490228, "post_id": 34532536, "comment_id": 56806466, "body": "Looks like he did not think that <code>strlen()</code> releases memory, but <code>cstr[5] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 134, "user_id": 4530614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SO4XjeaHqCE/AAAAAAAAAAI/AAAAAAAAACQ/HFEYERVln4w/photo.jpg?sz=128", "display_name": "alphaplus", "link": "https://stackoverflow.com/users/4530614/alphaplus"}, "edited": false, "score": 0, "creation_date": 1451584939, "post_id": 34532536, "comment_id": 56842295, "body": "Thanks everybody, I understand memory in C/C++ more. Also thanks John Bode and Pravar Jawalekar for your answer"}], "tags": [], "owner": {"reputation": 555, "user_id": 5071598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-32mDN1SXPKI/AAAAAAAAAAI/AAAAAAAAAAA/FQIq7RpsTQk/photo.jpg?sz=128", "display_name": "Gary Jackson", "link": "https://stackoverflow.com/users/5071598/gary-jackson"}, "is_accepted": true, "score": 15, "last_activity_date": 1451490088, "creation_date": 1451490088, "answer_id": 34532536, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34532536#34532536", "title": "Does the below code really free memory in C/C++?", "body": "<p>No. All strlen() does is look for the first null character ('\\0') in the string. It doesn't free memory. It doesn't even care if the memory it examines is properly allocated. It will happily walk past the end of allocated memory in search of a null character if none is found starting from the pointer you give it.</p>\n"}, {"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1451493352, "post_id": 34532560, "comment_id": 56808240, "body": "&quot;<i>allocated a char array of length 22 char</i>&quot; - more like 22+*RandomNumber*, since <code>str</code> is not null-terminated, thus <code>strlen(str)</code> is undefined behavior. Also, your answer starts out talking about behavior related to <code>cstr</code> but then ends with talking about behavior related to <code>str</code> instead.  Your answer is misleading as worded.  <code>cstr</code> is indeed leaked, as it is allocated on the heap and not freed before <code>main()</code> exits. Only <code>str</code> is freed when it goes out of scope."}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 2, "last_activity_date": 1451494277, "last_edit_date": 1451494277, "creation_date": 1451490152, "answer_id": 34532560, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34532560#34532560", "title": "Does the below code really free memory in C/C++?", "body": "<p>No, it does not mean that <em>remain memory area of str is free</em>.</p>\n\n<hr>\n\n<p><code>strlen(cstr)</code> calculates the length of the string upto a point when a <code>NUL</code> <code>\\0</code> character is encountered.</p>\n\n<p>In the beginning you allocated a char array of length <code>22</code> char. Replacing a <code>char</code> in between with a <code>NUL</code> <code>\\0</code> is only going to make <code>strlen</code> believe that the string is upto <code>5</code> char long. It will not free the other <code>17</code> char that were allocated for the local char array after that replaced char.</p>\n\n<p>The memory for <code>char</code> array <code>str</code> will get get unallocated once the function <code>main()</code> exits (since it is a local array).</p>\n"}, {"tags": [], "owner": {"reputation": 545, "user_id": 760365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a609e2719e17ddaf2ae99133b1447b7?s=128&d=identicon&r=PG&f=1", "display_name": "Pravar Jawalekar", "link": "https://stackoverflow.com/users/760365/pravar-jawalekar"}, "is_accepted": false, "score": 5, "last_activity_date": 1451490225, "creation_date": 1451490225, "answer_id": 34532581, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34532581#34532581", "title": "Does the below code really free memory in C/C++?", "body": "<blockquote>\n  <p>As you see the Len of cstr changed. It mean that remain memory area of\n  cstr is free. Is it right?</p>\n</blockquote>\n\n<p>No. It's not. You allocated memory for array on heap and then inserted <code>\\0</code> at place between array. Because of this, <code>strlen</code> is reporting length of array equals to 5 (because it computes length of char array by looking \\0 character) but memory past that index still exists on heap. To free memory, You need to call <code>delete [] cstr</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 4, "last_activity_date": 1451490313, "creation_date": 1451490313, "answer_id": 34532607, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34532607#34532607", "title": "Does the below code really free memory in C/C++?", "body": "<p>No. <code>new</code> just allocates a chunk of memory of the size you specified. The only way to release it is to call <code>delete</code> on it.</p>\n\n<p><code>strlen</code> is a function that parses memory from a starting address and counts the number of non NUL bytes, such a thing is called a C-string.</p>\n\n<p>Putting a NUL byte somewhere in memory is no different from putting any other value for the memory management.</p>\n"}, {"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 7, "last_activity_date": 1451490486, "creation_date": 1451490486, "answer_id": 34532639, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34532639#34532639", "title": "Does the below code really free memory in C/C++?", "body": "<p>The code is broken from the starts. <code>str</code> is not a nul-terminated string, and as such can't be used with functions expecting those strings, such as <code>strlen</code> or <code>strcpy</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 4, "last_activity_date": 1451492617, "creation_date": 1451492617, "answer_id": 34533217, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c/34533217#34533217", "title": "Does the below code really free memory in C/C++?", "body": "<blockquote>\n  <p>As you see the Len of cstr changed. It mean that remain memory area of cstr is free. Is it right?</p>\n</blockquote>\n\n<p>No.  <code>strlen</code> only returns the length of the string stored within the array, not the size of the array itself.  The length of the string may be anywhere from 0 to <code>strlen(str)</code> - 1, but the size of <code>cstr</code> is always going to be <code>strlen(str)</code>.  </p>\n\n<p>The size of the array does not change just because you stored a smaller string to it, any more than a glass gets smaller if you only fill it half way.  The <em>only</em> way to release the memory pointed to by <code>cstr</code> is to use the <code>delete</code> operator.  </p>\n"}], "owner": {"reputation": 134, "user_id": 4530614, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SO4XjeaHqCE/AAAAAAAAAAI/AAAAAAAAACQ/HFEYERVln4w/photo.jpg?sz=128", "display_name": "alphaplus", "link": "https://stackoverflow.com/users/4530614/alphaplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 34532536, "answer_count": 6, "score": 4, "last_activity_date": 1451494277, "creation_date": 1451489964, "last_edit_date": 1451491267, "question_id": 34532503, "link": "https://stackoverflow.com/questions/34532503/does-the-below-code-really-free-memory-in-c-c", "title": "Does the below code really free memory in C/C++?", "body": "<p>Here is the code:</p>\n\n<pre><code>int main()\n{   \n   char str[] = {'a','b','c',' ','d','e',' ',' ','f',' ',' ',' ','g','h','i',' ',' ',' ',' ','j','k'};\n   cout &lt;&lt; \"Len = \" &lt;&lt; strlen(str) &lt;&lt; endl;\n\n   char* cstr = new char[strlen(str)];\n   strcpy(cstr, str); \n\n   cstr[5] = '\\0';\n\n   cout &lt;&lt; \"Len= \" &lt;&lt; strlen(cstr) &lt;&lt; endl;\n\n   return 0;\n}\n\n//---------------\nResult console:\nLen = 21                                                                                                                                                                        \nLen= 5\n</code></pre>\n\n<p>As you see the Len of cstr changed. It mean that remain memory area of cstr is free. Is it right?</p>\n"}, {"tags": ["c", "linux", "gcc", "arm", "cross-compiling"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451490989, "post_id": 34532481, "comment_id": 56806928, "body": "Show the full error please. And the compiler invocation. BTW, your link is broken."}, {"owner": {"reputation": 478, "user_id": 1498590, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/ddabfaf9422a0bb6979f3dffc55a05c9?s=128&d=identicon&r=PG", "display_name": "Filippo Bistaffa", "link": "https://stackoverflow.com/users/1498590/filippo-bistaffa"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451491404, "post_id": 34532481, "comment_id": 56807162, "body": "Edited the original question"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451491513, "post_id": 34532481, "comment_id": 56807217, "body": "Do you have your toolchain <code>bin</code> directory in the PATH ?"}], "answers": [{"tags": [], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "is_accepted": false, "score": 0, "last_activity_date": 1451493544, "creation_date": 1451493544, "answer_id": 34533441, "question_id": 34532481, "link": "https://stackoverflow.com/questions/34532481/wrong-header-subdir-when-cross-compiling-for-arm/34533441#34533441", "title": "Wrong header subdir when cross-compiling for ARM", "body": "<p>Try modifying <code>cflags</code> as follows in your <code>configure</code> invocation:</p>\n\n<pre><code>--cflags=\"-DOPENSSL_USE_DEPRECATED -nostdinc -nostdinc++\"\n</code></pre>\n"}], "owner": {"reputation": 478, "user_id": 1498590, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/ddabfaf9422a0bb6979f3dffc55a05c9?s=128&d=identicon&r=PG", "display_name": "Filippo Bistaffa", "link": "https://stackoverflow.com/users/1498590/filippo-bistaffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 770, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1451493544, "creation_date": 1451489878, "last_edit_date": 1451491776, "question_id": 34532481, "link": "https://stackoverflow.com/questions/34532481/wrong-header-subdir-when-cross-compiling-for-arm", "title": "Wrong header subdir when cross-compiling for ARM", "body": "<p>I am trying to cross-compile an application (tvheadend) for ARM (raspberry pi 2), using a x64 machine and <a href=\"https://github.com/raspberrypi/tools\" rel=\"nofollow\">this</a> toolchain.</p>\n\n<p>I am using the following command line to configure the compilation:\n<code>./configure --arch=arm-linux-gnueabihf --cc=arm-linux-gnueabihf-gcc --disable-avahi --release --cflags=-DOPENSSL_USE_DEPRECATED</code> and then I just <code>make</code>.</p>\n\n<p>The problem happens during the compilation of the source file <code>src/utils.c</code>: such file includes <code>string.h</code>, which is correctly selected from the toolchain include directory (let's say <code>ARMTOOLCHAIN/usr/include</code>), but then <code>string2.h</code>, which is inside <code>ARMTOOLCHAIN/usr/include/arm-linux-gnueabihf/bits</code>, is selected from the system directory, instead of <code>ARMTOOLCHAIN/usr/include/arm-linux-gnueabihf/bits</code>.</p>\n\n<pre><code>In file included from /usr/include/x86_64-linux-gnu/bits/byteswap.h:35:0,\n                 from ARMTOOLCHAIN/usr/include/endian.h:61,\n                 from /usr/include/x86_64-linux-gnu/bits/string2.h:51,\n                 from ARMTOOLCHAIN/usr/include/string.h:637,\n                 from src/utils.c:21:\nsrc/utils.c: In function \u2018sbuf_put_be16\u2019:\nsrc/utils.c:397:9: error: invalid 'asm': invalid operand for code 'w'\n   u16 = htons(u16);\n         ^\n</code></pre>\n\n<p>The problem is that the compiler does not search inside <code>ARMTOOLCHAIN/usr/include/arm-linux-gnueabihf</code> for the <code>bits</code> subdir. I tried to specify <code>-IARMTOOLCHAIN/usr/include/arm-linux-gnueabihf</code> as an option, and to create a symlink to <code>bits</code> inside <code>ARMTOOLCHAIN/usr/include</code> (so to avoid <code>arm-linux-gnueabihf</code>), but none of these works.</p>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 1, "creation_date": 1451490659, "post_id": 34532445, "comment_id": 56806737, "body": "What exactly throws you off? <code>memset</code> or <code>list-&gt;destroy</code> or something else?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1451490918, "post_id": 34532445, "comment_id": 56806890, "body": "You&#39;ve not shown how the <code>List</code> structure is defined.  Zeroing the structure may be legitimate.  It marks it as unusable until it is initialized again..  Maybe this code cannot tell whether the list structure it was given was allocated (and hence is freeable) or not.  Without a good deal more context, it is not possible to be definitive. It is unusual; it is not automatically wrong."}, {"owner": {"reputation": 3531, "user_id": 1174521, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a6bc053ffba8996e41c0bbb9a9ce36a?s=128&d=identicon&r=PG", "display_name": "jbg", "link": "https://stackoverflow.com/users/1174521/jbg"}, "edited": false, "score": 0, "creation_date": 1451491156, "post_id": 34532445, "comment_id": 56807015, "body": "<code>memset</code> doesn\u2019t free allocated memory, it writes over it with a value (zeroes in this case). The other functions called by <code>list_destroy</code> may <code>free</code> some internal storage, but at the end of this function, <code>list</code> will still be a valid pointer, but all the fields of the structure will contain zeroes. What is this function documented as doing?"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451492769, "post_id": 34532445, "comment_id": 56807905, "body": "@BenediktGruber: you have erased data by memset but you have not freed it. Memory is still allocated"}], "answers": [{"tags": [], "owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "is_accepted": false, "score": 2, "last_activity_date": 1451504400, "last_edit_date": 1451504400, "creation_date": 1451491152, "answer_id": 34532828, "question_id": 34532445, "link": "https://stackoverflow.com/questions/34532445/linked-destroy-with-memset/34532828#34532828", "title": "linked destroy with memset", "body": "<p>I\u2019m not exactly sure what throws you off, so let\u2019s discuss that code.</p>\n\n<pre><code>while (list_size(list) &gt; 0) \n</code></pre>\n\n<p>While there are items in the list we repeat the following block. Doesn\u2019t look unusual to me. So let\u2019s proceed.</p>\n\n<pre><code>if (list_rem_next(list, NULL, (void **)&amp;data) == 0 &amp;&amp; list-&gt;destroy != NULL) {\n</code></pre>\n\n<p>Ok, a function <code>list_rem_next</code> is called. I can only guess what it does, but likely it removes some element from the list and store the <em>data</em> of this removed element into the <code>data</code> variable. </p>\n\n<p>Next we check whether <code>list-&gt;destroy</code> is not null. Obviously that\u2019s a function pointer which can free-up the data structure. (So if the items in the list were malloc\u2019d this would point to <code>free</code>)</p>\n\n<pre><code>list-&gt;destroy(data);\n</code></pre>\n\n<p>If this is a valid pointer execute the function and pass the <em>data</em> to destroy.</p>\n\n<pre><code>memset(list, 0, sizeof(List));\n</code></pre>\n\n<p>Finally the <em>list</em> structure gets zeroed. A bit strange, but why not. This simply writes 0 from <code>list</code> to as many bytes as specified by the 3rd argument. </p>\n"}, {"tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 1, "last_activity_date": 1451614313, "creation_date": 1451614313, "answer_id": 34553063, "question_id": 34532445, "link": "https://stackoverflow.com/questions/34532445/linked-destroy-with-memset/34553063#34553063", "title": "linked destroy with memset", "body": "<p>Presumably the <code>list-&gt;destroy</code> function is doing the \"free\".</p>\n\n<p>In a perfectly constructed program there would be no reason zero-out memory that you are no longer using.  But you will sometimes see code like this:</p>\n\n<pre><code>memset(list, 0, sizeof(List));\n</code></pre>\n\n<p>or even something like this:</p>\n\n<pre><code>memset(list, 0x53, sizeof(List));      /* or some other \"curious\" value */\n</code></pre>\n\n<p>as a way to catch malformed programs which try to access memory after it is freed.  The idea being that the zeros (or weird values) are more likely to cause the program to die as soon as the previously-freed memory is accessed than if it had \"good data\" still there (kind of a primitive \"booby trap\").</p>\n"}], "owner": {"reputation": 19, "user_id": 5530815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340d03a76f79a92d1ef9b641da9c7a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Benedikt Gruber", "link": "https://stackoverflow.com/users/5530815/benedikt-gruber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451614313, "creation_date": 1451489692, "last_edit_date": 1451490608, "question_id": 34532445, "link": "https://stackoverflow.com/questions/34532445/linked-destroy-with-memset", "title": "linked destroy with memset", "body": "<p>I have found this in a book I bought, which is about algorithms.</p>\n\n<p>I would like to know if it\u2019s allowed through the C99 standard\nto destroy linked lists like this or are there any conventions that say that this is stupid?</p>\n\n<pre><code>void list_destroy(List *list) {\n   void *data;\n   while (list_size(list) &gt; 0) {\n       if (list_rem_next(list, NULL, (void **)&amp;data) == 0 &amp;&amp; list-&gt;destroy != NULL) {\n           list-&gt;destroy(data);\n       }\n   }\n   memset(list, 0, sizeof(List));\n   return;\n}\n</code></pre>\n\n<p>Why does this work? I learned to free allocated memory with free()?</p>\n"}, {"tags": ["c#", "c++", "c", "compact-framework", "pinvoke"], "comments": [{"owner": {"reputation": 64987, "user_id": 13154, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/13587943fa82922af31198ddd875d77f?s=128&d=identicon&r=PG", "display_name": "ctacke", "link": "https://stackoverflow.com/users/13154/ctacke"}, "edited": false, "score": 0, "creation_date": 1451495297, "post_id": 34531974, "comment_id": 56809319, "body": "How is the C++ binary loading the C# assembly?  Is this from a callback and the process itself is managed code?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451501512, "post_id": 34531974, "comment_id": 56812430, "body": "I&#39;d use a COM BSTR. That said, allocating on the C++ side is a good option. You should not be saying that&#39;s no good without a deeper understanding of this topic."}, {"owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "edited": false, "score": 0, "creation_date": 1451550711, "post_id": 34531974, "comment_id": 56828578, "body": "@ctake Actually it&#39;s a Windows Forms application. The C# handles the GUI, but all the rest of the work is done by the native code."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451679790, "post_id": 34531974, "comment_id": 56862886, "body": "You still have not explained the mechanism by which your C++ code is called, and the mechanism by which the C# code is called from your C++ code. These are crucial details in an interop question."}], "answers": [{"tags": [], "owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "is_accepted": true, "score": -1, "last_activity_date": 1451561466, "creation_date": 1451561466, "answer_id": 34545850, "question_id": 34531974, "link": "https://stackoverflow.com/questions/34531974/call-c-from-native-to-retrieve-a-string/34545850#34545850", "title": "Call C# from native to retrieve a String", "body": "<p>Actually it seems that no C# function can return something when called from C++.\n<strong>Any return type oher than void</strong> will cause a NotSupportedException to be thrown.</p>\n\n<p>I did not find evidence of this in the MSDN documentation, but after lots of testing it seems that it's how it works, at least with the <strong>compact framework</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 5853, "user_id": 1479943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d518018828cbe7c98d450f69faac65b6?s=128&d=identicon&r=PG", "display_name": "josef", "link": "https://stackoverflow.com/users/1479943/josef"}, "is_accepted": false, "score": 0, "last_activity_date": 1451630957, "last_edit_date": 1495539961, "creation_date": 1451630957, "answer_id": 34554166, "question_id": 34531974, "link": "https://stackoverflow.com/questions/34531974/call-c-from-native-to-retrieve-a-string/34554166#34554166", "title": "Call C# from native to retrieve a String", "body": "<p>The question was asked already at stackoverflow and other sides. </p>\n\n<p>One stackoverflow post is at <a href=\"https://stackoverflow.com/questions/9552498/calling-a-c-sharp-function-from-a-c-dll\">Calling a C# function from a C++ DLL</a>. </p>\n\n<p>The linked solutions use CallingConvention.StdCall which is available in CF but you can use CallingConvention.WinApi instead which translates to CallingConvention.StdCall according to this site \n<a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention%28v=vs.90%29.aspx</a></p>\n\n<p>You can also use other interop techniques like custom messages (SendMessage) between the windows and forms handles.</p>\n\n<p>To expose managed components to C++ use COM (see <a href=\"https://msdn.microsoft.com/en-us/library/zsfww439%28v=vs.80%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/zsfww439%28v=vs.80%29.aspx</a>)</p>\n"}], "owner": {"reputation": 7126, "user_id": 1560774, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e5c7d8e9733ac6dee89d29d0cd0123f4?s=128&d=identicon&r=PG", "display_name": "Virus721", "link": "https://stackoverflow.com/users/1560774/virus721"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 34545850, "answer_count": 2, "score": 0, "last_activity_date": 1482631219, "creation_date": 1451487933, "last_edit_date": 1482631219, "question_id": 34531974, "link": "https://stackoverflow.com/questions/34531974/call-c-from-native-to-retrieve-a-string", "title": "Call C# from native to retrieve a String", "body": "<p>I've been stuck on this all day, but it seems like it is not possible, at least using the <strong>compact framework</strong>, to call from the native code a C# method that <strong>returns</strong> a String.</p>\n\n<p>I've seen several exemples about passing data from and to native code, but none of the examples were using return values.</p>\n\n<p>What I would like to do is have a C# function that <strong>returns a string</strong>, so that i can pull that from C# back into C++, i.e call C# from C++ and not the other way.</p>\n\n<pre><code>String GetSomeString() { return \"foo\"; } // C#\n</code></pre>\n\n<p>And call this function from native code which would have a signature like :</p>\n\n<pre><code>typedef const wchar_t * (__stdcall * native_func_t)();\n</code></pre>\n\n<p>The problem with this is that it just doesn't work. A NotSupportedException is thrown when I pass my delegate to the native code. However if I replace the String return type by void it works perfectly.</p>\n\n<p>The other solutions would be :</p>\n\n<ul>\n<li><p>Call C# from C++ to get the string length, allocate that string on C++, pass it to the C# and make it fill the buffer using unsafe code. But this is dirty and unpractical, so I won't do that.</p></li>\n<li><p>Make the C# function call a C++ that will store the result somewhere, and, in the native code, retrieve that result where it was stored once the call to the C# has returned. But this is also very ugly and unpractical.</p></li>\n</ul>\n\n<p>Do you see another way to do that please ?</p>\n"}, {"tags": ["c", "matrix"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 5, "creation_date": 1451487871, "post_id": 34531918, "comment_id": 56805263, "body": "What text or who suggested using <code>while(!feof(...</code>?"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 1, "creation_date": 1451488294, "post_id": 34531918, "comment_id": 56805472, "body": "... see this post: <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1451488356, "post_id": 34531918, "comment_id": 56805504, "body": "<code>buffer = malloc(4096);</code> + <code>memset(buffer, 0, 4096);</code> + <code>free(buffer);</code> all in the same loop? Why not allocate the buffer once, and just <code>memset</code> it, and free outside the loop. Or better yet: <code>buffer[0] = &#39;\\0&#39;;</code> and/or use <code>fgets</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1451488381, "post_id": 34531918, "comment_id": 56805519, "body": "I suggest avoiding the incorrect use of <code>feof</code> by reading each line with <code>while(fgets(...) != NULL)</code> and then using <code>strtok</code> to extract the fields from the input string. But watch out when you have a multi-word city like <code>Los Angeles</code>. You might be better reconsidering the field delimiter you use, such as a comma or a tab."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451488577, "post_id": 34531918, "comment_id": 56805625, "body": "You could read a line and iterate through the characters until a number is found."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451489414, "post_id": 34531918, "comment_id": 56806030, "body": "Why do you use a dash as a nul value, wouldn&#39;t 0 work well? Or do you have to process the data as it is?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1451491420, "post_id": 34531918, "comment_id": 56807171, "body": "Posting with &quot;I would be very grateful if someone could help me!&quot;, leaving the post for an hour with no replies sees like a one-sided help."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451489169, "post_id": 34532234, "comment_id": 56805912, "body": "This might be true, but it does not answer the question"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451489388, "post_id": 34532234, "comment_id": 56806019, "body": "Where are the city names?"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451489513, "post_id": 34532234, "comment_id": 56806077, "body": "he wants to display only <code>mat[i][j]</code>, so it is impossible to display them because mat is <code>double**</code> with his code, it is replaced by <code>0</code>"}, {"owner": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "edited": false, "score": 0, "creation_date": 1451572721, "post_id": 34532234, "comment_id": 56837466, "body": "Thank you for your answer!!"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "edited": false, "score": 0, "creation_date": 1451599384, "post_id": 34532234, "comment_id": 56846373, "body": "@S.Proa - an <i>upclick</i> is a welcome surrogate for <i>Thank you</i> in Stackoverflow.  If you liked <i>developer&#39;s</i> answer, click the little up arrow to the upper left of this answer."}, {"owner": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451728071, "post_id": 34532234, "comment_id": 56872516, "body": "@ryyker: Done! Thanks ^^"}], "tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": false, "score": 1, "last_activity_date": 1451556530, "last_edit_date": 1451556530, "creation_date": 1451488946, "answer_id": 34532234, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34532234#34532234", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>At first, you have a incorrect free you can look below:</p>\n\n<pre><code>for(i=0; i&lt;rows; i++)\n{\n    for(j=0; j&lt;cols; j++)\n    {\n        printf(\"%g%s\", mat[i][j], j&lt;cols-1 ? \"\\t\" : \"\\n\");\n        /*free(mat[i]); this will be executed several time and the program will crash*/ \n    }\n    free(mat[i]);\n}\nfree(mat);\n</code></pre>\n\n<p>I have update your code for displaying all desired data:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;malloc.h&gt;\n\n#define rows 6\n#define cols 6\n\nint main()\n{\n    FILE *nansa;\n    char *buffer;\n    int ret,row=0,i,j,len=0,maxlen=0;\n\n    char delims[]=\" \\t\";\n    char *result=NULL;\n\n    double **mat=malloc( rows*sizeof(double*) );\n    for(i=0; i&lt;rows; i++)\n    {\n        mat[i]=malloc( cols*sizeof(double) ); \n    }\n\n    char **cities = (char **)malloc( rows*sizeof(char *) );\n    for(i=0; i&lt;rows; i++)\n    {\n        cities[i]=(char *)malloc(sizeof(char)*4095); \n    }\n\n    if ((nansa=fopen(\"dist.txt\",\"r\"))==NULL)\n    {\n        fprintf(stdout, \"Error\\n\"); \n        return -1;\n    }\n    while(!feof(nansa))\n    {\n        buffer=malloc( sizeof(char)*4096 );\n        memset(buffer,0,4096);\n        ret=fscanf(nansa, \"%4095[^\\n]\\n\", buffer);\n        if(ret != EOF) \n        {\n            int field=0;\n            result=strtok(buffer,delims);\n            while(result != NULL)\n            {\n                if(field&gt;5) break;\n                if(field == 0)\n                {\n                    strcpy(cities[row], result);\n                    len = strlen(result);\n                    if(len&gt;maxlen)\n                        maxlen=len;\n                }\n                mat[row][field]=atof(result);\n                result=strtok(NULL,delims);\n                field++;\n            }\n            ++row;\n        }\n        free(buffer);\n    }\n    fclose(nansa);\n    for(i=0; i&lt;cols; i++)\n    {\n        printf(\"%-*s%s\", maxlen, cities[i], (i&lt;cols-1) ? \" \" : \"\\n\");\n    }\n    for(i=1; i&lt;rows; i++)\n    {\n        printf(\"%-*s \", maxlen, cities[i]);\n        for(j=1; j&lt;cols; j++)\n        {\n            printf(\"%-*g%s\", maxlen, mat[i][j], (j&lt;cols-1) ? \" \" : \"\\n\");\n        }\n    }\n    for(i=0; i&lt;rows; i++)\n    {\n        free(cities[i]);\n        free(mat[i]);\n    }\n    free(mat);\n    return 0;\n}\n</code></pre>\n\n<p>And the result will be like this:</p>\n\n<pre><code>Distance  Amsterdam Antwerp   Athens    Barcelona Berlin   \nAmsterdam 0         160       3082      1639      649      \nAntwerp   160       0         2766      1465      723      \nAthens    3082      2766      0         3312      2552     \nBarcelona 1639      1465      3312      0         1899     \nBerlin    649       723       2552      1899      0        \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96306, "user_id": 3250829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e2e07c34e170453eeea9e937a98f19b?s=128&d=identicon&r=PG", "display_name": "rayryeng", "link": "https://stackoverflow.com/users/3250829/rayryeng"}, "edited": false, "score": 0, "creation_date": 1458059107, "post_id": 34532665, "comment_id": 59685003, "body": "Because you don&#39;t provide <b>how</b> to use it.  The question is concerned with parsing through several lines of text.  This is akin to saying that if you wanted to solve a mathematical equation, you are to use say Pythagorean&#39;s theorem... but you don&#39;t mention <b>how to use it</b>.  Take a look at the other answers in the post and compare the quality of the answers with your answer.... do you feel that you sufficiently solved the problem with your answer?"}], "tags": [], "owner": {"reputation": 7, "user_id": 5626255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6890b883b1a88639bb44520b3747e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "Dimos", "link": "https://stackoverflow.com/users/5626255/dimos"}, "is_accepted": false, "score": -2, "last_activity_date": 1451742778, "last_edit_date": 1451742778, "creation_date": 1451490595, "answer_id": 34532665, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34532665#34532665", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>See the usage of <code>strtok()</code>!!</p>\n\n<p>You can separate them with <code>strtok()</code>. You get everything as string, but then you make the distances to <code>int</code> with: - <code>'0'</code></p>\n"}, {"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451491486, "post_id": 34532720, "comment_id": 56807196, "body": "Well, the program can read the first line of the file to determine how many city are there, then allocate the right space in memory and read each distance in a nested loop (I&#39;m not the down voter BTW)."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451491716, "post_id": 34532720, "comment_id": 56807328, "body": "Yes, I suppose there are a million ways to improve.  The stated intent is limited to addressing the question about separating strings and numbers. allocating memory and additional looping would have clouded that simple part.  Thanks."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451491764, "post_id": 34532720, "comment_id": 56807358, "body": "It would be nice to take advantage of the simmetry of matrix of distances too ( I could do that in c++ more easily)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1451502014, "post_id": 34532720, "comment_id": 56812704, "body": "@Bob__ - Regarding using C++ to take advantage of symmetry, I appreciate that, and I am sure you could. But 2 things: First, the OP has tagged this post as C, so I felt constrained to keep it in C. Second, the focus of this answer is clearly stated. I hope it helps the OP to understand parsing differing data types into a C array. (or as OP said a matrix). Some of the other answers have addressed the answer to this post more broadly, and do an excellent job presenting many other techniques. Thanks for your comment!"}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1451598951, "last_edit_date": 1495535636, "creation_date": 1451490773, "answer_id": 34532720, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34532720#34532720", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p><em>...And I don't know how to separate the names and the distances (chars and integers)...</em></p>\n\n<p>Focusing only on <em>file reading</em>, <em>data parsing</em> and <em>data storage</em>...  </p>\n\n<p>Identifying features of your text file is an important step in helping you decide the approach you will take in <strong><em><a href=\"https://stackoverflow.com/questions/18183633/string-parsing-in-c-using-strtok\">parsing</a></em></strong> your data into variables.</p>\n\n<p>Your text file can be broken into the following:    </p>\n\n<ul>\n<li>The first row is a header  </li>\n<li>Each additional row contains data (cities and distances)</li>\n<li>cities are in first column only (non numeric (string) only)</li>\n<li>remaining columns contain distances (numeric and non-numeric)</li>\n</ul>\n\n<p>While the data is all stored in a text file, and initially read as strings, you express you would like to store them as strings and numbers.  The city names are strings and the distances as integers. But the distances section also contains non-numeric data: \"-\".</p>\n\n<p>storing multiple data types can be done using a <code>struct</code>.  The following code illustrates how you can parse then store the numbers and strings separately using a struct.  </p>\n\n<p><strong><em>Note</em></strong>: The following example is intended to illustrate how you might <em>separate the names and the distances</em> from the text file.  Error checking/handling is minimal.    </p>\n\n<p>As opposed to printing data out, I will leave an image showing a memory segment of how the data was stored, using an array of <code>struct</code>. (supporting your request to <em>save the data in it in a matrix in C</em>).</p>\n\n<pre><code>enum {\n    AM,\n    AN,\n    AT,\n    BA,\n    BE,\n    MAX_CITY\n};\n\ntypedef struct {//create a way to store both strings and numeric data\n    char city[20];\n    int dist[MAX_CITY];\n}DIST;\n\nDIST dist[MAX_CITY];//array (matrix) of struct DIST for storing results.\n\nint main(void)\n{\n    int i;\n    FILE *fp = {0};\n    char *tok = {0};\n    char line[260];\n    fp = fopen(\".\\\\dist.txt\", \"r\");\n    if(fp)\n    {\n        i = 0;\n        fgets(line, 260, fp); //consume first line - header information\n        while(fgets(line, 260, fp))\n        {\n            tok = strtok(line, \" \\t\\n\");\n            if(tok)\n            {\n                strcpy(dist[i].city, tok);//get city    \n            }\n            tok = strtok(NULL, \" \\t\\n\");\n            if(tok)\n            {\n                if(strstr(tok, \"-\")) dist[i].dist[0] = 0;\n                else dist[i].dist[0] = atoi(tok);//get city 1 dist  \n            }\n            tok = strtok(NULL, \" \\t\\n\");\n            if(tok)\n            {\n                if(strstr(tok, \"-\")) dist[i].dist[1] = 0;\n                else dist[i].dist[1] = atoi(tok);//get city 2 dist  \n            }\n            tok = strtok(NULL, \" \\t\\n\");\n            if(tok)\n            {\n                if(strstr(tok, \"-\")) dist[i].dist[2] = 0;\n                else dist[i].dist[2] = atoi(tok);//get city 3 dist  \n            }\n            tok = strtok(NULL, \" \\t\\n\");\n            if(tok)\n            {\n                if(strstr(tok, \"-\")) dist[i].dist[3] = 0;\n                else dist[i].dist[3] = atoi(tok);//get city 4 dist  \n            }\n            tok = strtok(NULL, \" \\t\\n\");\n            if(tok)\n            {\n                if(strstr(tok, \"-\")) dist[i].dist[4] = 0;\n                else dist[i].dist[4] = atoi(tok);//get city 5 dist  \n            }\n            i++;\n        }\n        fclose(fp);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong><em>Snippet of results</em></strong> (contents of struct after execution)  </p>\n\n<p><a href=\"https://i.stack.imgur.com/tXhv4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tXhv4.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451494344, "post_id": 34533510, "comment_id": 56808782, "body": "I really don&#39;t like your coding style (<i>for example: lower case macros?</i>), but your code is very good. One suggestion use the <code>&quot;%n&quot;</code> modifier in <code>scanf()</code>&#39;s so you avoid <code>strlen()</code>. It would improve performance for a very large file. Also, your solution wouldn&#39;t work if a city name has a white space in it. But the intent of the program is quite clear."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451494498, "post_id": 34533510, "comment_id": 56808872, "body": "@iharob I commented above the code about a two-word city name. Any helpful suggestions about my style apart from &quot;really don&#39;t like it&quot;?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451494555, "post_id": 34533510, "comment_id": 56808896, "body": "lower case macros - mybad, I usually use upper but copied OP style."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451494588, "post_id": 34533510, "comment_id": 56808918, "body": "Also, you have inconsistent white space usage."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451494688, "post_id": 34533510, "comment_id": 56808977, "body": "@iharob I previously noticed a difference in your style. I like to have a space each side of an operator, except in <code>for</code> statements (I seen you edit them before!) it seems to me to flow better, that&#39;s just my style. Also I like a space to separate function arguments."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1451495162, "post_id": 34533510, "comment_id": 56809244, "body": "@iharob I&#39;ve been evovling my coding style since being here. Two aspects: I would always like a space after <code>if</code> and <code>for</code> and <code>while</code> but many don&#39;t seem to have it (yes my post does inconsistently have one). The major change was my previous dislike of having the <code>{</code> at the right. It makes a code block much harder to eye up than having the <code>{</code> and the <code>}</code> align vertically, <i>in line with the code block itself</i> and not 4 spaces to the left, since the braces are actually part of the code block. But I&#39;ve changed that to suit the current style."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451495306, "post_id": 34533510, "comment_id": 56809326, "body": "OT, maybe, you can also right justify the printed numbers... ;)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451495357, "post_id": 34533510, "comment_id": 56809347, "body": "@Bob__ that would be a simple shange, not really relevant to the question."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451495435, "post_id": 34533510, "comment_id": 56809394, "body": "I know, but you were talking about styles"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1451495554, "post_id": 34533510, "comment_id": 56809452, "body": "Goodness me coding style was commented on. That&#39;s the output format not coding style."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451495812, "post_id": 34533510, "comment_id": 56809616, "body": "Actually, formatting of coding style, but it&#39;s irrelevant. More on topic, you can find out the number of city counting the numbers ( plus the &#39;-&#39; ) in the second row of the file."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451521030, "post_id": 34533510, "comment_id": 56820753, "body": "@ryyker I am sorry, it&#39;s not my intention."}, {"owner": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "edited": false, "score": 0, "creation_date": 1451572465, "post_id": 34533510, "comment_id": 56837344, "body": "Thank you very much!! This code is really helpful!! And for names with a multi word name such as Los Angeles I will simply write LosAngeles in the .txt file. Thank you so much!! :D"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "edited": false, "score": 0, "creation_date": 1451572798, "post_id": 34533510, "comment_id": 56837497, "body": "@S.Proa please &quot;accept&quot; whichever answer you feel was the best, thank you."}, {"owner": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "edited": false, "score": 0, "creation_date": 1451728207, "post_id": 34533510, "comment_id": 56872557, "body": "@Weather Vane: Done! Thank you so much! :)"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 5, "last_activity_date": 1451494399, "last_edit_date": 1451494399, "creation_date": 1451493776, "answer_id": 34533510, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34533510#34533510", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>Although it is tempting to use <code>fgets</code> to read each line (<code>feof</code> is wrong), the question is only an example with a small number of cities: perhaps there are 10000. So I have made an assumption that the name of any city is less than 64 (for input only). The memory reserved is correct for the name's actual length. </p>\n\n<p>The rows and columns will be the same, so there is no point having different defines: in fact I define only the number of cities. I use separate arrays for the city names (same across as down) and the distances.</p>\n\n<p>To keep it simple, I have done error checking, but aborted without a message. But where it will need to be modified is when the city is a multi word name such as Los Angeles (<code>%s</code> stops at any whitespace).  You'll need a different method then, or perhaps use an underscore to break a city_name.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define cities 5\n\nint main(void){\n\n    FILE *nansa;\n    char buffer[64];\n    char distname[64];                      // just to save work\n    char *city[cities];                     // city names\n    int *dist[cities];                      // distance array\n    int i, j, len, wid = 0;\n\n    if((nansa = fopen(\"dist.txt\",\"r\")) == NULL)\n        exit(1);                            // file open fault\n\n    // read the headings\n    if(fscanf(nansa, \"%63s\", buffer) != 1)  // read the word for \"distance\"\n        exit(1);                            // fscanf fault\n    strcpy(distname, buffer);\n\n    for(i=0; i&lt;cities; i++) {               // read the city names\n        if(fscanf(nansa, \"%63s\", buffer) != 1)\n            exit(1);                        // fscanf fault\n        len = strlen(buffer) + 1;\n        if (wid &lt; len)\n            wid = len;                      // column width\n        if((city[i] = malloc(len)) == NULL) // memory for city name\n            exit(1);                        // malloc fault\n        strcpy(city[i], buffer);\n    }\n\n    // read the data\n    for(j=0; j&lt;cities; j++) {               // read each table line\n        if((dist[j] = malloc(cities * sizeof(int))) == NULL)    // memory for distance chart\n            exit(1);                        // malloc fault\n        if(fscanf(nansa, \"%s\", buffer) != 1)   // skip the city name\n            exit(1);                        // fscanf fault\n        for(i=0; i&lt;cities; i++) {           // read each table line\n            if(fscanf(nansa, \"%63s\", buffer) != 1)  // read the distance\n                exit(1);                    // fscanf fault\n            dist[j][i] = atoi(buffer);\n        }\n    }\n\n    fclose(nansa);\n\n    // display the table headings\n    printf(\"%-*s\", wid, distname);          // use the terminology in the file\n    for(i=0; i&lt;cities; i++)                 // each city name\n        printf(\"%-*s\", wid, city[i]);\n    printf(\"\\n\");\n\n    // display each line\n    for(j=0; j&lt;cities; j++) {\n        printf(\"%-*s\", wid, city[j]);       // start with city name\n        for(i=0; i&lt;cities; i++) {           // each table data\n            if(dist[j][i])\n                printf(\"%-*d\", wid, dist[j][i]);\n            else\n                printf(\"%-*c\", wid, '-');\n        }\n        printf(\"\\n\");\n\n    }\n\n    // free the memory\n    for(i=0; i&lt;cities; i++) {\n        free (city[i]);\n        free (dist[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>Distance  Amsterdam Antwerp   Athens    Barcelona Berlin\nAmsterdam -         160       3082      1639      649\nAntwerp   160       -         2766      1465      723\nAthens    3082      2766      -         3312      2552\nBarcelona 1639      1465      3312      -         1899\nBerlin    649       723       2552      1899      -\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1451497694, "last_edit_date": 1451497694, "creation_date": 1451494076, "answer_id": 34533591, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34533591#34533591", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>The solution I think, is to ignore the header line completely and extract city names from the rows then after the first <em>digit</em> or <code>-</code> is found start scanning for values with <a href=\"http://man7.org/linux/man-pages/man3/strtod.3.html\" rel=\"nofollow\"><code>strtod()</code></a>. This solution that I just wrote is far from complete. It requires more structure (<em>the use of functions would help</em>), and sanity check (<em>for example the number for columns in each row is not necessarily the same</em>). But I think it will take you in the right direction.</p>\n\n<p>Why to ignore the header line? Because it's not clear what character separates a city name from another and cities often contain white spaces in their name, for example \"<em>Los Angeles</em>\" does. This approach will work regardless of the separator and whether city names contain spaces or not.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stddef.h&gt;\n\nint main()\n{\n    char *pointer;\n    FILE *nansa;\n    char buffer[1024];\n    char **cities;\n    double **distances;\n    size_t rows;\n    nansa = fopen(\"dist.txt\", \"r\");\n    if (nansa == NULL)\n        return -1;\n    if (fgets(buffer, sizeof(buffer), nansa) == NULL)\n        return -1; // Skip the header line.\n    rows = 0;\n    distances = NULL;\n    cities = NULL;\n    while (fgets(buffer, sizeof(buffer), nansa) != NULL)\n    {\n        char next;\n        double value;\n        void *aux;\n        ptrdiff_t length;\n        size_t column;\n\n        pointer = buffer;\n        next = *pointer;        \n        while ((isdigit((unsigned char) next) == 0) &amp;&amp; (next != '-'))\n            next = *pointer++;            \n        aux = realloc(cities, (rows + 1) * sizeof(*cities));\n        if (aux == NULL)\n            return -1; // allocation error ABORT\n        length = pointer - buffer - 1;\n        cities = aux;\n        cities[rows] = malloc(length + 1);\n        if (cities[rows] == NULL)\n            return -1; // allocation error ABORT                        \n        memcpy(cities[rows], buffer, length);\n        // Remove trailing spaces\n        while ((length &gt; 0) &amp;&amp; (isspace((unsigned char) cities[rows][length - 1]) != 0))\n            --length;\n        cities[rows][length] = '\\0';\n        if (isspace(next) == 0)\n            pointer--;\n        aux = realloc(distances, (rows + 1) * sizeof(*distances));\n        if (aux == NULL)\n            return -1;\n        distances = aux;\n        column = 0;\n        distances[rows] = NULL;\n        while ((*pointer != '\\0') &amp;&amp; (*pointer != '\\n')) \n        {\n            char *endptr;\n            aux = realloc(distances[rows], (column + 1) * sizeof(**distances));\n            if (aux == NULL)\n                return -1;\n            distances[rows] = aux;\n            value = strtod(pointer, &amp;endptr);\n            if (*endptr == '-')\n                distances[rows][column] = -1.0;\n            else\n                distances[rows][column] = value;\n            while ((*endptr != '\\0') &amp;&amp; (isspace((unsigned char) *(endptr + 1)) != 0))\n                ++endptr;\n            pointer = ++endptr;\n            column += 1;\n        }\n        rows += 1;\n    }\n\n    fprintf(stdout, \"%-15s|\", \"Distance\");\n    for (size_t i = 0 ; i &lt; rows ; ++i)\n        fprintf(stdout, \" %-14s|\", cities[i]);\n    fputc('\\n', stdout);\n    for (size_t i = 0 ; i &lt; rows ; ++i)\n    {\n        fprintf(stdout, \"%-15s|\", cities[i]);\n        for (size_t j = 0 ; j &lt; rows ; ++j)\n        {\n            if (distances[i][j] &lt; 0.0) // Invalid distance\n                fprintf(stdout, \"%15s|\", \"-\");\n            else\n                fprintf(stdout, \"%15.2f|\", distances[i][j]);\n        }\n        free(distances[i]);\n        free(cities[i]);\n        fputc('\\n', stdout);\n    }\n    free(distances);\n    free(cities);\n\n    fclose(nansa);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1451600833, "post_id": 34534420, "comment_id": 56846735, "body": "nice approach.  Especially like how you broke apart the monolithic <code>main()</code>  with the <code>getcell()</code> function."}], "tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 3, "last_activity_date": 1451497291, "creation_date": 1451497291, "answer_id": 34534420, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c/34534420#34534420", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>This seems to be one of the questions that invite a lot of fresh solutions that are rewritten from scratch. Here's one that allows any number of cities up to a certain maximum and that enforces matching city names.</p>\n\n<p>The core is a home-brew function <code>getcell</code> that is similar to <code>scanf(\"%s\", ...)</code>, but that emits a special return value when one or more new-line characters were read. This allows to get theb rows and columns right without having to read the whole line, which may be very long.</p>\n\n<p>Because the function reads from the file directly and because both whitespace and tokens must be looked at, the first non-matching character is consumed. To avoid this, <code>ungetc</code> is used, but never more than once. I don't think that this is especially good style, but I've left it as is. (That style is effortless when you work with strings and pointers, but not with files.)</p>\n\n<p>The code to read the distances checks consistency between rows and cols and cities aggressivly, but skips the checks for file I/O and allocation in order not to clutter the code more.</p>\n\n<p>The city names must be single words (<code>LeMans</code> or <code>Los_Angeles</code>) and are stored in a separate, fixed-size array. (That fixed size is the reason why there is a max. number of cities.) The distances are stored in a dynamically allocated array of <code>doubles</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_CITY 256        // Max. number of cities\n#define MAX_NAME 24         // Buffer allocated for a name\n#define NEWLINE -2          // Special token: end of line was read\n\n/*\n *      Short-cut acro for string comparison\n */\n#define is(a, b) (strcmp(a, b) == 0)\n\n/*\n *      Quick-and-dirty exit macro with message\n */\n#define die(...) exit((printf(__VA_ARGS__), putchar('\\n'), 1))\n\n\n\n/*\n *      Read a cell of at most (max - 1) characters and return its length.\n *      When the end of input is read, return the special value EOF; when\n *      one ore more new-line characters are read, return the special\n *      value NEWLINE. On EOF and NEWLINE, the contents of buf are\n *      undefined.\n */\nint getcell(FILE *f, char *buf, size_t max)\n{\n    size_t len = 0;\n    int nl = 0;\n    int c;\n\n    /*\n     *      Skip leading whitespace and account for newlines\n     */\n    for (;;) {\n        c = fgetc(f);\n\n        if (c == EOF) {\n            if (nl) break;\n            return EOF;\n        }\n        if (!isspace(c)) break;\n        if (c == '\\n') nl++;\n    }\n\n    ungetc(c, f);\n    if (nl) return NEWLINE;\n\n    /*\n     *      Store the token proper\n     */\n    for (;;) {\n        c = fgetc(f);\n\n        if (c == EOF || isspace(c)) break;\n        if (len + 1 &lt; max) buf[len++] = c;\n    }\n\n    ungetc(c, f);\n    buf[len] = '\\0';\n\n    return len;\n}\n\nint main()\n{\n    FILE *f = fopen(\"dist.txt\", \"r\");\n    int nrow = -1;\n    int ncol = -1;\n\n    char city[MAX_CITY][MAX_NAME];\n    int ncity = 0;\n\n    double *data;           // contiguous data block\n    double **dist;          // Pointers into that block\n\n    for (;;) {\n        char buf[MAX_NAME];\n        int len = getcell(f, buf, sizeof(buf));\n\n        if (len == EOF) break;\n\n        if (len == NEWLINE) {\n            if (nrow &gt;= 0 &amp;&amp; ncol &lt; ncity) {\n                die(\"Insufficient data for %s.\", city[nrow]);\n            }\n\n            nrow++;\n            ncol = -1;\n\n            continue;\n        }\n\n        if (nrow &lt; 0) {\n            if (ncol &lt; 0) {\n                if (!is(buf, \"Distance\")) die(\"Wrong file format\");\n            } else {\n                if (ncol &gt;= MAX_CITY) {\n                    die(\"Can have at most %d cities\", MAX_CITY);\n                }\n                strcpy(city[ncity++], buf);\n            }\n\n            ncol++;\n            continue;\n        }\n\n        if (ncol &lt; 0) {\n            if (nrow &gt; ncity) {\n                die(\"Too many rows, expected only %d.\", ncity);\n            }\n\n            if (!is(buf, city[nrow])) {\n                die(\"Expected '%s' in row %d.\", city[nrow], nrow);\n            }\n\n            if (nrow == 0) {\n                // First-touch allocation\n                data = malloc(ncity * ncity * sizeof(*data));\n                dist = malloc(ncity * sizeof(*dist));\n\n                for (int i = 0; i &lt; ncity; i++) {\n                    dist[i] = &amp;data[i * ncity];\n                }\n            }\n        } else {\n            if (nrow == ncol) {\n                if (!is(buf, \"-\")) {\n                    die(\"Distance of %s to itself isn't '-'.\", city[nrow]);\n                }\n\n                dist[nrow][ncol] = 0.0;\n            } else {\n                double d = strtod(buf, NULL);\n\n                if (ncol &gt;= ncity) {\n                    die(\"Too many columns for %s.\", city[nrow]);\n                }\n                dist[nrow][ncol] = d;\n            }\n        }\n\n        ncol++;\n    }\n\n    if (nrow &lt; ncity) die(\"Got only %d rows, expected %d.\", nrow, ncity);\n\n    /*\n     *      Print distance matrix\n     */\n\n    printf(\"Distance\");\n    for (ncol = 0; ncol &lt; ncity; ncol++) {\n        printf(\", %s\", city[ncol]);\n    }\n    puts(\"\");\n\n    for (nrow = 0; nrow &lt; ncity; nrow++) {\n        printf(\"%s\", city[nrow]);\n\n        for (ncol = 0; ncol &lt; ncity; ncol++) {\n            printf(\", %g\", dist[nrow][ncol]);\n        }\n        puts(\"\");\n    }\n\n    free(dist);\n    free(data);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5534514, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7bb83ca682a3e26d9301a0f2a228bff?s=128&d=identicon&r=PG&f=1", "display_name": "S. Proa", "link": "https://stackoverflow.com/users/5534514/s-proa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 34533510, "answer_count": 6, "score": 2, "last_activity_date": 1451742778, "creation_date": 1451487739, "last_edit_date": 1451491115, "question_id": 34531918, "link": "https://stackoverflow.com/questions/34531918/read-a-txt-file-and-save-the-data-as-a-matrix-in-c", "title": "Read a .txt file and save the data as a matrix in C", "body": "<p>I'm interested in reading a .txt file and save the data in it in a matrix in C.</p>\n\n<pre><code>dist.txt is the following:\nDistance    Amsterdam   Antwerp Athens  Barcelona   Berlin\nAmsterdam   -   160 3082    1639    649\nAntwerp 160 -   2766    1465    723\nAthens  3082    2766    -   3312    2552\nBarcelona   1639    1465    3312    -   1899\nBerlin  649 723 2552    1899    -\n</code></pre>\n\n<p>In fact it has more cities, but never mind.</p>\n\n<p>I want to read this document and record the distances. I've tried the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;malloc.h&gt;\n\n#define rows 6\n#define cols 6\n\nint main()\n{\n    FILE *nansa;\n    char *buffer;\n    int ret,row=0,i,j;\n\n    char delims[]=\" \\t\";\n    char *result=NULL;\n\n    double **mat=malloc( rows*sizeof(double*) );\n    for(i=0; i&lt;rows; i++)\n    {\n        mat[i]=malloc( cols*sizeof(double) ); \n    }\n\n    if ((nansa=fopen(\"dist.txt\",\"r\"))==NULL)\n    {\n        fprintf(stdout, \"Error\\n\"); \n        return -1;\n    }\n    while(!feof(nansa))\n    {\n        buffer=malloc( sizeof(char)*4096 );\n        memset(buffer,0,4096);\n        ret=fscanf(nansa, \"%4095[^\\n]\\n\", buffer);\n        if(ret != EOF) \n        {\n            int field=0;\n            result=strtok(buffer,delims);\n            while(result != NULL)\n            {\n                if(field&gt;4) break;\n                mat[row][field]=atof(result);\n                result=strtok(NULL,delims);\n                field++;\n            }\n            ++row;\n        }\n        free(buffer);\n    }\n    fclose(nansa);\n    for(i=0; i&lt;rows; i++)\n    {\n        for(j=0; j&lt;cols; j++)\n        {\n            printf(\"%g%s\", mat[i][j], j&lt;cols-1 ? \"\\t\" : \"\\n\");\n            free(mat[i]);\n        }\n    }\n    free(mat);\n    return 0;\n}\n</code></pre>\n\n<p>But I don't get what I want... And I don't know how to separate the names and the distances (chars and integers). I would be very grateful if someone could help me!</p>\n"}, {"tags": ["c", "recursion", "static"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451487563, "post_id": 34531850, "comment_id": 56805108, "body": "Recursive <code>main()</code>.... I don&#39;t like <i>weird</i> things.. :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1451487629, "post_id": 34531850, "comment_id": 56805134, "body": "It becomes zero because you decrease it? Is the problem perhaps your understanding about how <code>static</code> local variables work? Maybe is a problem understanding recursion? To better understand the recursion you should learn how to use a debugger and how to step over code line by line, and more importantly step <i>into</i> function calls. Do that and it will become clear."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1451487669, "post_id": 34531850, "comment_id": 56805156, "body": "Switch the 2 lines in the if and see what happens"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451487736, "post_id": 34531850, "comment_id": 56805190, "body": "Write out the code line-by-line, replacing <code>main</code> with the code that will actually get executed, so you end up with 1 procedural function. It&#39;ll make sense"}, {"owner": {"reputation": 23, "user_id": 5022129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f50Vib3liDw/AAAAAAAAAAI/AAAAAAAAAFM/ZWAIZwAsrOQ/photo.jpg?sz=128", "display_name": "sabhitha vangaveti", "link": "https://stackoverflow.com/users/5022129/sabhitha-vangaveti"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1451487874, "post_id": 34531850, "comment_id": 56805264, "body": "I tried @Johnny Mopp it is giving output as 4, 3, 2, 1"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451487877, "post_id": 34531850, "comment_id": 56805265, "body": "There is little point having a <code>static int</code> in <code>main</code> unless it recurses, which is <i>unwise behaviour</i>."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1451488005, "post_id": 34531850, "comment_id": 56805331, "body": "Correct. You do understand that static variables only get initialized once? They are kind of like global variables in lifetime but only have local scope."}], "answers": [{"comments": [{"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1451489272, "post_id": 34531917, "comment_id": 56805963, "body": "I like this one, also a link to the post calling main to main <a href=\"http://stackoverflow.com/questions/4238179/calling-main-in-main-in-c\" title=\"calling main in main in c\">stackoverflow.com/questions/4238179/calling-main-in-main-in-&zwnj;&#8203;c</a>"}, {"owner": {"reputation": 23, "user_id": 5022129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f50Vib3liDw/AAAAAAAAAAI/AAAAAAAAAFM/ZWAIZwAsrOQ/photo.jpg?sz=128", "display_name": "sabhitha vangaveti", "link": "https://stackoverflow.com/users/5022129/sabhitha-vangaveti"}, "edited": false, "score": 0, "creation_date": 1451491029, "post_id": 34531917, "comment_id": 56806947, "body": "Thanks for detailed explanation @Sourav Ghosh"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 23, "user_id": 5022129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f50Vib3liDw/AAAAAAAAAAI/AAAAAAAAAFM/ZWAIZwAsrOQ/photo.jpg?sz=128", "display_name": "sabhitha vangaveti", "link": "https://stackoverflow.com/users/5022129/sabhitha-vangaveti"}, "edited": false, "score": 0, "creation_date": 1451491170, "post_id": 34531917, "comment_id": 56807025, "body": "@sabhithavangaveti welcome. BTW, <a href=\"http://meta.stackexchange.com/q/5234/244062\">you can consider accepting an answer that helped you.</a>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1451488999, "last_edit_date": 1451488999, "creation_date": 1451487735, "answer_id": 34531917, "question_id": 34531850, "link": "https://stackoverflow.com/questions/34531850/understanding-static-int-execution/34531917#34531917", "title": "understanding static int execution", "body": "<p>There is a <a href=\"https://en.wikipedia.org/wiki/Recursion_(computer_science)\" rel=\"nofollow noreferrer\">recursive call</a> to <code>main()</code> in your code, till <code>if(--i)</code> is not down to 0. The print statement does not get a chance to execute.</p>\n\n<p>Once <code>i</code> becomes zero, the control returns, and the value of <code>i</code>, is, well, 0, then.</p>\n\n<p><em>[I don't have a photo editor handy right now, sorry]</em>, </p>\n\n<p>Try to have a look at the rough graphics to get an idea.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Acx8L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Acx8L.png\" alt=\"enter image description here\"></a></p>\n\n<p>FWIW, <code>i</code> is having <code>static</code> storage, so it <em>holds</em> the value <em>across</em> function calls. </p>\n\n<p><sup>(<em>I assumed the last part is already understood, just adding for sake of clarity.</em>)</sup></p>\n"}, {"tags": [], "owner": {"reputation": 561, "user_id": 5551782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c61258c604fe9de80439283e99266e?s=128&d=identicon&r=PG&f=1", "display_name": "Or Yaniv", "link": "https://stackoverflow.com/users/5551782/or-yaniv"}, "is_accepted": false, "score": 3, "last_activity_date": 1451487979, "creation_date": 1451487979, "answer_id": 34531986, "question_id": 34531850, "link": "https://stackoverflow.com/questions/34531850/understanding-static-int-execution/34531986#34531986", "title": "understanding static int execution", "body": "<p>here's your program's execution and values:</p>\n\n<pre><code>i = 5; --i; main ()// i==4\ni = 4; --i; main ()// i==3\ni = 3; --i; main ()// i==2\ni = 2; --i; main ()// i==1\ni = 1; --i; // i == 0 ,main is not called!\n</code></pre>\n\n<p>and only then the program comes back from recursion:</p>\n\n<pre><code>printf(\"%d,\", i);\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5022129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f50Vib3liDw/AAAAAAAAAAI/AAAAAAAAAFM/ZWAIZwAsrOQ/photo.jpg?sz=128", "display_name": "sabhitha vangaveti", "link": "https://stackoverflow.com/users/5022129/sabhitha-vangaveti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1451489038, "accepted_answer_id": 34531917, "answer_count": 2, "score": 2, "last_activity_date": 1451488999, "creation_date": 1451487485, "last_edit_date": 1451488113, "question_id": 34531850, "link": "https://stackoverflow.com/questions/34531850/understanding-static-int-execution", "closed_reason": "Duplicate", "title": "understanding static int execution", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    static int i = 5;\n\n    if(--i){\n        main();\n        printf(\"%d,\", i);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm unable to find why the value of <code>i</code> is becoming 0 every time.</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "semaphore", "exit"], "comments": [{"owner": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1451487532, "post_id": 34531697, "comment_id": 56805094, "body": "@Mat sorry, forgot to include that. But it still doesn&#39;t work."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1451488650, "post_id": 34531697, "comment_id": 56805666, "body": "I do not see the benefit of sem_* here. Can&#39;t you just use pthread_join() to wait for thread termination and make the cleanup then?"}, {"owner": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1451492022, "post_id": 34531697, "comment_id": 56807501, "body": "@Ctx Well, in this particular case I could. However there are a lot of other threads in my actual program that needs to be terminated and other operations that must be done in main because I don&#39;t want to overuse global variables for every resource I use."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1451499336, "post_id": 34531697, "comment_id": 56811433, "body": "Since I do not know the actual code it is hard to say, but I would happily trade some space for many more global variables to get rid of constructs like these."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1451490159, "post_id": 34532196, "comment_id": 56806431, "body": "To add to this, the <i>reason</i> it&#39;s not possible to guarantee that the other thread will be woken before the atexit handler calls its own <code>sem_wait</code> is that there is no way to observe whether the other thread is &quot;waiting in <code>sem_wait</code>&quot; or &quot;just about to call <code>sem_wait</code>&quot;. While the latter should be unlikely, without further synchronization, you cannot prove it&#39;s not the case, and thus you can&#39;t assume it."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1451490710, "post_id": 34532196, "comment_id": 56806770, "body": "@R.. Indeed.  And even if the other thread is blocked in <code>sem_wait()</code>, there&#39;s no guarantee that the already-running thread that called <code>sem_post()</code> won&#39;t be the one that acquires the semaphore via <code>sem_wait()</code>.  I&#39;d even venture to guess that&#39;s likely, as the OS&#39;s scheduler would be able to just &quot;give&quot; the semaphore to an already-running thread instead of having to block that thread and perform a context switch to the other thread."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1451490920, "post_id": 34532196, "comment_id": 56806894, "body": "Well formally it&#39;s required to unblock an existing waiter if there is one. The only thing that allows an implementation not to do this is the &quot;as if&quot; rule and the inability to observe whether another thread is already waiting or about-to-wait."}, {"owner": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "edited": false, "score": 0, "creation_date": 1451492107, "post_id": 34532196, "comment_id": 56807547, "body": "Thanks, that&#39;s interesting, I assumed that whenever you call sem_post the sem_wait would return based on when it was called, sort of like when you call sem_wait it adds it to a fifo queue. Nevertheless isn&#39;t there another way to overcome this problem using only one semaphore? Or even a better way without using semaphores at all?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1451492407, "post_id": 34532196, "comment_id": 56807702, "body": "@R.. <i>Well formally it&#39;s required to unblock an existing waiter if there is one. ...</i>  Hmm, this <a href=\"http://osxr.org/glibc/source/nptl/sysdeps/unix/sysv/linux/sem_wait.c?!v=glibc-2.17\" rel=\"nofollow noreferrer\">glibc source code</a> seems to indicate that if a thread calls <code>sem_wait()</code> on Linux and the semaphore value is positive the running thread won&#39;t even try to wake up any thread that might be waiting."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "edited": false, "score": 0, "creation_date": 1451492961, "post_id": 34532196, "comment_id": 56808006, "body": "@Linus Any thread waiting for a synchronization object isn&#39;t in a queue, it&#39;s in a pool.  You never know which thread will acquire whatever object the threads are all waiting for.  And how do you define &quot;when it was called&quot; when waiting for an object from different CPUs?  How would you define &quot;first&quot; or &quot;simultaneous&quot;? Once you start making ordering assumptions, definitions like that become critical. Read the <a href=\"http://lxr.free-electrons.com/source/kernel/futex.c\" rel=\"nofollow noreferrer\">first 200 lines or so of comments at the top of this source code</a> for some idea what that entails."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "edited": false, "score": 0, "creation_date": 1451493640, "post_id": 34532196, "comment_id": 56808397, "body": "@Linus - This <a href=\"http://src.illumos.org/source/xref/illumos-gate/usr/src/lib/libc/port/threads/sema.c#82\" rel=\"nofollow noreferrer\">Solaris <code>sem_wait()</code> source code</a> might be of interest.  Note that the comments state that SUSv3 requires FIFO queuing for semaphores.  I was unaware of that, and apparently Linux and glibc don&#39;t follow that requirement, assuming you&#39;re running on Linux."}, {"owner": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "edited": false, "score": 0, "creation_date": 1451493674, "post_id": 34532196, "comment_id": 56808415, "body": "@AndrewHenle okay, I think I have a somewhat better understanding of how it works now. I guess my best shot is to use two semaphores. Thanks for the explanation and pardon for my ignorance. I am very new to semaphores."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1451494439, "post_id": 34532196, "comment_id": 56808838, "body": "@AndrewHenle: The &quot;requirement of fifo ordering&quot; for semaphores, if one exists, is vacuous because entering the queue is not observable. In reality there is not even such a nominal requirement."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1451488807, "creation_date": 1451488807, "answer_id": 34532196, "question_id": 34531697, "link": "https://stackoverflow.com/questions/34531697/sem-post-does-not-prioritise-sem-wait-call-in-other-thread/34532196#34532196", "title": "sem_post does not prioritise sem_wait call in other thread", "body": "<p>You can't control which thread will return from <code>sem_wait()</code> after a call to <code>sem_post()</code>.  You need to use two semaphores:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n\nstatic sem_t wakeupMain;\nstatic sem_t cleanupDone;\n\nvoid *do_work(void *arg) {\n  // if something fails\n  printf(\"Something failed!\\n\");\n  exit(1);\n}\n\nvoid exit_handler() {\n  sem_post(&amp;wakeupMain); // wake up main thread\n  sem_wait(&amp;cleanupDone); // wait for cleanup in main\n  sem_destroy(&amp;wakeupMain);\n  sem_destroy(&amp;cleanupDone);\n}\n\nint main() {\n  pthread_t worker_thread;\n\n  sem_init(&amp;wakeupMain, 0, 0);\n  sem_init(&amp;cleanupDone, 0, 0);\n  atexit(exit_handler);\n\n  pthread_create(&amp;worker_thread, NULL, do_work, NULL);\n\n  sem_wait(&amp;wakeupMain); // block this thread until work is done\n\n  // simulate some cleanup\n  usleep(1000000);\n  printf(\"This never gets called!\\n\");\n\n  sem_post(&amp;cleanupDone); // destroy semaphore\n}\n</code></pre>\n"}], "owner": {"reputation": 1496, "user_id": 3013334, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f80883e570c1ca4c51e19309f7836c34?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/3013334/linus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2065, "favorite_count": 0, "accepted_answer_id": 34532196, "answer_count": 1, "score": 1, "last_activity_date": 1451488807, "creation_date": 1451486826, "last_edit_date": 1451487553, "question_id": 34531697, "link": "https://stackoverflow.com/questions/34531697/sem-post-does-not-prioritise-sem-wait-call-in-other-thread", "title": "sem_post does not prioritise sem_wait call in other thread", "body": "<p>I am working on my project where it is crucial that everything is cleaned up properly and all buffered log messages are saved to a file etc.. I am calling exit from another thread and I was thinking to use a semaphore to wait for the cleanup in main thread to occur before the program fully exits. The problem is that when I call sem_post from my exit handler registred with atexit, sem_wait will not immediately decrement the semaphore thus sem_wait in my exit handler will exit immediately because the semaphore is greater than zero.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n\nstatic sem_t sem;\n\nvoid *do_work(void *arg) {\n  // if something fails\n  printf(\"Something failed!\\n\");\n  exit(1);\n}\n\nvoid exit_handler() {\n  sem_post(&amp;sem); // wake up main thread\n  sem_wait(&amp;sem); // wait for cleanup in main\n  sem_destroy(&amp;sem);\n}\n\nint main() {\n  pthread_t worker_thread;\n\n  sem_init(&amp;sem, 0, 0);\n  atexit(exit_handler);\n\n  pthread_create(&amp;worker_thread, NULL, do_work, NULL);\n\n  sem_wait(&amp;sem); // block this thread until work is done\n\n  // simulate some cleanup\n  usleep(1000000);\n  printf(\"This never gets called!\\n\");\n\n  sem_post(&amp;sem); // destroy semaphore\n}\n</code></pre>\n\n<p>This <a href=\"https://ideone.com/H3ZcUw\" rel=\"nofollow\">example</a> demonstrates my problem. Is there any solution to this problem? I mustn't put the cleanup in my exit handler because I have a lot of local resources in the main function that needs to be cleaned up in my actual program.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1451486410, "post_id": 34531561, "comment_id": 56804486, "body": "<i>&quot;Many good questions generate some degree of opinion based on expert experience, but answers to this question will tend to be almost entirely based on opinions, rather than facts, references, or specific expertise.&quot;</i>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1451486479, "post_id": 34531561, "comment_id": 56804528, "body": "I would go for gcc-based toolchain with some nice IDE.."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451486527, "post_id": 34531561, "comment_id": 56804556, "body": "Code::Blocks and GCC (starting with v5) will be a very good choice."}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451487225, "post_id": 34531561, "comment_id": 56804910, "body": "@SouravGhosh The question is pointed. There is no degree of opinion. Obviously any question can be interpreted and this question has already been misinterpreted based on previous comments."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1451487266, "post_id": 34531561, "comment_id": 56804931, "body": "Re the specific question: yes, you can use it just for C programs. It can be used either as IDE or as command line tool. I recommend trying to use it &quot;out of the box&quot;, which will be IDE. Free downloadable Express version is available."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1451487324, "post_id": 34531561, "comment_id": 56804966, "body": "@nicomp Then what is &quot;how to start programming in C using Visual Studio 2015?&quot;"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1451487380, "post_id": 34531561, "comment_id": 56804998, "body": "@nicomp also, &quot;Can it work&quot; is a bit too broad, IMHO."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1451487454, "post_id": 34531561, "comment_id": 56805048, "body": "VS will probably fulfil most of your C needs, provided you stick to C89/90. Later versions (C99, C11) weren&#39;t fully implemented last I checked. Instead, you&#39;d have to use either C++ or the near-C subset that C++ offers. If you want to write only C, and benefit from all of the C99/11 goodies, gcc would be the better choice"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451487609, "post_id": 34531561, "comment_id": 56805125, "body": "@SouravGhosh &quot;Can it work&quot; is not broad in this context. The OP says &quot;I&#39;m just start to study C programming language.&quot; : in that context the answer is &quot;yes.&quot;  There is no ambiguity."}, {"owner": {"reputation": 17945, "user_id": 465053, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mj3Xe.jpg?s=128&g=1", "display_name": "RBT", "link": "https://stackoverflow.com/users/465053/rbt"}, "edited": false, "score": 0, "creation_date": 1472177079, "post_id": 34531561, "comment_id": 65658141, "body": "This link can help-<a href=\"http://stackoverflow.com/questions/2170169/visual-studio-create-a-hello-world-app-in-c\" title=\"visual studio create a hello world app in c\">stackoverflow.com/questions/2170169/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 5095209, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/OsoD7.png?s=128&g=1", "display_name": "Matthew Frost", "link": "https://stackoverflow.com/users/5095209/matthew-frost"}, "is_accepted": false, "score": 2, "last_activity_date": 1451487778, "last_edit_date": 1451487778, "creation_date": 1451487406, "answer_id": 34531828, "question_id": 34531561, "link": "https://stackoverflow.com/questions/34531561/how-program-in-ansi-c-applying-visual-studio-2015-as-editor-compiler/34531828#34531828", "title": "how program in ANSI C applying Visual Studio 2015 (as editor &amp; compiler)?", "body": "<p>The answer to your question is <strong>yes</strong> it can. See <a href=\"https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Supported_products\" rel=\"nofollow\">here</a> for more details, and other languages that are supported.</p>\n\n<p>However, many start programming in C without an IDE. Although, it can help you troubleshoot syntactical errors, you'll find that its most likely going to get in the way.</p>\n\n<p>If you're new to programming; C is a great language to start with. I would recommend watching <a href=\"https://www.youtube.com/watch?v=zFenJJtAEzE&amp;list=PLhQjrBD2T383Xfn0zECHrOTpfOSlptPAB\" rel=\"nofollow\">CS50</a>. Happy programming. </p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5730918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b62c8e4d1d6fcc3b37928ff22b88172?s=128&d=identicon&r=PG&f=1", "display_name": "Yaakov K.", "link": "https://stackoverflow.com/users/5730918/yaakov-k"}, "edited": false, "score": 0, "creation_date": 1451575129, "post_id": 34531893, "comment_id": 56838450, "body": "Thanks a lot - your answer was just what needed."}, {"owner": {"reputation": 202, "user_id": 406111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PbNQf.jpg?s=128&g=1", "display_name": "Adam Lawrence", "link": "https://stackoverflow.com/users/406111/adam-lawrence"}, "edited": false, "score": 0, "creation_date": 1507839846, "post_id": 34531893, "comment_id": 80382876, "body": "Hyperlink is dead - please revise"}], "tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": true, "score": 0, "last_activity_date": 1451487660, "creation_date": 1451487660, "answer_id": 34531893, "question_id": 34531561, "link": "https://stackoverflow.com/questions/34531561/how-program-in-ansi-c-applying-visual-studio-2015-as-editor-compiler/34531893#34531893", "title": "how program in ANSI C applying Visual Studio 2015 (as editor &amp; compiler)?", "body": "<p>Yes, Visual Studio can be used for just C. You can create a project that will compile C code and produce an executable program.</p>\n\n<p>See <a href=\"http://www.swarthmore.edu/NatSci/tali/E15/Visual_C.html\" rel=\"nofollow\">http://www.swarthmore.edu/NatSci/tali/E15/Visual_C.html</a> for a short explanation of how to create a simple project and write C code in VS.</p>\n"}], "owner": {"reputation": 51, "user_id": 5730918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b62c8e4d1d6fcc3b37928ff22b88172?s=128&d=identicon&r=PG&f=1", "display_name": "Yaakov K.", "link": "https://stackoverflow.com/users/5730918/yaakov-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3540, "favorite_count": 0, "closed_date": 1451488172, "accepted_answer_id": 34531893, "answer_count": 2, "score": 1, "last_activity_date": 1451580555, "creation_date": 1451486311, "last_edit_date": 1451580555, "question_id": 34531561, "link": "https://stackoverflow.com/questions/34531561/how-program-in-ansi-c-applying-visual-studio-2015-as-editor-compiler", "closed_reason": "Opinion-based", "title": "how program in ANSI C applying Visual Studio 2015 (as editor &amp; compiler)?", "body": "<p>I'm just start to study C programming language. I was recommended to use Visual Studio 2015 as modern editor and compiler. Can it work for just C?</p>\n"}, {"tags": ["c", "struct", "minecraft", "variadic-functions"], "answers": [{"comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451490281, "post_id": 34532553, "comment_id": 56806498, "body": "Nice idea! Only drawback is that the number of arguments passed is doubled and thus more data has to be passed. Do you have any code where this is actively used?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1451490866, "post_id": 34532553, "comment_id": 56806860, "body": "No, I haven&#39;t used this yet. The stack size needed for the parameters will be about double size, this is correct. But if you do not recurse with such functions (or code for platforms with very restricted resources), this is probably not noticable in practice."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1451490128, "creation_date": 1451490128, "answer_id": 34532553, "question_id": 34531522, "link": "https://stackoverflow.com/questions/34531522/designated-initializers-for-variable-arguments/34532553#34532553", "title": "Designated initializers for variable arguments", "body": "<p>You could use key/value-pairs instead of positioned values:</p>\n\n<pre><code> int func(int argc, ...) {\n\n }\n</code></pre>\n\n<p>and call it like</p>\n\n<pre><code>func(3, \n         P_NAME,    \"John\",\n         P_SURNAME, \"Myers\", \n         P_AGE,     10\n    );\n</code></pre>\n\n<p>or use a 0-value as terminator to avoid argc.</p>\n"}], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 34532553, "answer_count": 1, "score": 0, "last_activity_date": 1451490128, "creation_date": 1451486108, "last_edit_date": 1451489813, "question_id": 34531522, "link": "https://stackoverflow.com/questions/34531522/designated-initializers-for-variable-arguments", "title": "Designated initializers for variable arguments", "body": "<p>I'm writing a text-based Minecraft bot, mainly to (try to) annoy some players/admins and check out the internals of the <a href=\"http://wiki.vg/Protocol\" rel=\"nofollow\">Minecraft protocol</a>.</p>\n\n<p>Anyway, I'm still in the design phase and writing functions for sending and receiving packets. The declarations look like this right now:</p>\n\n<pre><code>int send_packet(int sock, con_state_t state, send_packet_t ptype, ...);\nint recv_packet(int sock, con_state_t state, recv_packet_t ptype, ...);\n</code></pre>\n\n<p><sub>(I'm planning on adding <code>typedef</code>s for error and socket types, both <code>int</code>s.)</sub></p>\n\n<p>So far, so good. I know variable arguments are type-unsafe but enable me to write better code as opposed to <code>struct</code>s. I can write code such as this (the <code>send_packet</code> function):</p>\n\n<pre><code>/* BTW: I had to decide between structs passed as void* to imitate\n * inheritance and variable-length arguments.\n * Both are equally type-unsafe but variable-length arguments offer the\n * significant advantage of portably iterating over them. Therefore, I can\n * implement a packet-independent packet sending function without remarkable\n * struggle or packet-specific functions, which would be QUITE a hassle.\n * A drawback is that for every argument from the variable-length arguments,\n * data has to be pushed on the stack, so the stack frame grows linearly\n * to the argument count. Not so with a struct; only the address of it had to\n * be passed.\n * (Is variable-length argument the right term at all? I deduced it from\n * variable-length array...)\n */\nint send_packet(int sock, send_packet_t ptype, ...) {\n    va_list fields;\n    uint8_t data[0];    /* TODO: replace 0 by something like PACK_MAX_LEN\n                                          * or so! */\n\n    /* TODO: as mentioned above, data should actually have the size of\n     * PACK_MAX_LEN. because this might be very big, you could use some\n     * dynamic memory allocation mechanism! same goes for string_t, chat_t,\n     * and all similar data types. */\n\n    uint8_t* data_it = data;\n\n    /* TODO: ADD PREPENDING OF PACKET ID AND PACKET LENGTH HERE! */\n    /* TODO: this function isn't finished. add some code, man! resuming the\n     * above comment. */\n\n    /* TODO: add support for legacy server list ping! (packet id = 0xfe) */\n\n    /* TODO: for more complex data types: add code to convert from\n     * simple data types to these complex ones like fix_varint_t to\n     * varint_t! */\n\n    va_start(fields, ptype);\n    for (size_t i = 0; i &lt; sp_structs[ptype].len; ++i) {\n        /* Jeez, I hope my code is understandable... */\n        switch (sp_structs[ptype].fields[i]) {\n        case map_boolean:\n            cpy_data_sp(boolean_t);\n            break;\n        case map_byte:\n            cpy_data_sp(byte_t);\n            break;\n        case map_ubyte:\n            cpy_data_sp(ubyte_t);\n            break;\n        case map_short:\n            cpy_data_sp(short_t);\n            break;\n        case map_ushort:\n            cpy_data_sp(ushort_t);\n            break;\n        case map_int:\n            cpy_data_sp(int_t);\n            break;\n        case map_long:\n            cpy_data_sp(long_t);\n            break;\n        case map_chat:\n            cpy_data_sp(chat_t);\n            break;\n        case map_string:\n            cpy_data_sp(string_t);\n            break;\n        case map_varint:\n            /* TODO: maybe write a macro to generalize wr_varint\n             * and wr_varlong. */\n\n            fix_varint_t fix = va_arg(fields, fix_varint_t);\n            data_it += wr_varint(data_it, fix);\n            break;\n        case map_varlong:\n            fix_varlong_t fix = va_arg(fields, fix_varlong_t);\n            data_it += wr_varlong(data_it, fix);\n            break;\n        /*case map_chunk:\n            cpy_data_sp(chunk_t);\n            break;*/\n        }\n    }\n\n/*\n    if (sock_send(sock, data, packet_len) == -1) {\n        return -1;\n    }\n*/\n    va_end(packet);\n\n    return 0;\n}\n</code></pre>\n\n<p>I just want to show you that, so you get why variable arguments are better here.<br>\nWith <code>struct</code>s, the function prototype would look as follows:</p>\n\n<pre><code> int send_packet(int sock, con_state_t state, send_packet_t ptype, void* pack);\n</code></pre>\n\n<p><code>pack</code> points to the <code>struct</code> here. Now we could deduce the packet type with <code>ptype</code> but we <strong>cannot iterate conveniently over the fields</strong> as mentioned in the first comment in the above code.</p>\n\n<p>Everyone using that function has to know the exact order of the arguments or undefined behavior might occur. <code>struct</code>s are nice here because of <em>designated initializers</em>, which enable order-independent member initialization.<br>\n<strong>Can you think of some way to emulate that for variable arguments?</strong><br>\nMaybe some <code>va_list</code> magic? It should be strictly-conforming, though.</p>\n\n<p><strong>Note:</strong> using C++ already came to my mind, which would solve all my problems, but I want to do this in nice, standard C99 with some C11.</p>\n"}, {"tags": ["c++", "c", "sockets", "network-programming", "tcpsocket"], "comments": [{"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 1, "creation_date": 1451485888, "post_id": 34531332, "comment_id": 56804199, "body": "What exactly are you trying to solve? What will you do if there is a time-out? Start polling again? Or exit? Or something else? What do you expect to do if there is some other error? What do you want to have happen if the receiving side is really on a &quot;go slow&quot; and the message is getting there, but very slowly (someone replaced a fast link with a much slower one, for example)?"}, {"owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 1, "creation_date": 1451485946, "post_id": 34531332, "comment_id": 56804228, "body": "Can you provide some code?"}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1451486202, "post_id": 34531332, "comment_id": 56804362, "body": "DOS attacks are typically &quot;lots of traffic&quot;, not &quot;no traffic&quot;, which is what gives a timeout..."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451486253, "post_id": 34531332, "comment_id": 56804397, "body": "I edited my question above! Sorry for not being clear enough the first time.."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "reply_to_user": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1451486617, "post_id": 34531332, "comment_id": 56804597, "body": "@MatsPetersson Yep you are correct! But the type of attack I had in mind was when I wait on recv() when I should logically be getting more data because the request so far is incomplete and the attacker just sits there not sending any data."}], "answers": [{"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451485952, "post_id": 34531433, "comment_id": 56804232, "body": "Assuming I poll in the same thread right before I call recv() or send(). And the call to poll() is statically well formatted, i.e. The parameters dont change dynamically besides how they do based on the invocation of the wrapped recv() or send()/"}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 0, "last_activity_date": 1451485761, "creation_date": 1451485761, "answer_id": 34531433, "question_id": 34531332, "link": "https://stackoverflow.com/questions/34531332/using-timeouts-on-socket-send-and-recv/34531433#34531433", "title": "Using timeouts on socket send() and recv()", "body": "<p>Answer to question beginning by \"Is is a good idea to ALWAYS\" are often \"no.\" Here, the answer depends on the way you <code>poll()</code>, so no it's no always a good idea.</p>\n\n<p>If you <code>poll()</code> in a separate thread whose goal is <em>only</em> to wait for data, a timeout won't do anything.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451485949, "post_id": 34531467, "comment_id": 56804230, "body": "Generally bad answer. In many cases there is absolultely no need to perform socket operation in separate thread."}], "tags": [], "owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "is_accepted": false, "score": -1, "last_activity_date": 1451485898, "creation_date": 1451485898, "answer_id": 34531467, "question_id": 34531332, "link": "https://stackoverflow.com/questions/34531332/using-timeouts-on-socket-send-and-recv/34531467#34531467", "title": "Using timeouts on socket send() and recv()", "body": "<p>I you use the sockets in a syncron aproach, then you have to use timeouts. But a better but harder way would be to use them asyncron. So, running in their own thread, they can block and will use least resoures...</p>\n"}, {"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451501909, "post_id": 34531468, "comment_id": 56812642, "body": "If I am planning on throwing an exception saying that a timeout has happened is it a good idea?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451502245, "post_id": 34531468, "comment_id": 56812823, "body": "@Curious, I have no idea. Is it a good idea in your application? Is timeout an exceptional case where you absolutely can&#39;t tolerate it at the call site, nor you can sanely propagate the error upstream?"}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451506912, "post_id": 34531468, "comment_id": 56815050, "body": "I don&#39;t have any application in mind yet but I just feel like every recv call should have some sort of timeout when it is used in real scenarios right?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451508133, "post_id": 34531468, "comment_id": 56815748, "body": "@Curious, there are many application which do not deal with any timeouts, and are just waiting for data or connection break."}, {"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451509838, "post_id": 34531468, "comment_id": 56816608, "body": "How about a regular HTTP server? A recv() call in such a server should be with such a timeout correct?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 0, "creation_date": 1451510108, "post_id": 34531468, "comment_id": 56816729, "body": "@Curious, yes, HTTP servers (like many other servers) are the kind of applications which will close connection which doesn&#39;t seem to be alive anymore."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": true, "score": 1, "last_activity_date": 1451485903, "creation_date": 1451485903, "answer_id": 34531468, "question_id": 34531332, "link": "https://stackoverflow.com/questions/34531332/using-timeouts-on-socket-send-and-recv/34531468#34531468", "title": "Using timeouts on socket send() and recv()", "body": "<p>What are you going to do after timeout lapses? If you are going to start waiting again, than timeout gives you nothing.</p>\n\n<p>If you will close the connection and brand it dead, than timeout is very useful. </p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1451486146, "post_id": 34531478, "comment_id": 56804325, "body": "poll has a benefit over SO_RCVTIMEO in that timeout is site configurable. However, this answer is a good one."}], "tags": [], "owner": {"reputation": 139, "user_id": 2947118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/02b14e8507965ace10f79dce3698af29?s=128&d=identicon&r=PG&f=1", "display_name": "samt1903", "link": "https://stackoverflow.com/users/2947118/samt1903"}, "is_accepted": false, "score": 1, "last_activity_date": 1451485931, "last_edit_date": 1495535301, "creation_date": 1451485931, "answer_id": 34531478, "question_id": 34531332, "link": "https://stackoverflow.com/questions/34531332/using-timeouts-on-socket-send-and-recv/34531478#34531478", "title": "Using timeouts on socket send() and recv()", "body": "<p>select() and poll() just tell you which file descriptors are ready to read from. Once you know which file descriptors are ready you can still call recv() on them so you will get the same return values/error checking either way. </p>\n\n<p>You really only need to use select() or poll() if you have multiple sockets/file descriptors to read from. If all you need is a timeout on a single socket then you can use setsockopt() with the SO_RCVTIMEO option to allow a recv() call to time out. See <a href=\"https://stackoverflow.com/questions/2876024/linux-is-there-a-read-or-recv-from-socket-with-timeout%20%22this%20answer%22.\">this answer</a>.</p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2165, "favorite_count": 0, "closed_date": 1451493303, "accepted_answer_id": 34531468, "answer_count": 4, "score": -1, "last_activity_date": 1451486687, "creation_date": 1451485292, "last_edit_date": 1451486687, "question_id": 34531332, "link": "https://stackoverflow.com/questions/34531332/using-timeouts-on-socket-send-and-recv", "closed_reason": "Opinion-based", "title": "Using timeouts on socket send() and recv()", "body": "<p>Is it a good idea to ALWAYS use either select() or poll() and impose say a 10 second timeout on both send() and recv() calls? Or should I just allow them to block indefinitely?</p>\n\n<p>Does imposing this sort of timeout (using select() or poll()) lead me to lose some sort of error reporting or functionality (in the form of return values) that I can get when just using send() and recv()?</p>\n\n<p>NOTE : Assuming I poll in the same thread right before I call recv() or send(). And the call to poll() is statically well formatted, i.e. The parameters dont change dynamically besides how they do based on the invocation of the wrapped recv() or send()</p>\n\n<p>ANOTHER NOTE : If there is a timeout, then I will throw an exception and let the programmer catch it. I was hoping this would lead to protection against a DOS attack. If there is indeed a timeout. I will throw an exception and not get to calling either recv() or send()</p>\n\n<p>YET ANOTHER NOTE : Source code related to what I am talking about can be found here <a href=\"https://beej.us/guide/bgnet/output/html/singlepage/bgnet.html#faq\" rel=\"nofollow\">https://beej.us/guide/bgnet/output/html/singlepage/bgnet.html#faq</a> under a similar FAQ</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "tipsy"], "comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1451485895, "post_id": 34531287, "comment_id": 56804207, "body": "Use the C compiler instead. The error message suggests that you&#39;re trying to compile C code with a C++ compiler."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1451486187, "post_id": 34531287, "comment_id": 56804355, "body": "enhzflep I am new to this, so after the make file is created, doesn&#39;t it include what should be used to compile the code? I mean I just type make in terminal. ( U mean I should do some modifications in the makefile?) Thank you"}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 1, "creation_date": 1451486194, "post_id": 34531287, "comment_id": 56804359, "body": "This first two lines of this example make almost no sense. The first is I presume declaring a function that takes an int and returns an int using the old style implicit int types. But the second line seems to be declaring a variable before the function body even begins. However the issue in question seems to be that the function should return an int in accordance with the implicit declaration and is returning nothing. Whatever your take this doesnt look like well formed C"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1451486483, "post_id": 34531287, "comment_id": 56804531, "body": "@enhzflep Some newer C compilers like clang also reject this code."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1451486492, "post_id": 34531287, "comment_id": 56804535, "body": "@Silviutz What compiler are you compiling with?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 3, "creation_date": 1451486513, "post_id": 34531287, "comment_id": 56804546, "body": "@Vality That&#39;s a K&amp;R declaration. Perfectly valid, just a bit older."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1451486579, "post_id": 34531287, "comment_id": 56804574, "body": "@FUZxxl I use terminal on mac, and the code is written in XCode, i am not sure if this is what u were asking for"}, {"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1451486626, "post_id": 34531287, "comment_id": 56804602, "body": "@Silviutz - I haven&#39;t got the slightest idea how you&#39;ve created the makefile, much less whether you should fix that process or fix the resultant makefile."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1451486762, "post_id": 34531287, "comment_id": 56804679, "body": "@enhzflep So I have a folder with many C files, and a configure executable. I run the executable in terminal using ./configure and the makefile was created. Then I tried to run the makefile in terminal and I got this error"}, {"owner": {"reputation": 1113, "user_id": 4092381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-iUd348W6B_A/AAAAAAAAAAI/AAAAAAAAAjs/0d8MLWyOoFo/photo.jpg?sz=128", "display_name": "Jordan Melo", "link": "https://stackoverflow.com/users/4092381/jordan-melo"}, "reply_to_user": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "edited": false, "score": 0, "creation_date": 1451487450, "post_id": 34531287, "comment_id": 56805044, "body": "@Vality It makes sense. It&#39;s declaring a function that takes a parameter named <code>job</code>, and then defines <code>job</code> underneath as a <code>char</code> array. This is how C used to be. You would define the types of the parameters separately from the function declaration."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 0, "creation_date": 1451486686, "post_id": 34531626, "comment_id": 56804631, "body": "I was thinking to do this, but there are many C files that I need to run, so I should modify it in every single one. I was looking for a faster way if possible."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 0, "creation_date": 1451486877, "post_id": 34531626, "comment_id": 56804745, "body": "So I should add this to the makefile or run it in terminal?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 1, "creation_date": 1451486906, "post_id": 34531626, "comment_id": 56804754, "body": "@Silviutz Yes. Add it to the Makefile. If you show us the makefile, I can tell you where exactly to put this option."}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 0, "creation_date": 1451487044, "post_id": 34531626, "comment_id": 56804822, "body": "Thank you so much it worked! But now I get another error:                          ld: library not found for -lXaw clang: error: linker command failed with exit code 1                                 Wait, let me add the makefile"}, {"owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 0, "creation_date": 1451487352, "post_id": 34531626, "comment_id": 56804983, "body": "Sorry, how can I upload the makefile? It is too big to paste it here?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "edited": false, "score": 1, "creation_date": 1451487548, "post_id": 34531626, "comment_id": 56805101, "body": "@Silviutz Put it in a paste bin. Anyway, the <code>-lXaw</code> problem is a different one. Please ask a separate question for it."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1451486728, "last_edit_date": 1451486728, "creation_date": 1451486553, "answer_id": 34531626, "question_id": 34531287, "link": "https://stackoverflow.com/questions/34531287/opening-an-old-version-of-a-c-file/34531626#34531626", "title": "Opening an old version of a C file", "body": "<p>Change the line</p>\n\n<pre><code>return;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>return 0;\n</code></pre>\n\n<p>or something like that to fix this problem. Optionally, pass the option</p>\n\n<pre><code>-Wno-return-type\n</code></pre>\n\n<p>to the compiler (if you are using <code>clang</code>, the default compiler on OS X) to make this not an error.</p>\n"}], "owner": {"reputation": 73, "user_id": 5668606, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/067a809ec62013121e7c07b6890a4b5d?s=128&d=identicon&r=PG&f=1", "display_name": "Silviutz", "link": "https://stackoverflow.com/users/5668606/silviutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 34531626, "answer_count": 1, "score": 1, "last_activity_date": 1451487070, "creation_date": 1451485110, "last_edit_date": 1451487070, "question_id": 34531287, "link": "https://stackoverflow.com/questions/34531287/opening-an-old-version-of-a-c-file", "title": "Opening an old version of a C file", "body": "<p>I need to install a program (tipsy) that is used to visualize galaxies simulation (my physics professor recommended it to me and he is using it too).</p>\n\n<p>I tried to install it, I created the makefile but when I run it I get an error for the following piece of code:</p>\n\n<pre><code>framepoints(job)\n\nchar job[MAXCOMM] ;\n{\n    char command[MAXCOMM] ;\n    char file_root[MAXCOMM] ;\n    char particle_type[MAXCOMM] ;\n\n    int box ;\n\n    struct gas_particle *gp ;\n    struct dark_particle *dp ;\n    struct star_particle *sp ;\n\n    double part_pos[2] ;\n    int i,j,k ;\n\n    char projection_type[MAXCOMM] ;\n\n    if (sscanf(job,\"%s %d %s %s\",command,&amp;box,\n        particle_type,file_root) == 4) { \n\n       if(strcmp(particle_type,\"star\") != 0 &amp;&amp;\n          strcmp(particle_type,\"gas\") != 0 &amp;&amp;\n          strcmp(particle_type,\"dark\") != 0 &amp;&amp;\n          strcmp(particle_type,\"gasandstar\") != 0 &amp;&amp;\n          strcmp(particle_type,\"darkandstar\") != 0 &amp;&amp;\n          strcmp(particle_type,\"darkandgas\") != 0 &amp;&amp;\n          strcmp(particle_type,\"all\") != 0) {\n\n              printf(\"&lt;sorry, %s is not a particle option, %s&gt;\\n\",\n                     particle_type,title) ;\n              return ;\n}\n</code></pre>\n\n<p>The error says: </p>\n\n<blockquote>\n  <p>non-void function 'framepoints' should return a value</p>\n</blockquote>\n\n<p>I understood that this return without any value is from versions before C89 but I don't know how to solve it. The code I need to run in order to install it is long so I can't modify it by hand (and also my professor told me it is working).</p>\n"}, {"tags": ["c", "encoding"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1451485211, "post_id": 34531208, "comment_id": 56803851, "body": "Then, you should add a second question, what is the purpose of <code>sou,des</code>, no? :)"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1451485593, "post_id": 34531208, "comment_id": 56804043, "body": "So wait, are you asking what type the <code>%c</code> specifier is used for? Because that&#39;s something google can help you with (<i>&quot;C format specifiers&quot;</i>). <code>%c</code> is used for the <code>char</code> type, <code>%s</code> for a <code>char *</code> and so on. Other specifiers include <code>%p</code> (for <code>void *</code>), <code>%zu</code> (for <code>size_t</code>), <code>%f</code> or <code>%g</code> for float/decimal, <code>%l</code> for long (with <code>d</code> or <code>u</code> depending on it being (un)-signed)... there&#39;s bound to be a list of specifiers kicking around"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1451489974, "post_id": 34531208, "comment_id": 56806319, "body": "This should be covered in your handy C or C++ reference manual; if you don&#39;t have one, Google for &quot;C printf conversion specifiers&quot;.  <code>%c</code> is used to output a single character value."}], "answers": [{"tags": [], "owner": {"reputation": 36301, "user_id": 50447, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c8779a33adeec01e05d5a480c7cd3c3?s=128&d=identicon&r=PG", "display_name": "Rowland Shaw", "link": "https://stackoverflow.com/users/50447/rowland-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1451485152, "creation_date": 1451485152, "answer_id": 34531299, "question_id": 34531208, "link": "https://stackoverflow.com/questions/34531208/c-in-c-using-print-statement-and-tower-of-hanoi/34531299#34531299", "title": "%c in c++ using print statement and tower of hanoi", "body": "<p><code>%c</code> if one of the <code>printf</code> <a href=\"https://msdn.microsoft.com/en-us/library/hf4y5e3w.aspx\" rel=\"nofollow\">type field characters</a> - the values are specified after the format, so in your example, <code>sou</code> and <code>des</code> are substituted in, in that order.</p>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 2695712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P7TVh.jpg?s=128&g=1", "display_name": "user2695712", "link": "https://stackoverflow.com/users/2695712/user2695712"}, "is_accepted": false, "score": 1, "last_activity_date": 1451485275, "creation_date": 1451485275, "answer_id": 34531324, "question_id": 34531208, "link": "https://stackoverflow.com/questions/34531208/c-in-c-using-print-statement-and-tower-of-hanoi/34531324#34531324", "title": "%c in c++ using print statement and tower of hanoi", "body": "<p>%c is reserved for one character</p>\n\n<p>Basically this: </p>\n\n<pre><code>Printf(\"move from tower %c to tower %c\\n\",sou,des)\n</code></pre>\n\n<p>Will output something like this:</p>\n\n<pre><code>move from tower A to tower B\n</code></pre>\n\n<p>so variables <strong>sou</strong> and <strong>des</strong>,for example would have values of <em>A</em> and <strong>B</strong> </p>\n"}], "owner": {"reputation": 25, "user_id": 5730935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a411167757bb6b11a91025ef84e05d2?s=128&d=identicon&r=PG&f=1", "display_name": "FILZA Tariq", "link": "https://stackoverflow.com/users/5730935/filza-tariq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "closed_date": 1451494553, "answer_count": 2, "score": -3, "last_activity_date": 1451487597, "creation_date": 1451484815, "last_edit_date": 1451487597, "question_id": 34531208, "link": "https://stackoverflow.com/questions/34531208/c-in-c-using-print-statement-and-tower-of-hanoi", "closed_reason": "Not suitable for this site", "title": "%c in c++ using print statement and tower of hanoi", "body": "<p>Can someone just tell me for what purpose is <code>%c</code> used in the <code>printf</code> statement?</p>\n\n<p>For example in the Tower of Hanoi game a print statement ut is written that <code>Printf(\"move from tower %c to tower %c\\n\",sou,des)</code> \nI am not getting how the program gets the value of <code>%c</code> </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 147720, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1451484323, "post_id": 34531039, "comment_id": 56803383, "body": "You just have to remember in which direction that stack grows, and the relative <code>sizeof</code> relationship between the various integral types in the question. And to account for struct padding due to alignment."}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1451486064, "post_id": 34531039, "comment_id": 56804279, "body": "Here the <code>sizeof(mystruct)</code> is 16 - did you check this?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1451486076, "post_id": 34531039, "comment_id": 56804284, "body": "using <code>printf(&quot;%p&quot;</code> is one of few cases where you actually <i>should</i> cast pointers to <code>void *</code>. the representation of an <code>int *</code> or a <code>struct mystruct *</code> can be different to that of a <code>void *</code>. Failing to cast could trigger UB"}], "answers": [{"comments": [{"owner": {"reputation": 10360, "user_id": 713179, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a5ff5fd766990db4f0b65a96b32fa499?s=128&d=identicon&r=PG&f=1", "display_name": "Angus", "link": "https://stackoverflow.com/users/713179/angus"}, "edited": false, "score": 0, "creation_date": 1451485753, "post_id": 34531264, "comment_id": 56804134, "body": "Why cant it be the last option <code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeece8c 0xfeeece88</code>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 10360, "user_id": 713179, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a5ff5fd766990db4f0b65a96b32fa499?s=128&d=identicon&r=PG&f=1", "display_name": "Angus", "link": "https://stackoverflow.com/users/713179/angus"}, "edited": false, "score": 0, "creation_date": 1451485917, "post_id": 34531264, "comment_id": 56804220, "body": "@Angus: because <code>c</code> is a char, and does not need to be aligned to 4 bytes boundaries."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 10360, "user_id": 713179, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a5ff5fd766990db4f0b65a96b32fa499?s=128&d=identicon&r=PG&f=1", "display_name": "Angus", "link": "https://stackoverflow.com/users/713179/angus"}, "edited": false, "score": 0, "creation_date": 1451487412, "post_id": 34531264, "comment_id": 56805018, "body": "@Angus: sorry, I messed up some names in the final part of the answer (and in the last comment I meant <code>ch</code>); check if now it makes more sense."}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 4, "last_activity_date": 1451487385, "last_edit_date": 1451487385, "creation_date": 1451485016, "answer_id": 34531264, "question_id": 34531039, "link": "https://stackoverflow.com/questions/34531039/understanding-the-stack-address-manipulation/34531264#34531264", "title": "Understanding the stack address manipulation", "body": "<p>The options that are given to you suppose a <code>sizeof(mystruct)</code> of 12 bytes, which is plausible, since you'll have</p>\n\n<ul>\n<li><code>a</code> at offset 0</li>\n<li>3 bytes of padding to keep <code>b</code> aligned to 4 bytes</li>\n<li><code>b</code> at offset 4</li>\n<li><code>c</code> at offset 8 (no padding required, we are already at a multiple of 2)</li>\n<li><code>d</code> at offset 10 (no padding required, <code>char</code> does not need any particular alignment)</li>\n<li>1 byte of padding to keep the next element of an array on 4 bytes boundaries (so that the <code>b</code> of all elements remains aligned to 4 bytes boundaries).</li>\n</ul>\n\n<p>So, all the options are plausible in this respect; next comes <code>ch</code>; assuming that the compiler keeps the order of variables (which is definitely <em>not</em> plausible in optimized builds) will sit right over <code>foo</code>. <code>foo</code> starts at <code>0xfeeece90</code> and <code>ch</code> does not have alignment requirements, so it'll be <code>0xfeeece8f</code>. Finally, <code>i</code> will sit at the nearest 4-bytes boundary above <code>ch</code>, which is indeed <code>0xfeeece88</code>.</p>\n\n<p>Again: this discussion is realistic as far <em>as the <code>struct</code> is concerned</em>, it is not when talking about the locals. In an optimized build the order of declaration does not matter, the  compiler will probably reorder them to avoid wastes of space (and, if you do not ask for their address, will try to fit them in registers).</p>\n"}], "owner": {"reputation": 10360, "user_id": 713179, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a5ff5fd766990db4f0b65a96b32fa499?s=128&d=identicon&r=PG&f=1", "display_name": "Angus", "link": "https://stackoverflow.com/users/713179/angus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1451487385, "creation_date": 1451484138, "last_edit_date": 1451484380, "question_id": 34531039, "link": "https://stackoverflow.com/questions/34531039/understanding-the-stack-address-manipulation", "title": "Understanding the stack address manipulation", "body": "<blockquote>\n  <p>Consider the following piece of code (on a 32-bit Intel/Linux system):</p>\n\n<pre><code>struct mystruct {\n  char a;\n  int b;\n  short c;\n  char d;\n};\nint main()\n{\n  struct mystruct foo[3];\n  char ch;\n  int i;\n\n  printf(\"%p %p %p %p %p\\n\", &amp;foo[0], &amp;foo[1], &amp;foo[2], &amp;ch, &amp;i);\n\n  return 0;\n}\n</code></pre>\n  \n  <p>Which of the following would be the most likely candidate for its output?</p>\n  \n  <ol>\n  <li><code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeece8f 0xfeeece88</code></li>\n  <li><code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeeceb4 0xfeeeceb8</code></li>\n  <li><code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeeceb4 0xfeeeceb5</code></li>\n  <li><code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeece8c 0xfeeece88</code></li>\n  </ol>\n</blockquote>\n\n<p>The output is option (1). I could not understand, how the option a is the right answer.. </p>\n\n<p>Stack grows from higher addresses to lower addresses. Here <code>foo[3]</code>, <code>foo[2]</code>, <code>foo[1]</code>, <code>foo[0]</code>, <code>ch</code>, <code>i</code> ... <code>i</code> will be at the lower address of stack and <code>foo[3]</code> at the higher address. Here the <code>sizeof(mystruct)</code> is 16, hence the <code>foo[3]</code>, <code>foo[2]</code>, <code>foo[1]</code>, <code>ch</code> will be laid with the address gap of 16.</p>\n\n<p>I couldn't get the address difference 16 here with the below address:</p>\n\n<pre><code>0xfeeece90 0xfeeece9c 0xfeeecea8 0xfeeece8f 0xfeeece88\n</code></pre>\n"}, {"tags": ["c", "exception", "dynamic-arrays"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 1, "creation_date": 1451483926, "post_id": 34530909, "comment_id": 56803146, "body": "Spend some time learning how to use a debugger."}, {"owner": {"reputation": 227, "user_id": 3149152, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100001080502383/picture?type=large", "display_name": "Logan", "link": "https://stackoverflow.com/users/3149152/logan"}, "edited": false, "score": 1, "creation_date": 1451484157, "post_id": 34530909, "comment_id": 56803290, "body": "well I know how to use a debugger, thanks t the debugger I know exactly where the exception is being thrown, but unfortunately I don&#39;t know what is wrong with the code"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1451484351, "post_id": 34530909, "comment_id": 56803401, "body": "1) <code>a-&gt;array = (int *)malloc(initialSize * sizeof(char));</code> --&gt; <code>a-&gt;array = (char *)malloc(initialSize * sizeof(char));</code> 2) <code>char C;</code> --&gt; <code>int C;</code> 3) need <code>#include &lt;stdlib.h&gt;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1451486813, "post_id": 34530909, "comment_id": 56804709, "body": "Apart from the comments above, there seems to be nothing wrong (no crash in MSVC even without the corrections). But was this really a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>? I wonder what the unecessary <code>#include &quot;header3.h&quot;</code> is for."}, {"owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "edited": false, "score": 0, "creation_date": 1451490945, "post_id": 34530909, "comment_id": 56806909, "body": "The interface to those functions is just awful. Have two sets of functions, one which deals with char arrays, and another that deals with int arrays."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 5626255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6890b883b1a88639bb44520b3747e4dd?s=128&d=identicon&r=PG&f=1", "display_name": "Dimos", "link": "https://stackoverflow.com/users/5626255/dimos"}, "is_accepted": false, "score": 0, "last_activity_date": 1451490055, "creation_date": 1451490055, "answer_id": 34532527, "question_id": 34530909, "link": "https://stackoverflow.com/questions/34530909/dynamic-arrays-in-c-exception-thrown/34532527#34532527", "title": "Dynamic Arrays in C - Exception thrown", "body": "<ol>\n<li><p>In initArray: [ int allocate: ( int *) ... ]</p>\n\n<pre><code>a-&gt;array = (int *)malloc(initialSize * sizeof(char));\n</code></pre>\n\n<p>In insertArray: [ char allocate: ( char *) ... ]</p>\n\n<pre><code>a-&gt;array = (char *)realloc(a-&gt;array, a-&gt;size * sizeof(char));\n</code></pre></li>\n</ol>\n\n<p>It causes problem.</p>\n\n<ol start=\"2\">\n<li>Use gdb: GNU Debugger</li>\n</ol>\n"}], "owner": {"reputation": 227, "user_id": 3149152, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100001080502383/picture?type=large", "display_name": "Logan", "link": "https://stackoverflow.com/users/3149152/logan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451500686, "creation_date": 1451483615, "last_edit_date": 1451500686, "question_id": 34530909, "link": "https://stackoverflow.com/questions/34530909/dynamic-arrays-in-c-exception-thrown", "title": "Dynamic Arrays in C - Exception thrown", "body": "<p>I have started out using dynamic arrays in C, I am getting an exception thrown runtime error:</p>\n\n<blockquote>\n  <p>Exception thrown at 0x00007FF7ECB21A87 in Assignment 3.exe: 0xC0000005: Access violation writing location 0xFFFFFFFFE7CBC420.</p>\n</blockquote>\n\n<p>This occurs in the <code>insertArray()</code> function, right when I try to store a <code>char</code> element in the array variable found in the <code>struct Array</code> (see below):</p>\n\n<p>Code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"header3.h\"\n\ntypedef struct {\n    char *array;\n    size_t used;\n    size_t size;\n} Array;\n\ntypedef struct {\n    int *array;\n    size_t used;\n    size_t size;\n} intArray;\n\nvoid initArray(int option, Array *a, intArray *b, size_t initialSize) {\n    if (option == 1) {\n        a-&gt;array = (int *)malloc(initialSize * sizeof(char));\n        a-&gt;used = 0;\n        a-&gt;size = initialSize;\n    }\n    else {\n        b-&gt;array = (int *)malloc(initialSize * sizeof(int));\n        b-&gt;used = 0;\n        b-&gt;size = initialSize;\n    }\n}\n\nvoid freeArray(int option, Array *a, intArray *b) {\n    if (option == 1) {\n        free(a-&gt;array);\n        a-&gt;array = NULL;\n        a-&gt;used = a-&gt;size = 0;\n    }\n    else {\n        free(b-&gt;array);\n        b-&gt;array = NULL;\n        b-&gt;used = b-&gt;size = 0;\n    }\n}\n\nvoid insertArray(int option, Array *a, intArray *b, char element, int element2) {\n    if (option == 1) {\n        if (a-&gt;used == a-&gt;size) {\n            a-&gt;size *= 2;\n            a-&gt;array = (char *)realloc(a-&gt;array, a-&gt;size * sizeof(char));\n        }\n        a-&gt;array[a-&gt;used++] = element; //ERROR HERE\n    }\n    else {\n        if (b-&gt;used == b-&gt;size) {\n            b-&gt;size *= 2;\n            b-&gt;array = (int *)realloc(b-&gt;array, b-&gt;size * sizeof(int));\n        }\n        b-&gt;array[b-&gt;used++] = element2;\n    }\n}\n\n\nint main() {\n    Array eq, postFx;\n    initArray(1, &amp;eq, 0, 2);  // initially 2 elements\n    initArray(1, &amp;postFx, 0, 2);\n    int i;\n    char C;\n    printf(\"Enter character string\\n\");\n    while ((C = getchar()) != EOF)\n        insertArray(1, &amp;eq, 0, C, 0);  // automatically resizes as necessary\n    //int n = expEvaluate(eq, (eq.used)-1, postFx); //call expEvaluate to process eq\n    //printf(\"\\nAnswer: %d\", n);\n    int chk = getchar(); //readkey (twice)\n    freeArray(1, &amp;eq, 0);\n    chk = getchar();\n\n    return 0;\n}\n</code></pre>\n\n<p>I can't seem to get the hang of this, I may be missing something obvious or the problem is bigger than that...either way nay help is appreciated!</p>\n"}, {"tags": ["c", "arrays", "function", "char"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451483595, "post_id": 34530879, "comment_id": 56802940, "body": "1 <code>stoixeia[50][7];</code> is out of bound. 2. to return an <i>array</i>, you need to have a <code>char **</code>, at least."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1451483736, "post_id": 34530879, "comment_id": 56803020, "body": "BTW <code>while(wrong=0)</code> --&gt; <code>while(wrong==0)</code>"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451484074, "post_id": 34530879, "comment_id": 56803238, "body": "@SouravGhosh what do you mean &quot;is out of bound&quot;? it is under the libraries"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1451484328, "post_id": 34530879, "comment_id": 56803386, "body": "@BLUEPIXY oh yeah, now it doesnt crashes but somehow when i enter a username in <code>usern</code> it doesnt find anything and it always asks me to give another username"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1451486398, "post_id": 34530879, "comment_id": 56804481, "body": "&quot;<i>My thought was that if i declare my array as a global one everything would change in my functions and the array will get &quot;updated&quot;.</i>&quot; -- Yes. True. So, you do not need to return the array."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451483970, "post_id": 34530911, "comment_id": 56803170, "body": "compilers shows me: [Warning] return makes pointer from integer without a cast"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451484453, "post_id": 34530911, "comment_id": 56803457, "body": "ok, thank you! i will try it! *also how should i declare the function?"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451484490, "post_id": 34530911, "comment_id": 56803476, "body": "you need to compare usern and stoixeia[i] ? or only the first character?"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451484633, "post_id": 34530911, "comment_id": 56803548, "body": "i want to compare the string (<code>usern</code>) with the first column of the array <code>stoixeia[i][0]</code>"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451484806, "post_id": 34530911, "comment_id": 56803637, "body": "first line or first column?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1451484810, "post_id": 34530911, "comment_id": 56803640, "body": "type of <code>stoixeia</code> isn&#39;t <code>char**</code>."}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451485016, "post_id": 34530911, "comment_id": 56803743, "body": "first column of the array"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451485666, "post_id": 34530911, "comment_id": 56804091, "body": "but how should i declare <code>gift</code> after rename it to char **gift"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451486122, "post_id": 34530911, "comment_id": 56804309, "body": "you mean how to call it?"}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 1, "creation_date": 1451486313, "post_id": 34530911, "comment_id": 56804429, "body": "look, i changed ` if (usern[i]==stoixeia[i][0])` as you said and the function works perfectly. I didnt put <code>char **</code>"}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "edited": false, "score": 0, "creation_date": 1451486497, "post_id": 34530911, "comment_id": 56804540, "body": "so you can use it as a <code>void</code> function"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1451486680, "post_id": 34530911, "comment_id": 56804626, "body": "Please use proper indentation and drop the <code>&amp;</code> from <code>scanf</code>."}, {"owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1451486904, "post_id": 34530911, "comment_id": 56804752, "body": "@CoolGuy: you are right, I don&#39;t see the <code>&amp;</code> in scanf, indentation is fixed, please see the updated answer"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1451487259, "post_id": 34530911, "comment_id": 56804928, "body": "&quot;<i><code>&#47;* you should initialize stoixeia to 0 via memcpy for example *&#47;</code></i>&quot; -- Why? <code>stoizeia</code> is a global array and it is automatically initialized to 0."}, {"owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451487449, "post_id": 34530911, "comment_id": 56805043, "body": "why did you remove &amp; in <code>scanf</code>? also thank you for your help, i think that it works now :) @developer"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "edited": false, "score": 0, "creation_date": 1451487560, "post_id": 34530911, "comment_id": 56805104, "body": "Notes: 1)A <code>do...while</code> loop is better in this case. 2)<code>for (i=0; i&lt;50; i++)</code> should probably be <code>for(int i = 0, len = strlen(usern); i &lt; len; i++)</code> 3) To @sniperalex117, if you say what <i>exactly</i> you&#39;re trying to achieve, it is easier for us to help you."}], "tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": true, "score": 1, "last_activity_date": 1451487314, "last_edit_date": 1451487314, "creation_date": 1451483619, "answer_id": 34530911, "question_id": 34530879, "link": "https://stackoverflow.com/questions/34530879/return-2d-char-array-in-c/34530911#34530911", "title": "Return 2d char array in C", "body": "<p>your function must be like this:</p>\n\n<p><strong>You don't need to return a value because you change directly the global variable.</strong></p>\n\n<pre><code>void gift ()\n{\n    int i,j,m;\n    int wrong=0;\n    int k=0;\n    char usern[50];\n    while(wrong==0) /* replace = by ==*/\n    {\n\n        printf(\"Enter the username that you want to Gift:\\n\");\n        scanf(\"%s\", usern);\n        for (i=0; i&lt;50; i++)\n        {\n            if (usern[i]==stoixeia[i][0])\n            {\n                wrong=1;\n                k=i;\n            }\n        }\n    }  \n    m=strlen(usern);\n    for(i=0; i&lt;m; i++)\n    {\n        stoixeia[k][6]= stoixeia[k][6] + 10;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 72, "user_id": 3617919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TQw5J.jpg?s=128&g=1", "display_name": "James Kirsch", "link": "https://stackoverflow.com/users/3617919/james-kirsch"}, "is_accepted": false, "score": 1, "last_activity_date": 1451484150, "creation_date": 1451484150, "answer_id": 34531042, "question_id": 34530879, "link": "https://stackoverflow.com/questions/34530879/return-2d-char-array-in-c/34531042#34531042", "title": "Return 2d char array in C", "body": "<p>As already mentioned use <code>**gift()</code> see <a href=\"http://www.cplusplus.com/forum/general/9508/\" rel=\"nofollow\">here</a> for some more information</p>\n"}], "owner": {"reputation": 79, "user_id": 5726780, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V67gycU50ZY/AAAAAAAAAAI/AAAAAAAAADM/i_mrYA8cy8E/photo.jpg?sz=128", "display_name": "sniperalex117", "link": "https://stackoverflow.com/users/5726780/sniperalex117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 34530911, "answer_count": 2, "score": 1, "last_activity_date": 1451487314, "creation_date": 1451483515, "question_id": 34530879, "link": "https://stackoverflow.com/questions/34530879/return-2d-char-array-in-c", "title": "Return 2d char array in C", "body": "<p>I want to take a 2D char array as an input in a function (actually my 2D array is global and the function doesn't have inputs) , change the values in it and then return another 2D char array.</p>\n\n<pre><code>char stoixeia[50][7];\nint main(int argc, char *argv[])\n</code></pre>\n\n<p>.\n.\n.</p>\n\n<pre><code>if (strcmp(answer, \"Gift\")==0) \n        {\n            gift();\n        } \n\n\nchar gift ()\n    {\n     int i,j,m;\n     int wrong=0;\n     int k=0;\n     char usern[50];\n     while(wrong=0)\n    {\n\n     printf(\"Enter the username that you want to Gift:\\n\");\n     scanf(\"%s\", &amp;usern);\n     for (i=0; i&lt;50; i++)\n    {\n     if (*usern==stoixeia[i][0])\n     {\n     wrong=1;\n     k=i;\n     }\n     }\n\n     }  \n      m=strlen(usern);\n      for(i=0; i&lt;m; i++)\n      {\n        stoixeia[k][6]= stoixeia[k][6] + 10;\n      }\n\n\n\n      return stoixeia[50][7];\n\n     }  \n</code></pre>\n\n<p>My thought was that if i declare my array as a global one everything would change in my functions and the array will get \"updated\". The compiler doesn't show any errors but when I run the programm and my <code>answer</code> is <code>Gift</code> the .exe stops working. Can you suggest me anything? Thank you</p>\n"}, {"tags": ["c", "stack"], "comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 6, "creation_date": 1451482829, "post_id": 34530630, "comment_id": 56802567, "body": "Lately, there have been several questions similar to this. How code like this works, or not, depends very much on the exact details of how your particular compiler lays out the stack frame, and where the return address is stored, so a general answer is not possible. For example, this code seems to assume that a function pointer is the same size as an integer. Is that true for your environment? Are you on a 32-bit or a 64-bit computer?"}, {"owner": {"reputation": 33896, "user_id": 1611055, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7e0a298478afff848f791de8fcbcbc7e?s=128&d=identicon&r=PG", "display_name": "Andreas Fester", "link": "https://stackoverflow.com/users/1611055/andreas-fester"}, "edited": false, "score": 3, "creation_date": 1451482888, "post_id": 34530630, "comment_id": 56802597, "body": "Did you check the assembly output which the compiler generates? Depending on the optimization level, <code>foo()</code> might not even explicitly be called from <code>main()</code>, and <code>foo()</code> might be reduced to essentially <code>return 1;</code>"}, {"owner": {"reputation": 768, "user_id": 5543739, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/be7e742aa8ac8a25356e2af2bd276474?s=128&d=identicon&r=PG", "display_name": "susdu", "link": "https://stackoverflow.com/users/5543739/susdu"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451483170, "post_id": 34530630, "comment_id": 56802748, "body": "@ThomasPadron-McCarthy, 32-bit"}, {"owner": {"reputation": 2825, "user_id": 2407962, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tFYVW.jpg?s=128&g=1", "display_name": "tapananand", "link": "https://stackoverflow.com/users/2407962/tapananand"}, "edited": false, "score": 0, "creation_date": 1451483592, "post_id": 34530630, "comment_id": 56802938, "body": "According to the cdecl function calling convention, this is overwriting the return address not the ebp. How is the control going to main is not clear to me yet."}, {"owner": {"reputation": 509, "user_id": 4905542, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09a00106b41474151b22b8f329db221c?s=128&d=identicon&r=PG&f=1", "display_name": "smartmic", "link": "https://stackoverflow.com/users/4905542/smartmic"}, "edited": false, "score": 1, "creation_date": 1451484305, "post_id": 34530630, "comment_id": 56803371, "body": "I think it would make sense to use the debugger (<code>gdb -q</code>) and look at the disassembly of each function <code>disassemble foo</code> etc. Using breakpoints you can investigate with <code>info register</code> where the actual registers eip, ebp etc. point to."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451533294, "post_id": 34530630, "comment_id": 56823420, "body": "As Thomas mentioned earlier, but straight to the point: This has nothing to do with C, and everything to do with your system."}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1518172395, "post_id": 34530630, "comment_id": 84405986, "body": "Which compiler (version), which optimization level \u2026?"}], "owner": {"reputation": 768, "user_id": 5543739, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/be7e742aa8ac8a25356e2af2bd276474?s=128&d=identicon&r=PG", "display_name": "susdu", "link": "https://stackoverflow.com/users/5543739/susdu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1451482650, "creation_date": 1451482650, "question_id": 34530630, "link": "https://stackoverflow.com/questions/34530630/c-hacking-the-function-call-stack", "title": "C: hacking the function call stack", "body": "<p>I'm trying to make a program that will help me understand the structure\nof the call stack.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint bar(int c)\n{\n    printf(\"BAR\\n\");\n    return 1;\n}\n\nint foo(int a)\n{\n    int* barADD = &amp;a - 1;\n    a = *barADD;\n    int* mainADD = barADD;\n    *barADD = (int)bar;\n    return 1;\n}\n\nint main()\n{\n    printf(\"Before bar\\n\");\n    foo(2);\n    printf(\"After bar\\n\");\n    return 1;\n} \n</code></pre>\n\n<p>foo modifies it's stack frame return address, so that instead of returning to main it writes the address of bar to the \"return address\" part of the foo()'s stack. While in bar, the program should be in the main() stack frame, because bar() doesn't have a frame of its own and foo()'s ebp register returned to main. bar()'s \"return 1\" should try to return from main() and throw an exception. Problem is that this code works just fine and main() executes correctly, printing</p>\n\n<pre><code>Before bar\nBAR\nAfter bar\n</code></pre>\n\n<p>I don't understand how this works and not crashing on the return part.</p>\n"}, {"tags": ["c", "string", "hex"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1451482004, "post_id": 34530443, "comment_id": 56802121, "body": "look into strtoul(3)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1451482009, "creation_date": 1451482009, "answer_id": 34530468, "question_id": 34530443, "link": "https://stackoverflow.com/questions/34530443/convert-string-of-a-hex-value-to-integer/34530468#34530468", "title": "Convert string of a hex value to integer", "body": "<p>You need to use <a href=\"http://man7.org/linux/man-pages/man3/strtol.3.html\" rel=\"nofollow\"><code>strtol()</code></a> function from <code>stdlib.h</code>.</p>\n\n<p>Excerpt from the man page, </p>\n\n<blockquote>\n  <p>The string may begin with an arbitrary amount of white space (as determined by isspace(3)) followed by a single optional <code>'+'</code> or <code>'-'</code> sign. <strong>If base is zero or 16, the string may then include a <code>\"0x\"</code> prefix, and the number will be read in base 16;</strong> [....]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 186, "user_id": 4086929, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003470286646/picture?type=large", "display_name": "Lucas Sampaio", "link": "https://stackoverflow.com/users/4086929/lucas-sampaio"}, "is_accepted": false, "score": 1, "last_activity_date": 1451482118, "creation_date": 1451482118, "answer_id": 34530497, "question_id": 34530443, "link": "https://stackoverflow.com/questions/34530443/convert-string-of-a-hex-value-to-integer/34530497#34530497", "title": "Convert string of a hex value to integer", "body": "<p>You can use the built-in function strtol(char *str, char *end, int base).</p>\n\n<pre><code>int x = strtol(s,NULL,16);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1451482916, "post_id": 34530499, "comment_id": 56802611, "body": "Actually I deleted my comment based on the quoted man page text in Sourav Ghosh&#39;s answer.  The documentation I was looking at did not suggest that 16 was also valid.  However I think zero is better - you then have the option of decimal or octal processing without changing the code."}], "tags": [], "owner": {"reputation": 151870, "user_id": 1501794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/VyUv5.jpg?s=128&g=1", "display_name": "Rahul Tripathi", "link": "https://stackoverflow.com/users/1501794/rahul-tripathi"}, "is_accepted": false, "score": 1, "last_activity_date": 1451482725, "last_edit_date": 1451482725, "creation_date": 1451482126, "answer_id": 34530499, "question_id": 34530443, "link": "https://stackoverflow.com/questions/34530443/convert-string-of-a-hex-value-to-integer/34530499#34530499", "title": "Convert string of a hex value to integer", "body": "<p>Try to use the <code>strtol()</code> function:</p>\n\n<pre><code>const char *hexstring = \"0x26B70A40\";\nint x = (int)strtol(hexstring, NULL, 0);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 3, "creation_date": 1451483210, "post_id": 34530704, "comment_id": 56802775, "body": "Apart from the fact that <code>strtol()</code> has been suggested in three answers already, this code is also incorrect. <code>str</code> does not exist, and <code>ptr</code> is unitialised.  <code>prt</code> should be of type <code>char*</code> and then &#39;&amp;prt` passed if needed, but in this case serves no purpose, so NULL could be passed."}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 0, "last_activity_date": 1451536933, "last_edit_date": 1451536933, "creation_date": 1451482913, "answer_id": 34530704, "question_id": 34530443, "link": "https://stackoverflow.com/questions/34530443/convert-string-of-a-hex-value-to-integer/34530704#34530704", "title": "Convert string of a hex value to integer", "body": "<p>Try this :</p>\n\n<pre><code> const char s[13] = \"0x26B70A40\";\n char **ptr;\n long val;\n val = strtol(s, ptr, 16);\n</code></pre>\n"}], "owner": {"reputation": 2124, "user_id": 795970, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3e908699d3ba1d553f600c103d891d54?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/795970/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1451809060, "creation_date": 1451481887, "last_edit_date": 1451809060, "question_id": 34530443, "link": "https://stackoverflow.com/questions/34530443/convert-string-of-a-hex-value-to-integer", "title": "Convert string of a hex value to integer", "body": "<p>How can I convert the string <code>0x26B70A40</code> to an <code>int</code> in c?</p>\n\n<pre><code>const char s[13] = \"0x26B70A40\";\nint x = someFunction(s);\nprintf(\"%d\\n\", x);\n</code></pre>\n\n<p>That should print <code>649529920</code>.</p>\n"}, {"tags": ["c", "multithreading", "openmp", "race-condition"], "comments": [{"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1451481344, "post_id": 34530278, "comment_id": 56801761, "body": "<i>Slightly different?</i>"}, {"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1451481462, "post_id": 34530278, "comment_id": 56801826, "body": "Also, for the record: the <b>bottom</b> one is correct?"}, {"owner": {"reputation": 532, "user_id": 3341645, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DJhr5.jpg?s=128&g=1", "display_name": "Rajith Gun Hewage", "link": "https://stackoverflow.com/users/3341645/rajith-gun-hewage"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1451481578, "post_id": 34530278, "comment_id": 56801882, "body": "@erip I added the answers from a sample run and, yes, the bottom one gives an identical answer to the sequential one."}, {"owner": {"reputation": 994, "user_id": 2044454, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsRrT.jpg?s=128&g=1", "display_name": "Victor Eijkhout", "link": "https://stackoverflow.com/users/2044454/victor-eijkhout"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 0, "creation_date": 1468256701, "post_id": 34530278, "comment_id": 64041429, "body": "@erip: machine precision for float is about 1e-7, so the error here is perfectly consistent with that. If you need more accuracy use double, which gives you 1e-15."}], "answers": [{"comments": [{"owner": {"reputation": 532, "user_id": 3341645, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DJhr5.jpg?s=128&g=1", "display_name": "Rajith Gun Hewage", "link": "https://stackoverflow.com/users/3341645/rajith-gun-hewage"}, "edited": false, "score": 1, "creation_date": 1451482090, "post_id": 34530444, "comment_id": 56802165, "body": "I think that is the reason. So based on this, the answer I get with the serial method is not necessarily correct as well, right? Because it is just one permutation of how the values can be added."}, {"owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "reply_to_user": {"reputation": 532, "user_id": 3341645, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DJhr5.jpg?s=128&g=1", "display_name": "Rajith Gun Hewage", "link": "https://stackoverflow.com/users/3341645/rajith-gun-hewage"}, "edited": false, "score": 1, "creation_date": 1451482376, "post_id": 34530444, "comment_id": 56802309, "body": "@rajeerc In essence, floats, due to not being a perfect representation of real numbers lose accuracy with each operation, and the order of the additions effects exactly how much accuracy they lose due to how they are represented. The serial method will be predictable and give the same answer each time, but not necessarily the most accurate one."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451483440, "post_id": 34530444, "comment_id": 56802876, "body": "Floating point numbers prove the existence of (your favorite Deity/Deities here) by negation as they are clearly the invention of (your favorite Personification of Evil here). Note: if you&#39;re an atheist you can apply Religious Algebra: the (Deity) and (Personification of Evil) cancel out, allowing us to rotate the proposition through the metaphysical plane, and following an appropriate Logical translation we arrive at the not-unexpected result of &quot;Sh*t happens&quot; / &quot;Deal with it&quot;. WARNING: continent-spanning wars have been fought over more trivial results than this. KIDS! DON&#39;T TRY THIS AT HOME!"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1451502354, "post_id": 34530444, "comment_id": 56812874, "body": "and another option is to use Kahan sumation. This operations i memory bandwidth bound so you might as well give the CPU something to do as it waits for main memory."}], "tags": [], "owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "is_accepted": true, "score": 3, "last_activity_date": 1451482183, "last_edit_date": 1451482183, "creation_date": 1451481889, "answer_id": 34530444, "question_id": 34530278, "link": "https://stackoverflow.com/questions/34530278/openmp-reduction-does-not-provide-the-same-answer-as-the-sequential-methodd/34530444#34530444", "title": "openmp reduction does not provide the same answer as the sequential methodd", "body": "<p>Floating point operations are not commutative. Therefore it is possible that your code is giving differing and possibly unpredictable results based on the order in which the floats are added to the accumulating variable.</p>\n\n<p>Openmp due to the nature of parallelising the code results in the additions being performed in an arbitrary order and thus causes slightly unpredictable value due to the above non commutative behaviour of floats.</p>\n\n<p>Either you need to accept this unpredictability or serialise the additions.</p>\n\n<p>The other option would be to use a fixed point library which was able to guarantee commutative addition, in which case the answer would be predictable regardless of the resulting order of the additions.</p>\n"}], "owner": {"reputation": 532, "user_id": 3341645, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DJhr5.jpg?s=128&g=1", "display_name": "Rajith Gun Hewage", "link": "https://stackoverflow.com/users/3341645/rajith-gun-hewage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "accepted_answer_id": 34530444, "answer_count": 1, "score": 3, "last_activity_date": 1451482183, "creation_date": 1451481243, "last_edit_date": 1451481508, "question_id": 34530278, "link": "https://stackoverflow.com/questions/34530278/openmp-reduction-does-not-provide-the-same-answer-as-the-sequential-methodd", "title": "openmp reduction does not provide the same answer as the sequential methodd", "body": "<p>I am trying to parallelize a vector dot product program using OpenMP. The following code shows what I did. </p>\n\n<pre><code>#define N 1000000\n\nfloat dotProduct = 0;\nfloat vector1Host[N], vector2Host[N]; //each element in the vectors are initialized to a value between 1 and 2\n\n#pragma omp parallel for private(i)  reduction(+:dotProduct)\n        for (i = 0; i &lt; N; i++)\n                dotProduct += vector1Host[i] * vector2Host[i];\n</code></pre>\n\n<p>The answer I get here is slightly different than what I get when I do the multiplication sequentially. Further, when I remove the <code>reduction(+:dotProduct)</code> and calculate the multiplications of each item seperately and add them together later (sequentially) I get the same answer as the completely sequential method. </p>\n\n<pre><code>float productComponents[N];\n\n#pragma omp parallel for private(i)\n     for (i = 0; i &lt; N; i++)\n            productComponents[i] += vector1Host[i] * vector2Host[i];\n\nfor (i=0; i&lt;N; i++)\n     dotProduct += productComponents[i];\n</code></pre>\n\n<p>The issue with this method is the performance. Please help me in finding the error in the first method, or an alternative method with good performance. </p>\n\n<p>Update:\nI added the output from a sample run.</p>\n\n<p>N=1000000: Ans=2251335.750000: Time(ms)=2.59163  //sequential<br>\nN=1000000: Ans=2251356.750000: Time(ms)=0.65846  //openmp</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 94, "user_id": 5259626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a166b664e27be1190e271d401baf6de7?s=128&d=identicon&r=PG&f=1", "display_name": "loginn", "link": "https://stackoverflow.com/users/5259626/loginn"}, "edited": false, "score": 2, "creation_date": 1451481212, "post_id": 34530246, "comment_id": 56801692, "body": "You just changed the pointers value to the ascii value of a."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1451490435, "post_id": 34530246, "comment_id": 56806608, "body": "Your compiler <i>should</i> have complained about the assignment at the very least; assigning an integer value to a pointer object is a <i>constraint violation</i>.  Note that gcc also complains about the <code>printf</code> statement, since the type of <code>a</code> (<code>char *</code>) is not what the <code>%c</code> conversion specifier expects (<code>char</code>)."}, {"owner": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "edited": false, "score": 0, "creation_date": 1451494039, "post_id": 34530246, "comment_id": 56808621, "body": "No, there are no warnings or errors in my gnu gcc compiler"}, {"owner": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "edited": false, "score": 0, "creation_date": 1451494133, "post_id": 34530246, "comment_id": 56808675, "body": "One more question . Is this statement correct &quot;Only an address of a variable can be stored in a pointer variable&quot; ? I read it in my book."}], "answers": [{"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451481670, "post_id": 34530317, "comment_id": 56801923, "body": "Nice answer... The only thing missing is that the address of <code>b</code> is written as <code>&amp;b</code> (e.g. &quot;perhaps you meant to write <code>a = &amp;b;</code>?&quot;...). Also, since the OP is confused about this whichever resource he&#39;s using to learn obviously isn&#39;t working, and he should probably try K&amp;R2e..."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451481786, "post_id": 34530317, "comment_id": 56801990, "body": "Correction: If you&#39;re going to bring up that, you might also want to bring up <code>%p</code>... So much to learn, so little book..."}, {"owner": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "edited": false, "score": 1, "creation_date": 1451481939, "post_id": 34530317, "comment_id": 56802073, "body": "I am using ANSI C by E Balaguruswamy . And I meant to write b , not &amp;b . I know difference between both."}, {"owner": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "edited": false, "score": 0, "creation_date": 1451494140, "post_id": 34530317, "comment_id": 56808681, "body": "One more question . Is this statement correct &quot;Only an address of a variable can be stored in a pointer variable&quot; ? I read it in my book."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "edited": false, "score": 0, "creation_date": 1451494686, "post_id": 34530317, "comment_id": 56808976, "body": "@AkhilRaj The book oversimplifies things a bit, because pointers can hold numeric values as well. Starting with C99 there are even special types available for converting pointers to/from integral types in a standard-compliant way - namely, <code>intptr_t</code> and <code>uintptr_t</code>. However, since it is exceptionally rare that one would need this sort of functionality, I wouldn&#39;t blame authors of the book for not mentioning this obscure piece of functionality."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 8, "last_activity_date": 1451481397, "creation_date": 1451481397, "answer_id": 34530317, "question_id": 34530246, "link": "https://stackoverflow.com/questions/34530246/what-does-pointer-variable-store/34530317#34530317", "title": "What does pointer variable store?", "body": "<blockquote>\n  <p>since <code>a</code> is pointer variable, it is supposed to store address</p>\n</blockquote>\n\n<p>A pointer variable can store numeric values, too. On most systems a pointer variable could store an <code>int</code>, although there is no explicit guarantee of this. However, a pointer variable is capable of storing a value of type <code>char</code> on all systems.</p>\n\n<blockquote>\n  <p>then why in this case is it storing character value?</p>\n</blockquote>\n\n<p>Because you told it to do so. Storing a value in a pointer does not make that value an address.</p>\n\n<p><strong>Note:</strong> your code has undefined behavior. The reason the code produces the output that you expect is that a pointer representation on your system happens to be compatible with that of an <code>int</code>, which is what <code>%c</code> expects.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5730752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dcf11f57aff1f435767640d71ec5afb?s=128&d=identicon&r=PG&f=1", "display_name": "embbeded", "link": "https://stackoverflow.com/users/5730752/embbeded"}, "is_accepted": false, "score": 0, "last_activity_date": 1451481667, "creation_date": 1451481667, "answer_id": 34530373, "question_id": 34530246, "link": "https://stackoverflow.com/questions/34530246/what-does-pointer-variable-store/34530373#34530373", "title": "What does pointer variable store?", "body": "<p>pointer is a variable which stores the address of the another variable.but here you wrote a=b which means your are providing the character d to which will the a store.this is because the pointer is also a variable.it is also having its own address space.while we provide the address of the another variable the pointer stores that address that means pointer have the storing capacity. but in this program you cant dereference the pointer.you will get segmentation fault.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5355748, "user_type": "registered", "profile_image": "https://graph.facebook.com/748771088589302/picture?type=large", "display_name": "Neeraj Shivam", "link": "https://stackoverflow.com/users/5355748/neeraj-shivam"}, "is_accepted": false, "score": 0, "last_activity_date": 1451483598, "creation_date": 1451483598, "answer_id": 34530899, "question_id": 34530246, "link": "https://stackoverflow.com/questions/34530246/what-does-pointer-variable-store/34530899#34530899", "title": "What does pointer variable store?", "body": "<p>Talking in reference with C, a pointer variable stores the address of the variable it is pointing to. <strong>In C we cannot use it like any other ordinary variable to store other type of data.</strong> Moreover, the datatype of the pointer variable is the variable pointing to or if we declare it as void we need to cast it in as per necessity(i.e. the data type of pointing variable).   </p>\n\n<p>Talking in reference to your query, since you have already declared it as \"pointer variable\"  so the function of \"printf\" is to print the data the pointer variable is pointing to.</p>\n"}, {"tags": [], "owner": {"reputation": 2324, "user_id": 1927951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417737b8eb65b6ed729e0c784da9622b?s=128&d=identicon&r=PG", "display_name": "Hamidreza Soleimani", "link": "https://stackoverflow.com/users/1927951/hamidreza-soleimani"}, "is_accepted": false, "score": 0, "last_activity_date": 1451484097, "last_edit_date": 1495542185, "creation_date": 1451484097, "answer_id": 34531032, "question_id": 34530246, "link": "https://stackoverflow.com/questions/34530246/what-does-pointer-variable-store/34531032#34531032", "title": "What does pointer variable store?", "body": "<p>Although your code output seems to be working based on the reasons that <a href=\"https://stackoverflow.com/users/335858/dasblinkenlight\">@dasblinkenlight</a> told, that is not a correct practice to assign a <code>char</code> to a <code>char*</code>. The compiler (GCC 4.8.4) warning also is helpful to understand the issue:</p>\n\n<pre><code>warning: assignment makes pointer from integer without a cast [enabled by default]\n  a = b;\n    ^\n</code></pre>\n\n<p>When you assign an <code>int</code> to a <code>int*</code> the compiler prints such warning. It also applies to <code>char</code> and <code>char*</code> in the same way because a <code>char</code> is a form of <code>int</code> in C.</p>\n"}], "owner": {"reputation": 387, "user_id": 4993280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EskYl.jpg?s=128&g=1", "display_name": "Akhil Raj", "link": "https://stackoverflow.com/users/4993280/akhil-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "accepted_answer_id": 34530317, "answer_count": 4, "score": 0, "last_activity_date": 1451484097, "creation_date": 1451481121, "last_edit_date": 1451481550, "question_id": 34530246, "link": "https://stackoverflow.com/questions/34530246/what-does-pointer-variable-store", "title": "What does pointer variable store?", "body": "<p>I typed in this code: </p>\n\n<pre><code>char *a;\nchar b = 'd';\na = b;\nprintf(\"%c\", a);\n</code></pre>\n\n<p>Output - 'd'.</p>\n\n<p>My query is that since <code>a</code> is pointer variable, it is supposed to store address. Why in this case is it storing character value?</p>\n"}, {"tags": ["c", "windows", "visual-c++", "access-violation"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1451482054, "post_id": 34530216, "comment_id": 56802147, "body": "Please post the code. What you did to try and fix the problem does not make sense."}, {"owner": {"reputation": 1050, "user_id": 4720292, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ab9634db96cbb4bc54c10cbe276ae411?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/4720292/pierre"}, "edited": false, "score": 2, "creation_date": 1451482101, "post_id": 34530216, "comment_id": 56802174, "body": "we can&#39;t help you without code."}, {"owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "edited": false, "score": 0, "creation_date": 1451482245, "post_id": 34530216, "comment_id": 56802247, "body": "What code do you want? I don&#39;t have the source code. The program is called TotalChrom by Perkin Elmer. Version 6.3.2  Also, on the non working machine, the process crashes at Operation : CloseFile - Path C:\\Windows\\WindowsShell.Manifest with Result of Success. Then after that it starts C:\\windows\\system32\\WerFault.exe  On a working machine it does the CloseFile WindowsShell.Manifest, but after it does CreateFile - Path - C:\\ with Result Success"}, {"owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "edited": false, "score": 0, "creation_date": 1451483084, "post_id": 34530216, "comment_id": 56802695, "body": "Screen Shots: <a href=\"http://imgur.com/a/TkiFX\" rel=\"nofollow noreferrer\">imgur.com/a/TkiFX</a>  The reason I uninstalled updates because I believe this stopped working when Visual C++ 2010 Redistribute got installed"}, {"owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "edited": false, "score": 0, "creation_date": 1451495790, "post_id": 34530216, "comment_id": 56809605, "body": "This was defiantly caused by a Windows update, I installed a fresh copy of Windows 7 x86 and installed a batch of updates and after a reboot, it now does the same thing as the non-working machines do. I believe it was either KB974945, KB2251489, KB2251491, KB2251487. I am currently narrowing down to the single KB. Hope this helps others in the future."}, {"owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "edited": false, "score": 0, "creation_date": 1451506686, "post_id": 34530216, "comment_id": 56814942, "body": "Well after installing the same updates as before, I noticed it still didn&#39;t crash. I also noticed McAfee HIPS and DLP Endpoint haven&#39;t been installed yet. Trying that next to see if that causes the crash"}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1451566118, "creation_date": 1451566118, "answer_id": 34546739, "question_id": 34530216, "link": "https://stackoverflow.com/questions/34530216/access-violation-when-loading-application/34546739#34546739", "title": "Access violation when loading application", "body": "<p>McAfee H.I.P.S was the culprit.  After I uninstalled and rebooted it worked. </p>\n"}], "owner": {"reputation": 40, "user_id": 357853, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1df29afebbcb9a421f5aa7f913bb9043?s=128&d=identicon&r=PG", "display_name": "Dimitri H", "link": "https://stackoverflow.com/users/357853/dimitri-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1451566118, "creation_date": 1451481000, "question_id": 34530216, "link": "https://stackoverflow.com/questions/34530216/access-violation-when-loading-application", "title": "Access violation when loading application", "body": "<p>I have an application that is having issues loading. I'm getting this error using Windows Debugger Version 10.0.10586.567 X86 on Windows 7 x86: </p>\n\n<pre><code>msvcrt!memcpy+0x15c:\n</code></pre>\n\n<p>The application works fine on a new install of windows and also doesn't work if I uninstall all the updates leading up to the issue. I even went as far as uninstalling Microsoft Office 2010 and its updates to be sure.</p>\n\n<p>I know the application relies on Visual C++, I am also not the developer and don't have any symbols or source code. I was wondering if you could look at the stacktrace and let me know what you think. I have ran process monitor on a working and non-working machine and the only difference is it gets information about C: then loads a logon.ini (logon screen) on the working machine, but on the non-working machine, it doesn't get to the logon screen and just crashes. Let me know if you need any more information. Thanks!</p>\n\n<p>Stack Trace:</p>\n\n<pre><code>Microsoft (R) Windows Debugger Version 10.0.10586.567 X86\nCopyright (c) Microsoft Corporation. All rights reserved.\n\nCommandLine: C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TcNav.exe\nSymbol search path is: srv*\nExecutable search path is: \nModLoad: 00400000 004e8000   TcNav.exe\nModLoad: 77bc0000 77d01000   ntdll.dll\nModLoad: 77980000 77a54000   C:\\Windows\\system32\\kernel32.dll\nModLoad: 75da0000 75deb000   C:\\Windows\\system32\\KERNELBASE.dll\nModLoad: 26800000 2680f000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\lcd_client.dll\nModLoad: 17000000 170f9000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\PnwLib.dll\nModLoad: 72a70000 72a77000   C:\\Windows\\system32\\WSOCK32.dll\nModLoad: 76650000 76685000   C:\\Windows\\system32\\WS2_32.dll\nModLoad: 76020000 760cc000   C:\\Windows\\system32\\msvcrt.dll\nModLoad: 76320000 763c2000   C:\\Windows\\system32\\RPCRT4.dll\nModLoad: 768f0000 768f6000   C:\\Windows\\system32\\NSI.dll\nModLoad: 19000000 19007000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\strdatacvt.dll\nModLoad: 6a670000 6a78c000   C:\\Windows\\system32\\MFC42.DLL\nModLoad: 761f0000 762b9000   C:\\Windows\\system32\\USER32.dll\nModLoad: 77d10000 77d5e000   C:\\Windows\\system32\\GDI32.dll\nModLoad: 76a80000 76a8a000   C:\\Windows\\system32\\LPK.dll\nModLoad: 763d0000 7646d000   C:\\Windows\\system32\\USP10.dll\nModLoad: 77a60000 77bbc000   C:\\Windows\\system32\\ole32.dll\nModLoad: 760d0000 7615f000   C:\\Windows\\system32\\OLEAUT32.dll\nModLoad: 72780000 7280c000   C:\\Windows\\system32\\ODBC32.dll\nModLoad: 77d60000 77e01000   C:\\Windows\\system32\\ADVAPI32.dll\nModLoad: 76a90000 76aa9000   C:\\Windows\\SYSTEM32\\sechost.dll\nModLoad: 18500000 18506000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\ResMgr.dll\nModLoad: 69260000 69272000   C:\\Windows\\system32\\MPR.dll\nModLoad: 40800000 40806000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\VersionDLL.dll\nModLoad: 50800000 50815000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\ExceptionDump.dll\nModLoad: 76610000 7663b000   C:\\Windows\\system32\\IMAGEHLP.dll\nModLoad: 75110000 75121000   C:\\Windows\\system32\\NETAPI32.dll\nModLoad: 75660000 75669000   C:\\Windows\\system32\\netutils.dll\nModLoad: 75990000 759a9000   C:\\Windows\\system32\\srvcli.dll\nModLoad: 751f0000 751ff000   C:\\Windows\\system32\\wkscli.dll\nModLoad: 6a420000 6a471000   C:\\Windows\\system32\\WINSPOOL.DRV\nModLoad: 68240000 68251000   C:\\Windows\\system32\\MSVCIRT.dll\nModLoad: 17500000 17538000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\pnwrpc.dll\nModLoad: 27000000 27017000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\NTSecurity.dll\nModLoad: 60000000 6001d000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\AcqClientDlg.dll\nModLoad: 21000000 21082000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCDLG.dll\nModLoad: 61100000 6111b000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\cam_client.dll\nModLoad: 20000000 200c7000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\sysconf.dll\nModLoad: 20500000 2060a000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\tcdata.dll\nModLoad: 23000000 23006000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCMSG.dll\nModLoad: 25500000 2551c000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCUTIL.dll\nModLoad: 24800000 24854000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCSECURITY.dll\nModLoad: 50000000 50006000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\ML.dll\nModLoad: 21500000 216bc000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TcFile.dll\nModLoad: 64100000 64116000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\mcs_client.dll\nModLoad: 12800000 12815000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\aqm_client.dll\nModLoad: 22000000 2201a000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCFILEUI.dll\nModLoad: 77900000 7797b000   C:\\Windows\\system32\\comdlg32.dll\nModLoad: 769d0000 76a27000   C:\\Windows\\system32\\SHLWAPI.dll\nModLoad: 72d20000 72da4000   C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_5.82.7601.18837_none_ec86b8d6858ec0bc\\COMCTL32.dll\nModLoad: 76ab0000 776fb000   C:\\Windows\\system32\\SHELL32.dll\nModLoad: 61000000 61033000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\AcqClientInt.dll\nModLoad: 26000000 2600c000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\acq_rpc_client.dll\nModLoad: 66100000 66138000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\SetupHelper.dll\n(1eb8.a94): Break instruction exception - code 80000003 (first chance)\neax=00000000 ebx=00000000 ecx=0012fb08 edx=77c071b4 esi=fffffffe edi=00000000\neip=77c609c6 esp=0012fb24 ebp=0012fb50 iopl=0         nv up ei pl zr na pe nc\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246\nntdll!LdrpDoDebuggerBreak+0x2c:\n77c609c6 cc              int     3\n0:000&gt; g\nModLoad: 76690000 766af000   C:\\Windows\\system32\\IMM32.DLL\nModLoad: 76900000 769cc000   C:\\Windows\\system32\\MSCTF.dll\nModLoad: 72720000 72758000   C:\\Windows\\system32\\odbcint.dll\nModLoad: 75510000 75532000   C:\\Windows\\system32\\LOGONCLI.DLL\nModLoad: 76640000 76645000   C:\\Windows\\system32\\PSAPI.DLL\nModLoad: 64bc0000 64bc8000   C:\\Windows\\System32\\drprov.dll\nModLoad: 75270000 75299000   C:\\Windows\\System32\\WINSTA.dll\nModLoad: 64ba0000 64bb4000   C:\\Windows\\System32\\ntlanman.dll\nModLoad: 64b80000 64b97000   C:\\Windows\\System32\\davclnt.dll\nModLoad: 64b70000 64b78000   C:\\Windows\\System32\\DAVHLPR.dll\nModLoad: 69570000 6957b000   C:\\Windows\\system32\\cscapi.dll\n(1eb8.a94): Unknown exception - code 000006ba (first chance)\nModLoad: 75a20000 75a3b000   C:\\Windows\\system32\\SspiCli.dll\nModLoad: 75ab0000 75abc000   C:\\Windows\\system32\\CRYPTBASE.dll\nModLoad: 74800000 74840000   C:\\Windows\\system32\\uxtheme.dll\nModLoad: 16500000 16850000   C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\PnwGResENU.DLL\nModLoad: 743d0000 743e3000   C:\\Windows\\system32\\dwmapi.dll\nModLoad: 74ef0000 74f11000   C:\\Windows\\system32\\ntmarta.dll\nModLoad: 76a30000 76a75000   C:\\Windows\\system32\\WLDAP32.dll\nModLoad: 697d0000 697db000   C:\\Windows\\System32\\perfproc.dll\nModLoad: 697d0000 697db000   C:\\Windows\\System32\\perfproc.dll\nModLoad: 75b20000 75b2e000   C:\\Windows\\system32\\RpcRtRemote.dll\nModLoad: 754d0000 7550c000   C:\\Windows\\system32\\mswsock.dll\nModLoad: 74e60000 74e65000   C:\\Windows\\System32\\wshtcpip.dll\nModLoad: 75750000 75756000   C:\\Windows\\System32\\wship6.dll\nModLoad: 75a00000 75a08000   C:\\Windows\\system32\\secur32.dll\nModLoad: 75590000 755a7000   C:\\Windows\\system32\\cryptsp.dll\nModLoad: 75430000 75438000   C:\\Windows\\system32\\credssp.dll\nModLoad: 690a0000 69103000   C:\\Program Files\\McAfee\\Host Intrusion Prevention\\HcApi.dll\nModLoad: 69090000 69099000   C:\\Program Files\\McAfee\\Host Intrusion Prevention\\HcThe.dll\nModLoad: 75480000 754c4000   C:\\Windows\\system32\\DNSAPI.dll\nModLoad: 75030000 7504c000   C:\\Windows\\system32\\IPHLPAPI.DLL\nModLoad: 75020000 75027000   C:\\Windows\\system32\\WINNSI.DLL\nModLoad: 73330000 73336000   C:\\Windows\\system32\\rasadhlp.dll\nModLoad: 736e0000 73718000   C:\\Windows\\System32\\fwpuclnt.dll\nModLoad: 75540000 75582000   C:\\Windows\\system32\\msv1_0.DLL\nModLoad: 757c0000 757d1000   C:\\Windows\\system32\\cryptdll.dll\n(1eb8.a94): C++ EH exception - code e06d7363 (first chance)\nModLoad: 74950000 74aee000   C:\\Windows\\WinSxS\\x86_microsoft.windows.common-controls_6595b64144ccf1df_6.0.7601.18837_none_41e855142bd5705d\\comctl32.DLL\n(1eb8.a94): Access violation - code c0000005 (first chance)\nFirst chance exceptions are reported before any exception handling.\nThis exception may be expected and handled.\n*** WARNING: Unable to verify checksum for C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCSECURITY.dll\neax=000504c2 ebx=000504ca ecx=00000001 edx=00000000 esi=0012eb1c edi=00000004\neip=7602996a esp=0012eaa4 ebp=0012eaac iopl=0         nv up ei ng nz ac pe cy\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297\nmsvcrt!memcpy+0x15c:\n7602996a 89448ffc        mov     dword ptr [edi+ecx*4-4],eax ds:0023:00000004=????????\n0:000&gt; g\n(1eb8.a94): Access violation - code c0000005 (!!! second chance !!!)\neax=000504c2 ebx=000504ca ecx=00000001 edx=00000000 esi=0012eb1c edi=00000004\neip=7602996a esp=0012eaa4 ebp=0012eaac iopl=0         nv up ei ng nz ac pe cy\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297\nmsvcrt!memcpy+0x15c:\n7602996a 89448ffc        mov     dword ptr [edi+ecx*4-4],eax ds:0023:00000004=????????\n0:000&gt; ~*\n.  0  Id: 1eb8.a94 Suspend: 1 Teb: 7ffdf000 Unfrozen\n      Start: *** WARNING: Unable to verify checksum for TcNav.exe\nTcNav!WinMainCRTStartup (0045f162)\n      Priority: 0  Priority class: 32  Affinity: 3\n   1  Id: 1eb8.c08 Suspend: 1 Teb: 7ffde000 Unfrozen\n      Start: ntdll!TppWorkerThread (77bf03cf)\n      Priority: 0  Priority class: 32  Affinity: 3\n   2  Id: 1eb8.1148 Suspend: 1 Teb: 7ffdd000 Unfrozen\n      Start: ntdll!TppWaiterpThread (77befcf7)\n      Priority: 0  Priority class: 32  Affinity: 3\n   3  Id: 1eb8.d1c Suspend: 1 Teb: 7ffdb000 Unfrozen\n      Start: *** WARNING: Unable to verify checksum for C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\pnwrpc.dll\npnwrpc!start_thread_main (17517790)\n      Priority: 1  Priority class: 32  Affinity: 3\n   4  Id: 1eb8.1a1c Suspend: 1 Teb: 7ffdc000 Unfrozen\n      Start: ntdll!TppWorkerThread (77bf03cf)\n      Priority: 0  Priority class: 32  Affinity: 3\n   5  Id: 1eb8.1c88 Suspend: 1 Teb: 7ffda000 Unfrozen\n      Start: ntdll!TppWorkerThread (77bf03cf)\n      Priority: 0  Priority class: 32  Affinity: 3\n0:000&gt; ~0s\neax=000504c2 ebx=000504ca ecx=00000001 edx=00000000 esi=0012eb1c edi=00000004\neip=7602996a esp=0012eaa4 ebp=0012eaac iopl=0         nv up ei ng nz ac pe cy\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297\nmsvcrt!memcpy+0x15c:\n7602996a 89448ffc        mov     dword ptr [edi+ecx*4-4],eax ds:0023:00000004=????????\n0:000&gt; k\n # ChildEBP RetAddr  \n00 0012eaac 24821b66 msvcrt!memcpy+0x15c\n01 0012eb14 248259a0 TCSECURITY!SharedMemory::Dialog+0x46\n02 0012eb70 248052cb TCSECURITY!CTcUAF::LockDialog+0x30\n03 0012ebe4 6a6c1123 TCSECURITY!CLogonDlg::OnInitDialog+0x8b\n04 0012ebec 7620c4e7 MFC42!AfxDlgProc+0x35\n05 0012ec18 76225855 USER32!InternalCallWinProc+0x23\n06 0012ec94 762259f3 USER32!UserCallDlgProcCheckWow+0xd6\n07 0012ecdc 76217206 USER32!DefDlgProcWorker+0xa8\n08 0012ecf8 7620c4e7 USER32!DefDlgProcA+0x22\n09 0012ed24 7620c5e7 USER32!InternalCallWinProc+0x23\n0a 0012ed9c 76201b31 USER32!UserCallWinProcCheckWow+0x14b\n0b 0012edcc 76222bee USER32!CallWindowProcAorW+0x99\n0c 0012edec 6a683319 USER32!CallWindowProcA+0x1b\n0d 0012ee0c 6a68336a MFC42!CWnd::DefWindowProcA+0x51\n0e 0012ee20 6a6c1bff MFC42!CWnd::Default+0x27\n0f 0012ee2c 6a68385d MFC42!CDialog::HandleInitDialog+0x60\n10 0012eeb4 6a683687 MFC42!CWnd::OnWndMsg+0x62f\n11 0012eedc 6a68a361 MFC42!CWnd::WindowProc+0x2e\n12 0012ef44 6a68a2b9 MFC42!AfxCallWndProc+0xb5\n13 0012ef68 6a68a571 MFC42!AfxWndProc+0x3e\n14 0012ef9c 7620c4e7 MFC42!AfxWndProcBase+0x57\n15 0012efc8 7620c5e7 USER32!InternalCallWinProc+0x23\n16 0012f040 76205294 USER32!UserCallWinProcCheckWow+0x14b\n17 0012f080 76224f6c USER32!SendMessageWorker+0x4d0\n18 0012f13c 7622535a USER32!InternalCreateDialog+0xb0d\n19 0012f160 76217238 USER32!CreateDialogIndirectParamAorW+0x33\n1a 0012f180 6a6c18b9 USER32!CreateDialogIndirectParamA+0x1b\n1b 0012f1ec 6a6c1aa0 MFC42!CWnd::CreateDlgIndirect+0x19c\n1c 0012f238 24825b8a MFC42!CDialog::DoModal+0xf4\n1d 0012f3a8 248220dc TCSECURITY!CTcUAF::DoWorkstationLogon+0x1ca\n1e 0012f480 2481f446 TCSECURITY!CTcUAF::CTcUAF+0x24c\n1f 0012f5cc 2481ec38 TCSECURITY!CTcSecurityApp::Logon+0x116\n*** WARNING: Unable to verify checksum for C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\TCDLG.dll\n20 0012f8fc 2101aa59 TCSECURITY!CTcSecurityApp::InitInstance+0xc08\n*** WARNING: Unable to verify checksum for C:\\PenExe\\TcCS\\Ver6.3.2\\Bin\\AcqClientDlg.dll\n21 0012faa8 60001405 TCDLG!CPnwWinApp::InitInstance+0x89\n22 0012fb04 0043a06c AcqClientDlg!CPnwAcqClientApp::InitInstance+0x15\n23 0012fec4 6a693519 TcNav!pnw_TcNavApp::InitInstance+0xac\n24 0012fed8 0045fedf MFC42!AfxWinMain+0x4f\n25 0012ff88 779cee6c TcNav!WinMain+0x15\n26 0012ff94 77c23ab3 kernel32!BaseThreadInitThunk+0xe\n27 0012ffd4 77c23a86 ntdll!__RtlUserThreadStart+0x70\n28 0012ffec 00000000 ntdll!_RtlUserThreadStart+0x1b\n</code></pre>\n"}, {"tags": ["c", "linux", "signals"], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 1, "last_activity_date": 1451485105, "last_edit_date": 1451485105, "creation_date": 1451481773, "answer_id": 34530404, "question_id": 34530060, "link": "https://stackoverflow.com/questions/34530060/can-not-register-handler-for-sigtrap/34530404#34530404", "title": "Can not register handler for SIGTRAP", "body": "<p>Only the parent process has registered a signal handler for <code>SIGTRAP</code> but not the child process. So when you raise <code>SIGTRAP</code> in child process, the parent process process is not aware of it.</p>\n\n<p><code>SIGCHLD</code> works (i.e. received by parent) because when the child process terminates (or stops), the signal <code>SIGCHLD</code> is sent to the parent process. But in case of <code>SIGTRAP</code> (or any other signal), it's not sent to the parent process. <code>SIGCHLD</code> is special in the sense, it's sent by default to the parent process on termination whereas other signals are not. </p>\n\n<p>If you add a handler in child process, you'll see the handler getting invoked:</p>\n\n<pre><code>void child(){\n    signal(SIGTRAP, sigtrap_handler);\n    sleep(1);\n    asm(\"int3\");\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>By the way, <code>printf()</code> is not an <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow\">async-signal-safe</a> function, so you can't safely call it in a signal handler.</p>\n"}], "owner": {"reputation": 3063, "user_id": 4133947, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/99688fdb4523347fb5e789c3705350d4?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/4133947/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 34530404, "answer_count": 1, "score": 0, "last_activity_date": 1451485105, "creation_date": 1451480422, "last_edit_date": 1451483336, "question_id": 34530060, "link": "https://stackoverflow.com/questions/34530060/can-not-register-handler-for-sigtrap", "title": "Can not register handler for SIGTRAP", "body": "<p>I am trying to register a handler for the <code>SIGTRAP</code> caused by calling <code>int3</code> in child, but it does not work. Changing <code>SIGTRAP</code> to <code>SIGCHLD</code> works.</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;wait.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\n\nvoid child();\nvoid parent(pid_t pid);\nvoid sigtrap_handler(int sig);\n\nint main(){\n    pid_t pid = fork();\n    if(pid == 0){\n        child();\n    } else {\n        parent(pid);\n    }\n}\n\n\nvoid child(){\n    sleep(1);\n    asm(\"int3\");\n    exit(EXIT_SUCCESS);\n}\n\nvoid parent(pid_t pid){\n    signal(SIGTRAP, sigtrap_handler);\n    int status;\n    do{\n        waitpid(pid, &amp;status, WUNTRACED | WCONTINUED);\n    } while(!WIFEXITED(status) &amp;&amp; !WIFSIGNALED(status));\n    exit(EXIT_SUCCESS);\n}\n\nvoid sigtrap_handler(int sig){\n    printf(\"Process %d received sigtrap %d.\\n\", getpid(), sig);\n}\n</code></pre>\n"}, {"tags": ["c", "compiler-construction", "header-files", "modularity"], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1451547515, "post_id": 34530423, "comment_id": 56827530, "body": "@ThomasPadronMcCarthy you use <code>printf</code> as an example, you say the implementation file (.c) is hidden but don&#39;t explain how it is hidden. I want to understand it from memory access point of view"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "reply_to_user": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1451548806, "post_id": 34530423, "comment_id": 56827968, "body": "@CholthiPaulTtiopic: From a memory access point of view, everything in the program is (on typical modern computers) linked into the same address space, so there is no &quot;hiding&quot; going on on that level. &quot;Hidden&quot; only means that to use <code>printf</code> in your program you don&#39;t <i>have</i> to look at the internals of the implementation, and doing so might even be a bit difficult, especially if the implementors haven&#39;t provided the source code."}], "tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": false, "score": 2, "last_activity_date": 1451482513, "last_edit_date": 1451482513, "creation_date": 1451481840, "answer_id": 34530423, "question_id": 34530007, "link": "https://stackoverflow.com/questions/34530007/why-do-header-files-ensure-c-programs-modularity/34530423#34530423", "title": "Why do header files ensure C programs&#39; modularity?", "body": "<p>One of the important things we have learnt in programming, and in engineering in general, and perhaps in any human endeavour, is that it is easier to solve a problem if you first split it into smaller problems, and then solve each of those problems separately. It is, after all, easier to jump one foot high ten times, than it is to jump ten feet up in one leap.</p>\n\n<p>But for this type of modularity to work as hoped for, those smaller problems need to be independent of each other, so you really can solve each of them without at the same time having to think of all the others. If you want to design a car, and split it into engine, transmission and steering, you want to be able to design the transmission as much as possible without caring about the steering, and the steering without thinking about the transmission. Otherwise, it's still one big problem, and not several smaller ones. The details of how you have implemented the transmission have to be hidden from the steering, so to speak.</p>\n\n<p>As an example from C, think of the <code>printf</code> function, which you probably have called from your programs lots of times. You <code>#include</code> the header file <code>stdio.h</code>, which contains a <em>declaration</em> of <code>printf</code>, looking something like this:</p>\n\n<pre><code>extern int printf (const char *format, ...);\n</code></pre>\n\n<p>But there is also a <em>definition</em> of <code>printf</code>, in a <code>.c</code> file that is part of the C standard library. The definition contains the actual code that interprets format specifiers such as <code>%10.4f</code>, and prints things to the standard output. It might or might not be present on your computer in source form, but the compiled form is used whenever your program calls <code>printf</code>.</p>\n\n<p>Now, have you ever had to worry about the internal details of <code>printf</code>? Probably not, and that is a good thing. It is hidden from you, not because it is secret or copyrighted, but so you don't have to worry about it.</p>\n"}, {"comments": [{"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1451544116, "post_id": 34531609, "comment_id": 56826367, "body": "thats a bit clear explanation sir. one question, where is the code data for these (external) objects stored in memory. am tempted to think of text segment of the program address space"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1451547376, "post_id": 34531609, "comment_id": 56827493, "body": "@cholthi: the details vary, but they are all in the same address space. If a module gives me the address of a static function, I can call the function. But modularity is not about security. It&#39;s about my being able to write my program without having to worry about internal details of the libraries. I don&#39;t need to maintain their invariants, and I don&#39;t need to worry about what I name my functions and data types."}, {"owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "edited": false, "score": 0, "creation_date": 1451548187, "post_id": 34531609, "comment_id": 56827767, "body": "you&#39;re very clear now. I didn&#39;t know what modularity is all about and that there is no concept of variables in the compiled code"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1451486496, "creation_date": 1451486496, "answer_id": 34531609, "question_id": 34530007, "link": "https://stackoverflow.com/questions/34530007/why-do-header-files-ensure-c-programs-modularity/34531609#34531609", "title": "Why do header files ensure C programs&#39; modularity?", "body": "<p>C doesn't do a great job of hiding implementation details. You can't hide the structure of datatypes unless you are prepared to only export them as pointers. Still, that can go a long way.</p>\n\n<p>Consider the standard <code>FILE</code> datatype. The implementation of a <code>FILE</code> will need to have a lot of details, including whatever the operating system requires to associate the object with an actual datastream, the current buffer and buffer location, the EOF and error flags, and a bunch of other things I can't think of right now, because I don't need to know.</p>\n\n<p>Although I use <code>FILE</code>s everyday, I don't need to think of any of those things. I just use <code>FILE*</code> in ways provided by the I/O library, and don't worry about how the details are implemented. Even if I wanted to, I can't take out my monkey wrench and modify the internal data members. Which is good, because I would almost certainly get it wrong if I tried.</p>\n\n<p>The division of programs into separate compilation units also means that I don't need to know anything about the internal functions used by the I/O library to implement its external API. Undoubtedly, it uses a host of internal functions, each of them with a name. If these names were visible to my code, I would have to make sure that I didn't use them for my own purposes by accident. Fortunately, I don't have to worry about that (mostly) because the names are (mostly) hidden.</p>\n"}], "owner": {"reputation": 842, "user_id": 2751683, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3558b76b5ea55282b21df6a923f60f4a?s=128&d=identicon&r=PG&f=1", "display_name": "Cholthi Paul Ttiopic", "link": "https://stackoverflow.com/users/2751683/cholthi-paul-ttiopic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 34531609, "answer_count": 2, "score": 0, "last_activity_date": 1451486496, "creation_date": 1451480266, "last_edit_date": 1451480781, "question_id": 34530007, "link": "https://stackoverflow.com/questions/34530007/why-do-header-files-ensure-c-programs-modularity", "title": "Why do header files ensure C programs&#39; modularity?", "body": "<p>i get confused when C books and papers talk about exposing interface (.h files) and hiding implementation.e.g when C Main program will wants access to data structure like queue, it will include <code>queue.h</code> to its source. then they will talk about <code>queue.c</code> being hidden from main program i.e main has no access to concrete queue types.</p>\n\n<p>Now the question: What do they mean by implementation is  <strong>hidden from</strong> main program and only accesses it through defined interface by header files </p>\n\n<pre><code>main program\n------------\n//call a function from .h file\nAfunction();\n\nfunction.h\n----------\n// prototypes\nvoid Afunction(void) \n\n function.c\n ---------\n // concrete implementation \nvoid Afunction(void) {\n   // your statements here..\n    {\n</code></pre>\n\n<p>I'm looking for answers even spanning compiler design if that will clear things for me.Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 1, "creation_date": 1451480030, "post_id": 34529829, "comment_id": 56801049, "body": "What&#39;s the error? I&#39;ve just compiled and run it, and the code works fine here."}, {"owner": {"reputation": 444, "user_id": 5391607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-zvI4tvN-bnE/AAAAAAAAAAI/AAAAAAAAAFk/YYciiuVl1L0/photo.jpg?sz=128", "display_name": "amit prasad", "link": "https://stackoverflow.com/users/5391607/amit-prasad"}, "reply_to_user": {"reputation": 1199, "user_id": 3168770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8lafT.jpg?s=128&g=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/3168770/paulo"}, "edited": false, "score": 0, "creation_date": 1451480112, "post_id": 34529829, "comment_id": 56801094, "body": "<a href=\"https://ideone.com/0vwLy2\" rel=\"nofollow noreferrer\">ideone.com/0vwLy2</a>"}, {"owner": {"reputation": 414, "user_id": 1582263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03999b3478e0ac4b8b25eb2eeba79904?s=128&d=identicon&r=PG", "display_name": "tigris", "link": "https://stackoverflow.com/users/1582263/tigris"}, "edited": false, "score": 1, "creation_date": 1451480125, "post_id": 34529829, "comment_id": 56801104, "body": "What do you mean by not working? Is it waits for you to enter values or closes the program?"}], "answers": [{"comments": [{"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451485119, "post_id": 34529985, "comment_id": 56803796, "body": "Why do you reverse <code>c</code> and <code>r</code> when printing if you have transposed the matrix? Those are square matrix."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1451485488, "post_id": 34529985, "comment_id": 56803985, "body": "@Bob__ If you have a matrix <code>[1 2 3]</code> ( read: left to right) with r=1 and c=3 then after transposing, it becomes <code>[1 2 3]</code> (read: top to bottom) and  r=3 and c=1. So it&#39;s necessary to reverse. A matrix doesn&#39;t have to square to transpose it."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1451480188, "creation_date": 1451480188, "answer_id": 34529985, "question_id": 34529829, "link": "https://stackoverflow.com/questions/34529829/transpose-of-matrix-is-sending-error-in-c/34529985#34529985", "title": "Transpose of matrix is sending Error in C", "body": "<p>You are not \"transposing\" the matrix. You are simply copying one array to another. To transpose a matrix, you need to convert rows to columns:</p>\n\n<pre><code>  for(i=0;i&lt;r;i++)\n    {\n        for(j=0;j&lt;c;j++)\n        {\n            b[j][i]=a[i][j];\n        }\n    }\n</code></pre>\n\n<p>and reverse <code>c</code> and <code>r</code> in the loop condition when printing:</p>\n\n<pre><code>for(i=0;i&lt;c;i++)\n{\n    for(j=0;j&lt;r;j++)\n    {\n        printf(\"%d\\n\",b[i][j]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Note that your arrays are capable of handling 50x50. So you need to ensure the input values of <code>r</code> and <code>c</code> don't exceed these limits.</p>\n"}, {"comments": [{"owner": {"reputation": 444, "user_id": 5391607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-zvI4tvN-bnE/AAAAAAAAAAI/AAAAAAAAAFk/YYciiuVl1L0/photo.jpg?sz=128", "display_name": "amit prasad", "link": "https://stackoverflow.com/users/5391607/amit-prasad"}, "edited": false, "score": 1, "creation_date": 1451542053, "post_id": 34541902, "comment_id": 56825676, "body": "Thanks Nil your code is working.It is so helpful for me."}], "tags": [], "owner": {"reputation": 66, "user_id": 5634058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53af6dc3806bc7dcd9bc1c6bcf650bf4?s=128&d=identicon&r=PG&f=1", "display_name": "NIL", "link": "https://stackoverflow.com/users/5634058/nil"}, "is_accepted": true, "score": 0, "last_activity_date": 1451541898, "creation_date": 1451541898, "answer_id": 34541902, "question_id": 34529829, "link": "https://stackoverflow.com/questions/34529829/transpose-of-matrix-is-sending-error-in-c/34541902#34541902", "title": "Transpose of matrix is sending Error in C", "body": "<p>Your code is </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    // your code goes here\n    int a[50][50], b[50][50], i, j, r, c;\n\n    printf(\"Enter the value of R and c\\n\");\n    scanf(\"%d%d\", &amp;r, &amp;c);\n\n    for(i=0;i&lt;r;i++)\n    {\n        for(j=0;j&lt;c;j++)\n        {\n           scanf(\"%d\",&amp;a[i][j]);\n        }\n\n\n    }\n\n    for(i=0;i&lt;r;i++)\n{\n    for(j=0;j&lt;c;j++)\n    {\n        printf(\"%3d\",a[i][j]);\n    }\n    printf(\"\\n\");\n}\n  printf(\"\\n\");\n\n    for(i = 0; i &lt; c; i++)\n    {\n        for(j = 0; j &lt; r; j++)\n        {\n            printf(\"%3d\", a[j][i]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 5391607, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-zvI4tvN-bnE/AAAAAAAAAAI/AAAAAAAAAFk/YYciiuVl1L0/photo.jpg?sz=128", "display_name": "amit prasad", "link": "https://stackoverflow.com/users/5391607/amit-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 34541902, "answer_count": 2, "score": 2, "last_activity_date": 1451541898, "creation_date": 1451479563, "last_edit_date": 1451480189, "question_id": 34529829, "link": "https://stackoverflow.com/questions/34529829/transpose-of-matrix-is-sending-error-in-c", "title": "Transpose of matrix is sending Error in C", "body": "<p>There are two 2D  arrays and <code>r</code> and <code>c</code> are their row and column, <code>i</code> and <code>j</code> are used for integer variables. </p>\n\n<p>Transpose of matrix is running well till the value <code>r</code> and <code>c</code> are entered.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    // your code goes here\n    int a[50][50], b[50][50], i, j, r, c;\n\n    printf(\"Enter the value of R and c\");\n    scanf(\"%d%d\", &amp;r, &amp;c);\n\n    for(i = 0; i &lt; r; i++)\n    {\n        for(j = 0; j &lt; c; j++)\n        {\n            scanf(\"%d\", &amp;a[i][j]);\n        }\n    }\n\n    for(i = 0; i &lt; r; i++)\n    {  \n        for(j = 0; j &lt; c; j++)\n        {\n            b[i][j] = a[i][j];\n        }\n    }\n\n    for(i = 0; i &lt; r; i++)\n    {\n        for(j = 0; j &lt; c; j++)\n        {\n            printf(\"%d\\n\", b[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gnu"], "answers": [{"tags": [], "owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "is_accepted": false, "score": 1, "last_activity_date": 1451484543, "creation_date": 1451484543, "answer_id": 34531142, "question_id": 34529743, "link": "https://stackoverflow.com/questions/34529743/trouble-with-status-of-pid-after-waitpid-in-my-own-implemented-shell/34531142#34531142", "title": "Trouble with status of pid after waitpid in my own implemented shell", "body": "<p>Impossible to be sure since you haven't shown all the code, but I speculate that you've already waited for those processes. </p>\n\n<p>In your fork code, the parent branch (default case) has a <code>waitpid</code> call. Is that code being executed? Once you have successfully waited for a child process (at least one that has in fact exited), it will be removed from the kernel process table, and you can't (successfully) later call <code>waitpid</code> again: it no longer exists.</p>\n\n<p>To discover what exactly is going on, you should print the <code>errno</code> value when <code>waitpid</code> fails (even better, print <code>strerror(errno)</code> so that you don't have to go lookup the <code>errno</code> value). This will tell you exactly <em>why</em> <code>waitpid</code> failed, not just that it failed. </p>\n"}], "owner": {"reputation": 71, "user_id": 5478189, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd28e0954280668443fc36cc6e737f6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Can &#220;st&#252;nel", "link": "https://stackoverflow.com/users/5478189/ali-can-%c3%9cst%c3%bcnel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451501163, "creation_date": 1451479139, "last_edit_date": 1451479222, "question_id": 34529743, "link": "https://stackoverflow.com/questions/34529743/trouble-with-status-of-pid-after-waitpid-in-my-own-implemented-shell", "title": "Trouble with status of pid after waitpid in my own implemented shell", "body": "<p>I am trying to implement my own shell as a homework. In the shell I need a new command called 'status' which displays the current status of pids for example:</p>\n\n<p>When I type it must display</p>\n\n<blockquote>\n  <p>myshell>>status</p>\n  \n  <p>PID PGID  STATUS    PROG</p>\n  \n  <p>1412 1412  pwd exit(0) </p>\n  \n  <p>1454 1454 /opt/firefox/bin/firefox running</p>\n  \n  <p>1462 1462 ls exit(1)</p>\n  \n  <p>1463 1463 xterm stopped</p>\n</blockquote>\n\n<p>However in my shell I have no child process error for exited process and it writes signaled(29) for stopped process.<a href=\"http://i.stack.imgur.com/IcSJo.png\" rel=\"nofollow\">You can see my output from here</a> </p>\n\n<p>This is my process list struct </p>\n\n<pre><code>typedef struct \n{\n  pid_t ppid;\n  pid_t ppgid;\n  char *prog;\n  char status[30];\n}Process;\n</code></pre>\n\n<p>This is my fork for executing new process:</p>\n\n<pre><code>if(forkexec){\n    int pid=fork();\n    iterator=iterator+1;\n    processList[iterator].prog=ptr;\n    processList[iterator].ppid=pid;\n    processList[iterator].ppgid=getpgid(pid); \n    strcpy(ptr,worte[0]);\n\n    switch (pid){\n    case -1:\n      perror(\"Fehler bei fork\"); \n      return(-1);\n    case 0: //child process\n\n      if(umlenkungen(k))\n    exit(1);\n      if(!setpgid(0, 0))\n      {\n        do_execvp(k-&gt;u.einfach.wortanzahl, k-&gt;u.einfach.worte); //for executing program\n      }\n\n      abbruch(\"interner Fehler 001\"); //error\n    default: //parent process\n      if(k-&gt;endeabwarten){\n        if(!setpgid(pid, 0))\n        {\n          tcsetpgrp(0,getpgid(pid));\n          waitpid(pid, NULL, WUNTRACED);\n          tcsetpgrp(0,getpgid(shellpid));\n        }\n\n      }\n      return 0;\n    }\n  }\n</code></pre>\n\n<p>In child process it calls do_execvp function which is:</p>\n\n<pre><code>void do_execvp(int argc, char **args){\n  if(execvp(*args, args)==-1)\n  {\n   perror(\"exec-Fehler\");\n  fprintf(stderr, \"bei Aufruf von \\\"%s\\\"\\n\", *args);\n  exit(1); \n  } \n}\n</code></pre>\n\n<p>For new status command I have, it means if the user enter status this part will run:</p>\n\n<pre><code>if (strcmp(worte[0], \"status\")==0) { \n    int i;\n    fputs(\"PID: PGID: PROGRAM: STATUS: \\n\",stdout);\n    for(i=0; i&lt;=iterator; i++)\n      {\n      find_status(i);\n      printf(\"%d %d %s %s\\n\", processList[i].ppid,processList[i].ppgid,processList[i].prog,processList[i].status);\n      }\n      return 0;\n  }\n</code></pre>\n\n<p>When I am iterating the process list to print with upper code I also call find_status function which is:</p>\n\n<pre><code>void find_status(int current)  \n\n{\n  pid_t w;\n  int status;\n  char stat[30];\n\n  w=waitpid(processList[current].ppid, &amp;status, WNOHANG | WUNTRACED | WCONTINUED);\n\n  switch(w){\n      case -1: \n      strcpy(stat, \"No child process\");\n      break;\n\n      case 0:\n         strcpy(stat,\"running\");\n      default:\n            if (WIFEXITED(status)!=0) {\n                sprintf(stat, \"exit(%d)\", WEXITSTATUS(status));\n            } else if (WIFSIGNALED(status)!=0) {\n                sprintf(stat, \"signaled(%d)\", WTERMSIG(status));\n            } else if (WIFSTOPPED(status)!=0) {\n                strcpy(stat,\"stopped\");\n            } \n      break;\n  }\n  strcpy(processList[current].status, stat);\n}\n</code></pre>\n\n<p>By the way iterator variable is global variable which holds the index of the last element in the process list. Process list is also global variable. So, where is my mistake in the code why it is not displaying exited and stopped process' status? Thank you.</p>\n"}, {"tags": ["c", "function", "pointers", "typedef"], "comments": [{"owner": {"reputation": 187, "user_id": 4766109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4ff668257b4540ae6d945a11748bdf69?s=128&d=identicon&r=PG&f=1", "display_name": "ndi equals", "link": "https://stackoverflow.com/users/4766109/ndi-equals"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1451478309, "post_id": 34529475, "comment_id": 56800060, "body": "int funct(int num) { \treturn 0; }"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 6, "creation_date": 1451478397, "post_id": 34529475, "comment_id": 56800107, "body": "First snippet will not compile as no <code>;</code> after <code>return 0</code>. Second will compile."}, {"owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "edited": false, "score": 1, "creation_date": 1451478397, "post_id": 34529475, "comment_id": 56800108, "body": "In your first example, the line: <code>if (1) {return 0};</code> is giving an error"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 6, "creation_date": 1451478430, "post_id": 34529475, "comment_id": 56800127, "body": "Hiding levels of pointer indirection behind <code>typedef</code>s is, at least from a maintenance perspective, hideous. Please consider <code>typedef int func(int num);</code> and then <code>func *c = &amp;funct;</code>... (I&#39;m not saying you should change your question, just consider this for your future programming style)"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 2, "creation_date": 1451478446, "post_id": 34529475, "comment_id": 56800136, "body": "Please be careful to <i>copy and paste exactly the code that you have tried!</i> The code that you have posted does not give the behavior you claim, and that makes it very difficult to help."}, {"owner": {"reputation": 187, "user_id": 4766109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4ff668257b4540ae6d945a11748bdf69?s=128&d=identicon&r=PG&f=1", "display_name": "ndi equals", "link": "https://stackoverflow.com/users/4766109/ndi-equals"}, "edited": false, "score": 0, "creation_date": 1451478831, "post_id": 34529475, "comment_id": 56800350, "body": "I added the full code and the errors."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451478888, "post_id": 34529475, "comment_id": 56800382, "body": "With your latest changes, on my compiler (&quot;gcc (Ubuntu 4.8.4-2ubuntu1~14.04) 4.8.4&quot;) both programs compile without errors. Which compiler are you using?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451478955, "post_id": 34529475, "comment_id": 56800416, "body": "@ThomasPadron-McCarthy; You must get warning/error about not using <code>c</code> variable."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 0, "creation_date": 1451478984, "post_id": 34529475, "comment_id": 56800430, "body": "@haccks: Yes, a warning. No errors."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451479101, "post_id": 34529475, "comment_id": 56800510, "body": "My guess, while I am trying to find the charger to my Windows computer so I can try it in Visual Studio, is that you are <i>not</i> compiling the second program you have shown, but that there is some mistake, and you are compiling some other version of it."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451479662, "post_id": 34529475, "comment_id": 56800828, "body": "@ThomasPadron-McCarthy As long as the warnings are there, people should treat them as Errors, which means that we shouldn&#39;t compile that code with them"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451479876, "post_id": 34529475, "comment_id": 56800962, "body": "@Allen This is a terrible code and a terrible example. Update your Question with a code which actually does compile, with less problems."}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 1, "creation_date": 1451479889, "post_id": 34529475, "comment_id": 56800973, "body": "@Michi In production code, yes, but this is obviously an MCVE test case - we <i>expect</i> a warning that <code>c</code> isn&#39;t used because we <i>know</i> it isn&#39;t being used.  That isn&#39;t the point."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "edited": false, "score": 0, "creation_date": 1451480058, "post_id": 34529475, "comment_id": 56801061, "body": "@J... YES, but this is not our problem to think or to judge things here. The OP should ask that Question in a manner which we do understand he&#39;s point."}, {"owner": {"reputation": 28846, "user_id": 327083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i8ttM.png?s=128&g=1", "display_name": "J...", "link": "https://stackoverflow.com/users/327083/j"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451480233, "post_id": 34529475, "comment_id": 56801154, "body": "@Michi I was replying to your broadbrush statement that we should treat warnings as errors.  As for the code not compiling - <i>that&#39;s why it&#39;s a question</i>.  If OP had working code that compiled without errors then they would not have a question to ask."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451480988, "post_id": 34529475, "comment_id": 56801573, "body": "@Michi Unfortunately some warnings are redundant, especially when working with the binary operators in the hands of an expert who is well aware of what precedence the operators have, reads the warnings and rolls their eyes because they already knew..."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451481079, "post_id": 34529475, "comment_id": 56801622, "body": "@Michi For example, <code>if ((x &amp; x + 1) == 0) { puts(&quot;x is a power of two&quot;); }</code> will emit a warning treated as an error, despite the fact that it&#39;s perfectly compliant and well defined code... The compiler will require that superfluous brackets be inserted."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451485848, "post_id": 34529475, "comment_id": 56804179, "body": "@Seb I don&#39;t understand why you mean. Is <a href=\"http://ideone.com/EF5dZc\" rel=\"nofollow noreferrer\">This</a>  what you meant ?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451532306, "post_id": 34529475, "comment_id": 56823219, "body": "@Michi <code>x</code> needs to be declared as some kind of <code>unsigned</code> type, and initialised..."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1451479802, "post_id": 34529867, "comment_id": 56800923, "body": "I think is time to move on from Microsoft&#39;s compiler :)"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451479821, "post_id": 34529867, "comment_id": 56800933, "body": "I tried it in Visual Studio 2013, and it worked for the OP when trying again with a new file, so this does not seems to be the problem. The OP probably compiled the wrong file, as sometimes happens."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451479836, "post_id": 34529867, "comment_id": 56800936, "body": "Shall I launch into a rant about &quot;monopoly position = no motivation to innovate/improve&quot;? No, probably not... :-)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451479897, "post_id": 34529867, "comment_id": 56800979, "body": "@ThomasPadron-McCarthy If you read the page linked to by the &quot;there is a bug&quot; text, you&#39;ll find out that the Spring edition of VS2013 is patched..."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451480026, "post_id": 34529867, "comment_id": 56801045, "body": "@Seb: The VS2013 I tried it in says &quot;Update 2&quot;, so yes, it&#39;s probably patched. But if that was the explanation, it seems a bit strange that the OP got it to work with a new file."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451480094, "post_id": 34529867, "comment_id": 56801085, "body": "@ThomasPadron-McCarthy It&#39;s likely that he forgot to toggle &quot;Compile as C&quot; for the new file, so he&#39;s using a C++ compiler to compile C code. :&#39;("}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451480803, "post_id": 34529867, "comment_id": 56801470, "body": "When trying it in my VS2013 it worked both as C and C++. But if the OP has the unpatched version, it indeed seems possible that this is what happened. You get my vote."}], "tags": [], "owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "is_accepted": false, "score": 4, "last_activity_date": 1451479810, "last_edit_date": 1495542683, "creation_date": 1451479684, "answer_id": 34529867, "question_id": 34529475, "link": "https://stackoverflow.com/questions/34529475/pointer-to-function-behaving-weirdly/34529867#34529867", "title": "Pointer to function behaving weirdly", "body": "<p>The error messages are a big hint. They look an awful lot like MSVC++ error numbers, don't they? Are you by chance using a C++ compiler to compile C code? I'll spare you the lecture, for now. Please use a C compiler to compile your C code. If you need to use that C code in a C++ project, you can use your linker to link the compiled-as-C module as you're compiling your C++ code, similar to how Microsoft recommends linking <code>ws2_32.lib</code> when you wish to use winsock.</p>\n\n<p>I understand that MSVC++ has an option to \"compile as C\", but Microsoft's C compiler is <em>really outdated</em>; it only supports C89, which means <a href=\"https://stackoverflow.com/questions/7859424/why-was-mixing-declarations-and-code-forbidden-up-until-c99\">you can't mix declarations with code</a>, at least not until VS2013.</p>\n\n<p>In VS2013 <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/808472/c99-support-of-mixed-declarations-and-statements-fails-with-certain-types-and-constructs\" rel=\"nofollow noreferrer\">there is a bug</a> which fits your problem. If you're using this IDE, I recommend upgrading (only slightly) to fix that bug... Mind you, MSVC++ 2013 <em>still</em> doesn't fully support C99 :( so maybe it's time to <a href=\"http://llvm.org/docs/GettingStartedVS.html\" rel=\"nofollow noreferrer\">upgrade to LLVM/Clang in VS</a>.</p>\n"}], "owner": {"reputation": 187, "user_id": 4766109, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/4ff668257b4540ae6d945a11748bdf69?s=128&d=identicon&r=PG&f=1", "display_name": "ndi equals", "link": "https://stackoverflow.com/users/4766109/ndi-equals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1451479665, "answer_count": 1, "score": -1, "last_activity_date": 1451479810, "creation_date": 1451478083, "last_edit_date": 1451479582, "question_id": 34529475, "link": "https://stackoverflow.com/questions/34529475/pointer-to-function-behaving-weirdly", "closed_reason": "Not suitable for this site", "title": "Pointer to function behaving weirdly", "body": "<p>I am trying to use <code>typedef</code> with a pointer to function, and it's behaving weirdly.</p>\n\n<p>The following code works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint funct(int num)\n{\n    return 0;\n}\ntypedef int(*func)(int num);\nint main()\n{\n    if (1) { return 0; }\n    func c = &amp;funct;\n    return 0;\n}\n</code></pre>\n\n<p>But the following code (without the <code>{}</code>) doesn't:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint funct(int num)\n{\n    return 0;\n}\ntypedef int(*func)(int num);\nint main()\n{\n    if (1) return 0; \n    func c = &amp;funct;\n    return 0;\n}\n</code></pre>\n\n<p>It tells me it's an illegal use of the function.\nWhy? Isn't it basically the same code?</p>\n\n<p>EDIT:\nErrors-</p>\n\n<pre><code>Warning 4   warning C4047: '=' : 'int' differs in levels of indirection from 'int (__cdecl *)(int)' \nError   1   error C2275: 'func' : illegal use of this type as an expression \nError   2   error C2146: syntax error : missing ';' before identifier 'c'   \nError   3   error C2065: 'c' : undeclared identifier    \n</code></pre>\n\n<p>EDIT 2: I inserted the complete code.\nIn the first example, I get no error after I build the code.\nIn the second piece of code, I get all the errors mentioned above.</p>\n\n<p>EDIT 3: I created a new file and tried the code and it works. I still have no idea what caused the error in the first place, so if someone could give me an idea that would be great.</p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1451477551, "post_id": 34529214, "comment_id": 56799668, "body": "Now is probably a great time to learn how to use a debugger to step though your code line by line. That way you can see what happens on each line and how all the variables change during execution. It should hopefully make you find something thake makes you go &quot;Hmm... Why is it doing that?&quot;"}, {"owner": {"reputation": 123, "user_id": 5693488, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e3d426b5c47baa46aa20882f8b5b125a?s=128&d=identicon&r=PG&f=1", "display_name": "William hart", "link": "https://stackoverflow.com/users/5693488/william-hart"}, "edited": false, "score": 0, "creation_date": 1451480266, "post_id": 34529214, "comment_id": 56801167, "body": "player1,2, and dealer get their cards from printcards(deck)"}], "answers": [{"comments": [{"owner": {"reputation": 1191, "user_id": 5726621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5CBh.png?s=128&g=1", "display_name": "neox5", "link": "https://stackoverflow.com/users/5726621/neox5"}, "edited": false, "score": 0, "creation_date": 1451479305, "post_id": 34529762, "comment_id": 56800633, "body": "please think through it again, I have not much time to go it trough step by step, but I think you wlil get the idea :)"}, {"owner": {"reputation": 123, "user_id": 5693488, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e3d426b5c47baa46aa20882f8b5b125a?s=128&d=identicon&r=PG&f=1", "display_name": "William hart", "link": "https://stackoverflow.com/users/5693488/william-hart"}, "edited": false, "score": 0, "creation_date": 1451479685, "post_id": 34529762, "comment_id": 56800850, "body": "Yeah i tried that, but when i call my function from player1() it still gives me the same cards, do you mind explaining your code and actually try it yourself?"}], "tags": [], "owner": {"reputation": 1191, "user_id": 5726621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5CBh.png?s=128&g=1", "display_name": "neox5", "link": "https://stackoverflow.com/users/5726621/neox5"}, "is_accepted": false, "score": 0, "last_activity_date": 1451479212, "creation_date": 1451479212, "answer_id": 34529762, "question_id": 34529214, "link": "https://stackoverflow.com/questions/34529214/cant-get-my-program-to-work-properly-same-numbers-when-dealing-cards/34529762#34529762", "title": "Cant get my program to work properly, same numbers when dealing cards", "body": "<pre><code>int printCards(struct Card *cardDeck)\n{\n    int sum = 0;\n    static int i = 0;\n\n    if(i &lt; DECK_SIZE)\n    {   \n        switch (cardDeck[i].value + 1)\n        {...}\n        printf(\"of \");\n        switch (cardDeck[i].suit)\n        {...}\n\n        sum += cardDeck[i].value;\n        i++;\n\n        return sum;\n    }else\n        printf(\"There are no cards left\");\n        return 0;\n    }\n}\n</code></pre>\n\n<p>use a static variable i: static int i=0; and after you go through the function i++;</p>\n\n<p>and if you reach i = 51 you can return that there are no cards left any more!</p>\n\n<p>I hope i could help you with that! best luck with your project :)</p>\n"}, {"tags": [], "owner": {"reputation": 142, "user_id": 5138104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1hjNA_9m9ls/AAAAAAAAAAI/AAAAAAAAABQ/VsNojeZPeMg/photo.jpg?sz=128", "display_name": "Eugene Anisiutkin", "link": "https://stackoverflow.com/users/5138104/eugene-anisiutkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1451482404, "last_edit_date": 1451482404, "creation_date": 1451481780, "answer_id": 34530409, "question_id": 34529214, "link": "https://stackoverflow.com/questions/34529214/cant-get-my-program-to-work-properly-same-numbers-when-dealing-cards/34530409#34530409", "title": "Cant get my program to work properly, same numbers when dealing cards", "body": "<p>Actually after i looked very carefully through the code, i could not find any place in which dealer, player1 and player2 get their own cards from the deck. </p>\n\n<p>All you do in <code>int player1(struct Card* deck)</code> is continiosly use <code>int printCards(struct Card *cardDeck)</code>, which ALWAYS prints a single card from the deck. Actually it always prints <code>cardDeck[0]</code>, which by that time will never change. a big BUT is that printing cardDeck is not actually assigning cards to different players, it's just that - printing. Maybe you actually should create some struct, which will hold data about a player. Something like</p>\n\n<pre><code>struct Player\n{\n  char* name; // name of player\n  struct listOfcards* list; // a pointer to a list of cards the player has\n} \n</code></pre>\n\n<p>Where <code>listOfcards</code> is something like this</p>\n\n<pre><code>struct listOfcards\n{\n  struct card* currCard // pointer to a current card\n  struct card* nextCard; // pointer  to next card in list(NULL if no next card)\n} \n</code></pre>\n\n<p>Be carefull though, this exaple is very simple, you will have to iterate <code>listOfcards</code> manualy to get all cards for current player. However, this very basic example allows you to add a card to the list at any time in your programm, and delete a card from the list at any time in the programm.</p>\n"}, {"tags": [], "owner": {"reputation": 6009, "user_id": 3313438, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/Ks9C6.jpg?s=128&g=1", "display_name": "Ziezi", "link": "https://stackoverflow.com/users/3313438/ziezi"}, "is_accepted": false, "score": 2, "last_activity_date": 1451483219, "creation_date": 1451483219, "answer_id": 34530786, "question_id": 34529214, "link": "https://stackoverflow.com/questions/34529214/cant-get-my-program-to-work-properly-same-numbers-when-dealing-cards/34530786#34530786", "title": "Cant get my program to work properly, same numbers when dealing cards", "body": "<p>Few general remarks,</p>\n\n<blockquote>\n  <p><em>\"I know my code isn't the prettiest, but I'll fix that later.\"</em></p>\n</blockquote>\n\n<p>is part of your problem, your code is growing and you need to start <strong>considering separating it into different files</strong>, <a href=\"http://www.gamedev.net/page/resources/_/technical/general-programming/organizing-code-files-in-c-and-c-r1798\" rel=\"nofollow\">here</a> is an excellent explanation on the topic of file organization.</p>\n\n<p>Additionally, <strong>add some comments describing the different</strong>, not so obvious and easy to understand, <strong>parts of your code</strong> like loops, functions, etc. That will help you and any other reader understand the functionality of your code. for example if a function is doing to many things, should you <strong>consider breaking it into smaller functions, each making a single task</strong> and is this going to make your job easier in terms of finding an error.</p>\n\n<p>Read more about <code>class</code>es and understand whether is a good idea to integrate all of the functions that act on <code>struct Card</code> into one single class. </p>\n\n<p>P.S. <strong>Be patient</strong> do not expect to solve a problem for a half an hour, <strong>read and research more before asking</strong> a question, especially when the question is not technical. </p>\n"}, {"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 1, "last_activity_date": 1451483858, "creation_date": 1451483858, "answer_id": 34530980, "question_id": 34529214, "link": "https://stackoverflow.com/questions/34529214/cant-get-my-program-to-work-properly-same-numbers-when-dealing-cards/34530980#34530980", "title": "Cant get my program to work properly, same numbers when dealing cards", "body": "<p>The commenters have already pointed out your mistake: You shuffle your deck, but you always look at the same card without discarding it from the deck. The deck gets smaller when you draw cards, so you need a means to keep track of how many cards are still in the deck or how many cards have already been drawn.</p>\n\n<p>Your code has some design \"smells\". For example, you keep a pointer to the sum with the card struct, but a sum should be kept for each player, not for a card. A card has a score, of course, but that can be determined in a separate function.</p>\n\n<p>It is good that you organise your code in various functions, but sometimes you make your functions do too much. <code>printCards</code>, for example, not only prints a card, it also draws a card from the deck and keeps a tally of the current score. Drawing a card from the deck, printing a card and calculating the score should be three separate functions. Eventually, you'll want to print cards without drawing them from the deck or get the score without printing it.</p>\n\n<p>I recommend to use a deck structure tat hold up to 52 cards and from which cards can be drawn. Here's an example program that deals only with the card dealing, not with the game of Black Jack. (That's probably the fun part and left to you.)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nenum {DIAMONDS, CLUBS, HEARTS, SPADES, MAX_SUIT};\nenum {ACE, TWO, THREE, FOUR, FIVE, SIX, SEVEN, EIGHT, NINE,\n    TEN, JACK, QUEEN, KING, MAX_RANK};\n\n#define MAX_CARD (MAX_RANK * MAX_SUIT)\n\nstruct Card {\n    int suit;\n    int rank;\n};\n\nstruct Deck {\n    struct Card card[MAX_CARD];\n    size_t ncard;\n};\n\n/*\n *      Initialise deck\n */\nvoid deck_init(struct Deck *deck)\n{\n    int suit, rank, k = 0;\n\n    for (suit = 0; suit &lt; MAX_SUIT; suit++) {\n        for (rank = 0; rank &lt; MAX_RANK; rank++) {\n            deck-&gt;card[k].suit = suit; \n            deck-&gt;card[k].rank = rank;\n            k++;\n        }\n    }\n\n    deck-&gt;ncard = k;\n}\n\n/*\n *      Get a random card from the deck. It is illegal to call this\n *      when the deck has been exhausted.\n */\nstruct Card deck_deal(struct Deck *deck)\n{\n    if (deck-&gt;ncard &lt;= 0) {\n        fprintf(stderr, \"Deck underflow\\n\");\n        exit(1);\n    }\n\n    int pick = deck-&gt;ncard * (rand() / (1.0 + RAND_MAX));\n    struct Card deal = deck-&gt;card[pick];\n\n    deck-&gt;card[pick] = deck-&gt;card[--deck-&gt;ncard];\n\n    return deal;\n}\n\n/*\n *      Print a card's name to the char buffer str of size len.\n *      Return the buffer, so it can be used in, e.g., printf.\n */\nchar *card_str(char *str, size_t len, struct Card c)\n{\n    static const char *sname[] = {\n        \"Diamonds\", \"Clubs\", \"Hearts\", \"Spades\"\n    };\n    static const char *rname[] = {\n        \"Ace\", \"Two\", \"Three\", \"Four\", \"Five\", \"Six\", \"Seven\",\n        \"Eight\", \"Nine\", \"Ten\", \"Jack\", \"Queen\", \"King\"\n    };\n\n    snprintf(str, len, \"%s of %s\", rname[c.rank], sname[c.suit]);\n    return str;\n}\n\n/*\n *      Determine the card's score.\n */\nint card_score(struct Card c)\n{\n    if (c.rank == ACE) return 11;\n    if (c.rank &gt; TEN) return 10;\n    return c.rank + 1;\n}\n\n/*\n *      Simple example code\n */\nint main()\n{\n    struct Deck deck;\n    int score = 0;\n    int ncard = 0;\n\n    srand(time(NULL));\n\n    deck_init(&amp;deck);\n\n    while (deck.ncard &amp;&amp; score &lt; 17) {\n        struct Card c = deck_deal(&amp;deck);\n        char buf[32];\n\n        puts(card_str(buf, sizeof(buf), c));\n        score += card_score(c);\n        ncard++;\n    }\n    printf(\"%d cards drawn with a score of %d.\\n\", ncard, score);\n\n    return 0;\n}\n</code></pre>\n\n<p>Things to note:</p>\n\n<ul>\n<li><p>The deck struct keeps the current number of cards still in the deck alongside the cards proper. When it is initialised, the deck is put into \"factory order\". Only when picking a card, a random decision is made. (You could as well shuffle the deck on initialisation and pick the topmost card if you wanted to, of course.)</p></li>\n<li><p>Printing, drawing and evaluating a card are three separate functions. Drawing a card is an action on the deck that yields a card. Printing and evaluating operate on a single card.</p></li>\n<li><p>Printing is achieved by printing to a char buffer here. This is somewhat ugly, but C's way to create strings. It has the advantage that you can use the function in a <code>printf</code> directly, but you must provide a char buffer.</p></li>\n<li><p>When you have many constants with consecutive values, you can use an <code>enum</code>, which enumerates these constants for you. Enumerated values start at 0, so that you can put an extra value, such as <code>MAX_SUIT</code> and <code>MAX_RANK</code> here, at the end to give you the number of enumerated items.</p></li>\n<li><p>The code for picking a card, printing it and evaluating it is a bit longer than yours, because these things have been separated. You can always write a function do do these three things, if you like, without sacrificing the nice modularity. (I suggest that you create a player struct for the player and the dealer, so that the pick-and-evaluate function can easily keep track of the scores.)</p></li>\n</ul>\n"}], "owner": {"reputation": 123, "user_id": 5693488, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/e3d426b5c47baa46aa20882f8b5b125a?s=128&d=identicon&r=PG&f=1", "display_name": "William hart", "link": "https://stackoverflow.com/users/5693488/william-hart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1451483858, "creation_date": 1451477028, "last_edit_date": 1451482295, "question_id": 34529214, "link": "https://stackoverflow.com/questions/34529214/cant-get-my-program-to-work-properly-same-numbers-when-dealing-cards", "title": "Cant get my program to work properly, same numbers when dealing cards", "body": "<p>So I'm getting pretty far in my program thanks to the help I've gotten from here.</p>\n\n<p>When I'm calling my function to print out random cards, but I get the same card every time. </p>\n\n<p>So to sum it up, player 1 gets 5 of clubs, the next card is still 5 of clubs.. The dealer gets 5 of clubs too... </p>\n\n<p>I used this in a loop to deal out 2 cards, but I still got 5 of clubs and 5 of clubs, so it's always the same cards (not just 5 of clubs, 9 of hearts etc).\n<strong>Its the last bit of code in the function <code>int player1()</code></strong></p>\n\n<p>Here's how my code looks:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n#define DIAMONDS 0\n#define CLUBS 1\n#define HEARTS 2\n#define SPADES 3\n#define COLOR_SIZE 13\n#define NR_OF_SUITS 4\n#define DECK_SIZE 52\n#define JACK 11\n#define QUEEN 12\n#define KING 13\n#define ACE 1\n\nstruct Card\n{\n    int suit;\n    int value;\n    int *sum;\n};\n\nint player2(struct Card* deck);\nint player1(struct Card* deck);\nint printCards(struct Card *cardDeck);\nvoid swapCards(struct Card *cardA, struct Card *cardB);\nvoid shuffleCards(struct Card *cardDeck);\n\n//==========================================================================\nint main()\n{\n    srand((unsigned)time(NULL));\n    //struct Card deck[DECK_SIZE];      //Statiskt allokerad array\n    struct Card * deck; //Dynamiskt allokerad array\n    int index;\n    int suit_index;\n\n    deck = (struct Card *)malloc(sizeof(struct Card) * DECK_SIZE);\n    for (suit_index = 0; suit_index &lt; NR_OF_SUITS; suit_index++)    /* Initiera kortleken */\n        for (index = 0; index &lt; COLOR_SIZE; index++)\n        {\n            deck[suit_index*COLOR_SIZE + index].suit = suit_index;\n            deck[suit_index*COLOR_SIZE + index].value = index;\n        }\n    shuffleCards(deck);\n    player1(deck);\n    system(\"pause\");\n    return 0;\n}\n//==========================================================================\n\nint printCards(struct Card *cardDeck)\n{\n    int sum = 0;\n    for (int i = 0; i &lt; 1; i++)\n    {\n        switch (cardDeck[i].value + 1)\n        {\n        case ACE: printf(\"Ace \");\n            cardDeck[i].value = 11;\n            break;\n        case JACK: printf(\"Jack \");\n            cardDeck[i].value = 10;\n            break;\n        case QUEEN: printf(\"Queen\");\n            cardDeck[i].value = 10;\n            break;\n        case KING: printf(\"King \");\n            cardDeck[i].value = 10;\n            break;\n        default: printf(\"%d \", cardDeck[i].value);\n            break;\n        }\n\n        printf(\"of \");\n        switch (cardDeck[i].suit)\n        {\n        case DIAMONDS: printf(\"Diamonds \");\n            break;\n        case HEARTS: printf(\"Hearts \");\n            break;\n        case CLUBS: printf(\"Clubs \");\n            break;\n        case SPADES: printf(\"Spades \");\n            break;\n        default: printf(\"Something went wrong!! \");\n            break;\n        }\n        printf(\"\\n\");\n        sum += cardDeck[i].value;\n    }\n    return sum;\n}\n//----------------------------------------------------------------------\n\nvoid swapCards(struct Card * cardA, struct Card *cardB)\n{\n    struct Card temp;\n    temp = *cardA;\n    *cardA = *cardB;\n    *cardB = temp;\n}\n//----------------------------------------------------------------------\n\nvoid shuffleCards(struct Card *cardDeck)\n{\n\n    for (int i = 0; i &lt; DECK_SIZE; i++)\n        swapCards(&amp;cardDeck[i], &amp;cardDeck[rand() % 52]);\n}\n//----------------------------------------------------------------------\n\nint player1(struct Card* deck) {\n    int i;\n    int val = 0;\n    int val2 = 0;\n    int sum1, sum2, sum3, first;\n    char name[20], name2[20];\n    //Player 1, gets 2 cards\n    gets(name);\n    printf(\"Welcome %s\\n\", name);\n    for (i = 0; i &lt; 2; i++) {\n        sum1 = printCards(deck);\n        val += sum1;\n    }\n    printf(\"%s, your hand is %d\\n\\n\",name, val);\n\n    //Player2, only 1 card so far\n    gets(name2);\n    printf(\"Welcome %s\\n\", name2);\n    sum2 = printCards(deck);\n    printf(\"%s, your hand has a total of %d\\n\\n\", name2, sum2);\n\n    //Dealers turn, looping til value is greater or equal to 17\n    printf(\"Dealers turn\\nDealers cards are:\\n\");\n    sum3 = printCards(deck);\n    val2 += sum3;\n    printf(\"%d Dealer has a total of \\n\", val2);\n    while (val2 &lt; 17) {\n        printf(\"Dealer gets a new card\\n\");\n        sum3 = printCards(deck);\n        val2 += sum3;\n        printf(\"Dealers card is %d, dealers value is now %d\\n\", sum3, val2);\n    }\n    printf(\"Dealer has a total of %d\\n\", val2);\n}\n</code></pre>\n\n<h2>Question:</h2>\n\n<p>How do I get different cards every time I call my function?</p>\n\n<h2>Note:</h2>\n\n<p>I've tried using different variables, loops and such but it still wont work.\nI really need a solution here, because I've tried like everything and I think this is the last problem I have.\nI know my code isn't the prettiest, but I'll fix that later.  </p>\n"}, {"tags": ["c", "linux", "gcc", "cryptography", "rsa"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1451477531, "post_id": 34529162, "comment_id": 56799657, "body": "Please paste the session transcript into the talk instead of linking to an image."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1451478097, "post_id": 34529162, "comment_id": 56799936, "body": "The code could use a little bit of coherent indentation."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1451477486, "creation_date": 1451477486, "answer_id": 34529323, "question_id": 34529162, "link": "https://stackoverflow.com/questions/34529162/i-am-working-with-the-source-code-of-rsa-algorithm-it-compiles-correctly-with-no/34529323#34529323", "title": "I am working with the source code of RSA Algorithm.It compiles correctly with no errors but the output is not correct", "body": "<p>Your program expects a number as the plain text. You pass the string <code>\"hi\"</code>. What did you expect to happen?</p>\n\n<p>Next time, consider checking the return value of <code>scanf</code>. It indicates how many items were successfully scanned. Use this to find out if the user actually typed a number.</p>\n"}], "owner": {"reputation": 27, "user_id": 5545103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75bc0033d810ac8008ad45c80fdb1bf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jasika", "link": "https://stackoverflow.com/users/5545103/jasika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "closed_date": 1451492336, "answer_count": 1, "score": -1, "last_activity_date": 1451478961, "creation_date": 1451476775, "last_edit_date": 1451478961, "question_id": 34529162, "link": "https://stackoverflow.com/questions/34529162/i-am-working-with-the-source-code-of-rsa-algorithm-it-compiles-correctly-with-no", "closed_reason": "Not suitable for this site", "title": "I am working with the source code of RSA Algorithm.It compiles correctly with no errors but the output is not correct", "body": "<p>I am working with the source code of RSA Algorithm and there are no errors in following code compilation but few warnings with respect to incorrect flags.But the output is not as it should be.\nSource Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint phi,M,n,e,d,C,FLAG;\nint check()\n{\nint i;\nfor(i=3;e%i==0 &amp;&amp; phi%i==0;i+2)\n{\n FLAG = 1;\n return 0;\n}\nFLAG = 0;\nreturn 0;\n}\n\nvoid encrypt()\n{\nint i;    \nC = 1;\nfor(i=0;i&lt; e;i++)\nC=C*M%n;\nC = C%n;\nprintf(\"\\n\\tEncrypted keyword : %d\",C);\n}\nvoid decrypt()\n{\nint i;\n M = 1;\nfor(i=0;i&lt; d;i++)\nM=M*C%n;\nM = M%n;\nprintf(\"\\n\\tDecrypted keyword : %d\",M);\n}\n\nint main()\n{    system(\"clear\");\n int p,q,s;\n printf(\"Enter Two Relatively Prime Numbers\\t: \");\n scanf(\"%d%d\",&amp;p,&amp;q);\n n = p*q;\n phi=(p-1)*(q-1);\n printf(\"\\n\\tF(n)\\t= %d\",phi);\n do\n {\n  printf(\"\\n\\nEnter e(less than F(n)\\t: \");\n  scanf(\"%d\",&amp;e);\n  check();\n }while(FLAG==1);\n d = 1;\n do\n  {\n     s = (d*e)%phi;\n     d++;\n  }while(s!=1);     \n  d = d-1;\n   printf(\"\\n\\tPublic Key\\t: {%d,%d}\",e,n);\n   printf(\"\\n\\tPrivate Key\\t: {%d,%d}\",d,n);\n   printf(\"\\n\\nEnter The Plain Text\\t: \");\n   scanf(\"%d\",&amp;M);\n   printf(\"\\n \\n\");\n   printf(\"\\n\\nEnter the Cipher text\\t: \");\n   scanf(\"%d\",&amp;C);\n   encrypt();\n   decrypt();\n   getchar();\n   }\n</code></pre>\n\n<p>output of the above code snippet -</p>\n\n<p><a href=\"https://i.stack.imgur.com/umADM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/umADM.png\" alt=\"Output Image\"></a></p>\n\n<p>Any suggestions to solve incorrect output response?</p>\n"}, {"tags": ["c", "printf", "language-lawyer", "c99", "format-specifiers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1451474325, "post_id": 34528346, "comment_id": 56798009, "body": "If you continue to read the linked answer you will see <i>why</i> both the <code>printf</code> formats are for <code>double</code>. It has to do with how arguments are passed to variable argument functions by the compiler."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 6, "last_activity_date": 1451474331, "creation_date": 1451474331, "answer_id": 34528481, "question_id": 34528346, "link": "https://stackoverflow.com/questions/34528346/l-length-modifier-has-no-effect-on-a-following-a-a-e-e-f-f-g-or-g-conve/34528481#34528481", "title": "`l` length modifier has no effect on a following a, A, e, E, f, F, g, or G conversion specifier", "body": "<p>The documentation is correct: <code>printf</code> sees no difference between <code>float</code> and <code>double</code>.</p>\n\n<p>Parameters of functions from the <code>printf</code> family are taken through the variable-length mechanism. In the variable-length part of a variable-length argument list, the \"default argument promotions\" apply: types <code>char</code> and <code>short int</code> are promoted to <code>int</code>, and <code>float</code> is promoted to <code>double</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1451509677, "last_edit_date": 1451509677, "creation_date": 1451476832, "answer_id": 34529173, "question_id": 34528346, "link": "https://stackoverflow.com/questions/34528346/l-length-modifier-has-no-effect-on-a-following-a-a-e-e-f-f-g-or-g-conve/34529173#34529173", "title": "`l` length modifier has no effect on a following a, A, e, E, f, F, g, or G conversion specifier", "body": "<p><strong>TL;DR</strong> - The answer that you linked is perfectly fine. <code>%f</code> in <code>printf()</code> can handle <code>double</code> and <code>float</code>, both type of argument.</p>\n\n<hr>\n\n<p><strong>Information:</strong> <code>printf()</code> is a <a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow\">variadic function</a>.</p>\n\n<p>As per <code>C99</code>, chapter 7.19.6.3</p>\n\n<h3>Syntax</h3>\n\n<blockquote>\n  <p><code>#include &lt;stdio.h&gt;</code><br>\n  <code>int printf(const char * restrict format, ...);</code></p>\n</blockquote>\n\n<p>and regarding the <code>%f</code> format specifier,</p>\n\n<blockquote>\n  <p><code>f,F</code></p>\n  \n  <p>A <code>double</code> argument representing a floating-point number is converted to\n  decimal notation in the style <em>[\u2212]ddd.ddd</em>, where the number of digits after\n  the decimal-point character is equal to the precision specification. [....]</p>\n</blockquote>\n\n<p>So, we see, the standard <em>only</em> mentions <code>double</code>. Curious about its <em>younger counterpart</em>, <code>float</code>?</p>\n\n<p>Then, from chapter \u00a76.5.2.2, paragraph 7</p>\n\n<blockquote>\n  <p>[...] The ellipsis notation in a function prototype declarator causes\n  argument type conversion to stop after the last declared parameter. The default argument\n  promotions are performed on trailing arguments.</p>\n</blockquote>\n\n<p>and, regarding the <em>default argument promotions</em> part, (<em>emphasis mine</em>), paragraph 6,</p>\n\n<blockquote>\n  <p>[...] If the expression that denotes the called function has a type that does not include a\n  prototype, the integer promotions are performed on each argument, <strong>and arguments that\n  have type <code>float</code> are promoted to <code>double</code></strong>. These are called the default argument\n  promotions. [...]</p>\n</blockquote>\n\n<p>so, for <code>printf()</code> function, with <code>%f</code> format specifier, it does not matter whether the supplied argument is of type <code>float</code> or <code>double</code>, it will get promoted to <code>double</code> anyway.</p>\n"}], "owner": {"reputation": 11132, "user_id": 136285, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/98d92168760c5b402a315926e4700d5f?s=128&d=identicon&r=PG", "display_name": "malat", "link": "https://stackoverflow.com/users/136285/malat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 34529173, "answer_count": 2, "score": 2, "last_activity_date": 1451509677, "creation_date": 1451473799, "last_edit_date": 1495535300, "question_id": 34528346, "link": "https://stackoverflow.com/questions/34528346/l-length-modifier-has-no-effect-on-a-following-a-a-e-e-f-f-g-or-g-conve", "title": "`l` length modifier has no effect on a following a, A, e, E, f, F, g, or G conversion specifier", "body": "<p>I am trying to understand the following <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fprintf.html\" rel=\"nofollow noreferrer\">section</a>:</p>\n\n<blockquote>\n  <p><code>l (ell)</code> </p>\n  \n  <p>Specifies that a following <code>d</code>, <code>i</code>, <code>o</code>, <code>u</code>, <code>x</code>, or <code>X</code> conversion\n  specifier applies to a <code>long</code> or <code>unsigned long</code> argument; that a\n  following <code>n</code> conversion specifier applies to a pointer to a <code>long</code>\n  argument; that a following <code>c</code> conversion specifier applies to a <code>wint_t</code>\n  argument; that a following <code>s</code> conversion specifier applies to a pointer\n  to a <code>wchar_t</code> argument; or has no effect on a following <code>a</code>, <code>A</code>, <code>e</code>, <code>E</code>, <code>f</code>,\n  <code>F</code>, <code>g</code>, or <code>G</code> conversion specifier.</p>\n</blockquote>\n\n<p>I can also see that this is consistent with <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">cppreference:fprintf</a> where <code>\"%f\"</code> and <code>\"%lf\"</code> are equivalent for <code>printf()</code> family.</p>\n\n<p>So is <a href=\"https://stackoverflow.com/a/28222471/136285\">this answer</a> erroneous ? Or does <code>C99</code> makes it clear now that <code>\"%f\"</code> is for <code>float</code>, while <code>\"%lf\"</code> is for <code>double</code> for <code>printf()</code> family functions ?</p>\n"}, {"tags": ["c", "cuda"], "answers": [{"tags": [], "owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "is_accepted": true, "score": 2, "last_activity_date": 1451761892, "last_edit_date": 1451761892, "creation_date": 1451495030, "answer_id": 34533836, "question_id": 34527991, "link": "https://stackoverflow.com/questions/34527991/cuda-can-shfl-delta-be-different-between-lanes/34533836#34533836", "title": "CUDA: can __shfl delta be different between lanes?", "body": "<blockquote>\n  <p>can __shfl delta be different between lanes?</p>\n</blockquote>\n\n<p>Yes, the <code>delta</code> can be different between lanes.  This could be used, for example, to broadcast a 32-bit quantity from a single lane to other lanes (although this is not the only way to perform such a <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#warp-examples-broadcast\" rel=\"nofollow\">broadcast</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n__global__ void bcast() {\n  int value = threadIdx.x;\n  value = __shfl_up(value, threadIdx.x); // Get \"value\" from lane 0\n  if (value) printf(\"Thread %u failed: %d\\n\", threadIdx.x, value);\n}\n\nint main() {\n  bcast&lt;&lt;&lt; 1, 32 &gt;&gt;&gt;();\n  cudaDeviceSynchronize();\n  return 0;\n}\n</code></pre>\n\n<p>Regarding your question about <code>delta</code> values, (note that the <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#synopsis\" rel=\"nofollow\">function prototypes</a> for <code>__shfl_up</code> and <code>__shfl_down</code> insist that <code>delta</code> is an <code>unsigned int</code> quantity, so it can't be negative),   the question about a <code>delta</code> value of <code>0</code> is not quite clear to me.  That would reference the origination lane, which by definition cannot be out-of-range or inactive.  So, yes,  a zero index value would return the origination lane value, just as an out-of-range index would.</p>\n\n<p>Regarding your last question, an out-of bounds computed source lane ID is not the same thing as an in-bounds computed source lane ID that happens to reference an inactive thread.  In the former case, the threads own shuffle variable is returned.  In the latter case, the returned value is undefined.</p>\n\n<p>Computation of the source lane ID for <code>delta</code> values greater than 31 may also have some additional complexity.  Casually, such computations would appear to be always out-of-bounds (but the actual behavior may be somewhat more complicated).   I'm not sure the documentation clearly touches on this, and I'm not sure this is the crux of any of your questions. </p>\n"}], "owner": {"reputation": 319, "user_id": 2833518, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/27be1aa132f4adb388aa37f92b50f004?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/2833518/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 34533836, "answer_count": 1, "score": 2, "last_activity_date": 1451761892, "creation_date": 1451472556, "last_edit_date": 1451472974, "question_id": 34527991, "link": "https://stackoverflow.com/questions/34527991/cuda-can-shfl-delta-be-different-between-lanes", "title": "CUDA: can __shfl delta be different between lanes?", "body": "<p>According to the <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#warp-shuffle-functions\" rel=\"nofollow\">CUDA documentation</a>, <code>__shfl()</code> intrinsics permit the exchange of a variable between threads. More specifically <code>__shfl_up()</code> and <code>__shfl_down()</code> (also <code>__shfl_xor()</code>) allow the exchange of a variable of a different lane. <code>unsigned int delta</code> is the second argument to these and specifies (positively or negatively) the <code>offset</code> lane id of the lane to exchange the variable from. I had always assumed this <code>delta</code> must be constant for all lanes in a warp. So, for example, one has to call like thus</p>\n\n<pre><code>val += __shfl_down(val, 3);\n</code></pre>\n\n<p>or </p>\n\n<pre><code>for (i = 1; i &lt; warpSize / 2; i ++)\n  val += __shfl_down(val, i);\n</code></pre>\n\n<p>however, I've just realized there is nothing explicitly stating that <code>delta</code> must be the same for all lanes (as long as all lanes are participating). Therefore, is the following <code>undefined</code> or fine</p>\n\n<pre><code>val += __shfl_down(val, threadIdx.x % warpSize);\n</code></pre>\n\n<p>This is just for example, and many of the lanes will add nothing as <code>delta</code> <a href=\"http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#warp-shuffle-functions\" rel=\"nofollow\">\"will not wrap around ... so effectively the upper <code>delta</code> lanes will remain unchanged.\".</a> There is also nothing specifying that <code>delta</code> must be <code>&gt;0</code>, <code>0</code> must just return the same as for out-of-range <code>delta</code>?</p>\n\n<p>Further to this, is the documentation not contradicting itself here?</p>\n\n<blockquote>\n  <p>Threads may only read data from another thread which is actively participating in the <code>__shfl()</code> command. If the target thread is inactive, the retrieved value is undefined.</p>\n</blockquote>\n\n<p>So it is undefined for inactive threads, however ...</p>\n\n<blockquote>\n  <p>All <code>__shfl()</code> intrinsics return the 4-byte word referenced by var from the source lane ID as an unsigned integer. If the source lane ID is out of range or the source thread has exited, the calling thread's own var is returned.</p>\n</blockquote>\n\n<p>... which means that for inactive threads it returns the calling thread's own var. Which further means, that in the my example above, if <code>delta</code> is out-of-bounds it adds itself, not nothing?</p>\n"}, {"tags": ["c++", "c", "gcc", "clang", "strict-aliasing"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451472029, "post_id": 34527729, "comment_id": 56796849, "body": "can you explain in more detail what is significant in the assembly output"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451472107, "post_id": 34527729, "comment_id": 56796892, "body": "There&#39;s a lot less distraction if you delete <code>main</code> from the example"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1451472196, "post_id": 34527729, "comment_id": 56796937, "body": "clang implements the function in one instruction (<code>rol edi, 16</code>) ... gcc doesn&#39;t seem to know about that"}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 10, "creation_date": 1451473399, "post_id": 34527729, "comment_id": 56797524, "body": "Why worry about optimization of UB code ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 1, "creation_date": 1451473410, "post_id": 34527729, "comment_id": 56797526, "body": "I&#39;ve taken the liberty of including the C function and its output in your question to hopefully make it easier to understand. Please double-check to make sure I didn&#39;t misunderstand your question."}, {"owner": {"reputation": 23269, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1451474810, "post_id": 34527729, "comment_id": 56798250, "body": "@M.M - gcc in 4.4.7 implements it as identity function that is obviously not the intent of the writer of the code. gcc does that apparently since strict aliasing allows that. I wonder why they stopped doing this optimization in newer versions."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1451474810, "post_id": 34527729, "comment_id": 56798251, "body": "Interestingly, UB aside, these are all local variables, you would think that the compiler can easily reason about them..."}, {"owner": {"reputation": 23269, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1451474924, "post_id": 34527729, "comment_id": 56798295, "body": "@Jarod42 - a) as i said is it ub or article is wrong? b) if it is UB why did compilers stopped using SA for optimizations? It can be a big perf diff in some cases."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 1, "creation_date": 1451503358, "post_id": 34527729, "comment_id": 56813339, "body": "Article explains strict-aliasing rule and specific behaviour for one implementation. Implementation may have changed to better handle other (valid) cases. They may also have identified that the code breaks SA but give correct code anyway... I would say it would be a <i>regression</i> if code were correct, but it not the case here."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1451504166, "post_id": 34527729, "comment_id": 56813760, "body": "@KarolyHorvath you would - I&#39;d speculate similiarly to OP that they deliberately don&#39;t optimize this case because there is a lot of &quot;real&quot; code in the wild that commits the same error but the developers don&#39;t realize it or don&#39;t want to fix the code. There&#39;s already enough people who get snotty about code like <code>if ( !p-&gt;x || !p )</code> being removed"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451504931, "post_id": 34527729, "comment_id": 56814103, "body": "@M.M: I know that the linux kernel developers are really pissed about it and they have their own flags for handling it (and honestly, I don&#39;t blame them). As for the example you&#39;ve provided.. it&#39;s just silly (I know, the problem sometimes doesn&#39;t look this obvious but still...)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451533759, "post_id": 34527729, "comment_id": 56823515, "body": "How is the code compiled?"}, {"owner": {"reputation": 23269, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "edited": false, "score": 0, "creation_date": 1451568945, "post_id": 34527729, "comment_id": 56836029, "body": "you have the flags in the link, but basically -O2/3"}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1452019733, "post_id": 34527729, "comment_id": 56983565, "body": "What do you mean by &quot;wrt&quot;?"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 0, "creation_date": 1452026893, "post_id": 34527729, "comment_id": 56987481, "body": "The only way to know is to bisect the commits until you find which one changed the behavior. Then you can read the corresponding email discussion on gcc-patches and see why it happened."}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1452027908, "post_id": 34527729, "comment_id": 56988018, "body": "@M.M but what is that <code>if</code> intended to do? If <code>!p</code>, it&#39;ll crash anyway if not optimized. Or is null page accessible in the kernel, so that this code relies on this?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1452062224, "post_id": 34527729, "comment_id": 56999594, "body": "@Ruslan it&#39;s intended to be <code>if ( !p || !p-&gt;x )</code> and the coder didn&#39;t realize there was a difference"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1452522061, "post_id": 34527729, "comment_id": 57193284, "body": "Unless the implementers choose to document how they treat specific cases of undefined behavior it is hazardous to try and reason about it. UB by definition allows all behavior and allows that behavior to change between versions and that is completely valid UB. You can even find that varying the code could lead to UB being exploited in one case but not another. A lot of good reads in <a href=\"http://stackoverflow.com/a/31746063/1708801\">my answer here</a>. Note in UB canaries link in my answer gcc has shifted its exploitation wrt to strict aliasing over time."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1468363623, "post_id": 34527729, "comment_id": 64094480, "body": "@Jarod42: The fact that the authors of C89 did not mandate behavioral guarantees which might be difficult to honor on some platforms was never intended to suggest that platforms that could support such guarantees shouldn&#39;t do so.  It is impossible to write <i>any</i> well-formed program which would be guaranteed not to invoke UB on an obtuse-but-compliant limitation, since it would be possible to have a pair of obtuse-but-compliant implementations such that any well-formed program that didn&#39;t invoke UB  on one would be <i>guaranteed</i> to invoke UB on the other."}], "answers": [{"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452015935, "post_id": 34617865, "comment_id": 56981507, "body": "Well, there was a time when &quot;the compiler people would say  &#39;nyaah, nyaah, the standards people said we can do this&#39;&quot;, <a href=\"https://lkml.org/lkml/2009/1/12/369\" rel=\"nofollow noreferrer\">in Linus&#39; own famous words</a>. Perhaps they have been bugged long enough, or there is a generation change which often is the only thing facilitating progress?"}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 1, "creation_date": 1452015990, "post_id": 34617865, "comment_id": 56981534, "body": "That&#39;s a rare example of c compiler people actually deoptimizing code in the name of &quot;nobody actually profits from this, but lots of people get caught by unexpected behavior&quot;. Actually I&#39;m perfectly surprised, what happened to the gcc people that they&#39;re starting to make rational decisions based on real-life code instead of blindly following the standard?"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452016167, "post_id": 34617865, "comment_id": 56981638, "body": "@PeterA.Schneider: Well, certainly times have changed. Probably the thread of CLang has something to do with it."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452016220, "post_id": 34617865, "comment_id": 56981672, "body": "And: I think your last #define is perfectly legal. (as opposed to <code>#define private public</code>; not the define as such, but the resulting code if the original contains <code>private</code>)."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452016282, "post_id": 34617865, "comment_id": 56981718, "body": "@PeterA.Schneider: As far as I remember (I may be mistaken), #defining a keyword is UB, so it would be UB in C++ but legal (not so useful) in C."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452016883, "post_id": 34617865, "comment_id": 56982048, "body": "True -- &quot;A translation unit shall not #define or #undef names lexically identical to keywords,...&quot; (17.6.4.3.1 in the 2011 std)"}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1452016979, "post_id": 34617865, "comment_id": 56982103, "body": "@PeterA.Schneider: Yes, I have just found it in the C++ std. Curiously enough, I found no such statement in the C std, only that you must not #define a keyword before #including a standard header."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452017183, "post_id": 34617865, "comment_id": 56982206, "body": "The dangers of <a href=\"http://www.catb.org/jargon/html/D/DWIM.html\" rel=\"nofollow noreferrer\">DWIM</a>. I really hope the compiler also warns about it..."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452017511, "post_id": 34617865, "comment_id": 56982392, "body": "Regarding your header-example: Obviously, there&#39;s a <code>_FOO_H_</code>-define in use by the implementation or some other header then. Tough luck, and have fun figuring that one out."}, {"owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1452017867, "post_id": 34617865, "comment_id": 56982568, "body": "@Deduplicator: That&#39;s why some versions of VC++ automatically write the include guards with a GUID <code>#define AFX_STDAFX_H__A9DB83DB_A9FD_11D0_BFD1_444553540000__INCLUDED&zwnj;&#8203;_</code>. Nice try, no starting underscore, but there is a double underscore, I can still format your hard drive!"}, {"owner": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1452029818, "post_id": 34617865, "comment_id": 56988936, "body": "Where&#39;s the intent of the standard documented?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1452034977, "post_id": 34617865, "comment_id": 56991274, "body": "@Ruslan: In the Apocrypha ;-)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1495259470, "post_id": 34617865, "comment_id": 75188012, "body": "@Ruslan; The authors of the Standard published rationale documents.  The authors of the Standard stated that they did not wish to break existing code, and further claimed that they regarded the most serious silent-breaking change as the mandated promotion of short unsigned types to signed int.  If one presumes they were being honest about such things, they must have intended that quality compilers for target platforms and fields where programmers routinely relied upon behaviors not mandated by the Standard should continue to support those behaviors whether or not the Standard mandated them."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 14968, "user_id": 673852, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/S5IZ5.png?s=128&g=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/673852/ruslan"}, "edited": false, "score": 0, "creation_date": 1495259582, "post_id": 34617865, "comment_id": 75188032, "body": "@Ruslan: There is a huge difference between saying that compilers should not be required to generate code that allows for the possibility of aliasing in cases where even in the absence of rules against it there would be <i>no evidence whatsoever</i> to suggest that it might occur, versus saying that compilers should be willfully blind to patterns where aliasing would be obvious."}], "tags": [], "owner": {"reputation": 79096, "user_id": 865874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ACMnN.png?s=128&g=1", "display_name": "rodrigo", "link": "https://stackoverflow.com/users/865874/rodrigo"}, "is_accepted": false, "score": 8, "last_activity_date": 1452017036, "last_edit_date": 1495540976, "creation_date": 1452015298, "answer_id": 34617865, "question_id": 34527729, "link": "https://stackoverflow.com/questions/34527729/why-compilers-no-longer-optimize-this-ub-with-strict-aliasing/34617865#34617865", "title": "Why compilers no longer optimize this UB with strict aliasing", "body": "<p>In this <a href=\"https://stackoverflow.com/a/2959468/865874\">other related question</a>, there is a comment by @DanMoulding. Let me plagiarize it:</p>\n\n<blockquote>\n  <p>The intent of the standard's strict aliasing rules are to allow the compiler to optimize in situations where it doesn't and cannot know whether an object is being aliased. The rules permit the optimizer to not make worst-case aliasing assumptions in those situations. However, when it is clear from the context that an object is being aliased, then the compiler should treat the object as being aliased, no matter what types are being used to access it. Doing otherwise is not in line with the intent of the language's aliasing rules.</p>\n</blockquote>\n\n<p>In your code, the aliasing of <code>*ptr</code> and <code>acopy</code> is obvious, as both are local variables, so any <em>sane compiler</em> should treat them as aliased. From this point of view the GCC 4.4 behaviour, although in line with a strict reading of the standard, will be considered a bug by most real-world programmers.</p>\n\n<p>You have to consider why there are aliasing rules in the first place. They are so that the compiler may take advantage of optimizations in situations where there <em>might be</em> be aliasing, but most likely there are none. So the language forbids that aliasing and the compiler is free to optimize. For example:</p>\n\n<pre><code>void foo(int *idx, float *data)\n{ /* idx and data do not overlap */ }\n</code></pre>\n\n<p>However, when the aliasing involves local variables, there are no lost optimizations:</p>\n\n<pre><code>void foo()\n{\n    uint32_t x;\n    uint16_t *p = (uint16_t *)&amp;x; //x and p do overlap!\n}\n</code></pre>\n\n<p>The compiler is trying to do its job as best as possible, not trying to find an UB somewhere to have an excuse to format your hard drive!</p>\n\n<p>There are a lot of code that is technically UB but is ignored by all compilers. For example, what would you think of a compiler that treats this as an empty file:</p>\n\n<pre><code>#ifndef _FOO_H_\n#define _FOO_H_\nvoid foo(void);\n#endif\n</code></pre>\n\n<p>Or what about a compiler that ignores this macro:</p>\n\n<pre><code>#define new DEBUG_NEW\n</code></pre>\n\n<p>simply because the standard allows it to do so?</p>\n"}, {"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1607540956, "post_id": 34618258, "comment_id": 115308126, "body": "&quot;What would you rather - that the compiler produces fast code that doesn&#39;t do what you want, or slightly slower code that does do what you want?&quot; If what I wrote is UB, I&#39;d rather it be the former, and I&#39;d want the code it produces to be as wrong as possible, so that I can find and fix the UB early in testing."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1607830018, "post_id": 34618258, "comment_id": 115394748, "body": "@JosephSible-ReinstateMonica I would rather than &quot;as wrong as possible&quot; compilers produced code which immediately errored out. But I&#39;m afraid that would prevent a lot of software I currently used from working as intended. If that lead to such software being fixed, of course, that would be a good thing... I&#39;m afraid there&#39;s just too much legacy code which is badly behaved, though."}], "tags": [], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "is_accepted": true, "score": 11, "last_activity_date": 1452606966, "last_edit_date": 1452606966, "creation_date": 1452016662, "answer_id": 34618258, "question_id": 34527729, "link": "https://stackoverflow.com/questions/34527729/why-compilers-no-longer-optimize-this-ub-with-strict-aliasing/34618258#34618258", "title": "Why compilers no longer optimize this UB with strict aliasing", "body": "<p>The GCC developers put some effort into making the compiler behave \"as expected\" in these cases. (I wish I could give you a proper reference for this - I remember it coming up on a mailing list or somesuch at some time).</p>\n\n<p>At any rate, something you say:</p>\n\n<blockquote>\n  <p>... does not implement the function as it could using strict aliasing</p>\n</blockquote>\n\n<p>... implies perhaps a slight misunderstanding of what the strict aliasing rules are for. Your code sample invokes <em>undefined behavior</em> - so <em>any</em> compilation is technically valid, including just a plain <code>ret</code> or generation of a trap instruction, or even nothing at all (it's legitimate to assume the method can never be called). That newer versions of GCC produce longer/slower code is hardly a deficiency, since producing code that does any particular thing at all would not violate the standard. In fact, the newer versions improve the situation by producing code that does what the programmer <em>probably intended</em> the code to do instead of silently doing something differerent.</p>\n\n<p>What would you rather - that the compiler produces fast code that doesn't do what you want, or slightly slower code that does do what you want?</p>\n\n<p>That being said, I firmly believe that you should not write code that breaks the strict aliasing rules. Relying on the compiler doing the \"right\" thing when it is \"obvious\" what is intended is walking a tightrope. Optimisation is hard enough already, without the compiler having to guess at - and make allowances for - what the programmer intended. Further, it's possible to write code which obeys the rules and which can be turned into very efficient object code by the compiler. Indeed the further question can be raised:</p>\n\n<p><strong>Why did earlier versions of GCC behave the way they did</strong>, and \"optimize\" the function by relying on adherence to the strict aliasing rules?</p>\n\n<p>That's a little bit complicated, but is interesting for this discussion (especially in light of suggestions that the compiler is going to some lengths just to break code). Strict aliasing is a component of (or rather, a rule which assists) a process called <em>alias analysis</em>. This process decides whether two pointers alias or not. There are, essentially, 3 possible conditions between any two pointers:</p>\n\n<ul>\n<li>They MUST NOT ALIAS (the strict aliasing rule makes it easy to deduce this condition, though it can sometimes be deduced in other ways).</li>\n<li>They MUST ALIAS (this requires analysis; value propagation might detect this condition for instance)</li>\n<li>They MAY ALIAS. This is the default condition when neither of the other two conditions can be established.</li>\n</ul>\n\n<p>In the case of the code in your question, strict aliasing implies a MUST NOT ALIAS condition between <code>&amp;acopy</code> and <code>ptr</code> (it is trivial to make this determination, because the two values have incompatible types which are not allowed to alias). This condition allows for the optimisation that you then see: all the manipulation of <code>*ptr</code> values can be discarded because they cannot in theory effect the value of <code>acopy</code> and they do not otherwise escape the function (which can be determined via <em>escape analysis</em>).</p>\n\n<p>It takes further effort to determine the MUST ALIAS condition between the two pointers. Furthermore, in doing so the compiler would need to ignore (at least temporarily) the previously ascertained MUST NOT ALIAS condition, which means it must spend time attempting to ascertain the truth of a condition which, if everything is as it should be, must be false.</p>\n\n<p>When both MUST NOT ALIAS and MUST ALIAS conditions are determined, we have a case where the code must be invoking undefined behaviour (and we can issue a warning). We then have to decide which condition to keep and which to discard. Because MUST NOT ALIAS, in this case, comes from a constraint which can be (and indeed has been) broken by the user, it is the best option to discard.</p>\n\n<p>So, the older versions of GCC either do not do the requisite analysis to determine the MUST ALIAS condition (perhaps because the opposite MUST NOT ALIAS condition has already been established), or alternatively, the older GCC version opts to discard the MUST ALIAS condition in preference to the MUST NOT ALIAS condition, which leads to faster code which does not do what the programmer most likely intended. In either case, it seems that the newer versions offer an improvement.</p>\n"}, {"comments": [{"owner": {"reputation": 20275, "user_id": 887836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UmvnY.jpg?s=128&g=1", "display_name": "Alexander Oh", "link": "https://stackoverflow.com/users/887836/alexander-oh"}, "edited": false, "score": 0, "creation_date": 1452107793, "post_id": 34640442, "comment_id": 57027473, "body": "alot better than before. +1. on a side note: materialization is one of the optimizations that take advantage of strict aliasing. if you can proof a segment of memory was not changed you don&#39;t have to reload the value from memory but can use a cached value (from a register) or compute it again. strict aliasing was meant to help reduce the cost of memory analysis."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1495259831, "post_id": 34640442, "comment_id": 75188068, "body": "I don&#39;t like the phraseology &quot;do what i mean&quot;.  Better would be to say that rules which exist for the sole purpose of allowing optimization and do not define <i>any</i> useful meaning, should be interpreted in such a fashion as to avoid breaking code <i>which would be meaningful and useful in their absence</i>.  Pessimistically regarding all casts from <code>T*</code> to <code>U*</code> as potential accesses of type <code>T</code> except in cases where they could be proven not to be <i>even without using aliasing rules</i> would not block many useful optimizations, but would instead reduce the fraction of useful programs..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1495259864, "post_id": 34640442, "comment_id": 75188073, "body": "...which would otherwise require disabling all type-based aliasing &quot;optimizations&quot;."}], "tags": [], "owner": {"reputation": 3667, "user_id": 3288910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c2b8044eca80b9a707c716c530d9f5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/3288910/jason"}, "is_accepted": false, "score": 3, "last_activity_date": 1452106194, "last_edit_date": 1452106194, "creation_date": 1452105862, "answer_id": 34640442, "question_id": 34527729, "link": "https://stackoverflow.com/questions/34527729/why-compilers-no-longer-optimize-this-ub-with-strict-aliasing/34640442#34640442", "title": "Why compilers no longer optimize this UB with strict aliasing", "body": "<p>The goal for a compiler should generally be matching the intent of the code as closely as possible.  In this case, the code invokes UB, but the intent should be pretty clear.  My guess is that more recently compilers have been focusing on being correct than taking advantage of UB for optimization purposes.</p>\n\n<p>Strict aliasing is essentially an assumption that code isn't trying to subvert the type system, which as noted by @rodrigo, gives the compiler more information it can use to optimize.  If the compiler can't assume strict aliasing, it precludes a number of non-trivial optimizations, which is why C even added a <code>restrict</code> qualifier (C99).</p>\n\n<p>Breaking strict aliasing isn't necessary for any optimizations I can think of.  In fact, in this specific case, depending on what the original intent was, you can get correct/optimized code without invoking UB...</p>\n\n<pre><code>uint32_t wswap(uint32_t ws) {\n  return (ws &lt;&lt; 16) | (ws &gt;&gt; 16);\n}\n</code></pre>\n\n<p>compiles to...</p>\n\n<pre><code>wswap:                                  # @wswap\n    .cfi_startproc\n# BB#0:\n    roll    $16, %edi\n    movl    %edi, %eax\n    retq\n</code></pre>\n"}], "owner": {"reputation": 23269, "user_id": 700825, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=128&d=identicon&r=PG", "display_name": "NoSenseEtAl", "link": "https://stackoverflow.com/users/700825/nosenseetal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 1, "accepted_answer_id": 34618258, "answer_count": 3, "score": 18, "last_activity_date": 1452606966, "creation_date": 1451471641, "last_edit_date": 1452026073, "question_id": 34527729, "link": "https://stackoverflow.com/questions/34527729/why-compilers-no-longer-optimize-this-ub-with-strict-aliasing", "title": "Why compilers no longer optimize this UB with strict aliasing", "body": "<p>One of the first results for strict aliasing on google is this article\n<a href=\"http://dbp-consulting.com/tutorials/StrictAliasing.html\">http://dbp-consulting.com/tutorials/StrictAliasing.html</a><br>\nOne interesting thing I noticed is this: <a href=\"http://goo.gl/lPtIa5\">http://goo.gl/lPtIa5</a></p>\n\n<pre><code>uint32_t swaphalves(uint32_t a) {\n  uint32_t acopy = a;\n  uint16_t* ptr = (uint16_t*)&amp;acopy;\n  uint16_t tmp = ptr[0];\n  ptr[0] = ptr[1];\n  ptr[1] = tmp;\n  return acopy;\n}\n</code></pre>\n\n<p>is compiled to</p>\n\n<pre><code>swaphalves(unsigned int):\n        mov     eax, edi\n        ret\n</code></pre>\n\n<p>by GCC 4.4.7. Any compiler newer than that (4.4 is mentioned in the article so article is not wrong) does not implement the function as it could using strict aliasing. \nWhat is the reason for this? \nWas it in fact bug in GCC or GCC decided to drop it since many lines of code were written in a way that thay produce UB  or it is just a compiler regression that lasts for years... \nAlso Clang does not optimize it. </p>\n"}, {"tags": ["c", "time", "struct", "stopwatch", "elapsedtime"], "comments": [{"owner": {"reputation": 8057, "user_id": 338249, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a660dd7e94731072e5543e7b6da75321?s=128&d=identicon&r=PG", "display_name": "rjdkolb", "link": "https://stackoverflow.com/users/338249/rjdkolb"}, "edited": false, "score": 5, "creation_date": 1451468961, "post_id": 34526922, "comment_id": 56795196, "body": "Can you please reformat the code ?"}, {"owner": {"reputation": 39, "user_id": 5682624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ace07a7d561a879cbfc0111634c3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan ", "link": "https://stackoverflow.com/users/5682624/jonathan"}, "edited": false, "score": 0, "creation_date": 1451469005, "post_id": 34526922, "comment_id": 56795222, "body": "My friend tried running, execute successfully but failed to run."}, {"owner": {"reputation": 39, "user_id": 5682624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ace07a7d561a879cbfc0111634c3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan ", "link": "https://stackoverflow.com/users/5682624/jonathan"}, "edited": false, "score": 0, "creation_date": 1451469178, "post_id": 34526922, "comment_id": 56795321, "body": "You can view the source code here: <a href=\"https://www.dropbox.com/s/watwdp7b7vmjbb8/elapsed.c?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/watwdp7b7vmjbb8/elapsed.c?dl=0</a>"}, {"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451469355, "post_id": 34526922, "comment_id": 56795419, "body": "Don&#39;t post external links to your code. You should <a href=\"https://stackoverflow.com/posts/34526922/edit\">edit</a> your post to include the code, select it, and press Ctrl+K"}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1451517312, "post_id": 34526922, "comment_id": 56819677, "body": "If you intended these to be time-of-day values entered, then your <i>else</i> case is wrong.  To account for time going over midnight, <code>24 * 60 * 60 + secondEnd - secondStart</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": false, "score": 1, "last_activity_date": 1451470205, "creation_date": 1451470205, "answer_id": 34527346, "question_id": 34526922, "link": "https://stackoverflow.com/questions/34526922/elapsed-time-c-program-using-struct/34527346#34527346", "title": "Elapsed Time C Program using struct", "body": "<p>You have a mistakes in main function, you should use in scanf <code>int *</code> instead of <code>int</code> so you must add <code>&amp;</code>, you can see below:</p>\n\n<pre><code>//main function\nvoid main(){\n    printf(\"Enter start time (Hour Minute Second) using 24 hours system : \");\n    scanf(\"%d %d %d\", &amp;startTime.hour, &amp;startTime.min, &amp;startTime.sec);\n\n    printf(\"Enter end time (Hour Minute Second) using 24 hours system : \");\n    scanf(\"%d %d %d\", &amp;endTime.hour, &amp;endTime.min, &amp;endTime.sec);\n\n    elapsed = elapsedTime(startTime, endTime);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 5635287, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hZnAj.jpg?s=128&g=1", "display_name": "J. Toran", "link": "https://stackoverflow.com/users/5635287/j-toran"}, "is_accepted": false, "score": 0, "last_activity_date": 1451476533, "creation_date": 1451476533, "answer_id": 34529117, "question_id": 34526922, "link": "https://stackoverflow.com/questions/34526922/elapsed-time-c-program-using-struct/34529117#34529117", "title": "Elapsed Time C Program using struct", "body": "<p>I assume you would want to calculate <code>different.sec</code> so I think the correct calculation of the different time is:</p>\n\n<pre><code>secPerHr = 60 * 60;\nsecPerMin = 60;\n\nif (secondDif &gt;= secPerHr) {\ndifferent.hour = secondDif / secPerHr;\nsecondDif -= different.hour * secPerHr;\n}\nif (secondDif &gt;= secPerMin) {\ndifferent.min = secondDif / secPerMin;\nsecondDif -= different.min * secPerMin;\n}\ndifferent.sec = secondDif;\n</code></pre>\n\n<p>Also, for testing purposes you would probably want to display the result in your main function.</p>\n"}], "owner": {"reputation": 39, "user_id": 5682624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ace07a7d561a879cbfc0111634c3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan ", "link": "https://stackoverflow.com/users/5682624/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1451476533, "creation_date": 1451468755, "last_edit_date": 1451470002, "question_id": 34526922, "link": "https://stackoverflow.com/questions/34526922/elapsed-time-c-program-using-struct", "title": "Elapsed Time C Program using struct", "body": "<pre><code>//import library\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n//declare variable structure\nstruct time{\n    int hour;\n    int min;\n    int sec;\n}startTime, endTime, different, elapsed;\n\n//mould struct and compute elapsedTime\nstruct time elapsedTime(struct time start, struct time end){\n\n    int secondStart, secondEnd, secondDif;\n\n    secondEnd = end.hour * 60 * 60 + end.min * 60 + end.sec;\n    secondStart = start.hour * 60 * 60 + start.min * 60 + start.sec;\n    if (secondEnd&gt;secondStart)\n        secondDif = secondEnd - secondStart;\n    else\n        secondDif = secondStart - secondEnd;\n\n    different.hour = secondDif / 60 / 60;\n    different.min = secondDif / 60;\n\n    return different;\n}\n\n//main function\nvoid main(){\n    printf(\"Enter start time (Hour Minute Second) using 24 hours system : \");\n    scanf(\"%d %d %d\", startTime.hour, startTime.min, startTime.sec);\n\n    printf(\"Enter end time (Hour Minute Second) using 24 hours system : \");\n    scanf(\"%d %d %d\", endTime.hour, endTime.min, endTime.sec);\n\n    elapsed = elapsedTime(startTime, endTime);\n}\n</code></pre>\n\n<p>Can someone help me check and run the code to check whether it is working or not?</p>\n"}, {"tags": ["c", "dynamic-programming"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1451468659, "post_id": 34526724, "comment_id": 56795036, "body": "<code>ans=(str[i-1]*10+str[i]);</code> probably doesn&#39;t do what you whink; you are operating on ASCII codes here. You also should print the result for each string, that is, inside the loop. And please print a newline after the result as the assignment requires."}, {"owner": {"reputation": 135, "user_id": 5714638, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f2b8bd3da3b41caa6e48b6b3e67ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "Monte San", "link": "https://stackoverflow.com/users/5714638/monte-san"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1451469566, "post_id": 34526724, "comment_id": 56795529, "body": "@MOehm What do you suggest I should write inside the loop?"}], "answers": [{"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1451474349, "post_id": 34528293, "comment_id": 56798025, "body": "While the recursive solution is elegant, you should probably provide some kind of memoization in order not to re-calculate the same branches over and over again. Try your code with a longer string that consists of all 1s or 2s."}, {"owner": {"reputation": 135, "user_id": 5714638, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f2b8bd3da3b41caa6e48b6b3e67ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "Monte San", "link": "https://stackoverflow.com/users/5714638/monte-san"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1451475075, "post_id": 34528293, "comment_id": 56798362, "body": "@MOehm Yes Sure!..Thank YOU!!"}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 2, "last_activity_date": 1451473654, "creation_date": 1451473654, "answer_id": 34528293, "question_id": 34526724, "link": "https://stackoverflow.com/questions/34526724/how-to-identify-the-bug-in-my-alphacode-implementation/34528293#34528293", "title": "How to identify the bug in my Alphacode implementation?", "body": "<p>What you need is a recursive function whitch divides if you find somthing in between 10 and 26</p>\n\n<pre><code>long long int count_decodings( const char * str )\n{\n    long long int count = 1;\n\n    // only accept digits \n    // continue while next character greater or equal '0' and less or equal '9'\n    while ( ( *str &gt;= '0' &amp;&amp; *str &lt;= '9' ) )\n    {\n        char actChar = *str;\n        str ++; // increment string pointer ( now str points to character after actChar )\n\n        if ( actChar == '1' &amp;&amp; ( *str &gt;= '0' &amp;&amp; *str &lt;= '9' ) )\n        {\n            // if we have 1 followed by somthing from 0 to 9 we have an new case\n            count += count_decodings( str + 1 ); // continue with next sign and increment count of decodings\n        }\n        else if ( actChar == '2' &amp;&amp; ( *str &gt;= '0' &amp;&amp; *str &lt;= '6' ) )\n        {\n            // if we have 2 followed by somthing from 0 to 6 we have an new case\n            count += count_decodings( str + 1 ); // continue with next sign and increment count of decodings\n        }\n    }\n\n    return count;\n}\n\nint main()\n{\n    char str[5010];\n    scanf(\"%s\",str);\n    while(str[0]!=0)\n    {\n        long long int count = count_decodings( str );\n        printf( \"%llu\\n\", count);\n        scanf(\"%s\", str);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 3, "last_activity_date": 1451474042, "creation_date": 1451474042, "answer_id": 34528408, "question_id": 34526724, "link": "https://stackoverflow.com/questions/34526724/how-to-identify-the-bug-in-my-alphacode-implementation/34528408#34528408", "title": "How to identify the bug in my Alphacode implementation?", "body": "<p>There are several errors:</p>\n\n<ul>\n<li><p>You print the result only once, for the last string. You should, of course, print a result for all strings. Your code currently looks like this:</p>\n\n<pre><code>scanf(\"%s\",str);\nwhile (str[0] != '0') {\n    // determine solution\n\n    scanf(\"%s\", str);\n}\nprintf(\"%llu\\n\", dp[len-1]);\n</code></pre>\n\n<p>The <code>printf</code> should go before the last <code>scanf</code>.</p></li>\n<li><p>This:</p>\n\n<pre><code>ans = (str[i - 1] * 10 + str[i]);\n</code></pre>\n\n<p>is a calculation on ASCII codes. You need somethingb like this:</p>\n\n<pre><code>ans = ((str[i - 1] - '0') * 10 + str[i] - '0');\n</code></pre></li>\n<li><p>The code</p>\n\n<pre><code>if (str[i] - '0') dp[i] = str[i];\n</code></pre>\n\n<p>should handle substrings that begin with a zero, but it leaves <code>dp[i]</code> effectively uninitialised (or filled with garbage from a previous string) for such strings.</p></li>\n</ul>\n\n<p>The principal error is that you attack the problem from the wrong end, though. When you go forward through the string, your algorithm loks like this:</p>\n\n<pre><code>if the next two digits are a number from 10 to 26:\n    dp[i] = dp[i + 1] + dp[i + 2]\nelse if the current digit isn't zero:\n    dp[i] = dp[i + 1]\nelse:\n    dp[i] = 0\n</code></pre>\n\n<p>That code requires knowledge of <code>dp[j]</code> with <code>j &gt; i</code> in order to calculate <code>dp[i]</code>. That means that you can solve the problem by walking through the array backwards. Your solution is then <code>dp[0]</code>.</p>\n\n<p>Because you only look forward one or two digits, you don't even need an auxiliary array; it is enough to keep the last two values and swap them accordingly after each iteration.</p>\n\n<p>Here's a solution that does this. It has only been tested for the given cases, but it should give you an idea how to solve your problem. The code doesn't do a lot of checking; it is assumed that the string has only digits.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nunsigned long long poss(const char *str)\n{\n    unsigned long long p1, p2;\n    size_t len = strlen(str);\n    size_t i;\n\n    if (len == 0) return 0;\n\n    i = len - 1;\n    p1 = 1;\n    p2 = 1;\n\n    if (str[i] == '0') p1 = 0;\n\n    while (i-- &gt; 0) {\n        unsigned long long p = p1;\n\n        if (str[i] == '0') p = 0;\n        if (str[i] == '1') p += p2;\n        if (str[i] == '2' &amp;&amp; str[i + 1] &lt; '7') p += p2;\n\n        p2 = p1;\n        p1 = p;\n    }    \n\n    return p1;\n}\n\nint main(void)\n{\n    char str[5001];\n\n    while(scanf(\"%s\",str) == 1 &amp;&amp; str[0] != '0') {\n        printf(\"%llu\\n\", poss(str));\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5714638, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f2b8bd3da3b41caa6e48b6b3e67ad5e?s=128&d=identicon&r=PG&f=1", "display_name": "Monte San", "link": "https://stackoverflow.com/users/5714638/monte-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 34528408, "answer_count": 2, "score": 0, "last_activity_date": 1459887959, "creation_date": 1451468019, "last_edit_date": 1459887959, "question_id": 34526724, "link": "https://stackoverflow.com/questions/34526724/how-to-identify-the-bug-in-my-alphacode-implementation", "title": "How to identify the bug in my Alphacode implementation?", "body": "<p>The following is my implementation of the problem: <a href=\"http://www.spoj.com/problems/ACODE/\" rel=\"nofollow\">http://www.spoj.com/problems/ACODE/</a>    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main() {\n    long long int dp[5010] = { 0 }, i, len, ans;\n    char str[5010];\n\n    scanf(\"%s\", str);\n    while (str[0] != '0') {\n       len = strlen(str);\n       dp[0]  =1;\n       for (i = 1; i &lt; len; i++) {\n           ans = (str[i-1] * 10 + str[i]);\n           if (str[i] - '0')\n               dp[i] = str[i];\n           if (ans &gt;= 10 &amp;&amp; ans &lt;= 26) {\n                if ((i - 2) &lt; 0)\n                    dp[i] += dp[0];\n                else\n                    dp[i] += dp[i-2];\n            }\n        }\n        scanf(\"%s\", str);\n    }\n    printf(\"%llu\\n\", dp[len-1]);\n    return 0;\n}\n</code></pre>\n\n<p>When I run it in my IDE, it gets executed but the output is completely different from expected. Also when I run it on Ideone it shows \"time limit exceeded\". Please help me in finding my mistake.</p>\n"}, {"tags": ["c++", "c", "dll", "process", "hook"], "comments": [{"owner": {"reputation": 13641, "user_id": 1871033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30bea353b9b21b063e2be8ab57a1465e?s=128&d=identicon&r=PG", "display_name": "CherryDT", "link": "https://stackoverflow.com/users/1871033/cherrydt"}, "edited": false, "score": 0, "creation_date": 1467031063, "post_id": 34526458, "comment_id": 63546811, "body": "Wait, you want to do this on Android, but you talk about DLL...? Sounds contradictory to me, DLLs are a Windows concept. Do you mean dynamic libraries in general (including <code>.so</code>, etc.)?"}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 5136621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f358dfa0804e3d9371b7f0e8b89e5622?s=128&d=identicon&r=PG&f=1", "display_name": "pystudent", "link": "https://stackoverflow.com/users/5136621/pystudent"}, "edited": false, "score": 0, "creation_date": 1451467787, "post_id": 34526596, "comment_id": 56794556, "body": "I forgot to add that I need to do so without altering the original dlls or changing system files. (I&#39;m planning on doing so on android and I don&#39;t want to require a root)."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "reply_to_user": {"reputation": 351, "user_id": 5136621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f358dfa0804e3d9371b7f0e8b89e5622?s=128&d=identicon&r=PG&f=1", "display_name": "pystudent", "link": "https://stackoverflow.com/users/5136621/pystudent"}, "edited": false, "score": 0, "creation_date": 1451467990, "post_id": 34526596, "comment_id": 56794662, "body": "Please <a href=\"https://stackoverflow.com/posts/34526596/edit\">edit</a> your question to include this requirement."}], "tags": [], "owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "is_accepted": false, "score": 0, "last_activity_date": 1451467598, "creation_date": 1451467598, "answer_id": 34526596, "question_id": 34526458, "link": "https://stackoverflow.com/questions/34526458/hook-a-specific-function-in-a-dll/34526596#34526596", "title": "Hook a specific function in a dll", "body": "<p>Simply write a dll with the same ABI.</p>\n\n<p>The idea is to make you dll call the equivalent functions from the original dll, eventually adding a special process, or do nothing or report an unauthorized call if necessary.</p>\n"}], "owner": {"reputation": 351, "user_id": 5136621, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f358dfa0804e3d9371b7f0e8b89e5622?s=128&d=identicon&r=PG&f=1", "display_name": "pystudent", "link": "https://stackoverflow.com/users/5136621/pystudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 423, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1451468196, "creation_date": 1451467149, "last_edit_date": 1451468196, "question_id": 34526458, "link": "https://stackoverflow.com/questions/34526458/hook-a-specific-function-in-a-dll", "title": "Hook a specific function in a dll", "body": "<p>Is it possible to hook all the processes, or find out when a specific function in a dll is called? I want to be able to catch this call and inject my own code / deny access to this function. How can I do this without looping through all the processes and hook each one of them?\nIs it possible to do so without altering system files? (I'm planning on doing this on an android device and I don't want to require a root)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1451467147, "post_id": 34526432, "comment_id": 56794170, "body": "C or C++, please pick one"}, {"owner": {"reputation": 3043, "user_id": 3480199, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f27d29e6c62b1cb98d185e81397f6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/3480199/zen"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451467301, "post_id": 34526432, "comment_id": 56794258, "body": "C and C++ share the same file postfix? I&#39;m learning C now, so I think I&#39;m asking for the C standard."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1451467329, "post_id": 34526432, "comment_id": 56794278, "body": "The mentioned answer says C99 and C++98. (link removed? <a href=\"http://stackoverflow.com/questions/5676978/unicode-identifiers-and-source-code-in-c11\" title=\"unicode identifiers and source code in c11\">stackoverflow.com/questions/5676978/&hellip;</a>)"}, {"owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1451467447, "post_id": 34526432, "comment_id": 56794347, "body": "I would add that using all English names in variable names is a good practice. It means that almost anyone can read your code, rather than those that know Chinese, Swedish, Polish or whatever native languages there are. And it really doesn&#39;t look right if you mix the C english-based keywords with other languages anyway."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451467447, "post_id": 34526432, "comment_id": 56794350, "body": "@Zen So why is it tagged C++? These are different languages."}, {"owner": {"reputation": 3043, "user_id": 3480199, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f27d29e6c62b1cb98d185e81397f6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/3480199/zen"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451467462, "post_id": 34526432, "comment_id": 56794363, "body": "@DavidHeffernan, I&#39;m not familiar about C++, but I heard about that C++ is based on C, which is compatible with C. So C standard is always suitable on C++, meanwhile we can&#39;t say C++ standard is not always suitable on C?"}, {"owner": {"reputation": 3043, "user_id": 3480199, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f27d29e6c62b1cb98d185e81397f6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/3480199/zen"}, "reply_to_user": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "edited": false, "score": 0, "creation_date": 1451467575, "post_id": 34526432, "comment_id": 56794431, "body": "@Mats Petersson, I totally agree with your point. I&#39;m just curious about this feature."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1451467582, "post_id": 34526432, "comment_id": 56794436, "body": "@Zen C and C++ are evolving separately. C has features that C++ doesn&#39;t have. C++ of course has plenty more features that C doesn&#39;t have. Unless you already know the answer to your question, you have no way of knowing whether there&#39;s a relevant difference between C and C++ here. (And yes, there are some differences between the two languages related to UCNs, but they&#39;re minor.)"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1451467584, "post_id": 34526432, "comment_id": 56794438, "body": "@Zen No, that&#39;s not correct. They are different languages, albeit related. This should be tagged C only. Please correct."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1451467621, "post_id": 34526432, "comment_id": 56794454, "body": "You&#39;re wrong @Zen. In fact C and C++ are two different languages although they look very similar for the basic constructions. But the fact that in general a C++ compiler also compile C (and usually the converse) is a good point that may explain why encodings may be supported for both on your compiler."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451469100, "post_id": 34526432, "comment_id": 56795272, "body": "The question is about the C language, the duplicate question answers the same question for the C++ language."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1451469869, "post_id": 34526432, "comment_id": 56795706, "body": "Regarding the C language, non ASCII letters have been supported in identifiers since C99.  <i>Annex D - Universal character names for identifiers</i> normalizes which characters are allowed.  The downside of using these is it makes the code much harder to read for non native speakers (and writers)."}], "owner": {"reputation": 3043, "user_id": 3480199, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f27d29e6c62b1cb98d185e81397f6ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Zen", "link": "https://stackoverflow.com/users/3480199/zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1451467292, "answer_count": 0, "score": 2, "last_activity_date": 1451467411, "creation_date": 1451467051, "last_edit_date": 1451467411, "question_id": 34526432, "link": "https://stackoverflow.com/questions/34526432/start-from-which-version-does-c-standard-support-non-alphanum-variable-name", "closed_reason": "Duplicate", "title": "Start from which version does C standard support non-alphanum variable name?", "body": "<p>These days I starts learning C language.</p>\n\n<p>And today by coincidence I find my C compiler can recognize non-alphanumeric variable names. Which is amazing. Below is an example:</p>\n\n<pre><code>zen1@localhost:~/git_test|\u21d2  cat z.c\n#include &lt;stdio.h&gt;\n\nint main () {\n    char *\u4e2d\u6587\u53d8\u91cf = \"\u8c01\u662f\u4f60\u7238\u7238\";\n    printf(\"%s\\n\", \u4e2d\u6587\u53d8\u91cf);\n    return 0;\n}\nzen1@localhost:~/git_test|\u21d2  make z\ncc     z.c   -o z\nzen1@localhost:~/git_test|\u21d2  ./z\n\u8c01\u662f\u4f60\u7238\u7238\n</code></pre>\n\n<p>I searched online, which seems at first C standard doesn't support this kind of variable name.<br>\nBut after a bit search work, I didn't find which version of C standard starts to support it.<br>\nThus I asked this question.</p>\n"}, {"tags": ["c", "linux", "svn"], "comments": [{"owner": {"reputation": 2805, "user_id": 4568212, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EFy85.jpg?s=128&g=1", "display_name": "Punit Vara", "link": "https://stackoverflow.com/users/4568212/punit-vara"}, "edited": false, "score": 0, "creation_date": 1451466149, "post_id": 34525976, "comment_id": 56793676, "body": "For example You have openssl library in source code. Now what you want to do ? I means which process you want compile against the library? Can you provide me any example"}, {"owner": {"reputation": 445, "user_id": 642956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/687646e2be71fbdbce482bb555b3789c?s=128&d=identicon&r=PG", "display_name": "Gold Fish", "link": "https://stackoverflow.com/users/642956/gold-fish"}, "reply_to_user": {"reputation": 2805, "user_id": 4568212, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EFy85.jpg?s=128&g=1", "display_name": "Punit Vara", "link": "https://stackoverflow.com/users/4568212/punit-vara"}, "edited": false, "score": 0, "creation_date": 1451467498, "post_id": 34525976, "comment_id": 56794383, "body": "I manage to compile against the openssl library. My question is regarding the location of the library. Should I link my source with the libraries that are in my source or against the libraries that are in the target filesystem."}, {"owner": {"reputation": 2805, "user_id": 4568212, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EFy85.jpg?s=128&g=1", "display_name": "Punit Vara", "link": "https://stackoverflow.com/users/4568212/punit-vara"}, "edited": false, "score": 0, "creation_date": 1451467869, "post_id": 34525976, "comment_id": 56794598, "body": "As I understood Second approach is best"}, {"owner": {"reputation": 2805, "user_id": 4568212, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EFy85.jpg?s=128&g=1", "display_name": "Punit Vara", "link": "https://stackoverflow.com/users/4568212/punit-vara"}, "edited": false, "score": 0, "creation_date": 1451467910, "post_id": 34525976, "comment_id": 56794624, "body": "Because compiling and installing library to filesystem increase the size of file system"}], "owner": {"reputation": 445, "user_id": 642956, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/687646e2be71fbdbce482bb555b3789c?s=128&d=identicon&r=PG", "display_name": "Gold Fish", "link": "https://stackoverflow.com/users/642956/gold-fish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1451465245, "creation_date": 1451465245, "question_id": 34525976, "link": "https://stackoverflow.com/questions/34525976/compiling-and-linking-with-3rd-party-libraries", "title": "Compiling and linking with 3rd party libraries", "body": "<p>I have a device with ARM processor running linux OS. On my Ubuntu, which is the host with the workspace, I have two folders - the source and the target's filesystem. In order to compile, I have to link to other libraries such as sqlite and openssl, etc. These libraries sources are in the source folder.</p>\n\n<p>After the compilation of the libraries (sqlite, tslib, openssl, etc.), the libraries outputs are installed to the filesystem, so that the ARM linux can run the processes, of course.</p>\n\n<p>The thing is, that in order to compile my processes source code, I have to link them against these libraries. So, My question is, what is the right approach:</p>\n\n<ol>\n<li>To compile and install the libraries to the filesystem, and then compile the processes against the libraries that on the filesystem.</li>\n<li>To compile and install the libraries, but then compile the processes against the libraries that are placed in the source folder.</li>\n</ol>\n\n<p>Maybe it looks the same, but add the fact that we are a team that work on the whole project, so the source code (including the libraries source) and the filesystem are being handled with SVN so all the team can sync and update the code. With the first approach, in case one developer deleted the filesystem, the project won't compile till he has the filesystem and the libraries on it. In the second approach, when a a library such as tslib is updated to the last version, then everyone has to compile the library by themselves cause the output of these libraries are not copied to the filesystem which is sync with the SVN.</p>\n\n<p>In short, Is it better to work with the source and the target are linked in some way (case 1), or does the total separation between the source and the filesystem is smarter approach (case 2).\nI tried to be clear as possible and explain the issue, hope I managed doing it.</p>\n"}, {"tags": ["c", "combinations", "permutation", "letter"], "comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1451466954, "post_id": 34525884, "comment_id": 56794068, "body": "Please stop editing the posted code incrementally from the answers and comments suggestions, it makes the whole discussion inconsistent."}, {"owner": {"reputation": 9795, "user_id": 1566187, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/00cb2ecc49f0f05736dc7c14bbccfeaa?s=128&d=identicon&r=PG", "display_name": "Ely", "link": "https://stackoverflow.com/users/1566187/ely"}, "edited": false, "score": 1, "creation_date": 1451467788, "post_id": 34525884, "comment_id": 56794558, "body": "I suggest you share all necessary code so that one can run the program and test performance. You should at least do your best to make it easier for us to help. Your question is not a coding problem, it&#39;s a performance problem; and this is a coding Q&amp;A site, not a performance site. How much time does it take for your test to complete?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451503637, "post_id": 34525884, "comment_id": 56813471, "body": "Here you have input with 50 pairs: 50 F C A F E F E E C E F E B F F E E E E E E E E B F F F C C A F E E A B F E F F C F E A A E E E E E E E E B C A E C E C E E B C E E E E F E F E C A D E E E E D A E B C C E E E E F A A C C E E B B D D F   My program is now running something about 3 hours, still haven&#39;t found correct combination. I think it should be programmed in other way, could somebody tell me some advice how to program it somehow else ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451832474, "post_id": 34525884, "comment_id": 56900258, "body": "Can you post a link to this large test file?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451833456, "post_id": 34525884, "comment_id": 56900574, "body": "Here you go <a href=\"http://speedding.sweb.cz/input.txt\" rel=\"nofollow noreferrer\">speedding.sweb.cz/input.txt</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451465792, "post_id": 34526048, "comment_id": 56793494, "body": "I don&#39;t have problem with functionality. I have problem with time of computing. If there&#39;s more than 50 groups, it takes hours to compute (there&#39;s 50! combinations). I need to make it done in a few minutes"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1451465865, "post_id": 34526048, "comment_id": 56793535, "body": "Actually you <i>do</i> have a &quot;problem with functionality&quot; - your code has serious bugs and will therefore exhibit Undefined Behaviour and will probably give incorrect results. You need to fix your code before you try to optimise it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451465958, "post_id": 34526048, "comment_id": 56793587, "body": "Now I have changed code to     char group[sum][3]; Still takes hours to compute."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1451466014, "post_id": 34526048, "comment_id": 56793611, "body": "In that case you should update your question appropriately, otherwise you will be wasting other people&#39;s time. (Also, how do you know it still takes &quot;hours to compute&quot; ? You only applied the bug fix in the last two minutes ?)."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1451466557, "post_id": 34526048, "comment_id": 56793882, "body": "You still have to fix the loop in <code>main()</code> (i = 0; i &lt; sum...). And better have the second dimension of size 2 and index with 0 and 1"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1451466858, "post_id": 34526048, "comment_id": 56794024, "body": "Use <code>0</code> based indices for rows and columns in the <code>group</code> matrix.  Also use <code>fscanf(input, &quot; %c&quot;, &amp;group[i][1]);</code> to read 1 character at a time, ignoring spaces and <b>not</b> storing the null byte beyond the end of the subarray."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1451465793, "last_edit_date": 1451465793, "creation_date": 1451465547, "answer_id": 34526048, "question_id": 34525884, "link": "https://stackoverflow.com/questions/34525884/find-combination-of-groups-and-letters/34526048#34526048", "title": "Find combination of groups and letters", "body": "<p>In C array indices start at 0, so an array of size <code>N</code> has valid indices from <code>0</code> to <code>N-1</code>. In the code above you are accessing the array <code>group</code> out of bounds, since it has size <code>2</code> (valid indices are therefore <code>0</code> and <code>1</code>), yet you are trying to access indices <code>1</code> and <code>2</code>.</p>\n\n<p>Either change:</p>\n\n<pre><code>char group[sum][2];\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>char group[sum][3];\n</code></pre>\n\n<p>or use indices <code>0</code>/<code>1</code> rather than <code>1</code>/<code>2</code>.</p>\n\n<p>Note also that your code lacks error checking, e.g. on the call to <code>fopen</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451744664, "post_id": 34555462, "comment_id": 56877492, "body": "Thank you, but I have to use all of given groups and they CAN&#39;T repeat :( I also know, there will always be solution."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451753582, "post_id": 34555462, "comment_id": 56880693, "body": "@Speedding: I don&#39;t understand your constraint.  I generate exactly the same permutations is the same order, the speedup comes from early pruning of impossible solutions.  Do you mean the identity pairs cannot be repeated immediately and must be used after another part of the path?  That&#39;s easy to add to the algorithm."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451754959, "post_id": 34555462, "comment_id": 56881177, "body": "No, that&#39;s ok. Try to solve this input 6 A A C B A C B A B D D B ... It will print out some bullshits."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451775163, "post_id": 34555462, "comment_id": 56887806, "body": "@Speedding: my bad, I was presumptuous and did not correctly assess the consequences of the change of method: constructing the path into a separate array requires an extra array to keep track of which pair is already used. I restored your original idea and just added the early pruning, checking for path continuity before recursion.  It is still very fast ans solves the problems correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451826082, "post_id": 34555462, "comment_id": 56898301, "body": "Thank you. You are the best !! ^^"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1451832690, "last_edit_date": 1451832690, "creation_date": 1451645192, "answer_id": 34555462, "question_id": 34525884, "link": "https://stackoverflow.com/questions/34525884/find-combination-of-groups-and-letters/34555462#34555462", "title": "Find combination of groups and letters", "body": "<p>Your program as several issues:</p>\n\n<ul>\n<li>you use 1 based indexing, which causes confusion and leads to referencing arrays and subarrays beyond their defined ends.</li>\n<li>you parse the input with <code>fscanf</code> using the <code>%s</code> specifier: this is unsafe and will write 2 bytes for each of your inputs, writing beyond the end of each subarray and beyond the end of the last array.</li>\n</ul>\n\n<p>You already know how to fix these, preferably by using 0 based indexing</p>\n\n<p>Your algorithm is <strong>very</strong> ineffective, complexity <code>O(n!)</code> because you enumerate all possible permutations and check for validity only on complete permutations.  You can drastically improve the performance by only enumerating permutations which already verify the constraint for their initial elements.  The complexity is substantially lower, still quadratic but <code>n</code> is quite small.</p>\n\n<p>Here is a modified version of your code that does this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint permutation(char group[][2], int buffer, int sum) {\n    if (buffer == sum)\n        return group[sum-1][1] == group[0][0];\n\n    for (int i = buffer; i &lt; sum; i++) {\n        if (group[buffer-1][1] == group[i][0]) {\n            char temp = group[buffer][0];\n            group[buffer][0] = group[i][0];\n            group[i][0] = temp;\n            temp = group[buffer][1];\n            group[buffer][1] = group[i][1];\n            group[i][1] = temp;\n\n            if (permutation(group, buffer + 1, sum))\n                return 1;\n\n            temp = group[buffer][0];\n            group[buffer][0] = group[i][0];\n            group[i][0] = temp;\n            temp = group[buffer][1];\n            group[buffer][1] = group[i][1];\n            group[i][1] = temp;\n        }\n    }\n    return 0;\n}\n\nint main(void) {\n    FILE *input = fopen(\"input.txt\", \"r\");\n    int sum, i;\n\n    if (input != NULL) {\n        if (fscanf(input, \"%d\", &amp;sum) != 1 || sum &lt;= 0) {\n            printf(\"invalid number of pairs\\n\");\n            fclose(input);\n            return 1;\n        }\n\n        char group[sum][2];\n\n        for (i = 0; i &lt; sum; i++) {\n            if (fscanf(input, \" %c %c\", &amp;group[i][0], &amp;group[i][1]) != 2) {\n                printf(\"incorrect input for pair number %d\\n\", i);\n                fclose(input);\n                return 1;\n            }\n        }\n        fclose(input);\n        if (permutation(group, 1, sum)) {\n            FILE *output = fopen(\"output.txt\", \"a\");\n            if (output == NULL) {\n                printf(\"cannot open output file\\n\");\n                return 2;\n            }\n            for (i = 0; i &lt; sum; i++) {\n                fprintf(output, \"%c %c\\n\", group[i][0], group[i][1]);\n            }\n            fclose(output);\n            return 0;\n        } else {\n            printf(\"complete path not found\\n\");\n            return 1;\n        }\n    }\n    printf(\"cannot open input file\\n\");\n    return 2;\n}\n</code></pre>\n\n<p>I modified other aspects of the code to improve efficiency and reusability:</p>\n\n<ul>\n<li>input is checked for validity.</li>\n<li>the recursive function stops and returns 1 when it finds a complete path. This allows the program to continue whether it found the path or not.</li>\n<li>output is handled from the <code>main</code> function for consistency.</li>\n</ul>\n\n<p>The above code solves the problem for the specified input with n=50 in <strong>less than 0.002 seconds</strong> on my laptop. It prints <code>F C C E E F F E E E E E E E E E E B B F F E E A A F F C C A A A A E E F F C C E E E E E E E E E E B B C C E E E E F F E E F F F F E E C C E E E E E E B B F F A A D D A A C C C C E E E E E E B B D D F\n</code></p>\n\n<p><strong>EDIT</strong> I realized that, since you are looking for a full closed path, you do not need to try different possibilities for the first pair.  <code>main</code> can call <code>permutation</code> with <code>1</code> instead of <code>0</code> and the <code>permutation</code> can be simplified as <code>buffer</code> can never be <code>0</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "edited": false, "score": 0, "creation_date": 1451837287, "post_id": 34578119, "comment_id": 56901846, "body": "Once, I wish I was such a good programmer as you are. Thank you, master."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451837959, "post_id": 34578119, "comment_id": 56902101, "body": "@Speedding: keep working hard, it takes a long time, constantly honing your skills.  I still learn new things and get humbled everyday, after 42 years (yes, 42!).  Stackoverflow is a great place for thist, so is <a href=\"https://projecteuler.net/\" rel=\"nofollow noreferrer\">projecteuler.net</a>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451862958, "post_id": 34578119, "comment_id": 56910702, "body": "@Speedding: oops!  I don&#39;t know if my code solved the problem on your system, but it failed for the 100k input file on mine.  I investigated this and came to a strong conclusion: recursion uses too much stack space for a recursive approach and possibly for automatic arrays as well.  I updated the answer with a non recursive version that uses the heap."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1451865659, "last_edit_date": 1451865659, "creation_date": 1451834489, "answer_id": 34578119, "question_id": 34525884, "link": "https://stackoverflow.com/questions/34525884/find-combination-of-groups-and-letters/34578119#34578119", "title": "Find combination of groups and letters", "body": "<p>Your new code has some problems:</p>\n\n<ul>\n<li><code>find</code> is defined asa returning <code>int</code>, but you return nothing.  You indeed do not test if you have found a complete path, fully relying on the assumption that there is at least one and that you have found it.</li>\n<li>You do not test for path closure.  You may find a closed path by chance, but you may also produce an unclosed path.</li>\n<li>Using 2 loops to find the unused pairs is less efficient than using a temporary array <code>used[sum]</code>.</li>\n<li>The first pair is always the first, so you can simplify the <code>find</code> function a little.</li>\n</ul>\n\n<p>Here is an improved version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint find(char group[][2], int buffer, int sum, int path[], unsigned char used[]) {\n    int i;\n    char last = group[path[buffer-1]][1];\n\n    if (buffer == sum)\n        return last == group[0][0];\n\n    for (i = 1; i &lt; sum; i++) {\n        if (!used[i] &amp;&amp; last == group[i][0]) {\n            path[buffer] = i;\n            used[i] = 1;\n            if (find(group, buffer + 1, sum, path, used))\n                return 1;\n            used[i] = 0;\n        }\n    }\n    return 0;\n}\n\nint main() {\n    FILE *input = fopen(\"input.txt\", \"r\");\n\n    if (input != NULL) {\n        int sum = 0, i;\n\n        fscanf(input, \"%d\", &amp;sum);\n\n        char group[sum][2];\n        int path[sum];\n        unsigned char used[sum];\n\n        for (i = 0; i &lt; sum; i++)\n            fscanf(input, \" %c %c\", &amp;group[i][0], &amp;group[i][1]);\n\n        path[0] = 0;  // always start at first element\n        used[0] = 1;\n        for (i = 1; i &lt; sum; i++)\n            used[i] = 0;\n\n        if (find(group, 1, sum, path, used)) {\n            FILE *output = fopen(\"output.txt\", \"a\");\n            for (i = 0; i &lt; sum; i++)\n                fprintf(output, \"%c %c\\n\", group[path[i]][0], group[path[i]][1]);\n        }\n    } else {\n        printf(\"Input file was not found.\");\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: I tested this new version with your large input file: it crashes on my laptop.  The previous version with the <code>permutation</code> functions works like a charm, producing the complete path in 0.060 seconds.  So there is a complete path and something is wrong with this <code>find</code> function.</p>\n\n<p>There are few differences between the algorithms:</p>\n\n<ul>\n<li><code>permutation</code> uses less stack space: a single automatic array of size n*2 (200k) versus 3 automatic arrays total size <code>n*(sizeof(int) + 3)</code> (700k).</li>\n<li><code>permutation</code> uses fewer variables, so recursion uses less stack space, but both probably use more than 1 MB of stack space to recurse 100000 times.</li>\n<li><code>find</code> does more scans, where <code>permutation</code> swaps <code>group</code> pairs and always snaps the next one directly.</li>\n</ul>\n\n<p>I reimplemented <code>find</code> without recursion and finally got it to produce a complete path.  It is a different one and it takes much longer to compute, 3.5 seconds.</p>\n\n<p>For larger input files, you definitely should not use recursion and you should even allocate the arrays from the heap with <code>malloc</code>.</p>\n\n<p>Here is the non recursive code, using heap memory:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint find(const char group[][2], int sum, int path[]) {\n    path[0] = 0;\n    if (sum &lt;= 1)\n        return group[0][1] == group[0][0];\n\n    unsigned char *used = calloc((size_t)sum, sizeof(*used));\n\n    for (int buffer = 1, i = 1;; i++) {\n        if (i == sum) {\n            --buffer;\n            if (buffer == 0) {\n                free(used);\n                return 0;\n            }\n            i = path[buffer];\n            used[i] = 0;\n        } else\n        if (!used[i] &amp;&amp; group[path[buffer-1]][1] == group[i][0]) {\n            path[buffer] = i;\n            if (buffer == sum - 1) {\n                if (group[i][1] == group[0][0]) {\n                    free(used);\n                    return 1;\n                }\n            } else {\n                buffer++;\n                used[i] = 1;\n                i = 0;\n            }\n        }\n    }\n}\n\nint main() {\n    FILE *input = fopen(\"input.txt\", \"r\");\n\n    if (input != NULL) {\n        int sum = 0, i;\n\n        fscanf(input, \"%d\", &amp;sum);\n\n        char (*group)[2] = calloc((size_t)sum, sizeof(*group));\n        int *path = calloc((size_t)sum, sizeof(*path));\n\n        for (i = 0; i &lt; sum; i++)\n            fscanf(input, \" %c %c\", &amp;group[i][0], &amp;group[i][1]);\n\n        if (find(group, sum, path)) {\n            FILE *output = fopen(\"output.txt\", \"a\");\n            for (i = 0; i &lt; sum; i++)\n                fprintf(output, \"%c %c\\n\", group[path[i]][0], group[path[i]][1]);\n        }\n    } else {\n        printf(\"Input file was not found.\");\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5645978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 1, "accepted_answer_id": 34578119, "answer_count": 3, "score": 1, "last_activity_date": 1494120462, "creation_date": 1451464895, "last_edit_date": 1494120462, "question_id": 34525884, "link": "https://stackoverflow.com/questions/34525884/find-combination-of-groups-and-letters", "title": "Find combination of groups and letters", "body": "<p>I have to find a combination of groups of letters, second letter in first group should be the same as first letter in second group etc.</p>\n\n<p>For example, solution for this group: <code>AA, CB, AC, BA, BD, DB</code>\nis this: <code>CB, BD, DB, BA, AA, AC</code></p>\n\n<p>I have this code so far, it works, but if there is a lot of groups, it takes ages to compute. I need to make it more efficient.</p>\n\n<p>In the input file, there's this input</p>\n\n<pre><code>10\nC D\nB C\nB B\nB B\nD B\nB B\nC A\nA B\nB D\nD C\n</code></pre>\n\n<p>My code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid permutation(char group[][2], int buffer, int sum) {\n    int i, j;\n    char temp;\n\n    if (buffer == sum &amp;&amp; group[1][1] == group[sum][2]) {\n        for (i = 1; i &lt; sum; i++)\n            if (group[i][2] != group[i+1][1]) break;\n\n        if (i == sum) {\n            FILE *output;\n            output = fopen(\"output.txt\", \"a\");\n            for (j = 1; j &lt;= sum; j++) {\n                fprintf(output, \"%c %c\\n\", group[j][1], group[j][2]);\n            }\n            exit(1);\n        }\n    } else {\n        for (i = buffer; i &lt;= sum; i++) {\n            temp = group[buffer][1];\n            group[buffer][1] = group[i][1];\n            group[i][1] = temp;\n            temp = group[buffer][2];\n            group[buffer][2] = group[i][2];\n            group[i][2] = temp;\n\n            permutation(group, buffer + 1, sum);\n\n            temp = group[buffer][1];\n            group[buffer][1] = group[i][1];\n            group[i][1] = temp;\n            temp = group[buffer][2];\n            group[buffer][2] = group[i][2];\n            group[i][2] = temp;\n        }\n    }\n}\n\nint main() {\n    FILE *input;\n\n    input = fopen(\"input.txt\", \"r\");\n\n    int sum, i;\n\n    fscanf(input, \"%d\", &amp;sum);\n\n    char group[sum][2];\n\n    for (i = 1; i &lt;= sum; i++) {\n        fscanf(input, \"%s\", &amp;group[i][1]);\n        fscanf(input, \"%s\", &amp;group[i][2]);\n    }\n\n    permutation(group, 1, sum);\n}\n</code></pre>\n\n<p><strong>EDIT</strong> So I have made some changes in my program (thanks to your help, I'm very new to programming so I'm sorry for mistakes), I use permutations no more and I'm just finding path. It works well, but now my input has 100000 groups and it takes a lot of time once again (about 2 hours and I need to make it done in 1 hour in maximal). I will probably have to do that in other way once again xD Any ideas ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint find(char group[][2], int buffer, int sum, int path[]) {\n    int i, j;\n\n    for (i = 0; i &lt; sum; i++) {\n        for (j = 0; j &lt; buffer; j++)\n            if (path[j] == i)\n                break;\n        if (buffer == 0 ||\n            (group[path[buffer-1]][1] == group[i][0] &amp;&amp; buffer == j)) {\n            printf(\"%d\\n\", buffer); // just for me to know what program is currently computing\n            path[buffer] = i;\n            find(group, buffer + 1, sum, path);\n            if (path[sum-1] != 0)\n                return;\n        }\n    }\n}\n\nint main() {\n    FILE *input = fopen(\"input.txt\", \"r\");\n\n    if (input != NULL) {\n        int sum, i;\n\n        fscanf(input, \"%d\", &amp;sum);\n        char group[sum][2];\n        int path[sum];\n\n        for (i = 0; i &lt; sum; i++)\n            fscanf(input, \" %c %c\", &amp;group[i][0], &amp;group[i][1]);\n        for (i = 0; i &lt; sum;i++)\n            path[i] = 0;\n\n        find(group, 0, sum, path);\n\n        FILE *output = fopen(\"output.txt\", \"a\");\n        for (i = 0; i &lt; sum; i++)\n            fprintf(output, \"%c %c\\n\", group[path[i]][0], group[path[i]][1]);\n    } else\n        printf(\"Input file was not found.\");\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "memory", "memory-leaks", "cuda"], "comments": [{"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1451466702, "post_id": 34525759, "comment_id": 56793949, "body": "Could you post a short repro case which illustrates the apparent memory leak? I am not sure your diagnosis of what is happening here is correct, and  it might be that you are misinterpreting what is occuring. Also, you are running a two year old CUDA toolkit and a year old driver. Have you considered upgrading to see whether the behaviour is the same?"}, {"owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "reply_to_user": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 0, "creation_date": 1451470644, "post_id": 34525759, "comment_id": 56796184, "body": "I added a sample code to repro case. I agree, the CUDA version should be up to date but I didn&#39;t had time to do this migration. I may/will try to do it to see if It happen again."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "edited": false, "score": 1, "creation_date": 1451478577, "post_id": 34525759, "comment_id": 56800215, "body": "I have run your code 1000 times in a shell loop on a 64bit system with 16Gb of ram with the 352.39 driver and CUDA 6 runtime and observed no memory leakage at all. I don&#39;t know what is going on with your code or your system, but CUDA doesn&#39;t leak host memory on exit in the way you are suggesting."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 2, "creation_date": 1451491580, "post_id": 34525759, "comment_id": 56807260, "body": "Definitely try latest CUDA and driver.  Also, if for some reason the host process associated with the program that segfaulted does not actually terminate, then you may not see the memory returned to the system pool, since the OS thinks the process is still running (it may be zombie or in some other wierd state).  Try the linux command <code>ps -ef |grep uname</code> (where <code>uname</code> is replaced by your actual linux username)  to see all processes associated with your username.  If you find any that look like they were associated with the segfaulted process, try killing them manually."}, {"owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451499091, "post_id": 34525759, "comment_id": 56811326, "body": "Thanks you robert for your suggestion. I already checked zombies process and there are none. Just in case, I run your suggested command line and nothing interesting appeared. I really have to check with newer version of cuda but clients have a wheezy distribution and cuda 7 is not packaged on debian. Migration would be tedious."}, {"owner": {"reputation": 119299, "user_id": 1695960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f557c03db19232aa410540af2f966?s=128&d=identicon&r=PG", "display_name": "Robert Crovella", "link": "https://stackoverflow.com/users/1695960/robert-crovella"}, "edited": false, "score": 1, "creation_date": 1451585252, "post_id": 34525759, "comment_id": 56842390, "body": "Does the GeForce 610M have an X server running on it?"}], "answers": [{"comments": [{"owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451498425, "post_id": 34529726, "comment_id": 56810994, "body": "I copy/paste your code to run exactly the same test. My results are : First free : used = 1205504 Second free : used = 1519068  I use same values than you. I agree it do not totally leak but it is 8 % which can&#39;t be ignored. I know the cuda runtime or driver or whatever should release resources but it is obviously not totally done in my case."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "reply_to_user": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451504355, "post_id": 34529726, "comment_id": 56813855, "body": "@P.Brunet: Can you post the complete output of free before and after somewhere? (perhaps in a edit in your question). This sounds like you are just misinterpreting what the output of free/top actually mean. An 8% change in total free memory when you are allocating half of your physical memory in a single contiguous buffer doesn&#39;t not imply you have a memory leak. The linux kernel dynamically reserves and frees file system cache and buffers that could easily explain a discrepancy of that size."}, {"owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451547889, "post_id": 34529726, "comment_id": 56827661, "body": "I understand you don&#39;t want to believe me so I put the full result but I think I can read it. If it was really the caching or buffering mechanism, it would not have swap later as the OS remove it when it is required. In this case (I rerun it right now), it is also 300 Mo of memory leak."}, {"owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "reply_to_user": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451562521, "post_id": 34529726, "comment_id": 56833592, "body": "@P.Brunet: It isn&#39;t that I don&#39;t want to believe you. It is that 99% of the time, questions like this are really misdiagnosis rather than a real problem - like <a href=\"http://stackoverflow.com/q/34371828/681865\">this recent one</a> for example. What I am trying to do is get you to refine the problem to a root cause. I (or anyone else) can&#39;t help you solve a problem which we can&#39;t reproduce without enough details to eliminate all the obvious stuff. You might well have uncovered a driver or toolkit bug, but you are using an old toolkit and driver and NVIDIA will just tell you to upgrade if you report it."}, {"owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "edited": false, "score": 0, "creation_date": 1451569881, "post_id": 34529726, "comment_id": 56836375, "body": "I totally understand this. I didn&#39;t believe it was the real cause at the beginning and it is normal to start for scratch with this kind of  investigation. Thanks for your support. I will look for an upgrade ASAP."}], "tags": [], "owner": {"reputation": 66945, "user_id": 681865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77320b8ddf13954ffb22aa22965d465e?s=128&d=identicon&r=PG&f=1", "display_name": "talonmies", "link": "https://stackoverflow.com/users/681865/talonmies"}, "is_accepted": false, "score": 2, "last_activity_date": 1451643433, "last_edit_date": 1451643433, "creation_date": 1451479072, "answer_id": 34529726, "question_id": 34525759, "link": "https://stackoverflow.com/questions/34525759/how-to-avoid-memory-leak-on-segfault-with-cuda/34529726#34529726", "title": "How to avoid memory leak on segfault with Cuda", "body": "<p>I have built a slightly modified version of your repro case:</p>\n\n<pre><code>#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime.h&gt;\n#include &lt;signal.h&gt;\n\nint main() {\n\n    int *ret;\n    const size_t sz = 1 &lt;&lt; 30;\n    cudaHostAlloc(&amp;ret, sz * sizeof(*ret), cudaHostAllocPortable);\n    raise(SIGSEGV);\n    return 0;\n}\n</code></pre>\n\n<p>which on my system should allocate 8Gb of pinned portable memory and raise a segfault, which produces abnormal exit and a core dump. I ran this on a 16Gb machine with the 352.39 driver and CUDA 6 runtime in a shell loop, which according to your analysis should cause leaking and cache thrashing within two or three runs:</p>\n\n<pre><code>$ free; for i in {1..20}; do echo -n $i; ./a.out; done; free\n             total       used       free     shared    buffers     cached\nMem:      16308996    3509924   12799072          0     303588    2313332\n-/+ buffers/cache:     893004   15415992\nSwap:      8257532          0    8257532\n1Segmentation fault (core dumped)\n2Segmentation fault (core dumped)\n3Segmentation fault (core dumped)\n4Segmentation fault (core dumped)\n5Segmentation fault (core dumped)\n6Segmentation fault (core dumped)\n7Segmentation fault (core dumped)\n8Segmentation fault (core dumped)\n9Segmentation fault (core dumped)\n10Segmentation fault (core dumped)\n11Segmentation fault (core dumped)\n12Segmentation fault (core dumped)\n13Segmentation fault (core dumped)\n14Segmentation fault (core dumped)\n15Segmentation fault (core dumped)\n16Segmentation fault (core dumped)\n17Segmentation fault (core dumped)\n18Segmentation fault (core dumped)\n19Segmentation fault (core dumped)\n20Segmentation fault (core dumped)\n             total       used       free     shared    buffers     cached\nMem:      16308996    3510740   12798256          0     303588    2313272\n-/+ buffers/cache:     893880   15415116\nSwap:      8257532          0    8257532\n</code></pre>\n\n<p>However, you can see that only yields a 0.006% decrease in free memory after allocating 160Gb of pinned memory and never calling a memory release API or allowing the code to follow the normal code path to exit. No memory leak or net change in free resources occurred.</p>\n\n<p>The CUDA driver and runtime will release both host and GPU resources at exit, be it normal or abnormal, with or without explicit calls to memory free APIs. I can't tell you what the problem is with your code or system, but a lack of host resource release on application exit by the CUDA runtime or driver is most likely not the root cause.</p>\n\n<p>I would encourage you to modify my code to fit the size of the physical memory on your machine (use half the physical memory) and run it as I have done in a loop with memory reporting directly before or after. I very much doubt you will see anything different from what I have posted in this answer. If you do, I would strongly recommend a driver update to the most recent release driver. </p>\n"}], "owner": {"reputation": 204, "user_id": 5729751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3440d4b3e9ee09804f544976e377f937?s=128&d=identicon&r=PG&f=1", "display_name": "P. Brunet", "link": "https://stackoverflow.com/users/5729751/p-brunet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1451643433, "creation_date": 1451464337, "last_edit_date": 1451547710, "question_id": 34525759, "link": "https://stackoverflow.com/questions/34525759/how-to-avoid-memory-leak-on-segfault-with-cuda", "title": "How to avoid memory leak on segfault with Cuda", "body": "<p>I work with a cuda device on an integration branch and I still have some segfault while I am finishing my work.</p>\n\n<p>After each crash, my memory consumption is increased by 500 Mo (seen using <code>free -m</code>, <code>htop</code> and one other but I don't remember the name). This memory is never released so on this computer with 4Go of RAM so I have to reboot after some crashes otherwise memory swap and it is really really slow (as usual when memory swap happen).</p>\n\n<p>I know the good answer is : \"Fix your segfault!!\" but I would like to understand why this behavior happen and how can I prevent it.</p>\n\n<p>I read that CUDA memory should be released by OS on segfault and it looks like it doesn't.</p>\n\n<p>While I tried to debug my program, I notice that if I fix the segfault, memory is free'd correctly but if I also comment the cuda release line : <code>cudaFreeHost(buf)</code> (with segfault fixed), I still have the memory leak.</p>\n\n<p>My memory is allocated as pinned pages : <code>cudaHostAlloc(&amp;ret, n*sizeof(my_struct), cudaHostAllocPortable)</code>.</p>\n\n<p>I wanted to make sure the \"free\" code is called using <code>unique_ptr</code> but it will not solve the problem with segfault.</p>\n\n<p>I looked at persistent mode for CUDA : <a href=\"http://docs.nvidia.com/deploy/driver-persistence/index.html\" rel=\"nofollow\">http://docs.nvidia.com/deploy/driver-persistence/index.html</a> but it is disable on my computer (I checked it with <code>nvidia-smi</code>).</p>\n\n<p>I tried to reset the cuda device : <code>nvidia-smi -r</code> but it say it is not supported on my computer.</p>\n\n<p><strong>Questions</strong> are:</p>\n\n<ul>\n<li>How can we ask program (or OS) to release these resources at the end of the program?</li>\n<li>If we can't, Does a command exists to recover these resources after the crash?</li>\n</ul>\n\n<p><em>Version</em>:</p>\n\n<ul>\n<li><p>CUDA 6.0.1</p></li>\n<li><p>gcc 4.9.2</p></li>\n<li><p>Driver Version: 340.65</p></li>\n<li><p>Card : GeForce 610M </p></li>\n</ul>\n\n<p><strong>Update</strong>:</p>\n\n<p>Here is a sample code to reproduce the problem. With commented line, I leak 10 Mo per run.</p>\n\n<pre><code>#include &lt;cuda.h&gt;\n#include &lt;cuda_runtime.h&gt;\n\nint main() {\n\n    int *ret;\n    cudaHostAlloc(&amp;ret, 10000000 * sizeof(*ret), cudaHostAllocPortable);\n    //cudaFreeHost(ret);\n    return 0;\n}\n</code></pre>\n\n<p><em>Update 2</em> :</p>\n\n<pre><code>             total       used       free     shared    buffers     cached\nMem:       3830056    1487156    2342900      66336     142840     527088\n-/+ buffers/cache:     817228    3012828\nSwap:      7811068          0    7811068\n1Erreur de segmentation\n2Erreur de segmentation\n3Erreur de segmentation\n4Erreur de segmentation\n5Erreur de segmentation\n6Erreur de segmentation\n7Erreur de segmentation\n8Erreur de segmentation\n9Erreur de segmentation\n10Erreur de segmentation\n11Erreur de segmentation\n12Erreur de segmentation\n13Erreur de segmentation\n14Erreur de segmentation\n15Erreur de segmentation\n16Erreur de segmentation\n17Erreur de segmentation\n18Erreur de segmentation\n19Erreur de segmentation\n20Erreur de segmentation\n             total       used       free     shared    buffers     cached\nMem:       3830056    1766580    2063476      64152     142860     531032\n-/+ buffers/cache:    1092688    2737368\nSwap:      7811068          0    7811068\n</code></pre>\n"}, {"tags": ["c", "string", "c-strings", "text-extraction"], "comments": [{"owner": {"reputation": 142, "user_id": 5138104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1hjNA_9m9ls/AAAAAAAAAAI/AAAAAAAAABQ/VsNojeZPeMg/photo.jpg?sz=128", "display_name": "Eugene Anisiutkin", "link": "https://stackoverflow.com/users/5138104/eugene-anisiutkin"}, "edited": false, "score": 1, "creation_date": 1451464000, "post_id": 34525630, "comment_id": 56792595, "body": "well you probably have to write your own text parser, but it really depends on tags. For example C has parser for html5, and i am sure xml parser can be found, but if your text is not a valid xml ot html, you&#39;ll have to write your own parser most likely/"}, {"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451464407, "post_id": 34525630, "comment_id": 56792795, "body": "sorry,let me say clearly"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1451464411, "post_id": 34525630, "comment_id": 56792798, "body": "<a href=\"http://stackoverflow.com/q/33538909/971127\">stackoverflow.com/q/33538909/971127</a>"}, {"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451465087, "post_id": 34525630, "comment_id": 56793094, "body": "There is a file that contains a series of text, some texts are between &lt;p&gt; and &lt;/p&gt; (like : &lt;p&gt;text&lt;/p&gt;) other texts are not. now i wan to extract those texts between &lt;p&gt;&amp;&lt;/p&gt; and save them into another file."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451466997, "post_id": 34525815, "comment_id": 56794093, "body": "thanks for your help. much appreciate:-)"}], "tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": true, "score": 0, "last_activity_date": 1451470888, "last_edit_date": 1451470888, "creation_date": 1451464584, "answer_id": 34525815, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c/34525815#34525815", "title": "How to find text between two specific strings in c", "body": "<p>If your parsing needs are big enough you may look for parsing library, like <a href=\"http://www.xmlsoft.org/\" rel=\"nofollow\">libxml</a>. Otherwise <a href=\"http://linux.die.net/man/3/strstr\" rel=\"nofollow\">strstr</a> is your friend:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char *res;\n    size_t len;\n    const char *p1, *p2;\n    char text[] = \"&lt;AAA&gt;hello world&lt;/AAA&gt;\";\n\n    p1 = strstr(text, \"&lt;AAA&gt;\");\n    if (p1 == NULL) return -1;\n    p1 += 5;\n    p2 = strstr(p1, \"&lt;/AAA&gt;\");\n    if (p2 == NULL) return -2;\n    len = p2 - p1;\n    res = malloc(len + 1);\n    if (res == NULL) return -3;\n    strncpy(res, p1, len);\n    res[len] = '\\0';\n    printf(\"'%s'\\n\", res);\n    return 0;\n}\n</code></pre>\n\n<p>stdout:\n'hello world'</p>\n\n<p>or even better (no need to malloc):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    const char *p1, *p2;\n    char text[] = \"&lt;AAA&gt;hello world&lt;/AAA&gt;\";\n\n    p1 = strstr(text, \"&lt;AAA&gt;\");\n    if (p1 == NULL) return -1;\n    p1 += 5;\n    p2 = strstr(p1, \"&lt;/AAA&gt;\");\n    if (p2 == NULL) return -2;\n    printf(\"'%.*s'\\n\", (int)(p2 - p1), p1);\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/cbuDgn\" rel=\"nofollow\">https://ideone.com/cbuDgn</a></p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1451465114, "last_edit_date": 1451465114, "creation_date": 1451464668, "answer_id": 34525834, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c/34525834#34525834", "title": "How to find text between two specific strings in c", "body": "<p>Follow these steps:</p>\n\n<ul>\n<li><p>Read the whole file into a <code>char</code> array, reallocating this array if needed, null terminate the array.</p></li>\n<li><p>Use <code>strstr()</code> to find an occurrence of <code>\"&lt;AAA&gt;\"</code>. save position if found, done if not.</p></li>\n<li><p>From that position, use <code>strstr</code> to find <code>\"&lt;/AAA&gt;\"</code>.</p></li>\n<li><p>output the text in between and restart.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451467133, "post_id": 34526002, "comment_id": 56794162, "body": "thanks for your answer and recommendation:-)"}], "tags": [], "owner": {"reputation": 4148, "user_id": 781252, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec72210a7b6a543152fa32b770d1eed0?s=128&d=identicon&r=PG&f=1", "display_name": "developer", "link": "https://stackoverflow.com/users/781252/developer"}, "is_accepted": false, "score": 0, "last_activity_date": 1451467706, "last_edit_date": 1451467706, "creation_date": 1451465350, "answer_id": 34526002, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c/34526002#34526002", "title": "How to find text between two specific strings in c", "body": "<p>You can use XML libraries to parse your text, I recommand using <a href=\"http://expat.sourceforge.net/\" rel=\"nofollow\">libexpat</a> or <a href=\"http://www.xmlsoft.org/\" rel=\"nofollow\">libxml2</a> or <a href=\"http://www.msweet.org/projects.php?Z3\" rel=\"nofollow\">minixml</a>, it is more easier to parse XML document with these libraries</p>\n\n<p>For example for minixml (from official documentation of minixml):</p>\n\n<p><strong>Loading XML</strong></p>\n\n<p>You load an XML file using the mxmlLoadFile function:</p>\n\n<pre><code>FILE *fp;\nmxml_node_t *tree;\n\nfp = fopen(\"filename.xml\", \"r\");\ntree = mxmlLoadFile(NULL, fp,\n                    MXML_TEXT_CALLBACK);\nfclose(fp);\n</code></pre>\n\n<p><strong>mxmlEntityGetValue</strong></p>\n\n<p>Get the character corresponding to a named entity.</p>\n\n<pre><code>int mxmlEntityGetValue ( \n    const char *name \n);\n</code></pre>\n\n<p><strong>Parameters</strong></p>\n\n<pre><code>name\n    Entity name\n</code></pre>\n\n<p><strong>Return Value</strong></p>\n\n<pre><code>    Character value or -1 on error\n</code></pre>\n\n<p>Discussion</p>\n\n<pre><code>The entity name can also be a numeric constant. -1 is returned if the name is not known.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451466698, "post_id": 34526071, "comment_id": 56793947, "body": "thanks for your help and support :-)!!"}], "tags": [], "owner": {"reputation": 1, "user_id": 5729589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fee53b7a9575945b49452bb0cec7a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gilyong Shin", "link": "https://stackoverflow.com/users/5729589/gilyong-shin"}, "is_accepted": false, "score": 0, "last_activity_date": 1451466154, "last_edit_date": 1451466154, "creation_date": 1451465639, "answer_id": 34526071, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c/34526071#34526071", "title": "How to find text between two specific strings in c", "body": "<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, const char *argv[]) {\n    const char *srcStr = \"&lt;AAA&gt;hello world&lt;/AAA&gt; this is a text &lt;AAA&gt;this is another text&lt;/AAA&gt;\";\n    const char *firstDelim = \"&lt;AAA&gt;\";\n    const char *lastDelim = \"&lt;/AAA&gt;\";\n    char extStr[128] = \"\";\n    int srcStrLen, firstDelimLen, lastDelimLen;\n    int i, catIdx = 0;\n\n    srcStrLen = strlen(srcStr);\n    firstDelimLen = strlen(firstDelim);\n    lastDelimLen = strlen(lastDelim);\n\n    for (i=0; i&lt;srcStrLen; i++){\n        if (strncmp(&amp;srcStr[i], firstDelim, firstDelimLen) == 0) {\n            i += firstDelimLen;\n            catIdx = i;\n        }\n        else if (strncmp(&amp;srcStr[i], lastDelim, lastDelimLen) == 0) {\n            strncat(extStr, &amp;srcStr[catIdx], i - catIdx);\n            i += lastDelimLen;\n            if (i != srcStrLen){\n                strcat(extStr, \" \");\n            }\n        }\n    }\n    printf(\"%s\\n\", extStr);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "edited": false, "score": 0, "creation_date": 1451467858, "post_id": 34526274, "comment_id": 56794593, "body": "wow! thank you very much. yes that&#39;s what i want,  much appreciated It seemed more logical way"}], "tags": [], "owner": {"reputation": 142, "user_id": 5138104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1hjNA_9m9ls/AAAAAAAAAAI/AAAAAAAAABQ/VsNojeZPeMg/photo.jpg?sz=128", "display_name": "Eugene Anisiutkin", "link": "https://stackoverflow.com/users/5138104/eugene-anisiutkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1451466819, "last_edit_date": 1451466819, "creation_date": 1451466447, "answer_id": 34526274, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c/34526274#34526274", "title": "How to find text between two specific strings in c", "body": "<p>As it was said above it looks like XML-parser is you friend, see suggested libraries for XML-parsing. If by some miracle XML-parser can't parse your text, because it is not a valid XML, you can try and use HTML-parser(for example <a href=\"https://github.com/lazytiger/gumbo-query\" rel=\"nofollow\">gumbo-query</a>, or any other you can find). If HTML-parser does not work, well you will most likely have to write your own text-parser. This may be downwoted, because it does not really answer the question, but i think all other answers lack at least a suggestion of what to try if XML-parsers and XML-like parsers do not work.</p>\n"}], "owner": {"reputation": 35, "user_id": 5729705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/psk55.jpg?s=128&g=1", "display_name": "Erfan", "link": "https://stackoverflow.com/users/5729705/erfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1451949352, "accepted_answer_id": 34525815, "answer_count": 5, "score": -2, "last_activity_date": 1451470888, "creation_date": 1451463842, "question_id": 34525630, "link": "https://stackoverflow.com/questions/34525630/how-to-find-text-between-two-specific-strings-in-c", "closed_reason": "Needs more focus", "title": "How to find text between two specific strings in c", "body": "<p>I want to extract only strings between <code>&lt;AAA&gt; and &lt;/AAA&gt;</code><br>\nhow can i extract those?\nplease help\n<strong>Example :</strong>\n<code>&lt;AAA&gt;hello world&lt;/AAA&gt;</code>\n<code>this is a text</code>\n<code>&lt;AAA&gt;this is another text&lt;/AAA&gt;</code>\n<strong>Result :</strong>\nhello world \nthis is another text</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1451461616, "post_id": 34524804, "comment_id": 56791625, "body": "You can verify this by inspecting the <code>&#47;proc</code> filesystem, some info in an Q&amp;A I answered here: <a href=\"http://unix.stackexchange.com/questions/33381/getting-information-about-a-process-memory-usage-from-proc-pid-smaps\" title=\"getting information about a process memory usage from proc pid smaps\">unix.stackexchange.com/questions/33381/&hellip;</a>"}, {"owner": {"reputation": 1326, "user_id": 3840196, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ft1IE.jpg?s=128&g=1", "display_name": "Pradeep Goswami", "link": "https://stackoverflow.com/users/3840196/pradeep-goswami"}, "edited": false, "score": 0, "creation_date": 1451480131, "post_id": 34524804, "comment_id": 56801109, "body": "proc/pid/maps possibly"}], "answers": [{"tags": [], "owner": {"reputation": 877, "user_id": 2548319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Thw8X.jpg?s=128&g=1", "display_name": "Paulo1205", "link": "https://stackoverflow.com/users/2548319/paulo1205"}, "is_accepted": false, "score": 0, "last_activity_date": 1451462759, "creation_date": 1451462759, "answer_id": 34525419, "question_id": 34524804, "link": "https://stackoverflow.com/questions/34524804/how-to-get-address-information-from-library-to-be-shared-among-all-processes/34525419#34525419", "title": "How to get address information from library to be shared among all processes?", "body": "<p>Look at the contents of <code>/proc/*/maps</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "is_accepted": false, "score": 2, "last_activity_date": 1451469095, "creation_date": 1451469095, "answer_id": 34527019, "question_id": 34524804, "link": "https://stackoverflow.com/questions/34524804/how-to-get-address-information-from-library-to-be-shared-among-all-processes/34527019#34527019", "title": "How to get address information from library to be shared among all processes?", "body": "<p>It is not the <code>text</code> and <code>bss</code> sections of your gedit (or whatever) that have the same address, but the content of the <code>libc.so</code> shared library - and all other shared libraries used by the two gedit processes.</p>\n\n<p>This, as the quoted text says, allows the shared library to be ONE copy, and this is the main benefit of the shared library in general.</p>\n\n<p><code>bss</code> is generally not shared - since that is per process data. <code>text</code> sections of two processes running the same executable, in Linux, will share the same code. </p>\n\n<p>Unfortunately, the proof of this would be to look at the physical mapping of pages (page at address X in process A is at physical address Y, and page for address X in process B is also at physical address Y) within the processes, and that's, as far as I know, not easily available without groking about inside the OS kernel.</p>\n"}], "owner": {"reputation": 81, "user_id": 5723932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e61a9b451b575343df270169b02efe?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/5723932/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1451470851, "creation_date": 1451459997, "last_edit_date": 1451470851, "question_id": 34524804, "link": "https://stackoverflow.com/questions/34524804/how-to-get-address-information-from-library-to-be-shared-among-all-processes", "title": "How to get address information from library to be shared among all processes?", "body": "<p>In <em>Understanding the Linux Kernel, 3rd edition</em>, it says:</p>\n\n<blockquote>\n  <p>Shared libraries are especially convenient on systems that provide file memory mapping, because they reduce the amount of main memory requested for executing a\n  program. When the dynamic linker must link a shared library to a process, it does not copy the object code, but performs only a memory mapping of the relevant portion of the library file into the process\u2019s address space. <strong>This allows the page frames containing the machine code of the library to be shared among all processes that are using the same code.</strong> Clearly, sharing is not possible if the program has been linked statically. (page 817)</p>\n</blockquote>\n\n<p>I am interested in this, want to write a small program in C to verify, given two pids as input such as two gedit processes, and then get the address information from page frames to be shared. Does anyone know how to do it? From that book, I think the bss segment and text segment address from two or more gedit processes are same, is that correct? </p>\n"}, {"tags": ["c", "scanf", "chars"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451459630, "post_id": 34524707, "comment_id": 56790822, "body": "I&#39;d ask <code>how</code> rather than <code>why</code>, <i>does it (even) work</i>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451459660, "post_id": 34524707, "comment_id": 56790830, "body": "Please see <a href=\"http://stackoverflow.com/q/5431941/2173917\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451459817, "post_id": 34524707, "comment_id": 56790888, "body": "To add another angle, read lines using <code>fgets()</code>, strip newline, and use <code>strcmp()</code>, easier, cleaner."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1451460545, "post_id": 34524707, "comment_id": 56791185, "body": "@SouravGhosh: using <code>fgets</code>, it is not necessary to strip the newline before calling <code>strcmp</code> and stripping the newline would actually prevent detection of a file difference where one file ends with a <code>&#39;\\n&#39;</code> and not the other."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451460653, "post_id": 34524707, "comment_id": 56791243, "body": "@chqrlie I was taking the perspective of the visible content, anyway. :)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1451460739, "post_id": 34524707, "comment_id": 56791278, "body": "@SouravGhosh: <i>read two files and check wether they are exactly the same</i> probably refers to <i>actual</i> rather than <i>visible</i> content <code>:)</code>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451460809, "post_id": 34524707, "comment_id": 56791310, "body": "@chqrlie Yes, maybe. In that case, you&#39;re very right. :)"}, {"owner": {"reputation": 1247, "user_id": 4349429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747aac0b54af7691075ba3758a66ca4a?s=128&d=identicon&r=PG&f=1", "display_name": "Pawan", "link": "https://stackoverflow.com/users/4349429/pawan"}, "edited": false, "score": 0, "creation_date": 1451463561, "post_id": 34524707, "comment_id": 56792397, "body": "@Giladmitrani I am wondering, why it didn&#39;t work for you. I checked the code execution (with gdb) and it seems working for me just fine. <code>fscanf()</code> is reading values from both the files correctly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451490256, "post_id": 34524707, "comment_id": 56806482, "body": "Candidate reasons 1) Files not opened properly, 2)  <code>c1,c2</code> are not the correct type. 3) Code does not check the result of <code>fscanf()</code> so why trust if <code>c1,c2</code> were written? 4) <code>c1, c2, ans</code> not initialized and whatever magic code/process used to determine  &quot;the code entered &#39;H&#39; into c1 and &#39;e&#39; into c2&quot; is faulty. 5) Files not written correctly (Like one is using UTF-16). The list can go on.   Posting a complete compilable code would help."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451493513, "post_id": 34524707, "comment_id": 56808327, "body": "@Giladmitrani: How do know the values of <code>c1</code> and <code>c2</code>?"}, {"owner": {"reputation": 303, "user_id": 5646563, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42864ff13f865209cec35230eb33cc49?s=128&d=identicon&r=PG&f=1", "display_name": "HazirBot", "link": "https://stackoverflow.com/users/5646563/hazirbot"}, "edited": false, "score": 0, "creation_date": 1451494942, "post_id": 34524707, "comment_id": 56809111, "body": "I&#39;ve edited for a full compile-able working code with implemented visual tests. Thank you guys for taking a look at this, though i am unable to replicate the error"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451509056, "post_id": 34524707, "comment_id": 56816190, "body": "<i>i cannot seem to replicate the problem (this happened to me during a test i took in the university, thus i cannot access the original code anymore.</i>  My guess is you were scanning both <code>c1</code> and <code>c2</code> from <code>f1</code> in the initial part of the <code>for</code> loop, a classic cut and paste bug."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451468412, "post_id": 34524884, "comment_id": 56794892, "body": "Please do not change this loop to a <code>do {} while</code> loop.  Although it would be semantically equivalent, <code>do {} while</code> loops tend to be error prone."}, {"owner": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 1, "creation_date": 1451470657, "post_id": 34524884, "comment_id": 56796194, "body": "I&#39;ve checked other posts about <code>do {} while</code> loop but no one mentioned it&#39;s error prone. It just seemed the best suitable for this example."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 0, "creation_date": 1451470937, "post_id": 34524884, "comment_id": 56796330, "body": "@seleciii44: I understand your surprise, maybe I should ask the question on SO, I have seen so many erroneous <code>do {} while</code> loops, especially for parsing files.  It would be appropriate here, but I&#39;d rather not condone it&#39;s use."}, {"owner": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 0, "creation_date": 1451472113, "post_id": 34524884, "comment_id": 56796897, "body": "I understand your concern. Yet, it&#39;s like telling not to use <code>switch</code> or pointers. Because almost everyone does fail once when using these. I believe the best way to learn is by mistakes."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 0, "creation_date": 1451509330, "post_id": 34524884, "comment_id": 56816318, "body": "@seleciii44  <code>switch</code> has its quirks, but nowhere as many bugs as <code>do {} while</code> loops tend to induce.  Lets play a little game of <i>show me a do/while loop, I&#39;ll show you a bug</i>. Give me 2 random letters."}, {"owner": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 0, "creation_date": 1451509807, "post_id": 34524884, "comment_id": 56816594, "body": "you really are serious :) ok. tell me what was wrong with my edit in your answer (by the way i really wanna learn/see if i&#39;m missing something.)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1356, "user_id": 1632887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MU4Pe.jpg?s=128&g=1", "display_name": "seleciii44", "link": "https://stackoverflow.com/users/1632887/seleciii44"}, "edited": false, "score": 0, "creation_date": 1451509835, "post_id": 34524884, "comment_id": 56816603, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/99343/discussion-between-chqrlie-and-seleciii44\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 2, "last_activity_date": 1451509028, "last_edit_date": 1451509028, "creation_date": 1451460336, "answer_id": 34524884, "question_id": 34524707, "link": "https://stackoverflow.com/questions/34524707/fscanf-from-two-different-files/34524884#34524884", "title": "fscanf from two different files", "body": "<p>Looking at your code, I cannot see an explanation for the behavior you document.  You should post a minimal complete verifiable example for use to see the rest of the function.</p>\n\n<p>Your approach is not very effective and will fail to detect some cases where files differ: the way you test for end of file is approximative.</p>\n\n<p>Here is an alternative using <code>getc</code>:</p>\n\n<pre><code>int c1, c2;\nint identical = 1;\n\nfor (;;) {\n    c1 = getc(f1);\n    c2 = getc(f2);\n\n    if (c1 != c2) {\n        identical = 0;\n        break;\n    }\n    if (c1 == EOF)\n        break;\n}\n</code></pre>\n\n<p>EDIT: after you posted more code, you concluded: <em>i cannot seem to replicate the problem (this happened to me during a test i took in the university, thus i cannot access the original code anymore.</em></p>\n\n<p>My guess is you were scanning both <code>c1</code> and <code>c2</code> from <code>f1</code> in the initial part of the <code>for</code> loop, a classic cut and paste bug.</p>\n"}], "owner": {"reputation": 303, "user_id": 5646563, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42864ff13f865209cec35230eb33cc49?s=128&d=identicon&r=PG&f=1", "display_name": "HazirBot", "link": "https://stackoverflow.com/users/5646563/hazirbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 34524884, "answer_count": 1, "score": 0, "last_activity_date": 1451509028, "creation_date": 1451459571, "last_edit_date": 1451494650, "question_id": 34524707, "link": "https://stackoverflow.com/questions/34524707/fscanf-from-two-different-files", "title": "fscanf from two different files", "body": "<p>During an assignment in school I came across this phenomenon which I cannot understand.</p>\n\n<p>My task was to read two files and check wether they are exactly the same.\nI made two text files which contained the exact same line:</p>\n\n<p>\"Hello world\"</p>\n\n<p>I decided to check the text char by char.\nat first I wrote the following code:</p>\n\n<p>EDIT: Due to many requests i've re-written the entire code to be displayed here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    char c1, c2;\n    int ans = 1;\n    FILE *f1 = fopen(\"text1.txt\",\"rt\");\n    FILE *f2 = fopen(\"text2.txt\",\"rt\");\n    for (fscanf(f1, \"%c\", &amp;c1), fscanf(f2, \"%c\", &amp;c2); \n        !feof(f1) &amp;&amp; !feof(f2) &amp;&amp; ans; \n        fscanf(f1, \"%c\", &amp;c1), fscanf(f2, \"%c\", &amp;c2))\n    { // Check Data:\n    if (c1 != c2) ans = 0; \n    printf(\"%c %c\\n\",c1,c2); // Print side by side check\n    } // Check Tail:\n    if (!feof(f1)) ans=0;\n    if (!feof(f2)) ans=0;\n\n    if (ans) printf(\"File 1 == File 2\");\n    else printf(\"File 1 != File 2\");\n\n    return 0;\n}\n</code></pre>\n\n<p>but for some reason the code entered 'H' into c1 and 'e' into c2.\nWhy does it work like that?</p>\n\n<p>EDIT: i cannot seem to replicate the problem (this happened to me during a test i took in the university, thus i cannot access the original code anymore. the university is using an outdated Microsoft Visual Studio 2012 while i code using the 2015express version/netbeans)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451459367, "post_id": 34524635, "comment_id": 56790723, "body": "See <a href=\"http://stackoverflow.com/questions/4384359/quick-way-to-implement-dictionary-in-c\">this SO post</a> for some answers on how to implement a dictionary in C. In case you don&#39;t know, dictionaries generally have a list of keys with associated values. I find it quite ideal for modifying variables using a string identifier during runtime."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 7, "creation_date": 1451459368, "post_id": 34524635, "comment_id": 56790725, "body": "C doesn&#39;t have any built-in introspection functions like this. There&#39;s no way to find a variable from its name."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1451459378, "post_id": 34524635, "comment_id": 56790732, "body": "Do you know an <code>int</code> is not guranteed to be able to hold an <i>address</i>?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451459509, "post_id": 34524635, "comment_id": 56790780, "body": "@Barmar: Well, one certainly could write code which parses the symbol table (presuming it has not been stripped) and find the variable somehow. But you can also shoot your foot right before a marathon."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1451459669, "post_id": 34524635, "comment_id": 56790835, "body": "Nothing in the C language allows that. You will have to resort to platform-specific code."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1451464714, "post_id": 34524635, "comment_id": 56792929, "body": "If you want a standard way, you need to bite the bullet, and accept the need to &quot;increase the job&quot; and then maintain the table.  The only solution is to implement a lookup table.     Even if you are willing to accept a non-standard way, accessing debugging information in executables (apart from being system specific) is not for the faint hearted or lazy."}], "answers": [{"tags": [], "owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "is_accepted": false, "score": 0, "last_activity_date": 1451460296, "creation_date": 1451460296, "answer_id": 34524878, "question_id": 34524635, "link": "https://stackoverflow.com/questions/34524635/how-to-get-the-address-of-a-variable-if-i-have-the-name-of-the-variable-in-stri/34524878#34524878", "title": "How to get the address of a variable, if I have the name of the variable in string during runtime?", "body": "<p>C doesn't have any sort of introspection capabilities in the standard, there's no way to do what you're aiming for in a portable manner. And the non-portable manners (like using the executable's debug info or symbol table) would be a terrible idea.</p>\n\n<p>But that doesn't mean there's no solution. Judging by your variable names, what you should be doing is:</p>\n\n<pre><code>int genVar[3];\n</code></pre>\n\n<p>Then you can dynamically index into that array at runtime. If that's not flexible enough, use a linked list or a hash map - there are quite a few implementations of those for C available (none in the standard though).</p>\n"}], "owner": {"reputation": 3, "user_id": 4862012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4cAFvxUscdk/AAAAAAAAAAI/AAAAAAAAAAA/CJiYiEqtcBA/photo.jpg?sz=128", "display_name": "ranjith rajachandran", "link": "https://stackoverflow.com/users/4862012/ranjith-rajachandran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1451465087, "creation_date": 1451459195, "last_edit_date": 1451465087, "question_id": 34524635, "link": "https://stackoverflow.com/questions/34524635/how-to-get-the-address-of-a-variable-if-i-have-the-name-of-the-variable-in-stri", "title": "How to get the address of a variable, if I have the name of the variable in string during runtime?", "body": "<p>I'm expecting something like below.  </p>\n\n<pre><code>int genVar001, genVar002, genVar003;\nint adrgenVar, status;\nchar strvariable[] =  \"genVar001\";\n\nstatus = somefunction(&amp;strvariable, adrgenVar);\n</code></pre>\n\n<p>Where '<em>adrgenVar</em>' will have the address of genVar001.! If the variable is not available the status should return error.</p>\n\n<p>Why it is required: for manipulation of the values in the runtime (via keyboard or files).</p>\n\n<p>Lookup table will not help me because it would increase the job; maintain the table if anything new is added.</p>\n\n<p><strong>Edit:</strong>\nI'm working with PLCs, <a href=\"https://code.google.com/p/br-standard/source/browse/trunk/NumAffaire/Logical/Libraries/sys_lib/sys_lib.fun\" rel=\"nofollow\">Here</a> is the library which will allow me to do so. \nFunction: PV_xgetadr.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1451456793, "post_id": 34524093, "comment_id": 56789740, "body": "<code>ptr</code> is a pointer to the last (<code>MAX-1</code>th) element of <code>var</code>. It doesn\u2019t have an order. If you move backwards from it to the beginning of the array, you\u2019ll be moving through the array in reverse order."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451458741, "post_id": 34524093, "comment_id": 56790459, "body": "This tutorial is very clumsy, but you seem to have grasped a good understanding of pointers. The syntax <code>ptr = &amp;var[MAX-1];</code> initializes <code>ptr</code> to point to the last element in the array.  decrementing <code>ptr</code> in a loop allows you to enumerate the array elements in <i>reverse</i> order,  but the array itself does not change."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451460047, "post_id": 34524093, "comment_id": 56790981, "body": "Just to make very clear: for <code>ptr = var</code>, you do <b>not</b> set <code>ptr</code> to the address of the array, but to the address of the first element because for most useages an array name is implicitly converted (decays) to a pointer to its first element. This might sound a bit nit-picky, as both have the same <b>value</b> for most implementations. But they have different types. The address of the array is <code>&amp;var</code> as always. Try <code>ptr = &amp;var</code> and you will get a type-missmatch error, unless you define <code>int (*ptr)[];</code>."}, {"owner": {"reputation": 53, "user_id": 1331743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e5b95fe4b7b67f9cf7f5c4756cdd29c?s=128&d=identicon&r=PG", "display_name": "Hendrik", "link": "https://stackoverflow.com/users/1331743/hendrik"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451465952, "post_id": 34524093, "comment_id": 56793584, "body": "Thanks @Olaf, it appear i&#39;ve misunderstood the concept of what <code>ptr = var</code> do at first."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451493177, "post_id": 34524093, "comment_id": 56808124, "body": "@Hendrik: See many other questions here. Simply put: an array is not a pointer is not an array. It is just that the indexing (<code>[]</code>) operator has been overloaded for pointers. That - along with the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">implicit conversion</a> I mentioned before - causes a lot of confusion. Please keep that in mind!"}], "answers": [{"tags": [], "owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "is_accepted": false, "score": 0, "last_activity_date": 1451457102, "creation_date": 1451457102, "answer_id": 34524175, "question_id": 34524093, "link": "https://stackoverflow.com/questions/34524093/how-the-logic-work-assigning-reverse-array-to-a-pointer/34524175#34524175", "title": "How the logic work, Assigning reverse array to a pointer", "body": "<p>No. Arrays in C are just contiguous areas of memory. They don't have strides or any other sort of metadata associated with them (though they may have a size if they are given one on declaration). You can't create an array that increments \"backwards\" through memory.</p>\n"}, {"tags": [], "owner": {"reputation": 23808, "user_id": 2382734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d80069e46785505b443aa9d1dd9eb3a3?s=128&d=identicon&r=PG", "display_name": "Renzo", "link": "https://stackoverflow.com/users/2382734/renzo"}, "is_accepted": true, "score": 2, "last_activity_date": 1451459576, "last_edit_date": 1451459576, "creation_date": 1451457161, "answer_id": 34524190, "question_id": 34524093, "link": "https://stackoverflow.com/questions/34524093/how-the-logic-work-assigning-reverse-array-to-a-pointer/34524190#34524190", "title": "How the logic work, Assigning reverse array to a pointer", "body": "<p>The assignment:</p>\n\n<pre><code>ptr = var\n</code></pre>\n\n<p>store in the pointer <code>ptr</code> the address of <code>var,</code> that is the address of the array, which is the same thing as the address of the first element of the array. The reason is because the memory is organized in the following way:</p>\n\n<pre><code>+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+ ...\n|  10 | 100 | 200 |  values of other variables, including i, ptr, etc.    \n+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+ ...\n  ^      ^     ^\n  |      |     |\n var[0] var[1] var[2]\n  ^\n  |\n var\n</code></pre>\n\n<p>The opertor <code>&amp;variable</code> in C get the address of <code>variable</code>. In other word, the assignment </p>\n\n<pre><code>ptr = var\n</code></pre>\n\n<p>is identical to: </p>\n\n<pre><code>ptr = &amp;var[0]\n</code></pre>\n\n<p>In the same way, the assignment:</p>\n\n<pre><code>ptr = &amp;var[MAX-1]\n</code></pre>\n\n<p>assigns to pointer the address of the <em>last</em> element of the array (which has index <code>MAX-1</code>, that is 2).</p>\n\n<p>At each iteration of the loop, the value of the variable pointed by pointer is printed, and the value of <code>ptr</code> is decremented in the second loop (note the use of <code>ptr--</code> instead of <code>ptr++</code> in the first example), so that the values of the array are printed from the last to the first.</p>\n"}, {"tags": [], "owner": {"reputation": 3923, "user_id": 3640699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NxDM0.jpg?s=128&g=1", "display_name": "Karthikeyan.R.S", "link": "https://stackoverflow.com/users/3640699/karthikeyan-r-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1451457208, "creation_date": 1451457208, "answer_id": 34524199, "question_id": 34524093, "link": "https://stackoverflow.com/questions/34524093/how-the-logic-work-assigning-reverse-array-to-a-pointer/34524199#34524199", "title": "How the logic work, Assigning reverse array to a pointer", "body": "<p>It doesn't contain the reverse order of an array. Simply it will point out\nto the last position address of that array.</p>\n\n<pre><code> 10    20    30    //&lt;-- values\n 1100  1104  1108  //&lt;-- let's take pointer address.\n</code></pre>\n\n<p>After this line, </p>\n\n<pre><code>ptr = &amp;var[MAX-1];\n\nptr will points to 1108. //memory address\n</code></pre>\n\n<p>So if you decrement the pointer value then it will decrement the address position and get the value in reverse order. So it will print the output as</p>\n\n<pre><code>30 20 10 \n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 1331743, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4e5b95fe4b7b67f9cf7f5c4756cdd29c?s=128&d=identicon&r=PG", "display_name": "Hendrik", "link": "https://stackoverflow.com/users/1331743/hendrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 34524190, "answer_count": 3, "score": 0, "last_activity_date": 1451459576, "creation_date": 1451456672, "last_edit_date": 1451456951, "question_id": 34524093, "link": "https://stackoverflow.com/questions/34524093/how-the-logic-work-assigning-reverse-array-to-a-pointer", "title": "How the logic work, Assigning reverse array to a pointer", "body": "<p>I'm currently learning about pointer in C Programming in this <a href=\"http://www.tutorialspoint.com/cprogramming/c_pointer_arithmetic.htm\" rel=\"nofollow\">link</a>.</p>\n\n<p>My understanding about pointer is, the pointer store value of the actual address in memory of a variable.</p>\n\n<p>Let's say I have </p>\n\n<pre><code>int  var[] = {10, 100, 200};\nint *ptr;\n</code></pre>\n\n<p>By assigning <code>var</code> to <code>ptr</code></p>\n\n<pre><code>ptr = var;\n</code></pre>\n\n<p><code>ptr</code> will be contained with address of the array in same sequence.</p>\n\n<p>My Question,</p>\n\n<p>There is an example for Decrementing a Pointer. Using Array and Pointer.\nThe example use </p>\n\n<pre><code>  ptr = &amp;var[MAX-1];\n</code></pre>\n\n<p>Why by using above code, the pointer <code>ptr</code> could contain the reverse order of the array.</p>\n"}, {"tags": ["c", "mongodb", "mongo-c-driver"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1451457303, "post_id": 34523969, "comment_id": 56789929, "body": "Is the link to 1.2.0 the old or the new version?  What was the old version you were using? What is the new version you are trying to use?"}, {"owner": {"reputation": 288, "user_id": 4030580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9180b9eb22269ef014d6563e68035344?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Shahid", "link": "https://stackoverflow.com/users/4030580/ahmed-shahid"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1451458929, "post_id": 34523969, "comment_id": 56790546, "body": "The link is for the new Driver. Which is C 1.2. The older version was 0.8. Here is the link to the repo for the old driver, <a href=\"https://github.com/mongodb/mongo-c-driver-legacy/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/mongodb/mongo-c-driver-legacy/blob/master/README.&zwnj;&#8203;md</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6316, "user_id": 3323096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1227f90127f0f7b8678a8c13261f48b4?s=128&d=identicon&r=PG", "display_name": "Vality", "link": "https://stackoverflow.com/users/3323096/vality"}, "is_accepted": true, "score": 2, "last_activity_date": 1451485744, "creation_date": 1451485744, "answer_id": 34531429, "question_id": 34523969, "link": "https://stackoverflow.com/questions/34523969/is-there-an-equivalent-of-mongo-find-one-in-the-new-mongo-c-driver/34531429#34531429", "title": "Is there an equivalent of mongo_find_one() in the new Mongo C driver", "body": "<p>This is likely an unsatisfying answer, but it does not appear there is a direct equivalent of the <code>mongo_find_one</code> function in version 1.2.0.</p>\n\n<p>It should not however be particularly difficult to build a function with similar semantics using a cursor and taking only a single element from it and discarding the rest.</p>\n"}], "owner": {"reputation": 288, "user_id": 4030580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9180b9eb22269ef014d6563e68035344?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Shahid", "link": "https://stackoverflow.com/users/4030580/ahmed-shahid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 34531429, "answer_count": 1, "score": 2, "last_activity_date": 1451485744, "creation_date": 1451456103, "last_edit_date": 1451457255, "question_id": 34523969, "link": "https://stackoverflow.com/questions/34523969/is-there-an-equivalent-of-mongo-find-one-in-the-new-mongo-c-driver", "title": "Is there an equivalent of mongo_find_one() in the new Mongo C driver", "body": "<p>In the legacy Mongo C driver there was a a function <code>mongo_find_one</code>, which was used to find a single document in a MongoDB server.</p>\n\n<pre><code>MONGO_EXPORT int mongo_find_one( mongo *conn, const char *ns, const bson *query,const bson *fields, bson *out );\n</code></pre>\n\n<p>Is there a similar function in the new Mongo driver. I have been using the following documentation but was not able to find anything that is equivalent.</p>\n\n<p><a href=\"http://api.mongodb.org/c/1.2.0/\" rel=\"nofollow\">http://api.mongodb.org/c/1.2.0/</a></p>\n"}, {"tags": ["php", "c", "char", "unsigned"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451457304, "post_id": 34523943, "comment_id": 56789930, "body": "What language is that supposed to be? Parts of it look like C, parts look like PHP. What is <code>ror8</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451457337, "post_id": 34523943, "comment_id": 56789941, "body": "What is that line of code trying to do?"}, {"owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451459534, "post_id": 34523943, "comment_id": 56790787, "body": "It was C code converted to PHP, but I&#39;m not sure what to do with unsigned char.  I know I should use the pack function, but I&#39;m not sure what the best route would be in this particular example as far as implementation goes."}, {"owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451459862, "post_id": 34523943, "comment_id": 56790903, "body": "It&#39;s part of an encryption function for RSA securid."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1451459865, "post_id": 34523943, "comment_id": 56790905, "body": "Explain what you&#39;re trying to accomplish. Show the input data and the desired output data. Also, show the original C code so we can understand what it&#39;s trying to do."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451459903, "post_id": 34523943, "comment_id": 56790924, "body": "Are you sure RSA doesn&#39;t provide a PHP library already?"}, {"owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1451460008, "post_id": 34523943, "comment_id": 56790964, "body": "There is an RSA authenticator that I believe is commercial as well as a PAM module, but this is part of a research project not to mention I believe the code could be implemented with either solution anyway.  Here is a pastebin link to the C code: <a href=\"http://pastebin.com/5gm5CQ1L\" rel=\"nofollow noreferrer\">pastebin.com/5gm5CQ1L</a>"}, {"owner": {"reputation": 4270, "user_id": 2707359, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8754698c78ca3a082e1593688a9df99c?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya", "link": "https://stackoverflow.com/users/2707359/ilya"}, "edited": false, "score": 0, "creation_date": 1451464385, "post_id": 34523943, "comment_id": 56792782, "body": "As far as I understand, the function <code>ror8(word, shift)</code> returns <code>(word &gt;&gt; shift) | (word &lt;&lt; (8 - shift))</code>. Kevin, it is better to add this kind of information in the question."}, {"owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "edited": false, "score": 0, "creation_date": 1451492451, "post_id": 34523943, "comment_id": 56807720, "body": "I&#39;m not really sure why my ror8 function call is relevant to the question of how to implement the pack function to replace the unsigned char tag, but here is a pastebin to my ror8 function.  <a href=\"http://pastebin.com/hAh2KipE\" rel=\"nofollow noreferrer\">pastebin.com/hAh2KipE</a>"}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "edited": false, "score": 1, "creation_date": 1451459565, "post_id": 34524266, "comment_id": 56790800, "body": "I&#39;d found that, but wasn&#39;t sure how to implement in this particular example.  For example what should I set $char to and should I simply replace (unsigned char) with ($unsignedchar)?"}], "tags": [], "owner": {"reputation": 6946, "user_id": 445492, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/67a133476d2c0d553cac18fd56f4dcd5?s=128&d=identicon&r=PG", "display_name": "John Ballinger", "link": "https://stackoverflow.com/users/445492/john-ballinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1451457514, "creation_date": 1451457514, "answer_id": 34524266, "question_id": 34523943, "link": "https://stackoverflow.com/questions/34523943/c-to-php-unsigned-char-issue/34524266#34524266", "title": "C to PHP unsigned char issue", "body": "<p>I can't for the life of me figure out what you are trying to do.</p>\n\n<p>But I think you are looking for the 'pack' function.<br>\n<a href=\"http://php.net/manual/en/function.pack.php\" rel=\"nofollow\">http://php.net/manual/en/function.pack.php</a></p>\n\n<pre><code>   $unsignedchar =  pack(\"C\",$char);  // convert a char character to an unsigned char byte\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1518171103, "creation_date": 1518171103, "answer_id": 48703445, "question_id": 34523943, "link": "https://stackoverflow.com/questions/34523943/c-to-php-unsigned-char-issue/48703445#48703445", "title": "C to PHP unsigned char issue", "body": "<p>The <code>(unsigned char)</code> cast in the original C code discards all bits not fitting in an <code>unsigned char</code> from the operand. The code obviously presumes that an <code>unsigned char</code> has 8 bits, thus the cast is equivalent to a bitwise AND with 2<sup>8</sup>\u22121, and you can write</p>\n\n<pre><code>$OCTET_data-&gt;B[0] = (ror8((ror8($OCTET_data-&gt;B[0], 1)-1)&amp;255, 1)-1)&amp;255^$OCTET_data-&gt;B[4];\n</code></pre>\n\n<p>or, perhaps a little more clearly</p>\n\n<pre><code>$OCTET_data-&gt;B[0] = ror8(ror8($OCTET_data-&gt;B[0], 1\n                             )-1 &amp; 255, 1\n                        )-1 &amp; 255 ^ $OCTET_data-&gt;B[4];\n</code></pre>\n"}], "owner": {"reputation": 459, "user_id": 353741, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03b2b5d8545c2ee6e74e9421e92fee40?s=128&d=identicon&r=PG", "display_name": "Kevin Remisoski", "link": "https://stackoverflow.com/users/353741/kevin-remisoski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1518171103, "creation_date": 1451456006, "last_edit_date": 1451461044, "question_id": 34523943, "link": "https://stackoverflow.com/questions/34523943/c-to-php-unsigned-char-issue", "title": "C to PHP unsigned char issue", "body": "<p>I cannot for the life of me figure out how to write this one line of code in PHP.  I've never run into anything like this in PHP before and would appreciate any help.</p>\n\n<pre><code>$OCTET_data-&gt;B[0] = (unsigned char) (ror8 ((unsigned char) (ror8 ($OCTET_data-&gt;B[0], 1) - 1), 1) - 1) ^ $OCTET_data-&gt;B[4];\n</code></pre>\n"}, {"tags": ["c++", "c", "compiler-errors", "lvalue", "rvalue"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1451456147, "post_id": 34523923, "comment_id": 56789472, "body": "Also the difference isn&#39;t about <code>&amp;</code>, it seems to be about whether <code>(*(time_t *)alloca(sizeof(time_t)) = time(NULL))</code> is an lvalue or not."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1451456169, "post_id": 34523923, "comment_id": 56789481, "body": "Also, why not just write this on two lines? <code>time_t t = time(NULL); gmtime(&amp;t);</code>"}, {"owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1451456482, "post_id": 34523923, "comment_id": 56789609, "body": "@immibis mainly because I want to get an address of a temporary object (the <code>time_t</code> value is used only once). I found compound literals in C so convenient but I cannot use it in C++."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451456820, "post_id": 34524091, "comment_id": 56789750, "body": "I don&#39;t know the rationale behind the rule, but I&#39;d figure that originally in C it was never an lvalue (there&#39;s rarely any cause to try and modify the result of an assignment), but when C++ was being developed, they changed it to be an lvalue for consistency with objects that overload <code>operator=</code> and return a reference to self (which is an lvalue)."}, {"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 0, "creation_date": 1451456859, "post_id": 34524091, "comment_id": 56789771, "body": "Nice job. I knew it had to do with different rules concerning rvalues and lvalues but I was looking into the <code>&amp;</code> operator and not the <code>=</code> operator. +1."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1451456667, "creation_date": 1451456667, "answer_id": 34524091, "question_id": 34523923, "link": "https://stackoverflow.com/questions/34523923/compiles-as-c-but-not-c-error-lvalue-required-as-unary-operand/34524091#34524091", "title": "Compiles as C++ but not C (error: lvalue required as unary &#39;&amp;&#39; operand)", "body": "<p>In C11 6.5.16/3:</p>\n\n<blockquote>\n  <p>An assignment operator stores a value in the object designated by the left operand. An assignment expression has the value of the left operand after the assignment, <strong>but is not an lvalue</strong>.</p>\n</blockquote>\n\n<p>In C++14 5.17/1:</p>\n\n<blockquote>\n  <p>The assignment operator (=) and the compound assignment operators all group right-to-left. All require a modifiable lvalue as their left operand <strong>and return an lvalue</strong> referring to the left operand.</p>\n</blockquote>\n\n<p>(Earlier versions of the language standards in each case specified the same thing).</p>\n\n<p>Since the address-of operator can only operate on an lvalue, the code is correct in C++ but not in C.</p>\n\n<hr>\n\n<p>Regarding the question \"Is it possible to modify my syntax to make it work in both C &amp; C++?\".  This is not a desirable goal; the two languages are different and you should decide what you're writing. This makes about as much sense as trying to stick to syntax that works in both C and Java.</p>\n\n<p>As suggested by others, you could write:</p>\n\n<pre><code>time_t t = time(NULL);\ngmtime(&amp;t);\n</code></pre>\n\n<p>which has the benefits over your original code of being:</p>\n\n<ul>\n<li>simpler, therefore easier to understand and maintain</li>\n<li>does not depend on non-standard <code>alloca</code> function</li>\n<li>does not have potential alignment violation</li>\n<li>uses no more memory and perhaps uses less</li>\n</ul>\n"}], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 1, "accepted_answer_id": 34524091, "answer_count": 1, "score": 5, "last_activity_date": 1451456667, "creation_date": 1451455905, "question_id": 34523923, "link": "https://stackoverflow.com/questions/34523923/compiles-as-c-but-not-c-error-lvalue-required-as-unary-operand", "title": "Compiles as C++ but not C (error: lvalue required as unary &#39;&amp;&#39; operand)", "body": "<p>This line compiles when I use C++, but not C:</p>\n\n<p><code>gmtime(&amp;(*(time_t *)alloca(sizeof(time_t)) = time(NULL))); //make an lvalue with alloca</code></p>\n\n<p>I'm surprised by this difference. There is not even a warning for C++.</p>\n\n<p>When I specify <code>gcc -x c</code>, the message is:</p>\n\n<pre><code>playground.cpp:25:8: error: lvalue required as unary '&amp;' operand\n gmtime(&amp;(*(time_t *)alloca(sizeof(time_t)) = time(NULL)));\n        ^\n</code></pre>\n\n<p>Isn't the <code>&amp;</code> here just an address-of operator? Why is it different in C and C++?</p>\n\n<p>Although I can use compound literals in C, still is it possible to modify my syntax to make it work in both C &amp; C++?</p>\n"}, {"tags": ["c", "linux", "libusb"], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 1705267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/56957d438f1bdd2e07c522f2b1e9d1b4?s=128&d=identicon&r=PG", "display_name": "Frotz", "link": "https://stackoverflow.com/users/1705267/frotz"}, "edited": false, "score": 0, "creation_date": 1451457978, "post_id": 34523990, "comment_id": 56790158, "body": "My problem is that I want to be able to tell why I&#39;m unable to talk to a device.  Should I just check if NULL is returned from <code>libusb_open_device_with_vid_pid()</code> and forget about finding out why?"}, {"owner": {"reputation": 2341, "user_id": 2556594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9307abdc6ee24a4f7f3a3e2f55506e1f?s=128&d=identicon&r=PG", "display_name": "Alex Skalozub", "link": "https://stackoverflow.com/users/2556594/alex-skalozub"}, "reply_to_user": {"reputation": 393, "user_id": 1705267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/56957d438f1bdd2e07c522f2b1e9d1b4?s=128&d=identicon&r=PG", "display_name": "Frotz", "link": "https://stackoverflow.com/users/1705267/frotz"}, "edited": false, "score": 0, "creation_date": 1451458963, "post_id": 34523990, "comment_id": 56790557, "body": "If you&#39;re already traversing a list of devices and querying descriptors for them, there&#39;s no need to do it for the second time (inside <code>libusb_open_device_with_vid_pid</code>). Just call <code>libusb_open</code> for the found device (after checking its vid/pid/etc. from descriptor), and it will return a meaningful error code you can analyze."}], "tags": [], "owner": {"reputation": 2341, "user_id": 2556594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9307abdc6ee24a4f7f3a3e2f55506e1f?s=128&d=identicon&r=PG", "display_name": "Alex Skalozub", "link": "https://stackoverflow.com/users/2556594/alex-skalozub"}, "is_accepted": true, "score": 1, "last_activity_date": 1451456205, "creation_date": 1451456205, "answer_id": 34523990, "question_id": 34523888, "link": "https://stackoverflow.com/questions/34523888/libusb-get-device-descriptor-always-returns-0-how-do-i-detect-failure/34523990#34523990", "title": "libusb_get_device_descriptor() always returns 0. How do I detect failure?", "body": "<p>Documentation explicitly states that</p>\n\n<blockquote>\n  <p>Note since libusb-1.0.16, LIBUSB_API_VERSION >= 0x01000102, this function always succeeds.</p>\n</blockquote>\n\n<p>This means you should never fail to get descriptor.</p>\n"}], "owner": {"reputation": 393, "user_id": 1705267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/56957d438f1bdd2e07c522f2b1e9d1b4?s=128&d=identicon&r=PG", "display_name": "Frotz", "link": "https://stackoverflow.com/users/1705267/frotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 34523990, "answer_count": 1, "score": 0, "last_activity_date": 1451456205, "creation_date": 1451455730, "question_id": 34523888, "link": "https://stackoverflow.com/questions/34523888/libusb-get-device-descriptor-always-returns-0-how-do-i-detect-failure", "title": "libusb_get_device_descriptor() always returns 0. How do I detect failure?", "body": "<p>Prior to version 1.0.16 of libusb, libusb_get_device_descriptor() would return 0 for success or a negative integer to indicate failure.  With version 1.0.16 and later, this function always returns 0.  How do I detect and figure out why I fail to get a descriptor now that that convenient means of figuring it out is gone? </p>\n"}, {"tags": ["c", "gdb", "breakpoints"], "answers": [{"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1451501725, "creation_date": 1451501725, "answer_id": 34535451, "question_id": 34523697, "link": "https://stackoverflow.com/questions/34523697/in-gdb-how-to-set-breakpoint-on-any-line-that-has-a-particular-word/34535451#34535451", "title": "In gdb how to set breakpoint on any line that has a particular word?", "body": "<blockquote>\n  <p>is it possible?</p>\n</blockquote>\n\n<p>No.</p>\n\n<p>GDB doesn't <em>look</em> at your source <em>at all</em>. It just inserts breakpoints at certain locations, and then runs the program at full speed, until one of the breakpoints is hit.</p>\n\n<p>What you are asking for is for GDB to execute <code>next</code> command repeatedly, and then conditionally continue if the line you are on does not match your regexp. I am not sure it's possible to script this, but even if it is, this will be <em>impractically slow</em> for any non-trivial program.</p>\n"}, {"tags": [], "owner": {"reputation": 3703, "user_id": 1370847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fbf2d89991ff2e9b36e53236a90d502?s=128&d=identicon&r=PG", "display_name": "amdixon", "link": "https://stackoverflow.com/users/1370847/amdixon"}, "is_accepted": true, "score": 5, "last_activity_date": 1451528403, "last_edit_date": 1451528403, "creation_date": 1451527610, "answer_id": 34540070, "question_id": 34523697, "link": "https://stackoverflow.com/questions/34523697/in-gdb-how-to-set-breakpoint-on-any-line-that-has-a-particular-word/34540070#34540070", "title": "In gdb how to set breakpoint on any line that has a particular word?", "body": "<p>Outside of gdb, you can search your source and list your breakpoints first, then call gdb with -x flag to set these breakpoints.</p>\n\n<p><strong>plan</strong></p>\n\n<blockquote>\n  <ul>\n  <li>grep over the source for user-defined patterns ( eg. erase, delete )</li>\n  <li>generate the break statements based on above line numbers, write these to file</li>\n  <li>call gdb with -x flag and point at generated file with break statements</li>\n  </ul>\n</blockquote>\n\n<p><strong>man gdb</strong></p>\n\n<pre><code>   ...\n   -x file\n       Execute GDB commands from file file.\n   ...\n</code></pre>\n\n<hr>\n\n<p><strong>write_breakpoints.sh</strong></p>\n\n<pre><code>#!/bin/bash\n\nsourcename=\"$1\";\npatterns=\"$2\";\noutbreaks=\"$3\";\n\ngrep -En \"$2\" \"$1\" | \\\n  cut -d: -f1 | \\\n  sed \"s/^\\(.\\+\\)$/break $1:\\1/g\" 1&gt;&gt;\"$3\";\n</code></pre>\n\n<p><strong>example.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt; \n\nvoid delete()\n{\n  printf(\"!! data is being deleted..\\n\");\n}\n\nvoid erase()\n{\n  printf(\"!! data is being erased..\\n\");\n}\n\nint main(void)\n{\n  printf(\"this line is safe..\\n\");\n  erase();\n  delete();\n  return 0;\n}\n</code></pre>\n\n<p><strong>usage</strong></p>\n\n<pre><code>$ gcc -g example.c -o example\n$ ./write_breakpoints.sh example.c \"(delete|erase)\" \"breakpoints.txt\"\n\n$ gdb -x breakpoints.txt example\nGNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1\nCopyright (C) 2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n&lt;http://www.gnu.org/software/gdb/bugs/&gt;.\nFind the GDB manual and other documentation resources online at:\n&lt;http://www.gnu.org/software/gdb/documentation/&gt;.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from example...done.\nBreakpoint 1 at 0x400531: file example.c, line 3.\nBreakpoint 2 at 0x400531: file example.c, line 5.\nBreakpoint 3 at 0x400541: file example.c, line 8.\nBreakpoint 4 at 0x400541: file example.c, line 10.\nBreakpoint 5 at 0x40055b: file example.c, line 16.\nBreakpoint 6 at 0x400565: file example.c, line 17.\n(gdb) run\nStarting program: /path/to/example \nthis line is safe..\n\nBreakpoint 5, main () at example.c:16\n16    erase();\n(gdb) c\nContinuing.\n\nBreakpoint 3, erase () at example.c:10\n10    printf(\"!! data is being erased..\\n\");\n(gdb) c\nContinuing.\n!! data is being erased..\n\nBreakpoint 6, main () at example.c:17\n17    delete();\n(gdb) c\nContinuing.\n\nBreakpoint 1, delete () at example.c:5\n5     printf(\"!! data is being deleted..\\n\");\n(gdb) c\nContinuing.\n!! data is being deleted..\n[Inferior 1 (process 26130) exited normally]\n(gdb) quit\n</code></pre>\n\n<hr>\n\n<p><strong>notes</strong></p>\n\n<ul>\n<li>can call write_breakpoints with multiple source files ( as it appends the break statements )</li>\n<li>it may also be possible to do this inside gdb using <a href=\"http://scc.ustc.edu.cn/zlsc/sugon/intel/debugger/cl/commandref/gdb_mode/cmd_forward_sear.htm\" rel=\"noreferrer\">forward-search</a> and b</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1511395740, "last_edit_date": 1511395740, "creation_date": 1511388345, "answer_id": 47444592, "question_id": 34523697, "link": "https://stackoverflow.com/questions/34523697/in-gdb-how-to-set-breakpoint-on-any-line-that-has-a-particular-word/47444592#47444592", "title": "In gdb how to set breakpoint on any line that has a particular word?", "body": "<p>Based on @amdixon's answer, I wrote a one-liner that's friendly for git repos (and wouldn't be hard to modify for svn, merc, etc.)  It can be run from the repo root or any subdirectory.</p>\n\n<pre><code>git ls-files '*.cpp' -z | xargs -n1 -P4 -0 awk -v wd=$(pwd) '/[REGEX]/ {print \"break \\\"\" wd \"/\" FILENAME \":\" NR \"\\\"\"}' &gt;outbreak\n</code></pre>\n\n<p>Where [REGEX] is your regex.  The file is good to run from any directory, so in my case:</p>\n\n<pre><code>mv outbreak /pathToExecutable\ncd !$\ncgdb -x outbreak executable\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p><code>-z</code>, <code>-0</code>, and <code>\\\"</code> are all to deal with spaces/eols in the path.  <code>-n1</code> causes awk to parse one file at a time (otherwise the line numbers will be wrong because it will treat it like a giant glob).  <code>P4</code> allows awk to run 4 processes at once (for speed--optional).  <code>-v wd=$(pwd)</code> passes the working directory to awk as <code>wd</code> and <code>FILENAME</code> and <code>NR</code> are awk builtins.</p>\n"}], "owner": {"reputation": 1405, "user_id": 646710, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad96b8b96de851fe2308338910a2f31e?s=128&d=identicon&r=PG", "display_name": "Sumit", "link": "https://stackoverflow.com/users/646710/sumit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1133, "favorite_count": 2, "accepted_answer_id": 34540070, "answer_count": 3, "score": 4, "last_activity_date": 1511395740, "creation_date": 1451454718, "question_id": 34523697, "link": "https://stackoverflow.com/questions/34523697/in-gdb-how-to-set-breakpoint-on-any-line-that-has-a-particular-word", "title": "In gdb how to set breakpoint on any line that has a particular word?", "body": "<p>I want that while my program is executing under gdb, <br/>\nBefore executing any line of code check if the line has a particular word example a macro name or a variable name or any particular word, and if it has that then stop the execution.<br/>\nBetter if it can be done using regular expression.</p>\n\n<p>I know there is a command <code>rbreak</code> or <code>rb</code> but that sets breakpoint on matching function name, that is not what I want.</p>\n\n<p>So is it possible?</p>\n"}, {"tags": ["c", "yacc", "lex"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1451451630, "post_id": 34523101, "comment_id": 56787901, "body": "What do you mean &quot;read multiple line&quot;? If the grammar is set up correctly then the parser should &quot;read multiple lines&quot; automatically. Can you please edit the question to include the grammar (complete if it&#39;s small, otherwise an outline)?"}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1451455818, "post_id": 34523789, "comment_id": 56789346, "body": "Perhaps you meant the second production to be left-recursive, so that the list is produced incrementally rather than piling up on the stack until the entire input is read. Of course, aside from parser stack usage, it makes little difference if the only goal is to validate syntax."}, {"owner": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "edited": false, "score": 0, "creation_date": 1451456267, "post_id": 34523789, "comment_id": 56789518, "body": "** Sir I am not understand what you want to say can you give me example using my code **"}, {"owner": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "edited": false, "score": 0, "creation_date": 1451556473, "post_id": 34523789, "comment_id": 56830913, "body": "hello sir i am not understand how to do this pleas give me one example please. only that part you initialize it above."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "edited": false, "score": 0, "creation_date": 1451561380, "post_id": 34523789, "comment_id": 56833106, "body": "@s.zen <i>What</i> part of my answer don&#39;t you understand? Just put the rule I show first in the rules-section of your Yacc-file."}, {"owner": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "edited": false, "score": 0, "creation_date": 1451889986, "post_id": 34523789, "comment_id": 56916997, "body": "%{ #include &lt;stdio.h&gt; #include &quot;y.tab.h&quot; extern int yylval; int yywrap(); %}  %% [a-zA-Z]\t{yylval = <i>yytext; return ALPHABET;} [0-9]+\t\t{yylval = atoi(yytext); return NUMBER;} [0-9]+&quot;.&quot;[0-9]</i>\t{yylval = atof(yytext); return NUMBER;} &quot;==&quot;\t\treturn EQ; &quot;&lt;=&quot;\t\treturn LE; &quot;&gt;=&quot;\t\treturn GE; &quot;!=&quot;\t\treturn NE; [\\t]\t; \\n\treturn 0; .\treturn  yytext[0]; %%  int yywrap() { \treturn 1; }"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "edited": false, "score": 0, "creation_date": 1451891137, "post_id": 34523789, "comment_id": 56917389, "body": "@s.zen: Please don&#39;t try posting code in a comment \u2014 it isn&#39;t readable, and as the OP, you can edit the question to add the new/extra code.  Remember not to destroy the question \u2014 add the new code, rather than replacing what was already there, please.  (If you&#39;re not the OP, it can be necessary to post code in a comment, but then enclose it in back-ticks: <code>%{ \u2026 %}</code> is created from `` <code>%{ \u2026 }%</code> ``"}, {"owner": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1451892000, "post_id": 34523789, "comment_id": 56917728, "body": "@JonathanLeffler ok sir i can understand but can you give me solution of my problem i put my code , so please check how to read multiple line text by using lex and yacc and checking expression is valid or invalid line by line."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1451457646, "last_edit_date": 1451457646, "creation_date": 1451455222, "answer_id": 34523789, "question_id": 34523101, "link": "https://stackoverflow.com/questions/34523101/lex-and-yacc-analyzer/34523789#34523789", "title": "lex and yacc analyzer", "body": "<p>You grammar only handles a single <code>ArithmeticExpression</code>, and once that is done the parser returns.</p>\n\n<p>One way to solve your problem is to modify the parser grammar just a little, so it handles multiple \"lines\" (or rather multiple expressions in your case) itself:</p>\n\n<pre><code>    ArithmeticExpression_list\n      : ArithmeticExpression\n      | ArithmeticExpression_list ArithmeticExpression\n      ;\n</code></pre>\n\n<p>Then you simply use the return value of <a href=\"https://www.gnu.org/software/bison/manual/bison.html#Parser-Function\" rel=\"nofollow\">the <code>yyparse()</code> function</a> to see if parsing was successful or not. If <code>yyparse()</code> return <code>0</code> then all expressions were syntactically okay.</p>\n\n<p>If you want to print for each and every expression, just add a semantic action for the <code>ArithmeticExpression</code>, if there's a syntax error it will not be invoked.</p>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1451893580, "creation_date": 1451893580, "answer_id": 34586712, "question_id": 34523101, "link": "https://stackoverflow.com/questions/34523101/lex-and-yacc-analyzer/34586712#34586712", "title": "lex and yacc analyzer", "body": "<p>The structure of <code>main()</code> is wrong.  It reads the whole of the input file using <code>fgets()</code>, and then seems to expect <code>yyparse()</code> to read some more information from it.</p>\n\n<p>What you probably need to do is:</p>\n\n<pre><code>while (yyparse() == 0)\n    printf(\"OK\\n\");\n</code></pre>\n\n<p>Well, something along those lines.  You might need to analyze <code>flag</code>, and/or set <code>flag</code> to 0 (or 1) after each iteration.  If you want to read lines and have the grammar read the string, you have more work to do \u2014 setting up appropriate input functions, etc.</p>\n\n<p>To get the code to compile cleanly, I used the following code.  I added <code>#define YY_NO_INPUT</code> and full prototypes and various other changes \u2014 and cleaned up the triple comma expressions in the grammar for the comparison operations.  They probably aren't what you'll use in the long term, but they satisfy the stringent compiler options I use.</p>\n\n<h3>testlex.l</h3>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include \"y.tab.h\"\n#define YY_NO_INPUT\nextern int yylval;\nint yywrap(void);\nextern void use_yyunput(char c);\n%}\n\n%%\n[a-zA-Z]    {yylval = *yytext; return ALPHABET;}\n[0-9]+      {yylval = atoi(yytext); return NUMBER;}\n[0-9]+\".\"[0-9]* {yylval = atof(yytext); return NUMBER;}\n\"==\"        return EQ;\n\"&lt;=\"        return LE;\n\"&gt;=\"        return GE;\n\"!=\"        return NE;\n[\\t]    ;\n\\n  return 0;\n.   return  yytext[0];\n%%\n\nint yywrap(void)\n{\n    return 1;\n}\nvoid use_yyunput(char c)\n{\n    unput(c);\n}\n</code></pre>\n\n<h3><code>testyacc.y</code></h3>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\nextern int yylex(void);\nextern int yyparse(void);\nextern void yyerror(char *str);\nextern FILE* yyin;\nint flag = 0;\n%}\n\n%token NUMBER\n%token ALPHABET\n%left '+''-' \n%left '*''/''%'\n%left '&amp;''|''^''~'\n%right EQ LE GE NE'&lt;''&gt;'\n%left '('')'\n%left UMINUS\n%left UPLUS\n%start check\n\n%%\ncheck   : E { }\n  E:E '+' E {$$ = $1 + $3;}\n  |E '-' E  {$$ = $1 - $3;}\n  |E '&amp;' E  {$$ = $1 &amp; $3;}\n  |E '|' E  {$$ = $1 | $3;}\n  |E '^' E  {$$ = $1 ^ $3;}\n  |'~' E    {$$ = ~$2;}\n  |E EQ E   {$$ = ($1 == $3);}\n  |E LE E   {$$ = ($1 &lt;= $3);}\n  |E GE E   {$$ = ($1 &gt;= $3);}\n  |E NE E   {$$ = ($1 != $3);}\n  |E '&lt;' E  {$$ = ($1 &lt;  $3);}\n  |E '&gt;' E  {$$ = ($1 &gt;  $3);}\n  |'(' E ')'    {$$ = $2;}\n  |'-' E %prec  UMINUS\n            {$$ = - $2;}\n  |'+' E %prec  UPLUS\n    {$$ = + $2;} \n  |NUMBER   {$$ = $1;}\n  |ALPHABET {$$ = $1;}\n  ;\n%%\n\nint main(void)\n{\n    char filename[30];\n    printf(\"\\nEnter filename\\n\");\n    scanf(\"%s\",filename);\n    yyin = fopen(filename, \"r\");\n    if(NULL == yyin)\n    {\n        fprintf(stderr,\"Can't read file %s\\n\",filename);\n        return 1;\n    }\n    else\n    {\n        while (yyparse() == 0)\n        {\n            printf(\"OK\\n\");\n        }\n        fclose(yyin);\n    }\n\n    if(flag == 0)\n        printf(\"\\nBoolean Arithmetic Expression is valid\\n\");\n\n    return 0;\n}\n\nvoid yyerror(char *str)\n{\n    assert(str != 0);\n    printf(\"\\nBoolean Arithmetic expression is invalid\\n\\n\");\n    flag = 1;\n}\n</code></pre>\n\n<h3>Compilation and run</h3>\n\n<p>The file <code>data</code> contained the data from the question.  <code>rmk</code> is a variation on the theme of <code>make</code>.</p>\n\n<pre><code>$ rmk testyacc.o testlex.o\n    yacc  testyacc.y\n    gcc -O3   -g   -I/Users/jleffler/inc   -std=c11   -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes -Wold-style-definition -Werror    -c y.tab.c\n    mv y.tab.o testyacc.o\n    rm -f y.tab.c\n    lex  testlex.l\n    gcc -O3   -g   -I/Users/jleffler/inc   -std=c11   -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes -Wold-style-definition -Werror    -c lex.yy.c\n    mv lex.yy.o testlex.o\n    rm -f lex.yy.c\n$ gcc -o testit testyacc.o testlex.o\n$ ./testit\n\nEnter filename\ndata\nOK\nOK\nOK\n\nBoolean Arithmetic expression is invalid\n\n$\n</code></pre>\n\n<p>Your stack uses integers, I believe.  The use of <code>atof()</code> isn't going to help very much.  That mainly means you've still got a lot of work to do.</p>\n\n<p>Testing on Mac OS X 10.11.2 with GCC 5.3.0 (with <code>flex 2.5.35 Apple(flex-31)</code> and\n<code>bison (GNU Bison) 2.3</code> masquerading as <code>lex</code> and <code>yacc</code>).</p>\n"}], "owner": {"reputation": 11, "user_id": 5387145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/def3da8cc72e179975f089f4a19406f8?s=128&d=identicon&r=PG&f=1", "display_name": "s.zen", "link": "https://stackoverflow.com/users/5387145/s-zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451893580, "creation_date": 1451451223, "last_edit_date": 1451891010, "question_id": 34523101, "link": "https://stackoverflow.com/questions/34523101/lex-and-yacc-analyzer", "title": "lex and yacc analyzer", "body": "<p>Now here is my lex code </p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include \"y.tab.h\"\nextern int yylval;\nint yywrap();\n%}\n\n%%\n[a-zA-Z]    {yylval = *yytext; return ALPHABET;}\n[0-9]+      {yylval = atoi(yytext); return NUMBER;}\n[0-9]+\".\"[0-9]* {yylval = atof(yytext); return NUMBER;}\n\"==\"        return EQ;\n\"&lt;=\"        return LE;\n\"&gt;=\"        return GE;\n\"!=\"        return NE;\n[\\t]    ;\n\\n  return 0;\n.   return  yytext[0];\n%%\n\nint yywrap()\n{\n    return 1;\n}\n</code></pre>\n\n<p>and here is my yacc code </p>\n\n<pre><code>%{\n#include&lt;stdio.h&gt;\nextern int yylex();\nextern int yyparse();\nextern FILE* yyin;\nint flag = 0;\n%}\n\n%token NUMBER\n%token ALPHABET\n%left '+''-' \n%left '*''/''%'\n%left '&amp;''|''^''~'\n%right EQ LE GE NE'&lt;''&gt;'\n%left '('')'\n%left UMINUS\n%left UPLUS\n%start check\n\n%%\ncheck   : E { }\n  E:E '+' E {$$ = $1 + $3;}\n  |E '-' E  {$$ = $1 - $3;}\n  |E '&amp;' E  {$$ = $1 &amp; $3;}\n  |E '|' E  {$$ = $1 | $3;}\n  |E '^' E  {$$ = $1 ^ $3;}\n  |'~' E    {$$ = ~$2;}\n  |E EQ E   {$$ = (EQ, $1, $3);}\n  |E LE E   {$$ = (LE, $1, $3);}\n  |E GE E   {$$ = (GE, $1, $3);}\n  |E NE E   {$$ = (NE, $1, $3);}\n  |E '&lt;' E  {$$ = ('&lt;', $1, $3);}\n  |E '&gt;' E  {$$ = ('&gt;', $1, $3);}\n  |'(' E ')'    {$$ = $2;}\n  |'-' E %prec  UMINUS\n            {$$ = - $2;}\n  |'+' E %prec  UPLUS\n    {$$ = + $2;} \n  |NUMBER   {$$ = $1;}\n  |ALPHABET {$$ = $1;}\n  ;\n%%\n\nint main(int argc, char** argv)\n{\n    char filename[30];\n    char line[300];\n    printf(\"\\nEnter filename\\n\");\n    scanf(\"%s\",filename);\n    yyin = fopen(filename, \"r\");\n    if(NULL == yyin)\n    {\n        fprintf(stderr,\"Can't read file %s\\n\",filename);\n        return 1;\n    }\n    else\n    {\n        while(fgets(line, sizeof line, yyin) != NULL)\n        {\n            printf(\"%s\\n\", line);\n\n        }\n        yyparse();  \n        fclose(yyin);\n        printf(\"\\nValue of yyparse : %d\\n\",yyparse());\n    }\n    if(flag == 0)\n        printf(\"\\nBoolean Arithmetic Expression is valid\\n\");\n\n    return 0;\n}\n\nvoid yyerror()\n{\n    printf(\"\\nBoolean Arithmetic expression is invalid\\n\\n\");\n    flag = 1;\n}\n</code></pre>\n\n<p>This is my main part for reading text file and do some operations, so anyone can tell me this how to read multiple line in text file using Yacc. Now I put my fully Yacc code and I try to check Boolean expression is correct or not my text file expressions are : -</p>\n\n<pre><code>a-b\na+b&amp;c\n(P!=F+E-O+F-(U&gt;Y+I&lt;N))\n(((a+B)-7+4-(c-d))+((P^q)-(L|z))+(m&amp;n)+(O-g)\n((A-2)&amp;(B+2)|(C-4)^(D+4)+(~E))==F+(G!=)-(i&lt;j)-(K&gt;M)\n((((a+b)-(c+d))-((E-F)+(G-H)))+((a&amp;B)+(c|d))-((e^f)+(~g)+(i==2)-(j!=2)+(k&lt;=8)-(l&gt;=17.98)+(M&lt;N)-(O&gt;p)-((-2+4)+(6-(-5)))))\n</code></pre>\n\n<p>So my code check only first expression. So my problem is that how to check all expressions line by line.</p>\n\n<p>Now please check where is the problem for reading text line by line and give message expression is valid or not please help.\n   Some expressions are valid and some are invalid so please check and tell me the problem and how to correct it.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1451451208, "post_id": 34523059, "comment_id": 56787786, "body": "Why are you using double percentages in the format string? The percentage character is not special in string literals and need not be escaped."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1451451729, "post_id": 34523059, "comment_id": 56787936, "body": "Also, the <code>strftime</code> format is for dates (if you remove the extra percentage characters), so how do you notice the &quot;time&quot;? <i>If</i> there was a problem it would only be noticeable around midnight."}, {"owner": {"reputation": 141, "user_id": 1717996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/05BfU.png?s=128&g=1", "display_name": "Amirul Islam", "link": "https://stackoverflow.com/users/1717996/amirul-islam"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1451453656, "post_id": 34523059, "comment_id": 56788555, "body": "Ignore the double percentage, when I wrote it I made a mistake, corrected it. But yes.. I have checked it after midnight.. but there are other ways.. I checked it too.. why dont you try and let me know if you have the same behavior."}, {"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 1, "creation_date": 1451454619, "post_id": 34523059, "comment_id": 56788903, "body": "Works fine for me once I add the time into the format string."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1451455695, "post_id": 34523059, "comment_id": 56789304, "body": "Using a format to show <i>the time</i>, <a href=\"http://ideone.com/7VVQ9u\" rel=\"nofollow noreferrer\">I can&#39;t reproduce your problem</a>, you must be doing something which you do not show us if you have a problem."}, {"owner": {"reputation": 141, "user_id": 1717996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/05BfU.png?s=128&g=1", "display_name": "Amirul Islam", "link": "https://stackoverflow.com/users/1717996/amirul-islam"}, "edited": false, "score": 0, "creation_date": 1451456936, "post_id": 34523059, "comment_id": 56789800, "body": "yes, its seems that the printlog function for some reason was modifying the timestamp which is very weird.. anyways.. thanks guys for the help"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451460395, "post_id": 34523059, "comment_id": 56791119, "body": "To avoid this sort of error you can do <code>struct tm ts = *localtime(&amp;ct);</code>  (and change <code>-&gt;</code> to <code>.</code> later)"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 1717996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/05BfU.png?s=128&g=1", "display_name": "Amirul Islam", "link": "https://stackoverflow.com/users/1717996/amirul-islam"}, "edited": false, "score": 0, "creation_date": 1451463556, "post_id": 34524142, "comment_id": 56792393, "body": "thanks.. made the changes and now its working fine"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1451456916, "creation_date": 1451456916, "answer_id": 34524142, "question_id": 34523059, "link": "https://stackoverflow.com/questions/34523059/deduct-1hr-from-current-time-strange-behavior/34524142#34524142", "title": "Deduct 1hr from Current Time (Strange behavior)", "body": "<p>I suspect you are running into the problem that <code>localtime()</code> returns a pointer to static storage, so multiple calls to <code>localtime()</code> end up all pointing at the same data.  In particular, it means that if you call <code>localtime()</code> twice with two different values for the time, and then analyze the output, the output appears to be the same.</p>\n\n<p>Look at this adaptation of your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nint main(void)\n{\n    int lookback = 60;\n    time_t c0 = time(0);\n    time_t ct = c0 - (lookback*60);\n    struct tm *t0 = localtime(&amp;c0);\n    //struct tm  copy_t0 = *t0;\n    struct tm *ts = localtime(&amp;ct);\n\n    char path[1024];\n    char p0[1024];\n    char format[512] = \"/home/stash/%Y%m%d-%H%M%S\";\n    strftime(p0, sizeof(p0), format, t0);\n    //strftime(p0, sizeof(p0), format, &amp;copy_t0);\n    strftime(path, sizeof(path), format, ts); \n    printf(\"%lu: %s\\n\", (unsigned long)c0, p0);\n    printf(\"%lu: %s\\n\", (unsigned long)ct, path);\n    return 0;\n}\n</code></pre>\n\n<p>When I run that code, I get sample output:</p>\n\n<pre><code>1451456585: /home/stash/20151229-212305\n1451452985: /home/stash/20151229-212305\n</code></pre>\n\n<p>When I use the commented out code \u2014 which makes a copy of the structure from <code>localtime()</code> \u2014 then I get the answer I wanted in the first place:</p>\n\n<pre><code>1451456732: /home/stash/20151229-222532\n1451453132: /home/stash/20151229-212532\n</code></pre>\n\n<p>Obviously, another way to handle the difference would be to call <code>localtime()</code> and then <code>strftime()</code>, before the next calls to <code>localtime()</code> and <code>strftime()</code>.</p>\n"}], "owner": {"reputation": 141, "user_id": 1717996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/05BfU.png?s=128&g=1", "display_name": "Amirul Islam", "link": "https://stackoverflow.com/users/1717996/amirul-islam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1451472302, "accepted_answer_id": 34524142, "answer_count": 1, "score": 0, "last_activity_date": 1451456916, "creation_date": 1451450977, "last_edit_date": 1451453450, "question_id": 34523059, "link": "https://stackoverflow.com/questions/34523059/deduct-1hr-from-current-time-strange-behavior", "closed_reason": "Not suitable for this site", "title": "Deduct 1hr from Current Time (Strange behavior)", "body": "<p>The answer to the main question is already out there, but I am facing a strange issue with strftime. Check the following code</p>\n\n<pre><code>int lookback = 60;\ntime_t ct;\ntime(&amp;ct);\nct -= (lookback*60);\nstruct tm *ts = localtime(&amp;ct);\n\nchar path[1024];\nchar format[512] = \"/home/stash/%Y%m%d\";\n\nprintlog(\"Maximum Lookback time: %02d-%02d-%d %2.2d:%2.2d:%2.2d\", ts-&gt;tm_mday, ts-&gt;tm_mon+1, ts-&gt;tm_year+1900, ts-&gt;tm_hour, ts-&gt;tm_min, ts-&gt;tm_sec); // This one works just fine\n\nstrftime(path, 1024, format, ts); // But strftime gives me current time\n</code></pre>\n\n<p>Any idea what I am doing wrong maybe? Or is there any other way I can achieve this? Note, I need to use strftime since the format is a dynamic var which will be changed externally.</p>\n\n<p>Edited</p>\n"}, {"tags": ["mysql", "c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1451451001, "post_id": 34523025, "comment_id": 56787728, "body": "Q: What&#39;s the purpose of running multiple threads?  Q: Unrelated, but why are you using the deprecated API, instead of <a href=\"http://php.net/manual/en/ref.pdo-mysql.php\" rel=\"nofollow noreferrer\">PDO</a> or <a href=\"http://php.net/manual/en/book.mysqli.php\" rel=\"nofollow noreferrer\">mySqli</a>?  Look here for more details: <a href=\"http://php.net/manual/en/mysqlinfo.api.choosing.php\" rel=\"nofollow noreferrer\">php.net/manual/en/mysqlinfo.api.choosing.php</a>"}, {"owner": {"reputation": 344, "user_id": 5050086, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e7cf3c41fb2d5642f5b1b1044c5662?s=128&d=identicon&r=PG", "display_name": "Laksith", "link": "https://stackoverflow.com/users/5050086/laksith"}, "reply_to_user": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1451451204, "post_id": 34523025, "comment_id": 56787784, "body": "@paulsm4 this is a app wchich needs a higher speed. In this program there is another process that is not been devoloped. a calculation and a insert to another mysql server. this is just the begining part."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 3, "creation_date": 1451456887, "post_id": 34523025, "comment_id": 56789784, "body": "VERY IMPORTANT: 1) Please do <i>not</i> write any new code against the deprecated &quot;mysql&quot; APIs. 2) Please do <i>not</i> expect the &quot;printf()&#39;s&quot; from your threads to match the actual order of execution - they won&#39;t.  4) Check <a href=\"https://dev.mysql.com/doc/refman/5.5/en/too-many-connections.html\" rel=\"nofollow noreferrer\">max_connections</a> in your mySQL configuration.  And, <i>MOST IMPORTANT</i>: please look at your <code>mysql_error()</code> output, look at your mySQL error logs, and <i>UPDATE YOUR POST WITH AN EXECT ERROR MESSAGE</i>."}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 5050086, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e7cf3c41fb2d5642f5b1b1044c5662?s=128&d=identicon&r=PG", "display_name": "Laksith", "link": "https://stackoverflow.com/users/5050086/laksith"}, "edited": false, "score": 0, "creation_date": 1451451305, "post_id": 34523080, "comment_id": 56787808, "body": "no . As I&#39;ve mentioned there&#39;s no problem with the connection since It works for 1 thread correctly. and works some what correctly on the server"}, {"owner": {"reputation": 8243, "user_id": 1629262, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/F9Q4g.jpg?s=128&g=1", "display_name": "doptimusprime", "link": "https://stackoverflow.com/users/1629262/doptimusprime"}, "reply_to_user": {"reputation": 344, "user_id": 5050086, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e7cf3c41fb2d5642f5b1b1044c5662?s=128&d=identicon&r=PG", "display_name": "Laksith", "link": "https://stackoverflow.com/users/5050086/laksith"}, "edited": false, "score": 0, "creation_date": 1451451650, "post_id": 34523080, "comment_id": 56787912, "body": "Please print the values of all the string parameters (dataBase) and integer parameters. That may give correct picture."}], "tags": [], "owner": {"reputation": 8243, "user_id": 1629262, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/F9Q4g.jpg?s=128&g=1", "display_name": "doptimusprime", "link": "https://stackoverflow.com/users/1629262/doptimusprime"}, "is_accepted": false, "score": 0, "last_activity_date": 1451451071, "creation_date": 1451451071, "answer_id": 34523080, "question_id": 34523025, "link": "https://stackoverflow.com/questions/34523025/cant-connect-to-mysql-server-on-localhost-111/34523080#34523080", "title": "Can&#39;t connect to MySQL server on &#39;localhost&#39; (111)", "body": "<p>In </p>\n\n<pre><code>if (mysql_real_connect(con1, dataBase1[0], dataBase1[1], dataBase1[2], dataBase1[3], 0, NULL, 0) == NULL) {\n          ^ port\n</code></pre>\n\n<p>You need to pass the port which is default to 3306. Check for the host name and other parameter.</p>\n\n<p>See <a href=\"http://dev.mysql.com/doc/refman/5.7/en/mysql-real-connect.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.7/en/mysql-real-connect.html</a> for reference.</p>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 5050086, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e7cf3c41fb2d5642f5b1b1044c5662?s=128&d=identicon&r=PG", "display_name": "Laksith", "link": "https://stackoverflow.com/users/5050086/laksith"}, "is_accepted": true, "score": 1, "last_activity_date": 1567056145, "last_edit_date": 1567056145, "creation_date": 1451548304, "answer_id": 34543069, "question_id": 34523025, "link": "https://stackoverflow.com/questions/34523025/cant-connect-to-mysql-server-on-localhost-111/34543069#34543069", "title": "Can&#39;t connect to MySQL server on &#39;localhost&#39; (111)", "body": "<p>I had to go throgh a really tough situation to finally get to the point. It was so simple that Only a single array declaration would do the thing. In my code , in the main function. when creating threads I've used,</p>\n\n<pre><code>for (i = 0; i &lt; 10; i++) {\n    threadRet[i] = pthread_create(&amp;threadT[i], NULL, threadedConnection, &amp;i);\n    printf(\"thread %d - thread ret %d\\n\",i,threadRet[i]);\n}\n</code></pre>\n\n<p>Here is anthor link which says about this \n<a href=\"https://computing.llnl.gov/tutorials/pthreads/#Management\" rel=\"nofollow noreferrer\">Pthreads</a></p>\n\n<p>the thing is that when the arrays do their work they uses the passed integer <code>i</code> and since the address of the integer is passed and in the for loop it continuously increases its value . So when threads try to use it its already incremented and continuously increased. so it gets jammed. </p>\n\n<p>So to overcome it what I did was I declared an array</p>\n\n<pre><code> for (i = 0; i &lt; threadCount; i++) {\n    tbl[i] = i;\n }\n i == 0;\n</code></pre>\n\n<p>and this arrays elements were passed when creating the threads as</p>\n\n<pre><code> for (i = 0; i &lt; 10; i++) {\n    threadRet[i] = pthread_create(&amp;threadT[i], NULL, threadedConnection, &amp;tbl[i]);\n    printf(\"thread %d - thread ret %d\\n\",i,threadRet[i]);\n }\n</code></pre>\n\n<p>this did the work well. And there were also some fewer modifications. that I didn't mention here because I believe they are not related to my problem. they are when joining threads in the end of the main , I used a <code>pthread_attr</code> to make them joinable other wise it wasn't quite right . so here is the final code only the (main function is given here since changes were taken place only in the main)</p>\n\n<pre><code>int main(int argc, char** argv) {\n\n    int threadRet, i = 0;\n    int tbl[threadCount];\n    void *status;\n    pthread_attr_t attr;\n\n    for (i = 0; i &lt; threadCount; i++) {\n    tbl[i] = i;\n    }\n    i == 0;\n\n    pthread_attr_init(&amp;attr);\n    pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_JOINABLE);\n\n    pthread_t * threadT = (pthread_t *) malloc(threadCount * sizeof (pthread_t));\n\n    for (i = 0; i &lt; threadCount; i++) {\n    threadRet = pthread_create(&amp;threadT[i], &amp;attr, threadedConnection, &amp;tbl[i]);\n        if (threadRet) {\n            printf(\"Error creating thread return value of pthread_create() is %d\", threadRet);\n        }\n        printf(\"thread %d - thread ret %d\\n\", i, threadRet);\n    }\n    i = 0;\n\n    pthread_attr_destroy(&amp;attr);\n\n    for (i = 0; i &lt; threadCount; i++) {\n        threadRet = pthread_join(threadT[i], &amp;status);\n        if (threadRet) {\n            printf(\"Error joining thread return value of pthread_join() is %d\", threadRet);\n        }\n\n    }\n\n    free(threadT);\n    pthread_exit(NULL);\n    return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>thanks anyone who tried to help out contributing their time....</p>\n"}], "owner": {"reputation": 344, "user_id": 5050086, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e7cf3c41fb2d5642f5b1b1044c5662?s=128&d=identicon&r=PG", "display_name": "Laksith", "link": "https://stackoverflow.com/users/5050086/laksith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 34543069, "answer_count": 2, "score": 1, "last_activity_date": 1567056145, "creation_date": 1451450698, "question_id": 34523025, "link": "https://stackoverflow.com/questions/34523025/cant-connect-to-mysql-server-on-localhost-111", "title": "Can&#39;t connect to MySQL server on &#39;localhost&#39; (111)", "body": "<p>I am developing a threaded program which reads a mysql database in 10 threads and print the result as a row count by each thread. So the final result is 100 line counts on the command line. the problem is when I run it it sometimes gives an error saying <code>Can't connect to MySQL server on 'localhost' (111)</code>\nsometimes it returns a <code>segmentation fault(core dumped)</code>  I checked the threads and they are also created fine with no errors.</p>\n\n<p>when I create only one thread it works perfectly fine giving the expected output.\n<code>No of Rows  of 00 - 6</code></p>\n\n<p>Another thing is I run this in a red hat server and It works well with no errors but the count is wrong.I created 5 threads and for the first thread <code>52380</code> is correct but for others it gives a different result the result should come like this</p>\n\n<pre><code>No of Rows  of 00 - 52380\nNo of Rows  of 01 - 53434\nNo of Rows  of 02 - 53333\nNo of Rows  of 03 - 50005\nNo of Rows  of 04 - 48393\n</code></pre>\n\n<p>but the actual result coming out is this</p>\n\n<pre><code>No of Rows  of 00 - 52380\nNo of Rows  of 00 - 52380\nNo of Rows  of 01 - 52380\nNo of Rows  of 01 - 52380\nNo of Rows  of 01 - 52380\n</code></pre>\n\n<p>I compile this using </p>\n\n<pre><code>gcc main.c -lpthread `mysql_config --cflags --libs`\n</code></pre>\n\n<p>What would be the cause for this problem. Can anyone help me with this please. Down here is the code I used. Header file is not given here. It contains the database details.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"main1.h\"\n#include &lt;pthread.h&gt;\n#include &lt;mysql/mysql.h&gt;\n#include &lt;mysql/my_global.h&gt;\n\nint main(int argc, char** argv) {\n\n   int threadRet[10], i = 0;\n   pthread_t * threadT = (pthread_t *) malloc(10 * sizeof (pthread_t));\n\n   for (i = 0; i &lt; 10; i++) {\n        threadRet[i] = pthread_create(&amp;threadT[i], NULL, threadedConnection, &amp;i);\n        printf(\"thread %d - thread ret %d\\n\",i,threadRet[i]);\n   }\n   i = 0;\n   for (i = 0; i &lt; 10; i++) {\n        pthread_join(threadT[i], NULL);\n   }\n   return (EXIT_SUCCESS);\n }\n\n\n\nvoid * threadedConnection(void * parr) {\n\n    int * j = (int *) parr;\n    int tableNo=*j;\n    long int rowCount = 0;\n    long int totalInserts = 0;\n\n    MYSQL *con1 = mysql_init(NULL);\n    MYSQL_RES *result;\n    MYSQL_ROW row;\n    con1[tableNo] = mysql_init(NULL);\n    if (mysql_real_connect(con1, dataBase1[0], dataBase1[1], dataBase1[2], dataBase1[3], 0, NULL, 0) == NULL) {\n        fprintf(stderr, \"%s\\n\", mysql_error(con1));\n        mysql_close(con1);\n        exit(1);\n     }\n\n     char countQuery[70];\n     sprintf(countQuery, \"SELECT COUNT(*) FROM numberTable where number like '%s%.2d'\", \"%\", *tableNo);\n\n     if (mysql_query(con1[tableNo], countQuery)) {\n        fprintf(stderr, \"%s\\n\", mysql_error(con1));\n        mysql_close(con1);\n        exit(1);\n     }\n\n     result = mysql_store_result(con1);       //Counting\n     row = mysql_fetch_row(result[tableNo]);  //line\n     rowCount = strtol((row)[0], NULL, 10);   //numbers\n     totalInserts = rowCount;                 //numberTable\n     mysql_free_result(result[tableNo]);\n\n     printf(\"No of Rows  of %.2d - %ld\\n\", tableNo, totalInserts);\n\n\n\n     mysql_close(con1[tableNo]);\n     }\n</code></pre>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1451449878, "post_id": 34522831, "comment_id": 56787383, "body": "How do you get out of the <code>while(1)</code> loop?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1451449932, "post_id": 34522831, "comment_id": 56787398, "body": "Have you considered using <code>fread</code> instead of <code>fscanf</code>?"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1451449981, "post_id": 34522831, "comment_id": 56787414, "body": "When you used the debugger, which statement is causing the issue?"}, {"owner": {"reputation": 1, "user_id": 5729224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fBTaU.jpg?s=128&g=1", "display_name": "James E.", "link": "https://stackoverflow.com/users/5729224/james-e"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1451450304, "post_id": 34522831, "comment_id": 56787505, "body": "nothing is written to break the while(1); but that means the entirety of my input should have been scanned. I haven&#39;t heard of fread; I&#39;ll look it up, but I&#39;m wondering why scanf is acting this way. I&#39;m using xcode on the mac, and I&#39;m not sure exactly what you mean by the debugger. I don&#39;t think there&#39;s any error in my code, but rather that there are intricacies to scanf that I&#39;m not familliar with."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1451451612, "post_id": 34522831, "comment_id": 56787891, "body": "Please post the input to the program."}, {"owner": {"reputation": 1, "user_id": 5729224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fBTaU.jpg?s=128&g=1", "display_name": "James E.", "link": "https://stackoverflow.com/users/5729224/james-e"}, "edited": false, "score": 0, "creation_date": 1451453483, "post_id": 34522831, "comment_id": 56788498, "body": "Here you go, posted."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1451454407, "post_id": 34522831, "comment_id": 56788819, "body": "That looks like a very eccentric way of reading the data.  I think you should be using <code>fgets()</code> to read lines, and then using <code>sscanf()</code> to analyze them.  You should be checking the value returned by <code>scanf()</code> more frequently than you are."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1451455225, "post_id": 34522831, "comment_id": 56789124, "body": "I don&#39;t see any checks to detect EOF. What logic are you using to terminate the program?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451456160, "post_id": 34522831, "comment_id": 56789477, "body": "Is it any wonder that your program is malfunctioning, when you neglect the return value of <code>scanf</code> that tells you whether or not it was successful, and just go on to use <code>trash</code> (possibly an uninitialised variable) as though <code>scanf</code> worked every time?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1451457976, "post_id": 34522831, "comment_id": 56790156, "body": "@JamesE., think carefully about Johathan&#39;s comment. The reason there is a general favor for reading a line-at-a-time and then parsing the line for the individual data is that it removes the sensitivity of the <i>format-string</i> from the read operation. There are times when you have a guaranteed identical line format where reading with the <code>scanf</code> family of functions makes sense. Here you are way outside that ideal."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451459884, "post_id": 34522831, "comment_id": 56790916, "body": "lol @ trash variable"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1451460158, "post_id": 34522831, "comment_id": 56791028, "body": "Why are you not using the <code>%f</code> format specifier in <code>fscanf</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5729224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fBTaU.jpg?s=128&g=1", "display_name": "James E.", "link": "https://stackoverflow.com/users/5729224/james-e"}, "edited": false, "score": 0, "creation_date": 1451462605, "post_id": 34524380, "comment_id": 56792002, "body": "Thanks for your answer. It was really helpful. I&#39;m pretty new to reading and parsing files, and fscanf was really the only function I was aware of or knew how to use. Now that I know about fgets and sscanf, I&#39;ll rewrite the code entirely using them instead."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 1, "user_id": 5729224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fBTaU.jpg?s=128&g=1", "display_name": "James E.", "link": "https://stackoverflow.com/users/5729224/james-e"}, "edited": false, "score": 0, "creation_date": 1453069278, "post_id": 34524380, "comment_id": 57429554, "body": "@JamesE. Can you please click the grey check mark below the answer score to mark it as accepted?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1451458635, "last_edit_date": 1451458635, "creation_date": 1451458103, "answer_id": 34524380, "question_id": 34522831, "link": "https://stackoverflow.com/questions/34522831/scanf-stops-working-abruptly/34524380#34524380", "title": "Scanf stops working abruptly", "body": "<p>Your function <code>getnumber</code> has several problems:</p>\n\n<p>The buffer <code>num</code> is initialized to all <code>'0'</code> without a null terminator.  You patch some bytes into it until you see a space or a linefeed and call <code>atof</code>.</p>\n\n<ul>\n<li><p>There is no test to prevent buffer overflow, invalid input may well cause that at some point in the input file.</p></li>\n<li><p>The buffer is not null terminated.  <code>atof</code> will stop on the first character that does not match the floating point syntax, but if all positions are digits, it will keep reading past the end of the <code>num</code> array.</p></li>\n</ul>\n\n<p>The whole code is very cumbersome and the semantics are unclear.</p>\n\n<p>You never test the return value from <code>scanf</code>: upon end of file, the contents of the unsigned char whose address is passed as argument to <code>scanf</code> will be indeterminate, most likely untouched from the previous value... potentially causing buffer overflow in <code>getnumber</code> as well.</p>\n\n<p>There is no way for your program to break from the <code>while (1)</code> loop.  Sooner or later, you will reach the end of file and your code will either invoke undefined behavior or get stuck in an infinite loop.</p>\n\n<p>Rewrite your code with <code>getchar()</code> or <code>fgets</code> and properly check for end of file.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1451474680, "last_edit_date": 1451474680, "creation_date": 1451474135, "answer_id": 34528438, "question_id": 34522831, "link": "https://stackoverflow.com/questions/34522831/scanf-stops-working-abruptly/34528438#34528438", "title": "Scanf stops working abruptly", "body": "<p>When you get into handling text files containing more than the basic <em>\"each line holds the same information\"</em>, you are better served utilizing <em>line-oriented</em> input functions like <code>fgets</code> or <code>getline</code> in order to separate <em>'reading'</em> of your data and <em>'processing (or parsing)'</em> of your data that too often people attempt to <em>shoehorn</em> into a <code>scanf</code> format string that results in more grief than good. </p>\n\n<p>As mentioned in my comment, when all the input lines are guaranteed to hold the same type and number of variables, and in the exact same format on every line, then the <code>scanf</code> family of input functions can be used fairly reliably. But when your data varies line-by-line, reading each line into a buffer and then having the luxury of writing a handler to parse and validate what was read will result in a far more robust code.</p>\n\n<p>Before beginning your reading, you must decide on how you will hold your values in memory. Whether in a struct, an array, a combination? While C is flexible enough to allow you wide latitude in how you store your data, a bit of thinking up-front on what parts of your data are relatively fixed and what parts will continue to grow, can help you sort out a reasonable storage scheme.</p>\n\n<p>In your case, the data you need that is relatively fixed in size is the <code>name</code> (or <code>label</code>) for your solid (e.g. <code>Untitled-56807ca1</code> in your sample data). The number of normal/vertex sets can be a single number, and keeping track of the max number you can store is also a single number.</p>\n\n<p>The data that will grow as you read from your input file will be the values for the <em>facet normal</em> arrays and the <em>vertex</em> arrays. Here you will need some way of reading as many as are contained in the file (likely without knowing how many are there when you start). Of course, if you do not need to store the data, but simply use the values as they are read, this isn't a concern, but in most cases, you want to be able to store your data so it can be passed to other parts of your code where it can be used.</p>\n\n<p>While you can do it a number of ways, a nested struct, where the fixed values are members of the outer, or base, struct, which also holds a pointer to your data (or nested struct of <em>normal</em> and <em>vertex</em> arrays makes sense. You can make life easier with a simple <em>create</em> or initialization function that allocates and initializes the structs and their values each time a new named solid is read.</p>\n\n<p>After setting up how you will hold/store your data, it is then just a matter of reading each line, examining/parsing the line contents, and taking the appropriate actions based on what you find in each line. You should also make sure you get what you expect to find in each line, and warn or throw an error if your code reads a line it doesn't understand.</p>\n\n<p>There is no better way to put these pieces together than in a short example to read your posted input file so you can get a flavor for it. Note: there are many ways to do this in C, all with their advantages/disadvantages, this is just one for you to consider and to ask questions about to help your understand how a line-oriented approach may benefit what you are attempting to do. Look over the example and let me know what questions you have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;  /* for ERANGE and errno     */\n#include &lt;math.h&gt;   /* for HUGE_VALF, HUGE_VALL */\n\n/* constants - num dimensions, initial facets\n * allocated within each solid, and the max\n * chars per-line for fgets to read\n */\nenum { NDIM = 3, FACETS = 32, MAXC = 256 };\n\n/* facets struct - declared as pointer member of \n * struct solid allowing additional allocation to\n * hold as many normal/vertexes as required.\n */\ntypedef struct {\n    double normal[NDIM];\n    double vertex[NDIM][NDIM];\n} facet;\n\n/* struct solid holds the solid's name, \n * a pointer to an array of stuct facet, \n * the number of facets containing data, and \n * the maximum presently allocated.\n */ \ntypedef struct {\n    char *name;\n    facet *facet;\n    size_t nfacets;\n    size_t maxfacets;\n} solid;\n\n/* function prototypes */\nsolid *create_solid ();\nsolid *read_solid (solid **sol, FILE *fp);\nvoid print_solid (solid *sol);\nvoid free_solid (solid *sol);\ndouble xstrtod (char *str, char **ep);\n\nint main (int argc, char **argv) {\n\n    solid *sol = NULL;  /* pointer to hold values */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open */\n        fprintf (stderr, \"error: file open failed '%s'\\n\", argv[1]);\n        return 1;\n    }\n\n    if (read_solid (&amp;sol, fp)) {    /* read data from file  */\n        print_solid (sol);          /* print data read      */\n        free_solid (sol);           /* free all memory      */\n    }\n    if (fp != stdin) fclose (fp);   /* close if not stdin   */\n\n    return 0;\n}\n\n/* read_solid takes the poiner address for a struct solid,\n * and will read all normal and vertexes into the struct,\n * updating 'nfacets' with the number of facets for which\n * there is data, and will validate each read and conversion\n * of values from string to double. retuns filled struct on\n * success, NULL otherwise\n */\nsolid *read_solid (solid **sol, FILE *fp)\n{\n    char line[MAXC] = {0};      /* temporary line buffer */\n    size_t idx = 0, vidx = 0;   /* line &amp; vertex indexes */\n\n    if (!*sol) *sol = create_solid(); /* allocate &amp; initialize struct */\n\n    while (fgets (line, MAXC, fp)) {  /* read each line in file */\n\n        size_t len = 0;\n        char *p, *ep;\n        p = ep = line;\n\n        len = strlen (line);    /* get length &amp; remove '\\n' */\n        if (line[len - 1] == '\\n') line[--len] = 0;\n\n        if (!(ep = strchr (line, ' '))) /* test if space in line */\n        {   /* if endfacet, update nfacets */\n            if (strcmp (\"endfacet\", line) == 0)  {\n                (*sol)-&gt;nfacets++;\n                if ((*sol)-&gt;nfacets == (*sol)-&gt;maxfacets) {\n                    /* reallocate (*sol)-&gt;facets here, \n                     * update (*sol)-&gt;maxfacets to new size\n                     */\n                    fprintf (stderr, \"read_solid() warning: limit reached\\n\"\n                                    \"you must reallocate or increase FACETS\\n\");\n                    break;\n                }\n            }\n            goto processed;\n        }\n\n        if (strncmp (\"solid\", line, ep - p) == 0) \n        {   /* begins with 'solid', set 'name' */\n            (*sol)-&gt;name = strdup (ep + 1);\n            goto processed;\n        }\n        else if (strncmp (\"facet\", line, ep - p) == 0) \n        {   /* read facet normal values */\n            size_t i;\n            while (*ep &amp;&amp; (*ep &lt; '0' || *ep &gt; '9')) ep++;\n            if (!*ep) { \n                fprintf (stderr, \"read_solid() error: facet normal no values.\\n\");\n                return NULL;\n            }\n            p = ep;\n            for (i = 0; i &lt; NDIM; i++) { /* convert to double &amp; validate */\n                (*sol)-&gt;facet[(*sol)-&gt;nfacets].normal[i] = xstrtod (p, &amp;ep);\n                p = ep;\n            }\n            goto processed;\n        }\n        else if (strncmp (\"vertex\", line, ep - p) == 0) \n        {   /* read vertex values */\n            size_t i;\n            p = ep + 1;\n\n            for (i = 0; i &lt; NDIM; i++) { /* convert to double &amp; validate */\n                (*sol)-&gt;facet[(*sol)-&gt;nfacets].vertex[vidx][i] = xstrtod (p, &amp;ep);\n                p = ep;\n            }\n            vidx = vidx &lt; 2 ? vidx + 1 : 0; /* update/reset vertex index */\n            goto processed;\n        }\n        else if (strncmp (\"outer\", line, ep - p) == 0) {\n            goto processed;\n        }\n        else if (strncmp (\"endsolid\", line, ep - p) == 0) {\n            goto processed;\n        }\n        else { /* if any line not processed - warn of unrecognized line */\n            fprintf (stderr, \"read_solid() warning: invalid line at '%zu'\\n\", idx);\n        }\n    processed:\n        idx++;  /* update line index */\n    }\n\n    if (!(*sol)-&gt;nfacets) { /* if no facet data, free mem, return NULL */\n        fprintf (stderr, \"read_solid() error: no data read.\\n\");\n        free_solid (*sol);\n        return NULL;\n    }\n\n    return *sol;\n}\n\n/* simple allocate/initialize function\n * return must be assigned to pointer\n */\nsolid *create_solid ()\n{\n    size_t i;\n\n    solid *sol = calloc (1, sizeof *sol);\n    sol-&gt;facet = calloc (FACETS, sizeof *(sol-&gt;facet));\n    sol-&gt;nfacets = 0;\n    sol-&gt;maxfacets = FACETS;\n\n    for (i = 0; i &lt; FACETS; i++) {\n        memset ((sol-&gt;facet)[i].normal, 0, NDIM * sizeof (double));\n        memset ((sol-&gt;facet)[i].vertex, 0, NDIM * NDIM * sizeof (double));\n    }\n\n    return sol;\n}\n\n/* simple print of normals &amp; vertexes to stdout */\nvoid print_solid (solid *sol)\n{\n    if (!sol) {\n        fprintf (stderr, \"print_solid() error: invalid parameter 'sol'.\\n\");\n        return;\n    }\n\n    size_t n, i;\n\n    printf (\"\\nnormal and vertexes for solid: %s\\n\", sol-&gt;name);\n    for (n = 0; n &lt; sol-&gt;nfacets; n++) {\n        printf (\"\\n  normal[%3zu] : %10.4f  %10.4f  %10.4f\\n\", n,\n                sol-&gt;facet[n].normal[0], \n                sol-&gt;facet[n].normal[1],\n                sol-&gt;facet[n].normal[2]);\n        for (i = 0; i &lt; NDIM; i++)\n            printf (\"   vertex[%2zu] : %10.4f  %10.4f  %10.4f\\n\", i,\n                    sol-&gt;facet[n].vertex[i][0], \n                    sol-&gt;facet[n].vertex[i][1],\n                    sol-&gt;facet[n].vertex[i][2]);\n    }\n}\n\n/* free allocated memory */\nvoid free_solid (solid *sol)\n{\n    if (sol-&gt;name) free (sol-&gt;name);\n    if (sol-&gt;facet) free (sol-&gt;facet);\n    if (sol) free (sol);\n}\n\n/* string to double with error checking. */\ndouble xstrtod (char *str, char **ep)\n{\n    errno = 0;\n\n    double val = strtod (str, ep);\n\n    /* Check for various possible errors */\n    if ((errno == ERANGE &amp;&amp; (val == HUGE_VAL || val == HUGE_VALL)) ||\n        (errno != 0 &amp;&amp; val == 0)) {\n        perror (\"strtod\");\n        exit (EXIT_FAILURE);\n    }\n\n    if (ep &amp;&amp; *ep == str) {\n        fprintf (stderr, \"No digits were found\\n\");\n        exit (EXIT_FAILURE);\n    }\n\n    return val;\n}\n</code></pre>\n\n<p><strong>Compile (gcc)</strong></p>\n\n<pre><code>gcc -Wall -Wextra -O3 -o bin/readsolid readsolid.c\n</code></pre>\n\n<p><strong>Use/Output</strong></p>\n\n<pre><code>$ ./bin/readsolid dat/solid.txt\n\nnormal and vertexes for solid: Untitled-56807ca1\n\n  normal[  0] :     0.0000      0.0000     -1.0000\n   vertex[ 0] :   100.0000     50.0000      0.0000\n   vertex[ 1] :     0.0000      0.0000      0.0000\n   vertex[ 2] :     0.0000     50.0000      0.0000\n\n  normal[  1] :     0.0000      0.0000     -1.0000\n   vertex[ 0] :     0.0000      0.0000      0.0000\n   vertex[ 1] :   100.0000     50.0000      0.0000\n   vertex[ 2] :   100.0000      0.0000      0.0000\n\n  normal[  2] :     1.0000      0.0000      0.0000\n   vertex[ 0] :     0.0000     50.0000     67.8050\n   vertex[ 1] :     0.0000      0.0000      0.0000\n   vertex[ 2] :     0.0000      0.0000     67.8050\n\n  normal[  3] :     1.0000      0.0000      0.0000\n   vertex[ 0] :     0.0000      0.0000      0.0000\n   vertex[ 1] :     0.0000     50.0000     67.8050\n   vertex[ 2] :     0.0000     50.0000      0.0000\n\n  normal[  4] :     0.0000      1.0000      0.0000\n   vertex[ 0] :     0.0000     50.0000     67.8050\n   vertex[ 1] :   100.0000     50.0000      0.0000\n   vertex[ 2] :     0.0000     50.0000      0.0000\n&lt;snip&gt;\n\n  normal[ 21] :     0.0000     -0.0000      1.0000\n   vertex[ 0] :    69.0000     15.5000    115.6740\n   vertex[ 1] :    31.0000     34.5000    115.6740\n   vertex[ 2] :    31.0000     15.5000    115.6740\n\n  normal[ 22] :     0.0000     -0.0000      1.0000\n   vertex[ 0] :    31.0000     34.5000    115.6740\n   vertex[ 1] :    69.0000     15.5000    115.6740\n   vertex[ 2] :    69.0000     34.5000    115.6740\n\n  normal[ 23] :     0.0000      0.8820      0.4713\n   vertex[ 0] :    50.0000     25.0000    133.4520\n   vertex[ 1] :    69.0000     34.5000    115.6740\n   vertex[ 2] :    31.0000     34.5000    115.6740\n</code></pre>\n\n<p><strong>Memory/Error Check</strong></p>\n\n<p>In any code your write that dynamically allocates memory, you have 2 responsibilites regarding any block of memory allocated: (1) always preserves a pointer to the starting address for the block of memory so, (2) it can be freed when it is no longer needed. It is imperative that you use a memory error checking program to insure you haven't written beyond/outside your allocated block of memory and to confirm that you have freed all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are so many subtle ways to misuse a block of memory that can cause real problems, there is no excuse not to do it. There are similar memory checkers for every platform. They are all simple to use. Just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/readsolid dat/solid.txt\n==4651== Memcheck, a memory error detector\n==4651== Copyright (C) 2002-2012, and GNU GPL'd, by Julian Seward et al.\n==4651== Using Valgrind-3.8.1 and LibVEX; rerun with -h for copyright info\n==4651== Command: ./bin/readsolid dat/solid.txt\n==4651==\n\nnormal and vertexes for solid: Untitled-56807ca1\n\n  normal[  0] :     0.0000      0.0000     -1.0000\n   vertex[ 0] :   100.0000     50.0000      0.0000\n   vertex[ 1] :     0.0000      0.0000      0.0000\n   vertex[ 2] :     0.0000     50.0000      0.0000\n&lt;snip&gt;\n==4651==\n==4651== HEAP SUMMARY:\n==4651==     in use at exit: 0 bytes in 0 blocks\n==4651==   total heap usage: 4 allocs, 4 frees, 3,690 bytes allocated\n==4651==\n==4651== All heap blocks were freed -- no leaks are possible\n==4651==\n==4651== For counts of detected and suppressed errors, rerun with: -v\n==4651== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)\n</code></pre>\n\n<p><strong>Note:</strong> this example ended up longer than I originally envisioned, but to provide adequate validation for any relatively sophisticated set of data, it will take a little bit of code to get it done correctly. Good luck.</p>\n"}], "owner": {"reputation": 1, "user_id": 5729224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fBTaU.jpg?s=128&g=1", "display_name": "James E.", "link": "https://stackoverflow.com/users/5729224/james-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1451474680, "creation_date": 1451449129, "last_edit_date": 1451458439, "question_id": 34522831, "link": "https://stackoverflow.com/questions/34522831/scanf-stops-working-abruptly", "title": "Scanf stops working abruptly", "body": "<p>I'm trying to read data from an stl file, one character at a time using <code>scanf</code>/<code>fscanf</code>. I call <code>scanf</code> many times in my program, but input all the data at the first instance. It works perfectly for a while, but it seems like as soon as <code>scanf</code> is called the 1022nd or 1023rd time, the program stops and prompts for more input, even though there is plenty left to scan.</p>\n\n<p>I've written a program before that called <code>scanf</code> more than 40,000 times on one input, so I don't know what the deal is...</p>\n\n<p>It seems to stop working at the first <code>scanf</code> in <code>getnormal()</code> when <code>z == 7</code>;</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid getnormal(char[], double[]);\nvoid getvertices(char[], double[], int);\n\nint main (int argc, char *argv[]) {\n    unsigned char trash = 0;\n    int z = 0;\n\n    char num[20];\n    for (int i = 0; i &lt; 20; i++)\n        num[i] = 48;\n\n    double normal [3] = {0,0,0};\n    double vertices [9] = {0,0,0,0,0,0,0,0,0};\n\n    //FILE *in = fopen(argv[1], \"r\");\n    //FILE *out = fopen(argv[2], \"w\");\n\n    while (trash != '\\n')\n        scanf(\"%c\", &amp;trash);\n\n    while (1) {\n        getnormal(num, normal);\n        for (int i = 1; i &lt;= 3; i++)\n            getvertices(num, vertices, i);\n        z++;\n    }\n}\n\ndouble getnumber(char num[]) {\n    unsigned char trash = 0;\n\n    for (int i = 0; i &lt; 20; i++)\n        num[i] = 48;\n\n    scanf(\"%c\", &amp;trash);\n\n    for (int j = 0; trash != ' ' &amp;&amp; trash != '\\n'; j++) {\n        num[j] = trash;\n        scanf(\"%c\", &amp;trash);\n\n        if (trash == 'e') {\n            for (int h = 0; h &lt; 4; h++)\n                scanf(\"%c\", &amp;trash);\n            break;\n        }\n    }\n    return atof(num);\n}\n\nvoid getnormal(char num[], double normal[]) {\n    unsigned char trash = 0;\n\n    while (trash != 'm')\n        scanf(\"%c\", &amp;trash);\n    while (trash != 'l')\n        scanf(\"%c\", &amp;trash);\n\n    scanf(\"%c\", &amp;trash);\n\n    for (int i = 0; i &lt; 3; i++)\n        normal[i] = getnumber(num);\n\n    printf(\"\\nnormal:\");\n    for (int i = 0; i &lt; 3; i++)\n        printf(\" %f\", normal[i]);\n    printf(\"\\n\");\n}\n\nvoid getvertices(char num[], double vertices[], int vertex) {\n    unsigned char trash = 0;\n\n    vertex = (vertex-1) * 3;\n\n    while (trash != 'x')\n        scanf(\"%c\", &amp;trash);\n    scanf(\"%c\", &amp;trash);\n\n    for (int i = 0; i &lt; 3; i++)\n        vertices[vertex+i] = getnumber(num);\n\n    printf(\"vertex:\");\n    for (int i = 0; i &lt; 3; i++) {\n        printf(\" %f\", vertices[vertex+i]);\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>Here's the input:</p>\n\n<pre><code>solid Untitled-56807ca1\nfacet normal 0.0 0.0 -1.0\nouter loop\nvertex 100.0 50.0 0.0\nvertex 0.0 0.0 0.0\nvertex 0.0 50.0 0.0\nendloop\nendfacet\nfacet normal 0.0 0.0 -1.0\nouter loop\nvertex 0.0 0.0 0.0\nvertex 100.0 50.0 0.0\nvertex 100.0 0.0 0.0\nendloop\nendfacet\nfacet normal -1.0 0.0 0.0\nouter loop\nvertex 0.0 50.0 67.80499999999999\nvertex 0.0 0.0 0.0\nvertex 0.0 0.0 67.80499999999999\nendloop\nendfacet\nfacet normal -1.0 0.0 0.0\nouter loop\nvertex 0.0 0.0 0.0\nvertex 0.0 50.0 67.80499999999999\nvertex 0.0 50.0 0.0\nendloop\nendfacet\nfacet normal -0.0 1.0 0.0\nouter loop\nvertex 0.0 50.0 67.80499999999999\nvertex 100.0 50.0 0.0\nvertex 0.0 50.0 0.0\nendloop\nendfacet\nfacet normal -0.0 1.0 0.0\nouter loop\nvertex 100.0 50.0 0.0\nvertex 0.0 50.0 67.80499999999999\nvertex 100.0 50.0 67.80499999999999\nendloop\nendfacet\nfacet normal 1.0 0.0 0.0\nouter loop\nvertex 100.0 50.0 0.0\nvertex 100.0 0.0 67.80499999999999\nvertex 100.0 0.0 0.0\nendloop\nendfacet\nfacet normal 1.0 0.0 0.0\nouter loop\nvertex 100.0 0.0 67.80499999999999\nvertex 100.0 50.0 0.0\nvertex 100.0 50.0 67.80499999999999\nendloop\nendfacet\nfacet normal -0.0 -1.0 -0.0\nouter loop\nvertex 100.0 0.0 67.80499999999999\nvertex 0.0 0.0 0.0\nvertex 100.0 0.0 0.0\nendloop\nendfacet\nfacet normal -0.0 -1.0 -0.0\nouter loop\nvertex 0.0 0.0 0.0\nvertex 100.0 0.0 67.80499999999999\nvertex 0.0 0.0 67.80499999999999\nendloop\nendfacet\nfacet normal 0.8393626319551987 8.038371845750061e-18 0.5435718646851044\nouter loop\nvertex 100.0 50.0 67.80499999999999\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 100.0 0.0 67.80499999999999\nendloop\nendfacet\nfacet normal 0.8393626319551987 8.038371845750061e-18 0.5435718646851044\nouter loop\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 100.0 50.0 67.80499999999999\nvertex 68.99999999999989 34.49999999999993 115.67399999999996\nendloop\nendfacet\nfacet normal -0.8393626319552003 -1.4889432537737797e-17 0.5435718646851019\nouter loop\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nvertex 0.0 50.0 67.80499999999999\nvertex 0.0 0.0 67.80499999999999\nendloop\nendfacet\nfacet normal -0.8393626319552003 -1.4889432537737797e-17 0.5435718646851019\nouter loop\nvertex 0.0 50.0 67.80499999999999\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nendloop\nendfacet\nfacet normal -5.5971483140148576e-18 -0.9513689920122365 0.30805363337837904\nouter loop\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 0.0 0.0 67.80499999999999\nvertex 100.0 0.0 67.80499999999999\nendloop\nendfacet\nfacet normal -5.5971483140148576e-18 -0.9513689920122365 0.30805363337837904\nouter loop\nvertex 0.0 0.0 67.80499999999999\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nendloop\nendfacet\nfacet normal 9.646494768713815e-18 0.9513689920122359 0.30805363337838126\nouter loop\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nvertex 100.0 50.0 67.80499999999999\nvertex 0.0 50.0 67.80499999999999\nendloop\nendfacet\nfacet normal 9.646494768713815e-18 0.9513689920122359 0.30805363337838126\nouter loop\nvertex 100.0 50.0 67.80499999999999\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nvertex 68.99999999999989 34.49999999999993 115.67399999999996\nendloop\nendfacet\nfacet normal 0.0 -0.8819736246769688 0.47129876445219904\nouter loop\nvertex 49.99999999999989 24.99999999999994 133.45199999999997\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nendloop\nendfacet\nfacet normal 0.6832351395351168 5.963605871623595e-18 0.7301984278978073\nouter loop\nvertex 68.99999999999989 34.49999999999993 115.67399999999996\nvertex 49.99999999999989 24.99999999999994 133.45199999999997\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nendloop\nendfacet\nfacet normal -0.6832351395351168 5.963605871623845e-18 0.7301984278978073\nouter loop\nvertex 49.99999999999989 24.99999999999994 133.45199999999997\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nendloop\nendfacet\nfacet normal -0.0 -0.0 1.0\nouter loop\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nvertex 30.9999999999999 15.49999999999995 115.67399999999996\nendloop\nendfacet\nfacet normal -0.0 -0.0 1.0\nouter loop\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nvertex 68.99999999999989 15.49999999999995 115.67399999999996\nvertex 68.99999999999989 34.49999999999993 115.67399999999996\nendloop\nendfacet\nfacet normal -0.0 0.8819736246769686 0.47129876445219915\nouter loop\nvertex 49.99999999999989 24.99999999999994 133.45199999999997\nvertex 68.99999999999989 34.49999999999993 115.67399999999996\nvertex 30.9999999999999 34.49999999999993 115.67399999999996\nendloop\nendfacet\nendsolid Untitled-56807ca1\n</code></pre>\n\n<p>Here's the output:</p>\n\n<pre><code>normal: 0.000000 0.000000 -1.000000\nvertex: 100.000000 50.000000 0.000000\nvertex: 0.000000 0.000000 0.000000\nvertex: 0.000000 50.000000 0.000000\n\nnormal: 0.000000 0.000000 -1.000000\nvertex: 0.000000 0.000000 0.000000\nvertex: 100.000000 50.000000 0.000000\nvertex: 100.000000 0.000000 0.000000\n\nnormal: -1.000000 0.000000 0.000000\nvertex: 0.000000 50.000000 67.805000\nvertex: 0.000000 0.000000 0.000000\nvertex: 0.000000 0.000000 67.805000\n\nnormal: -1.000000 0.000000 0.000000\nvertex: 0.000000 0.000000 0.000000\nvertex: 0.000000 50.000000 67.805000\nvertex: 0.000000 50.000000 0.000000\n\nnormal: -0.000000 1.000000 0.000000\nvertex: 0.000000 50.000000 67.805000\nvertex: 100.000000 50.000000 0.000000\nvertex: 0.000000 50.000000 0.000000\n\nnormal: -0.000000 1.000000 0.000000\nvertex: 100.000000 50.000000 0.000000\nvertex: 0.000000 50.000000 67.805000\nvertex: 100.000000 50.000000 67.805000\n\nnormal: 1.000000 0.000000 0.000000\nvertex: 100.000000 50.000000 0.000000\nvertex: 100.000000 0.000000 67.805000\nvertex: 100.000000 0.000000 0.000000\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451448346, "post_id": 34522728, "comment_id": 56786997, "body": "Could you be more specific? Does it lag? Crash (then provide error message)? See how to write a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to post minimal but only relevant code."}, {"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 2, "creation_date": 1451448456, "post_id": 34522728, "comment_id": 56787028, "body": "On a completely different note, the use of <code>goto</code> when its outcome isn&#39;t absurdly obvious is generally not recommended. Here, it might not be a problem. But most people won&#39;t recommend getting into a habit of using it too much."}, {"owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "reply_to_user": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451448671, "post_id": 34522728, "comment_id": 56787082, "body": "I doesn&#39;t lag or crush. When I pass my turn Program says Dealers Cards: and executes some -number varies- system(&quot;pause&quot;)&#39;s  then closes."}, {"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451448799, "post_id": 34522728, "comment_id": 56787121, "body": "Perhaps you could <a href=\"https://stackoverflow.com/posts/34522728/edit\">edit</a> your post, remove the unnecessary code, and include sample output."}, {"owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "reply_to_user": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451449948, "post_id": 34522728, "comment_id": 56787406, "body": "Won&#39;t let me edit. Says there is too much code for what I wrote. Anyways faulty part is probably when you pass your turn. But I couldn&#39;t see what wrong with it. I removed the system(&quot;pause&quot;) from game() function and now it just closes when I try to pass my turn but only sometimes."}, {"owner": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451450058, "post_id": 34522728, "comment_id": 56787428, "body": "StackOverflow automatically prevents you from posting questions in a high code to text ratio to avoid code only questions. Only post the problematic code and the last couple lines of output."}, {"owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "reply_to_user": {"reputation": 4186, "user_id": 2773311, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wIGqo.png?s=128&g=1", "display_name": "Arc676", "link": "https://stackoverflow.com/users/2773311/arc676"}, "edited": false, "score": 0, "creation_date": 1451450628, "post_id": 34522728, "comment_id": 56787612, "body": "High use of gotos seems to mess with my code. So I took a different route and seems like it worked. Thanks for your time."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "edited": false, "score": 0, "creation_date": 1451554087, "post_id": 34523335, "comment_id": 56829862, "body": "Thanks after I made my program &quot;goto&quot; clean and changed the things you pointed out it worked without any problems."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 2, "last_activity_date": 1451452652, "creation_date": 1451452652, "answer_id": 34523335, "question_id": 34522728, "link": "https://stackoverflow.com/questions/34522728/my-c-blackjack-program-got-stuck/34523335#34523335", "title": "My C Blackjack program got stuck", "body": "<p>You have the following problems in your code that I could see from compiler warnings/errors.</p>\n\n<ol>\n<li><p>The declaration of <code>printCard</code> does not match its usage and its implementation. Change the declaration to:</p>\n\n<pre><code>void printCard(int cardvalue, int cardtype);\n</code></pre></li>\n<li><p>Make the return type of <code>main</code> explicit. Change it to:</p>\n\n<pre><code>int main () ...\n</code></pre></li>\n<li><p>Change the lines that print <code>K</code>, <code>J</code>, and <code>Q</code>. You don't need the additional argument to <code>printf</code> in those lines.</p>\n\n<pre><code>printf(\"*   K *\\n\");\nprintf(\"*   J *\\n\");\nprintf(\"*   Q *\\n\");\n</code></pre></li>\n</ol>\n\n<p>Of the above, the first one is the most crucial fix. With those changes, I was able to run your program without any problem. My test platform: Linux, gcc 4.8.4.</p>\n\n<p>Increase your warning level so you can detect such warnings/errors and fix them in future programming efforts.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "edited": false, "score": 0, "creation_date": 1451553992, "post_id": 34523854, "comment_id": 56829812, "body": "Thank you for the tips. I did actually rewrote the entire game function to not use any goto&#39;s and when I realized -as you said- my endProgram() wasn&#39;t ending enything I used exit(EXIT_SUCCESS) instead of system(&quot;pause&quot;). system(&quot;cls&quot;) was there to keep command screen clean everytime player wanted to play. I was able to split dealers turn from the game() function but because I had a very limited time didn&#39;t do  the same for the players turn. It&#39;s so encouraging to see people take their time to actually help you so thanks."}], "tags": [], "owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "is_accepted": false, "score": 1, "last_activity_date": 1451455557, "creation_date": 1451455557, "answer_id": 34523854, "question_id": 34522728, "link": "https://stackoverflow.com/questions/34522728/my-c-blackjack-program-got-stuck/34523854#34523854", "title": "My C Blackjack program got stuck", "body": "<p>Since you asked... :-)</p>\n\n<p>In addition to what R Sahu called out...</p>\n\n<p>The biggest problem (challenge?) I noticed is that I don't see how your endProgram() function actually 'ends' anything.  It calls system(\"pause\") and then resumes:</p>\n\n<pre><code>void endProgram()\n{\n    printf(\"Thanks for playing my blackjack game! The results are:\\n\");\n    printf(\"Player won %d times!\\n\", playerwin);\n    printf(\"Dealer won %d times!\\n\", dealerwin);\n    printf(\"There have been a tie %d times!\\n\", tie);\n    system(\"pause);\n}\n</code></pre>\n\n<p>Which means code like the following in the pickCard() function has unpredictable behavior:</p>\n\n<pre><code>int pickCard(Deck deck, int cardnum)\n{\n    if (cardnumber == 52)\n    {\n        printf(\"There is not enough cards left to complete the game!\");\n        endProgram(); // once we get here what do we return to the caller?\n    }\n    else\n        return deck[cardnum];\n}\n</code></pre>\n\n<p>By \"unpredictable\" I specifically mean: What will pickCard() return to for cardnumber = 52 ?</p>\n\n<p>I <i>suspect</i> pickCard() is going to call endProgram(), whch being a void function won't do anything but return, then pickCard will fall out of the if-else statement and try to return an integer to the caller, and it will probably be choosing some garbage off the call stack to send back which may (or may not) be a valid card value.</p>\n\n<p>It turns out you call pickCard() in roughly 5 different places, sometimes for the player, sometimes the dealer.</p>\n\n<p>What happens to that logic if pickCard() returns a value that is <i>way</i> out of bounds?</p>\n\n<p>Since you only call shuffleDeck() once at the beginning of main(), eventually you're going to 'exhaust' the deck and get an undefined card value returned from pickCard().</p>\n\n<p>Which kind of fits your symptoms of \"it breaks in Dealer after <i>a while</i>...\".</p>\n\n<p>So... for general cleanup...</p>\n\n<p>I would take most the variables you have in the game() method and make them globals.</p>\n\n<p>I would add a LOT of print statements for debugging so you can verify the code is doing what you think it will do.</p>\n\n<p>Your calls to system() are a challenge for me on the linux side of the fence:</p>\n\n<pre><code>system(\"cls\");\nsystem(\"pause\");\n</code></pre>\n\n<p>Since you're devleoping on Windows I understand why you are using system (reminds me of the ancient days when I used to write dos batch files).</p>\n\n<p>But...  I would <i>encourage</i> you to ditch the system() calls and write your own input \"helper\" function that deals with scanf_s or whatever you want to use.\nMaybe something like this that can take a prompt and return whatever character the user types.</p>\n\n<p>char prompt_and_read_char( char *msg );</p>\n\n<p>I would encourage you to rewrite without goto statements.</p>\n\n<p>You do attempt a loop in the game() function for the player to draw cards; the for loop, so bonus points for that.</p>\n\n<p>Your overall style and user interaction goals are sound and suggest you'll eventually make a fun game.</p>\n\n<p>The code in game() is a bit over 200 lines of code, which makes it is harder than it needs to be to read.</p>\n\n<p>I would suggest doing something like this in game() function: the goal is to push all card-drawing into functions just for the player, or the dealer.</p>\n\n<pre><code>// Global Variable definitions...\nint gameInProcess = 0; // global, set to false.\nint tcvp = -1; // obvious bad \n// note for global-var police: yeah, I know globals is not \"good style\".\n// But cut our beginning programmer some slack here... this seems like the easiest way for\n// them to get their game running.  (Think of it as a first step toward cleaning up the\n// game() method if that helps any).\n\n// prototypes here.\n\n// main() here.\n...etc...\n\nint game() {\n   gameInProcess = 1; // set to true.\n   tcvp = 0;\n   tcvd = 0;\n   while( gameInProcess  ) {\n      // add plenty of print statements so you see what is going on; you can clean\n      //  them up later by searching on DEBUG.\n      printf(\"DEBUG... game(): tcvp=%d tcvd=%d cardnumber=%d\\n\", tcvp, tcvd, cardnumber );\n      game_playerDraws( ); // updates tcvp, may set gameInProcess to 0 if player win or busts.\n      game_dealerDraws( ); // udpates tcvd, may set gameInProcess to 0 if dealer hits blackjack or goes bust.\n      ...other functions for variations...\n   }\n   printf(\"game over, score: player=%d  dealer=%d\\n\", tcvp, tcvd );\n   // add logic to decide winner.\n   // return to caller, maybe let them decide if we'll have another game using the same deck.\n}\n\ngame_playerDraws( ) {\n   if( !gameInProcess ) {\n      printf(\"game_playerDraws(): gameInProcess=%d, nothing to do.\\n\", gameInProcess );\n      return;\n   }\n   // draw some cards, update globalcs if player wins or breaks.\n}\n\ngame_dealerDraws( ) {\n   ... do dealer-approriate things...\n}\n</code></pre>\n\n<p>The upside of this is if you exahust the deck, you can just set gameInProcess = 0; and return and everything gracefully stops.</p>\n\n<p>You might add an option to shuffle a new deck and start another game.</p>\n\n<p>But the big advantage is it will give you a clean way to start and end each game, which is something you're missing in the current version of the code.</p>\n\n<p>Good luck. You clearly enjoy programming and are having fun with the writing game.\nStick with it, I think you'll learn a lot.</p>\n"}], "owner": {"reputation": 17, "user_id": 5482817, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-m1cuHZTCHkw/AAAAAAAAAAI/AAAAAAAAAB4/hRag2zrGEyI/photo.jpg?sz=128", "display_name": "Kubilay Do\u011fru", "link": "https://stackoverflow.com/users/5482817/kubilay-do%c4%9fru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "closed_date": 1451462265, "accepted_answer_id": 34523335, "answer_count": 2, "score": -3, "last_activity_date": 1451455557, "creation_date": 1451448148, "question_id": 34522728, "link": "https://stackoverflow.com/questions/34522728/my-c-blackjack-program-got-stuck", "closed_reason": "Not suitable for this site", "title": "My C Blackjack program got stuck", "body": "<pre><code>#include&lt;stdlib.h&gt;  \n#include&lt;stdio.h&gt;\n#include&lt;time.h&gt;\n\n#define CARD_MAX 52\ntypedef int Deck[CARD_MAX];\nDeck deck;\nint cardnumber = 0;\nint playerwin = 0, dealerwin = 0, tie = 0;\n\nint game();\nvoid setupDeck(Deck deck);\nvoid shuffleDeck(Deck deck);\nvoid printCard(int card);\nint pickCard(Deck deck, int cardnum);\nvoid endProgram();\nvoid playAgain();\n\nmain()\n{\n    char yn;\n\n    srand(time(NULL));\n    setupDeck(deck);\n    shuffleDeck(deck);\n\n    again:\n    printf(\"Welcome! Do you wanna try your luck in a Blackjack Game? If so type 'y'.\\n\");\n    printf(\"If not type 'n' to close the program: \");\n    scanf_s(\"%c\", &amp;yn);\n    getchar();\n\n    if (yn == 'y')\n        game();\n\n    else if (yn == 'n')\n    {\n        printf(\"Looks like you aren't feeling lucky today! Comeback tomorrow!\\n\");\n        system(\"pause\");\n    }\n    else\n    {\n        printf(\"Unknown character! Try again!\\n\");\n        goto again;\n    }\n\n\n}\n\nint game()\n{\n    int card, cardvalue = 0, cardtype = 0, tcvp = 0, tcvd = 0;\n    int aceflagp = 0, faceflagp = 0, aceflagd = 0, faceflagd = 0, bjp = 0, bjd = 0;\n    int loopcounter;\n    char hitorpass;\n\n    system(\"cls\");\n    printf(\"Your cards:\\n\");\n    for (loopcounter = 0; loopcounter &lt; 2; loopcounter++)\n    {\n        card = pickCard(deck, cardnumber);\n        cardnumber++;\n        cardvalue = card % 13;\n        cardtype = card / 13;\n        printCard(cardvalue, cardtype);\n        if (cardvalue == 1)\n        {\n            aceflagp++;\n            cardvalue = 11;\n        }\n        else if (cardvalue == 0 || cardvalue == 11 || cardvalue == 12)\n        {\n            faceflagp = 1;\n            cardvalue = 10;\n        }\n        else\n            cardvalue = cardvalue;\n\n        tcvp += cardvalue;\n    }\n    if (aceflagp == 1 &amp;&amp; faceflagp == 1)\n        bjp = 1;\n\n    printf(\"Dealers cards:\\n\");\n\n    card = pickCard(deck, cardnumber);\n    cardnumber++;\n    cardvalue = card % 13;\n    cardtype = card / 13;\n    printCard(cardvalue, cardtype);\n    if (cardvalue == 1)\n    {\n        aceflagd++;\n        cardvalue = 11;\n    }\n    else if (cardvalue == 0 || cardvalue == 11 || cardvalue == 12)\n    {\n        faceflagd = 1;\n        cardvalue = 10;\n    }\n    else\n        cardvalue = cardvalue;\n\n    tcvd += cardvalue;\n\n    card = pickCard(deck, cardnumber);\n    cardnumber++;\n    cardvalue = card % 13;\n    cardtype = card / 13;\n    if (cardvalue == 1)\n    {\n        aceflagd++;\n        cardvalue = 11;\n    }\n    else if (cardvalue == 0 || cardvalue == 11 || cardvalue == 12)\n    {\n        faceflagd = 1;\n        cardvalue = 10;\n    }\n    else\n        cardvalue = cardvalue;\n\n    tcvd += cardvalue;\n\n    if (aceflagd == 1 &amp;&amp; faceflagd == 1)\n        bjd = 1;\n\n    if (bjp == 1 &amp;&amp; bjd == 1)\n    {\n        printf(\"Both sides has Blackjack! Tie!\\n\");\n        tie++;\n        playAgain();\n    }\n    else if (bjp == 1)\n    {\n        printf(\"Player Blackjack!\\n\");\n        playerwin++;\n        playAgain();\n    }\n    else if (bjd == 1)\n    {\n        printf(\"Dealer Blackjack!\\n\");\n        dealerwin++;\n        playAgain();\n    }\n    printf(\"Your card total is %d.\\n\", tcvp);\n    again:\n    printf(\"If you want to hit type 'h'. If you want to pass type 'p'\");\n    scanf_s(\"%c\", &amp;hitorpass);\n    getchar();\n\n    if (hitorpass == 'h')\n    {\n        card = pickCard(deck, cardnumber);\n        cardnumber++;\n        cardvalue = card % 13;\n        cardtype = card / 13;\n        printCard(cardvalue, cardtype);\n        if (cardvalue == 1)\n        {\n            aceflagp++;\n            cardvalue = 11;\n        }\n        else if (cardvalue == 0 || cardvalue == 11 || cardvalue == 12)\n        {\n            faceflagp = 1;\n            cardvalue = 10;\n        }\n        else\n            cardvalue = cardvalue;\n\n        tcvp += cardvalue;\n        if (tcvp &gt; 21)\n        {\n            if (aceflagp &gt; 0)\n            {\n                tcvp -= 10;\n                aceflagp--;\n                printf(\"Your card total is %d.\\n\", tcvp);\n                goto again;\n            }\n            else\n            {\n                printf(\"Your hand busted. You lost!\\n\");\n                dealerwin++;\n                playAgain();\n            }\n        }\n        else if (tcvp == 21)\n        {\n            printf(\"You have 21 in your hand can't hit more!\\n\");\n            goto dealersturn;\n        }\n        else if (tcvp &lt; 21)\n        {\n            printf(\"Your card total is %d.\\n\", tcvp);\n            goto again;\n        }\n\n    }\n    else if (hitorpass == 'p')\n    {\n    dealersturn:\n        printf(\"Dealers turn:\\n\");\n        if (tcvd &lt; 17)\n        {\n            card = pickCard(deck, cardnumber);\n            cardnumber++;\n            cardvalue = card % 13;\n            cardtype = card / 13;\n            printCard(cardvalue, cardtype);\n            if (cardvalue == 1)\n            {\n                aceflagd++;\n                cardvalue = 11;\n            }\n            else if (cardvalue == 0 || cardvalue == 11 || cardvalue == 12)\n            {\n                faceflagd = 1;\n                cardvalue = 10;\n            }\n            else\n                cardvalue = cardvalue;\n\n            tcvd += cardvalue;\n            if (tcvd &gt; 21)\n            {\n                if (aceflagd &gt; 0)\n                {\n                    tcvd -= 10;\n                    aceflagd--;\n                    goto dealersturn;\n                }\n                else\n                {\n                    printf(\"Dealers has a total of %d. Dealers hand busted!\\n\", tcvd);\n                    playerwin++;\n                    playAgain();\n                }\n            }\n            else if (tcvd &lt; 17)\n                goto dealersturn;\n            else\n            {\n                if (tcvp &gt; tcvd)\n                {\n                    printf(\"Player has %d, dealer has %d. Player won!\", tcvp, tcvd);\n                    playerwin++;\n                    playAgain();\n                }\n                else if (tcvp == tcvd)\n                {\n                    printf(\"Both player and the dealer has %d. Tie!\", tcvd);\n                    tie++;\n                    playAgain();\n                }\n                else\n                {\n                    printf(\"Player has %d, dealer has %d. Dealer won!\", tcvp, tcvd);\n                    dealerwin++;\n                    playAgain();\n                }\n            }\n        }\n    }\n    else\n    {\n        printf(\"Unknown character. Try again!\");\n        goto again;\n    }\n\n    system(\"pause\");\n}\n\nvoid endProgram()\n{\n    printf(\"Thanks for playing my blackjack game! The results are:\\n\");\n    printf(\"Player won %d times!\\n\", playerwin);\n    printf(\"Dealer won %d times!\\n\", dealerwin);\n    printf(\"There have been a tie %d times!\\n\", tie);\n    system(\"pause\");\n}\n\nvoid playAgain()\n{\n    char chardummy;\n    again:\n    printf(\"Would you like to play again? Type 'y' for Yes and 'n' for No.\\n\");\n    scanf_s(\"%c\", &amp;chardummy);\n    getchar();\n    if (chardummy == 'y')\n    {\n        if (cardnumber &gt;= 48)\n        {\n            printf(\"There is not enough card left in the deck!\");\n            endProgram();\n        }\n        else\n            game();\n    }\n    else if (chardummy == 'n')\n        endProgram();\n    else\n    {\n        printf(\"Unknown character. Try again!\");\n        goto again;\n    }\n}\n\nvoid setupDeck(Deck deck)\n{\n    int i;\n    for (i = 0; i&lt;CARD_MAX; i++)\n    {\n        deck[i] = i;\n    }\n}\n\nvoid shuffleDeck(Deck deck)\n{\n    for (int i = 52 - 1; i &gt;= 0; --i) {\n        int r = rand() % (i + 1);\n        int t = deck[i];\n        deck[i] = deck[r];\n        deck[r] = t;\n    }\n}\n\nvoid printCard(int cardvalue, int cardtype)\n{\n    char cardtype2;\n\n\n    if (cardtype == 0)\n        cardtype2 = 'C';\n    else if (cardtype == 1)\n        cardtype2 = 'D';\n    else if (cardtype == 2)\n        cardtype2 = 'H';\n    else if (cardtype == 3)\n        cardtype2 = 'S';\n\n    switch (cardvalue)\n{\n    case 0:\n    {\n        printf(\"*******\\n\");\n        printf(\"*     *\\n\");\n        printf(\"* %c   *\\n\", cardtype2);\n        printf(\"*   K *\\n\", cardvalue);\n        printf(\"*     *\\n\");\n        printf(\"*******\\n\");\n        break;\n    }\n    case 1:\n    {\n        printf(\"*******\\n\");\n        printf(\"*     *\\n\");\n        printf(\"* %c   *\\n\", cardtype2);\n        printf(\"*   A *\\n\");\n        printf(\"*     *\\n\");\n        printf(\"*******\\n\");\n        break;\n    }\n    case 2:\n    case 3:\n    case 4:\n    case 5:\n    case 6:\n    case 7:\n    case 8:\n    case 9:\n    case 10:\n    {\n        printf(\"*******\\n\");\n        printf(\"*     *\\n\");\n        printf(\"* %c   *\\n\", cardtype2);\n        printf(\"*  %2d *\\n\", cardvalue);\n        printf(\"*     *\\n\");\n        printf(\"*******\\n\");\n        break;\n    }\n    case 11:\n    {\n        printf(\"*******\\n\");\n        printf(\"*     *\\n\");\n        printf(\"* %c   *\\n\", cardtype2);\n        printf(\"*   J *\\n\", cardvalue);\n        printf(\"*     *\\n\");\n        printf(\"*******\\n\");\n        break;\n    }\n    case 12:\n    {\n        printf(\"*******\\n\");\n        printf(\"*     *\\n\");\n        printf(\"* %c   *\\n\", cardtype2);\n        printf(\"*   Q *\\n\", cardvalue);\n        printf(\"*     *\\n\");\n        printf(\"*******\\n\");\n        break;\n    }\n    }\n}\n\nint pickCard(Deck deck, int cardnum)\n{\n    if (cardnumber == 52)\n    {\n        printf(\"There is not enough cards left to complete the game!\");\n        endProgram();\n    }\n    else\n        return deck[cardnum];\n\n}\n</code></pre>\n\n<p>Here is my code for a simple blackjack game. For some reason after some rounds Dealers turn does not work. I would be gratefull if you could find the reason as I couldn't. And feel free to give tips about improving my code.</p>\n"}, {"tags": ["c", "stdio"], "comments": [{"owner": {"reputation": 6091, "user_id": 933198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25a22103fd3210fdfa142843c7777ff1?s=128&d=identicon&r=PG", "display_name": "Lee Taylor", "link": "https://stackoverflow.com/users/933198/lee-taylor"}, "edited": false, "score": 0, "creation_date": 1451445874, "post_id": 34522474, "comment_id": 56786493, "body": "Can you not remove the compiled version of the library (.lib) so that it won&#39;t compile/link?"}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 6091, "user_id": 933198, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/25a22103fd3210fdfa142843c7777ff1?s=128&d=identicon&r=PG", "display_name": "Lee Taylor", "link": "https://stackoverflow.com/users/933198/lee-taylor"}, "edited": false, "score": 0, "creation_date": 1451446025, "post_id": 34522474, "comment_id": 56786526, "body": "@LeeTaylor I&#39;d prefer to not tamper with the compilation environment, which is used for other things which include this library (and those things are free to include stdio.h if they wish).  I&#39;m looking for something less intrusive than using the method I was trying and adding <code>-fno-builtin</code>...e.g. something that can be done inside the source alone."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1451446052, "post_id": 34522474, "comment_id": 56786534, "body": "Redefine types/structs rather than functions."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1451446557, "post_id": 34522474, "comment_id": 56786629, "body": "Could you <code>#define printf dont_include_stdio_h</code> (or <code>#define printf _Static_assert(0, &quot;Do not include stdio.h&quot;)</code>)?"}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1451449806, "post_id": 34522474, "comment_id": 56787365, "body": "@Cornstalks I didn&#39;t think of #define because is that I feared it wouldn&#39;t give a noticeable message...but by making it into junk as `#define printf $dont_include_stdio_h$ it properly messes things up in a way that is a good enough alarm.  I&#39;d take that as an answer..."}], "answers": [{"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 1, "creation_date": 1451450110, "post_id": 34522920, "comment_id": 56787448, "body": "Nice... though the issue with that would be that it would only stop the inclusions if this inclusion were <i>after</i> stdio.h.  I&#39;d like to preempt it if this header were included before, too..."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 2, "last_activity_date": 1451449822, "creation_date": 1451449822, "answer_id": 34522920, "question_id": 34522474, "link": "https://stackoverflow.com/questions/34522474/prevent-inclusion-of-stdio-h-or-other-standard-header/34522920#34522920", "title": "Prevent inclusion of stdio.h (or other standard header)", "body": "<p>To prevent inclusion of <code>&lt;stdio.h&gt;</code>, I would go with</p>\n\n<pre><code>#if !defined(NDEBUG)\n#if defined(EOF)\n#error Do not include stdio.h, contact Joe for more information\n#endif\n#endif\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "is_accepted": true, "score": 6, "last_activity_date": 1451457189, "last_edit_date": 1451457189, "creation_date": 1451450522, "answer_id": 34522999, "question_id": 34522474, "link": "https://stackoverflow.com/questions/34522474/prevent-inclusion-of-stdio-h-or-other-standard-header/34522999#34522999", "title": "Prevent inclusion of stdio.h (or other standard header)", "body": "<p>You can redefine <code>printf</code> to be some nasty value that will cause a compilation or linking error. For example:</p>\n\n<pre><code>#define printf do_not_include_stdio_h\n#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(\"Hello, world!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/BXdiwq\" rel=\"nofollow\">produces the output</a>:</p>\n\n<blockquote>\n  <p><code>undefined reference to `do_not_include_stdio_h'</code></p>\n</blockquote>\n\n<p>You can munge the macro if you want it to be an even more obscure name or include invalid symbols if you're worried that some poor soul will have defined <code>do_not_include_stdio_h</code>.</p>\n\n<p>You can set the macro definition in the compiler flags so you don't have to manually edit the file(s). For example:</p>\n\n<pre><code>gcc -Dprintf=do_not_include_stdio_h my_file.c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1451480173, "post_id": 34523450, "comment_id": 56801129, "body": "The problem with grepping like this (beyond being invasive to the makefiles which I&#39;d rather avoid as they are generated by yet another process) is that then you have worries like what if it is in a comment, what if it&#39;s #ifdef&#39;d out and not applicable, etc.  There are some third-party files that are .c which have their own debug mode flags separate, so there&#39;d have to be exception lists, etc..."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1451512449, "post_id": 34523450, "comment_id": 56817779, "body": "Given a choice of being &quot;invasive&quot; on a makefile and being &quot;invasive&quot; on all of the compilation units (aka source files) in a project, I would choose the first.   Even in a complex project, the number of makefiles rarely exceeds the number of compilation units.   There are techniques to ensure custom handling within automatically generated makefiles, using make recursively, etc."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1451527872, "post_id": 34523450, "comment_id": 56822336, "body": "Reasonable, and thank you for the option, upvoted.  But for my particular case the better choice in the balance is to not touch makefiles..."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 3, "last_activity_date": 1451466974, "last_edit_date": 1451466974, "creation_date": 1451453378, "answer_id": 34523450, "question_id": 34522474, "link": "https://stackoverflow.com/questions/34522474/prevent-inclusion-of-stdio-h-or-other-standard-header/34523450#34523450", "title": "Prevent inclusion of stdio.h (or other standard header)", "body": "<p>I wouldn't touch the source files at all.   I'd modify the build script.   Much easier to maintain, and much easier to prevent people from circumventing the restriction (e.g. by changing the code which causes compilation to fail).</p>\n\n<p>For example, in a makefile, assuming you have an <code>all</code> target that build everything</p>\n\n<pre><code>all:\n\n   grep stdio *.h *.c\n   if [\"$?\" -eq 0 ]; then\n       echo \"Do not use stdio.  Contact Joe for info\"; exit 2;\n   fi\n\n   &lt;other stuff to do the build here&gt;\n</code></pre>\n\n<p>You can also do it on particular targets.  For example, if you have a target that compiles a .c file to produce a .o file, just check the .c file before compiling it.</p>\n\n<pre><code>  %.o : %.c\n\n       grep stdio $&lt;\n       if [\"$?\" -eq 0 ]; then\n           echo \"Do not use stdio.  Contact Joe for info\"; exit 2;\n       fi\n\n       $(CC) -c $(CFLAGS) $(CPPFLAGS) $&lt; -o $@\n</code></pre>\n\n<p>Your only problem now is what to do if you have someone who is determined to bypass your restriction (e.g. by <code>#include \"bypass.joe\"</code> where <code>bypass.joe</code> has an <code>#include &lt;stdio.h&gt;</code>).    For that, look up tools to generate dependencies (e.g. <code>gcc -MM</code>, <code>makedepend</code>, etc) and use that to set up a way to search all of the files your source files depend on.    If someone is that determined, also set protections on your makefiles so only you can edit them.</p>\n\n<p>EDIT:  If you have a tool set up to generate a dependency file, simply search that file for <code>stdio</code>.   If any compilation unit, directly or indirectly, includes <code>stdio.h</code> , then it will be listed in the dependency file.</p>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 34522999, "answer_count": 3, "score": 12, "last_activity_date": 1451466974, "creation_date": 1451445648, "question_id": 34522474, "link": "https://stackoverflow.com/questions/34522474/prevent-inclusion-of-stdio-h-or-other-standard-header", "title": "Prevent inclusion of stdio.h (or other standard header)", "body": "<p>A codebase I work with has historically tried--purposefully--to avoid dependencies on stdio.h creeping in.  It has its own print formatting and mechanisms, and those are what's supposed to be used instead of printf etc.</p>\n\n<p>But someone adds a dependency every so often that has to get noticed and taken out.  So I tried to make an alarm for the easiest of cases:</p>\n\n<pre><code>#if !defined(NDEBUG)\n   void printf(float dont_link_with_stdio_h);\n#endif\n</code></pre>\n\n<p>The gcc people seem to have been thinking along the lines of stopping easy errors too, because there's a helpful message if you do this...whether you've included <code>&lt;stdio.h&gt;</code> or not.</p>\n\n<blockquote>\n  <p>conflicting types for built-in function 'printf'</p>\n</blockquote>\n\n<p>There's a way to turn this warning off (<code>-fno-builtin</code>).  And there are all kinds of approaches that would do things like filter the symbol dump for things you don't want to be there...</p>\n\n<p>But is there a trivially easy non-warning-causing (if you didn't include stdio.h) way to alert someone that they've introduced an unwanted printf usage?</p>\n"}, {"tags": ["c", "pointers", "structure", "function-pointers"], "comments": [{"owner": {"reputation": 6362, "user_id": 691156, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dbdb4615e500003f3296669253c45367?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/691156/martin"}, "edited": false, "score": 1, "creation_date": 1451440872, "post_id": 34521881, "comment_id": 56785322, "body": "This should not compile.. Is this the code you&#39;re running to print 0?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1451441164, "post_id": 34521881, "comment_id": 56785389, "body": "It looks like there are some inconsistencies:  (1) is the struct <code>mons_</code> or <code>monster_</code>?  You need to use the same name (2) Did you want <code>print</code> or <code>printf</code>?  (3) add a newline <code>\\n</code> to the end of the format string.  (4) Fix indentation, it&#39;s painful to read like this."}, {"owner": {"reputation": 11, "user_id": 5683224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502e007ea06283215b14cd72b7f3c5e0?s=128&d=identicon&r=PG&f=1", "display_name": "felle", "link": "https://stackoverflow.com/users/5683224/felle"}, "edited": false, "score": 0, "creation_date": 1451441274, "post_id": 34521881, "comment_id": 56785421, "body": "You are right, I only copied out the bits that I thought there were errors in. I changed it and copied most of the code from my c.file now instead."}, {"owner": {"reputation": 6362, "user_id": 691156, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dbdb4615e500003f3296669253c45367?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/691156/martin"}, "edited": false, "score": 2, "creation_date": 1451441348, "post_id": 34521881, "comment_id": 56785440, "body": "I compiled your code and it printed 100 for me -- how are you compiling it?"}, {"owner": {"reputation": 6362, "user_id": 691156, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dbdb4615e500003f3296669253c45367?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/691156/martin"}, "edited": false, "score": 0, "creation_date": 1451441373, "post_id": 34521881, "comment_id": 56785451, "body": "<a href=\"http://ideone.com/UCNxQ1\" rel=\"nofollow noreferrer\">ideone.com/UCNxQ1</a>"}, {"owner": {"reputation": 11, "user_id": 5683224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502e007ea06283215b14cd72b7f3c5e0?s=128&d=identicon&r=PG&f=1", "display_name": "felle", "link": "https://stackoverflow.com/users/5683224/felle"}, "edited": false, "score": 0, "creation_date": 1451441503, "post_id": 34521881, "comment_id": 56785499, "body": "I&#39;m new, not sure what answer you are looking for but I&#39;m compiling it on linux without any flags just gcc filename.c and then ./a.out"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1451441602, "post_id": 34521881, "comment_id": 56785532, "body": "try putting a \\n in your printf: printf(&quot;%d\\n&quot;, m-&gt;health);"}, {"owner": {"reputation": 11, "user_id": 5683224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502e007ea06283215b14cd72b7f3c5e0?s=128&d=identicon&r=PG&f=1", "display_name": "felle", "link": "https://stackoverflow.com/users/5683224/felle"}, "edited": false, "score": 0, "creation_date": 1451441749, "post_id": 34521881, "comment_id": 56785580, "body": "That didn&#39;t help, not sure why it would, but is the code working for you aswell?"}, {"owner": {"reputation": 197, "user_id": 3889933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3607796bc36a0d65f5c7083a11db730?s=128&d=identicon&r=PG&f=1", "display_name": "Marvin Wang", "link": "https://stackoverflow.com/users/3889933/marvin-wang"}, "edited": false, "score": 0, "creation_date": 1451443114, "post_id": 34521881, "comment_id": 56785926, "body": "Is any member in the monster_ struct right?"}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1451448813, "post_id": 34521881, "comment_id": 56787128, "body": "For me the code works fine. For indentation, use tabs. Put an &#39;\\n&#39; at the end of the print line."}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1451450810, "post_id": 34521881, "comment_id": 56787670, "body": "@felle: Adding a <code>\\n</code> at the end of the print statement will help if the terminal is overwriting your program&#39;s output (for example, the output <code>&quot;100&quot;</code> is overwritten by the prompt <code>&quot;&gt; &quot;</code>, meaning all you see is <code>&quot;&gt; 0&quot;</code>). Try setting <code>health</code> to different values, like <code>1234567890</code>, and see what it prints out. If you still see only <code>0</code>, then something wacky is happening."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451462392, "post_id": 34521881, "comment_id": 56791924, "body": "You are missing <code>#include &lt;stdio.h&gt;</code> and <code>#include &lt;stdlib.h&gt;</code> at the top.  With those lines present, the code should either output <code>100</code>, or nothing.  (To prevent the nothing case, change <code>&quot;%d&quot;</code> to <code>&quot;%d\\n&quot;</code>).   If you still have unexpected output, please make sure that the code in your question is <i>exactly</i> what you are compiling and running."}], "answers": [{"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 1, "last_activity_date": 1451889954, "creation_date": 1451889954, "answer_id": 34585986, "question_id": 34521881, "link": "https://stackoverflow.com/questions/34521881/loading-values-into-a-structure-pointer-inside-a-function/34585986#34585986", "title": "Loading values into a structure pointer inside a function", "body": "<p>You code works as expected on my computer. I suppose what you need is just the following two head files:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5683224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/502e007ea06283215b14cd72b7f3c5e0?s=128&d=identicon&r=PG&f=1", "display_name": "felle", "link": "https://stackoverflow.com/users/5683224/felle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1451889954, "creation_date": 1451440572, "last_edit_date": 1451441395, "question_id": 34521881, "link": "https://stackoverflow.com/questions/34521881/loading-values-into-a-structure-pointer-inside-a-function", "title": "Loading values into a structure pointer inside a function", "body": "<p>So I'm just trying to load some values into a structure and I can't get it to work. I'm new to C and pointers etc is still a little bit confusing, so I'm not really sure why this doesn't work.</p>\n\n<pre><code>struct monster_{\n  int health;\n  int power;\n  int x_position;\n  int y_position;\n };\n\n\nvoid allocate(struct monster_ **a); \nvoid init_monster(struct monster_ *a);\n\nint main(){\n\n  struct monster_ *m;\n  allocate(&amp;m);\n  init_monster(m);\n\n\n  printf(\"%d\", m-&gt;health);\n\n  return 0;\n}\nvoid allocate(struct monster_ **a){ \n\n *a=(void*)malloc(sizeof(struct monster_));\n\n\n}\nvoid init_monster(struct monster_ *a){\n\n  a-&gt;health = 100;\n  a-&gt;power = 90;\n  a-&gt;x_position = 25;\n  a-&gt;y_position = 90;\n\n\n\n}\n</code></pre>\n\n<p>So what I want to happen is that m->health by this point should print 100, but it only prints 0.</p>\n\n<p>EDITED: Earlier code was not really what was in my code. Here is what I actually used.</p>\n"}, {"tags": ["c", "language-lawyer"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1451446583, "post_id": 34521620, "comment_id": 56786632, "body": "short answer is Yes, the C standard guarantees this. Also the <code>volatile</code> qualifier for <code>discard</code> is not needed."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451445889, "post_id": 34521773, "comment_id": 56786496, "body": "Even without the negation, the expression has to be evaluated. That is exactly what <code>volatile</code> is for."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1451445906, "post_id": 34521773, "comment_id": 56786500, "body": "The value <i>is</i> accessed [even under c++] with just <code>*a;</code> [<i>because</i> it&#39;s <code>volatile</code>] and <code>foo2</code> generates less code than <code>foo1</code> on my setup.  If you build <i>without</i> <code>volatile</code>, both functions become nops"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1451446115, "post_id": 34521773, "comment_id": 56786545, "body": "@CraigEstey: No wonder <code>foo1</code> generates more code, as it has to to perform both: the read and the write."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451447027, "post_id": 34521773, "comment_id": 56786716, "body": "@Olaf Yes. I generated all forms (and did x64 [by mistake] until I saw the code difference, then added -m32) and even did clang and c++/clang++.  All are about the same.  I&#39;ve seen the <code>*a;</code> before in other R/T code for just the same purpose (e.g. must access the word but don&#39;t care about value)--I believe I&#39;ve even written code for similar H/W. In this instance, the memory area [page] policy would need to be [as you mentioned] non-cached [for this code to be useful]. Code would be the same but I wonder if intent is clearer with <code>(void) *a;</code>?"}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451448901, "post_id": 34521773, "comment_id": 56787163, "body": "@Olaf, in C++ you can say <code>volatile uint32_t &amp;x = *a;</code>, which does <i>not</i> do the volatile read... so it&#39;s not really clear that a bare *a would, because it&#39;s not really necessary to convert the l-value *a into its r-value."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451458942, "post_id": 34521773, "comment_id": 56790549, "body": "@MattTimmermans: This question is about C. References are a C++ featrure and the question does not even go into that direction. They are completely other beasts; e.g. you cannot even use them like that because they have no value on their own (basically). Please stick to the question; this is no discussion or comparison forum."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1451459272, "post_id": 34521773, "comment_id": 56790688, "body": "@CraigEstey: If you enable compiler warnings (always do!) and use a half-way modern compiler, you should get one for <code>*a;</code>: &quot;value of expression not use&quot; or so. The cast is the correct way to tell the compiler that you don&#39;t care and he has to shut up. And yes, I think this makes the intend quite clear to the reader, too. Much more than the assignment or just writing <code>*a;</code>. But either way, you should comment your code and mention <b>why</b> you do this."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451472874, "post_id": 34521773, "comment_id": 56797280, "body": "@Olaf I always do -Wall [and a few more] and 30% of all code I write is comments.  You&#39;ll get a warning on foo1 [I wouldn&#39;t have coded it that way], but foo2 is clean.  In practice, I always wrap device port access in access functions [possibly inline] such as read_device/write_device so that I can add tracing with an #ifdef.  It helps a great deal if the H/W is still under development.  With the trace, I&#39;m able to prove to logic designer that the device was programmed correctly [and they need to fix their verilog/RTL]"}], "tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 2, "last_activity_date": 1451440574, "last_edit_date": 1451440574, "creation_date": 1451439667, "answer_id": 34521773, "question_id": 34521620, "link": "https://stackoverflow.com/questions/34521620/force-read-of-volatile-variable/34521773#34521773", "title": "Force read of volatile variable", "body": "<p>It's standard in C, but not C++.\nSee: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Volatiles.html\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Volatiles.html</a></p>\n\n<p>BUT, you certainly don't need to do the volatile write to <code>discard</code>.  These will probably all compile to the same as foo2:</p>\n\n<ul>\n<li>use foo1, but remove the <code>volatile</code> qualifier from <code>discard</code>; or</li>\n<li>use foo2, but use <code>!*a</code> or *a + 0 instead of <code>*a</code>.  The value must be accessed in order to evaluate the expression, even in C++</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1451440424, "post_id": 34521843, "comment_id": 56785206, "body": "Seems like 134 there would constitute a guarantee. It&#39;s explicitly saying actions (like dereferencing the value) on the <code>volatile</code> can&#39;t be optimized out."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1451440455, "post_id": 34521843, "comment_id": 56785220, "body": "@ShadowRanger Read above, \u201cWhat constitutes an access to an object that has volatile-qualified type is implementation-defined.\u201d"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1451440489, "post_id": 34521843, "comment_id": 56785230, "body": "Ah, sorry. Clearly need more sleep. Stupid &quot;implementation defined&quot; nonsense. :-)"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451451278, "post_id": 34521843, "comment_id": 56787799, "body": "The importance of footnote 134 shouldn&#39;t be undermined. <code>(volatile uint32_t *)0xdeadbeef</code> is not a declaration. I don&#39;t know why this answer got -1; it is technically correct... I guess the truth hurts, sometimes?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451458283, "post_id": 34521843, "comment_id": 56790285, "body": "@Seb: <code>(volatile uint32_t *)0xdeadbeef</code> certainly is not (and the <code>volatile</code> qualifier in the cast is actually unnecessary), but the variable declaration actually is and that is the relevant part. The usage is actually uncommon, as there are normally <code>#define</code>s for the peripherals (be it <code>struct *</code> or <code>uintN_t *</code>. Anyway; the footnote refers to the variable declaration which is actually the part in question here. And the last paragraph is pretty unclear. <code>*</code> dereferences a pointer. Not sure how that is implementation-specific. (Btw the answer got 2 DVs)."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451467408, "post_id": 34521843, "comment_id": 56794318, "body": "@Olaf At the time I commented, it had only had one DV. It might be wise to consider the previous point (p6, IIRC?) which makes a distinction between objects declared with the <code>volatile</code> qualifier and lvalues that treat an object as though it has a <code>volatile</code> qualifier..."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451476415, "post_id": 34521843, "comment_id": 56799093, "body": "@Seb Where am I talking about declarations? The relevant point still stands: \u201cWhat constitutes an access to an object that has volatile-qualified type is implementation-defined.\u201d Please elaborate on how my answer is invalid."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1451477047, "post_id": 34521843, "comment_id": 56799418, "body": "@Seb And &#182;6 only considers the case that a volatile object is accessed through a pointer to a non-volatile object. How does this apply?"}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 1, "creation_date": 1451477990, "post_id": 34521843, "comment_id": 56799883, "body": "@FUZxxl I never said your answer was invalid. In fact, I UV&#39;d it because I like it. What p6 says is perhaps not relevant here, though it does strengthen the need for the object to be defined using the volatile qualifier, as opposed to changing the qualiification using an lvalue."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451479006, "post_id": 34521843, "comment_id": 56800446, "body": "@Seb But &#182;6 does not concern this scenario."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451480782, "post_id": 34521843, "comment_id": 56801460, "body": "@FUZxxl Are you trying to argue with me? Because if so, you&#39;re not doing such a great job at it... I already said that I agree, p6 is not relevant, but that it does introduce the term &quot;object defined with a volatile-qualified type&quot; as distinct from lvalue expressions used to access it."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451482048, "post_id": 34521843, "comment_id": 56802145, "body": "@Seb Why don&#39;t you say that in the first place?"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 1, "last_activity_date": 1451440301, "creation_date": 1451440301, "answer_id": 34521843, "question_id": 34521620, "link": "https://stackoverflow.com/questions/34521620/force-read-of-volatile-variable/34521843#34521843", "title": "Force read of volatile variable", "body": "<p>There is no guarantee that dereferencing a volatile object causes a read access, see ISO 9899:2011 \u00a76.7.3 \u00b67:</p>\n\n<blockquote>\n  <p>An object that has volatile-qualified type may be modified in ways unknown to the implementation or have other unknown side effects. Therefore any expression referring to such an object shall be evaluated strictly according to the rules of the abstract machine, as described in 5.1.2.3. Furthermore, at every sequence point the value last stored in the object shall agree with that prescribed by the abstract machine, except as modified by the unknown factors mentioned previously. <sup>134)</sup> What constitutes an access to an object that has volatile-qualified type is implementation-defined.</p>\n  \n  <p><sup>134)</sup> A volatile declaration may be used to describe an object corresponding to a memory-mapped input/output port or an object accessed by an asynchronously interrupting function. Actions on objects so declared shall not be \u201coptimized out\u201d by an implementation or reordered except as permitted by the rules for evaluating expressions.</p>\n</blockquote>\n\n<p>In practice, implementations of the C programming language commonly define unary <code>*</code> to constitute an access to an object, thus guaranteeing that <code>*a</code> is causing a read access to a volatile variable <code>a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451451550, "post_id": 34522444, "comment_id": 56787872, "body": "It is important to realise that we&#39;re talking about objects having qualifications, as opposed to l-values having qualifications. Does the object pointed to by <code>(volatile uint32_t *)0xdeadbeef</code> indeed have a <code>volatile</code> qualification? We don&#39;t know, because we can&#39;t see it&#39;s declaration. Perhaps it points to <code>discard</code>, declared below it, in <code>foo1</code>... Perhaps not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451458755, "post_id": 34522444, "comment_id": 56790462, "body": "@Seb: This is an integer cast to a pointer. The conversion is implementation defined. This is the typical way to provide the address of a  memory mapped peripheral register at a specific address. What do you mean with &quot;declaration of the object&quot;? There is none. The only declaration is that of the pointer <code>vi</code> (resp. <code>a</code> in the question). About &quot;perhaps it point to ...&quot;: It better should not, because that would add tons of other problems for the compiler. It is the responsibility of the programmer to make sure there is no aliasing (and it would not make any sense either)."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451467665, "post_id": 34522444, "comment_id": 56794476, "body": "Depending upon your implementation, there may indeed be an object declared using the <code>volatile</code> qualifier that has such an address. It&#39;s also possible that there might be an object declared without the qualifier that has such an address, and a compiler might be able to determine that the object really isn&#39;t <code>volatile</code>-qualified... What happens, then? &quot;What constitutes an access to an object that has volatile-qualified type is implementation-defined.&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1451493873, "post_id": 34522444, "comment_id": 56808524, "body": "@Seb: I&#39;m quite confident I mentioned that in the third paragraph. Still it would be aliasing (through the pointer and the original name). Remember we are talking about setting an explicit address to a compiler-allocated object which is reachable through its name already. If you have such code, you should review your code; this is definitively not the clean way. I write embedded code and have never seen the need for such hacks."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": true, "score": 2, "last_activity_date": 1451446191, "last_edit_date": 1451446191, "creation_date": 1451445374, "answer_id": 34522444, "question_id": 34521620, "link": "https://stackoverflow.com/questions/34521620/force-read-of-volatile-variable/34522444#34522444", "title": "Force read of volatile variable", "body": "<p>The keyword <code>volatile</code> tells the compiler an object might change outside the scope of the normal (i.e. visible by the compiler) program flow. Therefore, the compiler <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.3p7\" rel=\"nofollow\">performs</a> this access <strong>in general</strong>. The last sentence refers to how the access is performed, e.g. byte-read, unaligned reads, etc.</p>\n\n<p>Futhermore, the compiler must execute all accesses to such objects in the order given by the program flow. Note, however, that it may reorder accesses to non-volatile objects freely and the underlying hardware might think different, too (the compiler might not know that).</p>\n\n<p>The compiler might still optimize accesses to <code>volatile</code> objects which exist and are modified only in the visible code. This is true for local variables where the address is not taken (there might be other situations), as these cannot be reached outside the scope. For the pointers you use, this is not true, as the compiler does not know about the object they point to.</p>\n\n<p>To drop the result of an expression without compiler warning, just cast it to <code>void</code>:</p>\n\n<pre><code>volatile uint32_t *vi = ...;\n(void)*vi;            // this still might be optimized if vi is local\n</code></pre>\n\n<p>(If the target is read-only, add <code>const</code>.)</p>\n\n<p>See the gcc <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.9.3/gcc/Volatiles.html#Volatiles\" rel=\"nofollow\">documentation</a> for details on <code>volatile</code> accesses. An implementation which complies to the C standard has to provide this information.</p>\n\n<p>Also note that the underlying hardware still might reorder the accesses, unless the memory area uses a strictly ordered/non-cached access policy. This is typical for memory-mapped peripheral registers. If a cache/MMU is used, the areas might have to be set up accordingly.</p>\n"}], "owner": {"reputation": 3984, "user_id": 164344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c978ca7e1c3da231710b8c114009faa5?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/164344/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3217, "favorite_count": 0, "accepted_answer_id": 34522444, "answer_count": 3, "score": 6, "last_activity_date": 1451446191, "creation_date": 1451438490, "question_id": 34521620, "link": "https://stackoverflow.com/questions/34521620/force-read-of-volatile-variable", "title": "Force read of volatile variable", "body": "<p>An embedded project I'm working on requires reading a specific location in memory, but the value of that memory location is not needed. Currently I am reading the volatile variable into a dummy variable as in <code>foo1()</code> below, but I am curious about the method in <code>foo2()</code>.</p>\n\n<pre><code>void foo1(void) {\n    volatile uint32_t *a = (volatile uint32_t *)0xdeadbeef;\n    volatile uint32_t discard = *a;\n}\nvoid foo2(void) {\n    volatile uint32_t *a = (volatile uint32_t *)0xdeadbeef;\n    *a;\n}\n</code></pre>\n\n<p>See the dissassembly (compiled with gcc 4.7.2 and -O3):</p>\n\n<pre><code>  foo1:\nmovl      0xdeadbeef, %eax\nmovl      %eax, -0x4(%rsp)\nret\n  foo2:\nmovl      0xdeadbeef, %eax\nret\n</code></pre>\n\n<p>The method in <code>foo2()</code> seems to work, but I want to know if it is guaranteed to work and isn't a side effect of the compiler version and optimizations I am using.</p>\n"}, {"tags": ["python", "c", "multiple-languages"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1451440518, "post_id": 34521511, "comment_id": 56785243, "body": "No where in the C code that you&#39;ve posted do I see an <code>addTwo</code> function."}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1451442683, "post_id": 34521511, "comment_id": 56785826, "body": "@David Hoelzer: The addTwo function is in another file, where the prototype is defined in the header function &quot;Adder.h&quot;"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1451442754, "post_id": 34521511, "comment_id": 56785841, "body": "Your compiler error tends to disagree with you."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "edited": false, "score": 0, "creation_date": 1451443136, "post_id": 34521771, "comment_id": 56785930, "body": "Thank you for the comment, although it is false that I copy-pasted a skeleton extension module. I did follow an example, but wrote it myself from that example so I knew what was going on. However, you are correct, that the import name had to be the function.c file that compiled my python code and the function name had to be my python method name. Thank you!"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "edited": false, "score": 0, "creation_date": 1451443377, "post_id": 34521771, "comment_id": 56785985, "body": "@smallfacebigmouth: You&#39;re welcome. I based the skeleton copy guess on the fact that the code is actually naming the module <code>modsum</code> too, even though the file produced is named <code>callingPy.OSSPECIFICEXTENSION</code> and imports as <code>callingPy</code>. It looks an awful lot like a module written for the purpose of modular summation that swapped in a simpler function later on. You see the same string scattered around all over, when the string isn&#39;t part of the intended naming or functionality, and you make assumptions. :-)"}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "edited": false, "score": 0, "creation_date": 1451444951, "post_id": 34521771, "comment_id": 56786309, "body": "True. I think I&#39;m still trying to get used to the concept of calling c from python :) thank you again for your help! I appreciate it."}], "tags": [], "owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "is_accepted": true, "score": 1, "last_activity_date": 1451439650, "creation_date": 1451439650, "answer_id": 34521771, "question_id": 34521511, "link": "https://stackoverflow.com/questions/34521511/calling-a-c-function-through-python-after-compilation/34521771#34521771", "title": "Calling a C function through Python - after compilation", "body": "<p>The only function in the extension module is exported to Python under the name <code>modsum</code>. You called <code>addTwo</code>. This seems self-explanatory.</p>\n\n<p>It looks like at the C layer, there is a raw C function named <code>addTwo</code> that does the work for the C function <code>adder</code>, which is then exported to Python under the name <code>modsum</code>. So you should either rename the export, or call it with the correct name:</p>\n\n<pre><code>s = callingPy.modsum(a, b)\n</code></pre>\n\n<p>It looks like you copy-pasted a skeleton extension module, switched one tiny internal, and didn't fix up any of the exports or names.</p>\n"}], "owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 34521771, "answer_count": 1, "score": 0, "last_activity_date": 1451439650, "creation_date": 1451437413, "last_edit_date": 1495541750, "question_id": 34521511, "link": "https://stackoverflow.com/questions/34521511/calling-a-c-function-through-python-after-compilation", "title": "Calling a C function through Python - after compilation", "body": "<p>In an attempt to call a c function from Python, (in a previous post <a href=\"https://stackoverflow.com/questions/34520710/calling-a-c-function-from-a-python-file-getting-error-when-using-setup-py-file\">Calling a C function from a Python file. Getting error when using Setup.py file</a>), I have compiled the code into a .pyd file and am testing the program. \nHowever, I am coming across the error </p>\n\n<pre><code>AttributeError: 'module' object has no attribute 'addTwo'\n</code></pre>\n\n<p>My test file is as so: </p>\n\n<pre><code>import callingPy\na = 3\nb = 4\ns = callingPy.addTwo(a, b)\nprint(\"S\", s)\n</code></pre>\n\n<p>Where callingPy is the following .c file (turned into a .pyd) through compilation: </p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include \"adder.h\"\n\nstatic PyObject* adder(PyObject *self, PyObject *args)       \n{\n    int a;\n    int b;\n    int s;\n    if (!PyArg_ParseTuple(args,\"ii\",&amp;a,&amp;b))                      \n       return NULL;\n    s = addTwo(a,b);                                                \n    return Py_BuildValue(\"i\",s);                                \n}\n\n/* DECLARATION OF METHODS*/\nstatic PyMethodDef ModMethods[] = {\n    {\"modsum\", adder, METH_VARARGS, \"Descirption\"},         \n    {NULL,NULL,0,NULL}\n};\n\n// Module Definition Structure\nstatic struct PyModuleDef summodule = {\n   PyModuleDef_HEAD_INIT,\"modsum\", NULL, -1, ModMethods     \n};\n\n/* INITIALIZATION FUNCTION*/\nPyMODINIT_FUNC PyInit_callingPy(void)\n{\n    PyObject *m;\n    m = PyModule_Create(&amp;summodule);\n    return m; \n}\n</code></pre>\n\n<p>Any help would be greatly appreciated! \nThank you. </p>\n"}, {"tags": ["c", "arrays", "segmentation-fault"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5721549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc4e937eba616f15e117b1a601ef172?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Red.", "link": "https://stackoverflow.com/users/5721549/mr-red"}, "edited": false, "score": 1, "creation_date": 1451435904, "post_id": 34521310, "comment_id": 56784181, "body": "Oh, so it isn&#39;t <i>always</i> a <code>Segmentation Fault</code> to write outside an array object?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 23, "user_id": 5721549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc4e937eba616f15e117b1a601ef172?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Red.", "link": "https://stackoverflow.com/users/5721549/mr-red"}, "edited": false, "score": 0, "creation_date": 1451436058, "post_id": 34521310, "comment_id": 56784216, "body": "@Mr.Red. No. It&#39;s <i>undefined behaviour,</i> anything can happen, including d&#230;mons flying out of your nose."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 23, "user_id": 5721549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc4e937eba616f15e117b1a601ef172?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Red.", "link": "https://stackoverflow.com/users/5721549/mr-red"}, "edited": false, "score": 0, "creation_date": 1451436397, "post_id": 34521310, "comment_id": 56784295, "body": "@Mr.Red. Welcome to C aka programming without training wheels."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 23, "user_id": 5721549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc4e937eba616f15e117b1a601ef172?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Red.", "link": "https://stackoverflow.com/users/5721549/mr-red"}, "edited": false, "score": 0, "creation_date": 1451437130, "post_id": 34521310, "comment_id": 56784470, "body": "@Mr.Red <i>Oh, so it isn&#39;t always a &#39;Segmentation Fault&#39; to write outside an array object?</i>  No.  And that&#39;s what makes buffer overruns so hard to debug.  If they always caused an immediate <code>SIGSEGV</code>, they&#39;d be easy to find."}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 3, "last_activity_date": 1451435727, "creation_date": 1451435727, "answer_id": 34521310, "question_id": 34521292, "link": "https://stackoverflow.com/questions/34521292/c-off-by-one-error-but-no-segmentation-fault/34521310#34521310", "title": "C - Off by one error, but no segmentation fault?", "body": "<blockquote>\n  <p>What is happening here?</p>\n</blockquote>\n\n<p>Your program invokes undefined behavior as you are writing outside your array object. Undefined behavior in C is undefined, your program can work today and crash all the other days or even print Shakespeare complete works.</p>\n"}, {"tags": [], "owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "is_accepted": false, "score": 4, "last_activity_date": 1451436050, "creation_date": 1451436050, "answer_id": 34521351, "question_id": 34521292, "link": "https://stackoverflow.com/questions/34521292/c-off-by-one-error-but-no-segmentation-fault/34521351#34521351", "title": "C - Off by one error, but no segmentation fault?", "body": "<p>A segmentation fault doesn't mean that you accessed an array out of bounds, it means that you've accessed a virtual memory address that isn't mapped. Often accessing an array out of bounds will cause this, but just because you aren't seeing a segfault it doesn't mean that all of your memory accesses are valid.</p>\n\n<p>As to why you're seeing the different behavior, it's hard to say and it isn't necessarily a worthwhile use of time to try justifying different results when the results are specified as undefined. If you're really curious about what's going on you could look at the assembly generated by the two versions of your code (use the <code>--save-temps</code> argument to clang).</p>\n"}, {"tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1451436775, "creation_date": 1451436775, "answer_id": 34521435, "question_id": 34521292, "link": "https://stackoverflow.com/questions/34521292/c-off-by-one-error-but-no-segmentation-fault/34521435#34521435", "title": "C - Off by one error, but no segmentation fault?", "body": "<p>The behaviour of your program (accessing an array element out of bounds) is undefined.</p>\n\n<p>There is no particular requirement that undefined behaviour result in a segmentation fault, or any other observable error condition.</p>\n\n<p>Undefined behaviour means - literally - that the C standard does not impose any restrictions on what is allowed to occur.   That means anything can happen, including appearing to work correctly, or working in one circumstance but not another.</p>\n\n<p>The trick is not to worry about the particular potential causes of segmentation faults (or any other error condition that any instance of undefined behaviour might trigger).   It is to ensure the program has well-defined behaviour, so such symptoms are guaranteed not to occur.</p>\n"}], "owner": {"reputation": 23, "user_id": 5721549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc4e937eba616f15e117b1a601ef172?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Red.", "link": "https://stackoverflow.com/users/5721549/mr-red"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 34521310, "answer_count": 3, "score": 1, "last_activity_date": 1451438468, "creation_date": 1451435552, "last_edit_date": 1451438468, "question_id": 34521292, "link": "https://stackoverflow.com/questions/34521292/c-off-by-one-error-but-no-segmentation-fault", "title": "C - Off by one error, but no segmentation fault?", "body": "<p>I recently wrote this code in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N_ROWS 100\n\n\nint main() {\n\n  char *inputFileName = \"triangle_data.txt\";\n  FILE *inputFile = fopen(inputFileName, \"r\");\n\n  if (inputFile == NULL) {\n    printf(\"ERROR: Failed to open \\\"%s\\\".\\n\", inputFileName);\n    return -1;\n  }\n\n  int triangle[(N_ROWS*(N_ROWS+1))/2 - 1];\n  size_t size = sizeof(triangle)/sizeof(int);\n  size_t index;\n\n\n  for (index = 0; !feof(inputFile); ++index) {\n    fscanf(inputFile, \"%d\", &amp;triangle[index]);\n  }\n\n  return 1;\n}\n</code></pre>\n\n<p>and was expecting a <code>Segmentation Fault</code>, since <code>N_ROWS*(N_ROWS+1))/2</code> is just enough space to hold the data in the file, but as you can see I made the array one element smaller. Somehow this doesn't trigger a segmentation fault. It does if I replace the body of the <code>for</code>-loop with:</p>\n\n<pre><code>int tmp;\nfscanf(inputFile, \"%d\", &amp;tmp);\ntriangle[index] = tmp;\n</code></pre>\n\n<p>What is happening here. If I make the array three elements to small it still doesn't trigger a segmentation fault. Five elements to small trigger one. I'm sure there is enough data in the file. </p>\n\n<p>As a test I printed the array afterwards and if I choose a smaller array there were elements missing.</p>\n\n<p>What is happening here?</p>\n\n<p>PS: Compiled with <code>clang</code> on a OS X.</p>\n"}, {"tags": ["python", "c", "integration"], "comments": [{"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1451431809, "post_id": 34520710, "comment_id": 56783031, "body": "<code>symbol not defined</code>: the function PyInit_buildsum doesn&#39;t exist. In your .c, don&#39;t you have to change &quot;sum&quot; into &quot;buildsum&quot; ?"}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "reply_to_user": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1451432290, "post_id": 34520710, "comment_id": 56783186, "body": "Hi, Thank you for the response. If I change buildsum to sum (in the setup file), I get the same error, just with the name <b>&quot;PyInit_sum:symbol not defined&quot;</b>"}, {"owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "edited": false, "score": 0, "creation_date": 1451432411, "post_id": 34520710, "comment_id": 56783228, "body": "It&#39;s something like: <code>mod_sum</code> should be named PyInit_sum, or there is a macro PYINIT(mod_sum) or something to use, instead of writing mod_sum."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1451432523, "post_id": 34520710, "comment_id": 56783262, "body": "Your <code>initmod</code> should be called <code>PyInit_sum</code> or <code>PyInit_buildsum</code>, depending on what you want the entry point to be called.  It should return the return value of <code>PyModule_Create</code>, the test for NULL is wrong."}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1451433481, "post_id": 34520710, "comment_id": 56783534, "body": "@cdarke: THANK YOU!! I tried that (with my original code) and it worked."}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1451433514, "post_id": 34520710, "comment_id": 56783541, "body": "Thanks to @cdarke, the working code is posted below!"}, {"owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1451434192, "post_id": 34520710, "comment_id": 56783724, "body": "@cdarke: Out of curiosity, do you know how to run a test file using the compiled .pyd code?"}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1451547890, "post_id": 34520710, "comment_id": 56827662, "body": "You need a small Python program to import your module.  Other than that, the fact that it is a DLL is invisible to the end user (a pyd file is actually a DLL)"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "is_accepted": false, "score": 1, "last_activity_date": 1451433602, "creation_date": 1451433602, "answer_id": 34521034, "question_id": 34520710, "link": "https://stackoverflow.com/questions/34520710/calling-a-c-function-from-a-python-file-getting-error-when-using-setup-py-file/34521034#34521034", "title": "Calling a C function from a Python file. Getting error when using Setup.py file", "body": "<p>The working code from above in case anyone runs into the same error: the answer from @dclarke is correct. The initialization function in python 3 must have PyInit_(name) as its name. </p>\n\n<pre><code>#include &lt;Python.h&gt;\n#include \"sum.h\"\n\nstatic PyObject* mod_sum(PyObject *self, PyObject *args)         \n{\n    int a;\n    int b;\n    int s;\n    if (!PyArg_ParseTuple(args,\"ii\",&amp;a,&amp;b))                      \n       return NULL;\n    s = sum(a,b);                                               \n    return Py_BuildValue(\"i\",s);                                \n}\n\n/* DECLARATION OF METHODS*/\nstatic PyMethodDef ModMethods[] = {\n    {\"modsum\", mod_sum, METH_VARARGS, \"Descirption\"},           \n    {NULL,NULL,0,NULL}\n};\n\n// Module Definition Structure\nstatic struct PyModuleDef summodule = {\n   PyModuleDef_HEAD_INIT,\"modsum\", NULL, -1, ModMethods     \n};\n\n/* INITIALIZATION FUNCTION*/\nPyMODINIT_FUNC PyInit_sum(void)\n{\n    PyObject *m;\n    m = PyModule_Create(&amp;summodule);\n    return m; \n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5728762, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b721fef48463e32083ffe11c65dfbad7?s=128&d=identicon&r=PG&f=1", "display_name": "littlebluedeer", "link": "https://stackoverflow.com/users/5728762/littlebluedeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1451433602, "creation_date": 1451431604, "last_edit_date": 1451433038, "question_id": 34520710, "link": "https://stackoverflow.com/questions/34520710/calling-a-c-function-from-a-python-file-getting-error-when-using-setup-py-file", "title": "Calling a C function from a Python file. Getting error when using Setup.py file", "body": "<p>My problem is as follows: \nI would like to call a C function from my Python file and return a value back to that Python file. \nI have tried the following method of using embedded C in Python (the following code is the C code called \"mod1.c). I am using Python3.4 so the format follows that given in the documentation guidelines. The problem comes when I call my setup file (second code below). \n    #include \n    #include \"sum.h\"</p>\n\n<pre><code>static PyObject* \nmod_sum(PyObject *self, PyObject *args)\n{\n    int a;\n    int b;\n    int s;\n    if (!PyArg_ParseTuple(args,\"ii\",&amp;a,&amp;b))                     \n       return NULL;\n    s = sum(a,b);\n    return Py_BuildValue(\"i\",s);                                \n}\n\n/* DECLARATION OF METHODS    */\nstatic PyMethodDef ModMethods[] = {\n    {\"sum\", mod_sum, METH_VARARGS, \"Descirption\"},          // {\"methName\", modName_methName, METH_VARARGS, \"Description..\"}, modName is name of module and methName is name  of method\n    {NULL,NULL,0,NULL}\n};\n\n// Module Definition Structure\nstatic struct PyModuleDef summodule = {\n   PyModuleDef_HEAD_INIT,\n   \"sum\",  \n   NULL, \n   -1,       \n   ModMethods       \n};\n\n/* INITIALIZATION FUNCTION    */\nPyMODINIT_FUNC initmod(void)\n{\n    PyObject *m;\n    m = PyModule_Create(&amp;summodule);\n    if (m == NULL)\n       return m;\n}\n</code></pre>\n\n<p>Setup.py \n    from distutils.core import setup, Extension</p>\n\n<pre><code>setup(name='buildsum', version='1.0',  \\\n      ext_modules=[Extension('buildsum', ['mod1.c'])])\n</code></pre>\n\n<p>The result that I get when I compile my code using gcc is the following error: <strong><em>Cannot export PyInit_buildsum: symbol not defined</em></strong></p>\n\n<p>I would greatly appreciate any insight or help on this problem, or any suggestion in how to call C from Python. Thank you! </p>\n\n<p>---------------------------------------EDIT ---------------------------------\nThank you for the comments: \nI have tried the following now: </p>\n\n<pre><code>static PyObject* \nPyInit_sum(PyObject *self, PyObject *args)          \n{\n    int a;\n    int b;\n    int s;\n    if (!PyArg_ParseTuple(args,\"ii\",&amp;a,&amp;b))                     \n       return NULL;\n    s = sum(a,b);                                               \n    return Py_BuildValue(\"i\",s);                            \n}\n</code></pre>\n\n<p>For the first function; however, I still get the same error of <strong><em>PyInit_sum: symbol not defined</em></strong></p>\n"}, {"tags": ["c", "sockets", "encryption", "file-io", "encryption-symmetric"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1451437405, "post_id": 34520651, "comment_id": 56784534, "body": "What do you mean by &quot;messes with the program&quot;?  That&#39;s not the kind of information that will help anyone solve your problem.  What kind of errors do you see?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1451438636, "post_id": 34520651, "comment_id": 56784811, "body": "Also, I doubt <code>AES_Encrypt()</code> produces a NUL-terminated string as its encrypted message, so this line would be wrong:  <code>if( send(sock , enc_message , strlen(enc_message) , 0) &lt; 0)</code>"}, {"owner": {"reputation": 157, "user_id": 4358113, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7c7c0427d9d15f83476200b3e90d0a0e?s=128&d=identicon&r=PG&f=1", "display_name": "blindeyes", "link": "https://stackoverflow.com/users/4358113/blindeyes"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1451439422, "post_id": 34520651, "comment_id": 56785001, "body": "The program runs without errors, the problem is that the answer from the server is not the decrypted message, but random characters. Sorry, for not being clear on that. Also, the first version runs as expected, so     <code>AES_Encrypt</code>  and  <code>send</code> must be cooperating well."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1518162722, "creation_date": 1518162722, "answer_id": 48701068, "question_id": 34520651, "link": "https://stackoverflow.com/questions/34520651/file-handling-messes-with-symmetric-client-server-communication/48701068#48701068", "title": "File handling messes with symmetric client-server communication", "body": "<blockquote>\n  <p>\u2026 the first version runs as expected, so     <code>AES_Encrypt</code> \n  and  <code>send</code> must be cooperating well.</p>\n</blockquote>\n\n<p>That a program with undefined behavior <em>runs as expected</em> does not imply that all is <em>well</em>.</p>\n\n<p>Andrew Henle is right, saying</p>\n\n<blockquote>\n  <p>I doubt <code>AES_Encrypt()</code> produces a NUL-terminated string as\n  its encrypted message, so this line would be wrong:  <code>if( send(sock , enc_message , strlen(enc_message) , 0) &lt; 0)</code></p>\n</blockquote>\n\n<p>The AES block size is 16 Bytes; <code>enc_message</code> will have been filled with 16 Bytes, any as well as none of which may be <code>'\\0'</code>, so <code>strlen(enc_message)</code> could yield a too short length to <code>send</code> as well as render the behavior undefined due to the array being accessed beyond the end.</p>\n"}], "owner": {"reputation": 157, "user_id": 4358113, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/7c7c0427d9d15f83476200b3e90d0a0e?s=128&d=identicon&r=PG&f=1", "display_name": "blindeyes", "link": "https://stackoverflow.com/users/4358113/blindeyes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1518162722, "creation_date": 1451431276, "last_edit_date": 1451431736, "question_id": 34520651, "link": "https://stackoverflow.com/questions/34520651/file-handling-messes-with-symmetric-client-server-communication", "title": "File handling messes with symmetric client-server communication", "body": "<p>I have written two programs that implement server-client communication with symmetric encryption. They seem to do their job: the client asks for a message,encrypts it with an AES_key, sends it to the server, which decrypts it and sends it back.\n Here is the code for the server: </p>\n\n<pre><code>/*\nC socket server example using sockets and symmetric encryption\ncompile with gcc server.c -o server -lssl -lcrypto\n*/\n\n#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;    //strlen\n#include&lt;sys/socket.h&gt;\n#include&lt;arpa/inet.h&gt; //inet_addr\n#include&lt;unistd.h&gt;    //write\n#include &lt;openssl/aes.h&gt;\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/evp.h&gt;\n\nint main(int argc , char *argv[])\n{\n\nstatic const unsigned char key[] = {\"hello\"};\nint socket_desc , client_sock , c , read_size;\nstruct sockaddr_in server , client;\nunsigned char client_message[40];\nunsigned char dec_message[16];\n\n//Create socket\nsocket_desc = socket(AF_INET , SOCK_STREAM , 0);\nif (socket_desc == -1)\n{\n    printf(\"Could not create socket\");\n}\nputs(\"Socket created\");\n\n//Prepare the sockaddr_in structure\nserver.sin_family = AF_INET;\nserver.sin_addr.s_addr = INADDR_ANY;\nserver.sin_port = htons( 8888 );\n\n//Bind\nif( bind(socket_desc,(struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)\n{\n    //print the error message\n    perror(\"bind failed. Error\");\n    return 1;\n}\nputs(\"bind done\");\n\n//Listen\nlisten(socket_desc , 3);\n\n//Accept and incoming connection\nputs(\"Waiting for incoming connections...\");\nc = sizeof(struct sockaddr_in);\n\n//accept connection from an incoming client\nclient_sock = accept(socket_desc, (struct sockaddr *)&amp;client, (socklen_t*)&amp;c);\nif (client_sock &lt; 0)\n{\n    perror(\"accept failed\");\n    return 1;\n}\nputs(\"Connection accepted\");\n\n//create decryption key\nAES_KEY aes_key;\nAES_set_decrypt_key((const unsigned char*) key, 128, &amp;aes_key);\n\n//Receive a message from client\n\n\nwhile( (read_size = recv(client_sock , client_message , 2000 , 0)) &gt; 0 )\n{\n\n    //decry message\n    AES_decrypt((const unsigned char*)client_message,dec_message,(const AES_KEY *)&amp;aes_key);\n    //Send the message back to client\nwrite(client_sock , dec_message , strlen(dec_message));\n}\n\nif(read_size == 0)\n{\n    puts(\"Client disconnected\");\n    fflush(stdout);\n}\nelse if(read_size == -1)\n{\n    perror(\"recv failed\");\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Here is the code for the client:</p>\n\n<pre><code>/*\nC ECHO client example using sockets and symmetric encryption\n*/\n#include&lt;stdio.h&gt; //printf\n#include&lt;string.h&gt;    //strlen\n#include&lt;sys/socket.h&gt;    //socket\n#include&lt;arpa/inet.h&gt; //inet_addr\n#include&lt;unistd.h&gt;    //write\n#include \"openssl/aes.h\"\n#include &lt;openssl/rsa.h&gt;\n#include &lt;openssl/evp.h&gt;\n\nint main(int argc , char *argv[])\n{\nstatic const unsigned char key[] = {\"hello\"};\nint sock;\nstruct sockaddr_in server;\n\n\n\n\n//Create socket\nsock = socket(AF_INET , SOCK_STREAM , 0);\nif (sock == -1)\n{\n    printf(\"Could not create socket\");\n}\nputs(\"Socket created\");\n\nserver.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\nserver.sin_family = AF_INET;\nserver.sin_port = htons( 8888 );\n\n//Connect to remote server\nif (connect(sock , (struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)\n{\n    perror(\"connect failed. Error\");\n    return 1;\n}\n\nputs(\"Connected\\n\");\n//create key\nAES_KEY aes_key;\nAES_set_encrypt_key((const unsigned char*)key, 128, &amp;aes_key);\n\n//keep communicating with server\nwhile(1)\n{\n    unsigned char enc_message[40]={0};\n    unsigned char message[16]={0};\n    unsigned char server_reply[40]={0};\n     fflush(stdin);\nfflush(stdout);\n    printf(\"Enter message : \");\n    scanf(\"%s\" , message);\n    //encrypt message\n    AES_encrypt((const unsigned char*)message,enc_message,(const AES_KEY *)&amp;aes_key);\n    //Send some data\n    if( send(sock , enc_message , strlen(enc_message) , 0) &lt; 0)\n    {\n        puts(\"Send failed\");\n        return 1;\n    }\n\n    //Receive a reply from the server\n    if( recv(sock , server_reply , 2000 , 0) &lt; 0)\n    {\n        puts(\"recv failed\");\n        break;\n    }\n\n    printf(\"Server reply : %s \\n\",server_reply);\n\n}\n\nclose(sock);\nreturn 0;\n}\n</code></pre>\n\n<p>Now, I'd like to exchange the key with public encyption, so I want to load two files for each end: its private and the public of the other one. I've already created them. </p>\n\n<p>So, adding the following code(at the beginning of main) to server works:</p>\n\n<pre><code>RSA* pRSAPRI = RSA_new();\nRSA* pRSAPRI2 = RSA_new();\nOpenSSL_add_all_algorithms();\nOpenSSL_add_all_ciphers();\nERR_load_crypto_strings();\nRSA*    pRSAserver;\nRSA*    pRSAclientimport;\nFILE*   f1;\nFILE*   f2;\n\n//load public key of client\nf1 = fopen(\"client_public.pem\", \"r\");\nif (f1==NULL)\n{\n  printf(\"could not open file \\n\");\n}\npRSAclientimport = PEM_read_RSAPublicKey(f1, &amp;pRSAPRI, NULL, NULL);\nfclose(f1);\n //load private key of server\nf2 = fopen(\"server_private.pem\", \"r\");\nif (f2==NULL)\n{\n  printf(\"could not open file \\n\");\n}\npRSAserver = PEM_read_RSAPrivateKey(f2, &amp;pRSAPRI2, NULL, \"1234\");\nfclose(f2);\n</code></pre>\n\n<p>However, adding this piece of code to client messes with the program, so that the answer from the server is not correct:</p>\n\n<pre><code> RSA* pRSAPRI2 = RSA_new();\nRSA* pRSAPRI = RSA_new();\nOpenSSL_add_all_algorithms();\nOpenSSL_add_all_ciphers();\nERR_load_crypto_strings();\nRSA*    pRSAclient;\nRSA*    pRSAserverimport;\n\nFILE*   f3;\nFILE*   f4;\n//load public key of server\nf3 = fopen(\"server_public.pem\", \"r\");\nif (f3==NULL)\n{\n  printf(\"could not open file \\n\");\n}\npRSAserverimport = PEM_read_RSAPublicKey(f3, &amp;pRSAPRI, NULL, NULL);\n\nfclose(f3);\n //load private key of client\nf4 = fopen(\"client_private.pem\", \"r\");\nif (f4==NULL)\n{\n  printf(\"could not open file \\n\");\n}\npRSAclient = PEM_read_RSAPrivateKey(f4, &amp;pRSAPRI2, NULL, \"1234\");\n\nfclose(f4);\n</code></pre>\n\n<p>Sorry for the long post, but I have no idea where the problem is. I've tried flushing randomly, which I guess may be the problem, but it didn't work. Any ideas?</p>\n"}, {"tags": ["c", "recursion", "coroutine", "setjmp"], "comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451427891, "post_id": 34520039, "comment_id": 56781491, "body": "It looks like you are ready to switch to the Go programming language."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1451428061, "post_id": 34520039, "comment_id": 56781578, "body": "It sounds like you could use the producer consumer pattern."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1451428067, "post_id": 34520039, "comment_id": 56781581, "body": "The thing you are trying to do is not supported by ISO C.  The way you&#39;re using <code>setjmp</code> and <code>longjmp</code> is not sanctioned by the standard, and there is no alternative in &quot;portable&quot; C.  You may find <a href=\"http://linux.die.net/man/2/getcontext\" rel=\"nofollow noreferrer\"><code>setcontext</code></a> and friends <i>somewhat</i> more congenial, since they are actually designed for this use case, but they are not available on all platforms and they are still rather awkward to use."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1451428090, "post_id": 34520039, "comment_id": 56781592, "body": "You can try and allocate a separate stack for the coroutine and use <code>setjmp</code> and <code>longjmp</code> to switch between your recursive co-routine and its consumer.  Nothing portable in sight I&#39;m afraid because you may have to fiddle with the <code>jmpbuf</code>s by hand."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1451428090, "post_id": 34520039, "comment_id": 56781593, "body": "Sounds like a bloat approach and/or an XY-problem. As given the question is too broad. What is your actual problem? Using recursive functions - even more as you write about wasting memory (is that an embedded system?) - is most times a bad idea."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1451430357, "post_id": 34520039, "comment_id": 56782487, "body": "You need to explain why a <code>PutByte</code> function doesn&#39;t solve your problem."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 2, "creation_date": 1451430534, "post_id": 34520039, "comment_id": 56782547, "body": "Can you please post your existing code for this? No offense, but this sounds like a terrible hack [using <code>setjmp&#47;longjmp</code>].  I&#39;ve done this sort of thing before and I can think of a number of ways to do this that are clean but it would help to have some context to riff off of."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1451431236, "post_id": 34520039, "comment_id": 56782813, "body": "A &quot;binary <a href=\"https://en.wikipedia.org/wiki/Massage\" rel=\"nofollow noreferrer\">massage</a>&quot; sounds relaxing right now, but I think this is about a &quot;binary message&quot;. :-)"}, {"owner": {"reputation": 61384, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1451431849, "post_id": 34520039, "comment_id": 56783044, "body": "just have one process create the chunks as a linked list of fixed-sized memory blocks (see <a href=\"https://en.wikipedia.org/wiki/Hashed_array_tree\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Hashed_array_tree</a>), and have another process working concurrently that sends them, or whatever, releasing the memory of the processed chunk. or must it be single threaded? in that case, convert your recursion to iteration. it is always possible to do this, imitating the recursion&#39;s control stack as some dynamic data structure on the heap."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1451432890, "post_id": 34520039, "comment_id": 56783364, "body": "@chux: As a massage is better done carefully (otherwise it will either not work at all or is pure pain), I&#39;m not sure if a <b>binary</b> massage really is that relaxing;-)"}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451469816, "post_id": 34520039, "comment_id": 56795670, "body": "Thank you for the feedback, links to code have been add, i am still curious why it is not supported by ISO C, @zwol. In my opinion I do something what chqrlie suggested - switching between the function and its caller. More feedback welcome."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451498531, "post_id": 34520039, "comment_id": 56811053, "body": "@stasik The short answer is that you&#39;re not allowed to use <code>longjmp</code> to re-enter a function that has returned (either normally or by calling <code>longjmp</code> itself).  This is not just a theoretical problem; its stack frame is liable to be trashed.  The point of using the <code>setcontext</code> functions instead is that you construct an entire additional <i>stack</i> and thus prevent the suspended context&#39;s stack frames from getting trashed."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451510495, "post_id": 34520039, "comment_id": 56816905, "body": "@zwol a co-commiter proposed the following trick <a href=\"https://github.com/open62541/open62541/commit/272eca14a02842d5acd626e2913c40aaec504e8f#diff-29584f3d8203a83888051cf7cfee8b72R1473\" rel=\"nofollow noreferrer\">github.com/open62541/open62541/commit/&hellip;</a> just alloca to increase the current frame and hope that the intermediate function calls fit in... oh this is dirty..."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451511710, "post_id": 34520039, "comment_id": 56817429, "body": "@Stasik You may be able to kludge something that works (on some platforms and compilers) but it will always be fragile."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451512935, "post_id": 34520039, "comment_id": 56817993, "body": "@zwol so, you suggest to go for setcontext? this means a context switch of the system, correct?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451520238, "post_id": 34520039, "comment_id": 56820534, "body": "@stasik If you can assume a POSIX.1-2001 environment that still includes the functions deprecated in -2008, then yes, that would be the path of least resistance.  I don&#39;t understand your second question."}, {"owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451660731, "post_id": 34520039, "comment_id": 56857427, "body": "@zwol the second queston was whether every call to setcontext implicates a context switch by the OS?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1451666399, "post_id": 34520039, "comment_id": 56858973, "body": "@Stasik It depends on the implementation and on your definition of &quot;context switch&quot;, I can&#39;t give you anything more specific than that."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451432789, "post_id": 34520826, "comment_id": 56783344, "body": "A software implementation likely would have the same problems as the normal (hardware) stack. Actually, it would add even more overhead. Anyway, I don&#39;t think that is an answer, but more of a comment."}], "tags": [], "owner": {"reputation": 1564, "user_id": 5422980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d70c303b95aa718a340b77e11628e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ari Hietanen", "link": "https://stackoverflow.com/users/5422980/ari-hietanen"}, "is_accepted": false, "score": 1, "last_activity_date": 1451432267, "creation_date": 1451432267, "answer_id": 34520826, "question_id": 34520039, "link": "https://stackoverflow.com/questions/34520039/recursive-coroutines-in-c-c99/34520826#34520826", "title": "Recursive coroutines in C (C99)", "body": "<p>As pointed out by Olaf the easiest way would be to use an iterative algorithm. However, if for some reason this is difficult, you can always simulate the recursive algorithm with a <code>stack</code> container and a <code>while</code> loop. This at least makes the function easier to interrupt. Pretty good article of how to implement this can be found <a href=\"http://www.codeproject.com/Articles/418776/How-to-replace-recursive-functions-using-stack-and\" rel=\"nofollow\">here</a>. The article is written for c++, but it should not be difficult to convert it to c.</p>\n"}], "owner": {"reputation": 2420, "user_id": 383834, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a9bb8cd9dabe7e17cdb916967e93d6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Stasik", "link": "https://stackoverflow.com/users/383834/stasik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "closed_date": 1451452209, "answer_count": 1, "score": 5, "last_activity_date": 1451471293, "creation_date": 1451427769, "last_edit_date": 1451471293, "question_id": 34520039, "link": "https://stackoverflow.com/questions/34520039/recursive-coroutines-in-c-c99", "closed_reason": "Needs more focus", "title": "Recursive coroutines in C (C99)", "body": "<p>While implementing a communication protocol, we have an encoder that traverses some structs recursively and encodes them into a binary message.</p>\n\n<p>So far so good, but now the buffer has to split out into multiple chunks of fixed size, e.g. the upper size of receiving buffer. Since allocating memory for the full message and cutting it consequently seems to be too wasteful (the size of the message is --<em>in theory</em>-- not bounded), the idea is now to implement a coroutine with means of setjmp/longjmp.</p>\n\n<p>At the moment, I have a prototype with two jump buffers - one buffer for resuming the encode function and the second one for simulating the return behavior of the function to jump back to its caller.</p>\n\n<p>Well, it seems to work, but the code looks like coming straight from hell. Are there any 'conventions' for implementing interruptible recursive functions, maybe a set of macros or something? I would like to use only standardized functions, no inline asm in order to stay portable. </p>\n\n<p><strong>Addition:</strong>\nThe prototype is here: <a href=\"https://github.com/open62541/open62541/compare/master...chunking_longjmp\" rel=\"nofollow\">https://github.com/open62541/open62541/compare/master...chunking_longjmp</a>\nThe 'usage' is shown inside of the unit-test.\nCurrently, coroutine behavior is implemented for a non-recursive function <code>Array_encodeBinary</code>. However, the 'coroutine' behavior should be extended to the general recursive <code>UA_encodeBinary</code> function located here: <a href=\"https://github.com/open62541/open62541/blob/master/src/ua_types_encoding_binary.c#L1029\" rel=\"nofollow\">https://github.com/open62541/open62541/blob/master/src/ua_types_encoding_binary.c#L1029</a></p>\n"}, {"tags": ["c", "output"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1451426237, "post_id": 34519705, "comment_id": 56780752, "body": "Because &quot;ABC&quot; has length 4. It&#39;s actually &quot;ABC\\0&quot;. Therefore, your string isn&#39;t terminated by zero, and <code>printf</code>&#39;s behaviour on such strings is undefined."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1451426242, "post_id": 34519705, "comment_id": 56780756, "body": "You didn&#39;t declare enough space for <code>x</code>.  Remember, a string needs to be null-terminated.  Since you only declared 3 characters, the null is lost and you are printing whatever garbage happens to follow it (until you reach a null byte)."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1451427676, "post_id": 34519705, "comment_id": 56781386, "body": "A decent compiler should have given (at least) a warning that would have made the root problem clear.  Have you disabled warnings?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1451427841, "post_id": 34519705, "comment_id": 56781456, "body": "@AdrianMcCarthy: Given the blue terminal color and font, I wouldn&#39;t be surprised if that&#39;s BorlandC++."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1451429845, "post_id": 34519705, "comment_id": 56782283, "body": "Don&#39;t post images of text."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1451430506, "post_id": 34519705, "comment_id": 56782538, "body": "I&#39;ve tried to increase the question&#39;s quality and make it&#39;s central topic (why <code>char[4]</code> and not <code>char[3]</code>) more clear. I didn&#39;t change the actual question, but I&#39;m not sure whether the current answers still all fit (most of them do say &quot;you need place for the zero terminator&quot;, so it should be fine). That being said, with this title, one should be able to a) search for it and b) find a possible duplicate (there should be one, right?)"}, {"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1451431080, "post_id": 34519705, "comment_id": 56782754, "body": "@Zeta Thank you for the question alterations! I didn&#39;t know to post that <code>&#47;&#47; (*)</code> in identifying the problematic piece of code.  I changed the title back, though, as I recall the two hours I spent searching for my problem, the only useful searches always came when searching &quot;something strange is happening&quot;. Also, there are indeed many duplicates to this question, though they all come in the format &quot;Strange &#39;this&#39; at the end of my string&quot; or &quot;Strange &#39;that&#39; at the end of my string&quot;.  No one asking the questions seemed to even consider the answer lying with x[k+1] as opposed to x[k]."}, {"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451431198, "post_id": 34519705, "comment_id": 56782801, "body": "Also, my question was severely downvoted after the title change of &quot;why x[k+1] instead of x[k]?&quot;. How concerned should I be about that?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1451431539, "post_id": 34519705, "comment_id": 56782919, "body": "@MarkPuchalaII It was already at -2 before I&#39;ve changed the title. That&#39;s why I&#39;ve changed it and tried to increase the quality (to stop the downvotes and make it reproducible). Note that if <code>3 -&gt; 4</code> is the only answer one can give, your question is too localized. That&#39;s why I tried to make it a little bit more general."}, {"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1451436694, "post_id": 34519705, "comment_id": 56784376, "body": "@Zeta Thanks for the input. I&#39;ve changed the title back to your original revision, then."}, {"owner": {"reputation": 44584, "user_id": 2617068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0nSBO.png?s=128&g=1", "display_name": "TigerhawkT3", "link": "https://stackoverflow.com/users/2617068/tigerhawkt3"}, "edited": false, "score": 1, "creation_date": 1451453737, "post_id": 34519705, "comment_id": 56788586, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31057309/why-is-there-a-question-mark-at-the-end-of-the-string\">Why is there a question mark at the end of the string?</a>"}, {"owner": {"reputation": 44584, "user_id": 2617068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0nSBO.png?s=128&g=1", "display_name": "TigerhawkT3", "link": "https://stackoverflow.com/users/2617068/tigerhawkt3"}, "edited": false, "score": 0, "creation_date": 1451453814, "post_id": 34519705, "comment_id": 56788613, "body": "As stated in the answer to the question you linked, it&#39;s &quot;to store the terminating <code>&#39;\\0&#39;</code>.&quot;"}, {"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "reply_to_user": {"reputation": 44584, "user_id": 2617068, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0nSBO.png?s=128&g=1", "display_name": "TigerhawkT3", "link": "https://stackoverflow.com/users/2617068/tigerhawkt3"}, "edited": false, "score": 0, "creation_date": 1451454061, "post_id": 34519705, "comment_id": 56788699, "body": "@TigerhawkT3 You&#39;re right about the possible duplicate; the reason I posted this question was that all other versions didn&#39;t ask the specific details That confused me the most, let alone get them answered. Is there a better way to handle this than simply asking in my own words?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1451460456, "post_id": 34519705, "comment_id": 56791149, "body": "@MarkPuchalaII: You don&#39;t have enough reputation for it (yet), but you <a href=\"https://stackoverflow.com/help/privileges\">can place a bounty on a question to increase awareness</a> (75 rep needed). By the way, the other answer didn&#39;t really cover how to do it in C++."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1451426313, "post_id": 34519724, "comment_id": 56780802, "body": "Or, even better, <code>char x[] = &quot;ABC&quot;;</code>. Let the compiler count the characters for you."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451426449, "post_id": 34519724, "comment_id": 56780867, "body": "@FiddlingBits - One assumes that this is a small sample of the code - therefore this will not be the same"}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": false, "score": 7, "last_activity_date": 1451426443, "last_edit_date": 1451426443, "creation_date": 1451426248, "answer_id": 34519724, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k/34519724#34519724", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>There is no space for the terminating <code>\\0</code>. In fact I would expect compilation to fail in such case.</p>\n\n<p>Try</p>\n\n<pre><code>char x[4] = \"ABC\";\n</code></pre>\n\n<p>Or, as <strong>@Zeta</strong> suggested, just</p>\n\n<pre><code>char x[] = \"ABC\";\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451426753, "post_id": 34519725, "comment_id": 56781001, "body": "I fount <code>printf()</code> doing the same thing as puts. Does it run the same way?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451427114, "post_id": 34519725, "comment_id": 56781153, "body": "@danny_ds - unless segmentation fault occurs before it finds that elusive null character"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451427116, "post_id": 34519725, "comment_id": 56781155, "body": "@MarkPuchalaII - Yes, all your strings should be null-terminated."}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1451427194, "post_id": 34519725, "comment_id": 56781181, "body": "@EdHeal - Indeed: <i>until it finds a \\0 or crashes..</i>"}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 4, "last_activity_date": 1451432278, "last_edit_date": 1451432278, "creation_date": 1451426251, "answer_id": 34519725, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k/34519725#34519725", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>Your string should be <strong>terminated</strong> with <code>\\0</code>.</p>\n\n<p>Use</p>\n\n<pre><code>char x[] = \"ABC\";\n</code></pre>\n\n<p>instead.</p>\n\n<blockquote>\n  <p>Using the top answer from this question, I found that when I change\n  x[3] to x[4] everything runs fine.</p>\n  \n  <p>BUT WHY? What is going on that x[3] is giving such a strange output?</p>\n</blockquote>\n\n<p><code>puts()</code> keeps going until it encounters <strong>a terminating <code>\\0</code></strong> byte. So if you don't supply one at the end of your string, it keeps running behind your string until it finds a <code>\\0</code> or <strong>crashes</strong>..</p>\n\n<p>See <a href=\"http://www.cplusplus.com/reference/cstdio/puts/\" rel=\"nofollow\">puts() description</a>:</p>\n\n<blockquote>\n  <p>The function begins copying from the address specified (str) <strong>until it\n  reaches the terminating null character ('\\0')</strong>. This terminating\n  null-character is not copied to the stream.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451426578, "post_id": 34519738, "comment_id": 56780922, "body": "This leaves me curious what do to with inputs. Should I just say something like &#39;scanf(x); x[strlen(x)-1] = &#39;\\0&#39;;`?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 1, "creation_date": 1451427022, "post_id": 34519738, "comment_id": 56781105, "body": "First read the manual for <code>scanf</code> then have a buffer of the right size, so you use the correct format string so that you do not overrun the buffer"}, {"owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451427110, "post_id": 34519738, "comment_id": 56781152, "body": "Are you referring to the GNU C Manual or should I be using another?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "edited": false, "score": 0, "creation_date": 1451427230, "post_id": 34519738, "comment_id": 56781199, "body": "<code>scanf</code> is more or less standard. Use the one for the compiler that you are using"}], "tags": [], "owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "is_accepted": false, "score": 4, "last_activity_date": 1451426285, "creation_date": 1451426285, "answer_id": 34519738, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k/34519738#34519738", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>A string is terminated by the null character - you have not allocated space for it.</p>\n\n<p>Do</p>\n\n<pre><code>char x[] = \"ABC\";\n</code></pre>\n\n<p>and let the compiler do the work for you!</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451427057, "post_id": 34519845, "comment_id": 56781117, "body": "I&#39;m afraid your explanation is a bit confusing, especially the pseudo code for <code>printf()</code> <code>;-)</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451429129, "post_id": 34519845, "comment_id": 56781993, "body": "@Zeta: Why not write an actual simplistic implementation of <code>puts</code> for illustration?  Even if the C library version is <i>smarter</i>, it should be semantically equivalent, especially regarding null termination."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1451429524, "post_id": 34519845, "comment_id": 56782153, "body": "@chqrlie: Fair enough. After all, it was almost already there, except for the missing increment (yup, would never terminate on non-empty strings) and the newline. I didn&#39;t add error checking, however, since that&#39;s more or less just checking the return of <code>putchar</code> and doesn&#39;t really consider whether <code>str</code> is zero terminated."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1451429842, "last_edit_date": 1451429842, "creation_date": 1451426887, "answer_id": 34519845, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k/34519845#34519845", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>Since you've asked \"why\" this yields <code>ABC -a</code>, here's an explanation: your <code>char x[3] = \"ABC\"</code> isn't well suited for <code>puts</code>. <code>puts</code> expects a string terminated by zero. However, your <code>x</code> is basically:</p>\n\n<pre><code>char x[3] = {'A', 'B', 'C'};\n</code></pre>\n\n<p>As you know, there's no way to get the length of a (dynamic) array:</p>\n\n<pre><code>char * allocate(){\n   return malloc(rand() + 1);\n}\n\nchar * mem = allocate(); // how large is mem??\n</code></pre>\n\n<p>There's no way for you to know how long it is. However, to print a string which is nothing else than a continuous sequence of characters in memory, a function needs to know when the string (aka the character sequence) ends.</p>\n\n<p>That's why the <a href=\"https://en.wikipedia.org/wiki/ASCII\" rel=\"nofollow\">American Standard Code for Information Interchange (ASCII)</a> and many other character sets contain the <a href=\"https://en.wikipedia.org/wiki/Null_character\" rel=\"nofollow\">null character</a>. It's basically <code>char</code> with value <code>0</code>:</p>\n\n<pre><code>char wrong_abc[3]   = {'A', 'B', 'C'};     // when does it end?\nchar correct_abc[4] = {'A', 'B', 'C', 0 }; // oh, there's a zero!\n</code></pre>\n\n<p>Now functions like <code>puts</code> can simply check for <code>0</code>:</p>\n\n<pre><code>// Simplified, actual \"puts\" checks for errors and returns\n// EOF on error or a non-negative int on succes.\nvoid puts(const char * str){\n   int i = 0;\n\n   while(str[i] != 0){\n      putchar(str[i]);\n      i++;\n   }\n\n   putchar('\\n');\n}\n</code></pre>\n\n<p>And that's why you </p>\n\n<ul>\n<li>need memory for all characters in the character sequence +1,</li>\n<li>get undefined behaviour when you forget the <code>0</code>.</li>\n</ul>\n\n<p>The implementation of <code>puts</code> above would never find <code>0</code> and accidentally leave the memory you own (or access other data), which usually leads to a segfault or other errors (or worse, doesn't get detected for a long time and then yields critical errors). The actual behaviour in such a situation is undefined.</p>\n\n<p>Note that string literals (e.g. <code>\"ABC\"</code>) automatically have a <code>'\\0'</code> at the end. Also, the compiler is smart enough to figure the length of the literal for you, so you can simply use</p>\n\n<pre><code>char x[] = \"ABC\";\n</code></pre>\n\n<p>That way, you don't have to worry if you change the literal later.</p>\n"}, {"tags": [], "owner": {"reputation": 528, "user_id": 5153946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J4cXX.jpg?s=128&g=1", "display_name": "George Bou", "link": "https://stackoverflow.com/users/5153946/george-bou"}, "is_accepted": false, "score": 0, "last_activity_date": 1451428309, "creation_date": 1451428309, "answer_id": 34520141, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k/34520141#34520141", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>Every time you declare a string variable, just add one more character to those you need for the ending  character <code>'\\0'</code> and you 'll be fine.</p>\n"}], "owner": {"reputation": 605, "user_id": 3292340, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/AJIup.png?s=128&g=1", "display_name": "Mark Puchala II", "link": "https://stackoverflow.com/users/3292340/mark-puchala-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "closed_date": 1451456535, "accepted_answer_id": 34519845, "answer_count": 5, "score": 0, "last_activity_date": 1451436654, "creation_date": 1451426123, "last_edit_date": 1495539883, "question_id": 34519705, "link": "https://stackoverflow.com/questions/34519705/why-do-i-need-chark-1-instead-of-chark-for-a-string-with-length-k", "closed_reason": "Not suitable for this site", "title": "Why do I need char[k + 1] instead of char[k] for a string with length k?", "body": "<p>So I have a simple set of code:   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  char x[3] = \"ABC\"; // (*)\n  puts(x);\n  return 0;\n}\n</code></pre>\n\n<p>It returns a strange output:</p>\n\n<pre>\nABC&not; a\n</pre>\n\n<p>Using the top answer from <a href=\"https://stackoverflow.com/questions/31057309/why-is-there-a-question-mark-at-the-end-of-the-string\">this question</a>, I found that when I change <code>x[3]</code> to <code>x[4]</code> everything runs fine.</p>\n\n<p>But why? Why do I get a strange output on <code>x[3]</code>, and why is <code>x[4]</code> fine?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 6, "creation_date": 1451426146, "post_id": 34519698, "comment_id": 56780713, "body": "sum += array[i]"}, {"owner": {"reputation": 18924, "user_id": 3970411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f2479dbd50036c3d580be156c176fb?s=128&d=identicon&r=PG", "display_name": "Hamid Pourjam", "link": "https://stackoverflow.com/users/3970411/hamid-pourjam"}, "edited": false, "score": 1, "creation_date": 1451426280, "post_id": 34519698, "comment_id": 56780786, "body": "<code>sum = sum + array[i];</code> or <code>sum += array[i]</code>"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1451426948, "post_id": 34519698, "comment_id": 56781077, "body": "What&#39;s wrong with this Question? It was a fair Question. Please stop Down voting people just because you don&#39;t like the Question."}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1451426827, "creation_date": 1451426827, "answer_id": 34519838, "question_id": 34519698, "link": "https://stackoverflow.com/questions/34519698/summing-an-array-of-integers-in-c/34519838#34519838", "title": "Summing an array of integers in C", "body": "<p>You should either write <code>sum += array[i];</code> or <code>sum = sum + array[i];</code>.  The way it is written, you do not compute the sum of values (except for trivial cases such as <code>0</code> and <code>1</code> value).</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1451427438, "post_id": 34519879, "comment_id": 56781286, "body": "I hope the OP learns from your commented code, but his code implements different semantics: the first input is the number of further inputs to sum. If you are going to post sample code, make it fit the OP&#39;s needs.  I agree it is unwise to use a VLA from an unchecked size typed by the user... but it is also bad practice to not check the return value of <code>scanf</code>."}], "tags": [], "owner": {"reputation": 19, "user_id": 5697096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPCLd.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/5697096/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1451427059, "creation_date": 1451427059, "answer_id": 34519879, "question_id": 34519698, "link": "https://stackoverflow.com/questions/34519698/summing-an-array-of-integers-in-c/34519879#34519879", "title": "Summing an array of integers in C", "body": "<p>Hope this helps I explain the various steps through comments: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* \n    Good practice to use a symbolic name to represent \n    the number of elements in an array that way if you \n    have to change the number of elements you just have \n    to do it here.\n*/ \n#define NO_OF_ELEMENTS 5\n\nint main()\n{\n    // Declare variables and initialize them to 0.\n    int i = 0, sum = 0;\n    int array[NO_OF_ELEMENTS] = {0}; // Initializes all elements to 0.\n\n    for(i = 0; i &lt; NO_OF_ELEMENTS; i++)\n    {\n        printf(\"Enter number %d: \", i + 1); // +1 so i doesnt appear as 0 on first loop.\n        scanf(\"%d\", &amp;array[i]);\n        sum += array[i]; // Calculate sum.\n    }\n\n    printf(\"Sum of elements: %d\", sum); // Display sum.\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5719669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db6400dc78e50cf8ebff2894ba1a387?s=128&d=identicon&r=PG&f=1", "display_name": "N. Reid", "link": "https://stackoverflow.com/users/5719669/n-reid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1451453870, "accepted_answer_id": 34519838, "answer_count": 2, "score": 1, "last_activity_date": 1451427059, "creation_date": 1451426105, "last_edit_date": 1451426902, "question_id": 34519698, "link": "https://stackoverflow.com/questions/34519698/summing-an-array-of-integers-in-c", "closed_reason": "Not suitable for this site", "title": "Summing an array of integers in C", "body": "<p>I have read the answers to questions already asked here about summing arrays and still can't see where I've got it wrong. I am trying to sum an array. The code I have written gives me an output, just not the correct one! This is my code:</p>\n\n<pre><code>int main() {\n    int x; \n    scanf(\"%d\",&amp;x);\n    int array[x];\n    int sum = 0; \n    for (int i = 0; i &lt; x; i++) {\n        scanf(\"%d\", &amp;array[i]);\n    }\n    for (int i = 0; i &lt; x; i++) {\n        sum += sum + array[i]; \n    }\n    printf(\"%d\\n\", sum);\n    return 0;\n}\n</code></pre>\n\n<p>Can anyone see where I've gone wrong? </p>\n\n<p>Thanks</p>\n"}]