[{"tags": ["c", "assembly", "arm", "cortex-a"], "comments": [{"owner": {"reputation": 25147, "user_id": 78720, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2d78d7a7bd9b1eca98bf4b7f0aba52dc?s=128&d=identicon&r=PG", "display_name": "sigjuice", "link": "https://stackoverflow.com/users/78720/sigjuice"}, "edited": false, "score": 2, "creation_date": 1489626674, "post_id": 42822845, "comment_id": 72758516, "body": "Examine the code that your ARM compiler generates for simple C functions?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 2, "creation_date": 1489627641, "post_id": 42822845, "comment_id": 72758730, "body": "The calling convention is fully documented in the Procedure Call Standard for the ARM Architecture. One complicating factor is whether the calling convention your C compiler uses is the base standard or the VFP variant standard. Either way once you determine that you can find out what registers integer and floating point values (if any) are passed in by following the rules given in chapter 5.  <a href=\"http://infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/IHI0042F_aapcs.pdf\" rel=\"nofollow noreferrer\">infocenter.arm.com/help/topic/com.arm.doc.ihi0042f/&hellip;</a>"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1489630847, "post_id": 42822845, "comment_id": 72759604, "body": "The compiler itself is a resource, whether or not you found it online, why not just ask the compiler, it knows the answer."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 2, "creation_date": 1489675446, "post_id": 42822845, "comment_id": 72783561, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/261419/arm-to-c-calling-convention-registers-to-save\">ARM to C calling convention, registers to save</a> or looking at the AAPCS, r0-r3 are for integer types and s0\u2013s15 (d0\u2013d7, q0\u2013q3) are for floats arguments.  If you can not find space, they are put on the stack.  Depends on ABI variant and co-processor.  <code>printf()</code> (varadic functions) types are much different."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1489676056, "post_id": 42822845, "comment_id": 72784056, "body": "<code>void foo(int, float, int, float);</code> should be the same as <code>void foo(int, int, float, float);</code> with regards to argument assignment AFAIU."}], "owner": {"user_type": "does_not_exist", "display_name": "user7718089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 625, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489621707, "creation_date": 1489621707, "question_id": 42822845, "link": "https://stackoverflow.com/questions/42822845/passage-of-floating-point-arguments-in-arm-processors", "title": "Passage of Floating point arguments in ARM processors", "body": "<p>I would like an example of the convention used when writing an assembly subroutine called from C.There are no resources online that explain where arguments that are integer and floating point type are stored. I have floating point hardware on the ARM and am able to pass in floating point numbers into floating point registers. But how do I pass in integers into integer registers and floating point values into floating point registers at the same time.</p>\n"}, {"tags": ["c", "http-headers", "zlib"], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 7403219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356974d37bdcc78ed5cc3d54d9514ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Droopy", "link": "https://stackoverflow.com/users/7403219/droopy"}, "edited": false, "score": 0, "creation_date": 1489625584, "post_id": 42823036, "comment_id": 72758258, "body": "I am not writing a web server. Just a client, server side application for a local pipe server. Also, the data that I am getting from the HTTP request is not urlencoded, it contains malformed characters, and I&#39;m almost 99% sure that it has something to do with the content-encoding. Any other ideas?"}, {"owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "reply_to_user": {"reputation": 124, "user_id": 7403219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356974d37bdcc78ed5cc3d54d9514ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Droopy", "link": "https://stackoverflow.com/users/7403219/droopy"}, "edited": false, "score": 0, "creation_date": 1489967914, "post_id": 42823036, "comment_id": 72888752, "body": "If you are writing the client, why did you set the Content-Type to url-encoded if you are not sending valid url-encoded data?  If you want the server to decode your data correctly, you have to tell it what you are sending.  I still am really unclear on what you are trying to do, or why, since you should be using libraries/frameworks to do this."}], "tags": [], "owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "is_accepted": false, "score": 1, "last_activity_date": 1489622851, "creation_date": 1489622851, "answer_id": 42823036, "question_id": 42822590, "link": "https://stackoverflow.com/questions/42822590/how-to-understand-decoding-http-requests-at-client-side/42823036#42823036", "title": "How to understand decoding HTTP Requests at Client side?", "body": "<p>First, I would discourage you from writing your own web server, because you WILL introduce massive security bugs.  <strong>Especially</strong> if you don't understand the standard.</p>\n\n<p>Second, the \"Accept-Encoding: gzip, deflate\" is the client telling the server <em>when you send the response</em>, it can be in either gzip or deflate format.  This has nothing to do with the \"ENCODED_DATA\" part of the request.</p>\n\n<p>The data in the request is NOT gzip compressed unless the client also sends the \"Content-Encoding:\" header. (And that header will say \"gzip\" or \"deflate\"). From the request shown, your data is probably not compressed at all, but in \"<a href=\"https://en.wikipedia.org/wiki/Percent-encoding#The_application.2Fx-www-form-urlencoded_type\" rel=\"nofollow noreferrer\">www-form-urlencoded</a>\".</p>\n\n<p>I'm going to flat out state that unless your goal is to learn the standards (in which case, you should be reading them, plus web server code), you should avoid playing at this layer at all costs. Just use one of the hundreds of web frameworks that do this job for you.</p>\n"}], "owner": {"reputation": 124, "user_id": 7403219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356974d37bdcc78ed5cc3d54d9514ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Droopy", "link": "https://stackoverflow.com/users/7403219/droopy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489622851, "creation_date": 1489620258, "question_id": 42822590, "link": "https://stackoverflow.com/questions/42822590/how-to-understand-decoding-http-requests-at-client-side", "title": "How to understand decoding HTTP Requests at Client side?", "body": "<p>I am working with <a href=\"https://github.com/madler/zlib/\" rel=\"nofollow noreferrer\">zLib</a>, and my goal is to decode the data sent to my server. I am trying to understand how to go about doing this.</p>\n\n<p>Assume I have an HTTP Request Headers (just off the top of my head):</p>\n\n<pre><code>Referer: http://google.com\\r\\n\nContent-Type: application/x-www-form-urlencoded\\r\\n\nAccept-Encoding: gzip, deflate\\r\\n\n\\r\\n\nENCODED_DATA\n</code></pre>\n\n<p>Using the content extracted from within <code>Accept-Encoding:</code> header.</p>\n\n<p>Assume <code>Ctx = ENCODED_DATA</code></p>\n\n<p>Does this tell me that in order to retrieve the plain text <code>Ctx</code>, I need to apply <code>Gzip(Ctx)</code> and then <code>Deflate(Ctx)</code>?</p>\n\n<p>Basically, the question is, how do I go about decoding the <code>ENCODED_DATA</code> inside the HTTP Request at client side assuming the headers are displayed as above.</p>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads", "posix"], "comments": [{"owner": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1489620225, "post_id": 42822480, "comment_id": 72756732, "body": "Save the thread id of the thread that should generate the random number then call the random number generator only if the saved thread id matches the current thread id."}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "reply_to_user": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1489620815, "post_id": 42822480, "comment_id": 72756944, "body": "and how can i be sure that other threads wont surpass the random generator and execute the iteration body with the previous rand ? Also , any idea why this got downvoted ? O_O"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1489620830, "post_id": 42822480, "comment_id": 72756949, "body": "You need explicit synchronisation. For example, a mutex to ensure only one thread accesses a global <code>gl_rand</code> and a barrier to ensure each thread operates in step."}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1489620946, "post_id": 42822480, "comment_id": 72756983, "body": "@kaylum a mutex wont be enough , i think i need condition variables , but i can&#39;t find an example that helps me enough"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1489621013, "post_id": 42822480, "comment_id": 72757004, "body": "Sure, that&#39;s what I meant by the barrier. Read the man pages and give it a try. We can&#39;t write the full solution for you but can help once you have tried and have a specific question related to that attempt."}, {"owner": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1489621204, "post_id": 42822480, "comment_id": 72757060, "body": "Ah.  Your question is more complex than you thought.  What you want is some thread-safe mechanism to generate random numbers at specific times.  Thread-safe generators are pretty standard and an atomic compare-and-swap operation can do that.  A thread-safe way of controlling the generation of random numbers is more complex, and it&#39;s not possible to be more specific without knowing what conditions will trigger generating a new random number"}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "reply_to_user": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1489621510, "post_id": 42822480, "comment_id": 72757166, "body": "@RayFischer i do understand it&#39;s a complex question :D No condition triggers the number generation , it&#39;s just an essential part of the iterations body and all threads must know the new one before they jump in."}, {"owner": {"reputation": 708, "user_id": 6540292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfac93d8c8c2c645ca2d70f2328e260?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Fischer", "link": "https://stackoverflow.com/users/6540292/ray-fischer"}, "edited": false, "score": 0, "creation_date": 1489622081, "post_id": 42822480, "comment_id": 72757343, "body": "@frcake I know exactly how to do this in C# but I don&#39;t know the details for Unix so, handwaving.  Create a counter that tracks how many threads have NOT fetched the current random number.  In an interlocked bit of code get the current random number, decrement the count and if it&#39;s zero then reset the count and generate a new random number."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1489623985, "post_id": 42822480, "comment_id": 72757859, "body": "I would consider separating the one function block into two, allowing you to set a &quot;master thread&quot; that runs an altered logic than the &quot;slave&quot; threads. This will also allow you to set a <a href=\"http://stackoverflow.com/questions/34519/what-is-a-semaphore\">semaphore</a> that will help you sync the &quot;master thread&quot; with the &quot;slave&quot; threads... or you can spawn and join threads within the &quot;master thread&quot; loop."}], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489621701, "post_id": 42822757, "comment_id": 72757228, "body": "will this happen once, in each iteration? and also when the other threads have ended the for loop ? cause if the rand changes in the middle of some calculation it&#39;d be wrong. the sequence is: [SingleNumberGeneration]-&gt;[UpdateGlobal] -&gt; [ReleaseThreads] -&gt; [do_job(end of for)] -&gt; [WaitForNewRand] . This is why im thinking about pthread_cond_wait and then broadcasting after the number generation . Also it&#39;s a ready code , i didn&#39;t write it , im just making it parallel from sequential! ill check what you told my about casting the float"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489621842, "post_id": 42822757, "comment_id": 72757277, "body": "It will happen once \u2014 period.  If you need once per iteration, then you have to coordinate the N threads so that they wait for all threads to be ready for the next iteration to start, then one process goes and runs the random number generator step, and then frees the other processes.  That&#39;s a different problem from the one I thought you were solving \u2014 but you should explain what you&#39;re up to with better code."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489622013, "post_id": 42822757, "comment_id": 72757325, "body": "You&#39;re probably looking at <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_wait.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_wait()</code></a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_signal.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_signal()</code></a>, <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_broadcast.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_broadcast()</code></a> and related functions.  You&#39;ll need to think carefully about what you&#39;re up to."}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489622065, "post_id": 42822757, "comment_id": 72757338, "body": "Yes I&#39;m closing in to something like this <a href=\"https://gist.github.com/frcake/e56ed3db546220080c402b9f8c4e0425\" rel=\"nofollow noreferrer\">gist.github.com/frcake/e56ed3db546220080c402b9f8c4e0425</a> what do you think"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489622249, "post_id": 42822757, "comment_id": 72757398, "body": "The busy wait is a disaster.  But the germ of the idea might be right.  You should be thinking of calling a function, not writing the code inline.  It might be <code>float next_iteration_random_number(void);</code>, perhaps.  You&#39;d need to set the wait queue back to zero before you broadcast.  Etc."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489826031, "post_id": 42822757, "comment_id": 72849411, "body": "Note that if the number of iterations is not large (say, less than a million of them), it would be far simpler to have the main thread generate an array of random numbers, one per iteration, before it starts any of the threads, and then let the threads run free, reading the random numbers from the array as required.  This is fine unless the threads call <code>lrand48()</code> in their ordinary processing, or anything similarly ghastly.  If you don&#39;t know the number of iterations up front, or can&#39;t afford to preempt that much space, then this solution works (for me).  Upgraded code at GitHub."}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1489862839, "post_id": 42822757, "comment_id": 72860500, "body": "Great answer!! Thank you so much!!"}, {"owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1490018364, "post_id": 42822757, "comment_id": 72910697, "body": "stupid question, but would it be correct (as another way of implementing) to put the execution of lrand() inside 2 barriers and execute only for id=X?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1490020112, "post_id": 42822757, "comment_id": 72911910, "body": "To the extent I understand what you&#39;re asking, I think the answer&#39;s no.  <a href=\"https://www.acronymfinder.com/IIUC.html\" rel=\"nofollow noreferrer\">IIUC</a>, you&#39;re asking if it is OK to designate thread number X as the one that generates the random number, each time it wants to.  I think that&#39;s not correct \u2014 that process might be finished with cycle N before some of the others have started, and the others would therefore not necessarily see the correct value.  That said, if you wanted to complicate things, you could designate thread X to wait on condition &#39;generate new number&#39;, but  <i>[\u2026continued\u2026]</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1490020319, "post_id": 42822757, "comment_id": 72912053, "body": "<i>[\u2026continuation\u2026]</i> but you&#39;d need the other threads to check that they&#39;re all ready before signalling the generate new number condition.  So, that seems like more complication for no real benefit, though I could imagine other scenarios where you would in fact need a single thread to generate the random number (because the single thread holds the seed material \u2014 I&#39;m thinking of <code>erand48()</code>,  <code>jrand48()</code> or <code>nrand48()</code>, for example).  You might also need another condition &#39;random number has been generated&#39; for the other threads to wait on and thread X to broadcast to.  Such fun."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "edited": false, "score": 0, "creation_date": 1490189358, "post_id": 42822757, "comment_id": 73000883, "body": "I was just reading part of Chapter 7 &quot;Real Code&quot; in the book <a href=\"http://www.informit.com/store/programming-with-posix-threads-9780201633924\" rel=\"nofollow noreferrer\">Programming with POSIX Threads</a> by David Butenhof.  It describes and implements a &#39;barrier&#39;, which has pretty much the structure outlined in the solution here.  There&#39;s the mutex, the condition, a counter, a threshold, and a cycle number \u2014 all as devised for this answer.  Well, almost; the barrier counts down to zero instead of up to the threshold as this code does.  You can find the code (including the barrier code) at the linked site."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1489830750, "last_edit_date": 1489830750, "creation_date": 1489621118, "answer_id": 42822757, "question_id": 42822480, "link": "https://stackoverflow.com/questions/42822480/posix-threads-unique-execution/42822757#42822757", "title": "POSIX Threads, unique execution", "body": "<h3><code>pthread_cond_wait()</code> and <code>pthread_cond_broadcast()</code></h3>\n\n<p>In conjunction with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_lock.html\" rel=\"nofollow noreferrer\"><code>pthread_mutex_lock()</code></a>\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_unlock.html\" rel=\"nofollow noreferrer\"><code>pthread_mutex_unlock()</code></a>, the\n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_wait.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_wait()</code></a> and \n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_broadcast.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_broadcast()</code></a> functions are the key to achieving the required functionality.\nHowever, considerable care is required to get the predicate right.</p>\n\n<pre><code>/*\n** Objective: N threads cooperate on M cycles or iterations of a task.\n** A new random number is needed for each cycle, but all threads must\n** use the same random number on each cycle.\n** Any thread may evaluate the new random number.\n*/\n\n#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include \"stderr.h\"\n\n#ifndef NUM_THREADS\n#define NUM_THREADS 3\n#endif\n#ifndef NUM_CYCLES\n#define NUM_CYCLES 5\n#endif\n\nenum { MAX_THREADS = NUM_THREADS };\nenum { MAX_CYCLES  = NUM_CYCLES  };\n\nstatic pthread_mutex_t mtx_waiting = PTHREAD_MUTEX_INITIALIZER;\nstatic pthread_cond_t  cnd_waiting = PTHREAD_COND_INITIALIZER;\nstatic int             num_waiting = 0;\nstatic int             cycle   = -1;\n\nstatic float gl_rand = 0;\nstatic long  gl_long = 0;\n\nstatic float next_iteration_random_number(int tid, int iteration)\n{\n    pthread_mutex_lock(&amp;mtx_waiting);\n    assert(cycle == iteration || cycle == iteration - 1);\n    num_waiting++;\n    printf(\"--&gt;&gt; TID %d, I = %d (C = %d, W = %d)\\n\",\n           tid, iteration, cycle, num_waiting);\n    while (cycle != iteration &amp;&amp; num_waiting != MAX_THREADS)\n    {\n        assert(num_waiting &gt; 0 &amp;&amp; num_waiting &lt;= MAX_THREADS);\n        printf(\"-CW- TID %d, I = %d (C = %d, W = %d)\\n\",\n               tid, iteration, cycle, num_waiting);\n        pthread_cond_wait(&amp;cnd_waiting, &amp;mtx_waiting);\n    }\n    assert(cycle == iteration || num_waiting == MAX_THREADS);\n    printf(\"---- TID %d, I = %d (C = %d, W = %d)\\n\",\n           tid, iteration, cycle, num_waiting);\n\n    if (cycle != iteration)\n    {\n        gl_long = lrand48();\n        gl_rand = (float)gl_long;\n        num_waiting = 0;\n        cycle = iteration;\n        printf(\"---- TID %d generates cycle %d: L = %ld, F = %g\\n\",\n               tid, cycle, gl_long, gl_rand);\n        pthread_cond_broadcast(&amp;cnd_waiting);\n    }\n\n    printf(\"&lt;&lt;-- TID %d, I = %d (C = %d, W = %d) L = %ld, F = %g\\n\",\n           tid, iteration, cycle, num_waiting, gl_long, gl_rand);\n    pthread_mutex_unlock(&amp;mtx_waiting);\n    return gl_rand;\n}\n\nstatic void *thread_function(void *vp)\n{\n    int tid = (int)(uintptr_t)vp;     // Thuggish!\n\n    for (int i = 0; i &lt; MAX_CYCLES; i++)\n    {\n        float f = next_iteration_random_number(tid, i);\n        printf(\"TID %d at work: I = %d, F = %g\\n\", tid, i, f);\n        fflush(stdout);\n        struct timespec rq;\n        rq.tv_sec = 0;\n        rq.tv_nsec = (((gl_long &amp; 0xFF) + (0xF * tid))) % 200 * 50000000;\n        assert(rq.tv_nsec &gt;= 0 &amp;&amp; rq.tv_nsec &lt; 10000000000);\n        nanosleep(&amp;rq, 0);\n    }\n\n    return 0;\n}\n\nint main(int argc, char **argv)\n{\n    err_setarg0(argv[0]);\n    assert(argc == 1);\n\n    pthread_t thread[MAX_THREADS];\n\n    for (int i = 0; i &lt; MAX_THREADS; i++)\n    {\n        int rc = pthread_create(&amp;thread[i], 0, thread_function, (void *)(uintptr_t)i);\n        if (rc != 0)\n        {\n            errno = rc;\n            err_syserr(\"failed to create thread %d\", i);\n        }\n    }\n\n    for (int i = 0; i &lt; MAX_THREADS; i++)\n    {\n        void *vp;\n        int rc = pthread_join(thread[i], &amp;vp);\n        if (rc != 0)\n        {\n            errno = rc;\n            err_syserr(\"Failed to join TID %d\", i);\n        }\n        printf(\"TID %d returned %p\\n\", i, vp);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><sup>\n<em>Source at <a href=\"https://github.com/jleffler/soq/tree/master/src/so-4828-2480\" rel=\"nofollow noreferrer\">GitHub</a>.  Library code in <a href=\"https://github.com/jleffler/soq/tree/master/src/libsoq\" rel=\"nofollow noreferrer\"><code>libsoq</code></a>.  The routines starting <code>err_</code> are declared in header <code>stderr.h</code> and the supporting code is in <code>stderr.c</code>.  These greatly simplify error reporting.</em></sup></p>\n\n<p>The <code>main()</code> function is trivial; it launches 5 threads, and then waits to join 5 threads.  The only tricky bit is relaying the thread number as an argument to the thread function.  The code converts the integer value into a <code>uintptr_t</code>, then coerces that to a <code>void *</code>; the called function undoes this sequence</p>\n\n<p>The per-thread function is not complex.  It collects the thread number from its argument, then enters into a loop to iterate through the required number of cycles.  On each iteration, it passes the iteration number (and the thread number) to <code>next_iteration_random_number()</code>, which coordinates the random number generation.  The thread prints the data, then uses <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/nanosleep.html\" rel=\"nofollow noreferrer\"><code>nanosleep()</code></a> to sleep for a not easily discernible amount of time that is under 1 second.</p>\n\n<p>The interesting code is in <code>next_iteration_random_number()</code>.  First, the thread locks the mutex that controls the shared information. It then increments the number of waiting threads.  If the current cycle is not the same as iteration it is dealing with and the number of waiting threads is not equal to the total number of threads, then this thread calls <code>pthread_cond_wait()</code> to sleep until broadcast to.  When the thread gets out of the loop (either by waking up after a broadcast, or because it never entered the loop), the thread looks to see if the current cycle is the iteration it is expecting.  If not, it must be the last thread to try for this cycle \u2014 so it generates the random number and does the housekeeping to ensure that the other threads will know what is happening,\nand then it uses <code>pthread_cond_broadcast()</code> to signal all the sleeping threads to awaken.  They can't actually wake yet; the current thread still holds the mutex.  It reports what it is doing and unlocks the mutex, and returns the random number.  The other threads detect that the cycle number is the same as the iteration they were waiting for, so they can each print the information, unlock the mutex, and return the number.</p>\n\n<p>The key point is that each thread must know which iteration it is expecting to work on, and must sleep appropriately when that is not yet the current iteration.  There are assertions and printing operations aplenty in the code to help understand what's going on.</p>\n\n<p>Wholly separately, since <code>lrand48()</code> returns a <code>long</code> (albeit with a value in the range [0,2<sup>31</sup>), so it is a 32-bit value even when <code>long</code> is a 64-bit type), which means there's a very good chance that it returns values which cannot be represented accurately in a <code>float</code>, so the <code>gl_rand = (float)lrand48();</code> code snipped from the question is dubious.  (The sample code also records the <code>long</code> value in <code>gl_long</code> and uses that on occasion.)</p>\n\n<p>The code compiles cleanly on a Mac running macOS Sierra 10.12.3 with GCC 6.3.0 and compilation options set to fussy:</p>\n\n<pre><code>$ gcc -O3 -g -I../../inc -std=c11 -Wall -Wextra -Werror -Wmissing-prototypes \\\n&gt;     -Wstrict-prototypes -Wold-style-definition pthrd37.c -o pthrd37 \\\n&gt;     -L../../lib -lsoq \n$\n</code></pre>\n\n<h3>Sample run</h3>\n\n<p>Program configured with 3 threads and 5 cycles:</p>\n\n<pre><code>--&gt;&gt; TID 0, I = 0 (C = -1, W = 1)\n-CW- TID 0, I = 0 (C = -1, W = 1)\n--&gt;&gt; TID 2, I = 0 (C = -1, W = 2)\n-CW- TID 2, I = 0 (C = -1, W = 2)\n--&gt;&gt; TID 1, I = 0 (C = -1, W = 3)\n---- TID 1, I = 0 (C = -1, W = 3)\n---- TID 1 generates cycle 0: L = 851401618, F = 8.51402e+08\n&lt;&lt;-- TID 1, I = 0 (C = 0, W = 0) L = 851401618, F = 8.51402e+08\nTID 1 at work: I = 0, F = 8.51402e+08\n---- TID 0, I = 0 (C = 0, W = 0)\n&lt;&lt;-- TID 0, I = 0 (C = 0, W = 0) L = 851401618, F = 8.51402e+08\nTID 0 at work: I = 0, F = 8.51402e+08\n---- TID 2, I = 0 (C = 0, W = 0)\n&lt;&lt;-- TID 2, I = 0 (C = 0, W = 0) L = 851401618, F = 8.51402e+08\nTID 2 at work: I = 0, F = 8.51402e+08\n--&gt;&gt; TID 1, I = 1 (C = 0, W = 1)\n-CW- TID 1, I = 1 (C = 0, W = 1)\n--&gt;&gt; TID 0, I = 1 (C = 0, W = 2)\n-CW- TID 0, I = 1 (C = 0, W = 2)\n--&gt;&gt; TID 2, I = 1 (C = 0, W = 3)\n---- TID 2, I = 1 (C = 0, W = 3)\n---- TID 2 generates cycle 1: L = 1804928587, F = 1.80493e+09\n&lt;&lt;-- TID 2, I = 1 (C = 1, W = 0) L = 1804928587, F = 1.80493e+09\nTID 2 at work: I = 1, F = 1.80493e+09\n---- TID 1, I = 1 (C = 1, W = 0)\n&lt;&lt;-- TID 1, I = 1 (C = 1, W = 0) L = 1804928587, F = 1.80493e+09\nTID 1 at work: I = 1, F = 1.80493e+09\n---- TID 0, I = 1 (C = 1, W = 0)\n&lt;&lt;-- TID 0, I = 1 (C = 1, W = 0) L = 1804928587, F = 1.80493e+09\nTID 0 at work: I = 1, F = 1.80493e+09\n--&gt;&gt; TID 2, I = 2 (C = 1, W = 1)\n-CW- TID 2, I = 2 (C = 1, W = 1)\n--&gt;&gt; TID 1, I = 2 (C = 1, W = 2)\n-CW- TID 1, I = 2 (C = 1, W = 2)\n--&gt;&gt; TID 0, I = 2 (C = 1, W = 3)\n---- TID 0, I = 2 (C = 1, W = 3)\n---- TID 0 generates cycle 2: L = 758783491, F = 7.58783e+08\n&lt;&lt;-- TID 0, I = 2 (C = 2, W = 0) L = 758783491, F = 7.58783e+08\nTID 0 at work: I = 2, F = 7.58783e+08\n---- TID 2, I = 2 (C = 2, W = 0)\n&lt;&lt;-- TID 2, I = 2 (C = 2, W = 0) L = 758783491, F = 7.58783e+08\nTID 2 at work: I = 2, F = 7.58783e+08\n---- TID 1, I = 2 (C = 2, W = 0)\n&lt;&lt;-- TID 1, I = 2 (C = 2, W = 0) L = 758783491, F = 7.58783e+08\nTID 1 at work: I = 2, F = 7.58783e+08\n--&gt;&gt; TID 0, I = 3 (C = 2, W = 1)\n-CW- TID 0, I = 3 (C = 2, W = 1)\n--&gt;&gt; TID 2, I = 3 (C = 2, W = 2)\n-CW- TID 2, I = 3 (C = 2, W = 2)\n--&gt;&gt; TID 1, I = 3 (C = 2, W = 3)\n---- TID 1, I = 3 (C = 2, W = 3)\n---- TID 1 generates cycle 3: L = 959030623, F = 9.59031e+08\n&lt;&lt;-- TID 1, I = 3 (C = 3, W = 0) L = 959030623, F = 9.59031e+08\nTID 1 at work: I = 3, F = 9.59031e+08\n--&gt;&gt; TID 1, I = 4 (C = 3, W = 1)\n-CW- TID 1, I = 4 (C = 3, W = 1)\n---- TID 0, I = 3 (C = 3, W = 1)\n&lt;&lt;-- TID 0, I = 3 (C = 3, W = 1) L = 959030623, F = 9.59031e+08\nTID 0 at work: I = 3, F = 9.59031e+08\n---- TID 2, I = 3 (C = 3, W = 1)\n&lt;&lt;-- TID 2, I = 3 (C = 3, W = 1) L = 959030623, F = 9.59031e+08\nTID 2 at work: I = 3, F = 9.59031e+08\n--&gt;&gt; TID 0, I = 4 (C = 3, W = 2)\n-CW- TID 0, I = 4 (C = 3, W = 2)\n--&gt;&gt; TID 2, I = 4 (C = 3, W = 3)\n---- TID 2, I = 4 (C = 3, W = 3)\n---- TID 2 generates cycle 4: L = 684387517, F = 6.84388e+08\n&lt;&lt;-- TID 2, I = 4 (C = 4, W = 0) L = 684387517, F = 6.84388e+08\nTID 2 at work: I = 4, F = 6.84388e+08\n---- TID 1, I = 4 (C = 4, W = 0)\n&lt;&lt;-- TID 1, I = 4 (C = 4, W = 0) L = 684387517, F = 6.84388e+08\nTID 1 at work: I = 4, F = 6.84388e+08\n---- TID 0, I = 4 (C = 4, W = 0)\n&lt;&lt;-- TID 0, I = 4 (C = 4, W = 0) L = 684387517, F = 6.84388e+08\nTID 0 at work: I = 4, F = 6.84388e+08\nTID 0 returned 0x0\nTID 1 returned 0x0\nTID 2 returned 0x0\n</code></pre>\n\n<p>Notice that each thread happens to generate the random number at least once.  That's not something that can be guaranteed, but it shows that no one thread is privileged.</p>\n\n<h3><code>pthread_once()</code></h3>\n\n<p>A first version of this answer mentioned and illustrated the <code>pthread_once()</code> call.  This was not what was actually needed, but\nit could be useful in other contexts.</p>\n\n<p>Assuming you have a sufficiently POSIX-compliant system, if you want only one thread to do something, but it does not matter which thread does it, then I believe you're looking for <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_once.html\" rel=\"nofollow noreferrer\"><code>pthread_once()</code></a>.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic pthread_once_t once_only = PTHREAD_ONCE_INIT;\n\nstatic float gl_rand = 0;\n\nstatic void pt_once(void)\n{\n    gl_rand = (float)lrand48();\n}\n\nvoid *thread_function(void *vp)\n{\n     pthread_once(&amp;once_only, pt_once);\n     \u2026rest of the code\u2026\n     return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 4070124, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ce0f695c5e1eb6c22340d36e8697c06d?s=128&d=identicon&r=PG&f=1", "display_name": "frcake", "link": "https://stackoverflow.com/users/4070124/frcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 42822757, "answer_count": 1, "score": -1, "last_activity_date": 1489830750, "creation_date": 1489619660, "last_edit_date": 1489621214, "question_id": 42822480, "link": "https://stackoverflow.com/questions/42822480/posix-threads-unique-execution", "title": "POSIX Threads, unique execution", "body": "<p>Is there a way to be sure only 1 thread executes a specific function? </p>\n\n<pre><code>for (i = startnotfirst; i &lt; end; i++) {     \n\n    gl_rand = (float) lrand48();\n\n    fprintf(stderr, \"\\nTHREADING - #ID: %d - THIS IS MY RAND: %f\", *mytid,rand);\n    to_open = (rand / (float) INT_MAX) &lt; (points-&gt;p[i].cost / z);\n    if (to_open) {\n        //printf(\"\\nRANDOM: %f \\nINT_MAX: %d \\npointsDistance(cost): %f \\nZ: %f \\n\\n RESULT: %f &lt; %f\\n\\n\\n\",rand ,INT_MAX,points-&gt;p[1].cost , z,(rand / (float) INT_MAX),(points-&gt;p[i].cost / z));\n        fprintf(stderr, \"\\nTHREADING - #ID: %d - im working...\", *mytid);\n        t_kcenter++;\n        for (int k = start; k &lt; end; k++) {\n            float distance = dist(points-&gt;p[i], points-&gt;p[k], points-&gt;dim);\n            //If distance is smaller add it to that cluster.\n            float new_cost = distance * points-&gt;p[k].weight;\n            if (new_cost &lt; points-&gt;p[k].cost) {\n                points-&gt;p[k].cost = new_cost;\n                points-&gt;p[k].assign = i;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I want the gl_rand to be executed by only one thread and others know about the new rand value either by changing a <code>global variable</code> or <code>broadcasting</code>.</p>\n\n<p>Also the threads must all have ended their job <code>iteration body</code>  before a new number comes out!</p>\n\n<p>Any ideas? Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 3, "creation_date": 1489619342, "post_id": 42822394, "comment_id": 72756424, "body": "<code>list</code> is not initialized, so <code>list[i]</code> (which means <code>*(list + i)</code> is reading an uninitialized value, which is UB."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1489619350, "post_id": 42822394, "comment_id": 72756428, "body": "You must allocate <code>list</code>."}, {"owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "edited": false, "score": 0, "creation_date": 1489620984, "post_id": 42822394, "comment_id": 72756993, "body": "So, this question had me use <code>malloc()</code> for the first time, had me realize that <code>(m|c)alloc()</code> uses <code>char</code> as the size by default, and learn that <code>-Wall</code> is very important. I&#39;m pleased :)"}], "answers": [{"comments": [{"owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "edited": false, "score": 0, "creation_date": 1489619909, "post_id": 42822426, "comment_id": 72756621, "body": "...and after a quick look, <code>malloc()</code> allocates in bytes, which what an unsigned char is, which is why you didn&#39;t use <code>sizeof(thing)</code> I assume."}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "reply_to_user": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "edited": false, "score": 1, "creation_date": 1489620039, "post_id": 42822426, "comment_id": 72756663, "body": "it&#39;s guaranteed by the standard, see <a href=\"http://stackoverflow.com/questions/2215445/are-there-machines-where-sizeofchar-1-or-at-least-char-bit-8\" title=\"are there machines where sizeofchar 1 or at least char bit 8\">stackoverflow.com/questions/2215445/&hellip;</a>"}, {"owner": {"reputation": 937, "user_id": 6857253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dfc7c7e7460d19e1aa991c9dd42909c?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/6857253/segfault"}, "edited": false, "score": 1, "creation_date": 1489620081, "post_id": 42822426, "comment_id": 72756675, "body": "True, the allocation unit for malloc is the char, it is a good habit to always define allocation unit though."}, {"owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "edited": false, "score": 0, "creation_date": 1489620100, "post_id": 42822426, "comment_id": 72756686, "body": "Thank you Jack. I&#39;m accepting this one because you referenced <code>free()</code>."}, {"owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "reply_to_user": {"reputation": 937, "user_id": 6857253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dfc7c7e7460d19e1aa991c9dd42909c?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/6857253/segfault"}, "edited": false, "score": 0, "creation_date": 1489620567, "post_id": 42822426, "comment_id": 72756847, "body": "@SegFault re: specifying the alloc unit, yeah, that&#39;s how I think I&#39;ve always seen it done, so I&#39;m going to stick to that. However, I&#39;ve learned two new things here, one of which is if I see C code in the future without specifying the unit size within a <code>malloc&#47;calloc()</code> call, it may be a red flag, and to check what is actually being allocated to."}], "tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": true, "score": 1, "last_activity_date": 1489619403, "creation_date": 1489619403, "answer_id": 42822426, "question_id": 42822394, "link": "https://stackoverflow.com/questions/42822394/shared-lib-segfaulting-cant-figure-out-valgrind-error/42822426#42822426", "title": "Shared lib segfaulting; can&#39;t figure out valgrind error", "body": "<p>You never allocate memory for <code>unsigned char* list</code>, that has nothing to do with the fact that you are linking against a shared library.</p>\n\n<p><code>list</code> points to a garbage address, try by allocating it first:</p>\n\n<pre><code>unsigned char* list = malloc(3);\n</code></pre>\n\n<p>Mind that you must take care of freeing when it's no longer required through <code>free(list)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1489619584, "post_id": 42822448, "comment_id": 72756521, "body": "why would you want to cast the return value of <code>malloc</code> in C? a <code>void*</code> is implicitly promoted to any other pointer type."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489619605, "post_id": 42822448, "comment_id": 72756529, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 937, "user_id": 6857253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dfc7c7e7460d19e1aa991c9dd42909c?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/6857253/segfault"}, "edited": false, "score": 0, "creation_date": 1489619634, "post_id": 42822448, "comment_id": 72756540, "body": "Ok, it might be an old habit ;)"}], "tags": [], "owner": {"reputation": 937, "user_id": 6857253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dfc7c7e7460d19e1aa991c9dd42909c?s=128&d=identicon&r=PG&f=1", "display_name": "SegFault", "link": "https://stackoverflow.com/users/6857253/segfault"}, "is_accepted": false, "score": 1, "last_activity_date": 1489619616, "last_edit_date": 1489619616, "creation_date": 1489619509, "answer_id": 42822448, "question_id": 42822394, "link": "https://stackoverflow.com/questions/42822394/shared-lib-segfaulting-cant-figure-out-valgrind-error/42822448#42822448", "title": "Shared lib segfaulting; can&#39;t figure out valgrind error", "body": "<p>Why not allocating list:</p>\n\n<pre><code>unsigned char* list;\nlist = malloc(sizeof (unsigned char) * 3);\n</code></pre>\n\n<p>This will reserve space in memory to access <code>list[i]</code>.</p>\n"}], "owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 42822426, "answer_count": 2, "score": 1, "last_activity_date": 1489619616, "creation_date": 1489619248, "last_edit_date": 1489619407, "question_id": 42822394, "link": "https://stackoverflow.com/questions/42822394/shared-lib-segfaulting-cant-figure-out-valgrind-error", "title": "Shared lib segfaulting; can&#39;t figure out valgrind error", "body": "<p>I'm pretty new to C, and wanted to create a shared library for learning purposes. I have valgrind output below (<code>Invalid read of size 8</code>), but I am unsure where to look for the problem (hence, I can't recognize what the problem is).</p>\n\n<p>My question is whether I can get kind souls to have a look and let me know where I'm going wrong.</p>\n\n<p>My <code>.c</code> file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint mult (int x, int y){\n    return x * y;\n}\n\nvoid speak (const char* str){\n    printf(\"%s\\n\", str);\n}\n\nunsigned char* arr (){\n    unsigned char* list;\n\n    int i;\n\n    for (i=0; i&lt;3; i++){\n        list[i] = i;\n    }\n\n    return list;\n}\n</code></pre>\n\n<p>My header file:</p>\n\n<pre><code>int mult (int x, int y);\nvoid speak (const char* str);\nunsigned char* arr ();\n</code></pre>\n\n<p>My entry point file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"xswrap.h\"\n\nvoid main (){\n    int ret = mult(5, 5);\n    printf(\"%d\\n\", ret);\n\n    speak(\"hello, world!\");\n\n    unsigned char* list = arr(); \n\n    int i;\n\n    for (i=0; i&lt;3; i++){\n        printf(\"%d\\n\", list[i]);\n    }\n}\n</code></pre>\n\n<p>My compilation steps:</p>\n\n<pre><code>gcc -c -fPIC xswrap.c\ngcc -shared -fPIC -Wl,-soname,libxswrap.so -o libxswrap.so xswrap.o -lc\ngcc -o test main.c -L. -lxswrap\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>25\nhello, world!\n0\n1\n2\nSegmentation fault\n</code></pre>\n\n<p>Valgrind output:</p>\n\n<pre><code>==13410== Memcheck, a memory error detector\n==13410== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==13410== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==13410== Command: ./test\n==13410== \n==13410== Invalid read of size 8\n==13410==    at 0x4010C13: _dl_fini (dl-fini.c:235)\n==13410==    by 0x5075FF7: __run_exit_handlers (exit.c:82)\n==13410==    by 0x5076044: exit (exit.c:104)\n==13410==    by 0x505C836: (below main) (libc-start.c:325)\n==13410==  Address 0x620f08 is not stack'd, malloc'd or (recently) free'd\n==13410== \n==13410== \n==13410== Process terminating with default action of signal 11 (SIGSEGV)\n==13410==  Access not within mapped region at address 0x620F08\n==13410==    at 0x4010C13: _dl_fini (dl-fini.c:235)\n==13410==    by 0x5075FF7: __run_exit_handlers (exit.c:82)\n==13410==    by 0x5076044: exit (exit.c:104)\n==13410==    by 0x505C836: (below main) (libc-start.c:325)\n==13410==  If you believe this happened as a result of a stack\n==13410==  overflow in your program's main thread (unlikely but\n==13410==  possible), you can try to increase the size of the\n==13410==  main thread stack using the --main-stacksize= flag.\n==13410==  The main thread stack size used in this run was 8388608.\n==13410== \n==13410== HEAP SUMMARY:\n==13410==     in use at exit: 0 bytes in 0 blocks\n==13410==   total heap usage: 1 allocs, 1 frees, 4,096 bytes allocated\n==13410== \n==13410== All heap blocks were freed -- no leaks are possible\n==13410== \n==13410== For counts of detected and suppressed errors, rerun with: -v\n==13410== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)\nSegmentation fault\n</code></pre>\n"}, {"tags": ["c", "oop", "pointers", "struct"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618503, "post_id": 42822234, "comment_id": 72756099, "body": "Remove the <code>(Base *)</code> casts from <code>malloc()</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618614, "post_id": 42822234, "comment_id": 72756152, "body": "If there is padding, I believe it would be added to the end of the structure."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1489618737, "post_id": 42822234, "comment_id": 72756193, "body": "Your <code>typedef</code> syntax is wrong. It should be <code>typedef struct Base { ...} Base;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489618867, "post_id": 42822234, "comment_id": 72756246, "body": "It would be better to reuse the <code>Base</code> structure inside <code>Derived1</code>: <code>struct Derived1 { Base base; ... };</code>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1489619041, "post_id": 42822234, "comment_id": 72756311, "body": "It&#39;s undefined behavior. You&#39;re violating strict aliasing."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1489619385, "post_id": 42822234, "comment_id": 72756443, "body": "How can your code &quot;work&quot; if it doesn&#39;t even compile?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 2531813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf129111c48c75f7a00a4c02ae6f7ea?s=128&d=identicon&r=PG", "display_name": "Jonas Juffinger", "link": "https://stackoverflow.com/users/2531813/jonas-juffinger"}, "edited": false, "score": 0, "creation_date": 1489660887, "post_id": 42822403, "comment_id": 72772954, "body": "Thank you very much, that&#39;s exactly what I wanted to know. I don&#39;t know why I didn&#39;t come up with the idea of embedding Base into Derived1, that makes way more sense."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1489673205, "post_id": 42822403, "comment_id": 72781776, "body": "The best solution for this specific case is indeed to include <code>Base</code> as a member of <code>Derived</code>. Generally speaking though, there&#39;s another way to dodge the incompatible type issue, and that is to put both structs inside a union, which invokes the special rule of &quot;common initial sequence&quot;. 6.5.2.3/6."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 5, "last_activity_date": 1489619647, "last_edit_date": 1495542331, "creation_date": 1489619304, "answer_id": 42822403, "question_id": 42822234, "link": "https://stackoverflow.com/questions/42822234/dynamic-inheritance-in-c/42822403#42822403", "title": "&quot;Dynamic Inheritance&quot; in C", "body": "<p>According to C99 rules, these two <code>struct</code>s are incompatible:</p>\n\n<blockquote>\n  <p>two structure, union, or enumerated types declared in separate translation units are compatible if their tags and members satisfy the following requirements: If one is declared with a tag, the other shall be declared with the same tag. If both are complete types, then the following additional requirements apply: <strong>there shall be a one-to-one correspondence between their members</strong> such that each pair of corresponding members are declared with compatible types, and such that if one member of a corresponding pair is declared with a name, the other member is declared with the same name. For two structures, corresponding members shall be declared in the same order.</p>\n</blockquote>\n\n<p>Your code breaks one-to-one correspondence between members, so according to the standard this would be invalid:</p>\n\n<pre><code>Base *d1 = (Base*) bases[1];\nd1-&gt;a=5; // Not valid\n</code></pre>\n\n<p>Fortunately, you can easily make it valid by embedding <code>Base</code> into <code>Derived1</code>:</p>\n\n<pre><code>typedef struct Derived1 {\n  Base base;\n  // adding some other members to this struct\n  int otherMember;\n  int otherMember2;\n} Derived1;\n</code></pre>\n\n<p>According to C99,</p>\n\n<blockquote>\n  <p>A pointer to a structure object, suitably converted, points to its initial member</p>\n</blockquote>\n\n<p>Hence, this is valid:</p>\n\n<pre><code>Base *d1 = (Base*) bases[1];\nd1-&gt;a=5; // Valid\n</code></pre>\n\n<p><strong>Note:</strong> <a href=\"https://stackoverflow.com/q/8416417/335858\">This Q&amp;A</a> talks about a related topic of strict aliasing.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1489619966, "last_edit_date": 1495540450, "creation_date": 1489619966, "answer_id": 42822533, "question_id": 42822234, "link": "https://stackoverflow.com/questions/42822234/dynamic-inheritance-in-c/42822533#42822533", "title": "&quot;Dynamic Inheritance&quot; in C", "body": "<p><code>bases[1]-&gt;a = 5;</code> types the second block of the allocated memory with effective type <code>Base</code>. When you then access it in <code>if(d1-&gt;a == 5)</code>, through a pointer of type <code>Derived</code>, you (<a href=\"https://stackoverflow.com/a/42353998/1084774\">arguably</a>, though in accordance with how compilers generally interpret the rule) violate <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p7\" rel=\"nofollow noreferrer\">6.5p7</a> and thereby make your program undefined.</p>\n\n<p>You can make your code defined by using composition instead (make Base the first member (and first members have the same address as their host structs)), or, if you want uniform access to members from across a larger inheritance tree, you can use a strategy such as <a href=\"http://www.deleveld.dds.nl/inherit.htm\" rel=\"nofollow noreferrer\">Typesafe Inheritance in C</a>, which relies on unions.</p>\n\n<p>Alternatively, there are compiler extensions that bring real slicing inheritance into C. In clang and gcc, these extensions can be enabled with <code>-fms-extensions</code> or <code>-fplan9-extensions</code> (the latter is a superset of the former with more features\u2014see the documentation for more information).</p>\n"}], "owner": {"reputation": 101, "user_id": 2531813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf129111c48c75f7a00a4c02ae6f7ea?s=128&d=identicon&r=PG", "display_name": "Jonas Juffinger", "link": "https://stackoverflow.com/users/2531813/jonas-juffinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 42822403, "answer_count": 2, "score": 2, "last_activity_date": 1489619966, "creation_date": 1489618456, "last_edit_date": 1489619708, "question_id": 42822234, "link": "https://stackoverflow.com/questions/42822234/dynamic-inheritance-in-c", "title": "&quot;Dynamic Inheritance&quot; in C", "body": "<p>I wrote the following code and it works, but I would like to know if a can be sure that it works all the time on all x86 machines.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Base {\n  int a;\n  float b;\n} Base;\n\ntypedef struct Derived1 {\n  int a;      // This two members have the same position as in the Base\n  float b;\n\n  // adding some other members to this struct\n  int otherMember;\n  int otherMember2;\n} Derived1;\n\nint main()\n{\n  Base *bases[2];\n\n  // Filling the array with different structs\n  bases[0] = (Base*) malloc(sizeof(Base));\n  bases[1] = (Base*) malloc(sizeof(Derived1));\n\n  bases[1]-&gt;a = 5;\n  Derived1 *d1 = (Derived1*) bases[1];\n\n  if(d1-&gt;a == 5)\n    printf(\"SUCCESS\\n\");\n\n  return 0;\n}\n</code></pre>\n\n<p>I know why this example works, but does it work always? Is there padding or similar stuff going on that can prevent this from working, or does the C standard even support this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 2, "creation_date": 1489617680, "post_id": 42822050, "comment_id": 72755738, "body": "<code>ssize_t read</code> is BAD. <code>read</code> is a standard library function."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 7, "creation_date": 1489617942, "post_id": 42822050, "comment_id": 72755851, "body": "Not sure what you mean. Can you not operate on the data in the <code>line</code> buffer within the <code>while</code> loop?"}, {"owner": {"reputation": 21, "user_id": 5032464, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a98de982a5234a327402034c820cd998?s=128&d=identicon&r=PG&f=1", "display_name": "therealdev", "link": "https://stackoverflow.com/users/5032464/therealdev"}, "edited": false, "score": 0, "creation_date": 1489618817, "post_id": 42822050, "comment_id": 72756225, "body": "this while loop operates on the whole line at once, I want to perform the function on every char of each line."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1489618942, "post_id": 42822050, "comment_id": 72756275, "body": "then you can include an inner loop that loops through each char of the line you just read. But if you really want to read one char at a time you can use the <a href=\"https://linux.die.net/man/2/read\" rel=\"nofollow noreferrer\"><code>read</code></a> function. As DYZ says, change the name of your <code>ssize_t read</code> variable to something else to avoid confusion"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1489619279, "post_id": 42822050, "comment_id": 72756404, "body": "You have the <code>line</code>. All the characters are in that buffer. Use an inner loop to operate on each character. Otherwise, what is the point of reading <code>line</code> at all?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1489619951, "post_id": 42822050, "comment_id": 72756632, "body": "&quot;cannot perform the operations of the function on each character of the line&quot; is unclear as <code>line</code> is readily usable to operate on a <i>copy</i> of the file&#39;s line.  State the operations needed, else this post is unclear."}, {"owner": {"reputation": 21, "user_id": 5032464, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a98de982a5234a327402034c820cd998?s=128&d=identicon&r=PG&f=1", "display_name": "therealdev", "link": "https://stackoverflow.com/users/5032464/therealdev"}, "edited": false, "score": 0, "creation_date": 1489620093, "post_id": 42822050, "comment_id": 72756678, "body": "Can I use getc(line) to get each character from the line?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1489620158, "post_id": 42822050, "comment_id": 72756703, "body": "You can use array indexing to get the characters in <code>line</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489620209, "post_id": 42822050, "comment_id": 72756724, "body": "Note: As <code>ssize_t</code> is a <i>signed</i> integer type and could return -1, <code>printf(&quot;Retrieved line of length %zd :\\n&quot;, read);</code> (zd vs. zu) is better.  Yet that is not specified to be right either.  <code>printf(&quot;Retrieved line of length %lld :\\n&quot;, (long long) read);</code> will certainly work."}, {"owner": {"reputation": 21, "user_id": 5032464, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a98de982a5234a327402034c820cd998?s=128&d=identicon&r=PG&f=1", "display_name": "therealdev", "link": "https://stackoverflow.com/users/5032464/therealdev"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1489620243, "post_id": 42822050, "comment_id": 72756739, "body": "How would I do that @DavidBowling ? I am sorry, I am new to C."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1489620334, "post_id": 42822050, "comment_id": 72756772, "body": "Something like <code>for (size_t i = 0; line[i] != &#39;\\0&#39;; i++) { &#47;&#47;do something with line[i]};</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 1, "creation_date": 1489620452, "post_id": 42822050, "comment_id": 72756811, "body": "@DavidBowling <code>for (ssize_t i = 0; i &lt; read; i++) foo(line[i])</code> would handle null characters and a <code>read == -1</code> situation unlike <code>line[i] != &#39;\\0&#39;</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1489620534, "post_id": 42822050, "comment_id": 72756833, "body": "@chux-- Yes, that sounds better."}, {"owner": {"reputation": 21, "user_id": 5032464, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a98de982a5234a327402034c820cd998?s=128&d=identicon&r=PG&f=1", "display_name": "therealdev", "link": "https://stackoverflow.com/users/5032464/therealdev"}, "edited": false, "score": 0, "creation_date": 1489621126, "post_id": 42822050, "comment_id": 72757038, "body": "Thank You everyone!"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489687130, "post_id": 42822050, "comment_id": 72792115, "body": "between these two lines: <code>if (stream == NULL)         exit(EXIT_FAILURE);</code> should be the line: `perror( &quot;fopen for file.txt failed&quot; );  so the reason (as the OS see it) is also output, to stderr."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489687886, "post_id": 42822050, "comment_id": 72792598, "body": "when the <code>while()</code> loop exits, call <code>perror()</code> so the reason for the exit of the while() loop is output to stderr"}], "owner": {"reputation": 21, "user_id": 5032464, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/a98de982a5234a327402034c820cd998?s=128&d=identicon&r=PG&f=1", "display_name": "therealdev", "link": "https://stackoverflow.com/users/5032464/therealdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489617534, "creation_date": 1489617534, "question_id": 42822050, "link": "https://stackoverflow.com/questions/42822050/read-a-file-line-by-line-without-moving-the-pointer-from-the-beginning-of-a-line", "title": "Read a file line by line without moving the pointer from the beginning of a line in C", "body": "<p>I have a problem where I need to access a file and read out every line where I have to perform a function on each character of the line. So far what I have tried is using this bit of code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    FILE *stream;\n    char *line = NULL;\n    size_t len = 0;\n    ssize_t read;\n\n    stream = fopen(\"file.txt\", \"r\");\n    if (stream == NULL)\n        exit(EXIT_FAILURE);\n\n    while ((read = getline(&amp;line, &amp;len, stream)) != -1) {\n        printf(\"Retrieved line of length %zu :\\n\", read);\n        printf(\"%s\", line);\n    }\n\n    free(line);\n    fclose(stream);\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>However, when I try this,  I cannot perform the operations of the function on each character of the line as the character pointer has already moved to the end of each line after reading a line. </p>\n\n<p>How can I access each character of a line while reading the file line by line. Any help would be much appreciated. Thank You!</p>\n"}, {"tags": ["c", "unix", "permissions", "file-permissions"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489617536, "post_id": 42822035, "comment_id": 72755680, "body": "Did you see this with a debugger? or at least, did you attempt printing the values to the console? What are the values? Oh, and, is <code>owner</code> a <code>uid_t</code>?"}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489617896, "post_id": 42822035, "comment_id": 72755830, "body": "Well I know I own the file because i put it in the server and gave myself all the permissions for it using &quot;chmod 755 program.c&quot;. Despite doing this however, the owner of the file id is 59 and the user id is 526718308. Also i&#39;m sorry, but I dont know what a uid_t is or does. I&#39;m sort of learning these concepts as I go."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618209, "post_id": 42822035, "comment_id": 72755955, "body": "What happens if you try this <code>struct stat stbuf;     if (stat(__FILE__, &amp;stbuf) == -1)         return -1;     fprintf(stdout, &quot;%d, %d\\n&quot;, stbuf.st_uid, getuid());</code> what gets printed?"}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618328, "post_id": 42822035, "comment_id": 72756021, "body": "Sorry I did research and this is a child process so it is a pid_t I believe does that change anything?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618395, "post_id": 42822035, "comment_id": 72756051, "body": "What is a <code>pid_t</code>?"}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618442, "post_id": 42822035, "comment_id": 72756077, "body": "A process id I believe"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618571, "post_id": 42822035, "comment_id": 72756133, "body": "Yes I know, but I don&#39;t see any <code>pid_t</code> in your code."}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618597, "post_id": 42822035, "comment_id": 72756144, "body": "Hey I ran what you gave me and it gave this output. 526718303, 526718303"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1489618648, "post_id": 42822035, "comment_id": 72756166, "body": "How are you populating your <code>fileStat</code> structure? Also, <code>chmod</code> does not change the owner of the file, try <code>chown</code> instead. I believe the file is actually not owned by the <code>getuid()</code> user."}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489618970, "post_id": 42822035, "comment_id": 72756283, "body": "<a href=\"http://pastebin.com/YibvD148\" rel=\"nofollow noreferrer\">pastebin.com/YibvD148</a> here check out my code"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489619155, "post_id": 42822035, "comment_id": 72756360, "body": "Your code doesn&#39;t have a single call to <i>stat(2)</i>, I don&#39;t understand what your code is trying to do, it&#39;s highly unreadable and frankly it doesn&#39;t seem like it&#39;s your code because you are to lost about it."}, {"owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489619713, "post_id": 42822035, "comment_id": 72756562, "body": "I understand it fine lol. It&#39;s just a small part thats messing up. If you don&#39;t want to help thats fine."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489620531, "post_id": 42822035, "comment_id": 72756831, "body": "Don&#39;t take it wrong, I do want to help. But then, can you explain why there is no <code>stat()</code> called anywhere? If you want more help write to iharob@gmail.com"}], "owner": {"reputation": 11, "user_id": 6132571, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0zC9.jpg?s=128&g=1", "display_name": "theGrandWizod", "link": "https://stackoverflow.com/users/6132571/thegrandwizod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489617476, "creation_date": 1489617476, "question_id": 42822035, "link": "https://stackoverflow.com/questions/42822035/how-to-compare-user-id-and-owner-of-the-file-id", "title": "How to compare user id and owner of the file id?", "body": "<p>I'm currently trying to find out how to compare the user id to the actual owner of a file's id to check if the person is the owner. I am attempting to do this like so, but it is not working...</p>\n\n<pre><code>struct stat fileStat;\nowner = fileStat.st_uid;\nif(owner == getuid()){\n...\n}\n</code></pre>\n\n<p>Doing it this way, the owner id of the file never matches the user id even if I know that the user is in fact the owner of the file. Please help fix my code or provide sample code. Thank you!</p>\n"}, {"tags": ["c++", "c", "linux", "address-sanitizer", "memory-sanitizer"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1489617454, "post_id": 42821991, "comment_id": 72755650, "body": "Write unit tests. Lots. Then the unit tests may work without external dependencies and can be compiled in their entirety with instrumentation."}, {"owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1489618839, "post_id": 42821991, "comment_id": 72756233, "body": "@KerrekSB - A lot of my unit tests depend on Protocol Buffers, and I&#39;m getting errors within libprotobuf if I try to build with ASan, so unfortunately, that wouldn&#39;t be an easy change. And I&#39;d like to have integration tests run under the Sanitizers as well, if possible."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1489655992, "post_id": 42821991, "comment_id": 72769465, "body": "@KerrekSB Unit tests in a large project may still require lots of dependencies. Also in a typical legacy codebase you only have system tests, not units."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 1, "creation_date": 1489656077, "post_id": 42821991, "comment_id": 72769511, "body": "@JoshKelley &quot;using private aliases for globals&quot; - in practice bugs like this are extremely rare. Also note that they are working fine in GCC and we&#39;ve recently submitted a <a href=\"http://lists.llvm.org/pipermail/llvm-commits/Week-of-Mon-20160208/330654.html\" rel=\"nofollow noreferrer\">patch to Clang</a> to fix it there (not enabled by default yet, though)."}], "answers": [{"comments": [{"owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "edited": false, "score": 0, "creation_date": 1489700781, "post_id": 42822070, "comment_id": 72799256, "body": "After further investigation, you&#39;re right; I was running into <a href=\"https://github.com/google/protobuf/issues/1450\" rel=\"nofollow noreferrer\">github.com/google/protobuf/issues/1450</a>, which was the root of my problem (and was causing different symptoms in Clang vs. GCC, which led me down the wrong trail of blaming using uninstrumented code in Clang)."}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 1, "last_activity_date": 1489620833, "last_edit_date": 1489620833, "creation_date": 1489617646, "answer_id": 42822070, "question_id": 42821991, "link": "https://stackoverflow.com/questions/42821991/how-can-i-practically-use-addresssanitizer-and-memorysanitizer/42822070#42822070", "title": "How can I practically use AddressSanitizer and MemorySanitizer?", "body": "<p>The sanitizers can easily be used on your own code without rebuilding system dependencies. I do so routinely with a large(ish) 2M line code base on RHEL 6 &amp; 7 using both GCC and Clang - it's not a problem. If it is a problem; you are doing  it wrong (or there is a bug somewhere that needs fixing).</p>\n"}, {"tags": [], "owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "is_accepted": true, "score": 2, "last_activity_date": 1489651809, "creation_date": 1489651809, "answer_id": 42828475, "question_id": 42821991, "link": "https://stackoverflow.com/questions/42821991/how-can-i-practically-use-addresssanitizer-and-memorysanitizer/42828475#42828475", "title": "How can I practically use AddressSanitizer and MemorySanitizer?", "body": "<p>AddressSanitizer supports separate instrumentation i.e. you <em>can</em> instrument just parts of your program with it (separate DSOs or even separate object files). Note however that if you use static Asan runtime (which is default on Clang, unless you build with <code>-shared-libasan</code>) you must instrument main executable. Shared runtime (default in GCC) does not have this problem but you'll need to <code>LD_PRELOAD</code> it if executable isn't instrumented. See <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerAsDso\" rel=\"nofollow noreferrer\">discussion in wiki</a> for details.</p>\n\n<p>As for MemorySanitizer, it indeed requires all of it's dependencies to be rebuilt. This is the major reason why the tool isn't widely used outside Google.</p>\n"}], "owner": {"reputation": 49834, "user_id": 25507, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/DqZPI.png?s=128&g=1", "display_name": "Josh Kelley", "link": "https://stackoverflow.com/users/25507/josh-kelley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 1, "accepted_answer_id": 42828475, "answer_count": 2, "score": 2, "last_activity_date": 1489651809, "creation_date": 1489617317, "last_edit_date": 1489618351, "question_id": 42821991, "link": "https://stackoverflow.com/questions/42821991/how-can-i-practically-use-addresssanitizer-and-memorysanitizer", "title": "How can I practically use AddressSanitizer and MemorySanitizer?", "body": "<p>AddressSanitizer and MemorySanitizer are very useful tools, but they require that the <em>whole program</em> be appropriately instrumented. (At least, for the Clang version of AddressSanitizer; see <a href=\"https://clang.llvm.org/docs/MemorySanitizer.html#handling-external-code\" rel=\"nofollow noreferrer\">here</a> in the MemorySanitizer docs and the \"using private aliases for globals\" section of <a href=\"https://github.com/google/sanitizers/wiki/AddressSanitizerClangVsGCC\" rel=\"nofollow noreferrer\">AddressSanitizerClangVsGCC</a>.)</p>\n\n<p>If taken at its word, this means that all library dependencies need to be built with the appropriate compiler flags to enable ASan or MSan. For a typical Linux application that requires various third-party dependencies, what's a practical way of doing this?  The Sanitizers are apparently a Google project, and I get the impression that Google code mostly just uses their own monorepo and their own <a href=\"https://bazel.build/\" rel=\"nofollow noreferrer\">build tools</a>, but this may be outside of the reach of the average developer. Is there a simple way of getting libraries built with the Sanitizers without investing in a lot of extra infrastructure or build scripts?</p>\n"}, {"tags": ["c", "arrays", "list", "malloc"], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1489617183, "creation_date": 1489617183, "answer_id": 42821960, "question_id": 42821889, "link": "https://stackoverflow.com/questions/42821889/delete-element-from-double-linked-list-in-c/42821960#42821960", "title": "Delete element from double linked list in c", "body": "<p>You're trying to free one of the elements of <code>arr_el</code>.  These were <strong>not</strong> allocated by <code>malloc</code>, so you can't free them.</p>\n\n<p>What you're doing is dereferencing the pointer returned by <code>create_elem</code> and <em>copying</em> the values it contains into an element of <code>arr_el</code>.  This also means you have a memory leak.</p>\n\n<p>You should instead declare <code>arr_el</code> as an array of <em>pointers</em>:</p>\n\n<pre><code>struct list_el *arr_el[4];\n</code></pre>\n\n<p>Then you assign the return value of <code>create_elem</code> directly to one of these:</p>\n\n<pre><code>arr_el[i] = create_elem(&amp;arr_data[i]);\ninsert_l(l, arr_el[i]);\n</code></pre>\n\n<p>And you can then subsequently delete them:</p>\n\n<pre><code>del_el(l, arr_el[0]);\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7111245, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh3.googleusercontent.com/-L86LSZrkHsg/AAAAAAAAAAI/AAAAAAAAACU/JG89IfkBNaw/photo.jpg?sz=128", "display_name": "Euro Pe", "link": "https://stackoverflow.com/users/7111245/euro-pe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 42821960, "answer_count": 1, "score": 0, "last_activity_date": 1489617255, "creation_date": 1489616837, "last_edit_date": 1489617255, "question_id": 42821889, "link": "https://stackoverflow.com/questions/42821889/delete-element-from-double-linked-list-in-c", "title": "Delete element from double linked list in c", "body": "<p>I have a double linked list, here's structure I used:</p>\n\n<pre><code>struct list_el{\n    struct data* val;\n    struct list_el* next;\n    struct list_el* prev;\n};\n\nstruct list{\n    struct list_el* head;\n    struct list_el* tail;\n};\n</code></pre>\n\n<p>When I do it like this, everything works correctly, insert and delete functions are working as I wanted:</p>\n\n<pre><code>int main(){\n    struct data d1 = {\"Name1\",\"Surname1\"};\n    struct data d2 = {\"Name2\",\"Surname2\"};\n    struct data d3 = {\"Name3\",\"Surname3\"};\n    struct data d4 = {\"Name4\",\"Surname4\"};\n    struct list *l = create();\n    struct list_el *el1, *el2, *el3, *el4;\n    el1 = create_elem(&amp;d1);\n    el2 = create_elem(&amp;d2);\n    el3 = create_elem(&amp;d3);\n    el4 = create_elem(&amp;d4);\n    insert (l, el1);\n    insert (l, el2);\n    insert (l, el3);\n    insert (l, el4);\n    del_el(l, el1);\n}\n</code></pre>\n\n<p>The problem is when I want to do it on arrays:</p>\n\n<pre><code>struct data arr_data[4]={{\"Name1\",\"Surname1\"},{\"Name2\",\"Surname2\"},{\"Name3\",\"Surname3\"},{\"Name4\",\"Surname4\"}};\n\nstruct list_el arr_el[4];\n\nint main(){    \n    struct list *l = create_l();\n    for (int i=0; i&lt;4; i++) {\n         arr_el[i] = *create_elem(&amp;arr_data[i]);\n         insert_l(l, &amp;arr_el[i]);\n    }   \n    //Till now everythink works correctly\n\n    //Here's the problem\n    del_el(l, &amp;arr_el[0]);\n}\n</code></pre>\n\n<p>When I run it it shows me an error: </p>\n\n<pre><code>malloc: *** error for object 0x10002dfb0: pointer being freed was not allocated\n</code></pre>\n\n<p>Don't know why it happened. In <code>create_elem()</code> I use <code>malloc</code>. Any ideas? </p>\n"}, {"tags": ["c", "regex"], "comments": [{"owner": {"reputation": 1237, "user_id": 3781320, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f10b7ce3156c7372e355d0e5e498de?s=128&d=identicon&r=PG&f=1", "display_name": "RandomEli", "link": "https://stackoverflow.com/users/3781320/randomeli"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489617396, "post_id": 42821820, "comment_id": 72755622, "body": "@chux No, it&#39;s not the issue."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1489617520, "post_id": 42821820, "comment_id": 72755673, "body": "If you want to match only floating point numbers, then the period <code>.</code> must be required, not optional."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 2, "creation_date": 1489617587, "post_id": 42821820, "comment_id": 72755697, "body": "@DYZ: period is optional in floating point literals. However at least one digit either before or after the period is mandatory. OP&#39;s regex fails to match the valid <code>0.</code> or similar."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1489617778, "post_id": 42821820, "comment_id": 72755781, "body": "@R.. Without a period, how do you know if it&#39;s an FP literal or an integer literal?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1489618254, "post_id": 42821820, "comment_id": 72755980, "body": "@dyz floating-constant needs either a fractional-constant (.) or exponent-part (e,E,p)"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489618329, "post_id": 42821820, "comment_id": 72756023, "body": "@chux Sure, but the OP explicitly said he does not want exponentials."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1489618442, "post_id": 42821820, "comment_id": 72756075, "body": "@DYZ neither did OP say code need to distinguish  FP literal or an integer literal, just match floating point literals."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489618504, "post_id": 42821820, "comment_id": 72756101, "body": "@chux I said &quot;<i>*If* you want to match only floating point numbers...</i>&quot;. Did  you actually read my comment before commenting on it?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1489618569, "post_id": 42821820, "comment_id": 72756130, "body": "@Dyz <a href=\"http://stackoverflow.com/questions/42821820/c-regular-expression-does-not-match-floating-point-literals?noredirect=1#comment72755980_42821820\">My comment</a> was addressing <a href=\"http://stackoverflow.com/questions/42821820/c-regular-expression-does-not-match-floating-point-literals?noredirect=1#comment72755781_42821820\">this comment</a>.  I had not read the other comment in context to this."}], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 3781320, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f10b7ce3156c7372e355d0e5e498de?s=128&d=identicon&r=PG&f=1", "display_name": "RandomEli", "link": "https://stackoverflow.com/users/3781320/randomeli"}, "edited": false, "score": 0, "creation_date": 1489617867, "post_id": 42822034, "comment_id": 72755820, "body": "Most of the time I will just match certain strings, and I can use 0 as my flag. I should notice this before using it, thanks!"}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "reply_to_user": {"reputation": 1237, "user_id": 3781320, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f10b7ce3156c7372e355d0e5e498de?s=128&d=identicon&r=PG&f=1", "display_name": "RandomEli", "link": "https://stackoverflow.com/users/3781320/randomeli"}, "edited": false, "score": 0, "creation_date": 1489618091, "post_id": 42822034, "comment_id": 72755906, "body": "@LingboTang If I&#39;m reading the <code>re_format</code> manpage right, your regex should still have worked... but they didn&#39;t when I tested it. For what it&#39;s worth though, with POSIX regex you can still use <code>\\\\{min,max\\\\}</code> in place of <code>?</code>, <code>*</code> and <code>+</code> like so: <code>&quot;[+-]\\\\{0,1\\\\}[0-9]\\\\{0,\\\\}\\\\.\\\\{0,1\\\\}[0-9]\\\\{1,\\\\}&quot;</code> (monstrous, I know ;])"}, {"owner": {"reputation": 1237, "user_id": 3781320, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f10b7ce3156c7372e355d0e5e498de?s=128&d=identicon&r=PG&f=1", "display_name": "RandomEli", "link": "https://stackoverflow.com/users/3781320/randomeli"}, "edited": false, "score": 1, "creation_date": 1489618229, "post_id": 42822034, "comment_id": 72755964, "body": "That&#39;s more trouble some, I&#39;ll just let the flag to handle the complexity for me."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1489618962, "post_id": 42822034, "comment_id": 72756282, "body": "@Siguza: That&#39;s a useful trick to know for using <code>sed</code>, but in modern applications you just want <code>REG_EXTENDED</code>."}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1489619090, "post_id": 42822034, "comment_id": 72756332, "body": "@R.. Oh sure, I&#39;m not debating that. :P"}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 3, "last_activity_date": 1489617471, "creation_date": 1489617471, "answer_id": 42822034, "question_id": 42821820, "link": "https://stackoverflow.com/questions/42821820/c-regular-expression-does-not-match-floating-point-literals/42822034#42822034", "title": "C: Regular Expression does not match floating point literals", "body": "<p>You need to add the <code>REG_EXTENDED</code> flag when calling <code>regcomp</code> or else adapt your regex to be compatible with POSIX BRE (Basic Regular Expressions, the legacy syntax used by <code>sed</code> and <code>grep</code> without <code>-E</code>). BRE is the default and probably not what you want.</p>\n"}], "owner": {"reputation": 1237, "user_id": 3781320, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f10b7ce3156c7372e355d0e5e498de?s=128&d=identicon&r=PG&f=1", "display_name": "RandomEli", "link": "https://stackoverflow.com/users/3781320/randomeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 42822034, "answer_count": 1, "score": 2, "last_activity_date": 1489618362, "creation_date": 1489616545, "last_edit_date": 1489618362, "question_id": 42821820, "link": "https://stackoverflow.com/questions/42821820/c-regular-expression-does-not-match-floating-point-literals", "title": "C: Regular Expression does not match floating point literals", "body": "<p>I'm writing a simple script to match floating points literals, only <code>+123.23</code>, <code>-123.23</code> or <code>123.23</code> etc should be matched, so I don't match those <code>-1.0e-10</code> form. So my expression is as simple as: <code>[+-]?([0-9]*[.])?[0-9]+</code> which will capture the sign, digits, dot and fraction for me optionally. And my C validation looks like:</p>\n\n<pre><code>reti = regcomp(&amp;regex, \"[+-]?([0-9]*[.])?[0-9]+\", 0);\nif (reti) {\n    fprintf(stderr, \"Could not compile regex of floating literals\\n\");\n    exit(1);\n}\n\nchar * testString = \"-87.21\";\nreti = regexec(&amp;regex, testString, 0, NULL, 0);\nif (!reti) {\n    printf(\"%s \\n\", testString);\n}\n</code></pre>\n\n<p>However, the value of reti is 1, which means my regex on test string \"-87.21\" failed. I tested my regex on regexr.com, it matches \"-87.21\", So I don't really know what happens here. Is there anyone can help?</p>\n"}, {"tags": ["c", "malloc", "singly-linked-list"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1489616313, "post_id": 42821746, "comment_id": 72755183, "body": "Use a debugger to find out exactly where the program is looping and what the linked list looks like at that point. That&#39;s the right way to debug such small programs. Only turn to Stackoverflow after you have exhausted all avenues of debugging on your own."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1489616455, "post_id": 42821746, "comment_id": 72755242, "body": "Turn on full compiler warnings. You have problems in your <code>fscanf()</code> call, it should be <code>&amp;tempPtr-&gt;priority</code> and <code>&amp;tempPtr-&gt;readingLevel</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489616585, "post_id": 42821746, "comment_id": 72755296, "body": "You need to allocate space for <code>tempPtr-&gt;firstName</code> and <code>tempPtr-&gt;lastName</code> every time you allocate another <code>student</code>. Maybe you should just declare these as arrays in the structure instead of pointers."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "edited": false, "score": 0, "creation_date": 1489620157, "post_id": 42821977, "comment_id": 72756702, "body": "ok so now when I call this function in main I am seg faulting. I ran through line by line in the function which doesn&#39;t seem to be having issues. In main I have it as head = buildStudentList(student, head). Where head = NULL and student is of char type set to argv[1]."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "edited": false, "score": 0, "creation_date": 1489620796, "post_id": 42821977, "comment_id": 72756938, "body": "I just tried it and it worked fine. Maybe you have a problem somewhere else in your program."}, {"owner": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "edited": false, "score": 0, "creation_date": 1489621221, "post_id": 42821977, "comment_id": 72757067, "body": "Ok so this is how it is called in main. Not too sure where I could get this seg fault issue. Ran GDB but does not seem to be showing exactly the source of the seg fault. int main(int argc, char* argv[]) {         if (argc &lt; 1 || argc &gt; 4)         {                 printf(&quot;INVALID USE OF PROGRAM\\n&quot;);                 return 0;         }         char* file = argv[1];         //char* wishlist = argv[2];           student* first = NULL;          first = buildStudentList(file, first);         //printStudents(head);           return 0; }"}, {"owner": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "edited": false, "score": 0, "creation_date": 1489621267, "post_id": 42821977, "comment_id": 72757086, "body": "If I comment out the function I do not get a seg fault issue."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "edited": false, "score": 0, "creation_date": 1489621339, "post_id": 42821977, "comment_id": 72757111, "body": "That doesn&#39;t mean the problem is in this function. If you have undefined behavior, it can cause errors in unrelated code."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1489617270, "creation_date": 1489617270, "answer_id": 42821977, "question_id": 42821746, "link": "https://stackoverflow.com/questions/42821746/create-link-list-from-text-file/42821977#42821977", "title": "Create link list from text file", "body": "<p>I suggest you change the <code>student</code> structure so that <code>firstName</code> and <code>lastName</code> are arrays rather than pointers. There's no need to use dynamic allocation when they're always the same size.</p>\n\n<pre><code>typedef struct Student{\n    char firstName[NAME];\n    char lastName[NAME];\n    int priority;\n    int readingLevel;\n    bookIds* wishlist;\n    struct Student* next;\n}student;\n</code></pre>\n\n<p>Next, whenever you allocate a new <code>student</code>, you need to initialize the <code>wishList</code> and <code>next</code> pointers to <code>NULL</code>.</p>\n\n<p>When you call <code>fscanf()</code>, you need to pass pointers to the <code>int</code> members that you're filling in.</p>\n\n<p>You can simplify your code by doing the <code>malloc()</code> in just one place, rather than before the loop and then repeating it in each branch of the <code>if</code>. Read the input into local variables, then allocate the <code>student</code> once that has succeeded.</p>\n\n<pre><code>typedef struct Student{\n    char firstName[NAME];\n    char lastName[NAME];\n    int priority;\n    int readingLevel;\n    bookIds* wishlist;\n    struct Student* next;\n}student;    \n\nstudent* buildStudentList(char* studentsFile, student* head)\n{\n    int i;\n    FILE* fp;\n    if((fp = fopen(studentsFile, \"r\")) == NULL)\n        {\n            printf(\"Unable to open file\\n\");\n            return 0;\n        }\n\n    student* current = NULL;\n\n    char firstName[NAME], lastName[NAME];\n    int priority, readingLevel;\n\n    while(fscanf(fp, \"%s %s %d %d\",firstName, lastName, &amp;priority, &amp;readingLevel) != EOF)\n        {\n            student* tempPtr = malloc(sizeof(student));\n            tempPtr-&gt;next = NULL;\n            tempPtr-&gt;wishlist = NULL;\n            strcpy(tempPtr-&gt;firstName, firstName);\n            strcpy(tempPtr-&gt;lastName, lastName);\n            tempPtr-&gt;priority = priority;\n            tempPtr-&gt;readingLevel = readingLevel;\n\n            if(head == NULL)\n                {\n                    head = tempPtr;\n                }\n            else\n                {\n                    current-&gt;next = tempPtr;\n                }\n            current = tempPtr;\n        }\n    fclose(fp);\n    return head;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6020269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd0e163aea694a239515181a11ab247?s=128&d=identicon&r=PG&f=1", "display_name": "BeePOSE", "link": "https://stackoverflow.com/users/6020269/beepose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489617270, "creation_date": 1489616233, "last_edit_date": 1489616345, "question_id": 42821746, "link": "https://stackoverflow.com/questions/42821746/create-link-list-from-text-file", "title": "Create link list from text file", "body": "<p>Having trouble reading in text file and storing it within a linked list. I am reading in a file that has first name, l name, priority, and reading level. I believe the issue could either be that I am not properly mallocing the strings/tempPtr, or that my loop is continually running. When running the program, it is continually running, no seg faults. </p>\n\n<pre><code>typedef struct Student{\n    char* firstName;\n    char* lastName;\n    int priority;\n    int readingLevel;\n    bookIds* wishlist;\n    struct Student* next;\n}student;    \n\nstudent* buildStudentList(char* studentsFile, student* head)\n{\n    int i;\n    FILE* fp;\n    student* tempPtr = NULL;\n    if((fp = fopen(studentsFile, \"r\")) == NULL)\n        {\n            printf(\"Unable to open file\\n\");\n            return 0;\n        }\n\n    student* current = NULL;\n    tempPtr = (student*)malloc(sizeof(student));\n    tempPtr-&gt;firstName = malloc(sizeof(char)* NAME);\n    tempPtr-&gt;lastName = malloc(sizeof(char)* NAME);\n\n    while(fscanf(fp, \"%s %s %d %d\",tempPtr-&gt;firstName, tempPtr-&gt;lastName, tempPtr-&gt;priority, tempPtr-&gt;readingLevel) != EOF)\n        {\n            tempPtr-&gt;next = NULL;\n            if(head == NULL)\n                {\n                    head = tempPtr;\n                    current = tempPtr;\n                    tempPtr = (student*)malloc(sizeof(student));\n                }\n            else\n                {\n                    current-&gt;next = tempPtr;\n                    current = tempPtr;\n                    tempPtr = (student*)malloc(sizeof(student));\n                }\n        }\n    free(tempPtr);\n    fclose(fp);\n    return head;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "realloc", "heap-corruption"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2933559"}, "edited": false, "score": 1, "creation_date": 1489615858, "post_id": 42821633, "comment_id": 72754987, "body": "Try running the program in Valgrind or Dr. Memory. It&#39;ll tell you where it detected invalid memory accesses."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1489616050, "post_id": 42821633, "comment_id": 72755081, "body": "<code>C = tmp;</code> is wrong. That sets a <i>local</i> variable and does not change the function caller&#39;s variable. So the caller&#39;s version of <code>C</code> will still be the old value - which has been freed by <code>realloc</code> so the result is invalid memory accesses and memory corruption as you have observed."}, {"owner": {"reputation": 17, "user_id": 7697995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7uLXx5DYnYw/AAAAAAAAAAI/AAAAAAAADl8/JK--XHRxJaY/photo.jpg?sz=128", "display_name": "Artur Yuzkiv", "link": "https://stackoverflow.com/users/7697995/artur-yuzkiv"}, "edited": false, "score": 0, "creation_date": 1489647224, "post_id": 42821633, "comment_id": 72764725, "body": "Kaylum, how can I fix my problem? In which way I must resize an array?"}, {"owner": {"reputation": 17, "user_id": 7697995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7uLXx5DYnYw/AAAAAAAAAAI/AAAAAAAADl8/JK--XHRxJaY/photo.jpg?sz=128", "display_name": "Artur Yuzkiv", "link": "https://stackoverflow.com/users/7697995/artur-yuzkiv"}, "edited": false, "score": 0, "creation_date": 1489647297, "post_id": 42821633, "comment_id": 72764765, "body": "bace1000, I download a Dr. Memory, but don&#39;t understand how it run on Windows"}, {"owner": {"reputation": 17, "user_id": 7697995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7uLXx5DYnYw/AAAAAAAAAAI/AAAAAAAADl8/JK--XHRxJaY/photo.jpg?sz=128", "display_name": "Artur Yuzkiv", "link": "https://stackoverflow.com/users/7697995/artur-yuzkiv"}, "edited": false, "score": 0, "creation_date": 1489666269, "post_id": 42821633, "comment_id": 72776664, "body": "I have solved a problem, thank you, kaylum!)"}, {"owner": {"reputation": 17, "user_id": 7697995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7uLXx5DYnYw/AAAAAAAAAAI/AAAAAAAADl8/JK--XHRxJaY/photo.jpg?sz=128", "display_name": "Artur Yuzkiv", "link": "https://stackoverflow.com/users/7697995/artur-yuzkiv"}, "edited": false, "score": 0, "creation_date": 1489905021, "post_id": 42821633, "comment_id": 72869693, "body": "Passing pointer to pointer I&#39;ve gotten ride of my problem: <code>void reallocationC(double ** C, int n){ \t*C =  realloc(*C, (n)*sizeof(**C)); \tif(!(*C)){ \t\tprintf(&quot;Error! Memore isn&#39;t reallocated!&#39;&quot;); \t} }</code>"}], "owner": {"reputation": 17, "user_id": 7697995, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7uLXx5DYnYw/AAAAAAAAAAI/AAAAAAAADl8/JK--XHRxJaY/photo.jpg?sz=128", "display_name": "Artur Yuzkiv", "link": "https://stackoverflow.com/users/7697995/artur-yuzkiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489616115, "creation_date": 1489615794, "last_edit_date": 1489616115, "question_id": 42821633, "link": "https://stackoverflow.com/questions/42821633/heap-corruption-on-resize-array-by-realloc-function-in-c", "title": "Heap Corruption on resize array by realloc() function in C", "body": "<h1>I have a problem with increasing C[] array from 6 to 10 I've faced with heap corruption problem by realloc(). I have a following code of Big M metod:</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint * mnInit(FILE * );\ndouble * * ReadA(FILE * , int, int);\ndouble * ReadVector(FILE * , int);\nint * condtxt(FILE *, int );\nvoid Artif_counter(int* , int *, int);\nvoid reallocationA(double**, int* , int , int);\nvoid increaseA(int*, double**, int, int, int);\nvoid increaseC(double *, int);\nint main(int argc, char * argv[]) {\n\n  FILE * file1 = fopen(\"C.txt\", \"r\");\n  FILE * file4 = fopen(\"A.txt\", \"r\");\n  FILE * file5 = fopen(\"Agetmn.txt\", \"r\");\n  FILE * file6 = fopen(\"cond.txt\", \"r\");\n\n  int * ptr_mn;\n  ptr_mn = mnInit(file5);\n  int n = * (ptr_mn);\n  int m = * (ptr_mn + 1);\n\n  double * * A;\n  A = ReadA(file4, n, m);\n  double * C;\n  C = ReadVector(file1, n);\n  int * cond;\n  cond = condtxt(file6, m);\n  for(int i = 0; i &lt; m; i++){\n  }\n//--------------------------------------------------\nint BAcounter = 0;\nArtif_counter(cond, &amp;BAcounter, m);\nprintf(\"\\n  Basys and Artifical variable = %d\", BAcounter);\nreallocationA(A, &amp;n, m, BAcounter);\nincreaseA(cond, A, n, m, BAcounter);\n</code></pre>\n\n<hr>\n\n<p>this function dont't working</p>\n\n<pre><code>increaseC(C, n); \n</code></pre>\n\n<hr>\n\n<p>When I trying to print arrays: the A[][] was printed right while C[] array <b>was printed</b> by unknown numbers and after the program Mmetod.exe was closed with problem: <b>A heap has been corrupted (parameters: 0x00007FFCA0C1F6B0).</b></p>\n\n<pre><code> // count of basys and artif\n //------------------------------------------------After Adding a new columns:\n printf(\"\\n A[][] ARRAY:\\n\");\n for (int i = 0; i &lt; m; i++) {\n printf(\"%d \", i);\n for (int j = 0; j &lt; n; j++) {\n  printf(\" %.3f \", A[i][j]);\n }\n  printf(\"\\n\");\n }\n\n printf(\"\\n\\tVECTOR C[]:\\n\");\n for (int i = 0; i &lt; n; i++) {\n printf(\"%lf \", C[i]);\n }\n fclose(file1);\n fclose(file4);\n fclose(file5);\n fclose(file6);\n free(C);\n for (int i = 0; i &lt; m; i++) {\n free(A[i]);\n }\n free(A);\n printf(\"\\n\\n\");\n system(\"pause\");\n return 0;\n}\n\nint * mnInit(FILE * file) {\nint c;\nint digit = 0;\nint column = 0;\nint * mnArray = malloc(2 * sizeof( * mnArray));\nif (file == NULL) perror(\"Warning!\");\nelse {\nwhile (!feof(file)) {\n  c = fgetc(file);\n  if (c == ';') {\n    column++;\n  }\n  if (c == ' ') {\n    digit++;\n  }\n }\n}\n* (mnArray) = (digit / column) + 1; * (mnArray + 1) = column;\nreturn mnArray;\n}\n\ndouble * * ReadA(FILE * file, int n, int m) {\n  double * * A = malloc(m * sizeof( * A));\n  for (int i = 0; i &lt; m; i++) {\n  A[i] = malloc(n * sizeof( * A[i]));\n  }\n\n  for (int i = 0; i &lt; m; i++) {\n  for (int j = 0; j &lt; n; j++) {\n  //fscanf(file ,\"%lf \", &amp;(*(*(A + i) + j)));\n  fscanf(file, \"%lf \", &amp; A[i][j]);\n      }\n  fscanf(file, \"\\n\");\n    }\n  return A;\n  }\n double * ReadVector(FILE * file, int m) { // ++++\n      double * Vector = malloc(m * sizeof( * Vector));\n      for (int i = 0; i &lt; m; i++) {\n        fscanf(file, \"%lf \", Vector + i);\n      }\n      return Vector;\n     }\n\n   int* condtxt(FILE * file, int m){\n      int * condA = malloc(m * sizeof(*condA));\n    for(int i = 0; i &lt; m; i++){\n    fscanf(file, \"%d\", &amp;condA[i]);\n   }\n    return condA;\n  }\n\nvoid Artif_counter(int * cond, int *k, int m){\n\n    for(int i = 0; i &lt; m; i++){\n        if(cond[i] == -1){\n            (*k)++;\n        }\n        if(cond[i] == 0){\n        (*k)++;\n        }\n        if(cond[i] == 1){\n        *k = (*k) + 2;\n        }\n    }\n }\nvoid reallocationA(double** A, int* n, int m, int k){\n    double * tmp = NULL;\n    for(int i = 0; i &lt; m; i++){\n        tmp = realloc(A[i], ((*n) + k)*sizeof(*A[i]));\n        if(tmp){\n            A[i] = tmp;\n            tmp = NULL;\n        } else{\n            printf(\"Error! Memory isn't reallocated'\");\n            tmp = NULL;\n        }\n    }\n    (*n) = (*n) + k;\n }\nvoid increaseA(int* cond, double** A, int n, int m, int k){\n    int presentcol = n-k;\n    for(int i = 0; i &lt; m; i++){\n        if(cond[i] == -1){\n            for(int j = 0; j &lt; m; j++){\n                if(j == i){\n                    A[j][presentcol] = 1;\n                } else {\n                    A[j][presentcol] = 0;\n                }\n            }\n            presentcol++;\n        }\n        if(cond[i] == 0){\n            for(int j = 0; j &lt; m; j++){\n                if(j == i){\n                    A[j][presentcol] = 1;\n                } else {\n                    A[j][presentcol] = 0;\n                }\n        }\n        presentcol++;\n    }\n        if(cond[i] == 1){\n            for(int j = 0; j &lt; m; j++){\n                if(j == i){\n                    A[j][presentcol] = 1;\n                    A[j][presentcol + 1] = -1;\n                    } else {\n                    A[j][presentcol] = 0;\n                    A[j][presentcol + 1] = 0;\n                    }\n                }\n            presentcol = presentcol + 2;\n            }\n        }\n    }\n</code></pre>\n\n<hr>\n\n<p>When I wanted to increase an array in a simple code by this function it've done and I don't understand why(\n<strong>A GNU debugger rewiev: 0 warning: Critical error detected c0000374</strong></p>\n\n<pre><code>    void increaseC(double * C, int n){\n     double * tmp;\n     tmp =  realloc(C, (n)*sizeof(*C)); // found out that realloc function caused an error\n     if(!tmp){\n     printf(\"Error\");\n     } else{\n      C = tmp;\n     }\n      tmp = NULL;\n    }\n</code></pre>\n"}, {"tags": ["c", "function", "scanf", "dynamic-allocation"], "comments": [{"owner": {"reputation": 142870, "user_id": 8747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1ee0402d24625f555c25ea8511aad31?s=128&d=identicon&r=PG", "display_name": "Rob\u1d69", "link": "https://stackoverflow.com/users/8747/rob%e1%b5%a9"}, "edited": false, "score": 0, "creation_date": 1489615594, "post_id": 42821553, "comment_id": 72754858, "body": "What, precisely, is your question?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489615794, "post_id": 42821553, "comment_id": 72754954, "body": "POSIX has a <code>getline()</code> function that does what you want. Can you use that?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489615806, "post_id": 42821553, "comment_id": 72754960, "body": "Are you trying to re-invent the 1000th version of <code>fgets</code> or <code>getline</code>? And using the name<code>read</code> is a very bad idea, because that is commonly already defined by your platforms system library."}, {"owner": {"reputation": 35, "user_id": 5563174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zWdpE.jpg?s=128&g=1", "display_name": "Ferro", "link": "https://stackoverflow.com/users/5563174/ferro"}, "edited": false, "score": 0, "creation_date": 1489616467, "post_id": 42821553, "comment_id": 72755245, "body": "Well I was trying to create an argument-less version of this <code>read()</code> function. I can&#180;t seem to make it through all the` *` and pointers . Seemed like a good practice but I didn&#180;t remember about the <code>getline()</code> or the <code>fgets()</code> functions. I&#39;ll try them ,thanks."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489615737, "post_id": 42821576, "comment_id": 72754924, "body": "<code>fgets()</code> won&#39;t reallocate the array if it&#39;s not long enough for the whole line."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489615756, "post_id": 42821576, "comment_id": 72754936, "body": "Yes, that&#39;s why I suggest <code>getline()</code>."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489615597, "creation_date": 1489615597, "answer_id": 42821576, "question_id": 42821553, "link": "https://stackoverflow.com/questions/42821553/how-to-create-a-substitute-for-scanf/42821576#42821576", "title": "How to create a substitute for scanf()", "body": "<p>You really don't need to roll your own, just use <a href=\"http://man7.org/linux/man-pages/man3/fgets.3p.html\" rel=\"nofollow noreferrer\">fgets()</a>.</p>\n\n<p>Also if you MUST roll your own <a href=\"http://man7.org/linux/man-pages/man3/getdelim.3.html\" rel=\"nofollow noreferrer\">getline()</a> function, do it with <a href=\"http://man7.org/linux/man-pages/man3/fgetc.3p.html\" rel=\"nofollow noreferrer\">fgetc()</a> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5563174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zWdpE.jpg?s=128&g=1", "display_name": "Ferro", "link": "https://stackoverflow.com/users/5563174/ferro"}, "edited": false, "score": 0, "creation_date": 1489616907, "post_id": 42821728, "comment_id": 72755438, "body": "wow , levels of indirection , not knowing this makes me feel like a complete newbie in C but thanks @Barmar it worked wonderfully. Thank you all"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1489616181, "creation_date": 1489616181, "answer_id": 42821728, "question_id": 42821553, "link": "https://stackoverflow.com/questions/42821553/how-to-create-a-substitute-for-scanf/42821728#42821728", "title": "How to create a substitute for scanf()", "body": "<p>The problem with your function is that you've declared too many levels of indirection. You declare</p>\n\n<pre><code>char **a = NULL;\n</code></pre>\n\n<p>and then assign to <code>*a</code>. But since <code>a == NULL</code>, this indirects through a null pointer, which is undefined behavior.</p>\n\n<p>You don't need an extra level of indirection for a local variable, that's only needed for a parameter so you can update the caller's variable.</p>\n\n<p>You should also check for EOF when reading. Instead of using <code>scanf()</code>, use <code>getc()</code>.</p>\n\n<pre><code>char *read2() {\n    int i = 0;\n    char *a = NULL;\n\n    while (1) {\n        a = (char *)realloc(a, (i + 1) * sizeof(char));\n        int c = getc(stdin);\n        if (c == '\\n' || c == EOF) {\n            break;\n        } else {\n            a[i] = c;\n            i++;\n        }\n    }\n    a[i] = '\\0';\n    return a;\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5563174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zWdpE.jpg?s=128&g=1", "display_name": "Ferro", "link": "https://stackoverflow.com/users/5563174/ferro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 42821728, "answer_count": 2, "score": -2, "last_activity_date": 1489616181, "creation_date": 1489615494, "question_id": 42821553, "link": "https://stackoverflow.com/questions/42821553/how-to-create-a-substitute-for-scanf", "title": "How to create a substitute for scanf()", "body": "<p>After having so many problems using the scanf() function I decided to search for an alternative to read whole strings (and by whole strings I mean words mixed with white spaces and numbers etc, until a \\n is found) from the keyboard. I stumbled upon an interesting bit of code here on stackoverflow.\nSo I changed that code to be more dynamic, I wanted to allocate memmory after a char input from the keyboard. I got it to work but only with <code>char **a</code> as an argument and ,in main(), I would call it like this <code>read(&amp;w);</code>.My idea is to create an argument-less function so that I can use it without having to declare a variable <code>char *w</code> each time I need to read a string. Here's the code I got:</p>\n\n<pre><code>char *read(char **a) {\nint i = 0;\n\nwhile (1) {\n    *a = (char *)realloc(*a, (i + 1) * sizeof(char));\n    scanf(\"%c\", &amp;(*(*a + i)));\n\n    if ( *(*a+i) == '\\n')\n        break;\n    else \n        i++;\n}\n*(*a+i) = '\\0';\nreturn *a;}\n</code></pre>\n\n<p>Now i'm trying to modify this function to take no arguments but I'm getting write/read access violation errors :</p>\n\n<pre><code>char *read2() {\nint i = 0;\nchar **a = NULL;\n\nwhile (1) {\n\n    *a = (char *)realloc(*a, (i + 1) * sizeof(char)) // Error here\n        scanf(\"%c\", &amp;(*(*a + i)));\n        if (*(*a + i) == '\\n') { break; }\n        else { i++; }\n}\n    *(*a + i) = '\\0';\nreturn *a;}\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 46515, "user_id": 5647260, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oByMV.jpg?s=128&g=1", "display_name": "Andrew Li", "link": "https://stackoverflow.com/users/5647260/andrew-li"}, "edited": false, "score": 3, "creation_date": 1489615405, "post_id": 42821513, "comment_id": 72754765, "body": "For starters, use <code>==</code> for comparison, not <code>=</code>!"}, {"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 1, "creation_date": 1489615405, "post_id": 42821513, "comment_id": 72754767, "body": "<code>dis = 0</code> should be <code>dis == 0</code>"}], "answers": [{"comments": [{"owner": {"reputation": 46515, "user_id": 5647260, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/oByMV.jpg?s=128&g=1", "display_name": "Andrew Li", "link": "https://stackoverflow.com/users/5647260/andrew-li"}, "edited": false, "score": 4, "creation_date": 1489615467, "post_id": 42821536, "comment_id": 72754798, "body": "You should comment and flag as a typographical error instead of answering."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2933559"}, "is_accepted": false, "score": 0, "last_activity_date": 1489615434, "creation_date": 1489615434, "answer_id": 42821536, "question_id": 42821513, "link": "https://stackoverflow.com/questions/42821513/code-is-skipping-a-command-in-the-program-c/42821536#42821536", "title": "Code is skipping a command in the program. (C)", "body": "<p>You're using the operator <code>=</code> when you want the operator <code>==</code>.</p>\n\n<p><code>a == b</code> checks if 2 numbers are equal, while <code>a = b</code> sets the first to the value of the second. </p>\n\n<p>In other words, change <code>dis = 0</code> to <code>dis == 0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 738, "user_id": 7572026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/340e7b48d6bfe006ce1b6f7161911df2?s=128&d=identicon&r=PG&f=1", "display_name": "Manav Dubey", "link": "https://stackoverflow.com/users/7572026/manav-dubey"}, "is_accepted": true, "score": 0, "last_activity_date": 1489616500, "last_edit_date": 1489616500, "creation_date": 1489615642, "answer_id": 42821593, "question_id": 42821513, "link": "https://stackoverflow.com/questions/42821513/code-is-skipping-a-command-in-the-program-c/42821593#42821593", "title": "Code is skipping a command in the program. (C)", "body": "<p>If you look at you <code>if</code> statement for <code>dis = 0</code>, it should:</p>\n\n<pre><code>if(dis == 0)\n</code></pre>\n\n<p>That should fix all your problems. Nice job with the code. Just a beginner mistake.</p>\n"}], "owner": {"reputation": 51, "user_id": 7717744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b60980ec48e05e0fe43df9232deaeab4?s=128&d=identicon&r=PG&f=1", "display_name": "Manav Dubey - Streetsville SS ", "link": "https://stackoverflow.com/users/7717744/manav-dubey-streetsville-ss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1489617541, "accepted_answer_id": 42821593, "answer_count": 2, "score": -1, "last_activity_date": 1489616500, "creation_date": 1489615331, "question_id": 42821513, "link": "https://stackoverflow.com/questions/42821513/code-is-skipping-a-command-in-the-program-c", "closed_reason": "Not suitable for this site", "title": "Code is skipping a command in the program. (C)", "body": "<p>Brief Description of Code: It's a quadratic equation calculator. It helps you find the roots of an equation.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nmain(){\n  int a, b, c, real;\n  float root1, root2, img, dis;\n  char solve;\n\n  printf(\"Do you want to solve an equation (y/n): \");//Ask user if they want to solve an equation\n  scanf(\"%c\", &amp;solve);\n\n  if(solve == 'n'){//Terminate program\n    return 0;\n  }\n\n  if(solve == 'y'){//Code for calculation\n    printf(\"\\nInput the number\");\n    printf(\"\\n````````````````\");\n    printf(\"\\nA: \");//Store number for a, b, c for the quadratic formula\n    scanf(\"%d\", &amp;a);\n    printf(\"\\nB: \");\n    scanf(\"%d\", &amp;b);\n    printf(\"\\nC: \");\n    scanf(\"%d\", &amp;c);\n\n    dis = (b*b) - (4*a*c);//calculation for the discriminent\n\n    //printf(\"%f\", dis); Check the discriminant value\n\n    if(dis &gt; 0){//Calculation for the real root\n      root1 = ((b*-1) + sqrt(dis))/(2*a);\n      root2 = ((b*-1) - sqrt(dis))/(2*a);\n\n      printf(\"\\nRoot 1: %.2f\", root1);\n      printf(\"\\nRoot 2: %.2f\", root2);\n\n      return 0;\n    }\n\n    if(dis = 0){//Calculation for no discriminent\n      root1 = (b*-1)/(2*a);\n      printf(\"\\nRoot 1 and 2: %.2f\", root1);\n      return 0;\n    }\n\n    if(dis &lt; 0){//Calculation for complex root\n     dis = dis * -1;\n\n     //printf(\"\\n%f\", dis);  !!!Testing to see why the code isn't functioning!!! It skipped this\n\n     root1 = (b*-1)/(2*a);\n     img = (sqrt(dis))/(2*a);\n\n     printf(\"Root 1 and 2: %.2f \u00b1 %.2f\", root1, img);\n\n     return 0; \n    }\n  }\n}\n</code></pre>\n\n<p>Problem: It works perfectly fine if the discriminant is greater than zero. But when it's equal to or less than zero, it skips everything in the code for some reason. I'm having trouble finding the error. I put in printf statement to see what is the value of the discriminant and I kept a printf statement in the if statement to see if it will printf anything, but it skipped that.</p>\n\n<p>Output I got:</p>\n\n<pre><code>gcc version 4.6.3\nDo you want to solve an equation (y/n):  y\n\nInput the number\n````````````````\nA:  1\nB:  2\nC:  5 //It ends here\n</code></pre>\n\n<p>Output I want:</p>\n\n<pre><code>gcc version 4.6.3\nDo you want to solve an equation (y/n):  y\n\nInput the number\n````````````````\nA:  1\nB:  2\nC:  5\nRoot 1 and 2: -1\u00b12i\n</code></pre>\n"}, {"tags": ["c", "matrix", "graph"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2933559"}, "edited": false, "score": 0, "creation_date": 1489615291, "post_id": 42821484, "comment_id": 72754713, "body": "Why are you trying to do graphics with the console? Just output to an bitmap. Here&#39;s a pretty simple image format if you need help. <a href=\"http://netpbm.sourceforge.net/doc/ppm.html\" rel=\"nofollow noreferrer\">netpbm.sourceforge.net/doc/ppm.html</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489615774, "post_id": 42821484, "comment_id": 72754949, "body": "<code>matrix=(char**)malloc(max*sizeof(char*));</code> --&gt; <code>matrix=(char**)malloc(count*sizeof(char*));</code>  note : <code>matrix[rows][columns]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489617237, "post_id": 42821484, "comment_id": 72755562, "body": "fix like <a href=\"http://ideone.com/Nnq4Ki\" rel=\"nofollow noreferrer\">this</a> You need <code>matrix[count][max]</code> or <code>matrix[max][count]</code>."}, {"owner": {"reputation": 141, "user_id": 7508922, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/d8ae61f31c8b7106f4b1bd925821354e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie18", "link": "https://stackoverflow.com/users/7508922/newbie18"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489638847, "post_id": 42821484, "comment_id": 72761646, "body": "thank you it works perfect now! @BLUEPIXY"}], "answers": [{"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1489695575, "creation_date": 1489695575, "answer_id": 42844036, "question_id": 42821484, "link": "https://stackoverflow.com/questions/42821484/drawing-a-vertical-graph-of-based-on-stdin-in-c/42844036#42844036", "title": "Drawing a Vertical Graph of # based on stdin in C", "body": "<p>The problem is that OP is allocating enough memory to store <code>max * max</code> characters (where <code>max</code> is the maximum value entered), while what they need is <code>max * count</code> (where <code>count</code> is number of values entered) if only positive numbers are allowed.</p>\n\n<p>Moreover, the program leaks memory, as the proper <code>free</code> calls are missing.</p>\n\n<p>An easier way to deal with memory managment (if OP can compile with a C99 compliant compiler) is using a Variable Length Array:</p>\n\n<pre><code>char matrix[rows][cols];        // where rows and cols aren't known at compile time\n</code></pre>\n\n<p>If VLA aren't an option, the memory can still be allocated contiguously:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nchar **matrix = malloc(rows * sizeof(*matrix));\nif ( !matrix )\n    exit(EXIT_FAILURE);\nmatrix[0] = malloc(rows * cols * sizeof(**matrix));\nif ( !matrix[0] ) {\n    free(matrix);\n    exit(EXIT_FAILURE);\n}\nfor ( int i = 1; i &lt; rows; ++i )\n    matrix[i] = matrix[i - 1] + cols;\n\n// do something with 'matrix'...\n\nfree(matrix[0]);\nfree(matrix); \n</code></pre>\n\n<p>Another potential issue is that the loop responsible for the input doesn't limit the number of values entered to the size of the buffer (80) nor checks if those values are really numbers.</p>\n\n<p>The following is a complete working implementation (with some helper functions):</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"limits.h\"\n\n#define MAX_ARR_SIZE 80\n\nint min (int a, int b) {\n    return a &lt; b ? a : b;\n}\n\nint max (int a, int b) {\n    return a &gt; b ? a : b;\n}\n\nvoid draw_bar_chart (FILE *out_stream, char fill_char,\n                     int *arr, int size,\n                     int bottom, int top);\n\nint read_ints (FILE *in_stream,\n               int *arr, int size,\n               int *min, int *max);\n\nint main(void) {\n    int min_value, max_value;\n    int values[MAX_ARR_SIZE];\n    int n_values = read_ints(stdin, values, MAX_ARR_SIZE,\n                             &amp;min_value, &amp;max_value);\n    // Avoid clipping the chart\n    int top_view = max(max_value, 0);\n    int bottom_view = min(min_value, 0);\n\n    draw_bar_chart(stdout, '#', values, n_values, bottom_view, top_view);\n}\n\nint read_ints (FILE *in_stream,\n               int *arr, int size,\n               int *min, int *max) {\n    int count = 0;\n    *min = INT_MAX;\n    *max = INT_MIN;\n    // Reads up to 'size' values to avoid buffer overflow.\n    while ( count &lt; size  &amp;&amp;  fscanf(in_stream, \"%d\", &amp;arr[count]) == 1 )\n    { // note that it stops when the read fails (EOF or not an int) ^^^^\n        if ( arr[count] &gt; *max )\n            *max = arr[count];\n        if ( arr[count] &lt; *min )\n            *min = arr[count];\n        ++count;\n    }\n    return count;\n}\n\nvoid tidy_up (int a, int b, int *min, int *max) {\n    if ( a &gt; b ) {\n        *min = b;\n        *max = a;\n    } else {\n        *min = a;\n        *max = b;\n    }\n}\n\nvoid draw_bar_chart (FILE *out_stream, char fill_char,\n                     int *arr, int size,\n                     int bottom, int top) {\n    int draw_height = top - bottom;\n    int i, j, start, end;\n\n    // VLA, requires a C99 compliant compiler\n    char canvas[draw_height][size + 1];\n    // null-terminates every row to make output easier\n    for ( i = 0; i &lt; draw_height; ++i )\n        canvas[i][size] = '\\0';\n    // The \"drawing\" can be done in many ways...\n    for ( j = 0; j &lt; size; ++j ) {\n        tidy_up(top, top - arr[j], &amp;start, &amp;end);\n        for ( i = 0; i &lt; start; ++i )\n            canvas[i][j] = ' ';\n        for ( ; i &lt; end; ++i )\n            canvas[i][j] = fill_char;\n        for ( ; i &lt; draw_height; ++i )\n            canvas[i][j] = ' ';\n    }\n\n    for ( i = 0; i &lt; draw_height; ++i ) {\n        fprintf(out_stream, \"%s\\n\", canvas[i]);\n    }    \n}\n</code></pre>\n\n<p>Which, given for example those inputs</p>\n\n<pre><code>1 5 6 9 8 7 3 2 0 -3 -8 -5 -4 1 1 2 0 1 q\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>   #\n   ##\n   ###\n  ####\n #####\n #####\n ######\n #######       #\n########     ### #\n         ####\n         ####\n         ####\n          ###\n          ##\n          #\n          #\n          #\n</code></pre>\n\n<hr>\n\n<p>It's worth noting that for this particular task, we don't need to use a temporary 2D array at all. The function responsible for printing the chart can be implemented like this:</p>\n\n<pre><code>void draw_bar_chart (FILE *out_stream, char fill_char,\n                     int *arr, int size,\n                     int bottom, int top) {\n    int start, end;\n    // \"draws\" the chart by determining if the current position is inside a bar\n    for ( int i = top - 1; i &gt;= bottom; --i ) {\n        for ( int j = 0; j &lt; size; ++j ) {\n            tidy_up(0, arr[j], &amp;start, &amp;end);\n            putc((i &gt;= start  &amp;&amp;  i &lt; end ? fill_char : ' '), out_stream);\n        }\n        puts(\"\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 7508922, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/d8ae61f31c8b7106f4b1bd925821354e?s=128&d=identicon&r=PG&f=1", "display_name": "Newbie18", "link": "https://stackoverflow.com/users/7508922/newbie18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489695575, "creation_date": 1489615229, "last_edit_date": 1489622229, "question_id": 42821484, "link": "https://stackoverflow.com/questions/42821484/drawing-a-vertical-graph-of-based-on-stdin-in-c", "title": "Drawing a Vertical Graph of # based on stdin in C", "body": "<p>I've written a program that reads integer values from stdin, separated by one or more spaces or newlines, until reaching EOF. The input will contain no more than 80 values.</p>\n\n<p>On standard output, I want to create a simple vertical column graph based the input values, in order left to right, using hash <code>#</code> characters. The number of hashes printed in each column is be equal to the corresponding input value.</p>\n\n<p>The area above a completed column is filled with space characters.</p>\n\n<p>I have this so far and it works correctly for inputs that are 4 numbers or greater, but when I input 2 or 3 numbers I get a seg fault. Can anyone see why?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, const char*argv) {\n\n    int arr[80];\n    int count=0;\n    int i,j;\n\n    while(1) {\n        if((scanf(\"%d\", &amp;arr[count++]))==EOF) {\n            break;\n        }\n    }\n    int max=arr[0];\n    for(i=0; i&lt;count; i++) {\n        if(max&lt;arr[i]) {\n            max=arr[i];\n        }\n    }\n\n    char **matrix;\n    matrix=(char**)malloc(max*sizeof(char*));\n\n    for(i=0;i&lt;count;i++) {\n        matrix[i]=(char*)malloc(sizeof(char)*max);\n    }\n\n    for(i=0;i&lt;count-1;i++) {\n        for(j=max-1;j&gt;=0;j--) {\n            if(max-j&lt;=arr[i]) {\n                 matrix[j][i]='#';\n            }\n            else {\n                matrix[j][i]=' ';\n            }\n        }\n    }\n\n    for(i=0;i&lt;max;i++) {\n        for(j=0;j&lt;count;j++) {\n            printf(\"%c\", matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1489614496, "post_id": 42821270, "comment_id": 72754348, "body": "add a <code>position</code> variable before the loop, initialise it to 1, increment it at the end of the loop and change <code>sum  = sum + digit;</code> to <code>sum  += pow(digit,pos);</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489614640, "post_id": 42821270, "comment_id": 72754416, "body": "<a href=\"http://stackoverflow.com/questions/42821270/c-program-that-calculates-sum-of-digits-of-a-number-raised-to-the-power-of-their#comment72754348_42821270\">Do this</a> or use a for loop, and there you will have the &quot;<i>position</i>&quot; <code>pos</code> variable <code>for (int pos = 1 ; num &gt; 0 ; ++pos)</code>."}, {"owner": {"reputation": 438, "user_id": 5500955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPhR9.jpg?s=128&g=1", "display_name": "Code4aliving", "link": "https://stackoverflow.com/users/5500955/code4aliving"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1489614731, "post_id": 42821270, "comment_id": 72754453, "body": "@George That&#39;s a great idea, but unfortunately the code above is getting at the digits from right to left, and she wants to read the digits from left to right.  It might be better all around to read in a string, and do it that way.  Step through the string until it&#39;s not a number, decoding actual digits from characters (char - &#39;0&#39;).  Then your position logic would be cool... (but of course she&#39;d have to take into account that pos would range from 1 to n, but when dereferencing the string to be sure to use &quot;pos-1&quot;."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489615359, "post_id": 42821270, "comment_id": 72754744, "body": "From a mathematical view, the digist start from the rightmost. And that position would be <code>0</code>, not <code>1</code>."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 438, "user_id": 5500955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPhR9.jpg?s=128&g=1", "display_name": "Code4aliving", "link": "https://stackoverflow.com/users/5500955/code4aliving"}, "edited": false, "score": 0, "creation_date": 1489615514, "post_id": 42821270, "comment_id": 72754823, "body": "@BradBales ah crud, totally missed that; thanks for pointing it out. Looks like an answer corrected the oversight :-)"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1489619359, "post_id": 42821270, "comment_id": 72756431, "body": "You are printing sum with %d which is not correct for long. Use %ld"}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 5500955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPhR9.jpg?s=128&g=1", "display_name": "Code4aliving", "link": "https://stackoverflow.com/users/5500955/code4aliving"}, "edited": false, "score": 0, "creation_date": 1489614805, "post_id": 42821325, "comment_id": 72754483, "body": "Unfortunately the requirements are to read the digits from left to right.  The original code and this code does it from right to left..."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 438, "user_id": 5500955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPhR9.jpg?s=128&g=1", "display_name": "Code4aliving", "link": "https://stackoverflow.com/users/5500955/code4aliving"}, "edited": false, "score": 1, "creation_date": 1489615072, "post_id": 42821325, "comment_id": 72754617, "body": "@BradBales count number of digits, then start working on the number the same way and decrement the counter number of digits after calling pow function."}, {"owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489615992, "post_id": 42821325, "comment_id": 72755045, "body": "Thank you @TonyTannous appreciate it, however does this code work for the digits from left to right as in the example?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489616416, "post_id": 42821325, "comment_id": 72755220, "body": "@KaraWetzelC yes it does."}, {"owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489617643, "post_id": 42821325, "comment_id": 72755727, "body": "Hey @TonyTannous so I updated the code according to your instructions and it still gives me the wrong answer. The updated code can be found in the latest edit to the question."}, {"owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489617675, "post_id": 42821325, "comment_id": 72755732, "body": "Can you edit so it gives out the right answer and help me figure out how you did?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489617843, "post_id": 42821325, "comment_id": 72755809, "body": "@KaraWetzelC yes sure. One moment"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489618019, "post_id": 42821325, "comment_id": 72755880, "body": "@KaraWetzelC remove the first while loop... you have 3 while loops and you don&#39;t need the first."}, {"owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489618418, "post_id": 42821325, "comment_id": 72756067, "body": "@TonyTannous I did remove the while loop but the code still returns the wrong value..."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1489618816, "post_id": 42821325, "comment_id": 72756223, "body": "What input did you try ?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1489619052, "post_id": 42821325, "comment_id": 72756318, "body": "Did you remove the forst while loop?"}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1489619106, "post_id": 42821325, "comment_id": 72756339, "body": "And use int for a while instead of long"}, {"owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "edited": false, "score": 0, "creation_date": 1489619313, "post_id": 42821325, "comment_id": 72756416, "body": "Yeah I removed the first while loop. Okay hold on."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489619421, "post_id": 42821325, "comment_id": 72756460, "body": "<code>double pow(double, double)</code> is subject to slightly non-whole valued  results, even whole-valued operands.  <code>pow(7,7)</code> may result in <code>823542.9999...</code> and then truncate to <code>823542</code> on <code>int</code> assignment.  Better to avoid <code>&lt;math.h&gt;</code> functions for an integer problem."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489619549, "post_id": 42821325, "comment_id": 72756508, "body": "@Chux I used my own ipow function so I guess Op also has his own and is not using the one from math. A simple search in google with give him results for a self implemented pow."}], "tags": [], "owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "is_accepted": false, "score": 3, "last_activity_date": 1489614999, "last_edit_date": 1489614999, "creation_date": 1489614546, "answer_id": 42821325, "question_id": 42821270, "link": "https://stackoverflow.com/questions/42821270/c-sum-of-digits-raised-to-the-power-of-their-position/42821325#42821325", "title": "C sum of digits raised to the power of their position", "body": "<p>This is pretty simple, create an extra function where you send it the digit position + the digit it self, the function will return digit^i. Add that to the sum.</p>\n\n<pre><code>int countDigits = 0\nint temp = num\nwhile (temp &gt; 0)\n{\n    countDigits += 1;\n    temp /= 10;\n}\n\ni = 0;\nsum = 0;\nwhile (num &gt; 0)\n{\n    digit = num % 10;\n    sum  = sum + pow(digit, countDigits);\n    countDigits -= 1;\n    num /= 10;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1489616478, "post_id": 42821756, "comment_id": 72755252, "body": "He&#39;s probably learning <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> just now and it would just confuse him at this stage. A recursion would be cool but I don&#39;t think he still knows it as well."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489619169, "post_id": 42821756, "comment_id": 72756363, "body": "Suggest consistency <code>if (n % 2) ... n&#47;=2;</code> or  <code>if (n &amp; 1) ...   n &gt;&gt;= 1;</code>.  The first is more portable."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1489616272, "creation_date": 1489616272, "answer_id": 42821756, "question_id": 42821270, "link": "https://stackoverflow.com/questions/42821270/c-sum-of-digits-raised-to-the-power-of-their-position/42821756#42821756", "title": "C sum of digits raised to the power of their position", "body": "<p>Rather than reading the number in and then trying to sum up the powered digits, it's a little easier to do it all at once.</p>\n\n<p>Here's a solution, that uses <code>ipow</code> -- raising <code>x</code> to the power <code>n</code> using exponentiation by squaring. You could equally well replace this with a loop that goes <code>n</code> times, since your <code>n</code> can't get very large.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nlong ipow(long x, int n) {\n    long r = 1;\n    while (n) {\n        if (n % 2) r *= x;\n        x *= x;\n        n &gt;&gt;= 1;\n    }\n    return r;\n}\n\nint main() {\n    long sum = 0;\n\n    printf(\"Enter the number \\n\");\n    long n = 0;\n    for (int pos = 1; ; pos++) {\n        int c = getchar() - '0';\n        if (c &lt; 0 || c &gt; 9) break;\n        sum += ipow(c, pos);\n        n = 10 * n + c;\n    }\n    printf(\"Number is: %ld\\n\", n);\n    printf(\"Powered digit sum is: %ld\\n\", sum);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7625287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17af78f00bf007b50b19d1ae8402893?s=128&d=identicon&r=PG&f=1", "display_name": "Kara Wetzel C", "link": "https://stackoverflow.com/users/7625287/kara-wetzel-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1877, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520628486, "creation_date": 1489614312, "last_edit_date": 1520628486, "question_id": 42821270, "link": "https://stackoverflow.com/questions/42821270/c-sum-of-digits-raised-to-the-power-of-their-position", "title": "C sum of digits raised to the power of their position", "body": "<p>I'm trying to write a C program that calculates the sum of digits of a number raised to the power of their position.</p>\n\n<p>Ex: \nUser inputs <code>5672</code>,\nOutput should be <code>5^1 + 6^2 + 7^3 + 2^4</code>.\nThe first digit in the number <code>5</code> is raised to the power <code>1</code> because it's the first digit. It's the same logic in every case.</p>\n\n<p>I have come up with the code to calculate the sum of digits of a number, however, I'm having trouble generating the code about how to raise these numbers to a certain power.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n    long num, digit, sum = 0;\n    int countDigits = 0;\n    long temp = num;\n    int i;\n\n    printf(\"Enter the number \\n\");\n    scanf(\"%ld\", &amp;num);\n    temp = num;\n    while (num &gt; 0) {\n        digit = num % 10;\n        sum  = sum + digit;\n        num /= 10;\n    }\n    printf(\"Given number = %ld\\n\", temp);\n    printf(\"Sum of the digits %ld = %ld\\n\", temp, sum);\n\n    while (temp &gt; 0) {\n      countDigits += 1;\n      temp /= 10;\n    }\n\n    i = 0;\n    sum = 0;\n    while (num &gt; 0) {\n        digit = num % 10;\n        sum = sum + pow(digit, countDigits);\n        countDigits -= 1;\n        num /= 10;\n    }\n\n    printf(\"The final sum is %d\\n\", sum);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "mariadb", "mysql-connector"], "comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1489613992, "post_id": 42821091, "comment_id": 72754107, "body": "Re &quot;<i>Using mysql -u -p works</i>&quot;, yeah, but what about <code>mysql -h 127.0.0.1 -u -p</code>?"}, {"owner": {"reputation": 383, "user_id": 7430498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a446f41b898b962b5fea9cfe2f1a6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Rojas", "link": "https://stackoverflow.com/users/7430498/luis-rojas"}, "reply_to_user": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1489615076, "post_id": 42821091, "comment_id": 72754618, "body": "It also works. That&#39;s why I am so lost with this problem. Everything seems to work, except the C function."}, {"owner": {"reputation": 4774, "user_id": 547065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca7b22b90c1506277b6f7ead24eb21c?s=128&d=identicon&r=PG", "display_name": "Vladislav Vaintroub", "link": "https://stackoverflow.com/users/547065/vladislav-vaintroub"}, "edited": false, "score": 0, "creation_date": 1489696797, "post_id": 42821091, "comment_id": 72797524, "body": "Do you use any non-ascii characters in your password?"}, {"owner": {"reputation": 383, "user_id": 7430498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a446f41b898b962b5fea9cfe2f1a6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Rojas", "link": "https://stackoverflow.com/users/7430498/luis-rojas"}, "edited": false, "score": 0, "creation_date": 1489711417, "post_id": 42821091, "comment_id": 72802737, "body": "No, it was a very simple password, just to test , few letters and numbers, as shown on the code I posted."}], "owner": {"reputation": 383, "user_id": 7430498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a446f41b898b962b5fea9cfe2f1a6ec?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Rojas", "link": "https://stackoverflow.com/users/7430498/luis-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1330, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1606895792, "creation_date": 1489613608, "last_edit_date": 1593969702, "question_id": 42821091, "link": "https://stackoverflow.com/questions/42821091/mysql-real-connect-in-c-fails-with-access-denied-for-user", "title": "mysql_real_connect() in C fails with &quot;Access denied for user&quot;", "body": "<p>I have been dealing all day with this problem, and I can't find a solution.\nI can't connect to mariadb from C (fedora24) using mysql_real_connect(). It always fails with Access denied for user, Error Code 1045, SQL State 28000</p>\n\n<p>All proposed solutions in internet are related to wrong password, wrong interface (localhost and not 127.0.0.1, for instance) or privileges, and so people could not connect using sql client.\nBut the fact is that I can connect using the sql client, with my user and also with root. I just can't with the C function. Using mysql -u -p works for both users, root and my user (userdb). I am even using phpMyAdmin, and it works with both users.</p>\n\n<p>I am connecting explicitly to 127.0.0.1, to use TCP socket and not Unix socket, in order to monitor messages using Wireshark. The response is always :</p>\n\n<pre><code>MySQL Protocol\nPacket Length: 72\nPacket Number: 2\nError Code: 1045\nSQL state: 28000\nError message: Access denied for user 'root'@'localhost' (using password: YES)\n</code></pre>\n\n<p>root and localhost changing, depending if I use root, userdb or a diffeent interface.</p>\n\n<p>If I check users and passwords I have this :</p>\n\n<pre><code>MariaDB [mysql]&gt; select user,host,password from mysql.user;\n+--------+-----------+-------------------------------------------+\n| user   | host      | password                                  |\n+--------+-----------+-------------------------------------------+\n| root   | localhost | *B94FFB596FCEC97E64467B3274F7C739C42FFA7A |\n| root   | 127.0.0.1 | *B94FFB596FCEC97E64467B3274F7C739C42FFA7A |\n| root   | ::1       | *B94FFB596FCEC97E64467B3274F7C739C42FFA7A |\n| userdb | %         | *A2CF089828EE5EEA40C84C6454E97650B87345A9 |\n+--------+-----------+-------------------------------------------+\n</code></pre>\n\n<p>My simplest test is this :</p>\n\n<pre><code>void finish_with_error( MYSQL *con )\n{\n    fprintf( stderr, \"%s\\n\", mysql_error( con ) );\n    mysql_close( con );\n    exit( EXIT_FAILURE );\n}\n\nint main( int argc, char **argv )\n{\n    MYSQL *con = mysql_init( NULL );\n\n    if ( con == NULL )\n    {\n        fprintf( stderr, \"%s\\n\", mysql_error( con ) );\n        exit( EXIT_FAILURE );\n    }\n\n    if ( mysql_real_connect( con, \"127.0.0.1\", \"root\", \"asd8814*\",\n                             \"mysql\", 0, NULL, 0 ) == NULL )\n    {\n        finish_with_error( con );\n    }\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Luis</p>\n\n<pre><code>******** UPDATE *********\n</code></pre>\n\n<p>As I was sure privileges and password were OK, as I could connect with phyMyAdmin and also mysql client, I started checking the password validation. That was the only thing left, in my opinion, that could cause problems only with C client and not the others. Both Mariadb and my C client are using mysql_native_password, as I could verify with Wireshark.</p>\n\n<p>I deleted the password in MariaDB for that user and it connected successfully.\nAfter that I created a new password using phpMyAdmin and still connects successfully.\nIt may seem as I had a wrong password, but then, why could I connect with phpMyAdmin and mysql client?</p>\n\n<p>I repeated the procedure with root user. I could connect to phpMyAdmin with root, so I deleted the password for root@127.0.0.1 and still could not connect from C. I deleted password for root@localhost and then C client connected.</p>\n\n<p>First question : why it connected with no password at root@localhost if I am calling mysql_real_connect() with 127.0.0.1 instead of localhost (and I confirm I am using TCP using Wireshark)</p>\n\n<p>Second question : I re-created same previous password for root@localhost using phpMyAdmin and now C client can also connect (as so does mysql client and phpMyAdmin).</p>\n\n<p>Unknown answers for those questions. I have no idea why password validation did not work before and why it works now.</p>\n"}, {"tags": ["c", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 13900, "user_id": 2020827, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e6c7105ef9148e931ad05a6692155046?s=128&d=identicon&r=PG&f=1", "display_name": "sergej", "link": "https://stackoverflow.com/users/2020827/sergej"}, "edited": false, "score": 0, "creation_date": 1489613534, "post_id": 42821050, "comment_id": 72753894, "body": "What is the question?"}, {"owner": {"reputation": 1, "user_id": 7717627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/defa485ac32d1cf4edd87c058e984eaf?s=128&d=identicon&r=PG&f=1", "display_name": "m_jenkins", "link": "https://stackoverflow.com/users/7717627/m-jenkins"}, "edited": false, "score": 0, "creation_date": 1489613600, "post_id": 42821050, "comment_id": 72753927, "body": "I couldn&#39;t make this program work. Even if compiled it crashes."}, {"owner": {"reputation": 8720, "user_id": 3846213, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/5PGh1.jpg?s=128&g=1", "display_name": "Eli Korvigo", "link": "https://stackoverflow.com/users/3846213/eli-korvigo"}, "edited": false, "score": 0, "creation_date": 1489613775, "post_id": 42821050, "comment_id": 72754009, "body": "I guess, <code>new_struct-&gt;text[20]=text;</code> is not what you want"}, {"owner": {"reputation": 438, "user_id": 5500955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lPhR9.jpg?s=128&g=1", "display_name": "Code4aliving", "link": "https://stackoverflow.com/users/5500955/code4aliving"}, "edited": false, "score": 1, "creation_date": 1489613906, "post_id": 42821050, "comment_id": 72754072, "body": "A few problems.  Here are two of them.  In your return_address function, you want &#39;int num&#39;, not &#39;int *num&#39;.  Also, take a look at the line where you&#39;re doing this: &quot; new_struct-&gt;text[20]=text;&quot;.  That should be strncpy(new_struct.text, text, sizeof(new_struct.text));  You might want to set the last byte of new_struct-&gt;text to &#39;\\0&#39; to make sure it is null terminated, otherwise your printf might explode if the original string was 20 chars or more."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489615679, "post_id": 42821050, "comment_id": 72754897, "body": "Warnings are not for fun. Enable and pay heed to them! Only ask after you have fixed them! (search for existing Q&amp;A if you don&#39;t understand them). And <b>always</b> check the result of <code>malloc</code> and other functions which can report a critical error."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489614089, "last_edit_date": 1489614089, "creation_date": 1489613622, "answer_id": 42821096, "question_id": 42821050, "link": "https://stackoverflow.com/questions/42821050/dynamic-memory-allocation-of-a-structure/42821096#42821096", "title": "Dynamic memory allocation of a structure", "body": "<ol>\n<li>Your array is very small, also it's not dynamic at all. If you are allocating using <code>malloc()</code> anyway, why not allocate everything dynamically?</li>\n<li>You cannot assign to an array.</li>\n<li>The <code>num</code> member, which I suppose is meant to store the length of the \"<em>string</em>\", is being assigned a pointer, which is not what you apparently want. And also, the behavior is only defined in very special circumstances when you assign a pointer to an integer, the compiler should be warning you unless you turned off warnings.</li>\n</ol>\n\n<p>Perhaps you want this,</p>\n\n<pre><code>struct string {\n    char *data;\n    int length;\n};\n\nstruct string *\nallocate_string(int length, const char *const source)\n{\n    struct string *string;\n    string = malloc(sizeof *string);\n    if (string == NULL)\n        return NULL;\n    string-&gt;length = strlen(source);\n    // Make an internal copy of the original\n    // input string\n    string-&gt;data = malloc(string-&gt;length + 1);\n    if (string-&gt;data == NULL) {\n        free(string);\n        return NULL;\n    }\n    // Finally copy the data\n    memcpy(string-&gt;data, source, string-&gt;length + 1);\n    return string;\n}\n\nvoid\nfree_string(struct string *string)\n{\n    if (string == NULL)\n        return;\n    free(string-&gt;data);\n    free(string);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7717627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/defa485ac32d1cf4edd87c058e984eaf?s=128&d=identicon&r=PG&f=1", "display_name": "m_jenkins", "link": "https://stackoverflow.com/users/7717627/m-jenkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489614089, "creation_date": 1489613425, "question_id": 42821050, "link": "https://stackoverflow.com/questions/42821050/dynamic-memory-allocation-of-a-structure", "title": "Dynamic memory allocation of a structure", "body": "<p>I need to write a program in which is structure with two fields: integer and string. Next I need to write a function which dynamically allocates this structure and takes int and string as parameters to pass them down to allocated structure. This function will also return pointer to newly made structure. Second element of this program should be function which takes struct pointer as parameter, then prints all of the fileds on screen and then free memory of struct. This is the best I could come up with.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct str{\n   int num;\n   char text[20];\n};\n\nstruct str* return_address(int *num, char *text){\n  struct str* new_struct=malloc(sizeof(struct str));\n  new_struct-&gt;num=num;\n  new_struct-&gt;text[20]=text;\n  return new_struct;\n};\n\nvoid release(struct str* s_pointer){\n  printf(\"%d %s\", s_pointer-&gt;num, s_pointer-&gt;text);\n  free(s_pointer);\n};\n\n\n\nint main()\n{\n  struct str* variable=return_address(1234, \"sample text\");\n  release(variable);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "expression"], "comments": [{"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 16, "creation_date": 1489613087, "post_id": 42820928, "comment_id": 72753684, "body": "As an FYI, this would not be &quot;expert syntax.&quot; This would be &quot;highly obfuscated, poorly-written syntax designed to confuse you.&quot; :-)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1489613113, "post_id": 42820928, "comment_id": 72753701, "body": "@templatetypedef You beat me to almost the same comment!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489613169, "post_id": 42820928, "comment_id": 72753732, "body": "May I ask you why? Why would you want to understand that horrible syntax?"}, {"owner": {"reputation": 79, "user_id": 1894277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001090181177/picture?type=large", "display_name": "Aveeral Jain", "link": "https://stackoverflow.com/users/1894277/aveeral-jain"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489613250, "post_id": 42820928, "comment_id": 72753780, "body": "@IharobAlAsimi I am trying to understand the answer here - <a href=\"http://stackoverflow.com/a/14164818/1894277\">stackoverflow.com/a/14164818/1894277</a> and I don&#39;t have enough reputation to comment"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1489613571, "post_id": 42820928, "comment_id": 72753913, "body": "Yes! See my answer. :-)"}, {"owner": {"reputation": 79, "user_id": 1894277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001090181177/picture?type=large", "display_name": "Aveeral Jain", "link": "https://stackoverflow.com/users/1894277/aveeral-jain"}, "reply_to_user": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 0, "creation_date": 1489614025, "post_id": 42820928, "comment_id": 72754120, "body": "@templatetypedef Thanks a lot"}], "answers": [{"comments": [{"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1489613707, "post_id": 42821058, "comment_id": 72753974, "body": "This reminds me of an employer I worked for in the late-80&#39;s/early-90&#39;s who had a piece of software which A) was critical to the functioning of the business, B) was undocumented, and C) they had lost the source to. Solution: rather than figure out what it did, and how, they just kept calling &quot;the magic function&quot;, happy to know that it did something even if they weren&#39;t quite sure how. This is a Fortune 1000 company, BTW... :-)"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1489614294, "post_id": 42821058, "comment_id": 72754250, "body": "Bad code, poorly addressed? No wonder it&#39;s Fortune 1000 rather than Fortune 500. :-)"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1489614601, "post_id": 42821058, "comment_id": 72754400, "body": "It&#39;s actually clearer by avoiding <code>val</code>: <code>*pointer = int_2; int_1 += int_2;  int_2++; pointer++;  if (int_2 &lt;= int_3) {     ... } </code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489615553, "post_id": 42821058, "comment_id": 72754839, "body": "I&#39;d rather call it &quot;fortunate&quot;. But maybe it just is suicidal, hoping the platform it was compiled for will always be available."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489624933, "post_id": 42821058, "comment_id": 72758093, "body": "IBM mainframe running MVS. Although many-times renamed, it&#39;s The O/S The Wouldn&#39;t Die. Or, who knows? Maybe by now they&#39;ve reverse-engineered it and having it running on an iPhone... :-)"}, {"owner": {"reputation": 2907, "user_id": 2223504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e6ed13444b7f670448cb75869d4c68aa?s=128&d=identicon&r=PG", "display_name": "Randy Lai", "link": "https://stackoverflow.com/users/2223504/randy-lai"}, "edited": false, "score": 0, "creation_date": 1577660482, "post_id": 42821058, "comment_id": 105219077, "body": "The code may be wrong? <code>if (val &lt; int_3)</code> should be <code>if (int_1 &lt; int_3)</code>"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "reply_to_user": {"reputation": 2907, "user_id": 2223504, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e6ed13444b7f670448cb75869d4c68aa?s=128&d=identicon&r=PG", "display_name": "Randy Lai", "link": "https://stackoverflow.com/users/2223504/randy-lai"}, "edited": false, "score": 0, "creation_date": 1577685363, "post_id": 42821058, "comment_id": 105223222, "body": "@RandyLai Good catch! Fixed."}], "tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": true, "score": 11, "last_activity_date": 1577685343, "last_edit_date": 1577685343, "creation_date": 1489613476, "answer_id": 42821058, "question_id": 42820928, "link": "https://stackoverflow.com/questions/42820928/what-does-int-1-pointer-int-2-int-3-mean/42821058#42821058", "title": "What does (int_1 += *pointer++ = int_2++) &lt; int_3 mean?", "body": "<p>So for starters, this is really, really bad C code. Like, horrible C code. Like, I've been coding in C for a long time and had to pull up an <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence chart</a> because I've never encountered something like this terrible. So there's no reason to write something like this - certainly not in production code, and hopefully not as part of a class because you shouldn't never need to know this particular quirk of operator precedence (source: I teach CS for a living). I would go so far as to say that the source that you're referencing is Bad C Code That Should Never Be Written That Way.</p>\n\n<p>But with that said, let's break it down! The core expression here is</p>\n\n<pre><code>(int_1 += *pointer++ = int_2++) &lt; int_3\n</code></pre>\n\n<p>In that inner expression are two assignment operators, which have equal precedence and group from right-to-left. That means this is equivalent to</p>\n\n<pre><code>(int_1 += (*pointer++ = int_2++)) &lt; int_3\n</code></pre>\n\n<p>This means</p>\n\n<ol>\n<li>Increment <code>int_2</code> and store its old value.</li>\n<li>Store that value at the place pointed at by <code>pointer</code>, then advance pointer to the next location.</li>\n<li>Add that value to <code>int_1</code>.</li>\n<li>Then see whether that value is less than <code>int_3</code>.</li>\n</ol>\n\n<p>There's no reason to do something like this. Just write</p>\n\n<pre><code>int val = int_2;\n*pointer = val;\nint_1 += val;\n\nint_2++;\npointer++;\n\nif (int_1 &lt; int_3) {\n    ...\n}\n</code></pre>\n\n<p>So yeah! Don't write code like this. Ever. :-)</p>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 4, "last_activity_date": 1489614312, "creation_date": 1489614312, "answer_id": 42821269, "question_id": 42820928, "link": "https://stackoverflow.com/questions/42820928/what-does-int-1-pointer-int-2-int-3-mean/42821269#42821269", "title": "What does (int_1 += *pointer++ = int_2++) &lt; int_3 mean?", "body": "<p>Let's work from the outside, in:</p>\n\n<pre><code>if (...) continue;\n</code></pre>\n\n<p>This is an <code>if-statement</code>, with a single statement (<code>continue</code>) as its body.</p>\n\n<p>The <code>continue</code> statement is only valid within a loop. So, somewhere there is a loop - either <code>for</code> or <code>do ... while</code> or <code>while</code> - and this statement is inside it. </p>\n\n<p>If the condition is true, whatever that is, the <code>continue</code> will cause the execution of body of the loop to skip forward to the end of the loop body, evaluate the condition of the loop, and possibly increment and start the next iteration (depending on the loop guard, and whether there's a <code>for</code> loop with a non-empty increment).</p>\n\n<p>Now let's look at the inside:</p>\n\n<pre><code>(int_1 += *pointer++ = int_2++) &lt; int_3\n</code></pre>\n\n<p>This is a parenthesized expression being compared with <code>int_3</code>. So we have something like:</p>\n\n<pre><code>temp &lt; int_3\n</code></pre>\n\n<p>This is a conditional expression, being used inside an <code>if</code> statement, so you can figure out how that's going to work.</p>\n\n<p>The parenthesized expression looks like this:</p>\n\n<pre><code>int_1 += *pointer++ = int_2++\n</code></pre>\n\n<p>There are two binary operators in use. The ternary (three arguments) and binary (two arguments) have lower precedence than the unary (one argument) operators. So the <code>=</code> and <code>+=</code> will be evaluated \"last\"-ish. In fact, the assignment operators are <a href=\"https://en.wikipedia.org/wiki/Operator_associativity#Right-associativity_of_assignment_operators\" rel=\"nofollow noreferrer\">right-associative </a></p>\n\n<p>This means that in a scenario like this one, given <code>A = B = C</code> (where <code>=</code> can also be <code>+=</code>, or <code>%=</code> or whatever), the expression will be arranged as if it were:</p>\n\n<pre><code>A = (B = C)\n</code></pre>\n\n<p>Grouping to the right, instead of to the left as with <code>+</code> and <code>*</code>, where A+B+C becomes (A+B)+C.</p>\n\n<p>So your inner expression is going to be separated into two parts:</p>\n\n<pre><code>   int_1 +=              (   *pointer++ = int_2++  )\n</code></pre>\n\n<p>Now the right-hand part will be evaluated first:</p>\n\n<pre><code>*pointer++ = int_2++\n</code></pre>\n\n<p>There is a pointer-dereference (<code>*</code>) operator, and two <em>post-increment</em> operators.</p>\n\n<p>The post-increment operator evaluates to the <em>current value</em> of whatever you are applying it to, but then causes that value to be increment <em>after</em> evaluation. So <code>int_2++</code> is really something like this:</p>\n\n<pre><code>(temp = int_2, int_2 = int_2+1, temp)\n</code></pre>\n\n<p>Likewise, saying <code>*pointer++ = value</code> really means this:</p>\n\n<pre><code>*pointer = value\npointer = pointer + 1\n</code></pre>\n\n<p>So you have the target of the present value of the pointer being assigned to the present value of <code>int_2</code>, and then both of them are incremented afterwards.</p>\n\n<p>C defines its assignment operator to return the rvalue of the assignment. That is, to return the value that was stored into whatever lvalue is on the left side of the assignment operator. In this case, the <code>=</code> assignment will return the present value (before post-increment) of <code>int_2</code>.</p>\n\n<p>So you have the final part of your expression:</p>\n\n<pre><code>int_1 += ...\n</code></pre>\n\n<p>Knowing that the value on the right (the <em>rvalue</em>) is going to be the present value of <code>int_2</code>, your code is adding that value to <code>int_1</code>. C's <code>+=</code> operator is a shorthand: <code>L += R</code> is the same as <code>L = L + R</code> except it only evaluates L one time. So the end result is that something like <code>int_1 = int_1 + int_2</code> gets executed.</p>\n\n<p>You will recall that assignment operators return their assigned value. The same is true for special assignment operators. In this case, the result of the <code>+=</code> will be the left side of the <code>A &lt; B</code> comparison that makes up your <code>if</code> statement.</p>\n\n<p>If we knew what <code>int_1</code> and <code>int_2</code> were, we could decide if that was going to be <code>&lt; int_3</code>, if we knew what <code>int_3</code> was. ;-)</p>\n"}], "owner": {"reputation": 79, "user_id": 1894277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001090181177/picture?type=large", "display_name": "Aveeral Jain", "link": "https://stackoverflow.com/users/1894277/aveeral-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 42821058, "answer_count": 2, "score": 4, "last_activity_date": 1577685343, "creation_date": 1489613006, "last_edit_date": 1495535394, "question_id": 42820928, "link": "https://stackoverflow.com/questions/42820928/what-does-int-1-pointer-int-2-int-3-mean", "title": "What does (int_1 += *pointer++ = int_2++) &lt; int_3 mean?", "body": "<p>I was reading <a href=\"https://stackoverflow.com/a/14164818/1894277\">this earlier answer</a> which had a piece of C code I couldn't understand. It essentially looks like this:</p>\n\n<pre><code>if((int_1 += *pointer++ = int_2++) &lt; int_3) continue;\n</code></pre>\n\n<p>I can break it down to something like this - </p>\n\n<p>What does this mean? I can get up to about this point:</p>\n\n<pre><code>if((int_1 = int_1+ *pointer++ (unsure about this part))&lt;int_3) continue;\n</code></pre>\n"}, {"tags": ["c", "arrays", "performance", "loops", "caching"], "answers": [{"comments": [{"owner": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 0, "creation_date": 1489619270, "post_id": 42820961, "comment_id": 72756401, "body": "I see you didn&#39;t disassemble the code - otherwise you would see what happened after -O3 -&gt; all the loops were removed as dead code. So your code proves nothing."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 0, "creation_date": 1489619450, "post_id": 42820961, "comment_id": 72756476, "body": "Thanks Anty for your comment!"}, {"owner": {"reputation": 8239, "user_id": 4056181, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/G0SRK.jpg?s=128&g=1", "display_name": "jmd_dk", "link": "https://stackoverflow.com/users/4056181/jmd-dk"}, "edited": false, "score": 0, "creation_date": 1489682437, "post_id": 42820961, "comment_id": 72789080, "body": "@gsamaras &quot;one order of magnitude speedup&quot;? More like factor of two. So you got best performance using a single loop, but this is opposite to the supposed cache speedup?"}, {"owner": {"reputation": 8239, "user_id": 4056181, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/G0SRK.jpg?s=128&g=1", "display_name": "jmd_dk", "link": "https://stackoverflow.com/users/4056181/jmd-dk"}, "reply_to_user": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 0, "creation_date": 1489682508, "post_id": 42820961, "comment_id": 72789136, "body": "@Anty What do you mean by &quot;ll the loops were removed as dead code&quot;? Do you mean that -O3 compiles the many loops into a single big loop? In that case, where does the performance difference come from?"}, {"owner": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 2, "creation_date": 1489690469, "post_id": 42820961, "comment_id": 72794092, "body": "No - it means they were removed altogether because a[N], b[N], c[N], d[N] and e[N] are never used as part of any expression that has side effects. It will be enough to output them to console to prohibit this effect. Check assembly with objdump or godbolt."}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1489614629, "last_edit_date": 1489614629, "creation_date": 1489613132, "answer_id": 42820961, "question_id": 42820898, "link": "https://stackoverflow.com/questions/42820898/collective-or-individual-loops-for-best-performance/42820961#42820961", "title": "Collective or individual loops for best performance?", "body": "<p>My initial intuition was that a loop per array would work better, since the data locality will help caching. </p>\n\n<p>Having all the arrays in one loop would pollute the cache (when processing the first array the cache would be (partially) populated by some elements of that array, but at the very next line of code, you will need data for the second array and cache will not be able to help).</p>\n\n<p>The theoretical complexity remains the same in both cases.</p>\n\n<hr>\n\n<p>However, it depends on the number of arrays you have (I am not saying contiguous for now). Having to loop from scratch again and again can beat the cache speedup that the approach of one array per loop can offer, as demonstrated below:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ cat bigloop.c\n#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;time.h&gt;\n\n#define N 100000\n\ntypedef struct timeval wallclock_t;\nvoid wallclock_mark(wallclock_t *const tptr);\ndouble wallclock_since(wallclock_t *const tptr);\n\n// gcc -Wall -O3 bigloop.c -o bigloop\nint main(void)\n{\n    int a[N], b[N], c[N], d[N], e[N], i;\n\n    wallclock_t  t;\n    double  s;\n\n    wallclock_mark(&amp;t);\n    for(i = 0; i &lt; N; ++i)\n    {\n        a[i] = i * 10 + (i - 2);\n        b[i] = i * 9 + (i - 3);\n        c[i] = i * 8 + (i - 1);\n        d[i] = i * 11 + (i - 5);\n        e[i] = i * 5 + (i - 0);\n    }\n    s = wallclock_since(&amp;t);\n    printf(\"Populating took %.9f seconds wall clock time.\\n\", s);\n\n    wallclock_mark(&amp;t);\n    for(i = 0; i &lt; N; ++i)\n    {\n        a[i] = e[i] + (i - 1);\n        b[i] = d[i] + (i + 3);\n        c[i] = a[i] - (i + 2);\n        d[i] = b[i] + (i - 2);\n        e[i] = a[i] + (i - 4);\n    }\n    s = wallclock_since(&amp;t);\n    printf(\"Load/write took %.9f seconds wall clock time.\\n\", s);\n\n    return 0;\n}\n\n#include &lt;stdio.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;time.h&gt;\n\n#define N 100000\n\ntypedef struct timeval wallclock_t;\nvoid wallclock_mark(wallclock_t *const tptr);\ndouble wallclock_since(wallclock_t *const tptr);\n\nint main(void)\n{\n    int a[N], b[N], c[N], d[N], e[N], i;\n\n    wallclock_t  t;\n    double  s;\n\n    wallclock_mark(&amp;t);\n    for(i = 0; i &lt; N; ++i)\n        a[i] = i * 10 + (i - 2);\n    for(i = 0; i &lt; N; ++i)\n        b[i] = i * 9 + (i - 3);\n    for(i = 0; i &lt; N; ++i)\n        c[i] = i * 8 + (i - 1);\n    for(i = 0; i &lt; N; ++i)\n        d[i] = i * 11 + (i - 5);\n    for(i = 0; i &lt; N; ++i)\n        e[i] = i * 5 + (i - 0);\n    s = wallclock_since(&amp;t);\n    printf(\"Populating took %.9f seconds wall clock time.\\n\", s);\n\n    wallclock_mark(&amp;t);\n    for(i = 0; i &lt; N; ++i)\n        a[i] = e[i] + (i - 1);\n    for(i = 0; i &lt; N; ++i)\n        b[i] = d[i] + (i + 3);\n    for(i = 0; i &lt; N; ++i)\n        c[i] = a[i] - (i + 2);\n    for(i = 0; i &lt; N; ++i)\n        d[i] = b[i] + (i - 2);\n    for(i = 0; i &lt; N; ++i)\n        e[i] = a[i] + (i - 4);\n    s = wallclock_since(&amp;t);\n    printf(\"Load/write took %.9f seconds wall clock time.\\n\", s);\n\n    return 0;\n}\n</code></pre>\n\n<p>where I have left out the time measurements code, which I have <a href=\"https://gsamaras.wordpress.com/code/1651-2/\" rel=\"nofollow noreferrer\">here</a>. The results are:</p>\n\n<pre><code>Georgioss-MacBook-Pro:~ gsamaras$ ./bigloop \nPopulating took 0.000581000 seconds wall clock time.\nLoad/write took 0.000178000 seconds wall clock time.\nGeorgioss-MacBook-Pro:~ gsamaras$ ./loop\nPopulating took 0.001092000 seconds wall clock time.\nLoad/write took 0.000285000 seconds wall clock time.\n</code></pre>\n\n<p>where you can see the one order of magnitude speedup the all-arrays-in-one-loop gets when populating the arrays. Furthermore, it's faster in processing them too!</p>\n\n<hr>\n\n<p>So, if I were you, I would implement both approaches and measure the times! =)</p>\n\n<p><sub>PS: Do not fall a victim of premature optimization. If you have a project you want to optimize, profile your code to find the bottleneck and focus on that!</sub></p>\n"}], "owner": {"reputation": 8239, "user_id": 4056181, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/G0SRK.jpg?s=128&g=1", "display_name": "jmd_dk", "link": "https://stackoverflow.com/users/4056181/jmd-dk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 42820961, "answer_count": 1, "score": 1, "last_activity_date": 1489614629, "creation_date": 1489612905, "last_edit_date": 1489613144, "question_id": 42820898, "link": "https://stackoverflow.com/questions/42820898/collective-or-individual-loops-for-best-performance", "title": "Collective or individual loops for best performance?", "body": "<p>Say I have <code>N</code> contiguous arrays of the same size in C (or any other language - I guess it doesn't matter much). I want to loop over these arrays and perform some operation on each array element. This can be achieved by a single loop since all <code>N</code> arrays are of the same size. Is it faster however to do a separate loop for each array, due to the way computer memory works?</p>\n\n<p>For concreteness, let's say that <code>N</code> is very large, perhaps several billion, making each array many gigabytes in size. Also, the arrays are really 3D, meaning that a complete \"loop over an array\" is actually three nested loops. The complexity of the arithmetic that goes into computing the array pointer from the three loop variables is comparable to the complexity of the actual operation on the array element, which is why I dread adding more loops than necessary.</p>\n\n<p>The \"obvious\" answer is to just write both programs and see which performs the best in my particular situation. I would however like to hear some more thoughtful arguments/guidelines for how to judge this situation, as it is beyond my own programming intuition.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 0, "creation_date": 1489613005, "post_id": 42820791, "comment_id": 72753635, "body": "Do you initialize <code>attr</code>? Because that&#39;s missing from your code and if its a local variable, the contents are otherwise undefined."}, {"owner": {"reputation": 397, "user_id": 6339565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/842cbfeb056950c7f6b38c7cb32a3798?s=128&d=identicon&r=PG&f=1", "display_name": "void", "link": "https://stackoverflow.com/users/6339565/void"}, "reply_to_user": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 0, "creation_date": 1489613449, "post_id": 42820791, "comment_id": 72753863, "body": "Thank you for your answer. You are right, I missed this initialization, but unfortunately there is still the same problem (once again : not always, but in rarely case, the function is stuck) Btw I updated my post"}, {"owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "edited": false, "score": 0, "creation_date": 1489613812, "post_id": 42820791, "comment_id": 72754029, "body": "What does <code>perror</code> prints when it returns -1?"}, {"owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "edited": false, "score": 0, "creation_date": 1489614604, "post_id": 42820791, "comment_id": 72754401, "body": "Do you wait for all threads to join? I see it&#39;s going up to <code>nb_philo</code>. Is this the same as <code>nb_threads</code>?"}, {"owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "edited": false, "score": 0, "creation_date": 1489618632, "post_id": 42820791, "comment_id": 72756159, "body": "Consider providing a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. It&#39;s hard to reproduce now."}, {"owner": {"reputation": 397, "user_id": 6339565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/842cbfeb056950c7f6b38c7cb32a3798?s=128&d=identicon&r=PG&f=1", "display_name": "void", "link": "https://stackoverflow.com/users/6339565/void"}, "edited": false, "score": 0, "creation_date": 1489659701, "post_id": 42820791, "comment_id": 72772102, "body": "Thank you for your answers, nb_philo = nb_threads, btw I have uptated the post, I add the output: The beginning seems to work, then It fails after few iterations, Thank you"}], "owner": {"reputation": 397, "user_id": 6339565, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/842cbfeb056950c7f6b38c7cb32a3798?s=128&d=identicon&r=PG&f=1", "display_name": "void", "link": "https://stackoverflow.com/users/6339565/void"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489659650, "creation_date": 1489612393, "last_edit_date": 1489659650, "question_id": 42820791, "link": "https://stackoverflow.com/questions/42820791/pthread-barrier-doesnt-work-properly-in-c", "title": "pthread_barrier doesn&#39;t work properly (in C)", "body": "<p>I have a main function which initialize a pthread_barrier as the following:</p>\n\n<pre><code>pthread_barrier_t     barrier;\npthread_barrierattr_t attr;\n\nif (pthread_barrierattr_init(&amp;attr) != 0 ||\n    pthread_barrier_init(&amp;barrier, &amp;attr, nb_threads) != 0)\n  return ;\nint i = 0;\nwhile (i &lt; nb_threads)\n    {\n      threads[i].barrier = &amp;barrier;\n      threads[i].attr = &amp;attr;\n      // ...\n      if ((error = pthread_create(&amp;threads[i].thread, NULL, core,\n                                  (void *)&amp;threads[i])) != 0)\n        return (thread_create_error(error));\n      i++;\n    }\n  i = -1;\n  while (++i &lt; nb_philo)\n    pthread_join(threads[i].thread, NULL);\n</code></pre>\n\n<p>And, in each thread, I have a pointer on my barrier variables.</p>\n\n<p>And, in each thread's function (the same one for each thread), I have the <code>pthread_barrier_wait(thread-&gt;barrier)</code> function within a loop.</p>\n\n<pre><code>void thread_func(...)\n{\n    int i = 0;\n\n    while (i &lt; nb_threads)\n    {\n       //...Doing some stuff\n       pthread_barrier_wait(thread-&gt;barrier)\n       i++;\n    }\n}\n</code></pre>\n\n<p>In most of case, it works very well, but very rarely (and randomly??), it outputs nothing, the program is stuck, it seems like the barrier is still waiting. Sometimes, the <code>pthread_barrier_wait(thread-&gt;barrier)</code> functions returns -1 (most of case it returns 0).</p>\n\n<p>How could I fix this problem ? It this the good way to use barriers in C ? There is no mutex, is this normal ? Why sometimes the program still waits and sometimes no ?</p>\n\n<p>The output seems to work at the beginning, and after few iterations, it completely fails :</p>\n\n<pre><code>thread 1 begin\nthread 2 begin\nthread 3 begin\n...\nthread 1 end\nthread 2 end\nthread 3 end\n...\n\nafter few iterations:\n\nthread 1 begin\nthread 2 begin\nthread 3 end\n\n...\n\nthread 3 begin\nthread 1 end\nthread 2 end\n...\n</code></pre>\n\n<p>Thank you very much</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1489610121, "post_id": 42820102, "comment_id": 72752051, "body": "There&#39;s no function in the standard library to do that, no."}, {"owner": {"reputation": 2269, "user_id": 3104399, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/yzJGV.jpg?s=128&g=1", "display_name": "Ben Wainwright", "link": "https://stackoverflow.com/users/3104399/ben-wainwright"}, "edited": false, "score": 0, "creation_date": 1489610176, "post_id": 42820102, "comment_id": 72752078, "body": "It would not be possible to write a function to do this as <code>#define</code> is a preprocessor directive, meaning that by the time we get to runtime, it is gone"}, {"owner": {"reputation": 239, "user_id": 4146066, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WUyvhk8A6qE/AAAAAAAAAAI/AAAAAAAAADU/8_aq03Q2YD4/photo.jpg?sz=128", "display_name": "Hans", "link": "https://stackoverflow.com/users/4146066/hans"}, "edited": false, "score": 1, "creation_date": 1489610375, "post_id": 42820102, "comment_id": 72752207, "body": "Is the the question just out of curiosity? If not, describe the actual problem you try to solve so we can give good advice."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1489610739, "post_id": 42820184, "comment_id": 72752435, "body": "The answer is C has no <i>built-in</i> facility for it, but you can roll your own, subject to some non-trivial limitations."}], "tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": false, "score": 2, "last_activity_date": 1489610664, "last_edit_date": 1489610664, "creation_date": 1489610112, "answer_id": 42820184, "question_id": 42820102, "link": "https://stackoverflow.com/questions/42820102/is-there-any-c-function-that-returns-constant-variable-name-for-a-given-input-va/42820184#42820184", "title": "Is there any C function that returns constant variable name for a given input value?", "body": "<p>The answer is no, the c preprocessor replaces all occurences of MAXSIZE with 10 when run. </p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1489610889, "post_id": 42820188, "comment_id": 72752520, "body": "C has no built-in facility for this, but you can write your own function to do as the OP asks, subject to some non-trivial limitations (among them that such a function can support at most one macro name for any given value)."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 5, "last_activity_date": 1489610123, "creation_date": 1489610123, "answer_id": 42820188, "question_id": 42820102, "link": "https://stackoverflow.com/questions/42820102/is-there-any-c-function-that-returns-constant-variable-name-for-a-given-input-va/42820188#42820188", "title": "Is there any C function that returns constant variable name for a given input value?", "body": "<p>No for many reasons:</p>\n\n<ul>\n<li>C is not a reflective language</li>\n<li>what if there are several constants with the same <code>10</code> value?</li>\n</ul>\n\n<p>but the actual reason that kills it is:</p>\n\n<ul>\n<li>preprocessor actually replaces <code>MAXSIZE</code> by <code>10</code> <em>before</em> compiling, so this information is lost</li>\n</ul>\n"}], "owner": {"reputation": 981, "user_id": 3044967, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0e62ac8cb1ade85abbf3f04fba77608?s=128&d=identicon&r=PG&f=1", "display_name": "Aniketh", "link": "https://stackoverflow.com/users/3044967/aniketh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1489610621, "answer_count": 2, "score": 1, "last_activity_date": 1489610664, "creation_date": 1489609868, "last_edit_date": 1489610011, "question_id": 42820102, "link": "https://stackoverflow.com/questions/42820102/is-there-any-c-function-that-returns-constant-variable-name-for-a-given-input-va", "closed_reason": "Duplicate", "title": "Is there any C function that returns constant variable name for a given input value?", "body": "<p>For example lets say I defined a constant as below using #define macro in C</p>\n\n<pre><code>#define MAXSIZE 10\n</code></pre>\n\n<p>Is there any function in C that I can invoke by passing 10 as input and retrieve that constant name \"MAXSIZE\". Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32193, "user_id": 2908724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1xBJR.png?s=128&g=1", "display_name": "bishop", "link": "https://stackoverflow.com/users/2908724/bishop"}, "edited": false, "score": 0, "creation_date": 1489624426, "post_id": 42820021, "comment_id": 72757979, "body": "@hvd Ok, I see how the offhandishness is ambiguous. I removed my comment."}], "answers": [{"comments": [{"owner": {"reputation": 5812, "user_id": 735425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x7BUU.png?s=128&g=1", "display_name": "ssell", "link": "https://stackoverflow.com/users/735425/ssell"}, "edited": false, "score": 1, "creation_date": 1489610628, "post_id": 42820091, "comment_id": 72752371, "body": "Thanks for explaining <i>why</i> they were seeing different values between using <code>lu</code> and <code>llu</code>. So the upper 32-bit word of <code>0000 0000 0000 0000 0000 0000 0000 1000</code> was just whatever garbage was laying around?"}, {"owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "reply_to_user": {"reputation": 5812, "user_id": 735425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x7BUU.png?s=128&g=1", "display_name": "ssell", "link": "https://stackoverflow.com/users/735425/ssell"}, "edited": false, "score": 0, "creation_date": 1489611354, "post_id": 42820091, "comment_id": 72752760, "body": "Yes, I just added in the answer the hex representation of the wrong value."}], "tags": [], "owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "is_accepted": false, "score": 5, "last_activity_date": 1489611254, "last_edit_date": 1489611254, "creation_date": 1489609825, "answer_id": 42820091, "question_id": 42820021, "link": "https://stackoverflow.com/questions/42820021/why-does-the-maximum-value-of-datatypes-showing-an-absurdly-high-value/42820091#42820091", "title": "Why does the maximum value of datatypes showing an absurdly high value?", "body": "<p>As <code>printf</code> is expecting now to print a 64 bit value, you should pass it accordingly. You can cast it to <code>unsigned long long</code>:</p>\n\n<pre><code>    printf(\"%llu\", (unsigned long long)ULONG_MAX);\n</code></pre>\n\n<p>Assuming a little endian architecture, you got that bigger value previously because only the least significant 32-bit word was passed as a parameter, and printf needed 64 bit, so it was using as the most significant 32-bit word whatever the stack contained at the next address.</p>\n\n<p>The wrong value you got is 38654705663. If you display it in hexadecimal (you can also use <code>printf</code> for this with <code>%llx</code>), you get:\n<code>0000 0008 FFFF FFFF</code> (spaces added by me for easier reading).</p>\n"}, {"comments": [{"owner": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "edited": false, "score": 1, "creation_date": 1489610075, "post_id": 42820094, "comment_id": 72752023, "body": "Isn&#39;t it a constant, so why does it display some other value? Should it not overflow?"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "edited": false, "score": 1, "creation_date": 1489610265, "post_id": 42820094, "comment_id": 72752133, "body": "@KaranSingh There is a thing called <i>&quot;undefined behaviour&quot;</i>. It means that your program is not guaranteed to function properly anymore, and anything can happen with it. This term is used a lot in the standard in phrases like <i>&quot;If you &lt;do something silly&gt;, then the behaviour is undefined&quot;</i>."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "edited": false, "score": 1, "creation_date": 1489610417, "post_id": 42820094, "comment_id": 72752231, "body": "Simply saying, what happens is that <code>printf</code> expects to get a 64-bit wide unsigned integer (<code>unsigned long long</code> is <i>usually</i> 64 bits wide), but you give it a 32-bit wide integer. Because of that it (probably) reads not only your parameter, but also some nearby bytes."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "edited": false, "score": 2, "creation_date": 1489610511, "post_id": 42820094, "comment_id": 72752294, "body": "@KaranSingh: The variadic C functions like <code>printf</code> rely on the format string to know the size of the argument to pull from the <code>va_list</code>. If you give <code>printf</code> a format string that requires 8 bytes, but only provide 4 bytes on the argument list, things go very badly."}, {"owner": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "edited": false, "score": 2, "creation_date": 1489610575, "post_id": 42820094, "comment_id": 72752335, "body": "Wow, I get it now. It would be great if you added that to your answer. Also, I tried doing it with CHAR_MAX  and now I get 127 :) Thanks a lot."}], "tags": [], "owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "is_accepted": true, "score": 4, "last_activity_date": 1489609917, "last_edit_date": 1489609917, "creation_date": 1489609836, "answer_id": 42820094, "question_id": 42820021, "link": "https://stackoverflow.com/questions/42820021/why-does-the-maximum-value-of-datatypes-showing-an-absurdly-high-value/42820094#42820094", "title": "Why does the maximum value of datatypes showing an absurdly high value?", "body": "<p>Types of additional <code>printf()</code> parameters <em>must</em> match used placeholders. Otherwise the behaviour is undefined.</p>\n\n<p><code>%llu</code> stands for <code>unsigned long long</code>, thus your parameter also has to be <code>unsigned long long</code>:</p>\n\n<pre><code>printf(\"%llu\", (unsigned long long)ULONG_MAX);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15921, "user_id": 676558, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/PbWyu.png?s=128&g=1", "display_name": "Amin Negm-Awad", "link": "https://stackoverflow.com/users/676558/amin-negm-awad"}, "is_accepted": false, "score": 2, "last_activity_date": 1489609851, "creation_date": 1489609851, "answer_id": 42820098, "question_id": 42820021, "link": "https://stackoverflow.com/questions/42820021/why-does-the-maximum-value-of-datatypes-showing-an-absurdly-high-value/42820098#42820098", "title": "Why does the maximum value of datatypes showing an absurdly high value?", "body": "<p>With <code>%llu</code> you have to pass a long long integer to the <code>printf()</code>. Try this:</p>\n\n<pre><code>printf(\"%llu\", (unsigned long long)ULONG_MAX);\n</code></pre>\n"}], "owner": {"reputation": 790, "user_id": 4611854, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/og2CM.jpg?s=128&g=1", "display_name": "Karan Singh", "link": "https://stackoverflow.com/users/4611854/karan-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 42820094, "answer_count": 3, "score": 3, "last_activity_date": 1489611254, "creation_date": 1489609581, "last_edit_date": 1489610015, "question_id": 42820021, "link": "https://stackoverflow.com/questions/42820021/why-does-the-maximum-value-of-datatypes-showing-an-absurdly-high-value", "title": "Why does the maximum value of datatypes showing an absurdly high value?", "body": "<p>I was doing problem 2.1 of K&amp;R C which basically wants us to mess around and understand the header library </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;limits.h&gt;\n#include&lt;float.h&gt;\n\nint main()\n{\n    printf(\"%lu\", ULONG_MAX);\n}\n</code></pre>\n\n<p>When I run this program, I get the output </p>\n\n<pre><code>4294967295\n</code></pre>\n\n<p>which is equal to 2<sup>32</sup> -1. I was expecting this value (since K&amp;R has the same value in it's appendix).</p>\n\n<p>Now I changed <code>%lu</code> to <code>%llu</code>.</p>\n\n<p>With my little knowledge of the C language, I am assuming that <code>%llu</code> is a bigger 'placeholder' for the value of <code>ULONG_MAX</code>.</p>\n\n<p>I expected to get the same output, but instead I got a vague output </p>\n\n<pre><code>38654705663\n</code></pre>\n\n<p>Isn't <code>ULONG_MAX</code> supposed to be a constant? Why is it changing?\nAlso, in quest for an answer, I stumbled upon <a href=\"https://stackoverflow.com/questions/9749930/uint-max-the-same-as-ulong-max-in-c\">this</a>.</p>\n\n<p>I understand the argument that the standard mentions the term 'minimum' but when I tested this with <code>CHAR_MAX</code> (i.e. tried to print <code>CHAR_MAX</code> with a <code>%llu</code> specifier), I got </p>\n\n<pre><code>38654705663\n</code></pre>\n\n<p>This is contradictory to everything I have ever read about <code>char</code> in C.</p>\n\n<p>Really hope that someone clears the confusion regarding this.</p>\n"}, {"tags": ["c", "linux", "assembly", "signals", "system-calls"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1489612117, "post_id": 42819841, "comment_id": 72753168, "body": "See <a href=\"http://stackoverflow.com/questions/42356368/memory-access-error-sys-rt-sigaction-signal-handler\" title=\"memory access error sys rt sigaction signal handler\">stackoverflow.com/questions/42356368/&hellip;</a>"}, {"owner": {"reputation": 1156, "user_id": 4772791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9e0e4bd022920a359eac1b22749ca6?s=128&d=identicon&r=PG&f=1", "display_name": "arsv", "link": "https://stackoverflow.com/users/4772791/arsv"}, "edited": false, "score": 1, "creation_date": 1489737988, "post_id": 42819841, "comment_id": 72811293, "body": "<code>struct kernel_sigaction</code> is also wrong, it&#39;s union { <code>sa_handler</code>, <code>sa_sigaction</code> }"}], "owner": {"reputation": 79, "user_id": 6711421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e27df95bb43ac8dd4d7dcbc0824a4ea?s=128&d=identicon&r=PG&f=1", "display_name": "Rossman", "link": "https://stackoverflow.com/users/6711421/rossman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1610286563, "creation_date": 1489608966, "last_edit_date": 1610286563, "question_id": 42819841, "link": "https://stackoverflow.com/questions/42819841/issue-with-making-linux-sigaction-syscall-in-assembly", "title": "Issue with making Linux sigaction syscall in assembly", "body": "<p>I'm learning Linux syscalls and I have a problem with invoking syscall 13:</p>\n<blockquote>\n<p>rt_sigaction(int sig,    const struct sigaction __user *\nact,  struct sigaction __user * oact, size_t sigsetsize)</p>\n</blockquote>\n<p>on 64 bit Linux in assembly. I have used the C wrapper for this function (sigaction()) and it worked fine, but when I tried to make a direct syscall with the code below it failed. I have made other direct syscalls with this approach and only this syscall has failed to work.</p>\n<p>I suspect that the pointer to sigint_handler() function is being passed incorrectly to the kernel but I'm not sure.</p>\n<p>I can't use C system libraries in my project so getting this specific syscall to work with assembly invocation is my goal here.</p>\n<p>The C code I'm running:</p>\n<pre><code>#define _POSIX_SOURCE\n        \n#include &lt;stddef.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;linux/signal.h&gt;\n#include &lt;linux/unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;syscall.h&gt;\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;unistd.h&gt;\n\n// SYSCALL_4 simply injects the assembly to make the syscall directly\n#define SYSCALL_4(sys_num, a1,a2,a3,a4) \\ ({ \\\n    int64_t sys_ret; \\\n    __asm __volatile ( \\\n    &quot;movq %1, %%rax\\n\\t&quot;\\\n    &quot;movq %2, %%rdi\\n\\t&quot;\\\n    &quot;movq %3, %%rsi\\n\\t&quot;\\\n    &quot;movq %4, %%rdx\\n\\t&quot;\\\n    &quot;movq %5, %%r10\\n\\t&quot;\\\n    &quot;syscall\\n\\t&quot; \\\n    &quot;movq %%rax, %0\\n\\t&quot;\\\n    : &quot;=g&quot; (sys_ret)\\\n    : &quot;g&quot;(sys_num), &quot;g&quot; (a1) , &quot;g&quot; (a2), &quot;g&quot; (a3), &quot;g&quot; (a4)\\\n    : &quot;cc&quot;, &quot;memory&quot;, &quot;%rax&quot;, &quot;%rdi&quot;, &quot;%rsi&quot;, &quot;%rdx&quot;, &quot;%rcx&quot;, &quot;%r11&quot;, &quot;%r10&quot;\\       );\\\n    sys_ret; \\ })\n\nstruct kernel_sigaction {\n    void     (*sa_handler)(int);\n    void     (*sa_sigaction)(int, siginfo_t *, void *);\n    sigset_t   sa_mask;\n    int        sa_flags;\n    void     (*sa_restorer)(void);\n};\n        \nvoid sigint_handler(int signo) {\n    printf(&quot;In SIGINT handler ...\\n&quot;); \n} \n\nint main(void) {\n    struct kernel_sigaction sig;\n    \n    int64_t ret = SYSCALL_4(13, SIGINT, 0, &amp;sig, sizeof(sigset_t)); //__NR_rt_sigaction\n    if (ret &lt; 0)\n    {\n        fprintf(stderr,&quot;Unable to install SIGINT handler\\n&quot;);\n        errno = -ret;\n        perror(0);\n        exit(1);\n    }\n    \n    sig.sa_handler = sigint_handler;\n    \n    ret = SYSCALL_4(13, SIGINT, &amp;sig, 0, sizeof(sigset_t)); //__NR_rt_sigaction\n    if (ret &lt; 0) //doesnt fail here\n    {\n        fprintf(stderr,&quot;Unable to install SIGINT handler\\n&quot;);\n        errno = -ret;\n        perror(0);\n        exit(1);\n    }\n    \n    printf(&quot;Sleeping for 30 seconds ...\\n&quot;);\n    sleep(30); //seems to fail here\n    printf(&quot;Waking up ...\\n&quot;); //supposed to print after SIGINT handler\n    exit(0);\n}\n</code></pre>\n<p>and on console:</p>\n<pre><code>&gt; gcc -Wall -march=native -std=c11 -O0 P1c_inline.c -o P1c_inline.out \n&gt; ./P1c_inline.out \nSleeping for 30 seconds ...\n^CSegmentation fault (core dumped)\n</code></pre>\n"}, {"tags": ["c", "eclipse", "arm", "elf", "nm"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489609045, "post_id": 42819796, "comment_id": 72751416, "body": "your link doesn&#39;t work for me. Can you show the relevant parts of the mapfile in the question please?"}, {"owner": {"reputation": 575, "user_id": 2506321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VZIm4.jpg?s=128&g=1", "display_name": "Yusuf Husainy", "link": "https://stackoverflow.com/users/2506321/yusuf-husainy"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489609254, "post_id": 42819796, "comment_id": 72751522, "body": "@Jean-Fran&#231;oisFabre, try this link instead: <a href=\"https://justpaste.it/14i4h\" rel=\"nofollow noreferrer\">justpaste.it/14i4h</a> search for &quot;libcbor&quot; in it"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489609362, "post_id": 42819796, "comment_id": 72751578, "body": "sorry, no go either."}, {"owner": {"reputation": 575, "user_id": 2506321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VZIm4.jpg?s=128&g=1", "display_name": "Yusuf Husainy", "link": "https://stackoverflow.com/users/2506321/yusuf-husainy"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489610179, "post_id": 42819796, "comment_id": 72752079, "body": "Seems I can&#39;t paste the relevant sections of the map file, the size is more than 30000 characters and StackOverflow is not accepting it."}, {"owner": {"reputation": 575, "user_id": 2506321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VZIm4.jpg?s=128&g=1", "display_name": "Yusuf Husainy", "link": "https://stackoverflow.com/users/2506321/yusuf-husainy"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489610253, "post_id": 42819796, "comment_id": 72752123, "body": "try this: <a href=\"https://paste.ee/p/3OxJA\" rel=\"nofollow noreferrer\">paste.ee/p/3OxJA</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1489610578, "post_id": 42819796, "comment_id": 72752336, "body": "my firewall is good you know :) you could paste a small extract of your relevant portion, it would be something at least."}], "owner": {"reputation": 575, "user_id": 2506321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VZIm4.jpg?s=128&g=1", "display_name": "Yusuf Husainy", "link": "https://stackoverflow.com/users/2506321/yusuf-husainy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489609324, "creation_date": 1489608795, "last_edit_date": 1489609324, "question_id": 42819796, "link": "https://stackoverflow.com/questions/42819796/building-libcbor-but-objects-do-not-reflect-in-elf", "title": "Building libcbor, but objects do not reflect in ELF", "body": "<p>I have an ELF compiled from the sources having following <code>file</code>, <code>size</code> output:</p>\n\n<pre><code>bash.exe\"-3.1$ file FreeRTOS_Trial_CubeMX_Project.elf\nFreeRTOS_Trial_CubeMX_Project.elf: ELF 32-bit LSB executable, ARM, EABI5     version\n 1 (SYSV), statically linked, not stripped\n\nbash.exe\"-3.1$ arm-unknown-nto-qnx6.5.0eabi-size     FreeRTOS_Trial_CubeMX_Project.elf\n   text    data     bss     dec     hex filename\n   7936      24    4968   12928    3280 FreeRTOS_Trial_CubeMX_Project.elf\n</code></pre>\n\n<p>I have copied an external libcbor source files into the source tree without changing any setting in the Eclipse IDE. On doing an <code>nm</code> on it, I do not get the symbols within libcbor source tree:</p>\n\n<pre><code>bash.exe\"-3.1$ arm-unknown-nto-qnx6.5.0eabi-nm FreeRTOS_Trial_CubeMX_Project.el\nf\n08001e20 W ADC1_2_IRQHandler\n08001e20 W ADC3_IRQHandler\n08001edc R AHBPrescTable\n08001eec R APBPrescTable\nf1e0f85f a BootRAM\n08001e20 W BusFault_Handler\n08001e20 W CAN1_RX0_IRQHandler\n08001e20 W CAN1_RX1_IRQHandler\n08001e20 W CAN1_SCE_IRQHandler\n08001e20 W CAN1_TX_IRQHandler\n08001e20 W COMP_IRQHandler\n08001dd8 t CopyDataInit\n08001e20 W DFSDM1_FLT0_IRQHandler\n08001e20 W DFSDM1_FLT1_IRQHandler\n08001e20 W DFSDM1_FLT2_IRQHandler\n08001e20 W DFSDM1_FLT3_IRQHandler\n08001e20 W DMA1_Channel1_IRQHandler\n08001e20 W DMA1_Channel2_IRQHandler\n08001e20 W DMA1_Channel3_IRQHandler\n08001e20 W DMA1_Channel4_IRQHandler\n08001e20 W DMA1_Channel5_IRQHandler\n08001e20 W DMA1_Channel6_IRQHandler\n08001e20 W DMA1_Channel7_IRQHandler\n08001e20 W DMA2_Channel1_IRQHandler\n08001e20 W DMA2_Channel2_IRQHandler\n08001e20 W DMA2_Channel3_IRQHandler\n08001e20 W DMA2_Channel4_IRQHandler\n08001e20 W DMA2_Channel5_IRQHandler\n08001e20 W DMA2_Channel6_IRQHandler\n08001e20 W DMA2_Channel7_IRQHandler\n08001e20 W DebugMon_Handler\n08001e20 T Default_Handler\n08001e20 W EXTI0_IRQHandler\n08001e20 W EXTI15_10_IRQHandler\n08001e20 W EXTI1_IRQHandler\n08001e20 W EXTI2_IRQHandler\n08001e20 W EXTI3_IRQHandler\n08001e20 W EXTI4_IRQHandler\n08001e20 W EXTI9_5_IRQHandler\n08001e20 W FLASH_IRQHandler\n08001e20 W FMC_IRQHandler\n08001e20 W FPU_IRQHandler\n08001dee t FillZerobss\n08000314 T HAL_GPIO_Init\n080004d0 T HAL_GPIO_WritePin\n08000220 W HAL_GetTick\n08000210 W HAL_IncTick\n080001ec T HAL_Init\n08001d00 T HAL_InitTick\n08001c74 T HAL_MspInit\n080002b8 T HAL_NVIC_EnableIRQ\n08000250 T HAL_NVIC_SetPriority\n0800022c T HAL_NVIC_SetPriorityGrouping\n080004ec T HAL_PWREx_ControlVoltageScaling\n080004dc T HAL_PWREx_GetVoltageRange\n08000ba4 T HAL_RCC_ClockConfig\n08000d50 T HAL_RCC_GetClockConfig\n08000d14 T HAL_RCC_GetHCLKFreq\n08000d20 T HAL_RCC_GetPCLK2Freq\n080005dc T HAL_RCC_GetSysClockFreq\n08000718 T HAL_RCC_OscConfig\n080002fc T HAL_SYSTICK_CLKSourceConfig\n080002d0 T HAL_SYSTICK_Config\n08000fea W HAL_TIMEx_BreakCallback\n08000fe8 W HAL_TIMEx_CommutationCallback\n08000fb4 T HAL_TIM_Base_Init\n08000d8c W HAL_TIM_Base_MspInit\n08000d8e T HAL_TIM_Base_Start_IT\n08000da6 W HAL_TIM_IC_CaptureCallback\n08000dac T HAL_TIM_IRQHandler\n08000da4 W HAL_TIM_OC_DelayElapsedCallback\n08000da8 W HAL_TIM_PWM_PulseFinishedCallback\n08001c60 T HAL_TIM_PeriodElapsedCallback\n08000daa W HAL_TIM_TriggerCallback\n08001e20 W HardFault_Handler\n08001e20 W I2C1_ER_IRQHandler\n08001e20 W I2C1_EV_IRQHandler\n08001e20 W I2C2_ER_IRQHandler\n08001e20 W I2C2_EV_IRQHandler\n08001e20 W I2C3_ER_IRQHandler\n08001e20 W I2C3_EV_IRQHandler\n08001e20 t Infinite_Loop\n08001e20 W LCD_IRQHandler\n08001e20 W LPTIM1_IRQHandler\n08001e20 W LPTIM2_IRQHandler\n08001e20 W LPUART1_IRQHandler\n08001de0 t LoopCopyDataInit\n08001df4 t LoopFillZerobss\n08001e06 t LoopForever\n08001eac R MSIRangeTable\n08001e20 W MemManage_Handler\n08001e20 W NMI_Handler\n08001e20 W OTG_FS_IRQHandler\n08001e20 W PVD_PVM_IRQHandler\n08001790 T PendSV_Handler\n08001e20 W QUADSPI_IRQHandler\n08001e20 W RCC_IRQHandler\n08000558 t RCC_SetFlashLatencyFromMSIRange\n08001e20 W RNG_IRQHandler\n08001e20 W RTC_Alarm_IRQHandler\n08001e20 W RTC_WKUP_IRQHandler\n08001dd0 W Reset_Handler\n08001e20 W SAI1_IRQHandler\n08001e20 W SAI2_IRQHandler\n08001e20 W SDMMC1_IRQHandler\n08001e20 W SPI1_IRQHandler\n08001e20 W SPI2_IRQHandler\n08001e20 W SPI3_IRQHandler\n08001700 T SVC_Handler\n08001e20 W SWPMI1_IRQHandler\n08001afc T StartDefaultTask\n08001d78 T SysTick_Handler\n08001b06 T SystemClock_Config\n20000004 D SystemCoreClock\n08001d88 T SystemInit\n08001e20 W TAMP_STAMP_IRQHandler\n08001e20 W TIM1_BRK_TIM15_IRQHandler\n08001e20 W TIM1_CC_IRQHandler\n08001e20 W TIM1_TRG_COM_TIM17_IRQHandler\n08001d7c T TIM1_UP_TIM16_IRQHandler\n08001e20 W TIM2_IRQHandler\n08001e20 W TIM3_IRQHandler\n08001e20 W TIM4_IRQHandler\n08001e20 W TIM5_IRQHandler\n08001e20 W TIM6_DAC_IRQHandler\n08001e20 W TIM7_IRQHandler\n08001e20 W TIM8_BRK_IRQHandler\n08001e20 W TIM8_CC_IRQHandler\n08001e20 W TIM8_TRG_COM_IRQHandler\n08001e20 W TIM8_UP_IRQHandler\n08000ef0 T TIM_Base_SetConfig\n08001e20 W TSC_IRQHandler\n08001e20 W UART4_IRQHandler\n08001e20 W UART5_IRQHandler\n08001e20 W USART1_IRQHandler\n08001e20 W USART2_IRQHandler\n08001e20 W USART3_IRQHandler\n08001e20 W UsageFault_Handler\n08001e20 W WWDG_IRQHandler\n         w _Jv_RegisterClasses\n00000200 A _Min_Heap_Size\n00000400 A _Min_Stack_Size\n08001e80 t __EH_FRAME_BEGIN__\n20000d6c b __bss_end__\n20000008 b __bss_start__\n         U __call_exitprocs\n         w __deregister_frame_info\n08000190 t __do_global_dtors_aux\n08001f10 t __do_global_dtors_aux_fini_array_entry\n08001f08 ? __exidx_end\n08001f08 ? __exidx_start\n08001f08 t __frame_dummy_init_array_entry\n08001f0c t __init_array_end\n08001f08 t __init_array_start\n         U __libc_fini_array\n08001e24 T __libc_init_array\n08001f08 d __preinit_array_end\n08001f08 d __preinit_array_start\n         w __register_frame_info\n         U __stack\n20000d6c B _ebss\n20000008 D _edata\n20018000 A _estack\n08001e98 T _etext\n08001e8c T _fini\n08001e80 T _init\n         U _printf_float\n20000008 B _sbss\n20000000 D _sdata\n08001f18 A _sidata\n         U atexit\n20000008 b completed.8605\n20000d2c B defaultTaskHandle\n20000d70 b end\n080001b4 t frame_dummy\n08000000 R g_pfnVectors\n         U hardware_init_hook\n20000d30 B htim1\n08001b84 T main\n08001e70 T memset\n2000000c b object.8610\n08001026 T osDelay\n08000fec T osKernelStart\n08001036 T osSystickHandler\n08000ff6 T osThreadCreate\n080010f0 t prvAddCurrentTaskToDelayedList\n08001578 t prvIdleTask\n0800192c t prvInsertBlockIntoFreeList\n0800169c t prvPortStartFirstTask\n080010d0 t prvResetNextTaskUnblockTime\n0800166c t prvTaskExitError\n08001970 T pvPortMalloc\n20000030 B pxCurrentTCB\n080017f0 t pxCurrentTCBConst\n08001720 t pxCurrentTCBConst2\n20000024 b pxDelayedTaskList\n20000160 b pxEnd\n2000004c b pxOverflowDelayedTaskList\n080016d0 T pxPortInitialiseStack\n20000068 b pxReadyTasksLists\n         U software_init_hook\n20000164 b ucHeap\n20000150 b ucMaxSysCallPriority\n20000154 b ulMaxPRIGROUPValue\n20000d28 B uwTick\n20000000 d uxCriticalNesting\n20000064 b uxCurrentNumberOfTasks\n20000138 b uxDeletedTasksWaitingCleanUp\n080010ae T uxListRemove\n20000148 b uxPendedTicks\n2000013c b uxSchedulerSuspended\n20000134 b uxTaskNumber\n20000034 b uxTopReadyPriority\n0800104a T vListInitialise\n08001060 T vListInitialiseItem\n0800107e T vListInsert\n08001066 T vListInsertEnd\n080016bc t vPortEnableVFP\n08001724 T vPortEnterCritical\n08001768 T vPortExitCritical\n08001a8c T vPortFree\n08001820 W vPortSetupTimerInterrupt\n0800152c T vTaskDelay\n080012e8 T vTaskStartScheduler\n08001354 T vTaskSuspendAll\n080015e8 T vTaskSwitchContext\n20000d24 b xBlockAllocatedBit\n200000f4 b xDelayedTaskList1\n20000108 b xDelayedTaskList2\n20000d20 b xFreeBytesRemaining\n20000140 b xIdleTaskHandle\n20000d1c b xMinimumEverFreeBytesRemaining\n20000028 b xNextTaskUnblockTime\n20000144 b xNumOfOverflows\n20000050 b xPendingReadyList\n08001848 T xPortStartScheduler\n080017f4 T xPortSysTickHandler\n20000130 b xSchedulerRunning\n20000158 b xStart\n20000038 b xSuspendedTaskList\n08001160 T xTaskCreate\n0800164c T xTaskGetSchedulerState\n08001368 T xTaskIncrementTick\n08001454 T xTaskResumeAll\n2000011c b xTasksWaitingTermination\n2000002c b xTickCount\n2000014c b xYieldPending\n</code></pre>\n\n<p>however it generates the output.map file with the libcbor symbols. See <a href=\"http://pasted.co/c5f631c1\" rel=\"nofollow noreferrer\">this</a>. Search for \"libcbor\" in the link. Another link if that one doesn't work: <a href=\"https://justpaste.it/14i4h\" rel=\"nofollow noreferrer\">https://justpaste.it/14i4h</a></p>\n\n<p>Why would this happen? Am I failing to understand something here or missed something during my build?</p>\n\n<p>Any help is appreciated very much. Thanks.</p>\n"}, {"tags": ["c", "visual-c++", "playsound"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1489608636, "post_id": 42819725, "comment_id": 72751205, "body": "Lots of computer programs play sounds. Do you think they have access to some magic that you don&#39;t?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489609911, "post_id": 42819865, "comment_id": 72751918, "body": "Where can I find the lib? And when i add the code it gives me loads of errors."}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610161, "post_id": 42819865, "comment_id": 72752070, "body": "It&#39;s already available, you just have to add <code>Winmm.lib</code> to <code>Linker&#47;Input&#47;Additional Dependencies</code> in your Project Settings. The errors are probably from the linker - if not, let me know, I&#39;ll check it out further then."}, {"owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610267, "post_id": 42819865, "comment_id": 72752134, "body": "Where can I find the lib? And when i add the code it gives me loads of errors. It looks like I have some files damaged, it says &quot;dentifier &quot;WORD&quot; is undefined&quot;"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610511, "post_id": 42819865, "comment_id": 72752296, "body": "What type of project are you running? Console, MFC, .. ?"}, {"owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610627, "post_id": 42819865, "comment_id": 72752368, "body": "Win32 Console Apllication, by including mmsystem.h I add other external dependies in which there are some errors, and the errors starts when UINT or WORD or CHAR variable are declared"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610746, "post_id": 42819865, "comment_id": 72752441, "body": "Ok, try to include &lt;windows.h&gt; first (see updated answer)."}, {"owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489610960, "post_id": 42819865, "comment_id": 72752563, "body": "Thanks, we&#39;re about to solve the problem, all the libraries errors are gone, but &quot;PlaySoundW(LPCWSTR,HMODULE,DWORD)&#39;: cannot convert argument 1 from &#39;const char [9]&#39; to &#39;LPCWSTR&#39;\t &quot;"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489611279, "post_id": 42819865, "comment_id": 72752715, "body": "Ah, sorry, try this: <code>L&quot;test.wav&quot;</code> - or the macro: <code>_T(&quot;test.wav&quot;)</code>"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "reply_to_user": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489611874, "post_id": 42819865, "comment_id": 72753039, "body": "I added a quick example (tested). Of course make sure there is a test.wav in the current directory. (or try to remove the SND_ASYNC flag to test)"}, {"owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "edited": false, "score": 0, "creation_date": 1489611978, "post_id": 42819865, "comment_id": 72753108, "body": "Thank you :) Really helpful"}], "tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": true, "score": 1, "last_activity_date": 1489695515, "last_edit_date": 1489695515, "creation_date": 1489609065, "answer_id": 42819865, "question_id": 42819725, "link": "https://stackoverflow.com/questions/42819725/visual-c-or-c-play-sounds/42819865#42819865", "title": "Visual C++ or C play sounds", "body": "<p>Take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd743680.aspx\" rel=\"nofollow noreferrer\">PlaySound()</a> function.</p>\n\n<p>If you call <code>PlaySound()</code> with the <code>SND_ASYNC</code> flag, the function returns immediately after beginning the sound.</p>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;mmsystem.h&gt;\n\nPlaySound(L\"test.wav\", NULL, SND_ASYNC | SND_FILENAME);\n</code></pre>\n\n<p>You'll also have to add <code>Winmm.lib</code> in your project settings.</p>\n\n<hr>\n\n<p>Here's a quick example that should work:</p>\n\n<pre><code>#pragma once\n\n#include \"stdafx.h\"\n#include &lt;windows.h&gt;\n#include &lt;mmsystem.h&gt;\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n    if(!PlaySound(L\"test.wav\", NULL, SND_ASYNC | SND_FILENAME))\n        printf(\"error\\n\");\n    else\n        printf(\"ok\\n\");\n\n    getch();\n    return 0;\n}\n</code></pre>\n\n<p>and in stdafx.h:</p>\n\n<pre><code>#pragma once\n\n#include &lt;iostream&gt;\n#include &lt;tchar.h&gt;\n#include &lt;conio.h&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7438027, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a0c6494016a7ae99fb76f7c24f8ad4e9?s=128&d=identicon&r=PG&f=1", "display_name": "ohhConti", "link": "https://stackoverflow.com/users/7438027/ohhconti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4091, "favorite_count": 1, "accepted_answer_id": 42819865, "answer_count": 1, "score": 1, "last_activity_date": 1489695515, "creation_date": 1489608562, "last_edit_date": 1489612581, "question_id": 42819725, "link": "https://stackoverflow.com/questions/42819725/visual-c-or-c-play-sounds", "title": "Visual C++ or C play sounds", "body": "<p>I'm developping an easy game written in C (Visual C++)\nand I want to know if there is a way to play sounds,\nthanks\n(I'm using Visual Studio)</p>\n"}, {"tags": ["c", "list", "struct"], "comments": [{"owner": {"reputation": 136, "user_id": 2894021, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f1d430ec2a38a98ab8dc2db0ef176943?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/2894021/kaushik-koneru"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1489609581, "post_id": 42819696, "comment_id": 72751708, "body": "I changed <code>test_t list_types[][] = { list_1, list_2 };</code> then the error is ` error: array type has incomplete element type `"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1489618751, "post_id": 42819696, "comment_id": 72756196, "body": "Change <code>test_t list_types[][] = { list_1, list_2 };</code> to <code>test_t *list_types[] = { list_1, list_2 };</code> and you will have it.  See edits in my answer for more info."}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 2894021, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f1d430ec2a38a98ab8dc2db0ef176943?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/2894021/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1489610078, "post_id": 42820095, "comment_id": 72752024, "body": "I don&#39;t think malloc is necessary in this case...Memory is statically allocated.. I am just referring that memory .. this code doesn&#39;t solve my original question..where I want to refer list types from another structure not directly"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 136, "user_id": 2894021, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f1d430ec2a38a98ab8dc2db0ef176943?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/2894021/kaushik-koneru"}, "edited": false, "score": 0, "creation_date": 1489611287, "post_id": 42820095, "comment_id": 72752721, "body": "See edits.  1st section assigns <code>list</code> to <code>list_1</code>, then to <code>list_2</code>.  No <code>malloc(...)</code> used."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1489671503, "last_edit_date": 1489671503, "creation_date": 1489609838, "answer_id": 42820095, "question_id": 42819696, "link": "https://stackoverflow.com/questions/42819696/unable-to-parse-contents-of-structure-in-the-code/42820095#42820095", "title": "Unable to parse Contents of Structure in the code", "body": "<p><em>EDIT</em> to answer your question about initialization:<br>\nAs I mentioned in my comment under your post, the initialization of your 'list_types` variable is not correct.  </p>\n\n<p>Using your original version of the <code>list_types</code> variable: </p>\n\n<pre><code>test_t **list_types = { list_1, list_2 };\n</code></pre>\n\n<p>My compiler throws error: </p>\n\n<blockquote>\n  <p><code>Invalid initialization type;found</code>pointer to test_t<code>expected\n  </code>pointer to pointer to test_t</p>\n</blockquote>\n\n<p>Using this version (that was edited in later): </p>\n\n<pre><code>test_t list_types[][] = { list_1, list_2 };\n</code></pre>\n\n<p>My compiler throws error: </p>\n\n<blockquote>\n  <p>Missing array size for higher dimensions of multidimensional array.</p>\n</blockquote>\n\n<p>Neither of those initialization will work.  Change the form of your initialization to: </p>\n\n<pre><code>test_t *list_types[] = { list_1, list_2 };\n</code></pre>\n\n<p>and it will throw no errors, and contain both instances of `test_t.  </p>\n\n<p><em>END</em> of edit.  </p>\n\n<p><em>...refer to each from that structure rather than using different name...</em></p>\n\n<p>With the initialization made as shown above, you can now refer to each structure using the same name as shown below:  </p>\n\n<pre><code>....\n//test_t **list_types = { list_1, list_2 };//incorrect initialization...\ntest_t *list = NULL;\n\nvoid main(void) {\n\n    list = &amp;list_1[0]; //assign list_1 to list\n\n    int iter = 0;\n    for ( iter = 0; iter &lt; 3; iter++){\n        printf(\"Bool: %d Val: %d\\n\",list[iter].val, list[iter].p);\n    }\n\n\n    list = &amp;list_2[0];//assign list_2 to list\n\n    iter = 0;\n    for ( iter = 0; iter &lt; 3; iter++){\n        printf(\"Bool: %d Val: %d\\n\",list[iter].val, list[iter].p);\n    }\n    getchar();//stops execution in my environment\n}\n</code></pre>\n\n<p>The following illustrates contents of the <code>list</code> instance:  </p>\n\n<p>After first assignment:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/rPyTE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rPyTE.jpg\" alt=\"enter image description here\"></a>    </p>\n\n<p>After second assignment:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/L2Og4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L2Og4.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1655, "user_id": 6945651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXXfN.jpg?s=128&g=1", "display_name": "J. Piquard", "link": "https://stackoverflow.com/users/6945651/j-piquard"}, "is_accepted": false, "score": 0, "last_activity_date": 1489611895, "last_edit_date": 1489611895, "creation_date": 1489610487, "answer_id": 42820287, "question_id": 42819696, "link": "https://stackoverflow.com/questions/42819696/unable-to-parse-contents-of-structure-in-the-code/42820287#42820287", "title": "Unable to parse Contents of Structure in the code", "body": "<p>In fact, you want to create an array of struct-pointer.</p>\n\n<p><strong>Step 1</strong> - declare and initialize the array as using.</p>\n\n<pre><code>test_t *list_types[] = { list_1, list_2 };\n</code></pre>\n\n<p>instead  of:</p>\n\n<pre><code>test_t list_types[][] = { list_1, list_2 };\n</code></pre>\n\n<p><strong>Step 2</strong> - use that array instead of a pointer to that array to now the size.</p>\n\n<blockquote>\n  <p>And use the index <code>iter</code> to select between <code>list_1</code> or <code>list_2</code>,\n  otherwise you will access to the <code>list_1</code>.</p>\n  \n  <p>To access to all items of one <code>list_&lt;x&gt;</code>, it is necessary to store the\n  size.</p>\n</blockquote>\n\n<pre><code>for ( iter = 0; iter &lt; sizeof(list_types)/sizeof(list_types[0]); iter++){\n    list = list_types[iter];\n    printf(\"Bool: %d Val: %d\\n\",list[0].val, list[0].p);\n}\n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>for ( iter = 0; iter &lt; sizeof(list)/sizeof(list[0]); iter++){\n    printf(\"Bool: %d Val: %d\\n\",list[0].val, list[0].p);\n}\n</code></pre>\n"}], "owner": {"reputation": 136, "user_id": 2894021, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/f1d430ec2a38a98ab8dc2db0ef176943?s=128&d=identicon&r=PG&f=1", "display_name": "Kaushik Koneru", "link": "https://stackoverflow.com/users/2894021/kaushik-koneru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489671503, "creation_date": 1489608426, "last_edit_date": 1489609675, "question_id": 42819696, "link": "https://stackoverflow.com/questions/42819696/unable-to-parse-contents-of-structure-in-the-code", "title": "Unable to parse Contents of Structure in the code", "body": "<p>I am trying to accumulate all types of list in a Structure and refer to each from that structure rather than using different name of the structure</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #define TRUE 1\n    #define FALSE 0\n\n    typedef struct test_s {\n        int    val;\n        int     p;\n    }test_t;\n\n    test_t list_1[] = {\n            { TRUE, 1},\n            { TRUE, 2},\n            { TRUE, 3}\n    };\n\n    test_t  list_2[] = {\n            {FALSE, 1},\n            {TRUE , 2},\n            {TRUE , 3}\n    };\n\n    test_t list_types[][] = { list_1, list_2 };\n    test_t *list = NULL;\n\n    void\n    main() {\n\n        list = list_types[0];\n\n        int iter = 0;\n        for ( iter = 0; iter &lt; sizeof(list)/sizeof(list[0]); iter++){\n            printf(\"Bool: %d Val: %d\\n\",list[0].val, list[0].p);\n        }\n    }\n</code></pre>\n\n<p>I am \nWhen I am trying to compile, I am getting following error. Please highlight what I am missing in this snippet</p>\n\n<pre><code>test.c:22:8: error: array type has incomplete element type\n</code></pre>\n"}, {"tags": ["c", "linux", "shell", "unix", "malloc"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 3, "creation_date": 1489606584, "post_id": 42819099, "comment_id": 72750002, "body": "Are you sure you are not using a c++ compiler"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1489606617, "post_id": 42819099, "comment_id": 72750029, "body": "Cannot reproduce: clean compilation."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1489606660, "post_id": 42819099, "comment_id": 72750064, "body": "from &#39;<code>void*</code>&#39; to &#39;<code>char**</code>&#39;  typo as from &#39;<code>void*</code>&#39; to &#39;<code>char*</code>&#39; ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1489606723, "post_id": 42819099, "comment_id": 72750104, "body": "<code>#ifdef __cplusplus</code> <code>#error arrrgh! C++</code> <code>#endif</code>"}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1489606602, "creation_date": 1489606602, "answer_id": 42819164, "question_id": 42819099, "link": "https://stackoverflow.com/questions/42819099/invalid-conversion-error-while-using-malloc/42819164#42819164", "title": "Invalid conversion error while using malloc", "body": "<p>You are probably using a C++ compiler/C++ mode where there's no implicit conversion from <code>void*</code> to <code>T*</code>. In C, you shouldn't get this error as <code>void*</code> can be assigned to any other data pointer without explicit cast.</p>\n\n<p>Either you can use a C compiler or if you must use C++ compiler then cast appropriately.</p>\n"}, {"tags": [], "owner": {"reputation": 1260, "user_id": 3804799, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/938bb746e768e52b02aa3c2c1f7a672b?s=128&d=identicon&r=PG&f=1", "display_name": "icebp", "link": "https://stackoverflow.com/users/3804799/icebp"}, "is_accepted": false, "score": 1, "last_activity_date": 1489606626, "last_edit_date": 1495535394, "creation_date": 1489606626, "answer_id": 42819173, "question_id": 42819099, "link": "https://stackoverflow.com/questions/42819099/invalid-conversion-error-while-using-malloc/42819173#42819173", "title": "Invalid conversion error while using malloc", "body": "<p>Because <code>void *</code> can't be implicitly converted to <code>char *</code> in c++ and you're probably using c++. Quick fix:</p>\n\n<pre><code>char *line = (char *)malloc(sizeof(char) * buff_size);\n</code></pre>\n\n<p>You should read <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc?rq=1\">Do I cast the result of malloc?</a></p>\n"}], "owner": {"reputation": 9, "user_id": 7670031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69bbe3913bc0a1a34852daa2ee804b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Austin Anderson", "link": "https://stackoverflow.com/users/7670031/austin-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489606684, "creation_date": 1489606405, "last_edit_date": 1489606684, "question_id": 42819099, "link": "https://stackoverflow.com/questions/42819099/invalid-conversion-error-while-using-malloc", "title": "Invalid conversion error while using malloc", "body": "<p>I am trying to write a shell program in C. The following function is supposed to get user line input. I keep receiving an \"invalid conversion from <code>void*</code> to <code>char**</code> error on the line where I attempt to malloc. </p>\n\n<p>I do not understand why. Can anyone explain?</p>\n\n<pre><code>char *get_line_input(void)\n{\n  int scan;\n  int buff_size = 1024;\n  int argument_tracker = 0;\n  char *line = malloc(sizeof(char) * buff_size);\n\n  while (1) {\n    scan = getchar();\n    if (scan == '\\n') {\n      line[argument_tracker] = '\\0';\n      return line;\n    } else {\n      line[argument_tracker] = scan;\n    }\n    argument_tracker++;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "object-files"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489605553, "post_id": 42818801, "comment_id": 72749428, "body": "Edit the linker script."}, {"owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489605800, "post_id": 42818801, "comment_id": 72749541, "body": "? That has no bearing on this question; the linker doesn&#39;t affect this library at all, it&#39;s just the compiler and the <code>ar</code> utility."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489606369, "post_id": 42818801, "comment_id": 72749865, "body": "TRhe linker is responsible to link the final program code. Ant that&#39;s where you can mpa the sections from each input file to the output&#39;s sections resp. segments. So yes, it very well is involved. You are just looking at the wrong place. What do you expect will happen with an unknow section from an input file when you eventually link it?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 2, "creation_date": 1489606498, "post_id": 42818801, "comment_id": 72749941, "body": "You can use <a href=\"http://man7.org/linux/man-pages/man1/objcopy.1.html\" rel=\"nofollow noreferrer\"><code>objcopy --rename-section</code></a>, for example."}, {"owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489609205, "post_id": 42818801, "comment_id": 72751502, "body": "@Olaf &quot;What do you expect will happen with an unknow section from an input file when you eventually link it?&quot; -- our linker script places sections that don&#39;t otherwise match, into the <code>.text</code> output section, so it doesn&#39;t change how things are linked. I&#39;m just trying to partition program object code from this particular library into a contiguous area."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489611113, "post_id": 42818801, "comment_id": 72752636, "body": "That sounds like a bad idea. You normally discard such sections not to clutter the binary with unexpected stuff. What do you mean with &quot;continous area&quot;? The same section of a module is normally not split by the linker."}, {"owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1489612491, "post_id": 42818801, "comment_id": 72753369, "body": "@NominalAnimal -- thanks! Post as an answer and I&#39;ll accept. This worked great for me and I was able to see more clearly how much program and data memory was used by a particular library."}], "answers": [{"tags": [], "owner": {"reputation": 510, "user_id": 2678123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51aa9ec99be437b3fd56b7beb1e2ac1c?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/2678123/varun-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1539172582, "creation_date": 1539172582, "answer_id": 52739706, "question_id": 42818801, "link": "https://stackoverflow.com/questions/42818801/is-there-any-way-to-rename-the-section-name-in-a-o-or-a-file-compiled-by-gcc/52739706#52739706", "title": "Is there any way to rename the section name in a .o or .a file compiled by gcc?", "body": "<p>.a library or static library is nothing but collection of object files only.</p>\n\n<p>So before linking you can use objcpy rename command to change name of your sections.\nSimilarly you can change symbol name also using \" -redefine-sym\"</p>\n\n<p>--rename-section oldname=newname[,flags]\n           Rename a section from oldname to newname, optionally changing the\n           section's flags to flags in the process.  This has the advantage\n           over using a linker script to perform the rename in that the\n           output stays as an object file and does not become a linked\n           executable.\nExample:-</p>\n\n<pre><code>                 objcopy -I binary -O &lt;output_format&gt; -B &lt;architecture&gt; \\\n                  --rename-section .data=.rodata,alloc,load,readonly,data,contents \\\n                  &lt;input_binary_file&gt; &lt;output_object_file&gt;\n</code></pre>\n\n<p>Refer: <a href=\"http://man7.org/linux/man-pages/man1/objcopy.1.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man1/objcopy.1.html</a></p>\n"}], "owner": {"reputation": 170705, "user_id": 44330, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dd5a7ef1476fb01998a215b1642dfd07?s=128&d=identicon&r=PG", "display_name": "Jason S", "link": "https://stackoverflow.com/users/44330/jason-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1972, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1539172582, "creation_date": 1489605428, "question_id": 42818801, "link": "https://stackoverflow.com/questions/42818801/is-there-any-way-to-rename-the-section-name-in-a-o-or-a-file-compiled-by-gcc", "title": "Is there any way to rename the section name in a .o or .a file compiled by gcc?", "body": "<p>I have a precompiled library compiled with a gcc-based compiler and I would like to move the functions from the default <code>.text</code> section to some other section name (let's say <code>foo</code>). Is there a way to do this using binutils without recompiling?</p>\n"}, {"tags": ["c", "debugging", "byte"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 8, "creation_date": 1489605089, "post_id": 42818653, "comment_id": 72749154, "body": "Warnings are there for a reason.  Don&#39;t ignore them."}, {"owner": {"reputation": 1385, "user_id": 6693299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CIeRF.jpg?s=128&g=1", "display_name": "ScottK", "link": "https://stackoverflow.com/users/6693299/scottk"}, "edited": false, "score": 0, "creation_date": 1489605134, "post_id": 42818653, "comment_id": 72749176, "body": "Processes only return a single byte when the call exit(). So a return code of 255 likely means that the process returned -1, and it got truncated to 8 bits. You do not need ot change a variable size to fix this."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1489605140, "post_id": 42818653, "comment_id": 72749181, "body": "This is not &quot;encryption&quot; - you&#39;re simply adding an offset (<code>key</code>) to a byte value - except you&#39;re doing that incorrectly because you&#39;re not dereferencing <code>key</code>, but using the raw pointer value."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1489608539, "post_id": 42818653, "comment_id": 72751154, "body": "@Dai It&#39;s a Caesar cipher, the simplest form of encryption known."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1489608541, "post_id": 42818653, "comment_id": 72751155, "body": "I believe @chux means you <i>must</i> pass initialised pointers to <code>scanf</code> which also point to enough allocated memory, which you are not doing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1489611302, "post_id": 42818653, "comment_id": 72752730, "body": "@WeatherVane Oops I wrote my comment without the important &quot;un-&quot;. So the corrected comment should be: <code>char *f1;... scanf (&quot;%s&quot;, f1);</code>  --&gt; Code is passing un-initialized <code>f1</code> to <code>scanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7337392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o5arXlIBf_8/AAAAAAAAAAI/AAAAAAAABME/asWy_1M38Wk/photo.jpg?sz=128", "display_name": "Arak Rachael", "link": "https://stackoverflow.com/users/7337392/arak-rachael"}, "edited": false, "score": 0, "creation_date": 1489638907, "post_id": 42819836, "comment_id": 72761659, "body": "It will take time to go through all of this. Normally I dont pay attention to warnings, since they are ignored depending on what you are doing."}, {"owner": {"reputation": 13, "user_id": 7337392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o5arXlIBf_8/AAAAAAAAAAI/AAAAAAAABME/asWy_1M38Wk/photo.jpg?sz=128", "display_name": "Arak Rachael", "link": "https://stackoverflow.com/users/7337392/arak-rachael"}, "edited": false, "score": 0, "creation_date": 1489648488, "post_id": 42819836, "comment_id": 72765293, "body": "Ok, it works! Thank you very much, Now I have to check all of your post and learn every problem, piece by piece. I think this is a simple byte to byte encryption software? If the key is longer, than the security becomes higher?"}, {"owner": {"reputation": 13, "user_id": 7337392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o5arXlIBf_8/AAAAAAAAAAI/AAAAAAAABME/asWy_1M38Wk/photo.jpg?sz=128", "display_name": "Arak Rachael", "link": "https://stackoverflow.com/users/7337392/arak-rachael"}, "edited": false, "score": 0, "creation_date": 1489664017, "post_id": 42819836, "comment_id": 72775159, "body": "I thank you for the help. It was useful. I have details like this to pay attention to. Can you give me a good tutorial, so I can begin learning the procedure? If you need help with microcontrollers, tell me."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1489608946, "creation_date": 1489608946, "answer_id": 42819836, "question_id": 42818653, "link": "https://stackoverflow.com/questions/42818653/byte-to-byte-encryption-c-program-logical-mistakes/42819836#42819836", "title": "Byte to byte encryption &quot;C&quot; program logical mistakes", "body": "<p>First, let's address the warnings.</p>\n\n<p>Several of the warnings are for using uninitialized variables.  Each of these involves passing a <code>char *</code> to <code>scanf</code>.  The <code>%s</code> format specifier to <code>scanf</code> expects a pointer to a character array.  What you've passed in instead is a pointer that isn't pointing anywhere.  Dereferencing an uninitialized pointer invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in this case manifests as a crash.</p>\n\n<p>Declare these variables as <code>char</code> arrays with enough space for the input you expect.  Also, add a length specifier to <code>%s</code> specifying the maximum number of characters to read.</p>\n\n<p>The integer/pointer comparison errors are because of how you're using <code>process</code>.  This variable is a <code>char *</code>, expected to point to a null terminated string, but you're comparing it against an integer which doesn't make sense.</p>\n\n<p>Instead, use the <code>strcmp</code> function to compare it against <code>\"encryption\"</code> or <code>\"decryption\"</code>.</p>\n\n<p>The \"assignment makes integer from pointer without a cast\" is because you're trying to add <code>key</code>, which is a <code>char *</code>, to <code>Byte</code>, which is a <code>char</code>.  You  presumably want to index <code>key</code> to get a particular character from it, i.e. <code>key[1]</code>.  You'll also want a separate counter for the current key index, and you'll want to reset it to 0 when it becomes greater than or equal to the length of the key.</p>\n\n<p>The first time into your <code>while</code> loop, <code>Byte</code> hasn't been set, but you still compare it against <code>EOF</code>.  You also overwrite the value of <code>Byte</code> you're comparing when you read in the next byte, but then you don't check if that is <code>EOF</code>.</p>\n\n<p>You need to change the type of <code>Byte</code> and <code>newByte</code> to <code>int</code>, since that's what <code>fgetc</code> returns.  The <code>EOF</code> value is typically outside the range of a <code>char</code>, so you'll never find it unless you change the type.  You should also perform the read and comparison as part of the loop condition instead of using <code>while(1)</code> and remove the read from the loop body.</p>\n\n<p>The implicit declaration warning is because you call the <code>Encrypt</code> function before defining or declaring it.  As a result, an implicit declaration of <code>int Encrypt()</code> (i.e. a function taking an unknown number of arguments and returning an <code>int</code>) is created.  This happens to coincide which how it is defined, but still not a match.</p>\n\n<p>Either add a declaration for this function before <code>main</code>, or move the whole function before <code>main</code>.</p>\n\n<p>Besides the warnings, the <code>return 1</code> statement executes at the bottom of your <code>while</code> loop, so the loop only goes though one iteration before exiting.  The above suggestion to test the value of <code>Byte</code> in the condition should address this.</p>\n\n<p>Your decrypt is currently doing the same as your encrypt.  You probably want to subtract here instead of add.  In both cases, you also need to check for wraparound.  So if the encrypted value is larger than 255, subtract 256.  Similarly for the decrypt, if the value is less than 0, add 256.</p>\n\n<p>After applying these fixes, your code should look something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n// declare function before it's called\nvoid Encrypt(char * FILENAME, char * NEW_FILENAME);\n\nint main ()\n{\n    char f1[100];   // array big enough to hold expected input\n    char f2[100];   // array big enough to hold expected input\n\n    printf (\"Please enter file for encryption\\n\");\n    scanf  (\"%99s\", f1);    // set max characters to read to prevent buffer overflow\n    printf (\"Please enter the name of the file after encryption\\n\");\n    scanf  (\"%99s\", f2);\n\n    Encrypt(f1, f2);\n    return 0;\n}\n\nvoid Encrypt(char * FILENAME, char * NEW_FILENAME)\n{\n         printf(\"Encryption started\\n\");\n         FILE *inFile;\n         FILE *outFile;\n         char key[50];         // array big enough to hold expected input\n         char process[50];     // array big enough to hold expected input\n         int keylen, keyidx;\n\n         int Byte;       // fgetc returns int, so use an int\n         int newByte;\n\n         printf (\"Please enter 'encryption or decryption'\\n\");\n         scanf  (\"%49s\", process);\n         printf (\"Please enter the key\\n\");\n         scanf  (\"%49s\", key);\n         keylen = strlen(key);\n         keyidx = 0;    // starting index into key\n         printf(\"Opening files\\n\");\n\n         inFile = fopen(FILENAME,\"rb\");\n         outFile = fopen(NEW_FILENAME, \"w\");\n\n         if(inFile == NULL)\n         {\n            printf(\"Error: Can't Open inFile\\n\");\n         }\n         else if(outFile == NULL)\n         {\n            printf(\"Error: Can't open outFile\\n\");\n         }\n         else\n         {\n                 printf(\"File Opened, Encrypting\\n\");\n                 while((Byte = fgetc(inFile)) != EOF)    // read a byte, check if EOF\n                 {\n                         if (!strcmp(process,\"encryption\"))\n                         {\n                                 newByte = Byte + key[keyidx];    // use key index\n                                 if (newByte &gt; 255) newByte -= 256;   // check for overflow\n                         }\n                         else if (!strcmp(process,\"decryption\"))\n                         {\n                                 newByte = Byte - key[keyidx];\n                                 if (newByte &lt; 0) newByte += 256;\n                         }\n                         else\n                         {\n                            newByte = Byte;\n                         }\n                         fputc(newByte, outFile);\n                         keyidx++;\n                         // loop to the start of the key if needed\n                         if (keyidx &gt;= keylen) keyidx = 0;\n                 }\n         }\n         if (inFile != null) fclose(inFile);     // close your files when you're done\n         if (outFile != null) fclose(outFile);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7337392, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o5arXlIBf_8/AAAAAAAAAAI/AAAAAAAABME/asWy_1M38Wk/photo.jpg?sz=128", "display_name": "Arak Rachael", "link": "https://stackoverflow.com/users/7337392/arak-rachael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 42819836, "answer_count": 1, "score": -2, "last_activity_date": 1489608946, "creation_date": 1489604901, "last_edit_date": 1489605060, "question_id": 42818653, "link": "https://stackoverflow.com/questions/42818653/byte-to-byte-encryption-c-program-logical-mistakes", "title": "Byte to byte encryption &quot;C&quot; program logical mistakes", "body": "<p>Good day! I have this software made to encrypt and decrypt files. I am new to Real Time Operating Systems as I normally program microcontrollers, I was programming the basic things in Operatins Systems some time ago, including this project. The Codeblocks gnu C portable compiler IDE tells me there are no errors only warnings. But when I execute the code it runs to some point and then gives the error that the program stopped unexpectedly and the command prompt needs to close.</p>\n\n<p>The code and warnings are here. From the command prompt I get: <code>Process returned 255 0xFF</code>. Maybe a variable definition needs to be more than 8-bits.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid main ()\n{\n    char *f1;\n    char *f2;\n\n    printf (\"Please enter file for encryption\\n\");\n    scanf  (\"%s\", f1);\n    printf (\"Please enter the name of the file after encryption\\n\");\n    scanf  (\"%s\", f2);\n\n    Encrypt(f1, f2);\n}\n\nint Encrypt(char * FILENAME, char * NEW_FILENAME)\n{                                  /********VARIABLE DEFINITION BLOCK*******/\n         printf(\"Encryption started\\n\");\n         FILE *inFile;                                       //Declare inFile\n         FILE *outFile;                                      //Declare outFile\n         char *key;\n         char *process;\n\n         char Byte;\n         char newByte;\n         /*int  n;*/\n\n                                    /******USER INPUT BLOCK*******/\n         printf (\"Please enter 'encryption or decryption'\\n\");\n         scanf  (\"%s\", process);\n         printf (\"Please enter the key\\n\");\n         scanf  (\"%s\", key);\n         printf(\"Opening files\\n\");\n\n         /*int i=0;*/\n                                    /******FILE OPEN BLOCK********/\n         inFile = fopen(FILENAME,\"rb\");\n         outFile = fopen(NEW_FILENAME, \"w\");\n\n                                    /*****MAIN PROGRAM BLOCK******/\n         if(inFile == NULL)                     /* check if the input file is empy */\n         {\n            printf(\"Error: Can't Open inFile\\n\");\n         }\n\n                                                /* check if the output file is empty */\n         if(outFile == NULL)\n         {\n            printf(\"Error: Can't open outFile\\n\");\n         }\n                                                /* if both files are not empty output \"Encrypting\" and begin encryption */\n         else\n         {\n                 printf(\"File Opened, Encrypting\\n\");\n                                                /* encrypting cycle */\n                 while(1)\n                 {\n                         printf(\".\");                /* loading symbol */\n\n                                                     /* if the current byte is not the \"End of file\" byte and the process is encryption */\n                         if(Byte!=EOF &amp;&amp; process == 1)\n                         {                          /* Byte = function get char from \"inFile\" */\n                                 Byte = fgetc (inFile);\n                         //      printf(\"%d\",Byte); /* the new byte = old byte plus 1 byte from the key */\n                                 newByte = Byte + key;\n                                                    /* we put the new byte in the new already encrypted file */\n                                 fputc(newByte, outFile);\n\n                         }\n                                                    /* if the current file is not the \"End of file\" byte and the process is decryption */\n                         if(Byte!=EOF &amp;&amp; process == 2)\n                         {                          /* we read 1 byte with the function get char from the file recorded in the string (pointer) \"inFile */\n                                 Byte = fgetc (inFile);\n                         //      printf(\"%d\",Byte); /* 1 new byte, equals the old byte plus 1 byte from the key */\n                                 newByte = Byte + key;\n                                                    /* we put the new byte with the function put char in the string (pointer) in which the output file is */\n                                 fputc(newByte, outFile);\n\n                         }\n                                                    /* if the two \"while conditions\" are not true we print \"End of file\" */\n                         else\n                         {\n                                 printf(\"End of File\\n\");\n                         }\n                    return 1;\n                 }\n         }\n}\n</code></pre>\n\n<p>Build output:</p>\n\n<pre><code>||=== Build: Debug in Encryption-software (compiler: GNU GCC Compiler) ===|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|7|warning: return type of 'main' is not 'int' [-Wmain]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c||In function 'main':|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|17|warning: implicit declaration of function 'Encrypt' [-Wimplicit-function-declaration]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c||In function 'Encrypt':|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|65|warning: comparison between pointer and integer|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|69|warning: assignment makes integer from pointer without a cast|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|75|warning: comparison between pointer and integer|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|79|warning: assignment makes integer from pointer without a cast|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|92|warning: control reaches end of non-void function [-Wreturn-type]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|34|warning: 'process' is used uninitialized in this function [-Wuninitialized]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|36|warning: 'key' is used uninitialized in this function [-Wuninitialized]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|65|warning: 'Byte' may be used uninitialized in this function [-Wmaybe-uninitialized]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c||In function 'main':|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|13|warning: 'f1' is used uninitialized in this function [-Wuninitialized]|\nC:\\Users\\arakel-the-dragon\\Documents\\Encryption-software\\main.c|15|warning: 'f2' is used uninitialized in this function [-Wuninitialized]|\n||=== Build finished: 0 error(s), 12 warning(s) (0 minute(s), 1 second(s)) ===|\n</code></pre>\n"}, {"tags": ["c", "fork", "semaphore", "fifo"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1489604469, "post_id": 42818473, "comment_id": 72748774, "body": "Normally it&#39;s the parent waiting for the child."}, {"owner": {"reputation": 152, "user_id": 7560264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yhuvk.jpg?s=128&g=1", "display_name": "WizKiz", "link": "https://stackoverflow.com/users/7560264/wizkiz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489604516, "post_id": 42818473, "comment_id": 72748803, "body": "So would it be better to do the writing in the parent and perform the actions in the child?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489604541, "post_id": 42818473, "comment_id": 72748824, "body": "You have a deadlock. The parent doesn&#39;t post to the semaphore until after it reads something from the FIFO. But the child doesn&#39;t write to the FIFO until after the parent posts to the semaphore."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489604566, "post_id": 42818473, "comment_id": 72748846, "body": "@Olaf That&#39;s just waiting for termination. In other cases, it doesn&#39;t matter which is which."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1489604804, "post_id": 42818473, "comment_id": 72748980, "body": "I suspect this is an X/Y problem.  Why does the parent need a mechanism other than the FIFO to wait synchronize with the child?  Why does the child need to wait for the parent at all?"}, {"owner": {"reputation": 152, "user_id": 7560264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yhuvk.jpg?s=128&g=1", "display_name": "WizKiz", "link": "https://stackoverflow.com/users/7560264/wizkiz"}, "edited": false, "score": 0, "creation_date": 1489604891, "post_id": 42818473, "comment_id": 72749027, "body": "It doesn&#39;t deadlock when I run something very similar :O The semaphore is started at 1? child calls wait on it? writes?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1489605039, "post_id": 42818473, "comment_id": 72749122, "body": "Also, it is strange for a parent process and its forked child process to communicate via an external FIFO instead of directly via a pipe."}, {"owner": {"reputation": 152, "user_id": 7560264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yhuvk.jpg?s=128&g=1", "display_name": "WizKiz", "link": "https://stackoverflow.com/users/7560264/wizkiz"}, "edited": false, "score": 0, "creation_date": 1489605362, "post_id": 42818473, "comment_id": 72749312, "body": "It helps because for my use, the named fifo needs to be opened elsewhere other than in the main. The code above just doesn&#39;t explain that"}, {"owner": {"reputation": 11359, "user_id": 1323940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/def1b1fd4342d9e332b7a3bf41f57a00?s=128&d=identicon&r=PG", "display_name": "SzG", "link": "https://stackoverflow.com/users/1323940/szg"}, "edited": false, "score": 0, "creation_date": 1489612353, "post_id": 42818473, "comment_id": 72753284, "body": "You need to know that anything you write into a pipe, can be read only once. If you have 2 read FDs consuming it, maybe the other one has &quot;stolen&quot; some data from it."}], "owner": {"reputation": 152, "user_id": 7560264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yhuvk.jpg?s=128&g=1", "display_name": "WizKiz", "link": "https://stackoverflow.com/users/7560264/wizkiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 546, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489604281, "creation_date": 1489604281, "question_id": 42818473, "link": "https://stackoverflow.com/questions/42818473/fork-while-loop-semaphore-control-in-c", "title": "Fork, While loop semaphore control in C", "body": "<p>In C, Im curious how to control the child to wait for the parent to finish doing all of its actions. In the example code I am writing to a named fifo in child and reading in the parent. Wrote the code in the post so don't be rough.</p>\n\n<p>I tried doing it the code snippet below and it worked somewhat but the semaphore sequence eventually broke at some point. Is this possible, do I need more than 1 semaphore? It's indeterministic which process will go first, how can I make it deterministic to get input from the child first? I just started with semaphores and the concept is simple but Im having a hard time knowing when to post and when to wait.</p>\n\n<pre><code>sem_unlink(\"/queue\");\nsem_t queue = sem_open(\"/queue\",O_CREAT,O_RDWR,1);\npid_t example_pid = fork();\nswitch(example_pid)\n{\n   case -1:\n     example_pid = -1;\n     exit(1);\n   case 0:\n       int write_fd = open(myfifo,O_WRONLY);\n       while(1){\n           sem_wait(queue);\n           //Get some input\n           write(write_fd,input,sizeof(input)); \n       }\n   default:\n      int read_fd = open(myfifo,O_RDONLY);\n      while(1){\n           read(read_fd,BUF,sizeof(BUF));\n           //Do some actions from reading input\n           sem_post(queue);\n      }\n}\n</code></pre>\n\n<p>Comment: I think I would need two semaphores so that the parent knows the child is done writing?</p>\n"}, {"tags": ["c", "math", "gcc", "hyperlink"], "comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1489603720, "post_id": 42818223, "comment_id": 72748264, "body": "What does the make file look like? Are you allowed to edit it? Is the use of the power function unavoidable or just the most immediate solution (e.g., instead of using the Horner scheme for polynomial evaluation)?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 2, "creation_date": 1489603785, "post_id": 42818223, "comment_id": 72748309, "body": "First, using <code>pow</code> in such an assignment is usually not what you want, there are much simpler ways to deal with this. Then linking with math is to add <code>-lm</code> to the linker, usually you can do that by setting the environment varlalble <code>LDFLAGS</code> to that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1489604075, "post_id": 42818223, "comment_id": 72748497, "body": "... but note that if you are expected to use the makefile as-is, then you&#39;re out of luck.  You <i>can</i> set variables on the <code>make</code> command line or in its environment that <code>make</code> will then use, but you cannot rely on the grader to do that when your assignment is evaluated."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489604544, "post_id": 42818223, "comment_id": 72748827, "body": "Most likely your prof does not want you to use floating point for integer arithmetics. He would be right, that is a bad idea. And there is absolutely no need  to use <code>pow</code>."}, {"owner": {"reputation": 11, "user_id": 7717011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1dbb6bb9bd8b7ab64bc9811682fb57?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7717011/max"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1489605438, "post_id": 42818223, "comment_id": 72749362, "body": "@LutzL I rewrote the program using the horner scheme now, and it works and made the program a lot shorter. I assume this is what was wanted. We were indeed not allowed to edit anything apart from the code of the function. Thanks for the answers!"}], "owner": {"reputation": 11, "user_id": 7717011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1dbb6bb9bd8b7ab64bc9811682fb57?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7717011/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489603548, "creation_date": 1489603548, "question_id": 42818223, "link": "https://stackoverflow.com/questions/42818223/link-math-library-with-make", "title": "Link math library with make", "body": "<p>I'm using gcc version 4.8.4 on Ubuntu.\nIn my university assignment I have to write a function in C that converts a string that contains a number into an octal/decimal number.\nThat's no problem, but using the pow function makes problems.\nI know that you have to link the math library when compiling, but we are given a makefile, so my professor wants us to use make.\nNow, the thing is, the linking of the math library isn't included in the make file and I didn't find any way to make it work.\nIn the end I ended up writing my own pow function to make it work.\nSo my question is, is there a way to link the math library when using the make instruction, and if there is, how do you do it?</p>\n"}, {"tags": ["c++", "c", "constants"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 2, "creation_date": 1489601855, "post_id": 42817641, "comment_id": 72747174, "body": "Undefined behaviour."}, {"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 1, "creation_date": 1489601859, "post_id": 42817641, "comment_id": 72747180, "body": "That&#39;s a lot of de- and re-referencing. Be careful."}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489601974, "post_id": 42817641, "comment_id": 72747241, "body": "I know it has to be undefined behavior and it&#39;ll depend on the compiler as well, but why does the <code>*(int *)&amp;i</code> show the changed value?"}, {"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 1, "creation_date": 1489602004, "post_id": 42817641, "comment_id": 72747258, "body": "@AdityaGulavani That&#39;s the definition of undefined behavior -- behavior that you cannot predict."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1489602059, "post_id": 42817641, "comment_id": 72747296, "body": "@AdityaGulavani because compiler does not bother to look into memory and uses <code>const int</code> value directly."}, {"owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "edited": false, "score": 0, "creation_date": 1489602062, "post_id": 42817641, "comment_id": 72747298, "body": "It could be the compiler detecting your iniquity and emit another variable, so <i>i</i> remains unchanged."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 3, "creation_date": 1489602073, "post_id": 42817641, "comment_id": 72747306, "body": "It&#39;s a waste of time to reason about undefined behaviour."}, {"owner": {"reputation": 95188, "user_id": 440119, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5ec9ca2a92a94a5470396073129d79e7?s=128&d=identicon&r=PG", "display_name": "Benjamin Lindley", "link": "https://stackoverflow.com/users/440119/benjamin-lindley"}, "edited": false, "score": 5, "creation_date": 1489602079, "post_id": 42817641, "comment_id": 72747309, "body": "<i>&quot;is showing a different value, so there has to be a new variable.&quot;</i> -- No, there doesn&#39;t. Since you lied to the compiler and told it that the value of <code>i</code> would never change from 10, it is free to simply use the constant value 10 wherever you request the value of <code>i</code>. It doesn&#39;t need a variable for this."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1489602309, "post_id": 42817641, "comment_id": 72747439, "body": "Try disassembling the code to see what the compiler <i>actually</i> generates for this"}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489602778, "post_id": 42817641, "comment_id": 72747727, "body": "I am currently exploring effects of declaring it as volatile as well. Would be great if you can add you two cents to that thought"}, {"owner": {"reputation": 3903, "user_id": 206545, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c03fef2c351700918666bca7b3d9f3ed?s=128&d=identicon&r=PG", "display_name": "sizzzzlerz", "link": "https://stackoverflow.com/users/206545/sizzzzlerz"}, "edited": false, "score": 0, "creation_date": 1489602780, "post_id": 42817641, "comment_id": 72747728, "body": "Under what programming use case would you ever want to do this?"}, {"owner": {"reputation": 1341, "user_id": 4524618, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8e1ca7e81266dc3e8f724a4864b3d90e?s=128&d=identicon&r=PG", "display_name": "Sniper", "link": "https://stackoverflow.com/users/4524618/sniper"}, "edited": false, "score": 0, "creation_date": 1489602941, "post_id": 42817641, "comment_id": 72747824, "body": "Check this out  <a href=\"http://stackoverflow.com/questions/39106137/change-constant-value\" title=\"change constant value\">stackoverflow.com/questions/39106137/change-constant-value</a>"}], "answers": [{"comments": [{"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489602593, "post_id": 42817844, "comment_id": 72747612, "body": "Yes, I never do that. I just wanted to know the underlying compiler behaviour when something like this comes up"}, {"owner": {"reputation": 7737, "user_id": 3410396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acc26b280cedaa721d90828a80e39706?s=128&d=identicon&r=PG&f=1", "display_name": "Revolver_Ocelot", "link": "https://stackoverflow.com/users/3410396/revolver-ocelot"}, "reply_to_user": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489603233, "post_id": 42817844, "comment_id": 72748005, "body": "@AdityaGulavani the compiler behaviour might not be consistent even between two compilations of same program. And it almost surely would differ between different compilers. One thing you can do is to make a list of most likely behaviour in simple situations, but it wouldn&#39;t be really useful. P.S. Did you get a <i>attempt to write into write-protected page</i> error already in your experiments?"}, {"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489603357, "post_id": 42817844, "comment_id": 72748078, "body": "Not yet, now that I&#39;ve heard of it, I would like to explore it :)"}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": false, "score": 3, "last_activity_date": 1489602395, "creation_date": 1489602395, "answer_id": 42817844, "question_id": 42817641, "link": "https://stackoverflow.com/questions/42817641/changing-value-of-const-by-pointer/42817844#42817844", "title": "Changing value of const by pointer", "body": "<p>As the original answer points out correctly:</p>\n\n<blockquote>\n  <p>It's \"undefined behaviour\", meaning that based on the standard you can't predict what will happen when you try this. It may do different things depending on the particular machine, compiler, and state of the program.</p>\n</blockquote>\n\n<p>Anything is fair game, including what you observe, which is probably just the result of a compiler optimization. You shouldn't spend to much time trying to interpret undefined behavior.</p>\n\n<p>Edit: To be more clear regarding the recommendation: <strong>DO NOT DO THAT</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489602764, "post_id": 42817851, "comment_id": 72747719, "body": "I am currently exploring effects of declaring it as volatile as well. Would be great if you can add you two cents to that thought"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "reply_to_user": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "edited": false, "score": 0, "creation_date": 1489605348, "post_id": 42817851, "comment_id": 72749303, "body": "@AdityaGulavani: The <code>const</code> specifier means you are telling the compiler that the value in the identifier will not change.  The <code>volatile</code> specifier means that the value of a variable my change by means outside of program execution (other threads, hardware registers, etc).   You can&#39;t have a <code>volatile</code> <code>const</code>, as it doesn&#39;t make sense."}, {"owner": {"reputation": 1260, "user_id": 3804799, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/938bb746e768e52b02aa3c2c1f7a672b?s=128&d=identicon&r=PG&f=1", "display_name": "icebp", "link": "https://stackoverflow.com/users/3804799/icebp"}, "edited": false, "score": 0, "creation_date": 1489605359, "post_id": 42817851, "comment_id": 72749309, "body": "Note that the constants may end up in a read only section inside your executable and even if you try to write at the address of a const variable (assuming there is one), the OS will kill your process with an access violation fault because you attempted to write a read only page."}, {"owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 1, "creation_date": 1489605671, "post_id": 42817851, "comment_id": 72749483, "body": "@ThomasMatthews The standard has no prohibition against declaring a <code>const volatile T</code>, but after combing through the document a bit I still couldn&#39;t tell you what such a construct is supposed to mean.  My best guess is that it means &quot;its value may change, but you can&#39;t change it&quot;."}, {"owner": {"reputation": 1260, "user_id": 3804799, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/938bb746e768e52b02aa3c2c1f7a672b?s=128&d=identicon&r=PG&f=1", "display_name": "icebp", "link": "https://stackoverflow.com/users/3804799/icebp"}, "edited": false, "score": 0, "creation_date": 1489605983, "post_id": 42817851, "comment_id": 72749639, "body": "As far as &quot;volatile const&quot; goes:     volatile const i = 0; volatile int *p = &amp;i; *p = 2; both MSVC 2015 and GCC 5 will warn you about it. Both will generate code that writes at i&#39;s address (with optimizations disabled). Oddly enough, i will be placed in a read write section inside the PE. But this means nothing, as with other versions / settings the generated executable would probably be a lot different. And it will work and change i&#39;s value."}], "tags": [], "owner": {"reputation": 19619, "user_id": 4151599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpkLj.jpg?s=128&g=1", "display_name": "Miles Budnek", "link": "https://stackoverflow.com/users/4151599/miles-budnek"}, "is_accepted": true, "score": 6, "last_activity_date": 1489602420, "creation_date": 1489602420, "answer_id": 42817851, "question_id": 42817641, "link": "https://stackoverflow.com/questions/42817641/changing-value-of-const-by-pointer/42817851#42817851", "title": "Changing value of const by pointer", "body": "<p>The behavior when changing the value of a variable declared <code>const</code> is undefined.  The compiler doesn't have to do anything that makes sense.</p>\n\n<p>In this case, the compiler doesn't bother to look into memory when printing the <code>const</code> value <code>i</code>, since it knows that value couldn't have possibly been altered by any conforming code.  When you print <code>i</code>, it generates this assembly:</p>\n\n<pre><code>mov     esi, 10\nmov     rdi, rax\ncall    std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;::operator&lt;&lt;(int)\n</code></pre>\n\n<p>Notice that it just hard-codes <code>10</code> in that call.</p>\n"}], "owner": {"reputation": 242, "user_id": 2095777, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4373a11d6c454a9845ec5028a03eb9df?s=128&d=identicon&r=PG", "display_name": "tabs_over_spaces", "link": "https://stackoverflow.com/users/2095777/tabs-over-spaces"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 42817851, "answer_count": 2, "score": 0, "last_activity_date": 1489602420, "creation_date": 1489601770, "last_edit_date": 1495542316, "question_id": 42817641, "link": "https://stackoverflow.com/questions/42817641/changing-value-of-const-by-pointer", "title": "Changing value of const by pointer", "body": "<p>This <a href=\"https://stackoverflow.com/a/31583505\">answer</a> at <a href=\"https://stackoverflow.com/questions/12104839/how-to-modify-value-of-const-variable\">this question</a> explains how changing a constant variable via dereferencing a pointer to it's address works (apparently by creating a new variable).</p>\n\n<pre><code>const int i = 10;\n*(int *)&amp;i = 5;\n\nstd::cout &lt;&lt; &amp;i &lt;&lt; \"\\t\" &lt;&lt; i &lt;&lt; \"\\n\";                   // 0x7fff6b325244   10\n\nstd::cout &lt;&lt; &amp;*(int *)&amp;i &lt;&lt; \"\\t\" &lt;&lt; *(int *)&amp;i &lt;&lt; \"\\n\"; // 0x7fff6b325244   5\n</code></pre>\n\n<p>With <code>&amp;*(int *)&amp;i</code> I was trying to get the address of the new variable that the previous answer was talking about. How do I find where this new variable is stored?</p>\n\n<p><code>*(int *)&amp;i</code> is showing a different value, so there has to be a new variable. </p>\n\n<p>Compiled on g++ 5.4.0, Ubuntu 16.04</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1489602045, "post_id": 42817462, "comment_id": 72747288, "body": "Use linked list instead of array. or recursive call (The display will be in reverse order.)"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1489602890, "post_id": 42817462, "comment_id": 72747794, "body": "Do not post images of code."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1489603013, "post_id": 42817462, "comment_id": 72747871, "body": "investigate the use of a stack"}, {"owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "edited": false, "score": 1, "creation_date": 1489613633, "post_id": 42817462, "comment_id": 72753941, "body": "This seems like a highly contrived problem. Why can&#39;t you use arrays?"}], "owner": {"reputation": 57, "user_id": 7716750, "user_type": "registered", "profile_image": "https://graph.facebook.com/1179830985440861/picture?type=large", "display_name": "RAZOR", "link": "https://stackoverflow.com/users/7716750/razor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489613660, "creation_date": 1489601218, "last_edit_date": 1489613660, "question_id": 42817462, "link": "https://stackoverflow.com/questions/42817462/program-to-take-a-set-of-n-numbers-and-display-them-after-removing-the-smallest", "title": "Program to take a set of n numbers and display them after removing the smallest number (without using arrays)?", "body": "<p>I have written code to find the smallest number from the set:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nmain() {\n    int i,n,sm,N;\n    printf(\"How many numbers? \\n\");\n    scanf(\"%d\", &amp;N);\n    printf(\"Enter the first number:\\n\");\n    scan(\"%d\", &amp;n);\n    sm=n;\n    for (i=i;i&lt;=(N-1);i++) {\n        printf(\"\\nEnter another number:\\n\");\n        scanf(\"%d\",&amp;n);\n        if (n&lt;sm) {\n         sm=n;\n        }\n    }\n    printf(\"\\nThe smallest number is %d\", sm);\n}\n</code></pre>\n\n<p>I am unable to think of a way to modify the code so that I can remove the smallest number AND display the remaining numbers in a single line.</p>\n"}, {"tags": ["c", "encryption", "vigenere"], "comments": [{"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1489601571, "post_id": 42817287, "comment_id": 72747005, "body": "That <code>i</code> is declared in the <code>for</code> loop&#39;s initialisation expression, so it&#39;s only valid inside the <code>for</code> loop... that&#39;s why you can&#39;t test it in the <code>do...while()</code> condition.  Just declare it before the <code>do...while()</code> instead of in the <code>for</code>&#39;s initialisation.  Also remember that after the <code>for</code>, <code>i</code> will be one larger than it was on the last pass through the <code>for</code> loop."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489601664, "post_id": 42817287, "comment_id": 72747054, "body": "The variable <code>i</code> is limited in scope to the <code>for</code> loop that defines it.  It is not accessible outside that loop.  If you want to access <code>i</code> in the <code>while</code> condition of the <code>do \u2026 while</code> loop, you&#39;ll need to define it outside the scope of the <code>do \u2026 while</code> loop (if you defined it inside, it would not be accessible in the condition; it would go out of existence at the <code>}</code> before the condition."}, {"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489602285, "post_id": 42817287, "comment_id": 72747418, "body": "I understand that is why it&#39;s happening but I can&#39;t find a way to fix it. Every time I re-declare i anywhere else in the script I get an over-shadowing error. Can you tell me exactly how to express word [i] again and where to do so to avoid the over-shadowing error in this script as I&#39;ve tried everything I can think of?  Also what is your opinion of my while line of script at the bottom. Is it otherwise suitable? Is there another way I can express this loop to iterate repeatedly over the key as long as there are letters left in word?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1489602765, "post_id": 42817287, "comment_id": 72747720, "body": "You need to change <code>for(int i=0</code> to <code>for(i=0</code> to avoid creating a second <code>i</code> variable, and declare <code>int i=0;</code> before the <code>do ... while</code> loop."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1489603039, "post_id": 42817287, "comment_id": 72747887, "body": "The iteration test in the <code>do ... while</code> loop looks a little strange. Do you <i>really</i> want to compare the character value at <code>word[i]</code> to the length of the <code>word</code> string?"}, {"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489608185, "post_id": 42817287, "comment_id": 72750949, "body": "Ian thanks for fixing the i issue. The do while loop is probably an issue. The code now compiles but I&#39;m getting the error of \\ expected output, not standard error of &quot;/opt/sandbox50/bin/run.sh: line 31: 102...&quot;    In the while loop I was trying to iterate over the key repeatedly until the whole word was enciphered. This would be necessary in the case of shorter key words where the plaintext word to be enciphered was longer. How would you express that while loop?"}, {"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489617433, "post_id": 42817287, "comment_id": 72755640, "body": "I think I might have an endless loop which is causing the sandbox error. Line 31 is above the first &#39;for&#39; loop for some reason."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489801856, "post_id": 42823167, "comment_id": 72845147, "body": "Your code passed all check50 checks except this one:                                                  :( encrypts &quot;world, say hello!&quot; as &quot;xoqmd, rby gflkp!&quot; using &quot;baz&quot; as keyword    \\ expected output, but not &quot;ciphertext:xoqmd, szz gflkp!\\n&quot;.                               It didn&#39;t encipher just the word &#39;say&#39; properly, which is weird. This was the only check which contained a space (before the word &#39;say&#39;). The spaces have to be directly copied. Perhaps that&#39;s why."}, {"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489834402, "post_id": 42823167, "comment_id": 72851443, "body": "That one passed all of the check50 checks as expected. I will study it, though I don&#39;t understand it, then start my code again. Yours seems very different to what I was trying to do. Thanks for your assistance. I  gather it&#39;s a bit counter-productive that we are not taught to just use the libraries we would find in the real world."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489885520, "post_id": 42823167, "comment_id": 72866674, "body": "I&#39;ve given you 3 versions. Start with the 1st one [closest to your original]. Look at the differences to your own. Then, the 2nd and 3rd. Each one improves the algorithm and the modularity/simplicity [this was deliberate as a teaching tool]. Ask yourself: What is different, why did he do <i>that</i>? Your original had 3 loops and mine had one. Think: why? Then, why was <code>baseof</code> created (Hint: because, otherwise there would be replicated code). For something as simple as this, there aren&#39;t too many alternate ways to do this that don&#39;t add needless complexity or code replication"}, {"owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489937260, "post_id": 42823167, "comment_id": 72878661, "body": "Thanks. I will take your advice. I&#39;ve only been coding in C for a few weeks so I&#39;ve got a long way to go. ;-}"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "edited": false, "score": 0, "creation_date": 1489947318, "post_id": 42823167, "comment_id": 72882114, "body": "I sensed that based on your code, which is why I took the time to incrementally clean up the programming style--to help you learn. I&#39;ve been doing C for 35+ yrs [you should have seen my code then ;-)]. Not to worry. When learning a new lang, it is normal to absorb material but not quite really understand it [and feel like you&#39;re hanging by a thread]. The &quot;Aha!&quot; moment usually takes a few [more] months--and, suddenly, it all floods in and everything you&#39;ve been studying becomes all so clear. So, just persevere and be patient with yourself."}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 1, "last_activity_date": 1489809557, "last_edit_date": 1489809557, "creation_date": 1489623718, "answer_id": 42823167, "question_id": 42817287, "link": "https://stackoverflow.com/questions/42817287/how-do-i-repeat-a-for-loop-using-a-do-while-loop/42823167#42823167", "title": "How do I repeat a &#39;for&#39; loop using a &#39;do while&#39; loop", "body": "<p>I think you have too many loops [levels].</p>\n\n<p>If the key length runs out before the word is finished, you restart encrypting the word from the <em>beginning</em> of the word (i.e. a bug).</p>\n\n<p>The main thrust is to loop through all word chars. A <em>single</em> loop that increments <code>i</code> works, <em>providing</em> it also increments <code>l</code> [modulo key length].</p>\n\n<p>Here's a cleaned up version [please pardon the gratuitous style cleanup]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n// NOTE: I don't have GetString on my system\nchar *FakeGetString(void);\n\nint\nmain(int argc, char *argv[])\n{\n\n    // key\n    // prompts if no key is entered\n    if (argc &lt; 2) {\n        printf(\"Please enter your word key\");\n        return 1;\n    }\n\n    char *key = (argv[1]);\n    int klen = strlen(key);\n\n    if (argc &gt;= 2) {\n        printf(\"plaintext:\");\n\n#if 0\n        char *word = GetString();\n#else\n        char *word = FakeGetString();\n#endif\n\n        int wlen = strlen(word);\n\n        printf(\"ciphertext:\");\n\n        // current key index\n        int l = 0;\n\n        // starts loop to repeat following for loop\n        // iterates through word entered by user as plaintext\n        // advance to next key char [with wrap to beginning if we're short]\n        for (int i = 0;  i &lt; wlen; ++i, l = (l + 1) % klen) {\n            int num = key[l];\n            int cipher;\n\n            // if original characters are uppercase\n            if (isupper(word[i])) {\n                cipher = (word[i] + num - 65) % 26 + 65;\n            }\n\n            // if original characters are lowercase\n            else if (islower(word[i])) {\n                cipher = (word[i] + num - 97) % 26 + 97;\n            }\n\n            // all other types of characters\n            else {\n                cipher = word[i];\n            }\n\n            printf(\"%c\", cipher);\n        }\n\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n\n// NOTE: I don't have GetString on my system\nchar *\nFakeGetString(void)\n{\n    static char buf[1000];\n    char *cp;\n\n    fgets(buf,sizeof(buf),stdin);\n    cp = strchr(buf,'\\n');\n    if (cp != NULL)\n        *cp = 0;\n\n    return buf;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>The above code I wrote was pretty close but wasn't Vigenere because your original equation was off. The key value has to be an offset/row number, so it needs to have <code>'A'</code> subtracted from it (i.e. keywords can only be uppercase).</p>\n\n<p>So, here is the corrected version [with some additional cleanups]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n// NOTE: I don't have GetString on my system\nchar *FakeGetString(void);\n\nint\nbaseof(int chr)\n{\n    int base;\n\n    // if original character is uppercase\n    if (isupper(chr)) {\n        base = 'A';\n    }\n\n    // if original character is lowercase\n    else if (islower(chr)) {\n        base = 'a';\n    }\n\n    // anything else\n    else\n        base = 0;\n\n    return base;\n}\n\nint\nmain(int argc, char *argv[])\n{\n    int kval;\n    int base;\n    int i;\n\n    // key\n    // prompts if no key is entered\n    if (argc &lt; 2) {\n        printf(\"Please enter your word key\\n\");\n        return 1;\n    }\n\n    char *key = argv[1];\n    int klen = strlen(key);\n\n    // key must be uppercase and we only want row numbers\n    for (i = 0;  i &lt; klen;  ++i) {\n        kval = key[i];\n        base = baseof(kval);\n\n        if (base) {\n            key[i] = kval - base;\n            continue;\n        }\n\n        printf(\"Key value must be only A-Z\\n\");\n        return 1;\n    }\n\n    if (argc &gt;= 2) {\n        printf(\"plaintext:\");\n\n#if 0\n        char *word = GetString();\n#else\n        char *word = FakeGetString();\n#endif\n        int wlen = strlen(word);\n\n        printf(\"ciphertext:\");\n\n        // starts loop to repeat following for loop\n        // iterates through word entered by user as plaintext\n        // advance to next key char [with wrap to beginning if we're short]\n        for (i = 0;  i &lt; wlen;  ++i) {\n            int wval = word[i];\n            int cipher;\n\n            base = baseof(wval);\n\n            // uppercase or lowercase\n            if (base) {\n                kval = key[i % klen];\n                cipher = ((wval - base) + kval) % 26 + base;\n            }\n\n            // all other types of characters\n            else {\n                cipher = wval;\n            }\n\n            printf(\"%c\",cipher);\n        }\n\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n\n// NOTE: I don't have GetString on my system\nchar *\nFakeGetString(void)\n{\n    static char buf[1000];\n    char *cp;\n\n    fgets(buf,sizeof(buf),stdin);\n    cp = strchr(buf,'\\n');\n    if (cp != NULL)\n        *cp = 0;\n\n    return buf;\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE #2:</strong></p>\n\n<blockquote>\n  <p>Your code passed all check50 checks except this one: :( encrypts \"world, say hello!\" as \"xoqmd, rby gflkp!\" using \"baz\" as keyword \\ expected output, but not \"ciphertext:xoqmd, szz gflkp!\\n\". It didn't encipher just the word 'say' properly, which is weird.</p>\n</blockquote>\n\n<p>I tested it using the test data/example from the Wikipedia page on Vigenere, but it only had one ready test example [<em>without</em> spaces or punctuation].</p>\n\n<blockquote>\n  <p>This was the only check which contained a space (before the word 'say'). The spaces have to be directly copied. Perhaps that's why.</p>\n</blockquote>\n\n<p>The spaces <em>were</em> directly copied, so that was okay. But ...</p>\n\n<p>The correct way is that when a non-alpha char is copied, the key index must <em>not</em> be incremented.</p>\n\n<p>My version used <code>i</code> to index the phrase and <code>i % klen</code> to index the key, so the key index would <em>always</em> be incremented [effectively]. That is the bug.</p>\n\n<p>Ironically, I had wondered about this, but didn't have the expanded test data at the time.</p>\n\n<p>So, the solution is to separate the index variables [again :-)].</p>\n\n<p>Here's the corrected version. When I was fixing it I renamed the <code>i</code> variable to something more descriptive (e.g. <code>widx</code>) and (re)created the index variable for the key (e.g. <code>kidx</code>).</p>\n\n<p>Notice that, now, <code>kidx</code> is <em>only</em> incremented when actually encrypting a character. The \"pass through\" case does <em>not</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n// NOTE: I don't have GetString on my system\nchar *FakeGetString(void);\n\nint\nbaseof(int chr)\n{\n    int base;\n\n    // if original character is uppercase\n    if (isupper(chr)) {\n        base = 'A';\n    }\n\n    // if original character is lowercase\n    else if (islower(chr)) {\n        base = 'a';\n    }\n\n    // anything else\n    else\n        base = 0;\n\n    return base;\n}\n\nint\nmain(int argc, char *argv[])\n{\n    int kval;\n    int base;\n    int widx;\n    int kidx;\n\n    // key\n    // prompts if no key is entered\n    if (argc &lt; 2) {\n        printf(\"Please enter your word key\\n\");\n        return 1;\n    }\n\n    char *key = argv[1];\n    int klen = strlen(key);\n\n    // key must be uppercase and we only want row numbers\n    for (kidx = 0;  kidx &lt; klen;  ++kidx) {\n        kval = key[kidx];\n        base = baseof(kval);\n\n        if (base) {\n            key[kidx] = kval - base;\n            continue;\n        }\n\n        printf(\"Key value must be only A-Z\\n\");\n        return 1;\n    }\n\n    if (argc &lt; 2)\n        return 1;\n\n    printf(\"plaintext:\");\n\n#if 0\n    char *word = GetString();\n#else\n    char *word = FakeGetString();\n#endif\n    int wlen = strlen(word);\n\n    printf(\"ciphertext:\");\n\n    kidx = 0;\n\n    // starts loop to repeat following for loop\n    // iterates through word entered by user as plaintext\n    // advance to next key char [with wrap to beginning if we're short]\n    for (widx = 0;  widx &lt; wlen;  ++widx) {\n        int wval = word[widx];\n        int cipher;\n\n        base = baseof(wval);\n\n        // uppercase or lowercase\n        if (base) {\n            kval = key[kidx];\n            cipher = ((wval - base) + kval) % 26 + base;\n            kidx = (kidx + 1) % klen;\n        }\n\n        // all other types of characters\n        else {\n            cipher = wval;\n        }\n\n        printf(\"%c\",cipher);\n    }\n\n    printf(\"\\n\");\n\n    return 0;\n}\n\n// NOTE: I don't have GetString on my system\nchar *\nFakeGetString(void)\n{\n    static char buf[1000];\n    char *cp;\n\n    fgets(buf,sizeof(buf),stdin);\n    cp = strchr(buf,'\\n');\n    if (cp != NULL)\n        *cp = 0;\n\n    return buf;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7716458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pm6FX.jpg?s=128&g=1", "display_name": "Android", "link": "https://stackoverflow.com/users/7716458/android"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 42823167, "answer_count": 1, "score": -1, "last_activity_date": 1489809557, "creation_date": 1489600652, "last_edit_date": 1489601985, "question_id": 42817287, "link": "https://stackoverflow.com/questions/42817287/how-do-i-repeat-a-for-loop-using-a-do-while-loop", "title": "How do I repeat a &#39;for&#39; loop using a &#39;do while&#39; loop", "body": "<p>This is my Vigenere Cipher code. I'm trying to use the do while loop to repeat the iteration over the key entered by the user. The key is applied to the plaintext word entered by the user, one letter at a time. I need to be able to iterate over the key until the end of the plaintext word, in case the key is shorter than the word. I've tried to add the repeat using a do-while loop with the first for loop being the key iteration. </p>\n\n<p>The last line of the 'do while' loop is throwing the error of undeclared identifier i. This is the only error I'm getting. The inside 'for' loop is from the Caesar Cipher and passed all checks. I think my do while loop is wrong. If I add a definition of char* word[i] or word[i] I get an overshadowing error regardless of where I put it. I would like to use this code rather than completely change it so I understand if it's possible to do it this way. Any suggestions, however, would be welcome.  </p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n    if (argc&lt;2) //key\n    {\n        printf(\"Please enter your word key\"); //prompts if no key is entered\n        return 1;\n    }\n\n    char* key = (argv[1]);\n\n    if(argc&gt;=2)\n    {\n        printf(\"plaintext:\");\n        char* word = GetString();\n\n        printf(\"ciphertext:\");\n\n        do\n        {  //starts loop to repeat following for loop\n\n            for(int l=0; l&lt;strlen(key); l++) //iterate over letters in key\n            {\n                int num=l;\n                for(int i=0; i&lt;strlen(word); i++)  //iterates through word entered by user as plaintext\n                {\n                    if(isupper(word[i]))  //if original characters are uppercase\n                    {\n                        int cipher = (word[i] + num -65) % 26 + 65;\n                        printf(\"%c\", cipher);\n                    }\n                    else if(islower(word[i]))  //if original characters are lowercase\n                    {\n                        int cipher = (word[i] + num - 97) % 26 + 97;\n                        printf(\"%c\", (cipher));\n                    }\n                    else    //all other types of characters\n                    {\n                        printf(\"%c\", word[i]);\n                    }\n                }\n            }\n            printf(\"\\n\");\n        }while((word[i])&lt;strlen(word));  // loop to recommence iterating over letters in the key   (i throwing undeclared identifier error)\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "segmentation-fault"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1489599673, "post_id": 42816852, "comment_id": 72745927, "body": "Debug tip: insure <code>scanf(&quot;%d %lld %lld&quot;, &amp;temp, &amp;x, &amp;y)</code> succeeds --&gt; <code>if(scanf(&quot;%d %lld %lld&quot;, &amp;temp, &amp;x, &amp;y) != 3) break;</code>  AFAIK, <code>q</code> is too great."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489600175, "post_id": 42816852, "comment_id": 72746214, "body": "Unclear that <code>inx = (x ^ lastAns) % n;</code> results <i>always</i> in a non-negative answer.  <code>x ^ lastAns</code> may be negative leading to negative <code>inx</code>.    Suggest <code>assert(inx &gt;= 0); seqList[inx][0] += 1;</code>  Why use signed math when all is non-negative values? Array indexing should be <code>size_t</code> BTW."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489601085, "post_id": 42816852, "comment_id": 72746740, "body": "You don&#39;t even check if you really get a memory block. Use the debugger."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489601996, "post_id": 42816852, "comment_id": 72747253, "body": "True, no check after, <code>scanf(&quot;%d %d&quot;, &amp;n, &amp;q);, malloc(sizeof(LLT*) * n);,  seqList[i] = (LLT*) malloc(sizeof(LLT)); scanf(&quot;%d %lld %lld&quot;, &amp;temp, &amp;x, &amp;y)</code>  Although these are basic checks, good to do them before posting."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489602071, "post_id": 42816852, "comment_id": 72747303, "body": "Of course if <code>int</code> is 16-bit - code will not work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489602409, "post_id": 42816852, "comment_id": 72747501, "body": "I suspect <code>malloc(sizeof(LLT*) * n);</code> is return <code>NULL</code> for large <code>n</code> and codes fails to check."}, {"owner": {"reputation": 167, "user_id": 3105408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/6SxKW.jpg?s=128&g=1", "display_name": "Khaled Mohammad", "link": "https://stackoverflow.com/users/3105408/khaled-mohammad"}, "edited": false, "score": 0, "creation_date": 1490972148, "post_id": 42816852, "comment_id": 73364791, "body": "Thankyou for you comments, I have updated the code and posted please check it out and point out the mistake, it still didn&#39;t solve the entire problem but fixed alot of it."}], "owner": {"reputation": 167, "user_id": 3105408, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/6SxKW.jpg?s=128&g=1", "display_name": "Khaled Mohammad", "link": "https://stackoverflow.com/users/3105408/khaled-mohammad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490972102, "creation_date": 1489599274, "last_edit_date": 1490972102, "question_id": 42816852, "link": "https://stackoverflow.com/questions/42816852/why-is-dynamic-array-failing-with-larger-numbers", "title": "Why is dynamic array failing with larger numbers?", "body": "<p>So I was solving this practice code of Hackerrank:</p>\n\n<p><a href=\"https://www.hackerrank.com/challenges/dynamic-array\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/dynamic-array</a></p>\n\n<p>Where in short, I am supposed to implement a program that in short implements and manipulates a dynamic array.</p>\n\n<p>So I wrote this program: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\ntypedef long long int LLT;\nint main()\n{\n    int n = 0, q = 0, temp = 0,newSize = 1;\n    LLT x = 0, y = 0, lastAns = 0, inx = 0;\n    scanf(\"%d %d\", &amp;n, &amp;q);\n\n    // Allocating a multidimensional array.\n    LLT **seqList = (LLT**) malloc(sizeof(LLT*) * n);\n    for(int i = 0; i &lt; n; i++){\n        seqList[i] = (LLT*) malloc(sizeof(LLT));\n        seqList[i][0] = 1; // Setting the size of the array.\n    }\n\n    for(int i = 0; i &lt; q; i++){\n        scanf(\"%d %lld %lld\", &amp;temp, &amp;x, &amp;y);\n        inx = (x ^ lastAns) % n;\n        if(temp == 1){\n            seqList[inx][0] += 1;\n            newSize = seqList[inx][0];\n            LLT* buffer = (LLT*) realloc(seqList[inx], newSize * sizeof(LLT));\n            if (buffer == NULL){\n                free(seqList[inx]);\n                return NULL;\n            }\n            seqList[inx] = buffer;\n            seqList[inx][newSize - 1]  = y;\n\n       }\n        else{\n            lastAns = seqList[inx][(y % (seqList[inx][0])) + 1];\n            printf(\"%d\\n\", lastAns);\n        }\n    }\n}\n</code></pre>\n\n<p>This gives the correct answer for small test cases, for example:</p>\n\n<pre><code>INPUT: \n2 5\n1 0 5\n1 1 7\n1 0 3\n2 1 0\n2 1 1\n\nOUTPUT:\n7\n3\n</code></pre>\n\n<p>But with large input like this:</p>\n\n<p>INPUT: <a href=\"http://paste.ubuntu.com/24182668/\" rel=\"nofollow noreferrer\">http://paste.ubuntu.com/24182668/</a></p>\n\n<p>OUTPUT: <a href=\"http://paste.ubuntu.com/24182670/\" rel=\"nofollow noreferrer\">http://paste.ubuntu.com/24182670/</a></p>\n\n<p>It gives an error. A segmentation fault.\nSo I debugged it and found the error was occurring with this line 21:</p>\n\n<pre><code>seqList[inx][0] += 1;\n</code></pre>\n\n<p>After this input:</p>\n\n<pre><code>2 212195438 191367377\n</code></pre>\n\n<p>Why is it happening? What am I doing wrong?</p>\n\n<p><strong>UPDATE 1:</strong></p>\n\n<p><strong><em>Your comments were very helpful and I updated the code accordingly.</em></strong> </p>\n\n<p>Updated code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\ntypedef unsigned long long int LLT;\nint main()\n{\nLLT x = 0, y = 0, lastAns = 0, inx = 0, n = 0, q = 0, temp = 0, newSize = 1;\nscanf(\"%llu %llu\", &amp;n, &amp;q);\n\n// Allocating a multidimensional array.\nLLT **seqList = (LLT**) malloc(sizeof(LLT*) * n);\nif(seqList == NULL){\n    free(seqList);\n    printf(\"Couldn't allocate memory.\");\n    return 432;\n}\nfor(LLT i = 0; i &lt; n; i++){\n    seqList[i] = (LLT*) malloc(sizeof(LLT));\n    if(seqList[i] == NULL){\n        free(seqList[i]);\n        printf(\"Couldn't allocate memory.\");\n        return 432;\n    }\n    seqList[i][0] = 1; // Setting the size of the array.\n}\n\nfor(LLT i = 0; i &lt; q; i++){\n    scanf(\"%llu %llu %llu\", &amp;temp, &amp;x, &amp;y);\n    inx = (x ^ lastAns) % n;\n    if(temp == 1){\n        assert(inx &gt;= 0);\n        seqList[inx][0] += 1;\n        newSize = seqList[inx][0];\n        LLT* buffer = (LLT*) realloc(seqList[inx], newSize * sizeof(LLT));\n        if (buffer == NULL){\n            free(seqList[inx]);\n            printf(\"Couldn't allocate memory.\");\n            return 432;\n        }\n        seqList[inx] = buffer;\n        seqList[inx][newSize - 1]  = y;\n\n   }\n    else{\n        lastAns = seqList[inx][(y % (seqList[inx][0])) + 1];\n        printf(\"%llu\\n\", lastAns);\n    }\n}\n}\n</code></pre>\n\n<p>It doesn't break anymore but still gives wrong answer for the test cases I have used when I first posted the question. </p>\n\n<p>Test case:</p>\n\n<p>INPUT: <a href=\"http://paste.ubuntu.com/24182668/\" rel=\"nofollow noreferrer\">http://paste.ubuntu.com/24182668/</a></p>\n\n<p>EXPECTED OUTPUT: <a href=\"http://paste.ubuntu.com/24182670/\" rel=\"nofollow noreferrer\">http://paste.ubuntu.com/24182670/</a></p>\n\n<p>Please point out the mistake I am making.</p>\n\n<p>TIA. </p>\n"}, {"tags": ["c", "fork", "exec"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1489597404, "post_id": 42816223, "comment_id": 72744536, "body": "The child process exits when the program you run exits. Also, remember that <i>all</i> processes are started by a <code>fork</code> call, and <i>all</i> programs are &quot;executed&quot; using one of the <code>exec</code> functions. That includes your own program, whose process will exit when you return from the <code>main</code> function."}, {"owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "edited": false, "score": 0, "creation_date": 1489597863, "post_id": 42816223, "comment_id": 72744841, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/903864/how-to-exit-a-child-process-and-return-its-status-from-execvp\">How to exit a child process and return its status from execvp()?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489600988, "post_id": 42816439, "comment_id": 72746692, "body": "so, even if _exit(i) is not executed, wait will take care of that, right? it wouldn&#39;t even be necessary?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489601726, "post_id": 42816439, "comment_id": 72747091, "body": "<code>wait()</code> simply waits for the status change in its child processes. <code>_exit()</code> is necessary in case <code>execvp()</code> fails. Otherwise, both parent and child processes would continue which you wouldn&#39;t want. That&#39;s there&#39;s usually a call to exit() (or _exit/_Exit) after <code>exec*()</code> call. i.e. it&#39;d constitute a programming error."}, {"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602542, "post_id": 42816439, "comment_id": 72747576, "body": "so I have no way of force execvp exit?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489602573, "post_id": 42816439, "comment_id": 72747599, "body": "You said &quot;it doesn&#39;t even know the process it&#39;s replacing is a child process&quot;.  You could alternatively argue &quot;it always knows that the process it is replacing is a child process, but it doesn&#39;t care&quot;.  There&#39;s never a time (AFAIK, even at system startup) when a process switch via <code>execvp()</code> or friends is not a child process."}, {"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602649, "post_id": 42816439, "comment_id": 72747646, "body": "or is execvp exit success guaranteed by its return value?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602686, "post_id": 42816439, "comment_id": 72747668, "body": "@Ricardo: no (there&#39;s no way to force <code>execvp()</code> to exit).  If <code>execvp()</code> is successful, it does not return.  If it fails, it returns.  Your parent process could send a signal to its child, or something similar, but you&#39;re into IPC and there&#39;s nothing that the code after <code>execvp()</code> can do; it is not executed unless <code>execvp()</code> fails."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489604265, "post_id": 42816439, "comment_id": 72748619, "body": "@Ricardo &quot;is there any scenario where execvp executes correctly and the origin child process (the one that calls execvp) does not exit like in _exit(n) call&quot; -- if <code>execvp()</code> succeeds then the &quot;origin child process&quot; doesn&#39;t exist anymore - it&#39;s been replaced with a <i>new</i> process image. As long as that new program exits properly, there&#39;s no problem at all."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1489597983, "creation_date": 1489597983, "answer_id": 42816439, "question_id": 42816223, "link": "https://stackoverflow.com/questions/42816223/execvp-new-process-image-and-exit/42816439#42816439", "title": "execvp new process image and _exit", "body": "<blockquote>\n  <p>Does this mean that besides printf, _exit(i) is also not executed?</p>\n</blockquote>\n\n<p>Yes. Except if <code>execvp()</code> (and other exec family functions) failed, then it'll return and in that the <code>printf()</code> and <code>_exit()</code> statements will be executed.</p>\n\n<blockquote>\n  <p>If so, how can I kill child process? Does execvp new process image takes care of that?</p>\n</blockquote>\n\n<p><code>execvp()</code> doesn't kill child process - it doesn't even know the process it's replacing is a child process.</p>\n\n<p>In most practical cases, you don't want to \"kill\" child processes. You'd want to <em>wait</em> for the child process(es) to complete using <code>wait(2)</code> - which you already do. The child process(es) are independent just like your \"main\" process; they'll exit when their <code>main()</code> returns or by calling exit()/_exit etc or they terminate abnormally (e.g. getting killed by SIGTERM/SIGKILL signals).</p>\n"}, {"tags": [], "owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "is_accepted": false, "score": 0, "last_activity_date": 1489646426, "last_edit_date": 1489646426, "creation_date": 1489598317, "answer_id": 42816566, "question_id": 42816223, "link": "https://stackoverflow.com/questions/42816223/execvp-new-process-image-and-exit/42816566#42816566", "title": "execvp new process image and _exit", "body": "<p>Provided the <code>execvp</code> call succeeds, you are correct, neither the <code>printf</code> nor the <code>_exit</code> call will be executed. But a good practice would be to check if the <code>execvp</code> call succeeded, to troubleshoot if it doesn't.</p>\n\n<p>As said in a comment, the program will, hopefully, terminate by itself and be reaped by your <code>wait</code> calls properly.</p>\n\n<p>Killing the process will be necessary only if, for any reason, you want to abort it before it terminates. To do so, you will have to use the <code>kill</code> function, using the pid of the process as returned by <code>fork</code> and the signal you want to send it.</p>\n\n<p><strong>Answer to the EDIT</strong></p>\n\n<blockquote>\n  <p>Assuming I want to do a printf (or any other instruction) after execvp line, as shown in the code, is there any way?</p>\n</blockquote>\n\n<p>No, unless the <code>execvp</code> call fails. After (inside, in fact...) the <code>execvp</code>, the \"text\" of the new program will be executed, it's <code>main()</code> will run etc... The \"text\" of the parent program will be discarded (the <strong>replace</strong> part in your manpage quote).</p>\n\n<p><strong>Answer to the EDIT[2]</strong></p>\n\n<blockquote>\n  <p>is there any scenario where execvp executes correctly and the origin child process (the one that calls execvp) does not exit like in _exit(n) call</p>\n</blockquote>\n\n<p>I'm not sure I understood completely your new question.<br>\nThe program executed by <code>execvp</code> can exit in many ways, <code>exit()</code>, <code>_exit()</code>, by returning from <code>main()</code>, by being killed by a signal... But the <code>_exit</code> call, for example, will be in the \"text\" of the new program, not of the parent's one.<br>\nIt may stay alive \"forever\" too, in which case, you'll have to take some precautions to avoid being blocked inside a <code>wait</code> call in the parent. Most of the time, parents will wait for <code>SIGCHLD</code> signals to detect that a child must be <code>wait</code>-ed and maybe <code>kill()</code> them when they want it to terminate.</p>\n\n<p>As for this part of your question:</p>\n\n<blockquote>\n  <p>... producing results like in the above chunk.</p>\n</blockquote>\n\n<p>The key point is that your second snippet doesn't call <code>execvp</code>.</p>\n\n<p>After the fork() calls, the two processes (the parent and the child) continue to execute the same program, <strong>with the same state</strong>. So after forking, both will continue to execute the loop. So the parent process will try to fork <code>(10 - i)</code> children processes and the child process will do the same thing. So you'll end up with many more than 11 processes, like I imagine you really intended.</p>\n\n<p><strong>Note:</strong> Maybe using gdb to trace your program will help you understanding more precisely how things work. You'll have to use <code>set follow-fork-mode [child|parent]</code> before each <code>fork()</code> call. It's a little bit tedious but doable.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489600854, "post_id": 42816667, "comment_id": 72746621, "body": "when you say &quot;You don&#39;t need to do anything. The program now executing in the process will call exit when it wants to exit.&quot; does that mean that execvp will call its own exit and then child process will call _exit()? Assuming I want to do a printf after execvp line, as shown in the code, is there any way?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489601229, "post_id": 42816667, "comment_id": 72746807, "body": "Re &quot;<i>does that mean that execvp will call its own exit and then child process will call _exit()?</i>&quot;, No, <code>execvp</code> doesn&#39;t do any of that. It doesn&#39;t create a child. It doesn&#39;t call <code>_exit</code>. <code>execpv</code> simply changes what program is executed by the current process. /// Re &quot;<i>I want to do a printf after execvp line</i>&quot;, You can&#39;t. Your program is no longer running in that process. All your code and variables have been replaced with the new program&#39;s."}, {"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602513, "post_id": 42816667, "comment_id": 72747568, "body": "so I have no way of force execvp exit?"}, {"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602664, "post_id": 42816667, "comment_id": 72747654, "body": "or is execvp exit success guaranteed by its return value?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489602870, "post_id": 42816667, "comment_id": 72747777, "body": "Re &quot;<i>so I have no way of force execvp exit?</i>&quot;, No idea what you mean by this."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489603310, "post_id": 42816667, "comment_id": 72748058, "body": "Re &quot;<i>is execvp exit success guaranteed by its return value?</i>&quot;, No idea what you mean by &quot;execvp exit&quot;. If you&#39;re asking if <code>execvp</code>&#39;s success is guaranteed, then no, it&#39; snot. For example, the file to execute might not exist. On error, <code>execvp</code> will return, and <code>errno</code> will be set. (On success, your program ceases to run, so it doesn&#39;t see <code>execvp</code> returning, just like it wouldn&#39;t see <code>exit</code> returning.)"}, {"owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489603323, "post_id": 42816667, "comment_id": 72748066, "body": "in other words: is there any possible scenario where <code>execvp</code> executes correctly but child process (the one that executes execvp on the code above) does not properly exit()?"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489603483, "post_id": 42816667, "comment_id": 72748145, "body": "Yes. In addition to exiting successfully (<code>exit(0)</code>) and existing with an error (<code>exit(1)</code>), it could run forever, and it could be killed by a signal."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "edited": false, "score": 0, "creation_date": 1489603921, "post_id": 42816667, "comment_id": 72748395, "body": "When your program is no longer running, it can&#39;t &quot;go wild&quot;. <code>execvp(...); perror(&quot;exec&quot;); _exit(1);</code> is enough."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1489604169, "last_edit_date": 1489604169, "creation_date": 1489598703, "answer_id": 42816667, "question_id": 42816223, "link": "https://stackoverflow.com/questions/42816223/execvp-new-process-image-and-exit/42816667#42816667", "title": "execvp new process image and _exit", "body": "<blockquote>\n  <p><em>Does this mean that besides printf, _exit(i) is also not executed?</em></p>\n</blockquote>\n\n<p>Correct. <code>execvp</code> only returns when it fails.</p>\n\n<blockquote>\n  <p><em>If so, how can I kill child process? Does execvp new process image takes care of that?</em></p>\n</blockquote>\n\n<p>I think you're actually asking what you need to do to ensure the process will exit since you can't call <code>exit</code> yourself. </p>\n\n<p>You don't need to do anything. The program now executing in the process will call <code>exit</code> when it wants to exit.</p>\n\n<blockquote>\n  <p><em>If so, how can I kill child process?</em></p>\n</blockquote>\n\n<p>If you really are asking how to kill (prematurely terminate) the process, it's done by using <code>kill</code> to send a signal. The pid of the process to which to send the signal was returned by <code>fork</code>.</p>\n\n<blockquote>\n  <p><em>I want to do a printf (or any other instruction) after execvp line, as shown in the code, is there any way?</em></p>\n</blockquote>\n\n<p>No. Your program is no longer running in that process. All your code and variables have been replaced with the new program's. If you want that process to output something, it would have to be done by the program you executed.</p>\n\n<p>The parent can check if the child has successfully called <code>exec</code> by creating a pipe (before the fork) with the <code>FD_CLOEXEC</code> flag set.</p>\n\n<pre><code>int pipefd[2];\npid_t pid;\nint status;\n\nif (pipe2(pipefd, O_CLOEXEC) == -1) {\n   perror(\"Can't create pipe\");\n   exit(1);\n}\n\npid = fork();\nif (pid == -1) {\n   perror(\"Can't create pipe\");\n   exit(1);\n}\n\nif (!pid) {\n    char* child_argv[] = { argv[i], NULL };\n\n    close(pipefd[0]);\n\n    execvp(child_argv[0], child_argv);\n    write(pipefd[1], &amp;errno, sizeof(errno));\n    _exit(1);\n}\n\n{\n   char buf[sizeof(errno)];\n   ssize_t bytes_read;\n\n   close(pipefd[1]);\n\n   bytes_read = read(pipefd[0], buf, sizeof(buf));\n   if (bytes_read == -1) {\n      /* Ignoring read errors */\n   }\n   else if (bytes_read &gt; 0) {\n      /* An error occurred in the child */\n      if (bytes_read &gt;= sizeof(errno)) {\n         memmove(&amp;errno, buf, sizeof(errno));\n         perror(\"Can't exec\");\n      } else {\n         fprintf(stderr, \"Can't exec: Unknown error\\n\");\n      }\n\n      waitpid(pid, &amp;status, 0);\n      exit(1);\n   }\n}\n\n/* The child is now running the executed program */\nwaitpid(pid, &amp;status, 0);\nif      ( status &amp; 0x7F ) { fprintf(stderr, \"Child killed by signal %d\\n\", status &amp; 0x7F); }\nelse if ( status &gt;&gt; 8   ) { fprintf(stderr, \"Child exited with error %d\\n\", status &gt;&gt; 8); }\nelse                      { fprintf(stdout, \"Child completed successfully\\n\"); }\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7716485, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/8f6d788c5df8ec5ba97c095f8bf81592?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo", "link": "https://stackoverflow.com/users/7716485/ricardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489646426, "creation_date": 1489597303, "last_edit_date": 1489603639, "question_id": 42816223, "link": "https://stackoverflow.com/questions/42816223/execvp-new-process-image-and-exit", "title": "execvp new process image and _exit", "body": "<p>I have this code:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    for (int i = 1; i &lt; argc; i++) {\n        pid_t pid = fork();\n\n        if ( !pid ) {\n            char *aux[] = {argv[i], NULL};\n            execvp(aux[0], aux);\n            printf(\"\\nChild %d executed %s with exit code %d\\n\", getpid(), aux[0], i); \n            _exit(i);\n        }\n\n    }\n\n    for (int i = 1; i &lt; argc; i++) {\n        printf(\"Child dead\\n\");\n        wait(NULL);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>When running, I noticed <code>printf(...)</code> after execvp on child process never runs. I checked <code>man exec</code> where I found: </p>\n\n<blockquote>\n  <p>\"The  exec() family of functions replaces the current process image with a new process image.\"</p>\n</blockquote>\n\n<p>Does this mean that besides <code>printf</code>, <code>_exit(i)</code> is also not executed? If so, how can I kill child process? Does execvp new process image takes care of that?</p>\n\n<p>EDIT: Assuming I want to do a printf (or any other instruction) after execvp line, as shown in the code, is there any way?</p>\n\n<p>EDIT[2]: To make it more clear. If I have this chunk:</p>\n\n<pre><code>int main(void) {\n\n    for (int i = 0; i &lt; 10; i++) {\n        pid_t pid = fork();\n\n        if (!pid) {\n            printf(\"child %d\\n\", getpid());\n            //_exit(1);\n        }\n\n        else {\n            wait(NULL);\n            printf(\"parent here\\n\");\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Things go wild when <code>exit(1)</code> is commented. So, my doubt is: is there any scenario where <code>execvp</code> executes correctly and the origin child process (the one that calls execvp) does not exit like in <code>_exit(n)</code> call, producing results like in the above chunk.</strong> </p>\n"}, {"tags": ["c", "arrays", "struct", "segmentation-fault", "dynamic-allocation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489596812, "post_id": 42815946, "comment_id": 72744207, "body": "First please read <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>. Secondly, please read <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Do I cast the result of malloc?</a>. Thirdly, why do you allocate memory for <code>filename</code>? Lastly, <i>where</i> do you get the crash? On what line? Please mark it out with e.g. a comment. And if you don&#39;t know, then learn how to use a debugger to catch crashes in action."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1489596829, "post_id": 42815946, "comment_id": 72744220, "body": "There is no 3D array in your code. And being a 3-star C programmer is not a compliment. Using <code>***</code> is almost always a signal of bad code."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1489602047, "post_id": 42815946, "comment_id": 72747290, "body": "do an allocation of a real 3D with something as <code>mytype (*X)[a][b] = malloc(sizeof(mytype[n][a][b]));</code>."}, {"owner": {"reputation": 1, "user_id": 7490900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088240557952767/picture?type=large", "display_name": "Danio Quero", "link": "https://stackoverflow.com/users/7490900/danio-quero"}, "edited": false, "score": 0, "creation_date": 1489602755, "post_id": 42815946, "comment_id": 72747713, "body": "I read the two articles and understood the, I shall improve my code on that side easily.  Filename is allocated because of the needs of the function dq_Eloss_set_filename. It could be done better but is not related to the main error. I shall seek however a way to improve it. Coming to the error it happens after calling the function dq_Eloss_load_range_file.. if i print or use in any way the variables memrangeTAR[Aion][Zion][i].E or memrangeTAR[Aion][Zion][i].R"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7490900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088240557952767/picture?type=large", "display_name": "Danio Quero", "link": "https://stackoverflow.com/users/7490900/danio-quero"}, "is_accepted": false, "score": 0, "last_activity_date": 1489679504, "creation_date": 1489679504, "answer_id": 42838890, "question_id": 42815946, "link": "https://stackoverflow.com/questions/42815946/segmentation-fault-error-in-function-using-3d-dynamic-array/42838890#42838890", "title": "Segmentation fault error in function using 3D dynamic array", "body": "<p>I somehow managed to solve but not to understand WHY it's a solution.\nBy defining  a  </p>\n\n<p><code>RANGE *tmp;</code> </p>\n\n<p>variable, calling the usual function as  </p>\n\n<p><code>tmp = dq_Eloss_load_range_file ((double)Aion, (double)Zion, cor_sosau16.mass.Mtar,  cor_sosau16.charge.Ztar,  &amp;NTAR);</code>   </p>\n\n<p>and then assigning wanted pointer:  </p>\n\n<p><code>memrangeTAR[Aion][Zion] = tmp;</code></p>\n\n<p>I can use the content of the variables in any way now, like:</p>\n\n<pre><code>   for (i=0; i&lt;N; i++){\n        printf (\"\\n%lf  %lf\", memrangeTAR[Aion][Zion][i].E, \n                              memrangeTAR[Aion][Zion][i].R);\n   } \n</code></pre>\n\n<p>In this way no segmentation fault error is encountered, making me think that the problem was the way I was passing the pointer to the function, but still don't understand...</p>\n"}], "owner": {"reputation": 1, "user_id": 7490900, "user_type": "registered", "profile_image": "https://graph.facebook.com/1088240557952767/picture?type=large", "display_name": "Danio Quero", "link": "https://stackoverflow.com/users/7490900/danio-quero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489824102, "creation_date": 1489596527, "last_edit_date": 1489824102, "question_id": 42815946, "link": "https://stackoverflow.com/questions/42815946/segmentation-fault-error-in-function-using-3d-dynamic-array", "title": "Segmentation fault error in function using 3D dynamic array", "body": "<p>I'm working on a code which purpose is to manipulate a 1D array coming from a 3D array. Showing the code will explain everything:</p>\n\n<p>First of all, I'm working with array of structures:</p>\n\n<pre><code>typedef struct range_in_memory {\n      double E, R;\n} RANGE;\n</code></pre>\n\n<p>And I wrote this function that works like a charm when called in simple debug implementation:</p>\n\n<pre><code>    RANGE *dq_Eloss_load_range_file (double Aion, double Zion, double Atar, double Ztar, int *n){\n\n      char *filename;\n      char errormsg[80], dummy;\n      int N = 2;\n      int i = 0;\n      FILE *fp;\n      RANGE *memrange;\n\n      filename = (char*)malloc (50*sizeof (char));\n      dq_Eloss_set_filename (filename, Aion, Zion, Atar, Ztar);  \n      fp = dq_myfopen (filename, \"r\", errormsg);\n\n      while ( !feof (fp) ){\n        fscanf (fp, \"%c\", &amp;dummy);\n\n        if (dummy == '\\n') {\n          N++;\n\n        }\n      }\n\n      rewind (fp);\n\n      memrange = (RANGE*) calloc (N, sizeof (RANGE));\n\n      while ( !feof (fp) ){\n        fscanf (fp, \"%lf\\t%lf\\n\", &amp;memrange[i].E, &amp;memrange[i].R);\n        i++;\n      }\n      *n = N;\n\n    //   for (i=0; i&lt;N; i++){\n    //         printf (\"\\n%lf  %lf\", memrange[i].E, memrange[i].R);\n    //   }\n\n      fclose (fp);\n\n      return (memrange);\n}\n</code></pre>\n\n<p>The commented for cycle is crucial, so keep it in mind.\nNow, coming to my problem, I need to use a 3D array like:</p>\n\n<pre><code>RANGE ***memrangeTAR;\n</code></pre>\n\n<p>The function <code>*dq_Eloss_load_range_file</code> loads the content of a file int an array of RANGE type. I want to do this for several files, which are named according to two parameters <code>Aion</code> and <code>Zion</code>. In my mind it would have been something like:</p>\n\n<pre><code>(double) memrangeTAR [Aion][Zion][i].E\n(double) memrangeTAR [Aion][Zion][i].R\n</code></pre>\n\n<p>which would have been the values in the i-th line in the file related to Aion and Zion.</p>\n\n<p>This is the code:</p>\n\n<pre><code>void dq_load_range_files (RANGE ***memrangeTAR){\n  int NTAR;\n  double *ZMAX;\n  int Aion, Zion, AMAX = 250.;\n  int i;\n\n\n\n  printf (\"\\n   Allocating Memory for range data...\"); fflush (stdout);\n  ZMAX = (double*) malloc ((AMAX+1)*sizeof (double));\n  memrangeTAR   = (RANGE***) malloc ((AMAX+1)*sizeof (RANGE**));\n\n\n  for (Aion=1; Aion&lt;=AMAX; Aion++){\n    ZMAX[Aion] = ceil (dq_range_table_get_max_Zion (Aion)); \n    memrangeTAR  [Aion] = (RANGE**) malloc ((ZMAX[Aion]+1)*sizeof(RANGE*)); \n  }\n\n  printf (\"   ...ALLOCATED!                                  \\n\\n\");\n\n\n  printf (\"\\n   Loading range data...\\n\"); fflush (stdout);\n\n  for (Aion=1; Aion &lt;=AMAX; Aion++){\n\n        for (Zion=1; Zion&lt;=ZMAX[Aion]; Zion++){\n\n      memrangeTAR  [Aion][Zion] = dq_Eloss_load_range_file ((double)Aion, (double)Zion, cor_sosau16.mass.Mtar,  cor_sosau16.charge.Ztar,  &amp;NTAR); \n\n//   for (i=0; i&lt;N; i++){\n//         printf (\"\\n%lf  %lf\", memrangeTAR[Aion][Zion][i].E, memrangeTAR[Aion][Zion][i].R);\n//   }   \n\n    }\n  }\n\n}\n</code></pre>\n\n<p>It compiles (gcc on unix machine using gnu99 standard). It runs unless i try to access to the 3D array. If I de-comment the printing cycle in the first function, I can get what I want: it prints on terminal the content of the current file. If I de-comment the for cycle in the second function, it gives me segmentation fault.</p>\n\n<p>What am I doing wrong? </p>\n"}, {"tags": ["c", "assembly", "raspberry-pi", "arm", "inline-assembly"], "comments": [{"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489597473, "post_id": 42815812, "comment_id": 72744581, "body": "You are aware that .addr_file, .flags, and .gpiobase, where not previously located under the .data section in your other assembly example. The author was using indirect addressing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "reply_to_user": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489598091, "post_id": 42815812, "comment_id": 72744979, "body": "I&#39;m sorry im confused any chance you can explain what you mean? The code seems to work perfectly fine when its just assembly, but when i turn it into inline assembly problems occur."}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489598299, "post_id": 42815812, "comment_id": 72745106, "body": "MGordon0405 in your other post <a href=\"http://stackoverflow.com/questions/42702056/flash-raspberry-pi-led-using-arm-assembly\" title=\"flash raspberry pi led using arm assembly\">stackoverflow.com/questions/42702056/&hellip;</a>  &#39;.file:  .ascii &quot;/dev/mem\\000&quot;&#39; is under the .data section and the other items (e.g., .addr_file .word .file...) are under the .text section. Frankly, I don&#39;t do (or know) inline assembly; therefore, I&#39;m not sure how inline assembly is handling memory layout in your object file.  So, you may need to account for the location of  &#39;.file:  .ascii &quot;/dev/mem\\000&quot;&#39; and place it in .data section accordingly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "reply_to_user": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489598796, "post_id": 42815812, "comment_id": 72745374, "body": "I changed this around because for whatever reason &quot;.data&quot; would through up an unexplained error in my code and I can&#39;t find any reason for this and no one seemed to be able to explain it."}, {"owner": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489598876, "post_id": 42815812, "comment_id": 72745413, "body": "Humm... you mean within your inline assembly code vs. pure assembly code - right? What was the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "reply_to_user": {"reputation": 690, "user_id": 2438391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EMZ2X.jpg?s=128&g=1", "display_name": "InfinitelyManic", "link": "https://stackoverflow.com/users/2438391/infinitelymanic"}, "edited": false, "score": 0, "creation_date": 1489599050, "post_id": 42815812, "comment_id": 72745521, "body": "It works fine in pure assembly code, but when I use &#39;.data&#39; with inline assembly code it throws the error &quot;&quot;ERROR: .size expression for &#39;method name here&#39; does not evaluate to a constant&quot;"}], "owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489596147, "creation_date": 1489596147, "question_id": 42815812, "link": "https://stackoverflow.com/questions/42815812/inline-assembly-issue-reading-filename", "title": "Inline assembly issue reading filename", "body": "<p>Hi i've had an issue with inline C reading the file name properly. The code seems to get down to the final line and then just stops. I've tested by removing the filename after .ascii and then it will get by this line. So i'm guessing my issue is with <strong>\\\"/dev/mem\\000\\\"\\n\"</strong> .</p>\n\n<pre><code>asm(\n   \".addr_file: .word   .file\\n\"\n   \".flags:     .word   1576962\\n\"\n   \".gpiobase:  .word   0x3F200000\\n\\n\"\n   \".file:  .ascii \\\"/dev/mem\\\\000\\\"\\n\"\n);\n</code></pre>\n\n<p>The Actual filename i'm trying to add is '/dev/mem\\000', its been altered in code to avoid issues with C such as double quotes and '\\0' character but this may be the problem. Thanks for any help!</p>\n"}, {"tags": ["c", "gcc", "glibc", "libc"], "comments": [{"owner": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1489596610, "post_id": 42815762, "comment_id": 72744083, "body": "Weak symbols are supported for ELF targets, and also for a.out targets when using the GNU assembler and linker. Are all those things true (ELF, GNU assembler and linker)?"}, {"owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "reply_to_user": {"reputation": 38619, "user_id": 33252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0b55a5e4a7eff1bf29eae5bd314f0d?s=128&d=identicon&r=PG", "display_name": "Doug Currie", "link": "https://stackoverflow.com/users/33252/doug-currie"}, "edited": false, "score": 0, "creation_date": 1489596666, "post_id": 42815762, "comment_id": 72744120, "body": "@DougCurrie I&#39;m using MinGW, so GNU but not ELF."}], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489596707, "creation_date": 1489595975, "last_edit_date": 1495535394, "question_id": 42815762, "link": "https://stackoverflow.com/questions/42815762/attribute-weak-overriding-existing-function", "title": "__attribute__ ((weak)) overriding existing function", "body": "<p>I'm trying out some of the solutions to <a href=\"https://stackoverflow.com/q/42310814/6850771\">my question</a>.</p>\n\n<p>Say I'm running on a system that implements <code>itoa</code>. I have this code:</p>\n\n<pre><code>char *my_itoa (int a, char *b, int c)\n{\n    return itoa(a, b, c);\n}\n\nchar* __attribute__ ((weak)) itoa(int a, char* b, int c)\n{\n     strcpy(b, \"No itoa\");\n}\n</code></pre>\n\n<p>If I call <code>my_itoa(10, str, 10)</code> with the above code, <code>puts(str)</code> gives me \"No itoa\".</p>\n\n<p>However, if I simply write:</p>\n\n<pre><code>char *my_itoa (int a, char *b, int c)\n{\n    return itoa(a, b, c);\n}\n</code></pre>\n\n<p>and call <code>my_itoa(10, str, 10)</code>, <code>puts(str)</code> gives me \"10\".</p>\n\n<p>My understanding was that <code>__attribute__ ((weak))</code> would implement a function if it was not already implemented. Is that its true behavior? What's going on here?</p>\n"}, {"tags": ["c++", "c", "assembly", "dll", "inline"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1489594054, "post_id": 42814998, "comment_id": 72742294, "body": "Wouldn&#39;t MSDN be the correct addressee for this question? We are not the Microsoft support forum."}, {"owner": {"reputation": 51, "user_id": 6190073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/033654b398ed5094ca9b76e65401a9fa?s=128&d=identicon&r=PG&f=1", "display_name": "Joris Borza", "link": "https://stackoverflow.com/users/6190073/joris-borza"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489594264, "post_id": 42814998, "comment_id": 72742454, "body": "I have not experience with the MSDN forums and I do here. Secondly I don&#39;t know if this &#39;issue&#39; is related to MS or if it is not possible in general."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489594880, "post_id": 42814998, "comment_id": 72742862, "body": "Inline-assmbly is not part of the C language. So, of course it is MS-specific. Wrt you not knowing the MSDN-forum: non sequitur. That&#39;s not an argument."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6190073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/033654b398ed5094ca9b76e65401a9fa?s=128&d=identicon&r=PG&f=1", "display_name": "Joris Borza", "link": "https://stackoverflow.com/users/6190073/joris-borza"}, "edited": false, "score": 0, "creation_date": 1489594752, "post_id": 42815288, "comment_id": 72742780, "body": "Thanks for the answer!"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1489594843, "post_id": 42815288, "comment_id": 72742842, "body": "...because <code>size_t</code> is <code>unsigned</code>... ? ;)"}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "edited": false, "score": 0, "creation_date": 1489594845, "post_id": 42815288, "comment_id": 72742843, "body": "The assembler is distinct from the C/C++ compiler proper, but it ships with Visual Studio."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489594975, "post_id": 42815288, "comment_id": 72742924, "body": "Inline assembly is a compiler extension, thus not standardised at all. Just because two compilers support it does not mean youj can use the same construct/syntax for it on both implementations."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1489595018, "post_id": 42815288, "comment_id": 72742967, "body": "@LPs: exactly =)"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489595151, "post_id": 42815288, "comment_id": 72743080, "body": "@Olaf: of course, but my point here was essentially to clear up the potential misunderstanding that it&#39;s an intrinsic problem of those platforms - which of course doesn&#39;t make sense, it&#39;s just that MS chose not to implement this common extension. I&#39;ll try to make this clearer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489595281, "post_id": 42815288, "comment_id": 72743174, "body": "As I wrote, it is a matter of the implementation. Sorry, I thought was was obvious, as the question cites from the VisualStudio text. How would that be relevant for gcc? (retorical question)"}], "tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 2, "last_activity_date": 1489595479, "last_edit_date": 1489595479, "creation_date": 1489594634, "answer_id": 42815288, "question_id": 42814998, "link": "https://stackoverflow.com/questions/42814998/inline-assembly-on-x64-via-a-dll/42815288#42815288", "title": "Inline assembly on x64 via a DLL", "body": "<p>As specified by the MSDN, the <em>VC++ compiler</em> doesn't support inline assembly on those platforms. Of course it's not an intrinsic limitation of those platforms - it's just a feature not implemented in those versions of VC++, other compilers (e.g. gcc) support it just fine. Nothing so strange, it's not a standard feature (as in: a feature required by the C or C++ standard), it's just a common extension. </p>\n\n<p>Still, even with VC++ you don't need to go as far as making a dll - you can just assemble your asm file into an object module, and link it together with the other ones (generated e.g. by the C or C++ compiler) into a single executable. This is in fact the procedure they recommend to mix C/C++ and assembly - the Microsoft assembler itself is shipped along with VC++ as always. </p>\n"}], "owner": {"reputation": 51, "user_id": 6190073, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/033654b398ed5094ca9b76e65401a9fa?s=128&d=identicon&r=PG&f=1", "display_name": "Joris Borza", "link": "https://stackoverflow.com/users/6190073/joris-borza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 42815288, "answer_count": 1, "score": -1, "last_activity_date": 1489595479, "creation_date": 1489593926, "question_id": 42814998, "link": "https://stackoverflow.com/questions/42814998/inline-assembly-on-x64-via-a-dll", "title": "Inline assembly on x64 via a DLL", "body": "<p>Today I read on the <a href=\"https://msdn.microsoft.com/en-us/library/4ks26t93.aspx\" rel=\"nofollow noreferrer\">MSDN</a> website, that inline assembly is not supported on ARM and x64 processors. Since I'm not good at C, C++ or ASM, I couldn't test it out myself, but it sparked my interest. </p>\n\n<p>I wondered if it is not possible to do this in Visual Studio, since its on the MSDN website. </p>\n\n<p>Regardless of the answer to my first question, my second question remains: is it possible to compile a DLL with inline ASM, which is then called via a x64 C/C++ program to execute the inline ASM. \nIf so, why, and if not: why not.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "type-conversion"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1489593670, "post_id": 42814890, "comment_id": 72742023, "body": "<code>c&#47;c++</code> is UB.."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1489593711, "post_id": 42814890, "comment_id": 72742042, "body": "Try <code>(unsigned char)</code> instead! Is it the same result?"}, {"owner": {"reputation": 8847, "user_id": 3484570, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/r5BRZ.png?s=128&g=1", "display_name": "nwp", "link": "https://stackoverflow.com/users/3484570/nwp"}, "edited": false, "score": 2, "creation_date": 1489593713, "post_id": 42814890, "comment_id": 72742045, "body": "You compiler does the right thing according to the standard, but apparently not according to what you wanted. What did you want to happen instead?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489593805, "post_id": 42814890, "comment_id": 72742111, "body": "C and C++ are different languages. Which one do you use? How do you print? Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1489593892, "post_id": 42814890, "comment_id": 72742171, "body": "What behavior do you expect and why?"}, {"owner": {"reputation": 20035, "user_id": 2971, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3f6251940b41a2251e7a9f4b745a7f2?s=128&d=identicon&r=PG", "display_name": "Magnus Hoff", "link": "https://stackoverflow.com/users/2971/magnus-hoff"}, "edited": false, "score": 1, "creation_date": 1489593912, "post_id": 42814890, "comment_id": 72742192, "body": "It seems like <code>char</code> is signed, and the conversion to <code>unsigned int</code> is sign extended. If you convert to a signed <code>int</code> instead, you should see the same negative value for both the <code>int</code> and the <code>char</code>. You could use <code>unsigned char</code> instead, as Iharob suggested above."}, {"owner": {"reputation": 565, "user_id": 7705264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46450f795008d4ab8c078dfdf858afe?s=128&d=identicon&r=PG&f=1", "display_name": "em2er", "link": "https://stackoverflow.com/users/7705264/em2er"}, "edited": false, "score": 0, "creation_date": 1489593970, "post_id": 42814890, "comment_id": 72742228, "body": "char is signed, so (char)0xc3 gives -61, then -61 converted to unsigned which gives you what you see in the output. Negatives usually stores as <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">Two&#39;s complement</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 20035, "user_id": 2971, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f3f6251940b41a2251e7a9f4b745a7f2?s=128&d=identicon&r=PG", "display_name": "Magnus Hoff", "link": "https://stackoverflow.com/users/2971/magnus-hoff"}, "edited": false, "score": 0, "creation_date": 1489594146, "post_id": 42814890, "comment_id": 72742368, "body": "@MagnusHoff: The <b>cast</b> is not sign-extended, but the preceeding conversion to <code>int</code> is."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 565, "user_id": 7705264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46450f795008d4ab8c078dfdf858afe?s=128&d=identicon&r=PG&f=1", "display_name": "em2er", "link": "https://stackoverflow.com/users/7705264/em2er"}, "edited": false, "score": 1, "creation_date": 1489594187, "post_id": 42814890, "comment_id": 72742397, "body": "@em2er: If you mean &quot;<code>char</code> on your platform is signed&quot;, you are right. Otherwise you are wrong."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489594291, "post_id": 42814890, "comment_id": 72742476, "body": "Looks like C, I removed the C++ tag. And how do you know <code>unsigned char</code> has 8 bits?"}, {"owner": {"reputation": 565, "user_id": 7705264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46450f795008d4ab8c078dfdf858afe?s=128&d=identicon&r=PG&f=1", "display_name": "em2er", "link": "https://stackoverflow.com/users/7705264/em2er"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489594300, "post_id": 42814890, "comment_id": 72742482, "body": "@Olaf yes, you are completely right."}, {"owner": {"reputation": 87, "user_id": 3753794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83598d34bb118a9a7296ce601093e066?s=128&d=identicon&r=PG&f=1", "display_name": "Corrosif", "link": "https://stackoverflow.com/users/3753794/corrosif"}, "reply_to_user": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1489594409, "post_id": 42814890, "comment_id": 72742548, "body": "@slava I expected tho have &quot;blank&quot; bites filled with 0 and and not 1"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489594492, "post_id": 42814890, "comment_id": 72742606, "body": "@Corrosif What is the <i>value</i> of <code>(char)(0xc3)</code> on your platform?  Try <code>printf(&quot;%d\\n&quot;, (char)(0xc3));</code>"}], "answers": [{"tags": [], "owner": {"reputation": 50, "user_id": 7704061, "user_type": "registered", "profile_image": "https://graph.facebook.com/1749075055407466/picture?type=large", "display_name": "Riasat Mahbub", "link": "https://stackoverflow.com/users/7704061/riasat-mahbub"}, "is_accepted": false, "score": 0, "last_activity_date": 1489594067, "creation_date": 1489594067, "answer_id": 42815051, "question_id": 42814890, "link": "https://stackoverflow.com/questions/42814890/unexpected-behavior-on-casting-char-to-int/42815051#42815051", "title": "unexpected behavior on casting char to int", "body": "<p>Try </p>\n\n<pre><code>(unsigned char)(0xc3)\n(unsigned char)(0xc3)\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code> (char)(0x01)\n (char)(0xc3)\n</code></pre>\n\n<p>that should do the trick</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489597529, "post_id": 42815077, "comment_id": 72744616, "body": "Detail: Even if &quot;a <code>char</code> is 8 bits and 2&#39;s compliment representation&quot;, the conversion of 195 to an 8-bit signed <code>char</code> is <i>implementation-defined</i> behavior (or a signal is raised) .  The common, though not specified, ID behavior  results in <code>(char)(0xc3)</code> --&gt; <code>-61</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1489594131, "creation_date": 1489594131, "answer_id": 42815077, "question_id": 42814890, "link": "https://stackoverflow.com/questions/42814890/unexpected-behavior-on-casting-char-to-int/42815077#42815077", "title": "unexpected behavior on casting char to int", "body": "<p>In this case:</p>\n\n<pre><code>unsigned int test_3 = 0xc3;\n</code></pre>\n\n<p>The constant <code>0xc3</code> has type <code>int</code>.  It's value (195) is in the positive range of an <code>int</code>, so when it is converted to <code>unsigned int</code> via the assignment, it retains that value.</p>\n\n<p>As for this case:</p>\n\n<pre><code>unsigned int test_4 = (char)(0xc3);\n</code></pre>\n\n<p>The value is first cast to a <code>char</code>.  Assuming a <code>char</code> is 8 bits and 2's compliment representation is used for negative numbers, this representation falls into the negative range (-61).  So when it is converted to a larger type, the extra bits added are set to 1 to retain the same negative value.</p>\n"}], "owner": {"reputation": 87, "user_id": 3753794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83598d34bb118a9a7296ce601093e066?s=128&d=identicon&r=PG&f=1", "display_name": "Corrosif", "link": "https://stackoverflow.com/users/3753794/corrosif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 42815077, "answer_count": 2, "score": -3, "last_activity_date": 1489646303, "creation_date": 1489593650, "last_edit_date": 1489598762, "question_id": 42814890, "link": "https://stackoverflow.com/questions/42814890/unexpected-behavior-on-casting-char-to-int", "title": "unexpected behavior on casting char to int", "body": "<p>I'm struggling with an unexpected behavior on casting a <code>char</code> to an <code>unsigned int</code>. Sometimes the remaining bits are filled with 0 and other times with 1.</p>\n\n<p>On a simple program tested on gcc 4.9.2</p>\n\n<pre><code>unsigned int test_1 = 0x01;\nunsigned int test_2 = (char)(0x01);\nunsigned int test_3 = 0xc3;\nunsigned int test_4 = (char)(0xc3);\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>00000000 00000000 00000000 00000001 \n00000000 00000000 00000000 00000001 \n00000000 00000000 00000000 11000011 \n11111111 11111111 11111111 11000011\n</code></pre>\n\n<p>I expected to have \"blank\" bits filled with 0 and and not 1.</p>\n\n<p>Expected output :</p>\n\n<pre><code>00000000 00000000 00000000 00000001 \n00000000 00000000 00000000 00000001 \n00000000 00000000 00000000 11000011 \n00000000 00000000 00000000 11000011\n</code></pre>\n\n<hr>\n\n<p>Full code below :</p>\n\n<pre><code>#include \"stdio.h\"\n\n#define binary_p( x ) printBits(sizeof(x),&amp;x)\n\nvoid printBits(size_t const size, void const * const ptr)\n{\n    unsigned char *b = (unsigned char*) ptr;\n    unsigned char byte;\n    int i, j;\n\n    for (i=size-1;i&gt;=0;i--)\n    {\n        for (j=7;j&gt;=0;j--)\n        {\n            byte = (b[i] &gt;&gt; j) &amp; 1;\n            printf(\"%u\", byte);\n        }\n\n            printf(\" \");\n    }\n     puts(\"\");\n}\n\nint main(int argc, char *argv[])\n{\n    unsigned int test_1 = 0x01;\n    unsigned int test_2 = (char) (0x01);\n    unsigned int test_3 = 0xc3;\n    unsigned int test_4 = (char) (0xc3);\n\n    binary_p(test_1);\n    binary_p(test_2);\n    binary_p(test_3);\n    binary_p(test_4);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "opencl"], "comments": [{"owner": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1489618605, "post_id": 42814670, "comment_id": 72756148, "body": "do you mean <code>get_color_obj</code> in your example or host-side function?"}, {"owner": {"reputation": 1, "user_id": 7716099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b160ef5f513e793592ac524af595995?s=128&d=identicon&r=PG&f=1", "display_name": "valentin rousseau", "link": "https://stackoverflow.com/users/7716099/valentin-rousseau"}, "reply_to_user": {"reputation": 9427, "user_id": 1470092, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0eeda48676f683d04c1431b2542954af?s=128&d=identicon&r=PG", "display_name": "huseyin tugrul buyukisik", "link": "https://stackoverflow.com/users/1470092/huseyin-tugrul-buyukisik"}, "edited": false, "score": 0, "creation_date": 1489740151, "post_id": 42814670, "comment_id": 72812408, "body": "Yeah sorry this a host side function i&#39;ll correct it."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1489740489, "post_id": 42814670, "comment_id": 72812603, "body": "<a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/global.html\" rel=\"nofollow noreferrer\">As far as I understood it</a>, <code>__global</code> specifies the <i>address space</i>. The <i>type</i> of the variable is <code>t_obj *</code> (in <code>__global</code>). So I am a bit confused as to what kind of behaviour the OP is expecting. Showing the declaration of <code>host_side_funct()</code> would be helpful. An <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>, perhaps?"}], "owner": {"reputation": 1, "user_id": 7716099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b160ef5f513e793592ac524af595995?s=128&d=identicon&r=PG&f=1", "display_name": "valentin rousseau", "link": "https://stackoverflow.com/users/7716099/valentin-rousseau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489740183, "creation_date": 1489593066, "last_edit_date": 1489740183, "question_id": 42814670, "link": "https://stackoverflow.com/questions/42814670/passing-opencl-global-variable-to-c-code", "title": "Passing OpenCL __global variable to c code", "body": "<p>I'm having trouble with this sample of code from my OpenCL kernel : </p>\n\n<pre><code>__kernel void raytracer(int x_max, __global t_obj *begin_list, __global int *col)\n{\n    ...\n    col[id] = host_side_funct(begin_list, nearest_point, xy);\n}\n</code></pre>\n\n<p>I want to pass begin_list which is a __global variable to an other function in C.\nBut my c code can't get __global variable because it is waiting for a t_obj pointer, not a __global var pointing to it.\nHow should I use begin_list in order to be able to pass it in some c functions?</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 1, "creation_date": 1489592867, "post_id": 42814447, "comment_id": 72741333, "body": "There&#39;s a lot of code that is not for inserting an element into a binary tree."}, {"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "reply_to_user": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "edited": false, "score": 0, "creation_date": 1489593354, "post_id": 42814447, "comment_id": 72741766, "body": "yeah i just want to make it clear about the entire code."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "edited": false, "score": 0, "creation_date": 1489656444, "post_id": 42814984, "comment_id": 72769750, "body": "the tree is not getting traversed if i use root only as the global variable and iam not passing any value to insert method the tree is getting traversed only  for the first node."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "edited": false, "score": 0, "creation_date": 1489658193, "post_id": 42814984, "comment_id": 72771035, "body": "you are passing a value to insert - see this line: <code>case 1:insert(root);</code> - that&#39;s passing <code>root</code> by value. Maybe this explains the difference <a href=\"http://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value\" title=\"whats the difference between passing by reference vs passing by value\">stackoverflow.com/questions/373419/&hellip;</a>"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "edited": false, "score": 0, "creation_date": 1489658218, "post_id": 42814984, "comment_id": 72771056, "body": "Also, <code>root</code> doesn&#39;t need to be global - it&#39;d be better if it were declared locally in <code>main</code>"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 1, "last_activity_date": 1489593895, "creation_date": 1489593895, "answer_id": 42814984, "question_id": 42814447, "link": "https://stackoverflow.com/questions/42814447/inserting-element-in-binary-tree/42814984#42814984", "title": "Inserting element in binary tree", "body": "<p>You've defined <code>root</code> as a global variable, but your insert function also defines it's own local version of <code>root</code> which takes precedence. Because you're passing <code>root</code> in by value rather than reference, changing it's value has no effect. You have two options on how to fix this.</p>\n\n<ul>\n<li>Pass <code>root</code> by reference</li>\n</ul>\n\n<p>You change insert to be <code>void insert(struct node **root)</code> and then replace all instances of <code>root</code> in the function with <code>(*root)</code>. You'll also need to pass a pointer to root when you call it - <code>insert(&amp;root)</code> </p>\n\n<ul>\n<li>Return the new value of <code>root</code></li>\n</ul>\n\n<p>Change the return type to <code>struct node *</code> and make sure you <code>return root</code> at the end and at any point where you're already returning from the function. When you call it you'll assign the return value to <code>root</code> like <code>root=insert(root)</code></p>\n\n<p>Both are equally valid options.</p>\n"}], "owner": {"reputation": 73, "user_id": 6679492, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-_uh_SYij9Jw/AAAAAAAAAAI/AAAAAAAAAEk/zsTP5xivos4/photo.jpg?sz=128", "display_name": "reswanth ", "link": "https://stackoverflow.com/users/6679492/reswanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 42814984, "answer_count": 1, "score": 1, "last_activity_date": 1489593895, "creation_date": 1489592521, "last_edit_date": 1489592782, "question_id": 42814447, "link": "https://stackoverflow.com/questions/42814447/inserting-element-in-binary-tree", "title": "Inserting element in binary tree", "body": "<p>The code is for inserting an element in a binary tree using level order traversal. I'll first tell u how it works. It first goes through the nodes in each level and if there is any node which doesn't have both children it inserts the node as a child to that node and it use's queue for storing and retrieving the nodes addresses. My problem is that every time I call the create function the root value which is passed is always null even after inserting a node the root value is not changed and it's still a null. I am unable to figure out what's wrong in this. Can anyone help me out?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node\n{\n   int data;\n   struct node *left,*right;\n}*root;\n\nstruct queue\n{\n   int capacity,rear,front;\n   struct node **qu;\n};\n\n\nvoid enqueue(struct queue *q,struct node *n)\n{\n   q-&gt;front=(++(q-&gt;front))%q-&gt;capacity;\n   (q-&gt;qu)[q-&gt;front]=n;\n   if(q-&gt;rear==-1)\n   q-&gt;rear++;\n}\n\nstruct node* dequeue(struct queue *q)\n{\n   struct node *temp;\n   temp=q-&gt;qu[q-&gt;rear];\n   if(q-&gt;front==q-&gt;rear)\n   q-&gt;front=q-&gt;rear=-1;\n   else\n   q-&gt;rear=(++(q-&gt;rear))%q-&gt;capacity;\n}\n\nint isempty(struct queue *q)\n{\n   return(q-&gt;rear==-1);\n}\n\nstruct queue* create(unsigned int capacity)\n{\n   struct queue *p;\n   p=(struct queue*)malloc(sizeof(struct queue));\n   p-&gt;capacity=capacity;\n   p-&gt;front=p-&gt;rear=-1;\n   p-&gt;qu=(struct node**)malloc(sizeof(struct node)*capacity);\n   return p;\n}\n\n\n void insert(struct node *root)\n {\n    int n;\n    struct node *p,*q;\n    struct queue *tmp;\n    p=(struct node*)malloc(sizeof(struct node));\n    p-&gt;left=p-&gt;right=NULL;\n    scanf(\"%d\",&amp;n);\n    p-&gt;data=n;\n    if(root==NULL)\n    {\n      root=p;\n      return;\n    }\n    tmp=create(20);\n    enqueue(tmp,root);\n    while(isempty(tmp))\n    {\n      q=dequeue(tmp);\n      printf(\"%d %d\\n\",p,root);\n      if((!q-&gt;right)||(!q-&gt;left))\n      {\n          if(!q-&gt;right)\n          q-&gt;right=p;\n          else\n          q-&gt;left=p;\n          return;\n      }\n      else\n      {\n         enqueue(tmp,q-&gt;left);\n         enqueue(tmp,q-&gt;right);\n      }\n    }\n }\n\n void traverse(struct node *root)\n {\n   if(!root)\n   return;\n   traverse(root-&gt;left);\n   printf(\"%d \",root-&gt;data);\n   traverse(root-&gt;right);\n }\n\nvoid main()\n{\n   int i,n;\n   while(1)\n   {\n       printf(\"1.insert\\n2.exit\\n\");\n       scanf(\"%d\",&amp;n);\n       switch(n)\n       {\n          case 2:goto end;\n          case 1:insert(root);\n       }\n    }\n    end:\n    traverse(root);\n }\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "bash", "erlang", "stty"], "comments": [{"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 1, "creation_date": 1489592547, "post_id": 42814199, "comment_id": 72741065, "body": "<code>system(&quot;stty size&quot;)</code> doesn&#39;t return the size; it executes the command and returns the exit code of the command."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489593451, "post_id": 42814199, "comment_id": 72741841, "body": "Tell me how casting a pointer to a <code>char</code> value is going to solve the problem at hand."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489596313, "post_id": 42814199, "comment_id": 72743914, "body": "Why are you using <code>stty</code> for this? You can get the information directly with a function call."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1489596356, "post_id": 42814199, "comment_id": 72743941, "body": "To get the output that a command prints, use <code>popen()</code>, not <code>system()</code>."}, {"owner": {"reputation": 8908, "user_id": 172232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5a3de2b746da71aadd6b33ddbcbccd52?s=128&d=identicon&r=PG", "display_name": "quantumpotato", "link": "https://stackoverflow.com/users/172232/quantumpotato"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489600660, "post_id": 42814199, "comment_id": 72746520, "body": "@SouravGhosh I am trying to pass an argument to my erlang program as a string., I am using stty because I want to continuously let the user press keys without pressing return"}], "owner": {"reputation": 8908, "user_id": 172232, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5a3de2b746da71aadd6b33ddbcbccd52?s=128&d=identicon&r=PG", "display_name": "quantumpotato", "link": "https://stackoverflow.com/users/172232/quantumpotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489591932, "creation_date": 1489591932, "question_id": 42814199, "link": "https://stackoverflow.com/questions/42814199/passing-stty-size-results-to-erlang-program-through-c", "title": "Passing stty size results to Erlang program through C", "body": "<p>character.c:14:70: warning: cast to 'char <em>' from smaller integer type 'int'\n      [-Wint-to-pointer-cast]\n    sprintf(command, \"erl -noshell -s program main %s -s init stop\", (char</em>)out);</p>\n\n<p>when I try without the pointer</p>\n\n<pre><code>character.c:14:70: warning: format specifies type 'char *' but the argument has type\n      'char' [-Wformat]\n    sprintf(command, \"erl -noshell -s program main %s -s init stop\", (char)out);\n                                                   ~~                ^~~~~~~~~\n                                                   %c\n</code></pre>\n\n<p>I want to get the size of the terminal window through <code>stty size</code> and pass to my Erlang program so it can display text properly.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(void){\n  system (\"clear\");\n  int c;\n  /* use system call to make terminal send all keystrokes directly to stdin */\n  system (\"/bin/stty raw\");\n  int *out;\n  while((c=getchar())!= '.') {\n    char command[100];\n    char output[100];\n    int out = system(\"stty size\");\n    sprintf(command, \"erl -noshell -s program main %s -s init stop\", (char)out);\n  }\n  system (\"/bin/stty cooked\");\n  system (\"clear\");\n  system (\"echo ok\\n\");\n\n  // return out;\n  return 0;\n}\n</code></pre>\n\n<p>How do I do this?</p>\n"}, {"tags": ["c", "task", "openmp"], "comments": [{"owner": {"reputation": 877, "user_id": 3666903, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1i0Z6.jpg?s=128&g=1", "display_name": "bl4ckb0ne", "link": "https://stackoverflow.com/users/3666903/bl4ckb0ne"}, "edited": false, "score": 0, "creation_date": 1489591804, "post_id": 42814043, "comment_id": 72740467, "body": "OpenMP creates a worker every time you call it. Beside doing the for loop, I don&#180;t think you can spawn a custom thread with it. Maybe try to launch a std::thread to do what you want"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 877, "user_id": 3666903, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1i0Z6.jpg?s=128&g=1", "display_name": "bl4ckb0ne", "link": "https://stackoverflow.com/users/3666903/bl4ckb0ne"}, "edited": false, "score": 2, "creation_date": 1489592694, "post_id": 42814043, "comment_id": 72741194, "body": "@Bl4ckb0ne this is highly inaccurate. Also you should not mix <code>std::thread</code> and OpenMP."}, {"owner": {"reputation": 877, "user_id": 3666903, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1i0Z6.jpg?s=128&g=1", "display_name": "bl4ckb0ne", "link": "https://stackoverflow.com/users/3666903/bl4ckb0ne"}, "reply_to_user": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1489601115, "post_id": 42814043, "comment_id": 72746755, "body": "@Zulan that&#180;s true, I never tought about that, but it makes sense. I think I misunderstood the question of OP"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "edited": false, "score": 0, "creation_date": 1489681990, "post_id": 42819337, "comment_id": 72788776, "body": "Just a clarification on the repercussions of what you describe. If I run the code on a 16 core machine, and use the <code>num_threads(2)</code> clause on the for loop does this not mean 8 concurrent tasks will run with 2 threads each? Or will it launch 16 tasks with 2 threads each hence the over-subscription?"}, {"owner": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "edited": false, "score": 0, "creation_date": 1489682492, "post_id": 42819337, "comment_id": 72789121, "body": "EDIT (new comment as 5 mins was exceeded): Ignore this I have just reread the discussion you posted. 16^2 threads will be available."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "edited": false, "score": 0, "creation_date": 1489682667, "post_id": 42819337, "comment_id": 72789249, "body": "16 * 2, you could of course limit the outer parallel region to 8 to avoid oversubscription, but then you might get load balance issues."}, {"owner": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "edited": false, "score": 0, "creation_date": 1489683908, "post_id": 42819337, "comment_id": 72790118, "body": "MSDN seems to think its to the power of the depth not a multiplication <a href=\"https://msdn.microsoft.com/en-us/library/sk3zt8e1.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/sk3zt8e1.aspx</a>"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "reply_to_user": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "edited": false, "score": 1, "creation_date": 1489684206, "post_id": 42819337, "comment_id": 72790310, "body": "@BenHazelwood It would be 16^2 if you didn&#39;t explicitly use <code>num_threads(2)</code>."}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 2, "last_activity_date": 1489607200, "creation_date": 1489607200, "answer_id": 42819337, "question_id": 42814043, "link": "https://stackoverflow.com/questions/42814043/multiple-threads-per-task-openmp/42819337#42819337", "title": "Multiple threads per task OpenMP", "body": "<p>Yes, you can do that with nested parallel regions, exactly with the syntax you describe. You need to specifically enable it via setting the environment variable <code>OMP_NESTED=True</code> or calling <code>omp_set_nested</code> and it needs to be supported by the implementation.</p>\n\n<p>That said, you have to be very careful in terms of performance. Normally OpenMP will uses 1 thread per core, which is very nice for scheduler and hardware. Nested parallel regions will cause oversubscription (more than one thread per core) thus can cause performance issues when threads are competing for cores. This is particularly true, because many tasks could potentially open up man parallel regions.</p>\n\n<p>Also take a look at <a href=\"https://stackoverflow.com/a/4320422/620382\">this discussion</a> about nested parallel regions on nested loops.</p>\n"}], "owner": {"reputation": 55, "user_id": 6359898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/069f8bd719b393f59c9d1ceb4818ded3?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Hazelwood", "link": "https://stackoverflow.com/users/6359898/ben-hazelwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 42819337, "answer_count": 1, "score": 0, "last_activity_date": 1489607200, "creation_date": 1489591575, "question_id": 42814043, "link": "https://stackoverflow.com/questions/42814043/multiple-threads-per-task-openmp", "title": "Multiple threads per task OpenMP", "body": "<p>Is it possible to assign more than one thread to a task in OpenMP (4.x)?</p>\n\n<p>General outline of the problem I am trying to solve:</p>\n\n<pre><code>#pragma omp task\n{\n    #pragma omp parallel for num_threads(2)\n    &lt;for loop&gt;\n}\n</code></pre>\n"}, {"tags": ["c", "bluetooth-lowenergy", "bluez", "gatt", "hci"], "answers": [{"comments": [{"owner": {"reputation": 1137, "user_id": 2788009, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/aee4f9a084fca57f7bbe7a7b5f3a682c?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Goldberg", "link": "https://stackoverflow.com/users/2788009/bill-goldberg"}, "edited": false, "score": 0, "creation_date": 1490237457, "post_id": 42937930, "comment_id": 73026588, "body": "Thanks alot @yousif saeed : Could you tell how can I get the argument gpointer user_data of &#39;characteristics&#39; function you mentioned above ?"}], "tags": [], "owner": {"reputation": 7991, "user_id": 2215147, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/aecaa95e6ca4a3563a255de206b5e987?s=128&d=identicon&r=PG&f=1", "display_name": "Youssif Saeed", "link": "https://stackoverflow.com/users/2215147/youssif-saeed"}, "is_accepted": false, "score": 3, "last_activity_date": 1490129588, "last_edit_date": 1495540493, "creation_date": 1490129588, "answer_id": 42937930, "question_id": 42813790, "link": "https://stackoverflow.com/questions/42813790/example-code-to-access-battery-service-from-ble-device-in-c-using-bluez/42937930#42937930", "title": "Example code to access battery service from ble device in C using bluez", "body": "<p>I don't have example code but I can point you to the source code similar to what you did. To read the battery service you'll need the following steps:-</p>\n\n<ol>\n<li>As you mentioned, <strong>scan</strong> and detect the address that you are looking for. This can also be found in <a href=\"https://github.com/aguedes/bluez/blob/master/tools/hcitool.c\" rel=\"nofollow noreferrer\">hcitool.c</a>, at:-</li>\n</ol>\n\n<blockquote>\n  <p>static void cmd_lescan(int dev_id, int argc, char **argv) {...}</p>\n</blockquote>\n\n<ol start=\"2\">\n<li>Once your device is found, <strong>connect</strong> to the device. The source for this can be found at <a href=\"https://github.com/aguedes/bluez/blob/master/tools/hcitool.c\" rel=\"nofollow noreferrer\">hcitool.c</a>, at:-</li>\n</ol>\n\n<blockquote>\n  <p>static void cmd_lecc(int dev_id, int argc, char **argv)\n  {...}</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>You need to then do a <strong>characteristic discovery</strong> to look for the characteristic handle since you know the UUID. If your device is using the adopted battery service, then the characteristic you are looking for is <a href=\"https://www.bluetooth.com/specifications/gatt/viewer?attributeXmlFile=org.bluetooth.characteristic.battery_level.xml\" rel=\"nofollow noreferrer\">2A19</a>. The code for the characteristic discovery can be found at <a href=\"https://github.com/aguedes/bluez/blob/master/attrib/gatttool.c\" rel=\"nofollow noreferrer\">gatttool.c</a>, at:-</li>\n</ol>\n\n<blockquote>\n  <p>static gboolean characteristics(gpointer user_data) {...}</p>\n</blockquote>\n\n<ol start=\"4\">\n<li>Knowing the handle, you then proceed to <strong>read the characteristic value</strong>. The code for this can be found in <a href=\"https://github.com/aguedes/bluez/blob/master/attrib/gatttool.c\" rel=\"nofollow noreferrer\">gatttool.c</a>, at:-</li>\n</ol>\n\n<blockquote>\n  <p>static void char_read_cb(guint8 status, const guint8 *pdu, guint16 plen, gpointer user_data) {...}</p>\n</blockquote>\n\n<p>Alternatively, you can just read the characteristic data using the characteristic UUID if you already know it. This can be found in <a href=\"https://github.com/aguedes/bluez/blob/master/attrib/gatttool.c\" rel=\"nofollow noreferrer\">gatttool.c</a>, at:-</p>\n\n<blockquote>\n  <p>static void char_read_by_uuid_cb(guint8 status, const guint8 *pdu,\n  guint16 plen, gpointer user_data)</p>\n</blockquote>\n\n<p>If you're new to BlueZ, I recommend starting from the <a href=\"https://stackoverflow.com/questions/17835469/using-bluetooth-low-energy-in-linux-command-line?noredirect=1&amp;lq=1\">BlueZ command line tools</a>. This would help you understand more about what is going on under the hood in the source. To achieve what you want through the command line tools you simply need:-</p>\n\n<pre><code>- hcitool lescan\n- gatttool -b 00:11:22:33:44:55 --characteristics \n- gatttool -b 00:11:22:33:44:55 --char-read --uuid=0x2A19\n</code></pre>\n\n<p>Where 00:11:22:33:44:55 should be replaced with the device address with the battery service.</p>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 2014, "user_id": 6267288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f86a7e2f0811a9e18031ed7c0af917a?s=128&d=identicon&r=PG&f=1", "display_name": "OlivierM", "link": "https://stackoverflow.com/users/6267288/olivierm"}, "is_accepted": false, "score": 0, "last_activity_date": 1551806788, "creation_date": 1551806788, "answer_id": 55008396, "question_id": 42813790, "link": "https://stackoverflow.com/questions/42813790/example-code-to-access-battery-service-from-ble-device-in-c-using-bluez/55008396#55008396", "title": "Example code to access battery service from ble device in C using bluez", "body": "<p>Most of the examples would suggest you to extract source code from Bluez to read GATT characteristics. <a href=\"https://github.com/labapart/gattlib\" rel=\"nofollow noreferrer\">gattlib</a> (C-library) does not require you to do so and is built on top of Bluez.</p>\n\n<p>The library has two examples you could use for reading battery level.</p>\n\n<p>You can use the <a href=\"https://github.com/labapart/gattlib/blob/master/examples/notification/notification.c\" rel=\"nofollow noreferrer\"><code>notification</code> example</a> that subscribe to battery level notification. Or you could use the <a href=\"https://github.com/labapart/gattlib/blob/master/examples/read_write/read_write.c\" rel=\"nofollow noreferrer\"><code>read_write</code> example</a> to read the battery level.</p>\n"}], "owner": {"reputation": 1137, "user_id": 2788009, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/aee4f9a084fca57f7bbe7a7b5f3a682c?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Goldberg", "link": "https://stackoverflow.com/users/2788009/bill-goldberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3255, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1551806788, "creation_date": 1489590961, "last_edit_date": 1490129797, "question_id": 42813790, "link": "https://stackoverflow.com/questions/42813790/example-code-to-access-battery-service-from-ble-device-in-c-using-bluez", "title": "Example code to access battery service from ble device in C using bluez", "body": "<p>I have a ble device which gives battery status as battery service.I need to read battery information from my ble device using C programming language from linux using bluez. I could not see a proper example anywhere for this purpose even though there are examples of classic bluetooth. I am able to detect my ble device using the example code <a href=\"https://github.com/carsonmcdonald/bluez-experiments/blob/master/experiments/scantest.c\" rel=\"nofollow noreferrer\">here</a>.\nHow can I connect to my device ( I have the device address after scanning ) ?\nHow can I request the battery service to my device ( I know the service handle for my battery service ) ?\nExpecting Example code.</p>\n"}, {"tags": ["c", "debugging", "gdb"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1489590701, "post_id": 42813605, "comment_id": 72739511, "body": "You need to re-compile your code with debugging information turned on (-g option in gcc for example) - then you&#39;ll be able to see where your code is crashing."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1489592385, "post_id": 42813605, "comment_id": 72740923, "body": "looks like an architecture mismatch to me (32 vs 64 bit), not a <code>gdb</code> problem. Are you trying to cross-compile? What happens if you run <code>.&#47;main_process</code> without <code>gdb</code>?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1489616209, "post_id": 42813605, "comment_id": 72755145, "body": "@yano yes I cross compiling for the arm target(32bit) in Linux host(64 bit)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1489619468, "post_id": 42813605, "comment_id": 72756480, "body": "from this printout it doesn&#39;t look like you&#39;re even using an x64 to ARM toolchain. i386 and i386x86_64 are both Intel/AMD architectures, not ARM. <a href=\"https://www.linaro.org/downloads/\" rel=\"nofollow noreferrer\">Linaro</a> makes x64 to ARM toolchains. If you already have one, doesn&#39;t look like you&#39;re pointed to it."}], "answers": [{"comments": [{"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1489734253, "post_id": 42848508, "comment_id": 72809560, "body": "@Employee Russian , it&#39;s my silly mistake, what I did is actually trying to debug the binaries which i cross compiled for arm. Later I find out that I am not using the binaries which I build for Linux host. Gdb failed because I was running incompatible executable. I haven&#39;t setup the gdb server in my target (arm) yet."}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": false, "score": 1, "last_activity_date": 1489720004, "creation_date": 1489720004, "answer_id": 42848508, "question_id": 42813605, "link": "https://stackoverflow.com/questions/42813605/gdb-failed-with-sigsev-dont-know-why/42848508#42848508", "title": "gdb failed with sigsev, don&#39;t know why?", "body": "<blockquote>\n  <p>Error message from gdb<br>\n  <code>(gdb) r\n  Starting program: /home/iir/bin/</code></p>\n</blockquote>\n\n<p>The error message says that you are trying to <em>execute</em> <code>/home/iir/bin/</code> which appears to be a directory. It is very unlikely that this is the actual result you observed after running <code>gdb ./main_process</code>.</p>\n\n<p>Conclusion: you are not telling us what you <em>actually</em> did and what you observe, and trying to guess what that might be is a waste of time.</p>\n"}, {"tags": [], "owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "is_accepted": true, "score": 0, "last_activity_date": 1505814024, "creation_date": 1505814024, "answer_id": 46297024, "question_id": 42813605, "link": "https://stackoverflow.com/questions/42813605/gdb-failed-with-sigsev-dont-know-why/46297024#46297024", "title": "gdb failed with sigsev, don&#39;t know why?", "body": "<p>This question got downvotes, I want to mention here, the segfault caused because of running arm binaries in host GDB. </p>\n\n<p>I've noticed that its bug in our build system where it didn't build actually for the arm arch instead x86.</p>\n\n<p><strong>Questions:</strong></p>\n\n<p>gdb handles only one executables to debug at one time?\nAnswer: Yes and I can able to pass another executable in as an argument using run.</p>\n\n<p>All these three executables can't be run once in gdb?\nAnswer: No. </p>\n"}], "owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 1, "accepted_answer_id": 46297024, "answer_count": 2, "score": -1, "last_activity_date": 1505814024, "creation_date": 1489590434, "last_edit_date": 1505813977, "question_id": 42813605, "link": "https://stackoverflow.com/questions/42813605/gdb-failed-with-sigsev-dont-know-why", "title": "gdb failed with sigsev, don&#39;t know why?", "body": "<p>In my project, I build three applications, in my Linux host machine. </p>\n\n<p>Output binaries are,\n    main_process\n    update_data\n    db_process</p>\n\n<p><strong>Questions:</strong></p>\n\n<ul>\n<li>gdb handles only one executables to debug at one time?</li>\n<li>All these three executables can't be run once in gdb?</li>\n</ul>\n\n<p>When I run, </p>\n\n<p>gdb ./main_process</p>\n\n<p>Error message from gdb:</p>\n\n<pre><code>(gdb) r\nStarting program: /home/iir/bin/ \nwarning: `/lib/ld-linux.so.2': Shared library architecture i386 is not compatible with target architecture i386:x86-64.\nwarning: `/lib/ld-linux.so.2': Shared library architecture i386 is not compatible with target architecture i386:x86-64.\nFailed to read a valid object file image from memory.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00007ffff7dda402 in ?? () from /lib/ld-linux.so.2\n(gdb) bt\n#0  0x00007ffff7dda402 in ?? () from /lib/ld-linux.so.2\nBacktrace stopped: Cannot access memory at address 0x10074\n</code></pre>\n\n<p>EDIT: This question got downvotes, I want to mention here, the segfault caused because of running arm binaries in GDB. I've noticed that its bug in our build system where it didn't build actually for the arm arch instead x86.</p>\n"}, {"tags": ["c", "opengl"], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 3342628, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/eStRY.png?s=128&g=1", "display_name": "Manjunath", "link": "https://stackoverflow.com/users/3342628/manjunath"}, "edited": false, "score": 0, "creation_date": 1489596256, "post_id": 42813573, "comment_id": 72743874, "body": "Explicitly.. u mean? in command line like     cc aa.c -lglut  -lGLU -lGL -lm or how?"}], "tags": [], "owner": {"reputation": 1399, "user_id": 7359606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f9eca7f3b7853fa067205299f3ebc89?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Artsimovich", "link": "https://stackoverflow.com/users/7359606/joseph-artsimovich"}, "is_accepted": true, "score": 0, "last_activity_date": 1489590355, "creation_date": 1489590355, "answer_id": 42813573, "question_id": 42813040, "link": "https://stackoverflow.com/questions/42813040/error-when-linking-opengl-program/42813573#42813573", "title": "Error when linking OpenGL program", "body": "<p>Looks like you need to link to the math library explicitly with <code>-lm</code>.</p>\n"}], "owner": {"reputation": 602, "user_id": 3342628, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/eStRY.png?s=128&g=1", "display_name": "Manjunath", "link": "https://stackoverflow.com/users/3342628/manjunath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 42813573, "answer_count": 1, "score": -2, "last_activity_date": 1489612210, "creation_date": 1489589163, "last_edit_date": 1489612210, "question_id": 42813040, "link": "https://stackoverflow.com/questions/42813040/error-when-linking-opengl-program", "title": "Error when linking OpenGL program", "body": "<p>I'm new to OpenGL programming. I installed Ubuntu 64bit OS and installed all required libraries. But today when compiling I got stuck with an error for which I'm unable to find a solution </p>\n\n<p>When I compiled my program with this command:</p>\n\n<pre><code>cc aa.c -lglut  -lGLU -lGL\n</code></pre>\n\n<p>the following error appeared</p>\n\n<pre><code>/urs/bin/ld: /tmp/ccCVosZx.o: undefined refrence to symbol 'cos@@GLIBC_2.2.5' //lib/x86_64-linux-gnu/libm.so.6: error adding symbols: DSO missing from command line\n</code></pre>\n"}, {"tags": ["c", "json", "malloc", "cjson"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1489588253, "post_id": 42812650, "comment_id": 72737487, "body": "Use <a href=\"https://github.com/json-c/json-c\" rel=\"nofollow noreferrer\"><i>json-c</i> which is solid as a rock</a>, and simple to use. This might be a bug in the cJSON library."}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489588334, "post_id": 42812650, "comment_id": 72737551, "body": "I need a lightweight libray for embedded system. Is it?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489588367, "post_id": 42812650, "comment_id": 72737575, "body": "Yes it is, very lightweight in fact. It&#39;s fast, and widely used."}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489588430, "post_id": 42812650, "comment_id": 72737635, "body": "Can I add the *.c and *h files or i need to add a compiled version?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489588469, "post_id": 42812650, "comment_id": 72737679, "body": "You can download the source from github, and compile it with your code if you know how to. It&#39;s not difficult, and it&#39;s just a few files. <a href=\"https://github.com/json-c/json-c\" rel=\"nofollow noreferrer\">Just click the link</a>"}, {"owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489588583, "post_id": 42812650, "comment_id": 72737778, "body": "Into it&#39;s folder there are many source file. Need I to add each file to my project?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "edited": false, "score": 0, "creation_date": 1489588726, "post_id": 42812650, "comment_id": 72737891, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138124/discussion-between-iharob-al-asimi-and-federico\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "is_accepted": true, "score": 0, "last_activity_date": 1490103163, "creation_date": 1490103163, "answer_id": 42928666, "question_id": 42812650, "link": "https://stackoverflow.com/questions/42812650/cjson-print-function-doesnt-add-number-to-object/42928666#42928666", "title": "cJSON print function doesn&#39;t add number to object", "body": "<p>I updated the cJSON module and now it works fine.</p>\n"}, {"tags": [], "owner": {"reputation": 1930, "user_id": 1717115, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fa7e9cc32f551a10f549fdd9130ce5bc?s=128&d=identicon&r=PG", "display_name": "FSMaxB", "link": "https://stackoverflow.com/users/1717115/fsmaxb"}, "is_accepted": false, "score": 0, "last_activity_date": 1490210166, "creation_date": 1490210166, "answer_id": 42960750, "question_id": 42812650, "link": "https://stackoverflow.com/questions/42812650/cjson-print-function-doesnt-add-number-to-object/42960750#42960750", "title": "cJSON print function doesn&#39;t add number to object", "body": "<p>This is kind of interesting, I believe I know what is going on. Sorry for any inconveniences I caused by writing that bug ...</p>\n\n<p>In version 1.4.0 I introduced a bug to cJSON that the function that prints numbers didn't fail when it couldn't allocate enough memory.</p>\n\n<p><code>print_number</code> will try to allocate 64 bytes of memory before printing a number, because it doesn't know how many bytes <code>sprintf</code> will need and <code>snprintf</code> is not available in ANSI C. Your preallocated buffer probably wasn't long enough for the 64 bytes, so it didn't print the number one, but then continued printing the rest of the JSON normally because it didn't fail (the bug).</p>\n\n<p>I added a note to the header file today: Your preallocated has to be 63 bytes longer than what you expect the printed json to be if you want to avoid any kind of out of situation where cJSON aborts because it thinks it doesn't have enough memory in the preallocated buffer.</p>\n"}], "owner": {"reputation": 821, "user_id": 4953302, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6214968d94b08872c92ba43f392a5f49?s=128&d=identicon&r=PG&f=1", "display_name": "Federico", "link": "https://stackoverflow.com/users/4953302/federico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 42928666, "answer_count": 2, "score": 0, "last_activity_date": 1490210166, "creation_date": 1489588171, "question_id": 42812650, "link": "https://stackoverflow.com/questions/42812650/cjson-print-function-doesnt-add-number-to-object", "title": "cJSON print function doesn&#39;t add number to object", "body": "<p>I developing a C embedded software that build a JSON string with several parameters ( string and integer ). For my purpose I used cJSON ) in future I need to parse complex JSON).</p>\n\n<p>I build my json with this code:</p>\n\n<pre><code>  jsonObject = cJSON_CreateObject();\n\n  cJSON_AddNumberToObject( jsonObject, \"Version\", 1 );\n\n  cJSON_AddStringToObject( jsonObject, \"ID\", \"xyz\" );\n\n  cJSON_AddStringToObject( jsonObject, \"Local\", \"1234\" );\n\n  cJSON_AddNumberToObject( jsonObject, \"Type\", 1 );\n\n  cJSON_AddStringToObject( jsonObject, \"Message\", \"Hello\" );\n</code></pre>\n\n<p>Next I print the JSON into a dynamic buffer using:</p>\n\n<pre><code>cJSON_PrintPreallocated( jsonObject, *jsonMessage, *jsonMessageLen, 0 )\n</code></pre>\n\n<p>When I visualise the jsonMessage on a terminal, the property \"Type\" hasn't a value.</p>\n\n<p>This is the built json:</p>\n\n<pre><code>{\"Version\":1,\"ID\":\"xyz\",\"Local\":\"123\",\"Type\":,\"Message\":\"Hello\"}\n</code></pre>\n\n<p>I try to use a different print method, for example I used:</p>\n\n<pre><code>CJSON_PUBLIC(char *) cJSON_PrintBuffered(const cJSON *item, int prebuffer, cJSON_bool fmt)\n</code></pre>\n\n<p>And the JSON is built correctly. The problem is that I need to allocate the memory by myself and not using cJSON_PrintBuffered. This because I cannot use malloc and free function. </p>\n\n<p>Any suggestions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "sorting", "struct", "bubble-sort"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489587605, "post_id": 42812404, "comment_id": 72736975, "body": "Is the struct definition included before <code>fnEmployeeNumSort</code> is defined?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1489587607, "post_id": 42812404, "comment_id": 72736977, "body": "Where is the 5 coming from in the for loop?"}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 0, "creation_date": 1489587668, "post_id": 42812404, "comment_id": 72737037, "body": "post the full program"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 1, "creation_date": 1489587731, "post_id": 42812404, "comment_id": 72737087, "body": "Have you included the file that contains your struct? Anyways, when you get it to compile you&#39;re probably going to face issues with <code>nCount</code> and <code>ptrPerson[nCount + 1]</code>."}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489587918, "post_id": 42812404, "comment_id": 72737242, "body": "@StoryTeller , I have declared the definitions at the top"}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1489587960, "post_id": 42812404, "comment_id": 72737272, "body": "@ChrisTurner the 5 is the size of the array which is holding 5 different people within the main method"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1489588036, "post_id": 42812404, "comment_id": 72737321, "body": "@Luke: you should initialize the index and only loop up to <code>4</code> and decrement the index by 2 after the swap if it is non zero."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1489588947, "post_id": 42812404, "comment_id": 72738088, "body": "Your code is incomplete; in particular, it seems to be missing a <code>main()</code> function and at least one <code>#include</code>. Please <a href=\"https://stackoverflow.com/posts/42812404/edit\">edit</a> your code so it&#39;s a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem, then we can try to reproduce and solve it. You should also read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "reply_to_user": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1489588999, "post_id": 42812404, "comment_id": 72738144, "body": "@TobySpeight This is just a snippet as the whole code is way too large to include as there are multiple methods."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1489590389, "post_id": 42812404, "comment_id": 72739257, "body": "Read how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, then create one, and <a href=\"https://stackoverflow.com/posts/42812404/edit\">edit</a> your question to insert it.  You don&#39;t just dump your complete source code into a question and hope someone will debug it for you.  Reference: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Did I mention that you should reduce your problematic program to a  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489590479, "post_id": 42812404, "comment_id": 72739332, "body": "The rest of the program is irrelevant, so for the purpose of the question the code is complete."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1489589273, "post_id": 42812448, "comment_id": 72738356, "body": "The algorithm is flawed too."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1489588136, "last_edit_date": 1489588136, "creation_date": 1489587652, "answer_id": 42812448, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing/42812448#42812448", "title": "trying to sort structures but errors or crashing", "body": "<p>Your code has some problems,</p>\n\n<ol>\n<li><p>It's probably crashing because, <code>nCount</code> is never initialized, so it's undefined behavior.</p>\n\n<p>I don't know where the magic <code>5</code> comes from or if it's right, but cerainly not initializing <code>nCount</code> is a problem,</p>\n\n<pre><code>for (nCount = 0; nCount &lt; 5; ++nCount)\n</code></pre>\n\n<p>should fix it.</p>\n\n<p>Note that I said \"<em>probably</em>\", because a crash is a tricky thing. There might be other wrong pointer manipulation somewhere else, which is why a debugger is very helpful in finding these kind of problems.</p></li>\n<li><p>I suggest passing the number of elements as a parameter.</p></li>\n<li><p>You probably need <code>struct strPerson</code> instead of <code>strPerson</code>. </p>\n\n<p>While in the c++ language you can use the structure name directly, in c you can't unless you <code>typedef</code> it</p>\n\n<pre><code>typedef struct strPerson {\n    /* The definition in here */\n} strPerson;\n</code></pre>\n\n<p>then your code would work as it is. (<em>Fixing (1) first of course.</em>)</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 624, "user_id": 5856390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yxszl.png?s=128&g=1", "display_name": "Raz Zelinger", "link": "https://stackoverflow.com/users/5856390/raz-zelinger"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1489587882, "post_id": 42812477, "comment_id": 72737211, "body": "I&#39;ve edited my answer"}], "tags": [], "owner": {"reputation": 624, "user_id": 5856390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yxszl.png?s=128&g=1", "display_name": "Raz Zelinger", "link": "https://stackoverflow.com/users/5856390/raz-zelinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1489587824, "last_edit_date": 1489587824, "creation_date": 1489587726, "answer_id": 42812477, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing/42812477#42812477", "title": "trying to sort structures but errors or crashing", "body": "<p>this should fix it: <code>nCount = 0;</code> in the for loop</p>\n\n<p>and add <code>struct</code> before the strPerson</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 2, "last_activity_date": 1489587737, "creation_date": 1489587737, "answer_id": 42812482, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing/42812482#42812482", "title": "trying to sort structures but errors or crashing", "body": "<p>This line is missing the keyword <code>struct</code> at the beginning</p>\n\n<pre><code>strPerson temp = ptrPerson[nCount + 1];\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>struct strPerson temp = ptrPerson[nCount + 1];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489588277, "post_id": 42812561, "comment_id": 72737503, "body": "@StoryTeller: <i>errors or crashing</i>.  Answer updated, thanks"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489591476, "post_id": 42812561, "comment_id": 72740189, "body": "And there&#39;s also the problem that this ensures the largest employee number is last, but doesn&#39;t ensure the rest are sorted.  There needs to be another level of looping, or some other way to get everything sorted."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489595062, "post_id": 42812561, "comment_id": 72743005, "body": "@JonathanLeffler: the original code had this problem, but decrementing <code>i</code> after a swap fixes it. This is the basic <i>Bubble sort</i> algorithm."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1489588218, "last_edit_date": 1489588218, "creation_date": 1489587945, "answer_id": 42812561, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing/42812561#42812561", "title": "trying to sort structures but errors or crashing", "body": "<p>You have multiple problems in your code:</p>\n\n<ul>\n<li><code>nCount</code> is uninitialized.  This has undefined behavior and can definitely lead to a crash if it happens to have a negative value.</li>\n<li>type <code>strPerson</code> seems undefined, producing a compilation error. Use <code>struct strPerson</code> or define <code>strPerson</code> with <code>typedef struct strPerson strPerson;</code>.</li>\n<li>You also forget to decrement the index after the swap, leading to incorrect sort order.</li>\n<li>The array size is not specified as an argument, the value <code>5</code> in the algorithm would correspond to an array of 6 elements.</li>\n</ul>\n\n<p>You should specify the number of elements in the array as an argument and use this variation on your code:</p>\n\n<pre><code>void fnEmployeeNumSort(struct strPerson *ptrPerson, size_t count) {\n    for (size_t i = 0; i &lt; count - 1; i++) {\n        if (ptrPerson[i].nEmployeeNum &gt; ptrPerson[i + 1].nEmployeeNum) {\n            struct strPerson temp = ptrPerson[i + 1];\n            ptrPerson[i + 1] = ptrPerson[i];\n            ptrPerson[i] = temp;\n            if (i &gt; 0) {\n                i -= 2;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489588757, "post_id": 42812594, "comment_id": 72737919, "body": "nCount is now initialized, and struct included, now when I run the program it&#39;s even worse than before, not sure whats going on"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489588859, "post_id": 42812594, "comment_id": 72738008, "body": "@Luke I do not know what means &quot;worse than before&quot; but it is evident that the sorting algorithm is implemented incorrectly as I wrote in my answer."}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489588948, "post_id": 42812594, "comment_id": 72738090, "body": "how would it be done, I&#39;ve looked at many different examples and have tried to follow them using my own program"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489590066, "post_id": 42812594, "comment_id": 72738998, "body": "@Luke See my updated post."}, {"owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489590704, "post_id": 42812594, "comment_id": 72739517, "body": "Using this is an improvement, as it now outputs one of the 5 people, then it just crashes still"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "edited": false, "score": 0, "creation_date": 1489595878, "post_id": 42812594, "comment_id": 72743610, "body": "@Luke If your program crashes search an error in your code."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1489590045, "last_edit_date": 1489590045, "creation_date": 1489588021, "answer_id": 42812594, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing/42812594#42812594", "title": "trying to sort structures but errors or crashing", "body": "<blockquote>\n  <p>When I try and use the struct name in front of the temp variable it\n  just says 'unknown type name strPerson'</p>\n</blockquote>\n\n<p>There is no type <code>strPerson</code>. There is type <code>struct strPerson</code>. So the compiler issues an error for the declaration</p>\n\n<pre><code>strPerson temp = ptrPerson[nCount + 1];\n</code></pre>\n\n<p>You should write at least</p>\n\n<pre><code>struct strPerson temp = ptrPerson[nCount + 1];\n</code></pre>\n\n<p>Also the variable <code>nCount</code> was not initialized. So the function has undefined behavior.</p>\n\n<p>It is not clear what the magic number 5 means. If it is the size of the passed to the function array then again the function has undefined behavior because the expression <code>nCount + 1</code> can be out of the range of valid indices for the array.</p>\n\n<p>The function itself should be declared like</p>\n\n<pre><code>void fnEmployeeNumSort( struct strPerson *ptrPerson, size_t n );\n</code></pre>\n\n<p>where the second parameter <code>n</code> specifies the size of the sorted sequence.</p>\n\n<p>And at last the function does not perform sorting. The sorting algorithm is implemented incorrectly.</p>\n\n<p>Here is a demonstrative program that shows how the function can implement the bubble sort algorithm.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct strPerson\n{\n    int nEmployeeNum;\n};\n\nvoid fnEmployeeNumSort( struct strPerson *ptrPerson, size_t n )\n{\n    for ( size_t last = n; !( n &lt; 2 ); n = last )\n    {\n        for ( size_t i = last = 1; i &lt; n; i++ )\n        {\n            if ( ptrPerson[i].nEmployeeNum &lt; ptrPerson[i - 1].nEmployeeNum )\n            {\n                struct strPerson temp = ptrPerson[i];\n                ptrPerson[i] = ptrPerson[i - 1];\n                ptrPerson[i - 1] = temp;\n                last = i;\n            }\n        }\n    }       \n}\n\n#define N   5\n\nint main(void) \n{\n    struct strPerson p[N] = { { 5 }, { 4 }, { 3 }, { 2 }, { 1 } };\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", p[i].nEmployeeNum );\n    putchar( '\\n' );\n\n    fnEmployeeNumSort( p, N );\n\n    for ( size_t i = 0; i &lt; N; i++ ) printf( \"%d \", p[i].nEmployeeNum );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>5 4 3 2 1 \n1 2 3 4 5 \n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7196630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48dc13f194ca2e98563ffae965af364c?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/7196630/luke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1489592741, "accepted_answer_id": 42812594, "answer_count": 5, "score": 0, "last_activity_date": 1490830282, "creation_date": 1489587515, "last_edit_date": 1490830282, "question_id": 42812404, "link": "https://stackoverflow.com/questions/42812404/trying-to-sort-structures-but-errors-or-crashing", "closed_reason": "Not suitable for this site", "title": "trying to sort structures but errors or crashing", "body": "<p>I am coding a program which will sort the outputs by employee number, from lowest to highest. When I try and use the struct name in front of the temp variable it just says 'unknown type name strPerson'. I'm not too sure what I need to do, and I have only passed the pointer as a parameter as the other values can be retrieved from members within the struct as shown by the if statement.</p>\n"}, {"tags": ["c", "pointers", "memory-management", "dynamic-arrays", "dynamic-allocation"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489587221, "post_id": 42812270, "comment_id": 72736623, "body": "Any reason for a single start (<code>void*</code>) not to suffice?"}, {"owner": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489587324, "post_id": 42812270, "comment_id": 72736714, "body": "@StoryTeller the array must be implemented to handle generic (void*) types.  I believe I should have an array of pointers, hence the double star."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489587415, "post_id": 42812270, "comment_id": 72736801, "body": "If you insert pointers into the array, you don&#39;t need a <code>size</code> member. If you insert objects, you don&#39;t need an array of pointers"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489587644, "post_id": 42812270, "comment_id": 72737011, "body": "Unrelated to your question, but why a separate <code>malloc</code> followed by a copy-loop? Why not use <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\"><code>realloc</code></a>? Maybe not so unrelated after all, since using <code>realloc</code> would incidentally fix your problem."}, {"owner": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489588245, "post_id": 42812270, "comment_id": 72737482, "body": "@StoryTeller Could you explain why I would not need a size member?"}, {"owner": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489588256, "post_id": 42812270, "comment_id": 72737492, "body": "@Someprogrammerdude unfortunately, the only memory allocation function allowed in this implementation is <code>malloc</code>"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "edited": false, "score": 0, "creation_date": 1489587937, "post_id": 42812386, "comment_id": 72737258, "body": "Thanks, you&#39;re right.  However, I still am getting a segfault when I try to access a-&gt;array[1] after inserting two elements.  Is there anything in my insert code that could have caused this?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "edited": false, "score": 0, "creation_date": 1489588431, "post_id": 42812386, "comment_id": 72737637, "body": "@ScottSinischo Can you please create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> and show us? Like how you use these functions?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1489588438, "post_id": 42812386, "comment_id": 72737645, "body": "It&#39;d help if you included which line your debugger is saying the segfault is happening, but I noticed another problem with the code as-is and updated my answer."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 3, "last_activity_date": 1489588390, "last_edit_date": 1489588390, "creation_date": 1489587466, "answer_id": 42812386, "question_id": 42812270, "link": "https://stackoverflow.com/questions/42812270/dynamic-array-memory-allocation-with-void/42812386#42812386", "title": "Dynamic Array Memory Allocation with void**", "body": "<p>You've got a buffer overrun caused by this loop. Should be <code>i &lt; a-&gt;size</code> since if capacity is 5, you only expand it when size is also 5 and thus you'll be accessing the 6th element in the array.</p>\n\n<pre><code>for (int i = 0; i &lt;= a-&gt;size; i++)\n</code></pre>\n\n<p>You're also not added the new value when you resize. Possibly change the logic of your code along the lines of...</p>\n\n<pre><code>if (a-&gt;size == a-&gt;capacity)\n{\n   /* resize array */\n}\na-&gt;array[a-&gt;size++] = v;\n</code></pre>\n\n<p>...taking care to check the results of using <code>malloc</code> or <code>realloc</code> etc...</p>\n"}], "owner": {"reputation": 111, "user_id": 2407269, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PBEUy.jpg?s=128&g=1", "display_name": "Scott Sinischo", "link": "https://stackoverflow.com/users/2407269/scott-sinischo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 42812386, "answer_count": 1, "score": 1, "last_activity_date": 1489588390, "creation_date": 1489587158, "last_edit_date": 1489587237, "question_id": 42812270, "link": "https://stackoverflow.com/questions/42812270/dynamic-array-memory-allocation-with-void", "title": "Dynamic Array Memory Allocation with void**", "body": "<p>I am trying to implement a dynamic array which must have the following struct:</p>\n\n<pre><code>typedef struct DArray{\n    void **array;\n    int capacity;\n    int size;\n    void (*display)(FILE *, void *); //function pointer to a non-generic display function\n} DArray;\n</code></pre>\n\n<p>However, with the current behavior, the array doesn't seem to resize, and throws a segfault any time I try to access an index that's not zero.  The constructor and insert function is as follows:</p>\n\n<pre><code>DArray *newDArray(void (*d)(FILE *,void *)){\n    DArray *myDarray = malloc(sizeof(DArray));\n    myDarray-&gt;array = malloc(sizeof(void *)); //size = 1 for now, otherwise multiply by array length\n    myDarray-&gt;capacity = 1;\n    myDarray-&gt;size = 0;\n    myDarray-&gt;display = d;\n    return myDarray;\n}\n\nvoid insertDArray(DArray *a,void *v){\n    if (a-&gt;size &lt; a-&gt;capacity)\n        a-&gt;array[a-&gt;size] = v;\n    else{\n        void **newArray = malloc(sizeof(void *) * a-&gt;capacity * 2); //double size\n        for (int i = 0; i &lt;= a-&gt;size; i++)\n            newArray[i] = a-&gt;array[i];  //clone old array\n        a-&gt;capacity = a-&gt;capacity * 2;\n        free(a-&gt;array);\n        a-&gt;array = newArray;\n    }\n    a-&gt;size++;\n}\n</code></pre>\n\n<p>I'm having trouble understanding my pointers here.  I think what's happening is the pointer to a->array still points to the old, unresized array, but doing <code>*a-&gt;array = newArray;</code> does not work either.  Can anyone shed some light on this?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 8, "creation_date": 1489586969, "post_id": 42812150, "comment_id": 72736441, "body": "<a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Read about endianness</a>."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 2, "creation_date": 1489587167, "post_id": 42812150, "comment_id": 72736575, "body": "htonl() is a function you can call to reverse the endian-ness of your 32-bit ints, when running on a little-endian system.  It&#39;s typically implemented in a way that is very efficient (and it&#39;s a no-op when running on a big-endian system)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489587910, "post_id": 42812150, "comment_id": 72737236, "body": "Why the C++ tag? It&#39;s an unrelated language and provides other ways to do this."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1489588159, "post_id": 42812150, "comment_id": 72737408, "body": "@Olaf The code and question are just as relevant to C++ as C. I think the tag is fair."}, {"owner": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 0, "creation_date": 1489588482, "post_id": 42812150, "comment_id": 72737692, "body": "either a C or C++ developer could help me."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489588854, "post_id": 42812150, "comment_id": 72738003, "body": "The functions are C functions, the mechanism is C. A C++ programmer should use other features. And tags are not to attract max. attention. Tag-spam is not well received."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1489588907, "post_id": 42812150, "comment_id": 72738057, "body": "@Joster: from your edit, you seem to understand the issue of endianness. Use the method exposed in my answer on both ends of the transmission. Messing with <code>ntoh</code> macros is error prone as you will need an intermediary variable since you should not attempt to store the <i>reversed</i> value directly into the buffer at a potentially unaligned address. These expressions tend to compile efficiently with modern compilers."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489588963, "post_id": 42812150, "comment_id": 72738106, "body": "@Olaf: I agree a C++ programmer should not use <code>memcpy</code>, but he could use the shift expressions."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489589743, "post_id": 42812150, "comment_id": 72738735, "body": "@Olaf considering the questioner is actually asking <i>what the other methods are</i>, that does not disqualify C++ unless he is unwilling to compile the code as C++. With the C++ tag we have to assume that he is willing to compile the code as C++"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489590075, "post_id": 42812150, "comment_id": 72739006, "body": "@JeremyP: That would make the question too broad. We are a Q&amp;A site, not a consulting site. It also was reason for DV for not showing research effort. Feel free to ask on meta. Although I&#39;m pretty sure it will be closed as dup of a dup of a dup..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489590918, "post_id": 42812150, "comment_id": 72739682, "body": "@JeremyP the code/question may be C/C++ applicable, but the best answers may differ from C and C++ and OP has said &quot;For compiling in C++&quot;, so only the C++ should exist."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489591217, "post_id": 42812150, "comment_id": 72739941, "body": "&quot;I need to fill this buffer with int/short values in big-endian&quot; &amp; &quot;For compiling in C++&quot;  --&gt; then why accept an answer (a good C one) that does not use C++ function overloading for <code>int</code> and <code>short</code>?"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489591861, "post_id": 42812150, "comment_id": 72740507, "body": "So the OP has just added &quot;for compiling in C++&quot;, this means that somebody should post a C++ solution and the OP should change his acceptance to that answer."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489591945, "post_id": 42812150, "comment_id": 72740587, "body": "Although, of course, the question is now a duplicate of this <a href=\"http://stackoverflow.com/questions/105252/how-do-i-convert-between-big-endian-and-little-endian-values-in-c\" title=\"how do i convert between big endian and little endian values in c\">stackoverflow.com/questions/105252/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489589537, "post_id": 42812212, "comment_id": 72738574, "body": "@chqrlie More haste less speed"}, {"owner": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 0, "creation_date": 1489591153, "post_id": 42812212, "comment_id": 72739885, "body": "thanks for the help. I will mark your solution as correct although I need a more general one. One that serves for int/short or even structs with bitfileds. I already have a pretty efficient one, and all i wanted was to know if it&#39;s really necessary to swap bytes in such situation."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 0, "creation_date": 1489591649, "post_id": 42812212, "comment_id": 72740347, "body": "The example code I gave can easily be modified for int and short. Doing structs will necessarily require a roll your own method for each struct type."}], "tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 8, "last_activity_date": 1489589383, "last_edit_date": 1489589383, "creation_date": 1489587043, "answer_id": 42812212, "question_id": 42812150, "link": "https://stackoverflow.com/questions/42812150/why-memcpy-memmove-reverse-data-when-copying-int-to-bytes-buffer/42812212#42812212", "title": "Why memcpy/memmove reverse data when copying int to bytes buffer?", "body": "<p>It's because the processor architecture you use is <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"noreferrer\">little endian</a>. Multibyte numbers (anything bigger than a <code>uint8_t</code>) are stored with the least significant byte at the lowest address.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>What you do about it really depends on what the buffer is for. If you are only going to be using the buffer internally, forget about byte swapping, you'll have to do it in both directions and its a waste of time.</p>\n\n<p>If it is for some external entity e.g. a file or a network protocol, the specification of the file or network protocol will say what the endianness is. For example, network byte order for all the Internet protocols is effectively big endian. The networking library provides a family of functions to convert values for use in sending and receiving Internet protocol messages. Se for instance</p>\n\n<p><a href=\"https://linux.die.net/man/3/htonl\" rel=\"noreferrer\">https://linux.die.net/man/3/htonl</a></p>\n\n<p>If you want to roll your own, the portable way is to use bit shifts e.g.</p>\n\n<pre><code>void writeUInt32ToBufferBigEndian(uint32_t number, uint8_t* buffer)\n{\n    buffer[0] = (uint8_t) ((number &gt;&gt; 24) &amp; 0xff);\n    buffer[1] = (uint8_t) ((number &gt;&gt; 16) &amp; 0xff);\n    buffer[2] = (uint8_t) ((number &gt;&gt; 8) &amp; 0xff);\n    buffer[3] = (uint8_t) ((number &gt;&gt; 0) &amp; 0xff);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7709158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fabc44a7173f50fd5580b8d99b4516?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Ramsden", "link": "https://stackoverflow.com/users/7709158/richard-ramsden"}, "is_accepted": false, "score": 2, "last_activity_date": 1489587204, "creation_date": 1489587204, "answer_id": 42812293, "question_id": 42812150, "link": "https://stackoverflow.com/questions/42812150/why-memcpy-memmove-reverse-data-when-copying-int-to-bytes-buffer/42812293#42812293", "title": "Why memcpy/memmove reverse data when copying int to bytes buffer?", "body": "<p>On x86 architecture integers in memory are little endian.  The lowest byte first.  e.g. 0x12345678 will be 78, 56, 34, 12  in memory. </p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 8, "last_activity_date": 1615880608, "last_edit_date": 1615880608, "creation_date": 1489587412, "answer_id": 42812367, "question_id": 42812150, "link": "https://stackoverflow.com/questions/42812150/why-memcpy-memmove-reverse-data-when-copying-int-to-bytes-buffer/42812367#42812367", "title": "Why memcpy/memmove reverse data when copying int to bytes buffer?", "body": "<p>Neither <code>memcpy</code>, nor <code>memmove</code> <em>reverse</em> data when copying objects. The byte values you observe when dumping the character array correspond to the way the 32-bit value <code>15</code> (<code>0F</code> in hexadecimal) is stored in memory on your environment.</p>\n<p>Its appears to be in little endian order, <code>0F 00 00 00</code>, which is very common in desktop and laptop computers.  Other systems, such as many smartphones, might store integer values in big-endian order, <code>00 00 00 0F</code>, which you consider more <em>natural</em>, but both methods are equally correct.  It is just a matter of convention. Little-endian order means the byte with the lowest value bits is stored first, while big-endian is the opposite: the byte with the highest value bits is stored first.</p>\n<p>A comprehensive article on <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">Wikipedia</a> covers this subject in depth.</p>\n<p>In your application, you must specify in which order the binary value is expected to be stored, and if you decide on big-endian, I suggest you use this code for portability across environments:</p>\n<pre><code>#include &lt;stdint.h&gt;\n\nint foo = 15; //0x0000000F\nunsigned char buffer[100] = { 0 };\n\n...\nbuffer[offset + 0] = ((uint32_t)foo &gt;&gt; 24) &amp; 0xFF;\nbuffer[offset + 1] = ((uint32_t)foo &gt;&gt; 16) &amp; 0xFF;\nbuffer[offset + 2] = ((uint32_t)foo &gt;&gt;  8) &amp; 0xFF;\nbuffer[offset + 3] = ((uint32_t)foo &gt;&gt;  0) &amp; 0xFF;\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 0, "creation_date": 1489588411, "post_id": 42812502, "comment_id": 72737614, "body": "i find some incoherence in the fact that if i copy the bytes of a string like &quot;here is my value:&quot;, and afterwards an integer value, everything in the same buffer, on the output every byte matches the letter&#39;s order except the number. But it may be my perception."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 0, "creation_date": 1489588510, "post_id": 42812502, "comment_id": 72737721, "body": "@Joster: Um... A string? I don&#39;t understand what you are trying to say. If your number is represented as a <i>string</i>, as a part of a larger <i>string</i>, nothing will be reversed after copying. As for your original example (binary representation), the illusion of reversal comes from your everyday habit to write strings left-to-right and to write numbers &quot;right-to-left&quot; (as explained above)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "edited": false, "score": 1, "creation_date": 1489588660, "post_id": 42812502, "comment_id": 72737842, "body": "@Joster: The order of digits in a number is a cultural bias. For example <code>42</code> is written <code>4</code> <code>2</code> but pronounced <code>zwei und vierzig</code> in German, (two and forty).  Note also that Arabic is read from right to left, yet the numbers are written in the same <i>order</i> as in English, appearing as big-endian to an Arabic reader."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1489590615, "post_id": 42812502, "comment_id": 72739428, "body": "@chqrlie Sample inconsistency in English: 41 --&gt; &quot;forty-one&quot;  (big endian text) and 14 --&gt; &quot;Fourteen&quot; (little endian). ;-)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1489868407, "post_id": 42812502, "comment_id": 72862378, "body": "@chux: good point! Even singular and plural are culturally biassed: 0.4 seconds in English and 0,4 seconde in French."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1489588423, "last_edit_date": 1489588423, "creation_date": 1489587777, "answer_id": 42812502, "question_id": 42812150, "link": "https://stackoverflow.com/questions/42812150/why-memcpy-memmove-reverse-data-when-copying-int-to-bytes-buffer/42812502#42812502", "title": "Why memcpy/memmove reverse data when copying int to bytes buffer?", "body": "<p>The \"easier way\" is to stop calling it \"reversed\".  Why, really? <code>0F</code> is the least-significant part of the multi-byte value and you see it stored at the \"less-significant\" (i.e. lower) address. Looks perfectly consistent and natural to me. Why would you call it \"reversed\"?</p>\n\n<p>The only thing that looks \"reversed\" here is that \"strange\" original notation of yours <code>0x0000000F</code> in the comments, where you \"for some reason\" recorded the bytes in right-to-left order: least significant on the right, more significant on the left.</p>\n\n<p>In other words, the reversal here is entirely product of your perception/imagination. You, humans, write numbers in right-to-left order but at the same time output bytes (and write C programs) in left-to-right order. The inconsistency between the two is what is creating the illusion of reversal in such situations.</p>\n"}], "owner": {"reputation": 327, "user_id": 6573628, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5b98c309e7ba0cb8e0f0a8f52b2c7c86?s=128&d=identicon&r=PG&f=1", "display_name": "Joster", "link": "https://stackoverflow.com/users/6573628/joster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8117, "favorite_count": 0, "accepted_answer_id": 42812212, "answer_count": 4, "score": 5, "last_activity_date": 1615880608, "creation_date": 1489586878, "last_edit_date": 1489589980, "question_id": 42812150, "link": "https://stackoverflow.com/questions/42812150/why-memcpy-memmove-reverse-data-when-copying-int-to-bytes-buffer", "title": "Why memcpy/memmove reverse data when copying int to bytes buffer?", "body": "<p>So, my question is pretty simple:</p>\n\n<p>I need to fill a char/unsigned char array with some information. Some values in the middle are taken from short/int types and this is what happens:</p>\n\n<p>Code:</p>\n\n<pre><code>int foo = 15; //0x0000000F\nunsigned char buffer[100]={0};\n\n..\nmemcpy(&amp;buffer[offset], &amp;foo, sizeof(int)); //either memmove\n...\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>... 0F 00 00 00 ..\n</code></pre>\n\n<p>So by now I wrote a function to reverse this fields, but I don't find this a smart solution, as it impacts execution time, resources, and time to develop.</p>\n\n<p><strong>Is there an easier way to do it?</strong></p>\n\n<p>Edit: \nAs many of you have pointed, this behaviour is produced due to the little endian processor, but my problem still remains. I need to fill this buffer with int/short values in big-endian, as i need to serialize tha data to be transmitted to a machine which either works in little/big endian, doesn't matter as this protocol is already defined so.</p>\n\n<p>Note: For compiling in C++</p>\n"}, {"tags": ["c", "arrays", "file"], "comments": [{"owner": {"reputation": 2104, "user_id": 4635537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad50ed18dff8aaff0ff427ea7b1067d?s=128&d=identicon&r=PG", "display_name": "sameerkn", "link": "https://stackoverflow.com/users/4635537/sameerkn"}, "edited": false, "score": 2, "creation_date": 1489585578, "post_id": 42811302, "comment_id": 72735233, "body": "Would suggest you to read how to tokenize a string based on space <code>&#39; &#39;</code>character. Then analyse individual token to check if they are integers  and if they are integers then convert the tokens into integer and then insert them into array."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489585832, "post_id": 42811302, "comment_id": 72735419, "body": "For starters, you should always check the value returned by <code>fscanf()</code>.  It&#39;s pretty hard to validate the data from that call if you don&#39;t even know if it worked."}, {"owner": {"reputation": 160, "user_id": 6594779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c25720c1e7423a97c7894b530bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "svtag", "link": "https://stackoverflow.com/users/6594779/svtag"}, "edited": false, "score": 1, "creation_date": 1489586853, "post_id": 42811302, "comment_id": 72736344, "body": "Using <code>fscanf</code> will limit your program to work in 1 specified manner. Instead I will recommend using <code>fgetc</code>, it will read a file character by character and then you can use <code>ASCII</code> values to determine wheater you need that character or not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489591454, "post_id": 42811302, "comment_id": 72740168, "body": "Read the <i>line</i> with <code>fgets()</code> and then parse it."}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 7566672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bc75ad7652f64439c9b39ccf91a646f?s=128&d=identicon&r=PG&f=1", "display_name": "Stevenson R James", "link": "https://stackoverflow.com/users/7566672/stevenson-r-james"}, "is_accepted": false, "score": 1, "last_activity_date": 1489609737, "last_edit_date": 1495542747, "creation_date": 1489609737, "answer_id": 42820064, "question_id": 42811302, "link": "https://stackoverflow.com/questions/42811302/how-to-read-file-and-validate-input/42820064#42820064", "title": "How to read file and validate input?", "body": "<p>In your code, the fscanf() function call is looking for a pattern in the input stream (ie: the text in your file), which should start with a decimal integer. since \"a5\" does not start with an integer or a sign ('-'), a matching failure occurs. When the matching failure occurs, the character \"a\" is pushed back onto the stream, and the fscanf function returns. During the successive loops the same thing happens, since the input stream is from a file, and will not change.</p>\n\n<p>A very similar issue was discussed in the following stack overflow thread:\n<a href=\"https://stackoverflow.com/questions/17816766/behavior-of-fscanf-when-format-doesnt-match-file-contents\">Behavior of fscanf when format doesn&#39;t match file contents</a></p>\n\n<p>Since you mentioned that you are learning C, I would suggest you look at the various code examples in the \"The C Programming Language by K&amp;R\" Book. I remember that Some of the examples use getchar() to parse input from stdin. You can use the same methods but with fgetc (as mentioned earlier by Sma). I am sure you will enjoy reading the book (And learn the language at the same time!!) </p>\n"}], "owner": {"reputation": 51, "user_id": 7280152, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d6205a57efaacbf2e02dd06b272dfc6c?s=128&d=identicon&r=PG&f=1", "display_name": "Nhan Tran", "link": "https://stackoverflow.com/users/7280152/nhan-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489609737, "creation_date": 1489584751, "question_id": 42811302, "link": "https://stackoverflow.com/questions/42811302/how-to-read-file-and-validate-input", "title": "How to read file and validate input?", "body": "<p>Today I'm learning about File in C and come up with a problem </p>\n\n<p>First I created a text file as below:</p>\n\n<pre><code>5 1 5 2 4 -3 \n</code></pre>\n\n<p>The first element is the array size and I wrote a function to read all positive value into an integer array using this code:</p>\n\n<pre><code>void readFileToArray(char *fname, int *a, int *pn) {\n    int number;\n    int quantity;\n    FILE *fp = fopen(fname, \"r\");\n    fscanf(fp, \"%d\", &amp;quantity);\n    while (*pn &lt; quantity) {\n        fscanf(fp, \"%d\", &amp;number);\n        if (number &gt;= 0) {\n            a[*pn] = number;\n            (*pn)++;\n        }\n        else \n            quantity--;\n    }\n    fclose(fp);\n}\n</code></pre>\n\n<p>And it successfully read 1 5 2 4 into the array</p>\n\n<p>Next I changed the text file into this</p>\n\n<pre><code>5 1a 5 2 4 -3\n</code></pre>\n\n<p>Thanks to Tutorialspoint, I figured out how to eliminate 1a and read 5, 2, 4 into the array with this code </p>\n\n<pre><code>void readFileToArray(char *fname, int *a, int *pn) {\n    int number, test;\n    char space;\n    int quantity;\n    FILE *fp = fopen(fname, \"r\");\n    fscanf(fp, \"%d\", &amp;quantity);\n    while (*pn &lt; quantity) {\n        fpurge(stdin);\n        test = fscanf(fp, \"%d%c\", &amp;number, &amp;space);\n        if (test != 2 || space != ' ')\n            quantity--;\n        else {\n            a[*pn] = number;\n            (*pn)++;\n        }\n    }   \n    fclose(fp);\n}\n</code></pre>\n\n<p>However with the text file</p>\n\n<pre><code>5 1a a5 2 4 -3\n</code></pre>\n\n<p>The previous code block cannot read the file into array. When I tried to debug, I noticed the below code line</p>\n\n<pre><code>test = fscanf(fp, \"%d%c\", &amp;number, &amp;space);\n</code></pre>\n\n<p>It read a5 and returned value 0, which is correct. At this moment:</p>\n\n<pre><code>number = 1\nspace = a //because it cannot read a5 into the format %d%c\n</code></pre>\n\n<p>However, at the next loop run, number and space still held the value 1 and a until loop end. Program exit with no value read into the array</p>\n\n<p>Can anyone explain why and suggest me a solution?</p>\n\n<p>P/s: sorry for my bad English.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489584706, "post_id": 42811260, "comment_id": 72734561, "body": "I would think that <code>strtol(string, &amp;endptr, 2)</code> would convert from the string to the binary number."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 4, "creation_date": 1489584795, "post_id": 42811260, "comment_id": 72734653, "body": "If you&#39;re using an <code>int</code>, you can&#39;t distinguish. You would have to save to a <code>char</code> array (i.e., a string), and manipulate that to get what you want."}, {"owner": {"reputation": 6288, "user_id": 5167682, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2vexc.jpg?s=128&g=1", "display_name": "roottraveller", "link": "https://stackoverflow.com/users/5167682/roottraveller"}, "edited": false, "score": 0, "creation_date": 1489584828, "post_id": 42811260, "comment_id": 72734683, "body": "handling by using a <code>switch</code> case would be better."}, {"owner": {"reputation": 87, "user_id": 7714503, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85baa6296d02f229da40a98a4c4f696d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagato", "link": "https://stackoverflow.com/users/7714503/nagato"}, "edited": false, "score": 0, "creation_date": 1489584984, "post_id": 42811260, "comment_id": 72734795, "body": "I am allowed to use char, however i cant use an array. But since char takes only the first element then for example 01 will be stored as just 48(ASCII of 0)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489585056, "post_id": 42811260, "comment_id": 72734850, "body": "You can&#39;t do it without an array!"}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1489585347, "post_id": 42811260, "comment_id": 72735067, "body": "You can try saving the 2 characters into 2 different <code>char</code>s, but that&#39;s just making things complicated for yourself. Any reason why you can&#39;t use an array?"}, {"owner": {"reputation": 87, "user_id": 7714503, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85baa6296d02f229da40a98a4c4f696d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagato", "link": "https://stackoverflow.com/users/7714503/nagato"}, "edited": false, "score": 0, "creation_date": 1489585445, "post_id": 42811260, "comment_id": 72735140, "body": "school assignment."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1489585732, "post_id": 42811260, "comment_id": 72735340, "body": "If you can&#39;t use arrays, you may have to use 2 <code>char</code>s not in an array (e.g.: <code>char c1, c2; scanf(&quot;%c%c&quot;, &amp;c1, &amp;c2);</code>). Because, again, with an int, it is not possible to distinguish between 1 and 01."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489585809, "post_id": 42811260, "comment_id": 72735403, "body": "<code>char buf[3]; .... scanf(&quot; %2[01]&quot;, buf);</code> is a start."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489585854, "post_id": 42811260, "comment_id": 72735447, "body": "@chux Even though I would say that your suggestion is the best, OP said no arrays because school assignment."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1489585982, "post_id": 42811260, "comment_id": 72735552, "body": "@AntonH Important information like array restriction should be part of the post, not only in a comment.  Post edited."}, {"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 0, "creation_date": 1489586106, "post_id": 42811260, "comment_id": 72735661, "body": "I would also like to point out that the conditions in the <code>while</code> loop are in decimal, not binary, so you&#39;re not going to get the desired behavior regardless."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1489586138, "post_id": 42811260, "comment_id": 72735690, "body": "Read about encoding and representation of values in <b>binary</b> digital computers. And using decimal input to read a string of binary digits is a bad idea anyway. As others say, read a &quot;string&quot; and use <code>strtol</code> to convert to an integer (preferable <code>strtoul</code> to use an unsigned integer). If you are not allowed to use a <code>char []</code>, talk to your teacher, this restriction enforces bad code, something an assignment should <b>never</b> do. A good teacher will understand that and rethink his position. Feel free to cite me before your teacher."}], "answers": [{"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1489586337, "creation_date": 1489586337, "answer_id": 42811939, "question_id": 42811260, "link": "https://stackoverflow.com/questions/42811260/how-to-distinguish-between-01-and-1-in-c/42811939#42811939", "title": "how to distinguish between &quot;01&quot; and &quot;1&quot; in C", "body": "<p>Why not have a loop that reads in 2 characters, making sure they're either a 0 or 1 and build up n_bin as you go along.</p>\n\n<pre><code>int i;\nint n_bin=0;\nint c;\nint valid=0;\nwhile(!valid)\n  {\n  valid=1;\n  for(i=0;i&lt;2;i++)\n    {\n    c=getchar();\n    if ((c=='0')&amp;&amp;(c=='1'))\n      {\n      n_bin *= 2;\n      n_bin += c-'0';\n      }\n    else\n      {\n      valid=0;\n      break;\n      }\n    }\n  if(!valid)\n    {\n    printf(\"Your entered number is %d\\n Please enter a 2-digit binary number! \\n\",n_bin);\n    }\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1489586711, "post_id": 42812001, "comment_id": 72736207, "body": "Don&#39;t forget to add check on <code>length</code>, it&#39;s not valid if it has a value other than 2."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 6254, "user_id": 2261424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0beda634f65f29aace865be9504e5e6?s=128&d=identicon&r=PG", "display_name": "AntonH", "link": "https://stackoverflow.com/users/2261424/antonh"}, "edited": false, "score": 1, "creation_date": 1489586928, "post_id": 42812001, "comment_id": 72736407, "body": "@AntonH OP has ambiguity in the length requirement: should it distinguish or only accept 2 digits?  In any case, OP can add a length test of <code>if (length == 2)</code> or <code>if (length &gt;= 1 &amp;&amp; length &lt;= 2)</code> as needed."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489588591, "post_id": 42812001, "comment_id": 72737782, "body": "Even if length can be greater than 2, it should be restricted to being less than 32 to prevent <code>n_bin</code> from overflowing."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489589621, "post_id": 42812001, "comment_id": 72738649, "body": "@JeremyP True about OF.  Code could use additional code/length check or <code>unsigned</code> to handle overflow cases without UB or use <code>&quot; %n%3d%n&quot;</code> in the 2nd case.  Many approaches.  IMO, a robust solution would read a <i>line</i> of user input into a <i>string</i> and then parse it: something like a base 2 version of <a href=\"http://stackoverflow.com/a/21666135/2410359\">#3 in this answer</a>."}, {"owner": {"reputation": 87, "user_id": 7714503, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85baa6296d02f229da40a98a4c4f696d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagato", "link": "https://stackoverflow.com/users/7714503/nagato"}, "edited": false, "score": 0, "creation_date": 1489591375, "post_id": 42812001, "comment_id": 72740096, "body": "Thanks. Gonna use this method. Highly appreciated."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1489588260, "last_edit_date": 1489588260, "creation_date": 1489586467, "answer_id": 42812001, "question_id": 42811260, "link": "https://stackoverflow.com/questions/42811260/how-to-distinguish-between-01-and-1-in-c/42812001#42812001", "title": "how to distinguish between &quot;01&quot; and &quot;1&quot; in C", "body": "<p>No analysis of <code>int n_bin</code> will determine if it was assigned with user input of <code>\"1\"</code> or <code>\"01\"</code>.  Code needs to looks at the point of user input to distinguish.</p>\n\n<hr>\n\n<p>Reading in using characters:</p>\n\n<p>Read user input, one character at a time.  Look for <code>'0'</code>, <code>'1'</code>, <code>'\\n'</code>, <code>EOF</code> or something else.</p>\n\n<pre><code>int n_bin = 0;\nint length = 0;\nint ch;\nwhile ((ch = fgetc(stdin)) &gt;= '0' || ch &lt;= '1') {\n  n_bin =  n_bin*2 + (ch - '0');  // *2 as this is base 2\n  length++;\n}\n\nif (ch = '\\n' || ch == EOF) {\n  printf(\"Value (in decimal):%d  Character length:%d\\n\", n_bin, length);\n  if (n_bin &lt; 0 || n_bin &gt; 3 || length != 2) puts(\"Non-conformance\"):\n} else {\n  puts(\"Unexpected character entered\");\n} \n</code></pre>\n\n<hr>\n\n<p>Reading in as <code>int</code>, noting character offsets:</p>\n\n<p>Should you care for a more advanced approach, use <code>\"%n\"</code> which record the number of characters scanned.  </p>\n\n<pre><code>int n_bin;\nint start, end;        \n//                  v------- Consume leading white-space\n//                  | v----- Store # of characters read\n//                  | | v--- Scan/store int\n//                  | | | v- Store # of characters read\nint retval = scanf(\" %n%d%n\", &amp;start, &amp;n_bin, &amp;end);\nif (retval == 1) {\n  if ((end - start) == 2 &amp;&amp; n_bin &gt;= 0 &amp;&amp; n_bin &lt;= 3) {\n    puts(\"Success\");\n  } else {\n    puts(\"Fail\");\n  }\nelse {\n  // consume remaining characters in line\n  http://stackoverflow.com/q/34219549/2410359\n  puts(\"Fail\");\n}\n</code></pre>\n\n<p>Note: This second approach will pass input like <code>\"+1\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 750, "user_id": 7054387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-6bDjhl9WjJI/AAAAAAAAAAI/AAAAAAAAAA0/HLJVVOTCc1Q/photo.jpg?sz=128", "display_name": "Fatemeh Karimi", "link": "https://stackoverflow.com/users/7054387/fatemeh-karimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489596469, "creation_date": 1489596469, "answer_id": 42815925, "question_id": 42811260, "link": "https://stackoverflow.com/questions/42811260/how-to-distinguish-between-01-and-1-in-c/42815925#42815925", "title": "how to distinguish between &quot;01&quot; and &quot;1&quot; in C", "body": "<p>there's no difference between 1 and 01 for the computer if the type is int. you can define two variable as below:</p>\n\n<pre><code>char digit1, digit2;\ndigit1 = getchar();\ndigit2 = getchar();\nwhile( '0' &lt;= digit1  &amp;&amp; digit1 &lt;= '9' &amp;&amp; '0' &lt;= digit2 &amp;&amp; digit2 &lt;= '9'){\n//write the code you want.\n//if diffrent instructions must be executed for 01 &amp; 00, it must be written here.\n//also instructions for other digits\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7714503, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/85baa6296d02f229da40a98a4c4f696d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagato", "link": "https://stackoverflow.com/users/7714503/nagato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1489596469, "creation_date": 1489584661, "last_edit_date": 1489585926, "question_id": 42811260, "link": "https://stackoverflow.com/questions/42811260/how-to-distinguish-between-01-and-1-in-c", "title": "how to distinguish between &quot;01&quot; and &quot;1&quot; in C", "body": "<p>I want user to enter 2 digit binary number. The example below works fine unless I enter values such as \"0\" or \"1\". By the definition 0 and 1 is not a 2 digit binary but program treats 01 as 1 so it exits from while loop. How can I fix it ? Basically, how can i make computer to distinguish between 01 and 1?  </p>\n\n<pre><code>int n_bin; \n\nwhile(n_bin!=01 &amp;&amp; n_bin!=00 &amp;&amp; n_bin!=10&amp;&amp;n_bin!=11) {;\n    printf(\"Your entered number is %d\\n Please enter a 2-digit binary number! \\n\",n_bin);\n    scanf(\"%d\",&amp;n_bin);\n}\n</code></pre>\n\n<p>I am allowed to use <code>char</code>, however I can't use an array.</p>\n"}, {"tags": ["c", "macos", "libc"], "comments": [{"owner": {"reputation": 1422, "user_id": 489345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1721c8a9adacfe182e8bea9aec08655a?s=128&d=identicon&r=PG", "display_name": "jojonas", "link": "https://stackoverflow.com/users/489345/jojonas"}, "edited": false, "score": 0, "creation_date": 1489584552, "post_id": 42811165, "comment_id": 72734443, "body": "What is the return code of your example? Does it return 1 (chmod did not succeed) or 0?"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "reply_to_user": {"reputation": 1422, "user_id": 489345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1721c8a9adacfe182e8bea9aec08655a?s=128&d=identicon&r=PG", "display_name": "jojonas", "link": "https://stackoverflow.com/users/489345/jojonas"}, "edited": false, "score": 0, "creation_date": 1489584652, "post_id": 42811165, "comment_id": 72734528, "body": "it does return 0, an important fact is that the program works in the local directory but does not when using /tmp/"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1489585016, "post_id": 42811165, "comment_id": 72734819, "body": "Works on my Linux. must be some protection or how umask works on mac."}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489585176, "post_id": 42811165, "comment_id": 72734944, "body": "any comment on the downvote? Is the question not clear? Or too verbose?"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 1, "creation_date": 1489586725, "post_id": 42811165, "comment_id": 72736220, "body": "What happens if you run your C program under <code>sudo</code>, i.e. <code>sudo .&#47;YourProgram</code>"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489588299, "post_id": 42811165, "comment_id": 72737520, "body": "With sudo it works"}, {"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1489588473, "post_id": 42811165, "comment_id": 72737686, "body": "I deduce that your code is correct therefore but that something like <code>SIP</code> (System Integrity Protection) is preventing you as a normal user. However, I have been wrong before ;-)"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489589306, "post_id": 42811165, "comment_id": 72738378, "body": "How can SIP protect my c program but not chmod? Doesn&#39;t chmod do the same syscall than my program?"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "reply_to_user": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1489644977, "post_id": 42811165, "comment_id": 72763756, "body": "@MarkSetchell I tried disabling SIP with <code>csrutil disable</code> in System Recovery, but it did not help. Btw: I now totally rewrote the question, there was a mistake: I compared my C program against <code>chmod u+s</code> which was wrong, it needs to be compared against <code>chmod g+s</code>"}], "answers": [{"comments": [{"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489601261, "post_id": 42815076, "comment_id": 72746825, "body": "You misunderstood the question. I agree that it is a bit misleading that the chmod sets different flags than the C program. The point is that chmod can set the setgid flag but my c program not. However when executed as root or in a different directory it eorks"}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489601389, "post_id": 42815076, "comment_id": 72746893, "body": "Your C program is setting the setgid flag. However, it&#39;s also clearing the user execute flag. Setgid doesn&#39;t make any sense without execute permissions, and <code>ls</code> may not have any way to display that combination."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489601579, "post_id": 42815076, "comment_id": 72747008, "body": "Your question didn&#39;t mention anything about running the executable as root\u2026"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489601692, "post_id": 42815076, "comment_id": 72747065, "body": "Indeed, I forgot to add that. It&#39;s in the comments below. But what I mentioned is that it works in different directories"}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1489645090, "post_id": 42815076, "comment_id": 72763805, "body": "thanks to your answer I found that my question was not clearly asked, so I totally revised it and found out that I wrongly compared my C program against <code>chmod u+s</code> which should have been <code>chmod g+s</code>. Also, I took your <code>chmod</code> usage suggestion into the question so the execution flag is also set"}], "tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 0, "last_activity_date": 1489594125, "creation_date": 1489594125, "answer_id": 42815076, "question_id": 42811165, "link": "https://stackoverflow.com/questions/42811165/setgid-does-not-work-on-tmp/42815076#42815076", "title": "setgid does not work on /tmp/", "body": "<p>The <code>chmod()</code> system call sets the permissions on a file to <em>only</em> the value you provide. This means that setting permissions to <code>S_IRUSR | S_ISGID</code> clears all other permissions, including user write and execute.</p>\n\n<p>What you probably want is:</p>\n\n<pre><code>chmod(\"/tmp/foo\", 0755 | S_ISGID);\n</code></pre>\n\n<p>(<code>0755</code> being the octal mode for user read+write+execute and group/other read+execute -- it's a lot less typing than the equivalent constants.)</p>\n"}], "owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489993354, "creation_date": 1489584396, "last_edit_date": 1489993354, "question_id": 42811165, "link": "https://stackoverflow.com/questions/42811165/setgid-does-not-work-on-tmp", "title": "setgid does not work on /tmp/", "body": "<p>I have this C program:</p>\n\n<pre><code>#include &lt;sys/stat.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    if (chmod(\"/tmp/foo\", 0755 | S_ISGID) &lt; 0) {\n            exit(1);\n    }\n    exit(0);\n}\n</code></pre>\n\n<p>When I run it like this:</p>\n\n<pre><code>rm -f /tmp/foo &amp;&amp;\ntouch /tmp/foo &amp;&amp;\n./a.out &amp;&amp;\nls -al /tmp/foo &amp;&amp;\n</code></pre>\n\n<p><code>a.out</code> runs with exit code <code>0</code> but the output is:</p>\n\n<pre><code>-rwxr-xr-x  1 philipp  wheel  0 Mar 16 06:58 /tmp/foo\n</code></pre>\n\n<p><strong>Why is the groupid flag not set here?</strong> The permissions should be <code>-rwxr-sr-x</code>.</p>\n\n<p>The following things would fix the issue (but I still wonder why I see this effect):</p>\n\n<ul>\n<li>running the program as root</li>\n<li>running it in a different directory</li>\n<li>running it on Linux</li>\n<li>setting the set-user-id (<code>S_ISUID</code>)</li>\n<li>I can swear it worked in an earlier version of OSX</li>\n</ul>\n\n<p>What I tried but didn't work:</p>\n\n<ul>\n<li><code>chmod g+s /tmp/foo</code> also doesn't work</li>\n<li>disabling csrutil did not change anything</li>\n<li>altering the permissions on <code>/tmp/</code> to something different, e.g. <code>0777</code> or <code>4777</code></li>\n</ul>\n\n<p>So the question remains: what does make <code>/tmp/</code> different from the other directories if it's not the permissions? The only difference I could see is:</p>\n\n<pre><code>ls -al /\n</code></pre>\n\n<p>showed tmp as this:</p>\n\n<pre><code>lrwxr-xr-x@   1 root  wheel     11 Dec 11 19:28 tmp -&gt; private/tmp\n</code></pre>\n\n<p>The <code>@</code> sign at the end shows that there are some non-unix properties set on the directory. Querying those with <code>ls -l@ /tmp</code> shows:</p>\n\n<pre><code>lrwxr-xr-x@ 1 root  wheel  11 Dec 11 19:28 /tmp -&gt; private/tmp\n    com.apple.FinderInfo    32\n    com.apple.rootless       0\n</code></pre>\n\n<p><strong>Update</strong>: According to comment feedbacks and a downvote I figured the question is confusing, so I totally revised the question and the title. During revision I found out that I wrongly compared the effects of my program against <code>chmod u+s</code> which was wrong, I need to compare against <code>chmod g+s</code>, I also corrected this in my question.</p>\n"}, {"tags": ["c", "arrays", "json", "char", "readfile"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489584453, "post_id": 42811141, "comment_id": 72734368, "body": "It will not fix the problem probably, but use <code>fread()</code> instead of reading one character at a time. And <code>sizeof(char)</code> is ALWAYS 1, it&#39;s mandatory."}, {"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489584584, "post_id": 42811141, "comment_id": 72734468, "body": "I&#39;ve used fread but same problem"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489584600, "post_id": 42811141, "comment_id": 72734480, "body": "Where is your <code>printf()</code> call?"}, {"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1489584770, "post_id": 42811141, "comment_id": 72734626, "body": "I&#39;ve put it after add &#39;\\0&#39; (edit)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1489585104, "post_id": 42811141, "comment_id": 72734888, "body": "I think your problem is the input file then. Because this code is fine."}, {"owner": {"reputation": 818, "user_id": 7095889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dd263cb10743a750eff5b85bb91bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yuriy Ivaskevych", "link": "https://stackoverflow.com/users/7095889/yuriy-ivaskevych"}, "edited": false, "score": 0, "creation_date": 1489585315, "post_id": 42811141, "comment_id": 72735038, "body": "Have you tried to use a <i>debugger</i> to see what is going on? Especially when you get <code>string_size</code>, inside <code>while</code> loop and to inspect content of <code>content</code> before printing."}, {"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "edited": false, "score": 1, "creation_date": 1489585395, "post_id": 42811141, "comment_id": 72735098, "body": "The file is not a simple txt file, it looks like xml syntax but have a CRC32 at the begining, i add an example"}, {"owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "edited": false, "score": 0, "creation_date": 1489585751, "post_id": 42811141, "comment_id": 72735354, "body": "The question marks are for non printable characters. The real binary values are needed to understand fully the problem.  You can try to pipe the output of your program into <code>hexdump -C</code>, this will show you what your program really outputs."}, {"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "edited": false, "score": 0, "creation_date": 1489587036, "post_id": 42811141, "comment_id": 72736484, "body": "I&#39;ve removed first line with CRC32 for test and file reading is fine, so just have this question, how read the special characters of CRC in the file ?"}, {"owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "edited": false, "score": 1, "creation_date": 1489587845, "post_id": 42811141, "comment_id": 72737183, "body": "The problem is not the reading, but rather the way you output them. A possibility could be to check each byte value and print them with a &#39;.&#39; when they are not printable. That&#39;s somewhat similar to what hexdump -C would do.  <code>man ascii</code> can give you a starting step, but keep in mind that things like unicode can make the &quot;printable&quot; detection quite complex."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "edited": false, "score": 0, "creation_date": 1489585049, "post_id": 42811319, "comment_id": 72734841, "body": "i did it, same problem"}], "tags": [], "owner": {"reputation": 4964, "user_id": 2622016, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/224fcc10727bc8adf8a64f548abd9b6b?s=128&d=identicon&r=PG", "display_name": "user2622016", "link": "https://stackoverflow.com/users/2622016/user2622016"}, "is_accepted": false, "score": -2, "last_activity_date": 1489584790, "creation_date": 1489584790, "answer_id": 42811319, "question_id": 42811141, "link": "https://stackoverflow.com/questions/42811141/char-parse-error-from-char-array/42811319#42811319", "title": "Char* parse error from char array", "body": "<p>I think you should use quotes <code>\"\"</code> around the content string:</p>\n\n<pre><code>printf(\"content: \\\"%s\\\"\",content);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1489585158, "post_id": 42811452, "comment_id": 72734923, "body": "You are printing <code>content</code> when it&#39;s uninitialized, UNDEFINED BEHAVIOR."}, {"owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "edited": false, "score": 0, "creation_date": 1489585303, "post_id": 42811452, "comment_id": 72735029, "body": "My file contains a CRC32 at the begining so it has special characters, do you think thas this can be the cause ?"}, {"owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "edited": false, "score": 0, "creation_date": 1489585491, "post_id": 42811452, "comment_id": 72735176, "body": "@user2622016: edited, but the same goes for the malloc not checked in the OP&#39;s original version... --- to jof III: of course, for example, the special characters could contain a \\r and some spaces and overwrite the rest of the output. Can you attach your file, for examination ?"}], "tags": [], "owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "is_accepted": false, "score": -1, "last_activity_date": 1489585435, "last_edit_date": 1489585435, "creation_date": 1489585109, "answer_id": 42811452, "question_id": 42811141, "link": "https://stackoverflow.com/questions/42811141/char-parse-error-from-char-array/42811452#42811452", "title": "Char* parse error from char array", "body": "<p>I compiled and ran the following code and it shows no major problem when executed.</p>\n\n<p>The compilable version I used is (cmdline: gcc main.c -Wall -Wextra -o main):</p>\n\n<pre><code>    #include &lt;stdlib.h&gt;\n    #include &lt;stdio.h&gt;\n    #include &lt;string.h&gt;\n\n    int main(void)\n    {\n            int c;\n            FILE *file;\n\n            int string_size;\n            file = fopen(\"plop\", \"r\");\n            char * content;\n            if (file == NULL)\n            {\n                    perror(\"fprintf\");\n                    return 1;\n            }\n\n            // Seek the last byte of the file\n            fseek(file, 0, SEEK_END);\n            // Offset from the first to the last byte, or in other words, filesize\n            string_size = ftell(file);\n            // go back to the start of the file\n            rewind(file);\n            // Allocate a string that can hold it all\n            content = malloc((string_size + 1) * sizeof(char));\n\n            int i = 0;\n\n            while ((c = getc(file)) != EOF)\n            {\n                    //printf(\"%c\",(char) c);\n                    content[i] = (char) c;\n                    i++;\n            }\n\n            content[string_size] = '\\0';\n\n            printf(\"content: %s\", content);\n\n            return 0;\n    }\n</code></pre>\n\n<p>Maybe your file has a binary content?<br>\nWhat is the symbol printed, that you mentioned?</p>\n"}], "owner": {"reputation": 29, "user_id": 4729359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-Ky7sr289c8A/AAAAAAAAAAI/AAAAAAAAFkc/qw-WOjXUorI/photo.jpg?sz=128", "display_name": "jof lll", "link": "https://stackoverflow.com/users/4729359/jof-lll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489585595, "creation_date": 1489584332, "last_edit_date": 1592644375, "question_id": 42811141, "link": "https://stackoverflow.com/questions/42811141/char-parse-error-from-char-array", "title": "Char* parse error from char array", "body": "<p>I read a file and stock all characters like this:</p>\n<pre><code>void ReadFile()\n{\n    int c;\n    FILE *file;\n\n    int string_size;\n    file = fopen(&quot;/userFiles/ex.txt&quot;, &quot;r&quot;);\n    char * content;\n    if (file)\n    {\n\n        // Seek the last byte of the file\n        fseek(file, 0, SEEK_END);\n        // Offset from the first to the last byte, or in other words, filesize\n        string_size = ftell(file);\n        // go back to the start of the file\n        rewind(file);\n        // Allocate a string that can hold it all\n        content = malloc((string_size + 1) * sizeof(char));\n\n        int i = 0;\n\n        while ((c = getc(file)) != EOF)\n        {\n            //printf(&quot;%c&quot;,(char) c);\n            content[i] = (char) c;\n            i++;\n        }\n\n        content[string_size] = '\\0';\n        printf(&quot;content: %s&quot;,content);\n        fclose(file);\n\n    }\n    else\n    {\n        printf(&quot;not load\\n&quot;);\n    }\n\n}\n</code></pre>\n<p>Problem is if i read each carachter i've got the content of the file but if i do:</p>\n<pre><code>printf(&quot;content: %s&quot;,content);\n</code></pre>\n<p>I got just a symbol and not text whereas i need to pass the content var with correct text in argument of a json reply.</p>\n<p>This is the first line of the file (CRC32):</p>\n<blockquote>\n<h1>\ufffdex.txt    k\ufffd\ufffdX\ufffd ?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?</h1>\n</blockquote>\n"}, {"tags": ["c", "regex"], "comments": [{"owner": {"reputation": 818, "user_id": 7095889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dd263cb10743a750eff5b85bb91bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yuriy Ivaskevych", "link": "https://stackoverflow.com/users/7095889/yuriy-ivaskevych"}, "edited": false, "score": 1, "creation_date": 1489584793, "post_id": 42811106, "comment_id": 72734652, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1085083/regular-expressions-in-c-examples\">Regular expressions in C: examples?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7098688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pDTOOnxJlWM/AAAAAAAAAAI/AAAAAAAAAVs/Ou4gIHXwCNs/photo.jpg?sz=128", "display_name": "Viral Prajapati", "link": "https://stackoverflow.com/users/7098688/viral-prajapati"}, "edited": false, "score": 0, "creation_date": 1489742542, "post_id": 42811358, "comment_id": 72813737, "body": "I have difficulty in understanding direct source code, can you please provide some video link for regex.h tutorials?"}], "tags": [], "owner": {"reputation": 9137, "user_id": 4295017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53186503963b4007f9107bd53e151966?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Egorov", "link": "https://stackoverflow.com/users/4295017/dmitry-egorov"}, "is_accepted": false, "score": 0, "last_activity_date": 1489584874, "creation_date": 1489584874, "answer_id": 42811358, "question_id": 42811106, "link": "https://stackoverflow.com/questions/42811106/how-to-wirte-regular-expressions-in-c-i-am-making-a-test-case-on-prime-no-usin/42811358#42811358", "title": "How to Wirte regular expressions in c? I am making a test case on Prime No. using concept of Regular Expression in c, Following is my source code", "body": "<p>You can't simply compare a string with a regex like this: <code>ch==[A-Za-z]</code>. You have to prepare (compile) the regex using <code>regcomp()</code> and then use <code>regexec()</code> to match the regex against your input string.</p>\n\n<p>An old example of using POSIX regex functions can be found <a href=\"http://web.archive.org/web/20160308115653/http://peope.net/old/regex.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7098688, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pDTOOnxJlWM/AAAAAAAAAAI/AAAAAAAAAVs/Ou4gIHXwCNs/photo.jpg?sz=128", "display_name": "Viral Prajapati", "link": "https://stackoverflow.com/users/7098688/viral-prajapati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489584874, "creation_date": 1489584234, "question_id": 42811106, "link": "https://stackoverflow.com/questions/42811106/how-to-wirte-regular-expressions-in-c-i-am-making-a-test-case-on-prime-no-usin", "title": "How to Wirte regular expressions in c? I am making a test case on Prime No. using concept of Regular Expression in c, Following is my source code", "body": "<p>How to Wirte regular expressions in c? I am making a test case on Prime No. using concept of Regular Expression in c, Following is my source code. this code should not accept any negative no.s, should not accept 0's &amp; 1's, Should not accept decimal no.s(floating values) &amp; neither any alphabets or characters or special symbols, I am having problem with concept of regular expression acceptance!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;regex.h&gt;\n\n\n int main() {\n  int i, n, prime, flag=0;\n\n  char ch[10],*p;\n\n  printf(\"Enter the Number to check Whether its prime or not\\n\");\n\n  scanf(\"%s\",&amp;ch);\n\n  if(p= strstr(ch,\".\")){\n\n    printf(\"Decimal Values are not allowed in Prime Number!\\n\");\n\n    goto error;\n\n  }else if (ch==[A-Za-z]){\n\n    printf(\"Please Enter the Numeric Value\\n\");\n\n  }\n\n  n=atoi(ch);\n\n  printf(\"The Integer Type Cast Value is:%d\\n\",n );\n\n  if(n&lt;=0){\n\n  printf(\"%d is not a Valid number, prime number is always positive &amp; greater than &amp; is not in decimal 0\\n\",n );\n\ngoto error;\n\n}else{\n\n  for(i=2; i&lt;=n/2; ++i){\n\n         if(n%i==0){\n\n           flag=1;\n\n           break;\n\n       }\n     }\n   }\n\n   if (flag==0)\n       printf(\"%d is a prime number.\",n);\n   else if (flag==1)\n\nprintf(\"%d is not a prime number.\",n);\n\n       else\n\n       error:printf(\"%s is not a Valid number, prime number is always positive &amp; greater than &amp; is not in decimal 0\\n\",ch);\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "linked-list", "thread-safety", "pthreads"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7506022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adf00acebf73dcb2fd0323ea48a17a?s=128&d=identicon&r=PG&f=1", "display_name": "JNgoon", "link": "https://stackoverflow.com/users/7506022/jngoon"}, "edited": false, "score": 0, "creation_date": 1490107705, "post_id": 42812261, "comment_id": 72958271, "body": "First of all thanks for the comment and the book tip, I did a little bit of research in your recommended literature and nearly none of my questions are answered, but I&#39;ve learned some new stuff I like to know ;)"}], "tags": [], "owner": {"reputation": 71, "user_id": 7707841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sKzNgt73hCM/AAAAAAAAAAI/AAAAAAAAAAA/EfsWnhDeuAI/photo.jpg?sz=128", "display_name": "segfault", "link": "https://stackoverflow.com/users/7707841/segfault"}, "is_accepted": false, "score": 0, "last_activity_date": 1489587138, "creation_date": 1489587138, "answer_id": 42812261, "question_id": 42810997, "link": "https://stackoverflow.com/questions/42810997/del-and-r-w-linked-list-nodes-in-multithreading-with-rw-locks-deadlocks/42812261#42812261", "title": "Del. and r/w linked List Nodes in Multithreading with RW-locks -&gt; deadlocks?", "body": "<p>If you want to insert/delete list nodes, then doing fine-grained synchronization without locking the whole list is a bit tricky. The best way to start is to look through the slides from Maurice Herlihy &amp; Nir Shavit: \"<a href=\"http://www.cs.nyu.edu/courses/fall05/G22.2631-001/lists.slides2.pdf\" rel=\"nofollow noreferrer\">Linked Lists: Locking, Lock-Free, and Beyond ...</a>\".</p>\n\n<p>I also strongly recommend the classical work \"The Art of Multiprocessor Programming\" from the same authors, this is the must-read book if you are seriously interested in multithreading.</p>\n"}], "owner": {"reputation": 13, "user_id": 7506022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adf00acebf73dcb2fd0323ea48a17a?s=128&d=identicon&r=PG&f=1", "display_name": "JNgoon", "link": "https://stackoverflow.com/users/7506022/jngoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489587138, "creation_date": 1489583966, "question_id": 42810997, "link": "https://stackoverflow.com/questions/42810997/del-and-r-w-linked-list-nodes-in-multithreading-with-rw-locks-deadlocks", "title": "Del. and r/w linked List Nodes in Multithreading with RW-locks -&gt; deadlocks?", "body": "<p>I've got a question about how exactly rw-locks in multithreading working with single linked lists.</p>\n\n<p>First of all the Scenario in a Pitcure:     </p>\n\n<pre><code>    Head ==&gt; A ==&gt; B ==&gt; C ==&gt; Tail\n                   ^    \n                  | |\n                  |  ----------&gt; Thread 2:\n            Thread 1:            - rw-access B    \n            -deleting B\n</code></pre>\n\n<p>And now in text; Thread 1 is on the way to deleting Node B so locks A and locks B after locking to B is done, Thread 2 is trying to read or/and write information to/from B so he`s is trying to lock B and hate to wait, because Thread 1 already locked B.</p>\n\n<p>Now I'm a little bit confused<br>\n<strong>What happens after Thread 1 deleted B and unlocks B?</strong><br>\n<strong>Is Thread 1 in a deadlock, because I deleted the Lock in B by using free(b) ?</strong><br>\n<strong>Do I have to destroy the Lock for B in Thread 1 ?</strong><br>\n<strong>Do I have to manage this case in a routine? like: Check after getting the lock if B is still a Node ?</strong><br>\nHere another \"picture\" to illustrate it.</p>\n\n<pre><code>Thread 1                Thread 2\n----------------------  ----------------------\nLock A                  \nLock B                         \nA-&gt;next = C;            Lock B\nUnlock A                waiting ...\nfree(B)                 waiting ...\nUnlock B                waiting ...\n                        Get Lock B\n                        Try to read/write B  // what happens now?\n</code></pre>\n\n<p>My List elements looks like this</p>\n\n<pre><code>typedef struct Node\n{\n    char Name[21];          // Information Dummy\n    pthread_rwlock_t aLock; // rw lock\n    Node *next;             // pointer to the next node\n}Node;\n</code></pre>\n\n<p>I hope I were able to illustrate my Problem ;)</p>\n\n<p>kind regards</p>\n"}, {"tags": ["c", "return-type"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1489583760, "post_id": 42810897, "comment_id": 72733854, "body": "<i>function returning itself</i>  =  <i>recursive function</i>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1489584025, "post_id": 42810897, "comment_id": 72734042, "body": "The recursive call has an &quot;f&quot; at the end of the name??"}, {"owner": {"reputation": 818, "user_id": 7095889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28dd263cb10743a750eff5b85bb91bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yuriy Ivaskevych", "link": "https://stackoverflow.com/users/7095889/yuriy-ivaskevych"}, "edited": false, "score": 0, "creation_date": 1489584160, "post_id": 42810897, "comment_id": 72734149, "body": "<code>reversePrintf</code> &lt;-- typo ? Did you mean just <code>reversePrint</code> ? In this case - <a href=\"http://ideone.com/5Z9Spq\" rel=\"nofollow noreferrer\">cannot reproduce</a>"}, {"owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "edited": false, "score": 0, "creation_date": 1489738921, "post_id": 42810897, "comment_id": 72811746, "body": "thanks guys, i&#39;ve notice the return function name was wrong, but now i wrote it without calling the function."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1489739001, "post_id": 42810897, "comment_id": 72811798, "body": "<code>x &gt; UINT_MAX</code> can never be true. Also the scanf should test <code>== 1</code>, not <code>!= EOF</code>."}, {"owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "edited": false, "score": 0, "creation_date": 1489739249, "post_id": 42810897, "comment_id": 72811930, "body": "now i  enter certain unsigned int, ex: 4294967294, the reverse number is 4927694924, which exceed UINT_MAX, causing over flow problem, i dont know how to solve this over flow problem"}], "answers": [{"comments": [{"owner": {"reputation": 8601, "user_id": 1485885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tdPE1.jpg?s=128&g=1", "display_name": "cbuchart", "link": "https://stackoverflow.com/users/1485885/cbuchart"}, "edited": false, "score": 0, "creation_date": 1489587837, "post_id": 42810939, "comment_id": 72737176, "body": "Also, you are printing the reversed number <b>always</b>."}, {"owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "edited": false, "score": 0, "creation_date": 1489739387, "post_id": 42810939, "comment_id": 72812006, "body": "i notice the problem, and change it a little bit, but now facing over flow problem if the reverse number is greater then INT_MAX"}, {"owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "edited": false, "score": 0, "creation_date": 1489922314, "post_id": 42810939, "comment_id": 72873859, "body": "thanks, you are right, i return the right most digit~"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1489583786, "creation_date": 1489583786, "answer_id": 42810939, "question_id": 42810897, "link": "https://stackoverflow.com/questions/42810897/reverse-an-unsigned-int-number-causing-overflow/42810939#42810939", "title": "reverse an unsigned int number causing overflow", "body": "<p>You never return the reversed number, all you return is the final (rightmost) digit.</p>\n\n<p>And your function doesn't \"return itself\", it returns the result of <em>calling itself</em>, which is not the same.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 0, "last_activity_date": 1489839745, "creation_date": 1489839745, "answer_id": 42874352, "question_id": 42810897, "link": "https://stackoverflow.com/questions/42810897/reverse-an-unsigned-int-number-causing-overflow/42874352#42874352", "title": "reverse an unsigned int number causing overflow", "body": "<p>Your test for overflow is incorrect because you compare the <code>unsigned int result</code> with a value that is larger than the range of this type, so the test always fails.</p>\n\n<p>There are 2 ways to check for overflow:</p>\n\n<ul>\n<li><p>taking advantage of unsigned arithmetics, you can compare is the result is smaller than the previous result.</p></li>\n<li><p>alternately, you can compare if <code>result</code> is larger than <code>UINT_MAX / 10</code> or if it is equal, if digit is larger than <code>UINT_MAX % 10</code>. This method works for all integer types, unsigned and signed.</p></li>\n</ul>\n\n<p>Here is the modified code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void) {\n    unsigned int x;\n\n    printf(\"max unsigned int = %u\\n\\n\", UINT_MAX);\n    printf(\"please enter any unsigned int,\\n\"\n           \"it will show the reverse number if it is in range\\n\"\n            \"(enter 10 digit only)\\n\\n\");\n\n    while (scanf(\"%u\", &amp;x) == 1) {\n        unsigned int temp = x, result = 0;\n        int overflow = 0;\n        while (temp &gt; 0) {\n            unsigned int digit = temp % 10;\n            if (result &gt; UINT_MAX / 10\n            ||  (result == UINT_MAX / 10 &amp;&amp; digit &gt; UINT_MAX % 10)) {\n                overflow++; // the result will not fit\n                break;\n            }\n            result = result * 10 + digit;\n            temp /= 10;\n        }\n        if (overflow)\n            printf(\"out of range for unsigned int type\\n\\n\");\n        else\n            printf(\"result is %u\\n\\n\", result);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1489968448, "post_id": 42882040, "comment_id": 72888900, "body": "The test on the digit is indeed useless for the 32-bit <code>unsigned int</code> case, but it would be necessary for the 16-bit unsigned int case: <code>63556</code> causes an overflow, but not <code>53556</code>.  The test in 2 parts is completely generic, trying to reduce it for special cases is error prone."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1489968679, "post_id": 42882040, "comment_id": 72888962, "body": "For the signed int code, the test <code>while (temp &gt;= INT_MIN || temp &lt;= INT_MAX)</code> is always true. For the positive case, the code is essentially the same as that of the unsigned case.  For the negative case, it is more tricky: I would suggest computing as unsigned and negating the result at the end."}], "tags": [], "owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "is_accepted": false, "score": 0, "last_activity_date": 1489922168, "last_edit_date": 1489922168, "creation_date": 1489888149, "answer_id": 42882040, "question_id": 42810897, "link": "https://stackoverflow.com/questions/42810897/reverse-an-unsigned-int-number-causing-overflow/42882040#42882040", "title": "reverse an unsigned int number causing overflow", "body": "<p>Thanks for your answer, much appreciated!\n1. Regarding to \"compare if result is larger than UINT_MAX / 10 or if it is equal, if digit is larger than UINT_MAX % 10. This method works for all integer types, unsigned and signed.\"</p>\n\n<p>Is  (result == UINT_MAX / 10 &amp;&amp; digit > UINT_MAX % 10)) necessary?\nI assume input below digits\n(reminder: only enter digit within UINT_MAX)</p>\n\n<ul>\n<li>unsigned int  4294967295 (10digit), reverse will be 592769492(4) /out\nrange</li>\n<li><p>unsigned int  4294967294 (10digit), reverse will be    492769492(4)\n/out range</p></li>\n<li><p>unsigned int  4227694924 (10digit), reverse will be 429496722(4) / in\nrange </p></li>\n<li><p>unsigned int  927694924(9digit), reverse will be 429496729 / in\nrange</p></li>\n<li><p>the closest input is 3927694924 i can think of, and it will fit (result == UINT_MAX / 10 &amp;&amp; digit > UINT_MAX % 10)) / in range</p></li>\n</ul>\n\n<p>However, I've done the same for signed int, please see the code at below, but im not sure how to apply your method of signed int:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void) {\n    int x;\n\n    printf(\"max int = %d\\n\", INT_MAX);\n    printf(\"min int = %d\\n\\n\", INT_MIN);\n\n    printf(\"please enter any integer within -2,147,483,648 ~ 2,147,483,647,\\n\"\n           \"it will show the reverse number if it is in range\\n\"\n            \"(enter 10 digit or less)\\n\\n\");\n\n    while (scanf(\"%d\", &amp;x) == 1) {\n        int temp = x, result = 0;\n        int overflow = 0;\n        while (temp &gt;= INT_MIN || temp &lt;= INT_MAX) {\n            int digit = temp % 10;\n            printf(\"temp is %u\\n\", temp);\n            printf(\"result is %u\\n\", result);\n            if (result &gt; INT_MAX / 10 || (result == INT_MAX / 10 &amp;&amp; digit &gt; INT_MAX % 10)) {\n                overflow++; // the result will not fit\n                break;\n            }\n            if (result &lt; INT_MIN / 10 || (result == INT_MIN / 10 &amp;&amp; digit &gt; INT_MIN % 10)) {\n                overflow++; // the result will not fit\n                break;\n            }\n            result = result * 10 + digit;\n            temp /= 10;\n            if(temp == 0) break;\n        }\n        if (overflow)\n            printf(\"out of range for int type\\n\\n\");\n        else\n            printf(\"result is %d\\n\\n\", result);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7715019, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10155154515814375/picture?type=large", "display_name": "LingLing Ling", "link": "https://stackoverflow.com/users/7715019/lingling-ling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 42874352, "answer_count": 3, "score": -3, "last_activity_date": 1490076196, "creation_date": 1489583676, "last_edit_date": 1490076196, "question_id": 42810897, "link": "https://stackoverflow.com/questions/42810897/reverse-an-unsigned-int-number-causing-overflow", "title": "reverse an unsigned int number causing overflow", "body": "<p>Enter a unsigned int, reverse it and see if its' still in range, if it is, print the reverse number, if not, print your number is out of range </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; \n#include &lt;limits.h&gt;\n\nint main() {\n    unsigned int a = UINT_MAX; // 0xffff\n    printf(\"max unsigned int = %u\\n\\n\", a);\n\n    unsigned int x = 0;\n    printf(\"please enter any unsigned int,\\nit will show the reverse number if it's in range\\n(enter 10 digit only)\\n\\n\");\n    while (scanf(\"%u\", &amp;x) != EOF) {\n        //printf(\"x =  %u\\n\", x); \n        // above %d will print each UINT's binary oder, ex: enter 4294967292, x = -1 \n        // if change %u, it will print entered number, ex: enter 4294967292, x = 4294967292 \n        unsigned int temp = x, result = 0;\n        int m = 0;\n        while (temp &gt; 0) {\n            unsigned int digit = temp % 10;\n            if (result &gt; 429496729) {\n                m++; //if reversed 9digits is already bigger 429496729, \n                //then 'result =  result * 10 + digit', it will have over flow problem.\n            }\n            result = result * 10 + digit;\n            temp /= 10;\n            if (temp == 0) break;\n        }\n        printf(\"m=%d\\n\", m);\n        if (m &gt;= 1)\n            printf(\"out of range\\n\");\n        else\n            printf(\"result is %u\\n\", result);\n\n        printf(\"\\n\");       \n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "aes"], "owner": {"reputation": 11, "user_id": 7714942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gnOd72MuPxM/AAAAAAAAAAI/AAAAAAAAEKA/7Br1uTUtJ0s/photo.jpg?sz=128", "display_name": "Dwi Pratama Arijaya", "link": "https://stackoverflow.com/users/7714942/dwi-pratama-arijaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489582960, "creation_date": 1489582960, "question_id": 42810590, "link": "https://stackoverflow.com/questions/42810590/libsrtp-using-another-aes-mode", "title": "LibSRTP using another AES mode", "body": "<p>libsrtp is using AES GCM for encrypt media, and i'm trying to use another AES to encrypt my media like AES OFB.<br/>\nhere is the libsrtp repo: <a href=\"https://github.com/cisco/libsrtp\" rel=\"nofollow noreferrer\">https://github.com/cisco/libsrtp</a><br/></p>\n\n<pre><code>static srtp_err_status_t srtp_aes_gcm_openssl_encrypt (void *cv, unsigned char *buf, unsigned int *enc_len)\n{\n    srtp_aes_gcm_ctx_t *c = (srtp_aes_gcm_ctx_t *)cv;\n    if (c-&gt;dir != srtp_direction_encrypt &amp;&amp; c-&gt;dir != srtp_direction_decrypt) {\n        return (srtp_err_status_bad_param);\n    }\n\n    /*\n     * Encrypt the data\n     */\n    EVP_Cipher(c-&gt;ctx, buf, buf, *enc_len);\n\n    return (srtp_err_status_ok)\n}\n</code></pre>\n\n<p>Should i change the existing AES GCM to AES OFB? Where should i start changing then?<br/>\nAny suggestion?  </p>\n"}, {"tags": ["c", "semaphore", "race-condition", "critical-section"], "comments": [{"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1489583206, "post_id": 42810378, "comment_id": 72733412, "body": "Good ol&#39; SysV semaphores .. you might want to take a look at <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/semaphore.h.html\" rel=\"nofollow noreferrer\"><code>semaphore.h</code></a> to make this a little simpler .. however, if <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/semget.html\" rel=\"nofollow noreferrer\"><code>semget</code></a> fails, <i>then</i> you try to get it again (<code>if(semID == -1) {...if ((semID = semget...</code>) .. is that your intent?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1489583237, "post_id": 42810378, "comment_id": 72733441, "body": "Any reason you&#39;re not using a mutex instead?"}, {"owner": {"reputation": 1054, "user_id": 2000945, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/46yyu.jpg?s=128&g=1", "display_name": "Kranthi Kumar", "link": "https://stackoverflow.com/users/2000945/kranthi-kumar"}, "reply_to_user": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1489583385, "post_id": 42810378, "comment_id": 72733569, "body": "@txtechhelp It is not failing for me in semget. Both processes are executing critical section. I want to know where was I going wrong."}, {"owner": {"reputation": 1054, "user_id": 2000945, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/46yyu.jpg?s=128&g=1", "display_name": "Kranthi Kumar", "link": "https://stackoverflow.com/users/2000945/kranthi-kumar"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1489583497, "post_id": 42810378, "comment_id": 72733665, "body": "@dbush I thought it is better to use semaphores when it is across processes. Did not try with mutex. I always used mutexes for threads. Even if I use mutex and it fixes my code I still want to know why this semaphore thing is not working the way I wanted. Do you have some info on how to use mutexes for processes ? Is it same as threads ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1489583609, "post_id": 42810378, "comment_id": 72733745, "body": "Actually, I didn&#39;t initially catch the multiple process part.  Haven&#39;t tried using mutexes that way before."}, {"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1489605803, "post_id": 42810378, "comment_id": 72749543, "body": "I&#39;m more familiar with POSIX semaphores, but based on the <a href=\"http://man7.org/linux/man-pages/man2/semget.2.html\" rel=\"nofollow noreferrer\">docs</a> and the code you&#39;ve posted it&#39;s unclear where the issue might reside; chances are in how the IPC is being initialized elsewhere in your code. To that, if you&#39;re just trying to lock a file, why not use <a href=\"https://linux.die.net/man/2/flock\" rel=\"nofollow noreferrer\">flock</a>?"}], "owner": {"reputation": 1054, "user_id": 2000945, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/46yyu.jpg?s=128&g=1", "display_name": "Kranthi Kumar", "link": "https://stackoverflow.com/users/2000945/kranthi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489582367, "creation_date": 1489582367, "question_id": 42810378, "link": "https://stackoverflow.com/questions/42810378/semaphore-not-locking-the-process-and-instead-proceeding-and-executing-critical", "title": "Semaphore not locking the process and instead proceeding and executing critical section", "body": "<p>I have 2+processes where both where the processes write logs of the processes into a file. To maintain syncrhonization I planned to used semaphores to make the process till when one guy is executing in the critical section. Below are the code snippets of the functions I used. </p>\n\n<pre><code>static int createAndInitializeSemphore()\n{\n       int                        rv                                = SUCCESS;\n       FILE*                fptr                       = NULL;\n#ifdef DEBUG\n       char          szDbgMsg[256] = \"\";\n#endif\n\n       printf( \"%s: --- enter ---\", __FUNCTION__);\n\n\n       while(1)\n       {\n              if(doesFileExist(MESSAGE_KEY_FILE) != SUCCESS)\n              {\n                     printf(  \"%s: %s File doesnt exist Creating It\", __FUNCTION__, MESSAGE_KEY_FILE);\n\n\n                     fptr = fopen(MESSAGE_KEY_FILE, \"w\");\n                     if(fptr == NULL )\n                     {\n                           printf(  \"%s: Could Not Open the File\", __FUNCTION__);\n\n\n                           return FAILURE;\n                     }\n\n                     fprintf(fptr, \"SCA APP LOG APP\\n\");\n                     fclose(fptr);\n              }\n\n              if( (semKey = ftok(MESSAGE_KEY_FILE, 'B')) == -1 )\n              {\n                     printf( \"%s: FAILED to generate Semaphore key\", __FUNCTION__);\n\n                     printf( \"%s: Something went wrong ftok(): %s, errno=%d\", __FUNCTION__, strerror(errno), errno);\n\n                     rv = FAILURE;\n                     break;\n              }\n\n              printf( \"%s: Semaphore key[%d]\", __FUNCTION__, semKey);\n\n\n              semID = semget(semKey, 0, 0);\n\n              if(semID == -1)\n              {\n                     printf( \"%s: semget returned Error: %s, errno=%d\", __FUNCTION__, strerror(errno), errno);\n\n\n                     if ((semID = semget(semKey, 1, IPC_CREAT | 0666)) != -1)\n                     {\n                           printf( \"%s: Semaphore ID Created\", __FUNCTION__);\n\n\n                           arg.val = 1;\n\n                           if(semctl(semID, 0, SETVAL, arg) == -1)\n                           {\n                                  printf( \"%s: semctl returned Error: %s, errno=%d\", __FUNCTION__, strerror(errno), errno);\n\n                                  //What to do now?\n                           }\n                     }\n                     else if(errno == EEXIST)\n                     {\n                           printf( \"%s: semID already exists\", __FUNCTION__);\n\n                     }\n              }\n\n              printf( \"%s: Successfully Created Application Log Message Queue\",__FUNCTION__);\n\n              break;\n       }\n\n       printf( \"%s: Returning[%d]\", __FUNCTION__, rv);\n\n\n       return rv;\n}\n\nstatic void lockSemaphore()\n{\n#ifdef DEBUG\n       char   szDbgMsg[128] = \"\";\n#endif\n\n       struct sembuf sbuf;\n\n       sbuf.sem_flg = SEM_UNDO;\n       sbuf.sem_num = 0;\n       sbuf.sem_op = -1;\n\n       if(semop(semID, &amp;sbuf, 1) == -1)\n       {\n              printf( \"%s: Failed to Lock Semaphore Id[%d]: %s, errno=%d\", __FUNCTION__, semID, strerror(errno), errno);\n\n       }\n\n       return;\n}\n\nstatic void unlockSemaphore()\n{\n#ifdef DEBUG\n       char   szDbgMsg[128] = \"\";\n#endif\n\n       struct sembuf sbuf ;\n\n       sbuf.sem_flg = 0;\n       sbuf.sem_num = 0;\n       sbuf.sem_op = 1;\n\n       if(semop(semID, &amp;sbuf, 1) == -1)\n       {\n              printf( \"%s: Failed to Un-Lock Semaphore Id[%d]: %s, errno=%d\", __FUNCTION__, semID, strerror(errno), errno);\n\n       }\n\n       return;\n}\n</code></pre>\n\n<p>createAndInitializeSemaphore will be called each process only once at the startup. Suppose if we have two processes P1 and P2, both writes logs into a file called log.txt.Below is the code how it looks like for both processes while writing logs into the file: </p>\n\n<pre><code>lockSemaphore();\n\n/* code for opening the log file writing the logs and the close the file*/\n\nunlockSemaphore();\n</code></pre>\n\n<p>But it is not working as expected. Even when P1 acquired the lock and executing the critical section P2 is also able to acquire the and executing in the critical section and file is getting corrupted. Could you please help where I am doing wrong ? </p>\n"}, {"tags": ["c", "sorting", "qsort"], "comments": [{"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1489582168, "post_id": 42810022, "comment_id": 72732617, "body": "shouldnt it be <code>sizeof(*Date)</code>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 1, "creation_date": 1489582224, "post_id": 42810022, "comment_id": 72732653, "body": "@PeterMiehle That&#39;s a syntax error. :) Perhaps you meant <code>sizeof (Date *)</code>."}, {"owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "edited": false, "score": 0, "creation_date": 1489583176, "post_id": 42810022, "comment_id": 72733379, "body": "upps sorry, too much golang"}], "answers": [{"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1489582568, "post_id": 42810417, "comment_id": 72732909, "body": "To clarify the last paragraph: <code>Date* date1 = (Date*)a;</code> should be <code>Date* date1 = *(Date**)a;</code>"}, {"owner": {"reputation": 33, "user_id": 5577652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632427dfcc7721d5d452ece553328b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Jojko", "link": "https://stackoverflow.com/users/5577652/jojko"}, "edited": false, "score": 0, "creation_date": 1489584309, "post_id": 42810417, "comment_id": 72734252, "body": "Yeah, it works, Thank you! Can you explain me how these how this change in <code>compare</code> function work? It is so confusing for me"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 4, "last_activity_date": 1489744461, "last_edit_date": 1489744461, "creation_date": 1489582485, "answer_id": 42810417, "question_id": 42810022, "link": "https://stackoverflow.com/questions/42810022/qsort-returns-wrong-scrambled-numbers-in-cmp-function/42810417#42810417", "title": "QSort returns wrong (scrambled?) numbers in cmp function", "body": "<p>This:</p>\n\n<pre><code>qsort(dates[0], *date_num, sizeof(Date), compare);\n</code></pre>\n\n<p>is wrong, if you want to sort <code>dates</code> then pass <code>dates</code> to <code>qsort()</code>, not its first element. Also the size you want to sort is the size of a pointer, i.e. <code>sizeof (Date *)</code>, or ever better <code>sizeof *dates</code>.</p>\n\n<p>Further, your comparison function fails to take into account that it will be passed pointers to elements of <code>dates</code>, i.e. pointers to pointers to <code>Date</code>. This means it should start:</p>\n\n<pre><code>static int compare(const void* a, const void* b){\n    const Date * const date1 = *(const Date**) a;\n    const Date * const date2 = *(const Date**) b;\n</code></pre>\n\n<p>Again, this change is needed since the comparison function to <code>qsort()</code> is passed two pointers to elements in the array that is getting sorted. That's a reasonable thing to pass, it can't pass the elements themselves (it doesn't know their types), but a <code>const void *</code> can point at any kind of data. Since your array elements are of type <code>Date *</code> (pointer to <code>Date</code>), that means the actual values sent to <code>compare()</code> are pointers to pointers to <code>Date</code> (i.e. <code>Date **</code>).</p>\n\n<p>Finally, there's no point in dropping <code>const</code> inside it, so don't do that.</p>\n"}], "owner": {"reputation": 33, "user_id": 5577652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/632427dfcc7721d5d452ece553328b5b?s=128&d=identicon&r=PG&f=1", "display_name": "Jojko", "link": "https://stackoverflow.com/users/5577652/jojko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 42810417, "answer_count": 1, "score": 2, "last_activity_date": 1489744461, "creation_date": 1489581561, "question_id": 42810022, "link": "https://stackoverflow.com/questions/42810022/qsort-returns-wrong-scrambled-numbers-in-cmp-function", "title": "QSort returns wrong (scrambled?) numbers in cmp function", "body": "<p>I want to use QSort in my program to sort elements in the pointer to pointers to struct. The first element is ok but then it is messed up. The function seems to read some elements but in wrong order / position.</p>\n\n<p>Here is my code</p>\n\n<pre><code>...\n\ntypedef struct Date {\n    int day;\n    int month;\n    int year;\n} Date;\n\n...\n\n// Sorts the date date_num - the number of entered dates, dates - pointer to pointers to structs of dates\nvoid sort_dates(int* date_num, Date** dates){\n\n    // Normalize the year\n    int d; // The date\n    for(d=0;d&lt;*date_num;d++){\n        if(dates[d]-&gt;year &gt;= 90 &amp;&amp; dates[d]-&gt;year &lt;= 99){\n            dates[d]-&gt;year = (dates[d]-&gt;year)+1900;\n        } else{\n            dates[d]-&gt;year = (dates[d]-&gt;year)+2000;\n        }\n    }\n\n    qsort(dates[0], *date_num, sizeof(Date), compare);\n\n}\n\nint compare(const void* a, const void* b){\n\n    Date* date1 = (Date*)a;\n    Date* date2 = (Date*)b;\n\n    // Concatenate year, month and day\n    long num1 = date1-&gt;year;\n    long num2 = date2-&gt;year;\n\n    // Concatenate month\n    num1 = num1*100+(date1-&gt;month);\n    num2 = num2*100+(date2-&gt;month);\n\n    // Concatenate day\n    num1 = num1*100+(date1-&gt;day);\n    num2 = num2*100+(date2-&gt;day);\n\n    printf(\"num1 = %d %d %d, num2 = %d %d %d\\n\", date1-&gt;year, date1-&gt;month, date1-&gt;day, date2-&gt;year, date2-&gt;month, date2-&gt;day);\n\n    //return (num2 - num1);\n    return 0; // Sorting Temporarily disabled\n\n}\n</code></pre>\n\n<p>After input:</p>\n\n<pre><code>January 1 01\nJanuary 1 00\nFebruary 28 99\nJuly 17 12\nSeptember 10 12\nJuly 1 00\nJune 30 90\nAugust 25 06\nMay 27 08\nOctober 1 03\n</code></pre>\n\n<p>The program converts month names to numbers and stores dates in <code>Date** dates</code> . After executing this I expect something like this in format\n<code>num1 = year month day, num2=year month day</code> :</p>\n\n<pre><code>num1 = 2001 1 1, num2 = 2012 9 10\nnum1 = 2012 9 10, num2 = 2000 7 1\n...\n</code></pre>\n\n<p>But it actually returns something like that:</p>\n\n<pre><code>num1 = 2001 1 1, num2 = 0 0 0\nnum1 = 0 2000 1, num2 = 33 0 0\nnum1 = 1 0 33, num2 = 0 2000 1\nnum1 = 2001 1 1, num2 = 1 0 33\nnum1 = 0 0 0, num2 = 1 0 33\nnum1 = 2 28 0, num2 = 0 0 1999\nnum1 = 2012 7 17, num2 = 0 0 0\nnum1 = 0 33 0, num2 = 2012 7 17\nnum1 = 2 28 0, num2 = 0 33 0\nnum1 = 0 0 1999, num2 = 0 33 0\nnum1 = 2001 1 1, num2 = 2 28 0\nnum1 = 0 0 0, num2 = 2 28 0\nnum1 = 1 0 33, num2 = 2 28 0\nnum1 = 0 2000 1, num2 = 2 28 0\nnum1 = 33 0 0, num2 = 2 28 0\n</code></pre>\n\n<p>I suspect that there could be a problem with the size of each block to be sorted as ex. year is in some elements at wrong position (different than first) but logically it seems to be right. </p>\n"}, {"tags": ["c", "assembly", "raspberry-pi", "raspbian", "inline-assembly"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489581072, "post_id": 42809752, "comment_id": 72731780, "body": "What is the reason to use inline assembly to basically declare a global variable as an array of characters? This could easily have been done with a global variable <code>char file[] = &quot;&#47;dev&#47;mem&quot;;</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489581233, "post_id": 42809752, "comment_id": 72731899, "body": "As for your problem, the error message doesn&#39;t match the code you show. The error message mentions <code>.size</code> which is not in your code. Also, are you sure you want to use a leading dot for the label?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1489581300, "post_id": 42809752, "comment_id": 72731940, "body": "Lastly, what compiler are you using? Which version of it?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1489581595, "post_id": 42809752, "comment_id": 72732145, "body": "Shouldn&#39;t it also be <code>.section .data</code> instead of just <code>.data</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "edited": false, "score": 0, "creation_date": 1489581616, "post_id": 42809752, "comment_id": 72732166, "body": "I don&#39;t have any reference to &#39;.size&#39; in my program at all which is why the error message confuses me and the complier is gcc (Debian 4.6.3- 14+rpi1)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "edited": false, "score": 0, "creation_date": 1489581704, "post_id": 42809752, "comment_id": 72732244, "body": "I&#39;ll try the C variable the now thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "edited": false, "score": 0, "creation_date": 1489581785, "post_id": 42809752, "comment_id": 72732310, "body": "I just tried with &#39;.section .data&#39; but it didn&#39;t solve anything. Thanks for informing me of the correct syntax though."}], "answers": [{"tags": [], "owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "is_accepted": false, "score": 1, "last_activity_date": 1489934239, "creation_date": 1489934239, "answer_id": 42887820, "question_id": 42809752, "link": "https://stackoverflow.com/questions/42809752/cant-declare-data-in-inline-assembly/42887820#42887820", "title": "Can&#39;t declare .data in inline assembly", "body": "<p>You don't restore the section before the end of the inline assembly, and gcc generate code that relies on inline assembly not changing the current section.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5510766"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489934239, "creation_date": 1489580885, "question_id": 42809752, "link": "https://stackoverflow.com/questions/42809752/cant-declare-data-in-inline-assembly", "title": "Can&#39;t declare .data in inline assembly", "body": "<p>Hello I have a problem where I can't seem to declare .data . I've tried various different things with my code and it always seems to break at this part</p>\n\n<pre><code>    asm(\n       \".data\\n\"\n       \".file:  .ascii \\\"/dev/mem\\\\000\\\"\\n\"\n    );\n</code></pre>\n\n<p>I can also remove any information after the .data and it will still break at '.data'. This is done on a raspberry pi 2 with inline assembly on C. If the rest of the code is relevant let me know but I'm pretty sure it's not. Thanks for any help!</p>\n\n<p>Edit: Apologies I forgot to include the error message</p>\n\n<p>\"ERROR: .size expression for 'method name here' does not evaluate to a constant</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7713294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a467bb29af15225581e841ea0ef33c?s=128&d=identicon&r=PG&f=1", "display_name": "Saras", "link": "https://stackoverflow.com/users/7713294/saras"}, "edited": false, "score": 0, "creation_date": 1489654072, "post_id": 42828558, "comment_id": 72768250, "body": "Yes, you are right, i am going to build FPGA. For that i am learning and practicing C codes in HLS. Please suggest me which Program Language is best to build FPGA."}, {"owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "reply_to_user": {"reputation": 15, "user_id": 7713294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a467bb29af15225581e841ea0ef33c?s=128&d=identicon&r=PG&f=1", "display_name": "Saras", "link": "https://stackoverflow.com/users/7713294/saras"}, "edited": false, "score": 0, "creation_date": 1489655065, "post_id": 42828558, "comment_id": 72768902, "body": "Saras, if the answer was helpful please accept it (with the tic where you can vote up my answer: it will become green). To start with HLS use this link: <a href=\"https://www.xilinx.com/support/documentation/sw_manuals/xilinx2016_4/ug871-vivado-high-level-synthesis-tutorial.pdf\" rel=\"nofollow noreferrer\">xilinx.com/support/documentation/sw_manuals/xilinx2016_4/&hellip;</a>. Try to replicate everything!!"}], "tags": [], "owner": {"reputation": 3669, "user_id": 5078576, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gwGt0.jpg?s=128&g=1", "display_name": "Leos313", "link": "https://stackoverflow.com/users/5078576/leos313"}, "is_accepted": false, "score": 0, "last_activity_date": 1489652130, "creation_date": 1489652130, "answer_id": 42828558, "question_id": 42809103, "link": "https://stackoverflow.com/questions/42809103/vivado-hls-coding-compilation-error/42828558#42828558", "title": "Vivado Hls-Coding Compilation Error", "body": "<p>Ok, with HLS you are building HW on FPGA. This HW can exist if there are some inputs and some outputs. In this case, your C code cannot be translated in RTL: your box will have no input-output buses and will be not able to interact with the surrounding world. Also, if you read the ERROR is saying: \"<strong>Port has no Fanin or fanout and is left dangling.</strong>\"</p>\n"}], "owner": {"reputation": 15, "user_id": 7713294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a467bb29af15225581e841ea0ef33c?s=128&d=identicon&r=PG&f=1", "display_name": "Saras", "link": "https://stackoverflow.com/users/7713294/saras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 862, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489652130, "creation_date": 1489579072, "last_edit_date": 1489579369, "question_id": 42809103, "link": "https://stackoverflow.com/questions/42809103/vivado-hls-coding-compilation-error", "title": "Vivado Hls-Coding Compilation Error", "body": "<p>During simulation, i am getting this error code : \"csim_design\" failed :nonzero return value &amp;&amp; \u201cPort has no Fanin or fanout and is left dangling.  Please check my code, TOP FUNCTION Name: Trail_NTB, and if it wrong please correct it </p>\n\n<pre><code>void Trail_NTB()\n{\n   int static numbers[]={1,2,3,4,5};\n   int i,result;\n   for(i=0;i&lt;=4;i++);\n   {\n       result=numbers[i];\n   }\n}\n</code></pre>\n"}, {"tags": ["c", "file-descriptor"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1489578743, "post_id": 42808661, "comment_id": 72730146, "body": "It&#39;s not very clear what you&#39;re asking - what do you mean by &quot;stdin-like&quot;?"}, {"owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1489580315, "post_id": 42808661, "comment_id": 72731260, "body": "@ChrisTurner when you read something from stdin you read it only once, not endlessly because stdin &quot;deletes&quot;/&quot;cleans&quot; it (I don&#39;t know exactly how it works) once it has been read"}], "answers": [{"tags": [], "owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489579281, "creation_date": 1489579281, "answer_id": 42809190, "question_id": 42808661, "link": "https://stackoverflow.com/questions/42808661/create-file-descriptor-that-replaces-stdin-in-select/42809190#42809190", "title": "Create file descriptor that replaces stdin (in select())", "body": "<p>Yes. You can use pipes for this: <a href=\"https://linux.die.net/man/2/pipe\" rel=\"nofollow noreferrer\">https://linux.die.net/man/2/pipe</a></p>\n\n<p>Or FIFOs: <a href=\"https://linux.die.net/man/3/mkfifo\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/mkfifo</a>\nUsing FIFOs will create a file in the filesystem which can be opened by the client and server process to communicate through.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489582852, "post_id": 42809831, "comment_id": 72733132, "body": "I already tried to replace it by <code>write</code> but it appears <code>FD_ISSET</code> (<a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/select.2.html</a>) doesn&#39;t accept it"}, {"owner": {"reputation": 31, "user_id": 7246752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804381bc6c3f781d615e058787c9fbee?s=128&d=identicon&r=PG&f=1", "display_name": "tfontain", "link": "https://stackoverflow.com/users/7246752/tfontain"}, "reply_to_user": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489584207, "post_id": 42809831, "comment_id": 72734178, "body": "You mean doing FD_ISSET(0, set) ?"}, {"owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489584400, "post_id": 42809831, "comment_id": 72734311, "body": "yes but by replacing the 0 (because I don&#39;t want keyboard input) by anything else (like another file descriptor)"}, {"owner": {"reputation": 31, "user_id": 7246752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804381bc6c3f781d615e058787c9fbee?s=128&d=identicon&r=PG&f=1", "display_name": "tfontain", "link": "https://stackoverflow.com/users/7246752/tfontain"}, "reply_to_user": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489585012, "post_id": 42809831, "comment_id": 72734817, "body": "Using stdin don&#39;t mean you forced to use your keyboard ; you can simply write into it with the function write() like I showed. But if by &quot;keyboard input&quot; you mean &quot;standard input&quot; - so you don&#39;t want to use the stdin - you should create a filedescriptor by opening an existing file or by creating a file. If you wants this file to have the same behavior than the stdin, you should look at lseek function, with SEEK_END to place the offset at the end and to read in this location."}, {"owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489588376, "post_id": 42809831, "comment_id": 72737582, "body": "I tried to write like that but <code>FD_ISSET()</code> doesn&#39;t work, even with a custom file descriptor. Thank for lseek, I&#39;m going to check it"}], "tags": [], "owner": {"reputation": 31, "user_id": 7246752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804381bc6c3f781d615e058787c9fbee?s=128&d=identicon&r=PG&f=1", "display_name": "tfontain", "link": "https://stackoverflow.com/users/7246752/tfontain"}, "is_accepted": false, "score": 0, "last_activity_date": 1489581087, "creation_date": 1489581087, "answer_id": 42809831, "question_id": 42808661, "link": "https://stackoverflow.com/questions/42808661/create-file-descriptor-that-replaces-stdin-in-select/42809831#42809831", "title": "Create file descriptor that replaces stdin (in select())", "body": "<p>If I understood correctly, you want to communicate to a program who can only read on the stdin.\nYou have two ways to write in the stdin : the first way is to use your keyboard, and the second way is to use <code>write()</code>.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nint         main(void)\n{\n    char    *s = \"what you want to write\";\n    write(STDIN_FILENO, s, strlen(s));\n    return (0);\n}\n</code></pre>\n\n<p>This program will write on the stdin, in the same way you would write with your keyboard. Besides, you will see the string printed on your command-line interface.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489586744, "post_id": 42811243, "comment_id": 72736239, "body": "Ho yes it works thank you, it doesn&#39;t read &quot;test&quot; for ever but .. when I update the fd by writing &quot;tess&quot; in, it keeps reading anything. It only reads &quot;tess&quot; if I <code>CTRL+C</code> and relaunch it"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 0, "last_activity_date": 1489584609, "creation_date": 1489584609, "answer_id": 42811243, "question_id": 42808661, "link": "https://stackoverflow.com/questions/42808661/create-file-descriptor-that-replaces-stdin-in-select/42811243#42811243", "title": "Create file descriptor that replaces stdin (in select())", "body": "<p>The problem isn't that you're reading in \"test\" constantly, it's that you're not handling the call to <code>read()</code> properly. Whilst you're checking that it's not returning an error, you're not seeing how many bytes have been read in. <code>read()</code> doesn't null-terminate the string read in, so you should actually store the return value and use that to put the NUL in your buffer. Otherwise, since nothing in the buffer is changing, it'll appear as if you're re-reading the same text over and over.</p>\n\n<pre><code>    int err=read(fd, buffer, 4);\n    if(err &lt; 0)\n        {\n        fprintf(stderr, \"read %s\\n\", strerror(errno));\n        }\n    else\n        {\n        buffer[err]='\\0';\n        }\n</code></pre>\n\n<p>If you make this change, you'll find that you only ever read in \"test\" once and after that you're not reading anything more in.</p>\n\n<p>Note: You don't need the calls to <code>dup2()</code> - that's just for copying a file descriptor to known value. You can just use <code>fd</code> as is in your calls to read/write data.</p>\n"}], "owner": {"reputation": 107, "user_id": 7230462, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ec72ca053363dcc9636fad0e77ec4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7230462/rapha%c3%abl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 627, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489584609, "creation_date": 1489577858, "last_edit_date": 1495535394, "question_id": 42808661, "link": "https://stackoverflow.com/questions/42808661/create-file-descriptor-that-replaces-stdin-in-select", "title": "Create file descriptor that replaces stdin (in select())", "body": "<p>Having in mind to communicate with a multi-client Unix domain socket without keyboard input, I want to create a file descriptor that replaces stdin.</p>\n\n<p>With a multi-client socket, you have to add the stdin's file descriptor (which is 0, with <code>FD_SET(0, &amp;readfds)</code>) to <a href=\"http://man7.org/linux/man-pages/man2/select.2.html\" rel=\"nofollow noreferrer\">readfds</a> in order to send the keyboard input (<code>FD_ISSET(0, &amp;readfds)</code>) to the server. Since I don't want to write everytime I launch my client, I want to replace this file descriptor by a custom one (by writing to this file from another program).</p>\n\n<p>I checked out <a href=\"https://stackoverflow.com/questions/5935872/create-a-file-descriptor\">Create a file descriptor</a> to create two programs:</p>\n\n<p>One that writes to the file descriptor:</p>\n\n<pre><code>int main() {\n    char buffer[] = \"test\";\n    int fd = open(\"sample.dat\", O_WRONLY | O_CREAT, 0666);\n    dup2(fd, 5);\n\n    if(write(5, buffer, 4) &lt; 0)\n        fprintf(stderr, \"write %s\\n\", strerror(errno));\n\n    close(5);    \n    return 0;\n}\n</code></pre>\n\n<p>And another one that reads from it:</p>\n\n<pre><code>int main() {\n    char buffer[4];\n    int fd = open(\"sample.dat\", O_RDONLY);\n    dup2(fd, 5);\n\n    for(;;) {\n        if(read(5, buffer, 4) &lt; 0)\n            fprintf(stderr, \"read %s\\n\", strerror(errno));\n\n        printf(\"%s\\n\", buffer);\n        sleep(1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>My question is</strong>: is it possible to make this file descriptor as stdin-like ? I mean actually my second program read \"test\" endlessly because (of course) sample.dat still contains \"test\" but I want to delete it once it has been read.</p>\n"}, {"tags": ["c", "graphics", "include"], "comments": [{"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1489576338, "post_id": 42808059, "comment_id": 72728572, "body": "What are you hoping to gain from <code>graphics.h</code>? Is there some API / library that you&#39;re hoping to use? It would be worth mentioning it in your question."}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1489576365, "post_id": 42808059, "comment_id": 72728587, "body": "<code>&lt;graphics.h&gt;</code> is just a random filename - we need more of a clue.  Why do you think you need it?  Please choose C or C++"}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1489576942, "post_id": 42808059, "comment_id": 72728983, "body": "@RichardCritten I&#39;m writing in C!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1489577061, "post_id": 42808059, "comment_id": 72729048, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4881649/how-can-i-add-graphics-h-library-on-my-mac\">How can i add graphics.h library on my mac?</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1489577677, "post_id": 42808059, "comment_id": 72729431, "body": "@AlanTuring then why did you add C++ tag to your question?"}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1489578691, "post_id": 42808059, "comment_id": 72730114, "body": "@MichaelWalz Useless."}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1489578698, "post_id": 42808059, "comment_id": 72730118, "body": "@Attie Useless."}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 1, "creation_date": 1489578783, "post_id": 42808059, "comment_id": 72730168, "body": "@AlanTuring No... your question is useless - do you even know what you&#39;re trying to accomplish by including <code>graphics.h</code>?"}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1489578815, "post_id": 42808059, "comment_id": 72730191, "body": "@Attie Your useless link does not provide me any help or information. Do you want me to write here all the code I&#39;m trying to compile?"}, {"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1489578880, "post_id": 42808059, "comment_id": 72730242, "body": "@AlanTuring a concise example, yes. <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "edited": false, "score": 0, "creation_date": 1489578978, "post_id": 42808059, "comment_id": 72730325, "body": "@AttieDone! The code is above!"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1489579568, "post_id": 42808059, "comment_id": 72730763, "body": "Did you find that code in a museum? I&#39;m pretty sure I recognise those function calls. From 25 years ago from Borland compilers. The way we speak to hardware and the operating system changes over the years. You can&#39;t expect to use a library that worked on one compiler for DOS to work on something more modern. If you want that to work, you need to dig up a compiler and operating system that&#39;s equally old as the code you&#39;re trying to run."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1489580005, "post_id": 42808059, "comment_id": 72731073, "body": "I got curious. I wasn&#39;t that far off with 25 years ago (since that was when I used it). The last product that supported that graphics interface was Borland C++ 5.02 which was released in 1997."}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1489580537, "post_id": 42808059, "comment_id": 72731400, "body": "@Art lol, well I was trying to follow some programs written on the book of Hanly and Koffman &quot;problem solving and programming in C&quot; but it says its from 2013... not that old! o.o"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1489580870, "post_id": 42808059, "comment_id": 72731635, "body": "@AlanTuring Sounds like they just keep reprinting an old book without updating it to more modern interfaces. Or maybe there exists a compatibility layer somewhere that simulates the old Borland Graphics Interface on some more modern compilers. There is no graphics interface that will work on all operating systems. The closest you can get is OpenGL or SDL. You can google tutorials for those. Or wait a bit until you learn more and stay with text output for now."}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1489580898, "post_id": 42808059, "comment_id": 72731650, "body": "@Art Thank you!!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489581069, "post_id": 42808059, "comment_id": 72731778, "body": "BGI graphics were still used until the late 1990s, but then mostly for student purposes, as professionals were then moving over to Windows graphics."}, {"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1489582503, "post_id": 42808059, "comment_id": 72732840, "body": "@Art The problem is: how to write a &quot;modern&quot; code for that?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1489583232, "post_id": 42808059, "comment_id": 72733439, "body": "<a href=\"https://www.cs.colorado.edu/~main/bgi/doc/\" rel=\"nofollow noreferrer\">Find out what each BGI function does</a> and replace with similar functions from modern library. Or use <a href=\"http://libxbgi.sourceforge.net/\" rel=\"nofollow noreferrer\">wrapper library</a> with your modern library (note: I haven&#39;t used linked library)."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "edited": false, "score": 0, "creation_date": 1489582494, "post_id": 42809737, "comment_id": 72732834, "body": "The problem is: how to write a &quot;modern&quot; code for that?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "edited": false, "score": 0, "creation_date": 1489582675, "post_id": 42809737, "comment_id": 72732982, "body": "@AlanTuring Depends on OS, toolchain, graphics library etc, but also what kind of graphics you want to make: user interfaces or 3D stuff."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1489580846, "creation_date": 1489580846, "answer_id": 42809737, "question_id": 42808059, "link": "https://stackoverflow.com/questions/42808059/what-can-i-use-instead-of-includegraphics-h-in-mac-os/42809737#42809737", "title": "What can I use instead of #include&lt;graphics.h&gt; in Mac Os?", "body": "<p><code>graphics.h</code> refers to the non-standard graphics library called BGI, designed by Borland in the year 1989 to be used with Borland compilers for the MS DOS operative system. It is not C standard, it is not portable. It cannot be used on any other system than DOS or early 32 bit Windows (95/98 etc), unless you use emulators.</p>\n\n<p>If you wasted time learning about BGI, you were scammed by your teacher/school. \nAs a beginner, you should forget all about MS DOS graphics and focus on things that are actually used in the real world, in the year 2017.</p>\n"}], "owner": {"reputation": 123, "user_id": 5467916, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/s54EF.png?s=128&g=1", "display_name": "Understanding", "link": "https://stackoverflow.com/users/5467916/understanding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7796, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547270384, "creation_date": 1489576188, "last_edit_date": 1489578965, "question_id": 42808059, "link": "https://stackoverflow.com/questions/42808059/what-can-i-use-instead-of-includegraphics-h-in-mac-os", "title": "What can I use instead of #include&lt;graphics.h&gt; in Mac Os?", "body": "<p>The question is the same above.</p>\n\n<p>Since when I compile my C program it gives me a fatal error (graphics.h not found), I was wondering what I can use instead of it.</p>\n\n<p>Consider that I DO NOT WANT links to other sites or whatever, because I'm a newbie and I wouldn't understand.</p>\n\n<p>I just need the command to type, in order to make it work. If I have to download a library then it's fine, provided you guide me all through the process.</p>\n\n<p>Thanks.</p>\n\n<p><strong>Here is what I am trying to compile</strong></p>\n\n<p>A code to create a smiley.</p>\n\n<pre><code>#include &lt;graphics&gt;\n\nint main(void)\n{\nint midX, midY,\nleftEyeX, rightEyeX, eyeY,\nnoseX, noseY,\nheadRadius,\neyeNoseRadius,\nsmileRadius,\nstepX, stepY,\n\ninitwindow(500, 400, \"Happy Face - press key to close\", 200, 150);\n\nmidX = getmaxx() / 2;\nmidY = getmaxy() / 2;\nheadRadius = getmaxy() / 4;\ncircle(midX, midY, headRadius);\n\nstepX = headRadius / 4;\nstepY = stepX;\nleftEyeX = midX - stepX;\neyeY = midY - stepY;\neyeNoseRadius = headRadius / 10;\ncircle(leftEyeX, eyeY, eyeNoseRadius);\ncircle(rightEyeX, eyeY, eyeNoseRadius);\n\nnoseX = midX;\nnoseY = midY + stepY;\ncircle(noseX, noseY, eyeNoseRadius);\n\nsmileRadius = (int)(0.75*headRadius + 0.5);\narc(midX, midY, 210, 330, smileRadius);\n\ngetch();\nclosegraph();\n\nreturn(0);\n\n}\n</code></pre>\n"}, {"tags": ["c", "if-statement", "char", "fgets", "scanf"], "comments": [{"owner": {"reputation": 5623, "user_id": 1347519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a9e1eb6e25803528d25f57f3df79e115?s=128&d=identicon&r=PG", "display_name": "Attie", "link": "https://stackoverflow.com/users/1347519/attie"}, "edited": false, "score": 0, "creation_date": 1489576664, "post_id": 42808017, "comment_id": 72728796, "body": "Double quotes - <code>&quot;3&quot;</code> - will create a string containing <code>3\\0</code> (that <code>\\0</code> is a nul terminatory - how C knows where the end of the string is). Single quotes - <code>&#39;3&#39;</code> - will place the character&#39;s value in memory - 51."}, {"owner": {"reputation": 2150, "user_id": 3160531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/501097d9d9b4f54f0eff01d859f42901?s=128&d=identicon&r=PG&f=1", "display_name": "charlie_pl", "link": "https://stackoverflow.com/users/3160531/charlie-pl"}, "edited": false, "score": 1, "creation_date": 1489576700, "post_id": 42808017, "comment_id": 72728821, "body": "Just a general suggestion here: separate logic from input/output. How to do that? Create new fuction for example &quot;translateScoreToGrade&quot;, that has integer as input, and struct Grade as an output (char grade, char modifier). It&#39;s much more elegant, and much cleaner to test, and your professor will give you a higher score :)"}, {"owner": {"reputation": 2150, "user_id": 3160531, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/501097d9d9b4f54f0eff01d859f42901?s=128&d=identicon&r=PG&f=1", "display_name": "charlie_pl", "link": "https://stackoverflow.com/users/3160531/charlie-pl"}, "edited": false, "score": 0, "creation_date": 1489577193, "post_id": 42808017, "comment_id": 72729117, "body": "Also you can convert those ifs to switch -&gt; (100 - score)/10, case 0 -&gt;A case 1-&gt;B ... default-&gt;F"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1489592657, "post_id": 42808017, "comment_id": 72741147, "body": "Doesn&#39;t <code>if (plusminus &lt; &quot;3&quot;) {</code> generate a compiler warning? If not, enable all compiler warnings - it saves time."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1489576280, "creation_date": 1489576280, "answer_id": 42808089, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/42808089#42808089", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<p>You are comparing a <em>string</em> with a character. A string literal is a pointer to the actual string array in memory. A character is a small integer.</p>\n\n<p>You should use <em>character</em> literals instead, using <em>single</em> quotes like e.g. <code>'3'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "is_accepted": false, "score": 0, "last_activity_date": 1489576421, "creation_date": 1489576421, "answer_id": 42808145, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/42808145#42808145", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<pre><code>   plusminus = line[1];   \nif (plusminus &lt; '3'&amp;&amp;plusminus!='0') {\n    printf(\"-\");\n}\nif (plusminus &gt; '8'||plusminus=='0') {\n    printf(\"+\");\n}\n</code></pre>\n\n<p>you also need to check for '0' because it is &lt; 3 but it output should be '+' according to the rule .</p>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 1, "last_activity_date": 1489576726, "creation_date": 1489576726, "answer_id": 42808254, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/42808254#42808254", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<p>Since you've already got your score as an <code>int</code>, you could use the modulus operator <code>%</code> to get the remainder of the score divided by 10 which is the same thing as the last digit. </p>\n\n<p>For example:</p>\n\n<pre><code>if((score % 10) &lt;= 3)&amp;&amp;((score % 10) &gt;= 1))\n  {\n  printf(\"-\");\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 232, "user_id": 7440624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PwhR.jpg?s=128&g=1", "display_name": "Steve Bunting", "link": "https://stackoverflow.com/users/7440624/steve-bunting"}, "is_accepted": false, "score": 0, "last_activity_date": 1489576795, "creation_date": 1489576795, "answer_id": 42808282, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/42808282#42808282", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<p>If you want to get the last digit of a base 10 number, use <code>i % 10</code>. Then you can make comparisons to this number using integers rather than characters, which is what you are doing.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5389523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf063891b638566d79824fba353e6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5389523/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1489585891, "creation_date": 1489585891, "answer_id": 42811758, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/42811758#42811758", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<p>You can simplify the first chain of ifs:</p>\n\n<pre><code>// check for conditions\nif (score &lt;= 60) {\n    printf(\"F\");\n} else if (score &lt;= 70) {\n    printf(\"D\");\n} else if (score &lt;= 80) {\n    printf(\"C\");\n} else if (score &lt;= 90) {\n    printf(\"B\");\n} else {\n    printf(\"A\");\n}\n</code></pre>\n\n<p>And handle +/- like this:</p>\n\n<pre><code>if ((score - 1) % 10 &lt; 2) {\n    printf(\"-\");\n} else if ((score - 1) % 10 &gt; 7) {\n    printf(\"+\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8341263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jWLG86rfXnc/AAAAAAAAAAI/AAAAAAAAA4U/DZ_g2e0TKHs/photo.jpg?sz=128", "display_name": "joseph Assefa", "link": "https://stackoverflow.com/users/8341263/joseph-assefa"}, "is_accepted": false, "score": 0, "last_activity_date": 1500594415, "last_edit_date": 1500594415, "creation_date": 1500593007, "answer_id": 45226674, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/45226674#45226674", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main (){\n    int grade=0;\n    printf(\"Enter your grade\\n\");\n    scanf(\"%d\",&amp;grade);\n\n    if (grade&lt;=60) {\n        printf(\"F\\n\");\n    }\n    if (grade&gt;=61^grade&gt;=70) {\n        printf(\"D\\n\");\n    }\n    if (grade&gt;=71^grade&gt;=80) {\n        printf(\"C\\n\");\n    }\n    if (grade&gt;=81^grade&gt;=90) {\n        printf(\"B\\n\");\n    }\n    if (grade&gt;=91^grade&gt;=100) {\n        printf(\"A\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1398, "user_id": 3743152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b86dfb1bb1df3238ef025a6a96d0fc?s=128&d=identicon&r=PG&f=1", "display_name": "Lux", "link": "https://stackoverflow.com/users/3743152/lux"}, "is_accepted": false, "score": 0, "last_activity_date": 1500595072, "creation_date": 1500595072, "answer_id": 45226916, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else/45226916#45226916", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<pre><code>#include &lt;stdlib.h&gt;\n\nchar * scoreToGrade(int);\n\nint main(){\n    int score;\n    printf(\"Enter your score:\");\n    scanf(\"%d\",&amp;score);\n\n    char * grade = scoreToGrade(score);\n\n    printf(\"Grade: %s\\n\", grade);\n}\n\nchar * scoreToGrade(int score){\n    /*\n     * 1 character for the letter\n     * 1 character for the +/- (if it's there, otherwise a terminating\n     * character, and 1 last character if there was a +/- \n     */\n    char * result = malloc(sizeof(char) * 3);\n\n    if(score &lt;= 60){\n        result[0] = 'F';\n    } else if(score &lt;= 70){\n        result[0] = 'D';\n    } else if(score &lt;= 80){\n        result[0] = 'C';\n    } else if(score &lt;= 90){\n        result[0] = 'B';\n    } else {\n        result[0] = 'A';\n    }\n\n    /* Handle plusses and minuses if the grade is not an F */\n    if(result[0] != 'F'){\n        int subscore = (score - 1) % 10;\n        if(subscore &gt;= 7){\n            result[1] = '+';\n        } else if(subscore &lt;= 2){\n            result[1] = '-';\n        } else {\n            result[1] = '\\0'; /* Add a string terminator, making the string one character long */\n        }\n    } else {\n        result[1] = '\\0'; /* Add a string terminator, making the string one character long. This is separate because the 'F' forces a one-character grade */\n    }\n    /* This is stuck on so that if there is a '+' or '-', the string does not go un-terminated. */\n    result[2] = '\\0';\n\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 7350326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IP4Gt.jpg?s=128&g=1", "display_name": "scugn1zz0", "link": "https://stackoverflow.com/users/7350326/scugn1zz0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 42808089, "answer_count": 7, "score": 0, "last_activity_date": 1500595072, "creation_date": 1489576059, "question_id": 42808017, "link": "https://stackoverflow.com/questions/42808017/beginner-c-exercise-sscanf-fgets-if-else", "title": "Beginner C exercise [sscanf - fgets - if else]", "body": "<p>I'm dealing with a beginner C exercise, i've done the first part pretty correct I think (not elegant at all); if a score is inserted the correct mark is outputted. \nBut i Really can't succeed in the last part of the exercise (add plus or minus) and I can't figure out why.\nI really would like to understand why <code>line[1]</code> does not work as expected.</p>\n\n<p>The text of the exercise:\nA professor generates letter grades using the following table:</p>\n\n<pre><code>0\u201360  -&gt; F\n61\u201370 -&gt; D\n71\u201380 -&gt; C\n81\u201390 -&gt; B\n91\u2013100 -&gt; A\n</code></pre>\n\n<p>Given a numeric grade, print the letter.\nNow, modify the previous program to print a + or \u2013 after the letter grade, based on the last digit of the score.\nLast digit Modifier</p>\n\n<pre><code>1\u20133 -&gt; \"\u2013\"\n4\u20137 -&gt; &lt;blank&gt;\n8\u20130 -&gt; \"+\"\n</code></pre>\n\n<p>For example, 81=B-, 94=A, and 68=D+. Note: An F is only an F. There is no F+ or F-.</p>\n\n<p>What I've done:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\nchar line[20];              //prepare the input from keyboard\nint score;\nchar plusminus;\n\nint main() {\n    printf(\"insert your score: \");      // ask for the score\n    fgets(line, sizeof(line), stdin);\n    sscanf(line, \"%d\", &amp;score);\n\n// check for conditions\n    if (score &lt;= 60) {\n        printf(\"F\");\n    }\n    if (score &lt;= 70 &amp;&amp; score &gt;60) {\n        printf(\"D\");\n    }\n    if (score &lt;= 80 &amp;&amp; score &gt;70) {\n        printf(\"C\");\n    }\n    if (score &lt;= 90 &amp;&amp; score &gt;80) {\n        printf(\"B\");\n    }\n    if (score &lt;= 100 &amp;&amp; score &gt;90) {\n        printf(\"A\");\n    }\n\n// plus and minus to the mark, but didn't succed :(\n    plusminus = line[1];\n    if (plusminus &lt; \"3\") {\n        printf(\"-\");\n    }\n    if (plusminus &gt; \"8\") {\n        printf(\"+\");\n    }\n}\n</code></pre>\n\n<p>Thanks to everyone! </p>\n"}, {"tags": ["c++", "c", "winapi", "buffer"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489576212, "post_id": 42807802, "comment_id": 72728471, "body": "Passing <code>pTest</code> with allowed value, in other words something like <code>int pTest; OpenBmpFile((char*)file, (char*)file2, &amp;pTest, hWnd);</code>"}, {"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489577650, "post_id": 42807802, "comment_id": 72729418, "body": "Thank you, for some reason it&#39;s saying &quot;Multiple Selection&quot; even when I open just one .bmp image. :/ I&#39;ve been having this issue for a whole day I&#39;m really sick of it. If only WinAPI can simplify things... though it is an old language after all."}], "answers": [{"comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1489588620, "post_id": 42808868, "comment_id": 72737809, "body": "It should also be hinted at that the <code>szFilePath</code> buffer in OP&#39;s code is way too small for multiple selection result and <code>CommDlgExtendedError()</code> should be called to check condition if buffer is too small."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1489598663, "post_id": 42808868, "comment_id": 72745296, "body": "If you read the documentation for the <code>OFN_ALLOWMULTISELECT</code>  flag, if multiple files are selected, the directory and list of filenames are separated by a NUL character, and <code>nFileOfset</code> points at the first filename, so <code>nFileOffset-1</code> would point at the NUL character after the directory. If a single file is selected, that NUL character is not present."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1489652311, "post_id": 42808868, "comment_id": 72767245, "body": "@Remy Lebeau, small correction: if <code>OFN_ALLOWMULTISELECT</code> is specified, there will always be a terminating double null, also if a single file is selected. If the flag is not specified, there will always be a single filename and no double null. There is never a null character after the directory; <code>nFileOffset</code> just points to the beginning of the filename in the full path and filename."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1489687089, "post_id": 42808868, "comment_id": 72792082, "body": "@PaulOgilvie &quot;<i>There is never a NULL character after the directory</i>&quot; - yes, there is. Clearly you did not read the documentation carefully enough: &quot;<b><i>For Explorer-style dialog boxes, the directory and file name strings are NULL separated</i></b>&quot;. The OP is displaying an Explorer style dialog, and there is a NUL character after the directory when multiple files are selected. I tested it. See the code in my answer."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1489687707, "post_id": 42808868, "comment_id": 72792485, "body": "@PaulOgilvie: in your answer, &quot;<i>to determine if the user has selected more than one file, go to the end of <code>lpstrFile</code> (i.e., to the first null), then check if there is another null following it, if not, then the user selected multiple files</i>&quot; is wrong. If there is a delimiter character located at <code>nFileOffset-1</code>, multiple files are selected, otherwise one file is selected. If <code>OFN_EXPLORER</code> is specified, the delimiter is a null character, otherwise the delimiter is a space character. This is clearly outlined in the documentation."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1489578462, "creation_date": 1489578462, "answer_id": 42808868, "question_id": 42807802, "link": "https://stackoverflow.com/questions/42807802/trouble-separating-data-within-buffer-winapi/42808868#42808868", "title": "Trouble separating data within buffer (WinAPI)", "body": "<p><code>nFileOffset</code> is the offset from the beginning of <code>lpstrFile</code> to the file name:</p>\n\n<blockquote>\n  <p>if <code>lpstrFile</code> points to the following string, <code>\"c:\\dir1\\dir2\\file.ext\"</code>, this member contains the value 13 to indicate the offset of the <code>\"file.ext\"</code> string. If the user selects more than one file, <code>nFileOffset</code> is the offset to the first file name.</p>\n</blockquote>\n\n<p>According to this, <code>szFilePath[ofn.nFileOffset-1]</code> will point to the <code>\\</code>. <code>lpStrFile</code> is defined as:</p>\n\n<blockquote>\n  <p>...If the <code>OFN_ALLOWMULTISELECT</code> flag is set and the user selects multiple files, the buffer contains the current directory followed by the file names of the selected files. For Explorer-style dialog boxes, the directory and file name strings are NULL separated, with an extra NULL character after the last file name.</p>\n</blockquote>\n\n<p>So, to determine if the user has selected more than one file, go to the end of <code>lpstrFile</code> (i.e., to the first null), then check if there is another null following it, if not, then the user selected multiple files.</p>\n\n<p>To construct the full path and filename of each file, reuse the part up to <code>nFileOffset</code> and concatenate each filename. Use a debugger to inspect <code>ofn</code> upon return for all details.</p>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1489594584, "post_id": 42812638, "comment_id": 72742663, "body": "Although I appreciate pointing out the new interface, <i>this is C++</i> and I would like to see the C version."}], "tags": [], "owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "is_accepted": false, "score": 0, "last_activity_date": 1489588145, "creation_date": 1489588145, "answer_id": 42812638, "question_id": 42807802, "link": "https://stackoverflow.com/questions/42807802/trouble-separating-data-within-buffer-winapi/42812638#42812638", "title": "Trouble separating data within buffer (WinAPI)", "body": "<p>Microsoft recommends to use the more modern <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb776913(v=vs.85).aspx\" rel=\"nofollow noreferrer\">Common Item Dialog API</a> (available since Windows Vista) instead of <code>GetOpenFileName().</code></p>\n\n<p>With this API you don't have the hassle of splitting the file name buffer and handle the error condition if the provided buffer is too small (which would require you to call the API again with a bigger buffer). In your code the buffer (szFilePath) is <strong>way too small</strong> for multiple selection result so you will run into this error condition very soon if the user selects many files.</p>\n\n<p>I'll first provide a short example only to show the sequence of API calls for using <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb775834(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>IFileOpenDialog</code></a> with multiple selection. </p>\n\n<h1>Short Example (scroll down for full code)</h1>\n\n<p>For brevity the following code has <strong>no error handling at all</strong>! You should check the HRESULT of each COM API call for failure, which I'll show in the full example after.</p>\n\n<pre><code>// Prepare the file open dialog.\nCComPtr&lt;IFileOpenDialog&gt; dlg;\ndlg.CoCreateInstance( CLSID_FileOpenDialog );\n\ndlg-&gt;SetOptions( fos | FOS_ALLOWMULTISELECT );\n\n// Show the file open dialog.\ndlg-&gt;Show( hwndOwner );\nif( hr == S_OK ) // If user clicked OK button...\n{\n    CComPtr&lt;IShellItemArray&gt; items;\n    dlg-&gt;GetResults( &amp;items );\n\n    DWORD numItems = 0;\n    items-&gt;GetCount( &amp;numItems );\n\n    // Loop over all files selected by the user.\n    for( DWORD i = 0; i &lt; numItems; ++i )\n    {\n        CComPtr&lt;IShellItem&gt; item;\n        items-&gt;GetItemAt( i, &amp;item );\n\n        CComHeapPtr&lt;WCHAR&gt; path;\n        item-&gt;GetDisplayName( SIGDN_FILESYSPATH, &amp;path );\n\n        std::wcout &lt;&lt; std::wstring( path ) &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<h1>Full Example with Error Handling</h1>\n\n<p>The following code shows how to use <code>IFileOpenDialog</code> and how to bridge the gap between C-style error reporting (HRESULT) and the C++ way of doing it (exceptions).</p>\n\n<p>First we define a function <code>ShowFileOpenDialog()</code> that wraps <code>IFileOpenDialog</code> to make it easier to use. It returns a <code>std::vector</code> with the absolute pathes of the files selected by the user. If the user clicks \"cancel\" the vector will be empty. In case of any error it throws a <code>std::system_error</code> exception.</p>\n\n<pre><code>#include &lt;atlbase.h&gt;\n#include &lt;atlcom.h&gt;     // CComHeapPtr\n#include &lt;atlcomcli.h&gt;  // CComPtr\n#include &lt;Shobjidl.h&gt;   // IFileOpenDialog\n#include &lt;system_error&gt;\n#include &lt;vector&gt;\n#include &lt;string&gt;\n\nvoid ThrowOnFail( HRESULT hr, char const* reason )\n{\n    if( FAILED(hr) )\n        throw std::system_error( hr, std::system_category(), std::string(\"Could not \") + reason );\n}\n\nstd::vector&lt;std::wstring&gt; ShowFileOpenDialog( \n    HWND hwndOwner, const std::vector&lt;COMDLG_FILTERSPEC&gt;&amp; filter = {},\n    FILEOPENDIALOGOPTIONS options = 0 )\n{\n    // Using CComPtr to automatically call IFileOpenDialog::Release() when scope ends.\n    CComPtr&lt;IFileOpenDialog&gt; dlg;\n    ThrowOnFail( dlg.CoCreateInstance( CLSID_FileOpenDialog ), \"instanciate IFileOpenDialog\" );\n\n    if( !filter.empty() )\n        ThrowOnFail( dlg-&gt;SetFileTypes( filter.size(), filter.data() ), \"set filetypes filter\" );\n\n    ThrowOnFail( dlg-&gt;SetOptions( options ), \"set options\" );\n\n    HRESULT hr = dlg-&gt;Show( hwndOwner );\n    if( hr == HRESULT_FROM_WIN32(ERROR_CANCELLED) )\n        return {};\n    ThrowOnFail( hr, \"show IFileOpenDialog\");\n\n    CComPtr&lt;IShellItemArray&gt; items;\n    ThrowOnFail( dlg-&gt;GetResults( &amp;items ), \"get results\" );\n\n    DWORD numItems = 0;\n    ThrowOnFail( items-&gt;GetCount( &amp;numItems ), \"get result count\" );\n\n    std::vector&lt;std::wstring&gt; result;\n    result.reserve( numItems );\n\n    for( DWORD i = 0; i &lt; numItems; ++i )\n    {\n        CComPtr&lt;IShellItem&gt; item;\n        ThrowOnFail( items-&gt;GetItemAt( i, &amp;item ), \"get result item\" );\n\n        // Using CComHeapPtr to automatically call ::CoTaskMemFree() when scope ends.\n        CComHeapPtr&lt;WCHAR&gt; path;\n        ThrowOnFail( item-&gt;GetDisplayName( SIGDN_FILESYSPATH, &amp;path ), \"get result item display name\" );\n\n        // Construct std::wstring directly in the vector.\n        result.emplace_back( path );\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>How to call this code and handle the exception:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\nint main()\n{\n    ::CoInitialize(0);  // call once at application startup\n\n    try \n    {\n        HWND hwnd = nullptr;  // In a GUI app, specify handle of parent window instead.\n        auto paths = ShowFileOpenDialog( hwnd, {{ L\"Bitmap Files (*.bmp)\", L\"*.bmp\" }},\n                                         FOS_ALLOWMULTISELECT );\n        if( paths.empty() )\n        {\n            // Cancel button clicked.\n            std::cout &lt;&lt; \"No file(s) selected.\\n\";\n        }\n        else\n        {\n            // OK button clicked.\n            for( const auto&amp; path : paths )\n                std::wcout &lt;&lt; path &lt;&lt; L\"\\n\";\n        }\n    }\n    catch( std::system_error&amp; e )\n    {\n        std::cout \n            &lt;&lt; \"Could not show 'file open dialog'.\"\n            &lt;&lt; \"\\n\\nCause: \" &lt;&lt; e.what()\n            &lt;&lt; \"\\nError code: \" &lt;&lt; e.code() &lt;&lt; \"\\n\";\n    }\n\n    ::CoUninitialize();  // match call of ::CoInitialize()\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489624415, "post_id": 42817709, "comment_id": 72757977, "body": "Hey Remy, thank you so much for the information. I knew I couldn&#39;t get away with just typecasting like that. Thing is, I am quite new to WinAPI and I am not a big fan of its syntax, though I&#39;m forcing myself to create an app with it. Anyway, would you kindly be able to have a look at my full code so far (here: <a href=\"http://textuploader.com/dtchw\" rel=\"nofollow noreferrer\">textuploader.com/dtchw</a>) and tell me how I should utilize it? Because currently my loading bitmap function isn&#39;t accepting the char* filename and I don&#39;t want to do any typecasting."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489629214, "post_id": 42817709, "comment_id": 72759137, "body": "@FearlessHobbit this code I have given you keeps the directory and filenames separate, even for single selection.  Your loop will need to combine them back together, such as with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb773571.aspx\" rel=\"nofollow noreferrer\"><code>PathCombine()</code></a>, before calling <code>LoadAndBlitBitmap()</code>. I chose not to make <code>OpenBmpFiles()</code> prefix each reported <code>filename</code> with the same <code>path</code> to save memory.  It would be trivial to change that behavior, though."}, {"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489629809, "post_id": 42817709, "comment_id": 72759314, "body": "Ah okay, thank you, I will try to combine them then, hopefully it&#39;s not too difficult to combine them, I&#39;ll let you know how things go. Thank you so much for your help. By the way, just to let you know, the idea behind my program is to make an application that loads bitmaps concurrently using multithreading."}, {"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489631374, "post_id": 42817709, "comment_id": 72759731, "body": "Okay cool, I think that&#39;s better. By if <code>(insertSlash) *out++ = &#39;\\\\&#39;;</code> Did you mean to put <code>slashNeeded</code> as the expression instead?"}, {"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489631559, "post_id": 42817709, "comment_id": 72759772, "body": "Oh and also do you think you can give me an example of how to make this load images with PathCombine()? That&#39;ll be very helpful."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489639672, "post_id": 42817709, "comment_id": 72761883, "body": "@FearlessHobbit yes, it should have been <code>slashNeeded</code>. And you don&#39;t need <code>PathCombine()</code> with the newer code, only the earlier code"}, {"owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "edited": false, "score": 0, "creation_date": 1489640409, "post_id": 42817709, "comment_id": 72762140, "body": "Wonderful, it works great now. I&#39;m so glad I surpassed this problem. Now onto the next challenge, multi-threading! :p Given the current state of my code, do you think it&#39;s hard to implement a simple multi-threading mechanism?"}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 0, "last_activity_date": 1489639977, "last_edit_date": 1489639977, "creation_date": 1489601963, "answer_id": 42817709, "question_id": 42807802, "link": "https://stackoverflow.com/questions/42807802/trouble-separating-data-within-buffer-winapi/42817709#42817709", "title": "Trouble separating data within buffer (WinAPI)", "body": "<p>The biggest mistake you are making is mixing ANSI and Unicode together.  You are using <code>char[]</code> buffers and type-casting them to <code>LPWSTR</code> pointers in order to assign them to the <code>OPENFILENAME</code> fields.  Since you are using the <code>TCHAR</code> version of the API, that means your project is being compiled for Unicode, not for ANSI.  Thus the API is expecting Unicode buffers, and will output Unicode strings.  Which also means you are telling the API that <em>twice</em> your buffers' allocated space is available to receive characters, since you are setting the <code>ofn.nMaxFile</code> and <code>ofn.nMaxFileTitle</code> fields to <em>byte</em> counts instead of <em>character</em> counts.  So you can cause buffer overflows. </p>\n\n<p>You cannot merely typecast an 8-bit buffer to a 16-bit data type.  You have to use the correct data type for your buffer to begin with, and get rid of the type-casts.  In this case, that means using <code>WCHAR</code>/<code>wchar_t</code> (or at least <code>TCHAR</code>) buffers instead of <code>char</code> buffers.  But, since you are using <code>char</code> in your function parameters, you should use the ANSI version of the API instead of the <code>TCHAR</code>/Unicode version.</p>\n\n<p>When selecting multiple files, especially files with long filenames, the resulting character data can easily grow beyond the size of your fixed-length buffer.  As the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646839.aspx\" rel=\"nofollow noreferrer\"><code>OPENFILENAME</code> documentation</a> states:</p>\n\n<blockquote>\n  <p>lpstrFile<br>\n  Type: LPTSTR</p>\n  \n  <p>The file name used to initialize the File Name edit control. The first character of this buffer must be NULL if initialization is not necessary. When the <code>GetOpenFileName</code> or <code>GetSaveFileName</code> function returns successfully, this buffer contains the drive designator, path, file name, and extension of the selected file.</p>\n  \n  <p>If the <code>OFN_ALLOWMULTISELECT</code> flag is set and the user selects multiple files, the buffer contains the current directory followed by the file names of the selected files. For Explorer-style dialog boxes, the directory and file name strings are NULL separated, with an extra NULL character after the last file name. For old-style dialog boxes, the strings are space separated and the function uses short file names for file names with spaces. You can use the <code>FindFirstFile</code> function to convert between long and short file names. If the user selects only one file, the <code>lpstrFile</code> string does not have a separator between the path and file name.</p>\n  \n  <p><strong>If the buffer is too small, the function returns <code>FALSE</code> and the <code>CommDlgExtendedError</code> function returns <code>FNERR_BUFFERTOOSMALL</code>. In this case, the first two bytes of the <code>lpstrFile</code> buffer contain the required size, in bytes or characters</strong>.</p>\n  \n  <p>nMaxFile<br>\n  Type: DWORD</p>\n  \n  <p><strong>The size, in characters, of the buffer pointed to by <code>lpstrFile</code></strong>. The buffer must be large enough to store the path and file name string or strings, including the terminating NULL character. <strong>The <code>GetOpenFileName</code> and <code>GetSaveFileName</code> functions return <code>FALSE</code> if the buffer is too small to contain the file information. The buffer should be at least 256 characters long</strong>.</p>\n</blockquote>\n\n<p>You are not taking that into account.  256 (better to use 260, aka <code>MAX_PATH</code>) is OK for selecting a single file, but may not be OK for selecting multiple files.  If <code>GetOpenFileName()</code> fails with <code>FNERR_BUFFERTOOSMALL</code>, you will have to reallocate your buffer and call <code>GetOpenFileName()</code> again.</p>\n\n<p>With that said, try something more like this:</p>\n\n<pre><code>BOOL OpenBmpFiles(char **filePath, char** fileNames, HWND hwnd)\n{\n    *filePath = NULL;\n    *fileNames = NULL;\n\n    size_t iMaxFileSize = MAX_PATH;\n    char *lpFileBuffer = (char*) malloc(iMaxFileSize);\n    if (!lpFileBuffer)\n        return FALSE;\n\n    char szFileTitle[MAX_PATH];\n    BOOL bResult = FALSE;\n\n    OPENFILENAMEA ofn;            \n    memset(&amp;ofn, 0, sizeof(ofn));\n    ofn.lStructSize = sizeof(ofn);\n    ofn.hwndOwner = hwnd;\n    ofn.lpstrFilter = \"Bitmap Files (*.bmp)\\0*.bmp\\0\\0\";\n    ofn.nFilterIndex = 1;\n    ofn.lpstrFile = lpFileBuffer;\n    ofn.nMaxFile = iMaxFileSize;\n    ofn.lpstrFileTitle = szFileTitle;\n    ofn.nMaxFileTitle = MAX_PATH;\n    ofn.lpstrTitle = \"Open BMP File\";\n    ofn.Flags = OFN_SHOWHELP | OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST | OFN_LONGNAMES | OFN_ALLOWMULTISELECT | OFN_EXPLORER;\n\n    do\n    {\n        //\n        // Set lpstrFile[0] to '\\0' so that GetOpenFileName does not \n        // use the contents of lpstrFile to initialize itself.\n        //\n        ofn.lpstrFile[0] = '\\0';\n\n        // show the common dialog \"Open BMP File\"\n        if (GetOpenFileNameA(&amp;ofn))\n            break;\n\n        // if cancel, exit           \n        if (CommDlgExtendedError() != FNERR_BUFFERTOOSMALL)\n            goto cleanup;\n\n        // reallocate the buffer and try again\n        iMaxFileSize = * (WORD*) lpFileBuffer;\n        char *lpNewFileBuffer = (char*) realloc(lpFileBuffer, iMaxFileSize);\n        if (!lpNewFileBuffer)\n            goto cleanup;\n\n        lpFileBuffer = lpNewFileBuffer;\n\n        ofn.lpstrFile = lpFileBuffer;\n        ofn.nMaxFile = iMaxFileSize;\n    }\n    while (true);\n\n    if (lpFileBuffer[ofn.nFileOffset-1] != '\\0')\n    {\n        MessageBox(hwnd, TEXT(\"Single Selection\"), TEXT(\"Open Debug 1\"), MB_OK);\n\n        // copy the single filename and make sure it is double-null terminated\n\n        size_t len = strlen(&amp;lpFileBuffer[ofn.nFileOffset]) + 2;\n\n        *fileNames = (char*) malloc(len);\n        if (!*fileNames)\n            goto cleanup;\n\n        strncpy(*fileNames, &amp;lpFileBuffer[ofn.nFileOffset], len);\n\n        // copy the directory path and make sure it is null terminated\n\n        lpFileBuffer[ofn.nFileOffset] = '\\0';\n\n        *filePath = strdup(lpFileBuffer);\n        if (!*filePath)\n        {\n            free(*fileNames);\n            *fileNames = NULL;\n            goto cleanup;\n        }\n    }\n    else\n    {\n        MessageBox(hwnd, TEXT(\"Multiple Selection\"), TEXT(\"Open Debug 2\"), MB_OK);\n\n        // copy the directory path, it is already null terminated\n\n        *filePath = strdup(lpFileBuffer);\n        if (!*filePath)\n            goto cleanup;\n\n        // copy the multiple filenames, they are already double-null terminated\n\n        size_t len = (ofn.nMaxFile - ofn.nFileOffset);\n\n        *fileNames = (char*) malloc(len);\n        if (!*fileNames)\n        {\n            free(*filePath);\n            *filePath = NULL;\n            goto cleanup;\n        }\n\n        // have to use memcpy() since the filenames are null-separated\n        memcpy(*fileNames, &amp;lpFileBuffer[ofn.nFileOffset], len);\n    }\n\n    bResult = TRUE;\n\ncleanup:\n    free(lpFileBuffer);\n    return bResult;\n}\n</code></pre>\n\n<p>Then you can use it like this:</p>\n\n<pre><code>char *path, *filenames;\nif (OpenBmpFiles(&amp;path, &amp;filenames, hwnd))\n{\n    char *filename = filenames;\n    do\n    {\n        // use path + filename as needed...\n        /*\n        char *fullpath = (char*) malloc(strlen(path)+strlen(filename)+1);\n        PathCombineA(fullpath, path, filename);\n        doSomethingWith(fullpath);\n        free(fullpath);\n        */\n\n        filename += (strlen(filename) + 1);\n    }\n    while (*filename != '\\0');\n\n    free(path);\n    free(filenames);\n}\n</code></pre>\n\n<hr>\n\n<p><strong>UPDATE</strong>: alternatively, to simplify the use of the returned filenames, you could do something more like this:</p>\n\n<pre><code>BOOL OpenBmpFiles(char** fileNames, HWND hwnd)\n{\n    *fileNames = NULL;\n\n    size_t iMaxFileSize = MAX_PATH;\n    char *lpFileBuffer = (char*) malloc(iMaxFileSize);\n    if (!lpFileBuffer)\n        return FALSE;\n\n    char szFileTitle[MAX_PATH];\n    BOOL bResult = FALSE;\n\n    OPENFILENAMEA ofn;            \n    memset(&amp;ofn, 0, sizeof(ofn));\n    ofn.lStructSize = sizeof(ofn);\n    ofn.hwndOwner = hwnd;\n    ofn.lpstrFilter = \"Bitmap Files (*.bmp)\\0*.bmp\\0\\0\";\n    ofn.nFilterIndex = 1;\n    ofn.lpstrFile = lpFileBuffer;\n    ofn.nMaxFile = iMaxFileSize;\n    ofn.lpstrFileTitle = szFileTitle;\n    ofn.nMaxFileTitle = MAX_PATH;\n    ofn.lpstrTitle = \"Open BMP File\";\n    ofn.Flags = OFN_SHOWHELP | OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST | OFN_LONGNAMES | OFN_ALLOWMULTISELECT | OFN_EXPLORER;\n\n    do\n    {\n        //\n        // Set lpstrFile[0] to '\\0' so that GetOpenFileName does not \n        // use the contents of lpstrFile to initialize itself.\n        //\n        ofn.lpstrFile[0] = '\\0';\n\n        // show the common dialog \"Open BMP File\"\n        if (GetOpenFileNameA(&amp;ofn))\n            break;\n\n        // if cancel, exit           \n        if (CommDlgExtendedError() != FNERR_BUFFERTOOSMALL)\n            goto cleanup;\n\n        // reallocate the buffer and try again\n        iMaxFileSize = * (WORD*) lpFileBuffer;\n        char *lpNewFileBuffer = (char*) realloc(lpFileBuffer, iMaxFileSize);\n        if (!lpNewFileBuffer)\n            goto cleanup;\n\n        lpFileBuffer = lpNewFileBuffer;\n\n        ofn.lpstrFile = lpFileBuffer;\n        ofn.nMaxFile = iMaxFileSize;\n    }\n    while (true);\n\n    if (lpFileBuffer[ofn.nFileOffset-1] != '\\0')\n    {\n        MessageBox(hwnd, TEXT(\"Single Selection\"), TEXT(\"Open Debug 1\"), MB_OK);\n\n        // copy the single filename and make sure it is double-null terminated\n\n        size_t len = strlen(lpFileBuffer) + 2;\n\n        *fileNames = (char*) malloc(len);\n        if (!*fileNames)\n            goto cleanup;\n\n        strncpy(*fileNames, lpFileBuffer, len);\n    }\n    else\n    {\n        MessageBox(hwnd, TEXT(\"Multiple Selection\"), TEXT(\"Open Debug 2\"), MB_OK);\n\n        // calculate the output buffer size\n\n        char *path = lpFileBuffer;\n        size_t pathLen = strlen(path);\n        bool slashNeeded = ((path[pathLen-1] != '\\\\') &amp;&amp; (path[pathLen-1] != '/'));\n        size_t len = 1;\n\n        char *filename = &amp;lpFileBuffer[ofn.nFileOffset];\n        while (*filename != '\\0')\n        {\n            int filenameLen = strlen(filename);\n            len += (pathLen + filenameLen + 1);\n            if (slashNeeded) ++len;\n            filename += (filenameLen + 1);\n        }\n\n        // copy the filenames and make sure they are double-null terminated\n\n        *fileNames = (char*) malloc(len);\n        if (!*fileNames)\n            goto cleanup;\n\n        char *out = *fileNames;\n\n        filename = &amp;lpFileBuffer[ofn.nFileOffset];\n        while (*filename != '\\0')\n        {\n            strncpy(out, path, pathLen);\n            out += pathLen;\n            if (slashNeeded) *out++ = '\\\\';\n\n            int filenameLen = strlen(filename);\n            strncpy(out, filename, filenameLen);\n            out += filenameLen;\n            *out++ = '\\0';\n\n            filename += (filenameLen + 1);\n        }\n\n        *out = '\\0';\n    }\n\n    bResult = TRUE;\n\ncleanup:\n    free(lpFileBuffer);\n    return bResult;\n}\n</code></pre>\n\n<p></p>\n\n<pre><code>char *filenames;\nif (OpenBmpFiles(&amp;filenames, hwnd))\n{\n    char *filename = filenames;\n    do\n    {\n        // use filename as needed...\n        /*\n        doSomethingWith(filename);\n        */\n\n        filename += (strlen(filename) + 1);\n    }\n    while (*filename != '\\0');\n\n    free(filenames);\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6219633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c912c4fd44b2c59996868fa4c678e07?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/6219633/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 42817709, "answer_count": 3, "score": 0, "last_activity_date": 1489639977, "creation_date": 1489575512, "question_id": 42807802, "link": "https://stackoverflow.com/questions/42807802/trouble-separating-data-within-buffer-winapi", "title": "Trouble separating data within buffer (WinAPI)", "body": "<p>I found this piece of code online that promises to separate data loaded into the buffer, I need that so I may display each .bmp image individually on the screen.</p>\n\n<pre><code>BOOL OpenBmpFile(char* filePath, char* fileName, int* offset, HWND hwnd)\n{\n    OPENFILENAME ofn;            \n    char szFileName[256];    \n    char szFilePath[256];\n    BOOL FileOK;         \n\n    memset(&amp;ofn, 0, sizeof(ofn));\n    ofn.lStructSize = sizeof(OPENFILENAME);\n    ofn.hwndOwner = hwnd;\n    ofn.lpstrFilter = TEXT(\"Bitmap Files (*.bmp)\\0*.bmp\\0\\0\");\n    ofn.nFilterIndex = 1;\n    strcpy(szFilePath, \"*.bmp\");\n    ofn.lpstrFile = (LPWSTR)szFilePath;\n    //\n    // Set lpstrFile[0] to '\\0' so that GetOpenFileName does not \n    // use the contents of szFile to initialize itself.\n    //\n    ofn.lpstrFile[0] = '\\0';\n    ofn.nMaxFile = sizeof(szFilePath);\n    ofn.lpstrFileTitle = (LPWSTR)szFileName;\n    ofn.nMaxFileTitle = sizeof(szFileName);\n    ofn.lpstrTitle = TEXT(\"Open BMP File\");\n    ofn.Flags = OFN_SHOWHELP | OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST | OFN_LONGNAMES | OFN_ALLOWMULTISELECT | OFN_EXPLORER;\n\n\n    // show the common dialog \"Open BMP File\"\n    FileOK = GetOpenFileName(&amp;ofn);\n\n    // if cancel, exit\n    if (!FileOK)\n        return FALSE;\n\n    // else store the selected filename\n    strcpy(fileName, szFileName);\n    //I use this because strcpy stops after the first NULL\n    memcpy(filePath, szFilePath, sizeof(szFilePath));\n    *offset = ofn.nFileOffset;\n\n    if(szFilePath[ofn.nFileOffset-1] != '\\0')\n    {\n    MessageBox(hwnd,L\"Single Selection\",L\"Open Debug 1\",MB_OK);\n    }\n    else\n    {\n    MessageBox(hwnd,L\"Multiple Selection\",L\"Open Debug 2\",MB_OK);\n    }\n\n    return TRUE;\n}\n</code></pre>\n\n<p>However, every time I call this function with the following line results in an error:</p>\n\n<pre><code>OpenBmpFile((char*)file, (char*)file2, pTest, hWnd);\n</code></pre>\n\n<p>Error: pTest is a nullptr;</p>\n\n<p>I guess my question is, how may I use this function effectively to display my images?  </p>\n"}, {"tags": ["c", "multithreading", "assembly", "x86", "memory-barriers"], "comments": [{"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1489575448, "post_id": 42807707, "comment_id": 72727916, "body": "make use of <code>volatile</code> for that variable (<code>x</code>), so that it won&#39;t cache the value either the thread A or B"}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1489576273, "post_id": 42807707, "comment_id": 72728519, "body": "No. But a lot of events, including dispatching exceptions, flush the store buffer anyway."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1489576311, "post_id": 42807707, "comment_id": 72728549, "body": "Threading race bugs are triggered by delays that are measured in <i>nanosecond</i> units.  That it is so short is what makes such bugs so drastically hard to debug."}, {"owner": {"reputation": 3378, "user_id": 2069150, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/filKc.jpg?s=128&g=1", "display_name": "Arch D. Robison", "link": "https://stackoverflow.com/users/2069150/arch-d-robison"}, "edited": false, "score": 0, "creation_date": 1489713597, "post_id": 42807707, "comment_id": 72803307, "body": "Tangentially related: The paper <a href=\"http://www.cs.tau.ac.il/~mad/publications/asplos2014-ffwsq.pdf\" rel=\"nofollow noreferrer\">cs.tau.ac.il/~mad/publications/asplos2014-ffwsq.pdf</a> suggests exploiting the bound on the store queue length to avoid using a fence.  But note that the authors are reasoning about buffer lengths, not time."}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 2, "last_activity_date": 1489576791, "creation_date": 1489576791, "answer_id": 42808280, "question_id": 42807707, "link": "https://stackoverflow.com/questions/42807707/is-there-anything-that-prevents-the-cpu-from-waiting-a-long-time-before-executin/42808280#42808280", "title": "Is there anything that prevents the CPU from waiting a long time before executing its scheduled set operations?", "body": "<p>No CPU documentation I've read in the past 15 years speaks about time it takes to synchronize memory in terms more specific than \"X is visible before Y\". The reason for this is because memory protocols are so complex that it's pretty much impossible to put an upper bound on how much can happen before your write will become visible (DMA, error correction, TLB lookups, SMM, etc.).</p>\n\n<p>You could construct a theoretical scenario where your write will never become visible, in fact, if you want to do that just find errata documents for CPUs and they'll have plenty examples of how that can happen. But in practice? No, you'll never wait 10 minutes. The kernel you're running on will be receiving interrupts that will perform memory reads and writes that will flush store buffers and evict your cache lines.</p>\n\n<p>That being said, you should still use memory synchronization, but for different reasons. For enforcing ordering. If value <code>x</code> is the only bit of information you want to send to the other thread it will eventually become readable and you can get away with not synchronizing. But this is almost never the case. Usually the value <code>x</code> is there to say that value <code>y</code> contains something interesting and you need proper synchronization to know that <code>y</code> has the right contents when <code>x</code> becomes visible to the other thread.</p>\n"}], "owner": {"reputation": 679, "user_id": 7663425, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eeb15b66507a9374260b7a5472f8772b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/7663425/christopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 42808280, "answer_count": 1, "score": 0, "last_activity_date": 1489576791, "creation_date": 1489575272, "question_id": 42807707, "link": "https://stackoverflow.com/questions/42807707/is-there-anything-that-prevents-the-cpu-from-waiting-a-long-time-before-executin", "title": "Is there anything that prevents the CPU from waiting a long time before executing its scheduled set operations?", "body": "<p>Let's say that I have two threads that share the global variable <code>x</code>.\n<code>Thread A</code>'s job is to set a value to <code>x</code>, and <code>Thread B</code>'s job is to read <code>x</code>. Now each thread (or each core I suppose) will have a cached copy of <code>x</code>.</p>\n\n<p>Let's say that <code>Thread A</code> has set the value of <code>x</code> to <code>12345</code>. Now <code>Thread A</code>'s cache could remain unaltered because the CPU can schedule the set operation to be executed later, and so the cache coherence protocol will not act, and so when <code>Thread B</code> reads the value of <code>x</code>, it will read an old value.</p>\n\n<p>My question is: is there anything that prevents the CPU from waiting a long time (for example: 10 minutes) before executing its scheduled set operations?</p>\n\n<p><strong><em>Note:</strong> I know that I can use a memory barrier to force the CPU to execute its scheduled set operations immediately, but I am curious to know what can happen if I don't use a memory barrier.</em></p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1489575095, "post_id": 42807542, "comment_id": 72727627, "body": "Remove <code>this</code> from the functions declaration, make sure the module <i>itself</i> is always compiled with a C compiler, and you will have no issue with using <code>this</code> as the identifier for the object inside the module."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489575171, "post_id": 42807542, "comment_id": 72727680, "body": "Also, <a href=\"http://yarchive.net/comp/linux/typedefs.html\" rel=\"nofollow noreferrer\">don&#39;t typedef the struct away</a>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1489575236, "post_id": 42807542, "comment_id": 72727733, "body": "You could also use <code>self</code>, which is commonly used on other languages when you need explicit <code>this</code>."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1489575239, "post_id": 42807542, "comment_id": 72727737, "body": "Why not <code>_this</code> but <code>this_</code>? Is it better to see <code>this_-&gt;member</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1489575359, "post_id": 42807542, "comment_id": 72727848, "body": "@StoryTeller That post is subjective nonsense. The vast majority of the programmers around the world prefer to use typedef. This is particularly true for C++ programmers or programmers mixing C and C++. The Linux world prefer not to use typedef, for subjective, irrational reasons. It is a matter of style completely. There is no need to preach one style before the other here, especially not when dealing with beginners."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1489575361, "post_id": 42807542, "comment_id": 72727850, "body": "@i486 - The C and C++ standard have a bunch of hard to remember rules about reserved identifier when it comes to a leading underscore. Many just prefer not to open that can of worms and avoid leading underscores."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489575495, "post_id": 42807542, "comment_id": 72727954, "body": "@Lundin - &quot;irrational reasons&quot; now there&#39;s some subjective nonsense if I&#39;ve ever heard such a thing. One may not like the Linux coding guidelines, but to say they have absolutely no basis in reason is bogus. That awful typedefing practice is the cause of more then one beginner question on SO that asks &quot;why can&#39;t I forward declare this?&quot;."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489575636, "post_id": 42807542, "comment_id": 72728075, "body": "It took me about 5 minutes to write a test program that confirms you can&#39;t use <code>this</code> as a parameter name in a header you include in a C++ program."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489575738, "post_id": 42807542, "comment_id": 72728133, "body": "@StoryTeller The Linux kernel coding style guide is overall an amateur-level document, lacking sources, scientific proof and rationales. This whole thing is a known style war between Linux fans and the rest of the C programming world. We don&#39;t need style wars here."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489575820, "post_id": 42807542, "comment_id": 72728189, "body": "@Lundin - I daresay the first inflammatory rhetoric came from you. I merely suggested what I consider a good practice that prevents a certain class of errors for the price of some syntactic sugar."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489576032, "post_id": 42807542, "comment_id": 72728329, "body": "@StoryTeller Linus is wrong. Well, he might be right with respect to the Linux kernel where resources are scarce, but there is nothing wrong with type abstraction in general terms."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489576133, "post_id": 42807542, "comment_id": 72728402, "body": "@StoryTeller <i>Also, <a href=\"http://yarchive.net/comp/linux/typedefs.html\" rel=\"nofollow noreferrer\">don&#39;t typedef the struct away</a></i> On a Centos 6 server I have access to, <code>find &#47;usr&#47;include -name \\*.h | xargs grep typedef | grep struct | wc -l</code> returns 8042. Even running that in <code>&#47;usr&#47;include&#47;linux</code> returns 191. Seems Linus doesn&#39;t follow his own &quot;rule&quot;..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489576133, "post_id": 42807542, "comment_id": 72728403, "body": "@JeremyP - This isn&#39;t a type abstraction, this is namespace hiding syntactic sugar IMO. Regardless, the point is moot. I said my piece, you guys said yours."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489576185, "post_id": 42807542, "comment_id": 72728446, "body": "@AndrewHenle - Linus isn&#39;t the sole contributer to the kernel. He accepts huge patches from people he trusts that are less stringent then him in regard to the patches <i>they</i> accept. Happens."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489576245, "post_id": 42807542, "comment_id": 72728498, "body": "@StoryTeller I used &quot;type abstraction&quot; only because Linus himself referred to it as that in the post to which you linked."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489576324, "post_id": 42807542, "comment_id": 72728560, "body": "@StoryTeller So, Linus&#39;s standard on <code>typedef</code> of structures is a mere subjective preference that he doesn&#39;t even bother to enforce?  Your comment is based on the unenforced style preference of one person?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489576330, "post_id": 42807542, "comment_id": 72728567, "body": "@JeremyP - And he didn&#39;t object to it in general terms. So, yeah... flame wars..."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489576404, "post_id": 42807542, "comment_id": 72728629, "body": "@AndrewHenle The files in <code>&#47;usr&#47;include</code> define APIs that are out of Linus&#39;s control. You can&#39;t use them to beat him over the head with."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489576408, "post_id": 42807542, "comment_id": 72728633, "body": "@AndrewHenle - My comment is based on the fact people are imperfect, and Linus being practical and pragmatic from time to time. Why do you insist on dragging this on, btw? What are you hoping to win?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489577127, "post_id": 42807542, "comment_id": 72729076, "body": "@JeremyP In an appeal to authority as a logical argument, demonstrating that the authority <i>explicitly picked to support the argument</i> doesn&#39;t even bother to enforce the argument&#39;s position shows that the &quot;authority&quot; isn&#39;t one.  Because not only are the ones in <code>&#47;usr&#47;include&#47;kernel</code> under Linus&#39;s control, many of those 8,000+ others are too. FWIW, the RH kernel source tree yields a count of <code>typedef struct</code> of over 900..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489577486, "post_id": 42807542, "comment_id": 72729312, "body": "@AndrewHenle - I didn&#39;t appeal to authority, I linked to someone else&#39;s colorful explanation of my approach so as to avoid repeating it verbatim by myself. Next time consider asking if I linked solely because it&#39;s &quot;Linus Torvalds&quot; who said it or because I agree with the content. As my comments to Jeremy clearly indicate, it&#39;s the latter."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1489577625, "post_id": 42807542, "comment_id": 72729400, "body": "@AndrewHenle I am on your side with regard to the general point, I merely objected to your use of the files in /usr/include as evidence of Linus&#39;s inconsistency when the vast majority of them were written by people working on other projects and the contents of many are mandated by standards e.g. C11, POSIX. It is legitimate to do the exercise on the Linux kernel source tree, but that is not what you did in the first instance. Anyway, we are all agreed that the typedefs are fine in the general case, even Linus agrees that according to StoryTeller."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1489577693, "post_id": 42807542, "comment_id": 72729439, "body": "@JeremyP - Yup. I don&#39;t know how I&#39;d code without the typedefs in <code>stdint.h</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1489580436, "post_id": 42807542, "comment_id": 72731330, "body": "Any C programmer can take a quick glimpse at the actual Linux kernel source code. After which you&#39;ll immediately dismiss both Torvalds and the Linux kernel coding document as any form of C authorities."}], "answers": [{"comments": [{"owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "edited": false, "score": 0, "creation_date": 1489576326, "post_id": 42807666, "comment_id": 72728565, "body": "Ok, understood. I will use <code>self</code> as somebody has stated in another comment."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "edited": false, "score": 1, "creation_date": 1489576652, "post_id": 42807666, "comment_id": 72728787, "body": "@LoPiTaL <code>self</code> is the equivalent of <code>this</code> in Objective-C. However, it is not a reserved word so much as just an implicitly defined argument so you won&#39;t run into the same issues."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1489575143, "creation_date": 1489575143, "answer_id": 42807666, "question_id": 42807542, "link": "https://stackoverflow.com/questions/42807542/using-this-keyword-in-plain-c/42807666#42807666", "title": "Using `this` keyword in plain C", "body": "<p>No, you can't do that since <code>this</code> is a reserved word in C++. It cannot be used as the name of an ordinary argument.</p>\n\n<p>You can remove the name from the header and keep it in the C file, but that of course means making the header slightly worse since it no longer contains the hint what that argument is meant for.</p>\n"}], "owner": {"reputation": 2275, "user_id": 3742943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ijesw.jpg?s=128&g=1", "display_name": "LoPiTaL", "link": "https://stackoverflow.com/users/3742943/lopital"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 42807666, "answer_count": 1, "score": 0, "last_activity_date": 1489575143, "creation_date": 1489574887, "question_id": 42807542, "link": "https://stackoverflow.com/questions/42807542/using-this-keyword-in-plain-c", "title": "Using `this` keyword in plain C", "body": "<p>I am used to program in C++. I like the Object Oriented stuff and the like the language provides.\nBut now I have to program in plain C, since I have to use an embedded system without support for C++ compiler, only plain C.</p>\n\n<p>I want to keep usign \"Object Oriented\" functions, thus I usually write my modules like this:</p>\n\n<pre><code>//Maybe hidden with PIMPL...\ntypedef struct myModuleData_\n{\n}myModuleData;\n\nmyModuleData* moduleCreate();\nvoid moduleFree(myModuleData *this_);\n\nvoid moduleSetSomething(myModuleData *this_, int something);\n</code></pre>\n\n<p>Now my question is: can I replace <code>this_</code> with <code>this</code> (without the final underscore)? Will the usage of <code>this</code> in plain C interfere in the future with C++ if I use this module in C++ by using it with extern \"C\"?</p>\n"}, {"tags": ["c", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489572856, "post_id": 42806683, "comment_id": 72726049, "body": "Probably because you leak a whole bunch of memory by constantly overwriting your root."}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "edited": false, "score": 1, "creation_date": 1489572959, "post_id": 42806683, "comment_id": 72726119, "body": "Well, you don&#39;t assign key to the <code>data</code> of the node ;)"}, {"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489573068, "post_id": 42806683, "comment_id": 72726202, "body": "@StoryTeller How so? OP inserts a node - this may change the root. (For an unbalanced tree this happens only the first time, but anyhow it is saver to not assume it)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1489573155, "post_id": 42806683, "comment_id": 72726256, "body": "@Henry - This isn&#39;t a self balancing tree. Insertion should not modify the identity of the root. Especially if all it does is just return a pointer to the new node without attaching it to anything."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489573308, "post_id": 42806683, "comment_id": 72726367, "body": "In fact, you don&#39;t return a value on every branch of <code>insert</code>. The behavior of your program is undefined..."}, {"owner": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489573583, "post_id": 42806683, "comment_id": 72726567, "body": "yes i think your correct. @StoryTeller"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "edited": false, "score": 0, "creation_date": 1489573296, "post_id": 42806766, "comment_id": 72726358, "body": "thank you i missed it. still preorder traversal is not printing. prints only final value 25."}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "reply_to_user": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "edited": false, "score": 0, "creation_date": 1489573601, "post_id": 42806766, "comment_id": 72726583, "body": "@Balaji I re-edited my code to add the final solution. Please, validate the solution if this work out."}, {"owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "reply_to_user": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "edited": false, "score": 0, "creation_date": 1489573742, "post_id": 42806766, "comment_id": 72726693, "body": "@Balaji For information, it was only prints the last value since first time you create the node. Then affect &quot;Null&quot;, then recreate it etc .."}, {"owner": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "edited": false, "score": 0, "creation_date": 1489573763, "post_id": 42806766, "comment_id": 72726711, "body": "yes, return statement has the mistake. thanks @kaldoran"}], "tags": [], "owner": {"reputation": 817, "user_id": 4612127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/77e5b33fd361733419766d29957eb203?s=128&d=identicon&r=PG&f=1", "display_name": "kaldoran", "link": "https://stackoverflow.com/users/4612127/kaldoran"}, "is_accepted": true, "score": 2, "last_activity_date": 1489573410, "last_edit_date": 1489573410, "creation_date": 1489573014, "answer_id": 42806766, "question_id": 42806683, "link": "https://stackoverflow.com/questions/42806683/binary-tree-preorder-traversal-prints-only-null/42806766#42806766", "title": "binary tree preorder traversal prints only NULL", "body": "<p>You just forgot to add the key value inside the new node ;)</p>\n\n<p>Just add : <code>new-&gt;data = key;</code> to the newNode code</p>\n\n<pre><code>Node* newNode(int key)\n{\n    Node* new = (Node*)malloc(sizeof(struct node));\n    new-&gt;data = key;\n    new-&gt;left = NULL;\n    new-&gt;right = NULL;\n    return new;\n}\n</code></pre>\n\n<p>For the moment, since <code>node-&gt;data</code> is not define <code>else if (node-&gt;data &gt; key)</code> and <code>else if (node-&gt;data &lt; key)</code> will have an undifined behavior.</p>\n\n<p><strong>Edit</strong> : By the way, be \"carefull\" when you go inside the 2 <code>else if</code> condition, you never return a node, then <code>root = insert(root,20);</code> will not work. You <strong>need</strong> to return a value in those case.</p>\n\n<pre><code>Node* insert(Node* node, int key)\n{\n    if (node==NULL)\n        return newNode(key);\n    else if (node-&gt;data &gt; key)\n        node-&gt;left = insert(node-&gt;left, key);\n    else if (node-&gt;data &lt; key)\n        node-&gt;right = insert(node-&gt;right, key);\n\n    return node;\n} \n</code></pre>\n\n<p>This code should work (if you change also the newNode function )</p>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1489574102, "creation_date": 1489574102, "answer_id": 42807218, "question_id": 42806683, "link": "https://stackoverflow.com/questions/42806683/binary-tree-preorder-traversal-prints-only-null/42807218#42807218", "title": "binary tree preorder traversal prints only NULL", "body": "<p>You have several errors in your insert function. It doesn't return a valid pointer on every branch, so your <code>root</code> cannot be asserted as pointing to a valid address if you assign the result to it. Always turn compiler warnings to as high a level as possible.</p>\n\n<p>Even though an unbalanced BST is a recursive data structure, I suggest you resist the urge to implement its operations recursively. It may be simple to write, but not always easy to debug.</p>\n\n<pre><code>Node* insert(Node* root, int key)\n{\n  Node **link= &amp;root;\n  while(*link) {\n    if((*link)-&gt;data &gt; key) {\n      link = &amp;((*link)-&gt;left);\n    } else {\n      link = &amp;((*link)-&gt;right);\n    }\n  }\n\n  *link = newNode(key);\n  return root;\n} \n</code></pre>\n\n<p>Take a moment to appreciate the abstraction here. The code above implements indirection to find the point of addition. It always keeps track of the tree <em>link</em> that must be modified on addition. Once an empty link is found (<code>*link == NULL</code>), we can assign to it.</p>\n\n<p>It also fixes another silent bug in your code, the addition of duplicate keys will also overwrite the root. I took the liberty of adding them to the right sub-tree as is common in certain implementations. But you may stop there instead and return <code>root</code> immediately.</p>\n"}], "owner": {"reputation": 27, "user_id": 2315212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UI2l0.jpg?s=128&g=1", "display_name": "Balaji", "link": "https://stackoverflow.com/users/2315212/balaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 42806766, "answer_count": 2, "score": 1, "last_activity_date": 1521758526, "creation_date": 1489572777, "last_edit_date": 1521758526, "question_id": 42806683, "link": "https://stackoverflow.com/questions/42806683/binary-tree-preorder-traversal-prints-only-null", "title": "binary tree preorder traversal prints only NULL", "body": "<p>Written my first simple tree data structure using C. Preorder traversal is not printing any values, only prints null. Can't able to detect where is the issue is. Thanks</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node {\n    int data;\n    struct node* left;\n    struct node* right;\n} Node;\n</code></pre>\n\n<p><strong>New node creation</strong></p>\n\n<pre><code>Node* newNode(int key) {\n    Node* new = (Node*)malloc(sizeof(struct node));\n    new-&gt;data = key;\n    new-&gt;left = NULL;\n    new-&gt;right = NULL;\n\n    return new;\n}\n</code></pre>\n\n<p><strong>Insertion using recursion</strong></p>\n\n<pre><code>Node* insert(Node* node, int key) {\n    if (node == NULL)\n        return newNode(key);\n    else if (node-&gt;data &gt; key)\n        node-&gt;left = insert(node-&gt;left, key);\n    else if (node-&gt;data &lt; key)\n        node-&gt;right = insert(node-&gt;right, key);\n    else \n        return (node);\n}\n</code></pre>\n\n<p><strong>Didn't get expected output</strong></p>\n\n<pre><code>void preorder(Node* node) {\n    if (node != NULL) {\n        printf(\"%d \",node-&gt;data);\n        preorder(node-&gt;left);\n        preorder(node-&gt;right);\n    }\n}\n\nint main() {\n    //Thinking issue might be in below initialization.\n    Node* root=NULL;\n    root = insert(root,10);\n    root = insert(root,20);\n    root = insert(root,30);\n    root = insert(root,40);\n    root = insert(root,50);\n    root = insert(root,60);\n    root = insert(root,25);\n\n    preorder(root);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "global-variables", "extern"], "comments": [{"owner": {"reputation": 125, "user_id": 7363106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MZrsDWbbCm8/AAAAAAAAAAI/AAAAAAAAABw/mlC55MUbzug/photo.jpg?sz=128", "display_name": "Ahmed Afif Khan", "link": "https://stackoverflow.com/users/7363106/ahmed-afif-khan"}, "edited": false, "score": 0, "creation_date": 1489572803, "post_id": 42806397, "comment_id": 72726001, "body": "Can I have some more sources or keywords to look at? And how do I get this work?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489573666, "post_id": 42806397, "comment_id": 72726630, "body": "1) Don&#39;t use global variables like this. Overall, the presence of the <code>extern</code> keyword is generally a clear indication of bad program design. 2) You can&#39;t set an array size based on a run-time constant unless the array is declared in local scope."}], "owner": {"reputation": 125, "user_id": 7363106, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MZrsDWbbCm8/AAAAAAAAAAI/AAAAAAAAABw/mlC55MUbzug/photo.jpg?sz=128", "display_name": "Ahmed Afif Khan", "link": "https://stackoverflow.com/users/7363106/ahmed-afif-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1489572199, "answer_count": 0, "score": 0, "last_activity_date": 1489572052, "creation_date": 1489572052, "question_id": 42806397, "link": "https://stackoverflow.com/questions/42806397/how-to-declare-the-index-of-an-array-from-a-global-variable", "closed_reason": "Duplicate", "title": "How to declare the index of an array from a global variable", "body": "<p>How do I get the index of an array which will take the the value of a global variable declared elsewhere.</p>\n\n<pre><code>//inside stress.h\n#include \"note.h\"\n\nextern int nelement = Element; //int Element is a global variable declared inside note.h\n#define nmesh 10\n\nint array [nelement*nmesh]; //error: expression must have a constant value\n</code></pre>\n\n<p><code>Element</code> is a variable which will be read during run-time.</p>\n"}, {"tags": ["css", "c", "gtk3"], "answers": [{"tags": [], "owner": {"reputation": 55, "user_id": 7164810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b03848c82bf75ecd767f01708d6842?s=128&d=identicon&r=PG&f=1", "display_name": "R. Rodrigues", "link": "https://stackoverflow.com/users/7164810/r-rodrigues"}, "is_accepted": true, "score": 1, "last_activity_date": 1489666654, "creation_date": 1489666654, "answer_id": 42833876, "question_id": 42806382, "link": "https://stackoverflow.com/questions/42806382/gtk3-css-provider-dont-works/42833876#42833876", "title": "Gtk+3 Css provider don&#39;t works", "body": "<p>The problem is that i don't define in glade the widget name. Css provider isn't defined by ID but by widget name. \nSo, i changed <code>GtkBox#Home_PrincipalScreen_table</code> to <code>#Background</code> and define the widget name as <code>Background</code> and works...</p>\n"}], "owner": {"reputation": 55, "user_id": 7164810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44b03848c82bf75ecd767f01708d6842?s=128&d=identicon&r=PG&f=1", "display_name": "R. Rodrigues", "link": "https://stackoverflow.com/users/7164810/r-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 42833876, "answer_count": 1, "score": 1, "last_activity_date": 1489666654, "creation_date": 1489572004, "last_edit_date": 1489582226, "question_id": 42806382, "link": "https://stackoverflow.com/questions/42806382/gtk3-css-provider-dont-works", "title": "Gtk+3 Css provider don&#39;t works", "body": "<p>I'm trying to pu image in background of GtkBox with css provider, and label text style, but nothing happens. I tried with so many different ways. </p>\n\n<p>Here is my custom.css:</p>\n\n<pre><code>GtkBox#Home_PrincipalScreen_table{\n    background-image: url(\"background.png\");\n}\n\nGtkLabel#Home_Cooling_Tunnel1_Cooler_label1{\n    color: white;\n}\n\nGtkLabel#label_Avg_Temp_value{\n    color: red;\n    font-family: Segoe UI;\n    font-size: 25px;\n}\nGtkButton{color: blue;\n    font-size: 25px\n}\n</code></pre>\n\n<p>And here is my .c file:</p>\n\n<pre><code>    GFile *file= g_file_new_for_path(\"custom.css\");\n    GtkCssProvider *css_provider = gtk_css_provider_new();\n    if(!gtk_css_provider_load_from_file(css_provider, file, &amp;error))\n    {\n        g_warning( \"%s\", error-&gt;message );\n        g_free( error );\n        return( 1 );\n    }\n    gtk_style_context_add_provider_for_screen(gdk_screen_get_default(), css_provider, GTK_STYLE_PROVIDER_PRIORITY_USER);\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Widgets change it proprieties like GtkButton example, but specific widget like Home_PrincipalScreen_table don't change. </p>\n\n<p>What's wrong with my code?</p>\n"}, {"tags": ["c", "gcc", "stm32", "hal", "usb-mass-storage"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489572065, "post_id": 42806276, "comment_id": 72725451, "body": "Minimum erasable size for flashes is a sector...."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "edited": false, "score": 0, "creation_date": 1489572615, "post_id": 42806403, "comment_id": 72725855, "body": "Thank you for your answer. But It&#39;s very strange for me because I found some examples where page erasing was used.But how it&#39;s possible to write some pages to FLASH from USB-host when you need to erase whole sector at first."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489572911, "post_id": 42806403, "comment_id": 72726084, "body": "The real  question is: where did you find out that pages exists? What is a page for you?"}, {"owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "edited": false, "score": 0, "creation_date": 1489573973, "post_id": 42806403, "comment_id": 72726854, "body": "For example following documentation: STM32F4 flash memory consists 512 pages (2 Kbytes each). But it is divided by 12 sectors: &#39;/* Base address of the Flash sectors */ 0x08000000 Sector 0, 16 Kbytes 0x08004000 Sector 1, 16 Kbytes 0x08008000 Sector 2, 16 Kbytes 0x0800C000 of Sector 3, 16 Kbytes 0x08010000 Sector 4, 64 Kbytes 0x08020000 Sector 5, 128 Kbytes 0x08040000 Sector 6, 128 Kbytes 0x08060000 Sector 7, 128 Kbytes 0x08080000 Sector 8, 128 Kbytes 0x080A0000 Sector 9, 128 Kbytes 0x080C0000 Sector 10, 128 Kbytes 0x080E0000 Sector 11, 128 Kbytes&#39;"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "edited": false, "score": 1, "creation_date": 1489574509, "post_id": 42806403, "comment_id": 72727226, "body": "@VshivtsevDaniil And what&#39;s the source for that? It&#39;s not RM0090. If you look in RM0090, you&#39;ll see that no pages in flash are mentioned, since that&#39;s not a concept that exists or matters. You can only erase whole sectors."}, {"owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "edited": false, "score": 0, "creation_date": 1489575135, "post_id": 42806403, "comment_id": 72727656, "body": "@unwind It was screen-shot from <a href=\"http://www.st.com/content/ccc/resource/technical/document/programming_manual/10/98/e8/d4/2b/51/4b/f5/CD00283419.pdf/files/CD00283419.pdf/jcr:content/translations/en.CD00283419.pdf\" rel=\"nofollow noreferrer\">PM0075 Programming manual</a>. And I&#39;ve got my mistake..."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 2, "last_activity_date": 1489573654, "last_edit_date": 1489573654, "creation_date": 1489572062, "answer_id": 42806403, "question_id": 42806276, "link": "https://stackoverflow.com/questions/42806276/how-can-i-erase-an-internal-flash-page-not-sector-in-my-stm32f405rg-while-usi/42806403#42806403", "title": "How can I erase an internal flash Page (not sector!) in my STM32F405RG while using HAL?", "body": "<p>You can't. The smallest part you can erase is a sector.</p>\n\n<p>I quote from the reference manual:</p>\n\n<blockquote>\n  <p>3.6.3 Erase</p>\n  \n  <p>The Flash memory erase operation can be performed at sector level or on the\n  whole Flash> memory (Mass Erase). Mass Erase does not affect the OTP sector\n  or the configuration sector.</p>\n</blockquote>\n\n<p>This is why the sectors have different sizes. It's important to lay out your software to use the sectors cleverly, considering when you might need to erase flash data.</p>\n\n<p>You'er probably going to need to buffer entire sectors in RAM, in order to implement flash-writing with file system-like granularity.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "edited": false, "score": 0, "creation_date": 1489574528, "post_id": 42807256, "comment_id": 72727236, "body": "Is this table located in RAM, isn&#39;t it?"}], "tags": [], "owner": {"reputation": 67, "user_id": 5410702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a5067fa1b7660167ea4883f140264b?s=128&d=identicon&r=PG&f=1", "display_name": "Mich", "link": "https://stackoverflow.com/users/5410702/mich"}, "is_accepted": false, "score": 1, "last_activity_date": 1489574180, "creation_date": 1489574180, "answer_id": 42807256, "question_id": 42806276, "link": "https://stackoverflow.com/questions/42806276/how-can-i-erase-an-internal-flash-page-not-sector-in-my-stm32f405rg-while-usi/42807256#42807256", "title": "How can I erase an internal flash Page (not sector!) in my STM32F405RG while using HAL?", "body": "<p>Usually:\ncopy a flash sector in a table, modify the page in the table, erase the sector, copy the table to the flash sector</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "is_accepted": false, "score": 1, "last_activity_date": 1489575868, "creation_date": 1489575868, "answer_id": 42807940, "question_id": 42806276, "link": "https://stackoverflow.com/questions/42806276/how-can-i-erase-an-internal-flash-page-not-sector-in-my-stm32f405rg-while-usi/42807940#42807940", "title": "How can I erase an internal flash Page (not sector!) in my STM32F405RG while using HAL?", "body": "<p>Apparently I've found my mistake. Examples I found are applied for STM32F103xx. And STM32F103xx flash-memory is really divided into pages (1 or 2 Kbytes). It is possible to erase \"sector\" that is equal to erase \"page\". But there are differences in the case of STM32F4xx where flash-memory is divided into sectors.</p>\n"}], "owner": {"reputation": 23, "user_id": 7713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-utYgLig9t1I/AAAAAAAAAAI/AAAAAAAAADc/tF14CCXlrUk/photo.jpg?sz=128", "display_name": "Vshivtsev Daniil", "link": "https://stackoverflow.com/users/7713810/vshivtsev-daniil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4716, "favorite_count": 0, "accepted_answer_id": 42806403, "answer_count": 3, "score": 1, "last_activity_date": 1489575868, "creation_date": 1489571705, "last_edit_date": 1489572118, "question_id": 42806276, "link": "https://stackoverflow.com/questions/42806276/how-can-i-erase-an-internal-flash-page-not-sector-in-my-stm32f405rg-while-usi", "title": "How can I erase an internal flash Page (not sector!) in my STM32F405RG while using HAL?", "body": "<p>I've reached a dead end trying manage the internal flash in the STM32F4 microcontroller. There are many examples but most of them use the SPL API or low-level register operations. I am using the HAL libraries. And I cannot find a function to erase just one page (in <code>stm32f4xx_hal_flash.c</code> and <code>stm32f4xx_hal_flash_ex.c</code>).\nSuggested functions such as <code>HAL_StatusTypeDef HAL_FLASHEx_Erase(FLASH_EraseInitTypeDef *pEraseInit, uint32_t *SectorError)</code> or <code>void FLASH_Erase_Sector(uint32_t Sector, uint8_t VoltageRange)</code> don't allow you to erase one page only (2048 kByte) but only a whole sector (or sectors).\nWhen I try to use something like:</p>\n\n<pre><code>void Internal_Flash_Erase(unsigned int pageAddress) {\nwhile (FLASH-&gt;SR &amp; FLASH_SR_BSY);\nif (FLASH-&gt;SR &amp; FLASH_SR_EOP) {\n    FLASH-&gt;SR = FLASH_SR_EOP;\n}\n\nFLASH-&gt;CR |= FLASH_CR_PER;\nFLASH-&gt;AR = pageAddress;\nFLASH-&gt;CR |= FLASH_CR_STRT;\nwhile (!(FLASH-&gt;SR &amp; FLASH_SR_EOP));\nFLASH-&gt;SR = FLASH_SR_EOP;\nFLASH-&gt;CR &amp;= ~FLASH_CR_PER;\n</code></pre>\n\n<p>}</p>\n\n<p>a compiler error occurs because there is no <code>FLASH-&gt;AR</code> (Adress Register) in HAL.\nI found reading the <a href=\"http://www.st.com/content/ccc/resource/technical/document/reference_manual/3d/6d/5a/66/b4/99/40/d4/DM00031020.pdf/files/DM00031020.pdf/jcr:content/translations/en.DM00031020.pdf\" rel=\"nofollow noreferrer\" title=\"RM0090 Reference manual\">RM0090 Reference manual</a> that now I need to use <code>FLASH-&gt;CR</code> instead AR and set the bits <code>FLASH_CR_SNB [3:6]</code> to choose the sector number.</p>\n\n<p>And now I don't know how to erase only one page. It is necessary for creating a Mass Storage Device in internal flash for the function:\n<code>int8_t STORAGE_Write_FS (uint8_t lun, \n                         uint8_t *buf, \n                         uint32_t blk_addr,\n                         uint16_t blk_len)\n</code> in <code>usbd_storage_if.c</code> that translates USB-stack calls to internal flash. </p>\n"}, {"tags": ["c", "linux", "file-locking"], "comments": [{"owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "edited": false, "score": 0, "creation_date": 1489574570, "post_id": 42806053, "comment_id": 72727257, "body": "You don&#39;t state a language/environment? Maybe use a counting semaphore."}, {"owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "edited": false, "score": 0, "creation_date": 1489584712, "post_id": 42806053, "comment_id": 72734567, "body": "Look at mtime and ctime; if you avoid deleting files that were created or modified in the past minute you&#39;re fine. Or the past day perhaps."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1489876216, "post_id": 42806053, "comment_id": 72864713, "body": "This is very Linux-specific, but is known to work in similar situations. Install a <code>SIGIO</code> handler (empty function is fine), and use <a href=\"http://man7.org/linux/man-pages/man2/fcntl.2.html\" rel=\"nofollow noreferrer\"><code>fcntl(fileno(handle), F_SETLEASE, F_WRLCK)</code></a> to take a write lease on the file. It will only succeed if the file is not open by any other process. (This does require that the file is owned by the same user as the running process, or that the process is running with superuser privileges.) If you do get the file lease, <code>unlink()</code>/<code>remove()</code> the file name and <code>fclose(handle)</code>; otherwise just <code>fclose(handle)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 1306600, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e1c620db61c9f51c02618382e38d2df?s=128&d=identicon&r=PG", "display_name": "Moshev", "link": "https://stackoverflow.com/users/1306600/moshev"}, "edited": false, "score": 0, "creation_date": 1489660540, "post_id": 42807129, "comment_id": 72772726, "body": "Yes, yes I know. That&#39;s why I specifically said I still need to open it by name from the same process. Basically, what happens is that one part of the program generates the file name and opens it, and keeps it open for the duration that it&#39;s used. Then another part opens it again, by name. If the directory entry is deleted between those two points, the second open will fail."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 526, "user_id": 1306600, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e1c620db61c9f51c02618382e38d2df?s=128&d=identicon&r=PG", "display_name": "Moshev", "link": "https://stackoverflow.com/users/1306600/moshev"}, "edited": false, "score": 0, "creation_date": 1489663512, "post_id": 42807129, "comment_id": 72774830, "body": "Sorry missed this part: &quot;the cache file is opened by name at various points&quot;. That looks like the real problem. Why do that? Why not have a per-process registry of open files?"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1489671062, "last_edit_date": 1489671062, "creation_date": 1489573899, "answer_id": 42807129, "question_id": 42806053, "link": "https://stackoverflow.com/questions/42806053/emulate-windows-style-file-locking-on-linux-and-os-x/42807129#42807129", "title": "Emulate Windows-style file locking on Linux and OS/X", "body": "<blockquote>\n  <p>I don't want to delete a file that's in use by another instance</p>\n</blockquote>\n\n<p>You <em>cannot</em> delete a file used by another process (or even the same process). You can delete the directory entry (or rather <em>a</em> directiry entry, as there may be more than one) that points to that file, but the file itself will remain live for as long as it's kept open by <em>any</em> process. Files in Linux are reference-counted, that's what making it work.</p>\n\n<p>An easy method to collaboratively \"lock\" a file by name would be this:</p>\n\n<pre><code>    char new_filename[FILENAME_SIZE] = \"busy_\";\n    link (filename, strcat(new_filename, filename));\n    fd = open(new_filename, \"r\");\n    if (fd) {\n        ......\n        close (fd);\n    }\n    unlink (new_filename);\n</code></pre>\n\n<p>One does <em>not</em> check the result of <code>link</code>. If everyone does this to open a file, and cleanup only unlinks the <em>original</em> name, you are set.</p>\n"}], "owner": {"reputation": 526, "user_id": 1306600, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e1c620db61c9f51c02618382e38d2df?s=128&d=identicon&r=PG", "display_name": "Moshev", "link": "https://stackoverflow.com/users/1306600/moshev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 1, "closed_date": 1489608880, "answer_count": 1, "score": 3, "last_activity_date": 1489671062, "creation_date": 1489571075, "last_edit_date": 1489660641, "question_id": 42806053, "link": "https://stackoverflow.com/questions/42806053/emulate-windows-style-file-locking-on-linux-and-os-x", "closed_reason": "Not suitable for this site", "title": "Emulate Windows-style file locking on Linux and OS/X", "body": "<p>I'm trying to get file-locking semantics on Linux that are close to what Windows offers for the purpose of not deleting cache files while they're open by a separate process. My program creates various temporary cache files that I want to delete when it closes, however multiple instances might run at the same time and I don't want to delete a file that's in use by another instance, because it will break semantics - the cache file is opened by name at various points and if deleted, that will break. I know that Linux won't physically delete the file until all open handles are closed, but I still need to open it by name.</p>\n\n<p>The name of each file uniquely identifies the contents, i.e. I know that if I need data X, it's in the cache file named hash(X), so it doesn't matter if the current instance is the one creating it, or if I'm reusing a file created by another instance. Obviously it's not exactly the hash of the data, since if I had the data, I wouldn't need cache files, but suffice to say that reusing cache files is what I want.</p>\n\n<p>My problem is that I haven't found a race-free way to lock the file with flock after opening it. Between those two calls another process might finish and run a cache cleanup operation that deletes the file I've just created. I don't need mandatory locking like on Windows, since it's only my program accessing those files, but I do need a way to keep instances from stepping on each other.</p>\n\n<p>Edit: I'm using C.</p>\n"}, {"tags": ["c", "gtk3", "gtksourceview"], "answers": [{"tags": [], "owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "is_accepted": true, "score": 0, "last_activity_date": 1489613960, "creation_date": 1489613960, "answer_id": 42821200, "question_id": 42805994, "link": "https://stackoverflow.com/questions/42805994/gtksourceview-usage-of-query-tooltip-text/42821200#42821200", "title": "gtkSourceView - usage of query-tooltip-text", "body": "<p>Ok, I checked the source-code of libgtksourceview: The string is freed by the library, the documenation for the signal-handler is just wrong.</p>\n\n<p>I filed a bug for the maintainers of the package here:\n<a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=857873\" rel=\"nofollow noreferrer\">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=857873</a></p>\n\n<p>So actually it is correct to use</p>\n\n<pre><code>...\nreturn strdup(message);\n...\n</code></pre>\n"}], "owner": {"reputation": 1427, "user_id": 1599887, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/31758de16279cc43ba0bf6094dc4260b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1599887/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 42821200, "answer_count": 1, "score": 0, "last_activity_date": 1489613960, "creation_date": 1489570933, "last_edit_date": 1489609077, "question_id": 42805994, "link": "https://stackoverflow.com/questions/42805994/gtksourceview-usage-of-query-tooltip-text", "title": "gtkSourceView - usage of query-tooltip-text", "body": "<p>I want to use the callback \"query-tooltip-text\" on my gtkSourceView. I connect the callback to the signal by using:</p>\n\n<pre><code>...\ng_signal_connect(G_OBJECT(attributes), \"query-tooltip-text\", G_CALLBACK(on_lineMarkerTooltip_displayed), context-&gt;plainTextEditor_lineMarkers[lineNumber-1]-&gt;message);\n</code></pre>\n\n<p>This works fine .. whenever the tooltip should be displayed, my method is called. <code>...-&gt;message</code> is a c-string which is in memory permanmently. Here my callback method:</p>\n\n<pre><code>gchar* on_lineMarkerTooltip_displayed(GtkSourceMarkAttributes *attributes, GtkSourceMark *mark, char* message)\n{\n    printf(\"message3: %s\\n\", message); // just to see what is going on\n    return message;\n}\n</code></pre>\n\n<p>The <a href=\"https://developer.gnome.org/gtksourceview/stable/GtkSourceMarkAttributes.html#GtkSourceMarkAttributes-query-tooltip-text\" rel=\"nofollow noreferrer\">gtk3 source doc</a> stats that I should control the lifetime of the string and free it when done, I think that should be fine.</p>\n\n<p>However my callback fails with a double-free segfault after it is called the second time:</p>\n\n<pre><code>...\nmessage3: bad hour\nmessage3: \nmessage3: `\ufffd/EV\n*** Error in `./cron-gui': double free or corruption (fasttop): 0x000056452fc70240 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x70bcb)[0x7f85670a9bcb]\n/lib/x86_64-linux-gnu/libc.so.6(+0x76f96)[0x7f85670aff96]\n/lib/x86_64-linux-gnu/libc.so.6(+0x7778e)[0x7f85670b078e]\n/usr/lib/x86_64-linux-gnu/libgtk-3.so.0(+0x214447)[0x7f85694\n...\n</code></pre>\n\n<p>So different than told in the official doc, it looks like gtk3 frees the memory of the string after usage. I tried to modify my callback accordingly like that:</p>\n\n<pre><code>gchar* on_lineMarkerTooltip_displayed(GtkSourceMarkAttributes *attributes, GtkSourceMark *mark, char* message)\n{\n    printf(\"message3: %s\\n\", message); // just to see what is going on\n    return strdup(message);\n}\n</code></pre>\n\n<p>Which works well, however I fear that my application could eat memory now.\nDo you know what is the correct usage of the <code>query-tooltip-text</code> callback ?</p>\n"}, {"tags": ["c", "compiler-errors", "compilation", "runtime-error"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1489569658, "post_id": 42805506, "comment_id": 72723769, "body": "C compiler does  not evaluate/trigger out of bounds errors on arrays. Runtime your code invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>. In your case you are probably corrupting the stack and return to main fails."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1489569731, "post_id": 42805506, "comment_id": 72723819, "body": "If you don&#39;t want to worry about such details when programming then you should probably pick a language other than C."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1489569770, "post_id": 42805506, "comment_id": 72723845, "body": "You\u2019re saying the compiler should detect that you\u2019re <code>strcpy</code>ing into a buffer of size 5 in <code>mycopy</code> from a parameter and tell you when you pass a parameter that\u2019s a variable that contains a pointer to a string literal that\u2019s bigger than that and warn? I guess that\u2019s possible. It\u2019s not really useful often enough to exist, though."}, {"owner": {"reputation": 283, "user_id": 7019536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6dd70da595d5ddb835ea7a17998c24e?s=128&d=identicon&r=PG&f=1", "display_name": "prashanthns", "link": "https://stackoverflow.com/users/7019536/prashanthns"}, "edited": false, "score": 0, "creation_date": 1489569838, "post_id": 42805506, "comment_id": 72723887, "body": "Study the difference between compile time error and run time error. I think some of the advance compilers might provide this case as warnings when warning level is kept high but in general this is not any syntactical error from C compiler perspective."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1489570815, "post_id": 42805506, "comment_id": 72724550, "body": "@LPs Thanks for sharing about &quot;undefined behavior&quot;. I was never introduced to it in my primary coding classes."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1489571004, "post_id": 42805506, "comment_id": 72724696, "body": "@PaulR Thank you for your suggestion. I appreciate your concern and love for C language. I want to worry about these details, hence I willed to ask this question on SO. All I am asking is the concept behind getting this error and the reason why is it not a compile-time error but a runtime error."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1489571157, "post_id": 42805506, "comment_id": 72724797, "body": "@Ryan Yes, that&#39;s what exactly I am suggesting. I always had a hard time differentiating between compile-time and runtime errors. Moreover, I believe this a case of &quot;undefined behavior&quot; which got me all messed up in my head."}, {"owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "reply_to_user": {"reputation": 283, "user_id": 7019536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6dd70da595d5ddb835ea7a17998c24e?s=128&d=identicon&r=PG&f=1", "display_name": "prashanthns", "link": "https://stackoverflow.com/users/7019536/prashanthns"}, "edited": false, "score": 0, "creation_date": 1489571183, "post_id": 42805506, "comment_id": 72724812, "body": "@prashanthns Thanks for your input."}, {"owner": {"reputation": 15221, "user_id": 1023911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Wln26.jpg?s=128&g=1", "display_name": "Werner Henze", "link": "https://stackoverflow.com/users/1023911/werner-henze"}, "edited": false, "score": 0, "creation_date": 1489572433, "post_id": 42805506, "comment_id": 72725713, "body": "The space in <code># include</code> and <code># define</code> is at least very unusual."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489574511, "post_id": 42805506, "comment_id": 72727228, "body": "Because the compiler can&#39;t tell that it is a bug, or it simply doesn&#39;t care. There is no requirement from the C standard that the compiler must raise a diagnostic upon encountering this code. The whole responsibility of the bounds-checking falls on the programmer."}], "answers": [{"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1489572131, "creation_date": 1489572131, "answer_id": 42806427, "question_id": 42805506, "link": "https://stackoverflow.com/questions/42805506/executable-not-running/42806427#42806427", "title": "Executable not running", "body": "<p>The C11 standard says the following in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.4\" rel=\"nofollow noreferrer\">7.1.4. Use of  library functions</a>:</p>\n\n<blockquote>\n  <p>If a function argument is described as being an array, *the pointer actually passed to the function <strong>shall</strong> have a value such that <strong><em>all</em> address computations and accesses to objects (that would be valid if the pointer did point to the first element of such an array) are in fact valid.</strong></p>\n</blockquote>\n\n<p>And of <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.24.2.3\" rel=\"nofollow noreferrer\"><code>strcpy</code></a></p>\n\n<blockquote>\n  <p>2 The strcpy function copies the string pointed to by s2 (including the terminating null character) into the <strong>array pointed to by s1.</strong></p>\n</blockquote>\n\n<p>And in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">Appendix J.2 Undefined behavior</a>:</p>\n\n<blockquote>\n  <p>1 The behavior is undefined in the following circumstances: \n  The pointer passed to a library function array parameter does not have a value such that all address computations and object accesses are valid (7.1.4).</p>\n</blockquote>\n\n<p>Since the behaviour is undefined, according to standard, anything can happen. A compiler is actually <em>allowed</em> to do compile-time bounds checking, and the compilation might very well be aborted if it can be deduced that the program always writes out of bounds. Or the implementation can support range checking and abort with clear diagnostics. Or the <code>strcpy</code> might just copy the 4 first characters and add a terminating null, or copy <code>42</code> into the target string instead - and all these implementations would be standard-conforming.</p>\n"}], "owner": {"reputation": 4671, "user_id": 4927751, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VwUAi.jpg?s=128&g=1", "display_name": "Kshitij Saraogi", "link": "https://stackoverflow.com/users/4927751/kshitij-saraogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1489572131, "creation_date": 1489569568, "question_id": 42805506, "link": "https://stackoverflow.com/questions/42805506/executable-not-running", "title": "Executable not running", "body": "<p>I have the following code:</p>\n\n<pre><code># include&lt;stdio.h&gt;\n# include&lt;string.h&gt;\n# define M 5 \n\nvoid mycopy(char* text)\n{\n     char buffer[M];\n     strcpy(buffer, text);\n}\n\nint main()\n{\n    char *name = \"Kshitij\";\n    int i = 0;\n    mycopy(name);\n    printf(\"i = %d\", i);\n    return 0;\n}\n</code></pre>\n\n<p>This code compiles in GCC on Apple LLVM version 8.0.0 (clang-800.0.42.1).\nHowever, when I try to run the corresponding executable, I get a process <code>abort</code> output such as:</p>\n\n<pre><code>[1]    PID abort     ./executable.out\n</code></pre>\n\n<p>I understand that an error is expected since the size of <code>buffer</code> array is less than the length of <code>text</code> argument being passed to it in this case. However, I am unable to understand to grasp the concept behind this behavior. Why isn't a compile-time error stating the reason raised by the compiler here ?</p>\n"}, {"tags": ["c", "struct", "malloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489569434, "post_id": 42805428, "comment_id": 72723620, "body": "From where you&#39;re learning C? Seems not so trustworthy..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489569456, "post_id": 42805428, "comment_id": 72723632, "body": "C is process oriented, not source code line number oriented (i.e., a script)..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1489570008, "post_id": 42805428, "comment_id": 72724012, "body": "Your code seems to have spilled out of <code>main</code> in random directions. You best collect it all back there."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489574698, "post_id": 42805428, "comment_id": 72727348, "body": "The question can&#39;t be answered since the code doesn&#39;t make any sense. You need to study the very basics of program flow before you do anything else."}, {"owner": {"reputation": 5, "user_id": 7713796, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c9a6a16321482ac1739e031feddd64c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7713796/lee"}, "edited": false, "score": 0, "creation_date": 1489575869, "post_id": 42805428, "comment_id": 72728218, "body": "I know the code is a mess, i&#39;m just typing things while I try to learn this. I&#39;ll be fixing the main once I get it."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1489589185, "post_id": 42805428, "comment_id": 72738292, "body": "It is difficult to offer solutions when the problem statement is simply, &quot;it doesn&#39;t work&quot;.  Please <a href=\"https://stackoverflow.com/posts/42805428/edit\">edit</a> your question to give a more complete description of what you expected to happen and how that differs from the actual results.  See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for hints on what makes a good explanation."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7713796, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c9a6a16321482ac1739e031feddd64c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7713796/lee"}, "edited": false, "score": 0, "creation_date": 1489575867, "post_id": 42806703, "comment_id": 72728216, "body": "Where did you get struct Date from? Supposed to be Dates?"}, {"owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "reply_to_user": {"reputation": 5, "user_id": 7713796, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c9a6a16321482ac1739e031feddd64c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7713796/lee"}, "edited": false, "score": 0, "creation_date": 1489583106, "post_id": 42806703, "comment_id": 72733327, "body": "That&#39;s a mistake the OP is making. The struct holds only one date, it should not be plural. The array can be &quot;date&quot; or &quot;dates&quot; according to taste."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 0, "last_activity_date": 1489572828, "creation_date": 1489572828, "answer_id": 42806703, "question_id": 42805428, "link": "https://stackoverflow.com/questions/42805428/c-how-to-use-structs-and-malloc-with-variable-input/42806703#42806703", "title": "C how to use structs and malloc with variable input", "body": "<p>You have the number of dates as the user enter it. So allocate them</p>\n\n<pre><code>  ndates = // user input\n  struct Date *date = malloc(Ndates * sizeof(struct Date));\n</code></pre>\n\n<p>Then load them in</p>\n\n<pre><code>   for(i=0;i&lt;ndates;i++)\n   {\n       scanf(\"%d %d %d \", &amp;date[i].month, &amp;date[i].day. &amp;date[i].year);\n   }\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7713796, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c9a6a16321482ac1739e031feddd64c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/7713796/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1489593329, "creation_date": 1489569318, "last_edit_date": 1489593329, "question_id": 42805428, "link": "https://stackoverflow.com/questions/42805428/c-how-to-use-structs-and-malloc-with-variable-input", "title": "C how to use structs and malloc with variable input", "body": "<p>My problem has changed, I need so sort my list of dates but having problems with it not sorting years and months properly. If I comment out and just sort by days it works fine.</p>\n\n<p>Input n (1&lt;=n&lt;=10000) and then followed by n lines. Each line corresponds to a valid date, consisting of one string (\"January\", \"February\", ..., or \"December\"), one integer between 1 and 31, and one two digit integer representing the year (from 90 to 99, and then from 00 to 12). You do not have to worry about date validation. All dates in the input are valid dates.\nPlease use structures to store the dates. Please use malloc to dynamically allocate just enough space for n structures. You are asked to sort the dates chronologically using the built-in qsort function. Please output the sorted list, one date per line, from most recent date to oldest. Please also use the built-in bsearch function to allow for a user query to check whether a specific date is in the list, and output either \"Yes\" or \"No\".</p>\n\n<p>INPUT-\nn, the number of dates to sort, followed by n dates, followed by a user query in format day month year (e.g. \u201c1 1 00\u201d or \u201c31 3 68\u201d).\n(Note this is a different format as the rest of the dates are presented in)</p>\n\n<p>OUTPUT-\nSorted list of dates, followed by \u201cYes\u201d or \u201cNo\u201d to indicate whether the query date input by the user (e.g. 1 1 00 day month year) is in the list.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define MIN_SIZE 0\n#define MAX_SIZE 100\n#define MAX_MONTH_STR 9\n\n//Define a struct data type\ntypedef struct{\nchar* month;\nint day;\nint year;\nint monthnum;\n}date;\n\n //Method to allocate memory for a list of date structures\ndate* allocateStruct(int size){\n\n//Declaration of variables\ndate *datearray;\nint i;\n\n//Allocate memory for rows (to store 'size' many pointers to 'date' struct data type)\ndatearray = malloc(size*sizeof(date));\n\n//For-loop to allocate memory for columns (to store 'size' many integers, and initialize them to zero)\nfor (i=0; i&lt;size; i++){\n    datearray[i].month = calloc(MAX_MONTH_STR,sizeof(char));\n    datearray[i].day = 0;\n    datearray[i].year = 0;\n\n    }\nreturn datearray;\n}\n\nint compare(const void *s1, const void *s2){\n   date *date1 = ( date *)s1;\n   date *date2 = ( date *)s2;\n\n  //if year not equal sort year\nif (date2-&gt;year != date1-&gt;year){\n    int year2 = date2-&gt;year;\n    int year1 = date2-&gt;year;\n    if (year1&lt;14){\n        year1 = year1+100;\n    }\n    if (year2&lt;14){\n        year2 = year2+100;\n    }\n    int yearcompare = year2 - year1;\n    return -yearcompare;\n}\nelse if (date2-&gt;monthnum != date1-&gt;monthnum){\n    //else if month not equal sort month\n    int monthcompare = date2-&gt;monthnum - date1-&gt;monthnum;\n    return -monthcompare;\n}\nelse if (date2-&gt;day != date1-&gt;day){\n    //else sort day\n    int daycompare = date2-&gt;day - date1-&gt;day;\n    return -daycompare;\n    }\n}\n    //  if (daycompare == 0)\n//    return date1-&gt;id - date2-&gt;id;\n//  else\n\n int main(){\n//Declaration of variables\nint n;\ndate* date_list;\nint i, j, k; //used in loops\n\n//Read input\ndo{\n    //printf(\"Enter number of dates you want to enter (between 1 and 10000):\\n\");\n    scanf(\"%d\", &amp;n);\n}\nwhile(n&lt;MIN_SIZE || n&gt;MAX_SIZE);\n\n//ALLOCATE MEMORY\ndate_list = allocateStruct(n);\n\n\n//For-loop to store values in 'date_list'\nfor (i=0; i&lt;n; i++){\n    //printf(\"Enter the date (month day year) in the following format: text number number\");\n    scanf(\"%s\", date_list[i].month);\n    scanf(\"%d\", &amp;date_list[i].day);\n    scanf(\"%d\", &amp;date_list[i].year);\n\n    if      (strcmp(date_list[i].month,\"January\")==0){date_list[i].monthnum=1;}\n    else if (strcmp(date_list[i].month,\"February\")==0){date_list[i].monthnum=2;}\n    else if (strcmp(date_list[i].month,\"March\")==0){date_list[i].monthnum=3;}\n    else if (strcmp(date_list[i].month,\"April\")==0){date_list[i].monthnum=4;}\n    else if (strcmp(date_list[i].month,\"May\")==0){date_list[i].monthnum=5;}\n    else if (strcmp(date_list[i].month,\"June\")==0){date_list[i].monthnum=6;}\n    else if (strcmp(date_list[i].month,\"July\")==0){date_list[i].monthnum=7;}\n    else if (strcmp(date_list[i].month,\"August\")==0){date_list[i].monthnum=8;}\n    else if (strcmp(date_list[i].month,\"September\")==0){date_list[i].monthnum=9;}\n    else if (strcmp(date_list[i].month,\"October\")==0){date_list[i].monthnum=10;}\n    else if (strcmp(date_list[i].month,\"Novermber\")==0){date_list[i].monthnum=11;}\n    else if (strcmp(date_list[i].month,\"December\")==0){date_list[i].monthnum=12;}\n\n}\n\n\n\n\nqsort(date_list, n, sizeof(date), compare);\n\n//Test print\nfor (i=0; i&lt;n; i++){\n    //printf(\"Enter the date (month day year) in the following format: text number number\");\n    printf(\"%s \", date_list[i].month);\n    printf(\"%d \", date_list[i].day);\n    printf(\"%d\\n\", date_list[i].year);\n    printf(\"%s = %d \\n\\n\", date_list[i].month, date_list[i].monthnum);\n}\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "asterisk"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489569432, "post_id": 42805383, "comment_id": 72723619, "body": "Smells like you can&#39;t pass <code>NULL</code> as third parameter of <code>stasis_subscribe</code> function"}, {"owner": {"reputation": 13, "user_id": 5966093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KWkgXhXJzRI/AAAAAAAAAAI/AAAAAAAAAHM/FR98Xejr_00/photo.jpg?sz=128", "display_name": "Through Lee", "link": "https://stackoverflow.com/users/5966093/through-lee"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489570717, "post_id": 42805383, "comment_id": 72724487, "body": "This is how asterisk officially did in the source code,should be right."}], "answers": [{"tags": [], "owner": {"reputation": 14851, "user_id": 861388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e67c6ded563e65de617062d3c47d79c2?s=128&d=identicon&r=PG", "display_name": "arheops", "link": "https://stackoverflow.com/users/861388/arheops"}, "is_accepted": false, "score": 0, "last_activity_date": 1489569590, "creation_date": 1489569590, "answer_id": 42805517, "question_id": 42805383, "link": "https://stackoverflow.com/questions/42805383/asterisk-stasis-subscribe/42805517#42805517", "title": "Asterisk stasis subscribe", "body": "<p>This question is debug one.</p>\n\n<ol>\n<li>Compile asterisk with debug symbols</li>\n<li>Enable core dump in asterisk.conf</li>\n<li>Start asterisk.</li>\n<li>Check core dump with GDB</li>\n</ol>\n\n<p><a href=\"https://wiki.asterisk.org/wiki/display/AST/Getting+a+Backtrace\" rel=\"nofollow noreferrer\">https://wiki.asterisk.org/wiki/display/AST/Getting+a+Backtrace</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5966093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KWkgXhXJzRI/AAAAAAAAAAI/AAAAAAAAAHM/FR98Xejr_00/photo.jpg?sz=128", "display_name": "Through Lee", "link": "https://stackoverflow.com/users/5966093/through-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489569590, "creation_date": 1489569168, "question_id": 42805383, "link": "https://stackoverflow.com/questions/42805383/asterisk-stasis-subscribe", "title": "Asterisk stasis subscribe", "body": "<p>I added a custom module to <code>apps/</code> folder for registerd to the <code>ast_channel_topic_all</code> topic.Unfortunately asterisk occured segment fault every load the moudle.</p>\n\n<pre><code>#include \"asterisk.h\"\n#include \"asterisk/module.h\"\n#include \"asterisk/json.h\"\n#include \"asterisk/stasis.h\"\n#include \"asterisk/stasis_channels.h\"\n#include \"asterisk/manager.h\"\n\nASTERISK_FILE_VERSION(__FILE__, \"$Revision$\")\n#define AST_MODULE \"stasis_test\"\n\nstatic struct stasis_subscription *queue_stasis_message_sub;\n\nstatic void queue_subscribe_callback(void *data, struct stasis_subscription    *sub, struct stasis_topic *topic, struct stasis_message *message){\n\n    struct ast_channel_blob *payload = stasis_message_data(message);\n    // ...\n}\n\nstatic int unload_module(void) {\n\n    stasis_unsubscribe_and_join(queue_stasis_message_sub);\n\n    return 0;\n}\n\nstatic int load_module(void) {\n\n    queue_stasis_message_sub = stasis_subscribe(ast_channel_topic_all(),     queue_subscribe_callback, NULL);\n\n    if ( !queue_stasis_message_sub ) {\n        unload_module();\n        return AST_MODULE_LOAD_DECLINE;\n    }\n\n    return AST_MODULE_LOAD_SUCCESS;\n}\n\nAST_MODULE_INFO(\n    ASTERISK_GPL_KEY, AST_MODFLAG_LOAD_ORDER, AST_MODULE,\n    .load = load_module,\n    .unload = unload_module\n);\n</code></pre>\n\n<p>What cause this error? Looking forward to your reply.\nBTW,The asterisk version I'm using is 13.10.</p>\n"}, {"tags": ["c", "session", "service"], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 4207672, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100008458208551/picture?type=large", "display_name": "Omega Doe", "link": "https://stackoverflow.com/users/4207672/omega-doe"}, "is_accepted": false, "score": 1, "last_activity_date": 1489576673, "creation_date": 1489576673, "answer_id": 42808235, "question_id": 42804934, "link": "https://stackoverflow.com/questions/42804934/monitor-session-change-event-in-c/42808235#42808235", "title": "monitor session change event in c", "body": "<p>gSvcStatusHandle = RegisterServiceCtrlHandler(SVCNAME,SvcCtrlHandler,NULL);</p>\n\n<p>should be :\ngSvcStatusHandle = RegisterServiceCtrlHandlerEx(SVCNAME,SvcCtrlHandler,NULL);</p>\n"}], "owner": {"reputation": 305, "user_id": 4207672, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100008458208551/picture?type=large", "display_name": "Omega Doe", "link": "https://stackoverflow.com/users/4207672/omega-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1489576673, "creation_date": 1489567827, "question_id": 42804934, "link": "https://stackoverflow.com/questions/42804934/monitor-session-change-event-in-c", "title": "monitor session change event in c", "body": "<p>I try to build a service that monitor user sessions activity. currently focusing on logon and lock of user.\ni am using <a href=\"http://msdn.microsoft.com/en-us/library/bb540475(v=VS.85).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/bb540475(v=VS.85).aspx</a> example</p>\n\n<p>my code :</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;strsafe.h&gt;\n#pragma comment(lib, \"advapi32.lib\")\n\n#define SVCNAME TEXT(\"SvcName\")\n#define SVC_ERROR 4\n\nSERVICE_STATUS          gSvcStatus;\nSERVICE_STATUS_HANDLE   gSvcStatusHandle;\nHANDLE                  ghSvcStopEvent = NULL;\nVOID SvcInstall(void);\nDWORD WINAPI SvcCtrlHandler(DWORD , DWORD , LPVOID , LPVOID );\n\nVOID WINAPI SvcMain(DWORD, LPTSTR *);\n\nVOID ReportSvcStatus(DWORD, DWORD, DWORD);\nVOID SvcInit(DWORD, LPTSTR *);\nVOID SvcReportEvent(LPTSTR);\n\n\n\nvoid __cdecl _tmain(int argc, TCHAR *argv[])\n{\n\nif (lstrcmpi(argv[1], TEXT(\"install\")) == 0)\n{\n    SvcInstall();\n    return;\n}\n\nSERVICE_TABLE_ENTRY DispatchTable[] =\n{\n    { SVCNAME, (LPSERVICE_MAIN_FUNCTION)SvcMain },\n    { NULL, NULL }\n};\n\nif (!StartServiceCtrlDispatcher(DispatchTable))\n{\n    SvcReportEvent(TEXT(\"StartServiceCtrlDispatcher\"));\n}\n}\n\nVOID SvcInstall()\n{\nSC_HANDLE schSCManager;\nSC_HANDLE schService;\nTCHAR szPath[MAX_PATH];\n\nif (!GetModuleFileName(NULL, szPath, MAX_PATH))\n{\n    printf(\"Cannot install service (%d)\\n\", GetLastError());\n    return;\n}\n\nschSCManager = OpenSCManager(\n    NULL,                    // local computer\n    NULL,                    // ServicesActive database \n    SC_MANAGER_ALL_ACCESS);  // full access rights \n\nif (NULL == schSCManager)\n{\n    printf(\"OpenSCManager failed (%d)\\n\", GetLastError());\n    return;\n}\n\n// Create the service\n\nschService = CreateService(\n    schSCManager,              // SCM database \n    SVCNAME,                   // name of service \n    SVCNAME,                   // service name to display \n    SERVICE_ALL_ACCESS,        // desired access \n    SERVICE_WIN32_OWN_PROCESS, // service type \n    SERVICE_AUTO_START,      // start type \n    SERVICE_ERROR_NORMAL,      // error control type \n    szPath,                    // path to service's binary \n    NULL,                      // no load ordering group \n    NULL,                      // no tag identifier \n    NULL,                      // no dependencies \n    NULL,                      // LocalSystem account \n    NULL);                     // no password \n\nif (schService == NULL)\n{\n    printf(\"CreateService failed (%d)\\n\", GetLastError());\n    CloseServiceHandle(schSCManager);\n    return;\n}\nelse printf(\"Service installed successfully\\n\");\n\nCloseServiceHandle(schService);\nCloseServiceHandle(schSCManager);\n}\n\nVOID WINAPI SvcMain(DWORD dwArgc, LPTSTR *lpszArgv)\n{\n\ngSvcStatusHandle = RegisterServiceCtrlHandler(SVCNAME,SvcCtrlHandler,NULL);\nOutputDebugString(L\"\\n***SVCMAIN\");\nif (!gSvcStatusHandle)\n{\n    SvcReportEvent(TEXT(\"RegisterServiceCtrlHandler\"));\n    return;\n}\n\ngSvcStatus.dwServiceType = SERVICE_WIN32_OWN_PROCESS;\ngSvcStatus.dwServiceSpecificExitCode = 0;\n\nReportSvcStatus(SERVICE_START_PENDING, NO_ERROR, 3000);\n\nSvcInit(dwArgc, lpszArgv);\n}\n\nVOID SvcInit(DWORD dwArgc, LPTSTR *lpszArgv)\n{\nFILE *f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\nOutputDebugString(L\"\\n***SVCINIT\");\nfprintf(f, \"init\\n\");\nfclose(f);\n\nghSvcStopEvent = CreateEvent(\n    NULL,    // default security attributes\n    TRUE,    // manual reset event\n    FALSE,   // not signaled\n    NULL);   // no name\n\nif (ghSvcStopEvent == NULL)\n{\n    ReportSvcStatus(SERVICE_STOPPED, NO_ERROR, 0);\n    return;\n}\n\nReportSvcStatus(SERVICE_RUNNING, NO_ERROR, 0);\n\nwhile (WaitForSingleObject(ghSvcStopEvent, 3000) != WAIT_OBJECT_0){\n    OutputDebugString(L\"\\n***BEEP\");\n\n    f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\n    fprintf(f, \"beep\\n\");\n    fclose(f);\n    Beep(1000, 100);\n\n}\nReportSvcStatus(SERVICE_STOPPED, NO_ERROR, 0);\n\n}\n\nVOID ReportSvcStatus(DWORD dwCurrentState,\nDWORD dwWin32ExitCode,\nDWORD dwWaitHint)\n{\nstatic DWORD dwCheckPoint = 1;\nDWORD my_error = 0;\n\n// Fill in the SERVICE_STATUS structure.\n\ngSvcStatus.dwCurrentState = dwCurrentState;\ngSvcStatus.dwWin32ExitCode = dwWin32ExitCode;\ngSvcStatus.dwWaitHint = dwWaitHint;\ngSvcStatus.dwControlsAccepted = SERVICE_ACCEPT_SESSIONCHANGE | SERVICE_ACCEPT_STOP;\n\nif ((dwCurrentState == SERVICE_RUNNING) ||\n    (dwCurrentState == SERVICE_STOPPED)){   \ngSvcStatus.dwCheckPoint = 0;\n}\nelse gSvcStatus.dwCheckPoint = dwCheckPoint++;\n\n// Report the status of the service to the SCM.\nSetServiceStatus(gSvcStatusHandle, &amp;gSvcStatus);\nmy_error = GetLastError();\nFILE *f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\nfprintf(f, \"last error  %d  \\n\",my_error);\nfprintf(f, \"\\n***controls accepted %d ***\\n\",     gSvcStatus.dwControlsAccepted);\nfclose(f);\n\n}\n\nDWORD WINAPI SvcCtrlHandler(DWORD dwControl, DWORD dwEventType, LPVOID     lpEventData, LPVOID lpContext)\n{\nDWORD dwErrorCode = NO_ERROR;\n\nFILE *f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\n// Handle the requested control code. \nfprintf(f, \"dwCtrl is = %d \\n\", dwControl);\nfclose(f);\n\nswitch (dwControl)\n{\n\ncase SERVICE_CONTROL_TIMECHANGE:\n    f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\n    fprintf(f, \"time\\n\");\n    fclose(f);\n    OutputDebugString(L\"\\n****GOT time!!!\\n\\n\");\n    SetEvent(ghSvcStopEvent);\n    ReportSvcStatus(gSvcStatus.dwCurrentState, NO_ERROR, 0);\n    break;\n\ncase SERVICE_CONTROL_SESSIONCHANGE:\n    f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\n    fprintf(f, \"session\\n\");\n    fclose(f);\n    OutputDebugString(L\"\\n****GOT Session!\\n\\n\");\n    SetEvent(ghSvcStopEvent);\n    ReportSvcStatus(gSvcStatus.dwCurrentState, NO_ERROR, 0);\n    break;\n\ncase SERVICE_CONTROL_STOP:\n    OutputDebugString(L\"\\n****GOT STOP!\\n\\n\");\n    f = fopen(\"c:\\\\test\\\\file.txt\", \"a\");\n    fprintf(f, \"stop\\n\");\n    fclose(f);\n    ReportSvcStatus(SERVICE_STOP_PENDING, NO_ERROR, 0);\n\n    SetEvent(ghSvcStopEvent);\n    ReportSvcStatus(gSvcStatus.dwCurrentState, NO_ERROR, 0);\n\n    return;\n\ncase SERVICE_CONTROL_INTERROGATE:\n\n    break;\n\ndefault:\n    break;\n}\n\n}\n\nVOID SvcReportEvent(LPTSTR szFunction)\n{\nHANDLE hEventSource;\nLPCTSTR lpszStrings[2];\nTCHAR Buffer[80];\n\nhEventSource = RegisterEventSource(NULL, SVCNAME);\n\nif (NULL != hEventSource)\n{\n    StringCchPrintf(Buffer, 80, TEXT(\"%s failed with %d\"), szFunction, GetLastError());\n\n    lpszStrings[0] = SVCNAME;\n    lpszStrings[1] = Buffer;\n\n    ReportEvent(hEventSource,        // event log handle\n        EVENTLOG_ERROR_TYPE, // event type\n        0,                   // event category\n        SVC_ERROR,           // event identifier\n        NULL,                // no security identifier\n        2,                   // size of lpszStrings array\n        0,                   // no binary data\n        lpszStrings,         // array of strings\n        NULL);               // no binary data\n\n    DeregisterEventSource(hEventSource);\n}\n}\n</code></pre>\n\n<p>any ideas why i am not getting any  \"case SERVICE_CONTROL_SESSIONCHANGE\" and only stop?\nin my log file i see the beep log and controls accepted - 129 (stop + session change)\nthis is my log file content :</p>\n\n<pre><code>last error  0  \n\n***controls accepted 129 ***\ninit\nlast error  0  \n\n***controls accepted 129 ***\nbeep\nbeep\nbeep\nbeep\nbeep\n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets", "server"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1489589327, "post_id": 42804643, "comment_id": 72738394, "body": "Please <a href=\"https://stackoverflow.com/posts/42804643/edit\">edit</a> your code to reduce it to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem.  Your current code includes much that is peripheral to your problem - a minimal sample normally looks similar to a good unit test: only performing one task, with input values specified for reproducibility."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1489625397, "post_id": 42804643, "comment_id": 72758206, "body": "I&#39;m fairly certain that opening a new thread per connection is a bad idea. Multi-threaded servers often use a thread pool rather than a thread-per-client, since context-switching can become expensive when opening too many threads (it&#39;s easier to experience DoS when using a thread-per-client design)... you can read through <a href=\"http://facil.io\" rel=\"nofollow noreferrer\">facil.io</a> as an example for my proposed approach."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489775294, "post_id": 42804643, "comment_id": 72835658, "body": "the posted code fails to cleanly compile.  When compiling, always enable all the warnings, then fix those warnings. (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -pedantic</code>  I also use: <code>-Wconversion -std=gnu11</code> )   Using these parameters to <code>gcc</code>, the posted code produces 25 warnings, several of which are very serious. (so perhaps also use: <code>-Werror</code> )"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7244241, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209327748383043/picture?type=large", "display_name": "Gregory Gould", "link": "https://stackoverflow.com/users/7244241/gregory-gould"}, "edited": false, "score": 0, "creation_date": 1489569037, "post_id": 42805144, "comment_id": 72723360, "body": "I appreciate it. I kinda thought A LOT was up. How do I correctly start a thread the runs threadFunction rather than simply calling it?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 11, "user_id": 7244241, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209327748383043/picture?type=large", "display_name": "Gregory Gould", "link": "https://stackoverflow.com/users/7244241/gregory-gould"}, "edited": false, "score": 0, "creation_date": 1489569734, "post_id": 42805144, "comment_id": 72723822, "body": "The call is done by the <code>()</code>, so just give the name of the function (which evaluates to a function pointer, when needed). Something like <code>pthread_create(&amp;thread[threadNumber], NULL, threadFunction, (void *) snew);</code>. This passes <code>snew</code> as the thread&#39;s argument. If you can&#39;t figure this out from e.g. <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\">the manual page</a>, I think you need to study some more. :)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489775720, "post_id": 42805144, "comment_id": 72835905, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489775759, "post_id": 42805144, "comment_id": 72835932, "body": "usually better to separate a struct definition from the declaration of an instance of that struct."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489775816, "post_id": 42805144, "comment_id": 72835968, "body": "there are only a very few system functions that are &#39;safe&#39; to use in a signal handler function.  <code>fprintf()</code> and <code>printf()</code> are not amongst them"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489775996, "post_id": 42805144, "comment_id": 72836086, "body": "function: <code>processMessage()</code> is returning a struct rather than a pointer to a struct.  If the struct is larger than a couple of CPU registers, then problems arise.  Strongly suggest calling <code>malloc()</code> to get memory for the struct then returning a pointer to that memory"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489776296, "post_id": 42805144, "comment_id": 72836263, "body": "regarding this format string: <code>&quot;%*c%d%c%d\\n%[^\\n]s&quot;</code> the final <code>s</code> (unless every message will end in a superficial <code>s</code>,) should not be part of the format string."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489776418, "post_id": 42805144, "comment_id": 72836331, "body": "the call to <code>sscanf()</code> will always place (at least) a NUL byte into the <code>entry[]</code> array, so this statement: <code>strcpy(Server.string,entry);</code> will always work,  so the code block beginning with: <code>if (numBytes == 0)</code> does nothing and should be removed"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489776792, "post_id": 42805144, "comment_id": 72836547, "body": "the posted code contains several &#39;magic&#39; numbers.  &#39;magic&#39; numbers are numbers with to basis.  Suggest using a <code>enum</code> statement or <code>#define</code> statements to give those &#39;magic&#39; numbers meaningful names, Then use those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489776838, "post_id": 42805144, "comment_id": 72836572, "body": "for ease of readability and understanding, follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489777270, "post_id": 42805144, "comment_id": 72836811, "body": "the variable <code>*Server</code> is defined in two places,  Both places are in the file global name space.  once at line 25 and again at line 29"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489777372, "post_id": 42805144, "comment_id": 72836856, "body": "What happens when <code>totalSize</code> is &lt; 2?  Note: <code>totalSize</code> is the number of lines in the file, not the total length of any/all lines"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489777523, "post_id": 42805144, "comment_id": 72836946, "body": "function: <code>readFile()</code> opens the same file twice, for the same mode, in the same file pointer, with out an intermediate call to <code>fclose()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489777693, "post_id": 42805144, "comment_id": 72837056, "body": "when calling any of the <code>scanf()</code> family of functions, always check the returned value (not the parameter values) to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489777876, "post_id": 42805144, "comment_id": 72837136, "body": "regarding this line: <code>sscanf(individualLine,&quot;%[^\\n]s&quot;,string);</code> the trailing <code>s</code> in the format string should not be there.  the <code>[^\\n]</code> will not read the newline so that would be next in the input, not a <code>s</code>  So, most likely the call to <code>sscanf()</code> will fail.  Suggest removing that trailing <code>s</code> from the format string."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489778053, "post_id": 42805144, "comment_id": 72837214, "body": "this line: <code>void *threadFunction(int snew)</code> should be: <code>void *threadFunction( void* data)</code> Note: correct the call to <code>pthread_create()</code> also.  and the first line in the body of the function should be: `int snew = (int)*data;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489778377, "post_id": 42805144, "comment_id": 72837383, "body": "when declaring a mutex, it needs to be initialized,  use either <code>pthread_mutex_t lock = PTHREAD_MUTEX_INITIALIZER;</code>  -or-  <code>pthread_mutex_t lock; pthread_mutex_init ( &amp;lock, NULL);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489778474, "post_id": 42805144, "comment_id": 72837440, "body": "when calling <code>send()</code> or <code>recv()</code>, always check the returned value to assure the operation was successful."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489778567, "post_id": 42805144, "comment_id": 72837489, "body": "when exiting a pthread function, use: <code>pthread_exit( &amp;status );</code>  where <code>status</code> is an integer that contains the return status from the function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489778760, "post_id": 42805144, "comment_id": 72837581, "body": "when the incorrect number of command line parameters was entered by the user, out a USAGE message to stderr, not stdout, that indicates how the program should have been invoked.   This is usually a statement similar to <code>fprintf( stdere, &quot;USAGE: %s .,... \\n&quot;, argv[0] );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1489779150, "post_id": 42805144, "comment_id": 72837770, "body": "this code sequence: <code>snew = accept (sock, (struct sockaddr*) &amp; from, &amp; fromlength);     printf(&quot;Miney, &quot;);     if (snew &lt; 0)     {       perror (&quot;Server: accept failed&quot;);       exit (1);     }</code> will not work correctly when an error occurs, because the interviening call to <code>printf()</code> will have changed the value of <code>errno</code> and <code>perror()</code> outputs its&#39; message depending on the value of <code>errno</code>"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1489568434, "creation_date": 1489568434, "answer_id": 42805144, "question_id": 42804643, "link": "https://stackoverflow.com/questions/42804643/segfault-on-server-after-multithreading-in-c/42805144#42805144", "title": "Segfault on Server after Multithreading in C", "body": "<p>You seem to somehow expect this:</p>\n\n<pre><code>pthread_create(&amp;thread[threadNumber],NULL,threadFunction(snew), &amp;id[threadNumber]);\n/* ... */\nclose (snew);\n</code></pre>\n\n<p>To make sense, while it clearly doesn't.</p>\n\n<p>Instead of starting a thread that runs <code>threadFunction</code>, passing it <code>snew</code>, you <em>call</em> the thread function and pass the return value to <code>pthread_create()</code>, which will interpret it as a function pointer. This will break, especially considering that the thread function incorrectly ends with:</p>\n\n<pre><code>return;\n</code></pre>\n\n<p>This shouldn't compile, since it's declared to return <code>void *</code>.</p>\n\n<p>Also assuming you managed to start the thread, passing it <code>snew</code> to use as its socket: then you immediately close that socket, causing any reference to it from the thread to be invalid!</p>\n\n<p>Please note that <code>pthread_create()</code> does not block and wait for the thread to exit, that would be kind of ... pointless. It starts off the new thread to run in parallel with the main thread, so of course you can't yank the carpet away from under it.</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1489570673, "last_edit_date": 1592644375, "creation_date": 1489570673, "answer_id": 42805908, "question_id": 42804643, "link": "https://stackoverflow.com/questions/42804643/segfault-on-server-after-multithreading-in-c/42805908#42805908", "title": "Segfault on Server after Multithreading in C", "body": "<p>This signal handler is completely unsafe:</p>\n<pre><code>void sigint_handler(int sig) \n{\n    if (debug) printf(&quot;\\nInduced SIGINT.\\n&quot;);\n\n    FILE *fp;\n    fp=fopen(&quot;whiteboard.all&quot;,&quot;w&quot;);\n\n    int x=0;\n    for (x;x&lt;serverSize;x++) // Loop Responsible for iterating all the whiteboard entries.\n    {\n        if (debug) printf(&quot;@%d%c%d\\n%s\\n&quot;,Server[x].line,Server[x].type,Server[x].bytes,Server[x].string);\n        fprintf(fp,&quot;@%d%c%d\\n%s\\n&quot;,Server[x].line,Server[x].type,Server[x].bytes,Server[x].string);\n    }\n\n    if (debug) printf(&quot;All values stored.\\n&quot;);\n\n    free(Server); // Free dynamically allocated memory\n\n\n    exit(1);\n\n}\n</code></pre>\n<p><a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04_03\" rel=\"nofollow noreferrer\">Per <strong>2.4.3 Signal Actions</strong> of the POSIX standard</a> (emphasis added):</p>\n<blockquote>\n<p>The following table defines a set of functions that shall be\nasync-signal-safe. Therefore, applications can call them, without\nrestriction, from signal-catching functions. ...</p>\n<p>[list of async-signal-safe functions]</p>\n<p><strong>Any function not in the above table may be unsafe with respect to signals.</strong> Implementations may make other interfaces\nasync-signal-safe. In the presence of signals, all functions defined\nby this volume of POSIX.1-2008 shall behave as defined when called\nfrom or interrupted by a signal-catching function, with the exception\nthat <strong>when a signal interrupts an unsafe function or equivalent</strong>\n(such as the processing equivalent to exit() performed after a return\nfrom the initial call to main()) <strong>and the signal-catching function\ncalls an unsafe function, the behavior is undefined.</strong> Additional\nexceptions are specified in the descriptions of individual functions\nsuch as longjmp().</p>\n</blockquote>\n<p>Your signal handler invokes undefined behavior.</p>\n"}], "owner": {"reputation": 11, "user_id": 7244241, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209327748383043/picture?type=large", "display_name": "Gregory Gould", "link": "https://stackoverflow.com/users/7244241/gregory-gould"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489570673, "creation_date": 1489566943, "last_edit_date": 1489567370, "question_id": 42804643, "link": "https://stackoverflow.com/questions/42804643/segfault-on-server-after-multithreading-in-c", "title": "Segfault on Server after Multithreading in C", "body": "<p>So I'm trying to code a multi-threading server. I've spent an enormous time on the internet figuring out the correct way to do this and the answer as always seems to be it depends. Whenever I execute my code, the client successfully connects, and executes but when the thread terminates and returns to the while loop the whole program segfaults. </p>\n\n<p>I probably could use a good spanking on a few other things as well such as my usage of global variables. The entirety of code is below, sorry for the inconsistent space/tabbing. </p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;math.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n\n/* ---------------------------------------------------------------------\n  This is a basic whiteboard server. You can query it, append to it and\n  clear in it. It understands both encrypted and unencrypted data.\n --------------------------------------------------------------------- */\n\nstruct whiteboard {\n    int line;\n    char type;\n    int bytes;\n    char string[1024];\n} *Server;\n\nint serverSize, threadcount, id[5];\nbool debug = true;\nstruct whiteboard *Server;\n\npthread_mutex_t mutex;\npthread_t thread[5];\n\n/* -------------------------------------------\n  function: sigint_handler\n  Opens a file \"whiteboard.all\" in writemode \n  and writes all white board information in \n  command mode.\n ------------------------------------------- */\nvoid sigint_handler(int sig) \n{\n    if (debug) printf(\"\\nInduced SIGINT.\\n\");\n\n    FILE *fp;\n    fp=fopen(\"whiteboard.all\",\"w\");\n\n    int x=0;\n    for (x;x&lt;serverSize;x++) // Loop Responsible for iterating all the whiteboard entries.\n    {\n        if (debug) printf(\"@%d%c%d\\n%s\\n\",Server[x].line,Server[x].type,Server[x].bytes,Server[x].string);\n        fprintf(fp,\"@%d%c%d\\n%s\\n\",Server[x].line,Server[x].type,Server[x].bytes,Server[x].string);\n    }\n\n    if (debug) printf(\"All values stored.\\n\");\n\n    free(Server); // Free dynamically allocated memory\n\n\n    exit(1);\n\n}\n\n/* -------------------------------------------\n  function: processMessage\n  Parses '!' messages into their parts - \n  returns struct in response.\n ------------------------------------------- */\nstruct whiteboard processMessage(char * message)\n{\n    int lineNumber, numBytes;\n    char stringType, entry[1028];\n\n    if (debug) printf(\"Update Statement!\\n\");\n\n    // Read line sent by Socket\n    sscanf(message,\"%*c%d%c%d\\n%[^\\n]s\",&amp;lineNumber,&amp;stringType,&amp;numBytes,entry);\n\n    if (debug) printf(\"Processed: Line: %d, Text: %s\\n\",lineNumber,entry);\n\n    // Parse information into local Struct\n    struct whiteboard Server;\n    Server.line = lineNumber;\n    Server.type = stringType;\n    Server.bytes = numBytes;\n    strcpy(Server.string,entry);\n\n    // If there is no bytes, give nothing\n    if (numBytes == 0)\n    {\n        strcpy(Server.string,\"\");\n    }\n\n    return Server;\n}\n\n\n/* -------------------------------------------\n  function: handleEverything\n  Determines type of message recieved and \n  process and parses accordingly.\n ------------------------------------------- */\nchar * handleEverything(char* message, struct whiteboard *Server, char* newMessage)\n{\n    bool updateFlag = false, queryFlag = false;\n\n    // If message is an Entry\n    if (message[0] == '@')\n    {\n        if (debug) printf(\"Triggered Entry!\\n\");\n\n        // Create Temporary Struct\n        struct whiteboard messageReturn;\n        messageReturn = processMessage(message);\n\n        // Store Temporary Struct in Correct Heap Struct\n        Server[messageReturn.line] = messageReturn;\n        sprintf(newMessage,\"!%d%c%d\\n%s\\n\",messageReturn.line, messageReturn.type, messageReturn.bytes, messageReturn.string);\n        return newMessage;\n    }\n\n    // If message is a query\n    if (message[0] == '?')\n    {\n        if (debug) printf(\"Triggered Query!\\n\");\n\n        int x;\n        queryFlag = true;\n\n        sscanf(message,\"%*c%d\",&amp;x); // Parse Query\n\n        if (x &gt; serverSize) // Check if Query out of Range\n        {\n            strcpy(newMessage,\"ERROR: Query out of Range.\\n\");\n            return newMessage;\n        }   \n\n        sprintf(newMessage,\"!%d%c%d\\n%s\\n\",Server[x].line,Server[x].type,Server[x].bytes,Server[x].string);\n\n        if (debug) printf(\"newMessage as of handleEverything:%s\\n\",newMessage);\n        return newMessage;\n    }   \n}\n\n/* -------------------------------------------\n  function: readFile\n  If argument -f given, read file\n  process and parse into heap memory.\n ------------------------------------------- */\nvoid readFile(char * filename)\n{\n\n    FILE *fp;\n    fp=fopen(filename,\"r\");\n\n    int line, bytes, count = 0, totalSize = 0;\n    char type, check, string[1028], individualLine[1028];\n\n\n    // Loop to determine size of file. **I know this is sloppy.\n    while (fgets(individualLine, sizeof(individualLine), fp)) \n    {\n        totalSize++;\n    }\n\n    // Each line shoud have totalSize - 2 (to account for 0)\n    // (answer) / 2 to account for string line and instruction.\n    totalSize = (totalSize - 2) / 2;\n    serverSize = totalSize+1;\n    if (debug) printf(\"Total Size is: %d\\n\",serverSize);\n\n    // Open and Allocate Memory\n    fp=fopen(filename,\"r\");\n    if (debug) printf(\"File Mode Calloc Initialize\\n\");\n    Server = calloc(serverSize+2, sizeof(*Server));\n\n    // Write to Heap Loop\n    while (fgets(individualLine, sizeof(individualLine), fp)) {\n        if (individualLine[0] == '@') // Case of Header Line\n        {               \n            sscanf(individualLine,\"%c%d%c%d\",&amp;check,&amp;line,&amp;type,&amp;bytes);\n            if (debug) printf(\"Count: %d, Check:%c, Line:%d, Type: %c, Bytes:%d \\n\",count,check,line,type,bytes);\n\n            Server[count].line = line;\n            Server[count].type = type;\n            Server[count].bytes = bytes;\n            count++;    \n        }\n\n        else\n        {\n            // For case of no data\n            if (individualLine[0] == '\\n')\n            {\n                strcpy(string,\"\");\n            }\n\n            // Then scan data line\n            sscanf(individualLine,\"%[^\\n]s\",string);        \n            if (debug) printf(\"String: %s\\n\",string);           \n            strcpy(Server[count-1].string,string);\n        }\n    }\n    return;\n}\n\n\nvoid *threadFunction(int snew)\n{\n    char tempmessage[1024], message[2048];\n    // Compile and Send Server Message\n    strcpy(tempmessage, \"CMPUT379 Whiteboard Server v0\\n\");\n    send(snew, tempmessage, sizeof(tempmessage), 0);\n\n    // Recieve Message\n    char n = recv(snew, message, sizeof(message), 0);\n\n    pthread_mutex_lock(&amp;mutex);\n\n    if (debug) printf(\"Attempt to Malloc for newMessage\\n\");\n    char * newMessage = malloc(1024 * sizeof(char));\n\n    if (debug) printf(\"goto: handleEverything\\n\");\n    newMessage = handleEverything(message, Server, newMessage);\n    if (debug) printf(\"returnMessage:%s\\n\",newMessage);\n\n    strcpy(message,newMessage); \n    free(newMessage);\n\n    pthread_mutex_unlock(&amp;mutex);\n\n    if (debug) printf(\"message = %s\\n\", message);\n\n    send(snew, message, sizeof(message), 0);\n    printf(\"End of threadFunction\\n\");\n\n   return;\n}\n\n\n\n/* -------------------------------------------\n  function: main\n  Function Body of Server\n ------------------------------------------- */\nint main(int argc, char * argv[])\n{\n  int sock, fromlength, outnum, i, socketNumber, snew;\n  bool cleanMode;\n\n  // Initialize Signal Handling\n  struct sigaction act;\n  act.sa_handler = sigint_handler;\n  sigemptyset(&amp;act.sa_mask);\n  act.sa_flags = 0;\n  sigaction(SIGINT, &amp;act, 0);\n\n  // For correct number of arguments.\n  if (argc == 4)\n  {\n    // If \"-n\" parameter (cleanMode)\n    if (strcmp(argv[2], \"-n\") == 0)\n    {\n        // Get size + 1\n        cleanMode = true;\n        sscanf(argv[3],\"%d\",&amp;serverSize);\n        serverSize += 1;\n\n        if (debug) printf(\"== Clean Mode Properly Initiated == \\n\");\n        if (debug) printf(\"serverSize: %d\\n\",serverSize);\n\n        if (debug) printf(\"Clean Mode Calloc\\n\");\n        Server = calloc(serverSize, sizeof(*Server));\n\n        int i = 0;\n        for (i; i &lt; serverSize; i++) // Initialize allocated Memory\n        {\n            Server[i].line = i;\n            Server[i].type = 'p';\n            Server[i].bytes = 0;\n            strcpy(Server[i].string,\"\");\n        }\n    }\n\n    // If \"-f\" parameter (filemode)\n    else if (strcmp(argv[2], \"-f\") == 0)\n    {\n        // Read File\n        cleanMode = false;\n        readFile(argv[3]);\n\n        if (debug) printf(\"== Statefile Mode Properly Initiated == \\n\");\n        if (debug) printf(\"serverSize: %d\\n\",serverSize);\n    }\n\n    // Otherwise incorrect parameter.\n    else\n    {\n        printf(\"Incorrect Argument. \\n\");\n        printf(\"Usage: wbs279 pornumber {-n number | -f statefile}\\n\");\n        exit(1);\n    }\n\n    sscanf(argv[1],\"%d\",&amp;socketNumber);\n  }\n\n  // Send Error for Incorrect Number of Arguments\n  if (argc != 4)\n  {\n    printf(\"Error: Incorrect Number of Input Arguments.\\n\");\n    printf(\"Usage: wbs279 portnumber {-n number | -f statefile}\\n\");\n    exit(1);\n  }\n\n  // == Do socket stuff ==\n\n  char tempmessage[1024], message[2048];\n  struct sockaddr_in master, from;\n\n  if (debug) printf(\"Assrt Socket\\n\");\n\n  sock = socket (AF_INET, SOCK_STREAM, 0);\n  if (sock &lt; 0) \n  {\n    perror (\"Server: cannot open master socket\");\n    exit (1);\n  }\n\n  master.sin_family = AF_INET;\n  master.sin_addr.s_addr = INADDR_ANY;\n  master.sin_port = htons (socketNumber);\n\n  if (bind (sock, (struct sockaddr*) &amp;master, sizeof (master))) \n  {\n    perror (\"Server: cannot bind master socket\");\n    exit (1);\n  }\n\n  // == Done socket stuff == \n\n  listen (sock, 5);\n  int threadNumber = 0;\n\n  while(1) \n  {\n    printf(\"But what about now.\\n\");\n    if (debug) printf(\"-- Wait for Input --\\n\");\n    printf(\"Enie, \");\n    fromlength = sizeof (from);\n    printf(\"Meanie, \");\n    snew = accept (sock, (struct sockaddr*) &amp; from, &amp; fromlength);\n    printf(\"Miney, \");  \n    if (snew &lt; 0) \n    {\n      perror (\"Server: accept failed\");\n      exit (1);\n    }\n    printf(\"Moe\\n\");\n\n\n    pthread_create(&amp;thread[threadNumber],NULL,threadFunction(snew), &amp;id[threadNumber]);\n    //printf(\"Can I join?!\\n\");\n    //pthread_join(thread[0],NULL);\n    //printf(\"Joined?!\\n\");\n\n    threadNumber++;\n\n    close (snew);\n  }\n}\n</code></pre>\n\n<p>I'm also curious as to how exactly to let multiple clients use the server at once. Is how I've allocated the whiteboard structure data appropriate for this process?</p>\n\n<p>I'm very sorry if these don't make any sense.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489566092, "post_id": 42804367, "comment_id": 72721657, "body": "(1) Research about proper indentation. It&#39;s all the same for the compiler, but makes a great deal of difference to humans. (2) Why are you leaking the memory <code>x</code> points to by reallocating it?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1489566256, "post_id": 42804367, "comment_id": 72721744, "body": "See <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\" title=\"do i cast the result of malloc\">stackoverflow.com/questions/605845/&hellip;</a>. to eliminate A. The answer is D, since you overwrite the pointer <code>x</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1489566328, "post_id": 42804367, "comment_id": 72721793, "body": "I also don&#39;t like <code>void main()</code>. A smart Alec would amend the exam question with this as option E."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 2, "creation_date": 1489566379, "post_id": 42804367, "comment_id": 72721810, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc#605858\">Don&#39;t cast malloc</a>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 5, "creation_date": 1489566510, "post_id": 42804367, "comment_id": 72721880, "body": "Your instructor either doesn&#39;t know C well, or this is a trick question. The <code>iostream.h</code> strongly implies a C++ compiler (an ancient compiler, in fact). which means option A is the only one that can possibly be correct."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489566742, "post_id": 42804367, "comment_id": 72722018, "body": "@StoryTeller Is the very smart answer !"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1489567008, "post_id": 42804367, "comment_id": 72722189, "body": "In C language you are <i>supposed</i> to convert <code>void *</code> to <code>int *</code> <i>without</i> explicit cast. That the right way to do it. Unnecessary explict casts are extremely bad practice and shoud be avoided at all costs wherever possible."}, {"owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "edited": false, "score": 0, "creation_date": 1489567108, "post_id": 42804367, "comment_id": 72722239, "body": "ok i got it. I should not be using iostream and conio. And that casting with malloc is not necessary in C but in C++ its necessary. Also im compiling my code with c++ compiler instead of c compiler. Thank you all"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1489567157, "post_id": 42804367, "comment_id": 72722273, "body": "@Prakhar: If you are compiling your code as C++, then why are you misleading people by tagging your question as [C]?"}, {"owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1489567250, "post_id": 42804367, "comment_id": 72722328, "body": "@AnT i didnt know it untill now. Thats the reason i asked for help here and got answer. Sorry for discomfort anyway. Im new to C and C++."}], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "edited": false, "score": 0, "creation_date": 1491330654, "post_id": 42804453, "comment_id": 73501544, "body": "thanks. I get it their are lot of errors in this code."}], "tags": [], "owner": {"reputation": 4751, "user_id": 5649326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/a82Se.jpg?s=128&g=1", "display_name": "Marievi", "link": "https://stackoverflow.com/users/5649326/marievi"}, "is_accepted": false, "score": 0, "last_activity_date": 1489566842, "last_edit_date": 1495540925, "creation_date": 1489566334, "answer_id": 42804453, "question_id": 42804367, "link": "https://stackoverflow.com/questions/42804367/what-is-wrong-with-the-following-code-in-c-language/42804453#42804453", "title": "What is wrong with the following Code in C language?", "body": "<p>The statement :</p>\n\n<pre><code>int *x = malloc(sizeof(int));\n</code></pre>\n\n<p>will not lead to compile error, as it declares <code>x</code> as a pointer to <code>int</code> and initializes it right afterwards. It did not have type <code>void</code> beforehand.</p>\n\n<p>The statement :</p>\n\n<pre><code>x = (int *)malloc(sizeof(int));\n</code></pre>\n\n<p>causes a possible memory leak, as it reallocates the memory which is already allocated for <code>x</code>.</p>\n\n<hr>\n\n<p><strong><em>NOTE :</em></strong> However none of this answers is completely correct. This code will not compile for various reasons.</p>\n\n<p>If this is your code, change :</p>\n\n<pre><code>void main()\n</code></pre>\n\n<p>to :</p>\n\n<pre><code>int main(void)\n</code></pre>\n\n<p>and also see <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">why you should not cast the result of malloc</a>.</p>\n\n<p>Apart from that, <code>clrscr()</code>, <code>getch()</code>, <code>&lt;conio.h&gt;</code> and <code>&lt;iostream.h&gt;</code> are not recognized by standard library.</p>\n"}, {"comments": [{"owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "edited": false, "score": 0, "creation_date": 1489566901, "post_id": 42804484, "comment_id": 72722122, "body": "neglect conio.h, actually i was using an old ide (turbo c)"}, {"owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "edited": false, "score": 0, "creation_date": 1489567549, "post_id": 42804484, "comment_id": 72722492, "body": "I got it answer is D which is right. Also standard library doesn&#39;t have iostream and conio header files. Memory leak will occur as we lose track of first assignment of memory to x. In C their is no need to manualy typecast malloc."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1489571126, "post_id": 42804484, "comment_id": 72724772, "body": "The <code>#include &lt;iostream.h&gt;</code> is a hint the code is (pre-standard) C++, not C.     That and the various points you raise suggest the quality of the exam itself is VERY low."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 6, "last_activity_date": 1489566908, "last_edit_date": 1489566908, "creation_date": 1489566439, "answer_id": 42804484, "question_id": 42804367, "link": "https://stackoverflow.com/questions/42804367/what-is-wrong-with-the-following-code-in-c-language/42804484#42804484", "title": "What is wrong with the following Code in C language?", "body": "<p>There's no right answer among the choices offered.</p>\n\n<p>The immediately obvious problems with the code, under assumption that the code is supposed to be written in standard C:</p>\n\n<ul>\n<li><p>Standard library does not have <code>&lt;conio.h&gt;</code> header or <code>&lt;iostream.h&gt;</code> header.</p></li>\n<li><p><code>void main()</code> is illegal. Should be <code>int main()</code>. Even better <code>int main(void)</code></p></li>\n<li><p><code>clrscr()</code>, <code>getch()</code> - standard library knows no such functions.</p></li>\n<li><p>The second <code>malloc</code> leaks memory allocated by the first one (assuming the first one succeeds).</p></li>\n<li><p>Result of second <code>malloc</code> is explicitly cast - bad and unnecessary practice.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1489570871, "post_id": 42804864, "comment_id": 72724598, "body": "The <code>iostream.h</code> could hint that OP is using a <i>C++</i> compiler."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1489586818, "post_id": 42804864, "comment_id": 72736315, "body": "@Antti Haapala: The C++ header with similar name is called <code>&lt;iosteam&gt;</code>, not <code>&lt;iostream.h&gt;</code>."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": false, "score": -1, "last_activity_date": 1489567627, "last_edit_date": 1592644375, "creation_date": 1489567627, "answer_id": 42804864, "question_id": 42804367, "link": "https://stackoverflow.com/questions/42804367/what-is-wrong-with-the-following-code-in-c-language/42804864#42804864", "title": "What is wrong with the following Code in C language?", "body": "<blockquote>\n<p><em>I observed that in line int *x = malloc(sizeof(int)); this code is trying to convert a void* into a int* without using proper typecasting.</em></p>\n</blockquote>\n<p><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">There's more than a little debate about whether or not to cast <code>malloc</code></a>, but it's a stylistic thing. <code>void *</code> is safely promoted to any other pointer.</p>\n<p>ISO C 6.3.2.3 says...</p>\n<blockquote>\n<p>A pointer to void may be converted to or from a pointer to any incomplete or object type. A pointer to any incomplete or object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer.</p>\n</blockquote>\n<p>Whatever you choose, pick one and stick with it.</p>\n<hr />\n<p>The memory leak is here:</p>\n<pre><code>int *x = malloc(sizeof(int));\nif(NULL==x) return;\nx = assignval(x,0);\nif(x){\n    // Memory leak\n    x = (int *)malloc(sizeof(int));\n</code></pre>\n<p>The first <code>malloc</code> points <code>x</code> at allocated memory. The second <code>malloc</code> can only happen if the first succeeded (if <code>x</code> is true). The pointer to the memory allocated by the first <code>malloc</code> is lost.</p>\n<p>Using a new variable would fix the leak, keeping in mind that the code is nonsense.</p>\n<pre><code>int *x = malloc(sizeof(int));\nif(NULL==x) return;\nx = assignval(x,0);\nif(x){\n    int *y = malloc(sizeof(int));\n    if(NULL==y) return;\n    y = assignval(y,10);\n    free(y);\n}\n</code></pre>\n<hr />\n<p>As a side note, <code>void main()</code> is <em><strong>technically</strong></em> not a violation of the ISO C standard, it is &quot;some other implementation-defined manner&quot;.</p>\n<p>5.1.2.2.1 says:</p>\n<blockquote>\n<p>The function called at program startup is named main. The implementation declares no prototype for this function. It shall be defined with a return type of int and with no parameters:</p>\n<p>int main(void) { /* ... */ }</p>\n<p>or with two parameters (referred to here as argc and argv, though any names may be used, as they are local to the function in which they are declared):</p>\n<p>int main(int argc, char <em>argv[]) { /</em> ... */ }</p>\n<p>or equivalent;) <em><strong>or in some other implementation-defined manner</strong></em>.</p>\n</blockquote>\n<p>I'm guessing you're using a Windows compiler, that would be the &quot;some other implementation&quot;. <code>clang</code> considers it an error.</p>\n<pre><code>test.c:8:1: error: 'main' must return 'int'\nvoid main(){\n^~~~\nint\n1 error generated.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 2, "creation_date": 1489570704, "post_id": 42804910, "comment_id": 72724477, "body": "That&#39;s because the compiler with Visual Studio is a C++ compiler, in which implicit conversion from <code>void *</code> to another pointer is not permitted.  In standard C, typecasting the return value from <code>malloc()</code> is permitted but is poor practice."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1489572001, "post_id": 42804910, "comment_id": 72725410, "body": "@Peter: Wrong. Compiler in Visual Studio is not a &quot;C++ compiler&quot;. It is &quot;whatever you configure it to be&quot; compiler, which can properly compile C code and C++ code, exactly like GCC and most C/C++ compilers available today. Meanwhile, the above claim that the need to cast is somehow tied to &quot;IDE&quot; is completely nonsensical."}], "tags": [], "owner": {"reputation": 750, "user_id": 7054387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-6bDjhl9WjJI/AAAAAAAAAAI/AAAAAAAAAA0/HLJVVOTCc1Q/photo.jpg?sz=128", "display_name": "Fatemeh Karimi", "link": "https://stackoverflow.com/users/7054387/fatemeh-karimi"}, "is_accepted": false, "score": -1, "last_activity_date": 1489567783, "creation_date": 1489567783, "answer_id": 42804910, "question_id": 42804367, "link": "https://stackoverflow.com/questions/42804367/what-is-wrong-with-the-following-code-in-c-language/42804910#42804910", "title": "What is wrong with the following Code in C language?", "body": "<p>you should never forget that a void * pointer can be assigned to all type of pointers. in IDEs like visual studio, you get a compile error if you do not perform casting while assigning a void * to &lt;>. for example:</p>\n\n<pre><code>float *ptr = malloc(sizeof(float));//compile error in visual studio.\n</code></pre>\n\n<p>but if you compile it with GCC without typecasting, you won't get a compile error.</p>\n"}], "owner": {"reputation": 64, "user_id": 4380466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cVk8J.jpg?s=128&g=1", "display_name": "Prakhar", "link": "https://stackoverflow.com/users/4380466/prakhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 42804484, "answer_count": 4, "score": 0, "last_activity_date": 1489569246, "creation_date": 1489566003, "last_edit_date": 1489569246, "question_id": 42804367, "link": "https://stackoverflow.com/questions/42804367/what-is-wrong-with-the-following-code-in-c-language", "title": "What is wrong with the following Code in C language?", "body": "<p>I observed that in line <code>int *x = malloc(sizeof(int));</code> this code is trying to convert a void* into a int* without using proper typecasting. So according to me answer should be <em>option A</em>. But in official GATE-2017 exam answer key, <em>answer is given D.</em> So am i wrong ? how ?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;iostream.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint *assignval(int *x, int val){\n  *x = val;\n  return x;\n}\n\nvoid main(){\n    clrscr();\n    int *x = malloc(sizeof(int));\n    if(NULL==x) return;\n    x = assignval(x,0);\n    if(x){\n        x = (int *)malloc(sizeof(int));\n        if(NULL==x) return;\n        x = assignval(x,10);\n    }\n    printf(\"%d\\n\",*x);\n    free(x);\n    getch();\n}\n</code></pre>\n\n<ul>\n<li>(A) compiler error as the return of malloc is not typecast\nappropriately.</li>\n<li>(B) compiler error because the comparison should be made as x==NULL\nand not as shown.</li>\n<li>(C) compiles successfully but execution may result in dangling\npointer.</li>\n<li>(D) compiles successfully but execution may result in memory leak.</li>\n</ul>\n\n<blockquote>\n  <p>In my opinion <em>option D</em> is only correct when <code>int *x = (int *)malloc(sizeof(int));</code> is used.</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "forward-declaration", "function-prototypes"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 10, "creation_date": 1489565931, "post_id": 42804326, "comment_id": 72721579, "body": "Never in C++, and no longer in C since 99"}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 1, "creation_date": 1489566605, "post_id": 42804326, "comment_id": 72721942, "body": "<i>&quot;Why C++ Compiler Gives an Error?&quot;</i> As usual: Because the standard says so."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 1, "creation_date": 1489567073, "post_id": 42804326, "comment_id": 72722223, "body": "@CraigYoung read it as &quot;no fwd decl...&quot;"}, {"owner": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1489567353, "post_id": 42804326, "comment_id": 72722401, "body": "Is the question title just a <b>complaint</b> about the fact that C++ requires declarations before functions are used and therefore in some cases needs &quot;forward declarations&quot;?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13760, "user_id": 224704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c94b60d81fde0361f2daa910a0f9a77?s=128&d=identicon&r=PG", "display_name": "Disillusioned", "link": "https://stackoverflow.com/users/224704/disillusioned"}, "edited": false, "score": 0, "creation_date": 1489567414, "post_id": 42804326, "comment_id": 72722425, "body": "@CraigYoung Well, take it with a grain of salt. This question originates from the lack of knowledge that C and C++ are two different languages and should be treated so. Nothing else. :)"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1489567495, "post_id": 42804326, "comment_id": 72722462, "body": "@SouravGhosh - Ironically enough, modern C and C++ agree on this point :)"}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 0, "creation_date": 1489567647, "post_id": 42804326, "comment_id": 72722548, "body": "C was originally designed as a one pass compiler, so you need to forward declare items before using it."}, {"owner": {"reputation": 122, "user_id": 1456400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437d3c9dc9af09cdfc0aff3f23d11f41?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1456400/daniel"}, "edited": false, "score": 0, "creation_date": 1489568175, "post_id": 42804326, "comment_id": 72722829, "body": "The first code does not compile on my computer. It gives me &quot;identifier not found&quot; error. I use Visual Studio 2012 Express Edition for Windows Desktop. Btw, there should be a # in front of include but I don&#39;t think this is why the code compiles on your computer."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489568198, "post_id": 42804326, "comment_id": 72722847, "body": "I have added the C tag back, as this question was asked as a comparison between C and C++. While the base of the question was wrong (c == c++), both the tags seem relevant here. let me know if anybody disagrees."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 122, "user_id": 1456400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437d3c9dc9af09cdfc0aff3f23d11f41?s=128&d=identicon&r=PG", "display_name": "daniel", "link": "https://stackoverflow.com/users/1456400/daniel"}, "edited": false, "score": 0, "creation_date": 1489568259, "post_id": 42804326, "comment_id": 72722883, "body": "@daniel that must be a typo, anyway. :)"}], "answers": [{"comments": [{"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1489571760, "post_id": 42804829, "comment_id": 72725226, "body": "A compiler compliant with C99 or later will reject the code.   Compilers that are older than 1999, or in &quot;C89&quot; modes (e.g. <code>gcc -stdc89</code>), generally do not claim compliance with C99."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1489571939, "post_id": 42804829, "comment_id": 72725372, "body": "@Peter Sometimes you need to enforce the &quot;compliance&quot; using options, it&#39;s not there by default...that&#39;s all i&#39;m sayin&#39;."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 3, "last_activity_date": 1489567881, "last_edit_date": 1489567881, "creation_date": 1489567516, "answer_id": 42804829, "question_id": 42804326, "link": "https://stackoverflow.com/questions/42804326/issue-with-missing-forward-declaration-in-c/42804829#42804829", "title": "Issue with missing forward declaration in C++", "body": "<p>Well, it is as much as wrong in C, as in C++.</p>\n\n<p>Considering the question is based on the <strong><em>\"assumption\"</em></strong> that the code is valid from a C compiler point of view, let me elaborate that, as per the spec (<code>C11</code>), implicit declaration of functions is not allowed. Compile your code with strict conformance and (any conforming) compiler will produce the same error in C.</p>\n\n<p><kbd><strong><a href=\"https://ideone.com/WAqVjs\" rel=\"nofollow noreferrer\">See live example</a></strong></kbd></p>\n\n<p>Quoting <code>C11</code>, Foreword/p7, <em>\"Major changes in the second edition included:\"</em></p>\n\n<blockquote>\n  <ul>\n  <li>remove implicit function declaration</li>\n  </ul>\n</blockquote>\n\n<p>and the same exist in the <code>C99</code>, also.</p>\n\n<hr>\n\n<p>Note: <em>On why it might have worked</em></p>\n\n<p>Pre <code>C99</code>, there was actually room for this code to be compiled successfully. In case of a missing function prototype, it was assumed that the function returns an <code>int</code> and accepts any number of parameters as input. That is now very much non-standard and compilers with legacy support may choose to allow such code to be compiled, but strictly speaking, a conforming compiler should refuse to do so.</p>\n"}, {"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 2, "last_activity_date": 1522075609, "last_edit_date": 1522075609, "creation_date": 1489567537, "answer_id": 42804837, "question_id": 42804326, "link": "https://stackoverflow.com/questions/42804326/issue-with-missing-forward-declaration-in-c/42804837#42804837", "title": "Issue with missing forward declaration in C++", "body": "<blockquote>\n  <p>Why C++ Compiler Gives an Error?</p>\n</blockquote>\n\n<p>Because you shall not call functions that have not been declared in C++.</p>\n\n<blockquote>\n  <p>Is it not by default take int data type?</p>\n</blockquote>\n\n<p>No. That used to be the case in another language, C. It is not the case in C++ (nor in C since later standard versions).</p>\n"}, {"comments": [{"owner": {"reputation": 4909, "user_id": 911550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WHa6T.jpg?s=128&g=1", "display_name": "parvus", "link": "https://stackoverflow.com/users/911550/parvus"}, "edited": false, "score": 0, "creation_date": 1489570977, "post_id": 42805488, "comment_id": 72724672, "body": "This is a tiny bit correct and mostly very wrong. When an undeclared function is encountered, the C compiler assumes a declaration (the linker will then complain if no implementation has been found). When the assumption is false, i.e. when a declaration or implementation is found later in the code,"}, {"owner": {"reputation": 4909, "user_id": 911550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WHa6T.jpg?s=128&g=1", "display_name": "parvus", "link": "https://stackoverflow.com/users/911550/parvus"}, "edited": false, "score": 0, "creation_date": 1489572963, "post_id": 42805488, "comment_id": 72726123, "body": "and does not match with the assumption, a compiler error is given. This may be further influenced by your compiler version and compiler flags. By far the best advice is: don&#39;t do it; always declare up front."}, {"owner": {"reputation": 26, "user_id": 7573808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QE2V8.jpg?s=128&g=1", "display_name": "T.Buys", "link": "https://stackoverflow.com/users/7573808/t-buys"}, "reply_to_user": {"reputation": 4909, "user_id": 911550, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/WHa6T.jpg?s=128&g=1", "display_name": "parvus", "link": "https://stackoverflow.com/users/911550/parvus"}, "edited": false, "score": 0, "creation_date": 1489661205, "post_id": 42805488, "comment_id": 72773141, "body": "@parvus, yes the C compiler assumes a declaration. This is a legacy of the old K&amp;R C function style where a function declarator has no parameters and if the function returns an int, the declaration might well have been omitted."}], "tags": [], "owner": {"reputation": 26, "user_id": 7573808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QE2V8.jpg?s=128&g=1", "display_name": "T.Buys", "link": "https://stackoverflow.com/users/7573808/t-buys"}, "is_accepted": false, "score": 1, "last_activity_date": 1489663241, "last_edit_date": 1489663241, "creation_date": 1489569532, "answer_id": 42805488, "question_id": 42804326, "link": "https://stackoverflow.com/questions/42804326/issue-with-missing-forward-declaration-in-c/42805488#42805488", "title": "Issue with missing forward declaration in C++", "body": "<p>In C++ you can't call an undeclared function. In C you can call a function without a forward declarator if the definition of the function returns an int. This is because of the old K&amp;R function definition style. This is obsolete for ANSI-C, always declare a function with a prototype.</p>\n"}, {"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1489910006, "last_edit_date": 1495541419, "creation_date": 1489569620, "answer_id": 42805525, "question_id": 42804326, "link": "https://stackoverflow.com/questions/42804326/issue-with-missing-forward-declaration-in-c/42805525#42805525", "title": "Issue with missing forward declaration in C++", "body": "<p>To complete the picture and in relation to the answer by <a href=\"https://stackoverflow.com/a/42804829/817643\"><strong>Sourav Ghosh</strong></a>. Here's what the C++ standard has to say about the issue:</p>\n\n<p><a href=\"http://eel.is/c++draft/expr.call#2\" rel=\"nofollow noreferrer\">[expr.call] p2</a>:</p>\n\n<blockquote>\n  <p>[\u2009Note: If a function or member function name is used, and name lookup does not find a declaration of that name, the program is ill-formed. No function is implicitly declared by such a call. \u2009\u2014\u2009end note\u2009]</p>\n</blockquote>\n\n<p>Couldn't get more explicit than that.</p>\n"}], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 1, "closed_date": 1489577922, "accepted_answer_id": 42804829, "answer_count": 4, "score": -1, "last_activity_date": 1522075609, "creation_date": 1489565874, "last_edit_date": 1489568211, "question_id": 42804326, "link": "https://stackoverflow.com/questions/42804326/issue-with-missing-forward-declaration-in-c", "closed_reason": "Needs details or clarity", "title": "Issue with missing forward declaration in C++", "body": "<p>I have compiled following program without forward declaring function in <code>C</code>. It's successfully compiled and run in <code>GCC</code> without any warning or error. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n        int ret = func(10, 5);\n}\n\nint func(int i, int j)\n{\n        return (i+j);\n}\n</code></pre>\n\n<p>But, I have compiled following program without forward declaring function in <code>C++</code>, Compiler gives me an error.</p>\n\n<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{\n        int ret = func(10, 5);\n}\n\nint func(int i, int j)\n{\n        return (i+j);\n}\n</code></pre>\n\n<p><strong>An Error:</strong></p>\n\n<pre><code>fl.cpp:6:22: error: \u2018func\u2019 was not declared in this scope\n  int ret = func(10, 5);\n                      ^\n</code></pre>\n\n<p><strong>Why C++ Compiler Gives an Error? Is it not by default take int data type?</strong></p>\n"}, {"tags": ["c", "linux", "mount", "ext4"], "comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1489589778, "post_id": 42804231, "comment_id": 72738761, "body": "I do not think you can use <a href=\"http://man7.org/linux/man-pages/man2/access.2.html\" rel=\"nofollow noreferrer\"><code>access()</code></a> to check if a mount is okay. The check is quite possible, mind you; just not with <code>access()</code>."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 1, "creation_date": 1489652285, "post_id": 42804231, "comment_id": 72767234, "body": "in my opinion it is not sufficient to check the mountpoint access to decide whether the filesystem mounted to it is ok or not. If you don&#39;t have an API provided by the fs driver, perhaps you could do some read operations in the easisest case for this purpose. For example you can recursively read the directory listing under the mountpoint. But in this case you don&#39;t test file&#39;s content and don&#39;t test whether writing is ok."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489652588, "post_id": 42804231, "comment_id": 72767378, "body": "besides that, just an idea. You can try to open some from the mounted filesystem for writting and then analyze the error code. Depending on your OS, you can also get EIO return code which will indicate yor case."}, {"owner": {"reputation": 79, "user_id": 3326784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2fa961f484c6c737d35c73fd33ea518b?s=128&d=identicon&r=PG&f=1", "display_name": "Vatel", "link": "https://stackoverflow.com/users/3326784/vatel"}, "edited": false, "score": 0, "creation_date": 1489989536, "post_id": 42804231, "comment_id": 72893773, "body": "Is there another api can use to check the mountpoint?  I use a specifical file under the mountpoint to check if it&#39;s writable or not."}], "owner": {"reputation": 79, "user_id": 3326784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2fa961f484c6c737d35c73fd33ea518b?s=128&d=identicon&r=PG&f=1", "display_name": "Vatel", "link": "https://stackoverflow.com/users/3326784/vatel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593969677, "creation_date": 1489565558, "last_edit_date": 1593969677, "question_id": 42804231, "link": "https://stackoverflow.com/questions/42804231/how-to-use-access-stat-to-test-if-the-mountpoint-is-ok-or-not", "title": "how to use access/stat to test if the mountpoint is ok or not?", "body": "<p>I mounted a disk to a mountpoint, and I unplug the disk without umount.\nI want to use access(mountpoint, R_OK | W_OK) to discover the disk is broken, but failed...</p>\n\n<p>Here's my testing code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n\nint main(void)\n{\n    char *dir = \"/sdf\";\n    int ret;\n    struct stat s;\n\n    ret = access(dir, R_OK | W_OK);\n    if (ret &lt; 0) {\n        printf(\"access ERROR: %s can not be read or write ret=%d\\n\", dir, ret);\n        return 0;\n    }\n\n    printf(\"access INFO: %s can be read and write ret=%d\\n\", dir, ret);\n\n    ret = stat(dir, &amp;s);\n    if (ret &lt; 0) {\n        printf(\"stat ERROR: %s can not be read or write ret=%d\\n\", dir, ret);\n        return 0;\n    }\n\n    printf(\"stat INFO: %s can be read and write ret=%d\\n\", dir, ret);\n    return 0;\n}\n</code></pre>\n\n<p>here's the result:</p>\n\n<pre><code>[test]# ./access \naccess INFO: /sdf can be read and write ret=0\nstat INFO: /sdf can be read and write ret=0\n</code></pre>\n\n<p>I use ls to list the mountpoint:</p>\n\n<pre><code>[test]# ls /sdf\nls: reading directory /sdf: Input/output error\n</code></pre>\n\n<p>I dont know why this happen...</p>\n\n<p>anyone can help me?</p>\n\n<p>I use ext4 filesystem</p>\n\n<pre><code>[test]# mount |grep sdf\n/root/loopfile.img on /sdf type ext4 (ro,relatime)\n/dev/sdf on /sdf type ext4 (rw,noatime,data=ordered)\n</code></pre>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489564212, "post_id": 42803823, "comment_id": 72720628, "body": "That would depend on what is the effective type of <code>loc</code>. C <i>is</i> a statically typed language..."}, {"owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489564306, "post_id": 42803823, "comment_id": 72720674, "body": "loc can be put as #define loc 0x100"}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1489564330, "post_id": 42803823, "comment_id": 72720692, "body": "If you have the address of a value, then you have a pointer. You should use the dereference operator to dereference the pointer an you get the value. The type of the pointer must match the data type you want to read."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1489564331, "post_id": 42803823, "comment_id": 72720694, "body": "Then your entire code is ill-formed. You can&#39;t take the address of a constant"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1489564413, "post_id": 42803823, "comment_id": 72720741, "body": "Where did you get <code>loc</code> from? You might be looking to set a volatile pointer to it, but that\u2019s a bit rare. See <a href=\"https://stackoverflow.com/questions/2389251/pointer-to-a-specific-fixed-address\" title=\"pointer to a specific fixed address\">stackoverflow.com/questions/2389251/&hellip;</a> if that\u2019s really the case."}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1489565574, "last_edit_date": 1489565574, "creation_date": 1489564326, "answer_id": 42803873, "question_id": 42803823, "link": "https://stackoverflow.com/questions/42803823/how-to-get-a-value-from-a-memory-adress-in-c/42803873#42803873", "title": "How to get a value from a memory adress in C?", "body": "<p>The addressof operator returns an object that is a pointer type. The value of the pointer is the memory address of the pointed object (which is <code>loc</code>). You can get the value of the object at the pointed memory address by dereferencing the pointer with the dereference operator:</p>\n\n<pre><code>*(&amp;loc)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 5, "creation_date": 1489564520, "post_id": 42803915, "comment_id": 72720802, "body": "Did you mean <code>*(int*)p</code> and <code>*(float*)p</code>?"}], "tags": [], "owner": {"reputation": 11267, "user_id": 903651, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e3dda4f66a2b7cc9fdced12a0fbede58?s=128&d=identicon&r=PG", "display_name": "Adrian Maire", "link": "https://stackoverflow.com/users/903651/adrian-maire"}, "is_accepted": false, "score": 1, "last_activity_date": 1489564754, "last_edit_date": 1489564754, "creation_date": 1489564478, "answer_id": 42803915, "question_id": 42803823, "link": "https://stackoverflow.com/questions/42803823/how-to-get-a-value-from-a-memory-adress-in-c/42803915#42803915", "title": "How to get a value from a memory adress in C?", "body": "<p>An address has no type, but assuming you know it, you may use the follow line:</p>\n\n<pre><code>printf(\"%d\", *(int*)p);\n</code></pre>\n\n<p>You could test several types to check what is in there:</p>\n\n<pre><code>printf(\"%d\", *(int*)p);\nprintf(\"%f\", *(float*)p);\n...\n</code></pre>\n\n<p>Be careful, that the address is required to belong to the current process, if not, the memory protection will kill your process.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1489564820, "creation_date": 1489564820, "answer_id": 42804003, "question_id": 42803823, "link": "https://stackoverflow.com/questions/42803823/how-to-get-a-value-from-a-memory-adress-in-c/42804003#42804003", "title": "How to get a value from a memory adress in C?", "body": "<p>The standard way of accessing a particular address 0x12345678 (such as a hardware register) is:</p>\n\n<pre><code>(volatile uint32_t*)0x12345678\n</code></pre>\n\n<p>If you want to use the contents of that address as if it was a variable, you could either have a pointer point there, or make a macro:</p>\n\n<pre><code>#define REGISTER ( *(volatile uint32_t*)0x12345678 )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 750, "user_id": 7054387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-6bDjhl9WjJI/AAAAAAAAAAI/AAAAAAAAAA0/HLJVVOTCc1Q/photo.jpg?sz=128", "display_name": "Fatemeh Karimi", "link": "https://stackoverflow.com/users/7054387/fatemeh-karimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1489565208, "creation_date": 1489565208, "answer_id": 42804125, "question_id": 42803823, "link": "https://stackoverflow.com/questions/42803823/how-to-get-a-value-from-a-memory-adress-in-c/42804125#42804125", "title": "How to get a value from a memory adress in C?", "body": "<p>you can simply use the asterisk to get the value of the variable the pointer is pointing to.</p>\n\n<pre><code>type x = *loc\n</code></pre>\n\n<p>i used type because i don't know the type of loc(it may be int, double, float,...)</p>\n"}], "owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2646, "favorite_count": 0, "closed_date": 1489578144, "accepted_answer_id": 42804003, "answer_count": 4, "score": 2, "last_activity_date": 1489565574, "creation_date": 1489564164, "last_edit_date": 1489564258, "question_id": 42803823, "link": "https://stackoverflow.com/questions/42803823/how-to-get-a-value-from-a-memory-adress-in-c", "closed_reason": "Duplicate", "title": "How to get a value from a memory adress in C?", "body": "<p>A bit of a silly question but here it is - how do I get a value based on its address?</p>\n\n<p>Usually to get the address for a certain value I just print it out like this:</p>\n\n<pre><code>printf(\"%p\", &amp;loc);\n</code></pre>\n\n<p>But now I need to get a value based on its address in memory. How do I do that?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 1, "creation_date": 1489570864, "post_id": 42803422, "comment_id": 72724590, "body": "It&#39;s most likely that your <code>&#47;etc&#47;ld.so.preload</code> file has an entry for this library. And it sounds like the preload library has a bug in this case."}, {"owner": {"reputation": 534, "user_id": 2677528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtJK5.png?s=128&g=1", "display_name": "kolrabi", "link": "https://stackoverflow.com/users/2677528/kolrabi"}, "edited": false, "score": 0, "creation_date": 1489592084, "post_id": 42803422, "comment_id": 72740697, "body": "libachk seems to be some SUSE specific security library that intercepts calls to the libc and checks any provided argument before passing it on. And it seems to crash when checking if your LOG_PATH contains a certain string."}, {"owner": {"reputation": 11, "user_id": 7712415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa8d67c69f7e3578ad2b332127a7138?s=128&d=identicon&r=PG&f=1", "display_name": "Longxu Qin", "link": "https://stackoverflow.com/users/7712415/longxu-qin"}, "edited": false, "score": 0, "creation_date": 1489632599, "post_id": 42803422, "comment_id": 72760052, "body": "Thanks for your comment. you mean that every or most syscalls, like open(), read(),write(), was intercepted by libachk,  and in libachk, it do some check, and then calls libc function finally? By the way, LOG_PATH contains very normal string &quot;/var/log/naslog&quot;, it seems could not to be wrong."}, {"owner": {"reputation": 11, "user_id": 7712415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa8d67c69f7e3578ad2b332127a7138?s=128&d=identicon&r=PG&f=1", "display_name": "Longxu Qin", "link": "https://stackoverflow.com/users/7712415/longxu-qin"}, "reply_to_user": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1489633268, "post_id": 42803422, "comment_id": 72760227, "body": "Thanks for your comment @Petesh, it seems like what you say. But what strange is that, when I install this program on other machine, which system is the same as SUSE 11 spc1 linux,  It goes well. The content of /etc/ld.so.preload of two machine is the same string &quot;libachk.so&quot;, and the output of cmd &quot;ldd exe-program&quot; in two machine is same, expect the address of lib."}], "owner": {"reputation": 11, "user_id": 7712415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fa8d67c69f7e3578ad2b332127a7138?s=128&d=identicon&r=PG&f=1", "display_name": "Longxu Qin", "link": "https://stackoverflow.com/users/7712415/longxu-qin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489570669, "creation_date": 1489562702, "last_edit_date": 1489570669, "question_id": 42803422, "link": "https://stackoverflow.com/questions/42803422/why-invoke-open-in-libachk-so-instead-of-in-libc-so", "title": "Why invoke open() in libachk.so instead of in libc.so?", "body": "<p>I have a very strange SEGMENT FAULT stack as follow.</p>\n\n<pre><code>#0  0x00007f3b85fb0f6e in __strstr_sse42 () from /lib64/libc.so.6\n#1  0x00007f3b889b5415 in syscheckGetFdPath () from /lib64/libachk.so\n#2  0x00007f3b889b4fc7 in acc_achkon_open () from /lib64/libachk.so\n#3  0x00007f3b889b46d4 in open () from /lib64/libachk.so\n#4  0x0000000000414d44 in nas_log_write_through(buff, size)\n</code></pre>\n\n<p>The source code of <code>nas_log_write_through()</code> function like this</p>\n\n<pre><code>void nas_log_write_through(char *buf, int size)\n{\n    int fd = 0;\n    mode_t mod = umask(0);\n    fd = open(LOG_PATH, O_RDWR | O_APPEND | O_CREAT, 0777);\n    umask(mod);    \n    if (-1 == fd)\n    {\n        return;\n    }\n\n    write(fd, buf, size);\n    close(fd);\n}\n</code></pre>\n\n<p>In most case, it works well, but it suddenly works bad. and get core dump stack like previous shows. I want what is libachk.so doing? why syscall open() in libachk.so, instead of libc.so?</p>\n\n<p>I have searched in Google, but got nothing useful. Any suggest is welcome.\nThanks a lot.</p>\n\n<p>My system is SUSE 11 Linux, spc 1.</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489562070, "post_id": 42803129, "comment_id": 72719601, "body": "Read this <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489563019, "post_id": 42803129, "comment_id": 72720066, "body": "OT: always check <code>fopen</code> returned value before to use it."}], "owner": {"reputation": 31, "user_id": 2899571, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002072558506/picture?type=large", "display_name": "Krishna Priya", "link": "https://stackoverflow.com/users/2899571/krishna-priya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489561914, "creation_date": 1489561545, "last_edit_date": 1489561914, "question_id": 42803129, "link": "https://stackoverflow.com/questions/42803129/mail-using-c-code-in-unix-box", "title": "Mail using c code in unix box", "body": "<p>I used below code to send mail from my unix box. It compiled successfully.But I am not receiving any mails in mail box. Kindly help me on this. \nDo I need to do any configuration for this?</p>\n\n<p>After executing the code I am seeing the some file in  /usr/spool/mail folder.\nWhat it means actually? </p>\n\n<pre><code>    char cmd[100];  // to hold the command.\n    char to[] = \"sample@example.com\"; // email id of the recepient.\n    char body[] = \"SO rocks\";    // email body.\n    char tempFile[100];     // name of tempfile.\n\n    strcpy(tempFile,tempnam(\"/tmp\",\"sendmail\")); // generate temp file name.\n\n    FILE *fp = fopen(tempFile,\"w\"); // open it for writing.\n    fprintf(fp,\"%s\\n\",body);        // write body to it.\n    fclose(fp);             // close it.\n\n    sprintf(cmd,\"sendmail %s &lt; %s\",to,tempFile); // prepare command.\n    system(cmd);     // execute it.\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 4, "creation_date": 1489561606, "post_id": 42803110, "comment_id": 72719360, "body": "because <code>matrix[3][3]</code> isn&#39;t a <code>int**</code> but <code>*int[3]</code>"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1489561651, "post_id": 42803110, "comment_id": 72719383, "body": "but shouldn&#39;t it access the same memory location?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1489561796, "post_id": 42803110, "comment_id": 72719440, "body": "@noob No, not at all. After all, an <code>int**</code> is a pointer to a pointer. While a <code>*int[3]</code> contains pointers to integers. How can code that expects pointers to pointers work if you give it pointers to integers?"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1489561930, "post_id": 42803110, "comment_id": 72719520, "body": "I see. I used the ** since I want the size to be dynamic. How can I declare this function if I want both dimensions of the array to be determined in run-time?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 3, "creation_date": 1489561996, "post_id": 42803110, "comment_id": 72719556, "body": "If you&#39;re gonna work with multi-dimensional arrays, read this <a href=\"http://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\" title=\"correctly allocating multi dimensional arrays\">stackoverflow.com/questions/42094465/&hellip;</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489563222, "post_id": 42803110, "comment_id": 72720157, "body": "<code>int[3][3] mat</code> isn&#39;t even valid C and won&#39;t compile."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489565080, "post_id": 42803110, "comment_id": 72721090, "body": "@Lundin typo. I corrected it"}], "answers": [{"comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1489562396, "post_id": 42803294, "comment_id": 72719766, "body": "thx! I tried using the mat_size s.n as argument but didn&#39;t succeed so I thought of sending mat as void* and then casting it inside the function, but this looks way better"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1489563240, "post_id": 42803294, "comment_id": 72720164, "body": "If I now want to create a new function that returns a dynamically-determined-sized-array, how would I do that? I cant declare a &quot;int [][] f(){}&quot;... so should I declare a void* and then cast it?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1489563386, "post_id": 42803294, "comment_id": 72720235, "body": "You should think to use a struct with pointer to dynamic allocated array and dim. So you can return a simple struct pointer. Otherwise you can pass output arrays pointer ans sizes as parameters to function."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 3, "last_activity_date": 1489562196, "creation_date": 1489562196, "answer_id": 42803294, "question_id": 42803110, "link": "https://stackoverflow.com/questions/42803110/code-crashes-when-accessing-a-predefined-array/42803294#42803294", "title": "code crashes when accessing a predefined array", "body": "<p>The type of function parameter does not match the passed matrix because <code>matrix[3][3]</code> isn't a <code>int**</code> but <code>(*int)[3]</code>.</p>\n\n<p>From comment you also want to have dynamic sizes for your matrix so you can do that using <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html\" rel=\"nofollow noreferrer\">VLA</a> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct\n{\n    const unsigned int m;\n    const unsigned int n;\n} mat_size;\n\nvoid print_mat(mat_size s, int (*mat)[s.n])\n{\n    unsigned int i, j;\n    for (i = 0; i &lt; s.m; i++)\n    {\n        for (j = 0; j &lt; s.n; j++)\n        {\n            printf(\"%d \", mat[i][j]);\n        }\n        printf(\"\\n\");\n    }\n    printf(\"=============\\n\");\n}\n\nint main(int argc, char** argv)\n{\n\n    int matrix[3][3] = { { 1, 4, 2 }, { 7, -1, 15 }, { 33, -10, -1 } };\n    mat_size s = { 3, 3 };\n    print_mat(s, matrix);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1489563483, "last_edit_date": 1495541384, "creation_date": 1489563483, "answer_id": 42803644, "question_id": 42803110, "link": "https://stackoverflow.com/questions/42803110/code-crashes-when-accessing-a-predefined-array/42803644#42803644", "title": "code crashes when accessing a predefined array", "body": "<p>An array that is declared as a function parameter gets silently adjusted by the compiler to the first object. This is why</p>\n\n<pre><code>void func (int a[5]);\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>void func (int* a);\n</code></pre>\n\n<p>Similarly, an array that is declared by the caller and passed to such a function, also \"decays\" into a pointer to the first element.</p>\n\n<p>The rationale behind this is that arrays shouldn't get passed by value to functions, since taking a hard copy of an array takes up execution time and memory.</p>\n\n<hr>\n\n<p>In the case of multi-dimensional arrays, the same rules apply. Given a function <code>void print_mat(int mat[3][3])</code>, the array will get silently adjusted to a pointer to the first element. The first element in an <code>int [3][3]</code> array is an array of type <code>int[3]</code>. Therefore a pointer to such an element must be an <em>array pointer</em>, <code>int (*)[3]</code>.</p>\n\n<p>Therefore <code>void print_mat(int mat[3][3])</code> is equivalent to <code>void print_mat(int (*mat)[3])</code>. So you can change the function to use such an array pointer and it would be equivalent.</p>\n\n<p>However, I would recommend using a variable approach instead:</p>\n\n<pre><code>void print_mat (size_t x, size_t y, int mat[x][y])\n</code></pre>\n\n<hr>\n\n<p>Pointer-to-pointers have nothing to do with multi-dimensional arrays, though they can be used to emulate one together with dynamic memory allocation. Doing so is however most often bad and incorrect practice. See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a> for more info about that.</p>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 42803294, "answer_count": 2, "score": 2, "last_activity_date": 1489565056, "creation_date": 1489561468, "last_edit_date": 1489565056, "question_id": 42803110, "link": "https://stackoverflow.com/questions/42803110/code-crashes-when-accessing-a-predefined-array", "title": "code crashes when accessing a predefined array", "body": "<p>I'm having trouble understanding why my code crashes when accessing the array. When converting the function param to <code>int[3][3]</code> instead of <code>int**</code> I get no problems, but I can't understand why, since the <code>int**</code> I'm given as a argument is a valid pointer that points to local memory defined in <code>main</code></p>\n\n<pre><code>typedef struct {const unsigned int m; const unsigned int n;} mat_size;\n\nvoid print_mat(int** mat, mat_size s){  // &lt;-- faulty version\n    int i,j;\n    for(i = 0; i &lt; s.m; i++){\n        for(j = 0; j &lt; s.n; j++){\n            printf(\"%d \", mat[i][j]);\n        }\n        printf(\"\\n\");\n    } \n    printf(\"=============\");\n}\n\n\nint main(int argc, char** argv) {\n\n    int matrix[3][3] = {{1,4,2},{7,-1,15},{33,-10,-1}};\n    mat_size s = {3,3};\n    print_mat(matrix, s);  \n\n    while(1);\n    return 0;\n}\n\nvoid print_mat(int mat[3][3], mat_size s){  // &lt;-- good version\n    int i,j;\n    for(i = 0; i &lt; s.m; i++){\n        for(j = 0; j &lt; s.n; j++){\n            printf(\"%d \", mat[i][j]);\n        }\n        printf(\"\\n\");\n    } \n    printf(\"=============\");\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1489565201, "post_id": 42803083, "comment_id": 72721167, "body": "You need to store the <code>index</code> of the max value, along the value itself, and return it. I would also rename the function to <code>findIndexOfMax</code> to make it obvious what it should be doing."}, {"owner": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1489565895, "post_id": 42803083, "comment_id": 72721559, "body": "Thank you guys! I got it to work."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "edited": false, "score": 0, "creation_date": 1489563713, "post_id": 42803115, "comment_id": 72720388, "body": "Thanks! I&#39;ve fixed what you&#39;ve mentioned and I&#39;m still not getting the correct numbers."}], "tags": [], "owner": {"reputation": 3102, "user_id": 3137699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6d2nI.jpg?s=128&g=1", "display_name": "Natasha Dutta", "link": "https://stackoverflow.com/users/3137699/natasha-dutta"}, "is_accepted": false, "score": 2, "last_activity_date": 1489561478, "creation_date": 1489561478, "answer_id": 42803115, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array/42803115#42803115", "title": "using function to find max value in an array", "body": "<p>I'm not sure if this is a typo here, but it appears while calling</p>\n\n<pre><code> int  high = findHighNumber(percentages, elements);\n</code></pre>\n\n<p>you don't have a variable <code>elements</code> defined there. That said, you have another syntax error (missing the closing <code>}</code>) near</p>\n\n<pre><code>if (high &lt; percentages[index])\n       {\n        high = percentages[index];  ///after this.\n</code></pre>\n\n<p>Finally, inside <code>findHighNumber ()</code>, <code>elements</code> is local to the function, so, the <em>only</em> usage as <code>elements = index+1;</code> is useless.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "edited": false, "score": 0, "creation_date": 1489563903, "post_id": 42803222, "comment_id": 72720472, "body": "I&#39;m about 4 weeks into programming so bear with me but I&#39;m not exactly sure what mean by return the index where the higher element is. Cold you show an example? I removed the &quot;elements = index +1&quot;"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "edited": false, "score": 0, "creation_date": 1489568062, "post_id": 42803222, "comment_id": 72722772, "body": "@JessicaBlake It looks like ncarrier already resolved your doubts ;)"}], "tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 1, "last_activity_date": 1489561911, "creation_date": 1489561911, "answer_id": 42803222, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array/42803222#42803222", "title": "using function to find max value in an array", "body": "<p>Given the way you are storing and using data, you should return the index where the higher element is, not its value.\nAlso you have to pass the right size of the array (and don't change it inside the function), while you are passing an uninitialized value.</p>\n"}, {"tags": [], "owner": {"reputation": 944, "user_id": 2434120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dedac18837648b2f5c2cb279f6e25d5?s=128&d=identicon&r=PG", "display_name": "jyap", "link": "https://stackoverflow.com/users/2434120/jyap"}, "is_accepted": false, "score": 1, "last_activity_date": 1489565226, "last_edit_date": 1489565226, "creation_date": 1489564915, "answer_id": 42804034, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array/42804034#42804034", "title": "using function to find max value in an array", "body": "<p>You should send the index instead of the value.</p>\n\n<pre><code>int findIndexOfMax (double percentages[], int elements) {\n\n    int index = 0;\n    int highIndex = 0;\n    double high = 0.0;\n    high = percentages[highIndex];\n\n    for (index = 1; index &lt; elements; index++) \n    {\n        if (high &lt; percentages[index]) \n        {\n            high = percentages[index];\n            highIndex = index;\n        }       \n    }\n\n    return highIndex;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "edited": false, "score": 0, "creation_date": 1489565866, "post_id": 42804139, "comment_id": 72721547, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 413, "user_id": 3374090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1e9e24a7d54780360da03c4342d94a?s=128&d=identicon&r=PG&f=1", "display_name": "ncarrier", "link": "https://stackoverflow.com/users/3374090/ncarrier"}, "is_accepted": true, "score": 2, "last_activity_date": 1489565247, "creation_date": 1489565247, "answer_id": 42804139, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array/42804139#42804139", "title": "using function to find max value in an array", "body": "<p>First, you have to declare the <code>elements</code> variable in <code>main()</code>:</p>\n\n<pre><code>int elements = 7;\n</code></pre>\n\n<p>or even better:</p>\n\n<pre><code>int elements = sizeof(percentages) / sizeof(*percentages);\n</code></pre>\n\n<p>which computes the array size automatically.</p>\n\n<p>Then, don't modify the <code>elements</code> variable in you loop.\nIf you do it, each time the current maximum is changed, you program your loop to stop after the next element, potentially missing the real maximum which can be located at the end of the array.</p>\n\n<p>Then, like Bob said, you should return the <strong>index of the maximum</strong>, this way, you can retrieve the corresponding sampleSize, or year.<br>\nWhen you do <code>years[high]</code>, you're using a <strong>percentage as an array index</strong> which can take any real value in [0,100], instead of an index which must stay in {0, 1, 2, 3, 4, 5, 6}.</p>\n\n<p>What's more, you store <code>high</code> in an <strong>integer</strong> variable, resulting in a truncation of it's value. You may prefer to store it as a <strong>double</strong> variable.</p>\n\n<p>So <code>findHighNumber()</code> can become:</p>\n\n<pre><code>    int findHighNumber(double percentages[], int elements)\n    {\n            int index;\n            double high;\n            int high_index;\n\n            high_index = 0;\n            high = percentages[high_index];\n\n            for (index = 1; index &lt; elements; index++)\n                    if (high &lt; percentages[index]) {\n                            high = percentages[index];\n                            high_index = index;\n                    }\n\n            return high_index;\n    }\n</code></pre>\n\n<p>The <code>main()</code> function now can become something like:</p>\n\n<pre><code>    int main (void)\n    {\n            int years[] = {2000, 2002, 2004, 2006, 2008, 2010, 2012};\n            double percentages[] = {6.7, 6.6, 8, 9, 11.3, 14.7, 14.6};\n            int sampleSizes[] = {187761, 444050, 172335, 308038, 337093, 1000,\n                    46978};\n            int elements = sizeof(percentages) / sizeof(*percentages);\n            int high_index = findHighNumber(percentages, elements);\n\n            printf (\"%i had the highest percentage with autism at %.2lf%% (sample\"\n                    \"size was %d).\\n\", years[high_index], percentages[high_index],\n                    sampleSizes[high_index]);\n\n            return 0;\n    }\n</code></pre>\n\n<p>Then, some small advices:</p>\n\n<ol>\n<li>putting a prototype of <code>findHighNumber()</code> is not needed, just define the function above the places where it's needed. This way, when you <strong>really</strong> have to put a prototype for a function, it a hint saying that you were forced to do so, (for example for mutually recursive functions), plus it shortens the code.</li>\n<li><p>you should define a, for example, <code>struct autism_sample</code> like that:</p>\n\n<pre><code>struct autism_sample {\n        int year;\n        int sample_size;\n        double percentage;\n};\n</code></pre>\n\n<p>This way, you just have to define one array:</p>\n\n<pre><code>struct autism_sample autism_samples[] = {\n    {\n        .year = 2000,\n        .sample_size = 187761,\n        .percentage = 6.7,\n    },\n    {\n        .year = 2002,\n        .sample_size = 444050,\n        .percentage = 6.6,\n    },\n    ...\n};\n</code></pre>\n\n<p>This way, your data is organized in a more logical way, less error-prone to maintain and you gain the choice, in the implementation of findHighNumber(), to return either the index of the maximum or directly, a pointer to the element holding the maximum, the index becomes then useless.<br>\nWhat's more, it's easier to (un)serialize...  </p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 806, "user_id": 7631183, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ceb7367e91c69b2ad355a235b16c0d0a?s=128&d=identicon&r=PG&f=1", "display_name": "Wanderer", "link": "https://stackoverflow.com/users/7631183/wanderer"}, "is_accepted": false, "score": 0, "last_activity_date": 1489565291, "creation_date": 1489565291, "answer_id": 42804154, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array/42804154#42804154", "title": "using function to find max value in an array", "body": "<p>You are returning the wrong value .. you should not return what's the highest value but you should return the index of it. </p>\n\n<p>or you you can simply print the result that you want in the function you're calling.</p>\n\n<p>Also, I don't see that you have initialized the variable elements. </p>\n"}], "owner": {"reputation": 23, "user_id": 7713160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212234824690806/picture?type=large", "display_name": "Jessica Blake", "link": "https://stackoverflow.com/users/7713160/jessica-blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2281, "favorite_count": 0, "accepted_answer_id": 42804139, "answer_count": 5, "score": 1, "last_activity_date": 1489565291, "creation_date": 1489561366, "last_edit_date": 1489563653, "question_id": 42803083, "link": "https://stackoverflow.com/questions/42803083/using-function-to-find-max-value-in-an-array", "title": "using function to find max value in an array", "body": "<p>Can someone please explain what I'm doing wrong. I need to use an array to find the max value of the percentages array and display that amount and the year in the corresponding years array. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint findHighNumber (double percentages[], int elements);\n\nint main (void)\n{\n\n  int index;\n  int elements;\n\n\n  int years[] = {2000, 2002, 2004, 2006, 2008, 2010, 2012};\n  double percentages[] = {6.7, 6.6, 8, 9, 11.3, 14.7, 14.6};\n  int sampleSizes[] = {187761, 444050, 172335, 308038, 337093, 1000, 346978};\n\n\n   int  high = findHighNumber(percentages, elements);\n   printf (\"%i had the highest percentage with autism at %.2lf%%.\\n\", years[high], percentages[high]);\n\n\n   return 0;\n}\n\n int findHighNumber (double percentages[], int elements)\n {\n    int index, high;\n    high = percentages[0];\n\n    for (index = 1; index &lt; elements; index++)\n       if (high &lt; percentages[index])\n       {\n        high = percentages[index];\n    }\n   return high;\n }\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489560647, "post_id": 42802853, "comment_id": 72718925, "body": "Did you copy the code from somewhere?"}, {"owner": {"reputation": 9, "user_id": 7532867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0debadb28c890c44f1d3902aba253a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Tian", "link": "https://stackoverflow.com/users/7532867/mark-tian"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489560681, "post_id": 42802853, "comment_id": 72718940, "body": "No I wrote it myself, I just don&#39;t know how to actually call the function @sourav"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1489560738, "post_id": 42802853, "comment_id": 72718968, "body": "In that case, you need a good book, tutorial or TA. All of them are either unavailable or off-topic at SO."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1489561010, "post_id": 42802853, "comment_id": 72719096, "body": "<code>void generate_data(float input_buffer[])</code> --&gt; <code>float *generate_data(float input_buffer[])</code>, call <code>generate_data(input_buffer);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 419, "user_id": 2184960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee3fb011aab6b63cb1aed2df949e8c6?s=128&d=identicon&r=PG", "display_name": "jjm", "link": "https://stackoverflow.com/users/2184960/jjm"}, "is_accepted": false, "score": 0, "last_activity_date": 1489568849, "creation_date": 1489568849, "answer_id": 42805285, "question_id": 42802853, "link": "https://stackoverflow.com/questions/42802853/using-pointers-to-return-array-from-function-in-c/42805285#42805285", "title": "Using Pointers to Return Array from Function in C", "body": "<p>Please check the below source code. Check comments in code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;  \n\n#define MAX_DATA_SIZE 10\nvoid generate_data(float input_buffer[]); /*prototyping the function*/\n\nint main(void) {\n    float input_buffer[MAX_DATA_SIZE + 2] = { 0 };\n    int i = 0; /*counter for input buffer array*/\n\n    generate_data(input_buffer); /* Generate Random data*/\n\n    while (i &lt; input_buffer[0]+2) {  /* Print arrey from the begining*/\n        printf(\"input_buffer[%d] = %f\\n\",i,input_buffer[i]); \n        i++;\n    }\n\n    return 0;\n}\n\nvoid generate_data(float input_buffer[])\n{\n    int no_of_data_points;\n    int function_ID = 0;\n\n    srand(time(NULL));\n\n    no_of_data_points = 2 + rand() % (MAX_DATA_SIZE - 2 + 1); /*generates number of data points that ranges from 2 to MAX DATA SIZE*/\n\n    printf(\"------&gt; %d\\n\",no_of_data_points); /* Just for understanding*/\n\n    function_ID = 1 + rand() % (4 - 1 + 1);   /*generates function ID that ranges from 1 to 4*/\n\n    input_buffer[0] = no_of_data_points;\n    input_buffer[1] = function_ID;\n\n    int i = 2; /*counter for input buffer array*/\n\n    while (i &lt; no_of_data_points+2) { /* Store the \"no_of_data_points\" to array from i = 2*/ \n        input_buffer[i] = (float)rand() / RAND_MAX;\n        i++;\n    }\n\n    return; /* Return type is void*/\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7532867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0debadb28c890c44f1d3902aba253a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Tian", "link": "https://stackoverflow.com/users/7532867/mark-tian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1489568849, "creation_date": 1489560557, "last_edit_date": 1489568746, "question_id": 42802853, "link": "https://stackoverflow.com/questions/42802853/using-pointers-to-return-array-from-function-in-c", "title": "Using Pointers to Return Array from Function in C", "body": "<p>I'm writing a piece of code where I have a function that generates random numbers and places them into an array. I'm very lost on how to use pointers and would appreciate any help.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;  \n\n#define MAX_DATA_SIZE 10\nvoid generate_data(float input_buffer[]); /*prototyping the function*/\n\nint main(void)\n{\n    float input_buffer[MAX_DATA_SIZE + 2] = { 0 };\n    /*calls the array and prints it*/\n    return 0;\n}\n\nvoid generate_data(float input_buffer[])\n{\n    int no_of_data_points;\n    int function_ID = 0;\n\n    srand(time(NULL));\n\n    no_of_data_points = 2 + rand() % (MAX_DATA_SIZE - 2 + 1); /*generates number    of data points that ranges from 2 to MAX DATA SIZE*/\n    function_ID = 1 + rand() % (4 - 1 + 1); /*generates function ID that ranges from 1 to 4*/\n\n    input_buffer[0] = no_of_data_points;\n    input_buffer[1] = function_ID;\n\n    int i = 2; /*counter for input buffer array*/\n\n    while (i &lt;= no_of_data_points) {\n        input_buffer[i] = (float)rand() / RAND_MAX;\n        i++;\n    }\n    return input_buffer;\n}\n</code></pre>\n"}, {"tags": ["c", "insert", "doubly-linked-list"], "comments": [{"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "edited": false, "score": 0, "creation_date": 1489561274, "post_id": 42802818, "comment_id": 72719206, "body": "You are returning the temp(last node) and assigning to head in tailInsert function"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489561889, "post_id": 42802818, "comment_id": 72719501, "body": "<code>return tailInsert(head-&gt;next, data);</code> --&gt; <code>tailInsert(head-&gt;next, data);     return head;</code> or <code>node *tailInsert(node *head, int data)</code> --&gt; <code>void  tailInsert(node *head, int data)</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489562118, "post_id": 42802818, "comment_id": 72719620, "body": "Also <code>frontInsert</code> needs <code>head-&gt;prev = newHead;</code>"}, {"owner": {"reputation": 120, "user_id": 5563225, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/54159a68ec7941e85d0ae4c581be0d44?s=128&d=identicon&r=PG&f=1", "display_name": "starlight", "link": "https://stackoverflow.com/users/5563225/starlight"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1489562123, "post_id": 42802818, "comment_id": 72719625, "body": "@BLUEPIXY Thank you, the first way did not work, however, the second one worked :)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1489562311, "post_id": 42802818, "comment_id": 72719724, "body": "first <a href=\"http://ideone.com/rHD8uY\" rel=\"nofollow noreferrer\">DEMO</a>"}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5563225, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/54159a68ec7941e85d0ae4c581be0d44?s=128&d=identicon&r=PG&f=1", "display_name": "starlight", "link": "https://stackoverflow.com/users/5563225/starlight"}, "edited": false, "score": 0, "creation_date": 1489561612, "post_id": 42803103, "comment_id": 72719364, "body": "I updated it to return the head, however, it only prints the last two values now. I&#39;m confused because the code was identical other than the pointer to the previous node to my singly linked list that worked perfectly fine."}, {"owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "reply_to_user": {"reputation": 120, "user_id": 5563225, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/54159a68ec7941e85d0ae4c581be0d44?s=128&d=identicon&r=PG&f=1", "display_name": "starlight", "link": "https://stackoverflow.com/users/5563225/starlight"}, "edited": false, "score": 0, "creation_date": 1489561976, "post_id": 42803103, "comment_id": 72719545, "body": "You have used recursion. The head node during the last recursive call would be the tail node."}, {"owner": {"reputation": 120, "user_id": 5563225, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/54159a68ec7941e85d0ae4c581be0d44?s=128&d=identicon&r=PG&f=1", "display_name": "starlight", "link": "https://stackoverflow.com/users/5563225/starlight"}, "edited": false, "score": 0, "creation_date": 1489562139, "post_id": 42803103, "comment_id": 72719633, "body": "Thank you! I understand now."}], "tags": [], "owner": {"reputation": 846, "user_id": 4675426, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6a40956551f38afd8a2c712b4780d73a?s=128&d=identicon&r=PG", "display_name": "Karthick", "link": "https://stackoverflow.com/users/4675426/karthick"}, "is_accepted": true, "score": 1, "last_activity_date": 1489563256, "last_edit_date": 1489563256, "creation_date": 1489561440, "answer_id": 42803103, "question_id": 42802818, "link": "https://stackoverflow.com/questions/42802818/inserting-to-head-and-tail-of-a-doubly-linked-list-only-prints-out-last-tail/42803103#42803103", "title": "Inserting to head and tail of a doubly linked list -- only prints out last tail item inserted", "body": "<p>You are returning the temp(last node) from tailInsert and assigning to head. Do not change the head pointer if you are inserting at tail.</p>\n\n<pre><code>void tailInsert(node *head, int data)\n{\n    if(head-&gt;next == NULL)\n    {\n      node *temp;\n      temp = createNode(data);\n      temp-&gt;next = NULL;\n      temp-&gt;prev = head;\n      head-&gt;next = temp;\n      return ;\n    }\n    tailInsert(head-&gt;next, data);\n}\n</code></pre>\n\n<p>In main do not assign anything to head if you are calling <code>tailInsert</code> function</p>\n"}], "owner": {"reputation": 120, "user_id": 5563225, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/54159a68ec7941e85d0ae4c581be0d44?s=128&d=identicon&r=PG&f=1", "display_name": "starlight", "link": "https://stackoverflow.com/users/5563225/starlight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1965, "favorite_count": 0, "accepted_answer_id": 42803103, "answer_count": 1, "score": 0, "last_activity_date": 1489563256, "creation_date": 1489560447, "last_edit_date": 1489562017, "question_id": 42802818, "link": "https://stackoverflow.com/questions/42802818/inserting-to-head-and-tail-of-a-doubly-linked-list-only-prints-out-last-tail", "title": "Inserting to head and tail of a doubly linked list -- only prints out last tail item inserted", "body": "<p>I am trying to implement a doubly linked list in order to study for an exam and am running into some trouble when inserting items into the tail -- it prints out correctly when I only insert to the head in the list. However, when I insert to the tail in the list only the last tail item is printed out. Below is my full code:</p>\n\n<pre><code> /*\n    - Q2: Write a function that takes a LinkedList struct pointer and inserts at the head of the linked list. \n\n    - Q3. Write a function that takes a LinkedList struct pointer and frees all memory associated with it. (\n          For a solution, see fancy-linked-lists.c, attached above.) \n\n    - Q4  Review all the functions from today's code and give their big-oh runtimes.\n\n    - Q5:  Implement  functions for doubly linked lists: \n        -  tail_insert(), \n        -  head_insert(), \n        -  tail_delete(), \n        -  head_delete(), \n        -  delete_Nth(). \n        -  Repeat these exercises with doubly linked lists in which you maintain a tail pointer.\n        -  How does the tail pointer affect the runtimes of these functions?\n        -  Are any of these functions more efficient for doubly linked lists with tail pointers than they are for singly linked lists with tail pointers?\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct node\n{\n   int data;\n   struct node *next;\n   struct node *prev;\n} node;\n\nnode *createNode(int data)\n{\n    node *ptr = NULL;\n    ptr = malloc(sizeof(node));\n    if(ptr == NULL)\n    {\n        printf(\"space could not be allocated\\n\");\n        return NULL;\n    }\n\n    ptr-&gt;data = data;\n    ptr-&gt;next = NULL;\n    ptr-&gt;prev = NULL;\n\n    return ptr;\n}\n\nnode *tailInsert(node *head, int data)\n{\n        if(head-&gt;next == NULL)\n    {\n        node *temp;\n        temp = createNode(data);\n        temp-&gt;next = NULL;\n        temp-&gt;prev = head;\n        head-&gt;next = temp;\n        return head;\n    }\n    tailInsert(head-&gt;next, data);\n}\n\nnode *frontInsert(node *head, int data)\n{\n    node *newHead;\n\n    if(head == NULL)\n    {\n        return createNode(data);\n    }\n\n    newHead = createNode(data);\n    newHead-&gt;next = head;\n    newHead-&gt;prev = NULL;\n\n    return newHead;\n}\n\nnode *destroy_linked_list(node *list)\n{\n    /*if (list == NULL)\n        return NULL;\n\n    // Free the entire list within this struct.\n    destroy_list(list-&gt;head);\n\n    // Free the struct itself.\n    free(list);\n\n    return NULL;\n    */\n}\n\nvoid printList(node *head)\n{\n    if (head == NULL)\n    {\n        printf(\"Empty List\\n\");\n        return;\n    }\n\n    for(; head != NULL; head = head-&gt;next)\n        printf(\"%d \", head-&gt;data);\n\n    printf(\"\\n\");\n}\n\nint main(void)\n{\n    node *head = NULL;\n\n    head = frontInsert(head, 1);\n    head = frontInsert(head, 2);\n    head = frontInsert(head, 3);\n    head = tailInsert(head, 4);\n    head = tailInsert(head, 5);\n    head = tailInsert(head, 6);\n\n    printList(head);\n\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>I appreciate the help!</p>\n"}, {"tags": ["c", "recursion", "multidimensional-array"], "comments": [{"owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "edited": false, "score": 0, "creation_date": 1489560737, "post_id": 42802801, "comment_id": 72718967, "body": "What is the problem with passing the array through <code>forkFork</code> function as an argument?"}, {"owner": {"reputation": 241, "user_id": 3437710, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/29282ad7d97865afbba4f94a4bfe03ae?s=128&d=identicon&r=PG&f=1", "display_name": "hkn", "link": "https://stackoverflow.com/users/3437710/hkn"}, "reply_to_user": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "edited": false, "score": 0, "creation_date": 1489560874, "post_id": 42802801, "comment_id": 72719027, "body": "its not passing new values ; for example at the first call of forkFork , matrix array changes to {1,4,9,16} In the second process call (with recursion) i am trying to pass  {1,4,9,16} to forkFork function but its using old values {1,2,3,4}"}, {"owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "edited": false, "score": 1, "creation_date": 1489563260, "post_id": 42802801, "comment_id": 72720176, "body": "I have spotted the problem and provided a solution below."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1489564267, "post_id": 42802801, "comment_id": 72720650, "body": "Are you deliberately trying to make your program as inefficient as possible? If not, forget about fork and forget about recursion."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 3437710, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/29282ad7d97865afbba4f94a4bfe03ae?s=128&d=identicon&r=PG&f=1", "display_name": "hkn", "link": "https://stackoverflow.com/users/3437710/hkn"}, "edited": false, "score": 0, "creation_date": 1489613576, "post_id": 42803482, "comment_id": 72753914, "body": "btw is it good to pass matrix from parent to child with pipe for this code ?"}, {"owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "reply_to_user": {"reputation": 241, "user_id": 3437710, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/29282ad7d97865afbba4f94a4bfe03ae?s=128&d=identicon&r=PG&f=1", "display_name": "hkn", "link": "https://stackoverflow.com/users/3437710/hkn"}, "edited": false, "score": 0, "creation_date": 1489614580, "post_id": 42803482, "comment_id": 72754390, "body": "kln I don&#39;t why you are spawning processes for this small example. If you are doing for the sake of learning I think it would be a good exercise to try pipes. There is a nice starting point here: <a href=\"http://stackoverflow.com/q/16133464/1952879\">stackoverflow.com/q/16133464/1952879</a>"}], "tags": [], "owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1489562957, "creation_date": 1489562957, "answer_id": 42803482, "question_id": 42802801, "link": "https://stackoverflow.com/questions/42802801/passing-2d-array-to-recursion/42803482#42803482", "title": "passing 2D Array to recursion", "body": "<p>The problem with your solution is that all forked processes are created by the main/parent process. Therefore, each forked process just inherits the address space of the parent whose matrix values are always {1, 2, 3, 4}. The solution is for each modifying process to create its child process. Thus a new child process inherits the modified matrix.</p>\n\n<p>See my solution below for <code>forkFork</code> function which works as expected.</p>\n\n<pre><code>void forkFork(int counter)\n{\n    pid_t pid;\n    if(counter == 0)\n    {\n        exit(0);\n    }\n    if(counter &gt; 0)\n    {\n        if ((pid = fork()) &lt; 0)\n        {\n            perror(\"fork error :(\");\n        }\n        else if (pid == 0)\n        {\n            matrixPower(matrix);\n            print(matrix);\n            forkFork(counter - 1);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 3437710, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/29282ad7d97865afbba4f94a4bfe03ae?s=128&d=identicon&r=PG&f=1", "display_name": "hkn", "link": "https://stackoverflow.com/users/3437710/hkn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "accepted_answer_id": 42803482, "answer_count": 1, "score": 1, "last_activity_date": 1489562957, "creation_date": 1489560398, "last_edit_date": 1489562029, "question_id": 42802801, "link": "https://stackoverflow.com/questions/42802801/passing-2d-array-to-recursion", "title": "passing 2D Array to recursion", "body": "<p>I am trying to make calculations with using fork in C.\nI have a 2D array with members {1,2,3,4}, I have a function to get square for each member in the array. I will call this function with child processes.\nFor example for 3 child process output will be like this;</p>\n\n<pre><code>1.Child\n1 4\n9 16\n----------\n2.Child\n1 16\n81 256\n----------\n3.Child\n1 256\n6561 65536\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n\nint matrix[2][2] = {1, 2, 3 ,4 }  ;\n\nint main(){\nforkFork(3);\n}\n\nvoid forkFork(int counter)\n{\n    pid_t pid;\n    if(counter == 0)\n    {\n        exit(0);\n    }\n    if(counter &gt; 0)\n    {\n        if ((pid = fork()) &lt; 0)\n        {\n            perror(\"fork error :(\");\n        }\n        else if (pid == 0)\n        {\n            matrixPower(matrix);\n            print(matrix);\n        }\n        else if(pid &gt; 0)\n        {\n            forkFork(counter - 1);\n        }\n    }\n}\n\nvoid matrixPower(int m[2][2])\n{\n    int i,j,k;\n    int result = 0;\n\n    for (i = 0; i &lt; 2; i++)\n    {\n        for (j = 0; j &lt; 2; j++)\n        {\n            result =  matrix[i][j]*matrix[i][j];\n\n            m[i][j] = result;\n            result = 0;\n        }\n    }\n}\n\nvoid print(int a[2][2])\n{\n    int row, col ;\n    for(  row = 0; row &lt; 2; row++ )\n    {\n        for(  col = 0; col &lt; 2 ; col++ )\n        {\n            printf(\"%d\\t\", a[row][col]);\n        }\n        puts(\"\");\n    }\n\n        printf(\"-------------------------------\\n\");\n}\n</code></pre>\n\n<p>I could not find a way to pass new array to recursion function...</p>\n"}, {"tags": ["c", "scanf", "compiler-warnings"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489560257, "post_id": 42802743, "comment_id": 72718748, "body": "What are you trying to achieve? This is a warning about a serious bug in your program. The entire behavior of your program is undefined."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1489560307, "post_id": 42802743, "comment_id": 72718772, "body": "<code>%d</code> --&gt; <code>&quot;%hhu&quot;</code> or <code>%c</code>, <code>main()</code> --&gt; <code>int main(void)</code>"}, {"owner": {"reputation": 1859, "user_id": 2157639, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/faaf63a16923788f63d2a2b68c8d3c6b?s=128&d=identicon&r=PG", "display_name": "Ivan  Ivanov", "link": "https://stackoverflow.com/users/2157639/ivan-ivanov"}, "edited": false, "score": 0, "creation_date": 1489560417, "post_id": 42802743, "comment_id": 72718808, "body": "scanf to int, then check length and copy to char"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1489560683, "last_edit_date": 1489560683, "creation_date": 1489560287, "answer_id": 42802771, "question_id": 42802743, "link": "https://stackoverflow.com/questions/42802743/want-to-remove-warning-without-change-data-type-to-char/42802771#42802771", "title": "Want to remove warning without change data-type to char", "body": "<p>Actually,</p>\n\n<pre><code>scanf(\"%d\",&amp;ch);\n</code></pre>\n\n<p>leaves your program with <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> as the supplied argument is not the correct type for the conversion specifier. You need to write</p>\n\n<pre><code>scanf(\"%hhu\",&amp;ch);\n</code></pre>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.21.6.2</p>\n\n<blockquote>\n  <p><code>hh</code></p>\n  \n  <p>Specifies that a following <code>d</code>, <code>i</code>, <code>o</code>, <code>u</code>, <code>x</code>, <code>X</code>, or <code>n</code> conversion specifier applies\n  to an argument with type pointer to <code>signed char</code> or <code>unsigned char</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 7574076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d7e8df5765f7c2a20ad0e4af23e4784?s=128&d=identicon&r=PG&f=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/7574076/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 42802771, "answer_count": 1, "score": 0, "last_activity_date": 1489560828, "creation_date": 1489560176, "last_edit_date": 1489560828, "question_id": 42802743, "link": "https://stackoverflow.com/questions/42802743/want-to-remove-warning-without-change-data-type-to-char", "title": "Want to remove warning without change data-type to char", "body": "<p>I want to remove warning without change data-type to char.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nmain()\n{\n    unsigned char ch;\n    printf(\"Hello This is Problematic\\n\");\n    scanf(\"%d\",&amp;ch);\n    printf(\"1\\n\");\n}\n</code></pre>\n\n<p>This generates the warning</p>\n\n<blockquote>\n  <p>test.c:7:2: warning: format \u2018%d\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018unsigned char *\u2019 [-Wformat=]   scanf(\"%d\",&amp;ch);</p>\n</blockquote>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489559378, "post_id": 42802515, "comment_id": 72718370, "body": "Welcome to Stack Overflow! <a href=\"http://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of <code>malloc()</code> and family in <code>C</code>.</a>."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 4, "creation_date": 1489559461, "post_id": 42802515, "comment_id": 72718404, "body": "&quot;does not work&quot; is not a useful problem statement. Please read this <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1489559810, "post_id": 42802515, "comment_id": 72718552, "body": "1) <code>&quot;%d%1[^\\n]s&quot;</code> is wrong."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1489559985, "post_id": 42802515, "comment_id": 72718641, "body": "Try <code>if (scanf(&quot;%d&quot;, &amp;list-&gt;val) == 1) { scanf(&quot;%*[^\\n]&quot;); scanf(&quot;%*c&quot;); \u2026</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1489562968, "post_id": 42802515, "comment_id": 72720050, "body": "@CoolGuy The format of the input is unclear at this time."}, {"owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "edited": false, "score": 0, "creation_date": 1489567043, "post_id": 42802515, "comment_id": 72722204, "body": "The format of input is totally fine, it stops reading once it sees a newline(\\n)."}], "answers": [{"tags": [], "owner": {"reputation": 2325, "user_id": 1952879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c0d1e907a5506a461719a612a5ae21?s=128&d=identicon&r=PG", "display_name": "hmatar", "link": "https://stackoverflow.com/users/1952879/hmatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1489567152, "creation_date": 1489567152, "answer_id": 42804709, "question_id": 42802515, "link": "https://stackoverflow.com/questions/42802515/scan-inputs-to-linked-list/42804709#42804709", "title": "scan inputs to linked list", "body": "<p>I had to take your code and try to reproduce the errors you are getting.\nYour code looks fine except that it gives compile-times errors as it fails to infer the type for <code>ListNode</code>.\nTypical errors are I getting that I think you are:</p>\n\n<pre><code>test.c:11:5: error: unknown type name \u2018ListNode\u2019\n     ListNode *list,*list2=NULL;\n</code></pre>\n\n<p>There are two solution alternatives:</p>\n\n<p><em>One</em>, modify the struct definition as below. With this approach, your code works like a charm. </p>\n\n<pre><code>typedef struct ListNode {\n  int val;\n  struct ListNode *next;\n} ListNode;\n</code></pre>\n\n<p><em>Two</em>, retain the definition of your struct but precede every struct variable declaration with keyword <code>struct</code>. E.g; instead of <code>ListNode *list,*list2=NULL;</code> do <code>struct ListNode *list,*list2=NULL;</code></p>\n\n<p>I tried to run your code, the sample input, and produced output is below. I hope this is how you expect your function to behave.</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 // &lt;- input\n9 8 7 6 5 4 3 2 // &lt;- output\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7713002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798e26eff2df44327fdfdd6b5794c591?s=128&d=identicon&r=PG&f=1", "display_name": "man chan", "link": "https://stackoverflow.com/users/7713002/man-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489567152, "creation_date": 1489559253, "question_id": 42802515, "link": "https://stackoverflow.com/questions/42802515/scan-inputs-to-linked-list", "title": "scan inputs to linked list", "body": "<p>I'm a newbie of programming. I have wrote a function to scan inputs to linked list. But it does not work. Can anyone help me find what the problem is?</p>\n\n<pre><code>ListNode *BuildList() {\n    char discard;\n    ListNode *list,*list2=NULL;\n    list = (ListNode*)malloc(sizeof(struct ListNode));\n    if ((scanf(\"%d%1[^\\n]s\", &amp;list-&gt;val, &amp;discard)) == 2) {\n        list-&gt;next = BuildList();\n        printf(\"%d \", list-&gt;next-&gt;val);\n    }\n    else\n    {\n        list-&gt;next = NULL;\n    }\n    return list;\n}\n</code></pre>\n\n<p>and ListNode is defined as</p>\n\n<pre><code>struct ListNode {\n    int val;\n    ListNode *next;\n};\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "pointers", "memory-address", "dereference"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1489559169, "post_id": 42802470, "comment_id": 72718275, "body": "The behavior of your program is undefined. You didn&#39;t initialize <code>test</code> so what is it pointing at for you to assign at <code>test[0]</code>?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1489560934, "post_id": 42802470, "comment_id": 72719054, "body": "You want to find and read a good C book. You also want to look at the warnings your compiler is giving you. Not doing this == wasting your time. Add <code>-Wall -Wextra -Wpedantic -Werror</code> to your compilation flags."}, {"owner": {"reputation": 1, "user_id": 7712948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d5d17fb524d29c69130b03d509716f?s=128&d=identicon&r=PG&f=1", "display_name": "jaytielle", "link": "https://stackoverflow.com/users/7712948/jaytielle"}, "edited": false, "score": 0, "creation_date": 1489562169, "post_id": 42802470, "comment_id": 72719651, "body": "Thanks, I&#39;m re-reading K&amp;R2, and I&#39;ve added those flags - it raised a: &#39;test&#39; is used uninitialized in this function [-Werror=uninitialized]   test[0] = &quot;Hello&quot;;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7712948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d5d17fb524d29c69130b03d509716f?s=128&d=identicon&r=PG&f=1", "display_name": "jaytielle", "link": "https://stackoverflow.com/users/7712948/jaytielle"}, "edited": false, "score": 1, "creation_date": 1489559878, "post_id": 42802502, "comment_id": 72718593, "body": "Thank you, I didn&#39;t realize this alone could mess with other portions of the code so significantly. The function call is expecting char** words unfortunately :\\ <a href=\"https://leetcode.com/problems/keyboard-row/#/description\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1, "user_id": 7712948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d5d17fb524d29c69130b03d509716f?s=128&d=identicon&r=PG&f=1", "display_name": "jaytielle", "link": "https://stackoverflow.com/users/7712948/jaytielle"}, "edited": false, "score": 0, "creation_date": 1489639877, "post_id": 42802502, "comment_id": 72761948, "body": "I might be misunderstanding it, the expected format is  char** findWords(char** words, int wordsSize, int* returnSize) {} - I am forced to use that function declaration."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1, "user_id": 7712948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d5d17fb524d29c69130b03d509716f?s=128&d=identicon&r=PG&f=1", "display_name": "jaytielle", "link": "https://stackoverflow.com/users/7712948/jaytielle"}, "edited": false, "score": 0, "creation_date": 1489645886, "post_id": 42802502, "comment_id": 72764129, "body": "@jaytielle what do you mean &quot;forced&quot;?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1489559653, "last_edit_date": 1489559653, "creation_date": 1489559211, "answer_id": 42802502, "question_id": 42802470, "link": "https://stackoverflow.com/questions/42802470/c-function-inputs-are-somehow-taking-the-same-memory-in-address/42802502#42802502", "title": "C function inputs are somehow taking the same memory in address", "body": "<p>The problem is</p>\n\n<pre><code>test[0] = \"Hello\";\ntest[1] = \"Alaska\";\ntest[2] = \"Dad\";\ntest[3] = \"Peace\";\n</code></pre>\n\n<p>all of these invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, as <code>test</code>, on it's own does not point to a <em>valid</em> memory. </p>\n\n<p>Before you can dereference <code>test</code> to obtain <code>test[n]</code>, you need to make sure that <code>test</code> is pointed to a valid memory which is having enough size to make the <code>test[n]</code> access a valid one.</p>\n\n<p>Instead of the above snippet, you can simple write</p>\n\n<pre><code> char * test[] = { \"Hello\", \"Alaska\", \"Dad\", \"Peace\" };\n</code></pre>\n\n<p>and get done with it.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489559321, "post_id": 42802508, "comment_id": 72718339, "body": "It points somewhere for sure, just we can&#39;t be sure about the &quot;where&quot; part. :)"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1489573228, "post_id": 42802508, "comment_id": 72726306, "body": "@SouravGhosh Yes, sure"}], "tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": false, "score": 2, "last_activity_date": 1489573260, "last_edit_date": 1489573260, "creation_date": 1489559229, "answer_id": 42802508, "question_id": 42802470, "link": "https://stackoverflow.com/questions/42802470/c-function-inputs-are-somehow-taking-the-same-memory-in-address/42802508#42802508", "title": "C function inputs are somehow taking the same memory in address", "body": "<pre><code>char **test; // this should be const char but func decl is predefined\n\ntest[0] = \"Hello\";\ntest[1] = \"Alaska\";\ntest[2] = \"Dad\";\ntest[3] = \"Peace\";\n</code></pre>\n\n<p>You can't do what you are doing above. <code>test</code> doesn't point to any \"meaningful\" place.</p>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 7479696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12ea7cffb9e02b31267bbacaca12b469?s=128&d=identicon&r=PG&f=1", "display_name": "Vidor Vistrom", "link": "https://stackoverflow.com/users/7479696/vidor-vistrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1489559584, "creation_date": 1489559584, "answer_id": 42802601, "question_id": 42802470, "link": "https://stackoverflow.com/questions/42802470/c-function-inputs-are-somehow-taking-the-same-memory-in-address/42802601#42802601", "title": "C function inputs are somehow taking the same memory in address", "body": "<p>Since you are invoking undefined behavior by calling a pointer that doesn't point to anywhere, various variables/ pointers may point to same memory address, just like in situations where different variables may contain the same garbage value!</p>\n"}], "owner": {"reputation": 1, "user_id": 7712948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d5d17fb524d29c69130b03d509716f?s=128&d=identicon&r=PG&f=1", "display_name": "jaytielle", "link": "https://stackoverflow.com/users/7712948/jaytielle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489573260, "creation_date": 1489559091, "last_edit_date": 1489559823, "question_id": 42802470, "link": "https://stackoverflow.com/questions/42802470/c-function-inputs-are-somehow-taking-the-same-memory-in-address", "title": "C function inputs are somehow taking the same memory in address", "body": "<p>I've been staring at this problem for a while and I can't seem to find an obvious solution nor the vocabulary to describe the specific issue. I'll try my best:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;string.h&gt;\n\nchar** findWords(char** words, int wordsSize, int* returnSize) {\n\n    *returnSize = 15; //&lt;- wordsSize and returnSize have the same memory address????\n\n    printf(\"wordsSize is %d\\n\", wordsSize);\n    for(int i=0; i&lt;wordsSize; i++)\n    {\n        printf(\"i: %d first word: %s, len: %d\\n\", i, words[i], strlen(words[i]));\n    }\n}\n\nint main(void){\n    char **test; // this should be const char but func decl is predefined\n\n    test[0] = \"Hello\";\n    test[1] = \"Alaska\";\n    test[2] = \"Dad\";\n    test[3] = \"Peace\";\n\n\n    int *foo;\n\n    findWords(test, 4, foo);\n\n    printf(\"%d\", *foo);\n\n}\n</code></pre>\n\n<p>When findWords() gets called, I see that &amp;wordsSize and *returnSize are the same (i.e. they have the same memory address)</p>\n\n<pre><code>[New Thread 3492.0x9d0]\n\nBreakpoint 1, findWords (words=0x7efde000, wordsSize=4, returnSize=0x28ff24) at keyboardrow.c:15\n15          printf(\"wordsSize is %d\\n\", wordsSize);\n(gdb) print &amp;wordsSize\n$1 = (int *) 0x28ff24\n(gdb) print returnSize\n$2 = (int *) 0x28ff24\n(gdb)\n</code></pre>\n\n<p>Am I missing something obvious? It seems to me that &amp;wordsSize and returnSize should have different memory addresses since they are two separate variables.</p>\n"}, {"tags": ["c", "algorithm", "matrix"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1489924103, "post_id": 42802208, "comment_id": 72874364, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/138446/discussion-on-question-by-manhattan-code-for-determinant-of-n-x-n-matrix\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489587222, "post_id": 42804835, "comment_id": 72736624, "body": "Thanks very much for taking out time but Its still not working. What should be done, and can you tell me why there is a hold as I am new to this community."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489587555, "post_id": 42804835, "comment_id": 72736931, "body": "The posted code works; before the change from <code>size_t</code> to <code>int</code> for the variable <code>l</code>, your <code>pow()</code> method would not work. BTW, this would need to be <code>pow(-1, k)</code>. You were using <code>j</code> here."}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489590359, "post_id": 42804835, "comment_id": 72739238, "body": "Thanks very much @David. I am using Codeblocks to compile and code is not working in that.I also tried a couple of code running websites.  I changed size_t to int but even after that its not working. All it does is asks me the size of the matrix and thats it.  Thankful that you are trying to help me out :)"}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489591165, "post_id": 42804835, "comment_id": 72739902, "body": "I just edited as you had pointed out. with this it asks me the value of the matix elements but then stops"}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489594336, "post_id": 42804835, "comment_id": 72742510, "body": "Thanks again. I did update my code in my original question on your lines but I did not change size_t, pow (although i changed j to k) and added continue statement. I also change variable l to p. Thanks a ton ...!!!"}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489709237, "post_id": 42804835, "comment_id": 72802190, "body": "I saw your Ideone link. Thanks for that. You have been amazing in teaching me. Just one more thing. I am able to run my code but now it is not giving the right value of the determinant. I also plugged in a specific matrix instead of scanf( ) command but the result is not correct. I feel that there is some problem with &#39;aj&#39; in  &quot;p = a[i][aj] .......* as the &#39;aj&#39; considers the last value taken by variable &#39;aj&#39; which happens to be &#39;n-1&#39;. Can this be fixed some how. It can be some other error as well. I am not getting the right answer. I have posted the updated code. Thanks a ton!!"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489710376, "post_id": 42804835, "comment_id": 72802493, "body": "@manhattan-- you just need to change this line: <code>p = a[0][aj]*pow(-1,k)*det(n-1, b)+p;</code> to <code>p = a[0][k]*pow(-1,k)*det(n-1, b)+p;</code> This is because you need to multiply the sub-determinant by the <code>k</code>th element of <code>a[0]</code>. I had this in my original answer, but missed this change in the Update for your newer code, an also missed it in the Ideone code since it did not affect my test case! Just goes to show, you should always have more than one test case ;) Sorry about that; I will update that line in my answer."}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489710709, "post_id": 42804835, "comment_id": 72802580, "body": "Thanks......I should have pointed out myself....That was an easy one. Thanks again...."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489711025, "post_id": 42804835, "comment_id": 72802649, "body": "@manhattan-- Here is a new <a href=\"http://ideone.com/TFY1oW\" rel=\"nofollow noreferrer\">Ideone link</a>. I see that you are still using <code>pow()</code> to alternate signs; as a next step, you should convert to using the multiplier <code>sign</code> instead. Also, if you found this answer helpful, consider <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accepting</a> by clicking on the checkmark next to my answer :)"}, {"owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "edited": false, "score": 0, "creation_date": 1489754614, "post_id": 42804835, "comment_id": 72821756, "body": "Thanks very much. You were extremely helpful....Thanks again..."}], "tags": [], "owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "is_accepted": false, "score": 3, "last_activity_date": 1489710426, "last_edit_date": 1489710426, "creation_date": 1489567530, "answer_id": 42804835, "question_id": 42802208, "link": "https://stackoverflow.com/questions/42802208/code-for-determinant-of-n-x-n-matrix/42804835#42804835", "title": "code for determinant of n X n matrix", "body": "<p>You need a function prototype for <code>det()</code> before <code>main()</code>, and the size argument needs to precede the VLA in the function call. Also, you should be using <code>size_t</code> for array indices instead of <code>int</code>.</p>\n\n<p>There is no reason to use <code>pow()</code> to alternate signs; instead use <code>int sign = 1;</code> and multiply by <code>-1</code> when the sign needs to be alternated.</p>\n\n<p>In the loop within <code>det()</code>, you have:</p>\n\n<pre><code>for(j=0 &amp;&amp; j!=k ; j&lt;n; j++) {}\n</code></pre>\n\n<p>with the intention of skipping over the <code>k</code>th column; instead you need to write this as:</p>\n\n<pre><code>for (j = 0; j &lt; n; j++) {\n    if (j == k) continue;\n    ...\n}\n</code></pre>\n\n<p>But there is a further problem here with:</p>\n\n<pre><code>b[i][j]=a[i][j];\n</code></pre>\n\n<p>Since the indices for <code>b[][]</code> and <code>a[][]</code> are not the same, and in fact <code>b</code> is smaller than <code>a</code>, this will result in writing out of bounds to <code>b</code>. Instead you can declare separate column indices for the two matrices:</p>\n\n<pre><code>size_t aj, bj;\n...\nfor (aj = 0, bj = 0; aj &lt; n; aj++)\n    {\n        if (aj == k) continue;\n            b[i-1][bj] = a[i][aj];\n            ++bj;\n        }\n        ...\n    }\n</code></pre>\n\n<p>Finally, you multiply the determinant of <code>b</code> by the wrong element of <code>a</code>:</p>\n\n<pre><code>l = a[0][j]*pow(-1,j)*det(b,n-1)+l;\n</code></pre>\n\n<p>After making the other corrections, this should be:</p>\n\n<pre><code>l = sign * a[0][k] * det(n-1, b) + l;\n</code></pre>\n\n<p>Here is the complete modified code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint det(size_t n, int a[n][n]);\n\nint main(void)\n{\n    size_t n,i,j;\n\n    printf(\"enter the size of the matrix: \");\n    scanf(\"%zu\", &amp;n);\n\n    int a[n][n];\n\n    printf(\"enter the matrix: \\n\");\n    for (i = 0; i &lt; n; i++)\n    {\n        for(j = 0; j &lt; n; j++)\n        {\n            scanf(\"%d\",  &amp;a[i][j]);\n        }\n    }\n\n    printf(\"determinant is %d\\n\", det(n, a));\n\n    return 0;\n}\n\nint det(size_t n, int a[][n])\n{\n    size_t i, aj, bj, k, d;\n    int l = 0;\n    int sign = 1;\n\n    if(n == 2)\n    {\n        d = a[0][0] * a[1][1] - a[0][1] * a[1][0];\n\n        return d;\n    }\n\n    else\n        for (k = 0; k &lt; n ; k++)\n        {\n            int b[n-1][n-1];\n\n            for (i = 1; i &lt; n; i++)\n            {\n                for (aj = 0, bj = 0; aj &lt; n; aj++)\n                {\n                    if (aj == k) continue;\n                    b[i-1][bj] = a[i][aj];\n                    ++bj;\n                }\n            }\n\n            l += sign * a[0][k] * det(n-1, b);\n            sign *= -1;\n        }\n\n    return l;\n}\n</code></pre>\n\n<p>Here are a couple of sample interactions:</p>\n\n<pre><code>\u03bb&gt; ./a.out \nenter the size of the matrix: 3\nenter the matrix: \n1 2 3\n4 5 6\n7 8 9\ndeterminant is 0\n\n\u03bb&gt; ./a.out \nenter the size of the matrix: 3\nenter the matrix: \n1 -2 3\n4 -5 6\n7 8 -9\ndeterminant is 42\n</code></pre>\n\n<h2>Update</h2>\n\n<p>OP has posted updated code, and this update is to address the new issues. First, <code>main()</code> must (for the most part) have one of two function signatures:</p>\n\n<pre><code>int main(void);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int main(int argc, char *argv[]);  // equivalently int main(int argc, char **argv);\n</code></pre>\n\n<p>Now, you must either move the definition of <code>det()</code> before <code>main()</code>, or add a function prototype:</p>\n\n<pre><code>int det( int n, int a[][n]);\n</code></pre>\n\n<p>Since <code>det()</code> uses VLAs, the size argument must come before the array argument, so the function calls must change to:</p>\n\n<pre><code>printf(\"%d determinant is\", det(n, a));\n</code></pre>\n\n<p>and</p>\n\n<pre><code>p = a[0][k]*pow(-1,k)*det(n-1, b)+p;\n</code></pre>\n\n<p>Finally, within the inner loop in <code>det()</code>, you must keep two indices, <code>aj</code> and <code>bj</code>, since <code>a[][]</code> and <code>b[][]</code> are different sizes, and the elements of <code>a[][]</code> and <code>b[][]</code> do not exactly correspond:</p>\n\n<pre><code>for(aj=0, bj=0 ; aj&lt;n; aj++)\n{\n    if(aj==k) continue;\n    b[i-1][bj]=a[i][aj];\n    ++bj;\n}\n</code></pre>\n\n<p>I would suggest <em>not</em> using <code>pow()</code> for the sign alternation for a number of reasons; it involves an unnecessary library call, and the return value of <code>pow()</code> is <code>double</code>.</p>\n\n<p>Most of these points were made in the original answer. After making these changes, your code worked for me.</p>\n"}], "owner": {"reputation": 111, "user_id": 7438158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67caba72f8d45b17925718e7bc107984?s=128&d=identicon&r=PG&f=1", "display_name": "na1201", "link": "https://stackoverflow.com/users/7438158/na1201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4067, "favorite_count": 0, "closed_date": 1489580769, "answer_count": 1, "score": -3, "last_activity_date": 1489741662, "creation_date": 1489558065, "last_edit_date": 1592644375, "question_id": 42802208, "link": "https://stackoverflow.com/questions/42802208/code-for-determinant-of-n-x-n-matrix", "closed_reason": "Not suitable for this site", "title": "code for determinant of n X n matrix", "body": "<p>I wrote my code and tried compiling in Codeblocks but it is not working. While running the programming it was showing errors in &quot;int det(, )&quot;. I also tried using &quot;*a&quot; but it did not work. All it does is ask me the size of the matrix and the values and then stops. I am writing the full program but I believe the error is in the part of <code>int det(int n, int a[][])</code>.</p>\n<pre><code>#include&lt;math.h&gt;\n\nmain()\n\n{\n\n    int n,i,j;\n\n    printf(&quot;enter the size of the matrix&quot;);\n\n    scanf(&quot;%d&quot;, &amp;n);\n\n\n    int a[n][n];\n\n    printf(&quot;enter the matrix \\n&quot;);\n   \n    for (i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;n; j++)\n\n            {\n                printf(&quot; \\n&quot;);\n\n                scanf(&quot;%d&quot;,  &amp;a[i][j]);\n            }\n\n    }\n\n    printf(&quot;%d determinant is&quot;, det(a,n));\n\n}\n\nint det( int a[][n],int n)\n\n{\n\n    int i, j,k,d,l=0 ;\n\n    if(n=2)\n        \n        {\n            d = a[0][0]*a[1][1] - a[0][1]*a[1][0];\n        \n            return (d);\n        \n        }\n    \n    else\n        \n        for ( k = 0; k &lt; n ; k++ )\n    \n        {\n            int b[n-1][n-1];\n            for (i=1; i&lt;n; i++)\n            \n            {\n            \n                for(j=0 &amp;&amp; j!=k ; j&lt;n; j++)\n                {\n                    b[i][j]=a[i][j];\n                }\n\n            }\n\n            l = a[0][j]*pow(-1,j)*det(b,n-1)+l;\n\n        }\n\n    return(l);\n\n}\n</code></pre>\n<h2>Update:</h2>\n<p>Updated code:</p>\n<pre><code>    #include&lt;math.h&gt;\n#include&lt;stdio.h&gt;\nint det( int n, int a[][n]);\n\n\nint main(void)\n\n{\n\n    int n,i,j;\n\n    printf(&quot;enter the size of the matrix &quot;);\n\n    scanf(&quot;%d&quot;, &amp;n);\n\n    int a[n][n];\n\n    printf(&quot;enter the matrix \\n&quot;);\n\n    for (i=0; i&lt;n; i++)\n    {\n        for(j=0; j&lt;n; j++)\n\n            {\n                printf(&quot; &quot;);\n\n                scanf(&quot;%d&quot;,  &amp;a[i][j]);\n            }\n      //  printf(&quot;\\n&quot;);\n    }\n\n    printf(&quot; determinant is %d\\n&quot;, det(n,a));\n\n}\n\nint det( int n, int a[][n])\n\n{\n\n    int i, aj,bj,k,d,p=0 ;\n    int sign =1;\n    if(n==2)\n\n        {\n            d = a[0][0]*a[1][1] - a[0][1]*a[1][0];\n\n            return d;\n\n        }\n\n    else\n\n        for ( k = 0; k &lt; n ; k++ )\n\n        {\n            int b[n-1][n-1];\n            for (i=1; i&lt;n; i++)\n\n            {\n\n                for(aj=0,bj=0 ; aj&lt;n; aj++)\n                {\n                    if(aj==k) continue;\n                    b[i-1][bj]=a[i][aj];\n                    ++bj;\n                }\n\n            }\n\n            p = a[0][aj]*pow(-1,k)*det(n-1, b)+p;\n        }\n    \n    return p;\n\n}\n</code></pre>\n<p><strong>[Edit by Spektre]</strong></p>\n<p>You got wrong index in the last computation. I would change your <code>det</code> code to (summary of my comments):</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>int det( int n, int a[][n])\n    {   \n    if(n&lt;=0) return 0;                                 // stop recursion\n    if(n==1) return a[0][0];                           // stop recursion\n    if(n==2) return a[0][0]*a[1][1] - a[0][1]*a[1][0]; // stop recursion\n    int i,aj,bj,k,p,sign,b[n-1][n-1];\n    for (p=0,  sign=+1, k = 0; k &lt; n ; k++, sign=-sign)\n        {\n        for (i=1; i&lt;n; i++)\n            {\n            for (aj=0,bj=0 ; aj&lt;n; aj++)\n             if (aj!=k) \n                {\n                b[i-1][bj]=a[i][aj];\n                ++bj;\n                }\n            }\n        p= p + (sign*a[0][k]*det(n-1, b)); // here you had aj instead of k causing problems !!!\n        }\n    return p;\n    }\n</code></pre>\n<p>Sadly my compilers does not allow this kind of array passing and I would need to change it to either template or dynamic arrays which would be confusing for you ... So I tested on this and looks like it works:</p>\n<pre><code>const int N=3;\nint A[N][N]=\n    {\n    { 1,2,3 },\n    { 2,3,1 },\n    { 3,1,2 },\n    };\nint det(const int n, int a[][n])\n    {\n    if(n&lt;=0) return 0;                                 // stop recursion\n    if(n==1) return a[0][0];                           // stop recursion\n    if(n==2) return a[0][0]*a[1][1] - a[0][1]*a[1][0]; // stop recursion\n    int i,aj,bj,k,p,sign,b[N][N];\n    for (i=0;i&lt;n;i++) for (k=0;k&lt;n;k++) b[i][k]=0;\n    for (p=0, sign=+1, k = 0; k &lt; n ; k++, sign=-sign)\n        {\n        for (i=1; i&lt;n; i++)\n            {\n            for (aj=0,bj=0 ; aj&lt;n; aj++)\n             if (aj!=k)\n                {\n                b[i-1][bj]=a[i][aj];\n                ++bj;\n                }\n            }\n        p+= sign*a[0][k]*det(n-1,b); // here you had aj instead of k causing problems !!!\n        }\n    return p;\n    }\n</code></pre>\n<p>with result <code>det(N,A)=-18</code> matching my own determinant functions.</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 25147, "user_id": 78720, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2d78d7a7bd9b1eca98bf4b7f0aba52dc?s=128&d=identicon&r=PG", "display_name": "sigjuice", "link": "https://stackoverflow.com/users/78720/sigjuice"}, "edited": false, "score": 0, "creation_date": 1489558870, "post_id": 42802133, "comment_id": 72718145, "body": "Please include a complete program that exhibits the problem.  Refer to the guidelines listed here <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489559512, "post_id": 42802133, "comment_id": 72718430, "body": "Besides your code gives a very limited picture, I may assume you are facing an interference of another errors occurred before <code>pthread_create</code> is called. Reason - your coding style gives an impressions that you don&#39;t test errors."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 2, "creation_date": 1489559866, "post_id": 42802133, "comment_id": 72718586, "body": "And another hint: <a href=\"https://linux.die.net/man/3/pthread_create\" rel=\"nofollow noreferrer\">linux.die.net/man/3/pthread_create</a> says: EAGAIN - Insufficient resources to create another thread, or a system-imposed limit on the number of threads was encountered."}, {"owner": {"reputation": 1, "user_id": 7712860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641b34da9d6bea852b86815f800d035?s=128&d=identicon&r=PG&f=1", "display_name": "Niks", "link": "https://stackoverflow.com/users/7712860/niks"}, "reply_to_user": {"reputation": 25147, "user_id": 78720, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2d78d7a7bd9b1eca98bf4b7f0aba52dc?s=128&d=identicon&r=PG", "display_name": "sigjuice", "link": "https://stackoverflow.com/users/78720/sigjuice"}, "edited": false, "score": 0, "creation_date": 1489560531, "post_id": 42802133, "comment_id": 72718860, "body": "@sigjuice I have added the complete code. We are  creating the thread inside a function(function is called from a thread). We are continuously checking if a msg is received or not in that function. Based on that threads are created continuously."}, {"owner": {"reputation": 1, "user_id": 7712860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641b34da9d6bea852b86815f800d035?s=128&d=identicon&r=PG&f=1", "display_name": "Niks", "link": "https://stackoverflow.com/users/7712860/niks"}, "reply_to_user": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489560645, "post_id": 42802133, "comment_id": 72718924, "body": "@dmi I have modified the code. We checked the number of threads at the time of issue using &quot;cat /proc/*/status | grep Threads&quot;. Its only around 120."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489561535, "post_id": 42802133, "comment_id": 72719323, "body": "It depends on the OS and recources consumption; I have experienced a long time ago on some Linux distros limit a bit more than 100 (similary to what you wrote). On FreeBSD and Solaris the limit I could reach was much higher."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489561719, "post_id": 42802133, "comment_id": 72719412, "body": "...just an idea. Perhaps you could re-design your program to have a pool of worker threads to don&#39;t start new threads upon a new message?"}, {"owner": {"reputation": 1, "user_id": 7712860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641b34da9d6bea852b86815f800d035?s=128&d=identicon&r=PG&f=1", "display_name": "Niks", "link": "https://stackoverflow.com/users/7712860/niks"}, "reply_to_user": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489562567, "post_id": 42802133, "comment_id": 72719862, "body": "@dmi what about reducing the stack size ???? will that be useful???"}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489563113, "post_id": 42802133, "comment_id": 72720110, "body": "I cannot say for sure what kind of limitation you are facing. I would assume it is slightly less stack size relevant. Try to play around <code>ulimit</code>, check amount of open file descriptors including sockets and everything which may point to resources consumption. Perhaps then it gives some clue. But in my assumption this is more a question of SW design rather technical limits."}, {"owner": {"reputation": 1, "user_id": 7712860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641b34da9d6bea852b86815f800d035?s=128&d=identicon&r=PG&f=1", "display_name": "Niks", "link": "https://stackoverflow.com/users/7712860/niks"}, "reply_to_user": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489726737, "post_id": 42802133, "comment_id": 72806848, "body": "@dmi when we tried reducing stack size we didn&#39;t have problem in the creation of the above mentioned thread. However it resulted in failure of creation of another thread. What can we infer from this???"}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1489731630, "post_id": 42802133, "comment_id": 72808488, "body": "As per my assumption you can get rid of dynamic thread creation and use a pool of worker threads which start upon application start and wait for a trigger to run. Then, instead of creating a new thread as per your example, you can just give the trigger to one them to handle received request. This is a kind of a classical design pattern to serve network communication."}], "owner": {"reputation": 1, "user_id": 7712860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7641b34da9d6bea852b86815f800d035?s=128&d=identicon&r=PG&f=1", "display_name": "Niks", "link": "https://stackoverflow.com/users/7712860/niks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1002, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489571006, "creation_date": 1489557701, "last_edit_date": 1489571006, "question_id": 42802133, "link": "https://stackoverflow.com/questions/42802133/c-pthreads-pthread-create-fail-with-error-code-11eagain", "title": "c- pthreads: pthread_create fail with error code 11(EAGAIN)", "body": "<p>We have a set up in which we are recording video to SD card continuously using our custom board. But we are facing an issue with <code>pthread_create</code> in the long run.</p>\n\n<p>I got an <code>EAGAIN</code> when trying to spawn a thread using pthread_create. However, from what I've checked, the threads seem to have been terminated properly.</p>\n\n<p>Would it be possible that unclosed file handles play a part in causing this <code>EAGAIN</code> (i.e they share the same resource space)?</p>\n\n<p>I tried with the attribute <code>PTHREAD_CREATE_DETACHED</code>. Here is my code snippet.</p>\n\n<pre><code>int alarm_main_loop(int qid, int audQid, SemHandl_t hAlarmSem)\n{\n    ALARM_MSG_BUF msgbuf;\n    int msg_size, ret = 0;\n    int event_index, sch_index;\n    AlarmParam_t* pEvironment;\n    pthread_t thread;\n    pthread_attr_t attr;\n\n    pAlarmSysInfo = GetSysInfo();\n    if((hGIOSem = MakeSem()) == NULL) {\n        return -1;\n    }\n    /* ADDED TO SEND SCHEDULE INFO TO SCHEDULE MANAGER */\n    for (event_index = 0; event_index &lt; MAX_NO_OF_EVENTS; event_index++) {\n        for (sch_index = 0; sch_index &lt; MAX_SCHEDULES; sch_index++) {\n            Set_Event_Schedule(pAlarmSysInfo&gt;event_details[event_index].event_schedule[sch_index], event_index, sch_index, 0);\n        }\n    }\n    while(1)\n    {\n        /* Get Message */\n        msg_size = msgrcv( qid, &amp;msgbuf, sizeof(msgbuf) - sizeof(long), MSG_TYPE_MSG1, 0);\n        if( msg_size &lt; 0 ){\n            printf(\"Alarm Receive msg fail \\n\");\n            ret = -1;\n            break;\n        } else if(msgbuf.src == MSG_TYPE_MSG1 || msgbuf.src &lt; 0){\n            printf(\"Got Error message\\n\");\n            ret = -1;\n            break;\n        } else if(msgbuf.event == ALARM_EVENT_QUIT){\n            printf(\"Recieved Quit event\\n\");\n            break;\n        } else if(IsRestart()){\n            // If already restart flag is set then ignore the messages\n            continue;\n        } else {\n            /* Process alarm event */\n            pEvironment =  (AlarmParam_t*)malloc(sizeof(AlarmParam_t));\n            if(pEvironment == NULL){\n                printf(\"Error: More memory need for Alarm server\\n\");\n                break;\n            }\n            pEvironment -&gt; msg_id    = qid;\n            pEvironment -&gt; audMsg_id = audQid;\n            pEvironment-&gt;hAlarmSem   = hAlarmSem;\n            memcpy(&amp;pEvironment -&gt; msg_buf, &amp;msgbuf, sizeof(msgbuf));\n            pthread_attr_init(&amp;attr);\n            pthread_attr_setdetachstate(&amp;attr, PTHREAD_CREATE_DETACHED); \n            if((ret = pthread_create(&amp;thread, &amp;attr, ProcAlarmThread,pEvironment)) != 0){\n                free(pEvironment);\n                printf(\"Error: Alarm server creat thread fail with error no %d\\n\", ret);\n                break;\n            }\n            pthread_attr_destroy(&amp;attr);\n            pthread_detach(thread);\n        }\n    }\n    DestroySem(hGIOSem);\n    return ret;\n}\n</code></pre>\n\n<p><code>alarm_main_loop()</code> is called inside a thread. This function continuously checks if a msg is received and corresponding action are taken.</p>\n\n<p>After running continuously for almost 2 days we are getting this issue. </p>\n\n<p>Could anyone suggest me what is the reason behind this?</p>\n\n<p>How can we debug this issue?</p>\n\n<p>We tried <code>pthread_join</code> instead of <code>pthread_detach</code>(without any attributes) but still got the same issue.</p>\n"}, {"tags": ["c", "pointers", "malloc", "free"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1489553914, "post_id": 42801390, "comment_id": 72716479, "body": "You can change the copy of the pointer in <code>safefree()</code>; you can&#39;t change it in the calling code with that signature.  You need: <code>void safefree(void **vpp) { free(*vpp); *vpp = NULL; }</code> \u2014 and you&#39;d call <code>safefree(&amp;ptr); safefree(&amp;ptr);</code>.  And you&#39;d have to make sure you have a <code>void *</code>.  I suppose you can stick with <code>char *</code> if you use: <code>void safefree(char **cpp) { free(*cpp); *cpp = NULL; }</code> (and <code>safefree(&amp;ptr);</code> still), but that can only be used for freeing <code>char *</code> and not <code>double *</code>, etc."}, {"owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489554072, "post_id": 42801390, "comment_id": 72716527, "body": "@JonathanLeffler Can you explain that a little bit why do I have to pass the pointer to <code>ptr</code> (pointer) in the method/function."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1489554158, "post_id": 42801390, "comment_id": 72716556, "body": "Because you can&#39;t modify the pointer in the calling function unless you get passed a pointer to the pointer.  Just like you can&#39;t change an <code>int</code> variable in the calling function unless the called function is passed an <code>int *</code>, you can&#39;t change a <code>char *</code> in the calling function unless the called function is passed a <code>char **</code>."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1489554745, "post_id": 42801390, "comment_id": 72716711, "body": "A function-like macro may be useful here... it <i>can</i> modify the pointer you pass it, without requiring an extra level of indirection.  If you keep track of your allocations well, though, you shouldn&#39;t need this normally."}, {"owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "reply_to_user": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 0, "creation_date": 1489554812, "post_id": 42801390, "comment_id": 72716734, "body": "@Dmitri can you provide some insight on that."}, {"owner": {"reputation": 8445, "user_id": 929459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e420841bacccb72fb934f80069c11d0b?s=128&d=identicon&r=PG", "display_name": "Dmitri", "link": "https://stackoverflow.com/users/929459/dmitri"}, "edited": false, "score": 1, "creation_date": 1489555206, "post_id": 42801390, "comment_id": 72716855, "body": "Something like <code>#define safefree(X) do { free(X); (X)=NULL; } while(0)</code> will let you just use <code>safefree(ptr);</code>.  Since it&#39;s a text substitution instead of a function call, the macro expansion , <code>do {free(ptr); (ptr)=NULL; } while(0);</code>, is part of the function you use it in, and modifies the original <code>ptr</code> and not a copy of it.  But, you should always know when you need to free your pointers and not rely on something like this to avoid having to pay attention :)"}], "answers": [{"comments": [{"owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "edited": false, "score": 1, "creation_date": 1489554939, "post_id": 42801448, "comment_id": 72716773, "body": "Awesome Thanks for the Explanation."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1489554916, "last_edit_date": 1489554916, "creation_date": 1489554045, "answer_id": 42801448, "question_id": 42801390, "link": "https://stackoverflow.com/questions/42801390/fail-to-understand-why-freeing-memory-throws-an-error/42801448#42801448", "title": "Fail to understand why freeing memory throws an error", "body": "<p>First, let's review the behaviour of <code>free()</code>. Quoting <code>C11</code>, chapter \u00a77.22.3.3</p>\n\n<blockquote>\n<pre><code>void free(void *ptr);\n</code></pre>\n  \n  <p>The <code>free</code> function causes the space pointed to by <code>ptr</code> to be deallocated, that is, made\n  available for further allocation. <strong>If ptr is a null pointer, no action occurs</strong>. Otherwise, if\n  the argument does not match a pointer earlier returned by a memory management\n  function, <strong>or if the space has been deallocated by a call to <code>free</code> or <code>realloc</code>, the\n  behavior is undefined.</strong></p>\n</blockquote>\n\n<p>Follow the two emphasized points.</p>\n\n<ul>\n<li>You can pass a null pointer, <code>NULL</code>, to <code>free()</code> as many times as you want, they are valid calls (just to be ignored).</li>\n<li>You cannot pass a pointer which has already been passed to <code>free()</code> once.</li>\n</ul>\n\n<h3>Case 1:</h3>\n\n<p>Here, after calling <code>free()</code> with the pointer, we're <strong>explicitly</strong> setting the pointer to <code>NULL</code>. That is why, calling <code>free()</code> with the same pointer variable later, any number of time, is not an issue, at all.</p>\n\n<h3>case 2:</h3>\n\n<p>C uses pass-by-value for function argument passing. That's why, When wrapped inside a function,</p>\n\n<pre><code>free(pp);\n</code></pre>\n\n<p>works as expected, (it passes the required pointer to <code>free()</code>) but</p>\n\n<pre><code>pp = NULL;\n</code></pre>\n\n<p>is local to the function and that change is not reflected to the caller. Thereby, calling the function again causes double free, as now, </p>\n\n<ul>\n<li>the pointer has already been passed to <code>free()</code></li>\n<li>the assigned <code>NULL</code> is not reflected to the caller, hence the pointer is not set to NULL</li>\n<li>in the next call, we're passing already-<code>free()</code>d pointer again.</li>\n</ul>\n\n<p>As already mentioned, this invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p><strong>Solution:</strong> You need to pass a pointer to the pointer as the argument of the called function <code>safefree()</code> and from the called function, you can set the pointer value to <code>NULL</code> to get it reflected in the caller. Something like</p>\n\n<pre><code>void safefree(void ** ptrToPtr) \n{ \n     free(*ptrToPtr); \n     *ptrToPtr= NULL; \n }\n</code></pre>\n\n<p>and calling like</p>\n\n<pre><code> safefree (&amp;ptrToBeFreed);\n</code></pre>\n\n<p>will do the job (<em>mind the types there, anyways</em>).</p>\n"}, {"tags": [], "owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "is_accepted": false, "score": 1, "last_activity_date": 1489554275, "creation_date": 1489554275, "answer_id": 42801486, "question_id": 42801390, "link": "https://stackoverflow.com/questions/42801390/fail-to-understand-why-freeing-memory-throws-an-error/42801486#42801486", "title": "Fail to understand why freeing memory throws an error", "body": "<p>Aside from Jonathan's remark, if you do something that results in undefined behavior (free the pointer again), <em>it results in undefined behavior</em> (errors, crashes).</p>\n\n<p>Doing the same thing in different contexts does not necessarily result in the <em>same</em> undefined behavior, it depends on implementation details; they are typically only known to the compiler developer, so they seem 'random' from the outside. Nothing much can be learned by analyzing random undefined behavior. It could for example be that the compile time affects the result..., or the spelling of the directory you work in... anything.</p>\n"}], "owner": {"reputation": 1174, "user_id": 1438735, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/304d6cf1abce29ed9d38688f7975c690?s=128&d=identicon&r=PG", "display_name": "Ratatouille", "link": "https://stackoverflow.com/users/1438735/ratatouille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 42801448, "answer_count": 2, "score": 1, "last_activity_date": 1489554916, "creation_date": 1489553800, "last_edit_date": 1489554410, "question_id": 42801390, "link": "https://stackoverflow.com/questions/42801390/fail-to-understand-why-freeing-memory-throws-an-error", "title": "Fail to understand why freeing memory throws an error", "body": "<p>I was reading to Dangling Pointer and found it's a good habit do this, to prevent oneself from dangling pointer error. </p>\n\n<pre><code>free(ptr); // free the ptr\nptr = NULL; \n</code></pre>\n\n<p>Now I decided to test this with a sample vanilla C code.</p>\n\n<p><strong>CASE_1</strong></p>\n\n<pre><code>char *ptr = malloc(10);\n... \n...\nfree(ptr); \nptr=NULL;\n// Just to check what happen if I call free more than I once\nfree(ptr)\nptr=NULL;\n</code></pre>\n\n<p>All work fine. Until I decided to wrap the <code>free</code> and the pointer <code>NULL</code> assignment in a <code>function</code> I named it <code>safefree</code></p>\n\n<pre><code>void safefree(char *pp) {\n  free(pp);\n  pp = NULL;\n}\n</code></pre>\n\n<p><strong>CASE_2</strong></p>\n\n<p>Now, when I ran the above method more than 1 (like this)</p>\n\n<pre><code>safefree(ptr);\n\nsafefree(ptr);\n</code></pre>\n\n<p>I get the following error. </p>\n\n<pre><code>malloc: *** error for object 0x7fd98f402910: pointer being freed was not allocated\n*** set a breakpoint in malloc_error_break to debug\n</code></pre>\n\n<p>I happen to understand the error (pointer being freed was not allocated) \nbut I fail to understand why it doesn't fail in the <strong>CASE_1</strong> and fails in latter part of the sample code.</p>\n"}, {"tags": ["c", "arrays", "loops"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6191116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e56041d1bf5011a88e61c0c2c3a36a?s=128&d=identicon&r=PG&f=1", "display_name": "max", "link": "https://stackoverflow.com/users/6191116/max"}, "edited": false, "score": 0, "creation_date": 1489554027, "post_id": 42801427, "comment_id": 72716508, "body": "hi, i only want i.number from 39 to 0. so that i can use do..while loop to display sorted array value"}, {"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "reply_to_user": {"reputation": 21, "user_id": 6191116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e56041d1bf5011a88e61c0c2c3a36a?s=128&d=identicon&r=PG&f=1", "display_name": "max", "link": "https://stackoverflow.com/users/6191116/max"}, "edited": false, "score": 0, "creation_date": 1489554106, "post_id": 42801427, "comment_id": 72716539, "body": "have you tried changing the while condition to <code>while( i &gt; 0);</code>?"}, {"owner": {"reputation": 21, "user_id": 6191116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e56041d1bf5011a88e61c0c2c3a36a?s=128&d=identicon&r=PG&f=1", "display_name": "max", "link": "https://stackoverflow.com/users/6191116/max"}, "edited": false, "score": 0, "creation_date": 1489554288, "post_id": 42801427, "comment_id": 72716594, "body": "i need i= 0 as well to display first element in sorted array for reverse displaying array, biggest to smallest"}, {"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "reply_to_user": {"reputation": 21, "user_id": 6191116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e56041d1bf5011a88e61c0c2c3a36a?s=128&d=identicon&r=PG&f=1", "display_name": "max", "link": "https://stackoverflow.com/users/6191116/max"}, "edited": false, "score": 0, "creation_date": 1489554346, "post_id": 42801427, "comment_id": 72716614, "body": "As I said in my answer, the do-while loop does first, then checks. It should fix your problem as long as there isn&#39;t anything else wrong with your code."}], "tags": [], "owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "is_accepted": false, "score": 2, "last_activity_date": 1489554834, "last_edit_date": 1489554834, "creation_date": 1489553933, "answer_id": 42801427, "question_id": 42801363, "link": "https://stackoverflow.com/questions/42801363/do-while-for-array-in-c/42801427#42801427", "title": "do while for array in c", "body": "<p><strong>TL;DR</strong>: Either change your <code>printf</code> to this: <code>printf(\"i= %d\\n\", i);</code> or change your while loop to <code>while(i &gt; 0);</code>. Either way, it should fix your problem.</p>\n\n<p>A do while loop does the action in the curly braces and then checks the condition. I'm not quite understanding your question, but it seems to me that it's printing <code>-1</code> because it's doing first, then checking the condition. Furthermore, you're using <code>i - 1</code> in your <code>printf</code> function (which is probably where you've confused yourself the most).</p>\n\n<p><strong>EDIT</strong>: To be <strong>even more</strong> explicit about the while loop, the problem is that your condition is <code>(i &gt; -1)</code>. That means that when you reach <code>0</code>, your code will check: <code>is 0 greater than -1?</code>. It will return true and then move on the <code>i = -1</code> where it prints <code>-1</code>. Then it reaches the while condition once more where it sees that <code>-1 is not greater than -1</code> which is when the code terminates.</p>\n"}, {"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1489562087, "creation_date": 1489562087, "answer_id": 42803269, "question_id": 42801363, "link": "https://stackoverflow.com/questions/42801363/do-while-for-array-in-c/42803269#42803269", "title": "do while for array in c", "body": "<p>Your main problem is probably the starting value for <code>i</code>.\nAfter the first <code>do ... while</code> loop it equals 40 when the condition fails.</p>\n\n<p>Therefore you could make things a lot easier if you adjust your starting value for the second loop:</p>\n\n<pre><code>i--; // or i = SIZE-1;\ndo{\n    printf(\"i= %d\\n\", i);\n    i--;\n} while (i &gt;= 0);\n</code></pre>\n\n<p>Then you don't have any headache by shifting your values by one and can just use the values you want.</p>\n\n<p>If you insist on doing it the way you did, then check the limits...</p>\n\n<pre><code>do{\n    printf(\"i= %d\\n\", i-1);   // last value to be printed is 0 ==&gt; i == 1\n    i--;                      // The last wanted value of i now is 0.\n} while (i&gt;0);                // Stop if we reach last wanted value\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6191116, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d3e56041d1bf5011a88e61c0c2c3a36a?s=128&d=identicon&r=PG&f=1", "display_name": "max", "link": "https://stackoverflow.com/users/6191116/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1691, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489562087, "creation_date": 1489553635, "question_id": 42801363, "link": "https://stackoverflow.com/questions/42801363/do-while-for-array-in-c", "title": "do while for array in c", "body": "<p>i work for a question that generate random number and sort in array, then display numbers from biggest to smallest.\nhere is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#define SIZE 40\nint main()\n{\n    int array[SIZE];\n    int inner, outter, temp, i;\n\n    srand((unsigned)time(NULL));\n    //do... while to assign array value\n    i=0;\n    do{\n        array[i] = (int)((rand()%101)+1);\n        i++;\n    }while(i&lt;SIZE);\n\n    puts(\"Original array:\");\n\n\n    for(outter=0; outter&lt;SIZE-1;outter++){\n            printf(\"%d\\t\", array[outter]);\n    }\n\n    //bubble sort\n    for(outter=0; outter&lt;SIZE-1;outter++){\n\n        for(inner=outter+1; inner&lt;SIZE; inner++ ){\n\n            if(array[outter] &gt; array[inner]){\n\n                 temp = array[outter];\n                 array[outter] = array[inner];\n                 array[inner] = temp;\n            }\n        }\n    }\n    puts(\"\\n\");\n    puts(\"Sorted array:\");\n\n    printf(\"i= %d\\n\",i);\n     printf(\"%d\\n\", array[39]);\n    for(outter=0; outter&lt;SIZE;outter++){\n            printf(\"%d\\t\", array[outter]);\n    }\n\n    puts(\"\\n\");\n    for(outter=SIZE-1; outter&gt;0;outter--){\n            printf(\"%d\\t\", array[outter]);\n    }\n    puts(\"\\n\");\n    // try using do while loop to display reverse number from biggest to smallest numbers\n    do{\n        printf(\"i= %d\\n\", i-1);\n        i--;\n    }while(i&gt;-1);\n}\n</code></pre>\n\n<p>when i used do while for displaying reverse array number, my code goes crush.\nHowever, i display the value the \"i\" that used for looping array, it displayed from 39 to -1. I don not why i have -1 for \"i\" value since i set \"i>-1\".</p>\n"}]