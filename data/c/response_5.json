[{"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1423698086, "post_id": 28466715, "comment_id": 45259031, "body": "u did do &quot;ls -ail&quot; - ie force the inclusion of files starting with &quot;.&quot;"}, {"owner": {"reputation": 118, "user_id": 4557064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a14eb30ac6839a5a0a1e026de5d94f?s=128&d=identicon&r=PG&f=1", "display_name": "TheDude1142", "link": "https://stackoverflow.com/users/4557064/thedude1142"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1423698247, "post_id": 28466715, "comment_id": 45259090, "body": "@pm100 Yeah, I tried that and nothing."}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 4557064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a14eb30ac6839a5a0a1e026de5d94f?s=128&d=identicon&r=PG&f=1", "display_name": "TheDude1142", "link": "https://stackoverflow.com/users/4557064/thedude1142"}, "edited": false, "score": 0, "creation_date": 1423698479, "post_id": 28466757, "comment_id": 45259177, "body": "@abligh Well, what do you know, I am an idiot haha. Thank you for your help. Next time I will just take the advice and read the manual."}, {"owner": {"reputation": 631, "user_id": 12156208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5266a41a96f7ffdb31444f23521d8e64?s=128&d=identicon&r=PG&f=1", "display_name": "PyWalker2797", "link": "https://stackoverflow.com/users/12156208/pywalker2797"}, "edited": false, "score": 0, "creation_date": 1586652583, "post_id": 28466757, "comment_id": 108206099, "body": "Where did 0644 come from? I could not find this mode in the man pages"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 631, "user_id": 12156208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5266a41a96f7ffdb31444f23521d8e64?s=128&d=identicon&r=PG&f=1", "display_name": "PyWalker2797", "link": "https://stackoverflow.com/users/12156208/pywalker2797"}, "edited": false, "score": 0, "creation_date": 1586675064, "post_id": 28466757, "comment_id": 108210120, "body": "@PyWalker2797 it is an octal expression (leading <code>0</code>) of the unix file mode. See e.g. the <code>chmod</code> manpage. <code>0644</code> means the owner can read+write (4+2=<code>6</code>), the group can read (<code>4</code>), and others can read (<code>4</code>)."}, {"owner": {"reputation": 96, "user_id": 3921371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6b621279fb71b5f25fad940c6cf9e0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolasome", "link": "https://stackoverflow.com/users/3921371/nicolasome"}, "reply_to_user": {"reputation": 631, "user_id": 12156208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5266a41a96f7ffdb31444f23521d8e64?s=128&d=identicon&r=PG&f=1", "display_name": "PyWalker2797", "link": "https://stackoverflow.com/users/12156208/pywalker2797"}, "edited": false, "score": 1, "creation_date": 1592862771, "post_id": 28466757, "comment_id": 110572243, "body": "@PyWalker2797 you can also use <a href=\"http://permissions-calculator.org/\" rel=\"nofollow noreferrer\">permissions-calculator.org</a> to calculate the proper code for your permission level"}, {"owner": {"reputation": 631, "user_id": 12156208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5266a41a96f7ffdb31444f23521d8e64?s=128&d=identicon&r=PG&f=1", "display_name": "PyWalker2797", "link": "https://stackoverflow.com/users/12156208/pywalker2797"}, "edited": false, "score": 0, "creation_date": 1592864240, "post_id": 28466757, "comment_id": 110572701, "body": "This is awesome!!"}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 13, "last_activity_date": 1423698438, "last_edit_date": 1423698438, "creation_date": 1423698110, "answer_id": 28466757, "question_id": 28466715, "link": "https://stackoverflow.com/questions/28466715/using-open-to-create-a-file-in-c/28466757#28466757", "title": "Using open() to create a file in C", "body": "<p>When creating a file, you need a third parameter to open (the <code>mode</code>). If you don't do this, unpredictable things happen.</p>\n\n<p>Also, if you want to create a file if it's not there, you will need <code>O_CREAT</code> or'd in, i.e.</p>\n\n<pre><code>fd = open(tmpname, O_WRONLY | O_APPEND | O_CREAT, 0644);\n</code></pre>\n\n<p><code>O_CREAT</code> (roughly speaking) creates the file if it isn't present.</p>\n\n<p>From the man page:</p>\n\n<pre>\nNAME\n       open, creat - open and possibly create a file or device\n\nSYNOPSIS\n       #include \n       #include \n       #include \n\n       int open(const char *pathname, int flags);\n       int open(const char *pathname, int flags, mode_t mode);\n\n       int creat(const char *pathname, mode_t mode);\n\n...\n       O_CREAT\n              If the file does not exist it will be created.  The owner (user ID) of\n              the  file  is  set to the effective user ID of the process.  The group\n              ownership (group ID) is set either to the effective group  ID  of  the\n              process  or  to  the  group  ID  of the parent directory (depending on\n              filesystem type and mount options, and the mode of the  parent  direc\u2010\n              tory,  see  the  mount  options  bsdgroups and sysvgroups described in\n              mount(8)).\n\n              mode specifies the permissions to use in case a new file  is  created.\n              This  argument must be supplied when O_CREAT is specified in flags; if\n              O_CREAT is not specified, then mode is ignored.  The effective permis\u2010\n              sions  are  modified by the process's umask in the usual way: The per\u2010\n              missions of the created file are (mode & ~umask).  Note that this mode\n              applies  only to future accesses of the newly created file; the open()\n              call that creates a read-only file may well return a  read/write  file\n              descriptor.\n\n</pre>\n"}], "owner": {"reputation": 118, "user_id": 4557064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a14eb30ac6839a5a0a1e026de5d94f?s=128&d=identicon&r=PG&f=1", "display_name": "TheDude1142", "link": "https://stackoverflow.com/users/4557064/thedude1142"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28617, "favorite_count": 1, "accepted_answer_id": 28466757, "answer_count": 1, "score": 7, "last_activity_date": 1423699260, "creation_date": 1423697931, "last_edit_date": 1423699260, "question_id": 28466715, "link": "https://stackoverflow.com/questions/28466715/using-open-to-create-a-file-in-c", "title": "Using open() to create a file in C", "body": "<p>This is the first time I am using <code>open()</code> from:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n</code></pre>\n\n<p>I am trying to create two files:</p>\n\n<pre><code>int fd;\nint fd2;\nchar *tmpname = \"./TMPFILE\";\nprintf( \"Temporary file created\\n \");\nchar *tmpname2 = \"./TMPFILE2\";\nprintf( \"Temporary file two created\\n \");\nfd = open(tmpname, O_WRONLY | O_APPEND);\nfd2 = open(tmpname2, O_WRONLY | O_APPEND);\n</code></pre>\n\n<p>I am trying to create the files in the current working directory that can be written and appended to.</p>\n\n<p>This compiles and runs, but my concern is that when I check my directory to see if the files were created, they aren't listed.</p>\n\n<p>My question is does <code>open()</code> only make temporary files that are removed after the program runs or did I screw something up?</p>\n"}, {"tags": ["c", "string", "input", "ncurses"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1423697226, "post_id": 28466505, "comment_id": 45258717, "body": "What is <code>buffer</code>? What are it&#39;s contents? How do you know <code>malloc()</code> was successful? What gets put into <code>inStr</code>? Why even write <code>inStr[strlen(inStr)] = &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 10822, "user_id": 2452708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dxg4I.jpg?s=128&g=1", "display_name": "Anto Jurkovi\u0107", "link": "https://stackoverflow.com/users/2452708/anto-jurkovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1423697238, "post_id": 28466505, "comment_id": 45258720, "body": "<code>sizeof(char*)</code>? What is <code>BUFFER</code>?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1423697399, "post_id": 28466505, "comment_id": 45258772, "body": "You malloc&#39;ed something, alright. You&#39;re <i>sure</i> that <code>char*</code> shouldn&#39;t be <code>char</code> ? The fourth line seems completely useless, as <code>scanw</code> should terminate that string for you (how do you think <code>strlen</code> would work if it <i>didn&#39;t</i> ?). And this: <code>scanw(&quot;%s&quot;, &amp;inStr);</code> should be <code>scanw(&quot;%s&quot;, inStr);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1196, "user_id": 3198050, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/y98Uq.png?s=128&g=1", "display_name": "Luis Alves", "link": "https://stackoverflow.com/users/3198050/luis-alves"}, "is_accepted": false, "score": 0, "last_activity_date": 1423697302, "creation_date": 1423697302, "answer_id": 28466602, "question_id": 28466505, "link": "https://stackoverflow.com/questions/28466505/segmentation-faultcore-dumped-when-printing-pointers-information/28466602#28466602", "title": "Segmentation fault(core dumped) when printing pointer&#39;s information", "body": "<p>Change to:</p>\n\n<pre><code>malloc(sizeof(char)*BUFFER)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7332, "user_id": 1641198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/815c90f5e93c176813333043e3d3d880?s=128&d=identicon&r=PG", "display_name": "DrC", "link": "https://stackoverflow.com/users/1641198/drc"}, "is_accepted": true, "score": 3, "last_activity_date": 1423697484, "creation_date": 1423697484, "answer_id": 28466641, "question_id": 28466505, "link": "https://stackoverflow.com/questions/28466505/segmentation-faultcore-dumped-when-printing-pointers-information/28466641#28466641", "title": "Segmentation fault(core dumped) when printing pointer&#39;s information", "body": "<p>First item, for a \"%s\" format, you need to pass a pointer to a buffer.  You are actually passing a pointer to a pointer to a buffer.  Drop the &amp;.  Second, strlen is defined by the presence of a null at the end, so using it to determine where to put a null is a bit nonsensical.  Instead, you have to trust scanw to terminate it properly.  Note that is a HUGE assumption and is a big part of why the whole scanf family is troubled by buffer overruns - the function has no idea how big the buffer is.  Also, as others point out, your malloc size is off - you probably just want something like <code>malloc(BUFFER)</code> - note sizeof(char) is 1 by definition.</p>\n\n<pre><code>char *inStr;\ninStr = malloc(BUFFER);\nscanw(\"%s\", inStr);\nmvwprintw(stdscr, 0, 0, \"%s\",inStr);\n</code></pre>\n"}], "owner": {"reputation": 1145, "user_id": 1881202, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Yy1Yi.png?s=128&g=1", "display_name": "Exikle", "link": "https://stackoverflow.com/users/1881202/exikle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 28466641, "answer_count": 2, "score": -1, "last_activity_date": 1423697484, "creation_date": 1423696851, "last_edit_date": 1423697405, "question_id": 28466505, "link": "https://stackoverflow.com/questions/28466505/segmentation-faultcore-dumped-when-printing-pointers-information", "title": "Segmentation fault(core dumped) when printing pointer&#39;s information", "body": "<p>I'm reading in my input and putting it in a pointer. I have used malloc so I'm not sure what wrong</p>\n\n<p>CODE:</p>\n\n<pre><code>#define BUFFER 30 //in my .h file\n\nchar *inStr;\ninStr = malloc(sizeof(char*)*BUFFER);\nscanw(\"%s\", &amp;inStr);\ninStr[strlen(inStr)] = '\\0';\nmvwprintw(stdscr, 0, 0, \"%s\",inStr);\n</code></pre>\n\n<p>I'm trying to output it onto a ncurses board and am not sure why this is happening. It crashes when I press enter for the input</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423697941, "post_id": 28466489, "comment_id": 45258979, "body": "<code>array[x] = strtod(buf, &amp;endptr);</code>, etc.  Code is reading text.  Need to convert that to <code>int</code>.  Then print using <code>printf(&quot;%d &quot;, array[x]);</code>  GTG"}, {"owner": {"reputation": 18120, "user_id": 2587797, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/8H6jK.png?s=128&g=1", "display_name": "RustyShackleford", "link": "https://stackoverflow.com/users/2587797/rustyshackleford"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423698439, "post_id": 28466489, "comment_id": 45259163, "body": "where do I add &amp;endptr"}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1423700225, "post_id": 28467058, "comment_id": 45259753, "body": "Just a nitpick. <code>strtol</code> is a better function for converting to integers, although more complicated to use. <code>atoi</code> has no way to signal errors."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423700417, "post_id": 28467058, "comment_id": 45259807, "body": "I moved the <code>newline</code> out of the loop, as OP&#39;s question stated &quot;on a single line&quot;. The reason why he was getting a <code>newline</code> after every number (string) when there is not one in the code, is because <code>fgets()</code> keeps the <code>newline</code> that ends every line of the file (subject to a couple of provisos), at the end of the string it reads in."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 2, "last_activity_date": 1423699761, "creation_date": 1423699761, "answer_id": 28467058, "question_id": 28466489, "link": "https://stackoverflow.com/questions/28466489/print-dynamically-allocated-array-of-integers-on-single-line/28467058#28467058", "title": "Print dynamically allocated array of integers on single line", "body": "<p>Your code puts the buffer address in the integer array and then uses that as a string pointer for <code>printf()</code>, but you'll find it won't work if you try printing the array in a loop separate from the reading loop, because every element of the array holds this same buffer address. You should have been given a compiler warning about this.</p>\n\n<p>This answer uses two loops, as you want to print the numbers after reading them. </p>\n\n<pre><code>while(fgets(buf, 1000, fp) != NULL &amp;&amp; x &lt; 1000)\n    array[x++] = atoi(buf);\n\nfor (y=0; y&lt;x; y++)\n    printf(\"%d \", array[y]);\n\nprintf(\"\\n\");\n</code></pre>\n"}], "owner": {"reputation": 18120, "user_id": 2587797, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/8H6jK.png?s=128&g=1", "display_name": "RustyShackleford", "link": "https://stackoverflow.com/users/2587797/rustyshackleford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 28467058, "answer_count": 1, "score": 0, "last_activity_date": 1423699761, "creation_date": 1423696785, "question_id": 28466489, "link": "https://stackoverflow.com/questions/28466489/print-dynamically-allocated-array-of-integers-on-single-line", "title": "Print dynamically allocated array of integers on single line", "body": "<p>I'm trying to do the following:</p>\n\n<p>Open a file with <code>up</code> to <code>1000</code> ints in a text file, 1 int per line. </p>\n\n<p>Read the file line by line</p>\n\n<p>Store the ints in a dynamically allocated array of 1000</p>\n\n<p>Print the contents of the array on a single line</p>\n\n<p>Yes this is homework, I'm stuck on this. </p>\n\n<p><code>Output should be: \n$ 1 2 3 4 5 6 7 8 9 ....</code></p>\n\n<p>What I have so far prints the integers on a new line after each iteration.</p>\n\n<pre><code>    int x = 0;\n    char buf[1000];\n    int  *array = (int *) malloc(1000 * sizeof(int));\n    FILE *fp = fopen(\"test.txt\", \"r\");\n\n    while(fgets(buf, 1000, fp) != NULL) {\n            array[x] = buf;\n            printf(\"%s \", array[x]);\n            x++;\n    }       \n    fclose(fp);\n    return 0;\n</code></pre>\n\n<p>}       </p>\n"}, {"tags": ["c", "segmentation-fault", "openmp"], "comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1423728966, "post_id": 28466410, "comment_id": 45268879, "body": "Your question is a bit confusing. I answer your two questions at the end of your question. However, your title is &quot;Is there any default scope separator in OpenMP?&quot;. That&#39;s another question. What do you mean by &quot;scope seperator&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 413, "user_id": 3288836, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VDZ1R.jpg?s=128&g=1", "display_name": "sthbuilder", "link": "https://stackoverflow.com/users/3288836/sthbuilder"}, "edited": false, "score": 0, "creation_date": 1423731410, "post_id": 28472338, "comment_id": 45270115, "body": "could you explain a little bit about automatic storage? is all the global variable go this way by default?  and when you say&quot;statically allocated buffer&quot;, do.you mean the cprivate matrix I used? It is called statically allocated because of I declare.the matrix with the matrix size directly?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 413, "user_id": 3288836, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VDZ1R.jpg?s=128&g=1", "display_name": "sthbuilder", "link": "https://stackoverflow.com/users/3288836/sthbuilder"}, "edited": false, "score": 0, "creation_date": 1423732623, "post_id": 28472338, "comment_id": 45270771, "body": "Automatic storage uses the stack which has a limited size. In your code <code>matrixa, matrixb, matric, cprivate</code> all allocate from the stack. Global variables and variables defined using the static keyword use static storage."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 413, "user_id": 3288836, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VDZ1R.jpg?s=128&g=1", "display_name": "sthbuilder", "link": "https://stackoverflow.com/users/3288836/sthbuilder"}, "edited": false, "score": 0, "creation_date": 1423732706, "post_id": 28472338, "comment_id": 45270822, "body": "There is no need for <code>cprivate</code> which is why I removed it. However, if you really want a private buffer for each thread then you should use <code>malloc</code> to allocate using the heap or <code>threadprivate</code> for static storage for each thread."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 413, "user_id": 3288836, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VDZ1R.jpg?s=128&g=1", "display_name": "sthbuilder", "link": "https://stackoverflow.com/users/3288836/sthbuilder"}, "edited": false, "score": 0, "creation_date": 1423733186, "post_id": 28472338, "comment_id": 45271141, "body": "@javarookie, the reason I used static allocation is just so I chould use your same notation. Otherwise with dynamic allocation you have to do e.g. <code>matrixa[i*ASIZE+k]*matrixb[k*ASIZE+j]</code>."}], "tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": false, "score": 0, "last_activity_date": 1423728599, "creation_date": 1423728599, "answer_id": 28472338, "question_id": 28466410, "link": "https://stackoverflow.com/questions/28466410/is-there-any-default-scope-separator-in-openmp/28472338#28472338", "title": "Is there any default scope separator in OpenMP?", "body": "<p>Your code is likely failing because you are using automatic storage. You should use dynamic or static storage. Here is a fix to your code using static storage</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define ASIZE 1000\n\nlong matrixa [ASIZE][ASIZE];\nlong matrixb [ASIZE][ASIZE];\nlong matrixc [ASIZE][ASIZE]; //set to zero by default with static storage\n\nint main() {\n    for(int i=0; i&lt;ASIZE; i++) {\n        for(int j=0;j&lt;ASIZE; j++) {\n            matrixa [i][j] = 1;\n            matrixb [i][j] = j;\n        }\n    }\n\n    #pragma omp parallel for\n    for(int i=0 ;i&lt;ASIZE; i++) {\n        for(int j=0; j&lt;ASIZE; j++) {\n            long sum = 0;\n            for(int k=0; k&lt;ASIZE; k++) {\n                sum += matrixa[i][k]*matrixb[k][j];\n            }\n            matrixc[i][j] = sum;\n        }\n    }\n    for(int i=0; i&lt;50; i++) printf(\"Snap of C array %lu \\n\", matrixc[1][i]);\n}\n</code></pre>\n\n<p>If you want a statically allocated buffer for each thread then you need to use <code>threadprivate</code> otherwise use dynamic allocation.</p>\n\n<p>The reason you don't need to use a barrier is that a barrier is implicit with <code>critical</code> and many other constructs. To remove the implicit barrier you can use <code>nowait</code> in some cases (e.g. <code>#pragma omp parallel for nowait</code>).</p>\n"}], "owner": {"reputation": 413, "user_id": 3288836, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/VDZ1R.jpg?s=128&g=1", "display_name": "sthbuilder", "link": "https://stackoverflow.com/users/3288836/sthbuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423728839, "creation_date": 1423696456, "last_edit_date": 1592644375, "question_id": 28466410, "link": "https://stackoverflow.com/questions/28466410/is-there-any-default-scope-separator-in-openmp", "title": "Is there any default scope separator in OpenMP?", "body": "<p>I am new to OpenMP, just done my first try,it was a matrix multiplication. I am just wondering if there is a default block separator existed in openMP?\nfollowing is my code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;omp.h&gt;\n#define MAX_THREADS 4\n#define ASIZE 500\n\nint main()\n{\n  /*intialization of 2 matrix*/     \n  long matrixa [ASIZE][ASIZE];\n  long matrixb [ASIZE][ASIZE];\n  long matrixc [ASIZE][ASIZE] = {0};\n  for(int i=0; i&lt;ASIZE; i++)\n    for(int j=0;j&lt;ASIZE; j++)\n    {\n      matrixa [i][j] = 1;\n      matrixb [i][j] = j;\n    }\n\n  omp_set_num_threads(MAX_THREADS);\n\n  #pragma omp parallel\n  {\n    long cprivate [ASIZE][ASIZE] = {0};\n    #pragma omp for\n    for(int i =0 ;i&lt;ASIZE; i++)\n      for(int j=0; j&lt;ASIZE; j++)\n        for(int k=0; k&lt;ASIZE; k++)\n          cprivate[i][j]+=matrixa[i][k]*matrixb[k][j];\n\n    #pragma omp critical\n    for(int i =0 ;i&lt;ASIZE; i++)\n      for(int j=0; j&lt;ASIZE; j++)\n        matrixc[i][j]+=cprivate[i][j];\n\n    //#pragma omp barrier\n    if(omp_get_thread_num() ==0)\n      for(int i=0; i&lt;50; i++)\n        printf(&quot;Snap of C array %lu \\n&quot;, matrixc[1][i]); //print out chunk of the first row!\n\n  }\n}\n</code></pre>\n<p>I thought this way cause whether I add the <code>#pragma omp barrier</code> or not, I can get the expected result, which should be the result after the complete execution of the <code>#pragma omp critical</code> block.</p>\n<h1>questions</h1>\n<p>@ why it makes no difference with or without <code>#pragma omp barrier</code>  Any ideas?</p>\n<p>@\u3000I also noticed once I Increase the array size to 600 hundred, it will alert segmentation fault when executing the .o file, My initial guess it was from the int range(I have modified the array type from int[] to long[]), no difference.</p>\n"}, {"tags": ["c", "ubuntu", "gcc", "raspberry-pi", "raspbian"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423696326, "post_id": 28466346, "comment_id": 45258371, "body": "This would&#39;ve been much easier for all of us (yourself included) if you had pasted the <i>text</i>, instead of images. Anyways, care to translate that error message for us?"}, {"owner": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "edited": false, "score": 2, "creation_date": 1423698171, "post_id": 28466346, "comment_id": 45259060, "body": "What is the output of these two commands?      <b>echo $PATH</b>  and:      <b>ls -l &lt;your_bin_folder_path&gt;</b>"}, {"owner": {"reputation": 805, "user_id": 1614658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e91bd2bd6d5e902f7e1fd7b03b2ba6?s=128&d=identicon&r=PG", "display_name": "paolo2988", "link": "https://stackoverflow.com/users/1614658/paolo2988"}, "reply_to_user": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "edited": false, "score": 1, "creation_date": 1423731047, "post_id": 28466346, "comment_id": 45269933, "body": "@Jorge Torres I edited my question with the mentionend command."}], "answers": [{"tags": [], "owner": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "is_accepted": true, "score": 2, "last_activity_date": 1423753499, "creation_date": 1423753499, "answer_id": 28480852, "question_id": 28466346, "link": "https://stackoverflow.com/questions/28466346/cross-compile-ubuntu-raspberry/28480852#28480852", "title": "Cross Compile Ubuntu Raspberry", "body": "<p>Got it. This is because your path only contains the 'hard float' or 'hf' version of the compiler:</p>\n\n<p>arm-linux-gnueabi<strong>hf</strong>-gcc</p>\n\n<p>But your test is trying to run the non 'hf' version of the cross-compiler, so when you try to check the version to see if the compiler is installed, note that the 'hf' is missing.</p>\n\n<pre><code>arm-linux-gnueabi-gcc -v\n</code></pre>\n\n<p>That's the name of the 'soft float' version of the compiler, which is not installed. If you run your check as:</p>\n\n<pre><code>arm-linux-gnueabihf-gcc -v\n</code></pre>\n\n<p>You should get a valid reply. This is the compiler that you should use form your console. Alternatively, you can also opt for installing the 'soft float' version of the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 4623899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-ovtp7HNSjt4/AAAAAAAAAAI/AAAAAAAAADs/lSsa8_XxJGU/photo.jpg?sz=128", "display_name": "EffegiWeb", "link": "https://stackoverflow.com/users/4623899/effegiweb"}, "is_accepted": false, "score": 0, "last_activity_date": 1425989162, "creation_date": 1425989162, "answer_id": 28963282, "question_id": 28466346, "link": "https://stackoverflow.com/questions/28466346/cross-compile-ubuntu-raspberry/28963282#28963282", "title": "Cross Compile Ubuntu Raspberry", "body": "<p>Good!\nI'm currently use the cross compiler for the raspberry only in MS windows.\nNow I can try in Linux using the tutorial linked in your message.</p>\n"}], "owner": {"reputation": 805, "user_id": 1614658, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a8e91bd2bd6d5e902f7e1fd7b03b2ba6?s=128&d=identicon&r=PG", "display_name": "paolo2988", "link": "https://stackoverflow.com/users/1614658/paolo2988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 1, "accepted_answer_id": 28480852, "answer_count": 2, "score": 1, "last_activity_date": 1425989162, "creation_date": 1423696168, "last_edit_date": 1423751528, "question_id": 28466346, "link": "https://stackoverflow.com/questions/28466346/cross-compile-ubuntu-raspberry", "title": "Cross Compile Ubuntu Raspberry", "body": "<p>Followed <a href=\"http://hertaville.com/2012/09/28/development-environment-raspberry-pi-cross-compiler/\" rel=\"nofollow noreferrer\">this tutorial</a> i installed all the mentioned toolchain. After i choose my appropriate toolchain \"gcc-linaro-arm-linux-gnueabihf-raspbian\" in \".bashrc\" file. After i submit \"source .bashrc\" but \"arm-linux-gnueabi-gcc -v\" does not work.</p>\n\n<p>This is my row in \".bashrc\" file:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JGlFJ.png\" alt=\"enter image description here\"></p>\n\n<p>This is my bin folder:</p>\n\n<p><img src=\"https://i.stack.imgur.com/NYqph.png\" alt=\"enter image description here\"></p>\n\n<p>When i try to check it this is the result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/3VTzm.png\" alt=\"enter image description here\"></p>\n\n<p>As required, the former command <strong>echo $PATH</strong></p>\n\n<blockquote>\n  <p>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/home/v1sc3rr4k/Universita/Android/sdk/tools:/home/v1sc3rr4k/Universita/Android/sdk/platform-tools:/home/v1sc3rr4k/Universita/Android/android-ndk-r9d:<em>/home/v1sc3rr4k/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin</em></p>\n</blockquote>\n\n<p>whereas the latter <strong>ls -l </strong></p>\n\n<blockquote>\n  <p>-rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620076 feb 11 23:02 arm-linux-gnueabihf-addr2line\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  644400 feb 11 23:02 arm-linux-gnueabihf-ar\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 1085080 feb 11 23:02 arm-linux-gnueabihf-as lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      23 feb 11\n  23:02 arm-linux-gnueabihf-c++ -> arm-linux-gnueabihf-g++\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  618316 feb 11 23:02 arm-linux-gnueabihf-c++filt\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  572984 feb 11 23:02 arm-linux-gnueabihf-cpp\n  -rw-r--r-- 1 v1sc3rr4k v1sc3rr4k    2977 feb 11 23:02 arm-linux-gnueabihf-ct-ng.config\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 2706116 feb 11 23:02 arm-linux-gnueabihf-dwp\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   51540 feb 11 23:02 arm-linux-gnueabihf-elfedit\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  574264 feb 11 23:02 arm-linux-gnueabihf-g++ lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      29 feb\n  11 23:02 arm-linux-gnueabihf-gcc -> arm-linux-gnueabihf-gcc-4.8.3\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  571736 feb 11 23:02 arm-linux-gnueabihf-gcc-4.8.3\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20748 feb 11 23:02 arm-linux-gnueabihf-gcc-ar\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20684 feb 11 23:02 arm-linux-gnueabihf-gcc-nm\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20684 feb 11 23:02 arm-linux-gnueabihf-gcc-ranlib\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  257872 feb 11 23:02 arm-linux-gnueabihf-gcov\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 3631768 feb 11 23:02 arm-linux-gnueabihf-gdb\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  574712 feb 11 23:02 arm-linux-gnueabihf-gfortran\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  681964 feb 11 23:02 arm-linux-gnueabihf-gprof lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      26 feb\n  11 23:02 arm-linux-gnueabihf-ld -> arm-linux-gnueabihf-ld.bfd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 1064504 feb 11 23:02 arm-linux-gnueabihf-ld.bfd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   10501 feb 11 23:02 arm-linux-gnueabihf-ldd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 3755040 feb 11 23:02 arm-linux-gnueabihf-ld.gold\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  629292 feb 11 23:02 arm-linux-gnueabihf-nm\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  769100 feb 11 23:02 arm-linux-gnueabihf-objcopy\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  960268 feb 11 23:02 arm-linux-gnueabihf-objdump\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k     417 feb 11 23:02 arm-linux-gnueabihf-pkg-config\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   90444 feb 11 23:02 arm-linux-gnueabihf-pkg-config-real\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  644400 feb 11 23:02 arm-linux-gnueabihf-ranlib\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  431804 feb 11 23:02 arm-linux-gnueabihf-readelf\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620716 feb 11 23:02 arm-linux-gnueabihf-size\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620300 feb 11 23:02 arm-linux-gnueabihf-strings\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  769100 feb 11 23:02 arm-linux-gnueabihf-strip\n  v1sc3rr4k@v1sc3rr4k:~/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin$\n  cd v1sc3rr4k@v1sc3rr4k:~$ ls -l\n  /rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin ls:\n  impossibile accedere a\n  /rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin:\n  File o directory non esistente v1sc3rr4k@v1sc3rr4k:~$ ls -l\n  /home/v1sc3rr4k/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin\n  totale 22540\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620076 feb 11 23:02 arm-linux-gnueabihf-addr2line\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  644400 feb 11 23:02 arm-linux-gnueabihf-ar\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 1085080 feb 11 23:02 arm-linux-gnueabihf-as lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      23 feb 11\n  23:02 arm-linux-gnueabihf-c++ -> arm-linux-gnueabihf-g++\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  618316 feb 11 23:02 arm-linux-gnueabihf-c++filt\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  572984 feb 11 23:02 arm-linux-gnueabihf-cpp\n  -rw-r--r-- 1 v1sc3rr4k v1sc3rr4k    2977 feb 11 23:02 arm-linux-gnueabihf-ct-ng.config\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 2706116 feb 11 23:02 arm-linux-gnueabihf-dwp\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   51540 feb 11 23:02 arm-linux-gnueabihf-elfedit\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  574264 feb 11 23:02 arm-linux-gnueabihf-g++ lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      29 feb\n  11 23:02 arm-linux-gnueabihf-gcc -> arm-linux-gnueabihf-gcc-4.8.3\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  571736 feb 11 23:02 arm-linux-gnueabihf-gcc-4.8.3\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20748 feb 11 23:02 arm-linux-gnueabihf-gcc-ar\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20684 feb 11 23:02 arm-linux-gnueabihf-gcc-nm\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   20684 feb 11 23:02 arm-linux-gnueabihf-gcc-ranlib\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  257872 feb 11 23:02 arm-linux-gnueabihf-gcov\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 3631768 feb 11 23:02 arm-linux-gnueabihf-gdb\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  574712 feb 11 23:02 arm-linux-gnueabihf-gfortran\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  681964 feb 11 23:02 arm-linux-gnueabihf-gprof lrwxrwxrwx 1 v1sc3rr4k v1sc3rr4k      26 feb\n  11 23:02 arm-linux-gnueabihf-ld -> arm-linux-gnueabihf-ld.bfd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 1064504 feb 11 23:02 arm-linux-gnueabihf-ld.bfd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   10501 feb 11 23:02 arm-linux-gnueabihf-ldd\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k 3755040 feb 11 23:02 arm-linux-gnueabihf-ld.gold\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  629292 feb 11 23:02 arm-linux-gnueabihf-nm\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  769100 feb 11 23:02 arm-linux-gnueabihf-objcopy\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  960268 feb 11 23:02 arm-linux-gnueabihf-objdump\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k     417 feb 11 23:02 arm-linux-gnueabihf-pkg-config\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k   90444 feb 11 23:02 arm-linux-gnueabihf-pkg-config-real\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  644400 feb 11 23:02 arm-linux-gnueabihf-ranlib\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  431804 feb 11 23:02 arm-linux-gnueabihf-readelf\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620716 feb 11 23:02 arm-linux-gnueabihf-size\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  620300 feb 11 23:02 arm-linux-gnueabihf-strings\n  -rwxr-xr-x 1 v1sc3rr4k v1sc3rr4k  769100 feb 11 23:02 arm-linux-gnueabihf-strip</p>\n</blockquote>\n\n<p>Update</p>\n\n<p>Using Eclipse i am able to compile for Raspberry. It compiles right and the code works. But i am interested to understand how solve this configuration problem on Ubuntu.</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1423695792, "post_id": 28466213, "comment_id": 45258164, "body": "Verify the <a href=\"http://en.cppreference.com/w/cpp/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence</a> of <code>*menu_list[2]</code> is doing what you think it is."}, {"owner": {"reputation": 450, "user_id": 4543681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c958090adde76bfb9276867a9bb98beb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan P", "link": "https://stackoverflow.com/users/4543681/stefan-p"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1423696572, "post_id": 28466213, "comment_id": 45258456, "body": "<code>*menu_list[2]</code> and <code>*(menu_list[2])</code> give me the same result, so i assume that part to be right...but i&#39;ll add the parentheseis, just to be sure."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1423697064, "post_id": 28466213, "comment_id": 45258652, "body": "It would definitely clarify intent, though you&#39;re correct, I believe. I also think 6502 is accurate in his answer.  <a href=\"http://ideone.com/wSgwJ7\" rel=\"nofollow noreferrer\">see it live</a>"}], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 4543681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c958090adde76bfb9276867a9bb98beb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan P", "link": "https://stackoverflow.com/users/4543681/stefan-p"}, "edited": false, "score": 0, "creation_date": 1423697196, "post_id": 28466325, "comment_id": 45258704, "body": "Yeah...it&#39;s a step forward. If a change the line from  <code>printf(&quot;Value of options-pointer: %p\\n&quot;,*item.options);</code> to <code>printf(&quot;Value of options-pointer: %p\\n&quot;,item.options);</code> i&#39;m getting the right result....but now i stuck on the next step.  I&#39;ll play around a bit, before coming back to that question."}], "tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": true, "score": 1, "last_activity_date": 1423696055, "creation_date": 1423696055, "answer_id": 28466325, "question_id": 28466213, "link": "https://stackoverflow.com/questions/28466213/pointer-to-array-of-pointers-points-to-unexpected-address/28466325#28466325", "title": "Pointer to array of pointers points to unexpected address", "body": "<p>You are evaluating <code>*item.options</code>, not <code>item.options</code>. This seems is not what you wanted to print (i.e. the \"options pointer\") as there is an extra dereferencing operation.</p>\n"}], "owner": {"reputation": 450, "user_id": 4543681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c958090adde76bfb9276867a9bb98beb?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan P", "link": "https://stackoverflow.com/users/4543681/stefan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 28466325, "answer_count": 1, "score": 0, "last_activity_date": 1423699393, "creation_date": 1423695549, "last_edit_date": 1495540619, "question_id": 28466213, "link": "https://stackoverflow.com/questions/28466213/pointer-to-array-of-pointers-points-to-unexpected-address", "title": "Pointer to array of pointers points to unexpected address", "body": "<p>The question is related to my former question here:\n<a href=\"https://stackoverflow.com/questions/28397551/arduino-compile-error-while-using-reference-to-a-struct-in-another-struct\">Arduino compile error while using reference to a struct in another struct</a></p>\n\n<p>I ported the sample code back to the pc and compiled it  to get a clue, what's going wrong.</p>\n\n<p>Here's the sample:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int steps=64;\nunsigned int mode=0;\nunsigned int speed=1;\n\n\ntypedef struct{\n  unsigned int option_value;\n  char option_name[17];\n} SELECTION;\n\ntypedef struct{\n  char item_name[17];\n  unsigned int* variable;\n  SELECTION** options;\n} MENU_ITEM;\n\n\nSELECTION mode_forward = { 0, \"Forward\" };\nSELECTION mode_backward = { 1, \"Backward\" };\nSELECTION* options_mode[] = { &amp;mode_forward, &amp;mode_backward };\n\nSELECTION speed_slow = { 0, \"Slow\" };\nSELECTION speed_normal = { 1, \"Normal\" };\nSELECTION speed_fast = { 2, \"Fast\" };\nSELECTION* options_speed[] = { &amp;speed_slow, &amp;speed_normal, &amp;speed_fast };\n\nMENU_ITEM menu_steps = { \"Steps\", &amp;steps, NULL }; \nMENU_ITEM menu_mode = { \"Mode\", &amp;mode, options_mode }; \nMENU_ITEM menu_speed = { \"Speed\", &amp;speed, options_speed }; \nMENU_ITEM menu_exit = { \"Exit\", NULL, NULL }; \n\nconst unsigned char menu_items = 4;\nMENU_ITEM* menu_list[menu_items] = { &amp;menu_steps, &amp;menu_mode, &amp;menu_speed, &amp;menu_exit };\n//-----------------------------------------------------------\n\nint main(){\n\n  int options;\n\n  options=(int)(sizeof(options_speed)/sizeof(options_speed[0]));\n  printf(\"Speed options: %i\\n\\n\",options);\n\n  printf(\"Address of speed_slow:  %p\\n\",&amp;speed_slow);\n  printf(\"Address of speed_normal:  %p\\n\",&amp;speed_normal);\n  printf(\"Address of speed_fast:  %p\\n\",&amp;speed_fast);\n  printf(\"Address of array:  %p\\n\\n\",&amp;options_speed);\n\n  MENU_ITEM item;\n  item=*menu_list[2];\n\n  printf(\"Menu Item: %s - Item Value: %i\\n\",item.item_name,*item.variable);\n  printf(\"Address of name: %p\\n\",&amp;item.item_name);\n  printf(\"Address of variable-pointer: %p\\n\",&amp;item.variable);\n  printf(\"Address of options-pointer: %p\\n\",&amp;item.options);\n  printf(\"Value of options-pointer: %p\\n\",*item.options);\n\n\n  return 0;\n}\n</code></pre>\n\n<p>When i start the program i get the following output:</p>\n\n<pre><code>Speed options: 3\n\nAddress of speed_slow:  0x6010c0\nAddress of speed_normal:  0x6010e0\nAddress of speed_fast:  0x601100\nAddress of array:  0x601120\n\nMenu Item: Speed - Item Value: 1\nAddress of name: 0x7fff18a5dc90\nAddress of variable-pointer: 0x7fff18a5dca8\nAddress of options-pointer: 0x7fff18a5dcb0\nValue of options-pointer: 0x6010c0\n</code></pre>\n\n<p>That's what i expect....except the last line. Shouldn't the address that it points to be <code>0x601120</code> - the address of <code>options_speed</code> array? \nWhy does it point to the first member of the array instead?\nWhat do i have to change to let it point to <code>0x601120</code>?</p>\n"}, {"tags": ["c", "struct", "heap-memory"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1423693479, "post_id": 28465683, "comment_id": 45257145, "body": "Hmm, you are not going to find a lot of compilers that allocate the copy on the heap.  The stack is the common choice.  Regardless, this is big-time UB."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1423694390, "post_id": 28465683, "comment_id": 45257531, "body": "Because after malloc, you didn&#39;t write anything in that pointer before trying to print it. For whatever reason, malloc&#39;ing again didn&#39;t change the where the pointer is pointing to. Anyway, it&#39;s UB, so anything can happen."}, {"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1423694528, "post_id": 28465683, "comment_id": 45257594, "body": "Your assumptions are wrong.  Your st parameter for callByValue() is copied on to the stack.  any changes you make to st or its members will be discarded when the function returns and the stack pointer is reset."}, {"owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423695686, "post_id": 28465683, "comment_id": 45258113, "body": "This is not true for the heap memory array and exactly this is the reason why we are interested in this particular issue."}, {"owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423696036, "post_id": 28465683, "comment_id": 45258246, "body": "Then again why is this UB? Because isn&#39;t it a natural thing to put heap allocation in structs? Don&#39;t we do this all the time..."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1423696654, "post_id": 28465683, "comment_id": 45258495, "body": "It&#39;s perfectly natural to put heap allocation in structs, and it&#39;s done all the time. The only problem is accessing memory after calling <code>free</code> on that memory."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1423699471, "post_id": 28465683, "comment_id": 45259496, "body": "Another problem not mentioned yet; passing <code>s</code> by value when it contains an uninitialized member variable <code>array[0]</code> causes undefined behaviour due to read of indeterminate value."}], "answers": [{"comments": [{"owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423695737, "post_id": 28466237, "comment_id": 45258143, "body": "However after we free, we are able to give the struct by reference to the other function and modify the array. Firstly we didn&#39;t malloc again and thought exactly what you describe. However we could just acces the pointer and change the data in the heap..."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423696166, "post_id": 28466237, "comment_id": 45258301, "body": "Yes, that&#39;s the problem with undefined behavior (UB). Sometimes your program appears to work, even when it&#39;s totally wrong. The C language provides no protection against UB, it&#39;s your obligation as a programmer to avoid UB. One of the tools that can help you find UB in your programs is <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>. I suggest running your code with valgrind to see what errors you get."}, {"owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423697171, "post_id": 28466237, "comment_id": 45258691, "body": "Then why is it so that if I malloc space first, then free it, and then acces it that the os doesn&#39;t complain. Is this merely the page problem that comes into play? Cuz that would explain this issue."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423697760, "post_id": 28466237, "comment_id": 45258910, "body": "The OS doesn&#39;t really care. You ask for memory with <code>malloc</code>. You relinquish control of the memory with <code>free</code>. After the <code>free</code>, the OS <b>may</b> use the memory for something else. If you use the memory after the OS uses it for something else, then anything can happen. Hence <b>undefined</b> behavior."}, {"owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "edited": false, "score": 0, "creation_date": 1423697968, "post_id": 28466237, "comment_id": 45258986, "body": "Thanks for clarifying!"}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 2, "last_activity_date": 1423695646, "creation_date": 1423695646, "answer_id": 28466237, "question_id": 28465683, "link": "https://stackoverflow.com/questions/28465683/call-by-value-of-a-c-struct-containing-a-pointer-to-heap-allocated-memory/28466237#28466237", "title": "Call-by-value of a c struct containing a pointer to heap allocated memory", "body": "<p>When you call by value, the code makes a copy of the struct for use by the function. So you have this situation </p>\n\n<pre><code>main:        s.array  ---+\n                         +---&gt; MemA (memory for 2 ints)\ncallByValue: st.array ---+\n</code></pre>\n\n<p>After you <code>free(st.array)</code>, both of the pointers are invalid, since <code>MemA</code> has been freed.</p>\n\n<p>After you <code>malloc(1000...)</code>, you have this situation</p>\n\n<pre><code>main:        s.array  ---&gt; MemA (invalid pointer)\ncallByValue: st.array ---&gt; MemB (memory for 1000 ints)\n</code></pre>\n\n<p>The pointer in <code>main</code> doesn't get updated and remains invalid. Using the pointer in <code>main</code> will result in undefined behavior.</p>\n"}], "owner": {"reputation": 853, "user_id": 2506915, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6cbabe9a4b97888a4b666c88c50ad786?s=128&d=identicon&r=PG", "display_name": "Montaldo", "link": "https://stackoverflow.com/users/2506915/montaldo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 28466237, "answer_count": 1, "score": -2, "last_activity_date": 1423698050, "creation_date": 1423693248, "last_edit_date": 1423698050, "question_id": 28465683, "link": "https://stackoverflow.com/questions/28465683/call-by-value-of-a-c-struct-containing-a-pointer-to-heap-allocated-memory", "title": "Call-by-value of a c struct containing a pointer to heap allocated memory", "body": "<p>Dear stackoverflowers.</p>\n\n<p>During some experimenting with c and structs, me and a friend of mine came across something we cannot quite get our heads around. Below is a code snippet describing a struct with an int pointer and a variable. They are both set whilst creating the struct in the main function.</p>\n\n<p>We were wondering how c handles call-by-value on structs. Call-by-reference is all clear, simple reference and everything that is modified changes. Now the strange or interesting comes with the call-by-value. The struct is copied as a local variable and so are the pointer and the value of length in the struct. Basically creating another pointer to the same heap memory. (correct me if I am wrong).</p>\n\n<p>No what if you free this pointer. Does that mean that you loose the information on there? Not necessarily, cuz the information might be still there and within your page. But What if you malloc the pointer again. </p>\n\n<p>Why is the information still there? With and without the new malloc. Doesn't that mean that the OS gives you a new block of memory? Why is that value still there? What happens in general if you pass a struct call-by-value with a pointer to heap memory? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct Struct\n{\n  int* array;\n  int length;\n} Struct;\n\nvoid callByValue(Struct st)\n{\n  st.array[1] = 11;\n  st.length = 11;\n\n  /* This is weird */\n  free(st. array);\n}\n\nvoid callByRef(Struct *st)\n{\n  st-&gt;array[1] = 22;\n  st-&gt;length = 22;\n}\n\nint main()\n{\n  Struct s;\n  s.array = malloc(2*sizeof(int));\n  s.array[1] = 0;\n  s.length = 0;\n\n  printf(\"Before array[1]: %d length: %d\\n\", s.array[1], s.length);\n\n  callByValue(s);\n\n  printf(\"Caal-by-value array[1]: %d length: %d\\n\", s.array[1], s.length);\n\n  callByRef(&amp;s);\n\n  printf(\"Caal-by-reference array[1]: %d length: %d\\n\", s.array[1], s.length);\n\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Before array[1]: 0 length: 0\nCaal-by-value array[1]: 11 length: 0\nCaal-by-reference array[1]: 22 length: 22\n</code></pre>\n"}, {"tags": ["c", "string", "int"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1423695573, "post_id": 28465610, "comment_id": 45258068, "body": "Sorry, C is a low-level system language. It doesn&#39;t really even have &quot;strings&quot; as a data type. You have to do all that yourself: allocate a character array, copy characters into it with a loop, even add the null terminator at the end. No shortcuts."}], "answers": [{"comments": [{"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 6, "creation_date": 1423693509, "post_id": 28465663, "comment_id": 45257164, "body": "In C character constants are of type <code>int</code>. You probably confusing with C++."}, {"owner": {"reputation": 759, "user_id": 4524862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DwQeLaM9ZoM/AAAAAAAAAAI/AAAAAAAAAk8/H54y0WxDtZw/photo.jpg?sz=128", "display_name": "ftynse", "link": "https://stackoverflow.com/users/4524862/ftynse"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 1, "creation_date": 1423693789, "post_id": 28465663, "comment_id": 45257292, "body": "Well, I may have oversimplified.  But an explanation of what is an implementation-defined behavior and how it is supposed to work for &#39;ab&#39; or for multibyte characters does not belong to this question. For curious, <a href=\"http://stackoverflow.com/questions/20764538/type-of-character-constant\" title=\"type of character constant\">stackoverflow.com/questions/20764538/type-of-character-const&zwnj;&#8203;ant</a>"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423695926, "post_id": 28465663, "comment_id": 45258207, "body": "@ftynse: Type of character constants is not implementation-defined. It is <i>always</i> <code>int</code> (C99, <code>6.4.4.4p10</code>); for wide constants, it is <code>wchar_t</code> (<code>p11</code>)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1423695951, "post_id": 28465663, "comment_id": 45258216, "body": "@ftynse The <code>sizeof(&#39;a&#39;) == sizeof(int)</code> - this is not a implementation-defined behavior issue.  &quot;An integer character constant has type <code>int</code>.&quot;"}, {"owner": {"reputation": 53, "user_id": 4556802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/boJEw.png?s=128&g=1", "display_name": "Argarak", "link": "https://stackoverflow.com/users/4556802/argarak"}, "edited": false, "score": 0, "creation_date": 1423763814, "post_id": 28465663, "comment_id": 45290877, "body": "Even though I chose another answer to my question, I did like your explanation. Thank you!"}], "tags": [], "owner": {"reputation": 759, "user_id": 4524862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DwQeLaM9ZoM/AAAAAAAAAAI/AAAAAAAAAk8/H54y0WxDtZw/photo.jpg?sz=128", "display_name": "ftynse", "link": "https://stackoverflow.com/users/4524862/ftynse"}, "is_accepted": false, "score": 3, "last_activity_date": 1423693169, "creation_date": 1423693169, "answer_id": 28465663, "question_id": 28465610, "link": "https://stackoverflow.com/questions/28465610/c-multiply-char-by-int/28465663#28465663", "title": "C - Multiply char by int", "body": "<p>Use a loop to print it multiple times.</p>\n\n<p>In C, a symbol between <code>''</code> has a type <code>char</code>, a character, <em>not</em> a string.  <code>char</code> is a numeric type, same as <code>int</code> but shorter.  It holds a numerical representation of the symbol (ASCII code).  Multiplying it with an integer gives you an integer.</p>\n\n<p>A string, contained between <code>\"\"</code> is an array of characters.  The variable will store a <em>pointer</em> to the first character.  </p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 4556802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/boJEw.png?s=128&g=1", "display_name": "Argarak", "link": "https://stackoverflow.com/users/4556802/argarak"}, "edited": false, "score": 0, "creation_date": 1423763838, "post_id": 28466066, "comment_id": 45290899, "body": "Never knew of the putchar function before now, Thanks!"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1423694918, "creation_date": 1423694918, "answer_id": 28466066, "question_id": 28465610, "link": "https://stackoverflow.com/questions/28465610/c-multiply-char-by-int/28466066#28466066", "title": "C - Multiply char by int", "body": "<pre><code>for ( size_t ii = 0; ii &lt; 5; ++ii )\n    putchar('#');\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1423696213, "post_id": 28466067, "comment_id": 45258316, "body": "Using <code>printf</code> to in a loop to print individual characters is overkill; here <code>putchar</code> would suffice."}], "tags": [], "owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "is_accepted": false, "score": 0, "last_activity_date": 1423694922, "creation_date": 1423694922, "answer_id": 28466067, "question_id": 28465610, "link": "https://stackoverflow.com/questions/28465610/c-multiply-char-by-int/28466067#28466067", "title": "C - Multiply char by int", "body": "<p>First of all, use printf function. It allows you to format your output in the way you like. The way to get result you required is a for loop.</p>\n\n<pre><code>int i, x = 5;\nfor (i = 0; i &lt; x; i++)\n    printf(\"#\");\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4556802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/boJEw.png?s=128&g=1", "display_name": "Argarak", "link": "https://stackoverflow.com/users/4556802/argarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22349, "favorite_count": 0, "accepted_answer_id": 28466066, "answer_count": 3, "score": 4, "last_activity_date": 1521497506, "creation_date": 1423693005, "question_id": 28465610, "link": "https://stackoverflow.com/questions/28465610/c-multiply-char-by-int", "title": "C - Multiply char by int", "body": "<p>Before I ask my question let me just say that I am a newbie to C, and do not know how to do a lot in it.</p>\n\n<p>Anyway, the problem is that I need to print a specific number of characters. I first used Python, because that was a language that I was familiar with, and wrote this very simple program.</p>\n\n<pre><code>x = 5    \nprint('#' * x)\n</code></pre>\n\n<p>This is what I want to achieve, but in C. Sorry if this is a duplicate or a stupid question, but I have been puzzled and without answers, even after looking on the internet. </p>\n"}, {"tags": ["c", "for-loop", "infinite-loop"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1423691910, "post_id": 28465307, "comment_id": 45256297, "body": "If you get to see the result, your program did not get stuck in the loop. Q.E.D."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1423691919, "post_id": 28465307, "comment_id": 45256305, "body": "If it&#39;s stuck in the loop and the print is outside the loop, how is it printing the right answer?"}, {"owner": {"reputation": 18728, "user_id": 2382136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eMbhT.jpg?s=128&g=1", "display_name": "Wojtek Surowka", "link": "https://stackoverflow.com/users/2382136/wojtek-surowka"}, "edited": false, "score": 2, "creation_date": 1423692119, "post_id": 28465307, "comment_id": 45256395, "body": "In C do not use loops <code>i = 1; i &lt;= triangle</code> but <code>i = 0; i &lt; triangle</code>. The form starting from 1 will sooner or later hit you back."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1423692841, "post_id": 28465307, "comment_id": 45256795, "body": "This does not calculate triangular numbers... It sets <code>triNumber = triangle</code>."}], "answers": [{"comments": [{"owner": {"reputation": 56117, "user_id": 845092, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/50ccdbac5f0f9ff683e4b30a248189bf?s=128&d=identicon&r=PG", "display_name": "Mooing Duck", "link": "https://stackoverflow.com/users/845092/mooing-duck"}, "edited": false, "score": 0, "creation_date": 1423692405, "post_id": 28465348, "comment_id": 45256557, "body": "@Rizier123: I&#39;m pretty sure Ctrl+D, Ctrl+Z are not ways to write a newline, those are ways to end the stream.  Very different."}], "tags": [], "owner": {"reputation": 55943, "user_id": 3933332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zuzev.png?s=128&g=1", "display_name": "Rizier123", "link": "https://stackoverflow.com/users/3933332/rizier123"}, "is_accepted": false, "score": 2, "last_activity_date": 1423691908, "creation_date": 1423691908, "answer_id": 28465348, "question_id": 28465307, "link": "https://stackoverflow.com/questions/28465307/my-c-program-is-stuck-in-a-for-loop/28465348#28465348", "title": "My C program is stuck in a for loop", "body": "<p>It's not stuck in the for loop. You have to change your <code>scanf()</code> statement from this:</p>\n\n<pre><code>scanf(\"%i\\n\", &amp;triangle);\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>scanf(\"%i\", &amp;triangle);\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4556808, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SY9TYbSf6Y8/AAAAAAAAAAI/AAAAAAAAAMQ/6txXBhg7LtE/photo.jpg?sz=128", "display_name": "Aaron Medina", "link": "https://stackoverflow.com/users/4556808/aaron-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423691908, "creation_date": 1423691789, "last_edit_date": 1423691807, "question_id": 28465307, "link": "https://stackoverflow.com/questions/28465307/my-c-program-is-stuck-in-a-for-loop", "title": "My C program is stuck in a for loop", "body": "<p>I am trying to write a program that calculates the triangular number that is provided by the user. When I run it, it gets stuck in the for loop, but will still print out the right answer, because my print statement is outside the loop. Any help is greatly appreciated. My code is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n\n    //Declare your variables\n\n    int triangle, triNumber, i;\n\n\n    //Assign values for known variables\n\n    triNumber = 0;\n\n\n    //Get the user to input the triangular number that they want\n\n    printf(\"Please enter the triangular number you would like: \");\n    scanf(\"%i\\n\", &amp;triangle);\n\n\n    //Execute for loop that will calculate the triangular number\n\n    for (i = 1; i &lt;= triangle; i = i + 1)\n    {\n        triNumber = triNumber + 1;\n    }\n\n\n    //Display the user's triangular number\n\n    printf(\"The triangular number is %i\\n\", triNumber);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "dependencies", "shared-libraries", "eclipse-cdt"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1423693111, "post_id": 28465269, "comment_id": 45256938, "body": "Why would libcode depend on anything in the main project code? The point of libraries is to be standalone reusable pieces of code, thus able to be linked to ANY project."}, {"owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423745997, "post_id": 28465269, "comment_id": 45278801, "body": "It&#39;s a web service implementation, it just extends and serve funcionalities from the main executable, hence the dependency. It must be a shared library in order to be loaded by the http server, and the core is implemented in the main executable."}], "answers": [{"comments": [{"owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "edited": false, "score": 0, "creation_date": 1423746248, "post_id": 28466682, "comment_id": 45278947, "body": "I&#39;m not sure...there is a lot of stuff from the main project that are not needed to be in the shared library. It&#39;s a lightweigth library made just to expose some functionalities from the core and not to be &quot;the core&quot;."}, {"owner": {"reputation": 311, "user_id": 4547387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114e640cd37b0ff3745462e72a54cd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie C", "link": "https://stackoverflow.com/users/4547387/charlie-c"}, "reply_to_user": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "edited": false, "score": 0, "creation_date": 1423753588, "post_id": 28466682, "comment_id": 45284009, "body": "In that case you should go with your solution B above. You were on the right track all along, but I can understand trying to find other options before taking on a bunch of refactoring."}], "tags": [], "owner": {"reputation": 311, "user_id": 4547387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114e640cd37b0ff3745462e72a54cd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie C", "link": "https://stackoverflow.com/users/4547387/charlie-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1423697733, "creation_date": 1423697733, "answer_id": 28466682, "question_id": 28465269, "link": "https://stackoverflow.com/questions/28465269/how-to-implement-executable-and-shared-library-with-common-code-in-c/28466682#28466682", "title": "How to implement executable and shared library with common code in C", "body": "<p>You should probably put the source in <code>folderA</code> and <code>folderB</code> into your shared library since they apparently contain core functionality. In your executable put the source that uses the library to do something, for example, calling various functions in <code>libcode</code> to achieve some goal for the end user. You will need to link the executable to the shared library.</p>\n\n<pre><code>Main Project Executable [links to shared library] \n    main.c              [uses libcode to do stuff]\n\nShared Library Project\n    +-----folderA\n        ------------- sourceA.c\n        ------------- sourceA.h\n    +-----folderB\n        ------------- sourceB.c\n        ------------- sourceB.h\n        ------------- libcode.c\n        ------------- libcode.h\n</code></pre>\n"}], "owner": {"reputation": 3460, "user_id": 1987788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5229a103393dc342027d269fb8cf7f1e?s=128&d=identicon&r=PG", "display_name": "natenho", "link": "https://stackoverflow.com/users/1987788/natenho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423697733, "creation_date": 1423691639, "last_edit_date": 1423692410, "question_id": 28465269, "link": "https://stackoverflow.com/questions/28465269/how-to-implement-executable-and-shared-library-with-common-code-in-c", "title": "How to implement executable and shared library with common code in C", "body": "<p>I'm designing a Linux C project which is composed by two binaries: an executable and a shared library.</p>\n\n<p>I have the following project structure using Eclipse-cdt:</p>\n\n<pre>\n<b>Main Project Executable</b>\n    +-----folderA\n        ------------- sourceA.c\n        ------------- sourceA.h\n    +-----folderB\n        ------------- sourceB.c\n        ------------- sourceB.h\n    main.c\n\n<b>Shared Library Project</b>\n    +-----folderB\n        ------------- libcode.c\n        ------------- libcode.h\n</pre>\n\n<p>The Shared Library code in <strong>libcode.c</strong> is strictly dependent on <strong>folderA</strong> and <strong>folderB</strong> code from the Main Project.</p>\n\n<p>How could I organize the projects in order to have no duplicated files?</p>\n\n<h2>Solution A (Current)</h2>\n\n<p>The best solution I've found so far, is to use linked resources inside eclipse:</p>\n\n<pre>\n<b>Main Project Executable</b>\n    +-----folderA\n        ------------- sourceA.c\n        ------------- sourceA.h\n    +-----folderB\n        ------------- sourceB.c\n        ------------- sourceB.h\n        <b>------------- libcode.c</b>\n        <b>------------- libcode.h</b>\n    main.c\n\n<b>Shared Library Project</b>\n    +-----folderA <b>[linked]</b>\n        ------------- sourceA.c <b>[linked]</b>\n        ------------- sourceA.h <b>[linked]</b>\n    +-----folderB <b>[linked]</b>\n        ------------- sourceB.c <b>[linked]</b>\n        ------------- sourceB.h <b>[linked]</b>\n        ------------- libcode.c <b>[linked]</b>\n        ------------- libcode.h <b>[linked]</b>\n</pre>\n\n<p>Notice that I moved 100% of shared library code into the main project and linked all the files I needed in the Shared Library.\nThis way I don't need to have any \"physical\" source files inside the Shared Library Project, but I still think it's not a good idea, because it can surprise other developers (violating POLS principle).</p>\n\n<h2>Solution B</h2>\n\n<p>There is the option to move all the common code into a third project and make the two projects depend on it, but in my case it will lead into a big code refactoring, which I would like to avoid.</p>\n\n<p><strong>Any other possibility? Is the solution B definetly a better practice?</strong></p>\n"}, {"tags": ["c", "arrays", "algorithm", "while-loop", "distribution"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1423691811, "post_id": 28465215, "comment_id": 45256251, "body": "You do know that <code>memset(b, 0, n)</code> sets the first <code>n</code> <i>bytes</i> of <code>b</code> to zero, but <code>b</code> is an array of <code>n</code> <code>int</code>s?"}, {"owner": {"reputation": 3606, "user_id": 1313642, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/izoYJ.jpg?s=128&g=1", "display_name": "Eric Barr", "link": "https://stackoverflow.com/users/1313642/eric-barr"}, "edited": false, "score": 0, "creation_date": 1423692360, "post_id": 28465215, "comment_id": 45256526, "body": "By the way, as an improvement I would suggest always giving the variables in your programs more descriptive names, such as &quot;box&quot; instead of &quot;b&quot; and &quot;numBoxes&quot; instead of &quot;n&quot;.  It will help you and others who  look at your code to follow the logic more easily."}, {"owner": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "edited": false, "score": 0, "creation_date": 1423692921, "post_id": 28465215, "comment_id": 45256840, "body": "What is the time complexity of this code ?"}, {"owner": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "reply_to_user": {"reputation": 3606, "user_id": 1313642, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/izoYJ.jpg?s=128&g=1", "display_name": "Eric Barr", "link": "https://stackoverflow.com/users/1313642/eric-barr"}, "edited": false, "score": 0, "creation_date": 1423693471, "post_id": 28465215, "comment_id": 45257142, "body": "@EricBarr What is the time complexity of this code"}], "answers": [{"tags": [], "owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "is_accepted": false, "score": 2, "last_activity_date": 1423691815, "creation_date": 1423691815, "answer_id": 28465319, "question_id": 28465215, "link": "https://stackoverflow.com/questions/28465215/wrong-output-but-why/28465319#28465319", "title": "Wrong Output,but why?", "body": "<p><code>void * memset ( void * ptr, int value, size_t num );</code></p>\n\n<p><code>num</code> is the number of bytes, so</p>\n\n<p><code>memset(b,0,n);</code></p>\n\n<p>should be</p>\n\n<p><code>memset(b,0,n*sizeof(int));</code></p>\n\n<p><a href=\"http://ideone.com/I9LzdT\" rel=\"nofollow\">Live Demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "edited": false, "score": 0, "creation_date": 1423692229, "post_id": 28465328, "comment_id": 45256451, "body": "Thnx,  That was my mistake , sorry for that :("}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "edited": false, "score": 0, "creation_date": 1423692382, "post_id": 28465328, "comment_id": 45256540, "body": "No worries, everybody makes mistakes :)"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "edited": false, "score": 0, "creation_date": 1423693476, "post_id": 28465328, "comment_id": 45257144, "body": "@MoinakDebnath The <code>while</code> loop is based solely on <code>s</code>, and <code>s</code> decrements every time, so the complexity of the <code>while</code> loop is <i>O(s)</i>. The <code>for</code> loop is based solely on <code>n</code>, since <code>x1=n</code>, so the complexity of the <code>for</code> loop is <i>O(n)</i>. Overall, you have <i>O(n+s)</i>. That can be simplified to <i>O(n)</i> if <code>n</code> is larger than <code>s</code>, or <i>O(s)</i> is <code>s</code> is larger than <code>n</code>."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": false, "score": 1, "last_activity_date": 1423691854, "creation_date": 1423691854, "answer_id": 28465328, "question_id": 28465215, "link": "https://stackoverflow.com/questions/28465215/wrong-output-but-why/28465328#28465328", "title": "Wrong Output,but why?", "body": "<p>The third argument to <code>memset</code> is the number of <strong>bytes</strong> to set. Since <code>b</code> is an array of <code>int</code>, it has <code>4*n</code> bytes that need to be cleared, assuming 32-bit ints. The correct code is </p>\n\n<pre><code>memset( b, 0, sizeof(b) );\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4061847, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f9d7f7dee285958bdd5a65068a1d4422?s=128&d=identicon&r=PG&f=1", "display_name": "Moinak Debnath", "link": "https://stackoverflow.com/users/4061847/moinak-debnath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423691854, "creation_date": 1423691451, "question_id": 28465215, "link": "https://stackoverflow.com/questions/28465215/wrong-output-but-why", "title": "Wrong Output,but why?", "body": "<p>User will give N,S respectively</p>\n\n<p>If the value of N is 3, i.e i have 3 boxes and the input of S is 6.\nThen I am coding in such a manner that in the 1st case(n=3), 1 is added to each box,then again(n=2) 1 is added to each box (A,B,C) excluding the last box, again(n=1) 1 is added to each box excluding the last box as well as the second last box.<br>\nAnd the total number of balls left in each box is to displayed after distribution of total value S, </p>\n\n<p>For example : </p>\n\n<p>It looks like this, where a,b,c are the 3 boxes. \nn=3 and s=6</p>\n\n<pre><code>A B C\n1 1 1\n1 1\n1\n-----\n3 2 1 //output to be displayed\n</code></pre>\n\n<p>again if the input of n ans s are 4 and 9\nthen output would be,</p>\n\n<pre><code>A B C D\n1 1 1 1\n1 1 1\n1 1\n-------\n3 3 2 1 //output to be displayed\n</code></pre>\n\n<p>again if the input of n ans s are 3 and 4\nthen output would be,</p>\n\n<pre><code>A B C D\n1 1 1 1\n1 \n-------\n2 1 1 1 //output to be displayed\n</code></pre>\n\n<p>again if the input of n ans s are 4 and 2\nthen output would be,</p>\n\n<pre><code>A B C D\n1 1 \n-------\n1 1 0 0 //output to be displayed\n</code></pre>\n\n<p>for n max value of s = n*(n+1)/2</p>\n\n<p>Actually in this case the the complexity of the code cant be O(n^2). SO this was my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int n,i,j,s,y,x1;\n    scanf(\"%d%d\",&amp;n,&amp;s);\n    int b[n];\n    memset(b,0,n);\n    x1=n;\n    j=0;\n        while(s&gt;0)\n        {\n            y=j%n;\n            if(j!=n-1)\n            {\n                b[y]++;\n                s--;\n                j++;\n            }\n            else\n            {\n                b[y]++;\n                s--;\n                j=0;\n                n--;\n            }\n        }\n    for(i=0;i&lt;x1;++i)\n        {\n            printf(\"%d \",b[i]);\n        }\nreturn 0;\n}\n</code></pre>\n\n<p>But after executing the code,The output given by my code:</p>\n\n<pre><code>where n = 4 and s = 9\nthe output is : 3 32631 -747449654 32629\n\nwhere n = 3 and s = 5\nthe output is :2 2 4195586\n</code></pre>\n\n<p>Why is this happening ? I dont want to use nested for loops!\nBut whats wrong in here ? please help  me!</p>\n"}, {"tags": ["c", "arrays", "shared-memory"], "comments": [{"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1423691533, "post_id": 28465151, "comment_id": 45256110, "body": "What is your compiler &amp; OS (if any)?"}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1423691668, "post_id": 28465151, "comment_id": 45256175, "body": "Hi, it is ARM gcc compiler"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1423691754, "post_id": 28465151, "comment_id": 45256221, "body": "Might help: <a href=\"http://stackoverflow.com/questions/4067811/how-to-place-a-variable-at-a-given-absolute-address-in-memory-with-gcc\" title=\"how to place a variable at a given absolute address in memory with gcc\">stackoverflow.com/questions/4067811/&hellip;</a>"}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1423692468, "post_id": 28465151, "comment_id": 45256593, "body": "Hi, I know how to do it for one instantiate of structure that is something similar like on that link. But I do not know how to do it for array of  instantiates of structure. I do not know is it possible to do it. Something like: buffer_t buffer_pool[6] (and to force it start from specific address in memory for example 0x4000000). I found some advice on this link <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.faqs/ka3750.html\" rel=\"nofollow noreferrer\">infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.faqs/&hellip;</a> (second option is more interesting for me). But again it is just for one instantiate."}, {"owner": {"reputation": 434, "user_id": 3703709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e7935f2798b555f61085fd5827c9095?s=128&d=identicon&r=PG&f=1", "display_name": "mstbaum", "link": "https://stackoverflow.com/users/3703709/mstbaum"}, "edited": false, "score": 0, "creation_date": 1423692538, "post_id": 28465151, "comment_id": 45256634, "body": "Could you not just create 6 structs and place them adjacent to each other in memory?  That&#39;s basically all an array is.  Then you can have a pointer to the beginning of the buffer and use pointer addition to access the different structs."}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423692701, "post_id": 28465151, "comment_id": 45256716, "body": "mstbaum that is an option but I was thinking is there better way do do it, instead setting 6 structs and forcing them to specific memory. I will do like that if nobody gives better advice."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423693422, "post_id": 28465600, "comment_id": 45257115, "body": "kdopen thank you for answer I will do it like that. Initialize buffer_pool at beginning and then fill up through for loop."}], "tags": [], "owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "is_accepted": true, "score": 7, "last_activity_date": 1423692974, "creation_date": 1423692974, "answer_id": 28465600, "question_id": 28465151, "link": "https://stackoverflow.com/questions/28465151/initialize-array-starting-from-specific-address-in-memory-c-programming/28465600#28465600", "title": "Initialize array starting from specific address in memory - C programming", "body": "<p>A pointer to a single struct (or int, float, or anything else) is inherently a pointer to an array of them. The pointer type provides the sizeof() value for an array entry, and thus allows pointer arithmetic to work.</p>\n\n<p>Thus, given a <code>struct buffer</code> you can simply do</p>\n\n<pre><code>static struct buffer * const myFIFO = (struct buffer *) 0x40000\n</code></pre>\n\n<p>and then simply access <code>myFIFO</code> as an array</p>\n\n<pre><code>for (size_t i = 0; i &lt; maxPackets; ++i)\n{\n    buffer[i].someField = initialValue1;\n    buffer[i].someOtherField = 42;\n}\n</code></pre>\n\n<p>This works just the way you expect.</p>\n\n<p>What you <em>can't</em> do (using pure standard C) is declare an array at a particular address like this:</p>\n\n<pre><code>struct buffer myFIFO[23] @ 0x400000;\n</code></pre>\n\n<p>However, your compiler <em>may</em> have extensions to allow it. Many embedded compilers do (after all, that's often how they declare memory-mapped device registers), but it will be different for every compiler vendor, and possibly for every chip because it is a vendor extension.</p>\n\n<p>GCC does allow it for AVR processors via an attribute, for example</p>\n\n<pre><code>volatile int porta __attribute__((address (0x600)));\n</code></pre>\n\n<p>But it doesn't seem to support it for an ARM.</p>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423694417, "post_id": 28465722, "comment_id": 45257543, "body": "Gaskoin I am not that experienced with linker scripts, but I will try to do it looks interesting. I will get to know how to write linker scripts."}, {"owner": {"reputation": 2269, "user_id": 3407418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuU6F.png?s=128&g=1", "display_name": "Gaskoin", "link": "https://stackoverflow.com/users/3407418/gaskoin"}, "reply_to_user": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423694653, "post_id": 28465722, "comment_id": 45257666, "body": "I do not know how do you build your code so I cannot provide you any details. If you have dedicated IDE for your ARM maybe you can find something in configuration. If you are using gcc you should have somewhere a file with ld extension -&gt; that is what you need :)"}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423695544, "post_id": 28465722, "comment_id": 45258057, "body": "Dear I am using Xilinx SDK, it is based on eclipse. I found the way how to do it. So could I do it like this. I set this into linker script:                MEMORY {    ps7_ddr_0_S_AXI_BASEADDR : ORIGIN = 0x00100000, LENGTH = 0x1FF00000    ps7_ram_0_S_AXI_BASEADDR : ORIGIN = 0x00000000, LENGTH = 0x00030000    ps7_ram_1_S_AXI_BASEADDR : ORIGIN = 0xFFFF0000, LENGTH = 0x0000FE00    DAC_DMA (w) : ORIGIN = 0xE000000, LENGTH = 64K     }         And then I set this into code static buffer_t __attribute__((section(&quot;DAC_DMA&quot;))) buf_pool[6];"}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423699156, "post_id": 28465722, "comment_id": 45259399, "body": "Gaskoin I do not get it work. When I try to print out address of variable I get some random value. Seems that linker doesn&#39;t take into account may memory section declaration."}, {"owner": {"reputation": 2269, "user_id": 3407418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuU6F.png?s=128&g=1", "display_name": "Gaskoin", "link": "https://stackoverflow.com/users/3407418/gaskoin"}, "reply_to_user": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423728118, "post_id": 28465722, "comment_id": 45268475, "body": "You should try to launch it, because sometimes debugger can show wrong addresses for external memories, have the same issue with CM4 but was working fine. I do not know xilinx sdk so I me not be able to help you more"}, {"owner": {"reputation": 2269, "user_id": 3407418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuU6F.png?s=128&g=1", "display_name": "Gaskoin", "link": "https://stackoverflow.com/users/3407418/gaskoin"}, "reply_to_user": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 0, "creation_date": 1423728790, "post_id": 28465722, "comment_id": 45268781, "body": "You can check also <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0474f/BABDJCAA.html\" rel=\"nofollow noreferrer\">infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0474&zwnj;&#8203;f/&hellip;</a>"}, {"owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "edited": false, "score": 1, "creation_date": 1423737042, "post_id": 28465722, "comment_id": 45273532, "body": "Gaskoin I got it work. Except from declaring memory region in lscript.ld, also there should put memory region mapping for that region. So I added .dacdma : {    __dacdma_start = .;    *(.data)    __dacdma_end = .; } &gt; DAC_DMA                                     where DAC_DMA is previously added region (in style like you explained), and the I call static buffer_t buf_pool[MAX_BUF_POOL_SIZE]__attribute__((section(&quot;.dacdma&quot;)&zwnj;&#8203;));"}], "tags": [], "owner": {"reputation": 2269, "user_id": 3407418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QuU6F.png?s=128&g=1", "display_name": "Gaskoin", "link": "https://stackoverflow.com/users/3407418/gaskoin"}, "is_accepted": false, "score": 2, "last_activity_date": 1423693456, "creation_date": 1423693456, "answer_id": 28465722, "question_id": 28465151, "link": "https://stackoverflow.com/questions/28465151/initialize-array-starting-from-specific-address-in-memory-c-programming/28465722#28465722", "title": "Initialize array starting from specific address in memory - C programming", "body": "<p>Generally @kdopen is right but for arm you should create an entry in MEMORY section linker script that shows to linker where is your memory:</p>\n\n<pre><code>MEMORY\n{\n    ...\n    ExternalDDR (w) : ORIGIN = 0x400000, LENGTH = 4M\n}\n</code></pre>\n\n<p>And than, when you are declaring variable just use the </p>\n\n<pre><code>__attribute__((section(\"ExternalDDR\")))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "is_accepted": false, "score": 1, "last_activity_date": 1427128992, "creation_date": 1427128992, "answer_id": 29215687, "question_id": 28465151, "link": "https://stackoverflow.com/questions/28465151/initialize-array-starting-from-specific-address-in-memory-c-programming/29215687#29215687", "title": "Initialize array starting from specific address in memory - C programming", "body": "<p>I found the way how to do it. So could I do it like this. I set this into linker script: </p>\n\n<pre><code>MEMORY { \n        ps7_ddr_0_S_AXI_BASEADDR : ORIGIN = 0x00100000, LENGTH = 0x1FF00000          \n        ps7_ram_0_S_AXI_BASEADDR : ORIGIN = 0x00000000, LENGTH = 0x00030000 \n        ps7_ram_1_S_AXI_BASEADDR : ORIGIN = 0xFFFF0000, LENGTH = 0x0000FE00 \n        DAC_DMA (w) : ORIGIN = 0xE000000, LENGTH = 64K \n       }\n\n.dacdma : {\n   __dacdma_start = .;\n   *(.data)\n   __dacdma_end = .;\n} &gt; DAC_DMA\n</code></pre>\n\n<p>And then I set this into code </p>\n\n<pre><code>static buffer_t __attribute__((section(\"DAC_DMA\"))) buf_pool[6]; \n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 4556752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b547793d7a8351e37b7c66eb8e0ec056?s=128&d=identicon&r=PG&f=1", "display_name": "elem", "link": "https://stackoverflow.com/users/4556752/elem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10944, "favorite_count": 0, "accepted_answer_id": 28465600, "answer_count": 3, "score": 11, "last_activity_date": 1510576179, "creation_date": 1423691220, "question_id": 28465151, "link": "https://stackoverflow.com/questions/28465151/initialize-array-starting-from-specific-address-in-memory-c-programming", "title": "Initialize array starting from specific address in memory - C programming", "body": "<p><strong>Do you have idea how to initialize array of structs starting from specific address in memory (not virtual, physical DDR memory).</strong> I am working on implementation of TxRx on SoC (ARM-FPGA). Basically ARM (PS) and FPGA (PL) communicate to each other by using shared RAM memory. Currently I am working on transmitter side, so I need to constantly load packets that I get from MAC layer to memory, then my Tx reads data and sends it in air. To achieve this I want to implement circular FIFO buffer on (ARM) side, in way that I can store up to 6 packets into buffer and send them one by one, in same time loading other packets on places of already sent packages. Because I need to use specific memory addresses I am interested is it possible to initialize array of structure that will be stored on specific addresses in memory. <strong>For example I want that my array starts at adress 0x400000 and ends at address 0x400000 + MaximumNumberOfPackets x SizeOfPackets</strong> I know how to do it for one instantiate of structure for example like this:\nbuffer_t *tmp = (struct buffer_t *)234881024;</p>\n\n<p>But how to do it for array of structures?</p>\n"}, {"tags": ["c", "arrays", "valgrind", "dynamic-arrays", "scanf"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423690729, "post_id": 28464994, "comment_id": 45255667, "body": "You don&#39;t show the declaration of <code>numsInFile</code>. And <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast <code>malloc()</code></a>."}, {"owner": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690791, "post_id": 28464994, "comment_id": 45255703, "body": "@iharob numsInFile is just an integer."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423690863, "post_id": 28464994, "comment_id": 45255746, "body": "why are you ignoreing <code>fscanf()</code>&#39;s return value?"}, {"owner": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690914, "post_id": 28464994, "comment_id": 45255777, "body": "@iharob Not sure what you mean by ignoring it, I&#39;m checking if it&#39;s 1 before attempting to add the integer to the array so that I&#39;m not adding garbage"}, {"owner": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "edited": false, "score": 0, "creation_date": 1423691083, "post_id": 28464994, "comment_id": 45255850, "body": "@JayB follow the <code>don&#39;t cast malloc()</code> link to see the answer to that question. And you <i>are</i> ignoring the return value from the first <code>fscanf()</code> call (outside the loop)."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423691086, "post_id": 28464994, "comment_id": 45255854, "body": "Not when you read <code>numsInFile</code> there you do ignore it."}, {"owner": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423691172, "post_id": 28464994, "comment_id": 45255905, "body": "@iharob Ah, yes. I forgot about that. I&#39;ll add a check there"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423691329, "post_id": 28464994, "comment_id": 45255992, "body": "@JayB forgetting that will make your program invoke undefined behavior, in such situation it&#39;s quite dificult to debug and fix your program."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1423691394, "post_id": 28464994, "comment_id": 45256038, "body": "Compile your program with optimization disabled, and run that under valgrind.  Valgrind should tell you exactly on which line the access violation occurs.  No need to guess (or make us do so)."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1423691498, "post_id": 28464994, "comment_id": 45256089, "body": "@JohnBollinger yes with <code>gcc -Wall -Wextra -Werror -g3 -O0</code> in combination with <code>valgrind</code> it&#39;s possible to catch the most stupid mistakes instantly."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423692193, "post_id": 28464994, "comment_id": 45256431, "body": "The edited code is cleaner.  Is Valgrind still complaining?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1423692375, "post_id": 28464994, "comment_id": 45256533, "body": "Unless the return value of <code>fscanf()</code> is checked, we are left to guess that a correct conversion occurred.  Recommend to add code to check <code>fscanf()</code> return value in <code>fscanf(fp, &quot;%d&quot;, &amp;numsInFile);</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423692378, "post_id": 28464994, "comment_id": 45256538, "body": "Are you by chance printing the integers somewhere? If you are, please post that code too."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423692433, "post_id": 28464994, "comment_id": 45256577, "body": "@chux that could be the invalid read of size 4, I thought of it initially and the OP commented in my answer that he was going to change it."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423692510, "post_id": 28464994, "comment_id": 45256619, "body": "Are you sure valgrind is complaining about this code at all?  I don&#39;t see anything in it to explain the error.  I especially don&#39;t see anything that could explain an invalid <i>read</i>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423692693, "post_id": 28464994, "comment_id": 45256709, "body": "@iharob, no.  even if the <code>fscanf()</code> fails, subsequently accessing the value of the variable that was supposed to be read is not an &quot;invalid read&quot; in the valgrind sense.  The value may not be well defined, but the storage location certainly is fine."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423692772, "post_id": 28464994, "comment_id": 45256749, "body": "@John Bollinger Areas to explore: <code>numsInFile</code> value is unknown after the <code>fscanf()</code>.  Could be negative.  <code>numIntegers</code> is unknown - could be negative.  <code>integers</code> is not known, could be <code>NULL</code>."}, {"owner": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423693125, "post_id": 28464994, "comment_id": 45256947, "body": "@JohnBollinger I&#39;ve fixed it all, but found another error in the allocation of space for a dynamic 2d array and I&#39;ve added it to my question, I&#39;d appreciate it if someone could take a look.. Thanks for everyone&#39;s help so far"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423693182, "post_id": 28464994, "comment_id": 45256977, "body": "@chux, you are correct on all counts.  The fact remains, however, that the code presented performs no reads via any pointer.  Valgrind &quot;invalid read&quot; errors indicate reads of memory that valgrind does not think belong to the program, and you cannot get that from reading ordinary variables.  (Correction: <code>fscanf()</code> reads the format strings, but reading via a pointer to a string literal should never generate an invalid read.)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423693748, "post_id": 28464994, "comment_id": 45257273, "body": "@JayB, if you have a different problem, ask a different question.  When you do, be specific about exactly what line valgrind complains about.  And for what it&#39;s worth, it is doubtful that your new error is in the new code you posted."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423694054, "post_id": 28464994, "comment_id": 45257393, "body": "@John Bollinger Your assessment sounds good.  I take it if <code>integers</code> was <code>NULL</code>, a different error would be reported with <code>integers[i] = currInt;</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423694220, "post_id": 28464994, "comment_id": 45257459, "body": "@chux, if <code>integers</code> were <code>NULL</code>, then assignment to <code>integers[i]</code> could be expected to generate an invalid <i>write</i>, but not an invalid <i>read</i>.  It would likely also produce a segfault, even under valgrind."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423699502, "post_id": 28464994, "comment_id": 45259505, "body": "@JohnBollinger yes you are right again, what valgrind would warn about is an <code>Uninitialized Value</code>."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423691376, "post_id": 28465103, "comment_id": 45256023, "body": "I don&#39;t see any good reason for the downvote, and yesterday I recieved my first reputation reversal for serial downvoting, which I assume is happening again."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "edited": false, "score": 0, "creation_date": 1423691571, "post_id": 28465103, "comment_id": 45256132, "body": "@JayB Someone is downvoting all my posts no matter what, but don&#39;t worry it will be reverted within 24hrs. Did you fix your issue?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423692015, "post_id": 28465103, "comment_id": 45256352, "body": "Not my downvote, but note that the original code does not appear to exceed the bounds of <code>integers</code>.  The loop is structured oddly, but it never access an element of <code>integers</code> having index greater than or equal to the lesser of <code>numsInFile</code> and <code>numIntegers</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423692229, "post_id": 28465103, "comment_id": 45256452, "body": "@JohnBollinger you are absolutely right, I didn&#39;t pay attention to the check performed before, still it&#39;s wierd to use one variable for the size of the <code>malloc()</code>ed space and another variable to limit the read count..."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1423692135, "last_edit_date": 1423692135, "creation_date": 1423691058, "answer_id": 28465103, "question_id": 28464994, "link": "https://stackoverflow.com/questions/28464994/invalid-read-of-size-4-on-fscanf/28465103#28465103", "title": "Invalid read of size 4 on fscanf", "body": "<p>You allocate space for <code>countToUse</code> integers</p>\n\n<pre><code>integers = (int*)malloc(sizeof(int) * countToUse);\n</code></pre>\n\n<p>and then iterate through <code>numsInFile</code>, and then check or <code>numIntegers</code>, this is wrong, and you don't check the return value of your first <code>fscanf()</code> or of your <code>malloc()</code>.</p>\n\n<p>The following will not make valgrind complain</p>\n\n<pre><code>/* Get number of integers (first number) */\nint numsInFile;\n\nif (fscanf(fp, \"%d\", &amp;numsInFile) != 1)\n    doSomethingAboutIt_ButDoNotContinue();\n/* find minimum of numstoread and numintegers and use that as counttouse */\nif (numsInFile &lt; numIntegers)\n    countToUse = numsInFile;\nelse\n    countToUse = numIntegers;\n/*\n * Initialize the integers array with the minimum value as well\n * since it will only store this many \n */\nintegers = malloc(sizeof(int) * countToUse);\nif (integers == NULL)\n    doSomethingAboutIt_ButDoNotContinue();\nfor (int i = 0 ; i &lt; numsInFile ; i++)\n{\n    if (i &lt; countToUse) /* You allocated enough space for countToUse int's */\n    {\n        int currInt;\n\n        if (fscanf(fp, \"%d\", &amp;currInt) == 1)\n            integers[i] = currInt;\n        else\n            break;\n    }\n    else\n        break;\n}\n</code></pre>\n\n<p>there is of course a better way of doing this, by making the loop from <code>0</code> to <code>countToUse</code>, but I just wanted to point out what was wrong with your code.</p>\n\n<p>These tips should help you improve your skills, which as far as I can see, are good</p>\n\n<ol>\n<li><p>Always check the returned values from functions for errors, for example <code>malloc()</code> returns <code>NULL</code> on failure, and you didn't check for it.</p>\n\n<p>It's very unlikely that this will happen, but it's not impossible, so it is wise to check.</p></li>\n<li><p>Use compiler warnings, they help you with those small mistakes that are dificult to see normally.</p></li>\n<li><p>When using <code>valgrind</code> compile your program with debugging info and without optimization, as pointed out by @JohnBollinger that will help you know at what exact line the problem is.</p>\n\n<p>This is a typical compiler command that I use\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>gcc -Wall -Wextra -Werror -O0 -g3\n</code></pre>\n\n<p>when debugging it's an excelent way of preventing stupid mistakes, you can also add <code>std=c99</code> if you care about portability and <code>-pedantic</code> if you really want to purify your code.</p></li>\n</ol>\n"}], "owner": {"reputation": 377, "user_id": 4276197, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a342f474a7ce542c1e5c9d77737e5f9f?s=128&d=identicon&r=PG&f=1", "display_name": "JayB", "link": "https://stackoverflow.com/users/4276197/jayb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1401, "favorite_count": 0, "accepted_answer_id": 28465103, "answer_count": 1, "score": -2, "last_activity_date": 1423695295, "creation_date": 1423690677, "last_edit_date": 1423694500, "question_id": 28464994, "link": "https://stackoverflow.com/questions/28464994/invalid-read-of-size-4-on-fscanf", "title": "Invalid read of size 4 on fscanf", "body": "<p>Running my program through valgrind, I'm getting an invalid read of size 4 error in the following code (I think at the line where fscanf is called)</p>\n\n<p><strong>Important Info</strong>: <code>numIntegers</code> is the maximum number of integers that can be read, while <code>numsInFile</code> specifies the amount of integers present in the file. </p>\n\n<p>I use the minimum of the two to initialize the array. The reason for this is because if <code>numIntegers</code> is <code>100</code> and there are <code>22</code> integers in the file, I only want an array of size <code>22</code>.  If numIntegers is <code>22</code> and there are <code>100</code> integers in the file, I still want an array of size <code>22</code> since only <code>22</code> can be read.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>// Get number of integers (first number)\nint numsInFile;\nfscanf(fp, \"%d\", &amp;numsInFile);\n\n// find minimum of numstoread and numintegers and use that as counttouse\n    if(numsInFile &lt; numIntegers)\n        countToUse = numsInFile;\n    else\n        countToUse = numIntegers;\n\n// Initialize the integers array with the minimum value as well - since it will only store this many\nintegers = malloc(sizeof(int) * countToUse);\n\nfor(int i = 0; i &lt; numsInFile; i++){\n    if(i &lt; numIntegers){\n        int currInt;\n        if(fscanf(fp, \"%d\", &amp;currInt) == 1)\n            integers[i] = currInt;\n        else\n            break;\n    }\n    else\n        break;\n}\n</code></pre>\n\n<p>Any help is appreciated ahead of time. I can't for the life of me figure out why I'm getting this error in valgrind...</p>\n\n<h2>Code edited - No more errors</h2>\n\n<pre><code>// Get number of integers (first number)\nint numsInFile;\nif( fscanf(fp, \"%d\", &amp;numsInFile) != 1)\n    fprintf(stderr, \"Error reading number of integers(first number) from file. Exiting.\\n\");\n    exit(1);\n}\n\n// find minimum of numstoread and numintegers and use that as counttouse\n    if(numsInFile &lt; numIntegers)\n        countToUse = numsInFile;\n    else\n        countToUse = numIntegers;\n\n// Initialize the integers array with the minimum value as well - since it will only store this many\nintegers = malloc(sizeof(int) * countToUse);\n\nfor(int i = 0; i &lt; countToUse; i++){\n    int currInt;\n    if(fscanf(fp, \"%d\", &amp;currInt) == 1)\n        integers[i] = currInt;\n    else{\n        fprintf(stderr, \"Error loading integer array in countAndSort(). Exiting.\\n\");\n        exit(1);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "file", "scanf"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690064, "post_id": 28464615, "comment_id": 45255325, "body": "You must check that you are really scanning the values, in short check the return value of <code>fscanf()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690113, "post_id": 28464735, "comment_id": 45255360, "body": "first, your <code>fscanf()</code> is wrong, second it will be wrong when you fix it because you don&#39;t check for it&#39;s return value, which is there for a reason, don&#39;t you think?"}, {"owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690404, "post_id": 28464735, "comment_id": 45255503, "body": "Missed the <code>FILE</code> pointer. My bad. Also mentioned in the comments how the code is limited."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690497, "post_id": 28464735, "comment_id": 45255548, "body": "you didn&#39;t think of a c++ compiler, sometimes they use them without knowing that <code>c++ != c</code>."}, {"owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690640, "post_id": 28464735, "comment_id": 45255621, "body": "A C++ compiler should compile the declarations of variables inside the for loop just fine I suppose?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423690654, "post_id": 28464735, "comment_id": 45255631, "body": "Yes that&#39;s what I mean."}, {"owner": {"reputation": 151, "user_id": 3504410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/778838078/picture?type=large", "display_name": "user3504410", "link": "https://stackoverflow.com/users/3504410/user3504410"}, "edited": false, "score": 0, "creation_date": 1423693277, "post_id": 28464735, "comment_id": 45257038, "body": "hey thanks for the response, but it looks like this is doing both the row and column check at once? My program must be multithreaded, with the row and column checks creating their own threads, which is why I need to scan this way."}], "tags": [], "owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "is_accepted": false, "score": 3, "last_activity_date": 1423690616, "last_edit_date": 1423690616, "creation_date": 1423689631, "answer_id": 28464735, "question_id": 28464615, "link": "https://stackoverflow.com/questions/28464615/how-do-i-scan-certain-characters-from-a-file/28464735#28464735", "title": "How do I scan certain characters from a file", "body": "<p>Since it is a sudoku validator, create a 9 * 9 2D array and read row wise much like you are doing. Then loop through either row wise or column wise to validate your sudoku square.</p>\n\n<pre><code>// As pointed out in comments, this code assumes you have a minimum of 9*9 separated ints with width = 1.\n// If not, you need to check whether fscanf failed or not.\nint sudoku[9][9] ;\nfor(int i = 0; i &lt; 9; ++i)\n    for(int j = 0; j &lt; 9; ++j)\n        fscanf(file_ptr, \"%1d\", &amp;sudoku[i][j]); /* Check for the return value \n                                                 * of fscanf if it is not\n                                                 * guaranteed that there \n                                                 * will always be 81 elements \n                                                 * to read from or some other \n                                                 * error occurred while \n                                                 * reading the file.\n                                                 */\n\n// now use sudoku to verify.\nfor(int i = 0; i &lt; 9; ++i)\n    for(int j = 0; j &lt; 9; ++j)\n    {\n        // sudoku[i][j] is row wise.\n        // sudoku[j][i] is column wise.\n    }\n</code></pre>\n\n<p>I am assuming you are using C99 or up compiler. If it is C89, you need to move the <code>int i</code> and <code>int j</code> declarations at the beginning of the function (outside the loop).</p>\n"}, {"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": false, "score": 0, "last_activity_date": 1423690924, "creation_date": 1423690924, "answer_id": 28465066, "question_id": 28464615, "link": "https://stackoverflow.com/questions/28464615/how-do-i-scan-certain-characters-from-a-file/28465066#28465066", "title": "How do I scan certain characters from a file", "body": "<p>Evade all the counting and skipping and read as single characters, with a simple filter. After all, you are only interested in the 81 digits from <code>1</code> to <code>9</code>, which will <em>always</em> appear in the correct order -- no matter what other formatting or neatification is in place. If you also include the <code>0</code> or <code>.</code> for unknown cells, you can read formats such as this</p>\n\n<pre><code>1..|...|7..\n.2.|...|5..\n6..|38.|...\n-----------\n.78|...|...\n...|6.9|...\n...|...|14.\n-----------\n...|.25|..9\n..3|...|.6.\n..4|...|..2\n</code></pre>\n\n<p>and also this</p>\n\n<pre><code>000605000003020800045090270500000001062000540400000007098060450006040700000203000\n</code></pre>\n\n<p>(examples picked randomly from <a href=\"http://www.sudocue.net/fileformats.php\" rel=\"nofollow\">http://www.sudocue.net/fileformats.php</a>)</p>\n"}], "owner": {"reputation": 151, "user_id": 3504410, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/778838078/picture?type=large", "display_name": "user3504410", "link": "https://stackoverflow.com/users/3504410/user3504410"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423690924, "creation_date": 1423689259, "question_id": 28464615, "link": "https://stackoverflow.com/questions/28464615/how-do-i-scan-certain-characters-from-a-file", "title": "How do I scan certain characters from a file", "body": "<p>I am currently working on a sudoku validator, and the way I am doing it is to separate each row into an array of length 9 and check, separate each column into an array of length 9 and check, etc. I have done the rows already doing something like this</p>\n\n<pre><code>         for( i=0; i&lt;9; i++)\n        fscanf(file, \"%1d\", &amp;row1[i]);\n          for( i=0; i&lt;9; i++)\n        fscanf(file, \"%1d\", &amp;row2[i]);\n          for( i=0; i&lt;9; i++)\n        fscanf(file, \"%1d\", &amp;row3[i]);\n          for( i=0; i&lt;9; i++)\n        fscanf(file, \"%1d\", &amp;row4[i]);\n</code></pre>\n\n<p>and it works the way I want it too.</p>\n\n<p>I have each number in my sudoku solution separated by a space horizontally and next to each other vertically in my file.</p>\n\n<p>However, I am having trouble trying to scan each column into an array. Basically what I think I need to do is for the first column start at the first (top-left) character and store that into the first slot of my array. Then I need to skip 9 characters and then store that character.</p>\n\n<p>I thought I could do something similar like </p>\n\n<pre><code>         for( i=0; i&lt;82; i += 9)\n        fscanf(file, \"%1d\", &amp;col1[i]);\n          for( i=1; i&lt;82; i+=9)\n        fscanf(file, \"%1d\", &amp;col2[i]);\n          for( i=2; i&lt;82; i+=9)\n        fscanf(file, \"%1d\", &amp;col3[i]);\n          for( i=3; i&lt;82; i+=9)\n        fscanf(file, \"%1d\", &amp;col4[i]);\n          for( i=4; i&lt;82; i+=9)\n</code></pre>\n\n<p>but I realized it didn't work because I had set my array to size 9 and since i was inserting into the ith value in the array this would not behave like it wanted.</p>\n\n<p>Can anyone give me a suggestion how I could implement this? I think it is fairly trivial but I am having serious trouble wrapping my head around it.</p>\n\n<p>Thanks</p>\n\n<p>Edit: I also need to do this for the region, so i'm basically looking for a way to skip through a file and store only certain characters that I want. </p>\n"}, {"tags": ["c", "json", "cgi", "cjson"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4462642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599ced1e57c02b66b6b9ddece834f63c?s=128&d=identicon&r=PG&f=1", "display_name": "KGB", "link": "https://stackoverflow.com/users/4462642/kgb"}, "edited": false, "score": 0, "creation_date": 1423766698, "post_id": 28466616, "comment_id": 45292457, "body": "Thanks for the reply, I tried running the first piece of code you posted on my linux machine and sure enough everything ran as expected. However when I added the line <code>printf(&quot;Content-Type: application&#47;json\\n\\n&quot;);</code> and attempted to run it on the system I had originally been running the program on (a Cubox) I get the same incorrect output I had before. This leads me to believe that the code is actually correct and the problem is being caused by some other factor related to the Cubox and how it&#39;s set up."}], "tags": [], "owner": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "is_accepted": true, "score": 0, "last_activity_date": 1423697374, "creation_date": 1423697374, "answer_id": 28466616, "question_id": 28464475, "link": "https://stackoverflow.com/questions/28464475/first-number-in-json-parsed-with-cjson-is-always-0/28466616#28466616", "title": "First number in JSON parsed with CJSON is always 0", "body": "<p>It is difficult to know without knowing how URLDecode works, or what are the original contents of pcReq after it is retrieved from the environment. I would start from running this code without the web, to test cJSON as a small unit, and that would probably shed light on what is going wrong.</p>\n\n<p>First, to help us understand your code, in the code below:</p>\n\n<pre><code>pstReq = cJSON_Parse(pstReq);\n</code></pre>\n\n<p>I think that you meant:</p>\n\n<pre><code>pstReq = cJSON_Parse(pcReq);\n</code></pre>\n\n<p>With that in mind, I would run first this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"cJSON.h\"\n\nint main(int argc, char *argv[])\n{\n    cJSON *pstReq;\n\n    char *pcReq = \"{\\\"test\\\":123, \\\"test2\\\":123}\";\n    pstReq = cJSON_Parse(pcReq);\n\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test\")-&gt;valueint);\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test2\")-&gt;valueint);\n    printf(\"%s\\n\",cJSON_Print(pstReq));\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>This works as expected for me.</p>\n\n<p>If this produces the right output for you too, I would add printf()'s to see what is contained in pcReq before and after URLDecode(). The problem might come from 'pcReq' itself. So in short this would be the code that might give you an idea of where the problem is:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    cJSON *pstReq;\n    char *pcReq = getenv(\"QUERY_STRING\");\n\n    printf(\"Content-Type: application/json\\n\\n\");\n\n    printf (\"=== pcReq before decoding ===\\n\");\n    printf(\"%s\\n\",pcReq);\n    printf (\"=============================\\n\");\n\n    URLDecode(pcReq); /* Decodes the query string to JSON string */\n\n    printf (\"=== pcReq after decoding ===\\n\");\n    printf(\"%s\\n\",pcReq);\n    printf (\"=============================\\n\");\n\n    pstReq = cJSON_Parse(pcReq);\n\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test\")-&gt;valueint);\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test2\")-&gt;valueint);\n    printf(\"%s\\n\",cJSON_Print(pstReq));\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>I hope this helps to find the problem.</p>\n"}], "owner": {"reputation": 3, "user_id": 4462642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599ced1e57c02b66b6b9ddece834f63c?s=128&d=identicon&r=PG&f=1", "display_name": "KGB", "link": "https://stackoverflow.com/users/4462642/kgb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 28466616, "answer_count": 1, "score": 0, "last_activity_date": 1548726550, "creation_date": 1423688766, "last_edit_date": 1548726550, "question_id": 28464475, "link": "https://stackoverflow.com/questions/28464475/first-number-in-json-parsed-with-cjson-is-always-0", "title": "First number in JSON parsed with CJSON is always 0", "body": "<p>I'm trying to parse a JSON file received by a CGI file on a webserver using cJSON however the first number in the JSON keeps getting changed to 0.</p>\n\n<p>I've made a short piece of code which I'm using to test this:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    cJSON *pstReq;\n    char *pcReq = getenv(\"QUERY_STRING\");\n\n    printf(\"Content-Type: application/json\\n\\n\");\n\n    URLDecode(pcReq) /* Decodes the query string to JSON string */\n    pstReq = cJSON_Parse(pstReq);\n\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test\")-&gt;valueint);\n    printf(\"%d\\n\", cJSON_GetObjectItem(pstReq, \"test2\")-&gt;valueint);\n    printf(cJSON_Print(pstReq));\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Passing the JSON {\"test\":123, \"test2\":123} into this through the query string causes the program to output this:</p>\n\n<pre><code>0\n123\n{\"test\":0, \"test2\":123}\n</code></pre>\n\n<p>I have absolutely no idea what I'm doing wrong here if anybody could give me some idea of what the problem might be I'd greatly appreciate it.</p>\n"}, {"tags": ["c++", "c", "memory", "libraries"], "answers": [{"comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1423688743, "post_id": 28464411, "comment_id": 45254632, "body": "@pm100 it&#39;s perfectly well-defined. All what&#39;s required by the standards is what&#39;s written here. On Stack Overflow, we don&#39;t provide &quot;of course it just works&quot; answers. Asserting that is actually very rude."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1423688891, "post_id": 28464411, "comment_id": 45254698, "body": "so some part of the c++ standard say the the result of new is identical to the result of malloc (apart from the constructor invokation side-effect)"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1423688962, "post_id": 28464411, "comment_id": 45254728, "body": "@pm100: In a way, yes. It&#39;s in the same memory space (as proven by the fact that both <code>new</code> and <code>malloc</code> can create pointers of type <code>T*</code>)."}], "tags": [], "owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "is_accepted": true, "score": 10, "last_activity_date": 1423689117, "last_edit_date": 1423689117, "creation_date": 1423688469, "answer_id": 28464411, "question_id": 28464397, "link": "https://stackoverflow.com/questions/28464397/is-it-safe-to-pass-memory-allocated-using-new-to-c-libraries/28464411#28464411", "title": "Is it safe to pass memory allocated using &quot;new&quot; to C libraries?", "body": "<p>Memory is memory, and it does not matter how it was allocated.</p>\n\n<p>As long as you're matching <code>new</code> with <code>delete</code>, <code>new[]</code> with <code>delete[]</code> and <code>malloc</code>/<code>calloc</code> with <code>free</code> (also <code>realloc</code>), you're okay.</p>\n\n<p>If you think about it, even C allocates memory in different places, and it works fine --- if a library expects an <code>int</code>, you can allocate it either on the stack, or on the heap (or in some global storage):</p>\n\n<pre><code>int a;\nint* b = malloc(sizeof(int));\nstatic int c;\n\nsome_func(&amp;a);\nsome_func(b);\nsome_func(&amp;c);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 7, "last_activity_date": 1423688531, "creation_date": 1423688531, "answer_id": 28464419, "question_id": 28464397, "link": "https://stackoverflow.com/questions/28464397/is-it-safe-to-pass-memory-allocated-using-new-to-c-libraries/28464419#28464419", "title": "Is it safe to pass memory allocated using &quot;new&quot; to C libraries?", "body": "<blockquote>\n  <p>Does that mean that I should avoid using new for memory that will be used by a C library?</p>\n</blockquote>\n\n<p>Not at all. The memory is the same, so if you provide a safe way to deallocate the memory, you can definitely pass that memory to a C library.</p>\n\n<pre><code>int *p = new int(42);\nlib_func(p);\ndelete p;\n</code></pre>\n\n<p>Here is another example:</p>\n\n<pre><code>extern \"C\" {\n    int* make_buffer(size_t sz) {\n        return new int[sz];\n    }\n    void use_buffer(int* buf) {\n        ... // do something\n    }\n    void free_buffer(int* buf) {\n        delete[] buf;\n    }\n}\n</code></pre>\n\n<p>The code above lets your C code request dynamically allocated memory from your C++ library.</p>\n"}, {"tags": [], "owner": {"reputation": 8889, "user_id": 4538344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746edd669e07914179feb9f6957a06e3?s=128&d=identicon&r=PG", "display_name": "StenSoft", "link": "https://stackoverflow.com/users/4538344/stensoft"}, "is_accepted": false, "score": 4, "last_activity_date": 1423688561, "creation_date": 1423688561, "answer_id": 28464423, "question_id": 28464397, "link": "https://stackoverflow.com/questions/28464397/is-it-safe-to-pass-memory-allocated-using-new-to-c-libraries/28464423#28464423", "title": "Is it safe to pass memory allocated using &quot;new&quot; to C libraries?", "body": "<p>It is memory as any other so it is safe as long as the C library does not <code>free</code> it.</p>\n\n<p>Note that in your example, you can also use memory on stack which has no allocation or deallocation functions:</p>\n\n<pre><code>void func()\n{\n    int p;\n    lib_func(&amp;p);\n}\n</code></pre>\n"}], "owner": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 28464411, "answer_count": 3, "score": 4, "last_activity_date": 1423689117, "creation_date": 1423688408, "question_id": 28464397, "link": "https://stackoverflow.com/questions/28464397/is-it-safe-to-pass-memory-allocated-using-new-to-c-libraries", "title": "Is it safe to pass memory allocated using &quot;new&quot; to C libraries?", "body": "<p>I know that <code>new</code> <code>delete</code> are incombatible with <code>malloc</code> <code>free</code>.</p>\n\n<p>Does that mean that I should avoid using <code>new</code> for memory that will be used by a C library?</p>\n\n<p>What are things that can go wrong when using <code>new</code> instead of <code>malloc</code> when I will pass the memory to a C library?</p>\n\n<pre><code>void func()\n{\n    int *p = new int(42);\n\n    // Should I insist on using malloc for p if this function is a part\n    // of a C library?\n    lib_func(p);\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "centos", "mqueue"], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 4547387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114e640cd37b0ff3745462e72a54cd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie C", "link": "https://stackoverflow.com/users/4547387/charlie-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1423689798, "creation_date": 1423689798, "answer_id": 28464782, "question_id": 28464385, "link": "https://stackoverflow.com/questions/28464385/posix-message-queues-qsize-query/28464782#28464782", "title": "Posix Message Queues QSIZE Query", "body": "<p>I believe the message queue stores some bookkeeping information within the file. From the <code>mq_overview()</code> man page:</p>\n\n<blockquote>\n  <p>The contents of each file in the directory consist of a single line\n        containing information about the queue:</p>\n\n<pre><code>       $ cat /dev/mqueue/mymq\n       QSIZE:129     NOTIFY:2    SIGNO:0    NOTIFY_PID:8260\n</code></pre>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man7/mq_overview.7.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man7/mq_overview.7.html</a></p>\n"}], "owner": {"reputation": 31, "user_id": 4556596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bac84ef071fbecac440a3fe31c002960?s=128&d=identicon&r=PG&f=1", "display_name": "John Duffy", "link": "https://stackoverflow.com/users/4556596/john-duffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423689798, "creation_date": 1423688346, "last_edit_date": 1423688750, "question_id": 28464385, "link": "https://stackoverflow.com/questions/28464385/posix-message-queues-qsize-query", "title": "Posix Message Queues QSIZE Query", "body": "<p>When I examine the QSIZE of a message queue using \"cat /dev/mqueue/myqueue\" before and after doing a mq_send()/mq_receive() there appears to be some residual bytes left on the queue after the mq_recieve(). My little test program is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include &lt;mqueue.h&gt;\n\n\n#define MSG_LEN 8192 // As per mq_msgsize as returned by mq_getattr() on CentOS 7 x86_64 \n\n\nint main(void)\n{\n    mqd_t mq;\n\n\n    /* Create a message queue */\n    if ((mq = mq_open(\"/myqueue\", O_RDWR|O_NONBLOCK|O_CREAT|O_EXCL, S_IRUSR|S_IWUSR, NULL)) == -1) {\n        perror(\"Error calling mq_open()\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    /* Create a message */\n\n    char msg[MSG_LEN] = {\" \"};\n\n    int msglen = snprintf(msg, MSG_LEN, \"Hello, World!\"); // msglen is 13 without the terminating '\\0' \n\n    if (msglen &lt; 0) {\n        fprintf(stderr, \"Error calling snprintf()\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    /*\n     * QSIZE here using \"cat /dev/mqueue/myqueue\" is: 0\n     * OK\n     */\n\n\n    /* Send the message */\n\n    if (mq_send(mq, msg, msglen + 1, 1) == -1) { // add 1 to msglen for the termining '\\0'\n        perror(\"Error calling mq_send()\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    /*\n     * QSIZE here using \"cat /dev/mqueue/myqueue\" is: 62\n     * Why not 14?\n     */\n\n\n    /* Receive the message */\n\n    if (mq_receive(mq, msg, MSG_LEN, NULL) == -1) {\n        perror(\"Error calling mq_receive()\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    /*\n     * QSIZE here using \"cat /dev/mqueue/myqueue\" is: 48\n     * Why not 0?\n     */\n\n\n    exit(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I don't understand why 62 bytes are initially put onto the queue, and a residual of 48 bytes is left behind after sending and receiving a 14 byte message. Any help would be much appreciated.</p>\n\n<p>Kind regards</p>\n\n<p>John Duffy</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "reply_to_user": {"reputation": 1290, "user_id": 3227815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/932904f6217c372e891e1a36631019f1?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/3227815/katie"}, "edited": false, "score": 0, "creation_date": 1423687707, "post_id": 28464164, "comment_id": 45254088, "body": "no that doesn&#39;t work"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423687712, "post_id": 28464164, "comment_id": 45254094, "body": "Copy the <code>\\0</code> character as well"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423687816, "post_id": 28464164, "comment_id": 45254166, "body": "What the ... is &quot;produced a pointer&quot; ???"}, {"owner": {"reputation": 1290, "user_id": 3227815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/932904f6217c372e891e1a36631019f1?s=128&d=identicon&r=PG&f=1", "display_name": "Katie", "link": "https://stackoverflow.com/users/3227815/katie"}, "edited": false, "score": 0, "creation_date": 1423687851, "post_id": 28464164, "comment_id": 45254185, "body": "Can we see a copy of your complete code that causes this problem, preferably stripped down to a nice short main()? The behavior you&#39;re describing doesn&#39;t make sense, so there may be a bug in the rest of your code that you&#39;ve overlooked."}, {"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "edited": false, "score": 0, "creation_date": 1423687853, "post_id": 28464164, "comment_id": 45254188, "body": "copy the &#39;\\0&#39; character as well? what difference would that make? the point is that the array acts as a pointer, I want to be able to modify the array, and that code does copy &#39;\\0&#39; as well"}, {"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "edited": false, "score": 0, "creation_date": 1423687877, "post_id": 28464164, "comment_id": 45254203, "body": "okay pasting the code"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 8, "creation_date": 1423687889, "post_id": 28464164, "comment_id": 45254213, "body": "Strcpy works fine. Just <code>strcpy(help, one + 10);</code>."}, {"owner": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "edited": false, "score": 0, "creation_date": 1423688014, "post_id": 28464164, "comment_id": 45254278, "body": "Yep, the <code>strcpy()</code> approach works fine (as would the above loop, after fixing a syntax error or two): <a href=\"https://ideone.com/Xam0OC\" rel=\"nofollow noreferrer\">ideone.com/Xam0OC</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423688072, "post_id": 28464164, "comment_id": 45254302, "body": "Right, misunderstood the question. But it still make a little sense."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1423688099, "post_id": 28464164, "comment_id": 45254318, "body": "From everything I just read (and I had to read some of the phrases twice due to mild bewilderment), my only advice is to stop thinking you know what you&#39;re talking about regarding pointers and arrays in C. Study them (again)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1423688171, "post_id": 28464164, "comment_id": 45254355, "body": "&quot;char help will get the last two chars but still acts as a pointer so if go <code>char help[1] = z;</code> the original string becomes &#39;1234567890az&#39;&quot;.  Sorry, I do not believe you."}, {"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "edited": false, "score": 0, "creation_date": 1423688225, "post_id": 28464164, "comment_id": 45254379, "body": "whozCraig I know about pointers believe me. What part of my explanation did not make sense to you?"}, {"owner": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "edited": false, "score": 1, "creation_date": 1423688261, "post_id": 28464164, "comment_id": 45254398, "body": "A (fixed, compilable) version of the loop in the question, which also works as expected: <a href=\"https://ideone.com/j0Abfg\" rel=\"nofollow noreferrer\">ideone.com/j0Abfg</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423688269, "post_id": 28464164, "comment_id": 45254403, "body": "Prove with a working example. Better with ideone.com"}, {"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "edited": false, "score": 0, "creation_date": 1423688340, "post_id": 28464164, "comment_id": 45254436, "body": "thanks paul maybe then there is something else wrong with my code, at least you could unterstand the question, unlike some arrogant people here, who love to blame before they read"}], "answers": [{"tags": [], "owner": {"reputation": 42694, "user_id": 1175077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AWgLI.jpg?s=128&g=1", "display_name": "jpw", "link": "https://stackoverflow.com/users/1175077/jpw"}, "is_accepted": false, "score": 2, "last_activity_date": 1423688265, "creation_date": 1423688265, "answer_id": 28464366, "question_id": 28464164, "link": "https://stackoverflow.com/questions/28464164/copying-the-tail-part-of-a-string-into-another-array-in-c-no-reference-no-point/28464366#28464366", "title": "copying the tail part of a string into another array in C, no reference no pointers", "body": "<p><code>strcpy</code> is indeed the way to go. This code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n\n    char *one = \"1234567890ab\";\n    char two[10];\n\n    strcpy(two, one + 10);\n    two[1] = 'z';\n\n    printf(\"one: %s\\n\", one);\n    printf(\"two: %s\\n\", two);\n\n    return 0;\n}\n</code></pre>\n\n<p>will generate this output:</p>\n\n<pre><code>one: 1234567890ab\ntwo: az\n\nSuccess time: 0 memory: 2008 signal:0\n</code></pre>\n\n<p>See this <a href=\"http://ideone.com/kD8Rcb\" rel=\"nofollow\">example</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "edited": false, "score": 0, "creation_date": 1423688523, "post_id": 28464369, "comment_id": 45254530, "body": "yeah there is something else wrong, still cannot find what it is, but thanks"}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 2, "last_activity_date": 1423688273, "creation_date": 1423688273, "answer_id": 28464369, "question_id": 28464164, "link": "https://stackoverflow.com/questions/28464164/copying-the-tail-part-of-a-string-into-another-array-in-c-no-reference-no-point/28464369#28464369", "title": "copying the tail part of a string into another array in C, no reference no pointers", "body": "<p><code>strcpy</code> cannot \u201cproduce a pointer [to <code>one</code>]\u201d out of <code>help</code> when <code>help</code> is defined as an array of <code>char</code>. It is independent of the original string. There is an error somewhere else in your code, but at the moment you are not showing enough code to tell what it is. However, the following code:</p>\n\n<pre><code>char *one = \"1234567890ab\";\nchar help[10];\n(void) strcpy(help, one + 10);\n(void) printf(\"one = %s\\nhelp = %s\\n\", one, help);\nhelp[1] = 'z';\n(void) printf(\"one = %s\\nhelp = %s\\n\", one, help);\n</code></pre>\n\n<p>Produces the output:</p>\n\n<pre><code>one = 1234567890ab\nhelp = ab\none = 1234567890ab\nhelp = az\n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 3813966, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/39b5eb85b99c515e14417623306c3b39?s=128&d=identicon&r=PG&f=1", "display_name": "Mcs", "link": "https://stackoverflow.com/users/3813966/mcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 28464369, "answer_count": 2, "score": -3, "last_activity_date": 1423688273, "creation_date": 1423687598, "last_edit_date": 1423688153, "question_id": 28464164, "link": "https://stackoverflow.com/questions/28464164/copying-the-tail-part-of-a-string-into-another-array-in-c-no-reference-no-point", "title": "copying the tail part of a string into another array in C, no reference no pointers", "body": "<p>let' say I have</p>\n\n<pre><code>char *one = \"1234567890ab\"\n</code></pre>\n\n<p>I want would like to copy everything after the 10th char into another array in C. But I would like to copy it, I do not want a pointer pointing to it, so that if I modify the array holding \"ab\", nothing happens to the original one.</p>\n\n<p>if I do something like:</p>\n\n<pre><code>char help[10];\nfor(i=0; ((char help[i] = *(one + n + i)) != '\\0'; ++i);\n</code></pre>\n\n<p>char help will get the last two chars but still acts as a pointer so if go</p>\n\n<pre><code>char help[1] = 'z';\n</code></pre>\n\n<p>the original string becomes </p>\n\n<pre><code>\"1234567890az\"\n</code></pre>\n\n<p>how can I prevent this from happening thank you</p>\n\n<p>edit: I tried strcpy and it did not work, still produced a pointer.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6932, "user_id": 3476191, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pJGHG.png?s=128&g=1", "display_name": "NobodyNada", "link": "https://stackoverflow.com/users/3476191/nobodynada"}, "edited": false, "score": 2, "creation_date": 1423687374, "post_id": 28464073, "comment_id": 45253890, "body": "You mean the <code>free</code> function?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 4, "creation_date": 1423687413, "post_id": 28464073, "comment_id": 45253908, "body": "The <code>argv</code> second argument to <code>main</code> is <i>not</i> made of <code>malloc</code>-ed stuff, but of data sitting on the stack (of the <code>execve</code>-d process); it might be <code>malloc</code>-ed by your code in the <i>parent</i> process (your shell)."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1423688140, "post_id": 28464073, "comment_id": 45254339, "body": "You can only free what you yourself have malloc&#39;ed."}], "answers": [{"tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": true, "score": 1, "last_activity_date": 1423687878, "last_edit_date": 1423687878, "creation_date": 1423687704, "answer_id": 28464196, "question_id": 28464073, "link": "https://stackoverflow.com/questions/28464073/free-memory-that-may-be-mallocd-for-the-name-and-argv-fields/28464196#28464196", "title": "Free memory that may be malloc&#39;d for the name and argv fields", "body": "<p>1) free (p_cmd);</p>\n\n<p>2) p_cmd = NULL;</p>\n\n<p>E.g.:</p>\n\n<pre><code>  void cleanup( command_t* p_cmd )\n  {\n      if( p_cmd )\n      {\n          free (p_cmd);\n          p_cmd = NULL;\n      }\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3934120, "user_type": "registered", "profile_image": "https://graph.facebook.com/745805934/picture?type=large", "display_name": "Marcus Baker", "link": "https://stackoverflow.com/users/3934120/marcus-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1423695985, "creation_date": 1423695985, "answer_id": 28466311, "question_id": 28464073, "link": "https://stackoverflow.com/questions/28464073/free-memory-that-may-be-mallocd-for-the-name-and-argv-fields/28466311#28466311", "title": "Free memory that may be malloc&#39;d for the name and argv fields", "body": "<p>This is the naive answer. It assumes that command was allocated with a single <code>malloc()</code> or <code>strdup()</code>...</p>\n\n<pre><code>void cleanup(command_t *command) {\n    free(command);\n}\n</code></pre>\n\n<p>As a matter of style I would call your function something like <code>free_command()</code> or <code>destroy_command()</code> and keep it near to the functions that allocates the memory in the first place. E.g...</p>\n\n<pre><code>typedef char command_t;\n\ncommand_t *create_command_from_stdin(int line_length) {\n    command_t *command = malloc(line_length + 1);\n    fgets(command, line_length, stdin);\n    command[line_length] = '\\0';\n    return command;\n}\n\nvoid free_command(command_t *command) {\n    free(command);\n}\n</code></pre>\n\n<p>You cannot free something twice without trouble. If you fail to free something <code>malloc()</code>'d then you get a memory leak. To avoid this, you often keep the create and free functions in the same scope so you don't lose track of them...</p>\n\n<pre><code>void shell(void) {\n    while(true) {\n        command_t *command = create_command(80);\n        do_something_with_command(command);\n        do_insane_things_with_command(command);\n        free_command(command);\n    }\n}\n\nvoid do_something_with_command(const command_t *command) { ... }\n\nvoid do_insane_things_with_command(const command_t *command) { ... }\n</code></pre>\n\n<p>The <code>const</code> tag will protect you from accidently freeing them inside the functions and also acts as a hint to others that these functions do not take ownership of the command. That is, they do not take on the responsibility of freeing the memory.</p>\n\n<p>yours, Marcus</p>\n"}], "owner": {"reputation": 19, "user_id": 4526590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7194c9159739714b39a4410f29c258a?s=128&d=identicon&r=PG&f=1", "display_name": "Rand3m", "link": "https://stackoverflow.com/users/4526590/rand3m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 28464196, "answer_count": 2, "score": -2, "last_activity_date": 1423695985, "creation_date": 1423687255, "last_edit_date": 1423687861, "question_id": 28464073, "link": "https://stackoverflow.com/questions/28464073/free-memory-that-may-be-mallocd-for-the-name-and-argv-fields", "title": "Free memory that may be malloc&#39;d for the name and argv fields", "body": "<pre><code>void cleanup( command_t* p_cmd ){\n}\n</code></pre>\n\n<p>Basically i need to find a way to free up space that has been <code>malloc</code> in C. I am new to c and working on a basic shell.</p>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423686930, "post_id": 28463969, "comment_id": 45253651, "body": "Well, you have that <code>typedef struct coords * coordPtr</code> --- that&#39;s definitely not correct C."}, {"owner": {"reputation": 1513, "user_id": 2556354, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d17ecb069c4cf3205de82341203f9525?s=128&d=identicon&r=PG", "display_name": "madz", "link": "https://stackoverflow.com/users/2556354/madz"}, "edited": false, "score": 0, "creation_date": 1423687013, "post_id": 28463969, "comment_id": 45253692, "body": "have you tried:  typedef struct _coords {   int x = -1;   int y = -1;   struct _coords * next; } coords;"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 4, "creation_date": 1423687018, "post_id": 28463969, "comment_id": 45253697, "body": "This is a simple misunderstanding of C syntax: <code>* coordPtr</code> go after the body of the <code>struct</code>, not before it. Voting to close as a typo."}], "answers": [{"comments": [{"owner": {"reputation": 233, "user_id": 3829538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Xn7si.jpg?s=128&g=1", "display_name": "Ian Pennebaker", "link": "https://stackoverflow.com/users/3829538/ian-pennebaker"}, "edited": false, "score": 0, "creation_date": 1423687453, "post_id": 28463993, "comment_id": 45253928, "body": "I switched it and removed the default initializers and am still getting the same errors"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 233, "user_id": 3829538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Xn7si.jpg?s=128&g=1", "display_name": "Ian Pennebaker", "link": "https://stackoverflow.com/users/3829538/ian-pennebaker"}, "edited": false, "score": 0, "creation_date": 1423687782, "post_id": 28463993, "comment_id": 45254143, "body": "@IanPennebaker see my edit"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": true, "score": 5, "last_activity_date": 1423687744, "last_edit_date": 1423687744, "creation_date": 1423686947, "answer_id": 28463993, "question_id": 28463969, "link": "https://stackoverflow.com/questions/28463969/expected-identifier-c/28463993#28463993", "title": "Expected Identifier - C", "body": "<pre><code>typedef struct coords * coordPtr\n{\n  int x = -1;\n  int y = -1;\n  struct coords * next;\n};\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>typedef struct coords \n{\n  int x;\n  int y;\n  struct coords * next;\n} *coordPtr;\n</code></pre>\n\n<p>The type alias has to come last. Also you cannot provide default initializers in a struct declaration.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Also in your program, you make use of two type aliases:  <code>coords</code> and <code>coordPtr</code>. If you want to also use <code>coords</code>, you also need:</p>\n\n<pre><code>typedef struct coords coords;\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 3829538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Xn7si.jpg?s=128&g=1", "display_name": "Ian Pennebaker", "link": "https://stackoverflow.com/users/3829538/ian-pennebaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "closed_date": 1423690737, "accepted_answer_id": 28463993, "answer_count": 1, "score": -1, "last_activity_date": 1423687744, "creation_date": 1423686874, "question_id": 28463969, "link": "https://stackoverflow.com/questions/28463969/expected-identifier-c", "closed_reason": "Not suitable for this site", "title": "Expected Identifier - C", "body": "<p>I am having an issue with structs. Before each function declaration I get an error about an identifier. Errors occur before 'typedef', 'coords stackCreate', and 'coords stackPush' </p>\n\n<pre><code>typedef struct coords * coordPtr\n{\n  int x = -1;\n  int y = -1;\n  struct coords * next;\n};\n\ncoords stackCreate(int x, int y){\n  coordPtr stack = malloc(sizeof(coords));\n  stack-&gt;x = x;\n  stack-&gt;y = y;\n  return stack;\n}\n\ncoords stackPush(int x, int y, coords stack){\nstack-&gt;next = malloc(sizeof(coords));\nstack-&gt;next-&gt;x = x;\nstack-&gt;next-&gt;y = y;\n}\n</code></pre>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["c", "pointers", "matrix", "swap"], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1423687697, "post_id": 28464029, "comment_id": 45254077, "body": "That looks convenient, but won&#39;t actually work.  (a) You are passing <code>int (*)[5][5]</code> to a function that expects <code>int ***</code> and the type mismatch matters, and (b) you can&#39;t change an array like that."}, {"owner": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423688877, "post_id": 28464029, "comment_id": 45254693, "body": "Thank you for your effort Michal, but it does not work due to the mismatch."}], "tags": [], "owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "is_accepted": false, "score": 0, "last_activity_date": 1423687080, "creation_date": 1423687080, "answer_id": 28464029, "question_id": 28463943, "link": "https://stackoverflow.com/questions/28463943/swapping-square-matrices-names-in-c/28464029#28464029", "title": "Swapping square matrices names in C", "body": "<p>Yes, you should definitely use pointers, for example:</p>\n\n<pre><code>void swap (int*** m1, int*** m2)\n{\n    int** temp;\n    temp = *m1;\n    *m1 = *m2;\n    *m2 = temp;\n}\n</code></pre>\n\n<p>And then invoke:</p>\n\n<pre><code>int m1[5][5] = 0;\nint m2[5][5] = 0;\nswap (&amp;m1, &amp;m2);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423689802, "post_id": 28464179, "comment_id": 45255185, "body": "I am trying to understand your suggestion: After these doing these steps once, when I refer to element another[i][j] is it the same element of one[i][j] before the swapping?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423690126, "post_id": 28464179, "comment_id": 45255366, "body": "@user2149122, no.  The elements of <code>one</code> and <code>another</code> do not move, which is exactly the point.  Also, it is not the names &quot;one&quot; and &quot;another&quot; that are being swapped; rather, the names &quot;matrix1p&quot; and &quot;matrix2p&quot; that are (effectively) swapped.  More technically, it is which matrix each of those latter names refers to that is swapped.  There is no efficiency available to be gained if you have to move the matrix elements."}, {"owner": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423694736, "post_id": 28464179, "comment_id": 45257700, "body": "Ok then. One more question for you: How can I access a specific element one[i][j] using the pointer?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423695183, "post_id": 28464179, "comment_id": 45257888, "body": "@user2149122, given the declarations as I presented them, while <code>one</code> is aliased by <code>matrix1p</code>, you can access <code>one[i][j]</code> as <code>matrix1p[i][j]</code>.  It&#39;s as simple as that.  Likewise, while <code>one</code> is aliased by <code>matrix2p</code>, you can access <code>one[i][j]</code> as <code>matrix2p[i][j]</code>."}, {"owner": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1423914649, "post_id": 28464179, "comment_id": 45348013, "body": "I have posted my code in my question to make it better to understand. It does not matter what happens in the values of matrix B when a step is completed, because they are gonna be replaced by the averages of the next step. (Another minnor problem is that this code does not work in the aspect that the sum of the values of the cells should be constant, but when I run it there are some small diviations. If you could take a look I would be greatfull). My question is how do I use pointers to get the same result, without having to copy each time one matrix to the other. Thank you in advance."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1424027315, "post_id": 28464179, "comment_id": 45374933, "body": "@user2149122, I have already explained that if you refer to your matrices via pointers then you can change which matrix each pointer refers to.  Such an approach can address your issue, regardless of whether you want a complete swap or whether you want to change the referent only of one pointer.  Some variation on that is the only possible alternative to copying the matrix elements."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "edited": false, "score": 0, "creation_date": 1424027762, "post_id": 28464179, "comment_id": 45375083, "body": "@user2149122, as for arithmetic deviations, you are performing floating-point arithmetic, which is inexact.  The same computation should always produce the same result, but the relevant definition of &quot;same&quot; is quite narrow: identical operations performed on identical operands in identical order.  In particular, the only algebraic rearrangement guaranteed to not change the result is commuting the operands of <code>+</code> or <code>*</code>."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1423695347, "last_edit_date": 1423695347, "creation_date": 1423687649, "answer_id": 28464179, "question_id": 28463943, "link": "https://stackoverflow.com/questions/28463943/swapping-square-matrices-names-in-c/28464179#28464179", "title": "Swapping square matrices names in C", "body": "<p>You can swap the values of any two variables of the same type by assigning the value of the first to a temporary variable then assigning the value of the second to the first, then assigning the value of the temporary variable to the second:</p>\n\n<pre><code>int a = 2, b = 3, tmp;\n\ntmp = a;\na = b;\nb = tmp;\n</code></pre>\n\n<p>In particular, it works exactly the same when the variables are of pointer type, so</p>\n\n<pre><code>/* The matrices */\ndouble one[3][3], another[3][3];\n\n/* pointers to the matrices */\ndouble (*matrix1p)[3] = one;\ndouble (*matrix2p)[3] = another;\ndouble (*tmp)[3];\n\n/* ... perform matrix operations using matrix1p and matrix2p ... */\n\n/* swap labels (pointers): */\ntmp = matrix1p;\nmatrix1p = matrix2p;\nmatrix2p = tmp;\n\n/* ... perform more matrix operations using matrix1p and matrix2p ... */\n</code></pre>\n\n<hr>\n\n<p><strong>Updated to clarify:</strong></p>\n\n<p><code>matrix1p</code> is initially an alias for <code>one</code>, and <code>matrix2p</code> is initially an alias for <code>another</code>.  After the swap, <code>matrix1p</code> is an alias for <code>another</code>, whereas <code>matrix2p</code> is an alias for <code>one</code>.  Of course, you can perform such a swap as many times as you want.  You cannot, however, swap <code>one</code> and <code>another</code> themselves, except via an element-by-element swap.</p>\n\n<hr>\n\n<p>Note that this yields improved efficiency because pointers are quite small relative to the matrices themselves.  You don't have to move the elements of the matrices, but only to change which matrix each pointer refers to.</p>\n"}], "owner": {"reputation": 171, "user_id": 2149122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/2f20cbfb8bdaa79ba874ac67a8c32668?s=128&d=identicon&r=PG", "display_name": "user2149122", "link": "https://stackoverflow.com/users/2149122/user2149122"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423914282, "creation_date": 1423686794, "last_edit_date": 1423914282, "question_id": 28463943, "link": "https://stackoverflow.com/questions/28463943/swapping-square-matrices-names-in-c", "title": "Swapping square matrices names in C", "body": "<p>I have been looking for a way to swap the names between two matrices in C. I have 2 square size x size matrices. I make some operation to the one of them, I put the result in a cell in the other matrix, then I swap their names and I repeat. </p>\n\n<p>Below I am giving my code </p>\n\n<pre><code>int main(void){\nint const size = 1000;\nint const steps = 10;\nfloat A[size][size], B[size][size];\nint i,j,k;\nint t = 0;\ndouble sum = 0;\ndouble sum1 = 0;\nint const ed = size - 1;\nfor(i = 0; i &lt; size; ++i){\n    for(j = 0; j &lt; size; ++j){// initialize the matrices\n        A[i][j] = i+j;\n        B[i][j] = 0;\n    }\n}\nfor(i = 0; i &lt; size; ++i){//find the sum of the values in the first matrix\n    for(j = 0; j &lt; size; ++j){\n        sum = sum + A[i][j];\n    }\n}\nprintf(\"The total sum of the matrix 1 is %lf \\n\",sum);\n\nfor(k = 0; k &lt; steps; ++k){//for each cell of the matrix A calculate the average of the values' of the cell and its surroundings and put it in the coresponding place in the matrix B and then copy matrix B to matrix A and repeat. There are special cases for the cells who are at the edges and the last or first row/column.\n    for(i = 0; i &lt; size; ++i){\n        for(j = 0; j &lt; size; ++j){\n            if(i==0){\n                if(j==0)\n                    B[i][j]=(A[0][0]+A[0][1]+A[0][ed]+A[1][0]+A[ed][0])/5.0;\n                else if(j==ed)\n                    B[i][j]=(A[0][ed]+A[0][0]+A[0][ed-1]+A[1][ed]+A[ed][ed])/5.0;\n                else\n                    B[i][j]=(A[0][j]+A[0][j+1]+A[0][j-1]+A[1][j]+A[ed][j])/5.0;\n            }else if(i==ed){\n                if(j==0)\n                    B[i][j]=(A[ed][0]+A[ed][1]+A[ed][ed]+A[0][0]+A[ed-1][0])/5.0;\n                else if(j==ed)\n                    B[i][j]=(A[ed][ed]+A[ed][0]+A[ed][ed-1]+A[0][ed]+A[ed-1][ed])/5.0;\n                else\n                    B[i][j]=(A[ed][j]+A[ed][j+1]+A[ed][j-1]+A[0][j]+A[ed-1][j])/5.0;\n            }else{\n                if(j==0)\n                    B[i][j]=(A[i][0]+A[i][1]+A[i][ed]+A[i+1][0]+A[i-1][0])/5.0;\n                else if(j==ed)\n                    B[i][j]=(A[i][ed]+A[i][0]+A[i][ed-1]+A[i+1][ed]+A[i-1][ed])/5.0;\n                else\n                    B[i][j]=(A[i][j]+A[i][j+1]+A[i][j-1]+A[i+1][j]+A[i-1][j])/5.0;\n            }\n        }\n    }\n    sum1 = 0;\n    for(i = 0; i &lt; size; ++i){\n        for(j = 0; j &lt; size; ++j){\n            sum1 = sum1 + B[i][j];\n        }\n    }\n    t=t+1;\n    for(i = 0; i &lt; size; ++i){\n        for(j = 0; j &lt; size; ++j){\n            A[i][j] = B[i][j];\n        }\n    }\n    printf(\"%lf \\n\",sum1-sum);\n}\nprintf(\"The total sum of the matrix 2 is %lf \\n\",sum1);\nprintf(\"Number of steps completed: %i \\n\",t);\nprintf(\"Number of steps failed to complete: %i \\n\", steps-t);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I have used the method of copying each time the one matrix to the other, but this is not efficient.</p>\n\n<p>I have a hint that I should use pointers but I can not figure it out. Any help will be much appreciated.</p>\n"}, {"tags": ["c", "pic", "microchip", "mplab"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423686764, "post_id": 28463701, "comment_id": 45253555, "body": "Looks like it&#39;s not finding the <code>delay.h</code> header. Have you checked if it exists?"}, {"owner": {"reputation": 35, "user_id": 3672208, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1185027202/picture?type=large", "display_name": "Roshaan Nayyar", "link": "https://stackoverflow.com/users/3672208/roshaan-nayyar"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423687024, "post_id": 28463701, "comment_id": 45253700, "body": "yes it exists in header folder but still same error"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1423687072, "post_id": 28463701, "comment_id": 45253719, "body": "Try googling &quot;picc lite warning 176&quot;. Or you could add &quot;Includes.h&quot; to the question."}, {"owner": {"reputation": 35, "user_id": 3672208, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1185027202/picture?type=large", "display_name": "Roshaan Nayyar", "link": "https://stackoverflow.com/users/3672208/roshaan-nayyar"}, "edited": false, "score": 0, "creation_date": 1423687183, "post_id": 28463701, "comment_id": 45253772, "body": "includes.h already exist"}, {"owner": {"reputation": 670, "user_id": 2482978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3d7bd243cad19e3769584643c39f7f?s=128&d=identicon&r=PG", "display_name": "jolati", "link": "https://stackoverflow.com/users/2482978/jolati"}, "edited": false, "score": 0, "creation_date": 1423687241, "post_id": 28463701, "comment_id": 45253804, "body": "What version of MPLAB are you using? You may need to add the path."}, {"owner": {"reputation": 35, "user_id": 3672208, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1185027202/picture?type=large", "display_name": "Roshaan Nayyar", "link": "https://stackoverflow.com/users/3672208/roshaan-nayyar"}, "edited": false, "score": 0, "creation_date": 1423687410, "post_id": 28463701, "comment_id": 45253907, "body": "v8.91 version i am using.what about path?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423687674, "post_id": 28463701, "comment_id": 45254058, "body": "And what happens if you copy <code>delay.h</code> into the folder <code>C:\\Users\\RXN\\Desktop\\pic</code> ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423776796, "post_id": 28463701, "comment_id": 45298082, "body": "according to some of the error messages, the includes.h file is missing a &lt;cr&gt; &#39;carriage return&#39; at the end of the file.  Simply open the file in an editor, scroll to the end of the file, click the &#39;enter&#39; button on your keyboard, save the file.  Then, to avoid such problems in the future, modify your editor so a carriage return is always assured at the end of the file."}], "answers": [{"tags": [], "owner": {"reputation": 670, "user_id": 2482978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3d7bd243cad19e3769584643c39f7f?s=128&d=identicon&r=PG", "display_name": "jolati", "link": "https://stackoverflow.com/users/2482978/jolati"}, "is_accepted": false, "score": 1, "last_activity_date": 1423687957, "creation_date": 1423687957, "answer_id": 28464265, "question_id": 28463701, "link": "https://stackoverflow.com/questions/28463701/pic-c-mp-lab-errors-at-build-point/28464265#28464265", "title": "Pic c mp lab errors at build point", "body": "<p>From the menu bar open 'Project'->'Build options...'->'Projects'. Under the 'Directories' tab choose 'Include Search Path' from the drop down menu. Then click 'New' and the '...' button on the right. Navigate to your the directory that the header is in and click 'OK'. </p>\n\n<p>Alternatively, try putting the full path to header in the c file. </p>\n"}], "owner": {"reputation": 35, "user_id": 3672208, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1185027202/picture?type=large", "display_name": "Roshaan Nayyar", "link": "https://stackoverflow.com/users/3672208/roshaan-nayyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 694, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423687957, "creation_date": 1423685885, "last_edit_date": 1423686058, "question_id": 28463701, "link": "https://stackoverflow.com/questions/28463701/pic-c-mp-lab-errors-at-build-point", "title": "Pic c mp lab errors at build point", "body": "<p>i am very new to micro controller world. i am using pic16f877, making simple calculator using lcd and keypad. \ni am getting following errors at build time. kindly help me out.</p>\n\n<pre><code>Build C:\\Users\\RXN\\Desktop\\pic\\Calculator for device 16F877\nUsing driver C:\\Program Files (x86)\\HI-TECH Software\\PICC-Lite\\9.50\\bin\\picl.exe\n\nMake: The target \"C:\\Users\\RXN\\Desktop\\pic\\Main.obj\" is out of date.\nExecuting: \"C:\\Program Files (x86)\\HI-TECH Software\\PICC-Lite\\9.50\\bin\\picl.exe\" -C C:\\Users\\RXN\\Desktop\\pic\\Main.c -q --chip=16F877 -P --runtime=default --opt=default -D__DEBUG=1 -g --asmlist \"--errformat=Error   [%n] %f; %l.%c %s\" \"--msgformat=Advisory[%n] %s\" \"--warnformat=Warning [%n] %f; %l.%c %s\" \nWarning [176] C:\\Users\\RXN\\Desktop\\pic\\Includes.h; 24.0 missing newline\nError   [141] C:\\Users\\RXN\\Desktop\\pic\\LCD.c; 6.18 can't open include file \"delay.h\": No such file or directory\nMake: The target \"C:\\Users\\RXN\\Desktop\\pic\\Keypad.obj\" is out of date.\nExecuting: \"C:\\Program Files (x86)\\HI-TECH Software\\PICC-Lite\\9.50\\bin\\picl.exe\" -C C:\\Users\\RXN\\Desktop\\pic\\Keypad.c -q --chip=16F877 -P --runtime=default --opt=default -D__DEBUG=1 -g --asmlist \"--errformat=Error   [%n] %f; %l.%c %s\" \"--msgformat=Advisory[%n] %s\" \"--warnformat=Warning [%n] %f; %l.%c %s\" \nWarning [176] C:\\Users\\RXN\\Desktop\\pic\\Includes.h; 24.0 missing newline\nError   [141] C:\\Users\\RXN\\Desktop\\pic\\LCD.c; 6.18 can't open include file \"delay.h\": No such file or directory\nMake: The target \"C:\\Users\\RXN\\Desktop\\pic\\LCD.obj\" is out of date.\nExecuting: \"C:\\Program Files (x86)\\HI-TECH Software\\PICC-Lite\\9.50\\bin\\picl.exe\" -C C:\\Users\\RXN\\Desktop\\pic\\LCD.c -q --chip=16F877 -P --runtime=default --opt=default -D__DEBUG=1 -g --asmlist \"--errformat=Error   [%n] %f; %l.%c %s\" \"--msgformat=Advisory[%n] %s\" \"--warnformat=Warning [%n] %f; %l.%c %s\" \nWarning [176] C:\\Users\\RXN\\Desktop\\pic\\Includes.h; 24.0 missing newline\nError   [141] C:\\Users\\RXN\\Desktop\\pic\\LCD.c; 6.18 can't open include file \"delay.h\": No such file or directory\n\n********** Build failed! **********\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "pointers", "realloc"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1423685815, "post_id": 28463637, "comment_id": 45253048, "body": "<code>&amp;result = ...</code> stop right there. that isn&#39;t an lvalue."}, {"owner": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "edited": false, "score": 1, "creation_date": 1423686077, "post_id": 28463637, "comment_id": 45253191, "body": "<code>&amp;result</code> would be of type <code>char ****</code> inside <code>split_string</code>. You need to de-reference it. Maybe with <code>*result</code> instead ?"}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 3, "last_activity_date": 1423687066, "last_edit_date": 1423687066, "creation_date": 1423686707, "answer_id": 28463923, "question_id": 28463637, "link": "https://stackoverflow.com/questions/28463637/how-do-i-create-a-function-in-c-that-allows-me-to-split-a-string-based-on-a-deli/28463923#28463923", "title": "How do I create a function in C that allows me to split a string based on a delimiter into an array?", "body": "<p>You confusing dereferencing with <em>addressing</em> (which is the complete opposite). Btw, I couldn't find <code>split_array</code> anywhere in the function, as it was down in <code>main</code>. Even if you had the dereferencing and addressing correct, this would still have other issues.</p>\n\n<p>I'm fairly sure you're trying to do this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid split_string(char string[], const char *delimiter, char ***result)\n{\n    char *p = strtok(string, delimiter);\n    void *tmp = NULL;\n    int count=0;\n\n    *result = NULL;\n\n    while (p != NULL)\n    {\n        tmp = realloc(*result, (count+1)*sizeof **result);\n        if (tmp)\n        {\n            *result = tmp;\n            (*result)[count++] = p;\n        }\n        else\n        {   // failed to expand\n            perror(\"Failed to expand result array\");\n            exit(EXIT_FAILURE);\n        }\n\n        p = strtok(NULL, delimiter);\n    }\n\n    // add null pointer\n    tmp = realloc(*result, (count+1)*sizeof(**result));\n    if (tmp)\n    {\n        *result = tmp;\n        (*result)[count] = NULL;\n    }\n    else\n    {\n        perror(\"Failed to expand result array\");\n        exit(EXIT_FAILURE);\n    }\n}\n\nint main()\n{\n    char str[] = \"hello world 1 foo\", **toks = NULL;\n    char **it;\n\n    split_string(str, \" \", &amp;toks);\n\n    for (it = toks; *it; ++it)\n        printf(\"%s\\n\", *it);\n    free(toks);\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>hello\nworld\n1\nfoo\n</code></pre>\n\n<p>Honestly this would be cleaner if the function result were utilized rather than an in/out parameter, but you choice the latter, so there you go. </p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 28463923, "answer_count": 1, "score": 0, "last_activity_date": 1423687066, "creation_date": 1423685653, "last_edit_date": 1495541184, "question_id": 28463637, "link": "https://stackoverflow.com/questions/28463637/how-do-i-create-a-function-in-c-that-allows-me-to-split-a-string-based-on-a-deli", "title": "How do I create a function in C that allows me to split a string based on a delimiter into an array?", "body": "<p>I want to create a function in C, so that I can pass the function a string, and a delimiter, and it will return to me an array with the parts of the string split up based on the delimiter. Commonly used to separate a sentence into words.</p>\n\n<p>e.g.: <code>\"hello world foo\"</code> -> <code>[\"hello\", \"world\", \"foo\"]</code></p>\n\n<p>However, I'm new to C and a lot of the pointer things are confusing me. I got an answer mostly from <a href=\"https://stackoverflow.com/questions/11198604/c-split-string-into-an-array-of-strings\">this question</a>, but it does it inline, so when I try to separate it into a function the logistics of the pointers are confusing me:</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid split_string(char string[], char *delimiter, char ***result) {\n    char *p = strtok(string, delimiter);\n    int i, num_spaces = 0;\n\n    while (p != NULL) {\n        num_spaces++;\n        &amp;result = realloc(&amp;result, sizeof(char *) * num_spaces);\n\n        if (&amp;result == NULL) {\n            printf(\"Memory reallocation failed.\");\n            exit(-1);\n        }\n\n        &amp;result[num_spaces - 1] = p;\n\n        p = strtok(NULL, \" \");\n    }\n\n    // Add the null pointer to the end of our array\n    &amp;result = realloc(split_array, sizeof(char *) * num_spaces + 1);\n    &amp;result[num_spaces] = 0;\n\n    for (i = 0; i &lt; num_spaces; i++) {\n        printf(\"%s\\n\", &amp;result[i]);\n    }\n\n    free(&amp;result);\n} \n\nint main(int argc, char *argv[]) {\n    char str[] = \"hello world 1 foo\";\n    char **split_array = NULL;\n\n    split_string(str, \" \", &amp;split_array);\n\n    return 0;\n}\n</code></pre>\n\n<p>The gist of it being that I have a function that accepts a string, accepts a delimiter and accepts a pointer to where to save the result. Then it constructs the result. The variable for the result starts out as NULL and without memory, but I gradually reallocate memory for it as needed.</p>\n\n<p>But I'm really confused as to the pointers, like I said. I know my result is of type <code>char **</code> as a string it of type <code>char *</code> and there are many of them so you need pointers to each, but then I'm supposed to pass the <em>location</em> of that <code>char **</code> to the new function, right, so it becomes a <code>char ***</code>? When I try to access it with <code>&amp;</code> though it doesn't seem to like it.</p>\n\n<p>I feel like I'm missing something fundamental here, I'd really appreciate insight into what is going wrong with the code.</p>\n"}, {"tags": ["c", "wget"], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1439533274, "creation_date": 1439533274, "answer_id": 32003503, "question_id": 28463406, "link": "https://stackoverflow.com/questions/28463406/wget-logfile-how-to-set-the-unit-to-be-seconds-and-kilobytes/32003503#32003503", "title": "wget logfile, how to set the unit to be seconds, and kilobytes", "body": "<p>If you insist in modifying <code>wget</code>, change the above to</p>\n\n<pre><code>  logprintf (LOG_NOTQUIET,\n             _(\"FINISHED --%s--\\nTotal wall clock time: %s\\n\"\n               \"Downloaded: %d files, %ldK in %lds (%s)\\n\"),\n             datetime_str (time (NULL)),\n             wall_time,\n             numurls,\n             (long)(total_downloaded_bytes/1024),\n             (long)total_download_time,\n             retr_rate (total_downloaded_bytes, total_download_time));\n</code></pre>\n\n<p>- but you should reconsider handling the several units in your C program.</p>\n"}], "owner": {"reputation": 203, "user_id": 1675224, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/15fb00dce5f4dcbf915ded7cc9235fec?s=128&d=identicon&r=PG", "display_name": "user1675224", "link": "https://stackoverflow.com/users/1675224/user1675224"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 32003503, "answer_count": 1, "score": 0, "last_activity_date": 1439533274, "creation_date": 1423684912, "last_edit_date": 1423687123, "question_id": 28463406, "link": "https://stackoverflow.com/questions/28463406/wget-logfile-how-to-set-the-unit-to-be-seconds-and-kilobytes", "title": "wget logfile, how to set the unit to be seconds, and kilobytes", "body": "<p>The last three lines in the wget log file, with -nv option, are</p>\n\n<pre><code> FINISHED --2015-02-11 21:52:07--\n Total wall clock time: 4.8s\n Downloaded: 6 files, 316K in 1.7s (182 KB/s)\n</code></pre>\n\n<p>I want to read these lines with c, So I want the 316K to be always in K, (I don't want to have 2.3M etc) Also I want the time to be always in sec (Not in minute, hours etc). </p>\n\n<p>PS\nin the main.c (in the wget source)</p>\n\n<pre><code>             logprintf (LOG_NOTQUIET,\n              _(\"FINISHED --%s--\\nTotal wall clock time: %s\\n\"\n               \"Downloaded: %d files, %s in %s (%s)\\n\"),\n             datetime_str (time (NULL)),\n             wall_time,\n             numurls,\n             human_readable (total_downloaded_bytes, 10, 1),\n             download_time,\n             retr_rate (total_downloaded_bytes,      total_download_time));\n</code></pre>\n"}, {"tags": ["c", "string", "concatenation"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423684186, "post_id": 28463177, "comment_id": 45252180, "body": "You have <code>j=i+1</code>, and then use <code>sname[j++]</code> --- you&#39;re accessing <code>sname</code> out of bounds, plus some UB (see the next post) and so on. I spot 3 or so errors here, at least."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 5, "creation_date": 1423684214, "post_id": 28463177, "comment_id": 45252195, "body": "<code>cat[i++] = fname[i++]</code> is probably not going to do what you expect. <code>cat[i] = fname[i], i++</code> is safer."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1423684336, "post_id": 28463177, "comment_id": 45252245, "body": "@squeamishossifrage: Or he can just put the assignment in the (currently empty) body of the <code>for</code> loop, where it belongs."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423684383, "post_id": 28463177, "comment_id": 45252280, "body": "@Tim\u010cas Yes, that would make more sense"}, {"owner": {"reputation": 5064, "user_id": 1741125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/263d60d37f25bf7f29b3552785fb3efb?s=128&d=identicon&r=PG", "display_name": "mafso", "link": "https://stackoverflow.com/users/1741125/mafso"}, "edited": false, "score": 1, "creation_date": 1423684744, "post_id": 28463177, "comment_id": 45252473, "body": "OT: <a href=\"http://stackoverflow.com/questions/1694036\">Never use <code>%s</code> in <code>scanf</code> without a field width</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423684346, "post_id": 28463217, "comment_id": 45252251, "body": "Yeah, I am actually supposed to do this using array manipulations."}], "tags": [], "owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684271, "creation_date": 1423684271, "answer_id": 28463217, "question_id": 28463177, "link": "https://stackoverflow.com/questions/28463177/concatenating-strings-in-c-without-the-use-of-library-functions/28463217#28463217", "title": "concatenating strings in C without the use of library functions", "body": "<p>I realize you set yourself a challenge to try to learn how to do something specific (and I see you are making progress towards your goal). But I always like to keep in mind there are lots of ways to get the job done -- especially in C. You know you could just do this with <code>printf</code>, right?</p>\n\n<pre><code>char fname[16], sname[16];\nint i, j;\nprintf(\"Please enter your first name: \");\nscanf(\"%s\", fname);\nprintf(\"Please enter your second name: \");\nscanf(\"%s\", sname);\n\nprintf(\"%s %s\\n\", fname, sname);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 1758142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/087d5392c25711573eb218471eac3204?s=128&d=identicon&r=PG", "display_name": "pascx64", "link": "https://stackoverflow.com/users/1758142/pascx64"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684443, "creation_date": 1423684443, "answer_id": 28463270, "question_id": 28463177, "link": "https://stackoverflow.com/questions/28463177/concatenating-strings-in-c-without-the-use-of-library-functions/28463270#28463270", "title": "concatenating strings in C without the use of library functions", "body": "<p>Watch the index you use :</p>\n\n<p><code>cat[i++] = fname[i++]</code> and <code>cat[j++] = sname[j++]</code></p>\n\n<p>try to increment 'i' and 'j' at the end of your loop :</p>\n\n<pre><code>for (i=0; fname[i] != '\\0'; ++i)\n    cat[i] = fname[i];\n// ...\nfor (j=0; sname[j] != '\\0';++j)\n    cat[j+i+1] = sname[j];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423685394, "post_id": 28463327, "comment_id": 45252825, "body": "You mean the <code>cat</code> should be declared with <code>32</code> characters, right? Because it already contains <code>31</code> cells. Your analysis seems very plausibe, however when I run your corrected version, I get a two page error and the program doesn&#39;t even compile."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423685484, "post_id": 28463327, "comment_id": 45252879, "body": "Yeah, sorry about that. What error are you getting?"}, {"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423685835, "post_id": 28463327, "comment_id": 45253059, "body": "It complains about many things and is not clear where it went wrong. It says for example: <code>expected declaration specifiers or &#39;...&#39; before &#39;fname&#39;</code> and somewhere else it says <code>error: invalid initializer</code>. Here is the corrected code: <a href=\"http://paste.ofcode.org/38aK7vqBuYUMirpbbNKGpZ6\" rel=\"nofollow noreferrer\">paste.ofcode.org/38aK7vqBuYUMirpbbNKGpZ6</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423685909, "post_id": 28463327, "comment_id": 45253098, "body": "Your code needs to be in the <code>main()</code> function. You can&#39;t run code outside a function in C."}, {"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1423686055, "post_id": 28463327, "comment_id": 45253174, "body": "Oh crap. Sorry. Yeah, I got distracted. typo. (My original program included the main function of course) Now that I correct it, it gives back the exact same result as before!! for example if I give <code>John</code> and <code>Doe</code> as fname and sname I get some weird output like <code>J0h</code>"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1423686755, "last_edit_date": 1423686755, "creation_date": 1423684663, "answer_id": 28463327, "question_id": 28463177, "link": "https://stackoverflow.com/questions/28463177/concatenating-strings-in-c-without-the-use-of-library-functions/28463327#28463327", "title": "concatenating strings in C without the use of library functions", "body": "<p>You have several problems. First, since <code>cat</code> has to be big enough to hold the first two strings <strong>and</strong> a space between them, it should be declared <code>cat[32]</code> -- 15 characters of first name, 15 characters of surname, 1 space, and 1 trailing null byte.</p>\n\n<p>You're putting the space between the words in the wrong place. The first loop left <code>i</code> holding the next position in <code>cat</code>, so it should be:</p>\n\n<pre><code>cat[i] = ' ';\n</code></pre>\n\n<p>Next, your array indexes in the second loop are incorrect. The positions in <code>cat</code> are correct, because they start from where you left off the previous loop. But you need to start from <code>0</code> in <code>sname</code>. So this loop should be:</p>\n\n<pre><code>for (j = i+1, k = 0; sname[k] != 0; cat[j++] = sname[k++])\n    ;\n</code></pre>\n\n<p>Finally, after concatenating the two strings, you need to append a null byte to the result, to indicate the end.</p>\n\n<pre><code>cat[j] = 0;\n</code></pre>\n\n<p>Another problem is that you're incrementing <code>i</code> twice each time through the first loop, since you use <code>cat[i++] = fname[i++]</code>. Each of those <code>i++</code> will increment the variable. You need to separate the assignment from the increments:</p>\n\n<pre><code>for (i=0; fname[i] != '\\0'; i++) {\n    cat[i] = fname[i];\n}\n</code></pre>\n\n<p>Here's a final version of the script that works:</p>\n\n<pre><code># include &lt;stdio.h&gt;\n//the program loosely simulates the behaviour of strcpy\n\nint main() {\n    char fname[16], sname[16], cat[32];\n    int i, j, k;\n    printf(\"Please enter your first name: \");\n    scanf(\"%s\", fname);\n    printf(\"Please enter your second name: \");\n    scanf(\"%s\", sname);\n\n    for (i=0; fname[i] != '\\0'; i++) {\n        cat[i] = fname[i];\n    }\n\n    cat[i] = ' ';\n\n    for (j = i+1, k = 0; sname[k] != 0; cat[j++] = sname[k++]) {\n    }\n\n    cat[j] = 0;\n\n    printf(\"The final result is: %s\\n\", cat);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 28463327, "answer_count": 3, "score": 0, "last_activity_date": 1423688825, "creation_date": 1423684081, "last_edit_date": 1423688825, "question_id": 28463177, "link": "https://stackoverflow.com/questions/28463177/concatenating-strings-in-c-without-the-use-of-library-functions", "title": "concatenating strings in C without the use of library functions", "body": "<p>I need to write a simple program (no fancy pointer stuff, no library functions. It's for educational purposes) that reads the first and second names from a user and prints them out in a single line separated by a space. I am not getting the result and I am not sure why:</p>\n\n<pre><code># include &lt;stdio.h&gt;\n//the program loosely simulates the behaviour of strcpy\nmain(){\n    char fname[16], sname[16], cat[31];\n    int i, j;\n    printf(\"Please enter your first name: \");\n    scanf(\"%s\", fname);\n    printf(\"Please enter your second name: \");\n    scanf(\"%s\", sname);\n\n    for (i=0; fname[i] != '\\0'; cat[i++] = fname[i++])\n        ;\n\n    cat[i+1] = ' '; //adds a space between the tokens\n\n    for (j=i+1; sname[j] != '\\0'; cat[j++] = sname[j++])\n        ;   \n\n    printf(\"The final result is:\\n%s\", cat);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1423683978, "post_id": 28463123, "comment_id": 45252081, "body": "You&#39;re missing closing <code>)</code> and <code>;</code> in a few places."}, {"owner": {"reputation": 36814, "user_id": 671543, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2145962377da9419f2446cd565f614ee?s=128&d=identicon&r=PG", "display_name": "njzk2", "link": "https://stackoverflow.com/users/671543/njzk2"}, "edited": false, "score": 5, "creation_date": 1423683997, "post_id": 28463123, "comment_id": 45252091, "body": "<code>if(1)</code> does not do what you think it does."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 1, "creation_date": 1423684028, "post_id": 28463123, "comment_id": 45252108, "body": "And <code>else (2)</code> doesn&#39;t either."}, {"owner": {"reputation": 2129, "user_id": 199419, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/936265a5de0f3c8a3fc4519e02e88c92?s=128&d=identicon&r=PG", "display_name": "JPCF", "link": "https://stackoverflow.com/users/199419/jpcf"}, "edited": false, "score": 0, "creation_date": 1423684084, "post_id": 28463123, "comment_id": 45252133, "body": "Compiler output shows which line is causing the problem"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1423684247, "post_id": 28463123, "comment_id": 45252210, "body": "You&#39;ll run into problems with integer arithmetic on things like this: <code>Celcius=( Fahrenheit-32 )*5&#47;9;</code>. Like <code>Celcius</code> will always be 0."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4413591"}, "edited": false, "score": 0, "creation_date": 1423684288, "post_id": 28463123, "comment_id": 45252226, "body": "Questions caused by simple typographical errors are not deemed unsuitable here."}, {"owner": {"reputation": 4718, "user_id": 172218, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ulbsn.jpg?s=128&g=1", "display_name": "j b", "link": "https://stackoverflow.com/users/172218/j-b"}, "edited": false, "score": 0, "creation_date": 1423737095, "post_id": 28463123, "comment_id": 45273567, "body": "I would also suggest reading the Stack Overflow help &gt; on-topic particularly category &quot;2&quot; before posting further questions. This will help avoid large numbers of downvotes in the future <a href=\"http://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4556424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c16d316eaa981bb1a936c133c9a5db1b?s=128&d=identicon&r=PG&f=1", "display_name": "VerasVeras", "link": "https://stackoverflow.com/users/4556424/verasveras"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684080, "creation_date": 1423684080, "answer_id": 28463176, "question_id": 28463123, "link": "https://stackoverflow.com/questions/28463123/expected-before-token-in-ine-10/28463176#28463176", "title": "Expected &#39;;&#39; before &#39;{&#39; token in ine 10", "body": "<p>Generally, an expected ';' error means you are missing a semi-colon.\nIf you look at line 10, you are missing the semi-colon after if(1) and after the print statement.</p>\n"}, {"tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684178, "creation_date": 1423684178, "answer_id": 28463197, "question_id": 28463123, "link": "https://stackoverflow.com/questions/28463123/expected-before-token-in-ine-10/28463197#28463197", "title": "Expected &#39;;&#39; before &#39;{&#39; token in ine 10", "body": "<p>After <code>else</code> should NOT be ( 2 ). Else has not additional conditions, and is just the optional part of <code>if</code></p>\n"}, {"tags": [], "owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "is_accepted": true, "score": 1, "last_activity_date": 1423684631, "last_edit_date": 1423684631, "creation_date": 1423684318, "answer_id": 28463232, "question_id": 28463123, "link": "https://stackoverflow.com/questions/28463123/expected-before-token-in-ine-10/28463232#28463232", "title": "Expected &#39;;&#39; before &#39;{&#39; token in ine 10", "body": "<p>Here's a list of all compilation errors I found.</p>\n\n<p>The first problem is on this line:</p>\n\n<p><code>printf ( \"What do you want to do? (1/2) \\n 1. Fahrenheit to Celcius \\n. 2. Celcius to Fahrenheit \\n. \"</code></p>\n\n<p>You're missing a closing parentheses and a semicolon.</p>\n\n<p>Another is here:</p>\n\n<p><code>printf ( \"Enter Fahrenheit \\n.\" )</code></p>\n\n<p>you missed a semicolon at the end.</p>\n\n<p>Another problem is in this line:</p>\n\n<p><code>else ( 2 )</code></p>\n\n<p><code>else</code> doesn't have a condition block like <code>if()</code>, so <code>( 2 )</code> is treated like the statement that needs to execute in case the condition in the <code>if</code> your <code>else</code> belongs to isn't satisfied. However, it misses a ';' at the end, hence the error. The block enclosed by <code>{ }</code> doesn't relate to your <code>else</code> at all.</p>\n\n<p>Here's another:</p>\n\n<p><code>printf ( \"The temperature in Fahrenheit is %d \\n, Fahrenheit );</code> you're missing a closing <code>\"</code> in your string literal.</p>\n\n<p>Generally, even if you correct all of these mistakes, your code still will not do what you expect it to. I suggest you sit down with a good book or beginner's tutorial on programming before trying to code.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 3157163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fa8e0827006f57b24d0dca802ede9f0?s=128&d=identicon&r=PG&f=1", "display_name": "senior dev", "link": "https://stackoverflow.com/users/3157163/senior-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684527, "creation_date": 1423684527, "answer_id": 28463290, "question_id": 28463123, "link": "https://stackoverflow.com/questions/28463123/expected-before-token-in-ine-10/28463290#28463290", "title": "Expected &#39;;&#39; before &#39;{&#39; token in ine 10", "body": "<p>you need ; after printf on line 10</p>\n"}], "owner": {"reputation": 19, "user_id": 4556324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839f3aaf4c287af86ac127088e1152b3?s=128&d=identicon&r=PG&f=1", "display_name": "Tafadzwa", "link": "https://stackoverflow.com/users/4556324/tafadzwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 28463232, "answer_count": 4, "score": -5, "last_activity_date": 1423684631, "creation_date": 1423683899, "last_edit_date": 1423683935, "question_id": 28463123, "link": "https://stackoverflow.com/questions/28463123/expected-before-token-in-ine-10", "title": "Expected &#39;;&#39; before &#39;{&#39; token in ine 10", "body": "<p>I am new to programming and this is what I am getting when I try to compile this program. Can you please help?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main ()\n\n{\n\n    int Fahrenheit;\n\n    int Celcius;\n\n    int choice;\n\n    int temperature;\n\n    printf ( \"What do you want to do? (1/2) \\n 1. Fahrenheit to Celcius \\n. 2. Celcius to Fahrenheit \\n. \"\n\n    if ( 1 )\n\n{\n\n   printf ( \"Enter Fahrenheit \\n.\" )\n\n   scanf ( \"%d\", &amp;Fahrenheit );\n\n   Celcius=( Fahrenheit-32 )*5/9;\n\n   print( \"The temperature in Celcius is %d \\n\", Celcius );\n\n}\n\n   else ( 2 )\n\n{\n\n    printf ( \"Enter celcius\\n\" );\n\n    scanf ( \"%d\", &amp;Celcius );\n\n    Fahrenheit=Celcius*((9/5)+32);\n\n    printf ( \"The temperature in Fahrenheit is %d \\n, Fahrenheit );\n\n    }\n\n  }\n</code></pre>\n"}, {"tags": ["c", "memory-management", "struct", "linked-list", "malloc"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423683383, "post_id": 28462960, "comment_id": 45251727, "body": "Please <a href=\"http://stackoverflow.com/a/605858/485088\">don&#39;t cast malloc</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1423683467, "post_id": 28462960, "comment_id": 45251775, "body": "Should <code>int *elem;</code> be <code>struct coordinates *elem;</code>?"}, {"owner": {"reputation": 1, "user_id": 4556352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c699a050a03a34c37f88f383c5881?s=128&d=identicon&r=PG&f=1", "display_name": "rybak3", "link": "https://stackoverflow.com/users/4556352/rybak3"}, "edited": false, "score": 0, "creation_date": 1423683494, "post_id": 28462960, "comment_id": 45251789, "body": "Tim, the malloc statement is a direct copy of my professors directions, but after reading that I will not cast it anymore. Thank you"}, {"owner": {"reputation": 1, "user_id": 4556352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c699a050a03a34c37f88f383c5881?s=128&d=identicon&r=PG&f=1", "display_name": "rybak3", "link": "https://stackoverflow.com/users/4556352/rybak3"}, "edited": false, "score": 0, "creation_date": 1423683539, "post_id": 28462960, "comment_id": 45251819, "body": "Jonathan, that was my other thought but I wasn&#39;t sure I could do that, however it makes things much simpler. Could you please tell me how I would allocate the memory in that case?"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1423684979, "creation_date": 1423684979, "answer_id": 28463427, "question_id": 28462960, "link": "https://stackoverflow.com/questions/28462960/allocating-memory-for-a-node-with-a-struct-as-a-value/28463427#28463427", "title": "Allocating memory for a node with a struct as a value", "body": "<p>Change <code>linkedStruct</code> to contain an object of <code>coordinates</code> in it:</p>\n\n<pre><code>struct linkedStruct\n{\n   coordinates elem;\n   struct linkedStruct*  next;\n};\n</code></pre>\n\n<p>Then, after <code>malloc</code>, you can set the members of the new <code>linkedStruct</code>.</p>\n\n<pre><code>linkedPtr ptr = malloc(sizeof(linked));\nptr-&gt;elem.x = 1;\nptr-&gt;elem.y = 2;\nptr-&gt;next = NULL;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1423685714, "post_id": 28463554, "comment_id": 45252994, "body": "It would be much cleaner to give <code>struct linkedStruct</code> a member of type <code>struct coordinates</code> instead of a pointer to such an object.  That saves some unnecessary memory management on both ends, and eliminates a potential source of error.  And speaking of errors, you really should <i>check</i> whether <code>malloc()</code> is successful instead of assuming it will be."}], "tags": [], "owner": {"reputation": 193, "user_id": 1966904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaffbead10d196649a3d05fe4c4d54ac?s=128&d=identicon&r=PG", "display_name": "Th30n", "link": "https://stackoverflow.com/users/1966904/th30n"}, "is_accepted": false, "score": 0, "last_activity_date": 1423686305, "last_edit_date": 1423686305, "creation_date": 1423685395, "answer_id": 28463554, "question_id": 28462960, "link": "https://stackoverflow.com/questions/28462960/allocating-memory-for-a-node-with-a-struct-as-a-value/28463554#28463554", "title": "Allocating memory for a node with a struct as a value", "body": "<p>I won't go into much details of linked list algorithms since this seems to be your homework and should probably read the book and/or course materials.</p>\n\n<p>Since your element value is a <code>struct coordinates</code> you store a pointer to it inside your linked list node. Or to avoid having to worry as much about freeing stuff you can have a struct coordinates in a node instead of a pointer.</p>\n\n<pre><code>struct linkedStruct\n{\n    struct coordinates elem;\n    struct linkedStruct*  next;\n};\n\ntypedef struct linkedStruct linked;\ntypedef linked* linkedPtr;\n</code></pre>\n\n<p>When you add a node you need to set the <code>next</code> pointer to newly allocated node as you do in your code. And you set the pointer to your struct.</p>\n\n<pre><code>linkedPtr ptr = malloc(sizeof(linked));\nptr-&gt;elem.x = 3;\nptr-&gt;elem.y = 4;\n// assuming you are appending to the end of linked list and last_node-&gt;next is NULL\nptr-&gt;next = NULL\nlast_node-&gt;next = ptr;\n</code></pre>\n\n<p>You also need to set the <code>next</code> pointer of the newly created node <code>ptr</code> to <code>NULL</code> if it is at the end (there is no next node after it).\nYou need to cleanup the nodes with <code>free</code> when done. \nAnother suggestion is to have 2 structs, one being the linked list which stores pointers to start and end of the list (for easier appending) and a struct which represents the node (with element and next pointer) as you have done. Using that suggestion the above code could be in a function:</p>\n\n<pre><code>typedef struct {\n    linkedPtr *head;\n    linkedPtr *last;\n} linked_list; // Linked list with pointers to first and last node.\n\nint *append(linked_list *list, int x, int y)\n{\n    linkedPtr ptr = malloc(sizeof(linked)); // This might fail to allocate\n    if (ptr == NULL) {\n        return -1; // This will be the error code for failure.\n    }\n    ptr-&gt;elem.x = x;\n    ptr-&gt;elem.y = y;\n    ptr-&gt;next = NULL;\n    if (list-&gt;first == NULL) { // If list is empty.\n        list-&gt;first = ptr;\n        list-&gt;last = ptr;\n    } else {\n        list-&gt;last-&gt;next = ptr; // Point the last node to new node\n        list-&gt;last = ptr; // Set the last to new last node\n    }\n    return 0; // Code success\n}\n</code></pre>\n\n<p>To use append you need to have created <code>linked_list</code>.</p>\n\n<pre><code>linked_list *list = malloc(sizeof(linked_list)); // This might also fail.\nlist-&gt;head = NULL;\nlist-&gt;last = NULL;\nif (append(list, 3, 4) == -1) {\n  printf(\"Unable to allocate memory for appending to list\\n\");\n}\n</code></pre>\n\n<p>Don't forget to <code>free</code> all that when you are done.</p>\n"}], "owner": {"reputation": 1, "user_id": 4556352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c699a050a03a34c37f88f383c5881?s=128&d=identicon&r=PG&f=1", "display_name": "rybak3", "link": "https://stackoverflow.com/users/4556352/rybak3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423686305, "creation_date": 1423683311, "question_id": 28462960, "link": "https://stackoverflow.com/questions/28462960/allocating-memory-for-a-node-with-a-struct-as-a-value", "title": "Allocating memory for a node with a struct as a value", "body": "<p>I have thought of a couple of ways to do this but I am wondering which is correct.</p>\n\n<p>The assignment requires us to traverse a 2d array (maze) and print out each coordinate of the final solution path from start to finish.</p>\n\n<p>The coordinates are to be stored in a linked list that has stack operations acting upon it (push, pop, etc). Therefore, only one node at a time is being looked at (the head will point to a null node, and then values will be \"pushed\" in front of the initial node, then popped as is required. </p>\n\n<p>My problem is the proper allocation of memory for the node.</p>\n\n<p>The solution that I came up with would be generalized as:</p>\n\n<pre><code>struct coordinates{\n    int x;\n    int y;\n};\n\nstruct linkedStruct\n{\n int* elem;\n struct linkedStruct*  next;\n};\n\ntypedef struct linkedStruct linked;\ntypedef linked* linkedPtr; \n</code></pre>\n\n<p>So in main I assume I would do this</p>\n\n<pre><code>linkedPtr ptr = malloc(sizeof(linked));\nptr-&gt;elem = coordinates;\n</code></pre>\n\n<p>Is this correct? My first time doing linked lists.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1423682963, "post_id": 28462855, "comment_id": 45251453, "body": "This is because of stack overflow. Take out of <code>main</code> or use dynamic memory allocation. Read this <a href=\"http://stackoverflow.com/a/28462111/2455888\">answer</a> for further explanation."}, {"owner": {"reputation": 22608, "user_id": 618598, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/37b955736b6911e9bbfd417c6aede9ca?s=128&d=identicon&r=PG", "display_name": "Bernd Elkemann", "link": "https://stackoverflow.com/users/618598/bernd-elkemann"}, "edited": false, "score": 0, "creation_date": 1423682992, "post_id": 28462855, "comment_id": 45251478, "body": "char* arr = malloc(35000*500);"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 1, "creation_date": 1423683031, "post_id": 28462855, "comment_id": 45251504, "body": "As @haccks said --- you are trying to allocate (roughly) 17MB of memory on the stack."}], "answers": [{"tags": [], "owner": {"reputation": 8788, "user_id": 2236401, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06a91e6a7b9d4c46e5a39e18a5491a93?s=128&d=identicon&r=PG", "display_name": "sedavidw", "link": "https://stackoverflow.com/users/2236401/sedavidw"}, "is_accepted": false, "score": 1, "last_activity_date": 1423683011, "creation_date": 1423683011, "answer_id": 28462887, "question_id": 28462855, "link": "https://stackoverflow.com/questions/28462855/creating-large-array-in-c-but-cant-access-memory/28462887#28462887", "title": "creating large array in C but cant access memory", "body": "<p>You probably have some stack overflow happening.  Consider using dynamic memory allocation</p>\n"}], "owner": {"reputation": 1019, "user_id": 2730331, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ff73fdc2c4b7f1600823fb392a0ff36b?s=128&d=identicon&r=PG", "display_name": "user081608", "link": "https://stackoverflow.com/users/2730331/user081608"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "closed_date": 1423683148, "answer_count": 1, "score": 0, "last_activity_date": 1423683011, "creation_date": 1423682880, "question_id": 28462855, "link": "https://stackoverflow.com/questions/28462855/creating-large-array-in-c-but-cant-access-memory", "closed_reason": "Duplicate", "title": "creating large array in C but cant access memory", "body": "<p>I am currently creating a large array that looks like this:</p>\n\n<pre><code>unsigned char arr[35000][500];\n</code></pre>\n\n<p>I then try to write in 256 characters into the array like so:</p>\n\n<pre><code>for(i=0; i &lt; 256; i++)\n{\n  arr[i][0] = i;\n}\n</code></pre>\n\n<p>When I do this, I get the following seg fault:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00000000004007e3 in main () at arr.c:41\n41        arr[i][0] = i;\n</code></pre>\n\n<p>Any suggestions on why this is happening?</p>\n"}, {"tags": ["c", "buffer", "jpeg"], "answers": [{"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423682683, "post_id": 28462681, "comment_id": 45251278, "body": "He should also be opening the file in binary mode (<code>&quot;rb&quot;</code>), unless he wants bytes to be (seemingly) randomly dropped or changed on some systems."}, {"owner": {"reputation": 331, "user_id": 3865814, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cc3c3a5a12f96a50f35f31e3730aab14?s=128&d=identicon&r=PG&f=1", "display_name": "CatLord", "link": "https://stackoverflow.com/users/3865814/catlord"}, "edited": false, "score": 0, "creation_date": 1423682814, "post_id": 28462681, "comment_id": 45251364, "body": "So do I need to malloc at all?"}, {"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "reply_to_user": {"reputation": 331, "user_id": 3865814, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cc3c3a5a12f96a50f35f31e3730aab14?s=128&d=identicon&r=PG&f=1", "display_name": "CatLord", "link": "https://stackoverflow.com/users/3865814/catlord"}, "edited": false, "score": 0, "creation_date": 1423683109, "post_id": 28462681, "comment_id": 45251549, "body": "@CatLord, you can, but you don&#39;t need to. You could just read one byte at a time if you want."}], "tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 0, "last_activity_date": 1423682364, "creation_date": 1423682364, "answer_id": 28462681, "question_id": 28462587, "link": "https://stackoverflow.com/questions/28462587/read-jpeg-file-to-char-buffer-c/28462681#28462681", "title": "Read jpeg file to char* buffer c", "body": "<ol>\n<li><code>sizeof(char)</code> is <code>1</code>.</li>\n<li>You don't need to cast the return value of <code>malloc</code> in a C program.</li>\n<li>Using <code>feof()</code> as a loop condition is almost always wrong. Check and use the result of <code>fread</code> instead.</li>\n<li>A binary file's data is unlikely to be a C string. Printing it with <code>%s</code> won't work - write a loop and print each byte out using <code>%02x</code>, for example.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "is_accepted": false, "score": 1, "last_activity_date": 1423694672, "creation_date": 1423694672, "answer_id": 28466006, "question_id": 28462587, "link": "https://stackoverflow.com/questions/28462587/read-jpeg-file-to-char-buffer-c/28466006#28466006", "title": "Read jpeg file to char* buffer c", "body": "<p>You need to open the file in binary mode \"rb\".</p>\n\n<p>As mentioned above, doing a printf of binary jpeg data will not produce useful results.</p>\n"}, {"tags": [], "owner": {"reputation": 554, "user_id": 883569, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0d0b4473e1c1f83c49c13d97302a457e?s=128&d=identicon&r=PG", "display_name": "gigasai", "link": "https://stackoverflow.com/users/883569/gigasai"}, "is_accepted": false, "score": 0, "last_activity_date": 1492014628, "creation_date": 1492014628, "answer_id": 43375000, "question_id": 28462587, "link": "https://stackoverflow.com/questions/28462587/read-jpeg-file-to-char-buffer-c/43375000#43375000", "title": "Read jpeg file to char* buffer c", "body": "<p>What you really want is this</p>\n\n<pre><code>FILE* file = fopen(filePath, \"rb\");\nfseek(file, 0, SEEK_END);\nunsigned long fileLen=ftell(file);\nchar* file_data;\nrewind(file);\nfile_data=malloc((fileLen)*sizeof(char));\nif (file_data == NULL){\n    printf(\"Memory error\"); exit (2);\n}\nint num_read=0;\nchar s;\nwhile ((num_read = fread(&amp;s, 1, 1, file))) {\n    strncat(file_data,&amp;s,1);\n}\n\nprintf(\"file contents: %s\", file_data);\nfclose(file);\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 3865814, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cc3c3a5a12f96a50f35f31e3730aab14?s=128&d=identicon&r=PG&f=1", "display_name": "CatLord", "link": "https://stackoverflow.com/users/3865814/catlord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4259, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1492014628, "creation_date": 1423682125, "question_id": 28462587, "link": "https://stackoverflow.com/questions/28462587/read-jpeg-file-to-char-buffer-c", "title": "Read jpeg file to char* buffer c", "body": "<p>I'm trying to read a jpeg file into a char* buffer so that I can print out the buffer as text. My problem is that I'm only reading the first line. Here's my code:</p>\n\n<pre><code>        FILE* file = fopen(filePath, \"r\");\n        fseek(file, 0, SEEK_END);\n        unsigned long fileLen=ftell(file);\n        fseek(file, 0, SEEK_SET);\n        char* file_data;\n        file_data=(char *)malloc((fileLen+1)*sizeof(char));\n\n        while (!feof(file)) {\n            fread(file_data, fileLen, 1, file);\n        }\n\n        fclose(file);\n        printf(\"%s\\n\", file_data);\n</code></pre>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["c", "linux", "system-calls", "ld-preload"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1423683677, "creation_date": 1423683677, "answer_id": 28463063, "question_id": 28462523, "link": "https://stackoverflow.com/questions/28462523/how-to-wrap-ioctlint-d-unsigned-long-request-using-ld-preload/28463063#28463063", "title": "How to wrap ioctl(int d, unsigned long request, ...) using LD_PRELOAD?", "body": "<p>There is no portable way for one variadic function to forward its variadic arguments to another variadic function.  In part this is because the number and size of the actual arguments must be known at compile time for the compiler to construct the variadic call, but they are not statically known (not even in parametric fashion) inside the called function.</p>\n"}, {"comments": [{"owner": {"reputation": 4857, "user_id": 1405614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9a70943a5d825c32446259aa7e9348?s=128&d=identicon&r=PG", "display_name": "Valeri Atamaniouk", "link": "https://stackoverflow.com/users/1405614/valeri-atamaniouk"}, "edited": false, "score": 1, "creation_date": 1423871923, "post_id": 28467048, "comment_id": 45340431, "body": "I think it is a bit brave to tell that <code>char*p</code> would work for all ABIs... On ARM registers are used up to their availability, for example..."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 4857, "user_id": 1405614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9a70943a5d825c32446259aa7e9348?s=128&d=identicon&r=PG", "display_name": "Valeri Atamaniouk", "link": "https://stackoverflow.com/users/1405614/valeri-atamaniouk"}, "edited": false, "score": 1, "creation_date": 1423873682, "post_id": 28467048, "comment_id": 45340864, "body": "@Valeri Atamaniouk: the use of  <code>char *</code> is just tradition. What matters is that it always is exactly one machine word that will be interpreted as an <code>int</code>, or say a <code>struct termios *</code> by the kernel code that handles the <code>ioctl</code>, dependent on the value of <code>request</code>  (see e.g.<code>man ioctl_list</code>) This word can be passed in a register, or on the stack, independent of the type of <code>argp</code>"}, {"owner": {"reputation": 4857, "user_id": 1405614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9a70943a5d825c32446259aa7e9348?s=128&d=identicon&r=PG", "display_name": "Valeri Atamaniouk", "link": "https://stackoverflow.com/users/1405614/valeri-atamaniouk"}, "edited": false, "score": 1, "creation_date": 1423874362, "post_id": 28467048, "comment_id": 45341025, "body": "Yes, you are right. One extra long type argument if present."}], "tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 7, "last_activity_date": 1423871465, "last_edit_date": 1423871465, "creation_date": 1423699692, "answer_id": 28467048, "question_id": 28462523, "link": "https://stackoverflow.com/questions/28462523/how-to-wrap-ioctlint-d-unsigned-long-request-using-ld-preload/28467048#28467048", "title": "How to wrap ioctl(int d, unsigned long request, ...) using LD_PRELOAD?", "body": "<p>Although John Bollinger is correct in that according to its prototype in <code>ioctl.h</code>, <code>ioctl()</code> is a variadic function, in practice, it is not. </p>\n\n<p>See e.g <a href=\"http://www.makelinux.net/ldd3/chp-6-sect-1\" rel=\"noreferrer\">this quote</a> from the book <a href=\"http://lwn.net/Kernel/LDD3/\" rel=\"noreferrer\">Linux Device Drivers</a></p>\n\n<blockquote>\n  <p>The prototype stands out in the list of Unix system calls because of\n  the dots, which usually mark the function as having a variable number\n  of arguments. In a real system, however, a system call can't actually\n  have a variable number of arguments. System calls must have a\n  well-defined prototype, because user programs can access them only\n  through hardware \"gates.\" Therefore, the dots in the prototype\n  represent not a variable number of arguments but a single optional\n  argument, traditionally identified as char *argp. The dots are simply\n  there to prevent type checking during compilation.</p>\n</blockquote>\n\n<p>So you can write your susbtitute <code>ioctl()</code> as follows:</p>\n\n<pre><code>int ioctl(int d, unsigned long request, char *argp)\n{\n  /* follow the same recipe as for your example gettimeofday() */\n  return ioctl_real(d, request, argp);\n}\n</code></pre>\n\n<p>If you just want to build a wrapper library for use with <code>LD_PRELOAD</code>, the fact that your <code>ioctl</code> signature contradicts the one in <code>sys/ioctl.h</code> is irrelevant: linkers don't check types, and your wrapper library's fake <code>ioctl</code> will be called with exactly the same arguments as the real one would without <code>LD_PRELOAD</code></p>\n"}], "owner": {"reputation": 8608, "user_id": 1091116, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/15098b2b940cacd8b4d07026e01e3102?s=128&d=identicon&r=PG", "display_name": "d33tah", "link": "https://stackoverflow.com/users/1091116/d33tah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2162, "favorite_count": 3, "answer_count": 2, "score": 6, "last_activity_date": 1524196191, "creation_date": 1423681886, "question_id": 28462523, "link": "https://stackoverflow.com/questions/28462523/how-to-wrap-ioctlint-d-unsigned-long-request-using-ld-preload", "title": "How to wrap ioctl(int d, unsigned long request, ...) using LD_PRELOAD?", "body": "<p>Here's the template I use for wrapping a function using LD_PRELOAD:</p>\n\n<pre><code>int gettimeofday(struct timeval *tv, struct timezone *tz) {\n  static int (*gettimeofday_real)(struct timeval *tv, struct timezone *tz)=NULL;\n  if (!gettimeofday_real) gettimeofday_real=dlsym(RTLD_NEXT,\"gettimeofday\");\n  return gettimeofday_real(tv, tz);\n}\n</code></pre>\n\n<p>I realized though that ioctl seems to have the following signature:</p>\n\n<pre><code>   int ioctl(int d, unsigned long request, ...);\n</code></pre>\n\n<p>How could I wrap it in a similar way, given the <code>...</code> that's in the signature?</p>\n"}, {"tags": ["objective-c", "c", "while-loop", "generic-programming"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "edited": false, "score": 0, "creation_date": 1423686695, "post_id": 28462905, "comment_id": 45253526, "body": "It all works perfectly for intervals like 1 and 40, but not for 3 and 10. Between 3 and 10, i should have 2, not 1 twin...but that&#39;s not the output I get."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "edited": false, "score": 0, "creation_date": 1423686873, "post_id": 28462905, "comment_id": 45253615, "body": "Entering 3 and 10, gives two pairs (3,5) and (5,7)."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1423687555, "last_edit_date": 1423687555, "creation_date": 1423683075, "answer_id": 28462905, "question_id": 28462441, "link": "https://stackoverflow.com/questions/28462441/twin-primes-between-2-values-wrong-results/28462905#28462905", "title": "TWIN PRIMES BETWEEN 2 VALUES wrong results", "body": "<p>Your program misses (3 5) because 3 is not trapped as a prime number, and because 4 is not a multiple of 6. Rather than the main loop stepping by (effectively) 6, this answer steps by 1.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint prime (int num) { \n    int div;\n    if (num == 1) return 0;             // excluded 1\n    if (num == 2 || num == 3) return 1; // included 3 too\n    if (num % 2 == 0) return 0;\n    div = 3;\n    while (div*div &lt;= num) {\n        if (num % div == 0)             // moved to within loop\n            return 0;      \n        div += 2;\n    }\n    return 1;\n}\n\nint main(void) {\n    int low, high, i, count, n, m;\n    printf(\"Please enter the values for the lower and upper limits of the interval\\n\");\n    scanf(\"%d%d\", &amp;low, &amp;high);\n    printf(\"THIS IS THE LOW  %d\\n AND THIS IS THE HIGH %d\\n\", low, high);\n    count = 0;\n    for (i=low; i&lt;=high; i++) {\n        n = i-1;\n        m = i+1;\n        if (prime(n) &amp;&amp; prime(m)) {\n            printf (\"%2d %2d\\n\", n, m);\n            ++count;\n        }\n    }\n    printf(\"Number of twin primes is %d\\n\", count);\n    return 0;\n}\n</code></pre>\n\n<p>Program output</p>\n\n<pre><code>1\n40\nTHIS IS THE LOW  1\n AND THIS IS THE HIGH 40\n 3  5\n 5  7\n11 13\n17 19\n29 31\nNumber of twin primes is 5\n</code></pre>\n\n<p>Next run:</p>\n\n<pre><code>3\n10\nTHIS IS THE LOW  3\n AND THIS IS THE HIGH 10\n 3  5\n 5  7\nNumber of twin primes is 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "edited": false, "score": 0, "creation_date": 1423685740, "post_id": 28463227, "comment_id": 45253008, "body": "I tried adding an if statement to count if the starting number is less than 4, less or equal to  5 and equal to 3. It works for when i have intervals that start with 1, such as 1 and 10, 1 and 100 and 1 and 1000000, but when I try intervals like between 3 and 10, it still counts one less twin than it should."}, {"owner": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "edited": false, "score": 0, "creation_date": 1423685849, "post_id": 28463227, "comment_id": 45253065, "body": "The statement I added before my while loop was the following:     if (low&lt;= 5) count = 1;"}, {"owner": {"reputation": 513, "user_id": 4488635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OXIDM.gif?s=128&g=1", "display_name": "markedwardmurray", "link": "https://stackoverflow.com/users/4488635/markedwardmurray"}, "reply_to_user": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "edited": false, "score": 0, "creation_date": 1423687416, "post_id": 28463227, "comment_id": 45253915, "body": "Ok, so it definitely has to do with the unique distance between (3,5) and (5,7). The formula can&#39;t account for it because of this so you have to count it manually if your entered range includes three. I inserted the following if-statement and it works correctly: `    i = low;     count = 0;     if (low &lt;= 3 &amp;&amp; high &gt;= 3){         count ++;  // accounts for (3,5) twin primes if the range includes 3     }`"}], "tags": [], "owner": {"reputation": 513, "user_id": 4488635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OXIDM.gif?s=128&g=1", "display_name": "markedwardmurray", "link": "https://stackoverflow.com/users/4488635/markedwardmurray"}, "is_accepted": false, "score": 0, "last_activity_date": 1423687516, "last_edit_date": 1423687516, "creation_date": 1423684305, "answer_id": 28463227, "question_id": 28462441, "link": "https://stackoverflow.com/questions/28462441/twin-primes-between-2-values-wrong-results/28463227#28463227", "title": "TWIN PRIMES BETWEEN 2 VALUES wrong results", "body": "<p><a href=\"https://primes.utm.edu/lists/small/100ktwins.txt\" rel=\"nofollow\">https://primes.utm.edu/lists/small/100ktwins.txt</a></p>\n\n<p>The five twin primes under forty are (3,5), (5,7), (11,13), (17,19), (29,31) so if you know that your code isn't counting (3,5) then it is working correctly, counting (5,7), (11,13), (17,19), and (29,31).</p>\n\n<p>A possible fix would be to add an if-statement which adds 1 to \"count\" if the starting number is less than 4. I'm not really that used to reading C syntax so I had trouble getting my head around your formulas, sorry.</p>\n\n<p>edit: since comments don't format code snippets:</p>\n\n<p><code>i = low;\n    count = 0;\n    if (low &lt;= 3 &amp;&amp; high &gt;= 3){\n        count ++;  // accounts for (3,5) twin primes if the range includes 3\n    }</code></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 999500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20985e5c0f4978d8c984a4bbd816c333?s=128&d=identicon&r=PG", "display_name": "Keber", "link": "https://stackoverflow.com/users/999500/keber"}, "is_accepted": false, "score": 0, "last_activity_date": 1423742016, "last_edit_date": 1423742016, "creation_date": 1423685808, "answer_id": 28463677, "question_id": 28462441, "link": "https://stackoverflow.com/questions/28462441/twin-primes-between-2-values-wrong-results/28463677#28463677", "title": "TWIN PRIMES BETWEEN 2 VALUES wrong results", "body": "<p>You have a problem in your prime function, this is the output of your prime function for the first ten prime evaluations</p>\n\n<pre><code>for(i=1;i&lt;=10;i++) printf(\"%d\\t%d\",i,prime(i));\n\n1       1\n2       1\n3       0\n4       0\n5       1\n6       0\n7       1\n8       0\n</code></pre>\n\n<p>Note the prime() function from Weather Vane, you should include 3 as prime (and exclude 1).</p>\n\n<hr>\n\n<p>From [1], twin primes are the ones that have a prime gap of two, differing by two from another prime.</p>\n\n<p>Examples are (3,5) , (5,7), (11,13). The format (6n-1,6n+1) is true but for (3,5) as you stated. Your program runs almost ok since it shows the number of twin primes that are in the interval AND follows the rule mentioned above. This doesn't include (3,5). You can make a kind of exception (like if low&lt;=3 add 1 to total count), or use another algorithm to count twin primes (like verify if i is prime, then count distance from i to next prime, if distance=2 then they are twin primes)</p>\n\n<p>[1] <a href=\"http://en.wikipedia.org/wiki/Twin_prime\" rel=\"nofollow\">http://en.wikipedia.org/wiki/Twin_prime</a> </p>\n"}], "owner": {"reputation": 19, "user_id": 4556256, "user_type": "registered", "profile_image": "https://graph.facebook.com/735231573258421/picture?type=large", "display_name": "Karen N.", "link": "https://stackoverflow.com/users/4556256/karen-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1423742016, "creation_date": 1423681584, "last_edit_date": 1423682402, "question_id": 28462441, "link": "https://stackoverflow.com/questions/28462441/twin-primes-between-2-values-wrong-results", "title": "TWIN PRIMES BETWEEN 2 VALUES wrong results", "body": "<p>I've been working on this program to count how many twin primes between two values and it's been specified that twin primes come in the (6n-1, 6n+1) format, with the exception of (3, 5). My code seems to work fine, but it keeps giving me the wrong result....1 less couple of twin primes than i should get. Between 1 and 40, we should have 5 twin primes, but I'm always getting 4. \u00e9</p>\n\n<p>What am I doing wrong? Am I not taking into account (3, 5)?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint prime (int num) { \n    int div;\n    if (num == 2) return 1;\n    if (num % 2 == 0) return 0;\n    div = 3;\n    while (div*div &lt;= num &amp;&amp; num%div != 0)\n        div = div + 2;\n    if (num%div == 0)\n        return 0;\n    else\n        return 1;\n}\n\nint main(void) {\n    int low, high, i, count, n, m;\n    printf(\"Please enter the values for the lower and upper limits of the interval\\n\");\n    scanf(\"%d%d\", &amp;low, &amp;high);\n    printf(\"THIS IS THE LOW  %d\\n AND THIS IS THE HIGH %d\\n\", low, high);\n    i = low;\n    count = 0;\n    while (6*i-1&gt;=low &amp;&amp; 6*i+1&lt;=high) {\n        n = 6*i-1;\n        m = 6*i+1;\n        if (prime(n) &amp;&amp; prime(m)) ++count;\n        i = i + 1;\n    }\n    printf(\"Number of twin primes is %d\\n\", count);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gprof"], "comments": [{"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423789572, "post_id": 28462415, "comment_id": 45302826, "body": "Don&#39;t expect gprof to answer that question for you. <a href=\"http://stackoverflow.com/a/378024/23771\"><i>Here&#39;s what some people do.</i></a>"}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "reply_to_user": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423835549, "post_id": 28462415, "comment_id": 45321421, "body": "@MikeDunlavey While investigating this, I found that answer of yours, which I found very interesting."}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "reply_to_user": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423837252, "post_id": 28462415, "comment_id": 45322401, "body": "@MikeDunlavey When I actually attempted this, my first interrupted placed me in the function in question that takes up 17% of my running time.  Unfortunately my debugger only gave me about 3 levels of the call stack (possibly because that was all that was available in that thread).  I stepped through to find what function it was being called from, and in the time I was willing to spend (about 5 minutes), it did not leave that function."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423847328, "post_id": 28462415, "comment_id": 45328952, "body": "Did you try to see the stack (command &quot;bt&quot;)? That should show you the whole reason why you&#39;re spending the time, so maybe you can find a better way to accomplish the same thing. In my experience, it&#39;s a rare program that can&#39;t be sped up."}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "reply_to_user": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423851015, "post_id": 28462415, "comment_id": 45331039, "body": "@MikeDunlavey I did use the backtrace functionality in my debugger (DDD).  It appears to not be able to cross thread boundries."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1423922789, "post_id": 28462415, "comment_id": 45350052, "body": "I use GDB, and you can say &quot;thread n&quot; to put it in whatever thread you want, then say &quot;bt&quot;. Maybe DDD has something similar?"}], "answers": [{"tags": [], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "is_accepted": true, "score": 0, "last_activity_date": 1423858009, "last_edit_date": 1423858009, "creation_date": 1423852887, "answer_id": 28506462, "question_id": 28462415, "link": "https://stackoverflow.com/questions/28462415/unintelligable-names-in-gprof/28506462#28506462", "title": "unintelligable names in gprof", "body": "<p>I was able to determine that the functions in question were part of the third party library using <a href=\"/questions/tagged/callgrind\" class=\"post-tag\" title=\"show questions tagged 'callgrind'\" rel=\"tag\">callgrind</a>.  </p>\n\n<p>The raw <code>callgrind.out</code> file contains a listing of the functions in the program.  Included in this is what functions are called as a part of the running of each function.  </p>\n\n<p>Using this, I was able to trace up from the functions in question until I reached a function that is part of the library API.</p>\n\n<p>As for the goal of optimization, the API function that is eating up most of my run time (>75%) cannot be called fewer times.  This is making it difficult (although not impossible) to spot other hotspots.</p>\n"}], "owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 28506462, "answer_count": 1, "score": 1, "last_activity_date": 1423858009, "creation_date": 1423681493, "question_id": 28462415, "link": "https://stackoverflow.com/questions/28462415/unintelligable-names-in-gprof", "title": "unintelligable names in gprof", "body": "<p>I am attempting to use <a href=\"/questions/tagged/gprof\" class=\"post-tag\" title=\"show questions tagged 'gprof'\" rel=\"tag\">gprof</a> to profile a program that I have written, and am receiving unintelligible results.  Most of the function names are coming in like <code>_abfcd96687bed377dcecdf193c89698</code>.  I beleive that they are coming from a third party library that I am linking against, which I don't have source code for, so I can't recompile it for profiling.</p>\n\n<p>I would like to understand where these functions are coming from, as one of them accounts for 17% of my running time, and I would like to see if I can reduce the number of calls to that as yet unknown function.</p>\n"}, {"tags": ["c", "thread-safety", "tcl", "core", "panic"], "comments": [{"owner": {"reputation": 1585, "user_id": 110126, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a97e0e8ce453ea59823f78f898a68caf?s=128&d=identicon&r=PG", "display_name": "buzz3791", "link": "https://stackoverflow.com/users/110126/buzz3791"}, "edited": false, "score": 0, "creation_date": 1424203167, "post_id": 28462414, "comment_id": 45449903, "body": "We resolved this crash by using Tcl_DuplicateObj in the reader thread before the reader calls Tcl_SetObjResult.  The writer and reader of the object had already been mutexed but the crash was happening when the writer releases the previous write collided with the tcl interpreter freeing the result object returned by the reader."}], "answers": [{"tags": [], "owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "is_accepted": true, "score": 0, "last_activity_date": 1423689016, "creation_date": 1423689016, "answer_id": 28464549, "question_id": 28462414, "link": "https://stackoverflow.com/questions/28462414/alloc-invalid-block-are-tcl-incrrefcount-and-tcl-decrrefcount-thread-safe-for/28464549#28464549", "title": "alloc: invalid block - Are Tcl_IncrRefCount and Tcl_DecrRefCount thread safe for threaded Tcl / 1 interp per thread?", "body": "<p>The calls <code>Tcl_IncrRefCount</code> (actually a simple macro) and <code>Tcl_DecrRefCount</code> (a complicated macro) are <em>sort of</em> thread safe, but only because each <code>Tcl_Obj</code> should only ever be accessed from the thread that created it; parallel calls to T_IRC and T_DRC are fine, so long as they're on different values. The plus side of this is that accesses don't need locking (and the memory manager for <code>Tcl_Obj</code> structures takes advantage of this).</p>\n\n<p>Note that multi-threaded access is not a good plan at all unless you're <em>very</em> careful, since even reader operations like <code>Tcl_GetIntFromObj</code> can write to the underlying structure if a type transformation needs to be applied. <em>These operations are not locked.</em> Doing it at all needs very intimate knowledge of the current type of the value \u2014 not something that you're usually encouraged to think about in Tcl in the first place, though <code>tcl::unsupported::representation</code> can be helpful with probing this in 8.6 \u2014 and some very careful interlocking between the threads so that one isn't writing while the other is peeking. <strong><em>Don't do this at all</em></strong>, while not 100% accurate, is the approach least likely to lead to headaches.</p>\n\n<p>You probably ought to read more about how you're supposed to do it. <a href=\"http://www.activestate.com/blog/2010/05/concurreny-tcl-weaving-threads\" rel=\"nofollow\">The ActiveState blog</a> has a reasonable introduction.</p>\n"}], "owner": {"reputation": 1585, "user_id": 110126, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a97e0e8ce453ea59823f78f898a68caf?s=128&d=identicon&r=PG", "display_name": "buzz3791", "link": "https://stackoverflow.com/users/110126/buzz3791"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 1, "accepted_answer_id": 28464549, "answer_count": 1, "score": 1, "last_activity_date": 1423689016, "creation_date": 1423681490, "last_edit_date": 1423682787, "question_id": 28462414, "link": "https://stackoverflow.com/questions/28462414/alloc-invalid-block-are-tcl-incrrefcount-and-tcl-decrrefcount-thread-safe-for", "title": "alloc: invalid block - Are Tcl_IncrRefCount and Tcl_DecrRefCount thread safe for threaded Tcl / 1 interp per thread?", "body": "<p>Our 32-bit server application statically embeds tcl 8.4.11.  On Red Hat Linux 6.5 64-bit we're encountering crashes / core dumps.  The failure looks like</p>\n\n<p>alloc: invalid block: 0xf6f00f58: 88 f6 0</p>\n\n<p>At the bottom of the question, I've documented two different core dumps we've seen.</p>\n\n<p>We've isolated a potential root cause to a TCL object shared between two threads concurrently running separate TCL interpreter instances.  We think it's because TCL object is passed to Tcl_IncrRefCount / Tcl_DecrRefCount from these concurrently executing TCL interpreters.</p>\n\n<ol>\n<li>Are Tcl_IncrRefCount / Tcl_DecrRefCount thread safe when TCL is compiled threaded?  </li>\n<li>Are TCL objects shared by TCL interpreter instances?  Is there any way to disable TCL object sharing across interpreter instances?</li>\n<li>Is the situation any better in TCL version 8.6.3?</li>\n</ol>\n\n<pre class=\"lang-none prettyprint-override\"><code>(gdb) bt\n#0  __kernel_vsyscall () at arch/x86/vdso/vdso32/sysenter.S:49\n#1  0x001b7871 in raise (sig=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#2  0x001b914a in abort () at abort.c:92\n#3  0x080f611c in Tcl_PanicVA ()\n#4  0x080f613b in Tcl_Panic ()\n#5  0x0810133c in Ptr2Block ()\n#6  0x08100e04 in TclpFree ()\n#7  0x080b46a7 in Tcl_Free ()\n#8  0x08100686 in FreeStringInternalRep ()\n#9  0x080fdac1 in ResetObjResult ()\n#10 0x080fd316 in Tcl_GetStringResult ()\n#11 0x0808aaad in run_tcl_proc (pDevice=0x8e0ba08, pInterp=0x8d798c0, iNumArgs=2, objv=0x115434c, bIsCommand=0 '\\000', pCommand=0x0)\n#12 0x08093672 in Tcl_begin_next_state (pDevice=0x8e0ba08, iNextState=RunPoll, pCommand=0x0)\n#13 0x08093759 in Tcl_port_thread (dummy=0x8d1cab8)\n#14 0x008bcb39 in start_thread (arg=0x1154b70) at pthread_create.c:301\n#15 0x0026fc2e in clone () at ../sysdeps/unix/sysv/linux/i386/clone.S:133\n(gdb)\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>(gdb) bt\n#0  __kernel_vsyscall () at arch/x86/vdso/vdso32/sysenter.S:49\n#1  0x00395871 in raise (sig=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:64\n#2  0x0039714a in abort () at abort.c:92\n#3  0x080f611c in Tcl_PanicVA ()\n#4  0x080f613b in Tcl_Panic ()\n#5  0x0810133c in Ptr2Block ()\n#6  0x08100e04 in TclpFree ()\n#7  0x080b46a7 in Tcl_Free ()\n#8  0x080d21b6 in TclExecuteByteCode ()\n#9  0x080d1bc1 in TclCompEvalObj ()\n#10 0x080fbd5c in TclObjInterpProc ()\n#11 0x080b026a in TclEvalObjvInternal ()\n#12 0x080d2716 in TclExecuteByteCode ()\n#13 0x080d1bc1 in TclCompEvalObj ()\n#14 0x080fbd5c in TclObjInterpProc ()\n#15 0x080b026a in TclEvalObjvInternal ()\n#16 0x080b0517 in Tcl_EvalObjv ()\n#17 0x0808aa02 in run_tcl_proc (pDevice=0x94a2500, pInterp=0xac2bba0, iNumArgs=2, objv=0x11b034c, bIsCommand=0 '\\000', pCommand=0x0)\n#18 0x08093672 in Tcl_begin_next_state (pDevice=0x94a2500, iNextState=RunPoll, pCommand=0x0)\n#19 0x08093759 in Tcl_port_thread (dummy=0x9365e98)\n#20 0x00356b39 in start_thread (arg=0x11b0b70) at pthread_create.c:301\n#21 0x0044dc2e in clone () at ../sysdeps/unix/sysv/linux/i386/clone.S:133\n(gdb)\n</code></pre>\n"}, {"tags": ["c", "arrays", "count", "character", "words"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1423681578, "post_id": 28462411, "comment_id": 45250609, "body": "<code>if(a[i]=&#39; &#39;)</code> --&gt; <code>if(a[i]==&#39; &#39;)</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423681599, "post_id": 28462411, "comment_id": 45250622, "body": "please use <code>fgets(a, sizeof(a), stdin);</code> because <code>gets()</code> by itself could cause problems."}, {"owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "edited": false, "score": 0, "creation_date": 1423681676, "post_id": 28462411, "comment_id": 45250669, "body": "Can&#39;t i use scanf? i was actually hoping for scanf, but i saw somewhere that as a beginner i should use gets for inputting user data."}, {"owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "edited": false, "score": 0, "creation_date": 1423681736, "post_id": 28462411, "comment_id": 45250706, "body": "By the way, fgets didn&#39;t work either. Do u think my algorithm is wrong somewhere?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423681739, "post_id": 28462411, "comment_id": 45250709, "body": "<code>scanf()</code> would stop when it finds a whitespace. And whoever tells you to use <code>gets()</code> you shouldn&#39;t listen to them any further, it&#39;s a deprecated function, <code>fgets()</code> is much better obviously. Using <code>scanf()</code> or <code>fgets()</code> is not a matter of how skilled you are, but of what you need to do."}, {"owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "edited": false, "score": 0, "creation_date": 1458116155, "post_id": 28462411, "comment_id": 59709877, "body": "@downvoters(whoever they maybe, I am not addressing any particular person, I am just saying in general) .My account has been banned from asking questions and the stackoverflow has asked me to review my questions. I don&#39;t see how this question is wrong by any means. So if there is any improvement, please suggest so, or else please consider upvoting this question, so I get back my ability to ask questions on this site. I like stackoverflow and would like to be part of this community, so I want your help either in terms of suggestions for re-formatting the question or in form of upvotes. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "edited": false, "score": 0, "creation_date": 1423681812, "post_id": 28462453, "comment_id": 45250751, "body": "Man, this is embarrassing. So many silly mistakes in a single day. Thanks a lot, i&#39;ve been searching for this for about 30 minutes now. :D"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 4, "creation_date": 1423681889, "post_id": 28462453, "comment_id": 45250797, "body": "I&#39;d sooner turn up compile warnings than use &quot;Yoda conditions&quot;. With <code>-Wall -Wextra</code>, gcc gave me <code>warning: suggest parentheses around assignment used as truth value [-Wparentheses]</code>."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1423682357, "last_edit_date": 1423682357, "creation_date": 1423681630, "answer_id": 28462453, "question_id": 28462411, "link": "https://stackoverflow.com/questions/28462411/c-program-to-count-words-in-a-given-string-sentence/28462453#28462453", "title": "C program to count words in a given string/sentence?", "body": "<p>You are using the assignment operator <code>=</code> for comparison</p>\n\n<pre><code>if(a[i]=' ')\n</code></pre>\n\n<p>you need <code>==</code></p>\n\n<pre><code>if(a[i] == ' ')\n</code></pre>\n\n<p>some people use this</p>\n\n<pre><code>if (' ' == a[i])\n</code></pre>\n\n<p>to prevent this kind of mistake.</p>\n"}], "owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4023, "favorite_count": 0, "accepted_answer_id": 28462453, "answer_count": 1, "score": -3, "last_activity_date": 1423682357, "creation_date": 1423681480, "question_id": 28462411, "link": "https://stackoverflow.com/questions/28462411/c-program-to-count-words-in-a-given-string-sentence", "title": "C program to count words in a given string/sentence?", "body": "<p>I want to count the words in a given string by counting the spaces between them. Here's the code that i've tried.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;string.h&gt;\nmain()\n{\n int t,i,b=1;\n char a[100];\n printf(\"Enter a sentence: \");\n gets(a);\n t=strlen(a);\n for(i=0;a[i]!='\\0';i++)\n {\n      if(a[i]=' ')\n      {\n           b++;\n      }\n }\n printf(\"The number of words in the above sentence are %d\",b);\n getch();\n}\n</code></pre>\n\n<p>But i am unable to get the output. I keep getting wrong number of words. </p>\n\n<p>Thanks. :D</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423681539, "post_id": 28462393, "comment_id": 45250590, "body": "The problem is not in this code, how are you calling <code>entry()</code>?"}, {"owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "edited": false, "score": 0, "creation_date": 1423681567, "post_id": 28462393, "comment_id": 45250605, "body": "we need to see invocation of <code>void entry(..)</code> to be of any help, but the problem resides there, since the compiler is complaining that you are passing a <code>registro*</code> instead that a <code>registro**</code>, probably you have a <code>registers[0]</code> instead that <code>&amp;registers[0]</code> or you are passing a <code>registro[NUM]</code> instead that a <code>registro*[NUM]</code>."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "edited": false, "score": 0, "creation_date": 1423682044, "post_id": 28462393, "comment_id": 45250878, "body": "I edited the question adding the full program"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1423682930, "post_id": 28462393, "comment_id": 45251439, "body": "Again, the problem is not in this code.  Once the accessor syntax is fixed per Voland&#39;s answer below, this code compiles and runs as-expected. <a href=\"http://ideone.com/OkkYEz\" rel=\"nofollow noreferrer\"><b>see it live</b></a>. Post <b>real</b> code that exhibits the <b>real</b> problem."}, {"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "edited": false, "score": 0, "creation_date": 1423683209, "post_id": 28462393, "comment_id": 45251611, "body": "because it does not compile with the operator -&gt;"}, {"owner": {"reputation": 340494, "user_id": 77567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f74022962edfb2f4bf9e7f497cd14eb?s=128&d=identicon&r=PG", "display_name": "rob mayoff", "link": "https://stackoverflow.com/users/77567/rob-mayoff"}, "edited": false, "score": 1, "creation_date": 1423683937, "post_id": 28462393, "comment_id": 45252058, "body": "It doesn&#39;t compile with <code>-&gt;</code> because that use of <code>-&gt;</code> is incorrect. Why do you insist on using it? VolAnd and Fisher have both given you correct versions of your code."}], "answers": [{"comments": [{"owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "edited": false, "score": 1, "creation_date": 1423683349, "post_id": 28462655, "comment_id": 45251708, "body": "because it does not compile with the operator -&gt;"}], "tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": false, "score": 6, "last_activity_date": 1423682295, "creation_date": 1423682295, "answer_id": 28462655, "question_id": 28462393, "link": "https://stackoverflow.com/questions/28462393/i-cannot-access-the-elements-of-an-array-of-structure-with/28462655#28462655", "title": "I cannot access the elements of an array of structure with -&gt;", "body": "<p>When you use [ ] for pointer you already have a data, so use . instead of -></p>\n\n<pre><code>reg[i].order = i;\n</code></pre>\n\n<p>and the same for printf argument.</p>\n"}, {"comments": [{"owner": {"reputation": 723, "user_id": 2201814, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/nD1Hs.jpg?s=128&g=1", "display_name": "MHSFisher", "link": "https://stackoverflow.com/users/2201814/mhsfisher"}, "reply_to_user": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "edited": false, "score": 0, "creation_date": 1423683752, "post_id": 28462975, "comment_id": 45251950, "body": "remove the Index of reg like this : reg -&gt; order = i; I edited my answer"}, {"owner": {"reputation": 5331, "user_id": 3777428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJ6pq.png?s=128&g=1", "display_name": "eigenchris", "link": "https://stackoverflow.com/users/3777428/eigenchris"}, "edited": false, "score": 1, "creation_date": 1423684661, "post_id": 28462975, "comment_id": 45252426, "body": "I don&#39;t think this works correctly. Ultimately we want to access <code>reg[i].order</code>, which can also written as <code>(*(reg+i)).order</code>, given that <code>reg</code> is a pointer to the base of the array. Accessing <code>reg-&gt;order</code> is really accessing <code>(*reg).order</code>, which is only the first <code>struct</code> in the array. If you run this code, you&#39;ll find you only initialized the contents of the first <code>struct</code> properly, while the rest contain garbage."}], "tags": [], "owner": {"reputation": 723, "user_id": 2201814, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/nD1Hs.jpg?s=128&g=1", "display_name": "MHSFisher", "link": "https://stackoverflow.com/users/2201814/mhsfisher"}, "is_accepted": false, "score": 3, "last_activity_date": 1423683894, "last_edit_date": 1423683894, "creation_date": 1423683372, "answer_id": 28462975, "question_id": 28462393, "link": "https://stackoverflow.com/questions/28462393/i-cannot-access-the-elements-of-an-array-of-structure-with/28462975#28462975", "title": "I cannot access the elements of an array of structure with -&gt;", "body": "<p>I tried your code like this and whole of the array printed exactly true:</p>\n\n<pre><code>for (i = 0; i &lt; num_regs; i++){\n    reg-&gt;order = i;\n    printf(\"\\n order = %d\", reg-&gt;order);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1423684036, "post_id": 28463050, "comment_id": 45252114, "body": "Thanks for detailed explanation."}], "tags": [], "owner": {"reputation": 5331, "user_id": 3777428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJ6pq.png?s=128&g=1", "display_name": "eigenchris", "link": "https://stackoverflow.com/users/3777428/eigenchris"}, "is_accepted": true, "score": 2, "last_activity_date": 1423738445, "last_edit_date": 1423738445, "creation_date": 1423683621, "answer_id": 28463050, "question_id": 28462393, "link": "https://stackoverflow.com/questions/28462393/i-cannot-access-the-elements-of-an-array-of-structure-with/28463050#28463050", "title": "I cannot access the elements of an array of structure with -&gt;", "body": "<p>You need to understand the difference between the <code>-&gt;</code> and <code>.</code> operators when accessing data inside of a <code>struct</code>.</p>\n\n<ul>\n<li><code>s.a</code> is just for when <code>s</code> is a <code>struct</code> and <code>a</code> is a member of <code>s</code></li>\n<li><code>sp-&gt;a</code> is really just a shorthand for <code>(*sp).a</code> This is used when <code>sp</code> is a pointer-to-<code>struct</code>, and we want to dereference that pointer and access the <code>struct</code>'s data all in one step.</li>\n</ul>\n\n<p>As VolAnd said , you are using <code>reg[i]-&gt;order</code> but you should really be using <code>reg[i].order</code>.</p>\n\n<hr>\n\n<p>If it's still unclear...</p>\n\n<p>With your <code>entry()</code> function, you are passing in an array of 10 record <code>structs</code> called <code>reg</code>. You do this by passing a pointer to the array's base address, so the function accepts a pointer of type <code>record*</code>.</p>\n\n<p>The elements of the array are <code>structs</code>, <strong>not  <code>struct</code> pointers</strong>, so you access them with <code>reg[i].order</code>, not <code>reg[i]-&gt;order</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 2256138, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/EpJ2H.jpg?s=128&g=1", "display_name": "PravinY", "link": "https://stackoverflow.com/users/2256138/praviny"}, "is_accepted": false, "score": 0, "last_activity_date": 1423742012, "creation_date": 1423742012, "answer_id": 28476776, "question_id": 28462393, "link": "https://stackoverflow.com/questions/28462393/i-cannot-access-the-elements-of-an-array-of-structure-with/28476776#28476776", "title": "I cannot access the elements of an array of structure with -&gt;", "body": "<p>Here you are passing address of array and storing / collecting is in pointer.\nAnd as the pointer is pointing to array, if you use -> operator to access the structure element it will treat array as pointer and throws error as \"error: invalid type argument of \u00e2->\u00e2 (have \u00e2record\u00e2)\".</p>\n\n<p>So you have to use (.) operator instade of (->) operator.</p>\n\n<pre><code>for (i = 0; i &lt; num_regs; i++)\n{\n    reg[i].order = i;\n    printf(\"\\n order = %d\", reg[i].order);\n}\n</code></pre>\n"}], "owner": {"reputation": 1131, "user_id": 3780071, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lq0ha.png?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3780071/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1494, "favorite_count": 0, "accepted_answer_id": 28463050, "answer_count": 4, "score": 1, "last_activity_date": 1423742012, "creation_date": 1423681389, "last_edit_date": 1423681846, "question_id": 28462393, "link": "https://stackoverflow.com/questions/28462393/i-cannot-access-the-elements-of-an-array-of-structure-with", "title": "I cannot access the elements of an array of structure with -&gt;", "body": "<p>I'm having a little problem with a function which receives as a parameter an array of structures, the problem occurs when trying to access array elements with operator -></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct{\n    int order;\n}record;\n\nvoid entry(record*reg, size_t num_regs);\n\nint main(void){\n    record reg[10];\n    entry(reg, sizeof reg / sizeof reg[0]);\n\n    return 0;\n}\n\nvoid entry(record*reg, size_t num_regs){\n    size_t i;\n\n    for (i = 0; i &lt; num_regs; i++){\n        reg[i]-&gt;order = i;\n        printf(\"\\n order = %d\", reg[i]-&gt;order);\n    }\n}\n</code></pre>\n\n<p>throws this error if you try to compile\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>*error #2140: Type error in argument 1 to 'ingreso'; expected 'registro * *' but found 'registro *'.*\n</code></pre>\n\n<p>because it throws this error and how to fix it?</p>\n"}, {"tags": ["c", "int"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423680625, "post_id": 28462050, "comment_id": 45250052, "body": "Why is it so big? I though you was asking about type width and what&#39;s the maximum value you can store an <code>unsigned int</code> but why such a large array? The question  title is misleading."}, {"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423682681, "post_id": 28462050, "comment_id": 45251276, "body": "@iharob: I&#39;m a little confused on that point myself.  OP seems to have multiplied the five known <a href=\"http://oeis.org/A019434\" rel=\"nofollow noreferrer\">Fermat primes</a> together to get a number approximately equal to 2^31.  I don&#39;t see the purpose of that."}], "answers": [{"tags": [], "owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "is_accepted": false, "score": 3, "last_activity_date": 1423680514, "creation_date": 1423680514, "answer_id": 28462101, "question_id": 28462050, "link": "https://stackoverflow.com/questions/28462050/working-with-large-integer-arrays/28462101#28462101", "title": "Working with large integer arrays", "body": "<p>According to Google, your <code>A</code> array is <a href=\"https://www.google.com/search?q=4294967295+*+4+bytes\" rel=\"nofollow\">approximately 17 gigabytes</a>.  That's a lot.  You're probably overflowing the stack.</p>\n\n<p>If you really need this much memory, you may be able to <code>malloc()</code> it instead, but on <a href=\"http://en.wikipedia.org/wiki/Physical_Address_Extension\" rel=\"nofollow\">older</a> 32-bit architectures, you're basically out of luck (address space has a hard upper limit of 4 GB, minus kernel space).</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 1, "last_activity_date": 1423680855, "last_edit_date": 1423680855, "creation_date": 1423680542, "answer_id": 28462111, "question_id": 28462050, "link": "https://stackoverflow.com/questions/28462050/working-with-large-integer-arrays/28462111#28462111", "title": "Working with large integer arrays", "body": "<p>Memory for arrays is allocated on stack and its size is generally small and will result in stack overflow. You need to allocate memory on heap for such a large array. Either place   </p>\n\n<pre><code>unsigned int A[429496729];  \n</code></pre>\n\n<p>out side the <code>main</code> or use dynamic memory allocation  </p>\n\n<pre><code>unsigned int *A = malloc(sizeof(int)*sz); \nif(A == NULL)\n    exit(0);  \n</code></pre>\n\n<p>Use <code>free(A)</code> to free the allocated memory once you are done with <code>A</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": false, "score": 0, "last_activity_date": 1423681022, "creation_date": 1423681022, "answer_id": 28462277, "question_id": 28462050, "link": "https://stackoverflow.com/questions/28462050/working-with-large-integer-arrays/28462277#28462277", "title": "Working with large integer arrays", "body": "<p>Better use define constants from <code>limits.h</code>, such as UINT_MAX or ULONG_MAX, and check what type is used for indexing of arrays (perhaps your unsigned int transformed to int)</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 1966904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaffbead10d196649a3d05fe4c4d54ac?s=128&d=identicon&r=PG", "display_name": "Th30n", "link": "https://stackoverflow.com/users/1966904/th30n"}, "is_accepted": false, "score": 2, "last_activity_date": 1423683153, "last_edit_date": 1423683153, "creation_date": 1423681186, "answer_id": 28462331, "question_id": 28462050, "link": "https://stackoverflow.com/questions/28462050/working-with-large-integer-arrays/28462331#28462331", "title": "Working with large integer arrays", "body": "<p>You are allocating an array of 16-17GB which overflows the stack.\nAs haccks said you can try allocating on heap.</p>\n\n<pre><code>unsigned int *A = malloc(sizeof(int)*sz); \nif(A == NULL) {\n    printf(\"Unable to allocate memory for array.\\n\");\n    exit(1);\n}\n</code></pre>\n\n<p>Don't forget to free afterwards:</p>\n\n<pre><code>    ...\n    free(A);\n    return 0;\n}\n</code></pre>\n\n<p>And you also have a bug in your code. Array is indexed from <code>0</code> to <code>size - 1</code>.\nThis will when <code>i</code> becomes <code>sz</code> write to invalid memory.</p>\n\n<pre><code>for(i=1;i&lt;=sz;i++) { // Will cause invalid memory write\n    A[i]=A[j]+1 ;\n    j++;\n    printf(\"%u\\n\",A[i]); \n}\n</code></pre>\n\n<p>Change to:</p>\n\n<pre><code>for(i=1; i &lt; sz; i++) {\n    A[i] = A[j] + 1;\n    j++;\n    printf(\"%u\\n\", A[i]); \n}\n</code></pre>\n"}], "owner": {"reputation": 336, "user_id": 3661591, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/66aa38864c58111b5a03f6e6512be08c?s=128&d=identicon&r=PG&f=1", "display_name": "Leo103", "link": "https://stackoverflow.com/users/3661591/leo103"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1423683153, "creation_date": 1423680342, "last_edit_date": 1423680933, "question_id": 28462050, "link": "https://stackoverflow.com/questions/28462050/working-with-large-integer-arrays", "title": "Working with large integer arrays", "body": "<p>How to work with large integer, do I need GMP libraries or something?<br>\nI want an array that has elements starting from 0 to 2^32 <br>\nHow to get this to work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){\nunsigned int i,j=0,sz=4294967295;\nunsigned int A[sz];\n\nA[j]=0;\n\nfor(i=1;i&lt;=sz;i++){\n    A[i]=A[j]+1 ;\n    j++;\n printf(\"%u\\n\",A[i]); \n}    \nreturn 0;\n}\n</code></pre>\n\n<p>error: process exited with return value 3221225725 <br>\nis it that the array is too big or something??</p>\n"}, {"tags": ["c", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423679070, "post_id": 28461513, "comment_id": 45249114, "body": "<code>if(newPtr-&gt;data == NULL)  free(newPtr);</code> and you dereference the <code>free()</code>d pointer immediaetly after that. You must return from the function after freeing."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423679289, "post_id": 28461513, "comment_id": 45249234, "body": "seriously? <code>strtok(line, &quot;\\n&quot;);</code>, just <code>if (line[read - 1] == &#39;\\n&#39;) line[--read] = &#39;\\0&#39;;</code> would be fine and more explicit. Don&#39;t take it the wrong way, I think you are going to be a great programmer."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423680531, "post_id": 28461513, "comment_id": 45249990, "body": "@iharob: I didn&#39;t read through the code to find the context, but your 3rd point has different semantics --- it copies the value into whatever <code>ptr</code> was previous pointing at (instead of just changing <code>ptr</code>)."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423680700, "post_id": 28461513, "comment_id": 45250092, "body": "@Tim\u010cas absolutely right, i am deleting the comment."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1423733599, "post_id": 28461513, "comment_id": 45271377, "body": "First there was a link to the code; then there was the code; now there is neither. So what are we debugging here?"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679899, "post_id": 28461641, "comment_id": 45249596, "body": "@WeatherVane Because the original code was at a link and I copied it formatted it and pasted it here."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1423679135, "creation_date": 1423679135, "answer_id": 28461641, "question_id": 28461513, "link": "https://stackoverflow.com/questions/28461513/to-allocate-or-not-to-allocate-invalid-read-of-size-1-errors-staring-for-2-ho/28461641#28461641", "title": "To allocate or not to allocate. Invalid read of size 1 errors. [Staring for 2 hours]", "body": "<p>On line 138, if the condition is false (could not allocate space for string) then you forget to return, i.e.:</p>\n\n<pre><code>if(newPtr-&gt;data == NULL) {\n    free(newPtr);\n    return;\n}\n</code></pre>\n\n<p>This, if it happens, will surely cause memory problems. There may be other problems (still searching...)</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679659, "post_id": 28461779, "comment_id": 45249437, "body": "Good catch - and set <code>len = 0</code> too."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679730, "post_id": 28461779, "comment_id": 45249480, "body": "@WeatherVane I don&#39;t remember if that is required, let me check the manual."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679784, "post_id": 28461779, "comment_id": 45249512, "body": "@WeatherVane it wouldn&#39;t be bad but the manual says that if the first argument is <code>NULL</code> then <code>*n</code>  value will be ignored."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679821, "post_id": 28461779, "comment_id": 45249540, "body": "Sorry where I looked it said both!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679840, "post_id": 28461779, "comment_id": 45249560, "body": "@WeatherVane Ok ill add it then."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679864, "post_id": 28461779, "comment_id": 45249572, "body": "Upvoted anyway for a good catch. <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/getline.3.html</a>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423679945, "post_id": 28461779, "comment_id": 45249619, "body": "@WeatherVane my local manpage says <code>If *lineptr is NULL, then getline() will allocate a buffer for storing the line, which should be freed by the user program.  (In  this  case,  the  value  in  *n  is        ignored.)</code> And I copied that text from the page displayed in my konsole window."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423680078, "post_id": 28461779, "comment_id": 45249709, "body": "I think I need to update my manpages package, I use a custom linux which has my own package manager, so I need to check for updates manually for now."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 2, "last_activity_date": 1423679858, "last_edit_date": 1423679858, "creation_date": 1423679532, "answer_id": 28461779, "question_id": 28461513, "link": "https://stackoverflow.com/questions/28461513/to-allocate-or-not-to-allocate-invalid-read-of-size-1-errors-staring-for-2-ho/28461779#28461779", "title": "To allocate or not to allocate. Invalid read of size 1 errors. [Staring for 2 hours]", "body": "<p>After you free <code>line</code> the first time you should set it to <code>NULL</code> and <code>len</code> to <code>0</code></p>\n\n<pre><code>if (line)\n    free(line);\nline = NULL; /* make it NULL so you can call getline() again or just don't free it yet */\nlen  = 0;\n</code></pre>\n\n<p>other wise subsequent calls to <code>getline()</code> will try to access the invalid pointer.</p>\n\n<p>Also, as I commented</p>\n\n<pre><code>if(newPtr-&gt;data == NULL)\n    free(newPtr);\n</code></pre>\n\n<p>is wrong because you will dereference <code>newPtr</code> anyway, so you must</p>\n\n<pre><code>if (newPtr-&gt;data == NULL)\n{\n    free(newPtr);\n    return;\n}\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 1, "accepted_answer_id": 28461779, "answer_count": 2, "score": 0, "last_activity_date": 1423688430, "creation_date": 1423678679, "last_edit_date": 1423688430, "question_id": 28461513, "link": "https://stackoverflow.com/questions/28461513/to-allocate-or-not-to-allocate-invalid-read-of-size-1-errors-staring-for-2-ho", "title": "To allocate or not to allocate. Invalid read of size 1 errors. [Staring for 2 hours]", "body": "<p>This is the code I'm working on</p>\n\n<pre><code>code\n</code></pre>\n\n<p>However there are problems. Some or all might be because of not allocating space for <code>data</code> in nodes (line 135~) because the <code>line</code> is changing during iteration in <code>main</code>. But when I allocate space for it, at line 135, the outcome doesn't change much and there is memory leak. I'm stuck.</p>\n\n<p>I'm about to go crazy. Can you help me to fix errors? </p>\n\n<p>Any help is appreciated. Thank you!</p>\n\n<p>Output:\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>a@ubuntu:~/os/hw1$ ./o f1.txt f2.txt o.txt\n*** Error in `./o': double free or corruption (fasttop): 0x0000000001e8b250 ***\nAborted (core dumped)\n</code></pre>\n\n<p>Valgrind:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>a@ubuntu:~/os/hw1$ valgrind --leak-check=full ./o f1.txt f2.txt o.txt\n==21643== Memcheck, a memory error detector\n==21643== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==21643== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==21643== Command: ./o f1.txt f2.txt o.txt\n==21643== \n==21643== Invalid write of size 2\n==21643==    at 0x4C2F843: __GI_memcpy (vg_replace_strmem.c:917)\n==21643==    by 0x4EA5ED7: getdelim (iogetdelim.c:115)\n==21643==    by 0x400959: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid write of size 1\n==21643==    at 0x4EA5FD4: getdelim (iogetdelim.c:122)\n==21643==    by 0x400959: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c2 is 2 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4EC28BC: strtok (strtok.S:137)\n==21643==    by 0x40092F: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4EC28EC: strtok (strtok.S:163)\n==21643==    by 0x40092F: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4EC28F3: strtok (strtok.S:167)\n==21643==    by 0x40092F: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c1 is 1 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid write of size 1\n==21643==    at 0x4EC2919: strtok (strtok.S:186)\n==21643==    by 0x40092F: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c1 is 1 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4C2EC31: strcmp (vg_replace_strmem.c:755)\n==21643==    by 0x400A67: insert (in /home/a/os/hw1/o)\n==21643==    by 0x400942: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4C2DB62: strlen (vg_replace_strmem.c:412)\n==21643==    by 0x4EBF66D: strdup (strdup.c:41)\n==21643==    by 0x400ABB: insert (in /home/a/os/hw1/o)\n==21643==    by 0x400942: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4C2DB74: strlen (vg_replace_strmem.c:412)\n==21643==    by 0x4EBF66D: strdup (strdup.c:41)\n==21643==    by 0x400ABB: insert (in /home/a/os/hw1/o)\n==21643==    by 0x400942: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c1 is 1 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 2\n==21643==    at 0x4C2F840: __GI_memcpy (vg_replace_strmem.c:917)\n==21643==    by 0x400ABB: insert (in /home/a/os/hw1/o)\n==21643==    by 0x400942: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid read of size 1\n==21643==    at 0x4C2EC48: strcmp (vg_replace_strmem.c:755)\n==21643==    by 0x400A67: insert (in /home/a/os/hw1/o)\n==21643==    by 0x400942: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c1 is 1 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== Invalid free() / delete / delete[] / realloc()\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x400985: main (in /home/a/os/hw1/o)\n==21643==  Address 0x51fc2c0 is 0 bytes inside a block of size 120 free'd\n==21643==    at 0x4C2BCD7: free (vg_replace_malloc.c:473)\n==21643==    by 0x4008F6: main (in /home/a/os/hw1/o)\n==21643== \n==21643== \n==21643== HEAP SUMMARY:\n==21643==     in use at exit: 0 bytes in 0 blocks\n==21643==   total heap usage: 10 allocs, 11 frees, 1,878 bytes allocated\n==21643== \n==21643== All heap blocks were freed -- no leaks are possible\n==21643== \n==21643== For counts of detected and suppressed errors, rerun with: -v\n==21643== ERROR SUMMARY: 22 errors from 12 contexts (suppressed: 0 from 0)\n</code></pre>\n"}, {"tags": ["c", "pointers", "kernel", "osdev"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 2, "creation_date": 1423679014, "post_id": 28461472, "comment_id": 45249082, "body": "You might benefit from re-reading pointer-arithmetic basics (always scaled by the underlying type). Or maybe operator-precedence (cast has higher precedence than <code>+</code>)."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423680589, "post_id": 28461472, "comment_id": 45250036, "body": "Also, you might want to use <code>volatile</code> here to make sure the compiler doesn&#39;t try to be smart and optimize the assignments away."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4555935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27deb160ad77f4506ba7508ed2d06563?s=128&d=identicon&r=PG&f=1", "display_name": "kenshooak", "link": "https://stackoverflow.com/users/4555935/kenshooak"}, "edited": false, "score": 0, "creation_date": 1423680013, "post_id": 28461633, "comment_id": 45249669, "body": "Thank you very much, I absolutely missed that the different bracketing might have an effect on the result!"}], "tags": [], "owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "is_accepted": true, "score": 4, "last_activity_date": 1423679450, "last_edit_date": 1423679450, "creation_date": 1423679118, "answer_id": 28461633, "question_id": 28461472, "link": "https://stackoverflow.com/questions/28461472/strange-behaviour-of-c-pointers-with-memory-mapped-i-o/28461633#28461633", "title": "Strange behaviour of C pointers with memory mapped I/O", "body": "<p>If you add an integer <code>n</code> to a <code>&lt;type&gt;</code> pointer the address is incremented by <code>sizeof( &lt;type&gt; ) * n</code> bytes.\nSo in your first example, you have</p>\n\n<pre><code>*((uint16_t *)0xB8000 + 2) = 0x0741;\n</code></pre>\n\n<p>so what happens here is: 0xB8000 is cast to <code>unit16_t *</code> and then that pointer is incremented by 2 which means <code>2 * sizeof( uint16_t )</code> = 4 Bytes</p>\n\n<p>In your second example you have</p>\n\n<pre><code> *(uint16_t *)(0xB8000 + 1)\n</code></pre>\n\n<p>Notice the different bracketing: here you first add 1 to 0xB8000 -- a simple integer operation -- and cast the result.</p>\n"}], "owner": {"reputation": 13, "user_id": 4555935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27deb160ad77f4506ba7508ed2d06563?s=128&d=identicon&r=PG&f=1", "display_name": "kenshooak", "link": "https://stackoverflow.com/users/4555935/kenshooak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 28461633, "answer_count": 1, "score": 1, "last_activity_date": 1423679450, "creation_date": 1423678557, "question_id": 28461472, "link": "https://stackoverflow.com/questions/28461472/strange-behaviour-of-c-pointers-with-memory-mapped-i-o", "title": "Strange behaviour of C pointers with memory mapped I/O", "body": "<p>I am currently working on writing a basic operating system as a learning project. I use a gcc 4.9.2 cross compiler for this purpose.\nWhen trying to use memory-mapped I/O I stumbled upon behaviour of C pointers (or possibly memory-mapped I/O) which I fail to understand.\nWhen directly accessing the I/O memory through following code, I get the expected result, which is an \"AB\" in the top left corner in light grey font on black background.</p>\n\n<pre><code>*((uint16_t *)0xB8000) = 0x0741;\n*((uint16_t *)0xB8002) = 0x0742;\n</code></pre>\n\n<p>However when trying to manipulate the memory through the use of an offset adding 2 to the base address the result is not as expected an \"A\" in second but in third position.</p>\n\n<pre><code>*((uint16_t *)0xB8000 + 2) = 0x0741;\n</code></pre>\n\n<p>Adding 1 instead of 2 prints out the letter in second position, however I do not understand why. Since every letter (in MMIO) is composed of 2 bytes of data I would assume that I need to increase the memory address which I write to by 2 for the next character. (As I did at first by writing directly to 0xB8002)\nIn order to try and understand this behaviour I did some testing in a separate C program but was unable to replicate this behaviour:\n(Note: This code was compiled using normal gcc 4.8.2)</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main(void) {\n        printf(\"0xB8000 + 1 = %x\\n\", 0xB8000 + 1);\n        printf(\"&amp;(*(uint16_t *)(0xB8000 + 1)) = %x\\n\", (uint32_t)&amp;(*(uint16_t *)(0xB8000 + 1)));\n}\n</code></pre>\n\n<p>This program produced following output:</p>\n\n<pre><code>0xB8000 + 1 = b8001\n&amp;(*(uint16_t *)(0xB8000 + 1)) = b8001\n</code></pre>\n\n<p>I assume that I am missing some kind of behaviour of C pointers which causes the factoring in of the size of data which is written by a statement. Is this the case or is there a different reason that I have overlooked?</p>\n\n<p>Regards, Kenshooak</p>\n"}, {"tags": ["c", "memory-management", "malloc"], "answers": [{"comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1423678469, "post_id": 28461381, "comment_id": 45248786, "body": "I think the OP may be referring to the apparent 316k allocation size versus the 300k requested."}, {"owner": {"reputation": 385, "user_id": 2352622, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Zclss.jpg?s=128&g=1", "display_name": "Diwakar Sharma", "link": "https://stackoverflow.com/users/2352622/diwakar-sharma"}, "edited": false, "score": 0, "creation_date": 1423678613, "post_id": 28461381, "comment_id": 45248858, "body": "Yes actually that&#39;s kind of weird... looking at addresses it suggests 16Bytes.. while column suggests 316K .. Though 16Bytes looks sensible (16K is way too much for that purpose).. But why this column says 316K"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 1, "creation_date": 1423679326, "post_id": 28461381, "comment_id": 45249252, "body": "What&#39;s probably happening is that the C runtime has allocated 316K from the operating system so that it has plenty of memory available to quickly satisfy future malloc calls of your program."}], "tags": [], "owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "is_accepted": false, "score": 2, "last_activity_date": 1423678260, "creation_date": 1423678260, "answer_id": 28461381, "question_id": 28461302, "link": "https://stackoverflow.com/questions/28461302/malloc-anonymous-mapping-and-magic-area/28461381#28461381", "title": "malloc : Anonymous mapping and magic area", "body": "<p>The difference is not 16KB, it is 16 bytes.  Which most probably corresponds to the header that malloc has to allocate before your memory block so as to link blocks together, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 2501921, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ba89206691a9b80f87abe01cebe4660c?s=128&d=identicon&r=PG", "display_name": "cmidi", "link": "https://stackoverflow.com/users/2501921/cmidi"}, "is_accepted": false, "score": 1, "last_activity_date": 1424060006, "last_edit_date": 1424060006, "creation_date": 1423684890, "answer_id": 28463397, "question_id": 28461302, "link": "https://stackoverflow.com/questions/28461302/malloc-anonymous-mapping-and-magic-area/28463397#28463397", "title": "malloc : Anonymous mapping and magic area", "body": "<p>To start with any OS which has a Memory management unit  manages all it's memory (heap, code space, stacks I/O memory) using the MMU, all memory exists in a virtual space and page tables are used to translate the virtual addresses into physical addresses, the mapping to physical memory is dependent on the OS</p>\n\n<p><code>malloc</code> will return a pointer to heap memory using sbrk call which in turn will increase the heap size, the MMU when this memory is accessed will then  allocates actual physical page and maps to the virtual address.</p>\n\n<p>According to pmap manual page the output shows and not the allocated memory block size from malloc but the virtual mapping size.</p>\n\n<pre><code> \"Virtual Mapping Size (Kbytes)\n\n     The virtual size in kilobytes of each mapping.\"\n</code></pre>\n\n<p>For a quick experiment to  check if the block size of the memory returned from malloc should be equal to the output from <code>pmap</code>.</p>\n\n<p>To prove the point I did a quick test using this code</p>\n\n<pre><code> int main(int argc, char **argv)\n {\n      char *timeBuf = (char *)malloc(100);\n      printf(\"allocated address is %p\\n\",timeBuf);\n      int i;\n      for(i =0 ;i &lt; atoi(argv[1]);i++)\n      {              \n      }\n      return 0;\n}\n</code></pre>\n\n<p>the pmap output is:</p>\n\n<pre><code>`0000000001338000    132K rw---    [ anon ]`\n</code></pre>\n\n<p>The returned pointer from malloc: </p>\n\n<p><code>allocated address is 0x1338010</code></p>\n\n<p>I think the 16 bytes is kept by malloc for book keeping in it's headers as mentioned in previous answers. As you can se the allocated memory in program is just 100 bytes but the pmap virtual memory size is 132K</p>\n\n<p>So to answer your question in short no this is not related to the magic area.</p>\n"}], "owner": {"reputation": 385, "user_id": 2352622, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Zclss.jpg?s=128&g=1", "display_name": "Diwakar Sharma", "link": "https://stackoverflow.com/users/2352622/diwakar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1424060006, "creation_date": 1423678032, "question_id": 28461302, "link": "https://stackoverflow.com/questions/28461302/malloc-anonymous-mapping-and-magic-area", "title": "malloc : Anonymous mapping and magic area", "body": "<p>I was just fiddling around memory mappings and wanted to view user space virtual memory region mappings. Wrote some lines like</p>\n\n<pre><code>char *ptr = NULL;\nprintf(\"Allocating 300KB\\n\");\nptr = malloc (300*1024);    \nprintf(\"Allocated at %p.. sleeping\\n\", ptr);\nsleep (30);\nfree (ptr);\nprintf(\"Freed... sleeping\\n\");\nsleep (30);    \n</code></pre>\n\n<p>On running the program, <code>pmap</code> on the pid shows allocated region as:</p>\n\n<pre><code>00007f73b1e57000    316K rw---    [ anon ]\n</code></pre>\n\n<p>while program o/p says:</p>\n\n<pre><code>Allocated at 0x7f73b1e57010.. sleeping\n</code></pre>\n\n<p>Is this 16KB extra allocation for what we call magic region on allocation?\nIn the kernel, the corresponding <code>vm_area_struct</code> will hold ranges visible to program or the entire range from starting of magic region?</p>\n"}, {"tags": ["c", "memory-management", "operating-system", "disk"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1423689309, "post_id": 28461267, "comment_id": 45254915, "body": "This question looks like very good downvote candidate due to &quot;does not show any research effort&quot; and especially &quot;unclear or not useful&quot;. It looks like some abstract something resulting from misunderstanding of some coding problem. Please <b>explain</b> what <b>exactly</b> do you need to know and why. Illustrate your question with some practical <code>C</code> coding problem, although registers are more in the scope of the <code>assembly</code> language (where your answer would be more obvious)"}], "answers": [{"tags": [], "owner": {"reputation": 102935, "user_id": 35092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a0QNl.jpg?s=128&g=1", "display_name": "Charlie Martin", "link": "https://stackoverflow.com/users/35092/charlie-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1423678643, "creation_date": 1423678643, "answer_id": 28461499, "question_id": 28461267, "link": "https://stackoverflow.com/questions/28461267/is-there-data-transfer-between-register-cache-and-main-memory-when-calling-mallo/28461499#28461499", "title": "Is there data transfer between register/cache and main memory when calling malloc() and free()", "body": "<p>Well, the answer is either yes or no, but we don't know enough to say for sure, becase a lot of those things are determined by the underlying architecture; also, there are a lot of piece and moving parts in a modern processor.</p>\n\n<p>But the practical answer in most any machine is \"yes\", because registers are involved int eh calling squence, in the context switch to allocate new physical memory and map it into the virtual memory, in the cache hit that happens with malloc first accesses that memory and when it first updates its datastructures.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423678643, "creation_date": 1423677907, "last_edit_date": 1423678268, "question_id": 28461267, "link": "https://stackoverflow.com/questions/28461267/is-there-data-transfer-between-register-cache-and-main-memory-when-calling-mallo", "title": "Is there data transfer between register/cache and main memory when calling malloc() and free()", "body": "<p>malloc() and free() are used to allocate and deallocate space in main memory.\nDoes that mean that there is no data transfer between the space in the main memory and the registers (or cpu caches) when calling them?</p>\n\n<p>If there is no, are there similar operations/functions for allocating and deallocating space on disk without data transfer between the space on the disk and the main memory?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "c", "linker", "namespaces", "name-mangling"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1423678015, "post_id": 28461212, "comment_id": 45248549, "body": "No, either you have an <code>extern &quot;C&quot; foo_bar</code> forwarding to <code>foo::bar</code> or drop the bar from the namespace foo and just <code>extern &quot;C&quot; foo_bar</code> (implementing the function)"}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423678386, "post_id": 28461212, "comment_id": 45248741, "body": "What do you mean by &quot;forwarding&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1423678705, "post_id": 28461212, "comment_id": 45248910, "body": "Forwarding: <code>extern &quot;C&quot; int foo_bar(int x) { return foo::bar(x); }</code>"}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423680287, "post_id": 28461212, "comment_id": 45249840, "body": "@DieterL&#252;cking: That&#39;s the opposite of what I&#39;m trying to do. I think you meant <code>extern &quot;C&quot; int foo_bar(int);</code> and <code>namespace foo { int bar(int x) { return foo_bar(x); } }</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1423681026, "post_id": 28461212, "comment_id": 45250295, "body": "Matt: It depends, the first implementation (either C or C++) stays, the other forwards to the existing."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423682116, "post_id": 28461212, "comment_id": 45250918, "body": "@DieterL&#252;cking: There is no existing implementation. It&#39;s supposed to be implemented in <code>foo.c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423678477, "post_id": 28461271, "comment_id": 45248792, "body": "That&#39;s the opposite of what I&#39;m trying to do. But anyway, a wrapper would be my backup plan."}, {"owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "reply_to_user": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 1, "creation_date": 1423679839, "post_id": 28461271, "comment_id": 45249558, "body": "Got it.  I know you&#39;re hoping for something cleaner and I&#39;m watching the thread myself to what you come up with (fingers crossed)."}], "tags": [], "owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "is_accepted": false, "score": 1, "last_activity_date": 1423677918, "creation_date": 1423677918, "answer_id": 28461271, "question_id": 28461212, "link": "https://stackoverflow.com/questions/28461212/how-can-i-implement-in-c-a-function-declared-in-a-c-namespace/28461271#28461271", "title": "How can I implement in C a function declared in a C++ namespace?", "body": "<p>Would a wrapper be acceptable?</p>\n\n<pre><code>namespace foo {\n    int bar(int);\n    }\nextern \"C\" int callable_from_c(int f) {\n    return foo::bar(f);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423678323, "post_id": 28461276, "comment_id": 45248696, "body": "That&#39;s what I meant when I said &quot;it needs to only be accessible from the namespace <code>foo</code>&quot;. There shouldn&#39;t be any global name <code>bar</code>, which may even conflict with other names in C. The whole point of the namespace is to prevent the name conflicts."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423678369, "post_id": 28461276, "comment_id": 45248726, "body": "@Matt: In that case, no --- you&#39;ll need a wrapper function. See user590028&#39;s answer for that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1423678437, "post_id": 28461276, "comment_id": 45248771, "body": "That is just a forward declaration of a function with &quot;C&quot; linkage - I doubt it will work as expected"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423678462, "post_id": 28461276, "comment_id": 45248784, "body": "@DieterL&#252;cking: What do you mean? Why wouldn&#39;t it work?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1423678561, "post_id": 28461276, "comment_id": 45248830, "body": "@Tim\u010cas Have you tried it (building a library and an application) using that design?"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423680383, "post_id": 28461276, "comment_id": 45249891, "body": "@DieterL&#252;cking: Yup. Works fine. I basically have a <code>namespace siege { namespace c { #include ... } }</code> in C++ wrapper for a C lib; there are certain issues if those C files include other (in particular stdlib) headers that I haven&#39;t gotten around to fixing --- but those are completely unrelated to any issues with function declarations."}], "tags": [], "owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "is_accepted": false, "score": 3, "last_activity_date": 1423677941, "creation_date": 1423677941, "answer_id": 28461276, "question_id": 28461212, "link": "https://stackoverflow.com/questions/28461212/how-can-i-implement-in-c-a-function-declared-in-a-c-namespace/28461276#28461276", "title": "How can I implement in C a function declared in a C++ namespace?", "body": "<p><code>extern \"C\"</code> can be nested (in fact, that's how headers like <code>&lt;cstdio&gt;</code> typically work!), so you can just do the following:</p>\n\n<pre><code>/* C++ code */\nnamespace foo {\n    extern \"C\" {\n        int bar(int);\n    }\n}\n</code></pre>\n\n<p>After that, you just implement it in C as usual:</p>\n\n<pre><code>/* C code */\nint bar(int x) {\n    return -x; /* or whatever */\n}\n</code></pre>\n\n<p>Unfortunately, if there's a naming conflict (say, if you have both <code>foo::bar</code> <em>and</em> <code>baz::bar</code>), you won't be able to have them both, unless they're the same function.</p>\n"}, {"comments": [{"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1423850915, "post_id": 28505561, "comment_id": 45330982, "body": "That&#39;s not a &quot;reason&quot;, it&#39;s just an explanation of the problem."}], "tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1423850285, "last_edit_date": 1423850285, "creation_date": 1423849551, "answer_id": 28505561, "question_id": 28461212, "link": "https://stackoverflow.com/questions/28461212/how-can-i-implement-in-c-a-function-declared-in-a-c-namespace/28505561#28505561", "title": "How can I implement in C a function declared in a C++ namespace?", "body": "<p>You <strong>are</strong> forced to your backup plan (to use a wrapper function) for the following reason: C++ supports overloading of functions, and by that reason you can have different implementations of <code>bar</code> (with different fingerprints, even compatible) while you can have only one implementation in C.  Which of the C++ possibilities would be matched for <code>bar</code> in case you call them from C?  What if you have <code>bar(int)</code> and <code>bar(long)</code> in C++ and you want to call <code>bar(3)</code> from C?</p>\n\n<p>The solution is to have one wrapper <code>extern \"C\"</code> function that calls the appropiate non-C function.  This function can be called from C and you'll get the desired results.</p>\n\n<p>If you look, for example, at the identifier names that the linker manages, you'll see how the compiler mangles identifiers to cope at linking time with overloading.  That does not happen if you declare a function <code>extern \"C\"</code> in C++.</p>\n\n<p>Another reason is that you don't have namespaces in C.  The C function version must be visible at the global namespace level.  You are not able to hide a C calling convention inside a namespace because it is callable from all the C code or you'll be violating the C calling conventions.</p>\n"}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1423850285, "creation_date": 1423677693, "question_id": 28461212, "link": "https://stackoverflow.com/questions/28461212/how-can-i-implement-in-c-a-function-declared-in-a-c-namespace", "title": "How can I implement in C a function declared in a C++ namespace?", "body": "<p>Let's say I have a C++ header file <code>foo.hpp</code>:</p>\n\n<pre><code>namespace foo {\n    int bar(int);\n}\n</code></pre>\n\n<p>I cannot use <code>extern \"C\"</code> because it needs to only be accessible from the namespace <code>foo</code>.</p>\n\n<p>Is there a portable (or relatively portable) way to declare <code>foo::bar</code> in a C file <code>foo.c</code> so that it will link with anyone using <code>foo::bar</code> from C++?</p>\n\n<p>I know that on a particular system with a particular compiler, I can just find out how <code>foo::bar</code> is mangled and do something like this in <code>foo.c</code>:</p>\n\n<pre><code>int ZN3foo3barEi(int x) { /* ... */ }\n</code></pre>\n\n<p>But this is neither portable nor readable.</p>\n"}, {"tags": ["c", "types", "alignment", "portability"], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "edited": false, "score": 0, "creation_date": 1423742988, "post_id": 28461052, "comment_id": 45277075, "body": "I&#39;d gladly use C11 features, unfortunately due to some business/technical restraints I&#39;m forced to stay in the realm of C89/C90 (yup, old compilers on old machines). Anyway, I&#39;m giving +1 since it will be nice to use it once these shackles are broken."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "edited": false, "score": 2, "creation_date": 1423747505, "post_id": 28461052, "comment_id": 45279763, "body": "@J\u0119drzejDudkiewicz: I&#39;ve greatly expanded my answer now, with an ordering that should <i>usually</i> work. Most of the update is just rationale though, so that you can see my reasoning behind it."}, {"owner": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "edited": false, "score": 0, "creation_date": 1423817220, "post_id": 28461052, "comment_id": 45310938, "body": "Thanks a lot for a nice discussion. To be honest I&#39;m not quite sure what should I do with it, since I specifically asked how to get alignment and best answer was provided by nwellnhof. At the same time what you wrote is useful and certainly insightful - can I somehow assign more than single &quot;point&quot; to your answer or is there no way to do it?"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "edited": false, "score": 1, "creation_date": 1423834952, "post_id": 28461052, "comment_id": 45321112, "body": "@J\u0119drzejDudkiewicz: I don&#39;t think there is any way to do it, but don&#39;t worry about it. Thanks anyways!"}], "tags": [], "owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "is_accepted": false, "score": 11, "last_activity_date": 1423747664, "last_edit_date": 1423747664, "creation_date": 1423677180, "answer_id": 28461052, "question_id": 28460987, "link": "https://stackoverflow.com/questions/28460987/c-get-type-alignment-portably/28461052#28461052", "title": "C - get type alignment portably", "body": "<p>There is in C11, which adds <code>_Alignof</code>:</p>\n\n<pre><code>printf(\"Alignment of int: %zu\\n\", _Alignof(int));\n</code></pre>\n\n<p>It is usually better style to include <code>&lt;stdalign.h&gt;</code>, and use the lowercase <code>alignof</code>:</p>\n\n<pre><code>#include &lt;stdalign.h&gt;\n\nprintf(\"Alignment of int: %zu\\n\", alignof(int));\n</code></pre>\n\n<p>You can check for C11 this way:</p>\n\n<pre><code>#if __STDC_VERSION__ &gt;= 201112L\n    /* C11 */\n#else\n    /* not C11 */\n#endif\n</code></pre>\n\n<p>If you're using GCC or CLang, you can compile your code in C11 mode by adding <code>-std=c11</code> (or <code>-std=gnu11</code> if you also want GNU extensions). Default mode is <code>gnu89</code> for GCC, and <code>gnu99</code> for CLang.</p>\n\n<hr>\n\n<h1>Update:</h1>\n\n<p>You might not need to check the alignment for your system at all, if you make a few educated guesses. I would recommend using one of these two orderings:</p>\n\n<pre><code>// non-embedded use\nlong double, long long, void (*)(void), void*, double, long, float, int, short, char\n\n// embedded use (microcontrollers)\nlong double, long long, double, long, float, void (*)(void), void*, int, short, char\n</code></pre>\n\n<p>This ordering is perfectly portable (but not always optimal), since the worst-case scenario is just that you get more padding than otherwise.</p>\n\n<p><strong><em>What follows is an (admittedly lengthy) rationale. Feel free to skip everything past this point if you don't care how I came to this conclusion for the ordering.</em></strong></p>\n\n<hr>\n\n<h2>Covering most cases</h2>\n\n<p>This holds true in C (regardless of implementation):</p>\n\n<pre><code>// for both `signed` and `unsigned`\nsizeof(char) &lt;= sizeof(short) &lt;= sizeof(int) &lt;= sizeof(long) &lt;= sizeof(long long)\nsizeof(float) &lt;= sizeof(double) &lt;= sizeof(long double)\n</code></pre>\n\n<p>With a bit of tinkering with the order, you should be able to get unpadded structures in <em>most</em> cases. <em>Please note that this does <strong>not</strong> guarantee that the structure will be unpadded; but it will be in <strong>most real-world</strong> cases, which should be GoodEnough&trade;.</em></p>\n\n<p><em>What follows is advice that is implementation-specific, but should cover alignment in <strong>most</strong> cases.</em></p>\n\n<p>This is, however, perfectly portable everywhere (even if not optimal) &mdash; as long as you accept that there may be some padding (in other words, don't assume the structure is without any padding). If you get it wrong, all you'll get is a larger structure, so there's no danger of hitting undefined behavior of any kind.</p>\n\n<p>What you should do is order these from largest to smallest, since their alignment will also be in this order. Assuming a typical amd64 compiler:</p>\n\n<pre><code>long long a; // 8-byte\nlong b;      // 8-byte or 4-byte; already aligned in both cases\nint c;       // 4-byte; already aligned\nshort d, e;  // 2-byte; both already aligned\nchar f;      // 1-byte; always aligned\n</code></pre>\n\n<h3>Integer types</h3>\n\n<p>So let's start figuring out our order, starting with integer types:</p>\n\n<pre><code>long long, long, int, short, char\n</code></pre>\n\n<h3>Floating-point types</h3>\n\n<p>Now, the floating-point types. What do you do with <code>double</code>? Its alignment is <em>typically</em> 8 bytes on 64-bit architectures, and 4 bytes on 32-bit (but it can be 8-byte in some cases).</p>\n\n<p><code>long long</code> is always at least 8-byte (this is implicitly demanded by the standard because of its minimum range), and <code>long</code> is always at least 4-byte (but it's <em>usually</em> 8-byte in 64-bit; there are exceptions such as Windows).</p>\n\n<p>What I would do is put <code>double</code> between those. Note that <code>double</code> can be 4 bytes in size (usually in embedded systems, such as AVR / Arduino), but those practically always have a 4-byte <code>long</code>.</p>\n\n<p><code>long double</code> is a complex case. Its alignment can range from 4-byte (say, x86 Linux) to 16-byte (amd64 Linux). Nevertheless, 4-byte alignment is a historical artifact and is suboptimal; so I'll presume it's at least 8-byte and put it above <code>long long</code>. This'll also make it optimal when its alignment is 16-byte.</p>\n\n<p>This leaves <code>float</code>, which is practically always a 4-byte quantity, with 4-byte alignment; I'll put it between <code>long</code>, which is guaranteed to be at least 4-byte, and <code>int</code>, which can (typically) be 4 or 2-byte.</p>\n\n<p>All of this combined gives us the next order:</p>\n\n<pre><code>long double, long long, double, long, float, int, short, char\n</code></pre>\n\n<h3>Pointer types</h3>\n\n<p>All we have left now are pointer types. Size of different <em>non-function</em> pointers is not necessarily the same, but I am going to assume it is (and it is true in the vast majority of, if not all, cases). I'll assume function pointers <em>can</em> be larger (think hardware architecture with larger ROM than RAM), so I'll put them above others.</p>\n\n<p>Worst-case <em>practical</em> scenario is that they're the same, so I've achieved nothing; best-case is that I've eliminated some more padding.</p>\n\n<p>But what about the size? This typically holds on <em>non-embedded</em> systems:</p>\n\n<pre><code>sizeof(long) &lt;= sizeof(T*) &lt;= sizeof(long long)\n</code></pre>\n\n<p>In most systems, <code>sizeof(long)</code> and <code>sizeof(T*)</code> are the same; but e.g. 64-bit Windows has 32-bit <code>long</code>, and 64-bit <code>T*</code>. However, in embedded systems, it's different; pointers there can be 16-bit, which means:</p>\n\n<pre><code>sizeof(int) &lt;= sizeof(T*) &lt;= sizeof(long)\n</code></pre>\n\n<p>What to do here is up to you --- <em>you</em> are the one who knows where this'll usually run. On one hand, optimizing for embedded where primary use is non-, means optimizing for the uncommon case. On the other hand, memory is more limited in embedded systems than not. Personally, I'd recommend optimizing for desktop use, <em>unless</em> you're specifically making an embedded application. Since the alignment of <code>double</code> is typically the same as pointer size <em>but can be larger</em>, I'd put this below <code>double</code>.</p>\n\n<pre><code>// non-embedded\nlong double, long long, void (*)(void), void*, double, long, float, int, short, char\n</code></pre>\n\n<p>For embedded uses, I'd put it below <code>float</code>, since alignment of <code>float</code> is usually 4-byte, but <code>T*</code> is 2-byte or 4-byte:</p>\n\n<pre><code>// embedded\nlong double, long long, double, long, float, void (*)(void), void*, int, short, char\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "edited": false, "score": 0, "creation_date": 1423743794, "post_id": 28464194, "comment_id": 45277546, "body": "Thanks, it seems that the best solution is:  #define alignof(type) ((size_t)(offsetof(struct { char c; type d; }, d)))  It avoids &amp;*0, which is nice, since I&#39;m pretty sure I read that this isn&#39;t exactly safe, and althought it works, it&#39;s not guaranteed."}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1423689913, "last_edit_date": 1495541694, "creation_date": 1423687703, "answer_id": 28464194, "question_id": 28460987, "link": "https://stackoverflow.com/questions/28460987/c-get-type-alignment-portably/28464194#28464194", "title": "C - get type alignment portably", "body": "<p><strike>This is probably not very portable, but</strike> GCC accepts the following:</p>\n\n<pre><code>#define alignof(type) offsetof(struct { char c; type d; }, d)\n</code></pre>\n\n<p><strong>EDIT:</strong> And according to <a href=\"https://stackoverflow.com/a/17800462/1956010\">this answer</a>, C allows casting to anonymous struct types (although I'd like to see this statement backed up). So the following should be portable:</p>\n\n<pre><code>#define alignof(type) ((size_t)&amp;((struct { char c; type d; } *)0)-&gt;d)\n</code></pre>\n\n<p>Another approach using <a href=\"https://stackoverflow.com/questions/6440021/compiler-support-of-gnu-statement-expression\">GNU statement expressions</a>:</p>\n\n<pre><code>#define alignof(type) ({ \\\n    struct s { char c; type d; }; \\\n    offsetof(struct s, d); \\\n})\n</code></pre>\n"}], "owner": {"reputation": 751, "user_id": 3826362, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e6b9c3b2b13e728541101c198d19af88?s=128&d=identicon&r=PG&f=1", "display_name": "J\u0119drzej Dudkiewicz", "link": "https://stackoverflow.com/users/3826362/j%c4%99drzej-dudkiewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2683, "favorite_count": 3, "accepted_answer_id": 28464194, "answer_count": 2, "score": 10, "last_activity_date": 1423747664, "creation_date": 1423676973, "question_id": 28460987, "link": "https://stackoverflow.com/questions/28460987/c-get-type-alignment-portably", "title": "C - get type alignment portably", "body": "<p>I'm writing really small interpreter for a very simple language, which allows for simple structure definitions (made of other structures and simple types, like int, char, float, double and so one). I want fields to use as little alignment as possible, so using max_align_t or something similar is out of question. Now, I wonder if there is a nicer way to get alignment of any single type other than this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n\n#define GA(type, name) struct GA_##name { char c; type d; }; \\\n    const unsigned int alignment_for_##name = offsetof(struct GA_##name, d);\n\nGA(int, int);\nGA(short, short);\nGA(char, char);\nGA(float, float);\nGA(double, double);\nGA(char*, char_ptr);\nGA(void*, void_ptr);\n\n#define GP(type, name) printf(\"alignment of \"#name\" is: %dn\", alignment_for_##name);\n\nint main() {\nGP(int, int);\nGP(short, short);\nGP(char, char);\nGP(float, float);\nGP(double, double);\nGP(char*, char_ptr);\nGP(void*, void_ptr);\n}\n</code></pre>\n\n<p>This works, but maybe there is something nicer?</p>\n"}, {"tags": ["c", "cp"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423676905, "post_id": 28460595, "comment_id": 45247926, "body": "where does av[] get defined?"}, {"owner": {"reputation": 33, "user_id": 2836886, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c455c5114546e4b24085e2b2610619f?s=128&d=identicon&r=PG&f=1", "display_name": "uberpirate", "link": "https://stackoverflow.com/users/2836886/uberpirate"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423687817, "post_id": 28460595, "comment_id": 45254167, "body": "It&#39;s in main. I&#39;ll edit that."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423676263, "post_id": 28460656, "comment_id": 45247540, "body": "Or change the working directory, also the OP must check if <code>opendir()</code> returned <code>NULL</code>."}, {"owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423676465, "post_id": 28460656, "comment_id": 45247658, "body": "Both statements are true -- I was just trying to point him in the right direction."}, {"owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "edited": false, "score": 0, "creation_date": 1423690367, "post_id": 28460656, "comment_id": 45255484, "body": "Make sure <code>av[1]</code> is not <code>NULL</code>. Also make sure you check the return value of <code>opendir()</code>"}], "tags": [], "owner": {"reputation": 10100, "user_id": 590028, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43c6ce77252e438b40b96f5c68cf3432?s=128&d=identicon&r=PG", "display_name": "user590028", "link": "https://stackoverflow.com/users/590028/user590028"}, "is_accepted": false, "score": 1, "last_activity_date": 1423675753, "creation_date": 1423675753, "answer_id": 28460656, "question_id": 28460595, "link": "https://stackoverflow.com/questions/28460595/cant-open-file-in-cp-program/28460656#28460656", "title": "Can&#39;t open file in cp program", "body": "<p>The <code>DIR</code> record returned from <code>readdir</code> only returns the basename of the file. You need to concatenate this with the directory to correctly open the files. </p>\n\n<p>Something like this:</p>\n\n<pre><code>char srcfile[1024];\nsprintf(\"%s/%s\", av[1], ep-&gt;d_name);\nif ( (in_fd=open(srcfile, O_RDONLY)) == -1 )\n        oops(\"Cannot open\", srcfile);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2836886, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0c455c5114546e4b24085e2b2610619f?s=128&d=identicon&r=PG&f=1", "display_name": "uberpirate", "link": "https://stackoverflow.com/users/2836886/uberpirate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423687836, "creation_date": 1423675542, "last_edit_date": 1423687836, "question_id": 28460595, "link": "https://stackoverflow.com/questions/28460595/cant-open-file-in-cp-program", "title": "Can&#39;t open file in cp program", "body": "<p>I'm working on a custom version of cp where the arguments are two directories and the files from the first directory are copied to the second. My current problem is getting the files in the first directory to open. When I get to the \"open files\" part of the code I get an error saying that there is no file, which doesn't make sense because the file name is printing out in the error. Am I missing something simple? I think I included enough of the code.</p>\n\n<pre><code>int main(int ac, char *av[]) {    \n\nint     in_fd, out_fd, n_chars;\nchar    buf[BUFFERSIZE];\nstruct stat sb;\nDIR *copyFrom;\nDIR *copyTo;\nstruct dirent *ep;\n\n/* open dirs */\ncopyFrom = opendir(av[1]);\ncopyTo = opendir(av[2]);\n\nwhile(ep = readdir(copyFrom))\n{\n    /* open files */\n    if ( (in_fd=open(ep-&gt;d_name, O_RDONLY)) == -1 )\n        oops(\"Cannot open\", ep-&gt;d_name);\n\n    if ( (out_fd=creat(ep-&gt;d_name, COPYMODE)) == -1 )\n        oops( \"Cannot create\", ep-&gt;d_name);\n\n    /* copy files */\n    while ( (n_chars = read(in_fd , buf, BUFFERSIZE)) &gt; 0 )\n        if ( write( out_fd, buf, n_chars ) != n_chars )\n            oops(\"Write error to \", av[2]);\n\n    if ( n_chars == -1 )\n        oops(\"Read error from \", av[1]);\n\n    /* close files */\n    if ( close(in_fd) == -1 || close(out_fd) == -1 )\n        oops(\"Error closing files\",\"\");\n}\n}\n</code></pre>\n"}, {"tags": ["c", "apache", "api", "module"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 2, "creation_date": 1423676479, "post_id": 28460448, "comment_id": 45247668, "body": "I&#39;m pretty sure this is too broad, but --- how about threads? Have a main thread for messages, et cetera, and a worker thread for the processing. In the worker thread, check every once in a while (say, every iteration; or every 10 iterations; or every N seconds --- depending on the type of processing) if an exit has been requested."}], "owner": {"reputation": 21, "user_id": 4555795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ai13g.jpg?s=128&g=1", "display_name": "Mario Cavicchi", "link": "https://stackoverflow.com/users/4555795/mario-cavicchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1423675135, "creation_date": 1423675135, "question_id": 28460448, "link": "https://stackoverflow.com/questions/28460448/catch-a-client-close-connection-from-inside-a-apache-module", "title": "Catch a client close connection from inside a Apache module", "body": "<p>I'm developing a apache module in C. This module performs a processing that can take \"long\" time. During this processing how I can receive and manage a signal (because i think is related to signals) that the client has closed the connection? And stop the useless processing?</p>\n"}, {"tags": ["c", "thread-safety"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423675456, "post_id": 28460236, "comment_id": 45247041, "body": "I suspect an oversight (since things like <code>errno</code> <i>are</i> thread-local) --- either on the part of POSIX (if they <i>explicitly</i> declare it must be static, because they forgot to update), or on the part of GNU (if POSIX does not say so, and they are allowed to do that --- might be an oversight). If it&#39;s the latter, I&#39;d recommend filing a bug."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423675602, "post_id": 28460236, "comment_id": 45247134, "body": "As for the non-portable functions, I take it you&#39;re talking about <code>gmtime_r</code> and friends. Those are SUS, but (sadly) not stdC. In Windows (being the usual exception), you have <code>_gmtime_s</code> (note the reversed order of arguments!), though <code>gmtime</code> <i>does</i> use thread-local storage there."}], "answers": [{"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423675717, "post_id": 28460574, "comment_id": 45247204, "body": "I diasgree regarding changing them --- <code>errno</code> was changed to thread-local, with few to no issues. As for C, since C before C11 had no concept of threads at all, you could argue that the semantics in a threaded environment were <i>already</i> implementation-defined (or even unspecified)."}, {"owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1423676372, "post_id": 28460574, "comment_id": 45247602, "body": "Can you be sure a program only has one thread in the presence of external components (e.g. .so&#39;s)? Not sure on Linux, but on Window&#39;s there seems to always be extra threads from &quot;somewhere&quot; (e.g. on a app I tested I got a &quot;PGHook.dll&quot; thread somehow)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "edited": false, "score": 0, "creation_date": 1423679736, "post_id": 28460574, "comment_id": 45249484, "body": "@FireLancer, you can normally be confident about (non-)multithreading based on what functions and libraries your program uses, at least on Linux and other POSIX systems.  It is abnormal for undocumented threads to be created in your process on such systems, where &quot;abnormal&quot; pretty much means &quot;unheard of&quot;.  A function or library that created such a thread on the sly and allowed it to have any visible side effects on other threads would certainly be considered buggy on that account."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423682200, "post_id": 28460574, "comment_id": 45250962, "body": "@Tim\u010cas, the only explanations I see are (1) the standards committee intentionally chose to avoid requiring a change to the existing semantics of these functions, and (2) the standards committee was packed with ignorant screw-ups.  Although I cannot rule out (2), I find (1) a far more believable explanation.  Feel free to offer other alternatives if you have any."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423682365, "post_id": 28460574, "comment_id": 45251059, "body": "@JohnBollinger: Probably a mix of both, really. A case in point for (2): The existance of <code>&lt;tgmath.h&gt;</code> before C11 (meaning, without <code>_Generic</code>). Apparently done because the std comittee was envious of Fortran&#39;s success in the field of numeric computing, and wanted to make C more Fortran-y."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423682468, "post_id": 28460574, "comment_id": 45251128, "body": "@JohnBollinger: The thing I miss the most in C stdlib <i>are</i> reentrant variants of its functions. 2nd top spot for me is no standarized way of defining custom callbacks for <code>FILE</code> (meaning, every single lib implements its own --- like <code>SDL_RWops</code> for SDL). A standarized <code>FILE</code> structure (at least semi-, in the form of &quot;it must start like this, but may contain other members <i>AFTER</i> these&quot;) + user callbacks would&#39;ve removed the need for that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423682714, "post_id": 28460574, "comment_id": 45251296, "body": "@Tim\u010cas, I feel your pain.  Especially with respect to <code>FILE</code>.  I would dearly love to be able to implement custom streams that could be used with the standard library&#39;s stream i/O functions, but there&#39;s just no good way to do it.  (So I, too, end up writing wrappers.)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1423675477, "creation_date": 1423675477, "answer_id": 28460574, "question_id": 28460236, "link": "https://stackoverflow.com/questions/28460236/why-is-glibc-and-maybe-others-static-tm-struct-not-thread-local/28460574#28460574", "title": "Why is glibc (and maybe others) static tm struct not thread local?", "body": "<p>You are correct that the <code>gmtime()</code> and <code>localtime()</code> functions are not thread safe.  There are quite a few such functions in the C library, and they are as they are because they were designed for single-threaded programs (which once was the only kind), and changing them to rely on thread-local data would be an alteration to their previously-defined semantics.  They are not \"totally broken\" because many programs use only one thread, and because with proper care they can be used in multithreaded-programs, too.</p>\n\n<p>With that said, these are among the many functions for which reentrant versions have been standardized (<code>gmtime_r()</code> and <code>localtime_r()</code>); if the reentrant versions are available to you then they are a better choice for multithreaded programs.</p>\n"}], "owner": {"reputation": 27546, "user_id": 6266, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/398efb709eb606ef79ee6436f55f93bd?s=128&d=identicon&r=PG", "display_name": "Fire Lancer", "link": "https://stackoverflow.com/users/6266/fire-lancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 28460574, "answer_count": 1, "score": 2, "last_activity_date": 1423675477, "creation_date": 1423674503, "question_id": 28460236, "link": "https://stackoverflow.com/questions/28460236/why-is-glibc-and-maybe-others-static-tm-struct-not-thread-local", "title": "Why is glibc (and maybe others) static tm struct not thread local?", "body": "<p>So was doing a peer review today, and someone complained about the use of gmtime in the form <code>tm tm = *gmtime(&amp;t)</code>. My assumption had always been that it would use a per-thread storage to make it safe but having looked around seems <code>time/localtime.c</code> just declares it as a regular global.</p>\n\n<p><a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=time/localtime.c;h=38f3123d9a4093c3bbd78e4d39f63491af1fed56;hb=master\" rel=\"nofollow\">https://sourceware.org/git/?p=glibc.git;a=blob;f=time/localtime.c;h=38f3123d9a4093c3bbd78e4d39f63491af1fed56;hb=master</a> </p>\n\n<pre><code>/* The C Standard says that localtime and gmtime return the same pointer.  */\nstruct tm _tmbuf;\n</code></pre>\n\n<p>If I understand correctly this makes that implementation totally broken on modern systems, because it is not practical to reliably tell what other threads are doing?</p>\n\n<p>Why is it not made per-thread, making it as safe as it could ever have intended to be?</p>\n\n<p>I realise of course there are other versions of this function (although not portable), so a simple mygmtime wrapper is possible, but seems odd this is still an outstanding issue.</p>\n"}, {"tags": ["c", "io", "size", "buffer", "scanf"], "comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1423673887, "post_id": 28459980, "comment_id": 45246125, "body": "<code>size_t n</code> doesn&#39;t it give the buffer size?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1423674057, "post_id": 28459980, "comment_id": 45246229, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/10886594/how-to-limit-scanf-function-in-c-to-print-error-when-input-is-too-long\">How to limit scanf function in C to print error when input is too long?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1423674195, "post_id": 28459980, "comment_id": 45246316, "body": "IMO, the possible duplicate isn&#39;t very accurately a duplicate."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "edited": false, "score": 0, "creation_date": 1476983265, "post_id": 28459980, "comment_id": 67589765, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1621394/how-to-prevent-scanf-causing-a-buffer-overflow-in-c\">How to prevent scanf causing a buffer overflow in C?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423674494, "post_id": 28460098, "comment_id": 45246488, "body": "A much better solution for the specific case of <code>&quot;%64[^\\n]&quot;</code> is <code>fgets(buf, 64, stdin)</code> --- it does <i>exactly that</i>, except that you can provide the length as a &quot;proper&quot; argument."}, {"owner": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "edited": false, "score": 0, "creation_date": 1423675444, "post_id": 28460098, "comment_id": 45247035, "body": "Ahh, I remember now that I what saw was <code>&quot;%*[^\\n]&quot;</code> but apparently the <code>*</code> means &quot;discard the result&quot; instead of &quot;value in argument list&quot; for <code>scanf</code>. Nice solution for the problem!"}, {"owner": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 3, "creation_date": 1423677164, "post_id": 28460098, "comment_id": 45248075, "body": "@Tim <code>fgets(buf, 64, stdin)</code> is not <i>exactly</i> the same. <code>fgets</code> also gives you the newline character."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "edited": false, "score": 2, "creation_date": 1423677478, "post_id": 28460098, "comment_id": 45248247, "body": "@elias: Oh right, forgot about that. Easily fixed though: <code>buf[strcspn(buf, &quot;\\n&quot;)] = 0;</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423677619, "post_id": 28460098, "comment_id": 45248345, "body": "@Tim\u010cas: you&#39;re right about <code>fgets()</code> probably being better for this specific example.  I&#39;ve added extra information to the answer, referencing your point."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423680090, "post_id": 28460098, "comment_id": 45249721, "body": "Note: <code>scanf_s(&quot;%[^\\n]&quot;</code> is a problem if the first <code>char</code> is <code>&#39;\\n&#39;</code> in which case, nothing is saved and <code>&#39;\\n&#39;</code> remains in <code>stdin</code>.  This of course is caught in the   <code>...oops...</code> handler."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1423680532, "post_id": 28460098, "comment_id": 45249993, "body": "@chux: valid point.  The usual sensible fix is to include a space at the start of the format string, so leading white space is skipped.  Note that trying to read the newline after the string is hard if it is at the end of the format string and the input is interactive (a trailing newline or blank in the format string is an interactive disaster; the input doesn&#39;t terminate until a non-white space character is typed)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423680589, "post_id": 28460098, "comment_id": 45250035, "body": "@Tim\u010cas Nice comment about <code>buf[strcspn(buf, &quot;\\n&quot;)] = 0;</code>.  Suggest adding that to <a href=\"http://stackoverflow.com/q/2693776/2410359\">stackoverflow.com/q/2693776/2410359</a> . AFAIK, <code>strcspn()</code> well handles 2 problem <code>buf</code>: 1) <code>buf</code> that starts with <code>&#39;\\0&#39;</code> 2) <code>buf</code> that does not contain  <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423680936, "post_id": 28460098, "comment_id": 45250229, "body": "@chux: Indeed it does, because <code>strcspn()</code> stops at a <code>&#39;\\0&#39;</code>. Anyways, replied: <a href=\"http://stackoverflow.com/a/28462221/485088\">stackoverflow.com/a/28462221/485088</a>"}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1449051459, "post_id": 28460098, "comment_id": 55834944, "body": "Could you elaborate on &quot;probably generates an error if the input is too long. The size could/should be specified in the format string as before&quot;?  I can&#39;t see the benefit of specifying length in <code>scanf_s</code>&#39;s format string."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 1, "creation_date": 1449071376, "post_id": 28460098, "comment_id": 55848565, "body": "@a3f: Up to you. I don&#39;t have a Windows machine so I can&#39;t verify what I&#39;m about to say, but\u2026  If you&#39;re using <code>scanf_s()</code> or one of its relatives and the format for a <code>%c</code>, <code>%s</code> or <code>%[</code> conversion specification is limited to, say, 20 characters (e.g. <code>%20s</code>) and the user types 21 characters, the 21st character is processed by the next conversion specification (which may not work). On the other hand, if you have just <code>%s</code>, the 21st character triggers a runtime constraint violation and all the input is effectively lost and the scan completes. You get to choose which is the behaviour you prefer."}, {"owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "edited": false, "score": 0, "creation_date": 1449654073, "post_id": 28460098, "comment_id": 56097541, "body": "@JonathanLeffler I wasn&#39;t aware that they differ in that regard. Thanks!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 18, "last_activity_date": 1575963289, "last_edit_date": 1575963289, "creation_date": 1423674101, "answer_id": 28460098, "question_id": 28459980, "link": "https://stackoverflow.com/questions/28459980/specifying-the-maximum-string-length-to-scanf-dynamically-in-c-like-s-in-pr/28460098#28460098", "title": "Specifying the maximum string length to scanf dynamically in C (like &quot;%*s&quot; in printf)", "body": "<h3>Basic answer</h3>\n\n<p>There isn't an analog to the <code>printf()</code> format specifier <code>*</code> in <code>scanf()</code>.</p>\n\n<p>In <a href=\"https://www.cs.princeton.edu/~bwk/tpop.webpage/\" rel=\"nofollow noreferrer\">The Practice of Programming</a>, Kernighan and Pike recommend using <code>snprintf()</code> to create the format string:</p>\n\n<pre><code>size_t sz = 64;\nchar format[32];\nsnprintf(format, sizeof(format), \"%%%zus\", sz);\nif (scanf(format, buffer) != 1) { \u2026oops\u2026 }\n</code></pre>\n\n<h3>Extra information</h3>\n\n<p>Upgrading the example to a complete function:</p>\n\n<pre><code>int read_name(FILE *fp, char *buffer, size_t bufsiz)\n{\n    char format[16];\n    snprintf(format, sizeof(format), \"%%%zus\", bufsiz - 1);\n    return fscanf(fp, format, buffer);\n}\n</code></pre>\n\n<p>This emphasizes that the size in the format specification is one less than the size of the buffer (it is the number of non-null characters that can be stored without counting the terminating null).  Note that this is in contrast to <code>fgets()</code> where the size (an <code>int</code>, incidentally; not a <code>size_t</code>) is the size of the buffer, not one less. There are multiple ways of improving the function, but it shows the point.  (You can replace the <code>s</code> in the format with <code>[^\\n]</code> if that's what you want.)</p>\n\n<p>Also, as <a href=\"https://stackoverflow.com/users/485088/tim-%c4%8cas\">Tim \u010cas</a> noted in the <a href=\"https://stackoverflow.com/questions/28459980/specifing-the-maximum-string-length-to-scanf-dynamically-in-c/28460098?noredirect=1#comment45246488_28460098\">comments</a>, if you want (the rest of) a line of input, you're usually better off using <code>fgets()</code> to read the line, but remember that it includes the newline in its output (whereas <code>%63[^\\n]</code> leaves the newline to be read by the next I/O operation).  For more general scanning (for example, 2 or 3 strings), this technique may be better &mdash; especially if used with <code>fgets()</code> or <code>getline()</code> and then <code>sscanf()</code> to parse the input.</p>\n\n<p>Also, the TR 24731-1 'safe' functions, implemented by Microsoft (more or less) and standardized in Annex K of ISO/IEC 9899-2011 (the C11 standard), require a length explicitly:</p>\n\n<pre><code>if (scanf_s(\"%[^\\n]\", buffer, sizeof(buffer)) != 1)\n    ...oops...\n</code></pre>\n\n<p>This avoids buffer overflows, but probably generates an error if the input is too long.  The size could/should be specified in the format string as before:</p>\n\n<pre><code>if (scanf_s(\"%63[^\\n]\", buffer, sizeof(buffer)) != 1)\n    ...oops...\n\nif (scanf_s(format, buffer, sizeof(buffer)) != 1)\n    ...oops...\n</code></pre>\n\n<p>Note that the warning (from some compilers under some sets of flags) about 'non-constant format string' has to be ignored or suppressed for code using the generated format string.</p>\n"}, {"comments": [{"owner": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "edited": false, "score": 1, "creation_date": 1423675022, "post_id": 28460242, "comment_id": 45246793, "body": "This does obviously not work when the buffer length is the parameter of a function but it is a nice trick to use in situations where the buffer length is known preprocess-time."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "reply_to_user": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "edited": false, "score": 1, "creation_date": 1423675220, "post_id": 28460242, "comment_id": 45246907, "body": "@elias Yes, since it&#39;s done with the preprocessor the value must be a preprocessor macro, and indeed only a simple integer literal at that (even <code>STR_VALUE(BUFFER_SIZE - 1)</code> wouldn&#39;t work)."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": false, "score": 7, "last_activity_date": 1423674517, "creation_date": 1423674517, "answer_id": 28460242, "question_id": 28459980, "link": "https://stackoverflow.com/questions/28459980/specifying-the-maximum-string-length-to-scanf-dynamically-in-c-like-s-in-pr/28460242#28460242", "title": "Specifying the maximum string length to scanf dynamically in C (like &quot;%*s&quot; in printf)", "body": "<p>There is indeed no variable width specifier in the <code>scanf</code> family of functions. Alternatives include creating the format string dynamically (though this seems a bit silly if the width is a compile-time constant) or simply accepting the magic number. One possibility is to use preprocessor macros for specifying both the buffer and format string width:</p>\n\n<pre><code>#define STR_VALUE(x) STR(x)\n#define STR(x) #x\n\n#define MAX_LEN 63\n\nchar buffer[MAX_LEN + 1];\nfscanf(file, \"%\" STR_VALUE(MAX_LEN) \"[^\\n]\", buffer);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1596546619, "post_id": 53122501, "comment_id": 111840723, "body": "Note that <code>%5d</code> is for an integer, not a <code>double</code> as the name suggests."}, {"owner": {"reputation": 45, "user_id": 10582249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OPcyr.png?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/10582249/patrick"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1596637297, "post_id": 53122501, "comment_id": 111875792, "body": "I don&#39;t recognize the problem or the post. I edited to match <code>double</code> type"}], "tags": [], "owner": {"reputation": 45, "user_id": 10582249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OPcyr.png?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/10582249/patrick"}, "is_accepted": false, "score": -1, "last_activity_date": 1596637376, "last_edit_date": 1596637376, "creation_date": 1541176343, "answer_id": 53122501, "question_id": 28459980, "link": "https://stackoverflow.com/questions/28459980/specifying-the-maximum-string-length-to-scanf-dynamically-in-c-like-s-in-pr/53122501#53122501", "title": "Specifying the maximum string length to scanf dynamically in C (like &quot;%*s&quot; in printf)", "body": "<p>Another option is to <code>#define</code> the length of the string:</p>\n<pre><code>#define STRING_MAX_LENGTH &quot;%10s&quot;\n</code></pre>\n<p>or</p>\n<pre><code>#define DOUBLE_LENGTH &quot;%5f&quot;\n</code></pre>\n"}], "owner": {"reputation": 3512, "user_id": 3787875, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/90a3200499665173ac6fad85869443ba?s=128&d=identicon&r=PG&f=1", "display_name": "wefwefa3", "link": "https://stackoverflow.com/users/3787875/wefwefa3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14032, "favorite_count": 3, "accepted_answer_id": 28460098, "answer_count": 3, "score": 19, "last_activity_date": 1596637376, "creation_date": 1423673733, "last_edit_date": 1453790124, "question_id": 28459980, "link": "https://stackoverflow.com/questions/28459980/specifying-the-maximum-string-length-to-scanf-dynamically-in-c-like-s-in-pr", "title": "Specifying the maximum string length to scanf dynamically in C (like &quot;%*s&quot; in printf)", "body": "<p>I can specify the maximum amount of characters for <code>scanf</code> to read to a <code>buffer</code> using this technique:</p>\n\n<pre><code>char buffer[64];\n\n/* Read one line of text to buffer. */\nscanf(\"%63[^\\n]\", buffer);\n</code></pre>\n\n<p>But what if we do not know the buffer length when we write the code? What if it is the parameter of a function?</p>\n\n<pre><code>void function(FILE *file, size_t n, char buffer[n])\n{\n    /* ... */\n    fscanf(file, \"%[^\\n]\", buffer); /* WHAT NOW? */\n}\n</code></pre>\n\n<p>This code is <strong>vulnerable to buffer overflows</strong> as <code>fscanf</code> does not know how big the buffer is.</p>\n\n<p>I remember seeing this before and started to think that it was the solution to the problem:</p>\n\n<pre><code>fscanf(file, \"%*[^\\n]\", n, buffer);\n</code></pre>\n\n<p>My first thought was that the <code>*</code> in <code>\"%*[*^\\n]\"</code> meant that the maximum string size is passed an argument (in this case <code>n</code>). This is the meaning of the <code>*</code> in <code>printf</code>.</p>\n\n<p>When I checked the documentation for <code>scanf</code> I found out that it means that <code>scanf</code> should discard the result of <code>[^\\n]</code>.</p>\n\n<p>This left me somewhat disappointed as I think that it would be a very useful feature to be able to pass the buffer size dynamically for <code>scanf</code>.</p>\n\n<p>Is there any way I can pass the buffer size to <code>scanf</code> dynamically?</p>\n"}, {"tags": ["c", "portability", "platform", "memory-alignment"], "comments": [{"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1423674118, "post_id": 28459976, "comment_id": 45246270, "body": "The obvious solution would be catching <code>SIGBUS</code> upon trying an unaligned access..."}, {"owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1423674881, "post_id": 28459976, "comment_id": 45246722, "body": "@black That would be <i>heavy</i>, I suppose: even if catching a hardware exception was fast (which I strongly doubt), anyway installing a handler, catching the error and removing the handler never could be as fast as simply checking for address alignment and then branching accordingly. Unaligned access in my case is the primary mode of operation rather than a rare situation."}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1423675303, "post_id": 28459976, "comment_id": 45246956, "body": "It is indeed; I just proposed the &quot;poor&#39;s-man-solution&quot; to that. Could you tell us whether you just want to know that or you&#39;re trying to solve a specific problem <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY</a>?"}, {"owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1423676018, "post_id": 28459976, "comment_id": 45247386, "body": "@black There is absolutely no hidden task beyond reading / writing numbers and other primitive objects from / to a buffer, perhaps changing byte order on-the-fly as needed."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1423676622, "post_id": 28459976, "comment_id": 45247756, "body": "&quot;it would be stupid to check for alignment and perform byte-wise operations on platforms that allow unaligned access (such as x86)&quot;  Is it actually stupid?  I know x86 allows unaligned accesses, but I thought you pay a substantial performance penalty when you actually perform an unaligned access, so avoiding them doesn&#39;t necessarily seem stupid.  If the values are often unaligned, then a byte-by-byte solution would be portable and possibly no worse in performance."}, {"owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1423677142, "post_id": 28459976, "comment_id": 45248067, "body": "@AdrianMcCarthy Native CPU instructions are always faster than your code or at least not slower, \u2014 even when penalized by performance-killing circumstances, because your code will be penalized as well. The only hope you can have is that out-of-order execution will reduce the difference, but it will never make your custom code to run faster than a native read / write operation."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1423767975, "post_id": 28459976, "comment_id": 45293209, "body": "@AntonSamsonov:  I didn&#39;t say it would be faster.  I said it would be &quot;possibly no worse in performance.&quot;  Ideally, you shouldn&#39;t have unaligned data.  If the unaligned values you&#39;re accessing are contiguous, you might consider using memmove to align them before accessing.  Then you get speed and portability, freeing you from worrying about platform-specific details."}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1423674343, "post_id": 28460128, "comment_id": 45246402, "body": "would be lovely if you <code>free</code>d the memory, but plus one."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1423674428, "post_id": 28460128, "comment_id": 45246440, "body": "Just to be clear, the code came from GNU autoconf and I only added some whitespace and brackets to make it clear what was inside the for loop.  You could send a patch to them I suppose."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1423675007, "post_id": 28460128, "comment_id": 45246782, "body": "DavidGrayson: Any particular reason they&#39;re not just stack-allocating <code>string</code>? And @Bathsheba: I know some people will hate me for saying this, but GNU have never been known for code quality."}, {"owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "edited": false, "score": 0, "creation_date": 1423675329, "post_id": 28460128, "comment_id": 45246970, "body": "I suppose that on some architectures, the instructions for reading data from the stack could be special and have different alignment requirements.  That&#39;s just a guess though."}, {"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1570616324, "post_id": 28460128, "comment_id": 102966336, "body": "@Bathsheba, why waste time <code>free()</code>-ing when you can just quit?! The kernel will get the memory back either way."}], "tags": [], "owner": {"reputation": 70793, "user_id": 28128, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4e974a514f0764fdfe99a8915f192002?s=128&d=identicon&r=PG", "display_name": "David Grayson", "link": "https://stackoverflow.com/users/28128/david-grayson"}, "is_accepted": false, "score": 1, "last_activity_date": 1423674174, "creation_date": 1423674174, "answer_id": 28460128, "question_id": 28459976, "link": "https://stackoverflow.com/questions/28459976/compiler-constant-indicating-memory-alignment-requirement/28460128#28460128", "title": "Compiler constant indicating memory alignment requirement", "body": "<p><em>I am not technically answering the question you posed, but I am proposing a workaround in case the answer to your question is no.</em></p>\n\n<p>If your code is compiled with the help of a configure script, you can test to see if aligned access is required.  GNU autoconf has a feature for doing this:</p>\n\n<p><a href=\"http://www.gnu.org/software/autoconf-archive/ax_check_aligned_access_required.html\" rel=\"nofollow\">http://www.gnu.org/software/autoconf-archive/ax_check_aligned_access_required.html</a></p>\n\n<p>Basically it compiles the following small program, runs it, and looks at the result:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n  char* string = malloc(40);\n  int i;\n  for (i=0; i &lt; 40; i++)\n  {\n    string[[i]] = i;\n  }\n\n  {\n     void* s = string;\n     int* p = s+1;\n     int* q = s+2;\n\n     if (*p == *q) { return 1; }\n  }\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "edited": false, "score": 0, "creation_date": 1423675040, "post_id": 28460313, "comment_id": 45246803, "body": "I am reading / writing a single number at a time, even when some numbers are occasionally grouped into arrays (and even in this case, they are all unaligned most of the time)."}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "reply_to_user": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "edited": false, "score": 0, "creation_date": 1423685045, "post_id": 28460313, "comment_id": 45252645, "body": "@AntonSamsonov Added a few other options. However, it&#39;s still hard to extract possible solutions without <i>real</i> code available."}], "tags": [], "owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684925, "last_edit_date": 1423684925, "creation_date": 1423674712, "answer_id": 28460313, "question_id": 28459976, "link": "https://stackoverflow.com/questions/28459976/compiler-constant-indicating-memory-alignment-requirement/28460313#28460313", "title": "Compiler constant indicating memory alignment requirement", "body": "<p>A solution that doesn't require any check for that is one I've seen in an implementation of <code>memcpy</code>. Basically, you start copying data byte per byte till you get to an address multiple of the desired alignment.<br>\nAfter that, you can start copying word-size chunks of data with all the benefits you have with an aligned address (loop unrolling, vectorization, ...).  </p>\n\n<p>You'll get the best out of it with large blocks of data, though.</p>\n\n<p>Apparently, neither <code>clang</code> nor <code>gcc</code> define any macro to inform about unaligned access. (<code>gcc/clang -E -dM - &lt; /dev/null -march=native</code>).<br>\nSome ideas you may want to consider:</p>\n\n<ul>\n<li>Reduce the need in the first place: problems incur when you use pointers. Try to avoid that, refactoring the way you handle your data.</li>\n<li><code>asm</code>: write platform-dependent <code>asm</code> to load/store to/from an unaligned access, although it highly depends on the platforms you're working with.</li>\n<li>SSE allows unaligned access.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423675091, "post_id": 28460395, "comment_id": 45246833, "body": "This doesn&#39;t answer his question. He was asking if unaligned accesses are allowed, not what the maximum alignment is. For example, x86 typically has maximum alignment of <code>8</code> or <code>16</code>, but nevertheless allows accesses with alignment of <code>1</code> (they&#39;re just slower); on the other hand, MIPS and ARM raise errors for unaligned accesses."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423675523, "post_id": 28460395, "comment_id": 45247083, "body": "@ Tim \u010cas OP is asking &quot;do C/C++ compilers define a constant that indicates alignment requirement?&quot;, in bold.  Simple checking if <code>sizeof (max_align_t) == 1</code> would indicate if any alignment is needed."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423675949, "post_id": 28460395, "comment_id": 45247349, "body": "It would indicate if objects should be aligned, but there is <i>no</i> indication on whether unaligned accesses are supported. In x86, you <i>should</i> align, but you <i>don&#39;t have to</i>. In ARM or MIPS, you <i>must</i> align (or suffer from <code>SIGBUS</code> errors). OP was asking if there&#39;s a way to check whether you <i>must</i> align, not whether you <i>should</i>."}, {"owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "edited": false, "score": 0, "creation_date": 1423676254, "post_id": 28460395, "comment_id": 45247534, "body": "The misunderstanding probably stems from ambiguity of the word \u201crequirement\u201d: in case of x86, it is not a \u201crequirement\u201d (hard mandate), but merely a \u201crecommendation\u201d (soft advice)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423676275, "post_id": 28460395, "comment_id": 45247552, "body": "@Tim \u010cas OP is asking &quot;do C/C++ compilers define a constant that indicates alignment requirement?&quot;.  The sizeof of C11 type <code>max_align_t</code> is the minimum alignment requirement."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "edited": false, "score": 0, "creation_date": 1423676404, "post_id": 28460395, "comment_id": 45247620, "body": "chux: See @AntonSamsonov&#39;s comment above. <code>max_align_t</code> is not really a <i>requirement</i> here (well, it is when talking about strict C, since unaligned accesses are UB --- but we&#39;ve tossed out strict C the moment we started talking about the option of having those)."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": -2, "last_activity_date": 1423675406, "last_edit_date": 1495542133, "creation_date": 1423674967, "answer_id": 28460395, "question_id": 28459976, "link": "https://stackoverflow.com/questions/28459976/compiler-constant-indicating-memory-alignment-requirement/28460395#28460395", "title": "Compiler constant indicating memory alignment requirement", "body": "<p>OP:  do C/C++ compilers define a constant that indicates alignment requirement?<br>\nYes.  <code>max_align_t</code> is the type will the maximum alignment requirement.</p>\n\n<p>If the <code>sizeof(max_align_t) &gt; 1</code>, then some alignment is needed.</p>\n\n<p>For before C11, see <a href=\"https://stackoverflow.com/q/28459976/2410359\">Compiler constant indicating memory alignment requirement</a></p>\n"}], "owner": {"reputation": 1190, "user_id": 1879042, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Vul6p.jpg?s=128&g=1", "display_name": "Anton Samsonov", "link": "https://stackoverflow.com/users/1879042/anton-samsonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1423684925, "creation_date": 1423673721, "question_id": 28459976, "link": "https://stackoverflow.com/questions/28459976/compiler-constant-indicating-memory-alignment-requirement", "title": "Compiler constant indicating memory alignment requirement", "body": "<p>Some CPU architectures (other than x86) dislike reading and writing multibyte numbers at unaligned addresses so much that they raise SIGBUS exception upon detecting this and forcing the programmer to do everything manually on a byte-wise order. While nothing probably can be done with platforms that require this, it would be stupid to check for alignment and perform byte-wise operations on platforms that allow unaligned access (such as x86). The question is: <strong>do C/C++ compilers define a constant that indicates alignment requirement</strong>?</p>\n\n<p>Currently, I'm using this:</p>\n\n<pre><code>#if defined(_M_IX86) | defined(__i386) | defined(__i386__) | defined(i386) | defined(_X86_)\n    // Unaligned access is allowed.\n#elif defined(_M_X64) | defined(__x86_64__) | defined(__x86_64) | defined(__amd64) | defined(__amd64__) | defined(_M_AMD64)\n    // Unaligned access is allowed.\n#else\n    #define ALIGNED_ACCESS_ONLY\n#endif\n</code></pre>\n\n<p>But it looks too \u201chome-brew\u201d: rather than indicating the actual properties of current hardware platform, it only depicts my own considerations about x86-32 and x86-64 and the most popular constant names for these platforms.</p>\n"}, {"tags": ["objective-c", "c", "arrays", "enums"], "answers": [{"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423676252, "post_id": 28460290, "comment_id": 45247530, "body": "This won&#39;t work on architectures where <code>int</code> is not at least 36-bit (like x86). In fact, it invokes undefined behavior, because 36 is larger than the max allowed shift for 32-bit ints."}, {"owner": {"reputation": 301, "user_id": 2133820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rx44G.jpg?s=128&g=1", "display_name": "BoombaleOsby", "link": "https://stackoverflow.com/users/2133820/boombaleosby"}, "edited": false, "score": 0, "creation_date": 1423679401, "post_id": 28460290, "comment_id": 45249302, "body": "I tried this and it appears to be working fine - all had to do is cast the one first like 1ULL&lt;&lt;whichFlag. Also as recommended in other posts i made the backing ivar a uint64_t"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": -1, "last_activity_date": 1423674655, "creation_date": 1423674655, "answer_id": 28460290, "question_id": 28459919, "link": "https://stackoverflow.com/questions/28459919/possible-to-bitmask-more-values-than-an-int-can-hold/28460290#28460290", "title": "Possible to bitmask more values than an int can hold?", "body": "<p>If I understand your question, then the following might work:</p>\n\n<pre><code>enum flags\n{\n  .. 36 appropriatly named entries\n};\n\nlong long int myFlags = 0LL;\n\nint getFlag( enum flags whichFlag )\n{\n    return( (myFlags&amp;(1&lt;&lt;whichFlag)? 1:0 );\n}\n\nvoid setFlag( enum flags whichFlag )\n{\n    myFlags |= (1&lt;&lt;whichFlag);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "is_accepted": false, "score": 0, "last_activity_date": 1423675118, "creation_date": 1423675118, "answer_id": 28460441, "question_id": 28459919, "link": "https://stackoverflow.com/questions/28459919/possible-to-bitmask-more-values-than-an-int-can-hold/28460441#28460441", "title": "Possible to bitmask more values than an int can hold?", "body": "<p>In C, an enum is basically nothing else than just an int; as such, enums are limited to the maximum size of an integer.\nIf you want to have an arbitrary number of flags, you could use a bitfield:</p>\n\n<pre><code>struct flags {\n    unsigned f0 :1;\n    unsigned f1 :1;\n    unsigned f2 :1;\n    unsigned f3 :1;\n    unsigned f4 :1;\n    unsigned f5 :1;\n    unsigned f6 :1;\n    unsigned f7 :1;\n\n\n    ...\n\n    unsigned f35 :1;\n};\n\nstruct flags f;\n\nf.f33 = 1;\nf.f14 = 0;\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 2133820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rx44G.jpg?s=128&g=1", "display_name": "BoombaleOsby", "link": "https://stackoverflow.com/users/2133820/boombaleosby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 28460290, "answer_count": 2, "score": -1, "last_activity_date": 1423943861, "creation_date": 1423673549, "last_edit_date": 1423943861, "question_id": 28459919, "link": "https://stackoverflow.com/questions/28459919/possible-to-bitmask-more-values-than-an-int-can-hold", "title": "Possible to bitmask more values than an int can hold?", "body": "<p>I have 36 Bool flags that are related to one another.  Is there any way to enum this, or is an array / something else my only option?</p>\n\n<p>At first I tried to use a bitmask enum for this, but I realized that these are overflowing the Enum size and giving me bad results.</p>\n\n<p>I do not need to combine these like an options mask (they are independent of one another), just group.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "malloc"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423673566, "post_id": 28459889, "comment_id": 45245911, "body": "I think <code>K&amp;R</code> is an old book, and apparently old compilers didn&#39;t do this correctly."}, {"owner": {"reputation": 2141, "user_id": 3710044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd665eb6cb69cfcdbf5537974a78a17?s=128&d=identicon&r=PG&f=1", "display_name": "user3710044", "link": "https://stackoverflow.com/users/3710044/user3710044"}, "edited": false, "score": 1, "creation_date": 1423673631, "post_id": 28459889, "comment_id": 45245951, "body": "Very very old versions of C did not have (void*) so a cast was needed to pass &quot;lint&quot;. Your compiler NEVER needs the cast."}, {"owner": {"reputation": 7595, "user_id": 1946537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/35a99ae8d4d95127e3116eba23b0978d?s=128&d=identicon&r=PG", "display_name": "initramfs", "link": "https://stackoverflow.com/users/1946537/initramfs"}, "edited": false, "score": 1, "creation_date": 1423673696, "post_id": 28459889, "comment_id": 45245989, "body": "Cast in C++ and not in C. Though the use of <code>malloc()</code> would be discouraged over <code>new</code> and <code>delete</code>. If your compiler is giving you warnings, time to switch a compiler."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1423673721, "post_id": 28459889, "comment_id": 45246001, "body": "That&#39;s from the second edition (since it uses prototypes). The unnecessary cast is a little surprising."}, {"owner": {"reputation": 2141, "user_id": 3710044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd665eb6cb69cfcdbf5537974a78a17?s=128&d=identicon&r=PG&f=1", "display_name": "user3710044", "link": "https://stackoverflow.com/users/3710044/user3710044"}, "edited": false, "score": 0, "creation_date": 1423674157, "post_id": 28459889, "comment_id": 45246302, "body": "This particular cast isn&#39;t needed in ANY version of C, because the return type of malloc() would be either a (void*) or a (char*) so no C messages either way. Exactly what &quot;lint&quot; would do is another matter. (C++ OTOH has redefined (void*) from &quot;pointer to anything&quot; to &quot;pointer to nothing&quot; so it doesn&#39;t really count.)"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 2141, "user_id": 3710044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfd665eb6cb69cfcdbf5537974a78a17?s=128&d=identicon&r=PG&f=1", "display_name": "user3710044", "link": "https://stackoverflow.com/users/3710044/user3710044"}, "edited": false, "score": 1, "creation_date": 1423674280, "post_id": 28459889, "comment_id": 45246368, "body": "@user3710044: As I&#39;ve stated in my answer, and as iharob said --- it&#39;s entirely possible that certain ancient non-compliant compilers had trouble with that. That was <i>then</i> though, and <i>nowadays</i>, good luck finding a compiler with this problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1423674507, "post_id": 28459889, "comment_id": 45246496, "body": "Note that the quote about promotions is not entirely correct.  A <code>void *</code> is automatically and safely promoted to any pointer <i>to object</i> type, but not to any function pointer."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423673796, "post_id": 28459968, "comment_id": 45246067, "body": "The code is from the second edition (it uses a prototype, which didn&#39;t exist when the first edition was published). The cast is unnecessary."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423673896, "post_id": 28459968, "comment_id": 45246136, "body": "@KeithThompson: Probably added for compatibility with non-compliant compilers, then. Back then, it mattered; nowadays, pretty much every compiler implemnets C89 (or at least the vast majority of it)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423674437, "post_id": 28459968, "comment_id": 45246447, "body": "It&#39;s also in the errata (see my answer)."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423674641, "post_id": 28459968, "comment_id": 45246574, "body": "@KeithThompson: Nice, I didn&#39;t know about that. And I think that settles the &quot;cast malloc&quot; vs &quot;don&#39;t cast malloc&quot; argument --- the standards committee <i>themselves</i> say the cast is/can be harmful. I&#39;ll need to read K&amp;R C oneday, just so that I can help other people learning C better (when they quote it)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423674777, "post_id": 28459968, "comment_id": 45246648, "body": "The K&amp;R eratta list was not written by the committee."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1423674839, "post_id": 28459968, "comment_id": 45246687, "body": "@KeithThompson: Ah, disregard that part then. Still, I agree with the sentiment."}], "tags": [], "owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "is_accepted": false, "score": 2, "last_activity_date": 1423674150, "last_edit_date": 1423674150, "creation_date": 1423673697, "answer_id": 28459968, "question_id": 28459889, "link": "https://stackoverflow.com/questions/28459889/when-do-i-need-to-cast-the-result-of-malloc-in-c-language/28459968#28459968", "title": "When do I need to cast the result of malloc in C language?", "body": "<p>Firstly: K&amp;R C is ancient.</p>\n\n<p>Secondly: I don't know if that's the full code in that example, but in K&amp;R C, functions are assumed to have an <code>int</code> return value if not otherwise declared. If he's not declaring that <code>malloc</code>, it means it returns <code>int</code> as far as the compiler is concerned, hence the cast. Note that this is <em>undefined behavior</em> even in C89 (the earliest standarized version) and <em>extremely bad practice</em>; but he may have done it this way for brevity, or perhaps due to laziness --- or maybe for some other historical reason; I don't know all the intricacies of K&amp;R C, and it might be that <code>void*</code> to <code>char*</code> casts were not implicit back then.</p>\n\n<p>I should add that this is a very serious problem, since <code>int</code> and <code>void*</code> may have different sizes (and often do --- the most common example being most x86_64 code, where pointers are 64-bit, but ints are 32-bit).</p>\n\n<p><strong>UPDATE:</strong> @KeithThompson has informed me that the code is from 2nd edition, and <code>malloc</code> <em>is</em> declared there. That one is (unlike 1st ed) still relevant, if very much outdated at places.</p>\n\n<p>I'm <em>guessing</em> that the cast was likely done for compatibility with non-conforming compilers, which mattered at the time, as many [most?] compilers were not fully conforming yet. Nowadays, you'd have to get out of your way to find one that would need the cast (and no, C++ compilers don't count; they're C++ compilers, not C compilers).</p>\n"}, {"comments": [{"owner": {"reputation": 402, "user_id": 5500552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FuK6o.jpg?s=128&g=1", "display_name": "programmersn", "link": "https://stackoverflow.com/users/5500552/programmersn"}, "edited": false, "score": 0, "creation_date": 1562953038, "post_id": 28460192, "comment_id": 100555941, "body": "&quot;<i>The only case I can think of is passing the result of malloc() directly to a variadic function that needs an argument of a pointer type other than void*</i>&quot; : even this is partially true, as even if the expected argument type was <code>void*</code>, the implicit conversion to <code>void*</code> cannot be performed by the compiler on the passing argument, because of the variadic aspect of the function. The compiler cannot perform implicit conversion to a type it doesn&#39;t know ! Indeed, the only type of conversion the compiler performs on variadic and prototypeless functions are <i>default integer promotion</i> ..."}, {"owner": {"reputation": 402, "user_id": 5500552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FuK6o.jpg?s=128&g=1", "display_name": "programmersn", "link": "https://stackoverflow.com/users/5500552/programmersn"}, "edited": false, "score": 0, "creation_date": 1562953521, "post_id": 28460192, "comment_id": 100556135, "body": "... and <code>float</code> -&gt; <code>double</code> conversion, nothing else."}, {"owner": {"reputation": 402, "user_id": 5500552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FuK6o.jpg?s=128&g=1", "display_name": "programmersn", "link": "https://stackoverflow.com/users/5500552/programmersn"}, "edited": false, "score": 0, "creation_date": 1562953898, "post_id": 28460192, "comment_id": 100556287, "body": "<i>&quot;In such an unusual and contrived case, the cast can be avoided by assigning the result to a pointer object and passing that object&#39;s value to the function.) &quot;</i> : even in such a case you would need to cast the passed argument if the source (<i>T1</i>) and destination (<i>T2</i>) types are different. Failing to do so would lead to <i>UB</i> on architectures where the <i>T1</i> and <i>T2</i> types have different representations."}, {"owner": {"reputation": 402, "user_id": 5500552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FuK6o.jpg?s=128&g=1", "display_name": "programmersn", "link": "https://stackoverflow.com/users/5500552/programmersn"}, "edited": false, "score": 0, "creation_date": 1562953971, "post_id": 28460192, "comment_id": 100556321, "body": "The only case I can think of where a variadic function wouldn&#39;t need its trailing argument to be cast to the expected type is when the source and destination types are either <code>char*</code> and <code>void*</code> , as they are compelled to have same representation/alignment per the C standard, making any objects of such types interchangeable. AFAIK this is the only case where neither <i>implicit</i> nor <i>explicit</i> (<i>cast</i>) conversion is needed."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 8, "last_activity_date": 1443131935, "last_edit_date": 1443131935, "creation_date": 1423674369, "answer_id": 28460192, "question_id": 28459889, "link": "https://stackoverflow.com/questions/28459889/when-do-i-need-to-cast-the-result-of-malloc-in-c-language/28460192#28460192", "title": "When do I need to cast the result of malloc in C language?", "body": "<p>For any implementation conforming to C89 or later, casting the result of <code>malloc()</code> is never necessary.</p>\n\n<p>Casting the result of <code>malloc()</code> is mentioned in the <a href=\"http://cm.bell-labs.com/cm/cs/cbook/2ediffs.html\" rel=\"nofollow\">Errata for <em>The C Programming Language, Second Edition</em></a>:</p>\n\n<blockquote>\n  <p>142(\u00a76.5, toward the end): The remark about casting the return value\n  of malloc (\"the proper method is to declare ... then explicitly\n  coerce\") needs to be rewritten. The example is correct and works, but\n  the advice is debatable in the context of the 1988-1989 ANSI/ISO\n  standards. It's not necessary (given that coercion of <code>void *</code> to\n  <code>ALMOSTANYTYPE *</code> is automatic), and possibly harmful if <code>malloc</code>, or a\n  proxy for it, fails to be declared as returning <code>void *</code>. The explicit\n  cast can cover up an unintended error. On the other hand, pre-ANSI,\n  the cast was necessary, and it is in C++ also.</p>\n</blockquote>\n\n<p>(That link is no longer valid. The late Dennis Ritchie's home page is now <a href=\"https://www.bell-labs.com/usr/dmr/www/\" rel=\"nofollow\">here</a>; it points to an <a href=\"https://www.bell-labs.com/usr/cbook/index.html\" rel=\"nofollow\">updated location</a> for the home page for the book, but that link is also invalid.)</p>\n\n<p>Best practice is to assign the result of a <code>malloc()</code> call directly to a pointer object, and let the implicit conversion from <code>void*</code> take care of type consistency. The declaration of <code>malloc()</code> needs to be made visible via <code>#include &lt;stdlib.h&gt;</code>.</p>\n\n<p>(It's barely conceivable that you might want to use <code>malloc()</code> in a context where an explicit conversion is needed. The only case I can think of is passing the result of <code>malloc()</code> directly to a variadic function that needs an argument of a pointer type other than <code>void*</code>. In such an unusual and contrived case, the cast can be avoided by assigning the result to a pointer object and passing that object's value to the function.)</p>\n\n<p>The only good reasons to cast the result of <code>malloc()</code> are (a) compatibility with C++ (but the need to write code that compiles both as C and as C++ rarer than you might expect), and (b) compatibility with pre-ANSI C compilers (but the need to cater to such compilers is rare and becoming rarer).</p>\n"}, {"tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 1, "last_activity_date": 1423675454, "last_edit_date": 1423675454, "creation_date": 1423674582, "answer_id": 28460261, "question_id": 28459889, "link": "https://stackoverflow.com/questions/28459889/when-do-i-need-to-cast-the-result-of-malloc-in-c-language/28460261#28460261", "title": "When do I need to cast the result of malloc in C language?", "body": "<p>People who want (or may want) to cross compile C and C++ often cast <code>malloc(.)</code> because C++ won't automatically promote <code>void*</code>.</p>\n\n<p>As others point out in the good old days when function prototypes were optional the compiler would assume <code>malloc()</code> returned <code>int</code> if it hadn't seen the prototype with potentially catastrophic run-time outcomes.</p>\n\n<p>I try to see some point in that argument but I simply can't believe such situations occur with a regularity that warrants the flaming people then get for casting <code>malloc(.)</code>.</p>\n\n<p>Look at any Question that casts <code>malloc(.)</code> on this site and it doesn't matter what it's about some one will angrily demand they remove their casts as though they make their eyes bleed. </p>\n\n<p><strong>NB:</strong> It does no good and makes nothing wrong right to cast <code>malloc(.)</code> so it is clutter. In fact the only (real) argument I know is that it leads people to look at the cast and not look at the argument - which is what matters!</p>\n\n<p>I saw code on here today:</p>\n\n<pre><code>int** x=(int**)malloc(sizeof(int)*n);\n</code></pre>\n\n<p>It's very easy to be lulled into a false sense of security.\nThe <code>sizeof(int)</code> is doing (or in this case failing to do) the work to make sure what comes back from <code>malloc(.)</code> is right for the purpose. <code>(int**)</code> does no work.</p>\n\n<p>I'm not saying cast it. I am appealing for calm. I certainly think if a novice is failing to call <code>free(.)</code> we teach them that lesson <strong>before</strong> we get into nuances of casting <code>malloc(.)</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 3067430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/hIm3V.jpg?s=128&g=1", "display_name": "Tetravalente", "link": "https://stackoverflow.com/users/3067430/tetravalente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 0, "closed_date": 1423675744, "answer_count": 3, "score": 0, "last_activity_date": 1443131935, "creation_date": 1423673457, "last_edit_date": 1495542146, "question_id": 28459889, "link": "https://stackoverflow.com/questions/28459889/when-do-i-need-to-cast-the-result-of-malloc-in-c-language", "closed_reason": "Duplicate", "title": "When do I need to cast the result of malloc in C language?", "body": "<p>Based on <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">this old question</a> <code>malloc</code> returns a pointer to <code>void</code> that it </p>\n\n<blockquote>\n  <p>is automatically and safely promoted to any other pointer type</p>\n</blockquote>\n\n<p>But reading K&amp;R I've found this following code</p>\n\n<pre><code>char *strdup(char *s)\n{\nchar *p;\n/* make a duplicate of s */\np = (char *) malloc(strlen(s)+1)\n</code></pre>\n\n<p>What is the difference?</p>\n"}, {"tags": ["c", "string", "floating-point", "serial-port", "concatenation"], "comments": [{"owner": {"reputation": 3005, "user_id": 1319248, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2Jj2C.jpg?s=128&g=1", "display_name": "Kai Mattern", "link": "https://stackoverflow.com/users/1319248/kai-mattern"}, "edited": false, "score": 1, "creation_date": 1423672832, "post_id": 28459543, "comment_id": 45245433, "body": "Instead of tagging the question with things like concatenation, the programming languages would be a nice addition. Because that will make your question appear on some people&#39;s radar.  ;o)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4555488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d62895f510d53c63d2dfdf18f16598?s=128&d=identicon&r=PG", "display_name": "jpotesta", "link": "https://stackoverflow.com/users/4555488/jpotesta"}, "edited": false, "score": 0, "creation_date": 1423691710, "post_id": 28462396, "comment_id": 45256197, "body": "Sridhar, thank you this was very helpful and solved quite a few of the problems that I was having! The three problems that I still have are that for some reason sprint will not output anything for me but printf will; before I implement the f1 += 10, my f1 value is already off by a factor of 10 (could be something that is wrong in my code); lastly, implementing f1 += 10 does not seem to change the value of f1 (I cant seem to change it by setting it equal to a different value either)."}, {"owner": {"reputation": 3, "user_id": 4555488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d62895f510d53c63d2dfdf18f16598?s=128&d=identicon&r=PG", "display_name": "jpotesta", "link": "https://stackoverflow.com/users/4555488/jpotesta"}, "edited": false, "score": 0, "creation_date": 1423693904, "post_id": 28462396, "comment_id": 45257344, "body": "Sridhar, following up on the last comment that I left; I currently am getting the value of f1 to change, sprintf is now working, but for some reason I am still off by a factor of 10 with f1. This does not matter though as I will be manually inputting the value to something user defined and not adding/subtracting to it. Thanks for the help with this!"}], "tags": [], "owner": {"reputation": 919, "user_id": 3095460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utTEO.jpg?s=128&g=1", "display_name": "Sridhar Nagarajan", "link": "https://stackoverflow.com/users/3095460/sridhar-nagarajan"}, "is_accepted": true, "score": 0, "last_activity_date": 1423682567, "last_edit_date": 1423682567, "creation_date": 1423681402, "answer_id": 28462396, "question_id": 28459543, "link": "https://stackoverflow.com/questions/28459543/writing-comma-delimited-string-to-serial-port-from-floating-point-variables/28462396#28462396", "title": "Writing comma delimited string to serial port from floating point variables", "body": "<pre><code>int asdf = sscanf(data_str,\"%f,%f,%f\", &amp;press, &amp;temp, &amp;cond);\nstrn = (\"%f,%f, %f\", press, temp, cond);\n</code></pre>\n\n<p>i think above you probably wanted to form a string with all the three float variables but, this is actually storing the <code>cond</code> float value converted to a character in <code>strn</code></p>\n\n<pre><code>char ppri[3]\n</code></pre>\n\n<p><code>ppri</code> is an array of 3 characters, which literally cannot store three float values after converting them into string, unless each float is a single digit integer. but still, you have no space to put three commas in that also. </p>\n\n<pre><code>ppri[1]= [press+1.3,temp,cond];\n</code></pre>\n\n<p>this line will not compile at any cost, i dont know how it compiles for you. </p>\n\n<pre><code>ppri[2] = temp;\nppri[3] = cond;\n</code></pre>\n\n<p>declared char array of size 3 and you cannot access <code>ppri[3]</code>, array index starts with 0.</p>\n\n<pre><code>printf(\"%f\",ppri);\n</code></pre>\n\n<p>since ppri is an array, ppri store the address of the first char.</p>\n\n<pre><code>write(cmp_fd,ppri,sizeof(ppri)); \n</code></pre>\n\n<p>this will write 3 characters in the file pointed by the fd.</p>\n\n<p>I am not sure what you are trying to do in these part of the code, this is my initial observation, you can see other mistakes in the code, try fixing them.</p>\n\n<p>but anyhow if you want to parse float separated by comma, then you could use,</p>\n\n<pre><code>float f1, f2, f2;\n// read float values from string,\nsscanf(data_str,\"%f,%f,%f\",&amp;f1,&amp;f2,&amp;f3);\n// modify the float value\nf1 += 10;\n// form the modified string again.\nsprintf(data_str,\"%f,%f,%f\",f1,f2,f3);\n</code></pre>\n\n<p>and write back the <code>data_str</code> </p>\n"}], "owner": {"reputation": 3, "user_id": 4555488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d62895f510d53c63d2dfdf18f16598?s=128&d=identicon&r=PG", "display_name": "jpotesta", "link": "https://stackoverflow.com/users/4555488/jpotesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 28462396, "answer_count": 1, "score": 0, "last_activity_date": 1423682567, "creation_date": 1423672553, "last_edit_date": 1423674001, "question_id": 28459543, "link": "https://stackoverflow.com/questions/28459543/writing-comma-delimited-string-to-serial-port-from-floating-point-variables", "title": "Writing comma delimited string to serial port from floating point variables", "body": "<p>I am parsing a string that has 3 values in it, comma separated. I am currently using sscanf for this, which works just fine. What I am trying to do is to manipulate on of these values after parsing the string and concatenate my results back into the same format that I received it in and write it back to the serial port after each time I read and manipulate the string. I think the problem that I am running into is that I declare the variable as a float when being parsed, and am wondering how I can put the floats back together to write to a serial port. I am also having the problem of the variables actually writing to the buffer and sending out, but that is a different story. Any help with this would be greatly appreciated. Here is a sample of what I have:</p>\n\n<pre><code>    do {\n                struct timeval timeout = {0,299500};\n                char c;\n                fd_set fds;\n                int ret1, ret2;\n                //Zero file descriptor set, then append all types.\n                FD_ZERO(&amp;fds);\n                FD_SET(cmp_fd, &amp;fds);\n                FD_SET(STDIN_FILENO, &amp;fds);\n                ret1 = select(FD_SETSIZE, &amp;fds, NULL, NULL, &amp;timeout);\n                if (ret1 == -1)\n                  {\n                        perror(\"select\");\n                        need_exit = 1;\n                  }\n                 else if (ret1 &gt; 0)\n                         {\n                         if (FD_ISSET(cmp_fd, &amp;fds))\n                                {\n                                 do {ret2 = read(cmp_fd, &amp;c, 1);}\n                                 while ((ret2 &lt; 0 &amp;&amp; errno == EINTR));\n                                 if (ret2 == 1)\n                                        {\n                                        data_str[cmp_ind] = c;\n                                        cmp_ind++;\n\n                                        if(c == '\\n')\n                                                {\n                                                float press, temp, cond;\n                                                char strn;\n\n      int asdf = sscanf(data_str,\"%f,%f,%f\", &amp;press, &amp;temp, &amp;cond);\n                                        strn = (\"%f,%f, %f\", press, temp, cond);\n\nchar ppri[3]\nppri[1]= [press+1.3,temp,cond];\nppri[2] = temp;\nppri[3] = cond;\nprintf(\"%f\",ppri);\n\nwrite(cmp_fd,ppri,sizeof(ppri));    /* &lt;-- This is what I am trying to do*/\n                       /*needed output is: \"#####.##,#####.##, #####.##\" */ \n                                                bzero(data_str,100);\n                                                cmp_ind = 0;\n                                                printf(\"\\r\\n\");\n\n                                                }\n                                        }\n                              else if(ret2 == -1)\n                                         {\n                                           perror(\"read\");\n                                           need_exit = 1;\n                                         }\n                              }\n                if(FD_ISSET(STDIN_FILENO, &amp;fds))\n                        {\n                        do {ret2 = read(STDIN_FILENO, &amp;c, 1);}\n                        while (ret2 &lt; 0 &amp;&amp; errno == EINTR);\n                                if(ret2 == 1)\n                                        {\n                                        if(c == '\\x01') {\n                                                need_exit = -1;\n                                        }\n                        }\n        }\n}\n\n}\n while (!need_exit);\n</code></pre>\n"}, {"tags": ["c", "reverse", "postfix-notation", "rpn"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423671807, "post_id": 28459220, "comment_id": 45244735, "body": "What do you mean by &quot;not inputting properly&quot;? What&#39;s the input? What&#39;s the output? What&#39;s the desired output?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423672640, "post_id": 28459220, "comment_id": 45245317, "body": "BTW <code>a[i++] =v;</code> always last <code>v</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423672720, "post_id": 28459220, "comment_id": 45245355, "body": "<code>printf(&quot;%s\\n&quot;,*a[p]);</code> :  <code>*a[p]</code> is <code>a char</code>. and <code>v</code> is out of scope."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423673238, "post_id": 28459220, "comment_id": 45245719, "body": "<code>for (m=0; m != k; m++, k--)</code> wrong."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423673326, "post_id": 28459220, "comment_id": 45245780, "body": "That 2nd error pointed out by @BLUEPIXY would&#39;ve been caught by most modern compilers, if warnings were enabled. I <b>strongly</b> recommend that you enable warnings (<code>-Wall</code> in GCC and CLang; check your compiler&#39;s manual if you have some other compiler)."}, {"owner": {"reputation": 413, "user_id": 4414341, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/2fa7cc3bd9ac53bdb8bc424b82ce3f45?s=128&d=identicon&r=PG&f=1", "display_name": "Alpa8", "link": "https://stackoverflow.com/users/4414341/alpa8"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423674818, "post_id": 28459220, "comment_id": 45246673, "body": "@Tim \u010cas From not inputting properly I mean after inputing the no of test cases i.e.int z and first line if input it crashes"}, {"owner": {"reputation": 413, "user_id": 4414341, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/2fa7cc3bd9ac53bdb8bc424b82ce3f45?s=128&d=identicon&r=PG&f=1", "display_name": "Alpa8", "link": "https://stackoverflow.com/users/4414341/alpa8"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1423674994, "post_id": 28459220, "comment_id": 45246775, "body": "@BLUEPIXY I couldn&#39;t understand what you mean by-printf(&quot;%s\\n&quot;,*a[p]); : *a[p] is a char. and v is out of scope."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423675795, "post_id": 28459220, "comment_id": 45247247, "body": "<code>char *a[100];</code>: <code>a</code> is array of pointer to <code>char</code>. <code>a[p]</code> is pointer to <code>char</code>. <code>*a[p]</code> pointer dereference is <code>char</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1423676151, "post_id": 28459220, "comment_id": 45247464, "body": "<code>while (q-- &gt; 0)  {  char v[400];</code> : <code>v</code> is an effective area in the while block. If you see outside of the block is not valid."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1439544056, "creation_date": 1439544056, "answer_id": 32006602, "question_id": 28459220, "link": "https://stackoverflow.com/questions/28459220/reverse-polish-converter/32006602#32006602", "title": "Reverse Polish converter", "body": "<blockquote>\n  <p>after inputing the no of test cases i.e.int z and first line if input\n  it crashes</p>\n</blockquote>\n\n<p>This is due to the</p>\n\n<pre><code>        printf(\"%s\\n\",*a[p]);\n</code></pre>\n\n<p>as BLUEPIXY noticed, <em><code>*a[p]</code> is a <code>char</code></em>; but <code>%s</code> expects a <code>char *</code>, thus you need</p>\n\n<pre><code>        printf(\"%s\\n\", a[p]);\n</code></pre>\n\n<p>and regarding <em><code>v</code> is out of scope</em>, the crucial factor is not the scope (visibility), but the storage duration (lifetime) of <code>v</code> - its lifetime ends when execution of the block with which it is associated ends, and the value of a pointer <code>a[i]</code> to it becomes indeterminate; by changing</p>\n\n<pre><code>        a[i++] =v;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>        a[i++] = strdup(v);\n</code></pre>\n\n<p>you can remedy that.</p>\n"}], "owner": {"reputation": 413, "user_id": 4414341, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/2fa7cc3bd9ac53bdb8bc424b82ce3f45?s=128&d=identicon&r=PG&f=1", "display_name": "Alpa8", "link": "https://stackoverflow.com/users/4414341/alpa8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439544056, "creation_date": 1423671590, "last_edit_date": 1423676911, "question_id": 28459220, "link": "https://stackoverflow.com/questions/28459220/reverse-polish-converter", "title": "Reverse Polish converter", "body": "<p>I am trying to make a reverse Polish printer which can perform the following operation-</p>\n\n<p>Inputs:</p>\n\n<ol>\n<li><code>(a+(b*c))</code></li>\n<li><code>((a+b)*(z+x))</code></li>\n<li><code>((a+t)*((b+(a+c))^(c+d)))</code></li>\n</ol>\n\n<p>Outputs:</p>\n\n<ol>\n<li><code>abc*+</code></li>\n<li><code>ab+zx+*</code></li>\n<li><code>at+bac++cd+^*</code></li>\n</ol>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nchar pop(int t);\nvoid push(int c, int t);\nint main()\n{\n    int z;\n    scanf(\"%d\", &amp;z);\n    char *a[100];\n    int i = 0;\n    int q = z;\n    while (q-- &gt; 0)\n    {\n        char v[400];\n        scanf(\"%s\", &amp;v);\n        int t;\n        for (t = 0; t &lt; strlen(v); t++)    //loop to put the values and signs in the 2 stacks\n        {\n            if ((v[t] == '*') || (v[t] == '+') || (v[t] == '-') || (v[t] == '^'))\n            {\n                push(v[t], 2);\n\n\n            }\n\n            else if (v[t] == ')')\n            {\n                int y = pop(2);\n                push(y, 1);\n\n            }\n\n            else\n            {\n                push(v[t], 1);\n\n            }\n        }\n        int k = 0;\n        char c;\n        while ((c = pop(1)) !='\\0')    //loop to put elements in the array v\n        {\n\n            if (c != '(')\n            {\n\n                v[k++] = c;\n\n            }\n        }\n        v[k--] = '\\0';\n        int m;\n        for (m=0; m != k; m++, k--)     //for reversing the string\n        {\n            char t = v[m];\n            v[m] = v[k];\n            v[k] = t;\n        }\n\n        a[i++] =v;\n        printf(\"%s\",a[i - 1]);\n    }\n    int p;\n    for (p = 0; p &lt;z ; p++)   //printing the elements\n        printf(\"%s\\n\",*a[p]);\n    return 0;\n}\nchar ac[400];\nchar as[400];\nint ic = 0;\nint is = 0;\nvoid push(int c,int t)\n{\n    if (t == 1 &amp;&amp; ic != 400)\n        ac[ic++] = c;\n    else if (t == 2 &amp;&amp; is != 400)\n        as[is++] = c;\n}\nchar pop(int t)\n{\n    if (t == 1 &amp;&amp; ic != 0)\n        return ac[--ic];\n    if (t == 2 &amp;&amp; is != 0)\n        return as[--is];\n    return '\\0';\n}\n</code></pre>\n\n<p>But it is not even inputting properly and I am not able to figure out what are the mistakes in this code.Please help to figure out what are the problems. </p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1423670591, "post_id": 28458660, "comment_id": 45243972, "body": "Arrays are not pointers."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1423671653, "post_id": 28458660, "comment_id": 45244620, "body": "when you don&#39;t pass struct by pointers, you will have an implicit copy of it. in you example, <code>bar</code> modify the array through a pointer, that&#39;s why."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1423671821, "post_id": 28458660, "comment_id": 45244746, "body": "and arrays are not pointers semantically, but they can be the same in type system. two are different concepts. <code>int a[10], b[10]; a = b;</code> is illegal assignment."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423671898, "post_id": 28458660, "comment_id": 45244803, "body": "I can only hope the instructor is not teaching their students to write names with leading underscores &#39;_&#39; and to write #define&#39;d values that are not surrounded by parens &#39;(&#39; and &#39;)&#39; and writing multiple indented lines under an &#39;if&#39; statement with out using braces &#39;{&#39; and &#39;}&#39; and using meaningless variable names like &#39;A&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423672979, "post_id": 28458660, "comment_id": 45245537, "body": "passing the whole struct rather than a pointer to the struct is a very bad idea because the compiler will introduce 1) &#39;hidden&#39; memory areas (that cannot be otherwise reached), 2) at least 2 calls to memcpy() for each struct,  This greatly increases the complexity of the code, is much more difficult to debug, even with a good debugger and hides what is actually occuring."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423673169, "post_id": 28458660, "comment_id": 45245675, "body": "When passing the struct, the whole struct is passed, including any data within the struct, so the contents of arr1 are available/copied, while the pointer to array arr2 gets the pointer passed, but the data being pointed to does not get copied"}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1423670999, "last_edit_date": 1423670999, "creation_date": 1423670310, "answer_id": 28458764, "question_id": 28458660, "link": "https://stackoverflow.com/questions/28458660/struct-has-two-fields-each-one-is-an-1d-array-passing-the-struct-object-to-a/28458764#28458764", "title": "Struct has two fields , each one is an 1d array. Passing the struct object to a function without pointer , would change the struct object?", "body": "<p>The reason the changes done by <code>bar</code> are visible in the original <code>struct</code> is because <code>_arr2</code> in the copy of the <code>struct</code> is still pointing to <code>_arr1</code> of the original <code>struct</code> that you have passed. Essentially, you are passing a pointer, except now it is hidden in the <code>struct</code> that is passed by value.</p>\n\n<p><img src=\"https://i.stack.imgur.com/NxY9F.png\" alt=\"Illustration\"></p>\n\n<p>Here is a way to see what's going on:</p>\n\n<pre><code>void bar(A a) {\n    printf(\"%p %p\", (void*)a._arr2, (void*)&amp;a._arr1);\n    for (int i=0;i&lt; ARR_SIZE;++i) {\n       a._arr2[i] = 10*i;\n    }\n}\n</code></pre>\n\n<p>This will print different pointers for <code>_arr2</code> stored in the <code>struct</code> and <code>_arr1</code> embedded in it.</p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 2, "last_activity_date": 1423670532, "creation_date": 1423670532, "answer_id": 28458855, "question_id": 28458660, "link": "https://stackoverflow.com/questions/28458660/struct-has-two-fields-each-one-is-an-1d-array-passing-the-struct-object-to-a/28458855#28458855", "title": "Struct has two fields , each one is an 1d array. Passing the struct object to a function without pointer , would change the struct object?", "body": "<p><code>struct A</code> has an array and a pointer inside.</p>\n\n<pre><code>typedef struct _A {\n   int _arr1[ARR_SIZE];     // _arr1 is an array\n   int* _arr2; } A;         // _arr2 is a pointer\n</code></pre>\n\n<p>If you pass a copy of the pointer, the copy still points to the same place.</p>\n\n<p>Changing what the copy points to reflects in the calling function.</p>\n\n<p>You might like to read about differences between arrays and pointers.<br>\nI suggest section 6 of the <a href=\"http://c-faq.com/\" rel=\"nofollow\">c-faq</a>.</p>\n"}], "owner": {"reputation": 333, "user_id": 2637293, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/97407ddf4b7f3fb47264eb96f4a03cbf?s=128&d=identicon&r=PG", "display_name": "user2637293", "link": "https://stackoverflow.com/users/2637293/user2637293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 28458764, "answer_count": 2, "score": 1, "last_activity_date": 1423670999, "creation_date": 1423670030, "question_id": 28458660, "link": "https://stackoverflow.com/questions/28458660/struct-has-two-fields-each-one-is-an-1d-array-passing-the-struct-object-to-a", "title": "Struct has two fields , each one is an 1d array. Passing the struct object to a function without pointer , would change the struct object?", "body": "<p>This is a question from a test that i had yesterday.<br>\nConsidering this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define ARR_SIZE 5\n\ntypedef struct _A {\n   int _arr1[ARR_SIZE];\n   int* _arr2; } A;\n\nvoid foo(A a) {\n   int i;\n   for (i=0;i&lt; ARR_SIZE;++i)\n      a._arr1[i] = 5*i;\n}\n\nvoid bar(A a) {\n   int i;\n   for (i=0;i&lt; ARR_SIZE;++i)\n   a._arr2[i] = 10*i;\n}\n\nvoid printA(A* a,char* str)\n{\n   int i;\n   printf(\"%s:\\n_arr1:\\t\",str);\n   for (i=0;i&lt; ARR_SIZE;++i)\n       printf(\"%d\\t\",a-&gt;_arr1[i]);\n       printf(\"\\n_arr2:\\t\");\n   for (i=0;i&lt; ARR_SIZE;++i)\n       printf(\"%d\\t\",a-&gt;_arr2[i]);\n       printf(\"\\n\");\n}\n\nint main() {\n    A a1 = {{1,2,3,4,5},0};\n    A a2 = a1;\n    a1._arr2 = a1._arr1;\n    a2._arr2 = a2._arr1;\n    foo(a1);\n    bar(a2);\n    printA(&amp;a1,\"a1\");\n    printA(&amp;a2,\"a2\");\n    return 0;\n}\n</code></pre>\n\n<p>Now, it print this: \n<code>a1:<br>\n_arr1:  1       2       3       4       5<br>\n_arr2:  1       2       3       4       5<br>\na2:<br>\n_arr1:  0       10      20      30      40<br>\n_arr2:  0       10      20      30      40</code>  </p>\n\n<p>I don't understand the printings. If i make step by step configuring the code, i see that passing <code>a1</code> to <code>foo</code> won't make anything because i didn't sent a pointer-to-<code>a1</code>. But what i don't understand is why if i sent <code>a2</code> to <code>bar</code> without a pointer, it changes <code>a2</code>.<br>\nI thought about because <code>_arr2</code> is a pointer, and because of it,<code>bar</code> changes it, so <code>a2</code> changes. But, we know that every array is a pointer to the first element. So <code>_arr1</code> is an array, so it a pointer, but doesn't change!</p>\n\n<p>Can someone explain me why it happens? tnx a lot in advance!</p>\n"}, {"tags": ["c++", "c", "visual-studio-2010", "android-ndk"], "comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1423678164, "post_id": 28458629, "comment_id": 45248612, "body": "Use <code>snprintf</code> so you don&#39;t overflow the <code>szBuf</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1649, "user_id": 3133604, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/354805cc57c4ff2d7d88f95d791fef12?s=128&d=identicon&r=PG&f=1", "display_name": "undermind", "link": "https://stackoverflow.com/users/3133604/undermind"}, "is_accepted": false, "score": 2, "last_activity_date": 1423675555, "creation_date": 1423675555, "answer_id": 28460601, "question_id": 28458629, "link": "https://stackoverflow.com/questions/28458629/visualgdb-expression-must-have-pointer-type/28460601#28460601", "title": "VisualGDB. Expression must have pointer type", "body": "<p>Maybe, you should replace</p>\n\n<pre><code>jstring str = (*env)-&gt;NewStringUTF(env, szBuf);\n</code></pre>\n\n<p>with</p>\n\n<pre><code>jstring str = env-&gt;NewStringUTF(env, szBuf);\n</code></pre>\n\n<p>or with</p>\n\n<pre><code>jstring str = (*env).NewStringUTF(env, szBuf);\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 3631468, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/u9X95.jpg?s=128&g=1", "display_name": "farissyariati", "link": "https://stackoverflow.com/users/3631468/farissyariati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423675555, "creation_date": 1423669931, "question_id": 28458629, "link": "https://stackoverflow.com/questions/28458629/visualgdb-expression-must-have-pointer-type", "title": "VisualGDB. Expression must have pointer type", "body": "<p>I have just started using visualgdb</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;jni.h&gt;\n#include &lt;stdio.h&gt;\n\nint s_ButtonPressCounter = 0;\n\njstring\nJava_com_visualgdb_example_AndroidProject1_AndroidProject1_stringFromJNI( JNIEnv* env,\n                                                  jobject thiz )\n{\n    char szBuf[512];\n    sprintf(szBuf, \"You have pressed this huge button %d times\", s_ButtonPressCounter++);\n    jstring str = (*env)-&gt;NewStringUTF(env, szBuf);\n    return str;\n}\n</code></pre>\n\n<p>I have my intelissense show error log \nExpression must have pointer type.</p>\n\n<p>I tried to change it to env.NewStringUTF(szBuf) but the build comes to error.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6383, "user_id": 4371276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ce728cefdf7fcbcff17ee06ad463db?s=128&d=identicon&r=PG&f=1", "display_name": "dmg", "link": "https://stackoverflow.com/users/4371276/dmg"}, "edited": false, "score": 3, "creation_date": 1423670103, "post_id": 28458581, "comment_id": 45243652, "body": "Yes. Preprocessing. Store <code>a[0] + ... + a[j]</code> at a[j]. This way you can answer a query in constant time."}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "reply_to_user": {"reputation": 6383, "user_id": 4371276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ce728cefdf7fcbcff17ee06ad463db?s=128&d=identicon&r=PG&f=1", "display_name": "dmg", "link": "https://stackoverflow.com/users/4371276/dmg"}, "edited": false, "score": 0, "creation_date": 1423670212, "post_id": 28458581, "comment_id": 45243720, "body": "You mean what to replace? The sum function?"}, {"owner": {"reputation": 6383, "user_id": 4371276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ce728cefdf7fcbcff17ee06ad463db?s=128&d=identicon&r=PG&f=1", "display_name": "dmg", "link": "https://stackoverflow.com/users/4371276/dmg"}, "edited": false, "score": 0, "creation_date": 1423670324, "post_id": 28458581, "comment_id": 45243789, "body": "Store the sum of all the elements up to <code>j</code> in <code>a[j]</code>. That way when you have a query just return <code>a[last] - (first &gt; 0 ? a[first - 1] : 0)</code>"}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "reply_to_user": {"reputation": 6383, "user_id": 4371276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ce728cefdf7fcbcff17ee06ad463db?s=128&d=identicon&r=PG&f=1", "display_name": "dmg", "link": "https://stackoverflow.com/users/4371276/dmg"}, "edited": false, "score": 0, "creation_date": 1423670393, "post_id": 28458581, "comment_id": 45243826, "body": "@dmg and how can that make it linear? Can you please explain yourself more. I know you know it but if you want make a full answer!"}, {"owner": {"reputation": 6383, "user_id": 4371276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02ce728cefdf7fcbcff17ee06ad463db?s=128&d=identicon&r=PG&f=1", "display_name": "dmg", "link": "https://stackoverflow.com/users/4371276/dmg"}, "edited": false, "score": 0, "creation_date": 1423673646, "post_id": 28458581, "comment_id": 45245959, "body": "After your update change the line to <code>sum = integralArray[last] - (first &gt; 0 ? integralArray[first - 1] : 0);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423673791, "post_id": 28458581, "comment_id": 45246058, "body": "regarding the malloc calls:  1) in C, do not cast the returned value,  2) always check the returned value to assure the operation was successful (!= NULL)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1423673845, "post_id": 28458581, "comment_id": 45246096, "body": "regarding the fscanf calls: always check the returned value to assure the input/conversion operation was successful"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1423680535, "post_id": 28458581, "comment_id": 45249998, "body": "this problem is perfect for <code>prefix sum</code> or <code>scan</code>. have a look at this technique."}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423670571, "post_id": 28458805, "comment_id": 45243955, "body": "and what about the sum function? Where do I put these? Sorry for my nobbility! but I really lost myshelf"}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423670839, "post_id": 28458805, "comment_id": 45244147, "body": "Oooh and each element in the <code>integralArray[i]</code> is the sum of each querry?"}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423671009, "post_id": 28458805, "comment_id": 45244247, "body": "ok again I didn&#39;t understand. Sorry but I don&#39;t need the sum function with that? And the <code>i</code> isn&#39;t always greater than 0?"}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423671708, "post_id": 28458805, "comment_id": 45244669, "body": "I wrote the sum like this : <code>sum = integralArray[last] - integralArray[first - 1];</code> cause we want [i,j] (I don&#39;t know if I do it right. But the output isn&#39;t correct. Am I doing something wrong?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423673461, "post_id": 28458805, "comment_id": 45245862, "body": "Minor: consider different malloc style: <code>int *array = malloc(N * sizeof *array);</code>.  Cast not needed and IMO easier to code/maintain."}, {"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "edited": false, "score": 0, "creation_date": 1423674907, "post_id": 28458805, "comment_id": 45246738, "body": "Assuming <code>last</code> and <code>first</code> greater than 0, probably <code>integralArray[last-1] - integralArray[first-1]</code> if you wanted the sum in the range [first, last). Each <code>integralArray</code> entry is the sum of everything up to <i>and including</i> the number at that index."}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423675923, "post_id": 28458805, "comment_id": 45247328, "body": "@Tommy I wanted [first,last], but as I point out I take flase ouputs. What am I doin&#39;t wrong? See the update of my code and tell me"}, {"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "reply_to_user": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423679726, "post_id": 28458805, "comment_id": 45249477, "body": "@Opo the way I&#39;d written it the <code>integralArray</code> wasn&#39;t actually the sum it claimed to be. Fixed. Also you should check for <code>first &gt; 0</code> before assuming that <code>first - 1</code> is a safe index."}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423683214, "post_id": 28458805, "comment_id": 45251617, "body": "@Tommy ok <code>sum = integralArray[last] - ((first &gt; 0) ? array[first-1] : 0);</code> , but even now nothing worked. Can you please make a full post of the code? What is going wrong anyway?"}, {"owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "reply_to_user": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423687341, "post_id": 28458805, "comment_id": 45253874, "body": "@Opo I&#39;m just making up input data, which looks good to me. Is share.in publicly available? I&#39;d rather not post incorrect code."}, {"owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "edited": false, "score": 0, "creation_date": 1423767108, "post_id": 28458805, "comment_id": 45292688, "body": "@Tommy if you see the link of the problem you&#39;ll see the input example."}], "tags": [], "owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "is_accepted": false, "score": 2, "last_activity_date": 1423679652, "last_edit_date": 1423679652, "creation_date": 1423670404, "answer_id": 28458805, "question_id": 28458581, "link": "https://stackoverflow.com/questions/28458581/make-a-program-run-linear-in-c/28458805#28458805", "title": "Make a program run linear in C", "body": "<p>You'd form the integral array. Modify to something like:</p>\n\n<pre><code>int *array = (int*)malloc(N * sizeof(int));\nint *integralArray = (int*)malloc(N * sizeof(int));\n\nfor (int i = 0; i &lt; N; i++) {\n    fscanf(input,\"%d\",&amp;array[i]);\n    integralArray[i] = array[i] + ((i &gt; 0) ? integralArray[i-1] : 0);\n}\n</code></pre>\n\n<p>So the element at <code>integralArray[i]</code> is the sum of all elements in <code>array</code> from <code>0</code> to <code>i</code>.</p>\n\n<p>Then, to get the sum from <code>a</code> to <code>b</code>, where <code>a &gt; b</code>, <code>integralArray[b]</code> is the sum from <code>0</code> to <code>b</code> and <code>integralArray[a]</code> is the sum from <code>0</code> to <code>a</code> so you can just compute <code>integralArray[b] - integralArray[a]</code> to get the total from <code>a</code> to <code>b</code>. Intuitively, <code>integralArray[b]</code> includes the numbers you want but it also includes the numbers up to and including <code>a</code>. You don't want those so you take them off again.</p>\n\n<p>Vary appropriately for inclusion or exclusion of the number at <code>a</code> and the number at <code>b</code>. That as given will include the number at <code>b</code> but not that at <code>a</code>. You could adjust your <code>integralArray</code> to be one earlier (so <code>integralArray[b]</code> is the sum from 0 to <code>b-1</code>) or adjust your indices.</p>\n"}], "owner": {"reputation": 209, "user_id": 4110944, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/100005329808990/picture?type=large", "display_name": "Nikos KLon", "link": "https://stackoverflow.com/users/4110944/nikos-klon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474886265, "creation_date": 1423669829, "last_edit_date": 1474886265, "question_id": 28458581, "link": "https://stackoverflow.com/questions/28458581/make-a-program-run-linear-in-c", "title": "Make a program run linear in C", "body": "<p>So based in the following problem from <a href=\"http://www.spoj.com/problems/CSUMQ/\" rel=\"nofollow\">cumulative sum query</a> I created the solution. But is any other way to solve the problem in C with linear complexity O(N)?</p>\n\n<p>Problem description:</p>\n\n<blockquote>\n  <p>William Macfarlane wants to look at an array.</p>\n  \n  <p>You are given a list of N numbers and Q queries. Each query is\n  specified by two numbers i and j; the answer to each query is the sum\n  of every number between the range [i, j] (inclusive).</p>\n  \n  <p>Note: the query ranges are specified using 0-based indexing. </p>\n  \n  <p><strong>Input</strong></p>\n  \n  <p>The first line contains N, the number of integers in our list (N &lt;=\n  100,000). The next line holds N numbers that are guaranteed to fit\n  inside an integer. Following the list is a number Q (Q &lt;= 10,000). The\n  next Q lines each contain two numbers i and j which specify a query\n  you must answer (0 &lt;= i, j &lt;= N-1). Output</p>\n  \n  <p><strong>Output</strong></p>\n  \n  <p>For each query, output the answer to that query on its own line in the\n  order the queries were made.</p>\n</blockquote>\n\n<p>Here is the solution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n\nstruct node {\n    int first;\n    int last;\n};\n\nint sum_array(int *array, int first, int last) {\n    int sum = 0;\n    for (int i = first; i &lt;= last; i++) {\n        sum += array[i];\n    }\n\n    return sum;\n}\n\nint main() {\n    FILE* input = fopen(\"share.in\",\"r\");\n\n    int N = 0;\n    fscanf(input,\"%d\",&amp;N);\n\n    int *array = (int*)malloc(N * sizeof(int));\n\n    for (int i = 0; i &lt; N; i++) {\n        fscanf(input,\"%d\",&amp;array[i]);\n    }\n\n    int Q = 0;\n    fscanf(input,\"%d\",&amp;Q);\n\n    struct node query[Q];\n\n    for (int i=0; i &lt; Q; i++) {\n        fscanf(input,\"%d\",&amp;query[i].first); \n        fscanf(input,\"%d\",&amp;query[i].last); \n    }\n\n    fclose(input);\n\n    int sum = 0;\n    for ( int i = 0; i &lt; Q ; i++) {\n        int first = query[i].first;\n        int last = query[i].last;\n\n        sum = sum_array(array,first,last);\n\n        printf(\"Number of queries : %d , sum is %d\\n\",i ,sum);\n    }\n\n    free(array); \n    return 0;\n}\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>The answer given is good. But for some reason <strong>I couldn't make it work</strong>. </p>\n\n<p>So here is the code rewritten and if someone can explain me what I do wrong I will be happy! Keep in mind we want the range to be <strong>[first,last]</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;limits.h&gt;\n\nstruct node {\n    int first;\n    int last;\n};\n\nint sum_array(int *array, int first, int last) {\n    int sum = 0;\n    for (int i = first; i &lt;= last; i++) {\n        sum += array[i];\n    }\n\n    return sum;\n}\n\nint main() {\n    FILE* input = fopen(\"share.in\",\"r\");\n\n    int N = 0;\n    fscanf(input,\"%d\",&amp;N);\n\n    int *array = (int*)malloc(N * sizeof(int));\n    int *integralArray = (int*)malloc(N * sizeof(int));    \n\n    for (int i = 0; i &lt; N; i++) {\n        fscanf(input,\"%d\",&amp;array[i]);\n        integralArray[i] = array[i] + ((i &gt; 0) ? array[i-1] : 0);\n    }\n\n    int Q = 0;\n    fscanf(input,\"%d\",&amp;Q);\n\n    struct node query[Q];\n\n    for (int i=0; i &lt; Q; i++) {\n        fscanf(input,\"%d\",&amp;query[i].first); \n        fscanf(input,\"%d\",&amp;query[i].last); \n    }\n\n    fclose(input);\n\n    int sum = 0;\n    for (int i = 0; i &lt; Q ; i++) {\n        int first = query[i].first;\n        int last = query[i].last;\n\n        sum = integralArray[last] - integralArray[first - 1];\n\n        printf(\"Number of queries : %d , sum is %d\\n\",i ,sum);\n    }\n\n    free(array); \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2013"], "answers": [{"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": true, "score": 1, "last_activity_date": 1423668560, "creation_date": 1423668560, "answer_id": 28458117, "question_id": 28458094, "link": "https://stackoverflow.com/questions/28458094/checking-if-variable-is-a-certain-value/28458117#28458117", "title": "Checking if variable is a certain value", "body": "<pre><code>if (meningen == \"Simon Anderson\")\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (strcmp(meningen,\"Simon Anderson\") ==0)\n</code></pre>\n\n<p>I suggest you to use</p>\n\n<pre><code>fgets(meningen,sizeof(meningen),stdin);\n</code></pre>\n\n<p>instead of scanf() as <code>fgets()</code> takes care of buffer overflow and also make a note that <code>fgets()</code> comes with a newline character. You need to remove the newline character as shown below.</p>\n\n<pre><code>size_t n = strlen(meningen);\nif(n&gt;0 &amp;&amp; a[n-1] == '\\n')\na[n-1] = '\\0';\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "is_accepted": false, "score": 0, "last_activity_date": 1423668936, "last_edit_date": 1423668936, "creation_date": 1423668585, "answer_id": 28458125, "question_id": 28458094, "link": "https://stackoverflow.com/questions/28458094/checking-if-variable-is-a-certain-value/28458125#28458125", "title": "Checking if variable is a certain value", "body": "<p>This isn't working because you are comparing a string with <code>==</code>:</p>\n\n<pre><code>scanf(\" %[^\\n]s\", meningen);\nif (meningen == \"Simon Anderson\")\n</code></pre>\n\n<p>This is comparing the <em>address of</em> the <code>meningen</code> array, rather than the value(s) it contains. To check the <em>contents</em> of the array, you should use the <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/strcmp.html\" rel=\"nofollow\"><code>strcmp()</code></a> function instead:</p>\n\n<pre><code>scanf(\" %[^\\n]s\", meningen);\nif (strcmp(meningen, \"Simon Anderson\") == 0)\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4530215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b30234412f880b488398a7cafef08aa?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/4530215/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "closed_date": 1423668695, "accepted_answer_id": 28458117, "answer_count": 2, "score": 0, "last_activity_date": 1423668936, "creation_date": 1423668489, "question_id": 28458094, "link": "https://stackoverflow.com/questions/28458094/checking-if-variable-is-a-certain-value", "closed_reason": "Duplicate", "title": "Checking if variable is a certain value", "body": "<p>I want to check if the user input is equal to a certain value</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;windows.h&gt;\n\nint main()\n{\n    SetConsoleOutputCP(1252);\n    SetConsoleCP(1252);\n\n    char meningen[100];\n\n\n\n    printf(\"Hello \\n\");\n    printf(\"I want you to write 'Simon Anderson'.\\n\");\n\n    scanf(\" %[^\\n]s\", meningen);\n        if (meningen == \"Simon Anderson\")\n        {\n            printf(\"Congratilation. You have won the game.\\n\");\n            printf(\"Have a good day\");\n\n        }\n        else {\n            printf(\"You failed.\\n\");\n\n        }\n    getchar();\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>The problem is whatever I write I still get the \"You failed\" printed out. How can I make it so it returns true if the user wrote as the value in the if-statement? </p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "sum", "digits"], "comments": [{"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 0, "creation_date": 1423667773, "post_id": 28457757, "comment_id": 45242050, "body": "Shouldn&#39;t <code>while(q%10!=0);</code> be something like <code>while(q&gt;0);</code>? Otherwise it&#39;ll stop at a <code>0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 4264158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dd740e6a9590210f8ce122bd117750d5?s=128&d=identicon&r=PG", "display_name": "SUMIT KUMAR SINGH", "link": "https://stackoverflow.com/users/4264158/sumit-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1423668737, "post_id": 28457841, "comment_id": 45242734, "body": "why is pow if not written makes code more c like? @dasblinkenlight"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 174, "user_id": 4264158, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dd740e6a9590210f8ce122bd117750d5?s=128&d=identicon&r=PG", "display_name": "SUMIT KUMAR SINGH", "link": "https://stackoverflow.com/users/4264158/sumit-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1423668819, "post_id": 28457841, "comment_id": 45242804, "body": "@SUMITKUMARSINGHDIXIT It&#39;s <code>+=</code> that makes it more C-like, not the absence of <code>pow</code>. Dropping <code>pow</code> makes it more concise."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1423669449, "post_id": 28457841, "comment_id": 45243202, "body": "Would there be slower performance when using <code>pow(r,2)</code> rather than <code>r*r</code>?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1423669863, "post_id": 28457841, "comment_id": 45243489, "body": "@CoolGuy I doubt it: chances are that any decent optimizer would produce identical code for the three expressions (i.e. the one in OP, my expression, and <code>t += pow(r,2);</code> expression). It is mostly a readability thing these days."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1423667787, "creation_date": 1423667787, "answer_id": 28457841, "question_id": 28457757, "link": "https://stackoverflow.com/questions/28457757/c-program-to-print-sum-of-squares-of-digits-of-a-given-number/28457841#28457841", "title": "C program to print sum of squares of digits of a given number?", "body": "<p>Your stopping condition is wrong: <code>q%10!=0</code> will become \"true\" as soon as you reach the first zero in a decimal representation. For example, for a number <code>6540321</code> your program would add 3<sup>2</sup>+2<sup>2</sup>+1<sup>2</sup>, and stop, because the next digit happens to be zero. Squares of 6, 5, and 4 would never be added.</p>\n\n<p>Use <code>q != 0</code> condition instead to fix this problem. In addition, consider replacing</p>\n\n<pre><code>t=t+pow(r,2);\n</code></pre>\n\n<p>with a more concise and C-like</p>\n\n<pre><code>t += r*r;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 2, "last_activity_date": 1423667808, "creation_date": 1423667808, "answer_id": 28457849, "question_id": 28457757, "link": "https://stackoverflow.com/questions/28457757/c-program-to-print-sum-of-squares-of-digits-of-a-given-number/28457849#28457849", "title": "C program to print sum of squares of digits of a given number?", "body": "<p>Change</p>\n\n<pre><code>while(q%10!=0);\n</code></pre>\n\n<p>To</p>\n\n<pre><code>while(q);\n</code></pre>\n\n<p>Which is the short for</p>\n\n<pre><code>while(q!=0);\n</code></pre>\n\n<p>This is done to prevent to loop from ending once the value of <code>q</code> is a multiple of 10.</p>\n"}], "owner": {"reputation": 139, "user_id": 4450717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000722587165/picture?type=large", "display_name": "ThisSiteSucks", "link": "https://stackoverflow.com/users/4450717/thissitesucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27892, "favorite_count": 1, "accepted_answer_id": 28457841, "answer_count": 2, "score": 2, "last_activity_date": 1423667808, "creation_date": 1423667582, "question_id": 28457757, "link": "https://stackoverflow.com/questions/28457757/c-program-to-print-sum-of-squares-of-digits-of-a-given-number", "title": "C program to print sum of squares of digits of a given number?", "body": "<p>I want to write a c program that prints the sum of the squares of a given number.\nFor example, if the given number is 456, the output would be 4^2+5^2+6^2=16+25+36=77.</p>\n\n<p>So i have written this code and i want to know why it doesn't work if the user gives a number like 100,101,102 or 200,300 etc. It works fine for other numbers. I guess it has something to do with the dowhile loop. Please help me.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;math.h&gt;\nmain()\n{\n int n,t=0,r,q;\n printf(\"Enter the number to be tested: \");\n scanf(\"%d\",&amp;n);\n q=n;\n do\n {\n      r=q%10;\n      t=t+pow(r,2);\n      q=q/10;\n }\n while(q%10!=0);\n printf(\"%d\",t);\n getch();\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "hashtable"], "answers": [{"comments": [{"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1423669130, "post_id": 28458204, "comment_id": 45242997, "body": "Good link, I thought this was just some oddball 3rd party library. Note the safety warnings: <code>MT-Unsafe race:hsearch | AS-Unsafe heap | AC-Unsafe corrupt mem</code>, which just confirms my instinct to avoid it at all costs."}, {"owner": {"reputation": 6552, "user_id": 1006955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/lW3E1.jpg?s=128&g=1", "display_name": "Nobilis", "link": "https://stackoverflow.com/users/1006955/nobilis"}, "edited": false, "score": 0, "creation_date": 1423669174, "post_id": 28458204, "comment_id": 45243029, "body": "Thanks, looks like there&#39;s no getting around storing all malloc&#39;d elements in a separate structure."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 3, "last_activity_date": 1423668796, "creation_date": 1423668796, "answer_id": 28458204, "question_id": 28457712, "link": "https://stackoverflow.com/questions/28457712/get-all-keys-from-search-h-hash-search-table/28458204#28458204", "title": "Get all keys from (search.h) hash search table", "body": "<p>There is no standard functionality of iterating through the entries of the hash table. This question is addressed <a href=\"http://www.gnu.org/software/libc/manual/html_node/Hash-Search-Function.html\" rel=\"nofollow\">here</a> (in the <code>hdestroy</code> section):</p>\n\n<blockquote>\n  <p>It is important to remember that the elements contained in the hashing\n  table at the time hdestroy is called are not freed by this function.\n  It is the responsibility of the program code to free those strings (if\n  necessary at all). Freeing all the element memory is not possible\n  without extra, separately kept information since there is no function\n  to iterate through all available elements in the hashing table. If it\n  is really necessary to free a table and all elements the programmer\n  has to keep a list of all table elements and before calling hdestroy\n  s/he has to free all element\u2019s data using this list. This is a very\n  unpleasant mechanism and it also shows that this kind of hashing\n  tables is mainly meant for tables which are created once and used\n  until the end of the program run.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "is_accepted": false, "score": 1, "last_activity_date": 1423668950, "creation_date": 1423668950, "answer_id": 28458274, "question_id": 28457712, "link": "https://stackoverflow.com/questions/28457712/get-all-keys-from-search-h-hash-search-table/28458274#28458274", "title": "Get all keys from (search.h) hash search table", "body": "<p>Without looking at the actual source of the library, I would say there is no way walk the hash table after it has been created. You would be required to remember the pointers for your malloc'd memory in a separate structure.</p>\n\n<p>Frankly, I don't think I'd touch that library with a ten foot pole. The API has numerous problems</p>\n\n<ul>\n<li>Atrocious documentation</li>\n<li>The library can only support a single hash table (note that <code>hcreate</code> does not return a handle which is then passed to <code>hsearch</code> or <code>hdestroy</code>)</li>\n<li>The inability to walk the table, or retrieve the keys severely limits its uses.</li>\n</ul>\n\n<p>Instead, depending on your platform (you don't say whether you are on Windows or a Unix-based OS), I'd take a good long look at <code>glib</code> which supports a rich set of data-structures (<a href=\"https://developer.gnome.org/glib/\" rel=\"nofollow\">documentation home</a>)</p>\n\n<p>The docs for hash tables are <a href=\"https://developer.gnome.org/glib/2.42/glib-Hash-Tables.html\" rel=\"nofollow\">here</a>. That's for v2.42 of the library - they don't have a generic link for the \"latest version\".</p>\n\n<p><code>glib</code> is the core of GNOME (the Ubuntu UI) but you don't need to use any of the <code>gmainloop</code> or event pump related features.</p>\n"}], "owner": {"reputation": 6552, "user_id": 1006955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/lW3E1.jpg?s=128&g=1", "display_name": "Nobilis", "link": "https://stackoverflow.com/users/1006955/nobilis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "accepted_answer_id": 28458204, "answer_count": 2, "score": 1, "last_activity_date": 1423669116, "creation_date": 1423667458, "last_edit_date": 1423669116, "question_id": 28457712, "link": "https://stackoverflow.com/questions/28457712/get-all-keys-from-search-h-hash-search-table", "title": "Get all keys from (search.h) hash search table", "body": "<p>I'm using the <code>search.h</code> library to define a hash table through the <code>hcreate</code> function.</p>\n\n<p>How can I go through all the keys in that table? <code>hsearch</code> always expects an entry to search for (or store).</p>\n\n<p><a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/hcreate.html\" rel=\"nofollow\">This</a> is the documentation to all the three functions that manage the hash table ( <code>hcreate</code>, <code>hsearch</code> and <code>hdestroy</code>) but there's not mention of how to iterate through the structure to obtain all the stored keys.</p>\n\n<p>When storing an entry in the table, I <code>malloc</code> the key value and so would like to have an easy way to free those <code>malloc</code>'d values.</p>\n\n<p>Can I avoid having to store those in a separate structure such as an array?</p>\n\n<p>I wouldn't expect <code>hdestroy</code> to be doing this automatically for me, as it has no way of knowing if <code>key</code> points to dynamically allocated or static memory (or indeed if I haven't already freed that memory).</p>\n\n<p>Switching to a different hash search table library is not an option. I have to work with this. I'm on CentOS and use GCC 4.1.2.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3614959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7021dd9387b4fe7a4ff266e8a84c536c?s=128&d=identicon&r=PG&f=1", "display_name": "Desmond Nutes", "link": "https://stackoverflow.com/users/3614959/desmond-nutes"}, "edited": false, "score": 0, "creation_date": 1423668013, "post_id": 28457630, "comment_id": 45242214, "body": "I see what you&#39;re saying. Thank you."}], "tags": [], "owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "is_accepted": true, "score": 4, "last_activity_date": 1423667200, "creation_date": 1423667200, "answer_id": 28457630, "question_id": 28457573, "link": "https://stackoverflow.com/questions/28457573/i-dont-understand-the-difference-in-this-code-sample-for-kr-exercise-1-12/28457630#28457630", "title": "I don&#39;t understand the difference in this code sample for K&amp;R exercise 1-12", "body": "<p>If the end state is <code>OUT</code>, as it usually is, then there is no difference. If the end state is <code>IN</code> (i.e., input does not have trailing whitespace, such as newline) this terminates the last line of output with a newline. </p>\n"}], "owner": {"reputation": 93, "user_id": 3614959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7021dd9387b4fe7a4ff266e8a84c536c?s=128&d=identicon&r=PG&f=1", "display_name": "Desmond Nutes", "link": "https://stackoverflow.com/users/3614959/desmond-nutes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 28457630, "answer_count": 1, "score": 0, "last_activity_date": 1423667200, "creation_date": 1423667062, "question_id": 28457573, "link": "https://stackoverflow.com/questions/28457573/i-dont-understand-the-difference-in-this-code-sample-for-kr-exercise-1-12", "title": "I don&#39;t understand the difference in this code sample for K&amp;R exercise 1-12", "body": "<p>Im trying to figure out K&amp;R exercise 1-12 and stumbled across this answer: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define IN  1\n#define OUT 0\n\nmain()\n{\n\nint c, state;\n\nstate = OUT;\n\nwhile ((c = getchar()) != EOF) {\n    if (c != ' ' &amp;&amp; c != '\\n' &amp;&amp; c != '\\t') {\n        state = IN;\n        putchar(c);\n    }\n    else\n        if (state == IN) {\n            state = OUT;\n            putchar('\\n');\n        }\n}\n\nif (state == IN)\n    putchar('\\n');\n}\n</code></pre>\n\n<p>Whats the purpose of </p>\n\n<pre><code> if (state == IN)\n    putchar('\\n');\n</code></pre>\n\n<p>if i take this out of the code it still runs the exact same. Could some please explain to me the purpose of putting that extra if statement into the code.</p>\n\n<p>Also is there any simpler way to write this code without using things ahead of the books chapter? </p>\n"}, {"tags": ["c", "linux", "virtualbox", "wait", "zombie-process"], "comments": [{"owner": {"reputation": 95, "user_id": 4555253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5c5c449579e2c490c469ad4bbe5469b?s=128&d=identicon&r=PG&f=1", "display_name": "mudwomp", "link": "https://stackoverflow.com/users/4555253/mudwomp"}, "edited": false, "score": 0, "creation_date": 1423667195, "post_id": 28457525, "comment_id": 45241640, "body": "If I were to assume - I would put wait(3) after the child=fork() in the else statement. Although I&#39;m not fluent with zombie processes or linux, so I&#39;m not too sure how view the zombie processes"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4555253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5c5c449579e2c490c469ad4bbe5469b?s=128&d=identicon&r=PG&f=1", "display_name": "mudwomp", "link": "https://stackoverflow.com/users/4555253/mudwomp"}, "edited": false, "score": 0, "creation_date": 1423669034, "post_id": 28457846, "comment_id": 45242941, "body": "Thank you for getting back to me. While testing this without a <code>wait()</code>, when spamming compile, I see that sometimes I get a 1 for PPID instead of the PID of the parent. With the <code>wait(5)</code> inside the parent function, I do not see any. Does that mean having the <code>wait(5)</code> inside the function is getting rid of zombie processes?"}, {"owner": {"reputation": 95, "user_id": 4555253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5c5c449579e2c490c469ad4bbe5469b?s=128&d=identicon&r=PG&f=1", "display_name": "mudwomp", "link": "https://stackoverflow.com/users/4555253/mudwomp"}, "edited": false, "score": 0, "creation_date": 1423669102, "post_id": 28457846, "comment_id": 45242984, "body": "Also, when I type <code>ps aux</code>, I end up going to line(?) <code>26433 tc</code>. It just spams <code>tc</code> all the way down so I&#39;m not  sure where to look."}, {"owner": {"reputation": 1718, "user_id": 3791842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98W7v.jpg?s=128&g=1", "display_name": "Daniel Kleinstein", "link": "https://stackoverflow.com/users/3791842/daniel-kleinstein"}, "reply_to_user": {"reputation": 95, "user_id": 4555253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5c5c449579e2c490c469ad4bbe5469b?s=128&d=identicon&r=PG&f=1", "display_name": "mudwomp", "link": "https://stackoverflow.com/users/4555253/mudwomp"}, "edited": false, "score": 1, "creation_date": 1423669241, "post_id": 28457846, "comment_id": 45243082, "body": "Assuming you have zombie processes, run <code>ps aux | grep Z</code> to view just the lines containing <code>Z</code> (if your program has finished its execution then this won&#39;t show you anything relevant, as all the zombie children have been removed from the system). As for your first issue, what&#39;s happening is that your child process is running <i>after</i> the parent process has exited, so its parent is now the <code>init</code> process which has <code>pid == 1</code>. By  calling <code>wait</code> you&#39;re preventing the parent process from exiting until at least one of its children has finished its execution."}], "tags": [], "owner": {"reputation": 1718, "user_id": 3791842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98W7v.jpg?s=128&g=1", "display_name": "Daniel Kleinstein", "link": "https://stackoverflow.com/users/3791842/daniel-kleinstein"}, "is_accepted": false, "score": 1, "last_activity_date": 1423667799, "creation_date": 1423667799, "answer_id": 28457846, "question_id": 28457525, "link": "https://stackoverflow.com/questions/28457525/how-do-you-kill-zombie-process-using-wait/28457846#28457846", "title": "How do you kill zombie process using wait()", "body": "<blockquote>\n  <p>How do you know (and) where to put the \"wait()\" statement to kill\n  zombie processes?</p>\n</blockquote>\n\n<p>You can use <code>wait()</code> anywhere in the parent process, and when the child process terminates it'll be removed from the system. Where to put it is up to you, in your specific case you probably want to put it immediately after the <code>child = fork();</code> line so that the parent process won't resume its execution until its child has exited.</p>\n\n<blockquote>\n  <p>What is the command to view zombie processes if you have Linux virtual box?</p>\n</blockquote>\n\n<p>You can use the <code>ps aux</code> command to view all processes in the system (including zombie processes), and the <code>STAT</code> column will be equal to <code>Z</code> if the process is a zombie. An example output would be:</p>\n\n<pre><code>USER      PID    %CPU %MEM VSZ  RSS TTY      STAT START   TIME COMMAND\ndaniel    1000   0.0  0.0  0    0   ??       Z    17:15   0:00 command\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 11, "last_activity_date": 1423672928, "last_edit_date": 1423672928, "creation_date": 1423672560, "answer_id": 28459548, "question_id": 28457525, "link": "https://stackoverflow.com/questions/28457525/how-do-you-kill-zombie-process-using-wait/28459548#28459548", "title": "How do you kill zombie process using wait()", "body": "<blockquote>\n  <p>How do you know (and) where to put the \"wait()\" statement to kill\n  zombie processes?</p>\n</blockquote>\n\n<p>If your parent spawns only a small, fixed number of children; does not care when or whether they stop, resume, or finish; <strong>and</strong> itself exits quickly, then you do not need to use <code>wait()</code> or <code>waitpid()</code> to clean up the child processes.  The init process (pid 1) takes responsibility for orphaned child processes, and will clean them up when they finish.</p>\n\n<p>Under any other circumstances, however, you must <code>wait()</code> for child processes.  Doing so frees up resources, ensures that the child has finished, and allows you to obtain the child's exit status.  Via <code>waitpid()</code> you can also be notified when a child is stopped or resumed by a signal, if you so wish.</p>\n\n<p>As for <em>where</em> to perform the wait,</p>\n\n<ul>\n<li>You must ensure that <em>only the parent</em> <code>wait()</code>s.</li>\n<li>You should wait at or before the earliest point where you need the child to have finished (but not before forking), OR</li>\n<li>if you don't care when or whether the child finishes, but you need to clean up resources, then you can periodically call <code>waitpid(-1, NULL, WNOHANG)</code> to collect a zombie child if there is one, without blocking if there isn't any.</li>\n</ul>\n\n<p>In particular, you must <strong>not</strong> <code>wait()</code> (unconditionally) immediately after <code>fork()</code>ing because parent and child run the same code.  You must use the return value of <code>fork()</code> to determine whether you are in the child (return value == 0), or in the parent (any other return value).  Furthermore, the parent must <code>wait()</code> only if forking was successful, in which case <code>fork()</code> returns the child's pid, which is always greater than zero.  A return value less than zero indicates failure to fork.</p>\n\n<p>Your program doesn't really need to <code>wait()</code> because it spawns exactly four (not three) children, then exits.  However, if you wanted the parent to have at most one live child at any time, then you could write it like this:</p>\n\n<pre><code>int main() {\n    pid_t child;\n    int i;\n\n    printf(\"-----------------------------------\\n\");\n    about(\"Parent\");\n\n    for (i = 0; i &lt; 3; i++) {\n        printf(\"Now ..  Forking !!\\n\");\n        child = fork();\n\n        if (child &lt; 0) {\n            perror (\"Unable to fork\");\n            break;\n        } else if (child == 0) {\n            printf (\"In child #%d\\n\", (i+1));\n            about (\"Child\");\n            break;\n        } else {\n            /* in parent */\n            if (waitpid(child, NULL, 0) &lt; 0) {\n                perror(\"Failed to collect child process\");\n                break;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>If the parent exits before one or more of its children, which can happen if it does not wait, then the child will thereafter see its parent process being pid 1.</p>\n\n<p>Others have already answered how to get a zombie process list via th <code>ps</code> command.  You may also be able to see zombies via <code>top</code>.  With your original code you are unlikely to catch a glimpse of zombies, however, because the parent process exits very quickly, and <code>init</code> will then clean up the zombies it leaves behind.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 8207325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe434c506a4c2195e1682eb2dde8ac76?s=128&d=identicon&r=PG&f=1", "display_name": "rtc", "link": "https://stackoverflow.com/users/8207325/rtc"}, "is_accepted": false, "score": 0, "last_activity_date": 1499546794, "creation_date": 1499546794, "answer_id": 44990612, "question_id": 28457525, "link": "https://stackoverflow.com/questions/28457525/how-do-you-kill-zombie-process-using-wait/44990612#44990612", "title": "How do you kill zombie process using wait()", "body": "<blockquote>\n  <p>How do you know (and) where to put the \"wait()\" statement to kill\n  zombie processes?</p>\n</blockquote>\n\n<p>You can register a signal handler for SIGCHLD that sets a global <code>volatile sig_atomic_t flag = 0</code> variable to 1. Then, at some convenient place in your program, test whether <code>flag</code> is set to 1, and, if so, set it back to 0 and afterwards (for otherwise you might miss a signal) call <code>waitpid(-1, NULL, WNOHANG)</code> in a loop until it tells you that no more processes are to be waited for. Note that the signal will interrupt system calls with EINTR, which is a good condition to check for the value of <code>flag</code>. If you use an indefinitely blocking system call like <code>select()</code>, you might want to specify a timeout after which you check for <code>flag</code>, since otherwise you might miss a signal that was raised after your last <code>waitpid()</code> call but before entering the indefinitely blocking system call. An alternative to this kludge is to use <code>pselect()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8045505, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N_s9oIVWoMA/AAAAAAAAAAI/AAAAAAAAAFs/7iuRZYfPfOQ/photo.jpg?sz=128", "display_name": "Yoel Monsalve", "link": "https://stackoverflow.com/users/8045505/yoel-monsalve"}, "is_accepted": false, "score": 0, "last_activity_date": 1603031204, "creation_date": 1603031204, "answer_id": 64414436, "question_id": 28457525, "link": "https://stackoverflow.com/questions/28457525/how-do-you-kill-zombie-process-using-wait/64414436#64414436", "title": "How do you kill zombie process using wait()", "body": "<p>Use:</p>\n<pre><code>ps -e -opid,ppid,pgid,stat,etime,cmd | grep defunct\n</code></pre>\n<p>to see your zombies, also the <code>ppid</code> and <code>pgid</code> to see the parent ID and process group ID. The <code>etime</code> to see the elapsed (cpu) time your zombie has been alive. The parent ID is useful to send custom signals to the parent process.</p>\n<p>If the parent process is right coded to catch and handle the <code>SIGCHLD</code> signal, and to what expected (i.e., wait/reap the zombies), then you can submit:</p>\n<pre><code>kill -CHLD &lt;parent_pid&gt;\n</code></pre>\n<p>to tell the parent to reap all their zombies.</p>\n"}], "owner": {"reputation": 95, "user_id": 4555253, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5c5c449579e2c490c469ad4bbe5469b?s=128&d=identicon&r=PG&f=1", "display_name": "mudwomp", "link": "https://stackoverflow.com/users/4555253/mudwomp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19217, "favorite_count": 3, "accepted_answer_id": 28459548, "answer_count": 4, "score": 5, "last_activity_date": 1603031204, "creation_date": 1423666940, "question_id": 28457525, "link": "https://stackoverflow.com/questions/28457525/how-do-you-kill-zombie-process-using-wait", "title": "How do you kill zombie process using wait()", "body": "<p>I have this code that requires a parent to fork 3 children. </p>\n\n<ul>\n<li><p>How do you know (and) where to put the <strong>\"wait()\"</strong> statement to kill<br>\nzombie processes?</p></li>\n<li><p>What is the command to view zombie processes if you have Linux\nvirtual box?</p>\n\n<pre><code>main(){\n\n pid_t child;\n printf(\"-----------------------------------\\n\");\n about(\"Parent\");\n printf(\"Now ..  Forking !!\\n\");\n child = fork();\n int i=0;\n\n for (i=0; i&lt;3; i++){\n    if (child &lt; 0) {\n        perror (\"Unable to fork\");\n        break;\n    } \n    else if (child == 0){\n        printf (\"creating child #%d\\n\", (i+1));\n        about (\"Child\");\n        break;\n    }\n\n    else{\n        child = fork();\n    }\n  } \n}       \n\nvoid about(char * msg){\n\n pid_t me;\n pid_t oldone;\n\n me = getpid();\n oldone = getppid();\n\n printf(\"***[%s] PID = %d   PPID = %d.\\n\", msg, me, oldone);\n\n}\n</code></pre></li>\n</ul>\n"}, {"tags": ["c", "opencv", "ubuntu"], "comments": [{"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1423667203, "post_id": 28457331, "comment_id": 45241645, "body": "using c is an unlucky choice with opencv. if you can&#39;t use c++, you will have to look out for another library (e.g. ccv)"}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1423667262, "post_id": 28457331, "comment_id": 45241699, "body": "latest opencv does not support face-detection from the c-api any more (using the stock cascade-files)."}, {"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1423671192, "post_id": 28457331, "comment_id": 45244362, "body": "also, please clarify, if you meant <i>face-detection</i> (face or football?) or <i>face-recognition</i> (who is it?)"}], "answers": [{"tags": [], "owner": {"reputation": 7797, "user_id": 942746, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34cf9eae5d595c0b480a7cb42f3722b1?s=128&d=identicon&r=PG", "display_name": "Brian McFarland", "link": "https://stackoverflow.com/users/942746/brian-mcfarland"}, "is_accepted": false, "score": 1, "last_activity_date": 1423668798, "last_edit_date": 1423668798, "creation_date": 1423668482, "answer_id": 28458090, "question_id": 28457331, "link": "https://stackoverflow.com/questions/28457331/can-we-lock-file-or-folder-in-ubuntu-by-using-open-cv-and-c/28458090#28458090", "title": "Can we lock file or folder in ubuntu by using open CV and C", "body": "<p>Can't help you with the opencv part, but \"lock file and folders\" could mean a few things:</p>\n\n<ul>\n<li><p>You want to change permissions of files so that a given user/group can/cannot\naccess them.  If this is the case, you want the <code>chmod</code> function. \nSee <code>man 2 chmod</code>.  Seems like this is probably what you're after?</p></li>\n<li><p>Usually, \"file locking\" on Linux refers to a means to prevent other processes from accessing a file without changing permissions via either:</p>\n\n<ul>\n<li>Mandatory file locking via <code>lockf</code> (or <code>fcntl</code>).</li>\n<li>Advisory file locking via <code>flock</code>.</li>\n</ul></li>\n</ul>\n\n<p>If file locking is what you're after, here are the \"see also\" documents referred to by the man pages on <code>lockf</code> and/or <code>flock</code>:</p>\n\n<p><a href=\"https://www.kernel.org/doc/Documentation/filesystems/mandatory-locking.txt\" rel=\"nofollow\">https://www.kernel.org/doc/Documentation/filesystems/mandatory-locking.txt</a>\n<a href=\"https://www.kernel.org/doc/Documentation/filesystems/locks.txt\" rel=\"nofollow\">https://www.kernel.org/doc/Documentation/filesystems/locks.txt</a></p>\n\n<p>Note: Others have indicated you might want to use the <code>C++</code> API for <code>opencv</code>.  All of these functions should work just fine from C++ too.  </p>\n"}], "owner": {"reputation": 9, "user_id": 3733811, "user_type": "registered", "profile_image": "https://graph.facebook.com/1577799724/picture?type=large", "display_name": "user3733811", "link": "https://stackoverflow.com/users/3733811/user3733811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423668798, "creation_date": 1423666404, "question_id": 28457331, "link": "https://stackoverflow.com/questions/28457331/can-we-lock-file-or-folder-in-ubuntu-by-using-open-cv-and-c", "title": "Can we lock file or folder in ubuntu by using open CV and C", "body": "<p>I want to create a project to lock file and folders in ubuntu by face detection through opencv using C language. Can you please let me know it is possible and how can i do it. </p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1439, "user_id": 3717347, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/rUWzF.jpg?s=128&g=1", "display_name": "lychee", "link": "https://stackoverflow.com/users/3717347/lychee"}, "edited": false, "score": 1, "creation_date": 1423666033, "post_id": 28457086, "comment_id": 45240837, "body": "always use parens in defining macro&#39;s that take arguments ((a&gt;b) ? a : b)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1423666037, "post_id": 28457086, "comment_id": 45240839, "body": "Because it&#39;s a macro."}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "reply_to_user": {"reputation": 1439, "user_id": 3717347, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/rUWzF.jpg?s=128&g=1", "display_name": "lychee", "link": "https://stackoverflow.com/users/3717347/lychee"}, "edited": false, "score": 3, "creation_date": 1423666189, "post_id": 28457086, "comment_id": 45240941, "body": "@BsD, And this is the exact reason macros should be avoided if possible. Your correction is still missing parentheses: <code>((a) &gt; (b) ? (a) : (b))</code>"}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 2, "creation_date": 1423666206, "post_id": 28457086, "comment_id": 45240951, "body": "If you&#39;re going to tag a question as C, make the code valid C."}, {"owner": {"reputation": 5296, "user_id": 418066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/38yuw.png?s=128&g=1", "display_name": "Biffen", "link": "https://stackoverflow.com/users/418066/biffen"}, "edited": false, "score": 1, "creation_date": 1423666389, "post_id": 28457086, "comment_id": 45241101, "body": "If it&#39;s indeed C++, despite the C tag, use <code>std::max</code>."}], "answers": [{"comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1423666420, "post_id": 28457179, "comment_id": 45241121, "body": "Your macro can easily be broken by valid arguments. Switch the commented line to compare: <a href=\"http://coliru.stacked-crooked.com/a/69619687946a13f3\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/69619687946a13f3</a>"}, {"owner": {"reputation": 1045, "user_id": 2305161, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a4956f14412244c2942ff6746b81fc04?s=128&d=identicon&r=PG", "display_name": "Andy Newman", "link": "https://stackoverflow.com/users/2305161/andy-newman"}, "reply_to_user": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1423668624, "post_id": 28457179, "comment_id": 45242653, "body": "Yes, or just by using the ++ operator in one of the arguments, which is the classic way to break macros.  I did say there are situations where it will fail.  Edited and added &quot;many&quot; :p"}, {"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 0, "creation_date": 1423668808, "post_id": 28457179, "comment_id": 45242795, "body": "Yes, but ++ happening twice on arguments used twice can&#39;t easily be avoided, whereas this one can, via extra parentheses."}], "tags": [], "owner": {"reputation": 1045, "user_id": 2305161, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a4956f14412244c2942ff6746b81fc04?s=128&d=identicon&r=PG", "display_name": "Andy Newman", "link": "https://stackoverflow.com/users/2305161/andy-newman"}, "is_accepted": false, "score": 5, "last_activity_date": 1423736471, "last_edit_date": 1423736471, "creation_date": 1423666006, "answer_id": 28457179, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly/28457179#28457179", "title": "max defined in #define not working properly", "body": "<p>hash-define macros are a string expansion, not a \"language\" thing.</p>\n\n<pre><code>sum=sum+max(i,3);\n</code></pre>\n\n<p>expands to:</p>\n\n<pre><code>sum=sum+i&gt;3?i:3;\n</code></pre>\n\n<p>And if you are writing that with no () round it you deserve to get the wrong answer.  Try this:</p>\n\n<pre><code>#define max(a,b) (a&gt;b?a:b)\n</code></pre>\n\n<p>but there are still <strong>many</strong> situations where it will fail.  As others point out an even better macro is:</p>\n\n<pre><code>#define max(a,b) ((a)&gt;(b)?(a):(b))\n</code></pre>\n\n<p>but it will <strong>still</strong> fail in too many situations, such as arguments with side effects getting evaluated twice.  You are much much better off avoiding macros where possible and doing something like this:</p>\n\n<pre><code>template &lt;typename T&gt; T max(T a, T b) { return a&gt;b?a:b; }\n</code></pre>\n\n<p>or, infact, using std::max and std::min which have already been written for you!</p>\n"}, {"comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1423666492, "post_id": 28457207, "comment_id": 45241159, "body": "Your macro can easily be broken by valid arguments. Switch the commented line to compare: <a href=\"http://coliru.stacked-crooked.com/a/69619687946a13f3\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/69619687946a13f3</a>"}], "tags": [], "owner": {"reputation": 86959, "user_id": 1735406, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IF9uS.png?s=128&g=1", "display_name": "Maroun", "link": "https://stackoverflow.com/users/1735406/maroun"}, "is_accepted": false, "score": 1, "last_activity_date": 1423666061, "creation_date": 1423666061, "answer_id": 28457207, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly/28457207#28457207", "title": "max defined in #define not working properly", "body": "<p>The output of the prepocessor (view it with the <code>-E</code> flag) will be:</p>\n\n<pre><code>sum = sum+i&gt;3?i:3;\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>sum = (sum+i)&gt;3?i:3;\n</code></pre>\n\n<p>which is not what you meant because <code>+</code> has a <em>higher</em> precedence than <code>&gt;</code>. You should use:</p>\n\n<pre><code>#define max(a,b) (a&gt;b?a:b)\n</code></pre>\n\n<p>instead.</p>\n"}, {"tags": [], "owner": {"reputation": 1418, "user_id": 3858001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b1b90cc654d2da013e6d3208afa8a5?s=128&d=identicon&r=PG&f=1", "display_name": "thedoctor", "link": "https://stackoverflow.com/users/3858001/thedoctor"}, "is_accepted": false, "score": 2, "last_activity_date": 1423666061, "creation_date": 1423666061, "answer_id": 28457208, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly/28457208#28457208", "title": "max defined in #define not working properly", "body": "<p>I think you are having operator precedence issues, you have to remember that define will lead to a textual replacement in your source code. You should change your define to</p>\n\n<pre><code>#define max(a,b) ((a) &gt; (b) ? (a) : (b))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1423666166, "creation_date": 1423666166, "answer_id": 28457245, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly/28457245#28457245", "title": "max defined in #define not working properly", "body": "<p>Replacing your macro in the line <code>sum=sum+max(i,3);</code> gives the following form :</p>\n\n<pre><code>sum=sum+i&gt;3?i:3 ;\n</code></pre>\n\n<p>which is asking that if <code>sum + i</code> is greater than <code>3</code> than assign sum's value accordingly. Hence, you have 4 because each time a new assignment happens inside the loop. Use the template method suggested by Andrew. </p>\n\n<p>(The loop evaluates the condition <code>(sum + i) &gt; 3 ? i : 3</code> every time. There is no cumulative addition here.)</p>\n"}, {"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 3, "last_activity_date": 1423666198, "creation_date": 1423666198, "answer_id": 28457265, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly/28457265#28457265", "title": "max defined in #define not working properly", "body": "<p>This line:</p>\n\n<pre><code>sum=sum+max(i,3);\n</code></pre>\n\n<p>expands to: </p>\n\n<pre><code>sum = sum + i &gt; 3 ? i : 3;\n</code></pre>\n\n<p>Which, when set up with parens to make it clearer is:</p>\n\n<pre><code>sum = (sum + i) &gt; 3 ? i : 3;\n</code></pre>\n\n<p>So on the 5-passes through the loop, the expressions are:</p>\n\n<pre><code>sum = (0 + 0) &gt; 3 ? 0 : 3;  // Result, sum = 3\nsum = (3 + 1) &gt; 3 ? 1 : 3;  // Result: sum = 3\nsum = (3 + 2) &gt; 3 ? 2 : 3;  // Result: sum = 3\nsum = (3 + 3) &gt; 3 ? 3 : 3;  // Result: sum = 3\nsum = (3 + 4) &gt; 3 ? 4 : 3;  // Result: sum = 4\n</code></pre>\n\n<p>And that's where your answer comes from.</p>\n\n<p>The conventional way to solve this is to change the <code>#define</code> to:</p>\n\n<pre><code> #define max(a,b) (((a)&gt;(b))?(a):(b))\n</code></pre>\n\n<p>But even this has some pitfalls.</p>\n"}], "owner": {"reputation": 408, "user_id": 3428090, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/c93388ccd52e7569329766254d5f013c?s=128&d=identicon&r=PG&f=1", "display_name": "Richa Tibrewal", "link": "https://stackoverflow.com/users/3428090/richa-tibrewal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1423736471, "creation_date": 1423665774, "last_edit_date": 1423670014, "question_id": 28457086, "link": "https://stackoverflow.com/questions/28457086/max-defined-in-define-not-working-properly", "title": "max defined in #define not working properly", "body": "<p>I wrote the program as follows : </p>\n\n<pre><code>#include&lt;cstdio&gt;\n#define max(a,b) a&gt;b?a:b\nusing namespace std;\n\nint main()\n{\n    int sum=0,i,k;\n   for(i=0;i&lt;5;i++)\n    {\n      sum=sum+max(i,3);\n    }\n    printf(\"%d\\n\",sum);\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>I got the  output : 4</p>\n</blockquote>\n\n<p>But when I stored <code>max(i,3</code>) in a variable <code>k</code> and then added to <code>sum</code>, I got the correct output:</p>\n\n<pre><code>#include&lt;cstdio&gt;\n#define max(a,b) a&gt;b?a:b\nusing namespace std;\n\nint main()\n{\n   int sum=0,i,k;\n   for(i=0;i&lt;5;i++)\n   {\n     k=max(i,3);\n     sum=sum+k;\n   }\n   printf(\"%d\\n\",sum);\n   return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>Output : 16</p>\n</blockquote>\n\n<p>Can somebody please explain why is it happening?</p>\n"}, {"tags": ["c", "linux", "makefile", "shared-libraries"], "comments": [{"owner": {"reputation": 16853, "user_id": 4101725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dGwoPMFb_tM/AAAAAAAAAAI/AAAAAAAABks/tMMqc6E9REg/photo.jpg?sz=128", "display_name": "Michele d&#39;Amico", "link": "https://stackoverflow.com/users/4101725/michele-damico"}, "edited": false, "score": 1, "creation_date": 1423664986, "post_id": 28456712, "comment_id": 45240179, "body": "You don&#39;t link the shared library: try <code>-lfoo</code> instead of <code>libfoo.so</code>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1423665288, "post_id": 28456712, "comment_id": 45240361, "body": "cc is getting the literal single quotes around $ORIGIN.  Try omitting them."}], "answers": [{"tags": [], "owner": {"reputation": 1727, "user_id": 2014022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b5ab8fa77e562296a1b668005395762?s=128&d=identicon&r=PG", "display_name": "Peter K", "link": "https://stackoverflow.com/users/2014022/peter-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1423666123, "last_edit_date": 1423666123, "creation_date": 1423665412, "answer_id": 28456950, "question_id": 28456712, "link": "https://stackoverflow.com/questions/28456712/shared-library-from-archive-a-file-in-c/28456950#28456950", "title": "Shared library from archive (.a) file in C", "body": "<p>Your mistake is in the question: do not make shared library from archive, make it from objects, i.e. change Makefile like this</p>\n\n<pre><code>libfoo.so : foo.o bar.o\n    $(CC) -shared -o $@ foo.o bar.o\n</code></pre>\n\n<p>you can also use <code>%.o</code> to mean all objects</p>\n\n<p>also you need <code>CFLAGS = -fPIC</code> globally, to affect compilation command, not only the link step, that is you .o object files should be position-independent.</p>\n\n<p>also here <code>extern</code> is not needed, all C functions are implicitly extern</p>\n\n<pre><code>extern void foo(void);\n</code></pre>\n\n<p>I would also not recommend using <code>rpath</code> and better </p>\n\n<pre><code>export LD_LIBRARY_PATH=.\n</code></pre>\n\n<p>to load .so from current directory (or export path to .so's directory)</p>\n"}, {"comments": [{"owner": {"reputation": 632, "user_id": 4238643, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/45eebbdb12f68bec20e0e944157faad4?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijatya Singh", "link": "https://stackoverflow.com/users/4238643/abhijatya-singh"}, "edited": false, "score": 0, "creation_date": 1423677240, "post_id": 28457229, "comment_id": 45248105, "body": "Thanks @ctheo sir!!!!!! The compilation goes smoothly and the output of the compilation is:                         <code>cc -c -Wall -Werror -o main.o main.c  ; cc -c -Wall -Werror -fPIC  -o foo.o foo.c ; cc -c -Wall -Werror -fPIC  -o bar.o bar.c ; ar cvq libfoo.a foo.o bar.o ; a - foo.o ; a - bar.o ; cc -shared -o libfoo.so -Wl,--whole-archive libfoo.a  -Wl,--no-whole-archive ; cc -L&#47;home&#47;betatest&#47;Public&#47;implicit-rule-archive -Wl,-rpath,&#39;$ORIGIN&#39; -o run main.o libfoo.so ;</code> I want to ask how main.o is generated is it implicit rule or pattern defined below? Thanks!!"}, {"owner": {"reputation": 3112, "user_id": 2707697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9da9a865b63faae8438d2d57c1c71b9?s=128&d=identicon&r=PG&f=1", "display_name": "ztik", "link": "https://stackoverflow.com/users/2707697/ztik"}, "reply_to_user": {"reputation": 632, "user_id": 4238643, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/45eebbdb12f68bec20e0e944157faad4?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijatya Singh", "link": "https://stackoverflow.com/users/4238643/abhijatya-singh"}, "edited": false, "score": 0, "creation_date": 1423728353, "post_id": 28457229, "comment_id": 45268588, "body": "The main.o is build by the command <code>cc -c -Wall -Werror -o main.o main.c</code>. It uses CFLAGS without <code>-fPIC</code> addition since <code>libfoo.so</code> does not depend on it."}, {"owner": {"reputation": 632, "user_id": 4238643, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/45eebbdb12f68bec20e0e944157faad4?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijatya Singh", "link": "https://stackoverflow.com/users/4238643/abhijatya-singh"}, "edited": false, "score": 1, "creation_date": 1423731738, "post_id": 28457229, "comment_id": 45270296, "body": "It means it see a dependency main.o and call the defined pattern rule <code>%.o : %.c</code> . Thanks"}], "tags": [], "owner": {"reputation": 3112, "user_id": 2707697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9da9a865b63faae8438d2d57c1c71b9?s=128&d=identicon&r=PG&f=1", "display_name": "ztik", "link": "https://stackoverflow.com/users/2707697/ztik"}, "is_accepted": true, "score": 7, "last_activity_date": 1423666495, "last_edit_date": 1423666495, "creation_date": 1423666106, "answer_id": 28457229, "question_id": 28456712, "link": "https://stackoverflow.com/questions/28456712/shared-library-from-archive-a-file-in-c/28457229#28457229", "title": "Shared library from archive (.a) file in C", "body": "<p>If you wish to build a shared library from a static library you have to tell the linker to use all function/symbols included in static library (.a). Otherwise nothing will be included in the shared library (.so).</p>\n\n<p>You have to use <code>--whole-archive/--no-whole-archive</code> pair in linking.</p>\n\n<pre><code>CFLAGS = -Wall -Werror\nLDFLAGS = -L/home/betatest/Public/implicit-rule-archive -Wl,-rpath,'$$ORIGIN'\n\nall : run\n\nrun : main.o libfoo.so\n    $(CC) $(LDFLAGS) -o $@ $^\n\nlibfoo.so : CFLAGS += -fPIC # Build objects for .so with -fPIC.\nlibfoo.so : libfoo.a\n    $(CC) -shared -o $@ -Wl,--whole-archive $^  -Wl,--no-whole-archive\n\nlibfoo.a : foo.o bar.o\n     ar cvq libfoo.a foo.o bar.o\n\n# Compile any .o from .c. Also make dependencies automatically.\n%.o : %.c\n    $(CC) -c $(CFLAGS) -o $@ $&lt;\n\n#Include dependencies on subsequent builds.\n\n.PHONY : all clean\n\nclean :\n    -rm -f *.o *.d run libfoo.*\n</code></pre>\n\n<p>You can check the exported functions using <code>nm</code> command:</p>\n\n<pre><code>$ nm -D libfoo.so | grep  ' T '\n0000000000000702 T bar\n0000000000000714 T _fini\n00000000000006f0 T foo\n0000000000000590 T _init\n</code></pre>\n\n<p>When no <code>--whole-archive/--no-whole-archive</code> pair is used you get:</p>\n\n<pre><code>$ nm -D libfoo.so | grep  ' T '\n0000000000000714 T _fini\n0000000000000590 T _init\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 4238643, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/45eebbdb12f68bec20e0e944157faad4?s=128&d=identicon&r=PG&f=1", "display_name": "Abhijatya Singh", "link": "https://stackoverflow.com/users/4238643/abhijatya-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2475, "favorite_count": 0, "accepted_answer_id": 28457229, "answer_count": 2, "score": 3, "last_activity_date": 1423666495, "creation_date": 1423664676, "question_id": 28456712, "link": "https://stackoverflow.com/questions/28456712/shared-library-from-archive-a-file-in-c", "title": "Shared library from archive (.a) file in C", "body": "<p>I was given a task to create archive file <strong>.a</strong> from objects file and create a shared library file from archive .a file. I have tried experiment having following file:<br/>\n<strong>foo.h</strong></p>\n\n<pre><code>#ifndef _foo_h__\n#define _foo_h__\nextern void foo(void);\nextern void bar(void); \n#endif //_foo_h__\n</code></pre>\n\n<p><br/>\n<strong>foo.c</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid foo(void)\n{\n    puts(\"Hello, I'm a shared library\");\n}\n</code></pre>\n\n<p><br/>\n<strong>bar.c</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid bar(void)\n{\n    puts(\"This is bar function call.\");\n}\n</code></pre>\n\n<p><br/>\n<strong>main.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include\"foo.h\"\n\nint main(void)\n{\n    puts(\"This is a shared library test...\");\n    foo();\n    bar();\n    return 0;\n}\n</code></pre>\n\n<p><br/>\n<strong>Makefile</strong></p>\n\n<pre><code>CFLAGS = -Wall -Werror\nLDFLAGS = -L/home/betatest/Public/implicit-rule-archive -Wl,-rpath,'$$ORIGIN'\n\nall : run\n\nrun : main.o libfoo.so\n    $(CC) $(LDFLAGS) -o $@ $^\n\nlibfoo.so : CFLAGS += -fPIC # Build objects for .so with -fPIC.\nlibfoo.so : libfoo.a\n    $(CC) -shared -o $@ $^\n\nlibfoo.a : foo.o bar.o\n    ar cvq libfoo.a foo.o bar.o\n#   ar cr libfoo.a foo.o bar.o\n\n# Compile any .o from .c. Also make dependencies automatically.\n%.o : %.c\n    $(CC) -c $(CFLAGS) -o $@ $&lt;\n\n#Include dependencies on subsequent builds.\n\n.PHONY : all clean\n\nclean :\n    -rm -f *.o *.d run libfoo.*\n</code></pre>\n\n<p>This simple test program seems to run fine but while compiling using make it producing error as:</p>\n\n<pre><code>cc -c -Wall -Werror -o main.o main.c\ncc -c -Wall -Werror -fPIC  -o foo.o foo.c\ncc -c -Wall -Werror -fPIC  -o bar.o bar.c\nar cvq libfoo.a foo.o bar.o\na - foo.o\na - bar.o\ncc -shared -o libfoo.so libfoo.a\ncc -L/home/betatest/Public/implicit-rule-archive -Wl,-rpath,'$ORIGIN' -o run main.o libfoo.so\nmain.o: In function `main':\nmain.c:(.text+0xf): undefined reference to `foo'\nmain.c:(.text+0x14): undefined reference to `bar'\ncollect2: ld returned 1 exit status\nMakefile-test:7: recipe for target 'run' failed\nmake: *** [run] Error 1\n</code></pre>\n\n<p>Somebody please point out that where I am getting wrong?? Thanks a lot.</p>\n"}, {"tags": ["c", "matlab", "mex", "matlab-coder"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1423666650, "post_id": 28456706, "comment_id": 45241269, "body": "You can list multiple .c files in a single mex command..."}, {"owner": {"reputation": 2206, "user_id": 192031, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5fdee4fb9f57b3edc2037aef92c40694?s=128&d=identicon&r=PG", "display_name": "ThP", "link": "https://stackoverflow.com/users/192031/thp"}, "edited": false, "score": 2, "creation_date": 1423671653, "post_id": 28456706, "comment_id": 45244621, "body": "I see you are running in linux. Do you have a .sh file in the directory? If so try to run it (either from terminal or from matlab using <code>unix</code>). You might have to change permissions to executable."}, {"owner": {"reputation": 1082, "user_id": 1138921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28e465db4c6f6e1260d382283c0b4f26?s=128&d=identicon&r=PG", "display_name": "Garima Singh", "link": "https://stackoverflow.com/users/1138921/garima-singh"}, "reply_to_user": {"reputation": 2206, "user_id": 192031, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5fdee4fb9f57b3edc2037aef92c40694?s=128&d=identicon&r=PG", "display_name": "ThP", "link": "https://stackoverflow.com/users/192031/thp"}, "edited": false, "score": 0, "creation_date": 1423738602, "post_id": 28456706, "comment_id": 45274539, "body": "@ThP Thanks. That seems to be going in right direction. However, when I try to run <code>system(&#39;sh .&#47;ConstructSystemMatrix_2Translate_mex.sh&#39;)</code> I notice that it could not find files located in <code>&#47;usr&#47;local&#47;MATLAB&#47;R2014b&#47;extern&#47;include&#47;</code>. How could I give it some option for include file?"}, {"owner": {"reputation": 1814, "user_id": 3297440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b9a3c27ffed7a206aa03f34cde4bce?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Livingston", "link": "https://stackoverflow.com/users/3297440/ryan-livingston"}, "edited": false, "score": 0, "creation_date": 1423791553, "post_id": 28456706, "comment_id": 45303318, "body": "The <code>mki</code> file appears to be pointing at MATLAB R2012a. You may be best served by generating code for R2014b."}], "owner": {"reputation": 1082, "user_id": 1138921, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/28e465db4c6f6e1260d382283c0b4f26?s=128&d=identicon&r=PG", "display_name": "Garima Singh", "link": "https://stackoverflow.com/users/1138921/garima-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423664667, "creation_date": 1423664667, "question_id": 28456706, "link": "https://stackoverflow.com/questions/28456706/mex-file-generated-by-matlab-coder-how-to-re-compile", "title": "mex file generated by Matlab-coder: how to re-compile", "body": "<p>I recently got some of my Matlab code converted to C and it works. However, I would like to make some changes to these mex file and recompile.</p>\n\n<p>So far, I have only worked with simple mex project: usually consisting of two files like this:</p>\n\n<pre><code>  Matlab_mex_Testing.m &lt;--- I call mex function from here.\n  mexcallingmatlab.c \n</code></pre>\n\n<p>then I can compile using:</p>\n\n<pre><code>  mex -g -ldl CFLAGS=\"\\$CFLAGS -std=c99\" -largeArrayDims mexcallingmatlab.c\n</code></pre>\n\n<p>However, the converted project has multiple *.c, *.o files and when I tried to compile only the ...._mex.c, I get following error:</p>\n\n<pre><code>  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: excess elements in struct initializer [enabled by default]\n   emlrtContext emlrtContextGlobal = { true, false, EMLRT_VERSION_INFO, NULL, \"ConstructSystemMatrix_2Translate\", NULL, false, {2045744189U,2170104910U,2743257031U,4284093946U}, 0, false, 1, false };\n   ^\n  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: (near initialization for \u2018emlrtContextGlobal\u2019) [enabled by default]\n  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: excess elements in struct initializer [enabled by default]\n  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: (near initialization for \u2018emlrtContextGlobal\u2019) [enabled by default]\n  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: excess elements in struct initializer [enabled by default]\n  ConstructSystemMatrix_2Translate_mex.c:24:1: warning: (near initialization for \u2018emlrtContextGlobal\u2019) [enabled by default]\n  ConstructSystemMatrix_2Translate_mex.c: In function \u2018mexFunction\u2019:\n  ConstructSystemMatrix_2Translate_mex.c:57:3: warning: implicit declaration of function \u2018emlrtClearAllocCount\u2019 [-Wimplicit-function-declaration]\n     emlrtClearAllocCount(&amp;emlrtContextGlobal, 0, 0, NULL);\n     ^\n  ConstructSystemMatrix_2Translate_mex.o: In function `ConstructSystemMatrix_2Translate_mexFunction':\n  /home/dkumar/Desktop/codegen/mex/ConstructSystemMatrix_2Translate/ConstructSystemMatrix_2Translate_mex.c:37: undefined reference to `ConstructSystemMatrix_2Translate_initialize'\n  /home/dkumar/Desktop/codegen/mex/ConstructSystemMatrix_2Translate/ConstructSystemMatrix_2Translate_mex.c:39: undefined reference to `ConstructSystemMatrix_2Translate_api'\n  /home/dkumar/Desktop/codegen/mex/ConstructSystemMatrix_2Translate/ConstructSystemMatrix_2Translate_mex.c:41: undefined reference to `ConstructSystemMatrix_2Translate_terminate'\n  ConstructSystemMatrix_2Translate_mex.o: In function `ConstructSystemMatrix_2Translate_atexit_wrapper':\n  /home/dkumar/Desktop/codegen/mex/ConstructSystemMatrix_2Translate/ConstructSystemMatrix_2Translate_mex.c:50: undefined reference to `ConstructSystemMatrix_2Translate_atexit'\n  ConstructSystemMatrix_2Translate_mex.o: In function `mexFunction':\n  /home/dkumar/Desktop/codegen/mex/ConstructSystemMatrix_2Translate/ConstructSystemMatrix_2Translate_mex.c:57: undefined reference to `emlrtClearAllocCount'\n  collect2: error: ld returned 1 exit status\n\n      mex: link of ' \"ConstructSystemMatrix_2Translate_mex.mexa64\"' failed.\n\n  mex -g -ldl CFLAGS=\"\\$CFLAGS -std=c99\" -largeArrayDims ConstructSystemMatrix_2Translate_mex.c: Signal 127\n\n  ans =\n\n     255\n</code></pre>\n\n<p>I can see that various header files such as \"ConstructSystemMatrix_2Translate_initialize.h\" etc are properly included. </p>\n\n<p>I also see that there is a <code>*.mki file</code> with following contents:</p>\n\n<pre><code>  # Make settings for ConstructSystemMatrix_2Translate\n  CC=gcc\n  CFLAGS=-ansi -D_GNU_SOURCE  -fexceptions -fPIC -fno-omit-frame-pointer -pthread\n  CLIBS=-Wl,-rpath-link,/usr/local/MATLAB/R2012a/bin/glnxa64 -L/usr/local/MATLAB/R2012a/bin/glnxa64 -lmx -lmex -lmat -lm -lstdc++\n  COPTIMFLAGS=-O -DNDEBUG\n  CDEBUGFLAGS=-g\n  CXX=g++\n  CXXFLAGS=-ansi -D_GNU_SOURCE -fPIC -fno-omit-frame-pointer -pthread\n  CXXLIBS=-Wl,-rpath-link,/usr/local/MATLAB/R2012a/bin/glnxa64 -L/usr/local/MATLAB/R2012a/bin/glnxa64 -lmx -lmex -lmat -lm\n  CXXOPTIMFLAGS=-O -DNDEBUG\n  CXXDEBUGFLAGS=-g\n  LD=gcc\n  LDFLAGS=-pthread -shared -Wl,--version-script,/usr/local/MATLAB/R2012a/extern/lib/glnxa64/mexFunction.map -Wl,--no-undefined\n  LDOPTIMFLAGS=-O\n  LDDEBUGFLAGS=-g\n  Arch=glnxa64\n  OMPFLAGS=\n  OMPLINKFLAGS=\n  EMC_COMPILER=\n  EMC_CONFIG=optim\n</code></pre>\n\n<p>Am I supposed to <code>make some makefile out of this</code>? If yes, could someone guide me?</p>\n\n<p>I am running Matlab R2014b (64 bits)</p>\n"}, {"tags": ["c", "string", "string-literals"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1423663904, "post_id": 28456425, "comment_id": 45239440, "body": "My answer <a href=\"http://stackoverflow.com/a/26279717/1708801\">here</a> covers a lot of this ground."}, {"owner": {"reputation": 22608, "user_id": 618598, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/37b955736b6911e9bbfd417c6aede9ca?s=128&d=identicon&r=PG", "display_name": "Bernd Elkemann", "link": "https://stackoverflow.com/users/618598/bernd-elkemann"}, "edited": false, "score": 0, "creation_date": 1423664400, "post_id": 28456425, "comment_id": 45239791, "body": "@CoolGuy Yes all 3 of your examples are typically true because a compiler will see that the string literals are equal and because it trusts that the programmer will not try to modify them which also answers your last question (if you want to modify a string then use char-array instead of string literal)."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1423666805, "post_id": 28456425, "comment_id": 45241378, "body": "@ShafikYaghmour , Thanks. That answered my first two questions. What about the 3rd one? Do these read only strings exist as long as the program does or will the memory be sent back to the OS once there aren&#39;t any pointers pointing to the string?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1423666884, "post_id": 28456425, "comment_id": 45241429, "body": "@CoolGuy yes, they have static storage duration so they will exist until the program ends."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 22608, "user_id": 618598, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/37b955736b6911e9bbfd417c6aede9ca?s=128&d=identicon&r=PG", "display_name": "Bernd Elkemann", "link": "https://stackoverflow.com/users/618598/bernd-elkemann"}, "edited": false, "score": 0, "creation_date": 1423666895, "post_id": 28456425, "comment_id": 45241439, "body": "@eznme , That wasn&#39;t my question... I should&#39;ve bolded the &quot;until the program ends&quot; part."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1423667595, "post_id": 28456425, "comment_id": 45241925, "body": "@ShafikYaghmour ,Thanks once again. You&#39;ve cleared all my doubts on this."}], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "closed_date": 1423663997, "answer_count": 0, "score": 0, "last_activity_date": 1423663748, "creation_date": 1423663748, "question_id": 28456425, "link": "https://stackoverflow.com/questions/28456425/can-two-equal-unequal-string-literals-be-stored-in-the-same-memory-location", "closed_reason": "Duplicate", "title": "Can two equal/unequal string literals be stored in the same memory location?", "body": "<p>I have some doubts about string literals.</p>\n\n<p>Firstly, I know that C-strings must be compared using the <code>strcmp()</code>,<code>strncmp()</code> or some other function and if one uses <code>==</code>, then they compare the pointers as the array name \"decays\" into a pointer to its first element.<br>\nIs there a chance that two same strings can have the same address,i.e, Can these conditions be true?</p>\n\n<pre><code>if(\"string\"==\"string\")\n\n/*OR*/\n\nchar* str=\"string\";\nif(str==\"string\")\n\n/*OR*/\n\nchar* str=\"string\";\nchar* str2=\"string\";\nif(str==str2)\n</code></pre>\n\n<p><br>\nSecondly, Can two unequal strings contain the same address?</p>\n\n<p>Lastly, Do these strings stay in read only memory segment until the program ends?</p>\n"}, {"tags": ["c", "pipe", "gnuplot"], "comments": [{"owner": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "edited": false, "score": 1, "creation_date": 1423664066, "post_id": 28456410, "comment_id": 45239552, "body": "Do you want to plot the file <code>data.dat</code> or the numbers you are passing to gnuplot in the C code?"}, {"owner": {"reputation": 27, "user_id": 2802298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100002020925908/picture?type=large", "display_name": "Abhi Jith", "link": "https://stackoverflow.com/users/2802298/abhi-jith"}, "reply_to_user": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "edited": false, "score": 0, "creation_date": 1424091512, "post_id": 28456410, "comment_id": 45397284, "body": "i want to plot the numbers i pass through the pipe.."}], "answers": [{"tags": [], "owner": {"reputation": 3135, "user_id": 2648754, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/UWGAJ.png?s=128&g=1", "display_name": "a_pradhan", "link": "https://stackoverflow.com/users/2648754/a-pradhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1423666856, "creation_date": 1423666856, "answer_id": 28457494, "question_id": 28456410, "link": "https://stackoverflow.com/questions/28456410/need-help-in-plotting-the-most-simple-x-y-graph-using-gnuplot-through-c-pipes/28457494#28457494", "title": "need help in plotting the most simple x,y graph using gnuplot through C pipes", "body": "<p>You need to plot the data to a temporary file which you need to specify to gnu plot to actually plot. Write your coordinates in the temporary file and then pass the commands.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#define COMMANDS 2\n\nint main()\n{\n    char * commandsForGnuplot[] = {\"set title \\\"My Little Graph\\\"\", \"plot 'data.temp'\"};\n    FILE * temp = fopen(\"data.temp\", \"w\"); // write coordinates here.\n    FILE * gnuplotPipe = popen (\"gnuplot -persistent\", \"w\");\n    int i;\n    fprintf(temp, \"%lf %lf \\n\", 100.0, 200.0); //Write the data to a temporary file\n    fprintf(temp, \"%lf %lf \\n\", 200.0, 400.0); \n    for (i=0; i &lt; COMMANDS; i++)\n    {\n        fprintf(gnuplotPipe, \"%s \\n\", commandsForGnuplot[i]); //Send commands to gnuplot one by one.\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 2802298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100002020925908/picture?type=large", "display_name": "Abhi Jith", "link": "https://stackoverflow.com/users/2802298/abhi-jith"}, "is_accepted": true, "score": 0, "last_activity_date": 1424091625, "creation_date": 1424091625, "answer_id": 28541980, "question_id": 28456410, "link": "https://stackoverflow.com/questions/28456410/need-help-in-plotting-the-most-simple-x-y-graph-using-gnuplot-through-c-pipes/28541980#28541980", "title": "need help in plotting the most simple x,y graph using gnuplot through C pipes", "body": "<p>well,finally i found the bug, it was not with my program but the gnuplot..</p>\n\n<p><strong>i had to install  gnuplot-x11 along with gnuplot \nso i made a sudo apt-get install gnuplot-x11</strong></p>\n\n<p>now with the same above program,the graph pops up brightly...</p>\n\n<p>Thank you everyone for your help :)</p>\n"}, {"tags": [], "owner": {"reputation": 64845, "user_id": 2088135, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YB10Q.jpg?s=128&g=1", "display_name": "Tom Fenech", "link": "https://stackoverflow.com/users/2088135/tom-fenech"}, "is_accepted": false, "score": 0, "last_activity_date": 1424091811, "creation_date": 1424091811, "answer_id": 28542038, "question_id": 28456410, "link": "https://stackoverflow.com/questions/28456410/need-help-in-plotting-the-most-simple-x-y-graph-using-gnuplot-through-c-pipes/28542038#28542038", "title": "need help in plotting the most simple x,y graph using gnuplot through C pipes", "body": "<p>If I understand you correctly, you need to use the special filename \"-\" in your \"plot\" command string, which tells gnuplot to read values passed over the standard input stream:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{    \n    FILE *p = popen(\"gnuplot -persist\",\"w\");\n    fprintf(p,\"plot '-' with linespoints\\n\");\n    fprintf(p,\"%d\\t%d\\n\",100,200);\n    fprintf(p,\"%d\\t%d\\n\",200,400);\n    fprintf(p,\"%d\\t%d\\n\",300,600);\n    fprintf(p,\"e\\n\");\n    fclose(p);\n    return 0;\n}\n</code></pre>\n\n<p>The code in your question is ignoring the values you are passing it and displaying the contents of the file <code>data.dat</code> instead.</p>\n"}], "owner": {"reputation": 27, "user_id": 2802298, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100002020925908/picture?type=large", "display_name": "Abhi Jith", "link": "https://stackoverflow.com/users/2802298/abhi-jith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 28541980, "answer_count": 3, "score": 0, "last_activity_date": 1424091811, "creation_date": 1423663710, "question_id": 28456410, "link": "https://stackoverflow.com/questions/28456410/need-help-in-plotting-the-most-simple-x-y-graph-using-gnuplot-through-c-pipes", "title": "need help in plotting the most simple x,y graph using gnuplot through C pipes", "body": "<p>i know gnu plot is quite a good tool and has many features, but i only need it to plot a simple X and Y graph with data values provided through the pipe from a C program</p>\n\n<p>here ,i have written a simple program to plot some value, it is working fine in some systems, but it is not working on mine!!</p>\n\n<p>yes,i did install the gnuplot an hour ago on my ubuntu by apt-get ,still no graph pops up after this program executes,please help me make it work and need it to be simple..thank you</p>\n\n<p>here's my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\nFILE *p = popen(\"gnuplot -persist\",\"w\");\nfprintf(p,\"plot 'data.dat' with linespoints\\n\");\nfprintf(p,\"%d\\t%d\\n\",100,200);\nfprintf(p,\"%d\\t%d\\n\",200,400);\nfprintf(p,\"%d\\t%d\\n\",300,600);\nfprintf(p,\"e\\n\");\nfclose(p);\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macros", "operators", "overloading"], "comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1423663906, "post_id": 28456383, "comment_id": 45239442, "body": "Why not use a pointer to a comparison function?"}, {"owner": {"reputation": 13009, "user_id": 1532045, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c0f1432bd6834661f8e16d0397f43b00?s=128&d=identicon&r=PG", "display_name": "Avner Barr", "link": "https://stackoverflow.com/users/1532045/avner-barr"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423663970, "post_id": 28456383, "comment_id": 45239489, "body": "The function needs to return a &gt; or &lt;= symbol. The comparison is done in the code I already have"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1423664205, "post_id": 28456383, "comment_id": 45239657, "body": "No, the function would <i>do</i> the comparison; like <code>int gt(int l, int r) { return l&gt;r; } int (*cmpFuncPtr)(int, int) = gt; int main() { while( cmpFuncPtr(1, 2) ) ; }</code> Didn&#39;t test this but should be an infinite loop with minor modifications. Similarily define functions for less or equal etc. and switch the function pointer dynamically to one of them, depending on what you need."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423664954, "post_id": 28456383, "comment_id": 45240154, "body": "Just make <code>repeated code</code> -&gt; <code>repeatedCode()</code> ie, make it a function. Choosing the direction of iteration with a macro will make your code very difficult to understand."}], "answers": [{"comments": [{"owner": {"reputation": 13009, "user_id": 1532045, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c0f1432bd6834661f8e16d0397f43b00?s=128&d=identicon&r=PG", "display_name": "Avner Barr", "link": "https://stackoverflow.com/users/1532045/avner-barr"}, "edited": false, "score": 0, "creation_date": 1423664412, "post_id": 28456602, "comment_id": 45239798, "body": "I like this one. I didn&#39;t think about changing the step to negative. I will try to change the condition and see if it can work for me :)"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423665043, "post_id": 28456602, "comment_id": 45240216, "body": "This one is the solution, but consider making <code>repeatedCode()</code> a function, that way it will be clearer what the code does."}], "tags": [], "owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "is_accepted": false, "score": 2, "last_activity_date": 1423666449, "last_edit_date": 1423666449, "creation_date": 1423664327, "answer_id": 28456602, "question_id": 28456383, "link": "https://stackoverflow.com/questions/28456383/how-to-create-a-macro-on-a-condition-inside-a-if-statement/28456602#28456602", "title": "How to create a macro on a condition inside a if statement", "body": "<p>You only need the loop code once. Just change the step value and terminating value. For example:</p>\n\n<pre><code>int start_column, end_column, column_step;\n   :\nswitch (direction.horizontal) {\n  case UIScrollDirectionLeft:\n    column = start_column + 1;\n    column_step = 1;\n    end_column = max_allowed;\n    break;\n  case UIScrollDirectionRight:\n    column = min_column - 1;\n    column_step = -1;\n    end_column = -1;\n    break;\n  :\n}\nwhile (column != end_column) {\n  for (int row = minRow; row &lt; maxRow; row++) {\n    repeated_code();\n  }\n  column += column_step;\n}\n</code></pre>\n"}], "owner": {"reputation": 13009, "user_id": 1532045, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c0f1432bd6834661f8e16d0397f43b00?s=128&d=identicon&r=PG", "display_name": "Avner Barr", "link": "https://stackoverflow.com/users/1532045/avner-barr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423666449, "creation_date": 1423663588, "last_edit_date": 1423664486, "question_id": 28456383, "link": "https://stackoverflow.com/questions/28456383/how-to-create-a-macro-on-a-condition-inside-a-if-statement", "title": "How to create a macro on a condition inside a if statement", "body": "<p>I need to iterate a <code>for</code> loop nested inside of a <code>while</code> loop for several different conditions.</p>\n\n<p>The only change in the code for each statement is the comparison condition to apply.</p>\n\n<p>Turns out I am copy-pasting all of the code multiple times and changing the direction of the greater-less than symbol.</p>\n\n<p>for example:</p>\n\n<pre><code>if (direction.horizontal == UIScrollDirectionLeft) {\n    int column = startColumn+1;\n    while (column &lt; maxAllowed) {\n        for (int row = minRow; row &lt; maxRow; row++) {\n            repeated code\n        }\n        column++;\n } else {\n    int column = minColumn -1;\n    while (column &gt;= 0) {\n        for (int row = minRow; row &lt; maxRow; row++) {\n            repeated code\n        }\n        column--;\n    }\n}\n</code></pre>\n\n<p>Is it possible to do a macro for the condition operator in order to facilitate code reuse?</p>\n\n<p>I would really like something which could look like this:</p>\n\n<pre><code>int  startColumn = (direction.horizontal == UIScrollDirectionLeft) ? (startColumn+1) : minColumn -1;\nSignOfOperator theSignInTheWhile = (direction.horizontal == UIScrollDirectionLeft) ? \"&lt;\" : \"&gt;=\";\nint conditionToTestInWhile = (direction.horizontal == UIScrollDirectionLeft) ? maxAllowed : 0;\n\nwhile(startColumn,theSignInTheWhile,conditionToTestInWhile) {\n  // repeated code\n}\n</code></pre>\n\n<p>I have another 4 cases like the one above...</p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "string-concatenation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "edited": false, "score": 3, "creation_date": 1423663211, "post_id": 28456192, "comment_id": 45238926, "body": "Why are you using a version of GCC that&#39;s over a decade old?"}, {"owner": {"reputation": 2248, "user_id": 785937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70e63ebc80df54d7e32ca4535922986e?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/785937/john"}, "edited": false, "score": 1, "creation_date": 1423663308, "post_id": 28456192, "comment_id": 45239012, "body": "It is actually a safety-critical fork from a decade ago. It is from WindRiver 653. That&#39;s out of my hands."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1423663399, "post_id": 28456192, "comment_id": 45239083, "body": "Well, you already have two strings, after <code>#x</code> and <code>#y</code>; you don&#39;t need to concat them into a single token, just use <code>#x #y</code>."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1423663405, "post_id": 28456192, "comment_id": 45239089, "body": "That concat is unnecessary. <code>&quot;Hi&quot; &quot;There&quot;</code> will be interpreted as <code>&quot;HiThere&quot;</code> even without doing so."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423663467, "post_id": 28456192, "comment_id": 45239134, "body": "The preprocessor simply doesn&#39;t allow concatenation of strings using the concatenation operator. From <a href=\"http://en.cppreference.com/w/cpp/preprocessor/replace\" rel=\"nofollow noreferrer\">this reference</a>: &quot;Only tokens that form a valid token together may be pasted&quot;. String-literal concatenation is handled by another <a href=\"http://en.cppreference.com/w/cpp/language/translation_phases\" rel=\"nofollow noreferrer\">compiler phase</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3920237"}, "is_accepted": true, "score": 7, "last_activity_date": 1423663486, "creation_date": 1423663486, "answer_id": 28456345, "question_id": 28456192, "link": "https://stackoverflow.com/questions/28456192/getting-a-macro-to-concat-and-stringify/28456345#28456345", "title": "Getting a macro to concat AND stringify", "body": "<p>The preprocessor already concatenates adjacent string literals. So your macro is unnecessary. Example:</p>\n\n<pre><code>#define TOKENPASTE3(x, y) #x #y\nconst char* s = TOKENPASTE3(Hi, There);\n</code></pre>\n\n<p>becomes <code>\"Hi\" \"There\"</code>. However, if you wanted to stick with your approach, you need to use an extra level of indirection to macro expand your new token:</p>\n\n<pre><code>#define STRINGIFY(x) #x\n#define TOKENPASTE(x, y) STRINGIFY(x ## y)\n</code></pre>\n\n<p>becomes <code>\"HiThere\"</code>.</p>\n"}], "owner": {"reputation": 2248, "user_id": 785937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70e63ebc80df54d7e32ca4535922986e?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/785937/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7819, "favorite_count": 0, "accepted_answer_id": 28456345, "answer_count": 1, "score": 4, "last_activity_date": 1464076978, "creation_date": 1423663056, "last_edit_date": 1464076978, "question_id": 28456192, "link": "https://stackoverflow.com/questions/28456192/getting-a-macro-to-concat-and-stringify", "title": "Getting a macro to concat AND stringify", "body": "<p>The approach to concatenate in <strong>C</strong>/C++ in a preprocessor macro is to use ##.\nThe approach to stringify is to use #.\nI'm trying to concat AND stringify. This is generating a warning from g++ (3.3.2)</p>\n\n<pre><code>#define TOKENPASTE(x, y) x ## y\n#define TOKENPASTE2(x, y) TOKENPASTE(x, y)      // concat\n#define TOKENPASTE3(x, y) TOKENPASTE(#x, #y)    // concat-stringify (warnings)\nconst char* s = TOKENPASTE3(Hi, There)\n</code></pre>\n\n<p>It is not acceptable to get the warning</p>\n\n<blockquote>\n  <p>\"test_utils/test_registration.h:34:38: warning: pasting \"\"Hi\"\" and\n  \"\"There\"\" does not give a valid preprocessing token\"</p>\n</blockquote>\n\n<p>although (using the -E option) I see that it generates:</p>\n\n<pre><code>const char* s = \"Hi\"\"There\";\n</code></pre>\n\n<p>Which looks right to me.</p>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["c", "gcc", "osdev"], "answers": [{"tags": [], "owner": {"reputation": 9854, "user_id": 1741450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7900ed57a92b336effd879fa61de226?s=128&d=identicon&r=PG", "display_name": "lucasg", "link": "https://stackoverflow.com/users/1741450/lucasg"}, "is_accepted": true, "score": 2, "last_activity_date": 1423663478, "creation_date": 1423663478, "answer_id": 28456343, "question_id": 28455999, "link": "https://stackoverflow.com/questions/28455999/do-i-have-to-link-the-files-with-lgcc/28456343#28456343", "title": "Do I have to link the files with -lgcc?", "body": "<p>If you do some driver/kernel dev, you may use the <code>-nostdlib</code> to remove your module from the bloated stdlib. However, you also remove all the internal hacks GCC has in order to have a consistent behaviour on a whole range of hardware.</p>\n\n<p><a href=\"http://gcc.gnu.org/onlinedocs/gcc-4.6.1/gcc/Link-Options.html\" rel=\"nofollow\">http://gcc.gnu.org/onlinedocs/gcc-4.6.1/gcc/Link-Options.html</a></p>\n\n<blockquote>\n  <p>-nostdlib</p>\n  \n  <p>Do not use the standard system startup files or libraries when linking. No startup files and only the libraries you specify will be\n  passed to the linker, options specifying linkage of the system\n  libraries, such as -static-libgcc or -shared-libgcc, will be ignored.\n  The compiler may generate calls to memcmp, memset, memcpy and memmove.\n  These entries are usually resolved by entries in libc. These entry\n  points should be supplied through some other mechanism when this\n  option is specified.</p>\n  \n  <p>One of the standard libraries bypassed by -nostdlib and -nodefaultlibs is libgcc.a, a library of internal subroutines that GCC uses to overcome shortcomings of particular machines, or special needs\n  for some languages. (See Interfacing to GCC Output, for more\n  discussion of libgcc.a.) In most cases, you need libgcc.a even when\n  you want to avoid other standard libraries. In other words, when you\n  specify -nostdlib or -nodefaultlibs you should usually specify -lgcc\n  as well. This ensures that you have no unresolved references to\n  internal GCC library subroutines. (For example, `__main', used to\n  ensure C++ constructors will be called; see collect2.)</p>\n</blockquote>\n\n<p><a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.6.1/gccint/Interface.html#Interface\" rel=\"nofollow\">https://gcc.gnu.org/onlinedocs/gcc-4.6.1/gccint/Interface.html#Interface</a></p>\n\n<blockquote>\n  <p>3 Interfacing to GCC Output</p>\n  \n  <p>GCC is normally configured to use the same function calling convention\n  normally in use on the target system. This is done with the\n  machine-description macros described (see Target Macros).</p>\n  \n  <p>However, returning of structure and union values is done differently\n  on some target machines. As a result, functions compiled with PCC\n  returning such types cannot be called from code compiled with GCC, and\n  vice versa. This does not cause trouble often because few Unix library\n  routines return structures or unions.</p>\n  \n  <p>GCC code returns structures and unions that are 1, 2, 4 or 8 bytes\n  long in the same registers used for int or double return values. (GCC\n  typically allocates variables of such types in registers also.)\n  Structures and unions of other sizes are returned by storing them into\n  an address passed by the caller (usually in a register). The target\n  hook TARGET_STRUCT_VALUE_RTX tells GCC where to pass this address.</p>\n  \n  <p>By contrast, PCC on most target machines returns structures and unions\n  of any size by copying the data into an area of static storage, and\n  then returning the address of that storage as if it were a pointer\n  value. The caller must copy the data from that memory area to the\n  place where the value is wanted. This is slower than the method used\n  by GCC, and fails to be reentrant.</p>\n  \n  <p>On some target machines, such as RISC machines and the 80386, the\n  standard system convention is to pass to the subroutine the address of\n  where to return the value. On these machines, GCC has been configured\n  to be compatible with the standard compiler, when this method is used.\n  It may not be compatible for structures of 1, 2, 4 or 8 bytes.</p>\n  \n  <p>GCC uses the system's standard convention for passing arguments. On\n  some machines, the first few arguments are passed in registers; in\n  others, all are passed on the stack. It would be possible to use\n  registers for argument passing on any machine, and this would probably\n  result in a significant speedup. But the result would be complete\n  incompatibility with code that follows the standard convention. So\n  this change is practical only if you are switching to GCC as the sole\n  C compiler for the system. We may implement register argument passing\n  on certain machines once we have a complete GNU system so that we can\n  compile the libraries with GCC.</p>\n  \n  <p>On some machines (particularly the SPARC), certain types of arguments\n  are passed \u201cby invisible reference\u201d. This means that the value is\n  stored in memory, and the address of the memory location is passed to\n  the subroutine.</p>\n  \n  <p>If you use longjmp, beware of automatic variables. ISO C says that\n  automatic variables that are not declared volatile have undefined\n  values after a longjmp. And this is all GCC promises to do, because it\n  is very difficult to restore register variables correctly, and one of\n  GCC's features is that it can put variables in registers without your\n  asking it to.</p>\n</blockquote>\n"}], "owner": {"reputation": 385, "user_id": 4233152, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6863f323734085ad84efd9f7948a064c?s=128&d=identicon&r=PG&f=1", "display_name": "Coretool", "link": "https://stackoverflow.com/users/4233152/coretool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 0, "accepted_answer_id": 28456343, "answer_count": 1, "score": 1, "last_activity_date": 1453832928, "creation_date": 1423662522, "last_edit_date": 1453832928, "question_id": 28455999, "link": "https://stackoverflow.com/questions/28455999/do-i-have-to-link-the-files-with-lgcc", "title": "Do I have to link the files with -lgcc?", "body": "<p>If you've ever linked a kernel with gcc you may know the parameter -lgcc.\nIs this parameter important ? What does it do ? </p>\n"}, {"tags": ["python", "c", "sockets", "python-2.7", "nanomsg"], "comments": [{"owner": {"reputation": 3817, "user_id": 2082884, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8c1a7c51faf6f8622ecdbb8b638d3550?s=128&d=identicon&r=PG", "display_name": "hetepeperfan", "link": "https://stackoverflow.com/users/2082884/hetepeperfan"}, "edited": false, "score": 0, "creation_date": 1423663297, "post_id": 28455978, "comment_id": 45238998, "body": "Are you sure the type of sockets match? Shouldn&#39;t both be SOCK_STREAM or NN_PAIR. In ZeroMq which is not the same, a socket just waits to connnect until a suitable socket becomes available."}, {"owner": {"reputation": 10774, "user_id": 4419802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0f1bd19b8b8481b6b3e812691c1ccb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/4419802/matt"}, "edited": false, "score": 0, "creation_date": 1423663297, "post_id": 28455978, "comment_id": 45238999, "body": "Looking into library&#39;s docs, it seems that <code>nn_socker</code> must have <code>NN_PULL</code> flag for this particular situation."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1423667226, "post_id": 28455978, "comment_id": 45241671, "body": "In <code>&quot;tcp:&#47;&#47;127.0.0.1:xxxxx&quot;</code>, is <code>xxxxx</code> recognized as a valid port?  Should it be something like 10000?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1423667425, "post_id": 28455978, "comment_id": 45241820, "body": "Have you seen this <b><i><a href=\"http://tim.dysinger.net/posts/2013-09-16-getting-started-with-nanomsg.html\" rel=\"nofollow noreferrer\">nanomsg blog example</a></i></b>?"}, {"owner": {"reputation": 81, "user_id": 2889722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910c0a18194cd8f15f5218eaf08cb498?s=128&d=identicon&r=PG&f=1", "display_name": "linksfate", "link": "https://stackoverflow.com/users/2889722/linksfate"}, "edited": false, "score": 0, "creation_date": 1423667824, "post_id": 28455978, "comment_id": 45242087, "body": "xxxxx is replaced by a valid port in the actual code."}, {"owner": {"reputation": 470, "user_id": 1041313, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4461f02989bb1d19a7de713bbffb8faa?s=128&d=identicon&r=PG", "display_name": "mojovski", "link": "https://stackoverflow.com/users/1041313/mojovski"}, "edited": false, "score": 0, "creation_date": 1437642766, "post_id": 28455978, "comment_id": 51118753, "body": "does it work? I am also looking for a similar case"}, {"owner": {"reputation": 81, "user_id": 2889722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910c0a18194cd8f15f5218eaf08cb498?s=128&d=identicon&r=PG&f=1", "display_name": "linksfate", "link": "https://stackoverflow.com/users/2889722/linksfate"}, "edited": false, "score": 0, "creation_date": 1437733659, "post_id": 28455978, "comment_id": 51166132, "body": "I was able to establish the connection by using <a href=\"https://github.com/tonysimpson/nanomsg-python\" rel=\"nofollow noreferrer\">this</a> Python wrapper for the nanomsg library. It didn&#39;t work for me using the standard sockets in Python. (However, standard sockets in C work well with standard sockets in Python)"}], "answers": [{"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 5, "last_activity_date": 1479648714, "last_edit_date": 1479648714, "creation_date": 1477854972, "answer_id": 40332649, "question_id": 28455978, "link": "https://stackoverflow.com/questions/28455978/socket-connection-between-c-nanomsg-and-python-non-nanomsg/40332649#40332649", "title": "Socket connection between C (nanomsg) and Python (non-nanomsg)", "body": "<p>The issue is that nanomsg socket type is not a plain, standard, TCP type. The protocols do not match. You cannot send TCP message to a nanomsg socket and expect that <code>nn_recv</code> will work since the message will not conform to the defined nanomsg SP protocol requirements.</p>\n\n<p>See nanomsg SP protocol header:</p>\n\n<pre><code>0                1               2                3\n0 1 2 3 4 5 6 7  8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3  4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|      0x00     |      0x53     |      0x50     |    version    |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|             type              |           reserved            |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n</code></pre>\n\n<p>First four bytes of the protocol header are used to make sure that the peer's protocol is compatible with the protocol used by the local endpoint.</p>\n\n<p>If the protocol header received from the peer differs, the TCP connection <strong>MUST</strong> be closed immediately.</p>\n\n<p>That means that any raw TCP <code>send</code> to the nanomsg socket will kill the connection since it does not confirm to the SP protocol. </p>\n\n<p>For more info consult the sp-tcp-mapping-01.txt document <a href=\"https://github.com/nanomsg/nanomsg/blob/master/rfc/sp-tcp-mapping-01.txt\" rel=\"nofollow noreferrer\"><strong>here</strong></a></p>\n"}], "owner": {"reputation": 81, "user_id": 2889722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910c0a18194cd8f15f5218eaf08cb498?s=128&d=identicon&r=PG&f=1", "display_name": "linksfate", "link": "https://stackoverflow.com/users/2889722/linksfate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1479648714, "creation_date": 1423662485, "question_id": 28455978, "link": "https://stackoverflow.com/questions/28455978/socket-connection-between-c-nanomsg-and-python-non-nanomsg", "title": "Socket connection between C (nanomsg) and Python (non-nanomsg)", "body": "<p>I created a socket server in C (using nanomsg) which shall communicate with a Python script (using standard 'Socket' implementation) via TCP:</p>\n\n<p>C-Code (without error handling):</p>\n\n<pre><code>#include &lt;nanomsg/nn.h&gt;\n#include &lt;nanomsg/pair.h&gt;\n...\nchar buf[23];\n...\nsocket = nn_socket(AF_SP, NN_PAIR);\nnn_bind(socket, \"tcp://127.0.0.1:xxxxx\");\n...\nnn_recv(socket, buf, sizeof(buf), 0); \n...\nnn_shutdown(socket, endpoint_id);\n</code></pre>\n\n<p>Python-Code:</p>\n\n<pre><code>s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) \ns.connect((\"127.0.0.1\", xxxxx))\ns.send('Hello C this is Python')\ns.close()\n</code></pre>\n\n<p>There is no error in Python when connecting to the socket (if the C app is running). However, the C script is idling in method nn_recv and doesn't get any data at all. What am I doing wrong? </p>\n\n<p>First I start the C code in a shell (it idles in method nn_recv). Then I start Python in another shell and expect the C application to receive the data. Both scripts execute without error.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1423662584, "post_id": 28455955, "comment_id": 45238532, "body": "TL;DR! Start by using a debugger to see <i>where</i> the crash happens (in your code), then edit your question to only include the relevant parts (together with the values of involved variables)."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 1, "creation_date": 1423662623, "post_id": 28455955, "comment_id": 45238551, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Please don&#39;t cast the return value of <code>malloc()</code> in C</a>. Also remember that <code>malloc()</code> can fail."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1423662653, "post_id": 28455955, "comment_id": 45238571, "body": "Though, an even better start would be to <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">not cast the return of <code>malloc</code></a>, and actually check that you allocate correctly (<code>sizeof(int)</code> is not always equal to <code>sizeof(int *)</code>)."}, {"owner": {"reputation": 2432, "user_id": 793716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06452b91c9651f991d26d28ba873e760?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/793716/rob"}, "edited": false, "score": 0, "creation_date": 1423662742, "post_id": 28455955, "comment_id": 45238623, "body": "I am assuming that this was a typo: &quot;for(i=0;i&lt;20;i=i){&quot; this for loop would never end as i would never change from 0."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423663321, "post_id": 28456260, "comment_id": 45239027, "body": "It might me the case that <code>sizeof(int) == sizeof(int *)</code>. But it&#39;s reasonable to think that this is the issue."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423663437, "post_id": 28456260, "comment_id": 45239113, "body": "Also Gopi, please give the OP a link to the most popular c question on SO, Do I cast ... you know which one, don&#39;t you?"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423663455, "post_id": 28456260, "comment_id": 45239123, "body": "@iharob Yeah but what we need to <code>sizeof(int *)</code> and since the standard never guarantees <code>sizeof(int) == sizeof(int *)</code> we should have <code>sizeof(int*)</code> Yes ofcourse I will add the popular link"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423663521, "post_id": 28456260, "comment_id": 45239179, "body": "Oh, and apparently you should mention <code>scanf(&quot;%c&quot;,&amp;character);</code> it would be good to have a space <code>&quot; %c&quot;</code> in the third <code>scanf()</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423663573, "post_id": 28456260, "comment_id": 45239213, "body": "And I don&#39;t argue to that, alwaus use <code>-1</code> star in the <code>sizeof()</code> when <code>malloc()</code>ing"}, {"owner": {"reputation": 11, "user_id": 4554932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18338a25c57e8479c8b02b91495db20?s=128&d=identicon&r=PG&f=1", "display_name": "A.Z. Amiri", "link": "https://stackoverflow.com/users/4554932/a-z-amiri"}, "edited": false, "score": 0, "creation_date": 1423664279, "post_id": 28456260, "comment_id": 45239710, "body": "I finaly got it working thanks alot for the tips it really helped. And the infinite loop was on purpose."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 1, "last_activity_date": 1423663600, "last_edit_date": 1495540170, "creation_date": 1423663243, "answer_id": 28456260, "question_id": 28455955, "link": "https://stackoverflow.com/questions/28455955/segmentation-fault-anagram-project/28456260#28456260", "title": "segmentation fault anagram project", "body": "<pre><code>table = (int **)malloc(sizeof(int)*a);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>table = malloc(sizeof(int *)*a);\n</code></pre>\n\n<p>and also</p>\n\n<pre><code>test = malloc(sizeof(int *)*m);\nresult = malloc(sizeof(int *)*m);\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Dont cast <code>malloc()</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "is_accepted": false, "score": 0, "last_activity_date": 1423664101, "creation_date": 1423664101, "answer_id": 28456529, "question_id": 28455955, "link": "https://stackoverflow.com/questions/28455955/segmentation-fault-anagram-project/28456529#28456529", "title": "segmentation fault anagram project", "body": "<p>Unless <code>sizeof(int)==sizeof(int*)</code> on your platform the line:</p>\n\n<pre><code>table = (int **)malloc(sizeof(int)*a);\n</code></pre>\n\n<p>Will cause trouble.  Use:</p>\n\n<pre><code>table = malloc(sizeof(*table)*a);\n</code></pre>\n\n<p>NB: Old boys get ventilated about casting the return of <code>malloc()</code>. </p>\n"}], "owner": {"reputation": 11, "user_id": 4554932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18338a25c57e8479c8b02b91495db20?s=128&d=identicon&r=PG&f=1", "display_name": "A.Z. Amiri", "link": "https://stackoverflow.com/users/4554932/a-z-amiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1423664101, "creation_date": 1423662404, "last_edit_date": 1423663206, "question_id": 28455955, "link": "https://stackoverflow.com/questions/28455955/segmentation-fault-anagram-project", "title": "segmentation fault anagram project", "body": "<p>Hey guys im working on this project. It wants me to find anagrams. My code works when im writing like 2 sentences. But it shows me a segmentation fault if i write more sentences then 5. I tried to find the problem but i cant figure it out. can some one check it for me? here is my code. Thanks alot!</p>\n\n<pre><code>int klinkercheck(char z)\n{\n    if (z =='a')\n        return 1000;\n    else if (z == 'e')\n        return 10000;\n    else if (z == 'i')\n        return 100000;\n    else if (z == 'o')\n        return 1000000;\n    else if (z == 'u')\n        return 10000000;\n    else if (z == 10)\n        return 0;\n    else if (z == '.' || z== ' ')\n        return 0;\n    else\n        return 1;\n}\n\nint main()\n{\n    int a,k,i,m,l,*tablecost,*testcost;\n    int **table, **test, **result;\n    char character;\n\n    scanf(\"%d\",&amp;a);\n    table = (int **)malloc(sizeof(int)*a);\n    tablecost = (int *)malloc(sizeof(int)*a);\n\n    for(k=0; k&lt;a; k++) {\n        table[k]= (int *)malloc(sizeof(int)*26);\n        /*printf(\"tablecost = %d\",tablecost[k]);*/\n\n    }\n\n\n    for(k=0; k&lt;a; k++) {\n\n        for(i=0; i&lt;2; i=i) {\n            scanf(\"%c\",&amp;character);\n            tablecost[k]= tablecost[k]+klinkercheck(character);\n            if(character=='.') {\n                /*printf(\"%d\\n\",k);*/\n                break;\n            } else if(character &lt; 97) {\n                /* do nothing*/\n            } else {\n                table[k][character%97]++;\n            }\n        }\n    }\n\n    scanf(\"%d\",&amp;m);\n    test = (int **)malloc(sizeof(int)*m);\n    result = (int **)malloc(sizeof(int)*m);\n    testcost = (int *)malloc(sizeof(int)*m);\n\n    for(k=0; k&lt;m; k++) {\n        test[k]= (int *)malloc(sizeof(int)*26);\n        result[k] = (int *)malloc(sizeof(int)*a);\n\n    }\n\n    for (k = 0 ; k &lt; m ; k++) {\n        testcost[k]=0;\n        for(i=0; i&lt;20; i=i) {\n            scanf(\"%c\",&amp;character);\n            testcost[k] =testcost[k]+klinkercheck(character);\n            if(character=='.') {\n                break;\n            } else if(character &lt; 97) {\n                /* do nothing*/\n            } else {\n                test[k][character%97]++;\n            }\n        }\n    }\n\n    for (i = 0 ; i &lt; m ; i++) {\n        for (k = 0 ; k &lt; a ; k++) {\n            if (testcost[i] == tablecost[k]) {\n                for (l = 0 ; l &lt; 26 ; l++) {\n                    if (test[i][l] != table[k][l]) {\n                        break;\n                    } else if (l == 25) {\n                        printf(\"%d \", k + 1);\n                    }\n                }\n            }\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linux", "inotify"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423661005, "post_id": 28455484, "comment_id": 45237540, "body": "<code>inotify</code> is great and of course there are libraries on top of it to make it easier to use."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1423661176, "post_id": 28455484, "comment_id": 45237630, "body": "Inotify will indeed only monitor existing files, as it&#39;s kind of impossible to monitor something which doesn&#39;t exist. However, you forget that you can monitor <i>directories</i> as well."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1423661270, "post_id": 28455484, "comment_id": 45237688, "body": "Regarding &quot;file types&quot;, there&#39;s not really different &quot;types&quot; of files in Linux (or generally in the POSIX/UNIX world). But if you monitor the directory for new files, you can check the file extensions to see if it&#39;s what you want."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423661598, "post_id": 28455484, "comment_id": 45237907, "body": "@JoachimPileborg and in fact file creation is possible to monitor on directories, it also gives you the created file name, I have a small program that does exactly that, I wrote it one to help me with a bug in another software."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1423661909, "post_id": 28455484, "comment_id": 45238111, "body": "I think the union of your comments so far answers the question very well.  Did you consider making them an answer?  I would surely upvote for it.  It&#39;s a bit difficult for someone else to write an answer now as it would smell a bit like plagiarism."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1423662328, "post_id": 28455484, "comment_id": 45238364, "body": "And you can try using <code>libmagic</code> too for the file types. @5gon12eder if none of the commenters has wrote an answer yet you can do it, I think it&#39;s ok but of course it&#39;s my opinion."}, {"owner": {"reputation": 2022, "user_id": 281617, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20d873baa75c66bdcf8d06512ee664cc?s=128&d=identicon&r=PG", "display_name": "mousomer", "link": "https://stackoverflow.com/users/281617/mousomer"}, "edited": false, "score": 0, "creation_date": 1423663442, "post_id": 28455484, "comment_id": 45239115, "body": "What I need is to monitor, say, json files (/home/user/path_a/*.json) and disregard all other file types in that path."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423668250, "post_id": 28455484, "comment_id": 45242371, "body": "@iharob Thanks.  With your \u201cpermission\u201d, I decided to give it a shot."}], "answers": [{"comments": [{"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 0, "creation_date": 1423667115, "post_id": 28457493, "comment_id": 45241587, "body": "That&#39;s a handy piece of sample code except for the <code>C++</code> tag - that <code>catch</code> is a keyword."}, {"owner": {"reputation": 2022, "user_id": 281617, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20d873baa75c66bdcf8d06512ee664cc?s=128&d=identicon&r=PG", "display_name": "mousomer", "link": "https://stackoverflow.com/users/281617/mousomer"}, "edited": false, "score": 0, "creation_date": 1423668148, "post_id": 28457493, "comment_id": 45242309, "body": "Wow. Thank you very much. I&#39;ll check this."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 1, "creation_date": 1423668159, "post_id": 28457493, "comment_id": 45242317, "body": "@Petesh I decided to write a C example program to be more general. (The question is tagged <code>c</code> and <code>c++</code>.)  I&#39;m used to using <code>catch</code> as a label in C to make it clear that I&#39;m using <code>goto</code> to mimic exception handling.  Yes, this means the code won&#39;t compile as C++ code but I consider this more a feature than a bug because it reminds us not to use <code>goto</code> error handling in C++.  However, if you need dual language support, renaming the label would be a minor edit."}, {"owner": {"reputation": 2022, "user_id": 281617, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20d873baa75c66bdcf8d06512ee664cc?s=128&d=identicon&r=PG", "display_name": "mousomer", "link": "https://stackoverflow.com/users/281617/mousomer"}, "edited": false, "score": 0, "creation_date": 1472050566, "post_id": 28457493, "comment_id": 65598888, "body": "@5gon12eder why do you need the <i>struct sigaction</i> block on the main? things seem to wrok without it."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 2022, "user_id": 281617, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20d873baa75c66bdcf8d06512ee664cc?s=128&d=identicon&r=PG", "display_name": "mousomer", "link": "https://stackoverflow.com/users/281617/mousomer"}, "edited": false, "score": 0, "creation_date": 1472154580, "post_id": 28457493, "comment_id": 65650630, "body": "@mousomer It is used to ensure an orderly shutdown when SIGINT is received. In a real program, you&#39;d use whatever main loop suits your application. If you don&#39;t install a handler, SIGINT by default will terminate your application without cleanup."}], "tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": true, "score": 5, "last_activity_date": 1423668847, "last_edit_date": 1423668847, "creation_date": 1423666849, "answer_id": 28457493, "question_id": 28455484, "link": "https://stackoverflow.com/questions/28455484/linux-c-notify-file-type-creation/28457493#28457493", "title": "linux C++ notify file type creation", "body": "<p>This sounds like a good use case of <em>inotify</em>.  The <a href=\"http://man7.org/linux/man-pages/man7/inotify.7.html\" rel=\"nofollow\">man page</a> has a pretty good example that is easily transferred to your problem.</p>\n\n<p>Here is a little program that can be used like</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ myprog /tmp '*.o' '*.a'\n</code></pre>\n\n<p>to watch the directory <code>/tmp</code> for the creation of <code>*.o</code> and <code>*.a</code> files.  Note that the patterns are quoted to prevent expansion by the shell.  The program runs forever until interrupted by <code>SIGINT</code> (press <kbd>Ctrl</kbd> + <kbd>C</kbd>).</p>\n\n<p>I am using <code>fnmatch</code> to match the names of the created files against the patterns and install a signal handler for <code>SIGINT</code> that sets a global flag.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fnmatch.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/inotify.h&gt;\n#include &lt;unistd.h&gt;\n</code></pre>\n\n<p>I define a small preprocessor macro to align the buffer using GCC's <code>__attribute__</code> extension.  More on this later when we actually use this macro.</p>\n\n<pre><code>#ifdef __GNUC__\n#  define ALIGNAS(TYPE) __attribute__ ((aligned(__alignof__(TYPE))))\n#else\n#  define ALIGNAS(TYPE) /* empty */\n#endif\n</code></pre>\n\n<p>This is a global flag that we'll set in the signal handler to indicate that the program should quit gracefully.</p>\n\n<pre><code>static volatile int interrupted = 0;\n</code></pre>\n\n<p>And this is the signal handler itself.</p>\n\n<pre><code>static void\ninterruption_handler(const int s)\n{\n  if (s == SIGINT)\n    interrupted = 1;\n}\n</code></pre>\n\n<p>This function is the working-horse of the program.</p>\n\n<pre><code>static int\nmonitor_directory(const char *const directory,\n                  const char *const *const patterns,\n                  const size_t pattern_count)\n{\n  int notifyfd = -1;\n  int watchfd = -1;\n  int ret = 0;\n  const char * errmsg = \"unknown error\";\n</code></pre>\n\n<p>First, we initialize <em>inotify</em>.  <code>inotify_init</code> will return a file descriptor that we can <code>read()</code>  notifications from.  I use blocking I/O so the <code>read()</code> will block until an event occurs.</p>\n\n<pre><code>  notifyfd = inotify_init();\n  if (notifyfd &lt; 0)\n    {\n      errmsg = \"inotify_init\";\n      goto catch;\n    }\n</code></pre>\n\n<p>Now we register files to watch.  In our case, we want to watch a single directory (<code>directory</code>) for the creation of new files (<code>IN_CREATE</code>).  The returned file descriptor could be used to tell (if an event occurs) to what watched file it belongs.  But since we are watching only a single file (that happens to be a directory) anyway, we don't really need this info.</p>\n\n<pre><code>  watchfd = inotify_add_watch(notifyfd, directory, IN_CREATE);\n  if (watchfd &lt; 0)\n    {\n      errmsg = \"inotify_add_watch\";\n      goto catch;\n    }\n</code></pre>\n\n<p>Now everything is set up properly and we can start <code>read()</code>ing from the notification file descriptor.</p>\n\n<pre><code>  while (1)\n    {\n</code></pre>\n\n<p>It is not known in advance how much a call to <code>read</code> from the <em>inotify</em> descriptor will read so we have to read into a <code>char</code> buffer.  We wish to align it properly, tough.  See the man page for more comments on this.</p>\n\n<pre><code>      char buffer[sizeof(struct inotify_event) + NAME_MAX + 1] ALIGNAS(struct inotify_event);\n      const struct inotify_event * event_ptr;\n</code></pre>\n\n<p><code>read()</code> from the file descriptor.  If we get interrupted, the <code>read()</code> will unblock and return \u20131 as it will if an error occurs.</p>\n\n<pre><code>      ssize_t count = read(notifyfd, buffer, sizeof(buffer));\n      if (count &lt; 0)\n        {\n          if (interrupted)\n            goto finally;\n          errmsg = \"read\";\n          goto catch;\n        }\n</code></pre>\n\n<p>We have a new event, handle it.</p>\n\n<pre><code>      event_ptr = (const struct inotify_event *) buffer;\n      assert(event_ptr-&gt;wd == watchfd);\n      assert(event_ptr-&gt;mask &amp; IN_CREATE);\n      if (event_ptr-&gt;len)\n        {\n          size_t i;\n</code></pre>\n\n<p>Try matching the file name against each of our patterns.</p>\n\n<pre><code>          for (i = 0; i &lt; pattern_count; ++i)\n            {\n              switch (fnmatch(patterns[i], event_ptr-&gt;name, FNM_PATHNAME))\n                {\n                case 0:\n                  /* Your application logic here... */\n                  if (printf(\"%s\\n\", event_ptr-&gt;name) &lt; 0)\n                    {\n                      errmsg = \"printf\";\n                      goto catch;\n                    }\n                  break;\n                case FNM_NOMATCH:\n                  break;\n                default:\n                  errmsg = \"fnmatch\";\n                  goto catch;\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>finally, we have to do some cleanup.  <code>close()</code>ing the file descriptors created by <em>inotify</em> will cause it to release any associated resources.</p>\n\n<pre><code> finally:\n  if (watchfd &gt;= 0)\n    {\n      int status = close(watchfd);\n      watchfd = -1;\n      if (status &lt; 0)\n        {\n          errmsg = \"close(watchfd)\";\n          goto catch;\n        }\n    }\n  if (notifyfd &gt;= 0)\n    {\n      int status = close(notifyfd);\n      notifyfd = -1;\n      if (status &lt; 0)\n        {\n          errmsg = \"close(notifyfd)\";\n          goto catch;\n        }\n    }\n  return ret;\n catch:\n  if (errmsg &amp;&amp; errno)\n    perror(errmsg);\n  ret = -1;\n  goto finally;\n}\n</code></pre>\n\n<p>And this is how we hook everything together and run the program.</p>\n\n<pre><code>int\nmain(const int argc, const char *const *const argv)\n{\n  if (argc &lt; 3)\n    {\n      fprintf(stderr, \"usage: %s DIRECTORY PATTERN...\\n\", argv[0]);\n      return EXIT_FAILURE;\n    }\n  {\n    struct sigaction sa;\n    sa.sa_handler = interruption_handler;\n    sigemptyset(&amp;sa.sa_mask);\n    sa.sa_flags = 0;\n    sigaction(SIGINT, &amp;sa, NULL);\n  }\n  if (monitor_directory(argv[1], argv + 2, argc - 2) &lt; 0)\n    return EXIT_FAILURE;\n  return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 2022, "user_id": 281617, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/20d873baa75c66bdcf8d06512ee664cc?s=128&d=identicon&r=PG", "display_name": "mousomer", "link": "https://stackoverflow.com/users/281617/mousomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2126, "favorite_count": 1, "accepted_answer_id": 28457493, "answer_count": 1, "score": 3, "last_activity_date": 1423668847, "creation_date": 1423660933, "last_edit_date": 1423663313, "question_id": 28455484, "link": "https://stackoverflow.com/questions/28455484/linux-c-notify-file-type-creation", "title": "linux C++ notify file type creation", "body": "<p>I need to monitor the creation of a specific file type (with a known extension) in a specific folder in linux. I understand that inotify will only watch existing files. Do I understand correctly?</p>\n\n<p>Is there an alternative to inotify (or similar package) that would allow me to monitor file creation by file type?</p>\n\n<p>EDIT:\nwhat I need is to monitor file creation by mask. I need to monitor a path for *.json, while disregarding other file types.</p>\n"}, {"tags": ["c", "portability"], "comments": [{"owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "edited": false, "score": 0, "creation_date": 1423661952, "post_id": 28455163, "comment_id": 45238143, "body": "relevant: <a href=\"http://stackoverflow.com/a/5660458/3079266\">stackoverflow.com/a/5660458/3079266</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1423664974, "post_id": 28455163, "comment_id": 45240175, "body": "You should research TLV (type, length, value) encoding and &#39;serialization&#39; and XDR (external data representation)."}], "answers": [{"comments": [{"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 2, "creation_date": 1423661105, "post_id": 28455321, "comment_id": 45237593, "body": "Note: your <code>if</code> condition is wrong. Even if it were true, it wouldn&#39;t be an error. An error would be indicated with <code>-1</code>."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1423661614, "post_id": 28455321, "comment_id": 45237924, "body": "@black: Good point, though I was only trying to get the general idea across. I&#39;ll fix it up a bit."}], "tags": [], "owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "is_accepted": false, "score": 5, "last_activity_date": 1423661648, "last_edit_date": 1423661648, "creation_date": 1423660491, "answer_id": 28455321, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket/28455321#28455321", "title": "How can I portably send a C struct through a network socket?", "body": "<p>Yes, there definitely <em>will</em> be portability issues.</p>\n\n<p>Alignment of structure members can be different even among different compilers <em>on the same platform</em>, let alone different platforms. And that's all assuming that <code>sizeof(int)</code> is the same across all of them (though granted, it <em>usually</em> is --- but do you really want to rely on \"usually\" and hope for the best?).</p>\n\n<p>This holds even if <code>MAX_WORD</code> is the same on both computers (I'll assume they are from here on out; if they're not, then you're in trouble here).</p>\n\n<p>What you need to do is send (and receive) each field separately. There is also a problem with <code>sizeof(int)</code> and endianness, so I've added a call to <code>htonl()</code> to convert from system to network byte order (the inverse function is <code>ntohl()</code>). They both return <code>uint32_t</code> which has a fixed, known, size.</p>\n\n<pre><code>send(sockFd, myData.max_word, sizeof(myData.max_word)); // or just MAX_WORD\nsend(sockFd, myData.min_word, sizeof(myData.min_word));\nuint32_t count = htonl(myData.word_count); // convert to network byte order\nsend(sockFd, &amp;count, sizeof(count));\n\n// error handling!\nif((ret = recv(sockFd, myData.max_word, sizeof(myData.max_word))) != sizeof(myData.max_word))\n{\n    // handle error or read more data\n}\n... // and so on\n// remember to convert back from network byte order on recv!\n// also keep in mind the third field is now `uint32_t`, and not `int` in the stream\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423660670, "post_id": 28455335, "comment_id": 45237307, "body": "I strongly disagree --- endianness is the <i>least</i> of his problems here. It is a problem, but <code>sizeof(int)</code> and structure padding (due to different alignment of <code>int</code>) are the bigger issues here."}, {"owner": {"reputation": 159, "user_id": 4546454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37447624021955d58dd0d0feb1fb6df4?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/4546454/lui"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423660922, "post_id": 28455335, "comment_id": 45237475, "body": "Ok, yes, I understand, an int on a x86 is smaller than an int on a x64 machnine. Instead of int he should use types like uint32_t or something like this."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423661093, "post_id": 28455335, "comment_id": 45237582, "body": "@Tim\u010cas How come you \u201cstrongly disagree\u201d with an answer that is a true subset of your own?  There are more portability issues than endianness and your answer covers them quite accurately but everything this answer says is correct, too."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423661129, "post_id": 28455335, "comment_id": 45237608, "body": "@Lui: Well, <i>generally</i> not on x86 vs x64 (but <code>long</code> usually is). But it can be, it depends on the compiler. This is relevant: <a href=\"http://www.viva64.com/en/t/0012/\" rel=\"nofollow noreferrer\">viva64.com/en/t/0012</a> --- one system might be ILP64 (64-bit <code>int</code>), another LLP64 (32-bit <code>int</code>) and another (think embedded) <code>I16LP32</code> (16-bit <code>int</code>)."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1423661171, "post_id": 28455335, "comment_id": 45237628, "body": "@5gon12eder: Because he&#39;s focusing on the issue which is the <i>least</i> problematic of them all, and ignoring all the other, much larger issues."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423661357, "post_id": 28455335, "comment_id": 45237744, "body": "@Lui: For a real-world case of 16-bit <code>int</code>: <code>IP16L32</code>, or an extension <code>IP16L32LL64</code> (which adds 64-bit <code>long long</code>) is the one typically used for 8-bit (and possibly 16-bit) microcontrollers. Some of those have networking capability (either builtin, or via auxiliary hardware; think Arduino w/ Ethernet shield)."}], "tags": [], "owner": {"reputation": 159, "user_id": 4546454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37447624021955d58dd0d0feb1fb6df4?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/4546454/lui"}, "is_accepted": false, "score": 1, "last_activity_date": 1423660529, "creation_date": 1423660529, "answer_id": 28455335, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket/28455335#28455335", "title": "How can I portably send a C struct through a network socket?", "body": "<p>You have to take care about the endians.</p>\n\n<p>May you should use hton() or ntoh() functions, to convert between little and big endian.</p>\n"}, {"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423661538, "post_id": 28455510, "comment_id": 45237873, "body": "It is also not standard/portable C (or C+POSIX, since we&#39;re talking sockets), plus there remain issues with <code>sizeof(int)</code>. Using packing typically also bloats the code with software unaligned reads (at least on non-x86, because the vast majority of other architectures do not support unaligned reads/writes at all; in x86, it just makes such reads slower)."}, {"owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423661869, "post_id": 28455510, "comment_id": 45238082, "body": "@Tim\u010cas: well, I&#39;m not saying this is the way to go, just that it&#39;s possible to avoid some compatibility issues this way. Also, <code>sizeof(int)</code> will probably not be a problem for OP, as he says that the client and server in his setup will be either both x86 or both x64."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423663336, "post_id": 28455510, "comment_id": 45239033, "body": "Well, technically, he said <i>some</i> 64- or 32-bit system, but yes, there are probably none around with 16-bit <code>int</code>s. <i>That said</i>, he may later decide to add a <code>long</code> or similar in a structure, and hit the problem; I was trying to address the issue more generically."}], "tags": [], "owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "is_accepted": false, "score": 0, "last_activity_date": 1423661042, "creation_date": 1423661042, "answer_id": 28455510, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket/28455510#28455510", "title": "How can I portably send a C struct through a network socket?", "body": "<p>You can use <a href=\"http://www.grok2.com/structure_packing.html\" rel=\"nofollow\"><em>structure packing</em></a>. With most C compilers, you can enforce a specific structure alignment. It is sometimes used for what you need it - to transfer a <code>struct</code> over a network.</p>\n\n<p>Note that this still leaves endianness issues, so this is not a universal solution.</p>\n"}, {"comments": [{"owner": {"reputation": 1249, "user_id": 3282758, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0cead2db887575e4e15e9b164e1c43e8?s=128&d=identicon&r=PG&f=1", "display_name": "user3282758", "link": "https://stackoverflow.com/users/3282758/user3282758"}, "edited": false, "score": 0, "creation_date": 1423664702, "post_id": 28456649, "comment_id": 45239988, "body": "Yes @Jackson you are right regarding the recv() function. In the actual code I am ensuring that the entire data is received before I start reading the individual fields."}], "tags": [], "owner": {"reputation": 5428, "user_id": 29061, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2OmsL.png?s=128&g=1", "display_name": "Jackson", "link": "https://stackoverflow.com/users/29061/jackson"}, "is_accepted": true, "score": 1, "last_activity_date": 1423664491, "creation_date": 1423664491, "answer_id": 28456649, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket/28456649#28456649", "title": "How can I portably send a C struct through a network socket?", "body": "<p>As other relies have stated there are real problems in copying a C structure between different machines with different compilers/word size/and endian structure.  One common way to resolve this issue is to transform your data into a machine independent format, transfer it across the network and then transform it back into a structure on the receiver.  This is such a common requirement that multiple technologies already exist to do this - the two that spring to my mind initially are <a href=\"http://www.cs.fsu.edu/~engelen/soap.html\" rel=\"nofollow\">gsoap</a> and <a href=\"http://docs.freebsd.org/44doc/psd/22.rpcgen/paper.pdf\" rel=\"nofollow\">rpcgen</a> although there are probably many other options.</p>\n\n<p>I've mostly used gsoap and after you get past the initial learning curve you can develop robust solutions that scale well (with multiple threads) and which handles both the networking and data translations for you.</p>\n\n<p>If you don't want to go down this route then the <strong>safest</strong> approach is to write routines that convert your data to/from a standard string format (if you have issues with Unicode you'll need to take that into account as well) and then send that across the network.  </p>\n"}, {"tags": [], "owner": {"reputation": 4787, "user_id": 1897495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2122c23f30885020650d29e19e57acbd?s=128&d=identicon&r=PG", "display_name": "Eloims", "link": "https://stackoverflow.com/users/1897495/eloims"}, "is_accepted": false, "score": 0, "last_activity_date": 1423665195, "creation_date": 1423665195, "answer_id": 28456884, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket/28456884#28456884", "title": "How can I portably send a C struct through a network socket?", "body": "<p>If you are not writing embedded software, sending data between applications without serializing properly is rarely a good idea.</p>\n\n<p>The same goes for using raw sockets, which is not very convenient, and feels a bit like \"reinventing the wheel\".</p>\n\n<p>Many libraries can help you with both! Of course, you don't have to use them, but reading their documentation, and understanding how they work will help you make better choices. Things you have not yet planned can come out of the box (like, what happens when you want to update your system, and the message format changes?)</p>\n\n<p>For serialization, have a read on those general purpose formats:</p>\n\n<ul>\n<li>Human readable: JSON, XML, YAML, others...</li>\n<li>Binary: <a href=\"http://code.google.com/p/protobuf/\" rel=\"nofollow\">Protobuf</a>, <a href=\"http://troydhanson.github.io/tpl/index.html\" rel=\"nofollow\">TPL</a>, <a href=\"http://avro.apache.org/\" rel=\"nofollow\">Avro</a>, BSON, MessagePack, and many others</li>\n</ul>\n\n<p>For socket abstraction, look up</p>\n\n<ul>\n<li>Boost ASIO</li>\n<li>ZeroMQ</li>\n<li>nanomsg</li>\n<li>Many others</li>\n</ul>\n"}], "owner": {"reputation": 1249, "user_id": 3282758, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0cead2db887575e4e15e9b164e1c43e8?s=128&d=identicon&r=PG&f=1", "display_name": "user3282758", "link": "https://stackoverflow.com/users/3282758/user3282758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 28456649, "answer_count": 5, "score": 6, "last_activity_date": 1423665195, "creation_date": 1423660022, "last_edit_date": 1423661819, "question_id": 28455163, "link": "https://stackoverflow.com/questions/28455163/how-can-i-portably-send-a-c-struct-through-a-network-socket", "title": "How can I portably send a C struct through a network socket?", "body": "<p>Suppose I have a C struct defined as follows :</p>\n\n<pre><code>typedef struct servData {\n    char max_word[MAX_WORD];\n    char min_word[MAX_WORD];\n    int word_count ;\n} servSendData ;\n</code></pre>\n\n<p>where 'MAX_WORD' could be any value.\nNow if I have an instance of this structure :</p>\n\n<pre><code>servSendData  myData ;\n</code></pre>\n\n<p>And if I populate this instance and then send it over the network, will there be any portability issues here considering that I want my server as well as the client to be running on either a 64-bit system or a 32-bit system.</p>\n\n<p>I am going to send and receive data as follows :</p>\n\n<pre><code>//server side\nstrcpy(myData.max_word, \"some large word\") ;\nstrcpy(myData.min_word, \"small\") ;\nmyData.word_count=100 ;\nsend(sockFd, (char*)&amp;myData, sizeof(myData);\n\n//client side\nrecv(sockFd, (char*)&amp;myData, sizeof(myData);\nprintf(\"large word is %s\\n\", myData.max_word) ;\nprintf(\"small word is %s\\n\", myData.min_word) ;\nprintf(\"total words is %d\\n\", myData.word_count) ;\n</code></pre>\n"}, {"tags": ["c", "callback", "sctp"], "comments": [{"owner": {"reputation": 31, "user_id": 4554417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28cfeca3174bbbdef30f1b23ef517490?s=128&d=identicon&r=PG&f=1", "display_name": "xhs", "link": "https://stackoverflow.com/users/4554417/xhs"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423660625, "post_id": 28455098, "comment_id": 45237283, "body": "I don&#39;t think so and I have added the prototype of usrsctp_socket to the question."}, {"owner": {"reputation": 31, "user_id": 4554417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28cfeca3174bbbdef30f1b23ef517490?s=128&d=identicon&r=PG&f=1", "display_name": "xhs", "link": "https://stackoverflow.com/users/4554417/xhs"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423661823, "post_id": 28455098, "comment_id": 45238048, "body": "It is reasonable, I will try it. But in official <a href=\"https://sctp-refimpl.googlecode.com/svn/trunk/KERN/usrsctp/programs/\" rel=\"nofollow noreferrer\">examples</a>, I have seen none of these casting things and they just work well."}, {"owner": {"reputation": 31, "user_id": 4554417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28cfeca3174bbbdef30f1b23ef517490?s=128&d=identicon&r=PG&f=1", "display_name": "xhs", "link": "https://stackoverflow.com/users/4554417/xhs"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423663871, "post_id": 28455098, "comment_id": 45239414, "body": "Hi, @joachim-pileborg, I have updated my question again. I still insist that it has nothing to do with the &#39;addr&#39; parameter."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4554417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28cfeca3174bbbdef30f1b23ef517490?s=128&d=identicon&r=PG&f=1", "display_name": "xhs", "link": "https://stackoverflow.com/users/4554417/xhs"}, "is_accepted": false, "score": 2, "last_activity_date": 1423727800, "creation_date": 1423727800, "answer_id": 28472145, "question_id": 28455098, "link": "https://stackoverflow.com/questions/28455098/parameter-values-of-usrsctp-data-received-callback-became-nonsense/28472145#28472145", "title": "parameter values of usrsctp data received callback became nonsense", "body": "<p>OK, I figured out why myself. It is silly but I will post the solution here in case someone would need it.</p>\n\n<p>The defination of union sctp_sockstore (type of the second parameter of the callback function) is shown below.</p>\n\n<pre><code>union sctp_sockstore {\n#if defined(INET)\n    struct sockaddr_in sin;\n#endif\n#if defined(INET6)\n    struct sockaddr_in6 sin6;\n#endif\n    struct sockaddr_conn sconn;\n    struct sockaddr sa;\n};\n</code></pre>\n\n<p>INET and INET6 are defined in usrsctp library but not in my code, since I handcrafted the Makefile and omitted them. The parameters were shifted (like 16bit) because of different sizes of the unions and so became nonsense.</p>\n\n<p>Defining INET and INET6 (especially INET6) when you compile your own code solves the problem.</p>\n"}], "owner": {"reputation": 31, "user_id": 4554417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28cfeca3174bbbdef30f1b23ef517490?s=128&d=identicon&r=PG&f=1", "display_name": "xhs", "link": "https://stackoverflow.com/users/4554417/xhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423727800, "creation_date": 1423659801, "last_edit_date": 1495540291, "question_id": 28455098, "link": "https://stackoverflow.com/questions/28455098/parameter-values-of-usrsctp-data-received-callback-became-nonsense", "title": "parameter values of usrsctp data received callback became nonsense", "body": "<p>I am recently working on a project based on <a href=\"https://sctp-refimpl.googlecode.com/svn/trunk/KERN/usrsctp/\" rel=\"nofollow noreferrer\">usrsctp</a>.</p>\n\n<p>When creating a new SCTP socket, one can specify a callback function which will be called when new data is available as shown in the code below.</p>\n\n<p>create a new SCTP socket:</p>\n\n<pre><code>struct socket *s = usrsctp_socket(AF_CONN, SOCK_STREAM, IPPROTO_SCTP,\n                                  sctp_data_received_cb, NULL, 0, sctp);\n</code></pre>\n\n<p>callback function:</p>\n\n<pre><code>static int\nsctp_data_received_cb(struct socket *sock, union sctp_sockstore addr, void *data,\n                  size_t len, struct sctp_rcvinfo recv_info, int flags, void *user_data)\n{\n  struct sctp_transport *sctp = (struct sctp_transport *)user_data;\n  if (sctp == NULL || len == 0)\n    return -1;\n\n  fprintf(stdout, \"Data of length %u received on stream %u with SSN %u, TSN %u, PPID %u\\n\",\n          (uint32_t)len,\n          recv_info.rcv_sid,\n          recv_info.rcv_ssn,\n          recv_info.rcv_tsn,\n          ntohl(recv_info.rcv_ppid));\n\n  if (flags &amp; MSG_NOTIFICATION)\n    handle_notification_message(sctp, (union sctp_notification *)data, len);\n  else\n    handle_rtcdc_message(sctp, data, len, ntohl(recv_info.rcv_ppid), recv_info.rcv_sid);\n\n  free(data);\n  return 0;\n}\n</code></pre>\n\n<p>This callback function is called properly, but its parameter values are just nonsense. Output of the code above is like</p>\n\n<p><code>Data of length 675381504 received on stream 31504 with SSN 34835, TSN 32651, PPID 8470824</code></p>\n\n<p>which should have been like</p>\n\n<p><code>Data of length 18 received on stream 0 with SSN 0, TSN 4117987333, PPID 50</code></p>\n\n<p>I read the source code of usrsctp and found where the callback is called:</p>\n\n<pre><code>if (control-&gt;spec_flags &amp; M_NOTIFICATION) {\n    flags |= MSG_NOTIFICATION;\n}\ninp-&gt;recv_callback(so, addr, buffer, control-&gt;length, rcv, flags, inp-&gt;ulp_info);\nSCTP_TCB_LOCK(stcb);\n</code></pre>\n\n<p>Change it to the code below and recompile the library</p>\n\n<pre><code>if (control-&gt;spec_flags &amp; M_NOTIFICATION) {\n    flags |= MSG_NOTIFICATION;\n}\nfprintf(stdout, \"[LIB] Data of length %u received on stream %u with SSN %u, TSN %u, PPID %u\\n\",\n        control-&gt;length,\n        rcv.rcv_sid,\n        rcv.rcv_ssn,\n        rcv.rcv_tsn,\n        ntohl(rcv.rcv_ppid));\ninp-&gt;recv_callback(so, addr, buffer, control-&gt;length, rcv, flags, inp-&gt;ulp_info);\nSCTP_TCB_LOCK(stcb);\n</code></pre>\n\n<p>I can get expected output:</p>\n\n<p><code>[LIB] Data of length 18 received on stream 0 with SSN 0, TSN 4117987333, PPID 50</code></p>\n\n<p>Why did parameter values become nonsense in the callback function?</p>\n\n<p>I have found a similar question <a href=\"https://stackoverflow.com/questions/27658266/c-usrsctp-callback-parameters-null\">here</a>, but couldn't understand its answer. I am quite sure it is the same issue.</p>\n\n<p>[update1]</p>\n\n<p>the prototype of usrsctp_socket in usrsctp.h:</p>\n\n<pre><code>struct socket *\nusrsctp_socket(int domain, int type, int protocol,\n           int (*receive_cb)(struct socket *sock, union sctp_sockstore addr, void *data,\n                             size_t datalen, struct sctp_rcvinfo, int flags, void *ulp_info),\n           int (*send_cb)(struct socket *sock, uint32_t sb_free),\n           uint32_t sb_threshold,\n           void *ulp_info);\n</code></pre>\n\n<p>[update2]</p>\n\n<p>I am quite sure that no extra tricks as suggested in <a href=\"https://stackoverflow.com/questions/27658266/c-usrsctp-callback-parameters-null\">the old similar thread</a> are needed, since I see no weird castings in the <a href=\"https://sctp-refimpl.googlecode.com/svn/trunk/KERN/usrsctp/programs/\" rel=\"nofollow noreferrer\">official examples</a> and they just work well.</p>\n\n<p>for example in echo_server.c:</p>\n\n<pre><code>static int\nreceive_cb(struct socket *sock, union sctp_sockstore addr, void *data,\n           size_t datalen, struct sctp_rcvinfo rcv, int flags, void *ulp_info)\n{\n  char namebuf[INET6_ADDRSTRLEN];\n  const char *name;\n  uint16_t port;\n\n  if (data) {\n    if (flags &amp; MSG_NOTIFICATION) {\n      printf(\"Notification of length %d received.\\n\", (int)datalen);\n    } else {\n      switch (addr.sa.sa_family) {\n#ifdef INET\n      case AF_INET:\n        name = inet_ntop(AF_INET, &amp;addr.sin.sin_addr, namebuf, INET_ADDRSTRLEN);\n        port = ntohs(addr.sin.sin_port);\n        break;\n#endif\n#ifdef INET6\n      case AF_INET6:\n        name = inet_ntop(AF_INET6, &amp;addr.sin6.sin6_addr, namebuf, INET6_ADDRSTRLEN),\n        port = ntohs(addr.sin6.sin6_port);\n        break;\n#endif\n      case AF_CONN:\n#ifdef _WIN32\n        _snprintf(namebuf, INET6_ADDRSTRLEN, \"%p\", addr.sconn.sconn_addr);\n#else\n        snprintf(namebuf, INET6_ADDRSTRLEN, \"%p\", addr.sconn.sconn_addr);\n#endif\n        name = namebuf;\n        port = ntohs(addr.sconn.sconn_port);\n        break;\n      default:\n        name = NULL;\n        port = 0;\n        break;\n      }\n      printf(\"Msg of length %d received from %s:%u on stream %d with SSN %u and TSN %u, PPID %d, context %u.\\n\",\n             (int)datalen,\n             name,\n             port,\n             rcv.rcv_sid,\n             rcv.rcv_ssn,\n             rcv.rcv_tsn,\n             ntohl(rcv.rcv_ppid),\n             rcv.rcv_context);\n      if (flags &amp; MSG_EOR) {\n        struct sctp_sndinfo snd_info;\n\n        snd_info.snd_sid = rcv.rcv_sid;\n        snd_info.snd_flags = 0;\n        if (rcv.rcv_flags &amp; SCTP_UNORDERED) {\n          snd_info.snd_flags |= SCTP_UNORDERED;\n        }\n        snd_info.snd_ppid = rcv.rcv_ppid;\n        snd_info.snd_context = 0;\n        snd_info.snd_assoc_id = rcv.rcv_assoc_id;\n        if (usrsctp_sendv(sock, data, datalen, NULL, 0, &amp;snd_info, sizeof(struct sctp_sndinfo), SCTP_SENDV_SNDINFO, 0) &lt; 0) {\n          perror(\"sctp_sendv\");\n        }\n      }\n    }\n    free(data);\n  }\n  return (1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7938, "user_id": 2101822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/evC8a.jpg?s=128&g=1", "display_name": "Milad Faridnia", "link": "https://stackoverflow.com/users/2101822/milad-faridnia"}, "edited": false, "score": 0, "creation_date": 1423660004, "post_id": 28455081, "comment_id": 45236892, "body": "so whats the problem please explian more"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1423660241, "post_id": 28455081, "comment_id": 45237032, "body": "Where is debut_liste declaration?"}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1423660580, "post_id": 28455081, "comment_id": 45237251, "body": "@LPs: <code>debut_liste</code> is a global variable."}, {"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "reply_to_user": {"reputation": 7938, "user_id": 2101822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/evC8a.jpg?s=128&g=1", "display_name": "Milad Faridnia", "link": "https://stackoverflow.com/users/2101822/milad-faridnia"}, "edited": false, "score": 0, "creation_date": 1423661072, "post_id": 28455081, "comment_id": 45237570, "body": "@Milad it always returns <code>CODE_NON_TROUVE = 0</code>"}, {"owner": {"reputation": 6673, "user_id": 4213662, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/693430827/picture?type=large", "display_name": "Persixty", "link": "https://stackoverflow.com/users/4213662/persixty"}, "edited": false, "score": 0, "creation_date": 1423663391, "post_id": 28455081, "comment_id": 45239077, "body": "You also aren&#39;t calling <code>free(.)</code> with everything you <code>malloc(.)</code>ed when you finish with it."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1423662041, "last_edit_date": 1495540699, "creation_date": 1423660793, "answer_id": 28455422, "question_id": 28455081, "link": "https://stackoverflow.com/questions/28455081/working-with-pointers-in-c/28455422#28455422", "title": "Working with pointers in C", "body": "<p>In your code,</p>\n\n<pre><code> strcpy((*pointeur).codeactuel, CODE_NON_TROUVE);\n</code></pre>\n\n<p><code>codeactuel</code> is defined to have a size of <code>10</code>, but to copy <code>CODE_NON_TROUVE</code> you need to have a size of <code>11</code>.</p>\n\n<p>Then, <code>printf(birthPlace);</code> is also wrong, it should be something like</p>\n\n<pre><code> printf(\"%s\\n\", birthPlace);\n</code></pre>\n\n<p>Also, there is a logical problem in</p>\n\n<pre><code>pointeur=undepartement();\n</code></pre>\n\n<p>if <code>malloc()</code> fails and <code>undepartement()</code> returns NULL, you'll be facing undefined behaviour by dereferencing <code>pointeur</code>. Please add a NULL check.</p>\n\n<p>P.S - There maybe other issues. Please provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> and if possible kindly stick to english so that we can understand the code logic in a better way.</p>\n"}, {"tags": [], "owner": {"reputation": 2688, "user_id": 1911652, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a013447678c2adcff7adbc4af467c4e4?s=128&d=identicon&r=PG", "display_name": "Atul", "link": "https://stackoverflow.com/users/1911652/atul"}, "is_accepted": true, "score": 0, "last_activity_date": 1423662930, "creation_date": 1423662930, "answer_id": 28456148, "question_id": 28455081, "link": "https://stackoverflow.com/questions/28455081/working-with-pointers-in-c/28456148#28456148", "title": "Working with pointers in C", "body": "<p>Inside <code>while</code> loop  you are comparing <code>.currentCode</code> with <code>.dep_name.</code> \nThis was wrong. Change the code to this:</p>\n\n<pre><code>// trouve=((strcmp(ptmp.currentCode,dep_name))==0) ;\ntrouve=((strcmp(ptmp.name,dep_name))==0) ;\n</code></pre>\n\n<p>And it works correct.</p>\n"}], "owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 28456148, "answer_count": 2, "score": 0, "last_activity_date": 1423662930, "creation_date": 1423659769, "last_edit_date": 1423662632, "question_id": 28455081, "link": "https://stackoverflow.com/questions/28455081/working-with-pointers-in-c", "title": "Working with pointers in C", "body": "<p>I have created this program in c. The user type 'lieunaissance' and then we open a formatted file to search 'lieunaissance' value.</p>\n\n<p>I had a problem with the file, but now, my problem is with my structure <code>struct departement *recherche_dpt(char recherche_code[])</code>, it always returns <code>CODE_NON_TROUVE = 0</code>.</p>\n\n<p>How should I solve this, please?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;ctype.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stddef.h&gt;\n#include &lt;errno.h&gt;\n#define MAX_dpt 100000\n#define KEY_NOT_FOND \"NOT_FOUND\"\n\n/* global statement */\nstruct departement\n{\n    char currentCode[10];\n    char oldCode[10];\n    char name[50];\n    struct departement *predecesseur ;\n    struct departement *successeur;\n};\nstruct departement *debut_liste, *fin_liste;\nstruct departement *undepartement();\nvoid ouvrir_fichier(char Nomfichier[]);\nstruct departement *search_dpt(char recherche_code[]);\nstruct departement tabdpt[MAX_dpt];\n\nint main()\n{\n    char sexe, reponse, date[5], annee[3], mois[4], bidon[3],birthPlace[30], ordre[4], struct1[6], struct2[6],nir1[12],nir[13],nir2[13], nirancien[13] ;\n    int i, namebre, cle, reste,n;\n    long int val;\n\n    struct departement undpt, *pointeur;\n    char code[10];\n\n    scanf(\"%s\",birthPlace);\n\n    // convert birthplace uppercase and assign it to name\n    int k = 0;\n    while(birthPlace[k])\n    {\n        birthPlace[k] = toupper(birthPlace[k]);\n        k++;\n    }\n    printf(\"%s\\n\", birthPlace);\n\n    // Read in the file\n    ouvrir_fichier(\"Basedecommunes.txt\");\n    pointeur=search_dpt(birthPlace);\n    undpt = *pointeur;\n\n    if (strcmp(undpt.currentCode,KEY_NOT_FOND)==0)\n    {\n        printf(\"No \"\"%s\"\" has been found \\n\",birthPlace);\n    }\n    else\n    {\n        printf(\"Current code   : %s\\n\",undpt.currentCode);\n        printf(\"Old code   : %s\\n\",undpt.oldCode);\n        printf(\"Department name    : %d\\n\",undpt.name);\n    }\n\n\n    void ouvrir_fichier(char Nomfichier[])\n    {\n        struct departement *ptmp, *prec, *succ;\n        FILE *f1;\n        int nb, lire;\n\n        nb=0;\n        f1=fopen(Nomfichier, \"r\" );\n        if (f1 == NULL) {\n            printf(\"fopen failed, errno = %d\\n\", errno);\n        }\n        else {\n            printf(\"fopen succeeded\\n\");\n\n            while ((! feof(f1)) &amp;&amp; (nb &lt; MAX_dpt) )\n            {\n                ptmp=undepartement();\n                if (ptmp != NULL) {\n\n                    lire=fscanf (f1, \"%s %s %s\", (*ptmp).currentCode, (*ptmp).oldCode, (*ptmp).name);\n                    printf(\"lire = %d\\n\",lire);\n                    if (lire != EOF)\n                    {\n                        (*ptmp).predecesseur=NULL ;\n                        (*ptmp).successeur=NULL;\n\n                        if (debut_liste == NULL)\n                        {\n                            debut_liste=ptmp ;\n                            fin_liste=ptmp ;\n                        }\n                        else\n                        {\n                            (*fin_liste).successeur=ptmp   ;\n                            (*ptmp).predecesseur=fin_liste ;\n                            fin_liste=ptmp               ;\n                        }\n                        nb++ ;\n                    }\n                } else {\n                    printf(\"malloc error\\n\");\n                }\n            }\n\n        }\n\n        fclose(f1);\n    }\n\n\n    /*--- fonction de recherche --- */\n    struct departement *search_dpt(char dep_name[])\n    {\n        struct departement ptmp, *pointeur, *pactu;\n        int trouve ;\n\n        trouve = 0 ;\n\n        pointeur=undepartement();\n\n        strcpy((*pointeur).currentCode, KEY_NOT_FOND);\n\n        pactu=debut_liste ;\n        while ((! trouve) &amp;&amp; (pactu != NULL))\n        {\n            ptmp = (*pactu) ;\n            pactu=(*pactu).successeur ;\n\n            trouve=((strcmp(ptmp.currentCode,dep_name))==0) ;\n\n            if (trouve)\n            {\n                *pointeur=ptmp ;\n            }\n        }\n\n        return pointeur;\n\n    }\n\n    /* --- allocation memoire d'une nouvelle structure --- */\n    struct departement * undepartement(void)\n    {\n        struct departement *p = malloc(sizeof *p);\n        return p;\n    }\n</code></pre>\n\n<p>The file content:</p>\n\n<pre><code>01001   01001   ABERGEMENT-CLEMENCIAT\n01002   01002   ABERGEMENT-DE-VAREY\n01003   01003   AMAREINS\n01004   01004   AMBERIEU-EN-BUGEY\n01005   01005   AMBERIEUX-EN-DOMBES\n01006   01006   AMBLEON\n01007   01007   AMBRONAY\n01008   01008   AMBUTRIX\n01009   01009   ANDERT-ET-CONDON\n01010   01010   ANGLEFORT\n01011   01011   APREMONT\n01012   01012   ARANC\n01013   01013   ARANDAS\n01014   01014   ARBENT\n01015   01015   ARBIGNIEU\n01016   01016   ARBIGNY\n</code></pre>\n"}, {"tags": ["c", "asterisk", "sip", "asteriskami", "agi"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3254652, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cb7082e981c25bbdf696069476d7717d?s=128&d=identicon&r=PG&f=1", "display_name": "Raghuvendra Kumar", "link": "https://stackoverflow.com/users/3254652/raghuvendra-kumar"}, "edited": false, "score": 0, "creation_date": 1423727917, "post_id": 28465360, "comment_id": 45268365, "body": "It worked like a charm. Thanks for the support. One more query,  If i want to do the same thing in with AMI do i need to use bridge action:- api.BridgeAction bc= new BridgeAction(A-Party-Channel, B-Party-Channel, false) - for connecting party. How to connect to the queue using AMI"}, {"owner": {"reputation": 14851, "user_id": 861388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e67c6ded563e65de617062d3c47d79c2?s=128&d=identicon&r=PG", "display_name": "arheops", "link": "https://stackoverflow.com/users/861388/arheops"}, "reply_to_user": {"reputation": 87, "user_id": 3254652, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cb7082e981c25bbdf696069476d7717d?s=128&d=identicon&r=PG&f=1", "display_name": "Raghuvendra Kumar", "link": "https://stackoverflow.com/users/3254652/raghuvendra-kumar"}, "edited": false, "score": 0, "creation_date": 1423823015, "post_id": 28465360, "comment_id": 45314182, "body": "If you use dial command, it will bridge automaticaly on answer. Otherwise - depend of method. Use channelredirect to redirect other dialplan extension(including queue)"}], "tags": [], "owner": {"reputation": 14851, "user_id": 861388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e67c6ded563e65de617062d3c47d79c2?s=128&d=identicon&r=PG", "display_name": "arheops", "link": "https://stackoverflow.com/users/861388/arheops"}, "is_accepted": false, "score": 2, "last_activity_date": 1423691970, "creation_date": 1423691970, "answer_id": 28465360, "question_id": 28454747, "link": "https://stackoverflow.com/questions/28454747/how-to-route-incoming-call-to-queue-of-agents-though-agi-c-program-in-asterisk/28465360#28465360", "title": "How to route incoming call to queue of agents though AGI C Program in Asterisk", "body": "<p>You can use dial with Local channel to dialplan like this</p>\n\n<pre><code>Dial(Local/7001@Queues,,n)\n</code></pre>\n\n<p>or in AGI </p>\n\n<pre><code>fprintf(stdout,\"EXEC Dial \\\"Local/7001@Queues,50\\\"\\n\");\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3254652, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/cb7082e981c25bbdf696069476d7717d?s=128&d=identicon&r=PG&f=1", "display_name": "Raghuvendra Kumar", "link": "https://stackoverflow.com/users/3254652/raghuvendra-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2891, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423729403, "creation_date": 1423658772, "question_id": 28454747, "link": "https://stackoverflow.com/questions/28454747/how-to-route-incoming-call-to-queue-of-agents-though-agi-c-program-in-asterisk", "title": "How to route incoming call to queue of agents though AGI C Program in Asterisk", "body": "<p>I am using AGI in C Language for a basic Call Centre Setup in Asterisk</p>\n\n<pre><code>[PUNDIT]\nexten =&gt;92186,1,agi(Pundit/PunditBin)\nexten=&gt;92186,2,Hangup\n</code></pre>\n\n<p>PunditBin is a C application. On receiving the call the app dail Agent SIP URI directly and it works (Agent Phone Rings).</p>\n\n<pre><code>fprintf(stdout,\"EXEC Dial SIP/%s,50\\n\",Free_Pundit);\n</code></pre>\n\n<p>But the problem is that i have to include the ACD logic in the app itself. However, I want to use Asterisk Queue and ACD mechanism. </p>\n\n<p>I have configured the Asterisk ACD in following manner:-</p>\n\n<pre><code>**queues.conf:-**\n\n[exchat_pundit]\nmusicclass=default       ; play [default] music\nstrategy=rrmemory        ; use the Round Robin Memory strategy\njoinempty=no             ; do not join the queue when no members available\nleavewhenempty=yes       ; leave the queue when no members available\nringinuse=no             ; don't ring members when already InUse (prevents\ncontext=QueueMemberFunctions\n\n**Extension.conf**\n//Moving the call to Queue of agents\n[Queues]\nexten =&gt; 7001,1,Verbose(2,${CALLERID(all)} entering the chat Pundit queue)\nsame =&gt; n,Queue(exchat_pundit)\nsame =&gt; n,Hangup()\n\n\n\n[LocalSets]\ninclude =&gt; Queues      ; allow phones to call queues\n\n//Agent Registration, Pause etc..\n[QueueMemberFunctions]\n\nexten =&gt; *54,1,Verbose(2,Logging In Queue Member)\n   same =&gt; n,Set(MemberChannel=${CHANNEL(channeltype)}/${CHANNEL(peername)})\n   same =&gt; n,AddQueueMember(exchat_pundit,${MemberChannel})\n\n; ${AQMSTATUS}\n;   ADDED\n;   MEMBERALREADY\n;   NOSUCHQUEUE\n\nexten =&gt; *56,1,Verbose(2,Logging Out Queue Member)\n   same =&gt; n,Set(MemberChannel=${CHANNEL(channeltype)}/${CHANNEL(peername)})\n   same =&gt; n,RemoveQueueMember(exchat_pundit,${MemberChannel})\n\n; ${RQMSTATUS}:\n;    REMOVED\n;    NOTINQUEUE\n;    NOSUCHQUEUE\n\nexten =&gt; *72,1,Verbose(2,Pause Queue Member)\n   same =&gt; n,Set(MemberChannel=${CHANNEL(channeltype)}/${CHANNEL(peername)})\n   same =&gt; n,PauseQueueMember(exchat_pundit,${MemberChannel})\n\n; ${PQMSTATUS}:\n;     PAUSED\n;     NOTFOUND\n\nexten =&gt; *87,1,Verbose(2,Unpause Queue Member)\n   same =&gt; n,Set(MemberChannel=${CHANNEL(channeltype)}/${CHANNEL(peername)})\n   same =&gt; n,UnpauseQueueMember(exchat_pundit,${MemberChannel})\n\n; ${UPQMSTATUS}:\n;     UNPAUSED\n;     NOTFOUND\n\n\n**Sip.conf:-**\n\n//Agents \n[ABC]\ntype=friend; 'user' takes incoming calls\nsecret=welcome ; password for authenticating the user\nnat=yes\ndisallow=all ; Disallow all codecs for this peer or user definition.\nallow=speex\nallow=gsm\nallow=ulaw\nallow=alaw\nhost=dynamic ; what kind of host you are dealing with and the value .dynamic.\ncontext=QueueMemberFunctions; this is what ties up the Asterisk SIP user with the dialplan in\nusername=ABC; this field specifies the user name for authentication.\nregexten=ABC;\n\n\n[XYZ]\ntype=friend; 'user' takes incoming calls\nsecret=welcome ; password for authenticating the user\ndisallow=all ; Disallow all codecs for this peer or user definition.\nallow=speex\nallow=gsm\nallow=ulaw\nallow=alaw\nhost=dynamic \ncontext=QueueMemberFunctions\nusername=XYZ; \nregexten=XYZ;\n</code></pre>\n\n<p>Now when i make a call to extension 7001 using a sip phone directly, my call is sent to the agent in round robin manner it works per fine.</p>\n\n<p>Problem is when i dial the extension 7001 from my C code as following, it does not work.</p>\n\n<pre><code>fprintf(stdout,\"EXEC Dial 7001,50\\n\");\n</code></pre>\n\n<p>I am not able to send the incoming call to queue of agents. </p>\n\n<p>Please help me to resolve the issue.</p>\n\n<p>Regards,\nRaghuvendra Kumar</p>\n"}, {"tags": ["c", "linux", "function", "fork", "waitpid"], "comments": [{"owner": {"reputation": 1718, "user_id": 3791842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98W7v.jpg?s=128&g=1", "display_name": "Daniel Kleinstein", "link": "https://stackoverflow.com/users/3791842/daniel-kleinstein"}, "edited": false, "score": 0, "creation_date": 1423659246, "post_id": 28454645, "comment_id": 45236520, "body": "What do you mean by &quot;creates parent first&quot;? The parent process is the process being run, it has to exist in order for the children to be created. Could you include your output?"}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 1749566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BU4GG.jpg?s=128&g=1", "display_name": "Snaipe", "link": "https://stackoverflow.com/users/1749566/snaipe"}, "is_accepted": false, "score": 1, "last_activity_date": 1423659933, "creation_date": 1423659933, "answer_id": 28455140, "question_id": 28454645, "link": "https://stackoverflow.com/questions/28454645/parent-and-multiple-chilrend-pid-fork-waitpid-functions/28455140#28455140", "title": "Parent and multiple chilrend PID. Fork &amp; waitpid - functions", "body": "<p>From <code>waitpid(2)</code>'s <a href=\"http://linux.die.net/man/2/waitpid\" rel=\"nofollow\">manpage</a>:</p>\n\n<blockquote>\n  <p>The value of pid can be: [...] -1 meaning wait for any child process.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>waitpid(): on success, returns the process ID of the child whose state has changed; [...]</p>\n</blockquote>\n\n<p>This means that you can simply loop on waitpid at the end of your main like so:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define FORKED_CHILDREN 2\n\nif (pid != 0 &amp;&amp; pid != -1) {\n    for (int collected = 0; collected &lt; FORKED_CHILDREN; ++collected) {\n        pid_t cpid = waitpid(-1, NULL, 0);\n        printf(\"Child pid: %d\\n\", cpid);\n    }\n    printf(\"parent pid = %d\\n\", getpid());\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3665673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7c26d21ffb2b72a1f9168c272711c2?s=128&d=identicon&r=PG&f=1", "display_name": "Tanhua", "link": "https://stackoverflow.com/users/3665673/tanhua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2862, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423659933, "creation_date": 1423658508, "question_id": 28454645, "link": "https://stackoverflow.com/questions/28454645/parent-and-multiple-chilrend-pid-fork-waitpid-functions", "title": "Parent and multiple chilrend PID. Fork &amp; waitpid - functions", "body": "<p>I'm having problems with fork/waitpid functions.</p>\n\n<p>I'm trying to make program what first processes and prints children PIDS and after that Parent PID</p>\n\n<p>My code:</p>\n\n<pre><code>int main(void)\n{\n    pid_t pid;\n    int rv = 0;\n    int i = 1;\n    pid_t child_pids[2];\n\n    for (i = 0; i &lt; 2; i++)\n    {\n\n        switch (pid = fork())\n        {\n        case -1:\n            perror(\"fork\");\n            exit(1);\n\n        case 0:\n            pid = getpid();\n            exit(i);\n            break;\n\n        default:\n            child_pids[i] = pid;\n            break;\n        }\n    }\n    if (pid != 0 &amp;&amp; pid != -1) {\n        for (i = 0; i&lt;2; i++){\n            int status = 0;\n            printf(\"PARENT: waiting for child %d (%d)\\n\", i, child_pids[i]);\n            rv = waitpid(child_pids[i], &amp;status, 0);\n            printf(\"Child: %d, Here!!!\\n\", i);\n\n        }\n        printf(\"parent pid = %d\\n\", getpid());\n\n    }\n}\n</code></pre>\n\n<p>Currently it creates parent first and after that children.. So Someone have any tips what to do?</p>\n"}, {"tags": ["c", "arrays", "sizeof"], "comments": [{"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 4, "creation_date": 1423658558, "post_id": 28454612, "comment_id": 45236116, "body": "<code>sizeof(c)</code> is a compile-time constant, not a runtime calculated value."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 2, "creation_date": 1423659003, "post_id": 28454612, "comment_id": 45236378, "body": "Side-note: You should use <code>&quot;%zu&quot;</code>, not  <code>&quot;%lu&quot;</code> for <code>size_t</code> (which is the type that <code>sizeof()</code> returns). Your code, as is, will be UB in 64-bit Windows and a few POSIX systems (because <code>size_t</code> is 64-bit, but <code>long unsigned int</code> is 32-bit)."}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 4, "creation_date": 1423659226, "post_id": 28454612, "comment_id": 45236510, "body": "<a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Please don&#39;t cast the return value of <code>malloc()</code> in C</a>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1423664892, "post_id": 28454612, "comment_id": 45240115, "body": "It&#39;s a 64-bit pointer.  I dont need to look at the code or any other comments/amswers."}], "answers": [{"tags": [], "owner": {"reputation": 7313, "user_id": 109960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f6830f73ecf9a6bda6d1fe61f2655cf0?s=128&d=identicon&r=PG", "display_name": "Eric Fortin", "link": "https://stackoverflow.com/users/109960/eric-fortin"}, "is_accepted": true, "score": 8, "last_activity_date": 1423662826, "last_edit_date": 1423662826, "creation_date": 1423658488, "answer_id": 28454641, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454641#28454641", "title": "Why am I getting 8 always?", "body": "<p>At the moment you are asking for the size of a pointer which on a 64 bits machine is 8 bytes. Since this is a <code>malloc</code> and not a real array, you can't retrieve the size of the buffer allocated through <code>c</code>.</p>\n\n<p>If <code>c</code> was declared as</p>\n\n<pre><code>char c[30];\n</code></pre>\n\n<p>You could determine size with</p>\n\n<pre><code>size_t size = sizeof(c)/sizeof(c[0])\n</code></pre>\n\n<p>But to be honest if I had to do that, I would just <code>#define</code> the array size even though the size calculation would be stripped out at compilation. It makes the code clearer in my opinion.</p>\n"}, {"tags": [], "owner": {"reputation": 47334, "user_id": 41761, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/cec45d2a15c1af0ac05f7f069048e1f4?s=128&d=identicon&r=PG", "display_name": "Eimantas", "link": "https://stackoverflow.com/users/41761/eimantas"}, "is_accepted": false, "score": 0, "last_activity_date": 1423658560, "creation_date": 1423658560, "answer_id": 28454668, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454668#28454668", "title": "Why am I getting 8 always?", "body": "<p><code>sizeof</code> is an operator, not a function, thus the compiler creates the code equivalent to something like <code>sizeof(char *)</code> and pointer of a char (depending on the architecture of course) is of 8 bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 4549502, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152500551471642/picture?type=large", "display_name": "Henk Kok", "link": "https://stackoverflow.com/users/4549502/henk-kok"}, "is_accepted": false, "score": 0, "last_activity_date": 1423658628, "creation_date": 1423658628, "answer_id": 28454699, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454699#28454699", "title": "Why am I getting 8 always?", "body": "<p>Actually sizeof(*c) will return 1. The size of a mallocced buffer cannot be determined compile time (which is what sizeof does).</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 3863476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccdb393302c40d5fdef357464e09db44?s=128&d=identicon&r=PG&f=1", "display_name": "DieMartin", "link": "https://stackoverflow.com/users/3863476/diemartin"}, "is_accepted": false, "score": 3, "last_activity_date": 1604424001, "last_edit_date": 1604424001, "creation_date": 1423658682, "answer_id": 28454712, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454712#28454712", "title": "Why am I getting 8 always?", "body": "<p>You are printing the size of a <code>char *</code> which in your system is 8.</p>\n<p>If you want to know the amount of memory that was &quot;malloc&quot;ed you must store it somewhere. In your case your should store the <code>30</code> for future use if you are going to need it.</p>\n"}, {"tags": [], "owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1561392121, "last_edit_date": 1561392121, "creation_date": 1423658695, "answer_id": 28454720, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454720#28454720", "title": "Why am I getting 8 always?", "body": "<p>You're getting the size of the variable <code>c</code>, not the size of the memory region it points to. There's no way to get the size of an array inside a function because it always decays to pointer. You must store the size yourself. If you've passed the size to <code>malloc</code> then why can't you store that size to a variable?</p>\n"}, {"comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1423660049, "post_id": 28454734, "comment_id": 45236920, "body": "Also, the actual allocated memory may be larger, so even if there were a function like <code>memlen</code>, it would be pretty much useless. For example, it might round up to a multiple of some <code>N</code> for alignment purposes. Not that you should rely on that in code, of course (if you need <code>k</code> more bytes, ask for <code>k</code> more bytes!)."}], "tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1423659899, "last_edit_date": 1423659899, "creation_date": 1423658730, "answer_id": 28454734, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always/28454734#28454734", "title": "Why am I getting 8 always?", "body": "<p><code>sizeof(c)</code> means give me the size of the variable <code>c</code>. Since <code>c</code> is a pointer it's giving you back the number of bytes that the pointer takes up in memory. The fact you're seeing 8 suggests you're compiling for 64bit. On a 32bit built it would be 4.</p>\n\n<p>It's your job to remember the size of the thing you've allocated. After all, you asked for an amount of memory, so you do know how much you allocated! In your case, <code>size_t size = 30*sizeof(char)</code> will give you the amount you've allocated.</p>\n"}], "owner": {"reputation": 53, "user_id": 2582701, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d4d3c357f5ea9f688060f9acf482938d?s=128&d=identicon&r=PG", "display_name": "mit23", "link": "https://stackoverflow.com/users/2582701/mit23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 28454641, "answer_count": 6, "score": 0, "last_activity_date": 1604424001, "creation_date": 1423658428, "last_edit_date": 1423658471, "question_id": 28454612, "link": "https://stackoverflow.com/questions/28454612/why-am-i-getting-8-always", "title": "Why am I getting 8 always?", "body": "<pre><code>char *c = (char *)malloc(30*sizeof(char));\nprintf(\"%lu \\n\",sizeof(c));\n</code></pre>\n\n<p>In the above code I am trying to print the size of 'c'. No matter what number I give instead of '30' in the code, I get the sizeof(c) as 8.</p>\n\n<p>What is the problem? How can I determine the size of an array?</p>\n\n<p>Is length and size the same for an array?</p>\n"}, {"tags": ["c", "arrays", "int"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4134403, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1f02c8b775260d68799a86683874a36f?s=128&d=identicon&r=PG&f=1", "display_name": "bhroask", "link": "https://stackoverflow.com/users/4134403/bhroask"}, "edited": false, "score": 0, "creation_date": 1423658638, "post_id": 28454614, "comment_id": 45236177, "body": "Thank you for the advice :)"}, {"owner": {"reputation": 27, "user_id": 4134403, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1f02c8b775260d68799a86683874a36f?s=128&d=identicon&r=PG&f=1", "display_name": "bhroask", "link": "https://stackoverflow.com/users/4134403/bhroask"}, "edited": false, "score": 0, "creation_date": 1423658795, "post_id": 28454614, "comment_id": 45236270, "body": "Would there be any other way that brings a similar result?"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 27, "user_id": 4134403, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1f02c8b775260d68799a86683874a36f?s=128&d=identicon&r=PG&f=1", "display_name": "bhroask", "link": "https://stackoverflow.com/users/4134403/bhroask"}, "edited": false, "score": 0, "creation_date": 1423658847, "post_id": 28454614, "comment_id": 45236294, "body": "@bhroask Else you can set the whole array to <code>0</code> using <code>memset(array,0,sizeof(array)</code>"}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 1, "last_activity_date": 1423659004, "last_edit_date": 1423659004, "creation_date": 1423658433, "answer_id": 28454614, "question_id": 28454602, "link": "https://stackoverflow.com/questions/28454602/get-a-certain-number-of-elements-into-an-array/28454614#28454614", "title": "Get a certain number of elements into an Array", "body": "<pre><code>for (i = 0; i &lt;= SIZE; ++i)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>for (i = 0; i &lt; SIZE; ++i)\n</code></pre>\n\n<p>Else you have array out of bound access which will lead to undefined behavior.</p>\n\n<pre><code>for (i = 0; i &lt; SIZE; ++i)\n{\n  if(fscanf(ifp, \"%d\", &amp;inputArray[i]) != 1)\n  break;\n}\n</code></pre>\n\n<p>Set all elements to 0 using </p>\n\n<pre><code>memset(array,0,sizeof(array));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1423658526, "creation_date": 1423658526, "answer_id": 28454652, "question_id": 28454602, "link": "https://stackoverflow.com/questions/28454602/get-a-certain-number-of-elements-into-an-array/28454652#28454652", "title": "Get a certain number of elements into an Array", "body": "<p>You can check the return value of <code>fscanf()</code> and once it returns failure [return <code>!=1</code>], you should stop scanning anymore. </p>\n\n<p>Further, you can use that <code>i-1</code> value for printing <em>valid</em> elements.</p>\n\n<p>Also, you should change your loop limit to <code>i &lt; SIZE</code> to avoid off-by-one error.</p>\n\n<p>Then, you can initialize the local variables to avoid them having garbage values. You can use <code>memeset()</code> or initializer-lists to get that part done.</p>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 1554502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3978eb75534e71eb5e14be5c8645356a?s=128&d=identicon&r=PG", "display_name": "Konstantin.Krivyakin", "link": "https://stackoverflow.com/users/1554502/konstantin-krivyakin"}, "is_accepted": false, "score": 0, "last_activity_date": 1423658624, "creation_date": 1423658624, "answer_id": 28454698, "question_id": 28454602, "link": "https://stackoverflow.com/questions/28454602/get-a-certain-number-of-elements-into-an-array/28454698#28454698", "title": "Get a certain number of elements into an Array", "body": "<p>Don't define SIZE, make it a variable that will contains real count of number in file after reading.</p>\n\n<pre><code>size_t SIZE = 0;\nfor (SIZE = 0; ; ++SIZE)\n{\n    if (fscanf(ifp, \"%d\", &amp;inputArray[i]) == EOF)\n        break;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4134403, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1f02c8b775260d68799a86683874a36f?s=128&d=identicon&r=PG&f=1", "display_name": "bhroask", "link": "https://stackoverflow.com/users/4134403/bhroask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1423659004, "creation_date": 1423658392, "question_id": 28454602, "link": "https://stackoverflow.com/questions/28454602/get-a-certain-number-of-elements-into-an-array", "title": "Get a certain number of elements into an Array", "body": "<p>This is my code so far:</p>\n\n<pre><code>#include \"stdafx.h\"\n\n#define SIZE 200\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n\nFILE * ifp = NULL;\nint inputArray[SIZE];\nint i, j;\nint c;\n\nifp = fopen(\"testfile.txt\", \"r\");\n\nfor (i = 0; i &lt;= SIZE; ++i)\n    fscanf(ifp, \"%d\", &amp;inputArray[i]);\n/*fscanf(ifp, \"%d\", */\n\nfor (i = 0; i &lt;= SIZE; i++)\n    printf(\"%d\", inputArray[i]);\nreturn 0;\n\n\n}\n</code></pre>\n\n<p>So I have a file that has nnumbers in it like:<br>\n3<br>\n5 5 3<br>\n6<br>\n3 2 6 4 1 1<br></p>\n\n<p>The code above seems to work in getting the numbers into an array like 3 5 5 3 6 3 2...etc.\nBut then, the array size is 200. So the rest of the space not used in the array isn't just blank. It has a huge, weird numbers in it\nso when I print it out, it it prints \n35536326411 -858993460 -858993460\nit prints that -858993460 to what I assume is about 200 times.</p>\n\n<p>I'm a total noob in C and in programming. I asked the professor about the array size and he said just set it to a large number like 100 or 200 because trying to set the size of the array to a variable that can be changed (or something to that concept) is complicating and isn't at our level quite yet. </p>\n\n<p>I need to do math with these numbers and I don't want to include those -858993460 things in my calculations. How would I determine where in the array is the last element that was actually declared? \nSomeone please point me into the right direction...</p>\n"}, {"tags": ["c", "linux", "assembly", "module", "linux-kernel"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423657628, "post_id": 28454234, "comment_id": 45235587, "body": "You can post code directly on SO. Please do it, I cannot open the links."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423659809, "post_id": 28454234, "comment_id": 45236789, "body": "@teseter123 post the code in the question body, click edit and add it, indent it with 4 spaces to make the system highlight it."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1423672303, "post_id": 28454234, "comment_id": 45245088, "body": "Are you sure it&#39;s wise to identify the file by the user-submitted filename? What if the user <code>open()</code>s <code>.&#47;test</code> instead of <code>test</code>?"}, {"owner": {"reputation": 1, "user_id": 4554671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b23e424da280a2334da878eae3cff9?s=128&d=identicon&r=PG&f=1", "display_name": "tester123", "link": "https://stackoverflow.com/users/4554671/tester123"}, "edited": false, "score": 0, "creation_date": 1423672459, "post_id": 28454234, "comment_id": 45245190, "body": "stupid error... while opening with gedit, filename = path/to/filename."}], "owner": {"reputation": 1, "user_id": 4554671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b23e424da280a2334da878eae3cff9?s=128&d=identicon&r=PG&f=1", "display_name": "tester123", "link": "https://stackoverflow.com/users/4554671/tester123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423662016, "creation_date": 1423657237, "last_edit_date": 1423662016, "question_id": 28454234, "link": "https://stackoverflow.com/questions/28454234/file-access-control-in-linux", "title": "File access control in linux", "body": "<p>I`m writing a module to control file access. I'm now trying to implement the prohibition of file opening. <br>I've already tried are kernel module system open overload: <a href=\"http://pastebin.com/JWKbpFYT\" rel=\"nofollow\">http://pastebin.com/JWKbpFYT</a> \nI've also tried system read overload: <a href=\"http://pastebin.com/psK8vX41\" rel=\"nofollow\">http://pastebin.com/psK8vX41</a>\nThe problem in the first one is that I could restrict access to target file only in console (it didn't work in graphical interface, e.g. gedit).\nThe second one didn't work as the system stopped responding on running gedit with target file. <br>\nHow can I prohibit file opening without using SELinux?<br></p>\n\n<pre><code>asmlinkage int custom_open(const char __user *file_name, int flags, mode_t mod)\n{\n   printk(\"hook: open(\\\"%s\\\")\", file_name);\n   if (!strcmp(file_name, \"test\"))\n       return -1;\n   return original_open(file_name, flags, mod);\n}\n\nstruct file *fget(unsigned int fd)\n{\n struct file *file;\n struct files_struct *files = current-&gt;files;\n\n rcu_read_lock();\n file = fcheck_files(files, fd);\n if (file) {\n         /* File object ref couldn't be taken */\n         if (file-&gt;f_mode &amp; FMODE_PATH ||\n             !atomic_long_inc_not_zero(&amp;file-&gt;f_count))\n                 file = NULL;\n }\n rcu_read_unlock();\n\n return file;\n</code></pre>\n\n<p>}</p>\n\n<pre><code>asmlinkage int custom_read(int fd, void *buf, size_t noct)\n{\n   struct file *filp = fget(fd);\n   unsigned char f_name[DNAME_INLINE_LEN];\n   strcpy(f_name,filp-&gt;f_path.dentry-&gt;d_name.name);\n   if (!strcmp(f_name, \"_ttt.c\")){\n        printk(\"hook1: read fd=(%d: -&gt; %s)\\n\",fd,f_name);\n        return -1;\n }\n return original_read(fd, buf, noct);\n}\n</code></pre>\n"}, {"tags": ["c", "posix", "msvc12"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423657439, "post_id": 28454158, "comment_id": 45235480, "body": "there is no such thing as <code>plain c</code> it&#39;s just c. don&#39;t write <code>c&#47;c++</code> you can instead write <code>c and&#47;or c++</code> or something similar, there are very important differences between the two languages, it&#39;s NOT like <code>c++</code> is just <code>c</code> with classes and templates."}, {"owner": {"reputation": 4127, "user_id": 4231385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89a541a4609cafea3957e4cdfcca50f?s=128&d=identicon&r=PG&f=1", "display_name": "cremno", "link": "https://stackoverflow.com/users/4231385/cremno"}, "edited": false, "score": 0, "creation_date": 1423657601, "post_id": 28454158, "comment_id": 45235575, "body": "You believe? Did you check the parameters? There&#39;s no difference between <code>read()</code> and <code>_read()</code>."}, {"owner": {"reputation": 39446, "user_id": 4301306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a1461d0104809c90e2a252a2d4b0ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/4301306/wintermute"}, "edited": false, "score": 1, "creation_date": 1423657772, "post_id": 28454158, "comment_id": 45235674, "body": "You can make the warning disappear by adding <code>_CRT_NONSTDC_NO_DEPRECATE=1</code> to the preprocessor definitions ( see <a href=\"https://msdn.microsoft.com/en-us/library/ms235384.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms235384.aspx</a> ). <code>read</code> and <code>_read</code> should behave exactly the same, so if replacing one with the other does something for you, you&#39;re probably chasing some (possibly) unrelated UB."}, {"owner": {"reputation": 8031, "user_id": 143091, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c096715708403c3711af16fb490319f1?s=128&d=identicon&r=PG", "display_name": "jdm", "link": "https://stackoverflow.com/users/143091/jdm"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423658659, "post_id": 28454158, "comment_id": 45236186, "body": "@iharob: I&#39;m aware of that (especially that C is not just a subset of C++). I am using C here, not C++. But the C standard function <code>read</code> behaves strangely for me under MSVC, and MSDN tells me to use what it calls the &quot;ISO C++ function&quot; <code>_read</code> <i>in my C program</i>. The point is that Microsoft&#39;s compiler and documentation mixes up C and C++. It&#39;s not my confusion, but that of MSVC."}, {"owner": {"reputation": 5064, "user_id": 1741125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/263d60d37f25bf7f29b3552785fb3efb?s=128&d=identicon&r=PG", "display_name": "mafso", "link": "https://stackoverflow.com/users/1741125/mafso"}, "edited": false, "score": 0, "creation_date": 1423667750, "post_id": 28454158, "comment_id": 45242027, "body": "As far as I know, <code>_read</code> is not part of C++. I guess &quot;ISO C++ conformant&quot; means using a reserved identifier. As <code>&lt;unistd.h&gt;</code> isn&#39;t a C++ standard header, I don&#39;t see how an unreserved identifier can become an issue, however (wrt C++ conformance)."}, {"owner": {"reputation": 5064, "user_id": 1741125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/263d60d37f25bf7f29b3552785fb3efb?s=128&d=identicon&r=PG", "display_name": "mafso", "link": "https://stackoverflow.com/users/1741125/mafso"}, "edited": false, "score": 1, "creation_date": 1423668073, "post_id": 28454158, "comment_id": 45242256, "body": "For the <code>#define</code>: It&#39;s probably better to use a static wrapper function (if it turns out to be better to use the non-POSIX <code>_read</code> on Windows). <code>read</code> (a rather common word) could easily be some member function or declared in some other namespace, a macro would also expand e.g. for <code>foo.read()</code> or <code>foo::read()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1423657276, "creation_date": 1423657276, "answer_id": 28454241, "question_id": 28454158, "link": "https://stackoverflow.com/questions/28454158/deprecated-posix-function-read-raises-an-exception/28454241#28454241", "title": "&quot;deprecated POSIX function&quot; `read` raises an exception", "body": "<blockquote>\n  <p>Can I just <code>#define read _read</code> and so on, and expect it to work just like on Linux?</p>\n</blockquote>\n\n<p>Yes, just do it, it will solve the problem, and your code will be cross platform, just remember that there are other functions with the same issue.</p>\n"}], "owner": {"reputation": 8031, "user_id": 143091, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/c096715708403c3711af16fb490319f1?s=128&d=identicon&r=PG", "display_name": "jdm", "link": "https://stackoverflow.com/users/143091/jdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1423657276, "creation_date": 1423656985, "question_id": 28454158, "link": "https://stackoverflow.com/questions/28454158/deprecated-posix-function-read-raises-an-exception", "title": "&quot;deprecated POSIX function&quot; `read` raises an exception", "body": "<p>I am compiling a cross-platform C library (which works fine on Linux, and used to work on Windows) with MSVC (VS 2013) in Debug mode. When I call <code>read</code> from the C standard library, I sometimes get the exception:</p>\n\n<blockquote>\n  <p>An invalid parameter was passed to a function that considers invalid parameters fatal.</p>\n</blockquote>\n\n<p>I believe the parameters (file descriptor, buffer, length) are OK. Even if the file descriptor was not valid, I'd expect it to return -1. The code (which is not my own, and it's cross-platform and works fine on Linux) actually checks if the return value is -1 and acts accordingly.</p>\n\n<p>MSDN is extremely unhelpful, and just says:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/ms235412%28v=vs.120%29.aspx\" rel=\"nofollow\">read</a></p>\n  \n  <p>This POSIX function is deprecated. Use the ISO C++ conformant _<a href=\"https://msdn.microsoft.com/en-us/library/wyssk1bs.aspx\" rel=\"nofollow\">read</a> instead.</p>\n</blockquote>\n\n<p>But, I just tried and replaced <code>read</code> with <code>_read</code>, and it works perfectly.</p>\n\n<ul>\n<li><p>What exactly is the difference between <code>read</code> and <code>_read</code>? Since <code>read</code> is not documented, I can't just look it up. It seems to do the same, but also raises exceptions.</p></li>\n<li><p>Can I just mix \"deprecated POSIX functions\" and \"ISO C++ conformant\"* ones? For example \"open\" and \"_read\"? It seems to work fine</p></li>\n<li><p>Can I just <code>#define read _read</code> and so on, and expect it to work just like on Linux?</p></li>\n</ul>\n\n<hr>\n\n<p>*) Note that the project is plain C, not C++, despite the language in the documentation. MSVC is wierd in that it is not really C or C++, but C/C++ in a sense. Also, the fact that exceptions are raised does not mean I am using C++, but it is a non-standard windows extension of C, IIRC.</p>\n"}, {"tags": ["c", "malloc", "free"], "comments": [{"owner": {"reputation": 2568, "user_id": 1433901, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/26cd3d4f8ce5fc9b0b6a35d139c0ed6b?s=128&d=identicon&r=PG&f=1", "display_name": "MariusSiuram", "link": "https://stackoverflow.com/users/1433901/mariussiuram"}, "edited": false, "score": 1, "creation_date": 1423656987, "post_id": 28454123, "comment_id": 45235176, "body": "<code>I recoded</code> what do you mean?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423656988, "post_id": 28454123, "comment_id": 45235177, "body": "I have never read the implementation of <code>free()</code> but it&#39;s behavior is not the one you apparently think, <code>free()</code> doesn&#39;t set the memory to <code>0</code> it just releases it to the OS so it can be accessible by someone else, but it does not zero the bytes."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1423657002, "post_id": 28454123, "comment_id": 45235192, "body": "If your malloc() implementation uses a linked list, free() should put the freed memory on the free-list."}, {"owner": {"reputation": 681, "user_id": 4464416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/615c030d3f72eacf3992b8925e9d033c?s=128&d=identicon&r=PG&f=1", "display_name": "nookonee", "link": "https://stackoverflow.com/users/4464416/nookonee"}, "reply_to_user": {"reputation": 2568, "user_id": 1433901, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/26cd3d4f8ce5fc9b0b6a35d139c0ed6b?s=128&d=identicon&r=PG&f=1", "display_name": "MariusSiuram", "link": "https://stackoverflow.com/users/1433901/mariussiuram"}, "edited": false, "score": 0, "creation_date": 1423662524, "post_id": 28454123, "comment_id": 45238489, "body": "@MariusSiuram I&#39;m recoding it and using <code>LD_PRELOAD</code> to test it. @iharob Okay, but if i&#39;m not setting it to 0, for example we can still print a pointer which has been freed, which is not possible with the system free. That&#39;s why I thought it was good to do a <code>memset()</code>. By the way, the memset still allows me to use the pointer for a next <code>malloc()</code>. So is that good too ? @wildplasser I don&#39;t have a free-list but just a flag in my list to tell if it is free or not, thought it was a better way to do it, am i wrong ?"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "edited": false, "score": 0, "creation_date": 1588558740, "post_id": 28454242, "comment_id": 108935717, "body": "is this truly what free() does? Because I just tried malloc()ing a char * of length 15, putting a random sentence into it, printing that sentence, freeing the char *, and then printing the same char * variable and got the same sentence. So it doesn&#39;t really seem like the memory has been deallocated, no?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "reply_to_user": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "edited": false, "score": 0, "creation_date": 1605196445, "post_id": 28454242, "comment_id": 114582438, "body": "@z.karl You seem to think &quot;deallocated&quot; means something which it doesn&#39;t mean. It is no longer reserved for your use; it no longer belongs to you. Whether it still contains some stuff you put there after you give it up is implementation-defined and unpredictable, especially over time."}, {"owner": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1605299254, "post_id": 28454242, "comment_id": 114617813, "body": "@tripleee ah, thank you for pointing that misunderstanding out. So free() seems to be a lot like the <code>rm</code> linux command where it unlinks the memory/file in question, and it may or may not be where it was before, but whatever is in there isn&#39;t determined by what was before no?"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1605357380, "post_id": 28454242, "comment_id": 114628448, "body": "I woudn&#39;t exactly phrase it like that. Typically it doesn&#39;t make sense to eraee a resource when it&#39;s released, but it could become reserved for something else and have its contents replaced at any point. System load and the OS allocation strategy influecnce whether that&#39;s likely to happen sooner rather than later; typical Unix file systems will reclaim the released space fairly soon, whereas some other file systems will try to leave things untouched for longer, e.g. to reduce fragmentation. Your exposition still seems to confuse position (address) - which can never change - with contents."}], "tags": [], "owner": {"reputation": 280, "user_id": 1554502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3978eb75534e71eb5e14be5c8645356a?s=128&d=identicon&r=PG", "display_name": "Konstantin.Krivyakin", "link": "https://stackoverflow.com/users/1554502/konstantin-krivyakin"}, "is_accepted": false, "score": 1, "last_activity_date": 1423657280, "creation_date": 1423657280, "answer_id": 28454242, "question_id": 28454123, "link": "https://stackoverflow.com/questions/28454123/c-what-does-free-do-to-the-memory/28454242#28454242", "title": "C - What does free() do to the memory?", "body": "<p>The C library function <code>void free(void *ptr)</code> deallocates the memory previously allocated by a call to <code>calloc</code>, <code>malloc</code>, or <code>realloc</code>.</p>\n\n<p>You should use it to prevent memory leaks.</p>\n"}, {"comments": [{"owner": {"reputation": 681, "user_id": 4464416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/615c030d3f72eacf3992b8925e9d033c?s=128&d=identicon&r=PG&f=1", "display_name": "nookonee", "link": "https://stackoverflow.com/users/4464416/nookonee"}, "edited": false, "score": 0, "creation_date": 1423658243, "post_id": 28454243, "comment_id": 45235942, "body": "Okay, so if I use <code>memset</code> it&#39;s not like the system call, but do you personnaly think it&#39;s a good way to do like I did ? Is it safe or am I missing something ?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 681, "user_id": 4464416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/615c030d3f72eacf3992b8925e9d033c?s=128&d=identicon&r=PG&f=1", "display_name": "nookonee", "link": "https://stackoverflow.com/users/4464416/nookonee"}, "edited": false, "score": 0, "creation_date": 1423659943, "post_id": 28454243, "comment_id": 45236860, "body": "@nookonee free() would normally return the memory to the memory allocator, so the memory can be used again in future calls to malloc(). That&#39;s a very different thing compared to what memset() does."}, {"owner": {"reputation": 681, "user_id": 4464416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/615c030d3f72eacf3992b8925e9d033c?s=128&d=identicon&r=PG&f=1", "display_name": "nookonee", "link": "https://stackoverflow.com/users/4464416/nookonee"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1423661714, "post_id": 28454243, "comment_id": 45237978, "body": "@nos Okay, currently I have a list with all my adresses and a flag to say if it is free or not. So I am setting this flag and doing the <code>memset</code> So as it, I can reuse it and it is set to 0, is that right ?"}, {"owner": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "edited": false, "score": 0, "creation_date": 1588558809, "post_id": 28454243, "comment_id": 108935731, "body": "@Leonard Michlmayr No free won&#39;t deallocate the memory allocated to it at all right? Because I just tried malloc()ing a char * of length 15, putting a random sentence into it, printing that sentence, freeing the char *, and then printing the same char * variable and got the same sentence. So it doesn&#39;t really seem like the memory has been deallocated, no?"}, {"owner": {"reputation": 305, "user_id": 4542466, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3eP8241M7Jw/AAAAAAAAAAI/AAAAAAAAAV8/8KC-WYwTjqA/photo.jpg?sz=128", "display_name": "Leonard Michlmayr", "link": "https://stackoverflow.com/users/4542466/leonard-michlmayr"}, "reply_to_user": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "edited": false, "score": 0, "creation_date": 1588654684, "post_id": 28454243, "comment_id": 108974105, "body": "@z.karl, as I said, free does not change the data in the memory. It&#39;s like leaving your table in a fast food restaurant. If you decide to come back later your tray may still be there, but there is no guarantee. If you want to make sure that the data is cleared, use memset before free. That&#39;s the way to clear your table. If you don&#39;t use memset (which is the way you would do it most of the time) the next customer will remove your tray. (Note that if you want to make sure that no data leaks to other processes, memset is not enough.)"}, {"owner": {"reputation": 245, "user_id": 7388755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d90756d9892297907664eb8bac35dc0?s=128&d=identicon&r=PG", "display_name": "z.karl", "link": "https://stackoverflow.com/users/7388755/z-karl"}, "edited": false, "score": 0, "creation_date": 1588694299, "post_id": 28454243, "comment_id": 108994406, "body": "@LeonardMichlmayr ahhh, thanks! I really like the fast food analogy!"}], "tags": [], "owner": {"reputation": 305, "user_id": 4542466, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3eP8241M7Jw/AAAAAAAAAAI/AAAAAAAAAV8/8KC-WYwTjqA/photo.jpg?sz=128", "display_name": "Leonard Michlmayr", "link": "https://stackoverflow.com/users/4542466/leonard-michlmayr"}, "is_accepted": true, "score": 2, "last_activity_date": 1423657280, "creation_date": 1423657280, "answer_id": 28454243, "question_id": 28454123, "link": "https://stackoverflow.com/questions/28454123/c-what-does-free-do-to-the-memory/28454243#28454243", "title": "C - What does free() do to the memory?", "body": "<p>Usually free(3) does not do anything to the memory itself. (If security or privacy is a concern, you should clear memory before freeing.)</p>\n\n<p>If you want to implement malloc, you need to have some database of free memory blocks. When memory is freed you should join it with adjoint free memory, if there is any. If a complete page ends up unused, you should tell the kernel, that you don't need it anymore (depending on how you got that memory in the first place)</p>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 2256138, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/EpJ2H.jpg?s=128&g=1", "display_name": "PravinY", "link": "https://stackoverflow.com/users/2256138/praviny"}, "is_accepted": false, "score": 2, "last_activity_date": 1423748611, "creation_date": 1423748611, "answer_id": 28479015, "question_id": 28454123, "link": "https://stackoverflow.com/questions/28454123/c-what-does-free-do-to-the-memory/28479015#28479015", "title": "C - What does free() do to the memory?", "body": "<p><strong>Free :</strong> Call will unlink / unallocate the memory pointed by pointer so that  other process can use it.</p>\n\n<p><strong>Memset :</strong> Call will set a memory / fill a memory location. It won't unlink / unallocate a memory and memory remain allocated / occupied till the program exist. Which can cause memory leaks.</p>\n\n<p>You can use <strong>valgrind</strong> tool to check memory leaks.</p>\n\n<p>And it is a better practice to unlink / unallocate a memory if its not required.</p>\n"}], "owner": {"reputation": 681, "user_id": 4464416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/615c030d3f72eacf3992b8925e9d033c?s=128&d=identicon&r=PG&f=1", "display_name": "nookonee", "link": "https://stackoverflow.com/users/4464416/nookonee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9359, "favorite_count": 0, "accepted_answer_id": 28454243, "answer_count": 3, "score": 2, "last_activity_date": 1605196169, "creation_date": 1423656892, "question_id": 28454123, "link": "https://stackoverflow.com/questions/28454123/c-what-does-free-do-to-the-memory", "title": "C - What does free() do to the memory?", "body": "<p>I recoded <code>malloc()</code> <code>free()</code> and <code>realloc()</code>.</p>\n\n<p>I have a linked list with the pointers returned by <code>malloc()</code>.</p>\n\n<p>The question is : what does <code>free()</code> really do ?</p>\n\n<p>Currently, I did a <code>memset()</code> to have the same behavior of <code>free()</code>.</p>\n\n<p>But was it better just to set a flag in my list as 'is free' rather than doing a <code>memset()</code> in order to make it faster ?</p>\n"}, {"tags": ["c", "file", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423656872, "post_id": 28454073, "comment_id": 45235107, "body": "Standard Warning : Please <a href=\"http://stackoverflow.com/q/605845/2173917\">do not cast</a> the return value of <code>malloc()</code> and family."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423656935, "post_id": 28454073, "comment_id": 45235157, "body": "@SouravGhosh Since when has not casting void * to the type you need become good practice?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423657205, "post_id": 28454073, "comment_id": 45235322, "body": "@user2225104 Casting the return value of e.g. <code>malloc</code> can hide warnings given when <code>malloc</code> have not been properly prototyped (e.g. when the programmer forgot to include <code>&lt;stdlib.h&gt;</code>)"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423657249, "post_id": 28454073, "comment_id": 45235358, "body": "Not casting and later on adding those casts in a hurry when you compile with c++ compiler is more error prone."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423657366, "post_id": 28454073, "comment_id": 45235434, "body": "<code>adding those casts in a hurry when you compile with c++ compiler</code> why you have to hurry?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423657440, "post_id": 28454073, "comment_id": 45235481, "body": "You typically are in a hurry when you think you can simply reuse that piece of code and you did not plan time for those changes. You just want to get it to compile and you do not really care. With that, you lose all test depth you had otherwhise gotten for free. Just because someone tried to be clever."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423657551, "post_id": 28454073, "comment_id": 45235541, "body": "@user2225104 Switching languages for a project should never be done in a hurry, even if they are somewhat similar like C and C++. And it will be very easy to find out the places where the casting is needed (or rather, where you should look into e.g. <code>std::vector</code> or in worst case change to using <code>new[]</code>) as you will get compiler <i>errors</i>."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423657634, "post_id": 28454073, "comment_id": 45235594, "body": "@JoachimPileborg Obviously you never had to work under pressure. Why would you advise people to lay traps for future re-use in times where hardly anyone is compiling c code with a pure c-compiler anymore?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423657760, "post_id": 28454073, "comment_id": 45235668, "body": "@user2225104 It&#39;s a trap only if you think that code from a completely different language can just be dropped into another language just like that. And I&#39;ve had lot of pressure, hard to work for any time in the software industry without having pressure."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1423657813, "post_id": 28454073, "comment_id": 45235699, "body": "@JoachimPileborg People with your attitude make sure it is a completely different language, while it is perfectly reasonable to keep both worlds in mind while coding."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423658321, "post_id": 28454073, "comment_id": 45235996, "body": "@user2225104 Then I equally childishly counter-argument with it&#39;s people like you that keep on treating C++ as an extended C (&quot;C with classes&quot;). C and C++ <b><i>are</i></b> different languages, with different ways of doing things. Would you do it the other way around, drop C++ code into a C project? Why not? How about other languages? Why not?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423658669, "post_id": 28454073, "comment_id": 45236193, "body": "Let me put it this way: If you /intentionally/ prevent people from doing their work by making sure your code will break, you are not doing anyone a favor. Especially in the light of the fact that anytime I had to find bugs in C-code the first I did was to translate it with a c++ compiler to see type errors. Usually that got me quickly into to fixing major stuff the c-compiler silently accepted."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 1, "creation_date": 1423659043, "post_id": 28454073, "comment_id": 45236407, "body": "@user2225104 well, <code>gcc</code> provides a wide set of options that you should enable while compiling. Mostly it will do the job of warning you. And can you please give an example of a few wrong <code>stuff the c-compiler silently accepted.</code> I&#39;m curious. :-)"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423659230, "post_id": 28454073, "comment_id": 45236512, "body": "@Sourav Ghosh Having C and C++ code in front of me for now over 20 years, having to use code from hardcore &quot;I refuse c++ exists and stick to C code die hard&quot; kind of guys on several occasions - had I bothered to keep all those situations when what I said above proofed true, I could now write a book and become as famous as Scott Meyers and maybe even rich."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423660603, "post_id": 28454073, "comment_id": 45237270, "body": "@user2225104 if &quot;it is perfectly reasonable to keep both worlds in mind while coding&quot; but are happy to make the one you are <i>actually</i> coding less robust, why don&#39;t you use a <code>#define</code> for your casts, and then you will have it right in both languages?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423660733, "post_id": 28454073, "comment_id": 45237349, "body": "I am all for the #define NEW() solution. Better than simply smugly not casting and burdening the work on a future victim of that choice."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423660819, "post_id": 28454073, "comment_id": 45237406, "body": "Why would I do that if I am writing in C? I have no idea you&#39;ll be hacking my code!"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423661118, "post_id": 28454073, "comment_id": 45237602, "body": "@WeatherVane Ignorance is bliss o.O :) On a serious note: You gain much in the long run if you accept reality. And reality is that code lives longer than anyone expects it to live. And if it is useful it /will/ be reused in an unknown context. While it is impossible for non-psychics to foresee the future, it is simple to make choices which are painless and likely to be useful. C++ now also exists since like... 25 years. Nothing new at all."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1423661625, "post_id": 28454073, "comment_id": 45237929, "body": "@user2225104 Should my C code also consider <code>new()</code> in a way that is C# compatible? I fail to see why I should write my code in a way that makes your life easier, and mine harder."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1423661651, "post_id": 28454073, "comment_id": 45237948, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/70706/discussion-between-user2225104-and-weather-vane\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "edited": false, "score": 0, "creation_date": 1423657057, "post_id": 28454114, "comment_id": 45235232, "body": "I don&#39;t get it. The pointer inside function points to the file which was open in main function but I closed this file and assigned new pointer to variable f and it shouldn&#39;t affect variable old in main function"}], "tags": [], "owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "is_accepted": false, "score": 0, "last_activity_date": 1423656863, "creation_date": 1423656863, "answer_id": 28454114, "question_id": 28454073, "link": "https://stackoverflow.com/questions/28454073/file-pointer-change-inside-a-c-function/28454114#28454114", "title": "File pointer change inside a C function", "body": "<p>It is copied, but it still points to the same file. </p>\n"}, {"comments": [{"owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "edited": false, "score": 0, "creation_date": 1423657248, "post_id": 28454160, "comment_id": 45235356, "body": "I know what passing by value is. The point here is that even though I&#39;m not passing an argument as pointer to pointer as you did here, I am getting pointer change in main."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "edited": false, "score": 0, "creation_date": 1423657345, "post_id": 28454160, "comment_id": 45235417, "body": "@greenshade I can promise you that the pointer <code>old</code> does <i>not</i> change value in <code>main</code> after the call. If it seems to work it&#39;s because of <a href=\"http://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behavior</i></a>."}, {"owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "edited": false, "score": 0, "creation_date": 1423657574, "post_id": 28454160, "comment_id": 45235555, "body": "Thank you, that&#39;s the answer I wanted to get. Although it seems strange to me because I got code from my university and they told me to close a file inside a function and open it again but the pointer is being passed by copy. Maybe it&#39;s just a typo."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1423671994, "post_id": 28454160, "comment_id": 45244864, "body": "As to <i>why</i> this happens, I suspect it&#39;s <code>fopen()</code> working via <code>open()</code>, which says <code>man open:...The file descriptor returned by a successful call will be the lowest-numbered file  descriptor  not  currently open for the process.</code>. So after <code>fclose(); fopen()</code>, the new file has the same descriptor as the old one if the old one was the lowest-numbered file descriptor at the time."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1423657003, "creation_date": 1423657003, "answer_id": 28454160, "question_id": 28454073, "link": "https://stackoverflow.com/questions/28454073/file-pointer-change-inside-a-c-function/28454160#28454160", "title": "File pointer change inside a C function", "body": "<p>Arguments in C is passed <em>by value</em>, and that means they are copied. So the functions never have the original values, just copies, and modifying a copy will of course not modify the original.</p>\n\n<p>You can emulate <em>pass by reference</em> by using pointers, and in the case of passing a pointer by reference you of course have to pass a pointer to the pointer (by using the address-of operator <code>&amp;</code>).</p>\n\n<pre><code>void fun(FILE **f)\n{\n    fclose(*f);\n    *f = fopen(\"newfile\", \"r\");\n}\n\n...\n\nfun(&amp;old);\n</code></pre>\n"}], "owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 0, "accepted_answer_id": 28454160, "answer_count": 2, "score": 0, "last_activity_date": 1423657003, "creation_date": 1423656733, "question_id": 28454073, "link": "https://stackoverflow.com/questions/28454073/file-pointer-change-inside-a-c-function", "title": "File pointer change inside a C function", "body": "<p>I'd like to ask why is it possible to change the pointer value of file in C function without passing reference to it, what I mean is:</p>\n\n<pre><code>void fun(FILE *f)\n{\n    fclose(f);\n    f = fopen(\"newfile\", \"r\");\n}\n\nint main(void)\n{\n    FILE *old = fopen(\"file\", \"r\");\n    char *msg = (char*)malloc(sizeof(char) * 100);\n    fun(old);\n    fscanf(old, \"%s\", msg);\n    printf(\"%s\", msg);\n    free(msg);\n    return 0;\n}\n</code></pre>\n\n<p>Can anyone explain it to me? I was thought that pointers are being copied so I expected to get an error about closed file. Surprisingly I didn't get it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423656215, "post_id": 28453813, "comment_id": 45234709, "body": "<code>_outer</code> is not having any <code>_inner</code>, so shall we assume it is typedef to <code>_one</code>?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423656238, "post_id": 28453813, "comment_id": 45234728, "body": "If you redefine <code>struct _outer { char *outer_value; struct _one common;}</code> there is no problem, but as is, it&#39;s not good."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1423656564, "post_id": 28453813, "comment_id": 45234940, "body": "Note that while this is guaranteed to work in later versions of the C standard, the addition of this guarantee is an example of codifying existing practice."}], "answers": [{"tags": [], "owner": {"reputation": 280, "user_id": 1554502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3978eb75534e71eb5e14be5c8645356a?s=128&d=identicon&r=PG", "display_name": "Konstantin.Krivyakin", "link": "https://stackoverflow.com/users/1554502/konstantin-krivyakin"}, "is_accepted": false, "score": -1, "last_activity_date": 1423656267, "creation_date": 1423656267, "answer_id": 28453912, "question_id": 28453813, "link": "https://stackoverflow.com/questions/28453813/is-casting-to-nested-struct-pointers-safe/28453912#28453912", "title": "Is casting to nested struct pointers safe?", "body": "<p>Of course you can cast it. But if you want to be able access to <code>char *inner_value;</code> and <code>char *outer_value;</code> you need to change order in <code>_outer</code>:</p>\n\n<pre><code>struct _outer {\n    char *outer_value; // &lt;----|\n    struct _one common; // &lt;---|\n};\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 444, "user_id": 2326740, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/gePwC.png?s=128&g=1", "display_name": "Jin", "link": "https://stackoverflow.com/users/2326740/jin"}, "edited": false, "score": 0, "creation_date": 1480635894, "post_id": 28453999, "comment_id": 69056939, "body": "Is this also true for structs within structs within structs?"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1423656514, "creation_date": 1423656514, "answer_id": 28453999, "question_id": 28453813, "link": "https://stackoverflow.com/questions/28453813/is-casting-to-nested-struct-pointers-safe/28453999#28453999", "title": "Is casting to nested struct pointers safe?", "body": "<p>A casting like that is guaranteed to succeed by C99 standard:</p>\n\n<blockquote>\n  <p>6.7.2.1-13: A pointer to a structure object, suitably converted, points to its initial member (or if that member is a bit-field, then to the unit in which it resides), and vice versa. There may be unnamed padding within a structure object, but not at its beginning.</p>\n</blockquote>\n"}], "owner": {"reputation": 11194, "user_id": 124983, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/031f95430be418f88b1c01491551b901?s=128&d=identicon&r=PG", "display_name": "Residuum", "link": "https://stackoverflow.com/users/124983/residuum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 2, "closed_date": 1423656583, "accepted_answer_id": 28453999, "answer_count": 2, "score": 2, "last_activity_date": 1423656514, "creation_date": 1423655968, "last_edit_date": 1423656254, "question_id": 28453813, "link": "https://stackoverflow.com/questions/28453813/is-casting-to-nested-struct-pointers-safe", "closed_reason": "Duplicate", "title": "Is casting to nested struct pointers safe?", "body": "<p>Given two structs declared as</p>\n\n<pre><code>struct _inner {\n    char *inner_value;\n};\n\nstruct _outer {\n    struct _inner common;\n    char *outer_value;\n};\n</code></pre>\n\n<p>Can I assume that the following cast from a <code>struct _outer *</code> to <code>struct _inner*</code> will succeed in every compiler?</p>\n\n<pre><code>struct _outer *outer_struct;\nstruct _inner *inner_struct = (struct _inner *)outer_struct;\n</code></pre>\n\n<p>What is the minimum standard version of C, where this cast is guaranteed to succeed?</p>\n\n<p><strong>EDIT</strong>: I have changed <code>struct _one</code> to <code>struct _inner</code> in the outer struct.</p>\n"}, {"tags": ["c", "function", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423655709, "post_id": 28453681, "comment_id": 45234396, "body": "<code>able to use</code> can you please clarify?&quot;"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1423655800, "post_id": 28453681, "comment_id": 45234457, "body": "<code>struct_1</code> and <code>struct_2</code> have identical members in your example. What do you want to achieve? Do you want a linked list for various types of payloads?"}, {"owner": {"reputation": 18728, "user_id": 2382136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eMbhT.jpg?s=128&g=1", "display_name": "Wojtek Surowka", "link": "https://stackoverflow.com/users/2382136/wojtek-surowka"}, "edited": false, "score": 2, "creation_date": 1423655804, "post_id": 28453681, "comment_id": 45234461, "body": "This is a totally wrong perspective. Do not try to apply Python dynamic typing to C. If you have two structures - even with the same fields - for C they are different and that&#39;s it. There are some tricks to circumvent this, but since you are new to C do not start with tricks."}, {"owner": {"reputation": 216, "user_id": 4375077, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1a9750355733c281b63269ccda6109ce?s=128&d=identicon&r=PG&f=1", "display_name": "Diaco", "link": "https://stackoverflow.com/users/4375077/diaco"}, "edited": false, "score": 0, "creation_date": 1423655865, "post_id": 28453681, "comment_id": 45234489, "body": "Okay so I want to basically add the two numbers, but I want to do it for numbers up to 500 digits long (which cannot be done using int). So I want to make a list for each number. But as I want to do it for both structs, I want to have one function instead of copying the function and having two different functions doing the same thing but using different structs to do it. Do you understand what I am trying to do?"}, {"owner": {"reputation": 18728, "user_id": 2382136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eMbhT.jpg?s=128&g=1", "display_name": "Wojtek Surowka", "link": "https://stackoverflow.com/users/2382136/wojtek-surowka"}, "edited": false, "score": 1, "creation_date": 1423655964, "post_id": 28453681, "comment_id": 45234565, "body": "@diaco Why you want two structures for the same thing in the first place?"}, {"owner": {"reputation": 216, "user_id": 4375077, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1a9750355733c281b63269ccda6109ce?s=128&d=identicon&r=PG&f=1", "display_name": "Diaco", "link": "https://stackoverflow.com/users/4375077/diaco"}, "edited": false, "score": 0, "creation_date": 1423656197, "post_id": 28453681, "comment_id": 45234699, "body": "I want to have two linked lists in the end. Each digit of the number becomes an element in the list that I want to create. Thought it would be more right to use two structs than to use one struct. I am probably wrong though"}, {"owner": {"reputation": 1373, "user_id": 655027, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d94649cf365de22fa125f0a45f5ebb4?s=128&d=identicon&r=PG", "display_name": "rubikonx9", "link": "https://stackoverflow.com/users/655027/rubikonx9"}, "edited": false, "score": 1, "creation_date": 1423656222, "post_id": 28453681, "comment_id": 45234714, "body": "You want to have two copies of a struct. Not two distinct data types."}, {"owner": {"reputation": 18728, "user_id": 2382136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eMbhT.jpg?s=128&g=1", "display_name": "Wojtek Surowka", "link": "https://stackoverflow.com/users/2382136/wojtek-surowka"}, "edited": false, "score": 0, "creation_date": 1423656253, "post_id": 28453681, "comment_id": 45234743, "body": "You can without problem use the same structure for your two lists."}, {"owner": {"reputation": 216, "user_id": 4375077, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1a9750355733c281b63269ccda6109ce?s=128&d=identicon&r=PG&f=1", "display_name": "Diaco", "link": "https://stackoverflow.com/users/4375077/diaco"}, "edited": false, "score": 0, "creation_date": 1423656510, "post_id": 28453681, "comment_id": 45234901, "body": "okay, I will give it a try using one struct with two copies like you said. but still. is it possible to create the two lists using ONE function, or do I have to create two of them?"}, {"owner": {"reputation": 1373, "user_id": 655027, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4d94649cf365de22fa125f0a45f5ebb4?s=128&d=identicon&r=PG", "display_name": "rubikonx9", "link": "https://stackoverflow.com/users/655027/rubikonx9"}, "edited": false, "score": 0, "creation_date": 1423656541, "post_id": 28453681, "comment_id": 45234923, "body": "One function, called two times. That&#39;s the purpose of functions."}, {"owner": {"reputation": 216, "user_id": 4375077, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1a9750355733c281b63269ccda6109ce?s=128&d=identicon&r=PG&f=1", "display_name": "Diaco", "link": "https://stackoverflow.com/users/4375077/diaco"}, "edited": false, "score": 0, "creation_date": 1423656668, "post_id": 28453681, "comment_id": 45234988, "body": "exactly, that is what I want to achieve. but how does the function know which copy I&#39;m using? I cant tell it through an argument, can I?"}, {"owner": {"reputation": 18728, "user_id": 2382136, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eMbhT.jpg?s=128&g=1", "display_name": "Wojtek Surowka", "link": "https://stackoverflow.com/users/2382136/wojtek-surowka"}, "edited": false, "score": 0, "creation_date": 1423659099, "post_id": 28453681, "comment_id": 45236442, "body": "@diaco this is exactly what function arguments are for"}], "answers": [{"tags": [], "owner": {"reputation": 8889, "user_id": 4538344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746edd669e07914179feb9f6957a06e3?s=128&d=identicon&r=PG", "display_name": "StenSoft", "link": "https://stackoverflow.com/users/4538344/stensoft"}, "is_accepted": false, "score": 2, "last_activity_date": 1423655905, "creation_date": 1423655905, "answer_id": 28453790, "question_id": 28453681, "link": "https://stackoverflow.com/questions/28453681/c-functions-structs/28453790#28453790", "title": "C - Functions Structs", "body": "<p>C does not use duck typing as Python does so you cannot pass one structure that <em>looks like</em> other, completely unrelated structure as if it was this other structure.</p>\n"}, {"tags": [], "owner": {"reputation": 1627, "user_id": 973745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6d76d7da0d148f26c10ce3241e6b2c50?s=128&d=identicon&r=PG", "display_name": "LogicG8", "link": "https://stackoverflow.com/users/973745/logicg8"}, "is_accepted": false, "score": 0, "last_activity_date": 1423656533, "creation_date": 1423656533, "answer_id": 28454004, "question_id": 28453681, "link": "https://stackoverflow.com/questions/28453681/c-functions-structs/28454004#28454004", "title": "C - Functions Structs", "body": "<p>Unfortunately C cannot do what you want.</p>\n\n<p>Your options are:</p>\n\n<ol>\n<li>Refactor the code to use the same struct type for all items.</li>\n<li>Pass the fields of interest in the structs directly to the functions</li>\n<li>Write code to marshal the similar structs to a common struct.</li>\n<li>Play fast and loose with the type system and arrange shared elements the same way in the two different structs and cast your pointers.</li>\n</ol>\n\n<p><a href=\"https://isis.poly.edu/kulesh/stuff/src/klist/\" rel=\"nofollow\">If you just want a linked list check out how code re-use is achieved in the linux kernel</a></p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 3863476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccdb393302c40d5fdef357464e09db44?s=128&d=identicon&r=PG&f=1", "display_name": "DieMartin", "link": "https://stackoverflow.com/users/3863476/diemartin"}, "is_accepted": false, "score": 0, "last_activity_date": 1423656959, "creation_date": 1423656959, "answer_id": 28454142, "question_id": 28453681, "link": "https://stackoverflow.com/questions/28453681/c-functions-structs/28454142#28454142", "title": "C - Functions Structs", "body": "<p>Answer: No, you cannot do it directly. Welcome to static typing.</p>\n\n<p>There is a way to achieve something similar by using our beloved void * and some castings but, believe me, it is not what you want to do. If you really want to do it ask directly for it. You have been warned.</p>\n"}, {"tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 2, "last_activity_date": 1423665950, "last_edit_date": 1423665950, "creation_date": 1423665151, "answer_id": 28456869, "question_id": 28453681, "link": "https://stackoverflow.com/questions/28453681/c-functions-structs/28456869#28456869", "title": "C - Functions Structs", "body": "<p>You could have two instances of one structure.<br>\nThe function can accept either instance and process it as needed.  </p>\n\n<pre><code>typedef struct{\n    int number;\n    struct node *next;\n}mystruct;\nvoid function(int x, mystruct *eachstruct);//prototype\nint main()\n{\n    int number1 = 10;\n    int number2 = 20;\n    //declare two instances of mystruct\n    mystruct list_1 = { 0, NULL};\n    mystruct list_2 = { 0, NULL};\n    // call the function with one or the other instance of mystruct\n    function(number1, &amp;list_1);\n    function(number2, &amp;list_2);\n}\n\nvoid function(int x, mystruct *eachstruct)\n{\n    //do stuff in function\n    eachstruct-&gt;number = x;\n    if ( eachstruct-&gt;next == NULL)\n    {\n        //do more stuff\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 216, "user_id": 4375077, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1a9750355733c281b63269ccda6109ce?s=128&d=identicon&r=PG&f=1", "display_name": "Diaco", "link": "https://stackoverflow.com/users/4375077/diaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 28456869, "answer_count": 4, "score": 0, "last_activity_date": 1423665950, "creation_date": 1423655523, "last_edit_date": 1423655757, "question_id": 28453681, "link": "https://stackoverflow.com/questions/28453681/c-functions-structs", "title": "C - Functions Structs", "body": "<p>So I am still pretty new to C programming. I have learned Python though, so I am familliar to some of the codes.</p>\n\n<p>For instance when I create a function in python, I am able to make it general and usable for different classes.</p>\n\n<p>I want to do something similar here. I have two structs which look practically the same. I want to use the same function for both <code>struct</code>s, but ofcourse I cant send in the <code>struct</code> name as an argument into the function. What do I do instead?</p>\n\n<p>For now dont worry about what the function does. Its the principle of being able to use two <code>struct</code>s in the same function that counts for me. If this is a totally wrong perspective, then I am sorry but this was my first thought when coming upon this problem.</p>\n\n<pre><code>typedef struct{\n   int number;\n   struct node *next;\n}struct_1;\n\nstruct node *head;\n\ntypedef struct{\n   int number;\n   struct node *next;\n}struct_2;\n\nvoid main()\n{\n   int number1 = 10;\n   int number2 = 20;\n   function(number1);\n   function(number2);\n}\n\nvoid function(int x, struct) // Here is where I want to be able to use 2 different structs for the same function\n{\n   struct *curr, *head;\n   curr=(node1*)malloc(sizeof(node1));\n   printf(\"%d\", curr-&gt;number);\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "ftp"], "answers": [{"comments": [{"owner": {"reputation": 2327, "user_id": 2280212, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/IUER1.jpg?s=128&g=1", "display_name": "Federico Ponzi", "link": "https://stackoverflow.com/users/2280212/federico-ponzi"}, "edited": false, "score": 0, "creation_date": 1423658885, "post_id": 28453763, "comment_id": 45236315, "body": "Is this the way used by ftp?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 2327, "user_id": 2280212, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/IUER1.jpg?s=128&g=1", "display_name": "Federico Ponzi", "link": "https://stackoverflow.com/users/2280212/federico-ponzi"}, "edited": false, "score": 0, "creation_date": 1423659120, "post_id": 28453763, "comment_id": 45236455, "body": "@FedericoPonzi I Actually don&#39;t know, but it seems logical. It&#39;s often used for all passive (listening) sockets."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1423655814, "creation_date": 1423655814, "answer_id": 28453763, "question_id": 28453666, "link": "https://stackoverflow.com/questions/28453666/ftp-implementation-close-data-socket-every-time/28453763#28453763", "title": "FTP implementation: close data socket every time", "body": "<p>When a socket is closed, it enters the <code>TIME WAIT</code> state (<a href=\"http://en.wikipedia.org/wiki/Transmission_Control_Protocol#mediaviewer/File:Tcp_state_diagram_fixed_new.svg\" rel=\"nofollow\">see here for the possible TCP states</a>) and no other socket can be bound to the same address/port pair until the socket leaves <code>TIME WAIT</code> and is in the <code>CLOSED</code> state.</p>\n\n<p>You <em>can</em> go around this by setting the <code>SO_REUSEADDR</code> socket option, that will allow two sockets to be bound to the same address if one of the sockets is in the <code>TIME WAIT</code> state.</p>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 6660393, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154419254303656/picture?type=large", "display_name": "Nassar Nimer", "link": "https://stackoverflow.com/users/6660393/nassar-nimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1470068328, "creation_date": 1470068328, "answer_id": 38703580, "question_id": 28453666, "link": "https://stackoverflow.com/questions/28453666/ftp-implementation-close-data-socket-every-time/38703580#38703580", "title": "FTP implementation: close data socket every time", "body": "<p>you need to open socket for transfer each time as the server will close it when transfer finish.\nyou will know that the file is downloaded/uploaded by reading response from FTP Server for status code (226 or 250) - check List of FTP server return codes:\n<a href=\"https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes\" rel=\"nofollow\">https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes</a></p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 1547838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98994619062a6626baa3068aa49aafdb?s=128&d=identicon&r=PG&f=1", "display_name": "Honwhy Wang", "link": "https://stackoverflow.com/users/1547838/honwhy-wang"}, "is_accepted": false, "score": -1, "last_activity_date": 1515429718, "creation_date": 1515429718, "answer_id": 48154506, "question_id": 28453666, "link": "https://stackoverflow.com/questions/28453666/ftp-implementation-close-data-socket-every-time/48154506#48154506", "title": "FTP implementation: close data socket every time", "body": "<p>In my project, I use apache-commons-net,\njust keep the command connection alive with heartbeat command,\nand <code>enter local passive mode</code> every time to do file tranfer.\nThe principle is same for your situation, I suggest send\n<code>\nEPSV\n</code>\ncommand before GETTING a file.txt.</p>\n\n<p>refer: <a href=\"https://commons.apache.org/proper/commons-net/\" rel=\"nofollow noreferrer\">https://commons.apache.org/proper/commons-net/</a></p>\n"}], "owner": {"reputation": 2327, "user_id": 2280212, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/IUER1.jpg?s=128&g=1", "display_name": "Federico Ponzi", "link": "https://stackoverflow.com/users/2280212/federico-ponzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 1, "accepted_answer_id": 28453763, "answer_count": 3, "score": 0, "last_activity_date": 1515429718, "creation_date": 1423655460, "question_id": 28453666, "link": "https://stackoverflow.com/questions/28453666/ftp-implementation-close-data-socket-every-time", "title": "FTP implementation: close data socket every time", "body": "<p>I'm implementing in c a sort of FTP protocol.</p>\n\n<p>I' ve a server running.\nI start the client, connect to the server, and then send a <code>GET file.txt</code> request.\nThe client parse the command, see it's a GET command and starts a server socket.\nThe server recieves the command, and starts the data connection with the client and start sending file.txt on this connection.</p>\n\n<p>When the server sent the file, it closes the client socket (Data).</p>\n\n<p>When i want to GET another file, the port is already in use. How can i prevent this? Should i keep the data-connection open for all the command-connection session? In this case, how can my client know when the file is over?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays", "string"], "comments": [{"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 1, "creation_date": 1423654470, "post_id": 28453221, "comment_id": 45233678, "body": "Length of the previous string must be determined by any means if you want to append another characters to it."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 5, "creation_date": 1423654577, "post_id": 28453221, "comment_id": 45233748, "body": "<a href=\"http://www.stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\"><b>Never use <code>gets()</code></b>!!</a> Use <code>fgets()</code> instead."}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "edited": false, "score": 0, "creation_date": 1423654592, "post_id": 28453221, "comment_id": 45233757, "body": "allright how do i detirmine it (like when does the string reaches /0 or \\0 or whatever it is to end of a string)"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1423654602, "post_id": 28453221, "comment_id": 45233763, "body": "<code>strcat</code> might be useful here (though, in essence, this function <b>does</b> search for the end of the string before concatenating another string to it)."}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1423654630, "post_id": 28453221, "comment_id": 45233783, "body": "@CoolGuy why, what to use instead"}, {"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1423654662, "post_id": 28453221, "comment_id": 45233808, "body": "If you use scanf() instead of gets() you will get the number of characters entered in return value,you can use them."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1423654754, "post_id": 28453221, "comment_id": 45233862, "body": "[Just to complete what Mr. @CoolGuy said]... use <code>fgets()</code> instead."}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "edited": false, "score": 0, "creation_date": 1423654775, "post_id": 28453221, "comment_id": 45233871, "body": "but I want the string to be inputted(if that&#39;s a word) by the user"}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423654817, "post_id": 28453221, "comment_id": 45233893, "body": "@SouravGhosh &#39;fgets()&#39;  is for files,right"}, {"owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "edited": false, "score": 0, "creation_date": 1423654874, "post_id": 28453221, "comment_id": 45233929, "body": "1. <code>for (i=0; inname[i]!=0; i++) {}</code>. 2. <code>inname[i] = your_char;</code>. 3. <code>inname[i+1] = 0;</code>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1423654895, "post_id": 28453221, "comment_id": 45233939, "body": "@CoderGuy yes, you can make use of <code>stdin</code> in your case."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1423654897, "post_id": 28453221, "comment_id": 45233942, "body": "@CoderGuy use <code>stdin</code> for the <code>FILE*</code>"}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1423655272, "post_id": 28453221, "comment_id": 45234144, "body": "@WhozCraig so this means I use a char array instead of a file? how nifty"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423655415, "post_id": 28453221, "comment_id": 45234221, "body": "<code>gets(array)</code> -&gt; <code>fgets(array, sizeof(array), stdin)</code> as you see you pass the array size and hence prevent buffer overflow."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1423655429, "post_id": 28453221, "comment_id": 45234224, "body": "@CoderGuy , No. What WhozCraig said is to use the third argument(which you use for a <code>FILE</code> pointer) as <code>stdin</code>. The first argument is a <code>char*</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423655501, "post_id": 28453221, "comment_id": 45234271, "body": "@CoderGuy you can&#39;t add a character without knowing the length of the string in c."}, {"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "edited": false, "score": 0, "creation_date": 1423655718, "post_id": 28453221, "comment_id": 45234404, "body": "well I can count the characters and overwrite the <code>\\0</code> with another character and the empty space afterward with <code>\\0</code>"}], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "edited": false, "score": 0, "creation_date": 1423655042, "post_id": 28453457, "comment_id": 45234027, "body": "how can i test for the <code>\\0</code> character"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1423659114, "post_id": 28453457, "comment_id": 45236449, "body": "&quot;To find the Null Char&quot; ... simply use <code>i = strlen(inname)+1;</code>."}], "tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": false, "score": 1, "last_activity_date": 1423821464, "last_edit_date": 1423821464, "creation_date": 1423654838, "answer_id": 28453457, "question_id": 28453221, "link": "https://stackoverflow.com/questions/28453221/how-to-add-a-character-to-the-back-of-a-char-array-when-you-obtain-it-with-a-get/28453457#28453457", "title": "How to add a character to the back of a char array when you obtain it with a gets() function in c?", "body": "<p>As you have asked in comment, to determine the string length you can directly use </p>\n\n<pre><code>strlen(inname);\n</code></pre>\n\n<p>OR </p>\n\n<p>you can loop through string in a for loop until <code>\\0</code> is found.</p>\n\n<p>Now after getting the length of prvious string you can append new string as</p>\n\n<pre><code>strcat(&amp;inname[prevLength],\"NEW STRING\");\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>To find the Null Char you can write a for loop like this</p>\n\n<pre><code>for(int i =0;inname[i] != 0;i++)\n{\n      //do nothing\n}\n</code></pre>\n\n<p>Now you can use <code>i</code> direcly to copy any character at the end of string like:</p>\n\n<pre><code>inname[i] = Youe Char;\n</code></pre>\n\n<p>After this increment i and again copy Null char to(0) it.</p>\n\n<p>P.S.</p>\n\n<p>Any String in C end with a Null character termination. ASCII null char <code>'\\0</code>' is equivalent to <code>0</code> in decimal. </p>\n"}, {"comments": [{"owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "edited": false, "score": 0, "creation_date": 1423655121, "post_id": 28453479, "comment_id": 45234068, "body": "how can i test for the <code>\\0</code> character"}], "tags": [], "owner": {"reputation": 1, "user_id": 4547022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cFZBfnraht4/AAAAAAAAAAI/AAAAAAAAABU/oQY8YKxSHuc/photo.jpg?sz=128", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4547022/nicola"}, "is_accepted": false, "score": 0, "last_activity_date": 1423654890, "creation_date": 1423654890, "answer_id": 28453479, "question_id": 28453221, "link": "https://stackoverflow.com/questions/28453221/how-to-add-a-character-to-the-back-of-a-char-array-when-you-obtain-it-with-a-get/28453479#28453479", "title": "How to add a character to the back of a char array when you obtain it with a gets() function in c?", "body": "<p>You know that the final character of a C string is '\\0', e.g. the array:</p>\n\n<pre><code>char foo[10]={\"Hello\"};\n</code></pre>\n\n<p>is equivalent to this array:</p>\n\n<pre><code>['H'] ['e'] ['l'] ['l'] ['0'] ['\\0']\n</code></pre>\n\n<p>Thus you can iterate on the array until you find the '\\0' character, and then you can substitute it with the character you want.\nAlternatively you can use the function strcat of string.h library</p>\n"}, {"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1423655846, "creation_date": 1423655846, "answer_id": 28453774, "question_id": 28453221, "link": "https://stackoverflow.com/questions/28453221/how-to-add-a-character-to-the-back-of-a-char-array-when-you-obtain-it-with-a-get/28453774#28453774", "title": "How to add a character to the back of a char array when you obtain it with a gets() function in c?", "body": "<p>Short answer is you can't.</p>\n\n<p>In c you must know the length of the string to append <code>char</code>'s to it, in other languages the same applies but it happens magically, and without a doubt, internally the same must be done.</p>\n\n<p>c strings are defined as sequences of bytes terminated by a special byte, the <code>nul</code> character which has ascii code <code>0</code> and is represented by the character <code>'\\0'</code> in c.</p>\n\n<p>You must find this value to append characters before it, and then move it after the appended character, to illustrate this suppose you have</p>\n\n<pre><code>char hello[10] = \"Hello\";\n</code></pre>\n\n<p>then you want to append a <code>'!'</code> after the <code>'o'</code> so you can just do this</p>\n\n<pre><code>size_t length;\n\nlength = strlen(hello);\n/* move the '\\0' one position after it's current position */\nhello[length + 1] = hello[length]; \nhello[length]     = '!'; \n</code></pre>\n\n<p>now the string is <code>\"Hello!\"</code>.</p>\n\n<p>Of course, you should take car of <code>hello</code> being large enough to hold one extra character, that is also not automatic in c, which is one of the things I love about working with it because it gives you maximum flexibility.</p>\n\n<p>You can of course use some available functions to achieve this without worrying about moving the <code>'\\0'</code> for example, with</p>\n\n<pre><code>strcat(hello, \"!\");\n</code></pre>\n\n<p>you will achieve the same.</p>\n\n<p>Both <code>strlen()</code> and <code>strcat()</code> are defined in <code>string.h</code> header.</p>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 1, "last_activity_date": 1423656140, "creation_date": 1423656140, "answer_id": 28453867, "question_id": 28453221, "link": "https://stackoverflow.com/questions/28453221/how-to-add-a-character-to-the-back-of-a-char-array-when-you-obtain-it-with-a-get/28453867#28453867", "title": "How to add a character to the back of a char array when you obtain it with a gets() function in c?", "body": "<p>Note that <code>gets</code> is prone to buffer overflow and should be avoided.</p>\n\n<p>Reading a line of input:</p>\n\n<pre><code>char inname[30];\nsscanf(\"%.*s\", sizeof(inname), inname);\nint len = strlen(inname);\n// Remove trailing newline\nif (len &gt; 0 &amp;&amp; inname[len-1] == '\\n') {\n    len--;\n    inname[len] = '\\0'\n}\n</code></pre>\n\n<p>Appending to the string:</p>\n\n<pre><code>char *string_to_append = \".\";\nif (len + strlen(string_to_append) + 1) &lt;= sizeof(inname)) {\n    // There is enough room to append the string\n   strcat(inname, string_to_append); \n}\n</code></pre>\n\n<p>Optional way to append a single character to the string:</p>\n\n<pre><code>if (len &lt; sizeof(inname) - 2) {\n    // There is room to add another character\n   inname[len++] = '.'; // Add a '.' character to the string.\n   inname[len] = '\\0';  // Don't forget to nul-terminate\n}\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 4454435, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mKdSJ.png?s=128&g=1", "display_name": "BRHSM", "link": "https://stackoverflow.com/users/4454435/brhsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 28453867, "answer_count": 4, "score": 0, "last_activity_date": 1423821464, "creation_date": 1423654199, "last_edit_date": 1423654945, "question_id": 28453221, "link": "https://stackoverflow.com/questions/28453221/how-to-add-a-character-to-the-back-of-a-char-array-when-you-obtain-it-with-a-get", "title": "How to add a character to the back of a char array when you obtain it with a gets() function in c?", "body": "<p>I have an array of charracters where I put in information using a gets().</p>\n\n<pre><code>char inname[30];\ngets(inname);\n</code></pre>\n\n<p>How can I add another character to this array without knowing the length of the string in c? (the part that are actual letters and not like empty memmory spaces of romething)</p>\n\n<p>note: my buffer is long enough for what I want to ask the user (a filename, Probebly not many people have names longer that 29 characters)</p>\n"}, {"tags": ["c", "arrays", "pointers", "csv"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423654055, "post_id": 28453125, "comment_id": 45233406, "body": "<code>char*** myarray;</code>... no, i&#39;m not a three-star programmer. I&#39;m also confused :-)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1423654123, "post_id": 28453125, "comment_id": 45233450, "body": "To start with, <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">in C you should not cast the result of <code>malloc</code></a>. To continue, take a look at the second loop allocating memory, and <i>what</i> it allocates. Then realize that all <code>myarray[i][j]</code> pointers you set, you set to exactly the same."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1423654235, "post_id": 28453125, "comment_id": 45233531, "body": "Oh, and you don&#39;t need the <code>!feof(fp)</code> check in the loop condition, <code>fgets</code> will return <code>NULL</code> if you hit end of file and exit the loop <i>before</i> <code>feof(fp)</code> returns true."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423654600, "post_id": 28453125, "comment_id": 45233762, "body": "@SouravGhosh this is one situation where the three stars appear to be a good solution."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 4554380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/315b74a086b3f1bb222dc68f6de9d894?s=128&d=identicon&r=PG&f=1", "display_name": "Charlton", "link": "https://stackoverflow.com/users/4554380/charlton"}, "edited": false, "score": 0, "creation_date": 1423661833, "post_id": 28453202, "comment_id": 45238055, "body": "Thanks iharob, very informative. For clarification, how come char *varTemp is no good and char varTemp[100] is required? Does sscanf require an array of chars to use as buffer rather than a linked list?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 148, "user_id": 4554380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/315b74a086b3f1bb222dc68f6de9d894?s=128&d=identicon&r=PG&f=1", "display_name": "Charlton", "link": "https://stackoverflow.com/users/4554380/charlton"}, "edited": false, "score": 0, "creation_date": 1423662720, "post_id": 28453202, "comment_id": 45238610, "body": "@user4554380 I think I made it clear now, if I didn&#39;t please let me know."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 2, "last_activity_date": 1423662684, "last_edit_date": 1495539964, "creation_date": 1423654132, "answer_id": 28453202, "question_id": 28453125, "link": "https://stackoverflow.com/questions/28453125/read-csv-file-of-strings-to-2d-char-array-using-c/28453202#28453202", "title": "Read csv file of strings to 2D char* array using C", "body": "<p>You never allocate space for <code>varTemp</code>, you need space for the <code>scanf()</code>d string to be stored, so you could try this</p>\n\n<pre><code>char varTemp[100];\n</code></pre>\n\n<p>and <code>scanf()</code> this way</p>\n\n<pre><code>sscanf(strTemp, \"%99s\", varTemp);\n</code></pre>\n\n<p>and then copy the <code>varTemp</code> string to the array by <code>malloc()</code>ing and then <code>strcpy()</code>ing.</p>\n\n<p>The reason you need to copy the string is because you will overwrite it on subsequent calls to <code>sscanf()</code> so you copy it and use <code>varTemp</code> as a buffer to store the <code>scanf()</code>ed string.</p>\n\n<p>Also <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">Don't cast <code>malloc()</code></a>, and this <code>!feof(fp)</code> check in the <code>while</code> loop is superfluous, it will never be true, because when you reach the end of file <code>fgets()</code> will return <code>NULL</code> and then after that <code>feof()</code> will be true, so it's never evaluated when it would return true.</p>\n\n<p>It doesn't matter in this case because <code>sizeof(char *) == sizeof(char **)</code> but as a rule, you should <code>malloc()</code> with one star less than that of the pointer you are <code>malloc()</code>ing for, so</p>\n\n<pre><code>if ((myarray[i] = malloc(COLS * sizeof(char *))) == NULL)\n</code></pre>\n\n<p>would be easier to understand, and also on failure you just return from <code>main()</code> without freeing the previously allocated pointers.</p>\n\n<p>Finally if <code>COLS</code> and <code>ROWS</code> are fixed values there is absolutely no need for <code>malloc()</code> unless your array will be resized later or they are too big for the stack to hold them.</p>\n\n<p><code>char *varTemp</code> is a pointer, for it to be valid it should point somewhere, you can make it point somewhere by requesting that somewher from the OS via <code>malloc()</code>, like</p>\n\n<pre><code>char *varTemp;\nvarTemp = malloc(NumberOfBytesIWant);\nif (varTemp == NULL)\n    ohNo_TheSystemDidNotGiveMeMemory_PerhapsThereIsNoMemoryLeft_IShouldNotContinue();\n/* now varTemp is accessible and you are allowed to write NumberOfBytesIWant\n * into it. But you must remember to calll 'free(varTemp)' later when you no\n * longer need the data.\n */\n</code></pre>\n\n<p>I'ts not the only way you can make it point somewhere, this way you can dynamically allocate space and that is very often the appropriate solution when you have found out how many bytes you need, then just ask for that amount, nothing more and nothing less, but this would also work</p>\n\n<pre><code>char array[100];\nchar *varTemp;\n\nvarTemp = array;\n</code></pre>\n\n<p>arrays in c decay to pointers, so the above is valid and in this example <code>varTemp</code> is also accessible and you can for instance <code>sscanf(sourceString, \"%99s\", varTemp);</code>.</p>\n\n<p>But when you are not pointing to any valid memory address with your pointer, trying to access it is undefined behavior, since it's <strong>not defined</strong> where the pointer is pointing to.</p>\n"}], "owner": {"reputation": 148, "user_id": 4554380, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/315b74a086b3f1bb222dc68f6de9d894?s=128&d=identicon&r=PG&f=1", "display_name": "Charlton", "link": "https://stackoverflow.com/users/4554380/charlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 28453202, "answer_count": 1, "score": -1, "last_activity_date": 1423662684, "creation_date": 1423653875, "last_edit_date": 1423654512, "question_id": 28453125, "link": "https://stackoverflow.com/questions/28453125/read-csv-file-of-strings-to-2d-char-array-using-c", "title": "Read csv file of strings to 2D char* array using C", "body": "<p>I have searched and searched for a solution to this, can find plenty of answers about multidimensional arrays of int, float, double, but no char*. I think I have a grasp of the principles of pointers, know the difference between char, char* and char[] etc but a pointer to a 2D array of char pointers has got the better of me. I'm trying to parse a csv file and fill my 2D array with strings (char*). Here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define COLS 10\n#define ROWS 1000\n\nint main (void) {\n        char***myarray;\n        FILE *fp;\n        char charTemp[100];\n        char *varTemp = NULL;\n        char *strTemp = NULL;\n        int i, j;\n\n        // allocate memory to hold array ROWS\n        if (( myarray = (char***) malloc(ROWS * sizeof(char**))) == NULL )\n            return -1;\n\n        // then allocate memory to hold array COLS\n        for (i = 0; i &lt; ROWS; i++)\n        {\n            if (( myarray[i] = (char**) malloc(COLS * sizeof(char**))) == NULL )\n                return -2;\n        }\n\n        // read file\n        if ((fp = fopen (\"myfile.csv\", \"r\")) == NULL)\n            return -3;\n\n        // parse and fill 'myarray'\n        i = 0;\n        j = 0;\n\n        while (!feof(fp) &amp;&amp; fgets(charTemp, sizeof charTemp, fp)) {\n                strTemp = strtok(charTemp, \",\");\n                while (strTemp != NULL) {\n                    sscanf(strTemp, \"%s\", &amp;varTemp);\n                    myarray[i][j] = varTemp;\n                    printf(\"%s \", myarray[i][j]);\n                    j++;\n                    if (j &gt; COLS - 1)\n                        j = 0;\n                    strTemp = strtok( NULL, \",\" );\n                }   \n                printf(\"\\n\");\n                i++;\n            }\n        return 0;\n}\n</code></pre>\n\n<p>myfile.csv looks something like this:\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ABCD,1,0.2,0.5,0,A123,ZZ,1,120,1\nBCDE,1.038,0,0.525,0,B321,YY,1.25,100,0.7\nCDEF,1,0.2,0.5,0,C3P0,XX,1,120,1\nDEFG,,,,,,,,,\nEFGH,1,0.3,0.8,0,R2D2,WW,1.25,120,1\nFGHI,,,,,,,,,\netc.....\n</code></pre>\n\n<p>I know some are ints and floats etc but I want them all to go in as char* then I can atoi or whatever when I need to use them.</p>\n\n<p>The printf is just to view what I have loaded to test. If I use token %.*s it displays, if I use %s it segfaults at the printf line. I assume this means I am missing null pointers at the end of my strings??</p>\n\n<p>Debugging suggests varTemp is using memory out of bounds. Additionally, when using printf with <code>%.*s</code> on rows with no data after first key, it prints COL 0 in COL 1 position as well where there should be a <code>NULL</code> pointer. i.e.:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>ABCD 1 0.2 0.5 0 A123 ZZ 1 120 1\nBCDE 1.038 0 0.525 0 B321 YY 1.25 100 0.7\nCDEF 1 0.2 0.5 0 C3P0 XX 1 120 1\nDEFG DEFG\nEFGH 1 0.3 0.8 0 R2D2 WW 1.25 120 1\nFGHI FGHI\netc.....\n</code></pre>\n\n<p>I'm confused, any ideas?!</p>\n"}, {"tags": ["c", "libwebsockets"], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 1140799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4yyBR.png?s=128&g=1", "display_name": "GMemory", "link": "https://stackoverflow.com/users/1140799/gmemory"}, "is_accepted": false, "score": 0, "last_activity_date": 1423656741, "creation_date": 1423656741, "answer_id": 28454077, "question_id": 28453014, "link": "https://stackoverflow.com/questions/28453014/libwebsockets-how-to-store-ip-address-with-request/28454077#28454077", "title": "libwebsockets: how to store IP address with request", "body": "<p>Okay, it appears I can work around this by getting the descriptor using <code>libwebsocket_get_socket_fd</code> in a later callback (such as <code>LWS_CALLBACK_HTTP</code>)</p>\n\n<p>It concerns me that the documentation says \" <em>You will not need this unless you are doing something special</em> \" regarding this particular function, but it seems to work correctly after running a few tests.</p>\n\n<p>I wonder if there's a less obtuse way of doing this.</p>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 1140799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4yyBR.png?s=128&g=1", "display_name": "GMemory", "link": "https://stackoverflow.com/users/1140799/gmemory"}, "edited": false, "score": 0, "creation_date": 1428503069, "post_id": 29516754, "comment_id": 47190046, "body": "Thanks! I knew there had to be something more sane than the workaround I have been using. I just wish I didn&#39;t have such trouble getting my head around the documentation..."}], "tags": [], "owner": {"reputation": 36, "user_id": 4764306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ESfLx.jpg?s=128&g=1", "display_name": "Kame Graf", "link": "https://stackoverflow.com/users/4764306/kame-graf"}, "is_accepted": true, "score": 2, "last_activity_date": 1428501374, "creation_date": 1428501374, "answer_id": 29516754, "question_id": 28453014, "link": "https://stackoverflow.com/questions/28453014/libwebsockets-how-to-store-ip-address-with-request/29516754#29516754", "title": "libwebsockets: how to store IP address with request", "body": "<p>You almost had it.</p>\n\n<p>If you replace the <code>(int)(long)in</code> with <code>libwebsocket_get_socket_fd(wsi)</code> you can use it in other callbacks.</p>\n\n<pre><code>switch (reason) {\n    case LWS_CALLBACK_HTTP:\n             int IP_SIZE = 50;\n             char client_name [IP_SIZE];\n             char client_ip   [IP_SIZE];\n             libwebsockets_get_peer_addresses(context, wsi, libwebsocket_get_socket_fd(wsi), \n                      client_name, sizeof(client_name), \n                      client_ip, sizeof(client_ip));\n\n             fprintf(stderr, \"Received network connect from %s (%s)\\n\",\n                                    client_name, client_ip);\n             ...\n}\n</code></pre>\n\n<p>Output:</p>\n\n<p>Received network connect from xxxxxxxx.dip0.t-ipconnect.de (93.208.91.xxx)</p>\n"}], "owner": {"reputation": 137, "user_id": 1140799, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4yyBR.png?s=128&g=1", "display_name": "GMemory", "link": "https://stackoverflow.com/users/1140799/gmemory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1468, "favorite_count": 0, "accepted_answer_id": 29516754, "answer_count": 2, "score": 1, "last_activity_date": 1428501374, "creation_date": 1423653540, "question_id": 28453014, "link": "https://stackoverflow.com/questions/28453014/libwebsockets-how-to-store-ip-address-with-request", "title": "libwebsockets: how to store IP address with request", "body": "<p>I'm struggling to understand how I'm supposed to capture the client IP address when using libwebsockets as a server.</p>\n\n<p>From what I understand of the documentation, <code>libwebsockets_get_peer_addresses</code> is only available for use in the <code>LWS_CALLBACK_FILTER_NETWORK_CONNECTION</code> callback, but at that point the user data struct is seemingly not initialized, so any attempt to store here will segfault.</p>\n\n<p>I would have expected the IP address to be in the request headers, as per other web servers such as Apache or nginx, but in this library it seems to be only available for a certain portion of the request process and is not copied into the headers.</p>\n\n<p>This is what I'm attempting inside LWS_CALLBACK_FILTER_NETWORK_CONNECTION:</p>\n\n<pre><code>char client_name [IP_SIZE];\nchar client_ip   [IP_SIZE];\n\nlibwebsockets_get_peer_addresses(context, wsi, (int)(long)in, \n                                 client_name, sizeof(client_name),\n                                 client_ip, sizeof(client_ip));\n\nstrncpy(pss-&gt;ip, client_ip, sizeof(client_ip)); // segfault\n</code></pre>\n\n<p>I've tested the <code>strncpy</code> inside another callback (<code>LWS_CALLBACK_HTTP</code>) so I know that it <em>should</em> work when that <code>pss</code> has been initialized.</p>\n\n<p>Any help would be appreciated because I find the documentation for the library very difficult to comprehend.</p>\n"}, {"tags": ["c", "oracle", "plsql"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1423654644, "post_id": 28452913, "comment_id": 45233796, "body": "Sigh. Hex is a representation for printing, not a datatype."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1423654675, "post_id": 28452913, "comment_id": 45233816, "body": "If you can place the file on the net  (lan or wan) where the oracle server can access it, then the last option in the accepted answer of this question would do the trick:  <a href=\"http://stackoverflow.com/questions/21855935/inserting-image-into-blob-oracle-10g\" title=\"inserting image into blob oracle 10g\">stackoverflow.com/questions/21855935/&hellip;</a>"}, {"owner": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "edited": false, "score": 1, "creation_date": 1423654934, "post_id": 28452913, "comment_id": 45233964, "body": "I can&#39;t... Is there a way to build a BLOB object with a pl/sql block by &quot;pieces&quot;?"}, {"owner": {"reputation": 3097, "user_id": 3070062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20c7574a287e2a9be02000157f65532?s=128&d=identicon&r=PG&f=1", "display_name": "Falco", "link": "https://stackoverflow.com/users/3070062/falco"}, "edited": false, "score": 1, "creation_date": 1423657637, "post_id": 28452913, "comment_id": 45235595, "body": "Can&#39;t you call PL/SQL from C using Bind-Variables and assigning a BLOB directly ?"}, {"owner": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "edited": false, "score": 0, "creation_date": 1423673926, "post_id": 28452913, "comment_id": 45246160, "body": "Will try this out tomorrow."}], "answers": [{"comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "edited": false, "score": 1, "creation_date": 1423657733, "post_id": 28454294, "comment_id": 45235651, "body": "It works as long as the images are small. If you need to be able to handle large blobs this method will be very cumbersome."}, {"owner": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "edited": false, "score": 0, "creation_date": 1423673889, "post_id": 28454294, "comment_id": 45246128, "body": "I will pick this up again tomorrow and will give some feedback."}, {"owner": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "edited": false, "score": 1, "creation_date": 1424171268, "post_id": 28454294, "comment_id": 45432518, "body": "That examples link was the best solution. Solved all my problems, thank you Klas."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 1, "last_activity_date": 1423660107, "last_edit_date": 1423660107, "creation_date": 1423657465, "answer_id": 28454294, "question_id": 28452913, "link": "https://stackoverflow.com/questions/28452913/how-to-insert-a-large-hex-into-a-blob-column/28454294#28454294", "title": "How to insert a large hex into a BLOB column?", "body": "<p>The problem is transferring the data from C to the PL function since each parameter is limited in size. If the max size of the image is known you can declare a function/procedure with enough parameters and cut up the data. Unfortunately, the RAW data type is limited to 2000 bytes:</p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE insert_blob(key test.id%type, \n        part1 RAW(2000), \n        part2 RAW(2000), \n        part3 RAW(2000), \n        part4 RAW(2000), \n        part5 RAW(2000)),\n        part6 RAW(2000)),\n        part7 RAW(2000)),\n        part8 RAW(2000)),\n        part9 RAW(2000)),\n        part10 RAW(2000)) AS\n    l_blob BLOB;\nBEGIN\n    DBMS_LOB.createtemporary(l_blob, FALSE);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part1), part1);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part2), part2);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part3), part3);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part4), part4);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part5), part5);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part6), part6);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part7), part7);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part8), part8);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part9), part9);\n    DBMS_LOB.writeappend (l_blob, UTL_RAW.length(part10), part10);\n    UPDATE test SET qrcodeIMG = l_blob WHERE id = key;\n    commit;\n   DBMS_LOB.freetemporary(l_blob); \nEND;\n/\n</code></pre>\n\n<p>Obviously, this is not the way it is meant to be done. If you can, using a file is a better choice.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Oracle has <a href=\"http://docs.oracle.com/cd/B10501_01/appdev.920/a97269/pc_16lob.htm#1001868\" rel=\"nofollow\">examples</a> on how to properly write a LOB from C in the LOB chapter of the Pro*C/C++ Precompiler Programmer's Guide.</p>\n"}], "owner": {"reputation": 124, "user_id": 1295813, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9f94581af9fbb689ab0da7e68d4f7256?s=128&d=identicon&r=PG", "display_name": "Vcoder", "link": "https://stackoverflow.com/users/1295813/vcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1831, "favorite_count": 0, "accepted_answer_id": 28454294, "answer_count": 1, "score": 2, "last_activity_date": 1423660107, "creation_date": 1423653218, "question_id": 28452913, "link": "https://stackoverflow.com/questions/28452913/how-to-insert-a-large-hex-into-a-blob-column", "title": "How to insert a large hex into a BLOB column?", "body": "<p>I'm building a C program with PL/SQL on it, which creates a QRCODE bmp and saves that file, but i need to send it to a table column of BLOB type, the problem is I don't have access to Oracle server directory so i can't \"upload\" the file. I have been trying to send the hex via an update query with the function HEXTORAW(oracle function) like this:</p>\n\n<pre><code>update test set qrcodeIMG=hextoraw('424df64a010000...');\n</code></pre>\n\n<p>But the hex string is so large that it fails to update and says the string can only have 4000 chars...  The string has 5623 chars, but it obviously can have more acording to the size of the QRCODE generated. Is there any other way i can make this?</p>\n"}, {"tags": ["c", "pointers", "memory", "memory-leaks", "valgrind"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1423652983, "post_id": 28452808, "comment_id": 45232730, "body": "How do you know there is a memory leak? and <code>malloc(sizeof(SIZE));</code> are you sure?"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1423653091, "post_id": 28452808, "comment_id": 45232801, "body": "What is <code>SIZE</code> here ?? <code>newPtr-&gt;data = malloc(sizeof(SIZE));</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1423653117, "post_id": 28452808, "comment_id": 45232813, "body": "pretty sure that&#39;s supposed to be <b><code>malloc(SIZE)</code></b>. Your current <code>malloc(sizeof(SIZE))</code> would malloc the size of an <code>int</code> if it is a macro (and I&#39;ve no reason to think it isn&#39;t). So unless the strings you&#39;re copying are 3-chars long or shorter on a 32-bit <code>int</code> implementation, you&#39;re invoking undefined behavior with that <code>strcpy</code>."}, {"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1423653128, "post_id": 28452808, "comment_id": 45232823, "body": "You did not check the return code of the second <code>malloc</code>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1423653137, "post_id": 28452808, "comment_id": 45232833, "body": "typedeffing pointers considered harmful ..."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1423653583, "post_id": 28452808, "comment_id": 45233094, "body": "Btw, props for using Valgrind."}, {"owner": {"reputation": 7254, "user_id": 633684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FILa8kQG7TI/AAAAAAAAAAI/AAAAAAAAABE/W39twkD272Q/photo.jpg?sz=128", "display_name": "xiaofeng.li", "link": "https://stackoverflow.com/users/633684/xiaofeng-li"}, "edited": false, "score": 0, "creation_date": 1423653583, "post_id": 28452808, "comment_id": 45233096, "body": "Why do you think the problem is in this function? That&#39;s where the memory gets allocated, but maybe you should look at where it should be freed."}, {"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1423653619, "post_id": 28452808, "comment_id": 45233111, "body": "newPtr = malloc(sizeof(LISTNODE)) should be newPtr = malloc(sizeof(LISTNODEPTR)) ?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1423653651, "post_id": 28452808, "comment_id": 45233134, "body": "@Vagish I don&#39;t think so, that is one of the things that are correct."}, {"owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "edited": false, "score": 0, "creation_date": 1423653709, "post_id": 28452808, "comment_id": 45233173, "body": "<code>else if (cmp == 0)</code> you don&#39;t seem to <code>free(newPtr)</code> if this condition is not satisfied in the <code>while</code> loop. Just one I saw, there might be others."}, {"owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1423653929, "post_id": 28452808, "comment_id": 45233324, "body": "@WhozCraig When I make it <code>malloc(SIZE)</code>, <code>definitely lost: 3,003 bytes in 3 blocks</code>"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1423654547, "post_id": 28452808, "comment_id": 45233723, "body": "I don&#39;t care about the increased size loss. The previous code was flat-wrong and needed to be fixed. Your actual leak is from your failure to release the data block before the node pointer in your free. Finally, you don&#39;t need all the additional pointer juggling when doing this. That pointer-to-pointer passed to your function can do almost all of this easily. <a href=\"http://pastebin.com/EVHvauLq\" rel=\"nofollow noreferrer\">see example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "edited": false, "score": 0, "creation_date": 1423653726, "post_id": 28453036, "comment_id": 45233186, "body": "When I make it <code>malloc(SIZE)</code>, <code>definitely lost: 3,003 bytes in 3 blocks</code>"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1423653802, "post_id": 28453036, "comment_id": 45233238, "body": "as said above, <code>free</code> your <code>malloc</code>-ed space after use."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "edited": false, "score": 0, "creation_date": 1423653915, "post_id": 28453036, "comment_id": 45233316, "body": "@user4220128 using valgrind is a really good thing, but it seems that you need to learn how <code>malloc()</code>/<code>free()</code> work."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "edited": false, "score": 0, "creation_date": 1423655613, "post_id": 28453036, "comment_id": 45234338, "body": "@user4220128: Since you seem to be using Valgrind anyway: When you use <code>--leak-check=full</code>, Valgrind will tell you where the <code>malloc</code>s without matching <code>free</code>s occur."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 3, "last_activity_date": 1423653608, "creation_date": 1423653608, "answer_id": 28453036, "question_id": 28452808, "link": "https://stackoverflow.com/questions/28452808/cannot-find-the-memory-leak-staring-for-1-hour/28453036#28453036", "title": "Cannot find the memory leak. Staring for 1 hour", "body": "<p>There is a memory leak because the pointers you allocate locally in the function are never accessible from outside the function.</p>\n\n<p>Also <code>malloc(sizeof(SIZE))</code> is wrong, you should change it to <code>malloc(SIZE)</code>, and if it's a fixed value, you should proably declare the <code>data</code> member as <code>char data[SIZE]</code> instead of <code>malloc()</code>ing space for it.</p>\n\n<p><strong>SHORT ANSWER</strong><br></p>\n\n<p>The memory leak is due to your program not <code>free()</code>ing the <code>malloc()</code>ed memory.</p>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423654922, "post_id": 28453259, "comment_id": 45233956, "body": "I guess this was added after I posted my answer!"}, {"owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "edited": false, "score": 0, "creation_date": 1423662462, "post_id": 28453259, "comment_id": 45238451, "body": "Fudge me! Sorry about that. Thanks"}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": true, "score": 4, "last_activity_date": 1423654285, "creation_date": 1423654285, "answer_id": 28453259, "question_id": 28452808, "link": "https://stackoverflow.com/questions/28452808/cannot-find-the-memory-leak-staring-for-1-hour/28453259#28453259", "title": "Cannot find the memory leak. Staring for 1 hour", "body": "<p>You free the nodes, but not the data. </p>\n\n<pre><code>while ( startPtr != NULL ){\n    LISTNODEPTR tmp = startPtr;\n    startPtr = startPtr-&gt;nextPtr;\n    free(tmp-&gt;data);     // Line added\n    free(tmp);\n}   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "edited": false, "score": 0, "creation_date": 1423678791, "post_id": 28453929, "comment_id": 45248954, "body": "I rewrote the code based on your help. I&#39;m stuck again, if you could help me out that would be much appreciated: <a href=\"http://stackoverflow.com/questions/28461513/to-allocate-or-not-to-allocate-invalid-read-of-size-1-errors-staring-for-2-ho\" title=\"to allocate or not to allocate invalid read of size 1 errors staring for 2 ho\">stackoverflow.com/questions/28461513/&hellip;</a>"}], "tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 2, "last_activity_date": 1423658242, "last_edit_date": 1423658242, "creation_date": 1423656316, "answer_id": 28453929, "question_id": 28452808, "link": "https://stackoverflow.com/questions/28452808/cannot-find-the-memory-leak-staring-for-1-hour/28453929#28453929", "title": "Cannot find the memory leak. Staring for 1 hour", "body": "<p>Simplified:</p>\n\n<ul>\n<li>changed the <code>value[SIZE]</code> argument to a <code>char*</code>, since that is what it is</li>\n<li>without the confusing (and invisible) typedef</li>\n<li>malloc() is only called once you <strong>know</strong> you really need the new node</li>\n<li>removed excessive variables and conditions caused by <em>not using the pointer to pointer construct</em></li>\n<li>used strdup(), because that is simpler</li>\n</ul>\n\n<hr>\n\n<pre><code>struct listnode {\n        struct listnode *nextPtr;\n        char *data;\n        };\n\nvoid insert ( struct listnode **pp, char *value ) {\n    struct listnode *newPtr;\n    int cmp;\n\n        /* find place to insert in LL */\n    while ( *pp) {\n        /* Comparision to detect &amp; remove duplicates nodes */\n            cmp = strcmp(value, (*pp)-&gt;data);\n                /* Duplicate: nothing to do ... */\n            if (cmp == 0) return;\n                /* you're at the point where you need to add the node */\n            if (cmp &lt; 0) break;\n            pp = &amp;(*pp)-&gt;nextPtr;\n            }\n\n    /* when you get here, *pp points to the pointer you want to change.\n    ** *pp could even be NULL (if we are at the end of the list)\n    */\n\n    newPtr = malloc(sizeof *newPtr);    \n    if ( !newPtr ) { barf(); return; }\n\n    newPtr-&gt;data = strdup (value);\n        /* you could check newPtr-&gt;data here, and if null: free(newPtr) */\n\n        /* \"steal\" the pointer */\n    newPtr-&gt;nextPtr = *pp;\n        /* and inject the new pointer into the LL */\n    *pp = newPtr;\n    return;\n}\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 4220128, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/79d8c704d91a4413e8a119cf8dd7a2f2?s=128&d=identicon&r=PG&f=1", "display_name": "mmswe", "link": "https://stackoverflow.com/users/4220128/mmswe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 28453259, "answer_count": 3, "score": 0, "last_activity_date": 1423658242, "creation_date": 1423652874, "last_edit_date": 1423653849, "question_id": 28452808, "link": "https://stackoverflow.com/questions/28452808/cannot-find-the-memory-leak-staring-for-1-hour", "title": "Cannot find the memory leak. Staring for 1 hour", "body": "<p>Following C code has memory leak. I'm staring it for one hour but can't find it. I've been able to narrow it down to that function but still no luck for improvement. </p>\n\n<p>Can you help me to find it?</p>\n\n<p>Any help is appreciated. Thank you!</p>\n\n<pre><code>void insert ( LISTNODEPTR *sPtr, char value[SIZE] ) {\n    LISTNODEPTR newPtr, previousPtr, currentPtr;\n    int cmp;\n\n    newPtr = malloc(sizeof(LISTNODE));\n\n    if ( newPtr != NULL ) {\n\n        newPtr-&gt;data = malloc(sizeof(SIZE));\n\n        strcpy(newPtr-&gt;data, value);\n        newPtr-&gt;nextPtr = NULL;\n\n        previousPtr = NULL;\n        currentPtr = *sPtr;\n\n        /* Comparision to detect &amp; remove duplicates nodes */\n        while ( currentPtr != NULL ) {\n            cmp = strcmp(value, currentPtr-&gt;data);\n            if (cmp &lt; 0) {\n                /* you're at the point where you need to add the node */\n                break;\n            } else if (cmp == 0) {\n                /* value is equal, no duplicate is allowed, leave */\n\n                // since it is not added, destroy!\n                free(newPtr-&gt;data);\n                free(newPtr);\n\n                return;\n            }\n\n            previousPtr = currentPtr;\n            currentPtr = currentPtr-&gt;nextPtr;\n        }\n\n            if ( previousPtr == NULL ) {\n                newPtr-&gt;nextPtr = *sPtr;\n                *sPtr = newPtr;\n            }\n            else{\n                previousPtr-&gt;nextPtr = newPtr;\n                newPtr-&gt;nextPtr = currentPtr;\n            }\n\n    }\n\n\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>More of the code:</p>\n\n<pre><code>#define SIZE 1001\n\nstruct listNode {\n    char *data;\n    struct listNode *nextPtr;\n};\n\ntypedef struct listNode LISTNODE;\ntypedef LISTNODE *LISTNODEPTR;\n\n/* Function prototype */\nvoid insert ( LISTNODEPTR *, char[SIZE] );\n</code></pre>\n\n<p>Valgrind:</p>\n\n<pre><code>==19906== LEAK SUMMARY:\n==19906==    definitely lost: 12 bytes in 3 blocks\n==19906==    indirectly lost: 0 bytes in 0 blocks\n==19906==      possibly lost: 0 bytes in 0 blocks\n==19906==    still reachable: 0 bytes in 0 blocks\n==19906==         suppressed: 0 bytes in 0 blocks\n</code></pre>\n\n<p>If I turn sizeof(SIZE) to SIZE, then memory leaks become +3000.</p>\n\n<p><strong>Edit 2:</strong></p>\n\n<p>I do deallocate them in main()</p>\n\n<pre><code>while ( startPtr != NULL ){\n    LISTNODEPTR tmp = startPtr;\n    startPtr = startPtr-&gt;nextPtr;\n    free(tmp);\n}   \n</code></pre>\n"}, {"tags": ["c", "gdb", "stack", "arm", "corruption"], "comments": [{"owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "edited": false, "score": 1, "creation_date": 1423652700, "post_id": 28452691, "comment_id": 45232582, "body": "What exactly should we help you with? Where&#39;s the code? We&#39;re not <i>espers</i>, you know."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "edited": false, "score": 0, "creation_date": 1423653433, "post_id": 28452691, "comment_id": 45233003, "body": "I am looking for hints / direction that I should take to debug it further."}, {"owner": {"reputation": 2748, "user_id": 2879338, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e1Inh.jpg?s=128&g=1", "display_name": "Milind Dumbare", "link": "https://stackoverflow.com/users/2879338/milind-dumbare"}, "edited": false, "score": 0, "creation_date": 1423653549, "post_id": 28452691, "comment_id": 45233075, "body": "8 bytes or 8 bits? But <code>p localParam_p</code> prints the value at address <code>0x7ea5c774</code> which is correct, right?. What do you mean by the pointer <code>localParam_p</code> should rather print value at the next byte of <code>0x7ea5c774</code>"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423654025, "post_id": 28452691, "comment_id": 45233381, "body": "If you want a hint, maybe you should look for a function called with wrong parameters. If your prototypes/includes are not done correctly, the compiler won&#39;t warn you. That&#39;s why you always put the prototype in a .h that you include in both the function .c and the caller .c."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "edited": false, "score": 0, "creation_date": 1423654111, "post_id": 28452691, "comment_id": 45233441, "body": "8 bytes. <code>p localParam_p</code> printing the value at address <code>0x7ea5c774</code> is incorrect. The correct value is stored at  <code>0x7ea5c77c</code>"}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423654553, "post_id": 28452691, "comment_id": 45233727, "body": "Thanks @ElderBug. I&#39;m not sure if I understood it completely - are you suggesting that if a function call doesn&#39;t match the function prototype from the header file, the compiler won&#39;t complain?"}, {"owner": {"reputation": 25764, "user_id": 1163019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47a57beaec8e4221a9e18ca9b876e8b2?s=128&d=identicon&r=PG", "display_name": "auselen", "link": "https://stackoverflow.com/users/1163019/auselen"}, "edited": false, "score": 0, "creation_date": 1423655518, "post_id": 28452691, "comment_id": 45234280, "body": "Stack needs to be 8-byte aligned, so may be someone messing that up. Are you trying to combine pre-compiled object files or different tool chains?"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423659115, "post_id": 28452691, "comment_id": 45236452, "body": "@lalit_sam No, the compiler will complain if the call doesn&#39;t match the prototype, but won&#39;t complain if the prototype doesn&#39;t match the real function. If the prototype doesn&#39;t match the real function, the compiler will only complain if the prototype is included where the function is defined (i.e the compiler won&#39;t complain if the function can&#39;t &quot;see&quot; the wrong prototype)."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1423660974, "post_id": 28452691, "comment_id": 45237514, "body": "Note that if you&#39;re using normal ARM calling conventions function arguments should mostly be passed in registers rather than on the stack. Is the code pulling any dirty tricks that assume otherwise?"}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1423663839, "post_id": 28452691, "comment_id": 45239392, "body": "@Notlikethat You are right! Up to four arguments are being passed in registers. These have correct values. The ones on stack (and local variables) are corrupted (offset by 8 bytes). I am not sure if it is relevant but the last method in the call stack is an inline method and O2 optimization is being used."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423740610, "post_id": 28452691, "comment_id": 45275714, "body": "Thanks @ElderBug. It is a good suggestion. I am reviewing the code from this perspective. Could it also be due to mismatched argument types that are otherwise (implicitly) convertible. e.g. short to int or vice-versa. I see atleast one instance where a 32-bit signed integer is being converted to a 16-bit unsigned short. Can something of this sort cause stack corruption?"}, {"owner": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423741145, "post_id": 28452691, "comment_id": 45276005, "body": "@lalit_sam Conversions should not cause any problem. Even if it is implicit, all conversions are safe. Corruption may occur if the called prototype doesn&#39;t match the real function signature. Because the compiler will set/stack parameters according to the prototype, even if it doesn&#39;t match the real function."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 25764, "user_id": 1163019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47a57beaec8e4221a9e18ca9b876e8b2?s=128&d=identicon&r=PG", "display_name": "auselen", "link": "https://stackoverflow.com/users/1163019/auselen"}, "edited": false, "score": 0, "creation_date": 1423741203, "post_id": 28452691, "comment_id": 45276035, "body": "@auselen - No, I am not doing anything of this sort."}, {"owner": {"reputation": 25764, "user_id": 1163019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47a57beaec8e4221a9e18ca9b876e8b2?s=128&d=identicon&r=PG", "display_name": "auselen", "link": "https://stackoverflow.com/users/1163019/auselen"}, "edited": false, "score": 0, "creation_date": 1423743180, "post_id": 28452691, "comment_id": 45277192, "body": "your question is very incomplete to deduct something. try adding up some code segments or if you can&#39;t, try to create a simple piece of code reproducing the same problem."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 25764, "user_id": 1163019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47a57beaec8e4221a9e18ca9b876e8b2?s=128&d=identicon&r=PG", "display_name": "auselen", "link": "https://stackoverflow.com/users/1163019/auselen"}, "edited": false, "score": 0, "creation_date": 1423755769, "post_id": 28452691, "comment_id": 45285466, "body": "@auselen Thanks for you comments. I understand your point. I can&#39;t share the actual code due to IPR issues. I tried to reproduce the issue in a test program but in vain. Nonetheless, I will keep trying."}, {"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "reply_to_user": {"reputation": 4991, "user_id": 4340578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c75589faf097f9308a448ffe021defd1?s=128&d=identicon&r=PG&f=1", "display_name": "ElderBug", "link": "https://stackoverflow.com/users/4340578/elderbug"}, "edited": false, "score": 0, "creation_date": 1423756169, "post_id": 28452691, "comment_id": 45285731, "body": "@ElderBug This is interesting - I never thought about it before. I&#39;ll try to reproduce the problem you mentioned in a test program."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "edited": false, "score": 0, "creation_date": 1423717866, "post_id": 28457994, "comment_id": 45264409, "body": "Thanks @Tom Tromey. Are you saying that the process crash could be due to an entirely different reason and gdb result might be a red herring. I&#39;ll go ahead and try your suggestion anyway. Thanks again!"}, {"owner": {"reputation": 18871, "user_id": 1442050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e975c669f2ce0f2be4613f1e123864b3?s=128&d=identicon&r=PG", "display_name": "Tom Tromey", "link": "https://stackoverflow.com/users/1442050/tom-tromey"}, "reply_to_user": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "edited": false, "score": 0, "creation_date": 1423797680, "post_id": 28457994, "comment_id": 45304627, "body": "Sorry, I thought you wanted to know why gdb was giving the wrong answers.  It&#39;s hard to say whether or not these problems are related to the crash.  But I would suspect not."}], "tags": [], "owner": {"reputation": 18871, "user_id": 1442050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e975c669f2ce0f2be4613f1e123864b3?s=128&d=identicon&r=PG", "display_name": "Tom Tromey", "link": "https://stackoverflow.com/users/1442050/tom-tromey"}, "is_accepted": true, "score": 0, "last_activity_date": 1423668192, "creation_date": 1423668192, "answer_id": 28457994, "question_id": 28452691, "link": "https://stackoverflow.com/questions/28452691/stack-parameters-read-from-wrong-memory-address-in-the-stack/28457994#28457994", "title": "stack parameters read from wrong memory address in the stack", "body": "<p>My reaction to this sort of thing is to suspect a compiler debuginfo bug.  It could also be a gdb bug.  If I had this problem, here is what I would do:</p>\n\n<p>First, make sure I had a recent version of gdb; upgrading to the latest release if not.</p>\n\n<p>If that didn't work, enable DWARF location disassembly:</p>\n\n<pre><code>maint set dwarf2 always-disassemble on\n</code></pre>\n\n<p>Then ask for the location of the variable in question:</p>\n\n<pre><code>info addr localParm2\n</code></pre>\n\n<p>This will dump a DWARF expression showing where gdb thinks the variable is located.  DWARF expressions use a simple stack machine language, you will have to dig into the DWARF standard and perhaps some GCC extension documentation (on the GCC wiki) to understand this.</p>\n\n<p>If you are not using DWARF -- well, you should these days, and that's a good spot to start.</p>\n\n<p>This is the spot where I would expect to find the bug.  And, if so, the only answer is that you need to fix the compiler, either by upgrading or by debugging the problem there.</p>\n\n<p>It's also possible that the compiler output is correct and that you've found a gdb bug.  I think this is less likely, though, since the location expression code in gdb has been fairly well exercised.</p>\n\n<p>It's also worth double-checking that the debuginfo matches the program you are debugging.  And, it may worth looking to see if the compiler you're using has any known bugs in this area.</p>\n"}], "owner": {"reputation": 221, "user_id": 4554383, "user_type": "registered", "profile_image": "https://graph.facebook.com/891737877513578/picture?type=large", "display_name": "lalit_sam", "link": "https://stackoverflow.com/users/4554383/lalit-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "accepted_answer_id": 28457994, "answer_count": 1, "score": 0, "last_activity_date": 1424006926, "creation_date": 1423652518, "last_edit_date": 1424006926, "question_id": 28452691, "link": "https://stackoverflow.com/questions/28452691/stack-parameters-read-from-wrong-memory-address-in-the-stack", "title": "stack parameters read from wrong memory address in the stack", "body": "<p>I am trying to debug a process core dump on ARM architecture.</p>\n\n<p>It is a telecom stack software written in C. The process is single-threaded.</p>\n\n<p>Some debugging through gdb indicated that the stack parameters (local variables or function arguments) are being read from a memory location that is at a fixed offset (8 bytes) from the correct location. </p>\n\n<p>Here is some debugging information:</p>\n\n<pre><code>(gdb) p localParam_p\n$16 = (UInt8 *) 0xbe &lt;Address 0xbe out of bounds&gt;\n\n(gdb) x /16wx &amp;localParam_p\n0x7ea5c774:     0x000000be      0x00000010      0x94dc788c     0x00000000\n</code></pre>\n\n<p>The correct (expected) value is 0x94dc788c which is stored at a memory location 0x7ea5c77c (third word in the output above)</p>\n\n<p>Here is another example:</p>\n\n<pre><code>(gdb) p localParam2\n$18 = 0\n\n(gdb) x /16wx &amp;localParam2\n0x7ea5c770:     0x00000000      0x000000be      0x00000010     0x94dc788c\n</code></pre>\n\n<p>Expected value for addrLen is 0x10 (third word above).</p>\n\n<p>I can see the same issue with other local variables across stack frames. </p>\n\n<p>Kindly help! </p>\n\n<p>Valgrind can not be used on this system.</p>\n\n<p>The process has only crashed once in a duration of several days and the reproduction steps are as yet unknown.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 17349, "user_id": 1951708, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/uUTYl.jpg?s=128&g=1", "display_name": "Lorenz Meyer", "link": "https://stackoverflow.com/users/1951708/lorenz-meyer"}, "edited": false, "score": 0, "creation_date": 1423653043, "post_id": 28452479, "comment_id": 45232764, "body": "And what are your problems ? Your code ?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423660700, "post_id": 28452479, "comment_id": 45237333, "body": "Is your question really &quot;can anyone help me?&quot;. In which case the answer to the question that you asked is &quot;yes, there exist people that can help you.&quot;"}, {"owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "edited": false, "score": 0, "creation_date": 1423664347, "post_id": 28452479, "comment_id": 45239751, "body": "What a really useful answer, thank you!"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423664738, "post_id": 28452479, "comment_id": 45240012, "body": "Exactly. Completely useless to you. However, it is the answer to the question that you asked. The point is that it really matters that you ask a precise and specific question. The help you receive will be better if you do so. This requires some investment from you. So, it&#39;s now up to you to ask a better question. If you edit the question as described in the close note above we can reopen it and provide you with help."}, {"owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "edited": false, "score": 0, "creation_date": 1423665297, "post_id": 28452479, "comment_id": 45240369, "body": "I apologize for my error, I changed the question to be more precise and removed all kindness or deceptive words. I hope now the question is more understandable, thank you."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423669827, "post_id": 28452479, "comment_id": 45243470, "body": "What GUI framework, if any are you using? Raw Win32, or something more advanced?"}, {"owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "edited": false, "score": 0, "creation_date": 1423731449, "post_id": 28452479, "comment_id": 45270143, "body": "I&#39;using raw Win32 with pure C. As I wrote in a comment to the answer below the best way to put some partial formatted text in a GUI seems to be using a rich text editor control in read-only mode, but now the problem is how to properly set text in it..."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "edited": false, "score": 0, "creation_date": 1423669146, "post_id": 28452617, "comment_id": 45243010, "body": "I need to write some labels with generic characters as subscripts, unicode has only some chars codified as subscripts and the ones I need are missed."}], "tags": [], "owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "is_accepted": false, "score": 0, "last_activity_date": 1423652291, "creation_date": 1423652291, "answer_id": 28452617, "question_id": 28452479, "link": "https://stackoverflow.com/questions/28452479/using-greeks-characters-and-sub-superscript-in-win32-with-c/28452617#28452617", "title": "Using greeks characters and sub-superscript in Win32 with C", "body": "<p>If you've got a label, say, <code>HWND static</code>, you can set its text via <code>SetWindowText(static, L\"Unicode_text_\u0444\u0444\u0444\");</code>. You might want to explicitly use <code>SetWindowTextW</code>, which is the Unicode version of the function.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "edited": false, "score": 1, "creation_date": 1423672662, "post_id": 28453466, "comment_id": 45245326, "body": "Using a rich text control in read only mode sounds like the most practical way to do what I need, but as you said the problem is to set properly control text. I tried to compose the label text in a rich text editor (like Wordpad), open saved file with an ascii editor, copy the formatted text code and set it via the SetWindowText function, which should work with all windows, but I obtain an error at compiling time.. do you know how to set rich text in a rich text control? thank you a lot!"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423693208, "post_id": 28453466, "comment_id": 45256997, "body": "Rich edit controls are documented. Start there. There is also windowless rich edit which will look better."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1423693427, "post_id": 28453466, "comment_id": 45257119, "body": "Whoops, I did not see these comments.  Sorry, Filippo, I have no prior hands-on experience with Rich Edit controls, I only know that they exist and that they can be used for things like what you are trying to do."}], "tags": [], "owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "is_accepted": true, "score": 0, "last_activity_date": 1423654866, "creation_date": 1423654866, "answer_id": 28453466, "question_id": 28452479, "link": "https://stackoverflow.com/questions/28452479/using-greeks-characters-and-sub-superscript-in-win32-with-c/28453466#28453466", "title": "Using greeks characters and sub-superscript in Win32 with C", "body": "<p>You will need to instantiate either a web browser control (very heavy, but understands HTML, which is easy,) or a read-only rich text control. (Which is more lightweight but you will have to learn how to format text in it.)</p>\n"}], "owner": {"reputation": 65, "user_id": 1581899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqpfd.jpg?s=128&g=1", "display_name": "Filippo Micheletti", "link": "https://stackoverflow.com/users/1581899/filippo-micheletti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "closed_date": 1423662598, "accepted_answer_id": 28453466, "answer_count": 2, "score": 0, "last_activity_date": 1423664375, "creation_date": 1423651939, "last_edit_date": 1423664375, "question_id": 28452479, "link": "https://stackoverflow.com/questions/28452479/using-greeks-characters-and-sub-superscript-in-win32-with-c", "closed_reason": "Not suitable for this site", "title": "Using greeks characters and sub-superscript in Win32 with C", "body": "<p>I need to set some labels in an engineering software GUI using greek characters and sub or super-scripts.\nCould someone explain me how to do this programming in C with Win32?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9921, "user_id": 488195, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/aa1e7477ba2f6c0ec47ed521f1cf1676?s=128&d=identicon&r=PG", "display_name": "dgilperez", "link": "https://stackoverflow.com/users/488195/dgilperez"}, "edited": false, "score": 4, "creation_date": 1423651221, "post_id": 28452178, "comment_id": 45231741, "body": "What&#39;s your error message?"}, {"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "reply_to_user": {"reputation": 9921, "user_id": 488195, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/aa1e7477ba2f6c0ec47ed521f1cf1676?s=128&d=identicon&r=PG", "display_name": "dgilperez", "link": "https://stackoverflow.com/users/488195/dgilperez"}, "edited": false, "score": 0, "creation_date": 1423651491, "post_id": 28452178, "comment_id": 45231893, "body": "I get this message  &#39;Probleme acces fichier&#39; because f1= NULL (I think I have a problem with pointers : struct departement *undepartement() )"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 4, "creation_date": 1423651621, "post_id": 28452178, "comment_id": 45231962, "body": "What do you think <code>undepartement()</code> does? You need to <code>malloc</code> a pointer of type <code>struct departement*</code> and then return it."}, {"owner": {"reputation": 3357, "user_id": 3194340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b99bac217534b05a3f7b957e14025ccc?s=128&d=identicon&r=PG&f=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/3194340/n0p"}, "edited": false, "score": 0, "creation_date": 1423651758, "post_id": 28452178, "comment_id": 45232043, "body": "You have a redundant declaration of <code>ouvrir_fichier</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423651874, "post_id": 28452178, "comment_id": 45232096, "body": "@Netmaster enable compiler warnings. And read <a href=\"http://stackoverflow.com/questions/5431941/while-feof-file-is-always-wrong\">why is <code>while (!feof(file))</code> always wrong</a>."}, {"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "edited": false, "score": 0, "creation_date": 1423651937, "post_id": 28452178, "comment_id": 45232138, "body": "I have &#39;Segmentation fault ( core dumped )&#39; on ubuntu terminal"}, {"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "reply_to_user": {"reputation": 3357, "user_id": 3194340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b99bac217534b05a3f7b957e14025ccc?s=128&d=identicon&r=PG&f=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/3194340/n0p"}, "edited": false, "score": 0, "creation_date": 1423652000, "post_id": 28452178, "comment_id": 45232183, "body": "@Coconop I deleted it, and still have the problem"}, {"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423652078, "post_id": 28452178, "comment_id": 45232210, "body": "@iharob this is my first program, how can I do it, please? (on ubuntu)"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1423652034, "post_id": 28452489, "comment_id": 45232201, "body": "It&#39;s not the only problem, look at <code>ouvrir_fichier</code> the function only allocates the structs and doesn&#39;t return any reference to them at all."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 3, "last_activity_date": 1423651961, "creation_date": 1423651961, "answer_id": 28452489, "question_id": 28452178, "link": "https://stackoverflow.com/questions/28452178/c-file-open-error/28452489#28452489", "title": "C file open error", "body": "<p>This:</p>\n\n<pre><code>struct departement *undepartement()\n{\n    return (struct departement *) undepartement(sizeof(struct departement));\n}\n</code></pre>\n\n<p>is very wrong, it tries to return the address of the function (!) converted to a pointer to a structure, but also does an infinite recursive call that will eat your stack and cause undefined behavior.</p>\n\n<p>It should just be:</p>\n\n<pre><code>struct departement * undepartement(void)\n{\n    struct departement *p = malloc(sizeof *p);\n    return p;\n}\n</code></pre>\n\n<p>Note that functions accepting no arguments in C should be declared as <code>(void)</code>. Also note that <code>malloc()</code> can fail, you need to check the return vaule of <code>undepartement()</code> before relying on it.</p>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "edited": false, "score": 0, "creation_date": 1423657659, "post_id": 28452501, "comment_id": 45235609, "body": "Thank you, but, &#39;Basedecommunes.txt&#39; is  in the same directory of your running program."}], "tags": [], "owner": {"reputation": 3357, "user_id": 3194340, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b99bac217534b05a3f7b957e14025ccc?s=128&d=identicon&r=PG&f=1", "display_name": "n0p", "link": "https://stackoverflow.com/users/3194340/n0p"}, "is_accepted": false, "score": 1, "last_activity_date": 1423651994, "creation_date": 1423651994, "answer_id": 28452501, "question_id": 28452178, "link": "https://stackoverflow.com/questions/28452178/c-file-open-error/28452501#28452501", "title": "C file open error", "body": "<p>From <code>manpage</code>:</p>\n\n<blockquote>\n  <p>RETURN VALUE\n         Upon successful completion fopen(), fdopen()  and  freopen()  return  a\n         FILE pointer.  Otherwise, NULL is returned and errno is set to indicate\n         the error.</p>\n</blockquote>\n\n<p>So you might want to <code>#include &lt;errno.h&gt;</code> and check <code>errno</code> when your <code>fopen</code> fails to have your answer. </p>\n\n<p>My guess: maybe your file <code>Basedecommunes.txt</code> is not in the same directory of your running program.</p>\n"}], "owner": {"reputation": 287, "user_id": 974023, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c1e2702557f176ec93dc7ff340eec74c?s=128&d=identicon&r=PG", "display_name": "Netmaster", "link": "https://stackoverflow.com/users/974023/netmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 28452489, "answer_count": 2, "score": 0, "last_activity_date": 1423651994, "creation_date": 1423651185, "last_edit_date": 1423651812, "question_id": 28452178, "link": "https://stackoverflow.com/questions/28452178/c-file-open-error", "title": "C file open error", "body": "<p>I have created this program in c. The user type 'lieunaissance' and then we open a formatted file to search 'lieunaissance' value.</p>\n\n<p>The problem is that when the program try to open the file, I get an error message.</p>\n\n<p>How should I access the file?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;ctype.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;stddef.h&gt;\n#define MAX_dpt 100000\n#define CODE_NON_TROUVE \"NON_TROUVE\"\n\nstruct departement\n{\nchar codeactuel[10];\nchar anciencode[10];\nchar nom[50];\nstruct departement *predecesseur ;\nstruct departement *successeur;\n};\nstruct departement *debut_liste, *fin_liste;\nstruct departement *undepartement();\nvoid ouvrir_fichier(char Nomfichier[]);\nstruct departement *recherche_dpt(char recherche_code[]);\nstruct departement tabdpt[MAX_dpt];\nvoid ouvrir_fichier();\n\nint main()\n{\n    char sexe, reponse, date[5], annee[3], mois[4], bidon[3],lieunaissance[30], ordre[4], struct1[6], struct2[6],nir1[12],nir[13],nir2[13], nirancien[13] ;\n    int i, nombre, cle, reste,n;\n    long int val;\n    struct departement undpt, *pointeur;\n    char code[10];\n\n    scanf(\"%s\",lieunaissance);\n\n    // convertir lieu de naissance en majuscule et l'affecter \u00e0 nom\n    int k = 0;\n    while(lieunaissance[k])\n    {\n        lieunaissance[k] = toupper(lieunaissance[k]);\n        k++;\n    }\n    printf(lieunaissance);\n\n    //Lire dans le fichier\n    ouvrir_fichier(\"Basedecommunes.txt\");\n    pointeur = recherche_dpt(lieunaissance);\n    undpt    = *pointeur;\n    if (strcmp(undpt.codeactuel,CODE_NON_TROUVE)==0)\n    {\n        printf(\"Aucun \"\"%s\"\" n'a ete trouve \\n\",lieunaissance);\n    }\n    else\n    {\n        printf(\"Code actuel   : %s\\n\",undpt.codeactuel);\n        printf(\"Code ancien   : %s\\n\",undpt.anciencode);\n        printf(\"Nom du departement    : %d\\n\",undpt.nom);\n    }\n}\n\nvoid ouvrir_fichier(char Nomfichier[])\n{\n    struct departement *ptmp, *prec, *succ;\n    FILE *f1;\n    int nb, lire;\n\n    //printf(\"Entrez le nom du fichier :\");\n    //scanf(\"%s\",Nomfichier);\n\n    nb = 0;\n    f1 = fopen(Nomfichier, \"r\");\n    if (f1 == NULL)\n    {\n        printf(\"Probleme acces fichier\\n\");\n    }\n    else\n    {\n        while ((! feof(f1)) &amp;&amp; (nb &lt; MAX_dpt) )\n        {\n            ptmp = undepartement();\n            lire = fscanf (f1, \"%s %s %s\", (*ptmp).codeactuel, (*ptmp).anciencode, (*ptmp).nom);\n            if (lire != EOF)\n            {\n                (*ptmp).predecesseur = NULL ;\n                (*ptmp).successeur   = NULL;\n                if (debut_liste == NULL)\n                {\n                    debut_liste = ptmp;\n                    fin_liste   = ptmp;\n                }\n                else\n                {\n                    (*fin_liste).successeur = ptmp;\n                    (*ptmp).predecesseur    = fin_liste;\n                    fin_liste               = ptmp;\n                }\n                nb++ ;\n            }\n        }\n        /* if (! (nb &lt; MAX_dpt) )\n        {\n        printf(\"Nb departement = %d \\n\",MAX_dpt);\n        }\n        printf(\"Nb dpt lu = %d\\n\",i); */\n    }\n    fclose(f1);\n}\n\n\n/*--- fonction de recherche --- */\nstruct departement *recherche_dpt(char recherche_code[])\n{\n    struct departement ptmp, *pointeur, *pactu;\n    int trouve ;\n\n    trouve   = 0;\n    pointeur = undepartement();\n    strcpy((*pointeur).codeactuel, CODE_NON_TROUVE);\n\n    pactu = debut_liste;\n    while ((!trouve) &amp;&amp; (pactu != NULL))\n    {\n        ptmp  = (*pactu);\n        pactu = (*pactu).successeur;\n\n        trouve = ((strcmp(ptmp.codeactuel,recherche_code)) == 0) ;\n\n        if (trouve)\n        {\n            *pointeur = ptmp ;\n        }\n    }\n\n    return pointeur;\n}\n\n/* --- allocation m?moire d'une nouvelle structure --- */\nstruct departement *undepartement()\n{\n    return (struct departement *) undepartement(sizeof(struct departement));\n}\n</code></pre>\n"}, {"tags": ["c", "bitmap"], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1423651282, "post_id": 28452133, "comment_id": 45231766, "body": "I went to the page of the lib but found no documentation. Do you know where the documentation is?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1423651576, "post_id": 28452133, "comment_id": 45231936, "body": "@PaulOgilvie No idea, I just browsed the code real quick. It&#39;s a single C file."}, {"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1423673486, "post_id": 28452133, "comment_id": 45245872, "body": "EasyBMP is C++ library, I am using C"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1423651563, "last_edit_date": 1423651563, "creation_date": 1423651043, "answer_id": 28452133, "question_id": 28451742, "link": "https://stackoverflow.com/questions/28451742/how-to-read-raster-with-libbmp/28452133#28452133", "title": "How to read raster with libbmp?", "body": "<p>I don't see any reading (load) functionality in that code, so the description is a bit suspect.</p>\n\n<p>I looked at <a href=\"https://code.google.com/p/libbmp/source/browse/trunk/src/bmpfile.c\" rel=\"nofollow\">the code</a>, and there is no call to <code>open()</code> that uses a read mode, and the function <code>bmp_create()</code> does not support loading an existing file.</p>\n\n<p>The library seems to be incomplete.</p>\n\n<p>You can have a look at other libraries, perhaps <a href=\"http://easybmp.sourceforge.net/\" rel=\"nofollow\">EasyBMP</a> (which seems old, but on the other hand so is the BMP format).</p>\n"}, {"comments": [{"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1423652583, "post_id": 28452415, "comment_id": 45232516, "body": "Thank you for code. I am trying to write some functions to add it to the library. The bitmap.c contains some basic info about bitmap header, so I can try to find the bitmap data. Expecting that the header is made of these: <code>uint8_t magicNo[2]; uint32_t fsize; uint16_t creator1; uint16_t creator2; uint32_t offset;</code> the offset is the start of the bitmap pixel data."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1423651781, "creation_date": 1423651781, "answer_id": 28452415, "question_id": 28451742, "link": "https://stackoverflow.com/questions/28451742/how-to-read-raster-with-libbmp/28452415#28452415", "title": "How to read raster with libbmp?", "body": "<p>The following function reads a BMP:</p>\n\n<pre><code>char *DIBreadBmp (char *szFilename)\n{\n    BITMAPFILEHEADER    *pBmf;\n    DWORD               dwBitsSize;\n    char                *pDIB;\n    int                 fd;\n\n    if ((_sopen_s (&amp;fd, szFilename,(_O_RDONLY|_O_BINARY), _SH_DENYWR,(_S_IREAD|_S_IWRITE))) != 0) {\n        LogError (ERR_FILENOTFOUND, szFilename);\n        return (0);\n    }\n    // get length of DIB in bytes for use when reading\n    dwBitsSize = _filelength (fd);\n\n    // Go read the DIB file header and check if it's valid.\n    pBmf = malloc (sizeof(BITMAPFILEHEADER));\n\n    if ((_read (fd, (LPSTR) pBmf, sizeof (BITMAPFILEHEADER)) != sizeof (BITMAPFILEHEADER))\n    ||  (pBmf-&gt;bfType != DIB_HEADER_MARKER))\n    {\n        free(pBmf);\n        _close (fd);\n        LogError (ERR_NOT_DIB, szFilename);\n        return (0);\n    }\n    // Allocate memory for DIB\n    if (!(pDIB= malloc(dwBitsSize - sizeof(BITMAPFILEHEADER))))\n    {\n        free(pBmf);\n        _close (fd);\n        LogError (ERR_MEMORY, szFilename);\n        return (0);\n    }\n    // Go read the bits.\n    if (!_read (fd, pDIB, dwBitsSize - sizeof(BITMAPFILEHEADER)))\n    {\n        free(pDIB);\n        free(pBmf);\n        _close (fd);\n        LogError (ERR_READ, szFilename);\n        return (0);\n    }\n    _close (fd);\n    free(pBmf);\n\n    return (pDIB);\n}\n</code></pre>\n"}], "owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1023, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423651781, "creation_date": 1423649894, "question_id": 28451742, "link": "https://stackoverflow.com/questions/28451742/how-to-read-raster-with-libbmp", "title": "How to read raster with libbmp?", "body": "<p>Yesterday I have downloaded this library:\n<a href=\"http://code.google.com/p/libbmp/\" rel=\"nofollow\">http://code.google.com/p/libbmp/</a>\nThey say that this C library is designed for easily reading, writing, and modifying Windows bitmap (BMP) image files. But I could not find any function for reading the bitmap. Does anybody have idea how to read the bitmap (rgb pixels from image) in C? I use CodeBlocks IDE.</p>\n"}, {"tags": ["c", "delimiter", "string-parsing"], "comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1423649184, "post_id": 28451377, "comment_id": 45230550, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/3493714/parsing-the-value-in-between-two-xml-tags\">parsing the value in between two XML tags</a>"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1423649292, "post_id": 28451377, "comment_id": 45230607, "body": "Is the malformed close tag <code>&lt;&#47;text</code> in the second example intentional and representative?"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1423651071, "post_id": 28451377, "comment_id": 45231664, "body": "I see your question has changed completely .. Please don&#39;t change the question..so that makes the answer look wrong"}, {"owner": {"reputation": 47, "user_id": 4415617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7f1bde5f687fef4970ad210f9403?s=128&d=identicon&r=PG&f=1", "display_name": "k.dev", "link": "https://stackoverflow.com/users/4415617/k-dev"}, "reply_to_user": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1423652272, "post_id": 28451377, "comment_id": 45232320, "body": "@Gopi I have not changed the question."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1423652355, "post_id": 28451377, "comment_id": 45232382, "body": "I mean the string shown was different when you posted initially it didn&#39;t had <code>&lt;message......</code>"}, {"owner": {"reputation": 47, "user_id": 4415617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7f1bde5f687fef4970ad210f9403?s=128&d=identicon&r=PG&f=1", "display_name": "k.dev", "link": "https://stackoverflow.com/users/4415617/k-dev"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1423660392, "post_id": 28451377, "comment_id": 45237128, "body": "@tripleee It is a similar to parsing the value in between two XML tags but the difference is that in this case there could be multiple &lt;text&gt; tags so the solution given in parsing the value in between two XML tags won&#39;t work"}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "reply_to_user": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1423663782, "post_id": 28451377, "comment_id": 45239343, "body": "@Gopi I fixed the formatting so you&#39;re right that the tag wasn&#39;t originally <i>visible</i> but it was there all along.  The StackOverflow markup really sucks in that unsupported tags in body text simply disappear."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1423663829, "post_id": 28451377, "comment_id": 45239385, "body": "XML can certainly contain multiple occurrences of the same tag in the same document or even on the same line."}, {"owner": {"reputation": 47, "user_id": 4415617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7f1bde5f687fef4970ad210f9403?s=128&d=identicon&r=PG&f=1", "display_name": "k.dev", "link": "https://stackoverflow.com/users/4415617/k-dev"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1423721951, "post_id": 28451377, "comment_id": 45265736, "body": "@tripleee That malformed close tag that you are talking of is actually &lt;/text&gt;. I think it got left out while i was copying the string. So in a nut shell the close tag is &lt;/text&gt; not &lt;/text"}, {"owner": {"reputation": 47, "user_id": 4415617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7f1bde5f687fef4970ad210f9403?s=128&d=identicon&r=PG&f=1", "display_name": "k.dev", "link": "https://stackoverflow.com/users/4415617/k-dev"}, "edited": false, "score": 0, "creation_date": 1424338269, "post_id": 28451377, "comment_id": 45510622, "body": "I need to escape the double quotes in my string. Is there a way to escape it dynamically"}], "answers": [{"comments": [{"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1423650588, "post_id": 28451485, "comment_id": 45231402, "body": "&quot;I always need the data present between the <code>&lt;text&gt;</code> tag&quot; You&#39;re solving a different problem."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1423650692, "post_id": 28451485, "comment_id": 45231449, "body": "@weston I have added a <code>PS</code> please check it.. If that is the case then the initial string needs to be saved and the string which is passed to strotk() should be a different one ..How am I solving some other issue this is the solution OP wants just an addition is that the initial string shouldn&#39;t be changed"}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1423650776, "post_id": 28451485, "comment_id": 45231495, "body": "OP wants to extract the text in between the tags but your example starts with what they want to end with then breaks it up by <code>%</code>."}, {"owner": {"reputation": 50933, "user_id": 360211, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/3baKW.png?s=128&g=1", "display_name": "weston", "link": "https://stackoverflow.com/users/360211/weston"}, "edited": false, "score": 0, "creation_date": 1423651182, "post_id": 28451485, "comment_id": 45231725, "body": "Oh, I did not realize question was changed. That explains it."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 4, "last_activity_date": 1423650837, "last_edit_date": 1423650837, "creation_date": 1423649098, "answer_id": 28451485, "question_id": 28451377, "link": "https://stackoverflow.com/questions/28451377/extract-data-between-two-delimiters/28451485#28451485", "title": "Extract data between two delimiters", "body": "<p>There are functions <code>strtok()</code> and <code>strtok_r()</code> which can be used to extract the data based on the delimiters.</p>\n\n<pre><code>char a[100] = \"%20Conference%20successfully%20modified%200117246%20%20%20\";\nchar *p = strtok(a,\"%\");\nwhile(p != NULL)\n{\n  // Save the value in pointer p\n  p = strtok(NULL,\"%\");\n}\n</code></pre>\n\n<p>If you want the string <code>a</code> to be unmodified then have a separate array <code>b</code>\n<code>char b[100]</code> and copy the string to <code>b</code></p>\n\n<pre><code>strcpy(b,a);\n</code></pre>\n\n<p>Code and output:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    char a[100] = \"%20Conference%20successfully%20modified%200117246%20%20%20\";\n    char *p = strtok(a,\"%\");\n    char n[20];\n    while(p != NULL)\n    {\n      strcpy(n,p);\n      p = strtok(NULL,\"%\");\n      printf(\"%s\\n\",n);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>20Conference\n20successfully\n20modified\n200117246\n20\n20\n20\n</code></pre>\n\n<p>PS: <code>strtok()</code> modifies the passed string.Check man\n<a href=\"http://linux.die.net/man/3/strtok_r\" rel=\"nofollow\">http://linux.die.net/man/3/strtok_r</a></p>\n"}, {"tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": false, "score": 6, "last_activity_date": 1423650616, "creation_date": 1423650616, "answer_id": 28452010, "question_id": 28451377, "link": "https://stackoverflow.com/questions/28451377/extract-data-between-two-delimiters/28452010#28452010", "title": "Extract data between two delimiters", "body": "<p>I'd go with <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strstr.html\" rel=\"noreferrer\"><code>strstr()</code></a>.</p>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char data[] = \"&lt;message%20type%3D\\\"info\\\"%20code\"\n                  \"%3D\\\"20005\\\"&gt;%20&lt;text&gt;Conference%\"\n                  \"20successfully%20modified&lt;/text&gt;%\"\n                  \"20&lt;data&gt;0117246&lt;/data&gt;%20%20&lt;/mes\"\n                  \"sage&gt;%20\";\n    char *p1, *p2;\n    p1 = strstr(data, \"&lt;text&gt;\");\n    if (p1) {\n        p2 = strstr(p1, \"&lt;/text&gt;\");\n        if (p2) printf(\"%.*s\\n\", p2 - p1 - 6, p1 + 6);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4415617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7f1bde5f687fef4970ad210f9403?s=128&d=identicon&r=PG&f=1", "display_name": "k.dev", "link": "https://stackoverflow.com/users/4415617/k-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6858, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1423650837, "creation_date": 1423648796, "last_edit_date": 1423649094, "question_id": 28451377, "link": "https://stackoverflow.com/questions/28451377/extract-data-between-two-delimiters", "title": "Extract data between two delimiters", "body": "<p>I just want to know whether it is possible to pick up the data that is present between two delimiters (delimiter being a string).</p>\n\n<p>For example the original string is as under</p>\n\n<pre><code>&lt;message%20type%3D\"info\"%20code%3D\"20005\"&gt;%20&lt;text&gt;Conference%20successfully%20modified&lt;/text&gt;%20&lt;data&gt;0117246&lt;/data&gt;%20%20&lt;/message&gt;%20\n</code></pre>\n\n<p>and I want the data that is present between <code>&lt;text&gt;</code> tags. The string from which i need the data can be different. The string can also be like this </p>\n\n<pre><code>&lt;message%20type%3D\"info\"%20code%3D\"20001\"&gt;%20&lt;text&gt;Conference%20deleted&lt;/text%20%20&lt;vanity&gt;0116976&lt;/vanity&gt;%20&lt;/message&gt;%20&lt;message%20type%3D\"info\"%20code%3D\"20002\"&gt;%20&lt;text&gt;Number%20of%20conferences%20deleted&lt;/text&gt;%20&lt;data&gt;1&lt;/data&gt;%20%20&lt;/message&gt;%20  \n</code></pre>\n\n<p>but I always need the data present between the <code>&lt;text&gt;</code> tags. </p>\n\n<p>So is it possible in C language or is there any alternative?</p>\n"}, {"tags": ["c", "testing", "readfile", "qnx"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4014550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36eeb5a7c0d719ed9326fcbe5ae3e60?s=128&d=identicon&r=PG", "display_name": "Michael Matveev", "link": "https://stackoverflow.com/users/4014550/michael-matveev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423649280, "creation_date": 1423649280, "answer_id": 28451551, "question_id": 28451346, "link": "https://stackoverflow.com/questions/28451346/file-can-be-opened-but-not-read-qnx/28451551#28451551", "title": "File can be opened but not read QNX", "body": "<p>First you have to lock a file by another process that runs in background. \nExample in Perl (file_lock.pl):</p>\n\n<pre><code>#!/usr/bin/perl\nuse Fcntl qw(:flock SEEK_END);\nmy $fh = '/file/that/needs/to/be/locked';\nflock($fh, LOCK_EX) or die \"Cannot lock mailbox - $!\\n\";\nseek($fh, 0, SEEK_END) or die \"Cannot seek - $!\\n\";\nwhile (true) {}\n</code></pre>\n\n<p>Run that script in background, it will lock the file you need:</p>\n\n<pre><code>root@server:~# perl file_lock.pl &amp;\n</code></pre>\n\n<p>Then run your C code and test if the error handling works correctly.</p>\n"}], "owner": {"reputation": 11, "user_id": 4554176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6064a19c85d2ec0836697934557f909?s=128&d=identicon&r=PG&f=1", "display_name": "Tata", "link": "https://stackoverflow.com/users/4554176/tata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423649280, "creation_date": 1423648714, "question_id": 28451346, "link": "https://stackoverflow.com/questions/28451346/file-can-be-opened-but-not-read-qnx", "title": "File can be opened but not read QNX", "body": "<p>I need to test the following situation: a program in C, that runs on QNX-system, can open a file but can not read it. My task is to make sure that in this situation the program delivers the correct error message.\nManipulating file permissions does not work. </p>\n\n<p>Does anyone have an idea how to simulate this situation? Thank you very much in advance</p>\n"}, {"tags": ["stack", "c"], "comments": [{"owner": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 0, "creation_date": 1423648434, "post_id": 28451806, "comment_id": 45231035, "body": "I forgot to tell: it works because in C when you declare a new variable in the stack, it doesn&#39;t initialize the value to 0 or NULL, so the value taking is the value there was in the stack : In this case the value of p1."}, {"owner": {"reputation": 1267, "user_id": 231469, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2a51b9015fcbe61ed91d8146b2714?s=128&d=identicon&r=PG", "display_name": "Dave Clarke", "link": "https://stackoverflow.com/users/231469/dave-clarke"}, "edited": false, "score": 1, "creation_date": 1423648714, "post_id": 28451806, "comment_id": 45231036, "body": "Some would call this a terrible idea. It relies too heavily on implementation details that do not appear in the C standard."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1423650639, "post_id": 28451806, "comment_id": 45231426, "body": "Try adding something like <code>char dummy[16];</code> above <code>Pouet p2;</code> and see whether it still works as expected."}, {"owner": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 0, "creation_date": 1423651809, "post_id": 28451806, "comment_id": 45232064, "body": "No it segfault, if you touch the stack between the end of test2() and Pouet p2; it doesn&#39;t work. I really don&#39;t think you can use that in a real program but it&#39;s a cool hack imo"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1423650230, "creation_date": 1423650230, "answer_id": 28451879, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack/28451879#28451879", "title": "Passing Data through the Stack", "body": "<p>Of course there's a chance you can get corrupted data; you're using <em>undefined behavior</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 0, "creation_date": 1423652070, "post_id": 28451896, "comment_id": 45232208, "body": "I&#39;m trying to know if this undefined behavior can be used, I won&#39;t be using this in any project it&#39;s too dangerous."}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 1, "creation_date": 1423652235, "post_id": 28451896, "comment_id": 45232291, "body": "@Jiloko When the behavior is undefined anything can happen so if you ask <code>I&#39;m trying to know if this undefined behavior can be used?</code> I say NO NO NO.. Please don&#39;t rely on this"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 0, "creation_date": 1423653229, "post_id": 28451896, "comment_id": 45232886, "body": "@Jiloko: There is no distinction between serious and &quot;less serious&quot; UB, as far as C standard is concerned. Your program may crash or provide unpredictable output. In theory it may even wipe your hard disk, although it is rather unlikely to happen. See <a href=\"http://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">Undefined behavior</a> for more details."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 1, "last_activity_date": 1423650611, "last_edit_date": 1423650611, "creation_date": 1423650285, "answer_id": 28451896, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack/28451896#28451896", "title": "Passing Data through the Stack", "body": "<p>What you have is undefined behavior.</p>\n\n<pre><code>printf(\"Element of struct undeclared : %d %d %d %c \\'%s\\'\\n\", p2.a, p2.b, p2.c, p2.d, p2.e);\n</code></pre>\n\n<p>The scope of the variable p2 is local to function <code>test2()</code> and as soon as you exit the function the variable is no more valid.</p>\n\n<p>You are accessing uninitialized variables which will lead to undefined behavior.</p>\n\n<p>The output what you see is not guaranteed at all times and on all platforms. So you need to get rid of the undefined behavior in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": false, "score": 0, "last_activity_date": 1423650310, "creation_date": 1423650310, "answer_id": 28451909, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack/28451909#28451909", "title": "Passing Data through the Stack", "body": "<p>The data may or may not appear in <code>test2</code>. It depends on exactly how the program was compiled. It's more likely to work in a toy example like yours than in a real program, and it's more likely to work if you turn off compiler optimizations.</p>\n\n<p>The language definition says that the local variable ceases to exist at the end of the function. Attempting to read the address where you think it was stored may or may produce a result; it could even crash the program, or make it execute some completely unexpected code. It's <a href=\"http://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>For example, the compiler might decide to put a variable in registers in one function but not in the other, breaking the alignment of variables on the stack. It can even do that with a big struct, splitting it into several registers and some stack \u2014\u00a0as long as you don't take the address of the struct it doesn't need to exist as an addressable chunk of memory. The compiler might write a stack canary on top of one of the variables. These are just possibilities at the top of my head.</p>\n\n<p>C lets you see a lot behind the scenes. A lot of what you see behind the scenes can completely change from one <strike>production</strike> compilation or run to the next.</p>\n\n<p>Understanding what's going on here is useful as a debugging skill, to understand where values that you see in a debugger might be coming from. As a programming technique, this is useless since you aren't making the computer accomplish any particular result.</p>\n"}, {"tags": [], "owner": {"reputation": 11910, "user_id": 357448, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/23fc4cd28495731ed543bb414c90ae88?s=128&d=identicon&r=PG", "display_name": "inquam", "link": "https://stackoverflow.com/users/357448/inquam"}, "is_accepted": false, "score": 0, "last_activity_date": 1423650766, "creation_date": 1423650766, "answer_id": 28452052, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack/28452052#28452052", "title": "Passing Data through the Stack", "body": "<p>Just because this works for one compiler doesn't mean that it will for all. How uninitialized variables are handled is undefined and one computer could very well init pointers to null etc without breaking any rules.\nSo don't do this or rely on it. I have actually seen code that depended on functionality in mysql that was a bug. When that was fixed in later versions the program stopped working. My thoughts about the designer of that system I'll keep to myself. </p>\n\n<p>In short, never rely on functionality that is not defined. If you knowingly use it for a specific function and you are prepared that an update to the compiler etc can break it and you keep an eye out for this at all times it might be something you could explain and live with. But most of the time this is far from a good idea. </p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "edited": false, "score": 1, "creation_date": 1423654143, "post_id": 28452432, "comment_id": 45233466, "body": "I validate your answer as you explain exactly what&#39;s happening"}], "tags": [], "owner": {"reputation": 5482, "user_id": 3079266, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a3957246a6593b75c3b706364f0c553d?s=128&d=identicon&r=PG&f=1", "display_name": "Mints97", "link": "https://stackoverflow.com/users/3079266/mints97"}, "is_accepted": true, "score": 1, "last_activity_date": 1423651830, "creation_date": 1423651830, "answer_id": 28452432, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack/28452432#28452432", "title": "Passing Data through the Stack", "body": "<p>Contrary to the opinion of the majority, I think it can work out in most of the cases (not that you should rely on it, though).</p>\n\n<p>Let's check it out. First you call <code>test1</code>, and it gets a new <em>stack frame</em>: the <em>stack pointer</em> which signifies the top of the stack goes up. On that stack frame, besides other things, memory for your struct (exactly the size of <code>sizeof(struct pouet)</code>) is reserved and then initialized. What happens when <code>test1</code> returns? Does its stack frame, along with your memory, get destroyed?</p>\n\n<p>Quite the opposite. It stays on the stack. However, the stack pointer drops below it, back into the calling function. You see, this is quite a simple operation, it's just a matter of changing the stack pointer's value. I doubt there is any technology that clears a stack frame when it is disposed. It's just too costy a thing to do!</p>\n\n<p>What happens then? Well, you call <code>test2</code>. All it stores on the stack is just another instance of <code>struct pouet</code>, which means that its stack frame will <em>most probably</em> be exactly the same size as that of <code>test1</code>. This also means that <code>test2</code> will reserve the memory that previously contained your initialized <code>struct pouet</code> for its own variable <code>Pouet p2</code>, since both variables should <em>most probably</em> have the same positions relative to the beginning of the stack frame. Which in turn means that it will be initialized to the same value.</p>\n\n<p>However, this setup is not something to be relied upon. Even with concerns about non-standartized behaviour aside, it's bound to be broken by something as simple as a call to a different function between the calls to <code>test1</code> and <code>test2</code>, or <code>test1</code> and <code>test2</code> having stack frames of different sizes.</p>\n\n<p>Also, you should take compiler optimizations into account, which could break things too. However, the more similar your functions are, the less chances there are that they will receive different optimization treatment.</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://computerscience.stackexchange.com"], "markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1439905020, "open_beta_date": 1332272936, "closed_beta_date": 1331060400, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/cs/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/cs/Img/apple-touch-icon.png", "audience": "students, researchers and practitioners of computer science", "site_url": "https://cs.stackexchange.com", "api_site_parameter": "cs", "logo_url": "https://cdn.sstatic.net/Sites/cs/Img/logo.png", "name": "Computer Science", "site_type": "main_site"}, "on_date": 1423650035, "question_id": 38241}, "owner": {"reputation": 125, "user_id": 1812332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75b5ebbd1e7989347f80dfb609988011?s=128&d=identicon&r=PG", "display_name": "Gwenael Larmet", "link": "https://stackoverflow.com/users/1812332/gwenael-larmet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 28452432, "answer_count": 5, "score": 0, "last_activity_date": 1423651830, "creation_date": 1423647417, "last_edit_date": 1592644375, "question_id": 28451806, "link": "https://stackoverflow.com/questions/28451806/passing-data-through-the-stack", "title": "Passing Data through the Stack", "body": "<p>I wanted to see if you could pass struct through the stack and I manage to get a local var from a void function in another void function.</p>\n<p>Do you guys thinks there is any use to that and is there any chance you can get corrupted data between the two function call ?</p>\n<p>Here's the Code in C (I know it's dirty)</p>\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct pouet\n{\n    int a,b,c;\n    char d;\n    char * e;\n}Pouet;\n\nvoid test1()\n{\n    Pouet p1;\n    p1.a = 1;\n    p1.b = 2;\n    p1.c = 3;\n    p1.d = 'a';\n    p1.e = &quot;1234567890&quot;;\n    printf(&quot;Declared struct              : %d %d %d %c \\'%s\\'\\n&quot;, p1.a, p1.b, p1.c, p1.d, p1.e);\n}\n\nvoid test2()\n{\n    Pouet p2;\n    printf(&quot;Element of struct undeclared : %d %d %d %c \\'%s\\'\\n&quot;, p2.a, p2.b, p2.c, p2.d, p2.e);\n    p2.a++;\n}\n\nint main()\n{\n    test1();\n    test2();\n    test2();\n    return 0;\n}\n</code></pre>\n<p>Output is :</p>\n<blockquote>\n<p>Declared struct              : 1 2 3 a '1234567890'</p>\n<p>Element of struct undeclared : 1 2 3 a '1234567890'</p>\n<p>Element of struct undeclared : 2 2 3 a '1234567890'</p>\n</blockquote>\n"}, {"tags": ["c", "compilation", "linker"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 6, "creation_date": 1423646628, "post_id": 28450624, "comment_id": 45229041, "body": "&quot;The runtime code&quot; isn&#39;t part of the C standard, so the C standard cannot answer this question. It is a matter of how your linker operates. Dead code removal is certainly a known and used optimization strategy that is available on many platforms."}], "answers": [{"tags": [], "owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "is_accepted": true, "score": 2, "last_activity_date": 1423647254, "creation_date": 1423647254, "answer_id": 28450851, "question_id": 28450624, "link": "https://stackoverflow.com/questions/28450624/what-happens-to-a-static-c-function-that-is-not-called/28450851#28450851", "title": "what happens to a static c function that is not called", "body": "<p>This depends on linker,what does it with dead code is linker specific.\nYou should also include function definition under <code>#if</code> to make sure that it wont results into machine code.</p>\n"}, {"tags": [], "owner": {"reputation": 280, "user_id": 1554502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3978eb75534e71eb5e14be5c8645356a?s=128&d=identicon&r=PG", "display_name": "Konstantin.Krivyakin", "link": "https://stackoverflow.com/users/1554502/konstantin-krivyakin"}, "is_accepted": false, "score": 1, "last_activity_date": 1423647356, "last_edit_date": 1495542440, "creation_date": 1423647356, "answer_id": 28450890, "question_id": 28450624, "link": "https://stackoverflow.com/questions/28450624/what-happens-to-a-static-c-function-that-is-not-called/28450890#28450890", "title": "what happens to a static c function that is not called", "body": "<p>It depends on optimization level. On linux you can check it youself using\n<code>readelf -s ./a.out | grep func2</code></p>\n\n<p>But I think you use windows, so you need some similar tool <a href=\"http://www.pe-explorer.com/\" rel=\"nofollow noreferrer\">http://www.pe-explorer.com/</a> for example.</p>\n\n<p>Here is list of tools: <a href=\"https://stackoverflow.com/questions/2221806/any-tool-software-in-windows-for-viewing-elf-file-format\">Any tool/software in windows for viewing ELF file format?</a></p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 4553545, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-55_v5WwnDx8/AAAAAAAAAAI/AAAAAAAAA9A/vDozr1ECyfA/photo.jpg?sz=128", "display_name": "Rabinarayan Sahu", "link": "https://stackoverflow.com/users/4553545/rabinarayan-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1423647691, "creation_date": 1423647691, "answer_id": 28451010, "question_id": 28450624, "link": "https://stackoverflow.com/questions/28450624/what-happens-to-a-static-c-function-that-is-not-called/28451010#28451010", "title": "what happens to a static c function that is not called", "body": "<p>You would need to embed the function definitions also in an #if to achieve the goal.</p>\n\n<p>code may be something like this:</p>\n\n<p>Let's say the variable \"num\" is getting populated form configuration.</p>\n\n<pre><code>int _tmain(int argc, _TCHAR* argv[]) {\n    int i;\n#if (num&gt;99)\n    i = func();\n#else\n    i= func2();\n#endif\n    return 0;\n}\n\n#if(num&gt;99)\nstatic int func()\n{\n    return 1;\n}\n#else\nstatic int func2()\n{\n    return 2;\n}\n#endif\n</code></pre>\n\n<p>Hope it helps. Thank you!</p>\n"}], "owner": {"reputation": 690, "user_id": 2482566, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9af9270a61bcd91e73859e0ca799f3ed?s=128&d=identicon&r=PG", "display_name": "lsteinme", "link": "https://stackoverflow.com/users/2482566/lsteinme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 28450851, "answer_count": 3, "score": 5, "last_activity_date": 1423647691, "creation_date": 1423646577, "last_edit_date": 1423646960, "question_id": 28450624, "link": "https://stackoverflow.com/questions/28450624/what-happens-to-a-static-c-function-that-is-not-called", "title": "what happens to a static c function that is not called", "body": "<p>if you have something like this:</p>\n\n<pre><code>int _tmain(int argc, _TCHAR* argv[]) {\n    int i;\n#if (num&gt;99)\n    i = func();\n#else\n    i= func2();\n#endif\n    return 0;\n}\n\nstatic int func()\n{\n    return 1;\n}\nstatic int func2()\n{\n    return 2;\n}\n</code></pre>\n\n<p>Is it reasonable to expect that depending on if <code>num</code> is bigger or smaller then 99 ether <code>func</code> or <code>func2</code> will be removed from the runtime code?  </p>\n\n<p>Or would I rather need to also embed the functions in an <code>#if</code> to achieve this goal?</p>\n"}, {"tags": ["c++", "c", "linux", "memory", "memory-management"], "comments": [{"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1423647282, "post_id": 28450585, "comment_id": 45229441, "body": "Maybe this can be useful: <a href=\"http://stackoverflow.com/questions/1401359/understanding-linux-proc-id-maps\" title=\"understanding linux proc id maps\">stackoverflow.com/questions/1401359/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 20539, "user_id": 11698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FMhsh.jpg?s=128&g=1", "display_name": "Richard Corden", "link": "https://stackoverflow.com/users/11698/richard-corden"}, "is_accepted": true, "score": 1, "last_activity_date": 1423647573, "creation_date": 1423647573, "answer_id": 28450963, "question_id": 28450585, "link": "https://stackoverflow.com/questions/28450585/how-to-find-out-the-memory-footprint-of-my-linux-application/28450963#28450963", "title": "How to find out the memory footprint of my linux application?", "body": "<p>For the binaries valgrind's <a href=\"http://valgrind.org/docs/manual/ms-manual.html\" rel=\"nofollow\">massif</a> tool is very useful.  To help with processing the data I would also recommend <a href=\"https://gitorious.org/massif-visualizer\" rel=\"nofollow\">massif-visualizer</a>.  Using these tools you can find which functions that are allocating memory and how much memory they hold at any specific time.</p>\n\n<p>Given that your application is intended to run as a daemon, the most important consideration is that the memory usage remains constant throughout its lifetime.</p>\n"}, {"tags": [], "owner": {"reputation": 14, "user_id": 4519772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6623eb816e404467feb8ac9934d901a7?s=128&d=identicon&r=PG&f=1", "display_name": "fcr", "link": "https://stackoverflow.com/users/4519772/fcr"}, "is_accepted": false, "score": -1, "last_activity_date": 1423647873, "creation_date": 1423647873, "answer_id": 28451060, "question_id": 28450585, "link": "https://stackoverflow.com/questions/28450585/how-to-find-out-the-memory-footprint-of-my-linux-application/28451060#28451060", "title": "How to find out the memory footprint of my linux application?", "body": "<p>You should take the shared libraries into account:\n<a href=\"https://en.wikipedia.org/wiki/Memory_footprint\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Memory_footprint</a></p>\n"}], "owner": {"reputation": 35623, "user_id": 1003575, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cceded39fb12d936211b56afc86dcb04?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAMED", "link": "https://stackoverflow.com/users/1003575/mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 28450963, "answer_count": 2, "score": 0, "last_activity_date": 1423651420, "creation_date": 1423646479, "last_edit_date": 1423651420, "question_id": 28450585, "link": "https://stackoverflow.com/questions/28450585/how-to-find-out-the-memory-footprint-of-my-linux-application", "title": "How to find out the memory footprint of my linux application?", "body": "<p>I m developping a c application running on linux as daemon.</p>\n\n<p>My application is loading 3 shared libraries(<code>*.so</code>). And for some times it execute a shell scripts.</p>\n\n<p>Should I take on account the script shell and the 3 shared libraries in the calculation of my footprint?</p>\n\n<p>How I can find out the memory footprint of my application?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Is it possible to extract the footprint from the <code>/proc/$pid/maps</code>?</p>\n\n<pre><code>root@Linux:~# cat /proc/25998/maps\n00400000-00412000 r-xp 00000000 1f:00 2823       /usr/sbin/mydaemond\n00422000-00423000 rw-p 00012000 1f:00 2823       /usr/sbin/mydaemond\n005a9000-005db000 rwxp 00000000 00:00 0          [heap]\n76bd3000-76bd4000 ---p 00000000 00:00 0\n76bd4000-76dd3000 rw-p 00000000 00:00 0          [stack:26009]\n76dd3000-76dd4000 ---p 00000000 00:00 0\n76dd4000-76fd3000 rw-p 00000000 00:00 0          [stack:26008]\n76fd3000-76fd4000 ---p 00000000 00:00 0\n76fd4000-771d3000 rw-p 00000000 00:00 0          [stack:26007]\n771d3000-771d4000 ---p 00000000 00:00 0\n771d4000-773d3000 rw-p 00000000 00:00 0          [stack:26006]\n773d3000-773d4000 ---p 00000000 00:00 0\n773d4000-775d3000 rw-p 00000000 00:00 0          [stack:26005]\n775d3000-775d6000 r-xp 00000000 1f:00 799        /lib/libdl-0.9.33.2.so\n775d6000-775e5000 ---p 00000000 00:00 0\n775e5000-775e6000 r--p 00002000 1f:00 799        /lib/libdl-0.9.33.2.so\n775e6000-775e7000 rw-p 00003000 1f:00 799        /lib/libdl-0.9.33.2.so\n775e7000-775f9000 r-xp 00000000 1f:00 1436       /usr/lib/libz.so.1.2.7\n775f9000-77608000 ---p 00000000 00:00 0\n77608000-77609000 rw-p 00011000 1f:00 1436       /usr/lib/libz.so.1.2.7\n77609000-7764e000 r-xp 00000000 1f:00 1402       /usr/lib/libssl.so.1.0.0\n7764e000-7765e000 ---p 00000000 00:00 0\n7765e000-77662000 rw-p 00045000 1f:00 1402       /usr/lib/libssl.so.1.0.0\n77662000-77781000 r-xp 00000000 1f:00 1253       /usr/lib/libcrypto.so.1.0.0\n77781000-77790000 ---p 00000000 00:00 0\n77790000-777a1000 rw-p 0011e000 1f:00 1253       /usr/lib/libcrypto.so.1.0.0\n777a1000-777a2000 rw-p 00000000 00:00 0\n777a2000-77806000 r-xp 00000000 1f:00 808        /lib/libuClibc-0.9.33.2.so\n77806000-77815000 ---p 00000000 00:00 0\n77815000-77816000 r--p 00063000 1f:00 808        /lib/libuClibc-0.9.33.2.so\n77816000-77817000 rw-p 00064000 1f:00 808        /lib/libuClibc-0.9.33.2.so\n77817000-7781d000 rw-p 00000000 00:00 0\n7781d000-77830000 r-xp 00000000 1f:00 801        /lib/libgcc_s.so.1\n77830000-77840000 ---p 00000000 00:00 0\n77840000-77841000 rw-p 00013000 1f:00 801        /lib/libgcc_s.so.1\n77841000-77849000 r-xp 00000000 1f:00 1329       /usr/lib/libjson-c.so.2.0.1\n77849000-77858000 ---p 00000000 00:00 0\n77858000-77859000 rw-p 00007000 1f:00 1329       /usr/lib/libjson-c.so.2.0.1\n77859000-7785a000 r-xp 00000000 1f:00 1331       /usr/lib/libjson.so.0.1.0\n7785a000-77869000 ---p 00000000 00:00 0\n77869000-7786a000 rw-p 00000000 1f:00 1331       /usr/lib/libjson.so.0.1.0\n7786a000-7787d000 r-xp 00000000 1f:00 804        /lib/libpthread-0.9.33.2.so\n7787d000-7788c000 ---p 00000000 00:00 0\n7788c000-7788d000 r--p 00012000 1f:00 804        /lib/libpthread-0.9.33.2.so\n7788d000-7788e000 rw-p 00013000 1f:00 804        /lib/libpthread-0.9.33.2.so\n7788e000-77890000 rw-p 00000000 00:00 0\n77890000-778d5000 r-xp 00000000 1f:00 1255       /usr/lib/libcurl.so.4.3.0\n778d5000-778e4000 ---p 00000000 00:00 0\n778e4000-778e6000 rw-p 00044000 1f:00 1255       /usr/lib/libcurl.so.4.3.0\n778e6000-778f0000 r-xp 00000000 1f:00 1346       /usr/lib/libmicroxml.so.1.0\n778f0000-778ff000 ---p 00000000 00:00 0\n778ff000-77900000 rw-p 00009000 1f:00 1346       /usr/lib/libmicroxml.so.1.0\n77900000-77904000 r-xp 00000000 1f:00 810        /lib/libubus.so\n77904000-77913000 ---p 00000000 00:00 0\n77913000-77914000 rw-p 00003000 1f:00 810        /lib/libubus.so\n77914000-7791b000 r-xp 00000000 1f:00 809        /lib/libubox.so\n7791b000-7792a000 ---p 00000000 00:00 0\n7792a000-7792b000 rw-p 00006000 1f:00 809        /lib/libubox.so\n7792b000-77934000 r-xp 00000000 1f:00 811        /lib/libuci.so\n77934000-77943000 ---p 00000000 00:00 0\n77943000-77944000 rw-p 00008000 1f:00 811        /lib/libuci.so\n77944000-7794b000 r-xp 00000000 1f:00 793        /lib/ld-uClibc-0.9.33.2.so\n77957000-7795a000 rw-p 00000000 00:00 0\n7795a000-7795b000 r--p 00006000 1f:00 793        /lib/ld-uClibc-0.9.33.2.so\n7795b000-7795c000 rw-p 00007000 1f:00 793        /lib/ld-uClibc-0.9.33.2.so\n7fb30000-7fb51000 rwxp 00000000 00:00 0          [stack]\n7fff7000-7fff8000 r-xp 00000000 00:00 0          [vdso]\n</code></pre>\n"}, {"tags": ["c", "parsing"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423646226, "post_id": 28450479, "comment_id": 45228831, "body": "Sorry, but what is exactly being done by <code>parse_formula()</code> that cannot be done the <i>usual</i> way?"}, {"owner": {"reputation": 2071, "user_id": 4487530, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe96d2385b9429a5789611d6cf143ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Christo S. Christov", "link": "https://stackoverflow.com/users/4487530/christo-s-christov"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423646269, "post_id": 28450479, "comment_id": 45228852, "body": "@SouravGhosh he is looking for a library to do the parsing of the function to a value."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 2071, "user_id": 4487530, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe96d2385b9429a5789611d6cf143ca8?s=128&d=identicon&r=PG&f=1", "display_name": "Christo S. Christov", "link": "https://stackoverflow.com/users/4487530/christo-s-christov"}, "edited": false, "score": 0, "creation_date": 1423646376, "post_id": 28450479, "comment_id": 45228909, "body": "Mr @Chris something like <code>double result = ((data1 + data2) ^ data3) &#47; data4</code> or am I missing something?"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1423646402, "post_id": 28450479, "comment_id": 45228924, "body": "@SouravGhosh Imagine if the formula string was entered at runtime."}, {"owner": {"reputation": 429, "user_id": 2890591, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f3f1e63a626c0a13ebf614392f11ec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Leeroy", "link": "https://stackoverflow.com/users/2890591/j-leeroy"}, "edited": false, "score": 0, "creation_date": 1423646414, "post_id": 28450479, "comment_id": 45228933, "body": "parse_formula() should parse formula string, get data values by name (for example by using uthash), calculate the result and return double."}, {"owner": {"reputation": 3331, "user_id": 2581593, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/NtHku.jpg?s=128&g=1", "display_name": "zubergu", "link": "https://stackoverflow.com/users/2581593/zubergu"}, "edited": false, "score": 0, "creation_date": 1423646458, "post_id": 28450479, "comment_id": 45228948, "body": "Nope, I don&#39;t think it is. Look at Reverse Polish Notation and implement it yourself. It&#39;s both educational and entertaining. I implemented such parser in Pascal and learned a lot from this."}, {"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1503876376, "post_id": 28450479, "comment_id": 78779062, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9977045/evaluate-mathematical-function-from-string\">Evaluate Mathematical Function from String</a>"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1503876660, "post_id": 28450479, "comment_id": 78779115, "body": "Parsing is a very large subject. I suggest you google for more information about it."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1503876700, "post_id": 28450479, "comment_id": 78779120, "body": "Note that the string in your example does not contain the numerical values of any of the variables."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1423646507, "creation_date": 1423646507, "answer_id": 28450598, "question_id": 28450479, "link": "https://stackoverflow.com/questions/28450479/how-to-parse-a-formula-from-a-string/28450598#28450598", "title": "How to parse a formula from a string?", "body": "<p>There is no such function in the standard library, no.</p>\n\n<p>There are any number of libraries, I'm not going to recommend one here.</p>\n\n<p>Note that no library will allow \"automatic\" access by name to your program's variables; they are not available at runtime. You're going to have to find an expression evaluator with variable support, and initialize the variables in the evaluator before trying to evaluate the formula itself.</p>\n"}, {"comments": [{"owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "edited": false, "score": 0, "creation_date": 1503859658, "post_id": 28450909, "comment_id": 78775076, "body": "I don&#39;t consider this to be the right answer. The question specifically asked if there was available a C library that could parse and evaluate an expression. The questioner didn&#39;t ask if there was something in the standard library, just whether such a library exists anywhere. The answer is obviously yes. Yes one can learn a lot by implementing your own parser and evaluator but this is not what the questioner asked for."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "reply_to_user": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "edited": false, "score": 0, "creation_date": 1503861755, "post_id": 28450909, "comment_id": 78775691, "body": "@rhody Note that the OP also asked &quot;Or what is the best way to code it by myself?&quot;. However, if you would like to share libraries which may be useful, feel free to add an answer."}], "tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": true, "score": 3, "last_activity_date": 1435912090, "last_edit_date": 1495542106, "creation_date": 1423647407, "answer_id": 28450909, "question_id": 28450479, "link": "https://stackoverflow.com/questions/28450479/how-to-parse-a-formula-from-a-string/28450909#28450909", "title": "How to parse a formula from a string?", "body": "<p>There is nothing ready-made in the standard library for parsing expressions, no. However, it's a nice exercise to roll a parser/evaluator yourself. I don't want to spoil the fun, but here are some thoughts:</p>\n\n<p>The idea is to first parse the input string into some sort of data structure which represents the expression (usually some sort of tree structure) and then 'evaluate' that data structure with some given variable bindings.</p>\n\n<p>The data structure might be a <a href=\"https://stackoverflow.com/questions/20260730/structure-and-tagged-union-in-c\">tagged union</a>, something like this:</p>\n\n<pre><code>enum ValueType {\n ConstantValue, VariableValue, Addition, Division\n};\n\nstruct Value {\n  enum ValueType type;\n\n  /* The 'representation' of the value. */\n  union {\n     int constantValue;\n     const char *variableValue;\n     struct {\n       struct Value *summand1;\n       struct Value *summand2;\n     } additionValue;\n     struct {\n       struct Value *dividend;\n       struct Value *divisor;\n     } divisionValue;\n  } repr;\n};\n</code></pre>\n\n<p>For the parsing part, I suggest to read up on 'recursive descent' parsers, which area quite easy to understand and write by hand. The goal is to define a function</p>\n\n<pre><code>Value *parse( const char *s );\n</code></pre>\n\n<p>which returns a representation for the given string.</p>\n\n<p>The evaluation part is quite straightforward and lends itself to recursion. The goal is to define a function</p>\n\n<pre><code>int eval( const Value *v, ??? bindings );\n</code></pre>\n\n<p>...where <code>???</code> would be some type appropriate for holding variable bindings (e.g. a string to <code>int</code> mapping). Depending on the 'type' of the given value, it will perform the arithmetic operation, e.g.:</p>\n\n<pre><code>int eval( const Value *v, ??? bindings ) {\n  switch ( v-&gt;type ) {\n    case ConstantValue:\n      return v-&gt;repr.constantValue;\n    case Addition:\n      return eval( v-&gt;repr.additionValue.summand1 ) + eval( v-&gt;repr.additionValue.summand2 );\n    ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "is_accepted": false, "score": 0, "last_activity_date": 1503859424, "creation_date": 1503859424, "answer_id": 45908206, "question_id": 28450479, "link": "https://stackoverflow.com/questions/28450479/how-to-parse-a-formula-from-a-string/45908206#45908206", "title": "How to parse a formula from a string?", "body": "<p>There are quite a number of parsers available, both in C++ and plain C. For C++ there is muParser:</p>\n\n<p><a href=\"http://beltoforion.de/article.php?a=muparser&amp;hl=en&amp;s=idPageTop#idPageTop\" rel=\"nofollow noreferrer\">http://beltoforion.de/article.php?a=muparser&amp;hl=en&amp;s=idPageTop#idPageTop</a></p>\n\n<p>For C I found this little one which looks promising:</p>\n\n<p><a href=\"https://github.com/codeplea/tinyexpr\" rel=\"nofollow noreferrer\">https://github.com/codeplea/tinyexpr</a></p>\n"}], "owner": {"reputation": 429, "user_id": 2890591, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/60f3f1e63a626c0a13ebf614392f11ec?s=128&d=identicon&r=PG&f=1", "display_name": "J. Leeroy", "link": "https://stackoverflow.com/users/2890591/j-leeroy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1443, "favorite_count": 0, "accepted_answer_id": 28450909, "answer_count": 3, "score": 2, "last_activity_date": 1503876246, "creation_date": 1423646153, "last_edit_date": 1503876246, "question_id": 28450479, "link": "https://stackoverflow.com/questions/28450479/how-to-parse-a-formula-from-a-string", "title": "How to parse a formula from a string?", "body": "<p>For example, I have string <code>((data1 + data2) ^ data3) / data4</code> and I want my little program to get this string and do something like this:</p>\n\n<pre><code>int main(int argc, char **argv) {\n\n    double data1 = 1.0;\n    double data2 = 2.0;\n    double data3 = 3.0;\n    double data4 = 4.0;\n\n    double result = parse_formula(\"((data1 + data2) ^ data3) / data4\");\n\n    printf(\"Result is %d\\n\", result);\n    return 0;\n}\n</code></pre>\n\n<p>Is there such a parser in the standard library? If not, how would I make such a parser myself?</p>\n"}]