[{"tags": ["c", "arduino", "arduino-uno"], "comments": [{"owner": {"reputation": 526, "user_id": 5365012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_2kQk52HsJQ/AAAAAAAAAAI/AAAAAAAAESI/NauEwEkApuc/photo.jpg?sz=128", "display_name": "138", "link": "https://stackoverflow.com/users/5365012/138"}, "edited": false, "score": 3, "creation_date": 1553126431, "post_id": 55271832, "comment_id": 97274950, "body": "why can you not read vibrate from within the while loop, can you not add if (!vibrate = analogRead(pin)) break; after delay(10); ?"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 3, "creation_date": 1553126550, "post_id": 55271832, "comment_id": 97274972, "body": "While you have acted in good faith, pseudocode is the least helpful thing you can do, generally. Please see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>. Also you should format your code better because currently it&#39;s divided into multiple different sections. Also <code>if (i &gt; &#47;255)</code> is probably very wrong."}, {"owner": {"reputation": 514, "user_id": 7525035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7b1d54a0e1f51ad208af03630453bbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/7525035/muhammad"}, "reply_to_user": {"reputation": 526, "user_id": 5365012, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_2kQk52HsJQ/AAAAAAAAAAI/AAAAAAAAESI/NauEwEkApuc/photo.jpg?sz=128", "display_name": "138", "link": "https://stackoverflow.com/users/5365012/138"}, "edited": false, "score": 0, "creation_date": 1553126706, "post_id": 55271832, "comment_id": 97275012, "body": "@138 interesting, I will try putting that in"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553157943, "post_id": 55271832, "comment_id": 97283293, "body": "Is this some manner of bit-banging GPIO? Use PWM hardware and your problems will go away."}], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 2710319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62e82d1d25764466572d0aa49b0b2c5?s=128&d=identicon&r=PG", "display_name": "HeLLo", "link": "https://stackoverflow.com/users/2710319/hello"}, "edited": false, "score": 2, "creation_date": 1553141899, "post_id": 55273618, "comment_id": 97278220, "body": "I think you mean &quot;break; &quot; instead of &quot;break();&quot;."}, {"owner": {"reputation": 514, "user_id": 7525035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7b1d54a0e1f51ad208af03630453bbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/7525035/muhammad"}, "edited": false, "score": 0, "creation_date": 1553144788, "post_id": 55273618, "comment_id": 97278796, "body": "Yep, that was my first idea to use a break statement, the only thing is the value of the variable &#39;vibrate&#39; doesn&#39;t update in arduino. I&#39;m unsure why, but as soon as it enters the while loop, it won&#39;t update till the while loop is done."}, {"owner": {"reputation": 64, "user_id": 3382147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d8exa.png?s=128&g=1", "display_name": "can&#39;tThinkOfAName", "link": "https://stackoverflow.com/users/3382147/cantthinkofaname"}, "edited": false, "score": 0, "creation_date": 1553214444, "post_id": 55273618, "comment_id": 97311383, "body": "Maybe there&#39;s a call you could make to update the value. I don&#39;t know arduino."}], "tags": [], "owner": {"reputation": 64, "user_id": 3382147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d8exa.png?s=128&g=1", "display_name": "can&#39;tThinkOfAName", "link": "https://stackoverflow.com/users/3382147/cantthinkofaname"}, "is_accepted": false, "score": 2, "last_activity_date": 1553141951, "last_edit_date": 1553141951, "creation_date": 1553141153, "answer_id": 55273618, "question_id": 55271832, "link": "https://stackoverflow.com/questions/55271832/how-to-break-a-while-loop-inside-a-sensing-if-condition/55273618#55273618", "title": "How To Break a while loop inside a sensing if condition", "body": "<p>Inside a loop you could call <code>break;</code> to continue execution outside the loop you called it in.</p>\n"}, {"tags": [], "owner": {"reputation": 320, "user_id": 4209269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3905debb6172230b0cf4a1524038fb8?s=128&d=identicon&r=PG&f=1", "display_name": "anilkunchalaece", "link": "https://stackoverflow.com/users/4209269/anilkunchalaece"}, "is_accepted": true, "score": 1, "last_activity_date": 1553523368, "creation_date": 1553523368, "answer_id": 55339865, "question_id": 55271832, "link": "https://stackoverflow.com/questions/55271832/how-to-break-a-while-loop-inside-a-sensing-if-condition/55339865#55339865", "title": "How To Break a while loop inside a sensing if condition", "body": "<p><strong>update the vibrate variable</strong> within the while loop. You don't need to use <strong>break</strong> </p>\n\n<pre><code>void updateVibrate(){\n       //UPDATE THE VIBRATE VARIABLE\n    }\n\n    if (vibrate == 1){ //this is the input sensing to the arduino. \n      //It is either 1 or 0\n      //constantly run a while loop IF vibrate ==1\n      i=51;\n      while(vibrate ==1){\n         analogWrite(Motor,i); //constantly outputing a pulse of increasing magnitude\n         delay(10); //delay it for a certain period of time\n         i=i+50; //increment i \n         if (i&gt;=255){\n           i=51;\n         }\n       updateVibrate();//Call function which will update the vibrate (Global) Variable\n      }\n    }\n    else{ //do something else. Has it's own functions}\n</code></pre>\n\n<p>Alternatively, when you have fixed number of iterations, you can use for loop with break statement</p>\n"}], "owner": {"reputation": 514, "user_id": 7525035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7b1d54a0e1f51ad208af03630453bbaa?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad", "link": "https://stackoverflow.com/users/7525035/muhammad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 55339865, "answer_count": 2, "score": 0, "last_activity_date": 1553523368, "creation_date": 1553126031, "last_edit_date": 1553127113, "question_id": 55271832, "link": "https://stackoverflow.com/questions/55271832/how-to-break-a-while-loop-inside-a-sensing-if-condition", "title": "How To Break a while loop inside a sensing if condition", "body": "<p>The essence of my psuedo-code is as follows (I have simplified it to arrange for simpler answers): </p>\n\n<pre><code>if (vibrate == 1){ //this is the input sensing to the arduino. \n  //It is either 1 or 0\n  //constantly run a while loop IF vibrate ==1\n  i=51;\n  while(vibrate ==1){\n     analogWrite(Motor,i); //constantly outputing a pulse of increasing magnitude\n     delay(10); //delay it for a certain period of time\n     i=i+50; //increment i \n     if (i&gt;=255){\n       i=51;\n     }\n  }\n}\nelse{ //do something else. Has it's own functions}\n</code></pre>\n\n<p>Now vibrate is coming in from a sensor. If vibrate is 1, I would automatically want to output a ramped pulse (i.e. the while loop). However, if vibrate changes it's value (i.e. goes to zero), I would like the while loop not to be triggered, and if it is triggered, I would like to exit the while loop. The issue that I face is that vibrate updates itself outside of the while loop, and hence i'll get an infinite loop. Is there a better way to incorporate this? I can't update the value of vibrate in the while loop either, since I need to check the greater 'if' too. </p>\n"}, {"tags": ["c", "stack", "red-zone"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553125678, "post_id": 55271754, "comment_id": 97274739, "body": "The stack grows downward, but <code>ptr++</code> still adds, it doesn&#39;t subtract."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553125842, "post_id": 55271754, "comment_id": 97274773, "body": "Nothing you&#39;re doing here grows the stack, so growth direction is not relevant. C compilers generally allocate all the local variables in a function at once, rather than growing it for each variable."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553125880, "post_id": 55271754, "comment_id": 97274792, "body": "I don&#39;t think the red zone is relevant at all. That&#39;s used for temporaries during calculations, not declared variables."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 1, "creation_date": 1553126189, "post_id": 55271754, "comment_id": 97274878, "body": "There are no guarantees that the order variables are declared are the order they are placed on the stack."}, {"owner": {"reputation": 230, "user_id": 1993297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/629cd5b98cc5a2a7accef84b492abd53?s=128&d=identicon&r=PG", "display_name": "A6SE", "link": "https://stackoverflow.com/users/1993297/a6se"}, "edited": false, "score": 0, "creation_date": 1553126269, "post_id": 55271754, "comment_id": 97274900, "body": "Oh, I see. One more question: Why doesn&#39;t the stack pointer have the same value as the address of x then? There&#39;s 28 bytes difference between those addresses and I&#39;m not sure what occupied those bytes."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553126335, "post_id": 55271754, "comment_id": 97274917, "body": "There&#39;s other stuff in the stack."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553126352, "post_id": 55271754, "comment_id": 97274921, "body": "Like the return address of the function."}], "owner": {"reputation": 230, "user_id": 1993297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/629cd5b98cc5a2a7accef84b492abd53?s=128&d=identicon&r=PG", "display_name": "A6SE", "link": "https://stackoverflow.com/users/1993297/a6se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553125519, "creation_date": 1553125519, "question_id": 55271754, "link": "https://stackoverflow.com/questions/55271754/understanding-stack-and-red-zone-of-a-c-program", "title": "Understanding stack and red zone of a C program", "body": "<p>Here is a simple C program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char* argv[] ){\n    int x = 10;\n    int* ptr = &amp;x;\n    ptr++;\n    printf(\"%x   %d \\n\",  ptr,  *ptr);\n}\n</code></pre>\n\n<p>Using a GNU debugger on Ubuntu 64-bit, I debugged the program step by step from the beginning of main function and this is the result of the debugger:</p>\n\n<pre><code>Temporary breakpoint 1, main (argc=1, argv=0x7fffffffe0f8) at sigseg4.c:28\n28  int main(int argc, char* argv[] ){\n(gdb) display /a $sp\n1: /a $sp = 0x7fffffffdfe0\n(gdb) display /a $bp\n2: /a $bp = 0xffffffffffffe010\n(gdb) display /a &amp;x\n3: /a &amp;x = 0x7fffffffdffc\n(gdb) display /d x\n4: /d x = 21845\n(gdb) display /a &amp;ptr\n5: /a &amp;ptr = 0x7fffffffe000\n(gdb) display /a ptr\n6: /a ptr = 0x7fffffffe0f0\n(gdb) display /d *ptr\n7: /d *ptr = 1\n(gdb) next\n29      int x = 10;\n1: /a $sp = 0x7fffffffdfe0\n2: /a $bp = 0xffffffffffffe010\n3: /a &amp;x = 0x7fffffffdffc\n4: /d x = 21845\n5: /a &amp;ptr = 0x7fffffffe000\n6: /a ptr = 0x7fffffffe0f0\n7: /d *ptr = 1\n(gdb) next\n30      int* ptr = &amp;x;\n1: /a $sp = 0x7fffffffdfe0\n2: /a $bp = 0xffffffffffffe010\n3: /a &amp;x = 0x7fffffffdffc\n4: /d x = 10\n5: /a &amp;ptr = 0x7fffffffe000\n6: /a ptr = 0x7fffffffe0f0\n7: /d *ptr = 1\n(gdb) next\n31      ptr++;\n1: /a $sp = 0x7fffffffdfe0\n2: /a $bp = 0xffffffffffffe010\n3: /a &amp;x = 0x7fffffffdffc\n4: /d x = 10\n5: /a &amp;ptr = 0x7fffffffe000\n6: /a ptr = 0x7fffffffdffc\n7: /d *ptr = 10\n(gdb) \n32      printf(\"%x   %d \\n\",  ptr,  *ptr);\n1: /a $sp = 0x7fffffffdfe0\n2: /a $bp = 0xffffffffffffe010\n3: /a &amp;x = 0x7fffffffdffc\n4: /d x = 10\n5: /a &amp;ptr = 0x7fffffffe000\n6: /a ptr = 0x7fffffffe000\n7: /d *ptr = -8192\n(gdb) next\nffffe000   -8192 \n33  }\n1: /a $sp = 0x7fffffffdfe0\n2: /a $bp = 0xffffffffffffe010\n3: /a &amp;x = 0x7fffffffdffc\n4: /d x = 10\n5: /a &amp;ptr = 0x7fffffffe000\n6: /a ptr = 0x7fffffffe000\n7: /d *ptr = -8192\n(gdb) next\n__libc_start_main (main=0x5555555546aa &lt;main&gt;, argc=1, argv=0x7fffffffe0f8, \n    init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, \n    stack_end=0x7fffffffe0e8) at ../csu/libc-start.c:344\n344 ../csu/libc-start.c: No such file or directory.\n1: /a $sp = 0x7fffffffe020\n2: /a $bp = 0x4720\n(gdb) next\n[Inferior 1 (process 9922) exited normally]\n(gdb) \n</code></pre>\n\n<p>As we can see, the stack pointer doesn't change during the program when initializing x and ptr. What I found online is that x and ptr are actually stored in the red zone of the stack segment of memory.<br><br>\nHowever, the part that confuses me is this: First, we declare x and set it to 10. Adress of x is: 0x7fffffffdffc. Then we initialize a pointer ptr to x, resulting in ptr having the same value as address of x. However, what caught my eye is that the address of the pointer itself: 0x7fffffffe0f0 is 4 bytes bigger than the address of x (e0f0-dffc = 4), which is contradictory to what I've learned about stack, that it grows downwards in memory, not upwards.<br>\nDoes the red zone somehow behave differently than stack?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553125994, "post_id": 55271721, "comment_id": 97274837, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553126163, "post_id": 55271721, "comment_id": 97274873, "body": "The error suggests that <code>b[j].p</code> is not actually initialized."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553126267, "post_id": 55271721, "comment_id": 97274899, "body": "So the problem is probably in the code that creates the bins."}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1553126678, "post_id": 55271721, "comment_id": 97275004, "body": "Please provide all the relevant source code in one section. Dividing it up like you&#39;ve done makes it more difficult to test it and help you with your problem. Please see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1553128367, "post_id": 55271721, "comment_id": 97275386, "body": "I&#39;m voting to close this question as off-topic because a MVCE should be provided but the fault is clearly in code not present."}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553128755, "post_id": 55271721, "comment_id": 97275460, "body": "thanks for the comments @Barmar, I have edited the code provided to give a full perspective of my potential issue. Based on what you said, I would assume the last line in my <code>create_bins</code> function isn&#39;t actually creating the array?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553129200, "post_id": 55271721, "comment_id": 97275554, "body": "The <code>particle_t</code> typedef needs to be before <code>bins</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553129911, "post_id": 55271721, "comment_id": 97275692, "body": "It&#39;s a typo: <code>for (int j = 0; j &lt; num_bins; i++)</code>. That should be <code>j++</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553130079, "post_id": 55271721, "comment_id": 97275727, "body": "That caused the inner loop to be infinite and increment <code>i</code> forever, and <code>p[i]</code> eventually went out of bounds."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553130150, "post_id": 55271721, "comment_id": 97275743, "body": "I figured this out by printing <code>i</code> and <code>j</code> before <code>b[j].p[0] = p[i];</code> and I noticed that <code>i</code> was getting huge."}, {"owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553130194, "post_id": 55271721, "comment_id": 97275749, "body": "of course it&#39;s something simple... thanks @Barmar!"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553130241, "post_id": 55271721, "comment_id": 97275757, "body": "In the debugger you could have looked at the values of <code>i</code> and <code>j</code>."}], "owner": {"reputation": 47, "user_id": 3403085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0dfb85cce42480bbe6a04044584d95?s=128&d=identicon&r=PG&f=1", "display_name": "jrod091", "link": "https://stackoverflow.com/users/3403085/jrod091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553128641, "creation_date": 1553125322, "last_edit_date": 1553128641, "question_id": 55271721, "link": "https://stackoverflow.com/questions/55271721/trying-to-copy-pointers-into-array", "title": "Trying to copy pointers into array", "body": "<p>I keep getting a segfault in some code I am trying and I am unsure why. Please take a look below (I've pulled the required into a single window, the functions are actually within 3 different files):</p>\n\n<pre><code>#define density 0.0005 \n\nconst int NBINS = 10;\n\ndouble size;\n\ntypedef struct \n{\n   int x_start;\n   int x_end;\n   int y_start;\n   int y_end;\n   particle_t* p;\n   bool left;\n   bool right;\n   bool up;\n   bool down;\n} bins;\n\ntypedef struct \n{\n  double x;\n  double y;\n  double vx;\n  double vy;\n  double ax;\n  double ay;\n} particle_t;\n\nint find_option( int argc, char **argv, const char *option )\n{\n    for( int i = 1; i &lt; argc; i++ )\n        if( strcmp( argv[i], option ) == 0 )\n            return i;\n    return -1;\n}\n\nint read_int( int argc, char **argv, const char *option, int default_value )\n{\n    int iplace = find_option( argc, argv, option );\n    if( iplace &gt;= 0 &amp;&amp; iplace &lt; argc-1 )\n        return atoi( argv[iplace+1] );\n    return default_value;\n}\n\nvoid set_size( int n ) {\n    size = sqrt( density * n );\n}\n\nvoid init_particles( int n, particle_t *p ) {\n    srand48( time( NULL ) );\n\n    int sx = (int)ceil(sqrt((double)n));\n    int sy = (n+sx-1)/sx;\n\n    int *shuffle = malloc( n * sizeof(int) );\n    for( int i = 0; i &lt; n; i++ )\n        shuffle[i] = i;\n\n    for( int i = 0; i &lt; n; i++ ) \n    {\n        int j = lrand48()%(n-i);\n        int k = shuffle[j];\n        shuffle[j] = shuffle[n-i-1];\n\n        p[i].x = size*(1.+(k%sx))/(1+sx);\n        p[i].y = size*(1.+(k/sx))/(1+sy);\n\n        p[i].vx = drand48()*2-1;\n        p[i].vy = drand48()*2-1;\n    }\n    free( shuffle );\n}\n\nvoid create_bins(int n, int num_bins, bins* b) {\n   int x = 0;\n   int y = 0;\n\n   for (int i = 0; i &lt; num_bins; i++) {\n      b[i].x_start = x; \n      b[i].x_end = x + NBINS; \n      x += NBINS;\n\n      b[i].y_start = y; \n      b[i].y_end = y + NBINS; \n      y += NBINS;\n\n      b[i].p = malloc(n * sizeof(particle_t));\n   }\n}\n\nvoid add_to_bin (int n, int num_bins, bins* b, particle_t* p) {\n   for (int i = 0; i &lt; n; i++)\n       for (int j = 0; j &lt; num_bins; i++)\n          if (p[i].x &gt;= b[j].x_start &amp;&amp; p[i].x &lt; b[j].x_end)    // Check if particle is within bin's x boundaries\n             if(p[i].y &gt;= b[j].y_start &amp;&amp; p[i].y &lt; b[j].y_end) {  // Check if particle is within bin's y boundaries\n                b[j].p[0] = p[i];\n             }\n}\n\nint main( int argc, char **argv )\n{\n   if( find_option( argc, argv, \"-h\" ) &gt;= 0 )\n   {\n      printf( \"Options:\\n\" );\n      printf( \"-h to see this help\\n\" );\n      printf( \"-n &lt;int&gt; to set the number of particles\\n\" );\n      printf( \"-o &lt;filename&gt; to specify the output file name\\n\" );\n      printf( \"-s &lt;filename&gt; to specify a summary file name\\n\" );\n      printf( \"-no turns off all correctness checks and particle output\\n\");\n      return 0;\n   }\n\n   int n = read_int( argc, argv, \"-n\", 1000 );\n\n   int num_bins = n / NBINS;\n\n   bins* b = malloc (num_bins * sizeof(bins));\n\n   create_bins(n,num_bins,b);\n\n   particle_t *particles = malloc( n * sizeof(particle_t) );\n   set_size( n );\n   init_particles( n, particles );\n\n   add_to_bin(n,num_bins,b,particles);\n\n   return 0;\n}\n</code></pre>\n\n<p>I can get most of these parameters setup except for the <code>particle_t* p</code> inside my bins struct. Below is how I am trying to accomplish that:</p>\n\n<p>(I know setting <code>p[0]</code> over and over isn't going to accomplish what I want, I was just trying to dumb it down and have it set over and over)</p>\n\n<p>gdb gives me the following result:</p>\n\n<pre><code>(gdb) run\nStarting program: /workspace/particle/serial\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000008001101 in add_to_bin (n=1000, num_bins=100, b=0x8415e70, p=&lt;optimized out&gt;) at bins.h:70\n70                                      b[j].p[0] = p[i];\n</code></pre>\n\n<p>For some more background, the particles are being initialized in another function and I am trying to see which particles fall in a particular bin's area and add the particles that do to that bin, storing them in an array. I don't think I am grasping the idea of pushing the particles into an array correctly... I hope the above gives you a good idea of what I'm trying to do without being too much extra.</p>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 1265, "user_id": 2766386, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/35204395a1a9575da7fc91752c2caf02?s=128&d=identicon&r=PG&f=1", "display_name": "valek", "link": "https://stackoverflow.com/users/2766386/valek"}, "edited": false, "score": 0, "creation_date": 1553126007, "post_id": 55271700, "comment_id": 97274842, "body": "As I understood, you are passing your multiple word string as a command line arguments, right? And do you need to find the number of occurrences of all characters or just one that you specify? What do you mean by location: the address of the character or the position in the string from the beginning?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11206275, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7AAKuIrMfi0/AAAAAAAAAAI/AAAAAAAAAJs/Y-R6-JhsCRQ/photo.jpg?sz=128", "display_name": "Itgotworse26", "link": "https://stackoverflow.com/users/11206275/itgotworse26"}, "edited": false, "score": 0, "creation_date": 1553130293, "post_id": 55271872, "comment_id": 97275771, "body": "Thank you so much on the argv[] indexes. That particularly came in handy, as those were the indexes I didn&#39;t understand."}], "tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": true, "score": 0, "last_activity_date": 1553126333, "creation_date": 1553126333, "answer_id": 55271872, "question_id": 55271700, "link": "https://stackoverflow.com/questions/55271700/how-to-find-the-occurrences-and-location-of-characters-in-command-line-arguments/55271872#55271872", "title": "How to find the occurrences and location of characters in command line arguments", "body": "<p>You seem to be slightly confused about how input through main works. Basically, your idea of using command line parameters is pretty bad because you want to both specify the strings to be parsed but also which character to look for, which is pretty easy to mess up.</p>\n\n<p>A better way is using something like scanf with a printf preceding it to request input both for the strings to be parsed and the character to look for. This then enforces an order so it's much more difficult to mess up.</p>\n\n<p>Now, if you don't want to do that you still have to fix how you use argv. argv[0] contains the name of the program, not the first command line parameter. Statically referring to argv[2] isn't even really guaranteed to mean anything useful: it could be a part of the string you want to parse, or it could be the character you're looking for.</p>\n\n<p>Secondly, when you pass command line parameters into the program, they will automatically be divided by spaces. That is, <code>good dog</code> will turn into two separate argv indexes: <code>good</code> will be argv[1] and <code>dog</code> will be argv[2] in this case. If you want to send them as one argument, you can type <code>\"good dog\"</code> to achieve that.</p>\n\n<p>Here's a fully compilable program that is more of a sketch of what you probably want:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    int i = 0, frequency = 0; // wasn't initialized\n    char DesiredChar = 'o';\n    int  FirstLocationOfDesiredChar = -1;\n    if (argc &gt;= 1) {\n        for (i = 1; i &lt; argc; i++) {\n            int j = 0;\n            int StringLength = strlen(argv[i]);\n            for (; j &lt; StringLength; j++) {\n                if (argv[i][j] == DesiredChar) {\n                    frequency++;\n                    if (FirstLocationOfDesiredChar == -1) {\n                        FirstLocationOfDesiredChar = j;\n                    }\n                }\n            }\n        }\n    } else {\n        printf(\"Invalid no of inputs\\n\");\n        return 1;\n    }\n    printf(\"%s\", argv[1]);\n    printf(\"%d, %d\", frequency, FirstLocationOfDesiredChar);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11206275, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7AAKuIrMfi0/AAAAAAAAAAI/AAAAAAAAAJs/Y-R6-JhsCRQ/photo.jpg?sz=128", "display_name": "Itgotworse26", "link": "https://stackoverflow.com/users/11206275/itgotworse26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55271872, "answer_count": 1, "score": 0, "last_activity_date": 1553126333, "creation_date": 1553125208, "last_edit_date": 1553125912, "question_id": 55271700, "link": "https://stackoverflow.com/questions/55271700/how-to-find-the-occurrences-and-location-of-characters-in-command-line-arguments", "title": "How to find the occurrences and location of characters in command line arguments", "body": "<p>I'm new to command line arguments, but I have to find the occurrences and locations of a multiple word string. Say I enter in:</p>\n\n<pre><code>good dog\n</code></pre>\n\n<p>I would enter in o on the command line to get three counts of o and the locations. However, what I have is:</p>\n\n<pre><code>Frequency of d = 0\nLocation of d = -13280\n</code></pre>\n\n<p>How do I find the locations and how do I parse the parameters?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv)\n{\n    int i, frequency;\n    int *p;\n    p=&amp;argc;\n\n    for(int i=0; i&lt;argc; i++)\n    {\n        if(argv[i]==argv[i])\n        {\n            frequency++;\n        }\n    }\n\n    printf(\"\\nFrequency of %c = %d\\n\", argv[2][0], frequency);\n    printf(\"\\nLocation of %c = %d\\n\", argv[2][0], p);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1553124380, "post_id": 55271576, "comment_id": 97274372, "body": "check the return code from scanf. It will tell you how many items it processed. If it returns 0, it didn&#39;t put any numbers in your variable."}, {"owner": {"reputation": 27, "user_id": 10978206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w1kwsJk-wrg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOJj22dMWIE1IsBD78Clzw_84T8lw/mo/photo.jpg?sz=128", "display_name": "ice592", "link": "https://stackoverflow.com/users/10978206/ice592"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553124584, "post_id": 55271576, "comment_id": 97274442, "body": "So instead of if (isalpha((char)rozmiar) != 0) , I just put if (rozmiar = 0)  ?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553124650, "post_id": 55271576, "comment_id": 97274452, "body": "No... <code>int rc = scanf(&quot;%d&quot;, &amp;rozmiar);</code>  Then <code>if (rc == 0) {</code> ..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1553125680, "post_id": 55271576, "comment_id": 97274740, "body": "@bruceg <code>if (scanf(&quot;%d&quot;, &amp;rozmiar) != 1)</code> is better.  Consider end-of-file."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553125780, "post_id": 55271576, "comment_id": 97274761, "body": "ice592, What do you want to happen to  non-numeric input?  It does not disappear when <code>scanf(&quot;%f&quot;, &amp;zmienna);</code> fails to read it."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553126274, "post_id": 55271576, "comment_id": 97274901, "body": "@chux it looks like the OP wants to exit the program if the first input is not numeric.  So, he doesn&#39;t have to worry about it sticking around in the input buffer.  If he were going to prompt again for valid input, he&#39;d need to actually get the char data out of the buffer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1553130552, "post_id": 55271576, "comment_id": 97275825, "body": "@bruceg Likely, yet the question addressed to ice592 is best answered by OP.  With your comment, more likely now OP will not engage."}], "owner": {"reputation": 27, "user_id": 10978206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w1kwsJk-wrg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOJj22dMWIE1IsBD78Clzw_84T8lw/mo/photo.jpg?sz=128", "display_name": "ice592", "link": "https://stackoverflow.com/users/10978206/ice592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553128704, "creation_date": 1553124256, "question_id": 55271576, "link": "https://stackoverflow.com/questions/55271576/how-can-i-check-if-variable-in-scanf-is-not-number", "title": "How can I check if variable in scanf is not number?", "body": "<p>I have to prevent from putting letters into scanf in my program. I tried \"isalpha\" but is doesn't seems to work. Here is my code:</p>\n\n<pre><code>int main() \n{\n    float T[100] = {0}; \n    float *pt=T;\n    float suma = 0, zmienna;\n    int rozmiar;\n\n    printf(\"How many numbers would you like to put in: \");\n    scanf(\"%d\", &amp;rozmiar);\n    if (isalpha((char)rozmiar) != 0)\n    {\n        printf(\"Incorrect input\");\n        return 1;\n    }\n    else if(rozmiar&gt;100)\n    {\n        printf(\"Incorrect input data\");\n        return 2;\n    }\n    else\n    printf(\"\\n Enter the number: \\n\");\n    for (int i = 0; i&lt;rozmiar; i++) \n    {\n        scanf(\"%f\", &amp;zmienna);\n        *(pt+i)=zmienna;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "multithreading", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1553126373, "post_id": 55271457, "comment_id": 97274930, "body": "Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. In particular, <i>how</i> did you initialize the array?"}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553136343, "post_id": 55271457, "comment_id": 97277074, "body": "@EOF I added the example. But I didn&#39;t see how exactly the way the array is initialized affects the execution results"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553194857, "post_id": 55275403, "comment_id": 97304668, "body": "The signed integer overflow is undefined behavior, so the compiler can remove the code entirely."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1553455165, "post_id": 55275403, "comment_id": 97381117, "body": "@EOF good point. I added a note mentioning it (although I&#39;m still quite confident things are like I described them)"}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "edited": false, "score": 0, "creation_date": 1556735218, "post_id": 55275403, "comment_id": 98534994, "body": "It appears compiler optimization is the reason why the problem occurs. For some reason the compiler decided to change the reduction operation into atomic add. That makes all the difference."}], "tags": [], "owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "is_accepted": true, "score": 4, "last_activity_date": 1553455050, "last_edit_date": 1553455050, "creation_date": 1553152539, "answer_id": 55275403, "question_id": 55271457, "link": "https://stackoverflow.com/questions/55271457/openmp-first-kernel-much-slower-than-the-second-kernel/55275403#55275403", "title": "OpenMP first kernel much slower than the second kernel", "body": "<p>Since you don't provide any <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>, I'll have to make some wild guesses here, but I'm pretty confident I have the gist of the issue.</p>\n\n<p>First, you have to notice that 98,306 x 98,306 is 9,664,069,636 which is way larger than the maximum value a signed 32 bit integer can store (which is 2,147,483,647). Therefore, the upper limit of your <code>for</code> initialization loop, after overflowing, could become 1,074,135,044 (as on my machines, although it is undefined behavior so strictly speaking, anything could happen), which is roughly 9 times smaller than what you expected.</p>\n\n<p>So now, after the initialization loop, only 11% of the memory you thought you allocated has actually been allocated and touched by the operating system. However, your first reduction loop does a good job in going over the various elements of the array, and since for about 89% of it, it's for the fist time, the OS does the actual memory allocation there and then, which takes some significant amount of time.</p>\n\n<p>And now, for your second reduction loop, all memory has been properly allocated and touched, which makes it much faster.</p>\n\n<p>So that's what I believe happened. That said, many other parameters can enter into play here, such as:</p>\n\n<ul>\n<li><strong>Swapping</strong>: the array you try to allocate represents about 36GB of memory. If your machine doesn't have that much memory available, then your code might swap, which will potentially make a big mess of whatever performance measurement you can come up with</li>\n<li><strong>NUMA effect</strong>: if your machine has multiple NUMA nodes, then thread pinning and memory affinity, when not managed properly, can have a large impact on performance between loop occurrences</li>\n<li><strong>Compiler optimization</strong>: you didn't mention which compiler you used and which level of optimization you requested. Depending on that, you'd be amazed on how shortened your code could become. For example, the compiler could totally remove the second loop as it does the same thing as the first and becomes useless as the result will be the same... And many other interesting and unexpected things which render your benchmark meaningless</li>\n</ul>\n"}], "owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 55275403, "answer_count": 1, "score": -2, "last_activity_date": 1553455050, "creation_date": 1553123469, "last_edit_date": 1553136263, "question_id": 55271457, "link": "https://stackoverflow.com/questions/55271457/openmp-first-kernel-much-slower-than-the-second-kernel", "title": "OpenMP first kernel much slower than the second kernel", "body": "<p>I have a huge 98306 by 98306 2D array initialized. I created a kernel function that counts the total number of elements below a certain threshold.</p>\n\n<pre><code>#pragma omp parallel for reduction(+:num_below_threshold)\nfor(row)\n    for(col)\n        index = get_corresponding_index(row, col);\n        if (array[index] &lt; threshold)\n            num_below_threshold++;\n</code></pre>\n\n<p>For benchmark purpose I measured the execution time of the kernel executing when the number of thread is set to 1. I noticed that the first time the kernel executes it took around 11 seconds. The next call to the kernel executing on the same array with one thread only took around 3 seconds. I thought it might be a problem related to cache but it doesn't seem to be related. What is the possible reasons that caused this?</p>\n\n<p>This array is initialized as:</p>\n\n<pre><code>float *array = malloc(sizeof(float) * 98306 * 98306);\nfor (int i = 0; i &lt; 98306 * 98306; i++) {\n    array[i] = rand() % 10;\n}\n</code></pre>\n\n<p>This same kernel is applied to this array twice and the second execution time is much faster than the first kernel. I though of lazy allocation on Linux but that shouldn't be a problem because of the initialization function. Any explanations will be helpful. Thanks!</p>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553122890, "post_id": 55271336, "comment_id": 97273931, "body": "why don&#39;t you use the system functions, <code>asctime</code>, <code>strftime</code> or <code>ctime</code>?"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1553122958, "post_id": 55271336, "comment_id": 97273953, "body": "I&#39;m on Windows, and it Works On My Machine (tm). I fixed the scanf format strings, there are two places where you write into a short but use %i instead of %h. I seriously doubt that&#39;s the issue you&#39;re having, but it&#39;s what I changed and I&#39;m getting a steady once a second printing of time with &quot;Local time:&quot; in front of it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1553123200, "post_id": 55271336, "comment_id": 97274033, "body": "Running the posted code through the <code>gcc</code> compiler results in LOTS of warning and errors.  For instance: &quot;<code>untitled2.c:67:17: warning: format \u2018%i\u2019 expects argument of type \u2018int *\u2019, but argument 2 has type \u2018short int *\u2019 [-Wformat=]</code>  for statement: <code>scanf(&quot;%i&quot;, &amp;timezone);</code>   Suggest correcting the input format specifier.  Similar considerations exist for the statement: <code>scanf(&quot;%i&quot;, &amp;h24);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1553123310, "post_id": 55271336, "comment_id": 97274064, "body": "regarding: <code>gets(prefix);</code>  the function: <code>gets()</code> has been depreciated for years and completely removed from the latest versions of the C language.  Suggest using <code>fgets()</code>  (read the MAN page as the parameter list is different)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1553123450, "post_id": 55271336, "comment_id": 97274105, "body": "When compiling, always enable the warnings, then fix those warnings.   ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to produce the same thing"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1553123605, "post_id": 55271336, "comment_id": 97274148, "body": "Suggest using the input format specifier (for the short int variables) <code>%hi</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553124251, "post_id": 55271336, "comment_id": 97274332, "body": "regarding this kind of statement: <code>fprintf(filePointer, &quot;%s %02i:%02i.%02i&quot;, prefix, hour, minute, second);</code>  The format string is missing a trailing &#39;\\n&#39; so the data will stay in the stream buffer until one of several events happens.  Suggest appending a &#39;\\n&#39; to the end of the format string"}], "answers": [{"comments": [{"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1553124821, "post_id": 55271590, "comment_id": 97274511, "body": "So it really was that."}], "tags": [], "owner": {"reputation": 1466, "user_id": 810658, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/62139de5517901ce4c7ba8184070d24f?s=128&d=identicon&r=PG", "display_name": "Philip", "link": "https://stackoverflow.com/users/810658/philip"}, "is_accepted": false, "score": 2, "last_activity_date": 1553124354, "creation_date": 1553124354, "answer_id": 55271590, "question_id": 55271336, "link": "https://stackoverflow.com/questions/55271336/c-am-i-passing-the-string-wrong/55271590#55271590", "title": "C: Am I Passing the String Wrong?", "body": "<p>Yeah, that should be fine. But you're using scanf before you get there</p>\n\n<pre><code>short int h24;\n...\nscanf(\"%i\", &amp;h24);\n</code></pre>\n\n<p><code>%i</code> assumes an <code>int</code> not a <code>short</code>.  So it writes 4 bytes to a 2 byte variable. That overflows into your string. It clobbers  prefix[0] to 0 on mine, so the string is 0-length. </p>\n\n<p>Use <code>scanf(\"%h\", &amp;h24);</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 554, "user_id": 5119402, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/czEkC.png?s=128&g=1", "display_name": "haley", "link": "https://stackoverflow.com/users/5119402/haley"}, "edited": false, "score": 0, "creation_date": 1553136336, "post_id": 55271750, "comment_id": 97277070, "body": "This worked for the most part! I&#39;ll have to remove the <code>\\n</code> at the end of <code>prefix</code> though..."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1553125899, "last_edit_date": 1553125899, "creation_date": 1553125514, "answer_id": 55271750, "question_id": 55271336, "link": "https://stackoverflow.com/questions/55271336/c-am-i-passing-the-string-wrong/55271750#55271750", "title": "C: Am I Passing the String Wrong?", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>cleanly compiles</li>\n<li>performs the desired functionality</li>\n<li>look for <code>&lt;-- corrected</code> to see what I modified</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\n// This program writes the current time into a text file every second.\nint writeTime(short int timezone, char prefix[], short int h24)\n{\n    // Open the text file, in which to write\n    FILE *filePointer;\n    filePointer = fopen(\"clock.txt\", \"w+\");\n\n    if (filePointer == NULL) \n    {\n        perror(\"The file clock.txt failed to open.\"); // &lt;-- corrected\n    } \n\n    else \n    {\n        // THIS PART DOESN'T QUITE WORK WITH THE PREFIX:\n        time_t now = time(NULL); // get system time in seconds from 1970-01-01\n        time_t timeOfDay = (now + timezone * 3600) % 86400;\n        short int hour = (short)(timeOfDay / 3600); // &lt;-- corrected\n        short int minute = (short)(timeOfDay % 3600 / 60); // &lt;-- corrected\n        short int second = (short)(timeOfDay % 60); // &lt;-- corrected\n\n        if (h24) { // h24 is the 24 hour time flag\n            printf(\"%s %02i:%02i.%02i\\n\", prefix, hour, minute, second);\n            fprintf(filePointer, \"%s %02i:%02i.%02i\\n\", prefix, hour, minute, second);  // &lt;-- corrected\n        } \n\n        else \n        {\n            char* ampm;\n\n            if (hour &lt; 12) \n            {\n                ampm = \"AM\";\n            } \n\n            else \n            {\n                ampm = \"PM\";\n            }\n\n            printf(\"%s %02i:%02i.%02i %s\\n\", prefix, hour%12, minute, second, ampm);\n            fprintf(filePointer, \"%s %02i:%02i.%02i %s\\n\", prefix, hour%12, minute, second, ampm); // &lt;-- corrected\n        }\n    }\n    fclose(filePointer);\n    return 0;\n}\n\n\nint main(int argc, char **argv){\n    // Flags : 00000HPZ, 1 if set from command linearguments\n    // Z: timezone, P: prefix, H: 24h mode\n    unsigned short int flags = 0;\n    short int timezone = 0;\n    char prefix[64] = \"\";\n    short int h24 = 0;\n\n    // This part is meant to get parameters from command line arguments to save time for reuse\n    // -z: timezone; -p: prefix string; -24: 24h time (1 or 0 = on or off)\n    for (int i = 1; i &lt; argc; ++i) \n    {\n        if (0 == strcmp(argv[i], \"-z\")) \n        {\n            timezone = ( short int) strtol(argv[++i], NULL, 10);  // &lt;-- corrected\n            flags |= 1;\n            printf(\"Timezone UTC%+i\\n\", timezone);\n        } \n\n        else if (0 == strcmp(argv[i], \"-p\")) \n        {\n            strcpy(prefix, argv[++i]);\n            flags |= 2;\n            printf(\"Prefix %s\\n\",prefix);\n        } \n\n        else if (0 == strcmp(argv[i], \"-24\")) \n        {\n            h24 = (short int) strtol(argv[++i], NULL, 10);  // &lt;-- corrected\n            flags |= 4;\n            printf(\"24h %i\\n\", h24);\n        }\n    }\n\n    // User input for parameters not gotten from arguments:\n    if (!(flags &amp; 1)) \n    {\n        printf(\"Enter your timezone, as offset from UTC (e.g. East Coast US = -5, or -4 during DST): \");\n        scanf(\"%hi\", &amp;timezone);  // &lt;-- corrected\n        printf(\"UTC%+i\\n\", timezone);\n    }\n\n    if (!(flags &amp; 1 &lt;&lt; 1)) \n    {\n        printf(\"Enter your prefix (e.g. \\\"Local time:\\\", up to 64 characters) \");\n        // flush the input buffer: \n        int c;\n        while ((c = getchar()) != '\\n' &amp;&amp; c != EOF) {}\n\n        // replace the call to `gets()` with:\n        fgets( prefix, sizeof(prefix), stdin );\n        puts(prefix);\n    }\n    if (!(flags &amp; 1 &lt;&lt; 2)) {\n        printf(\"Enter \\\"1\\\" to enable 24 hour mode, and \\\"0\\\" to enable 12 hour mode. \");\n        scanf(\"%hi\", &amp;h24); // &lt;-- corrected\n        printf(\"24h %i\\n\", h24);\n    }\n\n    // Main loop\n    while (1) \n    {\n        // AM I DOING THIS PART RIGHT???\n        writeTime(timezone, prefix, h24);\n        sleep(1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The terminal output is:</p>\n\n<pre><code>Enter your timezone, as offset from UTC (e.g. East Coast US = -5, or -4 during DST): -7\nUTC-7\nEnter your prefix (e.g. \"Local time:\", up to 64 characters) pst\npst\n\nEnter \"1\" to enable 24 hour mode, and \"0\" to enable 12 hour mode. 1\n24h 1\n\npst\n 16:34.58\npst\n 16:34.59\npst\n 16:35.00\npst\n 16:35.01\npst\n 16:35.02\npst\n 16:35.03\npst\n 16:35.04\npst\n 16:35.05\npst\n 16:35.06\n....\n</code></pre>\n\n<p>the disk file: <code>clock.txt</code>  contains:</p>\n\n<pre><code>pst\n 16:32.48\n</code></pre>\n\n<p>and is updated once per second</p>\n"}], "owner": {"reputation": 554, "user_id": 5119402, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/czEkC.png?s=128&g=1", "display_name": "haley", "link": "https://stackoverflow.com/users/5119402/haley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 55271750, "answer_count": 2, "score": 1, "last_activity_date": 1553125899, "creation_date": 1553122510, "question_id": 55271336, "link": "https://stackoverflow.com/questions/55271336/c-am-i-passing-the-string-wrong", "title": "C: Am I Passing the String Wrong?", "body": "<p>I'm trying to make a utility for my stream. Basically, OBS can read from a text file, so I'm coding a program that updates a text file with the current time.</p>\n\n<p>The program would accept a string to append in front of the actual time. It's defined in <code>main()</code>, and passed to <code>writeTime()</code>, which executes every second and does the writing.</p>\n\n<p>However, something's going wrong, and I can't show the prefix even if I define it. I think there's something wrong with the way that I pass the argument to <code>writeTime()</code>, but I can't figure out what the issue is.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\n// This program writes the current time into a text file every second.\nint writeTime(short int timezone, char prefix[], short int h24){\n    // Open the text file, in which to write\n    FILE *filePointer;\n    filePointer = fopen(\"clock.txt\", \"w+\");\n    if (filePointer == NULL) {\n        printf(\"The file clock.txt failed to open.\");\n    } else {\n        // THIS PART DOESN'T QUITE WORK WITH THE PREFIX:\n        time_t now = time(NULL); // get system time in seconds from 1970-01-01\n        int timeOfDay = (now + timezone * 3600) % 86400;\n        short int hour = timeOfDay / 3600;\n        short int minute = timeOfDay % 3600 / 60;\n        short int second = timeOfDay % 60;\n        if (h24) { // h24 is the 24 hour time flag\n            printf(\"%s %02i:%02i.%02i\\n\", prefix, hour, minute, second);\n            fprintf(filePointer, \"%s %02i:%02i.%02i\", prefix, hour, minute, second);\n        } else {\n            char* ampm;\n            if (hour &lt; 12) {\n                ampm = \"AM\";\n            } else {\n                ampm = \"PM\";\n            }\n            printf(\"%s %02i:%02i.%02i %s\\n\", prefix, hour%12, minute, second, ampm);\n            fprintf(filePointer, \"%s %02i:%02i.%02i %s\", prefix, hour%12, minute, second, ampm);\n        }\n\n    }\n    fclose(filePointer);\n    return 0;\n}\n\nint main(int argc, char **argv){\n    // Flags : 00000HPZ, 1 if set from command linearguments\n    // Z: timezone, P: prefix, H: 24h mode\n    unsigned short int flags = 0;\n    short int timezone = 0;\n    char prefix[64] = \"\";\n    short int h24 = 0;\n    // This part is meant to get parameters from command line arguments to save time for reuse\n    // -z: timezone; -p: prefix string; -24: 24h time (1 or 0 = on or off)\n    for (int i = 1; i &lt; argc; ++i) {\n        if (0 == strcmp(argv[i], \"-z\")) {\n            timezone = (int) strtol(argv[++i], (char **)NULL, 10);\n            flags |= 1;\n            printf(\"Timezone UTC%+i\\n\", timezone);\n        } else if (0 == strcmp(argv[i], \"-p\")) {\n            strcpy(prefix, argv[++i]);\n            flags |= 2;\n            printf(\"Prefix %s\\n\",prefix);\n        } else if (0 == strcmp(argv[i], \"-24\")) {\n            h24 = (int) strtol(argv[++i], (char **)NULL, 10);\n            flags |= 4;\n            printf(\"24h %i\\n\", h24);\n        }\n    }\n    // User input for parameters not gotten from arguments:\n    if (!(flags &amp; 1)) {\n        printf(\"Enter your timezone, as offset from UTC (e.g. East Coast US = -5, or -4 during DST): \");\n        scanf(\"%i\", &amp;timezone);\n        printf(\"UTC%+i\\n\", timezone);\n    }\n    if (!(flags &amp; 1 &lt;&lt; 1)) {\n        printf(\"Enter your prefix (e.g. \\\"Local time:\\\", up to 64 characters) \");\n        // flush the input buffer: https://stackoverflow.com/questions/7898215/how-to-clear-input-buffer-in-c\n        int c;\n        while ((c = getchar()) != '\\n' &amp;&amp; c != EOF) {}\n        gets(prefix);\n        puts(prefix);\n    }\n    if (!(flags &amp; 1 &lt;&lt; 2)) {\n        printf(\"Enter \\\"1\\\" to enable 24 hour mode, and \\\"0\\\" to enable 12 hour mode. \");\n        scanf(\"%i\", &amp;h24);\n        printf(\"24h %i\\n\", h24);\n    }\n    // Main loop\n    while (1) {\n        // AM I DOING THIS PART RIGHT???\n        writeTime(timezone, prefix, h24);\n        sleep(1);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 432, "user_id": 4249714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3cdf02d97c4849cdd40b4bfde7f458?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian", "link": "https://stackoverflow.com/users/4249714/sebastian"}, "edited": false, "score": 1, "creation_date": 1553119100, "post_id": 55270727, "comment_id": 97272751, "body": "remove the newline from scanf, like so <code>scanf(&quot;%99f&quot;, &amp;zmienna);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1553119468, "post_id": 55270727, "comment_id": 97272881, "body": "If you are using just <code>%d</code> and <code>%f</code> you don&#39;t need to worry about newlines, leading whitespace gets filtered (<code>%c</code> is another matter). But what is the <code>99</code> in <code>%99f</code> supposed to achieve? Keep it simple, for now."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": false, "score": 2, "last_activity_date": 1553119644, "last_edit_date": 1553119644, "creation_date": 1553119439, "answer_id": 55270843, "question_id": 55270727, "link": "https://stackoverflow.com/questions/55270727/c-scanf-ignore-second-variable-in-loop/55270843#55270843", "title": "C scanf ignore second variable in loop", "body": "<p>The specific problem you were having is with <code>scanf</code>: putting a <code>\\n</code> is generally a bad idea because entering a newline is generally how you send off a line of characters to the program. Use <code>'\\n'</code> liberally in <code>printf</code> and \"never\" with <code>scanf</code>.</p>\n\n<p>Here's my modified version. I removed the pointer shenanigans because indexing into the array is simpler and better, and also initialized the array which you should always do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    float T[100] = {0}; // Used to not be initialized.\n    float suma = 0, zmienna;\n    int rozmiar;\n\n    printf(\"How many numbers would you like to put in: \");\n    scanf(\"%d\", &amp;rozmiar);\n\n    printf(\"\\n Enter the number: \\n\");\n    for (int i = 0; i&lt;rozmiar; i++) {\n        printf(\"\\n i = %d\", i);\n        scanf(\"%f\", &amp;zmienna);\n        T[i] = zmienna;\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10978206, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w1kwsJk-wrg/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOJj22dMWIE1IsBD78Clzw_84T8lw/mo/photo.jpg?sz=128", "display_name": "ice592", "link": "https://stackoverflow.com/users/10978206/ice592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1553119592, "answer_count": 1, "score": 1, "last_activity_date": 1553119644, "creation_date": 1553118732, "last_edit_date": 1553119528, "question_id": 55270727, "link": "https://stackoverflow.com/questions/55270727/c-scanf-ignore-second-variable-in-loop", "closed_reason": "Duplicate", "title": "C scanf ignore second variable in loop", "body": "<pre><code>int main()\n{\n    float T[100];\n    float *pt=T;\n    float suma = 0, srednia, zmienna;\n    int rozmiar;\n\n    printf(\"How many numbers would you like to put in: \");\n    scanf(\" %d\", &amp;rozmiar);\n    int dzielnik = rozmiar;\n\n    printf(\"\\n Enter the number: \\n\");\n    for(int i = 0;i&lt;rozmiar;i++)\n    {\n        printf(\"\\n i = %d\", i );\n        scanf(\"%99f\\n\", &amp;zmienna);\n        *(pt+i) = zmienna;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This is my code. The idea is simple. I have an array; I want to scan how many numbers I want to put into the array and then put numbers into array. I don't know why but <code>scanf</code> ignores the second variable that I put in array.</p>\n\n<p>If I put \"2\" in first scanf, program wants 3 variables from me.</p>\n\n<p>My output should be like this:</p>\n\n<pre><code>How many numbers would you like to put in: 2 \n\nEnter the number:\n\ni = 0\n\n2 (my number)\n\ni=1\n\n3 (my number)\n</code></pre>\n\n<p>but it's actually like this:</p>\n\n<pre><code>How many numbers would you like to put in: 2 \n\nEnter the number:\n\ni = 0\n\n1 (my number)\n\n2 (my number)\n\ni = 1\n\n3 (my number)\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 2, "creation_date": 1553118382, "post_id": 55270655, "comment_id": 97272521, "body": "It&#39;s <code>&amp;letter</code>. Change it to just <code>letter</code>, as well as making empty list just <code>char empty_list[26]&#39; . What you&#39;re doing with </code>&amp;letter` and an array of pointers is to make each array entry contain the address of the variable <code>letter</code>, and since that is continuously updated it will only contain the last change made to it, which is the last letter."}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 1, "creation_date": 1553118524, "post_id": 55270655, "comment_id": 97272574, "body": "Also consider using <code>&#39;A&#39;</code> rather than <code>65</code> in the calculation. It makes it more obvious what your intention is."}], "answers": [{"tags": [], "owner": {"reputation": 5425, "user_id": 583044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ad7ef9756043aad048a7f0e70c724f?s=128&d=identicon&r=PG", "display_name": "tinman", "link": "https://stackoverflow.com/users/583044/tinman"}, "is_accepted": false, "score": 3, "last_activity_date": 1553119543, "last_edit_date": 1553119543, "creation_date": 1553118555, "answer_id": 55270702, "question_id": 55270655, "link": "https://stackoverflow.com/questions/55270655/array-pointer-issue-in-c-array-only-contains-last-value/55270702#55270702", "title": "Array pointer issue in C - array only contains last value", "body": "<p>The main problem is your declaration:</p>\n\n<pre><code>char *empty_list[26];\n</code></pre>\n\n<p>defines an array of 26 pointers to characters. In your current code you assign each element in the array the address of the variable letter. Since that is out of scope when you print it is luck that it prints out the last one, it could equally have printed out garbage or crashed if the code between was complex. It could also have printed out additional garbage after the letter with what you already have since there is no way of knowing whether there is a string terminating character (\\0) after the letter. In your existing code <code>printf(\"%s\", *empty_list);</code> prints the first pointer from the array as a null terminated string, which if you ignore the loss of scope and assume the memory contents are still around, will be the last value from the loop since all pointers in your array point to the memory that letter was stored at and that memory has the last value from the loop.</p>\n\n<p>If your intention was to create an array with the letters then it should be:</p>\n\n<pre><code>char empty_list[27];\n</code></pre>\n\n<p>It needs to be 27 as you need to leave space for the string terminating character at the end. One way to fill that in would be to use:</p>\n\n<pre><code>empty_list[26] = '\\0';\n</code></pre>\n\n<p>after the end of your for loop and before you print the contents of the array (do not include the asterisk here - because it is an array the compiler will automatically take the address of the first element):</p>\n\n<pre><code>printf(\"%s\", empty_list);\n</code></pre>\n\n<p>As brothir mentioned in the comments when you assign the value of the letter to the element in the array it should be without the ampersand:</p>\n\n<pre><code>empty_list[i] = letter;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1553122958, "last_edit_date": 1553122958, "creation_date": 1553118614, "answer_id": 55270709, "question_id": 55270655, "link": "https://stackoverflow.com/questions/55270655/array-pointer-issue-in-c-array-only-contains-last-value/55270709#55270709", "title": "Array pointer issue in C - array only contains last value", "body": "<p>There are a few things wrong with your code.</p>\n\n<p>Firstly, the type of <code>empty_list</code> is presently an array of pointers to <code>char</code>, when it really should be an array of <code>char</code>, since your intent is to print it out as if it were the latter in the call to <code>printf</code> after your loop.  <code>char empty_list[26];</code> is the correct declaration.</p>\n\n<p>Secondly, in your loop, you assign <code>&amp;letter</code> when all you need is <code>letter</code>. Heck, you don't even need the intermediate variable <code>letter</code>. Just <code>empty_list[i] = i + 'A';</code> will suffice.</p>\n\n<p>Lastly, you are passing <code>empty_list</code> to <code>printf</code> to satisfy a format specifier <code>%s</code>, which expects a null-terminated string. What you need to do is add another element to <code>empty_list</code> and set that to zero:</p>\n\n<pre><code>char empty_list[27];\n// populated 0..25 with 'A'..'Z' in your code...\n\nempty_list[26] = '\\0';\n\nprintf(\"%s\\n\", empty_list);\n// Output: ABC...Z\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1553220415, "last_edit_date": 1553220415, "creation_date": 1553144475, "answer_id": 55274053, "question_id": 55270655, "link": "https://stackoverflow.com/questions/55270655/array-pointer-issue-in-c-array-only-contains-last-value/55274053#55274053", "title": "Array pointer issue in C - array only contains last value", "body": "<p>With the above help (much appreciated), my working code to create an array of letters in C is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    // create an array with 1 extra space for null terminator \n    char empty_list[27];\n\n    // add null terminator so string knows when it's finished.\n    empty_list[26] = '\\0';\n\n    for (int i = 0; i &lt; 26; i++){\n        // add 65 to get ASCII value for 'A'\n        char letter = A + i;\n        // insert each char into the array sequentially\n        empty_list[i] = letter;\n    }\n\n    printf(\"%s\", empty_list);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 55270709, "answer_count": 3, "score": 1, "last_activity_date": 1553220415, "creation_date": 1553118312, "last_edit_date": 1553118701, "question_id": 55270655, "link": "https://stackoverflow.com/questions/55270655/array-pointer-issue-in-c-array-only-contains-last-value", "title": "Array pointer issue in C - array only contains last value", "body": "<p>I'm trying to add (well, append really) the letters in the alphabet to an empty char array. However, I appear to run into some sort of pointer issue I don't understand, as my array contains only the last character. I tried moving the letter char outside of the for loop, but the compiler didn't like that. I also looked on here about how to create a list of all alphabetical chars, and one of the better answers was to type them all in 1 at a time. However, my problem means I don't fully understand for loops and pointers in C, and I want to.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n\n    char *empty_list[26];\n\n    for (int i = 0; i &lt; 26; i++){\n        char letter = i + 65;\n        empty_list[i] = &amp;letter;\n    }\n\n    printf(\"%s\", *empty_list);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "process"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1553117421, "post_id": 55270469, "comment_id": 97272146, "body": "Because your children create their children too."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 3, "creation_date": 1553117493, "post_id": 55270469, "comment_id": 97272172, "body": "Both the parent and child continue executing the <code>for</code> loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553117644, "post_id": 55270469, "comment_id": 97272244, "body": "@EugeneSh. How do I fix that and produce the same result?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553117678, "post_id": 55270469, "comment_id": 97272261, "body": "@Barmar How do I prevent that but have the same result? why is that happening?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553117726, "post_id": 55270469, "comment_id": 97272282, "body": "Many ways to do so. Simplest (but a bit ugly) would be to add a &quot;is_child&quot; flag that you set within the function and check in the <code>for</code> loop. better refactor it a bit."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1553117749, "post_id": 55270469, "comment_id": 97272294, "body": "@maverick98 Consider if &#39;child_creator(..)&#39; returned the child pid, so in the outside loop: <code>if (child_creator() == 0) { break &#47;* child doesn&#39;t get to loop again! *&#47;; }</code>. Does that show the flow better, and why the child is also running the &quot;parents&quot; loop? Many options to actually address such.."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1553117766, "post_id": 55270469, "comment_id": 97272302, "body": "The child could exit instead of returning."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553117899, "post_id": 55270469, "comment_id": 97272355, "body": "@Barmar When I used exit(0) at the end of if(child==0) the program did not run as expected"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553117978, "post_id": 55270469, "comment_id": 97272381, "body": "You have other problems. You&#39;re writing to <code>fd[1]</code> after you closed it earlier."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1553119077, "post_id": 55270469, "comment_id": 97272745, "body": "What&#39;s up with the screen shot?  Text is your friend."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1553118328, "post_id": 55270579, "comment_id": 97272500, "body": "I&#39;m also unsure about using the same pipe for every child. You can&#39;t be sure that they&#39;ll write and read in the desired order."}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1553118809, "post_id": 55270579, "comment_id": 97272660, "body": "@maverick98 after your edit, your code still closes <code>fd[1]</code> before trying to write to it..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1553118950, "post_id": 55270579, "comment_id": 97272702, "body": "@MichaelBeer How can I fix that? I removed the close(fd[1]); but when I run the program it doesn&#39;t print anything at all"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553119054, "post_id": 55270579, "comment_id": 97272738, "body": "Declare an array of pipes, create a new pipe before each fork, and each child uses the appropriate pipe to communicate with the next one in the series."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "edited": false, "score": 0, "creation_date": 1553119633, "post_id": 55270579, "comment_id": 97272943, "body": "@Barmar I tried what you said , but I think I am doing something wrong , I edited the post with the new code"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553119734, "post_id": 55270579, "comment_id": 97272977, "body": "<code>read(fd[j], ...)</code> should be <code>read(fd[j][0], ...)</code>, and similarly for all the other functions that use the pipes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "edited": false, "score": 0, "creation_date": 1553120472, "post_id": 55270579, "comment_id": 97273227, "body": "@Barmar Actually I made it work , everyone interested see the Edit"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553120488, "post_id": 55270579, "comment_id": 97273232, "body": "Post your final solution as an answer."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1553117885, "creation_date": 1553117885, "answer_id": 55270579, "question_id": 55270469, "link": "https://stackoverflow.com/questions/55270469/why-does-this-function-produce-so-many-child-processes/55270579#55270579", "title": "Why does this function produce so many child processes?", "body": "<p>Both the parent and child are returning to the <code>for</code> loop in <code>main()</code>. Since the child doesn't need to do anything after it writes its result, it should just exit rather than returning.</p>\n\n<p>You also have problems with your handling of the pipe file descriptors. You do <code>close(fd[1])</code> at the beginning of the child, but later try to <code>write(fd[1],&amp;w,sizeof(w))</code>. You can't write to a closed FD. You don't need to close anything until the child is exiting, and exiting a process automatically closes all its files.</p>\n\n<pre><code>void child_creator(){\n    pid_t child;\n    child=fork();\n    if (child==0) {\n        read(fd[0],&amp;w,sizeof(w));\n        w=w*count;\n        count++;\n        printf(\"I am child %d , my father is %d , the prod is %d\\n\",getpid(),getppid(),w);\n        sleep(1);\n        write(fd[1],&amp;w,sizeof(w));\n        exit(0);   \n    }\n}       \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7475343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55270579, "answer_count": 1, "score": 0, "last_activity_date": 1553271840, "creation_date": 1553117319, "last_edit_date": 1553271840, "question_id": 55270469, "link": "https://stackoverflow.com/questions/55270469/why-does-this-function-produce-so-many-child-processes", "title": "Why does this function produce so many child processes?", "body": "<p>I wrote this code in order to calculate the factorial of a number using processes and <code>pipe()</code>. I wanted to pass on the result from the child process to the child process. For example, to create calculate 5! the main which is the father sends the number 1 in the pipe. Then the first child is created and does 1*2, then it pushes in the pipe the number 2, the second child does 2*3 pushes the result in the pipe etc... Also, I use argv[1][0] thinking that we run the program like this (./ex3 5) where 5 is the number of which the factorial we would like to find. After running the program though, <strong>I noticed that a lot of child process was created <em>(I only wanted 4)</em>. Why is that?</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint fd[2];\nint w,count=2;\n\nvoid child_creator(){\n    pid_t child;\n    child=fork();\n    if (child==0) {\n        close(fd[1]);\n        read(fd[0],&amp;w,sizeof(w));\n        close(fd[0]);\n        w=w*count;\n        count++;\n        printf(\"I am child %d , my father is %d , the prod is %d\\n\",getpid(),getppid(),w);\n        sleep(1);\n\n        close(fd[0]);\n        write(fd[1],&amp;w,sizeof(w));\n        close(fd[1]);       \n    }\n}       \n\nint main(int argc , char **argv){\n    int fact=argv[1][0]-'0';\n    pipe(fd);\n    w=1;\n    for (int i=0; i&lt;fact-1; i++){\n         printf(\"this is i %d\\n\", i);\n        child_creator();\n    }\n    return 0;\n}   \n</code></pre>\n\n<p>After a suggested answer I tried this code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint fd[1000][2];\nint w,count=1,j=0;\n\nvoid child_creator(){\n    pid_t child;\n    j++;\n    pipe(fd[j]);\n    child=fork();\n    if (child==0) {\n        close(fd[j-1][1]);\n        read(fd[j-1][0],&amp;w,sizeof(w));\n        close(fd[j-1][0]);\n        w=w*count;\n        printf(\"I am child %d , my father is %d , the prod is %d\\n\",getpid(),getppid(),w);\n        sleep(1);\n\n        close(fd[j-1][0]);\n        write(fd[j][1],&amp;w,sizeof(w));\n        close(fd[j][1]);\n\n        exit(0);        \n\n    }\n\n}       \n\nint main(int argc , char **argv){\n    int fact=argv[1][0]-'0';\n    w=1;\n    for (int i=0; i&lt;fact-1; i++){ \n     count++;\n     child_creator();\n     sleep(2);\n    }\n\n    return 0;\n}   \n</code></pre>\n"}, {"tags": ["c", "oop", "pointers", "polymorphism"], "comments": [{"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 2, "creation_date": 1553117594, "post_id": 55270426, "comment_id": 97272222, "body": "Why do you think you <i>should</i> allocate your struct on the heap? the way you use it, it is totally fine to have it on the stack. Just don&amp;#39;t treat your struct as a pointer and access its members like <code>local_context.memberMethod()</code> . in fact, you should <i>avoid</i> allocating memory unless really required. in your situation, there is no need to have your struct on the heap, thus <i>do not</i> allocate it. have the compiler manage the object instead.  Apart from that - fine use of function pointers.   what should you require function pointers for if not for deciding at runtime which function to call?"}, {"owner": {"reputation": 920, "user_id": 4718423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/316O2.png?s=128&g=1", "display_name": "hewi", "link": "https://stackoverflow.com/users/4718423/hewi"}, "reply_to_user": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1553118051, "post_id": 55270426, "comment_id": 97272413, "body": "thanks, noted, appreciated"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "edited": false, "score": 0, "creation_date": 1553118364, "post_id": 55270426, "comment_id": 97272514, "body": "you are welcome. just to clarify: entirely fine usage of function pointers. if you want to read  a bit more about advanced techniques like these, I can recommend &quot;21st century C&quot; - forgot the author though..."}], "owner": {"reputation": 920, "user_id": 4718423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/316O2.png?s=128&g=1", "display_name": "hewi", "link": "https://stackoverflow.com/users/4718423/hewi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553117082, "creation_date": 1553117082, "question_id": 55270426, "link": "https://stackoverflow.com/questions/55270426/point-to-function-in-memory-depending-on-context-polymorphism", "title": "point to function in memory depending on context - polymorphism", "body": "<p>I would like to call a function depending on the context, it's the polymorphism idea I just can't seem to grasp.</p>\n\n<p>Is following example a plausible solution? where you create a struct and point to relevant function depending on Context:</p>\n\n<p><em>I know I should allocate memory for the stuct, which I am not doing in this pseudo code</em></p>\n\n<pre><code>struct ContextMethods{\n   void (*memberMethod)();\n} ContextMethods;\n\nvoid debugFunction(){ returns debug info};\nvoid productionFunction( does usefull production stuff);\nvoid run(ContextMethods local_context);\n\nmain(){\n\n    struct ContextMethods local_struct;\n\n    if(DEBUG){\n        local_struct-&gt;memberMethod = &amp;debugFunction;\n    }\n    if(PRODUCTION){\n        local_struct-&gt;memberMethod = &amp;productionFunction;\n    }\n\n    run(local_context);\n}\n\nrun(local_context){\n    local_context-&gt;memberMethod();\n}\n</code></pre>\n"}, {"tags": ["python", "c", "enums", "switch-statement", "typedef"], "comments": [{"owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "edited": false, "score": 0, "creation_date": 1553110545, "post_id": 55268847, "comment_id": 97268809, "body": "<code>but I&#39;m not sure how to implement the typedef, enum and switch statements in Python.</code> You don&#39;t"}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 4, "creation_date": 1553110682, "post_id": 55268847, "comment_id": 97268870, "body": "The C code looks like it can be replaced with <code>mode = (0x00 &lt;= d &amp;&amp; d &lt;= 0x07) ? d : 0xFF</code>, which in Python would be <code>mode = d if 0x00 &lt;= d &lt;= 0x07 else 0xFF</code>.  For the enum, use <a href=\"https://docs.python.org/3/library/enum.html#creating-an-enum\" rel=\"nofollow noreferrer\"><code>enum</code></a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553111437, "post_id": 55268847, "comment_id": 97269222, "body": "Related: <a href=\"https://stackoverflow.com/questions/1429505/does-python-have-an-equivalent-to-switch\">Does Python have an equivalent to switch?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 7443101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f96d09d90a71a8e256883f1f1576cf01?s=128&d=identicon&r=PG&f=1", "display_name": "Merig", "link": "https://stackoverflow.com/users/7443101/merig"}, "is_accepted": false, "score": 1, "last_activity_date": 1553110781, "creation_date": 1553110781, "answer_id": 55268953, "question_id": 55268847, "link": "https://stackoverflow.com/questions/55268847/how-to-implement-the-following-c-code-in-python-typedef-enums-and-switch/55268953#55268953", "title": "How to implement the following C code in Python? (typedef, enums and switch)", "body": "<p>How about a dictionary? You could assign each value to the corresponding mode, then call it:</p>\n\n<pre><code>modes = {\n    0x00 : 'CAN_NORMAL_MODE',\n    0x01 : 'CAN_SLEEP_MODE',\n    0x02 : 'CAN_INTERNAL_LOOPBACK_MODE',\n    0x03 : 'CAN_LISTEN_ONLY_MODE',\n    0x04 : 'CAN_CONFIGURATION_MODE',\n    0x05 : 'CAN_EXTERNAL_LOOPBACK_MODE',\n    0x06 : 'CAN_CLASSIC_MODE',\n    0x07 : 'CAN_RESTRICTED_MODE',\n    0xFF : 'CAN_INVALID_MODE'\n}\n\nd = something\nmode = modes[d]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51632, "user_id": 208880, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/de311342220232e618cb27c9936ab9bf?s=128&d=identicon&r=PG", "display_name": "Ethan Furman", "link": "https://stackoverflow.com/users/208880/ethan-furman"}, "is_accepted": false, "score": 2, "last_activity_date": 1553183288, "last_edit_date": 1553183288, "creation_date": 1553111194, "answer_id": 55269044, "question_id": 55268847, "link": "https://stackoverflow.com/questions/55268847/how-to-implement-the-following-c-code-in-python-typedef-enums-and-switch/55269044#55269044", "title": "How to implement the following C code in Python? (typedef, enums and switch)", "body": "<pre><code>from enum import IntEnum\n\nclass CAN_OPERATION_MODE(IntEnum):\n    NORMAL_MODE = 0x00\n    SLEEP_MODE = 0x01\n    INTERNAL_LOOPBACK_MODE = 0x02\n    LISTEN_ONLY_MODE = 0x03\n    CONFIGURATION_MODE = 0x04\n    EXTERNAL_LOOPBACK_MODE = 0x05\n    CLASSIC_MODE = 0x06\n    RESTRICTED_MODE = 0x07\n    INVALID_MODE = 0xFF\n\n    @classmethod\n    def _missing_(cls, value):\n        return cls.INVALID_MODE\n\nd = something\nmode = CAN_OPERATION_MODE(d)\n</code></pre>\n\n<p>I would also  remove the <code>_MODE</code> from all the enum names.</p>\n"}, {"comments": [{"owner": {"reputation": 543, "user_id": 11167518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pgw08oaXiaA/AAAAAAAAAAI/AAAAAAAABj0/Esy9fxNslfU/photo.jpg?sz=128", "display_name": "jcf", "link": "https://stackoverflow.com/users/11167518/jcf"}, "edited": false, "score": 0, "creation_date": 1553196174, "post_id": 55269244, "comment_id": 97305268, "body": "I was able to solve the problem in this way. I didn&#39;t want to do this kind of if-elif... construction, and I admit that I was a little obsessed with recreating the exact functionality of the C code in Python (instead of similar code that may work in a different way, but obtains the same results). Nevertheless, the most straightforward path (yours) was succesful. Thanks!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1553112003, "creation_date": 1553112003, "answer_id": 55269244, "question_id": 55268847, "link": "https://stackoverflow.com/questions/55268847/how-to-implement-the-following-c-code-in-python-typedef-enums-and-switch/55269244#55269244", "title": "How to implement the following C code in Python? (typedef, enums and switch)", "body": "<p>For the enum itself, you seem to be making it harder than it needs to be.  An enum can be mapped very cleanly to a python module containing only a bunch of variable definitions, such as this:</p>\n\n<p><strong>can_operation_mode.py</strong>:</p>\n\n<pre><code>CAN_NORMAL_MODE = 0x00\nCAN_SLEEP_MODE = 0x01\nCAN_INTERNAL_LOOPBACK_MODE = 0x02\nCAN_LISTEN_ONLY_MODE = 0x03\nCAN_CONFIGURATION_MODE = 0x04\nCAN_EXTERNAL_LOOPBACK_MODE = 0x05\nCAN_CLASSIC_MODE = 0x06\nCAN_RESTRICTED_MODE = 0x07\nCAN_INVALID_MODE = 0xFF\n</code></pre>\n\n<p>That provides useful namespacing (which C enums don't), but also the ability to import those names into another module so as to use them C style, without module name.  Of course, the tradeoff is that they are modifiable.</p>\n\n<p>As for the <code>switch</code>, no, Python does not have a direct analog to C's <code>switch</code>, at least not if you disqualify the sort of <code>if</code> / <code>else if</code> / <code>else</code> construct you describe in the question:</p>\n\n<p><strong>other_module.py</strong>:</p>\n\n<pre><code>import can_operation_mode.*\n\nd = something \nif   d == CAN_NORMAL_MODE:\n    mode = CAN_NORMAL_MODE\nelif d == CAN_SLEEP_MODE:\n    mode = CAN_SLEEP_MODE\n// more cases here ...\nelse:\n    mode = CAN_INVALID_MODE\n</code></pre>\n\n<p>Frankly, though, I don't see what's wrong with that from a perspective of maintaining syntactic similarity to the original C.  It looks pretty similar to me, right down to the use of colons.</p>\n"}], "owner": {"reputation": 543, "user_id": 11167518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Pgw08oaXiaA/AAAAAAAAAAI/AAAAAAAABj0/Esy9fxNslfU/photo.jpg?sz=128", "display_name": "jcf", "link": "https://stackoverflow.com/users/11167518/jcf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 55269244, "answer_count": 3, "score": 0, "last_activity_date": 1553183288, "creation_date": 1553110339, "question_id": 55268847, "link": "https://stackoverflow.com/questions/55268847/how-to-implement-the-following-c-code-in-python-typedef-enums-and-switch", "title": "How to implement the following C code in Python? (typedef, enums and switch)", "body": "<p>I have the following part of code in C:</p>\n\n<pre><code>typedef enum {\n    CAN_NORMAL_MODE = 0x00,\n    CAN_SLEEP_MODE = 0x01,\n    CAN_INTERNAL_LOOPBACK_MODE = 0x02,\n    CAN_LISTEN_ONLY_MODE = 0x03,\n    CAN_CONFIGURATION_MODE = 0x04,\n    CAN_EXTERNAL_LOOPBACK_MODE = 0x05,\n    CAN_CLASSIC_MODE = 0x06,\n    CAN_RESTRICTED_MODE = 0x07,\n    CAN_INVALID_MODE = 0xFF\n} CAN_OPERATION_MODE;\n\n//more code here in the middle...\n\nd = something \nswitch (d) {\n    case CAN_NORMAL_MODE:\n        mode = CAN_NORMAL_MODE;\n        break;\n    case CAN_SLEEP_MODE:\n        mode = CAN_SLEEP_MODE;\n        break;\n   // more cases here, not shown for readability\n    default:\n        mode = CAN_INVALID_MODE;\n        break;\n}\n</code></pre>\n\n<p>Here <em>d</em> is a byte that I read from other sources. The switch statement is inside another function, and more code is there, but I don't think it is necessary to show as it does nothing to do with this part.</p>\n\n<p>My problem is: I'm trying to <em>translate</em> this code to Python, for reasons, so that it is <em>sintactically similar</em> to the original C code (that is, I don't want the Python code to be radically different, so another person that has worked with the original C code can understand and use easily the Python code). I'm not sure how to implement the functionality in this code snippet in Python language without doing an endless stream of <em>if-elif...else</em> statements. I think there should an easier (pythonic) way to do it, but I'm not sure how to implement the <em>typedef</em>, <em>enum</em> and <em>switch</em> statements in Python. I have read some ways to implement the <em>enum</em> clause creating a class with the aliases and values as attributes, like this:</p>\n\n<pre><code>class myClass():\n    def __init__(self):\n        self.CAN_NORMAL_MODE = 0x00\n        self.CAN_SLEEP_MODE = 0x01\n        self.CAN_INTERNAL_LOOPBACK_MODE = 0x02\n    #etc\n</code></pre>\n\n<p>I have also come across a clever way of implementing a switch statement in Python, with a function like this (without any relation to my actual problem, just to show the structure of the implementation):</p>\n\n<pre><code>def switch(argument):\n    switcher = {\n        1: \"January\",\n        2: \"February\",\n        3: \"March\",\n        4: \"April\",\n        5: \"May\",\n        6: \"June\",\n        7: \"July\",\n        8: \"August\",\n        9: \"September\",\n        10: \"October\",\n        11: \"November\",\n        12: \"December\"\n    }\n    print switcher.get(argument, \"Invalid month\")\n</code></pre>\n\n<p>But I can't come across a way of combining this two things in an easy and understandable way. \nThank you and have a nice day!</p>\n"}, {"tags": ["c", "arduino", "esp32"], "comments": [{"owner": {"reputation": 795, "user_id": 3726543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8859affbf397ef24de423d42f0203356?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3726543/martin"}, "edited": false, "score": 1, "creation_date": 1553111738, "post_id": 55268598, "comment_id": 97269378, "body": "You are calling SaveParam() with a pointer to val as argument, and val is a pointer to i but you are trying to print the b value, could you clarify that ?"}, {"owner": {"reputation": 25, "user_id": 11027969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d58360dc488ba9fd6e38cf21bf5ec5?s=128&d=identicon&r=PG&f=1", "display_name": "DohnJoe", "link": "https://stackoverflow.com/users/11027969/dohnjoe"}, "reply_to_user": {"reputation": 795, "user_id": 3726543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8859affbf397ef24de423d42f0203356?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3726543/martin"}, "edited": false, "score": 0, "creation_date": 1553157627, "post_id": 55268598, "comment_id": 97283129, "body": "Yeah so actually the thing is that I want to compare two integer values. Idea: I receive a request from a wlan bridge and I am saving the integer value  I received from the Bridge into the EEPROM with the method SaveParam(int* param). Next, I want to load this integer value back into a variable with the method LoadParam() to compare the new int value from the bridge request with the old one from the bridge, which was saved, to know if I should rotate the stepper motor up or down."}, {"owner": {"reputation": 795, "user_id": 3726543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8859affbf397ef24de423d42f0203356?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3726543/martin"}, "edited": false, "score": 0, "creation_date": 1553192345, "post_id": 55268598, "comment_id": 97303483, "body": "My point was, is the problem about the save/load function from eeprom or is it about your code on top of it ? I understand your point of view but please, give us a code that is small and with the problem like: &quot;int b = 5; saveparam(b); int c = loadParam(); if (b != c) print(&quot;error&quot;)&quot;"}, {"owner": {"reputation": 2182, "user_id": 1689090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8d951e67e4b0c03f5b4c021e22b93d?s=128&d=identicon&r=PG", "display_name": "Evil Dog Pie", "link": "https://stackoverflow.com/users/1689090/evil-dog-pie"}, "edited": false, "score": 0, "creation_date": 1553524050, "post_id": 55268598, "comment_id": 97405140, "body": "SaveParam() writes 4 integers to EEPROM, starting with the one at the address passed in param (this might be what you want).  LoadParam() reads 4 integers from EEPROM into an array with space for ten integers, then returns the eleventh element from the array.  You need to fix both of these functions before you can even think about using the value returned by LoadParam()."}], "owner": {"reputation": 25, "user_id": 11027969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d58360dc488ba9fd6e38cf21bf5ec5?s=128&d=identicon&r=PG&f=1", "display_name": "DohnJoe", "link": "https://stackoverflow.com/users/11027969/dohnjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553114377, "creation_date": 1553109373, "last_edit_date": 1553114377, "question_id": 55268598, "link": "https://stackoverflow.com/questions/55268598/saving-int-value-into-eeprom-and-loading-it-back-into-a-value-again", "title": "Saving int value into Eeprom and loading it back into a value again", "body": "<p>so i am trying to save an integer value into Eeprom and load it back into a value again. But the problem is, that i can't load the saved int value correctly into the new int value. </p>\n\n<p>I am doing this, because I want to compare the new int value with the already saved one, to control a stepper motor with the rotations got from that value. </p>\n\n<pre><code>void SaveParam(int* param) {\n    Serial.print(\"Saving Param: \");\n    //Serial.println(param);\n    EEPROM.begin(512);\n    for (int i = 0; i &lt; 4; i++)\n        EEPROM.write(i+500, (int)param[i]);\n    EEPROM.end();\n}\n\nint LoadParam(){\n    int b[10];\n    EEPROM.begin(512);\n    for (int i = 0; i &lt; 4; i++)\n        b[i]= byte(EEPROM.read(i+500));   \n    EEPROM.end();\n    return b[10];\n}\n\n\n// main part\nint b = (int)LoadParam();\nint* val = &amp;i;\n\nif (i&gt;b) {\n    Serial.print(\"Motor is going down (clockwise) \");    \n    MotorMoveDown(i);\n    SaveParam(val);\n    Serial.println(b);\n} else if (i&lt;b) {\n    Serial.print(\"Motor is going up (counter-clockwise)\"); \n    MotorMove(i);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1553109281, "post_id": 55268495, "comment_id": 97268164, "body": "Why don&#39;t you trust the standard?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 4, "creation_date": 1553109293, "post_id": 55268495, "comment_id": 97268171, "body": "Yes, <code>void*</code> is a type. Not sure what the actual question is."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1553109549, "post_id": 55268495, "comment_id": 97268320, "body": "<code>int*</code> and <code>int</code> are both types, which is why <code>sizeof(int*)</code> and <code>sizeof(int)</code> both work."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1553109564, "post_id": 55268495, "comment_id": 97268329, "body": "@DYZ Because i see different claiming about this, so i ask myself if void* is a token (a type in this case) or is void + *. Why i ask myself? That&#39;s a good question my friend...i guess i just like to understand the things well..."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1553109581, "post_id": 55268495, "comment_id": 97268334, "body": "Is there something that makes you think being a type and being a pointer are mutually exclusive?"}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1553109931, "post_id": 55268495, "comment_id": 97268502, "body": "@ChristianGibbons In my world of doubt yes. For example the fact that &quot;void* ptr&quot; and &quot;void     *      ptr&quot; both work and that void* and void** are both addresses containers, so i wonder why to make them to be declared in different manners...By the way i am not experienced so to me, everything makes me rise doubts..."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1553109959, "post_id": 55268495, "comment_id": 97268516, "body": "Rule of thumb: many discussions are hogwash but the C standard is concrete. So in a dispute trust the latter."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553110196, "post_id": 55268495, "comment_id": 97268631, "body": "<code>void* ptr</code> and <code>void * ptr</code> are identical.  As is <code>void *ptr</code>.  The white-space is inconsequential.  I&#39;m not sure what you are getting at with the comparison of <code>void*</code> and <code>void**</code>."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1553110698, "post_id": 55268495, "comment_id": 97268881, "body": "@ChristianGibbons if void* is a pointer type and void** is also a pointer type, &quot;holding&quot; the same size of a void type, i cannot really see a semantical difference, but since sizeof() accepts a type, than void* and void** has to different types, but i have no idea in what they differs."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553111631, "post_id": 55268495, "comment_id": 97269329, "body": "<code>void*</code> is a pointer to a <code>void</code>.  <code>void**</code> is a pointer to <code>void *</code>.  So they are both pointers, but that is only part of their type.  What they point to is also a part of their type."}, {"owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "edited": false, "score": 1, "creation_date": 1553112785, "post_id": 55268495, "comment_id": 97269893, "body": "@Paolo There is a semantic difference between <code>void*</code> and <code>void**</code>. The latter has more information about the value than the former one. And that distinction is important for type safety."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "edited": false, "score": 0, "creation_date": 1553110475, "post_id": 55268720, "comment_id": 97268775, "body": "As far as i knew, void* pointers did not allow for arithmetic ops like using ++ operator, but today trying some code, the operation was executed and the address pointed increased of 1byte...rising me so much question since from some discussions, was written the void was the type (incomplete) and * was only a sintax to &quot;generate&quot; the proper pointer, avoiding to state that void* is actually a type itself. Thanks for explanation dbush"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "edited": false, "score": 1, "creation_date": 1553110631, "post_id": 55268720, "comment_id": 97268851, "body": "@Paolo See my update.  Some compilers allow it as an extension."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "edited": false, "score": 0, "creation_date": 1553111277, "post_id": 55268720, "comment_id": 97269152, "body": "In design C programs you would advise to follows strict C standards or GNU? Why does GNU prefer to officially brake ANSI C?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "edited": false, "score": 2, "creation_date": 1553111562, "post_id": 55268720, "comment_id": 97269293, "body": "@Paolo Generally you should follow the standard.  The only time I&#39;d recommend using extensions is if your program by its nature is restricted to some specific hardware or OS."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "edited": false, "score": 1, "creation_date": 1553120232, "post_id": 55268720, "comment_id": 97273143, "body": "@paolo: defining behaviour which is not defined by the standard does not break anything. The standard does not prohibit undefined behaviour; it merely fails to define the consequences. So GCC (and other compilers) are free to extend the standard, and you are free to use those extensions if you don&#39;t care about portability."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1553110612, "last_edit_date": 1553110612, "creation_date": 1553109852, "answer_id": 55268720, "question_id": 55268495, "link": "https://stackoverflow.com/questions/55268495/in-c-is-void-a-type/55268720#55268720", "title": "in C: Is void* a type?", "body": "<p>A <code>void *</code> is a valid type that has a known size.  What it points to is either some object whose type is not known or valid untyped memory (i.e. memory returned from <code>malloc</code>).  As such <code>sizeof(void *)</code> is a valid expression.</p>\n\n<p>Paragraph 1 of 6.5.3.4 states:</p>\n\n<blockquote>\n  <p><strong>The <code>sizeof</code> operator shall not be applied to an expression that has\n  function type or an incomplete  type,  to  the  parenthesized  name \n  of  such  a  type</strong>,  or  to  an  expression  that designates  a \n  bit-field  member.   The\n  <code>_Alignof</code> operator  shall  not  be  applied  to  a function type or an incomplete type.</p>\n</blockquote>\n\n<p>Because <code>void *</code> is not an incomplete type, <code>sizeof(void *)</code> is valid.  However, because <code>void</code> type is incomplete, <code>sizeof(void)</code> is invalid.</p>\n\n<p>Addressing your comment about <code>void **</code>, that is also a valid type which points to an object of type <code>void *</code>.</p>\n\n<p>Some compilers such as GCC implement an extension where <code>void</code> has a size of 1 , so <code>sizeof(void) == 1</code> and pointer arithmetic on a <code>void *</code> functions in a similar manner to arithmetic on a <code>char *</code>.  This however goes against the standard.</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 4, "last_activity_date": 1553113076, "creation_date": 1553113076, "answer_id": 55269509, "question_id": 55268495, "link": "https://stackoverflow.com/questions/55268495/in-c-is-void-a-type/55269509#55269509", "title": "in C: Is void* a type?", "body": "<p><code>void *</code> is indeed a type.  So is <code>void</code>.  </p>\n\n<p><code>void</code> is an <em>incomplete</em> type that cannot be completed - it represents an empty set of values.  Because it is an incomplete type, it may not be the operand of the <code>sizeof</code> operator.  Therefore, <code>void</code> (logically) has no size, and you cannot create an object of <code>void</code> type.</p>\n\n<p><code>void *</code> is a pointer type, and as such it is a complete type.  It acts as a \"generic\" pointer type, and can be converted to other pointer types without a cast.  You cannot dereference a <code>void *</code>, since the result would have type <code>void</code>, and you cannot have an object of type <code>void</code> - you must first convert it to a pointer to a complete type.  </p>\n\n<p><code>void *</code> has the same size and representation as a <code>char *</code>.  </p>\n"}], "owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55269509, "answer_count": 2, "score": 0, "last_activity_date": 1553113076, "creation_date": 1553108991, "last_edit_date": 1553111154, "question_id": 55268495, "link": "https://stackoverflow.com/questions/55268495/in-c-is-void-a-type", "title": "in C: Is void* a type?", "body": "<p>In some discussions it's claimed that void* is \"pointer to void object\" but in C standard 6.5.3.4, point 2 it is written:\n\"The sizeof operator yields the size (in bytes)....The size is determined from the type of the operand.\"\nSo it is stated that function sizeof() receives a type as arguments.</p>\n\n<p>So the compiler considers void* a type? or the use of * it's only for semantical interpretation? </p>\n"}, {"tags": ["c", "file-io", "word-count"], "comments": [{"owner": {"reputation": 8720, "user_id": 3846213, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/5PGh1.jpg?s=128&g=1", "display_name": "Eli Korvigo", "link": "https://stackoverflow.com/users/3846213/eli-korvigo"}, "edited": false, "score": 2, "creation_date": 1553109510, "post_id": 55268479, "comment_id": 97268300, "body": "What platform are you running this on? If you are on Windows, lines will end with <code>\\r\\n</code>"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 3, "creation_date": 1553109537, "post_id": 55268479, "comment_id": 97268315, "body": "or even better <code>isspace(c)</code>"}, {"owner": {"reputation": 45, "user_id": 8702228, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155692104898774/picture?type=large", "display_name": "Dev Dog", "link": "https://stackoverflow.com/users/8702228/dev-dog"}, "edited": false, "score": 1, "creation_date": 1553111517, "post_id": 55268479, "comment_id": 97269268, "body": "Yeah, it was the Windows \\r\\n that was giving me trouble. I&#39;m running the program on a vagrant Ubuntu virtual machine but the text files are saved on the host machine, so I think there were still \\r attached. Thanks for the help everyone  EDIT: isspace() also caught the \\r as well, should&#39;ve just gone with that initially"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1553116441, "post_id": 55268479, "comment_id": 97271710, "body": "Note that a file may contain non-printable characters for which isspace() is false. Also, how about punctuation marks that are surrounded by spaces? Are they considered to be words?"}, {"owner": {"reputation": 45, "user_id": 8702228, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155692104898774/picture?type=large", "display_name": "Dev Dog", "link": "https://stackoverflow.com/users/8702228/dev-dog"}, "edited": false, "score": 0, "creation_date": 1553118498, "post_id": 55268479, "comment_id": 97272562, "body": "That&#39;s a good point FredK, I did think about that once I resolved the initial issue and have since added additional conditions to ignore punctuation marks and numeric characters when determining whether to increment the word count, also accounting for hyphenated words and the like"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 11234238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbc2cf511cb54d0ec9bf5e495214a64a?s=128&d=identicon&r=PG&f=1", "display_name": "th3hunter", "link": "https://stackoverflow.com/users/11234238/th3hunter"}, "is_accepted": false, "score": 1, "last_activity_date": 1553122976, "creation_date": 1553122976, "answer_id": 55271396, "question_id": 55268479, "link": "https://stackoverflow.com/questions/55268479/simple-word-count-in-c/55271396#55271396", "title": "Simple Word Count in C", "body": "<p>Tip : if you move text file from windows to Unix system machine you can always run dos2unix command on the files and you won't need to worry about checking newline format that windows system uses.</p>\n"}], "owner": {"reputation": 45, "user_id": 8702228, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155692104898774/picture?type=large", "display_name": "Dev Dog", "link": "https://stackoverflow.com/users/8702228/dev-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553122976, "creation_date": 1553108939, "last_edit_date": 1553109312, "question_id": 55268479, "link": "https://stackoverflow.com/questions/55268479/simple-word-count-in-c", "title": "Simple Word Count in C", "body": "<p>I'm creating a word count function in c as part of a larger text file processing program, but I'm encountering some discrepancy in results.</p>\n\n<p>Below is the relevant code snippet: </p>\n\n<pre><code>#define OUT 0\n#define IN  1\nunsigned countWords(char * filename) {\n\n    FILE * fp = fopen(filename, \"r\");\n    int state = OUT;\n    int wc = 0;\n    char c;\n\n    if(fp == NULL) {\n        perror(\"Could not open file\");\n    }\n    while((c = fgetc(fp)) != EOF) {\n            printf(\"c: %c &amp; wc: %d\\n\", c, wc);\n        if(c == ' ' || c == '\\n' || c == '\\t') {\n            state = OUT;\n        }\n        else if (state == OUT) {\n            state = IN;\n            ++wc;\n        }\n    }\n    fclose(fp);\n    return wc;\n}\n</code></pre>\n\n<p>I'm testing this function with two short .txt files:</p>\n\n<pre>\nword word word  word\nword\n</pre>\n\n<p>and..</p>\n\n<pre>\nword word word\nword \n\n\n\n</pre>\n\n<p>Note that in the second .txt, the last word is followed by 3 newline characters.</p>\n\n<p>When I run these .txts through, the first file is always counted correctly with a return of 5, but the second file seems to be reading the 3 newline characters at the end of the file and increases the count to 7. </p>\n\n<p>I'm sure I'm missing something obvious but I would appreciate any help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1553107879, "post_id": 55268146, "comment_id": 97267484, "body": "Please add some punctuation and capitalisation to your prose. (Downvote not by me though.)"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553108193, "post_id": 55268146, "comment_id": 97267620, "body": "I don&#39;t know anything about beagleboards, but how is your code supposed to get out of the while(1) loop? What line is your seg fault on?"}, {"owner": {"reputation": 21, "user_id": 11232938, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rn0A5lnLs2o/AAAAAAAAAAI/AAAAAAAAAII/MMtuDG5yl7U/photo.jpg?sz=128", "display_name": "J.J Morel", "link": "https://stackoverflow.com/users/11232938/j-j-morel"}, "edited": false, "score": 0, "creation_date": 1553108450, "post_id": 55268146, "comment_id": 97267744, "body": "i just ctrl c to end the program as this was mainly a test to see if i could get it to write to the address as i intend to. it was just meant to blink the led and the second it runs it gives me the fault."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553108567, "post_id": 55268146, "comment_id": 97267801, "body": "I don&#39;t see anything wrong with the code presented .. you sure the <code>struct</code> and memory addresses are defined correctly?"}, {"owner": {"reputation": 21, "user_id": 11232938, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rn0A5lnLs2o/AAAAAAAAAAI/AAAAAAAAAII/MMtuDG5yl7U/photo.jpg?sz=128", "display_name": "J.J Morel", "link": "https://stackoverflow.com/users/11232938/j-j-morel"}, "edited": false, "score": 2, "creation_date": 1553108889, "post_id": 55268146, "comment_id": 97267952, "body": "i followed the addresses and according offset provided by the processors(AM335x 1GHz ARM&#174; Cortex-A8) reference manual will triple check if made a mistake in the addresses."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1553109130, "post_id": 55268146, "comment_id": 97268086, "body": "Are you running it in a process that has appropriate permissions?"}, {"owner": {"reputation": 21, "user_id": 11232938, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rn0A5lnLs2o/AAAAAAAAAAI/AAAAAAAAAII/MMtuDG5yl7U/photo.jpg?sz=128", "display_name": "J.J Morel", "link": "https://stackoverflow.com/users/11232938/j-j-morel"}, "edited": false, "score": 0, "creation_date": 1553109501, "post_id": 55268146, "comment_id": 97268293, "body": "this a new BBB out of box with pre-installed linux. i&#39;ve been doing my programs in root and haven&#39;t messed with the permission. since root has the highest permissions..? i know it comes with a driver that can control the port but for my project i need to go higher level and work with the actual addresses."}], "answers": [{"tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": false, "score": 0, "last_activity_date": 1553122202, "creation_date": 1553122202, "answer_id": 55271284, "question_id": 55268146, "link": "https://stackoverflow.com/questions/55268146/getting-segmentation-fault-on-a-beaglebone-black/55271284#55271284", "title": "getting segmentation fault on a beaglebone black", "body": "<p>The addresses that you have assigned appear to be physical or bus addresses; your program will run with virtual or program addresses.   The kernel on your machine constructs translation pages so your program can keep a normalized view of memory addresses which the kernel can assign dynamically.</p>\n\n<p>You need to map (using mmap()) the device space of the registers into your program, and assign your structure to point to them.</p>\n\n<p>You should end up with code that looks something like:</p>\n\n<pre><code>GPIO_TypeDef  *g0, *g1, ... ;\n...\ng0 = mmap(0, sizeof *g0,..., fd, 0);\n...\ng0-&gt;DataOut = 3;\n...\n</code></pre>\n\n<p>ps: stylistically, prepending _TypeDef defeats the purpose of the typedef mechanism, which is to make meaningful names and self documenting programs.   The idio(ma)?tic use of _t is only a bit better because it doesn\u2019t waste so many keystrokes.   Remember that some programmers are visually impaired, and have to listen to an assistive device say \u201cunderscore uppercase T y p e uppercase D e f\u201d each time they encounter that!</p>\n"}], "owner": {"reputation": 21, "user_id": 11232938, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rn0A5lnLs2o/AAAAAAAAAAI/AAAAAAAAAII/MMtuDG5yl7U/photo.jpg?sz=128", "display_name": "J.J Morel", "link": "https://stackoverflow.com/users/11232938/j-j-morel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1595362582, "creation_date": 1553107748, "last_edit_date": 1553107927, "question_id": 55268146, "link": "https://stackoverflow.com/questions/55268146/getting-segmentation-fault-on-a-beaglebone-black", "title": "getting segmentation fault on a beaglebone black", "body": "<p>im new to the beaglebone and linux so for a project im having to control the user led on the BBB by using the addresses as well as have a function for future use by ensuring all the gpio port are able to be set thru this. but when i run it to just turn on and off the user leds i get a segmentation fault and i don't know why or what i need to do to fix this. what do i need to include or is what i'm doing just a no go and if so what should i do?</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct {\n    volatile uint32_t REVISION;         //Address offset: 0x00\n    volatile uint32_t rangeA[3];        //Address offset: 0x04-0x0C\n    volatile uint32_t SYSCONFIG;        //Address offset: 0x10\n    volatile uint32_t rangeB[3];        //Address offset: 0x14-0x1C\n    volatile uint32_t EOI;              //Address offset: 0x20\n    volatile uint32_t IRQSTATUS_RAW_0;  //Address offset: 0x24\n    volatile uint32_t IRQSTATUS_RAW_1;  //Address offset: 0x28\n    volatile uint32_t IRQSTATUS_0;      //Address offset: 0x2C\n    volatile uint32_t IRQSTATUS_1;      //Address offset: 0x30\n    volatile uint32_t IRQSTATUS_SET_0;  //Address offset: 0x34\n    volatile uint32_t IRQSTATUS_SET_1;  //Address offset: 0x38\n    volatile uint32_t IRQSTATUS_CLR_0;  //Address offset: 0x3C\n    volatile uint32_t IRQSTATUS_CLR_1;  //Address offset: 0x40\n    volatile uint32_t IRQWAKEN_0 ;      //Address offset: 0x44\n    volatile uint32_t IRQWAKEN_1;       //Address offset: 0x48\n    volatile uint32_t rangeC[26];       //Address offset: 0x4C-0x110\n    volatile uint32_t SYSSTATUS;        //Address offset: 0x114\n    volatile uint32_t rangeD[6];        //Address offset: 0x118-0x12C\n    volatile uint32_t CTRL;             //Address offset: 0x130\n    volatile uint32_t OE;               //Address offset: 0x134\n    volatile uint32_t DATAIN;           //Address offset: 0x138\n    volatile uint32_t DATAOUT;          //Address offset: 0x13C\n    volatile uint32_t LEVELDETECT0;     //Address offset: 0x140\n    volatile uint32_t LEVELDETECT1;     //Address offset: 0x144\n    volatile uint32_t RISINGDETEDT;     //Address offset: 0x148\n    volatile uint32_t FALLINGDETECT;    //Address offset: 0x14C\n    volatile uint32_t DEBOUNCENABLE;    //Address offset: 0x150\n    volatile uint32_t DEBOUNCINGTIME;   //Address offset: 0x154\n    volatile uint32_t rangeE[14];       //Address offset: 0x158-0x18C\n    volatile uint32_t CLEARDATAOUT;     //Address offset: 0x190\n    volatile uint32_t SETDATAOUT;       //Address offset: 0x194\n} GPIO_TypeDef;\n\n#define GPIO0 ((GPIO_TypeDef *) 0x44E07000)\n#define GPIO1 ((GPIO_TypeDef *) 0x4804C000)\n#define GPIO2 ((GPIO_TypeDef *) 0x481AC000)\n#define GPIO3 ((GPIO_TypeDef *) 0x481AE000)\n\nint main()      //testing if this would work\n{\n    GPIO1-&gt;OE &amp;= ~(1UL&lt;&lt;21);       // set  bits to output eneble\n    while(1)\n    {\n        GPIO1-&gt;DATAOUT |= 1UL&lt;&lt;21;\n        int delay = 0;\n        while(delay &lt; 15000)    // just really quick crappy delay\n            delay++;\n        GPIO1-&gt;DATAOUT &amp;= ~(1UL&lt;&lt;21);\n        printf(\"Blink!!\\n\");    //test to see if it works\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553104938, "post_id": 55267387, "comment_id": 97266008, "body": "where does the <code>P</code> come from?! What&#39;s the logic?"}, {"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553105497, "post_id": 55267387, "comment_id": 97266289, "body": "@AnttiHaapala it&#39;s probably a typo (input should be <code>...DE PQ...</code> not <code>...DEP Q...</code>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553106134, "post_id": 55267387, "comment_id": 97266573, "body": "I would take a look at this question, and see if using the <code>getline</code> function would help: <a href=\"https://stackoverflow.com/q/3501338/1212725\">stackoverflow.com/q/3501338/1212725</a>"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553109700, "post_id": 55267387, "comment_id": 97268387, "body": "I don&#39;t think the problem is unclear, as already said there is just a typo in the result for ABCDEP and QRSTFG producing AQBRCSDTEFPG rather than APBQCRDSETFG. It would have been better if the PO had given a (beginning of) proposal, however I put a proposal in my answer."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553115127, "post_id": 55267387, "comment_id": 97271094, "body": "@bruno: The problem seems to be clear.. but the question is kind of &quot;give me tech codes&quot;: there are at least two separate subtasks - reading the file by 2 lines and &quot;merging&quot; these lines - but the asker didn&#39;t show any code which demonstrates his level of C knowledge."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553125254, "post_id": 55267932, "comment_id": 97274638, "body": "Any particular reason for <code>if (lineptr != NULL)       free(lineptr);</code> versus simply <code>free(lineptr);</code>?  Style?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553125390, "post_id": 55267932, "comment_id": 97274674, "body": "@chux because I don&#39;t like to do <code>free(NULL);</code> even I know <i>free</i> manages that case (just a personal taste)"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1553109294, "last_edit_date": 1553109294, "creation_date": 1553106906, "answer_id": 55267932, "question_id": 55267387, "link": "https://stackoverflow.com/questions/55267387/read-2-lines-from-a-file-at-a-time-then-alternately-merge-two-line-into-one-in/55267932#55267932", "title": "Read 2 lines from a file at a time, then alternately merge two line into one in C", "body": "<p>A proposal :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar * readLine(ssize_t * ln)\n{\n  char * lineptr = NULL;\n  size_t n = 0;\n\n  *ln = getline(&amp;lineptr, &amp;n, stdin);\n\n  if (*ln &lt;= 0) {\n    if (lineptr != NULL)\n      free(lineptr);\n    return NULL;\n  }\n\n  if (lineptr[*ln - 1] == '\\n')\n    lineptr[--*ln] = 0;\n\n  return lineptr;\n}\n\nint main()\n{\n  size_t sz = 0;\n  char ** lines = NULL;\n\n  for (;;) {\n    ssize_t n1;\n    char * l1 = readLine(&amp;n1);\n\n    if (l1 == NULL)\n      break;\n\n    ssize_t n2;\n    char * l2 = readLine(&amp;n2);\n    char * l;\n\n    if (l2 == NULL) {\n      /* consider the second line is empty if missing */\n      l = l1;\n    }\n    else {\n      l = malloc(n1 + n2 + 1);\n\n      if (l == NULL) {\n        fprintf(stderr, \"not enough memory\\n\");\n        return -1;\n      }\n\n      char * p1 = l1;\n      char * p2 = l2;\n      char * p = l;\n\n      for (;;) {\n        if (! *p1) {\n          strcpy(p, p2);\n          break;\n        }\n        *p++ = *p1++;\n        if (! *p2) {\n          strcpy(p, p1);\n          break;\n        }\n        *p++ = *p2++;\n      }\n      free(l1);\n      free(l2);\n    }\n\n    /* realloc for more than just 1 additional entry if lot of lines to manage */\n    lines = realloc(lines, ++sz * sizeof(char *));\n    if (lines == NULL) {\n      fprintf(stderr, \"not enough memory\\n\");\n      return -1;\n    }\n    lines[sz - 1] = l;\n  }\n\n  /* debug and free */\n  for (size_t i = 0; i != sz; ++i) {\n    puts(lines[i]);\n    free(lines[i]);\n  }\n\n  free(lines);\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra l.c\npi@raspberrypi:/tmp $ cat f\nABCDEP\nQRSTFG\nacegikmoqsuwyz\nbdfhjlnprtvx\npi@raspberrypi:/tmp $ ./a.out &lt; f\nAQBRCSDTEFPG\nabcdefghijklmnopqrstuvwxyz\n</code></pre>\n\n<p>Execution under <em>valgrind</em> :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out &lt; f\n==14583== Memcheck, a memory error detector\n==14583== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==14583== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==14583== Command: ./a.out\n==14583== \nAQBRCSDTEFPG\nabcdefghijklmnopqrstuvwxyz\n==14583== \n==14583== HEAP SUMMARY:\n==14583==     in use at exit: 0 bytes in 0 blocks\n==14583==   total heap usage: 11 allocs, 11 frees, 5,772 bytes allocated\n==14583== \n==14583== All heap blocks were freed -- no leaks are possible\n==14583== \n==14583== For counts of detected and suppressed errors, rerun with: -v\n==14583== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11233612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1185505564941657/picture?type=large", "display_name": "Thien Tao", "link": "https://stackoverflow.com/users/11233612/thien-tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1553106916, "answer_count": 1, "score": -4, "last_activity_date": 1553111180, "creation_date": 1553104809, "last_edit_date": 1553111180, "question_id": 55267387, "link": "https://stackoverflow.com/questions/55267387/read-2-lines-from-a-file-at-a-time-then-alternately-merge-two-line-into-one-in", "closed_reason": "Needs details or clarity", "title": "Read 2 lines from a file at a time, then alternately merge two line into one in C", "body": "<p>How to read 2 lines from a file at a time, then use pointers to alternately merge two line into one in C.</p>\n\n<p>Sample input: </p>\n\n<pre><code>ABCDE\nPQRSTFG\nacegikmoqsuwyz\nbdfhjlnprtvx\n</code></pre>\n\n<p>Ouput:</p>\n\n<pre><code>APBQCRDSETFG\nabcdefghijklmnopqrstuvwxyz\n</code></pre>\n"}, {"tags": ["c", "erlang", "interop", "distributed-system", "erlang-shell"], "comments": [{"owner": {"reputation": 36762, "user_id": 113848, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e3d4212415bc280a21ad85d8022791fe?s=128&d=identicon&r=PG", "display_name": "legoscia", "link": "https://stackoverflow.com/users/113848/legoscia"}, "edited": false, "score": 0, "creation_date": 1553161490, "post_id": 55267269, "comment_id": 97285077, "body": "In Erlang node names, a &quot;long name&quot; is a hostname that contains at least one dot, so that&#39;s why it rejects <code>stockholm</code>. You&#39;re getting further with anything that contains a dot, so I&#39;d start looking for the problem at that point."}], "owner": {"reputation": 31, "user_id": 11233427, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-s0lzCID5Lf8/AAAAAAAAAAI/AAAAAAAADBQ/w4PbgPjTPK0/photo.jpg?sz=128", "display_name": "Gavriel Loria", "link": "https://stackoverflow.com/users/11233427/gavriel-loria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1553130143, "creation_date": 1553104421, "last_edit_date": 1553130143, "question_id": 55267269, "link": "https://stackoverflow.com/questions/55267269/erlang-hostname-illegal-when-building-long-name-c-node", "title": "Erlang hostname illegal when building long name C Node", "body": "<p>I'm trying to follow the official Erlang C Node tutorial (<a href=\"http://erlang.org/doc/tutorial/cnode.html\" rel=\"nofollow noreferrer\">http://erlang.org/doc/tutorial/cnode.html</a>). I've gotten the short name server and client working, but not the long name server. On the one hand, if I use my computer's host (\"stockholm\") in <code>complex4:call_cnode()/1</code> in <code>complex4.erl</code> I get the following error when I call <code>complex4:foo(3).</code> in the <code>erl</code> CLI:</p>\n\n<pre><code>=ERROR REPORT==== 20-Mar-2019::12:15:21.400091 ===\n** System running to use fully qualified hostnames **\n** Hostname stockholm is illegal **\n</code></pre>\n\n<p>On the other hand, if I use any number of alternative hostnames in place of \"stockholm\" in <code>complex4.erl</code>, such as my public IP, my private IP, and a free subdomain I claimed online that maps to my public IP, when I call <code>complex4:foo(3).</code> in the CLI the CLI freezes, and the <code>cserver2</code> running in the background does not know that anything happened, or throws an <code>erl_accept</code> error.</p>\n\n<p>I've tried a number of hacks, including trying to write a custom <code>.hosts.erlang</code> containing my subdomain, and using the <code>-inetrc</code> flag to add an association between my public IP and my subdomain. I'm using the same cookie everywhere.</p>\n\n<p>Has anyone successfully run the long name server in this tutorial, and, if so, how did you set up your environment to avoid these problems?</p>\n"}, {"tags": ["c", "exit"], "answers": [{"tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": true, "score": 1, "last_activity_date": 1553101891, "last_edit_date": 1553101891, "creation_date": 1553101788, "answer_id": 55266525, "question_id": 55266508, "link": "https://stackoverflow.com/questions/55266508/exit-will-it-cause-parent-process-to-terminate/55266525#55266525", "title": "exit(...): Will it cause parent process to terminate?", "body": "<p><code>exit</code> does not cause the parent to also exit. It causes normal process termination for the current process.</p>\n"}, {"tags": [], "owner": {"reputation": 160, "user_id": 6529424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AehrV.png?s=128&g=1", "display_name": "eagle33322", "link": "https://stackoverflow.com/users/6529424/eagle33322"}, "is_accepted": false, "score": 3, "last_activity_date": 1553102308, "last_edit_date": 1553102308, "creation_date": 1553102050, "answer_id": 55266609, "question_id": 55266508, "link": "https://stackoverflow.com/questions/55266508/exit-will-it-cause-parent-process-to-terminate/55266609#55266609", "title": "exit(...): Will it cause parent process to terminate?", "body": "<pre><code>man exit\n</code></pre>\n\n<p>This shows</p>\n\n<blockquote>\n  <p>The exit() function causes normal [current/child] process termination and <strong><em>the value of [the exit] status is returned to the parent [process]</em></strong> (see wait(2)).\n  ...</p>\n  \n  <p>After  exit(),  the exit status must be transmitted to the parent process.  There are three cases.  If the parent has set SA_NOCLDWAIT, or has set the SIGCHLD handler to SIG_IGN, the status is discarded.  If the parent was waiting on the child, it is notified of the exit status.\n             In both cases the exiting process dies immediately.  If the parent has not indicated that it is not interested in the exit status, but is not waiting, the exiting process turns into a \"zombie\" process (which is nothing but a container for the single byte  representing  the  exit\n             status) so that the parent can learn the exit status when it later calls one of the wait(2) functions.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 9012940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e0998afe87b1dc81913bb73022d549?s=128&d=identicon&r=PG&f=1", "display_name": "YeonwooSung", "link": "https://stackoverflow.com/users/9012940/yeonwoosung"}, "is_accepted": false, "score": 1, "last_activity_date": 1553102934, "creation_date": 1553102934, "answer_id": 55266873, "question_id": 55266508, "link": "https://stackoverflow.com/questions/55266508/exit-will-it-cause-parent-process-to-terminate/55266873#55266873", "title": "exit(...): Will it cause parent process to terminate?", "body": "<p>No, the exit() does not terminate the parent process. The exit() function will terminate the current process, and return the exit code to the parent process. So, if you use exit(1), then the exit code 1 will be returned to the parent process.</p>\n"}], "owner": {"reputation": 129, "user_id": 10993171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a852550457e6d60b6b54751c3a1e3752?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSoul", "link": "https://stackoverflow.com/users/10993171/digitalsoul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 55266525, "answer_count": 3, "score": -2, "last_activity_date": 1553102934, "creation_date": 1553101753, "last_edit_date": 1553102266, "question_id": 55266508, "link": "https://stackoverflow.com/questions/55266508/exit-will-it-cause-parent-process-to-terminate", "title": "exit(...): Will it cause parent process to terminate?", "body": "<p>If I call exit(1) in the child process, will this action cause parent process to terminate as well? Or simply only child process is terminated by exit(1)?</p>\n"}, {"tags": ["c", "constants"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1553101447, "post_id": 55266341, "comment_id": 97264091, "body": "You can&#39;t be using exactly that code (or can never expect the code shown to work) \u2014 it won&#39;t compile, but the <code>double fp = derive(f, K);</code> line would give the error you claim.  And the <code>printf()</code> must be called within a function.  Within a function, the definition of <code>fp</code> would be fine, as would the call to <code>printf()</code>.  So, either your code fragment is incomplete or you&#39;re misunderstanding how a program works and you need to provide a <code>main()</code> function \u2014 or some other function \u2014 which defines <code>K</code>  and contains the last two lines of your fragment."}, {"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 1, "creation_date": 1553101486, "post_id": 55266341, "comment_id": 97264116, "body": "Where do f and K values come from ?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 0, "creation_date": 1553101637, "post_id": 55266341, "comment_id": 97264200, "body": "@MartinVerjans: <code>f</code> is the function defined starting in the third line of code.  <code>K</code> is undefined."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 0, "creation_date": 1553101651, "post_id": 55266341, "comment_id": 97264210, "body": "Your K is not constant, where is it defined ?"}, {"owner": {"reputation": 2583, "user_id": 3202696, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/QmN8u.png?s=128&g=1", "display_name": "TobiSH", "link": "https://stackoverflow.com/users/3202696/tobish"}, "reply_to_user": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "edited": false, "score": 0, "creation_date": 1553101663, "post_id": 55266341, "comment_id": 97264213, "body": "@MartinVerjans f is defined (the first function) but no clue about K"}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "edited": false, "score": 0, "creation_date": 1553101685, "post_id": 55266341, "comment_id": 97264225, "body": "f is the function as defined and sorry about K it is defined as #define K 10.0 in the beginning of the code"}, {"owner": {"reputation": 4268, "user_id": 5897829, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2c7105808cb099e98f04fe464af68c6?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Verjans", "link": "https://stackoverflow.com/users/5897829/martin-verjans"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553101758, "post_id": 55266341, "comment_id": 97264266, "body": "@JonathanLeffler thx yes I figured it for f 5 seconds before your answer. Didn&#39;t even notice the printf and fp declaration weren&#39;t in a function..."}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553102264, "post_id": 55266341, "comment_id": 97264599, "body": "@JonathanLeffler : Yes I rectified the mistakes : Put the last two lines inside a main function and I&#39;m getting this error still : In function <code>main&#39;: grds.c:(.text+0xc9): undefined reference to </code>grprintf&#39;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553102355, "post_id": 55266341, "comment_id": 97264656, "body": "Where do you think the <code>grprintf()</code> function is defined?  It&#39;s a different error from what you were getting previously, though.  The previous ones were from the compilation phase; the current one is from the linking phase (traditionally performed by the <code>ld</code> program invoked by the C compiler on your behalf).  Either you forgot to link the file containing <code>grprintf()</code> or you accidentally added <code>gr</code> in front of <code>printf()</code> and need to remove those two letters."}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553102725, "post_id": 55266341, "comment_id": 97264847, "body": "@JonathanLeffler : I hadn&#39;t defined any, I just deleted a few redundant header files and it compiles nicely now! Thanks a tonne guys! :D"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1553101841, "post_id": 55266487, "comment_id": 97264320, "body": "The line <code>double alpha,x;</code> should probably be removed alltogether. It&#39;s not needed at all"}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "edited": false, "score": 0, "creation_date": 1553102117, "post_id": 55266487, "comment_id": 97264500, "body": "@VietHTran : Thanks for the suggestions, such silly mistakes I did! I tried compiling your code and I&#39;m getting this error :  In function <code>main&#39;: grds.c:(.text+0xc9): undefined reference to </code>grprintf&#39;"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1553102214, "post_id": 55266487, "comment_id": 97264573, "body": "What is <code>grprintf</code>? This is not a standard function."}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1553102510, "post_id": 55266487, "comment_id": 97264724, "body": "@Jabberwocky : Ya I know, weird. This is the exact error I&#39;m getting :- /tmp/cc7Jj1Np.o: In function <code>main&#39;: grds.c:(.text+0xd3): undefined reference to </code>grprintf&#39; collect2: error: ld returned 1 exit status"}, {"owner": {"reputation": 2137, "user_id": 11076781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AEbp_l4M20o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNq9wzZW_MtnAU7_RDtc7xasFybGA/mo/photo.jpg?sz=128", "display_name": "VietHTran", "link": "https://stackoverflow.com/users/11076781/viethtran"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1553102515, "post_id": 55266487, "comment_id": 97264728, "body": "@Jabberwocky I think OP is working on the code at the moment. He will probably use it later on so I decided to keep it there."}, {"owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1553102643, "post_id": 55266487, "comment_id": 97264803, "body": "@Jabberwocky@VietHTran : Thanks guys it&#39;s working now! I just deleted a few header files and it works like a charm!"}, {"owner": {"reputation": 2137, "user_id": 11076781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AEbp_l4M20o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNq9wzZW_MtnAU7_RDtc7xasFybGA/mo/photo.jpg?sz=128", "display_name": "VietHTran", "link": "https://stackoverflow.com/users/11076781/viethtran"}, "edited": false, "score": 0, "creation_date": 1553102693, "post_id": 55266487, "comment_id": 97264829, "body": "No problem! Glad I can help :)"}], "tags": [], "owner": {"reputation": 2137, "user_id": 11076781, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AEbp_l4M20o/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNq9wzZW_MtnAU7_RDtc7xasFybGA/mo/photo.jpg?sz=128", "display_name": "VietHTran", "link": "https://stackoverflow.com/users/11076781/viethtran"}, "is_accepted": true, "score": 3, "last_activity_date": 1553101674, "creation_date": 1553101674, "answer_id": 55266487, "question_id": 55266341, "link": "https://stackoverflow.com/questions/55266341/initializer-element-is-not-constant-c/55266487#55266487", "title": "Initializer element is not constant - C", "body": "<p>You should add any block of code you want to run first during the execution in to a <code>main</code> function. In your case, you should put the code:</p>\n\n<pre><code>double fp = derive(f, K);\nprintf(\"%lf\\n\",fp);\n</code></pre>\n\n<p>into a <code>main</code> function</p>\n\n<pre><code>int main() {\n  double fp = derive(f, K);\n  printf(\"%lf\\n\",fp);\n}\n</code></pre>\n\n<p>Make sure you include the <code>stdio.h</code> library at the beginning of file since you are using <code>printf</code> function. Also, make sure you define constant <code>K</code> somewhere. I updated your code according to my suggestion above and it compiled without errors or warnings:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef double (*TFunc)(double);\ndouble alpha,x;\ndouble f(double x)\n{\n  return x*x;\n}\ndouble derive(TFunc f, const double x0)\n{\n  const double dx = 1.0e-6; // or similar\n  double dy = f(x0+dx)-f(x0-dx);\n  return dy/(2.*dx);   \n}\n\nint main() {\n  const double K = 1.0;\n  double fp = derive(f, K);\n  printf(\"%lf\\n\",fp);\n}\n\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8049168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pNBvrNWBYLM/AAAAAAAAAAI/AAAAAAAAAYQ/PkQQsjQJ-ug/photo.jpg?sz=128", "display_name": "Crossfit_Jesus", "link": "https://stackoverflow.com/users/8049168/crossfit-jesus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 55266487, "answer_count": 1, "score": -1, "last_activity_date": 1553101841, "creation_date": 1553101210, "last_edit_date": 1553101841, "question_id": 55266341, "link": "https://stackoverflow.com/questions/55266341/initializer-element-is-not-constant-c", "title": "Initializer element is not constant - C", "body": "<p>I'm getting two errors :<br>\nInitializer element is not constant in the  2nd last line below in the code<br>\nExpected declaration specifiers '...' before string constant    in the last line    </p>\n\n<pre><code>#define K 10.0\ntypedef double (*TFunc)(double);\ndouble alpha,x;\n\ndouble f(double x)\n{\n   return x*x;\n}\n\ndouble derive(TFunc f, const double x0)\n{\n    const double dx = 1.0e-6; // or similar\n    double dy = f(x0+dx)-f(x0-dx);\n    return dy/(2.*dx);   \n}\ndouble fp = derive(f, K);\nprintf(\"%lf\\n\",fp);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 1, "creation_date": 1553101221, "post_id": 55266263, "comment_id": 97263953, "body": "Look up how to use header files. Define your functions with prototypes in the header files. Add &quot;include&quot; statements for the header files in the other files. This way the other files will &quot;know&quot; about the external references and you can access them."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553102945, "post_id": 55266263, "comment_id": 97264958, "body": "Just put the function definitions you want to use at the top of one.c, e.g. <code>uint8_t proto485OnlyWrite(uint8_t address, uint8_t command, uint8_t action, uint16_t value);</code>.  Then you compile and link all three files together, e.g. <code>gcc -o myExe one.c two.c three.c</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553103728, "post_id": 55266263, "comment_id": 97265378, "body": "And what&#39;s the problem? You properly use pointers to extract the value from one function into another and then into third. Ignoring that you posted ton of unrelated code to your program that could be safely removed, you then pass the values into another function. All looks fine."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553192310, "post_id": 55266263, "comment_id": 97303471, "body": "regarding: <code>return counter;  GPIO_SetValue( PMAP_GPIO_PORT_DIR_RS485, PMAP_GPIO_PIN_DIR_RS485);</code>   The call to <code>GPIO_SetValue()</code> will never be executed because the prior <code>return</code> statement has already exited the function }`"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1553192799, "post_id": 55266263, "comment_id": 97303689, "body": "@bruceg,  Your saying to make each of the (variables of interest -VOI-) have &#39;file scope&#39;  That will not work.  Much better to have a header file that lists each of the -VOI- as &#39;extern&#39; in a header file and <code>#include</code> that header file in any .c file that wants to access those -VOI-   However, then other files can also modify those -VOI-  So best is to write &#39;accessor&#39; functions for those -VOI- and place the prototypes for those &#39;accessor&#39; functions in the header file that anyone that wants to use those -VOI- includes in their file (cont)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553192930, "post_id": 55266263, "comment_id": 97303762, "body": "(cont)  the last idea expressed (&#39;accessor&#39;&#39; functions ) incorporates the concept of <code>data hiding</code> and <code>limiting the scope of a variable</code>  Both are very important concepts to adhere to when programming"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553200369, "post_id": 55266263, "comment_id": 97306982, "body": "@user3629249 I was just suggesting what I thought might be the easiest thing for the OP to do in order to get his code to compile. You are of course 100% correct."}], "owner": {"reputation": 41, "user_id": 11233325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec75fc7a690aebf8a9dca8dec6853e3?s=128&d=identicon&r=PG&f=1", "display_name": "shruti", "link": "https://stackoverflow.com/users/11233325/shruti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553101009, "creation_date": 1553101009, "question_id": 55266263, "link": "https://stackoverflow.com/questions/55266263/pass-multiple-values-from-a-function-defined-in-one-file-to-another-file-using-c", "title": "pass multiple values from a function defined in one file to another file using c", "body": "<p>I have a task get multiple values from one function defined in one.c file to other function defined in two.c file.</p>\n\n<p>Please find below code snippet from both the files and kindly help to access the values from one.c file into two.c file.</p>\n\n<p>file one.c:</p>\n\n<pre><code>void GetABFWversion(uint8_t* fwcommand, uint8_t* fwaction, uint16_t* fwvalue)             \n{\n    uint16_t FW_slot=SdusAutoDetectSlotForNewFirmware();\n\n    char MyCopy[10];  \n    strcpy (MyCopy, BrakeBoardInfo.firmwareVersion);\n    char MyCopy1[10];\n    for (int k=0; k&lt;9; k++)\n    {\n      int l=1;\n      MyCopy1[k] = MyCopy[k+l]; \n    }\n\n    char FWversion_AB[10] = {0};\n    int z = 0;\n    for(int x=6;x&lt;10;x++)\n    {\n      FWversion_AB[z] = MyCopy1[x];\n      z++;\n    }\n\n    char res=0;\n\n    uint16_t val = atoi(FWversion_AB);\n    //res = proto485OnlyWrite(0x09,0x02,0x00,val);\n    printf(\"\\n\");\n    printf(\"FW version is sent to Arduino!!!   \");\n    RESULT = 1;\n    *fwcommand = 0x02;\n    *fwaction = 0x00;\n    *fwvalue = val;\n}\n</code></pre>\n\n<p>file two.c:</p>\n\n<pre><code>int16_t driver485Read (uint8_t *buffer, const uint16_t length)\n{\n  char head[20];  \n  const char *format=\"KL%02x:\";\n  int16_t wait_loop_cnt=0;\n  static uint32_t totalBytes = 0;\n  static uint32_t respNo = 0;\n\n  GPIO_ClearValue(PMAP_GPIO_PORT_DIR_RS485, PMAP_GPIO_PIN_DIR_RS485);             \n\n  UartRxFlush(UARW_UART_INDEX_RS485); /\n  respNo++;\n\n  int counter = 0; \n\n  do\n  {\n    OSTimeDly(2);\n\n    int8_t newBytesRcv = UartReceive(UARW_UART_INDEX_RS485,\n                                     (uint8_t*)&amp;(buffer[counter]), length-counter);\n    totalBytes += newBytesRcv;\n    counter = totalBytes;\n  }\n  while (/*wait_loop_cnt++&lt;= MAX_WAIT_LOOP &amp;&amp;*/ counter &lt; length);  \n  totalBytes = 0;\n\n  uint8_t i = 0;\n  format=\"OK%02x:\";\n\n  printf(\"Byte received........\");\n  int FWmsg[9] = {0x09,0x30,0x30,0x32,0x32,0x31,0x31,0x31,0x31};\n  int arduinodata[9] = {0x09,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30};  \n\n  for (i=0; i&lt;9;i++)\n  {\n  printf(\"%d  \",buffer[i]);\n  arduinodata[i] = buffer[i];\n  }\n\n  if(compareArray(FWmsg,arduinodata,7)==0)\n  {  \n    printf(\"Arrays have same elements.\\n\");\n    printArray(FWmsg,9);\n\n  char res = 0;\n\n  uint8_t fwc, fwa;\n  uint16_t fwv;\n\n  GetABFWversion(&amp;fwc, &amp;fwa, &amp;fwv); \n  res = proto485OnlyWrite(0x09,fwc,fwa,fwv);\n  printf(\"\\n\");\n  printf(\"FW version is sent to Arduino!!!   \");\n }\n else\n  {\n  printf(\"Arrays have different elements.\\n\");\n  }     \n\n  /* 1st byte is the slave address byte which value should be &gt;= RS485_ADDRESS_SLAVE_FIRST  &amp;&amp;\n  &lt;= RS485_ADDRESS_SLAVE_LAST and is already checked in dePadLeft() */\n  for(int i = 1; i &lt; length &amp;&amp; buffer[i] &gt;= RS485_PAYLOAD_VALID_MIN &amp;&amp; buffer[i] &lt;= RS485_PAYLOAD_VALID_MAX; i++);\n\n  counter = i; // to be OK, i = length = RS485_MSG_LENGTH if response (after eventual dePad..) is OK\n  printf(\"driver485Read %d\\n\",counter);\n\n\n#ifdef RS485_DEBUG  \n  static uint32_t i = 0;\n  i++;\n#endif\n\n  return counter;\n\n  GPIO_SetValue(PMAP_GPIO_PORT_DIR_RS485, PMAP_GPIO_PIN_DIR_RS485);  \n}\n</code></pre>\n\n<p>file three.c:</p>\n\n<pre><code>uint8_t proto485OnlyWrite(uint8_t address, uint8_t command, uint8_t action, uint16_t value)               \n{\n  uint8_t res=ERROR_FOUND;\n\n  OSSemPend(pbSemaphore, 0, &amp;res);\n  if (res == OS_ERR_NONE)\n  {\n    rs485_message_t rs485Msg;        \n    if (command ==CMD_POWER_PUMP_PB)\n    {\n      printf(\"CMD_POWER_PUMP_PB\");\n    }\n\n    proto485ComposeMsg(&amp;rs485Msg, address, command, action, value);\n\n    res = (RS485_MSG_LENGTH == driver485Write((uint8_t *)&amp;rs485Msg, sizeof(rs485Msg))) ? \n  NO_ERROR: \n    ERROR_FOUND;\n\n    OSSemPost(pbSemaphore);\n  }    \n  return res;\n}\n</code></pre>\n\n<p>I want to get the values of \"fwcommand\", \"fwaction\" and \"fwvalue\" defined in file one.c into file two.c at the place where I am passing the same to \"res = proto485OnlyWrite(0x09,fwc,fwa,fwv);\" in the place of \"fwc\", \"fwa\" and \"fwv\" respectively.</p>\n\n<p>Thank you....</p>\n"}, {"tags": ["c", "go", "types", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1553101901, "post_id": 55266246, "comment_id": 97264353, "body": "What is the intent of <code>unsafe.Pointer(uintptr(unsafe.Pointer(&amp;nums)))</code>? The extra <code>unintptr</code> and <code>unsafe.Pointer</code> shouldn&#39;t be doing anything."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10559464"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1553102277, "post_id": 55266246, "comment_id": 97264610, "body": "Thanks for pointing that out. It was probably just from a hasty copy paste. It could be removed."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10559464"}, "is_accepted": false, "score": 0, "last_activity_date": 1553101672, "creation_date": 1553101672, "answer_id": 55266486, "question_id": 55266246, "link": "https://stackoverflow.com/questions/55266246/golang-cgo-c-int-size-differences/55266486#55266486", "title": "Golang cgo *C.int size differences", "body": "<p>I figured it out. Silly mistake. I am incrementing by the size of the pointer - 64bit address - rather than the size of the int. Revised go file:</p>\n\n<pre><code>package main\n\n/*\nint addNums(int *nums);\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var nums [2]int32\n    fmt.Println(unsafe.Sizeof(nums))\n    numsPtr := (*C.int)(unsafe.Pointer(uintptr(unsafe.Pointer(&amp;nums))))\n    fmt.Println(numsPtr)\n    *numsPtr = 199\n    numsPtr = (*C.int)(unsafe.Pointer(uintptr(unsafe.Pointer(numsPtr)) + unsafe.Sizeof(*numsPtr)))\n    fmt.Println(numsPtr)\n    *numsPtr = 3\n    res, err := C.addNums((*C.int)(unsafe.Pointer(&amp;nums)))\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(res)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10559464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553102304, "creation_date": 1553100968, "last_edit_date": 1553102304, "question_id": 55266246, "link": "https://stackoverflow.com/questions/55266246/golang-cgo-c-int-size-differences", "title": "Golang cgo *C.int size differences", "body": "<p>I am exploring CGO and I have run into a quirk where the size of C.int in the go runtime is 8 bytes but the C int is 4 bytes. I understand that Go ints can be 64 bits or 32 bits depending on architecture, and that C ints are always 32 bits. Is \nthere a standard way for telling go to use 4 bytes for C.int types? I have not been able to find documentation that deals with this.</p>\n\n<p>Because of this the code does not function as anticipated. It basically adds the low side to the high side of the first int. It never references the second int passed.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Actual output:</p>\n\n<pre><code>0xc00001a0b0\n0xc00001a0b8\n0xc00001a0b0\n0xc00001a0b4\n199\n0\n199\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\n/*\nint addNums(int *nums);\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    var nums [2]C.int\n    numsPtr := (*C.int)(unsafe.Pointer(&amp;nums))\n    fmt.Println(numsPtr)\n    *numsPtr = 199\n    numsPtr = (*C.int)(unsafe.Pointer(uintptr(unsafe.Pointer(numsPtr)) + unsafe.Sizeof(numsPtr)))\n    fmt.Println(numsPtr)\n    *numsPtr = 3\n    res, err := C.addNums((*C.int)(unsafe.Pointer(&amp;nums[0])))\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(res)\n}\n</code></pre>\n\n<p>lib.c</p>\n\n<pre><code>long addNums(int *nums)\n{\n  printf(\"%p\\n\", &amp;nums[0]);\n  printf(\"%p\\n\", &amp;nums[1]);\n  printf(\"%d\\n\", nums[0]);\n  printf(\"%d\\n\", nums[1]);\n  return (nums[0] + nums[1]);\n}\n</code></pre>\n"}, {"tags": ["c", "cs50", "des", "crypt"], "comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 2, "creation_date": 1553099915, "post_id": 55265750, "comment_id": 97263182, "body": "Undefined reference errors are usually linker errors, not compiler errors. You may just need to tell the linker (e.g., with <code>-lcrypt</code>) that you want to link with the <code>crypt</code> library."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1553100197, "post_id": 55265750, "comment_id": 97263341, "body": "Why are you replicating the library declaration of <code>crypt</code>?  Delete that line.  The whole point of including a header file is that you pick up those declarations."}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1553100199, "post_id": 55265750, "comment_id": 97263343, "body": "I copied your code into a file named <code>testcrypt.c</code>, and it compiled just fine with <code>gcc -o testcrypt testcrypt.c -lcrypt</code>. And for future reference, when using function calls from installed libraries, you can usually figure out which library to link with by viewing the man page. In this case, <code>man 3 crypt</code> will show you the man page for the <code>crypt</code> function, and it states &quot;Link with -lcrypt&quot;."}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 1, "creation_date": 1553100416, "post_id": 55265750, "comment_id": 97263447, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\">What is an undefined reference/unresolved external symbol error and how do I fix it?</a>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553100420, "post_id": 55265750, "comment_id": 97263452, "body": "Please provide a <i>copy of the verbatim error code and the command you used to compile</i> in the question itself!"}, {"owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "edited": false, "score": 0, "creation_date": 1553100528, "post_id": 55265750, "comment_id": 97263521, "body": "Thanks, but how do I link? I&#39;m still getting errors when trying to run on repl.it, <a href=\"https://repl.it/@MichaelB4/FormalSteepExperiment\" rel=\"nofollow noreferrer\">repl.it/@MichaelB4/FormalSteepExperiment</a>. Errors are"}, {"owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "edited": false, "score": 0, "creation_date": 1553100534, "post_id": 55265750, "comment_id": 97263529, "body": "exit status 1 /tmp/main-7dd4df.o: In function <code>main&#39;: main.c:(.text+0x34): undefined reference to </code>crypt&#39; clang: error: linker command failed with exit code 1 (use -v to see invocation)"}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1553101546, "post_id": 55265750, "comment_id": 97264148, "body": "I took a look at repl.it, but I can&#39;t seem to find any discussion of how to link with external libraries. It&#39;s possible it just doesn&#39;t support that for the C language yet, or that if it is supported, it&#39;s an obscure, poorly documented, and/or hidden feature."}, {"owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "edited": false, "score": 0, "creation_date": 1553102476, "post_id": 55265750, "comment_id": 97264708, "body": "Thanks Mike Holt. I hadn&#39;t considered it could be an issue with Repl.it. It works fine with another compiler. Thanks for taking the time to solve my problem."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12052420, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCudMO9ezb9HigG8wdeA6TMkjO6DvKFTOWlMeREROQ=k-s128", "display_name": "Rai Sikandar Ali", "link": "https://stackoverflow.com/users/12052420/rai-sikandar-ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1594398537, "creation_date": 1594398537, "answer_id": 62838567, "question_id": 55265750, "link": "https://stackoverflow.com/questions/55265750/crypt-function-in-simple-c-program-not-working/62838567#62838567", "title": "Crypt function in simple C program not working", "body": "<p>when compiling use this: gcc yourfilename.c -lcrypt</p>\n"}], "owner": {"reputation": 201, "user_id": 8519006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11cb821618b0fb973e916ffdf2e0d023?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/8519006/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594398537, "creation_date": 1553099389, "last_edit_date": 1555567904, "question_id": 55265750, "link": "https://stackoverflow.com/questions/55265750/crypt-function-in-simple-c-program-not-working", "title": "Crypt function in simple C program not working", "body": "<p>I'm a NOOB, trying to figure out how to pass a word and a salt to the DES crypt function, and print out an encrypted (well, poorly encrypted) password. I have read the manual pages, and a few posts on here (regarding both cyppt and the crack problem set I'm working through), but am still unsure as to what my syntax needs to be per my code below, which has an 'undefined reference to crypt.' </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;crypt.h&gt;\n\n#define _XOPEN_SOURCE\n\nchar *crypt(const char *key, const char *salt);\n\nint main(void) {\n\n    char *password = \"lol\";\n\n    char *salt = \"50\";\n\n    char *encrypted = crypt(password, salt);\n\n    printf(\"%s\\n\", encrypted);\n    return 0;\n}\n\n// should print 50cI2vYkF0YU2 per CS50 crack exercise example.\n</code></pre>\n\n<p>I've consulted the following before asking this question, and still don't understand how to get my simple example working.\n<a href=\"http://pubs.opengroup.org/onlinepubs/009695299/functions/crypt.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/009695299/functions/crypt.html</a>\n<a href=\"https://www.quora.com/How-does-the-crypt-function-work-with-some-examples-of-crypt-function-in-C\" rel=\"nofollow noreferrer\">https://www.quora.com/How-does-the-crypt-function-work-with-some-examples-of-crypt-function-in-C</a>\n<a href=\"https://cs50.stackexchange.com/questions/23583/cs-des-based-crypt-function\">https://cs50.stackexchange.com/questions/23583/cs-des-based-crypt-function</a>\n<a href=\"https://stackoverflow.com/questions/21311397/crypt-function-in-c-not-working\">crypt() function in C not working</a></p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553098719, "post_id": 55265498, "comment_id": 97262422, "body": "Look for <code>vfprintf</code> instead."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553098754, "post_id": 55265498, "comment_id": 97262450, "body": "What is the corresponding int to string with <code>vfprintf</code> then."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553098867, "post_id": 55265498, "comment_id": 97262529, "body": "<code>vfprintf</code> leads to <code>__nldbl_vfprintf</code> which leads to blank as well. Actually maybe <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L1238\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1553098915, "post_id": 55265498, "comment_id": 97262548, "body": "Anyway, if you want an <code>itoa</code> functionality, the <code>xprintf</code> is a serious overkill to look at. There is an <code>strtol</code> family that is performing better than any of these."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553099049, "post_id": 55265498, "comment_id": 97262627, "body": "Does it have the buffer overflow problem?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1553099131, "post_id": 55265498, "comment_id": 97262697, "body": "Depends what you mean by &quot;buffer overflow problem&quot;. C in general has a &quot;buffer overflow problem&quot; in a sense."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553099152, "post_id": 55265498, "comment_id": 97262710, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190377/discussion-between-lance-pollard-and-eugene-sh\">continue this discussion in chat</a>."}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553099400, "post_id": 55265498, "comment_id": 97262883, "body": "Not sure where the string to integer form of <code>strtol</code> is either."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553099443, "post_id": 55265498, "comment_id": 97262913, "body": "<code>printf</code> in glibc is a function that was hand optimized by generations, it uses many features, that if you can&#39;t simply find <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L2362\" rel=\"nofollow noreferrer\">_IO_vfprintf</a>.... I suggest you start with something simpler, at least not with glibc printf, but with for example <a href=\"https://github.com/eblot/newlib/blob/master/newlib/libc/stdio/vfprintf.c#L1593\" rel=\"nofollow noreferrer\">newlib printf</a>."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1553099536, "post_id": 55265498, "comment_id": 97262967, "body": "Bear in mind, this is a function of <i>this specific implementation</i> (compiler) - it&#39;s not going to be universal to all C implementations.  Exactly how <code>*printf</code> formats <i>anything</i> is left up to the implementation, as long as it satisfies the requirements in the standard.  The exact source may not even be made available to end users of the compiler."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553101312, "post_id": 55265498, "comment_id": 97264002, "body": "@EugeneSh. \u2014 <code>strtol()</code> is the inverse of the <code>itoa()</code> or <code>*printf()</code> family, isn&#39;t it, converting a string to an integer, rather than formatting an integer into a string."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553101675, "post_id": 55265498, "comment_id": 97264222, "body": "@JonathanLeffler Oh my. Got confused completely. My bad."}], "answers": [{"comments": [{"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1553112515, "post_id": 55266431, "comment_id": 97269766, "body": "Wish I could give more +1, this is great! Thank you."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1553102137, "last_edit_date": 1553102137, "creation_date": 1553101467, "answer_id": 55266431, "question_id": 55265498, "link": "https://stackoverflow.com/questions/55265498/understanding-how-sprintf-converts-integers-to-strings/55266431#55266431", "title": "Understanding how sprintf converts integers to strings", "body": "<p><a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L2363\" rel=\"nofollow noreferrer\">Looks</a> like <code>_IO_vfprintf</code> is a hidden alias to <code>_IO_vfprintf_internal</code>.</p>\n\n<p>When compiling the file <code>vfprintf.c</code> file for normal (not wide) characters, the <code>fprintf</code> becomes a macro defined as <code>_IO_vfprintf_internal</code>, from <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L81\" rel=\"nofollow noreferrer\">here</a> and undefined before aliasing <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L2355\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>So <code>_IO_vfprintf_internal</code> declaration starts <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L1238\" rel=\"nofollow noreferrer\">here</a>, where <code>vfprintf</code> is declared (well, \"in un-proprocessed source file\", the identifier <code>vfprintf</code> get's never declared).</p>\n\n<p>After the <code>vfprintf</code> functions stopped processing all the width, spaces, minuses and other format specifiers, it finally will jump through <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L272\" rel=\"nofollow noreferrer\">jump tables</a> (that basically is a smart way of jumping around to different <code>goto</code> labels by a jump table with addresses obtained through GCC extensions <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">labels as values</a>) it will land on <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L487\" rel=\"nofollow noreferrer\"><code>form_integer:</code></a> label. From there we <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L535\" rel=\"nofollow noreferrer\">jump</a> to <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L627\" rel=\"nofollow noreferrer\"><code>number:</code></a>. From there we call <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L648\" rel=\"nofollow noreferrer\"><code>_itoa_word</code></a>.</p>\n\n<p>Now <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/_itoa.c#L173\" rel=\"nofollow noreferrer\">_itoa_word</a> is plainly simple and easy, even enough to post here the preprocessed function:</p>\n\n<pre><code>char *\n_itoa_word (_ITOA_WORD_TYPE value, char *buflim,\n        unsigned int base, int upper_case) {\n        const char *digits = (upper_case\n               ? _itoa_upper_digits\n               : _itoa_lower_digits);\n\n      ...\n      switch (base)\n      {\n      ...\n      // SPECIAL (10); expands to:\n      case 10:\n          do\n              *--buflim = digits[value % Base];\n          while ((value /= Base) != 0);\n          break;\n      ...\n      }\n      ...\n}\n</code></pre>\n\n<p>Where the <code>digits</code>, as in <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/itoa-udigits.c#L22\" rel=\"nofollow noreferrer\">_itoa_upper_digits</a> or as in <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/itoa-digits.c\" rel=\"nofollow noreferrer\">_itoa_lower_digits</a> is a simple lookup table, a char array initialized from a string literal, used to convert decimals to their associated ascii representation.</p>\n\n<p>After <code>_itoa_word</code> there some code for handling left justifing the string, printing the leading sign character and padding the string with spaces or zeros, but finally our string gets <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L697\" rel=\"nofollow noreferrer\">outputted</a> (or left justified <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/vfprintf.c#L736\" rel=\"nofollow noreferrer\">outputted</a>).</p>\n\n<blockquote>\n  <p>example of converting integers to string</p>\n</blockquote>\n\n<p>So 99% of the work is for handling all the strange </p>\n\n<pre><code>printf(\"%+- 3lld %+- 4.3Lf %-+04hhd %+- 5zd\", 1llu, 2.L, 3, (ssize_t)4);\n</code></pre>\n\n<p>format specifiers it needs to conform to. The conversion is just a simple conversion using a lookup string (to handle non-ASCII systems) that work's it's way backwards through the number:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar *my_itoa(char *dest, size_t destlen, int number)\n{\n    // we will work our way from the ending\n    char *p = &amp;dest[destlen];\n    // null terminate the string\n    *--p = '\\0';\n\n    while (number) {\n        if (p == dest) {\n            // destination buffer too small!!\n            return NULL;\n        }\n        *--p = \"0123456789\"[number % 10];\n        number /= 10;\n    }\n\n    return p;\n}\n\nint main()\n{\n    char buf[20];\n    printf(\"%s\\n\", my_itoa(buf, sizeof(buf), 123));\n}\n</code></pre>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55266431, "answer_count": 1, "score": 1, "last_activity_date": 1553102137, "creation_date": 1553098601, "last_edit_date": 1553098798, "question_id": 55265498, "link": "https://stackoverflow.com/questions/55265498/understanding-how-sprintf-converts-integers-to-strings", "title": "Understanding how sprintf converts integers to strings", "body": "<p>I am in the process of learning C and on a basic example of converting integers to string (which you take for granted in other languages). The answer I found was this:</p>\n\n<pre><code>sprintf(str, \"%d\", num);\n</code></pre>\n\n<p>But I would like to see how this is implemented. So I look up <a href=\"https://github.com/lattera/glibc/blob/master/stdio-common/sprintf.c\" rel=\"nofollow noreferrer\">sprintf</a> and it takes me here:</p>\n\n<pre><code>#define vsprintf(s, f, a) _IO_vsprintf (s, f, a)\n\nint\n__sprintf (char *s, const char *format, ...)\n{\n  va_list arg;\n  int done;\n\n  va_start (arg, format);\n  done = vsprintf (s, format, arg);\n  va_end (arg);\n\n  return done;\n}\n</code></pre>\n\n<p>So then I look up <a href=\"https://github.com/lattera/glibc/blob/master/libio/iovsprintf.c\" rel=\"nofollow noreferrer\"><code>_IO_vsprintf</code></a> and it shows:</p>\n\n<pre><code>int\n__IO_vsprintf (char *string, const char *format, va_list args)\n{\n  _IO_strfile sf;\n  int ret;\n\n#ifdef _IO_MTSAFE_IO\n  sf._sbf._f._lock = NULL;\n#endif\n  _IO_no_init (&amp;sf._sbf._f, _IO_USER_LOCK, -1, NULL, NULL);\n  _IO_JUMPS (&amp;sf._sbf) = &amp;_IO_str_jumps;\n  _IO_str_init_static_internal (&amp;sf, string, -1, string);\n  ret = _IO_vfprintf (&amp;sf._sbf._f, format, args);\n  _IO_putc_unlocked ('\\0', &amp;sf._sbf._f);\n  return ret;\n}\n</code></pre>\n\n<p>Which seems to revolve around <code>_IO_vfprintf</code>. But I can't find where that is in the <a href=\"https://github.com/lattera/glibc/tree/master/libio\" rel=\"nofollow noreferrer\">code</a>. Google and GitHub bring no results. Wondering if anyone has the full implementation of sprintf available or if not, can explain how it works.</p>\n\n<p>I would like to know how to implement itoa as sprintf does it, which sounds like is a good implementation.</p>\n\n<p>I am confused as to how this code can actually run if there is no implementation.</p>\n"}, {"tags": ["c#", "c", ".net", "gcc", "printf"], "comments": [{"owner": {"reputation": 1118, "user_id": 5048973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53a77c528e39678f92d634a70a12193e?s=128&d=identicon&r=PG&f=1", "display_name": "P Burke", "link": "https://stackoverflow.com/users/5048973/p-burke"}, "edited": false, "score": 0, "creation_date": 1553100828, "post_id": 55265394, "comment_id": 97263709, "body": "Hi, I suspect that your &quot;it might be important&quot; statement is that, important. Can you get the version before the corruption? If not I think  you need to post the information related to building the DLL."}, {"owner": {"reputation": 1, "user_id": 11232998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbd46d5b976a869dbc35f7b321ab261?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyB1991", "link": "https://stackoverflow.com/users/11232998/johnnyb1991"}, "reply_to_user": {"reputation": 1118, "user_id": 5048973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53a77c528e39678f92d634a70a12193e?s=128&d=identicon&r=PG&f=1", "display_name": "P Burke", "link": "https://stackoverflow.com/users/5048973/p-burke"}, "edited": false, "score": 0, "creation_date": 1553103219, "post_id": 55265394, "comment_id": 97265113, "body": "It was version 16.01.  It&#39;s still the same version."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1553120608, "post_id": 55265394, "comment_id": 97273272, "body": "This is an entirely normal mishap, making it specific to vsnprintf does make it much harder to explain.  Code compiled with GCC doesn&#39;t just have a dependency on the OS DLLs you listed, it also depends on the C runtime library.  If it can&#39;t be found at runtime then it is sayonara with this exception. memset() is a C runtime function as well, but is normally generated as an intrinsic so doesn&#39;t require the library.  Just use the normal troubleshooting strategies, enable loader snaps or use SysInternals&#39; Process Monitor to diagnose DLL resolution problems."}], "owner": {"reputation": 1, "user_id": 11232998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbd46d5b976a869dbc35f7b321ab261?s=128&d=identicon&r=PG&f=1", "display_name": "JohnnyB1991", "link": "https://stackoverflow.com/users/11232998/johnnyb1991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553113736, "creation_date": 1553098307, "last_edit_date": 1553113736, "question_id": 55265394, "link": "https://stackoverflow.com/questions/55265394/vsnprintf-and-snprintf-causing-dll-to-not-load", "title": "vsnprintf and snprintf causing dll to not load", "body": "<p>I've been fighting this for days.  I have a Visual Studio .net project written in C# that needs to load a dll written in C using gcc compilers on the Codeblocks IDE.  </p>\n\n<p>The dll can be loaded and used fine, but when I use vsnprintf in the dll, the .net project says \"Unable to load DLL.  The specified module could not be found.\" whenever I try to call a function from the dll.</p>\n\n<p>Relevant C# code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Runtime.InteropServices;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Threading;\n\nnamespace Scratchpad\n{\n    public partial class frmMain : Form\n    {\n        [DllImport(\"testpielibs\", CallingConvention = CallingConvention.Cdecl)]\n        static extern void SomeFunction(string a);    \n\n        private void button3_Click(object sender, EventArgs e)\n        {\n            SomeFunction(\"ABC\");\n        }\n    }\n}\n</code></pre>\n\n<p>Relevant C (the DLL) code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdarg.h&gt;\n\n#define DLL_EXPORT __declspec(dllexport)\n\nvoid DLL_EXPORT SomeFunction(const LPCSTR sometext)\n{\n    MessageBoxA(0, sometext, \"DLL Message\", MB_OK | MB_ICONINFORMATION);\n}\n\nDLL_EXPORT BOOL APIENTRY DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)\n{\n    switch (fdwReason)\n    {\n        case DLL_PROCESS_ATTACH:\n            break;\n        case DLL_PROCESS_DETACH:\n            break;\n        case DLL_THREAD_ATTACH:\n            break;\n        case DLL_THREAD_DETACH:\n            break;\n    }\n    return TRUE;\n}\n\nint  log_printf(char *format, ...)\n{\n    char msg[256];\n    va_list ap;\n\n    memset(msg, 0, sizeof msg);\n    va_start(ap, format);\n    vsnprintf(msg, 256, format, ap);\n    va_end(ap);\n    return 0;\n}\n</code></pre>\n\n<p>Notice that \"SomeFunction\" doesn't even call \"log_printf\".  The project builds fine regardless, and when I comment out the line with vsnprintf it works like it should with the .net project, but that one line is what's causing the dll to be unable to load in the .net project.  </p>\n\n<p>Incase this is releveant, here are my linker libraries for the dll:</p>\n\n<pre><code>ws2_32\niphlpapi\nmswsock\nwinmm\nuser32\n</code></pre>\n\n<p>Also, I feel like it might be important to note that the other day, just before all of this happened, I got an error from codeblocks saying something about my config file being corrupted.  This project was building fine before then, but I had to go back and manually re-assign the compiler and linker settings.</p>\n\n<p>Any suggestions?</p>\n\n<p>UPDATE: snprintf is causing the same issue.  I can use sprintf and vsprintf, but snprintf and vsnprintf are causing the dll to not be loaded in the C# project, even though the dll will still build with no errors or warnings.  I've looked into the calling conventions used to import my dll functions into my c# project, and Cdecl seems like the way to go since it specifically says that it \"enables calling functions with varargs, which makes it appropriate to use for methods that accept a variable number of parameters, such as Printf.\"  I've also tried importing SomeFunction using calling conventions Winapi, StdCall and ThisCall, but they all have the same results.  Any help would be really appreciated, I have been stumped on this for a while.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1553096773, "post_id": 55264782, "comment_id": 97261063, "body": "Pro tip: When you get nonsense values like this it&#39;s almost always a case of <i>uninitialized variables</i>. What is <code>count</code> set to before incrementing? Answer: Nothing in particular. Since the compiler doesn&#39;t think you care, it just uses <i>whatever</i> as a value. Compile with <code>-Wall</code> to expose problems like this."}], "answers": [{"tags": [], "owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "is_accepted": false, "score": 0, "last_activity_date": 1553098011, "creation_date": 1553098011, "answer_id": 55265307, "question_id": 55264782, "link": "https://stackoverflow.com/questions/55264782/getting-unexpected-output-for-entered-number-to-find-the-cube/55265307#55265307", "title": "getting unexpected output for entered number to find the cube", "body": "<p>You are getting an overflow, since 1000^4 is 1000000000000 which is certainly above the value of <code>INT_MAX</code> (2147483647 on my system). You should use an appropriate data type like <code>long</code> or check for an overflow like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;limits.h&gt;\n\n\nint cube(int num)\n{\n    int count,temp,i,add=1;\n\n    temp=num;\n    while(temp&gt;0)\n    {\n        temp=temp/10;\n        count++;\n    }\n    printf(\"%d\\n\" , count);\n\n    for(i=1;i&lt;=count;i++)\n    {\n        if (INT_MAX/num &lt; add) {\n            printf(\"overflow\\n\");\n        }\n        add=add*num;\n    }\n\n    return add;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9774129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SPQaQGwGZ_0/AAAAAAAAAAI/AAAAAAAAAB0/VlJZzZaZ6RI/photo.jpg?sz=128", "display_name": "Manish Pandey", "link": "https://stackoverflow.com/users/9774129/manish-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553098011, "creation_date": 1553096586, "last_edit_date": 1553097076, "question_id": 55264782, "link": "https://stackoverflow.com/questions/55264782/getting-unexpected-output-for-entered-number-to-find-the-cube", "title": "getting unexpected output for entered number to find the cube", "body": "<p>HERE I am not just trying to find out only cube of any number but i want to find out the entered number is to multiply by the count of its digit.\nex:- 100 to multiply by 100 three times.</p>\n\n<p>Whenever i am entering a number of more then of 3 digits i am getting \nunexpected output in negative number.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nint cube(int);\n\nvoid main()\n{\n    int n,ans;\n\n    printf(\"enter a number : \");\n    scanf(\"%d\" , &amp;n);\n\n   ans=cube(n);\n    printf(\"%d\" , ans);\n}\n\nint cube(int num)\n{\n    int count,temp,i,add=1;\n\n    temp=num;\n    while(temp&gt;0)\n    {\n        temp=temp/10;\n        count++;\n    }\n    printf(\"%d\\n\" , count);\n\n    for(i=1;i&lt;=count;i++)\n    {\n        add=add*num;\n    }\n\n    return add;\n}\n</code></pre>\n\n<p>Ex:-</p>\n\n<p>enter a number : 1000<br>\n4<br>\n-727379968</p>\n\n<p>But at the same time when i am entering the number as 10101</p>\n\n<p>enter a number : 10101<br>\n5<br>\n1343051877 </p>\n\n<p>i am getting this output.</p>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553096490, "post_id": 55264724, "comment_id": 97260852, "body": "What did you think <code>printf(&quot;Thread %d: &quot;,(int*) i); printf(&quot;Thread %d: &quot;, messages[(int*)i]);</code> would do? Because it makes to sense thread or no thread. Unrelated, it is very bad practice to pass along an integer inside the void pointer, instead of pointing at one... I&#39;d regard that as a dirty hack that can break at any point."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1553096620, "post_id": 55264724, "comment_id": 97260951, "body": "Change <code>(int*)i</code> to <code>(int)i</code>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553096766, "post_id": 55264724, "comment_id": 97261057, "body": "<code>printf(&quot;Thread %d: &quot;, messages[(int*)i]);</code> is not how to print a string, use the <code>%s</code> format specifier instead, along with the other changes suggested."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553097053, "post_id": 55264724, "comment_id": 97261267, "body": "this looks like a trivial/academic example, but understand from an architectural standpoint, this is a poor use of threads. The whole idea of threads is to do work in <i>parallel</i>. In your code, you are creating a single thread, then waiting for it to complete (with the <code>pthread_join</code> call), then creating the next one, etc. Serializing threads like this will gain you no speed improvements, and in fact will probably be slower than a single threaded implementation since you have introduced overhead for creating extra threads."}, {"owner": {"reputation": 29, "user_id": 11232960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hkx8IPcP7C4/AAAAAAAAAAI/AAAAAAAAAHk/v-aae30T0PY/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11232960/brian-kreidberg"}, "edited": false, "score": 0, "creation_date": 1553097421, "post_id": 55264724, "comment_id": 97261544, "body": "I have changed the code a bit now it says pthread create has to many augments"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553097528, "post_id": 55264724, "comment_id": 97261625, "body": "there should be 4 arguments: <a href=\"http://man7.org/linux/man-pages/man3/pthread_create.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/pthread_create.3.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11232960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hkx8IPcP7C4/AAAAAAAAAAI/AAAAAAAAAHk/v-aae30T0PY/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11232960/brian-kreidberg"}, "edited": false, "score": 0, "creation_date": 1553098894, "post_id": 55265348, "comment_id": 97262536, "body": "thanks for the help the only problem with that implementation is that the threads are printing in reverse now"}, {"owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "reply_to_user": {"reputation": 29, "user_id": 11232960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hkx8IPcP7C4/AAAAAAAAAAI/AAAAAAAAAHk/v-aae30T0PY/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11232960/brian-kreidberg"}, "edited": false, "score": 1, "creation_date": 1553099082, "post_id": 55265348, "comment_id": 97262653, "body": "Of course, you can&#39;t assume the execution order between threads because they are running in parallel. That&#39;s the point."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553100124, "post_id": 55265348, "comment_id": 97263301, "body": "I think your comment about 10 threads being too many is not accurate. Processes can certainly have more than 10 threads, and in linux anyway, there&#39;s no difference from an execution standpoint between a thread or a process. There are hundreds to thousands of threads of execution on a system, it&#39;s the schedulers job to manage what, when, and where they run."}, {"owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553102188, "post_id": 55265348, "comment_id": 97264549, "body": "@yano if you are using threads to fully use up your CPU power (expensive computation), then you will need as many threads as number of cores in your CPU. In my case I have 4 cores and a more modern user machines usually have 8 cores. From this perspective, 10 fully-utilized threads means the scheduler will waste time switching between them. However, if your are using threads as way of doing things concurrently, so that one job doesn&#39;t block the others then sure the OS can handle thousands of threads (usually those are mostly sleeping)."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553106341, "post_id": 55265348, "comment_id": 97266677, "body": "perhaps. I&#39;d be surprised to learn there are hard rules within the scheduler to spread threads from a process across all the cores. Particularly if they&#39;re working on a data set that fits in cache local to 1or 2 cores, it may very well be faster to context switch rather than sync data across all the cores. But admittedly I&#39;m no scheduler expert. These are details I wouldn&#39;t worry about unless I benchmarked my code and it was too slow. Writing code assuming a system has x number of cores isn&#39;t robust anyway, so unless OP is on a specific system, I think the number of cores is of little concern."}, {"owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "edited": false, "score": 0, "creation_date": 1553108462, "post_id": 55265348, "comment_id": 97267749, "body": "I don&#39;t think I completely understand your comment, but (again, I&#39;m talking about computationally expensive tasks like compressor, video encoder, renderer) if the OS were to not distribute the threads over all the cores (which it does), say only 1 core on a 4-core CPU, then your task is only using 25% of your CPU. And 25% is in no way faster than a any number of cache misses."}], "tags": [], "owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "is_accepted": false, "score": 2, "last_activity_date": 1553098138, "creation_date": 1553098138, "answer_id": 55265348, "question_id": 55264724, "link": "https://stackoverflow.com/questions/55264724/using-threads-for-the-first-time/55265348#55265348", "title": "using threads for the first time", "body": "<p>There are many problems in the code and I'll point them out individually as comments:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\n// Note: In most cases, you should use (char *) for strings instead of char[XX].\n// Note: You don't need to set the number of elements in the array \n// because it is automatically inferred from the initializer.\nchar *messages[] = {\"Hello\", \"Bonjour\", \"Hola\", \"Shalom\", \"Namaste\", \"Gutan Tag\", \"God dag\",\"Ola\", \"Salut\", \"Napot\", \"Dia\"};\n\nvoid *print_function(void *data)\n{\n  // The data you passed is int not a pointer to int.\n  int i = (int)data;\n  printf(\"Thread %d: \\n\", i);\n  // You need to use %s for printing string.\n  printf(\"Message: %s\\n\", messages[i]);\n  return NULL;\n}\n\nint main(int argc, char* argv[])\n{\n  int i;\n  int num = atoi(argv[1]);\n\n  // Limit the number of running threads so you don't slow down you computer (10 is already too much. It depends on the number of cores you CPU has).\n  #define MAX_NUM_OF_THREADS 10\n  if(num &gt; MAX_NUM_OF_THREADS)\n    num = MAX_NUM_OF_THREADS;\n\n  // I explain why we need to store the thread ids down below.\n  pthread_t thread_ids[MAX_NUM_OF_THREADS];\n\n\n  for(i = 0; i &lt; num; i++)\n  {\n    pthread_t tid;\n    void *thread_data = (void *)(i + 1);\n    pthread_create(&amp;tid, NULL, print_function, thread_data);\n    thread_ids[i] = tid;\n  }\n\n  // You can't join with the thread in the previous loop because it will serialize thread creation.\n  // Meaning the program will not create the next thread before the current thread finish execution.\n  // Instead, you need to create all the threads first then you join to them one by one afterward.\n  // And for that you need to store the thread ids for each thread in order to join with them after they are created.\n  for(i = 0; i &lt; num; i++)\n  {\n    pthread_join(thread_ids[i], NULL);\n  }\n\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 11232960, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hkx8IPcP7C4/AAAAAAAAAAI/AAAAAAAAAHk/v-aae30T0PY/photo.jpg?sz=128", "display_name": "Brian Kreidberg", "link": "https://stackoverflow.com/users/11232960/brian-kreidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553098138, "creation_date": 1553096420, "last_edit_date": 1553097385, "question_id": 55264724, "link": "https://stackoverflow.com/questions/55264724/using-threads-for-the-first-time", "title": "using threads for the first time", "body": "<p>//trying to make each thread print its thread number not id and then print a message from the array would like to be able to pass array in pthread create but right now I am getting a an error array subscript is not an integer please help me    </p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid * print_funtion( void* i, void* message)\n{   \n    printf(\"Thread %d: \",(int*) i);\n    printf(\"Thread %s: \", message);\n\n    return NULL;\n}\n\nint main(int argc, char* argv[]){\nint i;\nint num = atoi(argv[1]);\n//printf(\"%d \\n\", num);\n\n\nfor(i = 1; i &lt;= num; i++)\n{\n\n\n    char *messages[] = {\"Hello\", \"Bonjour\", \"Hola\", \"Shalom\", \"Namaste\", \"Gutan Tag\", \"God dag\",\"Ola\", \"Salut\", \"Napot\", \"Dia\"};\n\n\n    //printf(\"%d \\n\", i);\n    pthread_t tid;\n    pthread_create(&amp;tid, NULL, print_funtion,(void*)i, (void*)messages[i]);\n    pthread_join(tid,NULL);\n}\n\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "x86", "profiling", "intel-pin"], "answers": [{"comments": [{"owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 0, "creation_date": 1553192603, "post_id": 55285607, "comment_id": 97303603, "body": "this is perfect. Thanks so much!"}], "tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": true, "score": 1, "last_activity_date": 1553187569, "creation_date": 1553187569, "answer_id": 55285607, "question_id": 55264577, "link": "https://stackoverflow.com/questions/55264577/stack-allocation-size-using-intel-pin-tool/55285607#55285607", "title": "Stack allocation size using intel pin tool", "body": "<p>The sample pintool from <code>source/tools/SimpleExamples/oper-imm.cpp</code> shows how to get immediate operands. It looks like this:</p>\n\n<pre><code>if (INS_OperandIsImmediate(ins, i))\n{\n    // Get the value itself\n    ADDRINT value = INS_OperandImmediate(ins, i);\n\n    // Determine the size and the signedness of the immediate value.\n}\n</code></pre>\n\n<p>In your case, <code>i</code> is 1 because you need to check whether the second operand is an immediate value. You also need to check whether the first operand is an explicit <code>RSP</code> register and that the instruction is <code>ADD</code> or <code>SUB</code>. Essentially, you need to find the first such instruction.</p>\n\n<pre><code>if((INS_Opcode(ins) == XED_ICLASS_ADD || INS_Opcode(ins) == XED_ICLASS_SUB) &amp;&amp; \n   REG(INS_OperandReg(ins, 0)) == REG_STACK_PTR &amp;&amp; INS_OperandIsImmediate(ins, 1))\n{\n  // Obtain the immediate operand information as shown above.\n  // You can obtain the RSP register value before or after the instruction by\n  // passing IARG_REG_VALUE, REG_STACK_PTR to INS_Insert*.\n}\n</code></pre>\n\n<p>Some programming languages or specific implementations may allow allocating variables on the stack of dynamic sizes. For example, most C/C++ implementations offer <code>alloca</code>, which typically allocates memory from the stack. As another example, the C# language offers the <code>stackalloc</code> keyword. Therefore, the second operand is not necessarily always immediate and there can be multiple <code>ADD</code>/<code>SUB</code> instructions spread throughput the function that allocate/deallocate memory from the stack. </p>\n"}], "owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 55285607, "answer_count": 1, "score": 2, "last_activity_date": 1587424515, "creation_date": 1553096025, "last_edit_date": 1587424515, "question_id": 55264577, "link": "https://stackoverflow.com/questions/55264577/stack-allocation-size-using-intel-pin-tool", "title": "Stack allocation size using intel pin tool", "body": "<p>I have following c code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint foo()\n{\n  int a = 4;\n  int *p = &amp;a;\n  printf(\"%i\\n\", *p);\n  int b[10];\n  b[1] = 3;\n}\n\nint main(void)\n{\n  int a[10], b[20];\n  a[2] = 7;\n  b[7] = 9;\n  foo();\n  return 0;\n}\n</code></pre>\n\n<p>I created following PIN tool:</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include \"pin.H\"\n\n// Additional library calls go here\n\n/*********************/\n\n// Output file object\nofstream OutFile;\n\n//static uint64_t counter = 0;\n\nuint32_t lock = 0;\nuint32_t unlock = 1;\nstd::string rtin = \"\";\n// Make this lock if you want to print from _start\nuint32_t key = unlock;\n\nvoid printmaindisas(uint64_t addr, std::string disassins)\n{\n    std::stringstream tempstream;\n    tempstream &lt;&lt; std::hex &lt;&lt; addr;\n    std::string address = tempstream.str();\n    if (key)\n        return;\n    if (addr &gt; 0x700000000000)\n        return;\n    std::cout&lt;&lt;address&lt;&lt;\"\\t\"&lt;&lt;disassins&lt;&lt;std::endl;\n}\n\nvoid mutex_lock()\n{\n\nkey = !lock;\nstd::cout&lt;&lt;\"out\\n\";\n\n}\nvoid mutex_unlock()\n{\n\n    key = lock;\n    std::cout&lt;&lt;\"in\\n\";\n\n}\n\nvoid Instruction(INS ins, VOID *v)\n{\n\n    // if (INS_IsStackWrite(ins) == true)\n    // {\n    //  std::cout &lt;&lt; \"Stack write instruction: \" &lt;&lt; INS_Disassemble(ins) &lt;&lt; '\\n';\n    // }\n  // Insert a call to docount before every instruction, no arguments are passed\n  INS_InsertCall(ins, IPOINT_BEFORE, (AFUNPTR)printmaindisas, IARG_ADDRINT, INS_Address(ins),\n  IARG_PTR, new string(INS_Disassemble(ins)), IARG_END);\n    //std::cout&lt;&lt;INS_Disassemble(ins)&lt;&lt;std::endl;\n}\n\nvoid Routine(RTN rtn, VOID *V)\n{\n    if (RTN_Name(rtn) == \"main\")\n    {\n        //std::cout&lt;&lt;\"Loading: \"&lt;&lt;RTN_Name(rtn) &lt;&lt; endl;\n        RTN_Open(rtn);\n        RTN_InsertCall(rtn, IPOINT_BEFORE, (AFUNPTR)mutex_unlock, IARG_END);\n        RTN_InsertCall(rtn, IPOINT_AFTER, (AFUNPTR)mutex_lock, IARG_END);\n        RTN_Close(rtn);\n    }\n}\n\nKNOB&lt;string&gt; KnobOutputFile(KNOB_MODE_WRITEONCE, \"pintool\", \"o\", \"mytool.out\", \"specify output file name\");\n/*\nVOID Fini(INT32 code, VOID *v)\n{\n    // Write to a file since cout and cerr maybe closed by the application\n    OutFile.setf(ios::showbase);\n    OutFile &lt;&lt; \"Count \" &lt;&lt; count &lt;&lt; endl;\n    OutFile.close();\n}\n*/\n\nint32_t Usage()\n{\n  cerr &lt;&lt; \"This is my custom tool\" &lt;&lt; endl;\n  cerr &lt;&lt; endl &lt;&lt; KNOB_BASE::StringKnobSummary() &lt;&lt; endl;\n  return -1;\n}\n\nint main(int argc, char * argv[])\n{\n  // It must be called for image instrumentation\n  // Initialize the symbol table\n  PIN_InitSymbols();\n  // Initialize pin\n    // PIN_Init must be called before PIN_StartProgram\n    // as mentioned in the documentation\n  if (PIN_Init(argc, argv)) return Usage();\n\n  // Open the output file to write\n  OutFile.open(KnobOutputFile.Value().c_str());\n\n  // Set instruction format as intel\n    // Not needed because my machine is intel\n  PIN_SetSyntaxIntel();\n\n  RTN_AddInstrumentFunction(Routine, 0);\n  //IMG_AddInstrumentFunction(Image, 0);\n\n  // Add an isntruction instrumentation\n  INS_AddInstrumentFunction(Instruction, 0);\n\n  //PIN_AddFiniFunction(Fini, 0);\n\n  // Start the program here\n  PIN_StartProgram();\n\n  return 0;\n\n}\n</code></pre>\n\n<p>It gives me following output:</p>\n\n<pre><code>in\n40051e  push rbp\n40051f  mov rbp, rsp\n400522  add rsp, 0xffffffffffffff80\n400526  mov dword ptr [rbp-0x28], 0x7\n40052d  mov dword ptr [rbp-0x64], 0x9\n400534  mov eax, 0x0\n400539  call 0x4004e6\n4004e6  push rbp\n4004e7  mov rbp, rsp\n4004ea  sub rsp, 0x40\n4004ee  mov dword ptr [rbp-0xc], 0x4\n4004f5  lea rax, ptr [rbp-0xc]\n4004f9  mov qword ptr [rbp-0x8], rax\n4004fd  mov rax, qword ptr [rbp-0x8]\n400501  mov eax, dword ptr [rax]\n400503  mov esi, eax\n400505  mov edi, 0x4005d0\n40050a  mov eax, 0x0\n40050f  call 0x4003f0\n4003f0  jmp qword ptr [rip+0x200c22]\n4003f6  push 0x0\n4003fb  jmp 0x4003e0\n4003e0  push qword ptr [rip+0x200c22]\n4003e6  jmp qword ptr [rip+0x200c24]\n4\n400514  mov dword ptr [rbp-0x3c], 0x3\n40051b  nop\n40051c  leave \n40051d  ret \n40053e  mov eax, 0x0\n400543  leave \nout\n</code></pre>\n\n<p>I want to get the value <code>0xffffffffffffff80</code> in the case of <em>main</em> function and <code>0x40</code> in case of function <em>foo</em>. In short I want to get the stack place which has been allocated, after function creation. So, one way this can be done is by detecting the particular instruction, say add/sub rsp in this case and then trimming the output to get the particular string. Another way would be by getting the value of rbp or rsp (correct me if I'm wrong here).</p>\n\n<p>I check the pin api documentation <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/97619/Pin/html/modules.html\" rel=\"nofollow noreferrer\">here</a> and also saw some examples given <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/97619/Pin/html/index.html#SafeCopy\" rel=\"nofollow noreferrer\">here</a>, but still couldn't find the way to get the particular string values.</p>\n\n<p>Following the documentation I tried this:</p>\n\n<pre><code>if (INS_RegR(ins, 0) == REG_RSP)\n        std::cout &lt;&lt; \"rsp: \" &lt;&lt; REG_Size(REG_RSP) &lt;&lt; '\\n';\n</code></pre>\n\n<p>But, still couldn't figure out how to get the values.</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1553096043, "post_id": 55264559, "comment_id": 97260543, "body": "This will be easier if you use <code>fgets</code> (or even better, <code>getline</code>, but not all systems provide that) instead of <code>scanf</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553096331, "post_id": 55264559, "comment_id": 97260732, "body": "if <code>scanf</code> has a matching failure then the contents of the array are indeterminate..."}, {"owner": {"reputation": 148, "user_id": 9181912, "user_type": "registered", "profile_image": "https://graph.facebook.com/1545648365549477/picture?type=large", "display_name": "Jakub Men\u0161&#237;k", "link": "https://stackoverflow.com/users/9181912/jakub-men%c5%a1%c3%adk"}, "edited": false, "score": 0, "creation_date": 1553096974, "post_id": 55264559, "comment_id": 97261200, "body": "i cant use fgets beacause fgets ends with ascii char 10 and in my program i need scan all ascii from 0 to 127"}, {"owner": {"reputation": 148, "user_id": 9181912, "user_type": "registered", "profile_image": "https://graph.facebook.com/1545648365549477/picture?type=large", "display_name": "Jakub Men\u0161&#237;k", "link": "https://stackoverflow.com/users/9181912/jakub-men%c5%a1%c3%adk"}, "edited": false, "score": 0, "creation_date": 1553097284, "post_id": 55264559, "comment_id": 97261448, "body": "Ohh maybe i cant use it because \\0 is also in ascii as 0 and with fgets its working. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 9181912, "user_type": "registered", "profile_image": "https://graph.facebook.com/1545648365549477/picture?type=large", "display_name": "Jakub Men\u0161&#237;k", "link": "https://stackoverflow.com/users/9181912/jakub-men%c5%a1%c3%adk"}, "is_accepted": false, "score": 0, "last_activity_date": 1553097342, "creation_date": 1553097342, "answer_id": 55265071, "question_id": 55264559, "link": "https://stackoverflow.com/questions/55264559/check-if-users-input-is-empty-in-c-with-scanf/55265071#55265071", "title": "Check if user&#39;s input is empty in C with scanf", "body": "<p>fgets() is solution for condition if prom[0] == '\\n'</p>\n"}, {"comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1553103241, "post_id": 55265677, "comment_id": 97265124, "body": "It returns the number of sucessfully matched and assigned to specifiers, not the number of characters.  So testing against zero is an ok answer, but testing for returning 1 is probably better (to handle EOF more cleanly)"}], "tags": [], "owner": {"reputation": 1175, "user_id": 1654526, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3287ef88010dfa6ae54dfadd74a0d5e0?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/1654526/jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1553099195, "creation_date": 1553099195, "answer_id": 55265677, "question_id": 55264559, "link": "https://stackoverflow.com/questions/55264559/check-if-users-input-is-empty-in-c-with-scanf/55265677#55265677", "title": "Check if user&#39;s input is empty in C with scanf", "body": "<p>scanf() returns the number of converted chars. Test the returned value against 0 to see if no conversion has been done.</p>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 11222170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5EPr8bWacyU/AAAAAAAAAAI/AAAAAAAAAdU/tKAcuTI3_RY/photo.jpg?sz=128", "display_name": "Alexey Godin", "link": "https://stackoverflow.com/users/11222170/alexey-godin"}, "is_accepted": true, "score": 0, "last_activity_date": 1553105123, "creation_date": 1553105123, "answer_id": 55267472, "question_id": 55264559, "link": "https://stackoverflow.com/questions/55264559/check-if-users-input-is-empty-in-c-with-scanf/55267472#55267472", "title": "Check if user&#39;s input is empty in C with scanf", "body": "<p><strong>NEVER EVER SCANF ARBITRARY LENGTH STRINGS</strong>. It's a source of security holes and general source of errors you will have a great trouble to find later on. You may use scanf to look for strings if you implicitly specify the maximum length of the string to read (read about the scanf format specifiers). But in your situation it is faster and safer just to use fgets. Read the string. Check if you actually have read it (by the return value of fgets) and then check if the first character (if it actually exists) is '\\n'. If it is so then the user has prompted an empty string. </p>\n\n<p>Besides as you have got your string you can safely parse it with sscanf for the message you need to parse. </p>\n"}], "owner": {"reputation": 148, "user_id": 9181912, "user_type": "registered", "profile_image": "https://graph.facebook.com/1545648365549477/picture?type=large", "display_name": "Jakub Men\u0161&#237;k", "link": "https://stackoverflow.com/users/9181912/jakub-men%c5%a1%c3%adk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "accepted_answer_id": 55267472, "answer_count": 3, "score": 0, "last_activity_date": 1553105123, "creation_date": 1553095969, "last_edit_date": 1553098951, "question_id": 55264559, "link": "https://stackoverflow.com/questions/55264559/check-if-users-input-is-empty-in-c-with-scanf", "title": "Check if user&#39;s input is empty in C with scanf", "body": "<p>I need to do something when the user presses only enter without any input but that empty. When the user's input is something, <code>\\0</code> is always right behind the last char. For example </p>\n\n<blockquote>\n  <p>input:hello world </p>\n</blockquote>\n\n<p><code>\\0</code> is always in <code>prom[11]</code> but when user press only enter <code>\\0</code> isn't there.</p>\n\n<pre><code>char prom[100];\nscanf(\"%[^\\n]\", prom); \nif (prom[0] == '\\0'){ //if user press enter \n//do something\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "struct", "bit-packing"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1553096368, "post_id": 55264536, "comment_id": 97260760, "body": "Probably they don&#39;t allow enum-based bit-fields, simple as that. You could try to toss them out and use <code>uint32_t</code> or <code>uint8_t</code>. Also make sure that you compile with <code>-std=c11</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1553096704, "post_id": 55264536, "comment_id": 97261017, "body": "Are you using the same compiler flags?  Which ones?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1553097496, "post_id": 55264536, "comment_id": 97261599, "body": "To build on @Lundin&#39;s comment, when I compile with gcc (with <code>-std=c99</code> or <code>-std=c11</code>) with pedantic warnings, I get <code>warning: type of bit-field &#39;&lt;name of field&gt;&#39; is a GCC extension</code> for all of the bitfields of enum types."}, {"owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553100655, "post_id": 55264536, "comment_id": 97263597, "body": "Thank you @Lundin and @christian-gibbons for your quick responses, but it turns out it was the compiler treating <code>pause_states_t</code> and <code>info_level_t</code> as blanks because their type def hadn&#39;t been read yet.  Thanks again"}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "is_accepted": false, "score": 0, "last_activity_date": 1553100171, "creation_date": 1553100171, "answer_id": 55266001, "question_id": 55264536, "link": "https://stackoverflow.com/questions/55264536/syntax-error-in-bit-packing-a-structure-in-c-after-switching-compiler-and-ide/55266001#55266001", "title": "Syntax error in bit packing a structure in C after switching compiler and IDE", "body": "<p><strong>And the answer is...</strong> it has to do with the order the structure data types typedefs were being read between the two compilers and/or because of minor structural changes to the program because of the different controller.</p>\n\n<p>If I move the typedef of <code>pause_states_t</code> and <code>info_level_t</code> to another file that is definitely read before this file, the error goes away.</p>\n\n<p>It seems like instead of getting some sort of \"unrecognized symbol\" or \"unrecognized data type\" error, it treats it as if is blank and this is what triggers the errors.</p>\n\n<p>This is consistent with some other errors I'm getting now where the compiler is encountering customer data types before the typedef is read.</p>\n"}], "owner": {"reputation": 177, "user_id": 6346499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b306473ed6b4d8dd2fd7536e9778970a?s=128&d=identicon&r=PG&f=1", "display_name": "MidnightRover", "link": "https://stackoverflow.com/users/6346499/midnightrover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553100171, "creation_date": 1553095912, "question_id": 55264536, "link": "https://stackoverflow.com/questions/55264536/syntax-error-in-bit-packing-a-structure-in-c-after-switching-compiler-and-ide", "title": "Syntax error in bit packing a structure in C after switching compiler and IDE", "body": "<p>Okay, what am I missing....</p>\n\n<p>I wrote the code originally on an IAR IDE/compiler for use on an ARM microprocessor and it worked fine.</p>\n\n<p>We are now switching to a different controller with a Tricore microprocessor and are now using code::blocks IDE with GNU GCC compiler for TriCore v3.4.6.</p>\n\n<p>When building I am getting the errors with the below two structures (related enums given for reference):</p>\n\n<pre><code>01| typedef enum equip_states_t {\n02|   stopped = 0,\n03|   starting = 1,\n04|   running = 2,\n05|   paused = 3,\n06|   stopping = 4\n07| }equip_states_t;\n08| \n09| typedef enum info_level_t{\n10|   clear = 0,\n11|   alert = 1,\n12|   warning = 2,\n13|   error = 3\n14| } info_level_t;\n15| \n16| typedef struct d2101_equip_states_t {\n17|   equip_states_t        AIR_COMP_state:4; //Error starts here\n18|   pause_states_t        auto_pause_state:4;\n19|   fullness_states_t     BE_fullness:4;\n20|   equip_states_t        BE_state:4;\n21|   fullness_states_t     BIN_fullness:4;\n22|   bin_states_t          BIN_state:4;\n23|   bin_states_t          BYPASS_state:4;\n24|   control_modes_t       control_mode:4;\n25|   equip_states_t        DC_state:4;\n26|   source_dest_t         DIV_auto_pause:4;\n27|   source_dest_t         DIV_position:4;\n28|   equip_states_t        HYDR_state:4;\n29|   equip_states_t        QL_state:4;\n30|   fullness_states_t     TC_fullness:4;\n31|   equip_states_t        TC_state:4;\n32|   equip_states_t        TUC_state:4;\n33| } d2101_equip_states_t;\n34| \n35| typedef struct info_message_t {\n36|   uint16_t              ID;  //Error starts here\n37|   info_level_t          status:8;\n38|   uint8_t               not_used;\n39|   uint32_t              time_stamp:32;\n40| } info_message_t;\n</code></pre>\n\n<p>The errors are:</p>\n\n<pre><code>[18] error: [11705] syntax error before \"pause_states_t\"\n[18] warning: [11407] no semicolon at end of struct or union\n[19] error: [11707] syntax error before ':' token\n[20] error: [11707] syntax error before ':' token\n[21] error: [11707] syntax error before ':' token\n[24] error: [11707] syntax error before ':' token\n[25] error: [11707] syntax error before ':' token\n[26] error: [11707] syntax error before ':' token\n[27] error: [11707] syntax error before ':' token\n[28] error: [11707] syntax error before ':' token\n[29] error: [11707] syntax error before ':' token\n[30] error: [11707] syntax error before ':' token\n[31] error: [11707] syntax error before ':' token\n[32] error: [11707] syntax error before ':' token\n[33] warning: [13263] type defaults to 'int' in declaration of 'd2101_equip_states_t'\n[33] warning: [10516] data definition has no type or storage class\n[37] error: [11705] syntax error before \"info_level_t\"\n[37] warning: [11407] no semicolon at end of struct or union\n[39] error: [11707] syntax error before ':' token\n[40] warning: [13263] type defaults to 'int' in declaration of 'info_message_t'\n[40] warning: [10516] data definition has no type or storage class\n</code></pre>\n\n<p><strong>HOWEVER...</strong>\nIn many, many other instances, including some before and after in the same file, I use the same syntax with no errors and hence my confusion on what is going wrong.  E.G.</p>\n\n<pre><code>typedef struct rmt2001_feedback_to_remote_t{\n  uint8_t               screen_number;\n  bool                  fault_present:1;\n  switch_states_t       DC:1;\n  switch_states_t       air:1;\n  switch_states_t       HYDR:1;\n  switch_states_t       TUC:1;\n  switch_states_t       BE:1;\n  switch_states_t       TC:1;\n  switch_states_t       green_backlight:1;\n  source_dest_t         dest:3;\n  equip_states_t        status:3;\n  switch_states_t       red_backlight:1;\n  switch_states_t       blue_backlight:1;\n  uint8_t               gate_percent;\n  uint8_t               bin_percent;\n  uint8_t               BE_amps_msb;\n  uint8_t               BE_amps_lsb;\n  uint8_t               not_used;\n} rmt2001_feedback_to_remote_t;\n\ntypedef struct IO_view_t{\n  master_or_slave_t     master_or_slave:1;\n  uint8_t               exponent:3;\n  uint8_t               controller_id:4;\n  uint8_t               io_id:6;\n  A_of_D_t              A_or_D:1;\n  I_or_O_t              I_or_O:1;\n  uint16_t              raw;\n  int16_t               value;\n} IO_view_t;\n</code></pre>\n\n<p>If I remember correctly what I have read elsewhere on this site is that structure bit packing isn't very consistent between compilers as it's not clearly/strictly defined by c standard.  I also read that using bitwise operations with masks and offsets is a more cross platform friendly way of doing bit packing and failing anything else I can do that.... But I want to know why this doesn't work in only these two instances and I am hoping there is some simple little thing that will save me from having to do this.</p>\n\n<p>Thank you everyone for your time in reading this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1553095651, "post_id": 55264390, "comment_id": 97260248, "body": "Note that <code>(void *)i + 1</code> is illegal in standard C."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1553095653, "post_id": 55264390, "comment_id": 97260250, "body": "You&#39;re not passing a valid pointer to the thread function.  You sort of, mostly, almost get away with the misuse of it in the <code>printf()</code> call in <code>robotAct()</code>; you emphatically do not get away with it in the call to <code>Learning()</code> where you dereference the invalid non-pointer."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1553118633, "last_edit_date": 1553118633, "creation_date": 1553096384, "answer_id": 55264707, "question_id": 55264390, "link": "https://stackoverflow.com/questions/55264390/why-do-i-keep-getting-segmentation-fault-in-my-c-program/55264707#55264707", "title": "Why do I keep getting segmentation fault in my C program", "body": "<p>The main issue is explained in my comment:</p>\n\n<blockquote>\n  <p>You're not passing a valid pointer to the thread function.  You sort of, mostly, almost get away with the misuse of it in the <code>printf()</code> call in <code>robotAct()</code>; you emphatically do not get away with it in the call to <code>Learning()</code> where you dereference the invalid non-pointer.</p>\n</blockquote>\n\n<p>A solution is to create an array of integers in the main program which holds robot ID numbers (<code>int id[N];</code>). Then, initialize each element and pass <code>&amp;id[i]</code> to <code>pthread_create()</code>.  </p>\n\n<p>You should not print addresses with the <code>%d</code> format (even though it works on 32-bit systems; it does not work on 64-bit systems). The correct technique is to use <code>%p</code> to format the address. Or, in this case, print the integer and not the address using <code>*robot_id</code>.</p>\n\n<p>The code that follows has minimal adaptations to the original code and has not been compiled or tested (there could be problems outside the lines changed):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define N 5\n#define M 3\n#define LEFT (robot_id - 1) % N\n#define RIGHT (robot_id + 1) % N\n\npthread_t robots_id[N];\nsem_t simulations[M];\npthread_mutex_t sever_mutex;\n\nvoid Learning(int robot_id)\n{\n    printf(\"learning robot = %d\\n\", robot_id);\n}\n\nvoid *robotAct(void *id)\n{\n    int *robot_id = id;\n    printf(\"robot id = %d\\n\", *robot_id);        // Changed\n    Learning(*robot_id);\n    return 0;                                    // Added\n}\n\nint main(int argc, char *argv[])\n{\n    int E, T;\n    int id[N];                                   // Added\n\n    E = atoi(argv[1]);\n    T = atoi(argv[2]);\n\n    printf(\"Initializing Robot!\\n\");\n\n    //Initializes the simulations\n    for (int i = 0; i &lt; M; i++)\n    {\n        sem_init(&amp;simulations[i], 0, 0);\n    }\n\n    //Initializes the robots\n    for (int i = 0; i &lt; N; i++)\n    {\n        printf(\"Robot %d is created\\n\", i + 1);\n        id[i] = i + 1;                                          // Added\n        pthread_create(&amp;robots_id[i], NULL, robotAct, &amp;id[i]);  // Changed\n    }\n\n    sleep(T);\n\n    printf(\"Terminating Robots\\n\");\n    for (int i = 0; i &lt; N; i++)\n    {\n        pthread_cancel(robots_id[i]);\n    }\n    printf(\"Termination is completed!\\n\");\n    printf(\"-------Report-------------\\n\");\n    //getReport();\n    return 0;\n}\n</code></pre>\n\n<p>Avoid using <code>pthread_cancel()</code> for ending the threads; the threads should terminate under control.  For example, there might be a flag that you set in the main thread to indicate that the threads should cease, and they'd check that periodically. Normally, <code>pthread_join()</code> is used to clean up the completed threads.</p>\n\n<p>For future posts, please read about how to create an MCVE (<a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, Verifiable Example</a>).  There are parts of the code shown that are not relevant to the problem \u2014 the mutex and the semaphores, for example, are not really used.</p>\n"}], "owner": {"reputation": 37, "user_id": 10835819, "user_type": "registered", "profile_image": "https://graph.facebook.com/2014836551897434/picture?type=large", "display_name": "Thanakorn Pasangthien Ming", "link": "https://stackoverflow.com/users/10835819/thanakorn-pasangthien-ming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553118633, "creation_date": 1553095471, "last_edit_date": 1553112111, "question_id": 55264390, "link": "https://stackoverflow.com/questions/55264390/why-do-i-keep-getting-segmentation-fault-in-my-c-program", "title": "Why do I keep getting segmentation fault in my C program", "body": "<p>I've been trying to implement thread synchronization on C. However, I keep getting the segmentation fault when my invoke the function that I want the thread to execute. So anyone can suggest the solution on for this problem?</p>\n\n<p>Here is my code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#define N 5\n#define M 3\n#define LEFT (robot_id - 1) % N\n#define RIGHT (robot_id + 1) % N\n\npthread_t robots_id[N];\nsem_t simulations[M];\npthread_mutex_t sever_mutex;\n\nvoid Learning(int robot_id)\n{\n    printf(\"learning robot = %d\\n\", robot_id);\n}\n\nvoid *robotAct(void *id)\n{\n    int *robot_id = id;\n    printf(\"robot id = %d\\n\", robot_id);\n    Learning(*robot_id);\n}\n\nint main(int argc, char *argv[])\n{\n    int E, T;\n\n    E = atoi(argv[1]);\n    T = atoi(argv[2]);\n\n    printf(\"Initializing Robot!\\n\");\n\n    //Initializes the simulations\n    for (int i = 0; i &lt; M; i++)\n    {\n        sem_init(&amp;simulations[i], 0, 0);\n    }\n\n    //Initializes the robots\n    for (int i = 0; i &lt; N; i++)\n    {\n        printf(\"Robot %d is created\\n\", i + 1);\n        pthread_create(&amp;robots_id[i], NULL, robotAct, (void *)i + 1);\n    }\n\n    sleep(T);\n\n    printf(\"Terminating Robots\\n\");\n    for (int i = 0; i &lt; N; i++)\n    {\n        pthread_cancel(robots_id[i]);\n    }\n    printf(\"Termination is completed!\\n\");\n    printf(\"-------Report-------------\\n\");\n    //getReport();\n    return 0;\n}\n</code></pre>\n\n<p>Here is my result that I keep getting</p>\n\n<pre><code>Initializing Robot!\nRobot 1 is created\nRobot 2 is created\nRobot 3 is created\nrobot id = 1\nrobot id = 2\nRobot 4 is created\nrobot id = 3\n[1]    54477 segmentation fault  ./project 5 10\n</code></pre>\n"}, {"tags": ["c", "optimization", "clang", "undefined-behavior", "strict-aliasing"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553095581, "post_id": 55264205, "comment_id": 97260202, "body": "&quot;3 A program that is correct in all other aspects, operating on correct data, containing unspecified behavior shall be a correct program and act in accordance with 5.1.2.3.&quot;... it is not said anywhere that a program containing <b>undefined</b> behaviour is a correct program."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553095766, "post_id": 55264205, "comment_id": 97260342, "body": "Surely the main example can be simplified to something more easily manageable while still expressing the relevant details."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553096168, "post_id": 55264205, "comment_id": 97260627, "body": "In fact, as presented, the code has structures and characteristics that seem intended specifically to obfuscate."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553096515, "post_id": 55264205, "comment_id": 97260868, "body": "@JohnBollinger I guess, the program is a stripped down variant of something bigger and written in this way to provide a MCVE"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553096549, "post_id": 55264205, "comment_id": 97260899, "body": "Is the <code>longjmp</code> essential to the bug? I don&#39;t have Clang 7.1..."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553096773, "post_id": 55264205, "comment_id": 97261062, "body": "Yes, the test was extracted and simplified as possible from one real project . (The project was obfuscated.)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1553096775, "post_id": 55264205, "comment_id": 97261064, "body": "But that&#39;s just the point, @ensc: it is <i>not</i> an MCVE, or at least it doesn&#39;t seem to be one."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553096882, "post_id": 55264205, "comment_id": 97261135, "body": "I got -1, -1 in Clang 6.0, so at least reproducible."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553097163, "post_id": 55264205, "comment_id": 97261357, "body": "@JohnBollinger it is a) minimal, b) complete, c) verificable and d) an example.  So why do you think it is not an MCVE?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553097359, "post_id": 55264205, "comment_id": 97261505, "body": "I&#39;ve removed the <code>while</code> after the function pointer call, and it didn&#39;t have any effect..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 1, "creation_date": 1553097418, "post_id": 55264205, "comment_id": 97261540, "body": "@ensc So this is not <b>minimal</b>. I&#39;ve got the behaviour with clang 6.0.0 and removing the while loop, function <i>pointer</i> dereference, etc..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553097614, "post_id": 55264205, "comment_id": 97261687, "body": "<code>longjmp</code> is not needed either."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "edited": false, "score": 0, "creation_date": 1553098277, "post_id": 55264205, "comment_id": 97262106, "body": "@ensc, it should be possible also to reduce the single-trip loops to linear code, to remove the conditional compilation directives, and possibly more.  If removing any of that affects the observed behavior, then it is important for the OP to call specific attention to that."}, {"owner": {"reputation": 5867, "user_id": 2252087, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/020cbe41b02f03d59f3adae022c0ce7d?s=128&d=identicon&r=PG", "display_name": "ensc", "link": "https://stackoverflow.com/users/2252087/ensc"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553098338, "post_id": 55264205, "comment_id": 97262168, "body": "@JohnBollinger  true; sorry.  I was focused on the <code>sigjmp()</code> but it can be reproduced with much less and more simple code indead."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553098560, "post_id": 55264205, "comment_id": 97262312, "body": "@\u041f\u0430\u0432\u0435\u043b do you agree that <a href=\"https://gist.github.com/ztane/ed60a0cf8b4fba4a318cabacfae493b6\" rel=\"nofollow noreferrer\">this code</a> reproduces the problem - it is much more a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and does focus more on the actual problem."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1553098591, "post_id": 55264205, "comment_id": 97262341, "body": "@JohnBollinger the loops seemed to be essential... also the array needed 4 elements as opposed to say 2..."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553098794, "post_id": 55264205, "comment_id": 97262484, "body": "All important information to be conveyed in the question, @AnttiHaapala, so that you and I don&#39;t need to perform the exercise that you just did."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553099342, "post_id": 55264205, "comment_id": 97262845, "body": "Thank you @Antti Haapala, your code is more better"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1553099402, "post_id": 55264205, "comment_id": 97262886, "body": "@\u041f\u0430\u0432\u0435\u043b but do you concur that it still reproduces the problem - if you can verify it yourself using your GCC, Clang, and if it does then please <a href=\"https://stackoverflow.com/posts/55264205/edit\">edit</a> this question to contain it - and for posterity, this is an exercise that <i>you</i> as the question author should do."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553104795, "post_id": 55264205, "comment_id": 97265945, "body": "@\u041f\u0430\u0432\u0435\u043b I am still waiting for your reply ... and action..."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553118216, "post_id": 55264205, "comment_id": 97272469, "body": "@AnttiHaapala I modified the question. Is it ok now?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553117956, "post_id": 55265273, "comment_id": 97272374, "body": "Added an example (4) with &quot;issue being visible at translation time&quot;. @JohnBollinger, may you to comment this example?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 1, "creation_date": 1553119267, "post_id": 55265273, "comment_id": 97272807, "body": "It&#39;s not clear to me exactly why example (4) is significant, it not appearing to be meaningfully related to any of the others.  But I have added some commentary about it."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553123266, "post_id": 55265273, "comment_id": 97274052, "body": "By example (4) I want to model situation with &quot;formal violation of strict-aliasing&quot; in &quot;unreachable statement location&quot;, I suppose both examples are equivalent modulo this property."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553123986, "post_id": 55265273, "comment_id": 97274263, "body": "Thus, if example (4) is valid, than example (3) is valid too."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553124914, "post_id": 55265273, "comment_id": 97274539, "body": "I modified example (3) to use longLongAssign function."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553125913, "post_id": 55265273, "comment_id": 97274811, "body": "Example (4) has no strict-aliasing violation, as I have already explained."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553126018, "post_id": 55265273, "comment_id": 97274845, "body": "Example (3) <i>does</i> (still) contain a strict-aliasing violation, therefore its behavior is undefined.  In particular, accessing an <code>int[4]</code> via an lvalue of type <code>long long</code> has undefined behavior regardless of the circumstances or whether the compiler can be expected to recognize it."}, {"owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553169213, "post_id": 55265273, "comment_id": 97289437, "body": "Argument &quot;ptr&quot; of function longLongAssing has type &quot;char *&quot;, condition &quot;cond&quot; is always false. That is why I suppose example (3) now doesn&#39;t violate strict-aliasing rule. Last version of example (3) is identical to example (4), isn&#39;t it?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "edited": false, "score": 0, "creation_date": 1553170557, "post_id": 55265273, "comment_id": 97290139, "body": "@\u041f\u0430\u0432\u0435\u043b, all of your followups have been variations on the same theme already presented in the question and answered here.  Although it may be that you can form a plausible argument for some alternative along these lines to avoid UB, what ultimately matters is what the <i>compiler</i> thinks.  You are best off avoiding code that compiler is at risk of interpreting as having UB, whether you think that would be a correct interpretation or not.  You happen to be exploring an area that is particularly open to varying interpretation, which is unwise."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1553119850, "last_edit_date": 1553119850, "creation_date": 1553097895, "answer_id": 55265273, "question_id": 55264205, "link": "https://stackoverflow.com/questions/55264205/clang-strict-aliasing-optimizations-vs-unreachable-code-violating-strict-aliasin/55265273#55265273", "title": "Clang strict-aliasing optimizations vs unreachable code violating strict-aliasing", "body": "<p>The expression statement</p>\n\n<blockquote>\n<pre><code>                    *(long long *)grp = 0;\n</code></pre>\n</blockquote>\n\n<p>has undefined behavior on account of accessing an object of type <code>int[4]</code> via an lvalue of different, incompatible type (<code>long long</code>) -- a strict-aliasing violation, as you observe in the question.  But that doesn't have to be limited to <em>runtime</em> behavior. The (potential) issue being visible at translation time, the translation-time behavior is undefined, too, and therefore so is the result of every execution.</p>\n\n<p>Or at minimum, that's an interpretation of the standard to which at least some compiler developers subscribe.  Some folks around here object to such interpretations, but that doesn't change the fact that you have to deal with them.</p>\n\n<p><strong>With regard to the update</strong></p>\n\n<p>Your example (4) has perfectly well-defined behavior.  The major considerations here are</p>\n\n<ul>\n<li><p>It is explicitly permitted to convert a value of one object-pointer type to a different object-pointer type.  There are caveats about alignment of the result, but C requires it always to work for conversion to <code>char *</code>, and it requires the reverse conversion to reproduce the original pointer value (which has no alignment issue if it was valid to begin with).</p></li>\n<li><p>It is permitted to access any object's representation via an lvalue of character type.  In other words, a <code>char *</code> is permitted to alias any part of any object, so even though you <em>don't</em> access anything directly through the <code>char *</code> values passed to <code>assign()</code>, a conforming compiler must assume that those pointers could alias any object in the program.</p></li>\n<li><p>A null pointer of any type can be converted to another object-pointer type, resulting in a null pointer of the target type.</p></li>\n<li><p>By use of the <code>type</code> argument to function <code>assign()</code> in a manner consistent with that function's implementation, the program ensures that each object involved is ultimately accessed (only) via an lvalue of its correct type.</p></li>\n</ul>\n\n<p>What optimizations the compiler might apply are irrelevant to this analysis.  It is the code you present to the compiler by which behavior, if defined, is established.  Supposing that the program has defined behavior, it is the <em>compiler's</em> responsibility to ensure that that behavior is exhibited by the program resulting from translation to an executable, and it may and does use its knowledge about its own implementation to provide for that.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "is_accepted": false, "score": 0, "last_activity_date": 1553521619, "creation_date": 1553521619, "answer_id": 55339268, "question_id": 55264205, "link": "https://stackoverflow.com/questions/55264205/clang-strict-aliasing-optimizations-vs-unreachable-code-violating-strict-aliasin/55339268#55339268", "title": "Clang strict-aliasing optimizations vs unreachable code violating strict-aliasing", "body": "<p>Thank you all for your comments! You've helped me to understand the problem much better.</p>\n\n<p>Just to clarify why I do this and what I really wanted:\nI am porting clang on some specific platform. So my goal here was to understand if this test (from our autogen test system) contains error, or rather it's clang compilation bug. On results of this discussion, I've submitted an llvm bug\n(<a href=\"https://bugs.llvm.org/show_bug.cgi?id=41178\" rel=\"nofollow noreferrer\">https://bugs.llvm.org/show_bug.cgi?id=41178</a>).</p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 61, "user_id": 10202693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a67e2137340883514b694610f7df032?s=128&d=identicon&r=PG", "display_name": "\u041f\u0430\u0432\u0435\u043b", "link": "https://stackoverflow.com/users/10202693/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1553521619, "creation_date": 1553094849, "last_edit_date": 1553124840, "question_id": 55264205, "link": "https://stackoverflow.com/questions/55264205/clang-strict-aliasing-optimizations-vs-unreachable-code-violating-strict-aliasin", "title": "Clang strict-aliasing optimizations vs unreachable code violating strict-aliasing", "body": "<p>I have a question about strict-aliasing and clang optimizations for one example.</p>\n\n<p>Let's consider the following example (1):</p>\n\n<pre><code>typedef void (*FTy)(void);\nFTy F = 0;\n(*F)();\n</code></pre>\n\n<p>It is an undefined behavior.</p>\n\n<p>Let's consider the example (2) below:</p>\n\n<pre><code>typedef void (*FTy)(void);\nstatic const FTy F = 0;\n\nvoid g( int flag)\n{\n    if ( flag )\n    {\n        (*F)();\n    }\n}\n\nint main( void)\n{\n    g( 0);\n    return (0);\n}\n</code></pre>\n\n<p>Indirect call by F is still \"undefined behavior\", but stands under always false condtion. So programm must be correct.</p>\n\n<p>Now let's consider the main example (3):\n(second edition: Thanks to @Antti Haapala simplified version)\n(third edition: using of always_inline)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#ifndef BUGGY\n#define BUGGY 1\n#endif\n\nstatic inline void __attribute__((always_inline)) longLongAssign( int cond, char *ptr)\n{\n    if ( cond )\n    {\n        *((long long *)ptr) = 0;\n    }\n}\n\nvoid funcA(int s, int g)\n{\n    int i, j = 0, k;\n    int grp[4] = {-1, -1};\n    void *ptr[2] = {(void *)&amp;(grp[0]), 0};\n\n    for (i = 0, k = 0; i &lt; 1; ++i) {\n        for (j = 0; j &lt; 1; ++j) {\n            if ( grp[g] &gt; 0 )\n            {\n                if ( g &gt; 5 )\n                {\n                    continue;\n\n                } else\n                {\n                    longLongAssign( g &gt; 3, (char *)ptr[0]);\n                }\n            }\n            grp[k++] = 0;\n        }\n        printf(\"this should be zero: %d\\n\", grp[0]);\n    }\n}\n\nint main(void) {\n    funcA(0, 1);\n}\n</code></pre>\n\n<p>Compile by gcc and execute</p>\n\n<pre><code>this should be zero: 0\n</code></pre>\n\n<p>Compile by \"clang-7.0 -O0\" and execute</p>\n\n<pre><code>this should be zero: 0\n</code></pre>\n\n<p>Compile by \"clang-7.0 -O1 -fno-strict-aliasing\" and execute</p>\n\n<pre><code>this should be zero: 0\n</code></pre>\n\n<p>Compile by \"clang-7.0 -O1\" and execute</p>\n\n<pre><code>this should be zero: -1\n</code></pre>\n\n<p>In the main example one of stores to grp formally violates strict-aliasing</p>\n\n<pre><code>        *((long long *)ptr) = 0;\n</code></pre>\n\n<p>But this store stands under always false condition.</p>\n\n<p>The question here is: how a store operation</p>\n\n<ul>\n<li>violating breaking strict-aliasing rule</li>\n<li>but located in unreachable statement</li>\n</ul>\n\n<p>may affect any way to program execution?</p>\n\n<p>Is it correct by C language standart?</p>\n\n<p>Is an example (4) below correct, well defined and hasn't undefined behavior?</p>\n\n<pre><code>void assign( int type, char *ptr)\n{\n    if ( ptr )\n    {\n        if ( (type == 0) )\n        {\n            *((int *)ptr) = 1;\n\n        } else if ( (type == 1) )\n        {\n            *((float *)ptr) = 1;\n        } else\n        {\n            // unknown type\n        }\n     }\n }\n\n int main( void)\n {\n     int a;\n     float b;\n\n     assign( 0, (char *)&amp;a);\n     assign( 1, (char *)&amp;b);\n     assign( 0, (char *)0);\n\n     return (0);\n }\n</code></pre>\n\n<p>Inline and constant propagation optimizations in function main gives</p>\n\n<pre><code>    ...\n    if ( &amp;a )\n    {\n        if ( (0 == 0) )\n        {\n            *((int *)&amp;a) = 1;\n\n        } else if ( (0 == 1) )\n        {\n            *((float *)&amp;a) = 1;\n        } else\n        {\n            // unknown type\n        }\n    }\n    ...\n</code></pre>\n\n<p>In one hand store operation</p>\n\n<pre><code>            *((float *)&amp;a) = 1;\n</code></pre>\n\n<p>formally violates strict-aliasing, but stands in unreacheble location.</p>\n\n<p>Which reasons example (4) may be incorrect?\nIf example (4) is correct so why example (3) gives by clang compilation different results?</p>\n"}, {"tags": ["c", "performance", "optimization", "cpu", "scientific-computing"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1553095194, "post_id": 55264171, "comment_id": 97259942, "body": "Isn&#39;t <code>clock_gettime</code> measuring the real time consumed by <i>all</i> of the processes that are running in parallel? You want to measure the processor tie consumed by your process only (such as <a href=\"https://linux.die.net/man/3/clock\" rel=\"nofollow noreferrer\">linux.die.net/man/3/clock</a>)"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1553095586, "post_id": 55264171, "comment_id": 97260208, "body": "So,instead you should use <code>getrusage()</code> (or use <code>time</code> or <code>times</code>)"}, {"owner": {"reputation": 1357, "user_id": 773102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/St5U2.gif?s=128&g=1", "display_name": "Jonny Schubert", "link": "https://stackoverflow.com/users/773102/jonny-schubert"}, "edited": false, "score": 1, "creation_date": 1553095601, "post_id": 55264171, "comment_id": 97260217, "body": "Have a look here: <a href=\"https://stackoverflow.com/questions/7215764/how-to-measure-the-actual-execution-time-of-a-c-program-under-linux\" title=\"how to measure the actual execution time of a c program under linux\">stackoverflow.com/questions/7215764/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553099996, "post_id": 55264171, "comment_id": 97263227, "body": "Servers run <i>many</i> processes in parallel. Does it explain the difference?"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553100200, "post_id": 55264171, "comment_id": 97263344, "body": "@EugeneSh. Eh... not really? This server is owned by me and me only, so I can confirm that only this program is running during that period, if we ignore deamons and stuff that takes ~0.1% CPU time. Also, my server has 12 cores, so it could use the rest 11 cores to do other things."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553100950, "post_id": 55264171, "comment_id": 97263781, "body": "This <code>volatile</code> looks suspect to me."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553101159, "post_id": 55264171, "comment_id": 97263920, "body": "@wildplasser I <i>could</i> remove that <code>volatile</code> and print the stuff in <code>node_num_by_depth</code> instead, as I did before the edit, but doing so will fill the screen will meaningless numbers irrelevant to my question. I would say the sole purpose of this <code>volatile</code> is to prevent the compiler from optimizing everything out (as these computations have no side effect)."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553101288, "post_id": 55264171, "comment_id": 97263986, "body": "The references to the array are aliased, so the compiler should know."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553101442, "post_id": 55264171, "comment_id": 97264087, "body": "@wildplasser I have no idea what &quot;aliased&quot; mean, but I assume you are saying it&#39;s safe to remove the <code>volatile</code> qualifier? Let me remove it and see if it makes any difference."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553101697, "post_id": 55264171, "comment_id": 97264234, "body": "Oh, and the machines could have different caches, and the compilers could align things differently."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1553102796, "post_id": 55264171, "comment_id": 97264884, "body": "@wildplasser Yeah that was my first suspect too! But after checking the specification, I realized my server has much larger caches than my MacBook Pro. I have edited the question to include more information."}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1553109442, "post_id": 55264171, "comment_id": 97268253, "body": "Could it be that your MacBook pro is running with larger pages? You could be experiencing TLB thrashing if this is the case.  Also if the cache hierarchy in the MacBook is much simpler, you could be experiencing the accumulated effect of the various misses on the extra cache levels. Since your memory access is mostly random over a large memory range, your caches must be innefective most of the time; the more cache levels, the longer it would take to hit main memory."}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1553111572, "post_id": 55264171, "comment_id": 97269297, "body": "Rewording, my comment, you could be experiencing TLB thrashing IN YOUR SERVER if the virtual page size is configured to be smaller than in your MacBook."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1553127981, "post_id": 55264171, "comment_id": 97275300, "body": "@BlueStrat Paging could be a factor, but from my <b>Edit III</b> you can tell it didn&#39;t make so much difference. This could be used to explain the remaining 0.2x slowdown, though. (BTW: how can I get info about the TLB? It appears to be a rarely-mentioned piece of  hardware...)"}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1553130765, "post_id": 55264171, "comment_id": 97275884, "body": "Glad to read that you found the bottleneck.  Here is an excellent <a href=\"https://lwn.net/Articles/374424/\" rel=\"nofollow noreferrer\">series of articles</a> describing in great length how the TLB works, how it can be profiled and how using larger pages reduces TLB pressure at the cost of less granularity and more expensive virtual memory paging."}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1553127808, "creation_date": 1553094755, "last_edit_date": 1553127808, "question_id": 55264171, "link": "https://stackoverflow.com/questions/55264171/program-runs-10x-slower-on-2-5ghz-xeon-than-2-3ghz-core-i5", "title": "Program runs 10x slower on 2.5GHz Xeon than 2.3GHz Core i5", "body": "<p>I am doing some Monte Carlo simulations with the following code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/resource.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;time.h&gt;\n\n#define L 20\n#define N 200000\n\n\nint main() {\n    struct timespec ts_start, ts_end;\n    clock_t clk_start, clk_end;\n    struct rusage usage;\n    struct timeval tv_ustart, tv_uend;\n    struct timeval tv_sstart, tv_send;\n\n    clock_gettime(CLOCK_MONOTONIC, &amp;ts_start);\n    clk_start = clock();\n    getrusage(RUSAGE_SELF, &amp;usage);\n    tv_ustart = usage.ru_utime;\n    tv_sstart = usage.ru_stime;\n\n    /* \n     * the runtime of one simulation may vary a lot, so let's repeat it many times.\n     */\n    for (int iteration = 0; iteration &lt; N; iteration += 1) {\n        int node_num_by_depth[L + 1] = {1};\n\n        for (int level = 0; level &lt; L; level += 1) {\n            for (int depth = level; depth != -1; depth -= 1) {\n                int parent_num = node_num_by_depth[depth];\n                node_num_by_depth[depth] = 0;\n                for (int parent = 0; parent &lt; parent_num; parent += 1) {\n                    int child_num = 1 + arc4random() % 2;\n                    int child_depth = depth + (child_num &gt; 1);\n                    node_num_by_depth[child_depth] += child_num;\n                }\n            }\n        }\n    }\n\n    clock_gettime(CLOCK_MONOTONIC, &amp;ts_end);\n    clk_end = clock();\n    getrusage(RUSAGE_SELF, &amp;usage);\n    tv_uend = usage.ru_utime;\n    tv_send = usage.ru_utime;\n\n\n    double elapsed = (double) (ts_end.tv_sec - ts_start.tv_sec)\n                     + (double) (ts_end.tv_nsec - ts_start.tv_nsec) / 1E9;\n    printf(\"Wall clock time elapsed: %g\\n\", elapsed);\n\n    double cpu_time_used = ((double) (clk_end - clk_start)) / CLOCKS_PER_SEC;\n    printf(\"CPU time elapsed: %g\\n\", cpu_time_used);\n\n    printf(\"User CPU time elapsed: %lu.%06u\\n\",\n           tv_uend.tv_sec - tv_ustart.tv_sec,\n           tv_uend.tv_usec - tv_ustart.tv_usec);\n\n    printf(\"System CPU time elapsed: %lu.%06u\\n\",\n           tv_send.tv_sec - tv_sstart.tv_sec,\n           tv_send.tv_usec - tv_sstart.tv_usec);\n}\n</code></pre>\n\n<p>When running on my <a href=\"https://support.apple.com/kb/SP754?locale=en_US&amp;viewlocale=en_US\" rel=\"nofollow noreferrer\">MacBook Pro</a> with <code>2.3GHz dual-core Intel Core i5, Turbo Boost up to 3.6GHz, with 64MB of eDRAM</code>, the output is</p>\n\n<pre><code>Wall clock time elapsed: 32.408\nCPU time elapsed: 32.3566\nUser CPU time elapsed: 32.319151\nSystem CPU time elapsed: 32.319114\n</code></pre>\n\n<p>When running on my FreeBSD server with <code>CPU: Intel(R) Xeon(R) Platinum 8163 CPU @ 2.50GHz (2499.96-MHz K8-class CPU)</code>, it gives me</p>\n\n<pre><code>Wall clock time elapsed: 396.563\nCPU time elapsed: 396.414\nUser CPU time elapsed: 158.377633\nSystem CPU time elapsed: 158.376629\n</code></pre>\n\n<p>In both cases, the compilation instruction I used is <code>clang main.c -Ofast -march=native -o main</code>.</p>\n\n<p>Initially, the server was running Ubuntu 18.04, but I switched to FreeBSD after realizing that my program runs ridiculously slow. However, even on FreeBSD (where <code>arc4random</code> is provided natively), it is still significantly less efficient. Now, unless there is a very good reason, I don't want to switch to a new OS again.</p>\n\n<p>I have profiled the program with <code>gprof</code>, and you can find the result <a href=\"https://pastebin.com/u7nuiqsQ\" rel=\"nofollow noreferrer\">here</a>. We can see <code>arc4random</code> is taking quite a lot of time (30.8%), but this can't be the sole reason for a tenfold performance penalty.</p>\n\n<hr>\n\n<p>I have added some other measures of time as pointed out by the comments. You can see there is a huge gap between the wall clock time and the CPU time. Can I narrow it? Anyway, what I care is how long it takes to execute my program, instead of how many CPU cycles it takes.</p>\n\n<hr>\n\n<p>Here is some extended information about my MacBook Pro</p>\n\n<pre><code>Hardware Overview:\n\n  Model Name: MacBook Pro\n  Model Identifier: MacBookPro14,1\n  Processor Name: Intel Core i5\n  Processor Speed: 2.3 GHz\n  Number of Processors: 1\n  Total Number of Cores: 2\n  L2 Cache (per Core): 256 KB\n  L3 Cache: 4 MB\n  Memory: 8 GB\n  Boot ROM Version: 184.0.0.0.0\n  SMC Version (system): 2.43f6\n  Serial Number (system): XXXXXXXXXXXX\n  Hardware UUID: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n</code></pre>\n\n<p>My server is equipped with twelve <a href=\"https://en.wikichip.org/wiki/intel/xeon_platinum/8163\" rel=\"nofollow noreferrer\">Intel Skylake Xeon Platinum 8163 2.5GHz</a> CPUs, whose specification is shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/rFYPR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rFYPR.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>I have a big find! After replacing <code>arc4random</code> with <code>random</code>, there is a huge performance gain on the server.</p>\n\n<ul>\n<li><p>MacBook Pro with <code>random</code></p>\n\n<pre><code>Wall clock time elapsed: 5.61316\nCPU time elapsed: 5.40623\nUser CPU time elapsed: 5.361931\nSystem CPU time elapsed: 5.359096\n</code></pre></li>\n<li><p>Server with <code>random</code></p>\n\n<pre><code>Wall clock time elapsed: 6.69183\nCPU time elapsed: 6.6875\nUser CPU time elapsed: 6.690042\nSystem CPU time elapsed: 6.689085\n</code></pre></li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553092918, "post_id": 55263404, "comment_id": 97258252, "body": "And what is and how is <code>arr_patient</code> declared?"}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 1, "creation_date": 1553092958, "post_id": 55263404, "comment_id": 97258286, "body": "Could you post a fully functional example of your code and example input for your program?"}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553093379, "post_id": 55263404, "comment_id": 97258615, "body": "@KamilCuk Ooh, sry didnt mention that ( stupid me). the array is declared as &quot;Pat arr_patient[Max], in which Max is defined to a five thousands and &quot;Pat&quot; is actually a typedefed struct, Pat = struct patient. The whole code itself is quite large (approx, 200 lines) so at first at hesitated in uploading it SimonDoppler, but I can upload it if you insist."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1553093517, "post_id": 55263404, "comment_id": 97258713, "body": "Seems you only write to the file once (for <code>i=0</code>) - you need a loop..."}, {"owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1553093716, "post_id": 55263404, "comment_id": 97258863, "body": "@4386427 isnt the do while loop enough? Or do I need a for loop too? Doesnt the for loop loop for a predetermined amount of times? If so, thats not gonna work cuz I want the user to quit the loop whenever it wants."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1553094190, "post_id": 55263404, "comment_id": 97259229, "body": "@LesterCrest No. The code that writes to the file is outside the loop so it only write one record to the file."}], "answers": [{"tags": [], "owner": {"reputation": 1391, "user_id": 2318073, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/959695710b096f3c939271b20f307669?s=128&d=identicon&r=PG", "display_name": "Ameen", "link": "https://stackoverflow.com/users/2318073/ameen"}, "is_accepted": true, "score": 1, "last_activity_date": 1553093641, "creation_date": 1553093641, "answer_id": 55263775, "question_id": 55263404, "link": "https://stackoverflow.com/questions/55263404/how-to-add-keep-asking-for-user-input-and-save-all-input-to-file/55263775#55263775", "title": "How to add keep asking for user input and save all input to file", "body": "<p>This is how it should be done (I embedded notes about the problems in the code)</p>\n\n<pre><code>char answer;\n// NOTE: this must be outside the loop\nint i=0;\ndo\n{\n    printf(\" Enter details of patient %d\\n\\n\", i+1);\n\n    printf(\" Patients first name: \");\n    scanf(\"%s\",arr_patient[i].fname);\n    printf(\" Last name: \");\n    scanf(\"%s\",arr_patient[i].lname);\n    printf(\" Personnummer: \");\n    scanf(\"%d\", &amp;arr_patient[i].birthdate);\n    printf(\" Bildref: \");\n    scanf(\"%d\", &amp;arr_patient[i].bildref);\n\n    printf(\" Do you want to add someone else?: (y/n):\");\n        scanf(\" %c\",&amp;answer);\n\n    i++;\n\n}while(answer != 'n');\n\nFILE *patientfile = fopen(\"test.txt\", \"a\");\nif (!patientfile) printf(\" Failed to open file.\\n\");\n\n// NOTE: You need to loop over the array and write all the patients to the file\nfor(int j=0; j&lt;i; j++)\n{\n    fprintf(patientfile,\" %s\\t%s \\n \", arr_patient[j].fnamn,arr_patient[j].lnamn);\n    fprintf(patientfile,\" %d \\n\",arr_patient[j].birthdate);\n    fprintf(patientfile,\" %d \\n\",arr_patient[j].bildref);\n}\nfclose(patientfile);\n</code></pre>\n\n<p>But you don't actually need the array. You can write the patients to the file directly like this:</p>\n\n<pre><code>FILE *patientfile = fopen(\"test.txt\", \"a\");\nif (!patientfile) printf(\" Failed to open file.\\n\");\nchar answer;\nint i=0;\ndo\n{\n    // change patient_struct to your structure name\n    patient_struct patient;\n    printf(\" Enter details of patient %d\\n\\n\", i+1);\n\n    printf(\" Patients first name: \");\n    scanf(\"%s\",patient.fname);\n    printf(\" Last name: \");\n    scanf(\"%s\",patient.lname);\n    printf(\" Personnummer: \");\n    scanf(\"%d\", &amp;patient.birthdate);\n    printf(\" Bildref: \");\n    scanf(\"%d\", &amp;patient.bildref);\n\n    fprintf(patientfile,\" %s\\t%s \\n \", patient.fnamn, patient.lnamn);\n    fprintf(patientfile,\" %d \\n\", patient.birthdate);\n    fprintf(patientfile,\" %d \\n\", patient.bildref);\n\n    printf(\" Do you want to add someone else?: (y/n):\");\n        scanf(\" %c\",&amp;answer);\n\n    i++;\n\n}while(answer != 'n');\nfclose(patientfile);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 0, "last_activity_date": 1553094091, "last_edit_date": 1553094091, "creation_date": 1553093684, "answer_id": 55263789, "question_id": 55263404, "link": "https://stackoverflow.com/questions/55263404/how-to-add-keep-asking-for-user-input-and-save-all-input-to-file/55263789#55263789", "title": "How to add keep asking for user input and save all input to file", "body": "<p>I see two problems:</p>\n\n<p>You are setting <code>i</code> to zero in every loop:</p>\n\n<pre><code>do\n{\n    int i=0;\n</code></pre>\n\n<p>so all reading goes to array index zero. Move the initialization out of the loop:</p>\n\n<pre><code>int i=0;\ndo\n{\n</code></pre>\n\n<p>so that the first record will be stored at array index 0, the second record at array index 1 and so on.</p>\n\n<p>Further, you need a loop when writing to the file. Currently you only write one record. To write all records do something like:</p>\n\n<pre><code>for (int j = 0; j&lt;i; ++j)\n{\n    fprintf(patientfile,\" %s\\t%s \\n \", arr_patient[j].fnamn,arr_patient[j].lnamn);\n    fprintf(patientfile,\" %d \\n\",arr_patient[j].birthdate);\n    fprintf(patientfile,\" %d \\n\",arr_patient[j].bildref);\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11057650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/94qCI.jpg?s=128&g=1", "display_name": "Lester Crest", "link": "https://stackoverflow.com/users/11057650/lester-crest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 55263775, "answer_count": 2, "score": 1, "last_activity_date": 1553176024, "creation_date": 1553092751, "last_edit_date": 1553176024, "question_id": 55263404, "link": "https://stackoverflow.com/questions/55263404/how-to-add-keep-asking-for-user-input-and-save-all-input-to-file", "title": "How to add keep asking for user input and save all input to file", "body": "<p>EDIT: Problem fixed! Thanks everyone!</p>\n"}, {"tags": ["c", "file", "count", "char", "numbers"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 3, "creation_date": 1553092771, "post_id": 55263334, "comment_id": 97258121, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\" title=\"why is while feoffile always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553093095, "post_id": 55263334, "comment_id": 97258385, "body": "are <code>chars</code> and <code>words</code> initialized to 0?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553093103, "post_id": 55263334, "comment_id": 97258395, "body": "I suggest you refrain from using obscene language in SO posts. Edited it for now."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553093118, "post_id": 55263334, "comment_id": 97258409, "body": "I never see you get someting from <code>f</code>."}, {"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 0, "creation_date": 1553093491, "post_id": 55263334, "comment_id": 97258690, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Never ever write <code>while (!feof(f))</code>. It&#39;s always wrong."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1553094738, "post_id": 55263334, "comment_id": 97259635, "body": "Are you opening in text or binary mode?"}], "answers": [{"comments": [{"owner": {"reputation": 1975, "user_id": 6070341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHHZU.png?s=128&g=1", "display_name": "Costantino Grana", "link": "https://stackoverflow.com/users/6070341/costantino-grana"}, "edited": false, "score": 2, "creation_date": 1553093834, "post_id": 55263753, "comment_id": 97258964, "body": "<code>while (c=fgetc(f))</code> doesn&#39;t stop at EOF. Shouldn&#39;t it be <code>while ((c=fgetc(f))!=EOF)</code>?"}, {"owner": {"reputation": 3, "user_id": 11232585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ioGq.jpg?s=128&g=1", "display_name": "Kouler", "link": "https://stackoverflow.com/users/11232585/kouler"}, "edited": false, "score": 0, "creation_date": 1553324444, "post_id": 55263753, "comment_id": 97349996, "body": "and, of course, that doesn&#39;t mean, if you count space-chars, you have new words. You should see, if the last char was space and current is not. Then you will have the real number of words;)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1553094353, "last_edit_date": 1553094353, "creation_date": 1553093589, "answer_id": 55263753, "question_id": 55263334, "link": "https://stackoverflow.com/questions/55263334/count-the-number-of-characters-in-c/55263753#55263753", "title": "count the number of characters in C", "body": "<p>In my opinion, the following would suffice:</p>\n\n<pre><code>int c; \nwhile ((c=fgetc(f))!=EOF) {\n    if (c == ' ' || c=='\\n') {\n         words++;\n    } \n    else {\n        chars++;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11232585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ioGq.jpg?s=128&g=1", "display_name": "Kouler", "link": "https://stackoverflow.com/users/11232585/kouler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55263753, "answer_count": 1, "score": -1, "last_activity_date": 1553094353, "creation_date": 1553092600, "last_edit_date": 1553093141, "question_id": 55263334, "link": "https://stackoverflow.com/questions/55263334/count-the-number-of-characters-in-c", "title": "count the number of characters in C", "body": "<p>I need just to count the number of chars in my 'f' file. When I count a number of chars in one string, I get the real number of it, but when I press 'enter' in my .txt and creating a new line I lose 2 chars. So, having 4 strings with 15 chars at all,my program telling me that there are only 9 chars in the file. Help me please to, just, count this unfortunate chars...<br>\nHere is a code in C:</p>\n\n<pre><code>while (!feof(f)) {\n    bool space = 1; //remembering last char (was it space or not)\n    for (int i = 0; i &lt; len; ++i) { //running till the end of string\n        if (a[i] == ' ') {space = 1;} \n        else if (a[i] != '\\0' &amp;&amp; a[i] != '\\n') {\n            chars++;\n            if (space == 1) {\n                words++; //and counting the words\n                space = 0;\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 4, "creation_date": 1553092888, "post_id": 55263322, "comment_id": 97258221, "body": "Each recursive call to <code>main</code> gets a new set of local variables. Also, you technically are not allowed to call <code>main</code>; only the system can do that."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1553093435, "post_id": 55263322, "comment_id": 97258656, "body": "@RaymondChen While not particularly elegant, calling <code>main</code> should be possible. Only C++ had a restriction on that if I recall correctly."}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1553093895, "post_id": 55263322, "comment_id": 97259005, "body": "Neither of these languages forbids recursive main&#39;s."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 2, "creation_date": 1553094212, "post_id": 55263322, "comment_id": 97259248, "body": "@KrzysztofSzewczyk: C does not forbid recursive <code>main()</code>; C++ does."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1553094219, "post_id": 55263322, "comment_id": 97259255, "body": "I formatted the code. It has useless blocks."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553094564, "post_id": 55263322, "comment_id": 97259494, "body": "<code>random= (rand() );</code> should be <code>random= (rand() %10000);</code> and <code>&quot;%04d&quot;</code> to print."}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553095157, "post_id": 55263322, "comment_id": 97259917, "body": "@JonathanLeffler alright then, not a C++ programmer."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553190791, "post_id": 55263322, "comment_id": 97302761, "body": "You state the problem is with the <code>pin()</code> function, but you never post that function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553190944, "post_id": 55263322, "comment_id": 97302835, "body": "since the functiion: <code>srand()</code> is never called, the posted code will always produce the same sequence of random numbers"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553191125, "post_id": 55263322, "comment_id": 97302933, "body": "OT: regarding: `for(i=0; i&lt;3; i++) random= (rand() );  why call the function 3 times, when only the last returned value is actually used?  BTW: this will return values in the range 0...RAND_MAX"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 11232626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af0dd3317ebbcc6ea1c44e64bbcdafa?s=128&d=identicon&r=PG&f=1", "display_name": "k1st", "link": "https://stackoverflow.com/users/11232626/k1st"}, "edited": false, "score": 0, "creation_date": 1553098508, "post_id": 55264292, "comment_id": 97262282, "body": "Thanks a bunch! I&#39;m new into programming and we recently got a project. Learned many things today. Thanks mate!"}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "reply_to_user": {"reputation": 89, "user_id": 11232626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af0dd3317ebbcc6ea1c44e64bbcdafa?s=128&d=identicon&r=PG&f=1", "display_name": "k1st", "link": "https://stackoverflow.com/users/11232626/k1st"}, "edited": false, "score": 0, "creation_date": 1553103659, "post_id": 55264292, "comment_id": 97265341, "body": "@Astik It would be nice if you checked the green mark to approve my answer."}], "tags": [], "owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1553095876, "last_edit_date": 1553095876, "creation_date": 1553095131, "answer_id": 55264292, "question_id": 55263322, "link": "https://stackoverflow.com/questions/55263322/this-program-doesnt-seem-to-update-the-value-and-verify-for-the-new-value/55264292#55264292", "title": "This program doesn&#39;t seem to update the value and verify for the new value", "body": "<h2>What's wrong there?</h2>\n\n<p>First of all, there is need to revisit the code. You reference to function called <code>pin()</code>, that source code we don't know. Next, we run into tiny conflict of names (<code>int pin;</code>, <code>int pin();</code>). There are way too many code blocks. Variables are named poorly (<code>new_pin</code> isn't new pin, <code>old_pin</code> isn't old). Loop for generating pin is useless as you override variable without storing old randoms. Multiline strings without <code>\\</code> in <code>printf</code>'s (and others) are forbidden (I spotted them somewhere near Your original code). <code>exit</code> is missing paranthesis. That's about syntax, code optimization and naming quality.</p>\n\n<p>The code is recursively calling main, and that's certainly not a good idea (unless You know, what You are doing!) </p>\n\n<h2>How to fix the code.</h2>\n\n<p>I've formatted it and removed <code>int pin();</code> declarations as they were redudant. Complexity of code blocks was reduced and unnecessary library imports were stripped. The for loop was simplified (as it was redudant). Code looks now like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    int pin, new_pin, old_pin = 1111;\n    printf(\"Enter your pin: \");\n    scanf(\"%d\", &amp;pin);\n    if (pin == old_pin)\n        printf(\"PIN succefully verified.\\n\");\n    else if (pin != old_pin) {\n        printf(\"PIN couldn't be verified.\\n\");\n        printf(\"Press 1 to generate a new pin, 2 to re-enter or 0 to exit\\n\");\n        new_pin = getchar();\n        if (new_pin == '1') {\n            int i, random;\n            printf(\"Your new pin is: %4d\\n\" rand() % 9999);\n            main();\n        } else if (new_pin=='2')\n            main();\n\n        else {\n            printf(\"Exiting the program....\\n\");\n            return 0;\n        }\n    }\n}\n</code></pre>\n\n<p>Now, let's implement the functionality was made incorrectly. New pin mechanism was broken so hard, there is no sense in explaining it. It's better to get brand new one. Values were staticized so they won't disappear after creating new local variable set is made.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    static int pin, new_pin, validPin = 1111;\n    printf(\"Enter your pin: \");\n    scanf(\"%d\", &amp;pin);\n    if (pin == validPin)\n        printf(\"PIN succefully verified.\\n\");\n    else if (pin != validPin) {\n        printf(\"PIN couldn't be verified.\\n\");\n        printf(\"Press 1 to generate a new pin, 2 to fall back or any other key to exit.\\n\");\n        new_pin = getchar();\n        if (new_pin == '1') {\n            validPin = rand() % 9999;\n            printf(\"Your new pin is: %4d.\\n\", validPin);\n            main();\n        } else if (new_pin=='2')\n            main();\n\n        else {\n            printf(\"Exiting the program.\\n\");\n            return 0;\n        }\n    }\n}\n</code></pre>\n\n<p>Now, let's revisit main recursion antipattern and divide the code into subprocedures.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint proc() {\n    /* ... the code in partially unmodified form goes here. */\n}\n\nint main(void) {\n    while(!proc());\n}\n</code></pre>\n\n<p>Finally, let's mess around with variable scope to reduce it to the absolute minimum and put exit message at the end of main. Code at the end looks like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint proc() {\n    int pin;\n    static int validPin = 1111;\n\n    printf(\"Enter your pin: \");\n    scanf(\"%d\", &amp;pin);\n    if (pin == validPin)\n        printf(\"PIN succefully verified.\\n\");\n    else if (pin != validPin) {\n        int command;\n        printf(\"PIN couldn't be verified.\\n\");\n        printf(\"Press 1 to generate a new pin, 2 to fall back or any other key to exit.\\n\");\n        command = getchar();\n        if (command == '1') {\n            validPin = rand() % 9999;\n            printf(\"Your new pin is: %4d.\\n\", validPin);\n            return 0;\n        } else if (command == '2')\n            return 0;\n        else \n            return 1;\n    }\n\n    return 1;\n}\n\nint main(void) {\n    while(!proc());\n    printf(\"Exiting the program.\\n\");\n}\n</code></pre>\n\n<p>As some online C compilers may incorrectly react to <code>getchar()</code>, just use <code>scanf()</code>, like You actually did:</p>\n\n<pre><code>        int command;\n        printf(\"PIN couldn't be verified.\\n\");\n        printf(\"Press 1 to generate a new pin, 2 to fall back or 0 to exit:\\n\");\n        scanf(\"%d\", &amp;command);\n        if (command == 1) {\n            validPin = rand() % 9999;\n            printf(\"Your new pin is: %4d.\\n\", validPin);\n            return 0;\n        } else if (command == 0)\n            return 1;\n          else\n            return 0;\n</code></pre>\n\n<h2>Appendix</h2>\n\n<p>My final code could have been improved by exploding god-procedure <code>proc()</code> into pin verifier and command handlers, but the application is simple enough to keep things concise. In your learning curve, this application example might be a nice piece of code to train refactoring skills.</p>\n\n<p>I hope my review helped you.</p>\n"}], "owner": {"reputation": 89, "user_id": 11232626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5af0dd3317ebbcc6ea1c44e64bbcdafa?s=128&d=identicon&r=PG&f=1", "display_name": "k1st", "link": "https://stackoverflow.com/users/11232626/k1st"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553095876, "creation_date": 1553092561, "last_edit_date": 1553094182, "question_id": 55263322, "link": "https://stackoverflow.com/questions/55263322/this-program-doesnt-seem-to-update-the-value-and-verify-for-the-new-value", "title": "This program doesn&#39;t seem to update the value and verify for the new value", "body": "<p>Here is a code i wrote for pin verification, but i cannot make the system verify the new pin. In this program, input is taken from user and is verified using the pre-defined pin. If the user fails to verify the code, then a new code is presented which is to be the new pin.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;strings.h&gt;\n#include&lt;windows.h&gt;\n\nint pin();  \n\nint main()\n{\n    int pin();\n    {\n        int pin,new_pin,old_pin;\n        {\n            old_pin=1111;\n            printf(\"Enter your pin: \");\n            scanf(\"%d\", &amp;pin);\n\n            if(pin==old_pin)\n            {\n                printf(\"PIN succefully verified \\n\");\n            }\n            else if(pin!=old_pin)\n            {\n                printf(\"PIN couldn't be verified. \\n\");\n\n                printf(\"Press 1 to generate a new pin, 2 to re-enter or 0 to exit\\n\");\n                scanf(\"%d\", &amp;new_pin);\n                if (new_pin==1)\n                {\n                    printf(\"Your new pin is: \\n\");\n                    //generating random 4numbered pin\n\n                    int i,random;\n                    for(i=0; i&lt;3; i++)\n                        random= (rand() );\n                    printf(\"%d\\n\", random);\n\n                    main();\n                    random=new_pin;\n                    new_pin=old_pin;\n                }\n                else if (new_pin==2) {\n                    main();\n                }\n                else{\n                    printf(\"Exiting the program....\\n\");\n                    exit;\n                }\n            }\n        }\n    }\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "uppercase"], "comments": [{"owner": {"reputation": 883, "user_id": 2430872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/793e55e6b48b610f1dd426e9d5bdfe9e?s=128&d=identicon&r=PG", "display_name": "Sanjeev S", "link": "https://stackoverflow.com/users/2430872/sanjeev-s"}, "edited": false, "score": 6, "creation_date": 1553091888, "post_id": 55263071, "comment_id": 97257445, "body": "Why cant u use toupper?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1553092061, "post_id": 55263071, "comment_id": 97257557, "body": "Post code that set and prints <code>parameters</code>."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1553092093, "post_id": 55263071, "comment_id": 97257580, "body": "<code>parameters</code> is a typedef and a variable? You code <a href=\"https://onlinegdb.com/rJsHCaJ_N\" rel=\"nofollow noreferrer\">works</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1553092140, "post_id": 55263071, "comment_id": 97257617, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please."}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1553092240, "post_id": 55263071, "comment_id": 97257684, "body": "Attention, that is not the reason of your problem, but if there is no <code>&quot;\\0&quot;</code> in your char array, you will write somewhere in your memory. @chux Yes I also belive, that the probleme is there."}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 0, "creation_date": 1553092772, "post_id": 55263071, "comment_id": 97258124, "body": "I&#39;ve now updated my code... Please see the main question for updates. But still I see only lower case..."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1553092785, "post_id": 55263071, "comment_id": 97258134, "body": "the update isn&#39;t helping, you need to provide code that we can copy and paste into a file, compile, run, and reproduce the problem you&#39;re describing. That still is not in the question"}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553092861, "post_id": 55263071, "comment_id": 97258196, "body": "@Patrick ofcourse it is. I am not sure if it is normal, but I would either check if i&lt;sizeof(s)/sizeof(s[0])"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1553092873, "post_id": 55263071, "comment_id": 97258207, "body": "In your <code>EVP_EncrypyUpdate</code> call, should <code>parameters-&gt;output</code> be <code>parameters.output</code> (a typo), or is this a different <code>parameters</code> variable?"}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 0, "creation_date": 1553092879, "post_id": 55263071, "comment_id": 97258210, "body": "EVP_EncryptUpdate() is what writes the value into output variable... It&#39;s an OpenSSL call not something I implemented..."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1553093217, "post_id": 55263071, "comment_id": 97258483, "body": "EVP_EncryptUpdate() <code>out</code> parameter can have bytes ranges from <code>\\0</code> to <code>\\255</code>, you cannot treat it like &quot;a C string&quot; and assume that only the last byte will be <code>\\0</code> also, the length of the valid values in out are in outlen, and are <i>not</i> marked with <code>\\0</code>.  Not sure what you are trying to do"}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 0, "creation_date": 1553093303, "post_id": 55263071, "comment_id": 97258559, "body": "I populate a structure called parameters and pass to a function which calls OpenSSL functions. After computation parameters is returned back. The values are perfectly correct. All I&#39;m trying to do is just convert the output to upper case once parameters is passed back to calling function..."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1553093315, "post_id": 55263071, "comment_id": 97258574, "body": "Since you have two different variables called <code>parameters</code> (one is a struct and the other is a pointer), are you sure you are passing the correct thing to <code>strUpper</code>?"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1553093363, "post_id": 55263071, "comment_id": 97258603, "body": "your strUpper function works just fine ... you just don&#39;t understand what&#39;s happening inside <code>out</code>"}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 0, "creation_date": 1553093386, "post_id": 55263071, "comment_id": 97258620, "body": "Yes, because there is only parameters in the function where I&#39;m calling stringUpr()."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1553093479, "post_id": 55263071, "comment_id": 97258681, "body": "Have a look at <a href=\"https://onlinegdb.com/BkJDmA1dV\" rel=\"nofollow noreferrer\">onlinegdb.com/BkJDmA1dV</a>"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1553093708, "post_id": 55263071, "comment_id": 97258855, "body": "The problem is not in the code you have posted. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 0, "creation_date": 1553093814, "post_id": 55263071, "comment_id": 97258953, "body": "I cannot post the code I&#39;m afraid... Thank you all for the helpful comments... I&#39;ll look at what I&#39;m missing or what&#39;s the culprit in other parts of the code... I definitely did get some helpful comments in this post..."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1553093908, "post_id": 55263071, "comment_id": 97259014, "body": "I think you just aim for <code>void stringUpr(char *s, size_t len) { while(len--) { *s = toupper(*s); s++; } }</code> and call with <code>stringUpr(parameters.output, sizeof(parameters.output));</code>"}, {"owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "edited": false, "score": 1, "creation_date": 1553095867, "post_id": 55263071, "comment_id": 97260421, "body": "Now that I&#39;m sure the conversion function works fine (with all your help), I looked for the piece of code writing into file and I saw this: fprintf(outputStream, &quot;%02x&quot;, hexString[i]); After fixing this line, my issue seems to be solved now..."}], "answers": [{"comments": [{"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 2, "creation_date": 1553093136, "post_id": 55263485, "comment_id": 97258423, "body": "The <code>if (islower(s[i])</code> is redundant since <code>toupper(c)</code> returns the uppercase representation of <code>c</code> if it exists in the current locale and returns <code>c</code> otherwise."}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553093142, "post_id": 55263485, "comment_id": 97258429, "body": "Also if the char array is not ASCII, it can&#39;t be, that the content of the array is the same after subtract 32 from some characters. The only way would be, if some letters are not between &#39;a&#39; and &#39;z&#39;"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1553093146, "post_id": 55263485, "comment_id": 97258435, "body": "No need to check with <code>islower()</code> as <code>toupper()</code> won&#39;t change other char values."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 1, "creation_date": 1553093261, "post_id": 55263485, "comment_id": 97258518, "body": "@Ahrtaler <code>toupper()</code> is not an ASCII-only function.  It converts lower-case letters to the appropriate upper-case letter regardless of the execution character set in use."}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 0, "creation_date": 1553093305, "post_id": 55263485, "comment_id": 97258565, "body": "I never said, that toupper() is an ASCII only function"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 0, "creation_date": 1553093347, "post_id": 55263485, "comment_id": 97258597, "body": "@SimonDoppler I was mimicking the original code. I adjusted to remove that check."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553093399, "post_id": 55263485, "comment_id": 97258630, "body": "You need a cast to avoid UB on negative <code>char</code>s: <code>toupper((unsigned char)s[i]);</code>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "edited": false, "score": 1, "creation_date": 1553093418, "post_id": 55263485, "comment_id": 97258642, "body": "@Ahrtaler Then why post a comment about &quot;subtract 32 from some characters&quot;.  That&#39;s an ASCII-only case-conversion from lower- to upper-case."}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553093639, "post_id": 55263485, "comment_id": 97258805, "body": "@HolyBlackCat why would that be undefined behavior? <code>toupper</code> takes an <code>int</code>. <code>char</code> is implicitly converted."}, {"owner": {"reputation": 549, "user_id": 6911200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05be3c3f1ae8e8eaab9648064182b932?s=128&d=identicon&r=PG&f=1", "display_name": "NelDav", "link": "https://stackoverflow.com/users/6911200/neldav"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1553093708, "post_id": 55263485, "comment_id": 97258854, "body": "@AndrewHenle because the question was not how to convert lowercase charecter into uppercase character. It was why amys solution don&#39;t make that. I wanted to point out, that even if non ASCII is used, amys code would change the content of the array. Ofcourse it wouldn&#39;t work as expected. But it would change the array."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 4, "creation_date": 1553093765, "post_id": 55263485, "comment_id": 97258911, "body": "@PCLuddite <a href=\"https://en.cppreference.com/w/cpp/string/byte/toupper\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte/toupper</a> - <i>&quot;Like all other functions from <code>&lt;cctype&gt;</code>, the behavior of <code>std::toupper</code> is undefined if the argument&#39;s value is neither representable as <code>unsigned char</code> nor equal to <code>EOF</code>. To use these functions safely with plain <code>char</code>s (or <code>signed chars</code>), the argument should first be converted to <code>unsigned char</code>&quot;</i>"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553098498, "post_id": 55263485, "comment_id": 97262274, "body": "@HolyBlackCat done. although you may want to find a C source. the semantics can be very different between the two languages even if it happens to be true in both in this case."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553098626, "post_id": 55263485, "comment_id": 97262364, "body": "@PCLuddite I probably should&#39;ve linked this instead: <a href=\"https://en.cppreference.com/w/c/string/byte/toupper\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/string/byte/toupper</a> This page doesn&#39;t have the explicit remark about the cast, but like the previous page it says that <i>&quot;If the value of ch is not representable as unsigned char and does not equal EOF, the behavior is undefined.&quot;</i>"}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1553104328, "post_id": 55263485, "comment_id": 97265694, "body": "Why not <code>for ( int i = 0; s[i]; i++ ) s[i] = toupper( (unsigned char)s[i] );</code>"}, {"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1553104889, "post_id": 55263485, "comment_id": 97265983, "body": "@i486 if I wrote this from scratch, I would probably write it similar to that. But I&#39;m matching the OP&#39;s style, which isn&#39;t any more or less valid than what you&#39;ve written."}, {"owner": {"reputation": 628, "user_id": 2735127, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42f2555ee4eb92943306b7bc3acd0dd9?s=128&d=identicon&r=PG&f=1", "display_name": "Nirav", "link": "https://stackoverflow.com/users/2735127/nirav"}, "edited": false, "score": 0, "creation_date": 1574784925, "post_id": 55263485, "comment_id": 104349928, "body": "The line in the while loop <code>s[i++] = toupper((unsigned char)s[i]);</code> is <i>absolutely</i> incorrect. It seems that the original program by @PCLuddite was correct. But many untested edits made it incorrect. It should be <code>s[i] = toupper((unsigned char)s[i++]);</code> instead. I&#39;ve suggested an edit."}], "tags": [], "owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "is_accepted": false, "score": 2, "last_activity_date": 1553104077, "last_edit_date": 1553104077, "creation_date": 1553092937, "answer_id": 55263485, "question_id": 55263071, "link": "https://stackoverflow.com/questions/55263071/converting-char-array-to-upper-case-in-c/55263485#55263485", "title": "Converting char array to upper case in C", "body": "<p>Your program assumes that it's running using an ASCII character set, which is not guaranteed. Use the standard functions defined in <code>ctype.h</code></p>\n\n<pre><code>void stringUpr(char* s)\n{\n    int i = 0;\n    while(s[i] != '\\0')\n    {\n        s[i++] = toupper((unsigned char)s[i]);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 2932886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92cc7c3e5c9d09c502f5958b21f396c?s=128&d=identicon&r=PG&f=1", "display_name": "ARao", "link": "https://stackoverflow.com/users/2932886/arao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "closed_date": 1553093541, "answer_count": 1, "score": -1, "last_activity_date": 1553104077, "creation_date": 1553091793, "last_edit_date": 1553093150, "question_id": 55263071, "link": "https://stackoverflow.com/questions/55263071/converting-char-array-to-upper-case-in-c", "closed_reason": "Not suitable for this site", "title": "Converting char array to upper case in C", "body": "<p>I'm trying to convert a char array to upper case in C. But it still prints out in lower case. The logic in conversion function looks okay to me. I don't know if the problem could be that the input I'm passing to this function is member of a structure variable.</p>\n\n<p>This is the structure whose member I'm passing to conversion function:</p>\n\n<pre><code>typedef struct AESParams {\n   unsigned char output[192];\n} AESParams;\n</code></pre>\n\n<p>My conversion fucntion is shown below:</p>\n\n<pre><code>void stringUpr(char *s)\n{\n    int i=0;\n    while(s[i]!='\\0')\n    {\n        if(s[i]&gt;='a' &amp;&amp; s[i]&lt;='z'){\n            s[i]=s[i]-32;\n        }\n        ++i;\n    }\n}\n</code></pre>\n\n<p>I call conversion function as follows:</p>\n\n<pre><code>AESParams parameters;\nstringUpr(parameters.output);\n</code></pre>\n\n<p>If I print the output after calling \"stringUpr\" function, the value is still in lower case. Can anyone tell me what might be causing the issue here?</p>\n\n<p>TIA...</p>\n\n<p>Update: Code that writes value to output.</p>\n\n<pre><code>EVP_EncryptUpdate(&amp;ctx, parameters-&gt;output, &amp;outLen, input, length); \n// This call happens in some other file. parameters is passed to the function that calls this function and after computation parameters is passed back to the place where I'm calling stringUpr().\n</code></pre>\n\n<p>I'm confident that this lines works and it gives the correct results after computation. It's just that I want to take this value and convert to upper case and write to a file.</p>\n"}, {"tags": ["c", "dns", "bind", "dnsmasq", "libresolv"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 4002113, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/117890ca0922320b85d77309b109e4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4002113/karl"}, "edited": false, "score": 0, "creation_date": 1553092577, "post_id": 55263046, "comment_id": 97257953, "body": "I can see the two query in <code>wireshark</code> on mac os, do you mean local dns cache?"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "reply_to_user": {"reputation": 605, "user_id": 4002113, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/117890ca0922320b85d77309b109e4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4002113/karl"}, "edited": false, "score": 0, "creation_date": 1553096369, "post_id": 55263046, "comment_id": 97260763, "body": "I&#39;m not sure what your network topology looks like. Can you capture packets upstream from the caching resolver?"}, {"owner": {"reputation": 605, "user_id": 4002113, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/117890ca0922320b85d77309b109e4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4002113/karl"}, "edited": false, "score": 0, "creation_date": 1553139050, "post_id": 55263046, "comment_id": 97277650, "body": "I have updated the question with query response from mac"}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 2, "last_activity_date": 1553091733, "creation_date": 1553091733, "answer_id": 55263046, "question_id": 55262724, "link": "https://stackoverflow.com/questions/55262724/why-ns-t-ns-is-faster-than-ns-t-a-when-query-root-sever/55263046#55263046", "title": "Why ns_t_ns is faster than ns_t_a when query root sever?", "body": "<p>A recursive resolver needs to cache the <code>./IN/NS</code> record set, and usually does so when the resolver is started.  This is called <em>priming</em> and is covered in this RFC:</p>\n\n<ul>\n<li><a href=\"https://tools.ietf.org/html/rfc8109\" rel=\"nofollow noreferrer\">RFC 8109: Initializing a DNS Resolver with Priming Queries</a></li>\n</ul>\n\n<p>The set of root name servers also never expires from the cache (in a typical implementation).</p>\n\n<p>A query for <code>./IN/A</code> does not happen during regular operation, so the cache needs to be populated first.  This resource record set will also expire eventually.</p>\n\n<p>If both resource records sets are in the cache, typical resolver response times will be identical.</p>\n"}], "owner": {"reputation": 605, "user_id": 4002113, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/117890ca0922320b85d77309b109e4e7?s=128&d=identicon&r=PG&f=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/4002113/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553138870, "creation_date": 1553090897, "last_edit_date": 1553138870, "question_id": 55262724, "link": "https://stackoverflow.com/questions/55262724/why-ns-t-ns-is-faster-than-ns-t-a-when-query-root-sever", "title": "Why ns_t_ns is faster than ns_t_a when query root sever?", "body": "<p>I want to know the latency between client and local dns server.\nSo I send a query for the root dns server(.) like that:</p>\n\n<pre><code>res_nquery(&amp;res, \".\", ns_c_in, ns_t_a, answer, sizeof(answer));\n\n</code></pre>\n\n<p>But if I change <code>ns_t_a</code> to <code>ns_t_ns</code>, the query is become more faster. Why this happen? </p>\n\n<p>Response when use <code>ns_t_a</code>:\n<a href=\"https://i.stack.imgur.com/6vVo3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6vVo3.png\" alt=\"enter image description here\"></a></p>\n\n<p>Response when use <code>ns_t_ns</code>:\n<a href=\"https://i.stack.imgur.com/DleJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DleJG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "linux", "assembly", "system-calls", "api-design"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 6, "creation_date": 1553089949, "post_id": 55262374, "comment_id": 97256062, "body": "It&#39;s a normal 0 terminated string, yes, while <code>write()</code> can be used for data that&#39;s not."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1553090390, "post_id": 55262374, "comment_id": 97256350, "body": "open needs a zero terminated filename (zero bytes are <i>not</i> valid in filenames). write writes <i>binary</i> data, so zero bytes can occur and thus cannot work as buffer terminator"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1553091020, "post_id": 55262576, "comment_id": 97256828, "body": "` No functionality is lost by terminating strings with NUL as NUL bytes are not allowed to appear in paths or other identifiers.` well, this is exactly functionality lost - since strings are null-terminated, Unix doesn&#39;t allow null bytes in identifiers. While I do not think it is a big loss, and I know of no OS which allows that, formally, your statement is internally contradictive."}, {"owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "edited": false, "score": 0, "creation_date": 1553091147, "post_id": 55262576, "comment_id": 97256936, "body": "Ha! The write being used for binary data rather than strings was the source of my misunderstanding. Every time I&#39;ve used the write system call so far I&#39;ve done so with a string argument and so I had not considered that you may want to use the write syscall to write bytes that don&#39;t actually make sense within a string such as a NULL. When I look at it as the buffer argument for write not being a string it starts making sense. thanks."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1553091369, "post_id": 55262576, "comment_id": 97257091, "body": "@SergeyA There is no contradiction; if someone was to make a UNIX-variant where paths were passed as buffer/length pairs, you could still not create files with names containing NUL bytes as that&#39;s prohibited by the POSIX standard."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1553091794, "post_id": 55262576, "comment_id": 97257367, "body": "@fuz That&#39;s a bit of circular reasoning, though.  A lot of what&#39;s now the POSIX standard is really just codification of how things were done in early Unix variants."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1553091927, "post_id": 55262576, "comment_id": 97257470, "body": "@AndrewHenle You view this from the perspective of \u201cwe could have more functionality if the design decision was made differently back in the day\u201d while I see this as \u201cchanging the interface today would not give more functionality.\u201d  Both positions are correct, but I don&#39;t think it&#39;s useful to think about what could have been in this case."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1553090517, "creation_date": 1553090517, "answer_id": 55262576, "question_id": 55262374, "link": "https://stackoverflow.com/questions/55262374/why-does-the-linux-open-system-call-not-need-a-buffer-size-parameter-for-the-pat/55262576#55262576", "title": "Why does the Linux Open system call not need a buffer size parameter for the path?", "body": "<p>UNIX was developed as an operating system for programs written in assembly, later for programs written in C.  In the assembly convention the UNIX team uses and later in C, strings are terminated with NUL bytes.  Thus it is only natural to use the same convention when talking to the operating system.  Linus copied the UNIX API when designing Linux, so that's why it has the same design.  No functionality is lost by terminating strings with NUL as NUL bytes are not allowed to appear in paths or other identifiers.</p>\n\n<p>A <code>write</code> call writes arbitrary binary data to a file.  This data is not necessarily text thus using the string convention doesn't make much sense.</p>\n"}], "owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 55262576, "answer_count": 1, "score": 0, "last_activity_date": 1553092140, "creation_date": 1553089864, "last_edit_date": 1553092140, "question_id": 55262374, "link": "https://stackoverflow.com/questions/55262374/why-does-the-linux-open-system-call-not-need-a-buffer-size-parameter-for-the-pat", "title": "Why does the Linux Open system call not need a buffer size parameter for the path?", "body": "<p>Why does the <code>open</code> system call not need a buffer size parameter like the <code>write</code> system call does?</p>\n\n<p>How do these two system calls treat their string parameters differently? </p>\n\n<p>Does the <code>open</code> system call assume a zero-terminated string for the path parameter while the <code>write</code> system call does not? If so why the inconsistency? </p>\n\n<p>Why not make all (or none) of the system calls that use strings / arrays require a size parameter?</p>\n"}, {"tags": ["c", "gcc", "stack"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553089771, "post_id": 55262274, "comment_id": 97255937, "body": "The behaviour is <i>undefined</i>. Since none of the array writing is actually needed then the array can be optimized out and no stack smashing needs to happen."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553089774, "post_id": 55262274, "comment_id": 97255938, "body": "The optimization is good enough to remove the assembly code that caused stack smashing."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553089857, "post_id": 55262274, "comment_id": 97255989, "body": "Prefix the functions with <code>static</code> and use Godbolt to explore"}, {"owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553089959, "post_id": 55262274, "comment_id": 97256069, "body": "@AnttiHaapala: Just for understanding - I am printing array[index] in  my write_at_index(). So array writing is required right?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1553090204, "post_id": 55262274, "comment_id": 97256245, "body": "It is not required. The optimization can remove all the code and leave only calls to <code>printf</code>, as only this is a side effect."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1553090338, "post_id": 55262274, "comment_id": 97256322, "body": "Your code can be replaced by <code>puts(&quot;\\nwrite_at_index 6 arr[30]=10\\n\\ntest_stack_overflow 16 Exiting a[0] 0&quot;)</code> and no one would notice any difference."}], "answers": [{"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553090003, "creation_date": 1553090003, "answer_id": 55262412, "question_id": 55262274, "link": "https://stackoverflow.com/questions/55262274/gccs-stack-protection-feature-with-optimization-levels/55262412#55262412", "title": "GCC&#39;s stack protection feature with optimization levels", "body": "<p>At higher optimization levels, <code>write_at_index</code> is inlined into <code>test_stack_overflow</code>, and GCC detects that the entire array <code>a</code> is not used in any meaningful way, and eliminates it.  As a result, the store into the array and the associated buffer overflow are both gone.  You would have to add a compiler barrier to prevent that from happening.</p>\n\n<p>Furthermore, single-byte overflows only trigger stack protector crashes if they manage to hit the canary (or the return address).  So they are not a good way to exercise stack overflow detection code.</p>\n"}], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1553090003, "creation_date": 1553089631, "question_id": 55262274, "link": "https://stackoverflow.com/questions/55262274/gccs-stack-protection-feature-with-optimization-levels", "title": "GCC&#39;s stack protection feature with optimization levels", "body": "<p>I am doing some experiments with GCC's stack protection feature to understand it better. Basically I referred to <a href=\"https://stackoverflow.com/questions/1629685/when-and-how-to-use-gccs-stack-protection-feature\">this post on stackoverflow</a>.</p>\n\n<p>The following is my code.</p>\n\n<p><strong>test.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid write_at_index(char *arr, unsigned int idx, char val)\n{\n    arr[idx] = val;\n    printf(\"\\n%s %d arr[%u]=%d\\n\", __func__, __LINE__,\n        idx, arr[idx]);\n}\n\nvoid test_stack_overflow()\n{\n    char a[16] = {0}; //Array of 16 bytes.\n\n    write_at_index(a, 30/*idx*/, 10/*val*/); //Ask the other function to access 30th index.\n\n    printf(\"\\n%s %d Exiting a[0] %d\\n\", __func__, __LINE__, a[0]);\n}\n\nint main()\n{\n    test_stack_overflow();\n    return 0;\n}\n</code></pre>\n\n<p>The following is my makefile.</p>\n\n<p><strong>Makefile</strong></p>\n\n<pre><code>CC=gcc\n\nBIN=./test.out\n\nSRCS=./test.c\n\nall: $(BIN)\n\nOBJ = ${SRCS:.c=.o}\n\nCFLAGS=-O0 -fstack-protector -fstack-protector-all\n\n$(OBJ): %.o: %.c\n    $(CC) $(CFLAGS) $(INCLUDES) -c $*.c -o $*.o\n\n$(BIN): $(OBJ)\n    $(CC) -o $@ $&lt;\n    rm -rf ./*.o\n\nclean:\n    rm -rf ./*.out\n    rm -rf ./*.o\n</code></pre>\n\n<p>I am using gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</p>\n\n<p>When I build and run test.out, I get \" stack smashing detected \" crash as expected.</p>\n\n<p>However, if I change optimization level to O3, <code>(CFLAGS=-O3 -fstack-protector -fstack-protector-all)</code> and build and execute test.out, I am not observing the crash.</p>\n\n<p>So my question is, does the compiler remove the \"-fstack-protector\" option when optimization is enabled? Or am I missing some other setting here?</p>\n"}, {"tags": ["c", "python-3.x", "ctypes"], "answers": [{"comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1553090974, "post_id": 55262437, "comment_id": 97256792, "body": "I&#39;m reasonalbly sure the strings are <code>NUL</code>-terminated, not <code>NULL</code>-terminated."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1553092179, "post_id": 55262437, "comment_id": 97257644, "body": "@Deduplicator: I&#39;m not sure I understand. <a href=\"https://en.cppreference.com/w/cpp/string/byte\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte</a>."}, {"owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "edited": false, "score": 0, "creation_date": 1553092800, "post_id": 55262437, "comment_id": 97258148, "body": "@CristiFati NUL is the byte correspondance for 0 (Check the ASCII table), NULL, on the other hand, is the pointer that points to the memory address 0 (as defined in C) and it can have other names (None in Python, nil in Pascal ...)"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "edited": false, "score": 0, "creation_date": 1553093337, "post_id": 55262437, "comment_id": 97258588, "body": "@MeherKhiari: Yes, <i>NUL</i> is char 0, but that&#39;s also referred to as <i>null</i> (disregard the case). Also, <code>#define NULL    0</code>. So, even if NULL is used by convention for pointers, a bunch of official <i>URL</i>s use &quot;<i>Null-terminated strings</i>&quot;, and I&#39;m sticking with it."}, {"owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "edited": false, "score": 0, "creation_date": 1553093792, "post_id": 55262437, "comment_id": 97258939, "body": "@CristiFati &#39;bunch of official URLs use &quot;Null-terminated strings&quot;&#39;, that&#39;s the problem. They are confusing people. NUL is an ASCII nomination which is language independent and can be used as name in any programming language, NULL is a C specific notation that has been introduced for pointers. Please don&#39;t mix the two."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "edited": false, "score": 0, "creation_date": 1553094377, "post_id": 55262437, "comment_id": 97259361, "body": "@MeherKhiari An implementation can define that null pointers point to address 0, and does on modern systems. But that&#39;s not part of the standard. Regarding <code>NULL</code> and <code>NUL</code>: The first is a pointer, the last a character, but they are both called <i>null</i> in prose, especially when the difference is immaterial or obvious from context. &lt;/pedantic&gt;"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "reply_to_user": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "edited": false, "score": 1, "creation_date": 1553094444, "post_id": 55262437, "comment_id": 97259404, "body": "@MeherKhiari: <a href=\"https://en.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Null-terminated_string</a>, <a href=\"https://en.cppreference.com/w/cpp/string/byte\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/string/byte</a>, <a href=\"https://www.tutorialspoint.com/cprogramming/c_strings.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_strings.htm</a>, <a href=\"http://www.asciitable.com\" rel=\"nofollow noreferrer\">asciitable.com</a>, (actually <a href=\"https://www.google.com/search?newwindow=1&amp;biw=2106&amp;bih=910&amp;ei=RFGSXN2hBeibmwXUoKZY&amp;q=null+terminated+string&amp;oq=null+terminated+string\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>) speak for themselves. Even if using <i>NUL</i> would be technically more correct, it would confuse people more (because most of the articles uses <i>null</i>). But enough time wasted on a technicality. I changed it so there&#39;s no room for discussions like this one."}], "tags": [], "owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "is_accepted": true, "score": 0, "last_activity_date": 1553094122, "last_edit_date": 1553094122, "creation_date": 1553090084, "answer_id": 55262437, "question_id": 55261990, "link": "https://stackoverflow.com/questions/55261990/trouble-with-ctypes-calling-c-dll-function/55262437#55262437", "title": "Trouble with CTypes - calling C dll function", "body": "<p>When passing <em>zero-terminated strings</em>, use <em>c_char_p</em>. According to <a href=\"https://docs.python.org/3/library/ctypes.html#ctypes.c_char_p\" rel=\"nofollow noreferrer\">[Python 3]: <em>class</em> ctypes.<strong>c_char_p</strong></a>:</p>\n\n<blockquote>\n  <p>Represents the C <code>char *</code> datatype when it points to a zero-terminated string.</p>\n</blockquote>\n\n<p>Translated to your code:</p>\n\n\n\n<ol>\n<li><p>Change the function <em>argtypes</em> (1<sup>st</sup> one):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>func.argtypes = [c_char_p, POINTER(TStubMethod)]\n</code></pre></li>\n<li><p>Use <em>bytes</em> (which is <em>Python</em>'s equivalent for <code>char*</code>). You can <strong>either</strong> (<strong>not</strong> both):</p>\n\n<ul>\n<li><p>Converting <em>string</em> to <em>bytes</em> (to keep changes in <em>JpmcdsStringToStubMethod</em>):</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>return func(name.encode(), stubmethod)\n</code></pre></li>\n<li><p>Pass a <em>bytes</em> instance to <em>JpmcdsStringToStubMethod</em>:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>ret = JpmcdsStringToStubMethod(dll, b\"F/S\", byref(stubFS))\n</code></pre></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 79, "user_id": 5294101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d817b41606d40723ce3bbe1ed58c65a5?s=128&d=identicon&r=PG&f=1", "display_name": "suhasghorp", "link": "https://stackoverflow.com/users/5294101/suhasghorp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55262437, "answer_count": 1, "score": 0, "last_activity_date": 1553094122, "creation_date": 1553088890, "question_id": 55261990, "link": "https://stackoverflow.com/questions/55261990/trouble-with-ctypes-calling-c-dll-function", "title": "Trouble with CTypes - calling C dll function", "body": "<p>I have the following C function exported from a dll</p>\n\n<pre><code>typedef struct _TStubMethod\n{\n    TBoolean stubAtEnd;\n    TBoolean longStub;\n} TStubMethod;\n\n\nint JpmcdsStringToStubMethod\n(char        *name,     \n TStubMethod *stubMethod \n);\n</code></pre>\n\n<p>In Python, I have defined the type &amp; function and called the function as follows:</p>\n\n<pre><code>class TStubMethod(Structure):\n    _fields_ = [\n        ('stubAtEnd', c_int),\n        ('longStub', c_int)\n    ]\n\ndef JpmcdsStringToStubMethod(dll, name, stubmethod):\n    func = dll.JpmcdsStringToStubMethod\n    func.argtypes = [POINTER(c_char), POINTER(TStubMethod)]\n    func.restype = c_int\n    return func(name, stubmethod)\n\nstubFS = TStubMethod(False, False)\nret = JpmcdsStringToStubMethod(dll, 'F/S', byref(stubFS))\n</code></pre>\n\n<p>I am getting an error as follows. What am I doing wrong? </p>\n\n<pre><code>ArgumentError                             Traceback (most recent call last)\n&lt;ipython-input-61-ec7303283f89&gt; in &lt;module&gt;\n     25 \n     26 stubFS = TStubMethod(False, False)\n---&gt; 27 ret = JpmcdsStringToStubMethod(dll, 'F/S', byref(stubFS))\n\n&lt;ipython-input-55-c8ab0da16b04&gt; in JpmcdsStringToStubMethod(dll, name, stubmethod)\n      9     func.argtypes = [POINTER(c_char), POINTER(TStubMethod)]\n     10     func.restype = c_int\n---&gt; 11     return func(name, stubmethod)\n\nArgumentError: argument 1: &lt;class 'TypeError'&gt;: wrong type\n</code></pre>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["sql", "c", "oracle", "oracle-call-interface"], "owner": {"reputation": 11, "user_id": 11231721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9MLzIGOx9Gc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdYOVzo2UqLrOR2mdounCdiVeb4aA/mo/photo.jpg?sz=128", "display_name": "Yihua Qiu", "link": "https://stackoverflow.com/users/11231721/yihua-qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553084566, "creation_date": 1553084566, "question_id": 55260698, "link": "https://stackoverflow.com/questions/55260698/how-to-dynamic-fetch-utf8-value-with-oracle-oci", "title": "how to DYNAMIC fetch utf8 value with Oracle oci?", "body": "<p>when i DYNAMIC fetch utf8 value in oci ,OCIStmtFetch2 return a negative number\n as len,but i dont know whats negative mean,how can i fetch utf8 value DYNAMIC?</p>\n\n<p>my code is:</p>\n\n<pre><code>    for(;OCI_NEED_DATA == ret_oci;){\n        ret_oci=OCIStmtGetPieceInfo(conn-&gt;stmt,conn-&gt;err,(void**)&amp;defnp,&amp;dtype,(ub1*)&amp;utmp,&amp;utmp,&amp;utmp,&amp;up);\n        oci_checkerr(conn-&gt;err,ret_oci);\n        len_tmp=2;\n        if(tmpl!=(long)defnp){ //next column\n            tmpl=(long)defnp;\n            pa-&gt;topData = pa-&gt;topData - (pAH-&gt;maxLen-pAH-&gt;len);\n            pAH-&gt;maxLen=pAH-&gt;len;\n            // malloc buffer\n            pAH=arrayDataAppend(pa,-1,NULL,len_tmp,TYPE_RAW);\n            pTmp = (char*)(pAH+1);\n        }else{// current column need more buffer size\n            // malloc buffer\n            pAH=arrayDataAppend(pa,-2,NULL,len_tmp,TYPE_RAW);\n            pTmp = (char*)(pAH+1)+pAH-&gt;len;\n        }\n\n        ret_oci=OCIStmtSetPieceInfo((void*)defnp,dtype,conn-&gt;err,pTmp,&amp;len_tmp,up,NULL,NULL);\n        oci_checkerr(conn-&gt;err,ret_oci);\n        ret_oci=OCIStmtFetch2(conn-&gt;stmt, conn-&gt;err, 1,OCI_DEFAULT,0,OCI_DYNAMIC_FETCH);\n        printf(\"len_tmp:%d\\n\",len_tmp);\n        itmp = len_tmp;\n        oci_checkerr(conn-&gt;err,ret_oci);\n        //pTmp[itmp]=0;\n        pAH-&gt;len+=itmp;\n    }\n</code></pre>\n\n<p>value is utf8 char \"\u9648\u6d69\",</p>\n\n<p>run:</p>\n\n<p>when set len_tmp=2;</p>\n\n<pre><code>Error - OCI_NEED_DATA\nlen_tmp:2\nError - OCI_NEED_DATA\nlen_tmp:2\nError - OCI_NEED_DATA\nlen_tmp:-4\nError - OCI_STILL_EXECUTE\nepoll wait fd:17 to read..\nError - OCI_NODATA\nfetch result,rows:1 :cols:1\n        1:\u9648\ufffd, \n</code></pre>\n\n<p>when set len_tmp=3;</p>\n\n<pre><code>Error - OCI_NEED_DATA\nlen_tmp:3\nError - OCI_NEED_DATA\nlen_tmp:3\nError - OCI_STILL_EXECUTE\nepoll wait fd:17 to read..\nError - OCI_NODATA\nfetch result,rows:1 :cols:1\n        1:\u9648\u6d69, \n</code></pre>\n\n<p>when set len_tmp=5;</p>\n\n<pre><code>Error - OCI_NEED_DATA\nlen_tmp:5\nError - OCI_NEED_DATA\nlen_tmp:-5\nError - OCI_STILL_EXECUTE\nepoll wait fd:17 to read..\nError - OCI_NODATA\nfetch result,row:1 :cols:1\n        1:\u9648\ufffd\ufffd, \n</code></pre>\n\n<p>when set len_tmp=8;</p>\n\n<pre><code>Error - OCI_NEED_DATA\nlen_tmp:6\nError - OCI_STILL_EXECUTE\nepoll wait fd:17 to read..\nError - OCI_NODATA\nfetch result,rows:1 :cols:1\n        1:\u9648\u6d69, \n</code></pre>\n\n<p>when value is ascii char '123456782011', it does not has the problem:</p>\n\n<p>when set len_tmp=5;</p>\n\n<pre><code>Error - OCI_NEED_DATA\nlen_tmp:5\nError - OCI_NEED_DATA\nlen_tmp:5\nError - OCI_NEED_DATA\nlen_tmp:2\nError - OCI_STILL_EXECUTE\nepoll wait fd:17 to read..\nError - OCI_NODATA\nfetch result,rows:1 :cols:1\n        1:123456782011, \n</code></pre>\n"}, {"tags": ["c", "string", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1553082336, "creation_date": 1553082336, "answer_id": 55260011, "question_id": 55259947, "link": "https://stackoverflow.com/questions/55259947/queries-on-declaring-initialising-string-and-also-string-memory-region/55260011#55260011", "title": "Queries on declaring &amp; initialising string and also string memory region", "body": "<p>String literals like <code>\"heello!\"</code> are really <em>read-only</em> arrays of characters (including the string null-terminator).</p>\n\n<p>With</p>\n\n<pre><code>char *str1 = \"heello!\";\n</code></pre>\n\n<p>you make <code>str1</code> point to the first character of such an array.</p>\n\n<p>And when you do <code>str1[1] = 1</code> you attempt to modify the read-only array, which is forbidden and leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a> (which <em>can</em> but doesn't have to lead to crashes).</p>\n\n<p>That's why you either should use your own arrays for strings, or use <code>const char *</code> to point to literal strings.</p>\n"}], "owner": {"reputation": 17, "user_id": 11215789, "user_type": "registered", "profile_image": "https://graph.facebook.com/2362030207140617/picture?type=large", "display_name": "Neo", "link": "https://stackoverflow.com/users/11215789/neo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "closed_date": 1553082690, "answer_count": 1, "score": -1, "last_activity_date": 1553082704, "creation_date": 1553082126, "last_edit_date": 1553082246, "question_id": 55259947, "link": "https://stackoverflow.com/questions/55259947/queries-on-declaring-initialising-string-and-also-string-memory-region", "closed_reason": "Duplicate", "title": "Queries on declaring &amp; initialising string and also string memory region", "body": "<p>My question comes in three part. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char str[] = \"hello!\";\n    char *str1 = \"heello!\";\n    puts(str);\n    str1[1] = 1\n    puts(str1);\n    printf(\"%s\\n\", str1);\n    printf(\"%p\\n\", str1);\n</code></pre>\n\n<p>Ouput of code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>hello!\nh1ello!\nheello!\n0x10735ef9b\n</code></pre>\n\n<p>1) I understand that when you're declaring a char * type, you're declaring a pointer that points to char type. And usually for pointer, since it contains the address of the variable its pointing to, when you print the pointer itself, you'll get the address stored in the pointer and only when you dereference the pointer, then you'll get the content stored in the variable the pointer is pointing to. \nHowever for a char * type, why is it that it doesn't function like a regular pointer? You can print the content of the variable which the 'char *' pointer is pointing to without dereferencing it and also use it like a string variable(rather than a pointer) by changing the value of the str1[1] as shown above.</p>\n\n<p>2) I was taught that you shouldn't declare a pointer variable as such in the topic of pointer:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *str1 = \"heello!\";\n</code></pre>\n\n<p>because the pointer variable would be pointing to whatever address happens to be in the memory at that time, thus running a risk of changing the value in a memory location that you don't mean to and resulting in segfault.\nHence you should do the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *str1;\nchar c;\nstr1 = &amp;c;\n*addr = \"hello!\"\n</code></pre>\n\n<p>By doing the above, you'll make sure that your pointer is pointing to the right location before dereferencing  and writing to the location.</p>\n\n<p>However in the notes on string, it says to declare and initialise as such:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char *str1 = \"heello!\";\n</code></pre>\n\n<p>I'm quite confused as to what I should follow now when declaring a char * pointer. Please help.</p>\n\n<p>3) It says in my notes that the location of string is stored in a read only region of the memory called the text region. \nHence doing this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    char *str1 = \"hello!\";\n    str[1] = '.';\n</code></pre>\n\n<p>Will crash your program.</p>\n\n<p>But when you do this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char str2[7] = \"hello!\";\nstr2[1] = '.';\n</code></pre>\n\n<p>This is okay and will successfully change the second element in the string from 'e' to '.'</p>\n\n<p>The explanation to this was that str1 points to a read only region in the memory, while str2 contains a copy of the string on the stack.\nI do not understand how the above 2 different ways of declaring the string variable will make such a big difference when executing the code. Please help. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1553081364, "post_id": 55259622, "comment_id": 97250625, "body": "Can you add just enough of <code>main</code> and test data to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553081897, "post_id": 55259622, "comment_id": 97250937, "body": "You still need to add at the end <code>target-&gt;last= list-&gt;last;</code>"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1553081938, "post_id": 55259622, "comment_id": 97250960, "body": "We also need to see createlist and Add to understand if the link list you built is OK."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1553082412, "post_id": 55259622, "comment_id": 97251240, "body": "Post complete code."}, {"owner": {"reputation": 15, "user_id": 10192485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d755f81bd23366769ad4401beffb1d86?s=128&d=identicon&r=PG&f=1", "display_name": "Noah19191", "link": "https://stackoverflow.com/users/10192485/noah19191"}, "edited": false, "score": 0, "creation_date": 1553082480, "post_id": 55259622, "comment_id": 97251288, "body": "sorry,i just edited it."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": true, "score": 0, "last_activity_date": 1553083310, "creation_date": 1553083310, "answer_id": 55260315, "question_id": 55259622, "link": "https://stackoverflow.com/questions/55259622/infinite-loop-after-combine-two-linked-list/55260315#55260315", "title": "Infinite loop after combine two linked list", "body": "<p>I don't get an infinite loop from the code you've posted, but I can easily see how that would happen. The problem is the combination of copy and combine: copy makes it so that target only differs in in head, but all the nodes after that are the exact same as in list. So when you iterate through target in combine, and then set the last node's next to list's head you've created a loop.</p>\n\n<p>I don't know exactly what your intention is, but one way of solving this is to only copy the node data in copy, not the whole node pointer.</p>\n"}], "owner": {"reputation": 15, "user_id": 10192485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d755f81bd23366769ad4401beffb1d86?s=128&d=identicon&r=PG&f=1", "display_name": "Noah19191", "link": "https://stackoverflow.com/users/10192485/noah19191"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55260315, "answer_count": 1, "score": 0, "last_activity_date": 1553083310, "creation_date": 1553081013, "last_edit_date": 1553082789, "question_id": 55259622, "link": "https://stackoverflow.com/questions/55259622/infinite-loop-after-combine-two-linked-list", "title": "Infinite loop after combine two linked list", "body": "<p>I have two linked list <code>Target</code> and <code>List</code></p>\n\n<pre><code>      struct node\n        {\n            int data;\n            struct node *next;\n        };\n\n        struct snode\n        {\n            struct node *head;\n            struct node *last;\n            int size;\n        };\nvoid *createlist(struct snode *list)\n{\n    list-&gt;head = NULL;\n    list-&gt;last = NULL;\n    list-&gt;size = 0;\n}\n\n\nstruct node *createnode(int data)\n{\n    struct node *temp = (struct node *)malloc(sizeof(struct node));\n    temp-&gt;data = data;\n    temp-&gt;next = NULL;\n    return temp;\n}\n\nint Add(struct snode *list, int data, int pos) \n{\n    struct node *temp = createnode(data);\n    if (pos == 0) // add to first node\n    {\n        if (list-&gt;head == NULL)\n        {\n            list-&gt;head = temp;\n            list-&gt;last = temp;\n        }\n        else\n        {\n            temp-&gt;next = list-&gt;head;\n            list-&gt;head = temp;\n        }\n    }\n    else if (pos == -1) // add to last node\n    {\n        if (list-&gt;head == NULL)\n            list-&gt;head = temp;\n        else\n        {\n            struct node *pre = list-&gt;head;\n            while (pre-&gt;next != NULL)\n                pre = pre-&gt;next;\n            pre-&gt;next = temp;\n            temp-&gt;next = NULL;\n        }\n    }\n    else // add to the middle\n    {\n        int k = 1;\n        struct node *pre = list-&gt;head;\n        while ((pre != NULL) &amp;&amp; (k != pos))\n        {\n            pre = pre-&gt;next;\n            k++;\n        }\n        if ((k != pos) || (pos &gt; list-&gt;size))\n            return 0;\n        else\n        {\n            temp-&gt;next = pre-&gt;next;\n            pre-&gt;next = temp;\n        }\n    }\n    list-&gt;size++;\n    return 1;;\n}\nint copy(struct snode *target, struct snode *list)\n{\n    struct node *temp1 = list-&gt;head;\n    struct node *temp2 = createnode(temp1-&gt;data);\n    target-&gt;head = temp2;\n    if (temp1 == NULL)\n        return 0;\n    while (temp1 != NULL)\n    {\n        temp2-&gt;next = temp1-&gt;next;\n        temp1 = temp1-&gt;next;\n        temp2 = temp2-&gt;next;\n        target-&gt;size++;\n    }\n    return 1;\n}\nvoid printlist(struct snode list)\n{\n    while (list.head != NULL)\n    {\n        printf(\"%2d\", list.head-&gt;data);\n        list.head = list.head-&gt;next;\n    }\n}\nint main()\n{\n    struct snode list;\n    struct snode target;\n    createlist(&amp;list);\n    createlist(&amp;target); //create empty linkedlist\n    Add(&amp;list, 4, 0); //add node to linkedlist\n    Add(&amp;list, 6, 1);\n    Add(&amp;list, 9, -1);\n    Add(&amp;list, 7, 2);\n    Add(&amp;list, 5, 3);\n    copy(&amp;target,&amp;list); //copy list to target\n    combine(&amp;target,&amp;list);\n    printlist(target);\n}\n</code></pre>\n\n<p>I wanted to connect <code>Target</code> with <code>List</code> so i used this function</p>\n\n<pre><code>void combine(struct snode *target, struct snode *list)\n{\n    struct node *temp1=list-&gt;head;\n    struct node *temp2=target-&gt;head;\n    while(temp2-&gt;next!=NULL)\n        temp2=temp2-&gt;next;\n    temp2-&gt;next = list-&gt;head;\n\n}\n</code></pre>\n\n<p>But when i print it,it creates infinite loop. I tried to debug and I saw that after this line:</p>\n\n<pre><code>temp2-&gt;next = list-&gt;head\n</code></pre>\n\n<p>the last node of <code>List</code> point to the first node of <code>List</code>. </p>\n\n<p>I don't know why this happened,can someone tell me why and how to fix this problem?</p>\n"}, {"tags": ["c", "algorithm", "time-complexity"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 10, "creation_date": 1553079581, "post_id": 55259099, "comment_id": 97249563, "body": "Please write the description as <i>text</i> too, no images."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1553079695, "post_id": 55259099, "comment_id": 97249635, "body": "One approach would be to build a cache of sums of pairs, along with the pairs that make that sum. Then it&#39;s a matter of ordering that cache of sums, and reeling off the results. That&#39;s almost trivial in C++. The algorithm is O(N * N)"}, {"owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1553079874, "post_id": 55259099, "comment_id": 97249760, "body": "@Bathsheba Can it be done in C as well? If so, any idea as to how I may implement this?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1553079929, "post_id": 55259099, "comment_id": 97249801, "body": "Doing it in C is harder. Your starting point is to define a <code>struct</code> on the lines that I&#39;ve already mentioned. Then an array of those <code>struct</code>s. Then pass that thing into <code>qsort</code> (the callback function is the fun bit)."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1553080730, "post_id": 55259099, "comment_id": 97250274, "body": "Use a dictionary or map data structure, with sum as key, and list of pairs producing that sum as value (or just list of first number of pair, since second number is sum minus first...)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1553081129, "post_id": 55259099, "comment_id": 97250475, "body": "Maybe I misunderstand the meaning of &quot;unique pair&quot; but it seems to me that this algorithm isn&#39;t working. If <code>int arr[]={6,4,6,4};</code> the output is <code>(6,4),(4,6) (6,4),(6,4) (6,4),(4,6) (6,4),(6,4) (4,6),(6,4)</code> Is that the expected output? Isn&#39;t (6,4) the same as (4,6)? May the same &quot;solution&quot; be printed multiple times?"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1553081135, "post_id": 55259099, "comment_id": 97250479, "body": "arr[i]+arr[j] can be computed before the loop of k.  This is a minor optimization."}, {"owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1553104043, "post_id": 55259099, "comment_id": 97265553, "body": "@4386427 The algorithm assumes that the input does not contain duplicates."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1553117243, "post_id": 55259099, "comment_id": 97272072, "body": "ok... but how about the problem description? Where does it say that the array has no duplicates?"}], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1553233571, "post_id": 55260305, "comment_id": 97315740, "body": "Is this in Python? I want a C answer."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1553244540, "post_id": 55260305, "comment_id": 97319988, "body": "@DivyanshuVarma This is the algorithm. It is the logic.  Depending on what language you are using you write it consequently.  By PAIR(i,j) I mean a C array of dimension 2.  In C you write it pair[i][j] for example."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "reply_to_user": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1553247122, "post_id": 55260305, "comment_id": 97321448, "body": "@DivyanshuVarma StackOverflow is not a platform for solving homeworks.  If you need such platforms, I suggest you freelancer.com."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 1, "last_activity_date": 1553087307, "last_edit_date": 1553087307, "creation_date": 1553083282, "answer_id": 55260305, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c/55260305#55260305", "title": "Unique pairs with equal sum in C", "body": "<p>FIrst you precompute the sum of each pair and keep the result in a matrix <code>PAIRSUM</code>.</p>\n\n<pre><code>PAIRSUM(0, 0) = 12\nPAIRSUM(0, 1) = 10 a s o\n</code></pre>\n\n<p>Next, you loop over the <code>PAIRSUM</code> and see where 2 entries are similar.</p>\n\n<p>So you reduced the big problem to a smaller one, in which you check the equality of 2 numbers, not of 2 sums of numbers.</p>\n\n<p>For this you keep a vector <code>PAIR</code> in which at index <code>X</code> you keep the entries in <code>PAIRSUM</code> where the sum was <code>X</code>.</p>\n\n<p>For example, <code>PAIR(10) = { {0, 1} }</code>.</p>\n\n<p>You can also consider in <code>PAIRSUM</code> only the matrix above the diagonal, so for which the indexes <code>(i,j)</code> have <code>i&gt;j</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1553089864, "post_id": 55261625, "comment_id": 97255994, "body": "Calculating binomial coefficients C(<i>n</i>, <i>k</i>) via factorials is prone to overflow. If <code>size_t</code> has 64 bits, this will happen if <i>n</i> &gt; 20. You can use C(<i>n</i>, 2) = <i>n</i> &#183; (<i>n</i> \u2212 1) / 2, which is also obvious from your nested loops."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1553090063, "last_edit_date": 1553090063, "creation_date": 1553087721, "answer_id": 55261625, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c/55261625#55261625", "title": "Unique pairs with equal sum in C", "body": "<p>C code for calculating all the sums and storing the sums with indexes inside an array of structures. Then we sort the structures and print adjacent structure elements with the same sum.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;assert.h&gt;\n\n// for debugging\n#define debug(...)  ((void)0) // printf(__VA_ARGS__)\n\n// two indexes and a sum\nstruct is_s {\n    // one index inside the array\n    size_t i;\n    // the other index also inside the array\n    size_t j;\n    // no idea, must be random\n    int sum;\n};\n\n// used for qsoring the struct is_s\nstatic int is_qsort_compare_sum(const void *a0, const void *b0) {\n    const struct is_s * const a = a0;\n    const struct is_s * const b = b0;\n    return a-&gt;sum - b-&gt;sum;\n}\n\nint unique_pairs(const size_t len, const int arr[len]) {\n    if (len &lt;= 1) return 0;\n    // The number of unsorted combinations must be n!/(2!*(n-2)!)\n    const size_t islen = len * (len - 1) / 2; // @MOehm\n    debug(\"%zu\\n\", islen);\n\n    struct is_s * const is = malloc(islen * sizeof(*is));\n    if (is == NULL) {\n        return -ENOMEM;\n    }\n\n    size_t isidx = 0;\n    for (size_t i = 0; i &lt; len; ++i) {\n        for (size_t j = i + 1; j &lt; len; ++j) {\n            assert(isidx &lt; islen); // just for safety\n            struct is_s * const p = &amp;is[isidx++];\n            p-&gt;i = i;\n            p-&gt;j = j;\n            p-&gt;sum = arr[i] + arr[j];\n            debug(\"[%zu]=[%zu]=%d [%zu]=%d %d\\n\", isidx, p-&gt;i, arr[p-&gt;i], p-&gt;j, arr[p-&gt;j], p-&gt;sum);\n        }\n    }\n\n    qsort(is, islen, sizeof(*is), is_qsort_compare_sum);\n\n    for (size_t i = 0; i &lt; islen - 1; ++i) {\n        debug(\"([%zu]=%d,[%zu]=%d)%d = ([%zu]=%d,[%zu]=%d)%d\\n\", \n            is[i].i, arr[is[i].i], is[i].j, arr[is[i].j], is[i].sum,\n            is[i+1].i, arr[is[i+1].i], is[i+1].j, arr[is[i+1].j], is[i+1].sum\n        );\n        if (is[i].sum == is[i + 1].sum) {\n            printf(\"(%d,%d),(%d,%d) = %d\\n\",\n                arr[is[i].i], arr[is[i].j],\n                arr[is[i+1].i], arr[is[i+1].j], is[i].sum);\n        }\n    }\n\n    free(is);\n\n    return 0;\n}\n\nint main(void) {\n    const int arr[] = {6,4,12,10,22,54,32,42,21,11};\n    return unique_pairs(sizeof(arr)/sizeof(*arr), arr);\n}\n</code></pre>\n\n<p>The result I get is:</p>\n\n<pre><code>(6,10),(4,12) = 16\n(10,22),(21,11) = 32\n(12,21),(22,11) = 33\n(22,21),(32,11) = 43\n(32,21),(42,11) = 53\n(12,42),(22,32) = 54\n(10,54),(22,42) = 64\n</code></pre>\n\n<p>As I wonder if this is correct, as @Bathsheba noted, I think the worst case is O(n*n).</p>\n"}, {"comments": [{"owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1553139606, "post_id": 55261977, "comment_id": 97277772, "body": "&quot;The highest  sum will be less than twice the biggest number...&quot; So in the case of the given array you say I can make an array of 96 elements or 108? Also please explain this &quot;That way you ensure direct access from a sum. From there, you just use a linked list of pairs and that is all.&quot;  If I make an array then why a linked list of pairs?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "edited": false, "score": 0, "creation_date": 1553153049, "post_id": 55261977, "comment_id": 97281197, "body": "@DivyanshuVarma: because multiple pairs can give the same sum. So I use a linked list to record all the pairs giving a given sum. For the highest sum, it is trivial to find the highest value in an array, but finding the 2 topmost values is a little more complex. So for lazyness sake, I would use an array of size 108 when 96 is enough."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1553089463, "last_edit_date": 1553089463, "creation_date": 1553088846, "answer_id": 55261977, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c/55261977#55261977", "title": "Unique pairs with equal sum in C", "body": "<p>It would be easier in C++, Python, or Java because those languages provide high level containers. In Python, you could use a <code>defaultdict(list)</code> where the key would be the sums and the value a list of pairs giving that sum.</p>\n\n<p>Then you only have to process unique pairs (N<sup>2</sup> / 2)</p>\n\n<pre><code>result = collections.defaultdict(list)\nfor i, a in enumerate(A):\n    for b in A[i+1:]:\n        result[a+b].append((a,b))\n</code></pre>\n\n<p>It will be slightly more complex in C because you do not have the high-level direct access dict. If you can waste some memory and only have small numbers like here, you can say that the highest sum will be less than twice the biggest number in the input array, and directly allocate an array of that size. That way you ensure direct access from a sum. From there, you just use a linked list of pairs and that is all. As a bonus you even get a sorted list of sums.</p>\n\n<p>I you cannot assume that numbers are small you will have to build a direct access container. A hash type container using N*N/2 as size (N being the length of A) and sum%size as hash function should be enough.</p>\n\n<p>For completeness, here is a possible C code not doing the small numbers assumption (this code displays all pairs not only the ones with duplicated sums):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// a node in a linked list of pairs\nstruct pair_node {\n    int first;\n    int second;\n    struct pair_node *next;\n};\n\n// a slot for a hash type containers of pairs indexed by their sum\nstruct slot {\n    int number;\n    struct pair_node *nodes;\n    struct slot *next;\n};\n\n// utility function to find (or create) a slot for a sum\nstruct slot* find_slot(struct slot **slots, int size, int sum) {\n    struct slot *slt = slots[sum%size];\n    while (slt != NULL) {\n        if (slt-&gt;number == sum) {\n            return slt;\n        }\n        slt = slt-&gt;next;\n    }\n    slt = malloc(sizeof(struct slot));\n    slt-&gt;number = sum;\n    slt-&gt;nodes = NULL;\n    slt-&gt;next = slots[sum%size];\n    slots[sum%size] = slt;\n    return slt;\n}\n\nint main() {\n    int A[] = {6,4,12,10,22,54,32,42,21,11};  // the array of numbers\n    int N = sizeof(A) / sizeof(A[0]);\n\n    int arr_size = N * N / 2;   // size of the hash table of pairs\n    struct slot** result = malloc(arr_size * sizeof(struct slot *));\n    for (int i=0; i&lt;arr_size; i++) {\n        result[i] = NULL;\n    }\n\n    // process unique pairs\n    for (int i=0; i&lt;N-1; i++) {\n        for (int j=i+1; j&lt;N; j++) {\n            int sum = A[i] + A[j];\n            // allocate and initialize a node\n            struct pair_node *node = malloc(sizeof(*node));\n            node-&gt;first = A[i];\n            node-&gt;second = A[j];\n\n            // store the node in the hash container\n            struct slot *slt = find_slot(result, arr_size, sum);\n            node-&gt;next = slt-&gt;nodes;\n            slt-&gt;nodes = node;\n        }\n    }\n\n    // display the result\n    for (int i=0; i&lt;arr_size; i++) {\n        for (struct slot* slt=result[i]; slt != NULL;) {\n            printf(\"%d :\", slt-&gt;number);\n            struct pair_node *node = slt-&gt;nodes;\n            while(node != NULL) {\n                printf(\" (%d,%d)\", node-&gt;first, node-&gt;second);\n                node = node-&gt;next;\n                free(node);                // free what has been allocated\n            }\n            printf(\"\\n\");\n            struct slot *old = slt;\n            slt = slt-&gt;next;\n            free(old);\n        }\n    }\n    free(result);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 9131668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2e349ef0c77f84467723c8ff9aacae6?s=128&d=identicon&r=PG", "display_name": "Dru01", "link": "https://stackoverflow.com/users/9131668/dru01"}, "is_accepted": false, "score": 0, "last_activity_date": 1553132386, "last_edit_date": 1553132386, "creation_date": 1553093123, "answer_id": 55263560, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c/55263560#55263560", "title": "Unique pairs with equal sum in C", "body": "<p>It can be done in O(N^2 * log(N^2) * M), where M is the maximum number of pairs(i, j) that have the same sum, so in worst case it would be O(N^3 * log(N)).</p>\n\n<p>Lets iterate for every pair 0 &lt;= <strong>i,j</strong> &lt; N in order (increasing or decreasing), we have to save the sum of all the previous pairs(i, j) (to know which previous pairs have a certain sum) this can be done with a map with a integer key and a vector of pairs for the mapped value; then for every pair(i, j) you search in the map for it's sum (key = A[i] + A[j]), then al the pairs store in map[sum] are answers to this pair(i, j).</p>\n\n<p>You don't have to worry about for the following pairs to (i, j) that have the sum because the following pairs when they be processed they will count it.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13956245, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjJ_sthxAurTFvTnldp4Tit6T3d9_k92JGymepEJA=k-s128", "display_name": "Rajat Rastogi", "link": "https://stackoverflow.com/users/13956245/rajat-rastogi"}, "is_accepted": false, "score": 0, "last_activity_date": 1614597799, "last_edit_date": 1614597799, "creation_date": 1614592846, "answer_id": 66419999, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c/66419999#66419999", "title": "Unique pairs with equal sum in C", "body": "<p>Here is a Java solution:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.*;\n\nclass Duplicate {\n  public static void main(String[] args) {\n    \n    int [] a = {5,3,1,4,5,6,3,7,0,10,6,4,9,1};\n    \n    List&lt;Integer&gt; li = new ArrayList&lt;Integer&gt;();\n    \n    int p1=0, p2=0;\n    \n    for(int i=0; i&lt;a.length;i++) {\n      for(int j=i+1; j&lt;a.length;j++){\n        \n        if(a[i]+a[j] == 10) {\n          \n          p1 = a[i];\n          p2 = a[j];\n          \n          if(!li.contains(Math.abs(p2-p1))) {\n              \n            li.add(Math.abs(p2-p1));\n            \n            System.out.println(&quot;Pairs&quot; + &quot;:&quot; + p1 + &quot;,&quot; + p2);\n          }\n        }\n        p1=0;\n        p2=0;\n      }\n    }\n    \n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 120, "user_id": 4080322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28464b305895662d6d0defe2baf7542?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu Varma", "link": "https://stackoverflow.com/users/4080322/divyanshu-varma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 55260305, "answer_count": 5, "score": 0, "last_activity_date": 1614597799, "creation_date": 1553079383, "last_edit_date": 1553092640, "question_id": 55259099, "link": "https://stackoverflow.com/questions/55259099/unique-pairs-with-equal-sum-in-c", "title": "Unique pairs with equal sum in C", "body": "<p>The question at hand is:</p>\n\n<p><strong>Q8.</strong> Given an unsorted array A[]. The task is to print all <strong>unique pairs</strong> in the unsorted array with equal sum. Consider the Input: A[] = {6, 4, 12, 10, 22, 54, 32, 42, 21, 11}<br>\nExplain the approach of solving the above problem, and write the code in any one programming language C/C++/Python/Java. What is the time complexity of the above problem?</p>\n\n<p>Here is my solution to the above problem (in C) :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(){\n    int arr[]={6,4,12,10,22,54,32,42,21,11};\n    int len=sizeof(arr)/sizeof(arr[0]);\n    for(int i=0;i&lt;len;i++)\n        for(int j=i+1;j&lt;len;j++)\n            for(int k=i+1;k&lt;len;k++)\n                for(int l=k+1;l&lt;len;l++)\n                    if(arr[i]+arr[j]==arr[l]+arr[k])\n                        printf(\"(%d,%d),(%d,%d)\\n\",arr[i],arr[j],arr[k],arr[l]);\n    return 0;\n}\n</code></pre>\n\n<p>My logic is to take one element at a time, and take its sum with every other element, and for each such iteration, compare the sum of two other unique pair of elements to it. \nFor example, when i=0, j=3, arr[i]+arr[j]=16. When k=1,l=2, arr[k]+arr[l]=16. Since the pairs are unique (6,10) and (4,12) and their sum is equal, I print them. \nNote that the pairs are assumed to be unordered pairs so that (a,b) is the same as (b,a) and so we don't need to repeat that, as they have to be unique.</p>\n\n<p>My question is : I know that my code is almost O(n^4). How can I improve/optimise it further?</p>\n"}, {"tags": ["c", "fork"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1553079117, "post_id": 55258933, "comment_id": 97249292, "body": "how do you define &quot;main process&quot; ? Do you mean the original process ?"}, {"owner": {"reputation": 199, "user_id": 9093787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0836609c8efb77c82494e4c123f29509?s=128&d=identicon&r=PG&f=1", "display_name": "javac", "link": "https://stackoverflow.com/users/9093787/javac"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1553099824, "post_id": 55258933, "comment_id": 97263128, "body": "@SanderDeDycker yes"}], "answers": [{"tags": [], "owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "is_accepted": true, "score": 5, "last_activity_date": 1553079828, "creation_date": 1553079828, "answer_id": 55259227, "question_id": 55258933, "link": "https://stackoverflow.com/questions/55258933/difference-between-parent-and-main-process-and-how-to-detect-a-main-process/55259227#55259227", "title": "Difference between parent and main process and how to detect a main process?", "body": "<p>Your code creates 4 processes :</p>\n\n<ul>\n<li><code>(a &gt; 0) &amp;&amp; (b &gt; 0)</code> : the original process</li>\n<li><code>(a == 0) &amp;&amp; (b &gt; 0)</code> : the first child process of the original process (child A)</li>\n<li><code>(a &gt; 0) &amp;&amp; (b == 0)</code> : the second child process of the original process (child B)</li>\n<li><code>(a == 0) &amp;&amp; (b == 0)</code> : the first child process of child A (child AA)</li>\n</ul>\n\n<p>Remember that <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fork.html\" rel=\"noreferrer\"><code>fork</code></a> creates a child process, and returns the pid of this child process in the parent process, and returns 0 in the child process.</p>\n"}], "owner": {"reputation": 199, "user_id": 9093787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0836609c8efb77c82494e4c123f29509?s=128&d=identicon&r=PG&f=1", "display_name": "javac", "link": "https://stackoverflow.com/users/9093787/javac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 55259227, "answer_count": 1, "score": 0, "last_activity_date": 1553079828, "creation_date": 1553078860, "question_id": 55258933, "link": "https://stackoverflow.com/questions/55258933/difference-between-parent-and-main-process-and-how-to-detect-a-main-process", "title": "Difference between parent and main process and how to detect a main process?", "body": "<p>Below example I create 3 another process and I have also 1 main process. So totally, there are 4 process which is executing. My question that I can check the which process is parent and which process is child by controlling the return value of the <code>fork</code> system call function. However how can I detect the main process execution? And what is the difference between a main process and parent process?</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt; \nint main() \n{ \n    int a =fork(); \n    int b =fork(); \n\n\n    if (a == 0) \n        printf(\"Hello from Child(A)!\\n\"); \n\n    // parent process because return value non-zero. \n    else\n        printf(\"Hello from Parent(A)!\\n\"); \n\n    if (b == 0) \n        printf(\"Hello from Child(B)!\\n\"); \n\n    // parent process because return value non-zero. \n    else\n        printf(\"Hello from Parent(B)!\\n\"); \n\n\n    return 0; \n} \n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 3, "creation_date": 1553076250, "post_id": 55258062, "comment_id": 97247626, "body": "You&#39;ve declared all your multiple indirection pointers as single indirection pointers."}, {"owner": {"reputation": 201, "user_id": 2415465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4495f601aa5b3e226e7968e79532d81?s=128&d=identicon&r=PG", "display_name": "Noxet", "link": "https://stackoverflow.com/users/2415465/noxet"}, "edited": false, "score": 0, "creation_date": 1553076290, "post_id": 55258062, "comment_id": 97247650, "body": "There is nothing stating that 2 consecutive mallocs lie close to eachother. It can allocate memory basically anywhere. You just have to make sure that one heap-node points to the next one. Also I do not think your implementation, using stuff lite char ***, is correct either"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1553078110, "post_id": 55258062, "comment_id": 97248680, "body": "<code>char*** stackP = heap1P;</code> isn&#39;t even valid C. Most of this code won&#39;t compile cleanly."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1553096524, "post_id": 55258062, "comment_id": 97260876, "body": "At least formally there is no question here."}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1553089051, "post_id": 55258366, "comment_id": 97255432, "body": "&quot;<i>you would want something like</i>&quot; Why?"}, {"owner": {"reputation": 201, "user_id": 2415465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4495f601aa5b3e226e7968e79532d81?s=128&d=identicon&r=PG", "display_name": "Noxet", "link": "https://stackoverflow.com/users/2415465/noxet"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1553096291, "post_id": 55258366, "comment_id": 97260702, "body": "I wrote &quot;I <i>think</i> you would want ..&quot;. I assumed that this was what OP was looking for. An easy, general way of implementing a list."}], "tags": [], "owner": {"reputation": 201, "user_id": 2415465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4495f601aa5b3e226e7968e79532d81?s=128&d=identicon&r=PG", "display_name": "Noxet", "link": "https://stackoverflow.com/users/2415465/noxet"}, "is_accepted": false, "score": 0, "last_activity_date": 1553077123, "creation_date": 1553077123, "answer_id": 55258366, "question_id": 55258062, "link": "https://stackoverflow.com/questions/55258062/multiple-linked-pointers/55258366#55258366", "title": "Multiple linked pointers", "body": "<p>I think you would want something like:</p>\n\n<pre><code>typedef struct heap {\n    char val;\n    struct heap *next;\n} heap_t;\n\nint main()\n{\n    // allocate first\n    heap_t *head = malloc(sizeof(heap_t));\n    head-&gt;val = 'A';\n    // allocate second node\n    head-&gt;next = malloc(sizeof(heap_t));\n    head-&gt;next-&gt;val = 'B';\n\n    head-&gt;next-&gt;next = malloc(sizeof(heap_t));\n    head-&gt;next-&gt;next-&gt;val = 'X';\n\n    heap_t *tmp = head;\n    for (int i = 0; i &lt; 3; i++, tmp = tmp-&gt;next) {\n        printf(\"[%p, %c]\\n\", tmp, tmp-&gt;val);\n    }\n}\n</code></pre>\n\n<p>Note that this is a quick draft, and you should of course do the creation of new nodes inside a function, not the manual way I did here. Do not forget to free the memory afterwards.</p>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1553089309, "post_id": 55259367, "comment_id": 97255617, "body": "I&#39;d drop this <code>***</code>-comment. In the context of the question it does not add value to the answer  and as well can very well be taken a your personal opinion. If left in, it made sense to elaborate more on what the &quot;<i>specific use cases</i>&quot; were and with  doing so diverting away from the question even more."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1553089808, "post_id": 55259367, "comment_id": 97255966, "body": "@alk: you are probably right. I wrote it because I have never seen a real world use case for <code>***</code> but I agree that it is irrelevant for the question. I have removed it from the answer."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 5, "last_activity_date": 1553089673, "last_edit_date": 1553089673, "creation_date": 1553080234, "answer_id": 55259367, "question_id": 55258062, "link": "https://stackoverflow.com/questions/55258062/multiple-linked-pointers/55259367#55259367", "title": "Multiple linked pointers", "body": "<p>The problem is only that you have declared the various pointer as <code>char *</code>. It may look unimportant, because in common implementations all pointers have same representation. But it becomes essential as soon as you dereference them!</p>\n\n<p>Let us look at the following statements:</p>\n\n<pre><code>*heap3P = 'X';\n*heap2P = heap3P;\n</code></pre>\n\n<p>First one is correct: <code>heap3P</code> is a <code>char *</code> and <code>*heap3P</code> is assigned a <code>char</code>, all is fine here.</p>\n\n<p>Second one is terrible. As <code>heap2P</code> is a <code>char *</code>, <code>heap3P</code> if converted to an integer and trimmed into a <code>char</code>! Long story short: you only store one byte from the pointer... And if you look carefully to the values, you will see that the different <code>heapx</code> are indeed single byte values...</p>\n\n<p>The fix is trivial:</p>\n\n<pre><code>char*** heap1P = malloc(sizeof(char**));\nchar** heap2P = malloc(sizeof(char*));\nchar* heap3P = malloc(sizeof(char));\n</code></pre>\n\n<p>and the code compiles without a warning and runs as expected!</p>\n"}], "owner": {"reputation": 593, "user_id": 7390885, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ddd5e4e7377bfc8a1ac97f0755a2dfc2?s=128&d=identicon&r=PG&f=1", "display_name": "tomole", "link": "https://stackoverflow.com/users/7390885/tomole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55259367, "answer_count": 2, "score": 1, "last_activity_date": 1553539531, "creation_date": 1553076054, "last_edit_date": 1553246843, "question_id": 55258062, "link": "https://stackoverflow.com/questions/55258062/multiple-linked-pointers", "title": "Multiple linked pointers", "body": "<p>For a homework I have to build the following simple scenario.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pBkkh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pBkkh.png\" alt=\"enter image description here\"></a></p>\n\n<p>My attempt looks like:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main() {\n  char* heap1P = malloc(sizeof(char**));\n  char* heap2P = malloc(sizeof(char*));\n  char* heap3P = malloc(sizeof(char));\n\n  *heap3P = 'X';\n  *heap2P = heap3P;\n  *heap1P = heap2P;\n\n  char*** stackP = heap1P;\n\n  puts(\"stack                           | heap \");\n  printf(\"%p [%p] | %p [%p] =&gt; %p [%p] =&gt; %c [%p] \\n\", stackP, &amp;stackP, *heap1P, heap1P, *heap2P, heap2P, *heap3P, heap3P);\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>First I allocate space in memory and after that I set the values.\nThe output is like (format: value [address]):</p>\n\n<pre><code>stack                           | heap \n0x55a1e184f260 [0x7fff05e55c08] | 0xffffff80 [0x55a1e184f260] =&gt; 0xffffffa0 [0x55a1e184f280] =&gt; X [0x55a1e184f2a0] \n</code></pre>\n\n<p>As you can see the stack value contains the address of the first heap value. But the heap values are not correct. They do not contain the address of the following heap value.</p>\n\n<p>Why the heap values do not contain the given addresses?</p>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1553075041, "post_id": 55257703, "comment_id": 97246815, "body": "It takes a function pointer, but if you pass the function&#39;s name instead, it will automatically decay to a pointer of that function. Similarly to how arrays decay to pointers, too."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1553075101, "post_id": 55257703, "comment_id": 97246852, "body": "A function provided as argument (not as a function call), the compiler automatically takes its address - there is no other sensibe interpretation of <code>&amp;</code> on a funcion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1553075593, "post_id": 55257703, "comment_id": 97247165, "body": "Are you asking why <code>int max(int x, int y, int compare(int, int))</code> works and behaves the same as the posted code?"}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553089257, "post_id": 55258134, "comment_id": 97255576, "body": "I do like the second &quot;obscure&quot; parameter declaration... :( less to type."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 4, "last_activity_date": 1553076300, "creation_date": 1553076300, "answer_id": 55258134, "question_id": 55257703, "link": "https://stackoverflow.com/questions/55257703/c-function-pointer-differences/55258134#55258134", "title": "C Function Pointer Differences", "body": "<p>These 2 versions are equivalent:</p>\n\n<ul>\n<li><code>int max(int x, int y, int (*compare)(int, int))</code></li>\n<li><code>int max(int x, int y, int compare(int, int))</code></li>\n</ul>\n\n<p>Just like arrays passed as parameters to functions \"decay\" into pointers to the first element, similar \"decay\" happens to functions. They decay into function pointers. The standard says</p>\n\n<blockquote>\n  <p>A declaration of a parameter as \u2018\u2018function returning type\u2019\u2019 shall be adjusted to \u2018\u2018pointer to\n  function returning type\u2019\u2019</p>\n</blockquote>\n\n<p>So the second (obscure) version above gets silently translated by the compiler into the first version. But there is never a reason to declare a function inside a parameter list, so this whole issue is quite exotic.</p>\n\n<hr>\n\n<p>As for why <code>compare(x,y)</code> works as fine as <code>(*compare)(x,y)</code> or for that matter <code>(*****compare)(x,y)</code>, it is because whenever you use either a function name or function pointer, you always get a function pointer. If you try to de-reference the function pointer, you get the function. Which again bounces back implicitly into a function pointer. </p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/6893285/why-do-function-pointer-definitions-work-with-any-number-of-ampersands-or-as\">Why do function pointer definitions work with any number of ampersands &#39;&amp;&#39; or asterisks &#39;*&#39;?</a></p>\n\n<hr>\n\n<p>Beginners and veterans all alike can safely forget about the above obscure rules, and just do this:</p>\n\n<pre><code>int max(int x, int y, int (*compare)(int, int))\n{\n  return compare(x,y) ? x : y;\n}\n</code></pre>\n\n<p>Or better yet, use typedef:</p>\n\n<pre><code>typedef int compare_t (int, int);\n\n...\n\nint max(int x, int y, compare_t* compare)\n{\n  return compare(x,y) ? x : y;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 8919345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f4fbfdd07a2ea0818c9fa43f967270?s=128&d=identicon&r=PG&f=1", "display_name": "LIH", "link": "https://stackoverflow.com/users/8919345/lih"}, "is_accepted": false, "score": 0, "last_activity_date": 1553087564, "creation_date": 1553087564, "answer_id": 55261572, "question_id": 55257703, "link": "https://stackoverflow.com/questions/55257703/c-function-pointer-differences/55261572#55261572", "title": "C Function Pointer Differences", "body": "<p>Great answer given by Lundin before.\nRep too low to comment, so I'll put this here as extra. I saw the link on a similar post here on stackoverflow, I liked the tutorial.</p>\n\n<p>Origin of link to tutorial is this question: <a href=\"https://stackoverflow.com/questions/9410/how-do-you-pass-a-function-as-a-parameter-in-c\">How do you pass a function as a parameter in C?</a></p>\n\n<p>Function pointer tutorial mentioned in the above: <a href=\"http://www.newty.de/fpt/index.html\" rel=\"nofollow noreferrer\">http://www.newty.de/fpt/index.html</a></p>\n\n<p>Hope I'm not being presumptuous, I liked it, maybe it will make for a pleasant read for you as well.</p>\n"}], "owner": {"reputation": 144, "user_id": 5130294, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hcKBQ1drrAU/AAAAAAAAAAI/AAAAAAAAABY/bZbhPsTml50/photo.jpg?sz=128", "display_name": "Nova Shadowflame", "link": "https://stackoverflow.com/users/5130294/nova-shadowflame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 3, "answer_count": 2, "score": 1, "last_activity_date": 1553087564, "creation_date": 1553074943, "question_id": 55257703, "link": "https://stackoverflow.com/questions/55257703/c-function-pointer-differences", "title": "C Function Pointer Differences", "body": "<p>I have the following C Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint max(int x, int y, int (*compare)(int, int))\n{\n  return (*compare)(x,y) ? x : y;\n}\n\nint greater_than(int x, int y)\n{\n  if(x &gt; y) return 1;\n  else return 0;\n}\n\nint main(void) {\n printf(\"%d\",max(6,7,greater_than));\n}\n</code></pre>\n\n<p>It's just there to test function pointers. But the code still works the same even if i dont use <code>int (*compare)(int,int)</code> but <code>int compare(int,int)</code>. It also works if I don't dereference the function pointer or if use <code>int compare(int,int)</code> but still dereference. It also doesn't make a difference if I pass <code>greater_than</code> or <code>&amp;greater_than</code>. Why is this?</p>\n\n<p>With regards\nNova</p>\n"}, {"tags": ["c", "shell", "fork", "dup2"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1553076566, "post_id": 55257628, "comment_id": 97247823, "body": "What is the one that doesn&#39;t work supposed to do?"}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1553077133, "post_id": 55257628, "comment_id": 97248142, "body": "The first one is supposed to work but i don&#39;t understand why it doesn&#39;t work"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1553077177, "post_id": 55257628, "comment_id": 97248162, "body": "Define <i>work</i>. What is it supposed to be doing that it&#39;s not? What is it doing instead?"}, {"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1553077230, "post_id": 55257628, "comment_id": 97248191, "body": "It supposed to display on the terminal the 10 first character of my ls command but it doing nothing. It&#39;s because i do the dup2() before the fork but i don&#39;t understand why it doesn&#39;t work in this case"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1553079356, "post_id": 55257628, "comment_id": 97249432, "body": "How do you know if it works or not?  You don&#39;t check the return value."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1553082143, "post_id": 55257628, "comment_id": 97251086, "body": "Why would you expect your first one to display anything on the terminal? You change what standard output (FD 1) goes to."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1553139586, "post_id": 55262204, "comment_id": 97277766, "body": "Thanks for your response ! What i need to do to handle big traffic ?"}, {"owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "reply_to_user": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "edited": false, "score": 0, "creation_date": 1553139693, "post_id": 55262204, "comment_id": 97277789, "body": "@Progear yes, to handle big traffic you must read the pipe before waiting for the child to finish. In your case, replace <code>read</code> and <code>wait</code>"}], "tags": [], "owner": {"reputation": 7262, "user_id": 4955498, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DQswbNCOBTs/AAAAAAAAAAI/AAAAAAAAADE/avTd-sX467I/photo.jpg?sz=128", "display_name": "Michael Veksler", "link": "https://stackoverflow.com/users/4955498/michael-veksler"}, "is_accepted": true, "score": 2, "last_activity_date": 1553089472, "creation_date": 1553089472, "answer_id": 55262204, "question_id": 55257628, "link": "https://stackoverflow.com/questions/55257628/why-when-i-use-dup2-before-fork-it-doesnt-work/55262204#55262204", "title": "Why when i use dup2() before fork() it doesn&#39;t work?", "body": "<p>The original does not work correctly because:</p>\n\n<blockquote>\n<pre><code>dup2(test[1], 1);\nif (fork() == 0) {\n    execve(av[0], av, env);\n}\nelse {\n    wait(NULL);\n    read(test[0], str, 10);\n    write(1, str, 10);\n}\n</code></pre>\n</blockquote>\n\n<p>After the <code>dup2</code> stdout is redirected to the pipe. This redirection applies both to the parent and the child. Due to that, the line:</p>\n\n<blockquote>\n<pre><code>    write(1, str, 10);\n</code></pre>\n</blockquote>\n\n<p>writes its data back to the pipe, not the original stdout (which is lost).</p>\n\n<p>By moving the <code>dup2</code> to after the <code>fork()</code>, and only to the child process, the original stdout of the parent is left alone. In that case only the child's stdout gets redirected.</p>\n\n<p>Note: calling <code>wait</code> before reading the pipe will work for small pipe traffic like in the example, but won't work for big traffic. The issue is that the pipe has a limited buffer. Once the buffer is full, the pipe starts to block writes. The <code>wait</code> will wait on the child to finish, but the child will wait on the pipe to be read by the parent. This can become a deadlock when the traffic is big enough.</p>\n"}], "owner": {"reputation": 157, "user_id": 9854362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5945ede330ed0d02c223a2ab56b1653?s=128&d=identicon&r=PG&f=1", "display_name": "Progear", "link": "https://stackoverflow.com/users/9854362/progear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 55262204, "answer_count": 1, "score": 2, "last_activity_date": 1554538047, "creation_date": 1553074688, "last_edit_date": 1554538047, "question_id": 55257628, "link": "https://stackoverflow.com/questions/55257628/why-when-i-use-dup2-before-fork-it-doesnt-work", "title": "Why when i use dup2() before fork() it doesn&#39;t work?", "body": "<p>I want to make a shell and i want to handle multiple pipe. I tried to understand how works dup2() and fork. Normally, fork(), create a new child process who is exactly the same as the father. But when i use dup2 before the fork it doesn't seem to works how i things it should do. But when i use dup2() in the child process it works... I don't understand because normally fork create a copy of the calling process...</p>\n\n<p>Can someone explain why? </p>\n\n<p>This does not work:</p>\n\n<pre><code>int fd = open(\"toto.txt\", O_RDONLY);\nchar str[10] = {0};\nint test[2] = {0, 0};\nchar *av[] = {\"/bin/ls\", NULL};\n\npipe(test);\ndup2(test[1], 1);\nif (fork() == 0) {\n    execve(av[0], av, env);\n}\nelse {\n    wait(NULL);\n    read(test[0], str, 10);\n    write(1, str, 10);\n}\n</code></pre>\n\n<p>but this works :</p>\n\n<pre><code>int fd = open(\"toto.txt\", O_RDONLY);\nchar str[10] = {0};\nint test[2] = {0, 0};\nchar *av[] = {\"/bin/ls\", NULL};\n\npipe(test);\nif (fork() == 0) {\n    dup2(test[1], 1);\n    execve(av[0], av, env);\n}\nelse {\n    wait(NULL);\n    read(test[0], str, 10);\n    write(1, str, 10);\n}\n</code></pre>\n"}, {"tags": ["c", "file", "conditional-statements", "fopen", "race-condition"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 2, "creation_date": 1553074002, "post_id": 55257043, "comment_id": 97246192, "body": "What exactly is your problem? You know how to read an existing file. Try to do it. If it fails, create a new file."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1553074085, "post_id": 55257043, "comment_id": 97246235, "body": "Hint: checking return values of your file operations is mandatory! They tell you what to do."}, {"owner": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 0, "creation_date": 1553084948, "post_id": 55257043, "comment_id": 97252922, "body": "There is race-condition tag in the question. Some answers seems to allow opening a file for writing for several processes at the same time."}, {"owner": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "reply_to_user": {"reputation": 7193, "user_id": 765971, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f390fb2ccc9321e41ca5bcd09cb9a9a?s=128&d=identicon&r=PG", "display_name": "SKi", "link": "https://stackoverflow.com/users/765971/ski"}, "edited": false, "score": 0, "creation_date": 1553085745, "post_id": 55257043, "comment_id": 97253400, "body": "@SKi that&#39;s alright, I&#39;m happy for any contributions. Even if an answer&#39;s not perfect, I can generally still learn something useful from it. I take them all with a grain of salt anyway. I knew it was inevitable the race condition would be a point of contention, so the tag seemed appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "edited": false, "score": 0, "creation_date": 1553075410, "post_id": 55257550, "comment_id": 97247042, "body": "1. I wasn&#39;t aware I could do that, or how to do it, but it sounds good. Like <code>try</code>, <code>except</code> in python. 2. Sorry, <code>printf</code> was a typo, it was meant to be <code>fprintf</code> like you say, I fixed it up in the question. Maybe I should have left it for posterity, I&#39;m not sure."}, {"owner": {"reputation": 86, "user_id": 4609359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-POS-hArKiDA/AAAAAAAAAAI/AAAAAAAABRk/t5tJ_w9L7MM/photo.jpg?sz=128", "display_name": "Igor Munkin", "link": "https://stackoverflow.com/users/4609359/igor-munkin"}, "reply_to_user": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "edited": false, "score": 2, "creation_date": 1553075934, "post_id": 55257550, "comment_id": 97247408, "body": "This is somewhat like <code>try</code>-<code>except</code>, <i>except</i> that technically it&#39;s totally not. URW ;)"}, {"owner": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "edited": false, "score": 0, "creation_date": 1553080103, "post_id": 55257550, "comment_id": 97249891, "body": "Cool. I think I understand. So what does the code look like in context? This seems like a better answer than the other, but it&#39;s much easier to understand when I can see the code and visualize how it pieces together. I mean, it probably makes a lot of sense to people who are already familiar with it. But I&#39;m still finding my feet. Is it like: <code>if (fp == NULL) { fp -&gt;</code>.. something or other?"}, {"owner": {"reputation": 86, "user_id": 4609359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-POS-hArKiDA/AAAAAAAAAAI/AAAAAAAABRk/t5tJ_w9L7MM/photo.jpg?sz=128", "display_name": "Igor Munkin", "link": "https://stackoverflow.com/users/4609359/igor-munkin"}, "reply_to_user": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "edited": false, "score": 1, "creation_date": 1553086500, "post_id": 55257550, "comment_id": 97253863, "body": "I&#39;ve updated my answer as you both suggested and removed the one below, thanks!"}], "tags": [], "owner": {"reputation": 86, "user_id": 4609359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-POS-hArKiDA/AAAAAAAAAAI/AAAAAAAABRk/t5tJ_w9L7MM/photo.jpg?sz=128", "display_name": "Igor Munkin", "link": "https://stackoverflow.com/users/4609359/igor-munkin"}, "is_accepted": false, "score": 4, "last_activity_date": 1553086263, "last_edit_date": 1553086263, "creation_date": 1553074415, "answer_id": 55257550, "question_id": 55257043, "link": "https://stackoverflow.com/questions/55257043/how-to-read-a-configuration-file-or-create-one-if-its-missing/55257550#55257550", "title": "How to read a configuration file, or create one if it&#39;s missing", "body": "<p>Considering your example there are two main mistakes:</p>\n\n<ol>\n<li>You don't check the result of <code>fopen</code> thus you don't know whether your file has been successfully opened (here is the key to the answer).</li>\n<li><code>printf</code> function prints directrly to <code>stdout</code> and you have to use <code>fprintf</code> one for printing to your configuration file.</li>\n</ol>\n\n<p>I propose the following: try to <code>fopen</code> your configuration file (e.g. <code>./filename.txt</code>) for <code>r</code> and check the result of this call. Upon successful completion <code>fopen</code> return a <code>FILE</code> pointer to your <em>existing</em> configuration file. If the file doesn't exist <code>fopen</code> returns <code>NULL</code> and errno is set to <code>ENOENT</code>. In this case you can create a new configuration file and write a default config into it.</p>\n\n<p>Please see <code>man 3</code> section for the corresponding docs.</p>\n\n<p><strong>UPD</strong>:</p>\n\n<p>Here is PoC for the proposal</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n\nint main() {\n    FILE *fp = fopen(\".rc\", \"r\");\n    if (!fp)\n        switch (errno) {\n            case ENOENT:\n                fprintf(stderr, \"No config found, creating the default one\\n\");\n                fp = fopen(\".rc\", \"w\");\n                if (!fp) {\n                    perror(\"Failed to create default config: \");\n                    return EXIT_FAILURE;\n                }\n                /* write default config here */\n                break;\n            default:\n                perror(\"Failed to open existing config: \");\n                return EXIT_FAILURE;\n        }\n\n    /* read existing config here */\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1553079185, "post_id": 55257811, "comment_id": 97249332, "body": "Now you have to check two API call results, first <code>stat</code> then <code>fopen</code>, why not directly try to open the file. What is the advantage of calling stat first?"}, {"owner": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "edited": false, "score": 0, "creation_date": 1553080161, "post_id": 55257811, "comment_id": 97249928, "body": "Thanks, for the suggestion. I appreciate the example."}, {"owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "reply_to_user": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1553092150, "post_id": 55257811, "comment_id": 97257625, "body": "@JensM&#252;hlenhoff, there is none, just another approach."}], "tags": [], "owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "is_accepted": false, "score": 0, "last_activity_date": 1553075285, "last_edit_date": 1592644375, "creation_date": 1553075285, "answer_id": 55257811, "question_id": 55257043, "link": "https://stackoverflow.com/questions/55257043/how-to-read-a-configuration-file-or-create-one-if-its-missing/55257811#55257811", "title": "How to read a configuration file, or create one if it&#39;s missing", "body": "<p>Use <a href=\"http://man7.org/linux/man-pages/man2/stat.2.html\" rel=\"nofollow noreferrer\">stat</a> before opening your file. If the stat is successful then the file exists, if it is not, check for ENOENT in errno.</p>\n<h1>Example</h1>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    struct stat file_infos;\n    char file_path[] = &quot;/whatever&quot;\n    if (stat(file_path, &amp;file_infos) != 0)\n    {\n        if (errno == ENOENT)\n        {\n            // Do whatever when the file wasn't found\n        }\n        else\n        {\n            // Error accessing the file, check the errno for more infos\n        }\n    }\n    else\n    {\n        // File exists, do whatever you like with it.\n    }\n}\n</code></pre>\n<p>Enjoy :)</p>\n"}], "owner": {"reputation": 323, "user_id": 6998458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lDoQr.jpg?s=128&g=1", "display_name": "voices", "link": "https://stackoverflow.com/users/6998458/voices"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553086263, "creation_date": 1553072758, "last_edit_date": 1553074890, "question_id": 55257043, "link": "https://stackoverflow.com/questions/55257043/how-to-read-a-configuration-file-or-create-one-if-its-missing", "title": "How to read a configuration file, or create one if it&#39;s missing", "body": "<p>How do you make a file, but only if it doesn't already exist? Like.. I want to read a text file, but if it doesn't exist, I want to create one with some default text.</p>\n\n<p>I can create the file with the default text easy enough. And I can append or overwrite it if it already exists. </p>\n\n<p>But if it already contains some text, I want to READ FROM it. Not WRITE TO it. Like you might do with a dot file or configuration file, to set a default configuration in the event the file is missing.</p>\n\n<p>This is quite simple with Python, but I'm trying to make the transition to C, and It's more challenging than I'd anticipated. </p>\n\n<hr>\n\n<p>So my function basically looks something like this so far. The text is just a placeholder for whatever the real text might be.</p>\n\n<pre><code>main() {\n    FILE *fp;\n\n    fp = fopen(\"./filename.txt\", \"w\");\n    fprintf(fp, \"some default text\\n\");\n    fclose(fp);\n}\n</code></pre>\n\n<hr>\n\n<p>So just to clarify: If <code>./file.txt</code> already exists, it shouldn't be written to. It should be read from. </p>\n\n<p>When I say \"read from\", it could be printed to <code>stdout</code>, or stored in an array for instance, but that's probably beyond the scope of the question. </p>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553072707, "post_id": 55256970, "comment_id": 97245440, "body": "scanning <code>%c</code> is not efficient either, use <code>fgetc</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553072804, "post_id": 55256970, "comment_id": 97245490, "body": "There are <a href=\"https://en.cppreference.com/w/c/string/byte\" rel=\"nofollow noreferrer\">many functions in standard C dealing with characters and strings</a>. I&#39;m sure you&#39;ll be able to find a function that <a href=\"https://en.cppreference.com/w/c/string/byte/strstr\" rel=\"nofollow noreferrer\">finds a substring</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553072817, "post_id": 55256970, "comment_id": 97245504, "body": "as for the &quot;I can&#39;t use <code>&lt;string.h&gt;</code>&quot;... you <i>know</i> what function you could use <i>if</i> you could use it, i.e. <code>strstr</code>, then google for <i>&quot;strstr c implementation site:stackoverflow.com&quot;</i>"}, {"owner": {"reputation": 31, "user_id": 11208268, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jr0WhqgO5BQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTZotymMf_o9ApQ6ulWVD0bheqwA/mo/photo.jpg?sz=128", "display_name": "Martin Indrych", "link": "https://stackoverflow.com/users/11208268/martin-indrych"}, "edited": false, "score": 0, "creation_date": 1553072853, "post_id": 55256970, "comment_id": 97245524, "body": "I surely can, but I can&#39;t use any. That&#39;s the problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1553073294, "post_id": 55256970, "comment_id": 97245779, "body": "If you know which function <i>could</i> be used, then it&#39;s very easy to use its name to find tutorials and examples on how to use it. For example searching for <code>strstr c example</code> or <code>strstr c tutorial</code>."}, {"owner": {"reputation": 31, "user_id": 11208268, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jr0WhqgO5BQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTZotymMf_o9ApQ6ulWVD0bheqwA/mo/photo.jpg?sz=128", "display_name": "Martin Indrych", "link": "https://stackoverflow.com/users/11208268/martin-indrych"}, "edited": false, "score": 0, "creation_date": 1553073572, "post_id": 55256970, "comment_id": 97245933, "body": "I understand you, and your functions, but I can&#39;t use any library in this work, so any of the funtions you sent me cannot be used.."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1553073824, "post_id": 55256970, "comment_id": 97246082, "body": "I guess, you don&#39;t really understand what is suggested. If you search for the implementation of a given function you can add your own version of that function to your project. No library involved."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553077155, "post_id": 55257519, "comment_id": 97248153, "body": "This isn&#39;t an answer. The question states <i>&quot;I can&#39;t use the string.h library or any other that helps similarly.&quot;</i> And your second part directs the reader to another question, with no actual solution proposed here."}], "tags": [], "owner": {"reputation": 1, "user_id": 6641410, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h2OTyC3zTU0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcMs7DBrSgkEIsfXRRcgmjYgpI54Q/photo.jpg?sz=128", "display_name": "Benjamin", "link": "https://stackoverflow.com/users/6641410/benjamin"}, "is_accepted": false, "score": 0, "last_activity_date": 1553074329, "creation_date": 1553074329, "answer_id": 55257519, "question_id": 55256970, "link": "https://stackoverflow.com/questions/55256970/how-to-find-small-string-in-big-string-in-c/55257519#55257519", "title": "How to find small string in big string in C?", "body": "<p>I suppose you are working on linux. </p>\n\n<p>For your first question.\nmemmem() should find the needle in your haystack;</p>\n\n<p>From the memmem() manpage:</p>\n\n<blockquote>\n  <p>The memmem() function finds the start of the first occurrence of the\n  substring needle of length needlelen in the memory area haystack of\n  length haystacklen.</p>\n  \n  <p>memmem returns:</p>\n  \n  <p>The memmem() function returns a pointer to the beginning of the\n   substring, or NULL if the substring is not found.</p>\n</blockquote>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/memmem.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/memmem.3.html</a></p>\n\n<p>For your second question:\n<a href=\"https://stackoverflow.com/questions/18649547/how-to-find-the-length-of-argv-in-c\">How to find the length of argv[] in C</a></p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 6139796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70e8ec623799f48125b0aa020475091d?s=128&d=identicon&r=PG", "display_name": "Holger", "link": "https://stackoverflow.com/users/6139796/holger"}, "is_accepted": false, "score": 0, "last_activity_date": 1553084323, "creation_date": 1553084323, "answer_id": 55260628, "question_id": 55256970, "link": "https://stackoverflow.com/questions/55256970/how-to-find-small-string-in-big-string-in-c/55260628#55260628", "title": "How to find small string in big string in C?", "body": "<p>You can write your own find function.</p>\n\n<pre><code>int find(char *array, char *pattern) {\n    char *ap, *aap, *pp;\n    for(ap=array; *ap; ap++) {\n        for(pp=pattern, aap=ap; *aap &amp;&amp; *pp &amp;&amp; *pp==*aap; aap++, pp++); \n        if(*pp=='\\0') return ap-array;\n    }\n    return -1;\n}\n</code></pre>\n\n<p>The outer loop loops over your line 1 char a loop. It's the start point for the compare in the inner loop. The inner loop loops over your pattern and the line while </p>\n\n<ul>\n<li>pattern not at end</li>\n<li>line not at end</li>\n<li>pattern char equals line char</li>\n</ul>\n\n<p>without loop body.</p>\n\n<p>If the pattern end is reached it was found and the function returns the found position in the line.</p>\n"}], "owner": {"reputation": 31, "user_id": 11208268, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jr0WhqgO5BQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcTZotymMf_o9ApQ6ulWVD0bheqwA/mo/photo.jpg?sz=128", "display_name": "Martin Indrych", "link": "https://stackoverflow.com/users/11208268/martin-indrych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1553084323, "creation_date": 1553072525, "last_edit_date": 1553072685, "question_id": 55256970, "link": "https://stackoverflow.com/questions/55256970/how-to-find-small-string-in-big-string-in-c", "title": "How to find small string in big string in C?", "body": "<p>trying to create a code in C. First of all, I <strong>can't</strong> use the string.h library or any other that helps similarly. The input will be from command line like: ./program pattern file, I already succeed to open the file and write line of the file to an array, but now I have to compare the pattern a get with the line in file. If there is written the pattern, I have to printf the whole line.</p>\n\n<p>For the input I use:</p>\n\n<pre><code>char array[1000]; // hope 1000 will be enough\n\nchar *pattern= argv[1];\n</code></pre>\n\n<p>For the scanning I use:</p>\n\n<pre><code>while (fscanf(f,\"%c\", &amp;temp)!= EOF){\n        if (temp=='\\n'){\n             Algoritm...\n        }\n        add to array( array[i++]=temp) - already works`\n</code></pre>\n\n<p>And If I get end of line, I do not When the '\\n' ocures, I need to start the algorithm to find out if the small string is in the line. </p>\n\n<p>My questions:</p>\n\n<p>How can I compare these \"strings\"? efficiently? </p>\n\n<p>How to get know the size of pattern I get as input? (I think I need that to do the algorithm)</p>\n"}, {"tags": ["c", "windows", "multithreading"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553071955, "post_id": 55256709, "comment_id": 97245044, "body": "You seem to have multiple <code>single-thread.exe</code> programs, some which seems to create threads (despite the name of the executable program). Are you sure it&#39;s not one of them that are still running?"}, {"owner": {"reputation": 161, "user_id": 10763046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8c52006b9dff2c54b4f70729c83340?s=128&d=identicon&r=PG&f=1", "display_name": "Sun Hao Lun", "link": "https://stackoverflow.com/users/10763046/sun-hao-lun"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553072283, "post_id": 55256709, "comment_id": 97245209, "body": "I only have this program called single-thread.exe and I am sure that only one  program call single-thread.exe runnung in the same time."}, {"owner": {"reputation": 161, "user_id": 10763046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8c52006b9dff2c54b4f70729c83340?s=128&d=identicon&r=PG&f=1", "display_name": "Sun Hao Lun", "link": "https://stackoverflow.com/users/10763046/sun-hao-lun"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553072363, "post_id": 55256709, "comment_id": 97245246, "body": "If I use visualstudio , the threads will become 4 threads. It is strange."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 2, "creation_date": 1553073147, "post_id": 55256709, "comment_id": 97245695, "body": "When you run a debug build, there may be much more going on than just the code you&#39;ve written. For instance, the program may be communicating with you IDE in order to help you with debugging (so you can examine values, see where it crashed, and so on). Those things may run in their own thread(s) and make up most of the memory usage of small programs. Don&#39;t worry about it."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1553074026, "post_id": 55256709, "comment_id": 97246203, "body": "You are using Win10, befitting a modern OS it does take advantage of your machine having multiple processor cores.  They get your program started faster.  Details <a href=\"https://stackoverflow.com/a/34826385/17034\">are here</a>."}, {"owner": {"reputation": 161, "user_id": 10763046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8c52006b9dff2c54b4f70729c83340?s=128&d=identicon&r=PG&f=1", "display_name": "Sun Hao Lun", "link": "https://stackoverflow.com/users/10763046/sun-hao-lun"}, "edited": false, "score": 0, "creation_date": 1553074171, "post_id": 55256709, "comment_id": 97246283, "body": "Thanks. I will take a look."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553074455, "post_id": 55256709, "comment_id": 97246442, "body": "Did you build for release? If a debugger is attached, it will have to read the process memory somehow, like for example through a separate thread."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553075217, "post_id": 55256709, "comment_id": 97246934, "body": "@Lundin - this not related to debugging. and debuggers not create separate thread in target process for read it memory (no sense). this is os created working threads"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553075442, "post_id": 55256709, "comment_id": 97247063, "body": "@RbMm Some tool chains put the whole debugged program inside it&#39;s own memory. What it does internally is anyone&#39;s guess. Various dynamic analysers does inject something inside the target process. Quite hard to discuss this without a specific tool chain in mind."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553075948, "post_id": 55256709, "comment_id": 97247418, "body": "@Lundin - yes, of course some program, can inject remote thread in target process, but here i sure we have os created worked thread(s). easy can view this if use debugger"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1553090641, "post_id": 55256709, "comment_id": 97256509, "body": "There are system-managed threads as well. For example, the system has a thread to handle what happens if the user types Ctrl+C to terminate your application."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1553074600, "post_id": 55257214, "comment_id": 97246530, "body": "Why would a compiler do that unbidden and automatically? I very much doubt it. Especially since executing this code in multiple threads would be less effective than a single thread due to thread creation overhead. Pipelining has nothing to do with threads and is handled by the CPU."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1553074738, "post_id": 55257214, "comment_id": 97246611, "body": "There&#39;s something about the words &quot;instruction level&quot; than make me think that ILP happens at the level of instructions and does NOT happen as &quot;multiple threads (of instructions)&quot;."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1553075415, "post_id": 55257214, "comment_id": 97247046, "body": "no. this is os created working threads. nothing related to compiler"}, {"owner": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1553076431, "post_id": 55257214, "comment_id": 97247728, "body": "@Brendan ILP allows to overlap (i.e. parallelize =&gt; use of multiple threads) the instructions and even reorder the instructions executed."}, {"owner": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553076894, "post_id": 55257214, "comment_id": 97248020, "body": "@RbMm ILP is also implemented on processor level, meaning it can create threads on OS level."}, {"owner": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553077263, "post_id": 55257214, "comment_id": 97248214, "body": "@Lundin Certain compilers and/or processors will make greater use of ILP than others. A 3 nested for loop twice is expensive and therefore the thread overhead is not comparable to the execution time, leading to the compiler and/or professor making the decision to parallelize the instructions."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553077286, "post_id": 55257214, "comment_id": 97248229, "body": "no, 100% nothing related to this. op must look for this thread start address and look under debugger. and will be visible"}], "tags": [], "owner": {"reputation": 487, "user_id": 8242557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyWRa.png?s=128&g=1", "display_name": "pr0f3ss", "link": "https://stackoverflow.com/users/8242557/pr0f3ss"}, "is_accepted": false, "score": 1, "last_activity_date": 1553898937, "last_edit_date": 1553898937, "creation_date": 1553073377, "answer_id": 55257214, "question_id": 55256709, "link": "https://stackoverflow.com/questions/55256709/i-wrote-a-single-thread-program-using-codeblocks-but-in-task-manager-it-shows-th/55257214#55257214", "title": "I wrote a single-thread program using codeblocks but in task manager it shows that the program is using 2 threads?", "body": "<p>This might be a case of implicit parallelism where your CPU/compiler will exploit instruction level parallelism (<a href=\"https://en.m.wikipedia.org/wiki/Instruction-level_parallelism\" rel=\"nofollow noreferrer\">ILP</a> for short) to improve sequential processor performance. As your two for loops are independant of each other your compiler will make use of <a href=\"https://en.m.wikipedia.org/wiki/Automatic_vectorization\" rel=\"nofollow noreferrer\">vectorization</a> and your processor will automatically create threads to shorten execution time. Therefore you are running 2 or even 4 threads, dependant on your compiler/system.</p>\n"}], "owner": {"reputation": 161, "user_id": 10763046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8c52006b9dff2c54b4f70729c83340?s=128&d=identicon&r=PG&f=1", "display_name": "Sun Hao Lun", "link": "https://stackoverflow.com/users/10763046/sun-hao-lun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553898937, "creation_date": 1553071765, "last_edit_date": 1553080940, "question_id": 55256709, "link": "https://stackoverflow.com/questions/55256709/i-wrote-a-single-thread-program-using-codeblocks-but-in-task-manager-it-shows-th", "title": "I wrote a single-thread program using codeblocks but in task manager it shows that the program is using 2 threads?", "body": "<p>I wrote a program in codeblocks and the code is shown below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(int argc, char* argv[])\n{\n    int Param, i, j, k;\n    if(argc != 2){\n        fprintf(stderr, \"An integer parameter is required \\n\");\n        return -1;\n    }\n    Param = atoi(argv[1]);\n    if(Param&lt;0){\n        fprintf(stderr, \"An integer &gt;= 0 is required \\n\");\n    }\n\n    printf(\"first \\n\");\n    for(i = 0; i &lt; 1500; i++)\n        for(j = 0; j &lt; 1500; j++)\n            for(k = 0; k &lt; 1500; k++);\n\n    printf(\"second \\n\");\n    for(i = 0; i &lt; 1500; i++)\n        for(j = 0; j &lt; 1500; j++)\n            for(k = 0; k &lt; 1500; k++);\n    printf(\"Done \\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>In the program, I didn't use any multithread function and libraries like windows.h or thread.h. But when I opened the task manager to observe the threads it used, I was surprised that the program was using 2 threads. I have no idea why this can happen. Is there something added into the program I wrote while compiler is compiling my program?\nPlease help me to find out the mystery.</p>\n\n<p><a href=\"https://i.stack.imgur.com/miP0l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/miP0l.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the picture about the question.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1553071505, "post_id": 55256603, "comment_id": 97244809, "body": "There is no such language as &quot;C/C++&quot;, there is only the two <i>very different</i> languages C and C++. So please pick <i>one</i> of them, as the answer could differ depending on language."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553071541, "post_id": 55256603, "comment_id": 97244829, "body": "Why using <code>void*</code> whereas you want <code>int**</code> ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1553071610, "post_id": 55256603, "comment_id": 97244871, "body": "As a tip though: Think about how you would create a non-dynamic (non-pointer) &quot;2d&quot; array. Draw it out on paper and think about its layout. Perhaps you don&#39;t need two pointers?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1553071820, "post_id": 55256603, "comment_id": 97244966, "body": "I can&#39;t agree with Some programmer dude&#39;s first comment enough. Because I&#39;m pretty sure <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">this Q&amp;A</a> is a proper duplicate for a C question."}, {"owner": {"reputation": 44381, "user_id": 471160, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/9Z23A.jpg?s=128&g=1", "display_name": "marcinj", "link": "https://stackoverflow.com/users/471160/marcinj"}, "edited": false, "score": 0, "creation_date": 1553071852, "post_id": 55256603, "comment_id": 97244986, "body": "Why dont you switch from <code>void*</code> to <code>int*</code>? - this should fix your Illegal artithmetic warnings"}, {"owner": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1553072053, "post_id": 55256603, "comment_id": 97245099, "body": "Walking <code>vectorPointer</code> forward and backward is an odd choice. You&#39;re making an array so use array indexing. What you have looks very error prone."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1553072194, "post_id": 55256603, "comment_id": 97245165, "body": "@Jarod42 I am just curious to see if an int** can be somehow implemented using pointers to pointers"}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 17343, "user_id": 445976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c82b2b9bdcf1baaf4677238d59cf745f?s=128&d=identicon&r=PG", "display_name": "Blastfurnace", "link": "https://stackoverflow.com/users/445976/blastfurnace"}, "edited": false, "score": 0, "creation_date": 1553072276, "post_id": 55256603, "comment_id": 97245205, "body": "@Blastfurnace Of course i am aware of that. I am just exploring how is an array indexing can be implemented using plain pointers and low level stuff"}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553072499, "post_id": 55256603, "comment_id": 97245328, "body": "@Someprogrammerdude I am aware that since a MxN matrix contains m<i>n values, i am aware i could create one single *int pointer and allocating m</i>n int blocks..."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553073063, "post_id": 55256603, "comment_id": 97245649, "body": "If, for some reason, you want two separate arrays, where one maps a &quot;row&quot; to some specific location of the second array, then think about how to get a pointer to a &quot;row&quot; of your single data array. But more importantly, think long and hard about the <i>reason</i> you want this. Is it only plain curiosity? And if not, then what is the <i>actual</i> problem you need to solve? What part of your analysis and design requires you to have the second &quot;mapping&quot; array?"}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1553073410, "post_id": 55256603, "comment_id": 97245848, "body": "@Someprogrammerdude It is plain curiosity. I guess that some decades ago nothing was such obvious. I see computers for what they are, machines that evolves throught defined states. So since a matrix it&#39;s already quite an abstraction, and a command like int A[][] it&#39;s expression of that abstraction, i wonder which &quot;1 to 1&quot; instructions must be given to pass across states and so implement what we believe a matrix is. Since plain pointers are somehow something very connected to a memory block, i wondered what implementation has to be done to make it equivalent to something like A[][]...just that."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1553073962, "post_id": 55256603, "comment_id": 97246162, "body": "@Paolo A true 2D array in C is a very thin abstraction over the hardware. <code>array[i][j]</code> literally means access memory address <code>address + i*N + j</code>. C doesn&#39;t care what you want the array dimensions to symbolize, arrays are raw memory maps. A pointer-to-pointer look-up table is a far higher layer of abstraction (and therefore performs much slower)."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553075028, "post_id": 55256603, "comment_id": 97246807, "body": "@Lundin &quot;A pointer-to-pointer look-up table&quot; its a very interesting hint to me. Thanks for point it out with this words."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1553075311, "post_id": 55256603, "comment_id": 97246984, "body": "@Paolo That&#39;s simply what <code>type** arr = malloc (sizeof *type); ... arr[i] = malloc (sizeof *arr[i]);</code> is. It&#39;s not a 2D array, nor can it be used as one."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553076954, "post_id": 55256603, "comment_id": 97248048, "body": "@Lundin if i declare type** arr = malloc (sizeof <i>type), i am not allowed to declare  type</i> arr = malloc (sizeof type) because arr is already assigned. Does it means that * or ** are pure compiler sintaxis?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553077143, "post_id": 55256603, "comment_id": 97248147, "body": "@Paolo <code>type arr = malloc(...</code> is simply not valid C so I don&#39;t understand the question."}, {"owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553077285, "post_id": 55256603, "comment_id": 97248227, "body": "@Lundin Sorry i meant type* arr = malloc (sizeof type)...or maybe not even this is accepted because C does not do implicit casting?I am slowly understanding pointers but there are so many details :)"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553073466, "post_id": 55256898, "comment_id": 97245878, "body": "There was a new C standard released in the year 1999 making this method called &quot;mangled arrays&quot; pretty much obsolete. Use pointers to VLA instead. Cleaner code and faster executable."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1553072327, "creation_date": 1553072327, "answer_id": 55256898, "question_id": 55256603, "link": "https://stackoverflow.com/questions/55256603/in-c-c-how-can-i-implement-a-2d-int-array-using-two-single-pointers-no-use-o/55256898#55256898", "title": "In C/C++: How can i implement a 2D int array using two single pointers (no use of **int)?", "body": "<p>Actually, you only need one pointer. One way of doing it is by allocating enough memory to hold all the values, and then have functions that map the <code>x</code>/<code>y</code> values in the array to the respective memory location. Assume we want those to be the dimensions and our array variable:</p>\n\n<pre><code>int dimX = 10, dimY = 5;\nint *array;\n</code></pre>\n\n<p>You can set a value this way:</p>\n\n<pre><code>void arraySet(int value, int x, int y) {\n    array[x + dimX * y] = value;\n}\n</code></pre>\n\n<p>And get a value this way:</p>\n\n<pre><code>int arrayGet(int x, int y) {\n    return array[x + dimX * y];\n}\n</code></pre>\n\n<p>Allocate the memory beforehand such as in the <code>main</code> function:</p>\n\n<pre><code>array = malloc(sizeof(int)*dimX*dimY);\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>arraySet(123, 9, 3); // sets the value of [9, 3] to 123\nprintf(\"Memory at 9, 3 is %d\\n\", arrayGet(9, 3));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1553073422, "creation_date": 1553073422, "answer_id": 55257230, "question_id": 55256603, "link": "https://stackoverflow.com/questions/55256603/in-c-c-how-can-i-implement-a-2d-int-array-using-two-single-pointers-no-use-o/55257230#55257230", "title": "In C/C++: How can i implement a 2D int array using two single pointers (no use of **int)?", "body": "<p>This \"two pointers\" idea doesn't make any sense and the code you posted cannot be salvaged. What you should do instead is to use a pointer to a 2D array:</p>\n\n<pre><code>int (*ptr)[x][y] = malloc(sizeof *ptr);\n...\nfree(ptr);\n</code></pre>\n\n<p>That's it. However, a pointer to a 2D array is cumbersome, since we have to de-reference it before accessing the actual array. That is, we'd end up writing <code>(*ptr)[i][j] = ...;</code> which is ugly.</p>\n\n<p>To dodge this, we can instead still allocate a 2D array, but instead of pointing at \"the whole array\", we point at the first element, which is a 1D array:</p>\n\n<pre><code>int (*ptr)[y] = malloc( sizeof(int[x][y]) );\n...\nptr[i][j] = ... ; // more convenient syntax for access\n...\nfree(ptr);\n</code></pre>\n\n<p>More info: <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a></p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1553082849, "post_id": 55259405, "comment_id": 97251529, "body": "There is however never a reason to write code like this unless you need completely variable dimensions, such as in the case of a table of strings. <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>"}], "tags": [], "owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "is_accepted": false, "score": 1, "last_activity_date": 1553080355, "creation_date": 1553080355, "answer_id": 55259405, "question_id": 55256603, "link": "https://stackoverflow.com/questions/55256603/in-c-c-how-can-i-implement-a-2d-int-array-using-two-single-pointers-no-use-o/55259405#55259405", "title": "In C/C++: How can i implement a 2D int array using two single pointers (no use of **int)?", "body": "<p>You can simulate <code>int a[2][3];</code> with</p>\n\n<ul>\n<li><p>one dimensional array and index computing:</p>\n\n<pre><code>int* matrix = (int*) malloc(6 * sizeof(int));\n\nint get_matrix_2_3(int* matrix, int i, int j) { return matrix[3 * i + j]; }\n</code></pre></li>\n<li><p>2-dimensional array:</p>\n\n<pre><code>int** matrix = (int**) malloc(2 * sizeof(int*));\nfor (int i = 0; i != 2; ++i) {\n     matrix[i] = (int*) malloc(3 * sizeof(int));\n}\n\nmatrix[1][2] = 42;\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 155, "user_id": 10847083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ebb5ebf9886073da307d71b5e78b05e?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/10847083/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1553364706, "creation_date": 1553071315, "last_edit_date": 1553364706, "question_id": 55256603, "link": "https://stackoverflow.com/questions/55256603/in-c-c-how-can-i-implement-a-2d-int-array-using-two-single-pointers-no-use-o", "title": "In C/C++: How can i implement a 2D int array using two single pointers (no use of **int)?", "body": "<p>I am exploring pointer \"mechanics\" in C/C++. I try to understand if and how is possible to implement a 2D matrix using two pointers (one for \"rows\" and one for \"columns\") instead of a single double pointer. I am aware that a matrix with rows*columns number of values could be stored in memory sequentially, but i am looking to comprehend deeper the mechanics of pointers and eventually to implement a function similar to</p>\n\n<pre><code>int value=getValue(vectorNr,vectorValue) \n</code></pre>\n\n<p>that is able to \"simulate\" the construct </p>\n\n<pre><code>value=Matrix[vectorNr][vectorValue]\n\nvectorPointer                 vectorValue\n| AddressV1 |------|valAddr11 valAddr12 valAddr13 |\n| AddressV2 |------|valAddr21 valAddr22 valAddr23 |\n| AddressV3 |------|valAddr31 valAddr32 valAddr33 |   \n</code></pre>\n\n<p>I tried to begin writing a code like this but I quickly get stuck on pointer arithmetic and address offsetting. I also might chose a very dirty approach so any comment is welcome.</p>\n\n<p>CODE TO IMPLEMENT A 2D ARRAY WITH POINTERS (BUT NOT     USING DOUBLE POINTERS). To avoid confusion between rows     and columns I refer to \"Vectors as rows\" and \"Columns as vector values\"</p>\n\n<pre><code>    int vectorsNumber = 3; //Number of Vectors\n    int valuesNumber = 3; //Number of values stored in one     Vector\n\n\n    //Addresses of Vectors. Since Vectors holds a reference to set of values, vectorPointer will hold an address for every set.\n    void* vectorPointer = malloc(vectorsNumber     *sizeof(void*)); \n\n\n    //Populating the vectorPointer with the address generated by allocating memory for every set of values\n    for (int i = 0; i &lt; vectorsNumber; i++)\n    {\n        vectorPointer = (int*)malloc(valuesNumber * sizeof(int)); //Values shall be of int types\n        vectorPointer++; //ILLEGAL since cannot perform arithmetic on pointers of type void. What do do??\n    }\n\n    //Restore the initial address. In any case...ILLEGAL arithmetic.    What do do??\n    for (int i = 0; i &lt; vectorsNumber; i++)\n    {\n        vectorPointer--; //Restore the initial address. In any case...ILLEGAL arithmetic.\n    }\n\n    //Declaring the pointer to hold the address of one value. Memory was already allocated before\n    int* valueAddress; \n    for (int j = 0; j &lt; vectorsNumber; j++)\n    {\n        //Getting the address of the first value of the first Vector\n        valueAddress = (int*)vectorPointer; //Is this casting valid in C language?\n\n\n        //Populating the value with whatever operation\n        for (int k = 0; k &lt; valuesNumber; k++)\n        {\n\n            *valueAddress = (k + 1)*(j + 1); //populate the Vector with int values\n        }\n\n        vectorPointer++; //Switch to next Vector.ILLEGAL arithmetic\n\n    }\n</code></pre>\n"}, {"tags": ["c", "file", "match"], "comments": [{"owner": {"reputation": 3094, "user_id": 7470360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7631d33e5ae072cb002f197927ecf85?s=128&d=identicon&r=PG&f=1", "display_name": "A Jar of Clay", "link": "https://stackoverflow.com/users/7470360/a-jar-of-clay"}, "edited": false, "score": 0, "creation_date": 1553072863, "post_id": 55256493, "comment_id": 97245530, "body": "Please detail what you have tried and why it didn&#39;t work. See the <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> page for more information. This might help: <a href=\"https://stackoverflow.com/q/3463426/7470360\">stackoverflow.com/q/3463426/7470360</a>"}, {"owner": {"reputation": 25, "user_id": 8352900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b13ju.jpg?s=128&g=1", "display_name": "AJ AJ", "link": "https://stackoverflow.com/users/8352900/aj-aj"}, "reply_to_user": {"reputation": 3094, "user_id": 7470360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7631d33e5ae072cb002f197927ecf85?s=128&d=identicon&r=PG&f=1", "display_name": "A Jar of Clay", "link": "https://stackoverflow.com/users/7470360/a-jar-of-clay"}, "edited": false, "score": 0, "creation_date": 1553074575, "post_id": 55256493, "comment_id": 97246519, "body": "My codes up there is working My problem is I dont know how to search and Match the account Number and Pin on the File that I created. Inside the file are the Account pin and number."}, {"owner": {"reputation": 169, "user_id": 8886087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f67351afebf42a46899145a557f7795?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/8886087/pierre"}, "edited": false, "score": 1, "creation_date": 1553074658, "post_id": 55256493, "comment_id": 97246566, "body": "can you give us some info on how your Account.txt file is formatted? That will make it much easier to find a solution"}, {"owner": {"reputation": 25, "user_id": 8352900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b13ju.jpg?s=128&g=1", "display_name": "AJ AJ", "link": "https://stackoverflow.com/users/8352900/aj-aj"}, "edited": false, "score": 0, "creation_date": 1553074778, "post_id": 55256493, "comment_id": 97246639, "body": "After creating account which have account number , pin and  name written inside the file i created, I am now entering by account number and pin in order to do transaction i need to make sure that the pin and number that were entered are matched."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553188179, "post_id": 55256493, "comment_id": 97301432, "body": "OT: regarding: <code>printf(&quot;File does not exists \\n&quot;);</code>  1) Error messages should be output to <code>stderr</code>, not <code>stdout</code>  2) When the error is from a C library function, then should also output the text reason the system thinks the error occurred.  The simplest way to perform both of the above is to call <code>perrorf(&quot;fopen failed&quot;);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553188492, "post_id": 55256493, "comment_id": 97301596, "body": "OT: regarding: <code>scanf(&quot;%s&quot;, &amp; acctname);</code> and similar calls to <code>scanf()</code>  1) always check the returned value (not the parameter values) to assure the operation was successful (see the MAN page for <code>scanf()</code>)  2) when using &#39;%s&#39; and/or &#39;%[...]&#39; always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer which allows for the  NUL byte that those input specifiers always append to the input.  This also avoids any buffer overflow and the resulting undefined behavior"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553188840, "post_id": 55256493, "comment_id": 97301759, "body": "the posted code does not compile!.  It is missing the needed <code>#include</code> for the header file: <code>stdio.h</code> and is missing the declarations for the variables: <code>dep</code> and <code>acctpin</code> and <code>acctname</code>  and to meet the stackoverflow requirements needs the structure of the data in the file and a <code>main()</code> function to be calling all the posted functions"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553189061, "post_id": 55256493, "comment_id": 97301877, "body": "regarding: <code>fprintf(fptr, &quot;%d%s%d%f\\n&quot;, acctno, acctname,  acctpin);</code>  This hints the file contains ascii data, where the length of each field is &#39;just&#39; long enough to hold the current value.  This will make the data &#39;difficult&#39; to retrieve from the file.  Suggest using a struct of all the fields so every field has a fixed length.  Note: the format string expects 4 fields but the parameters only lists 3 fields, so this will not correctly compile"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553189437, "post_id": 55256493, "comment_id": 97302081, "body": "regarding: <code>if (fptr == NULL) {     printf(&quot;File does not exists \\n&quot;);   }</code>  When the program fails to open the file, then it should NEVER try to access the file for reading/writing.  I.E. after the call <code>printf()</code> should be <code>exit( EXIT_FAILURE );</code>  And again that <code>prinft()</code> should be: <code>perror()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553189731, "post_id": 55256493, "comment_id": 97302213, "body": "Strongly suggest using a <code>struct</code> to layout the file.  Similar to: `struct account { long acctNum; char acctName[30]; unsigned short acctPin;  float acctDep };&#39;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553190138, "post_id": 55256493, "comment_id": 97302428, "body": "OT: regarding: <code>printf(&quot;Enter Your Account Number :\\n&quot;);   scanf(&quot;%d&quot;, &amp; acctno);</code>  How is the user of this program to know the account number?  Suggest tracking the highest used account number, and add 1 to get the new account number."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553190446, "post_id": 55256493, "comment_id": 97302603, "body": "the function: <code>BankTransactions()</code> is giving limits on the length of <code>acctNum</code> and <code>acctPin</code> but the creation of the account has no checking to assure the numbers are within those limits.  BTW: if the numbers are shorter than the limits, do they need leading 0&#39;s?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 11215915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a688e5fb7a6b84a3ef04adf3e046b?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Kumar Mali", "link": "https://stackoverflow.com/users/11215915/sanket-kumar-mali"}, "is_accepted": false, "score": 0, "last_activity_date": 1553075389, "creation_date": 1553075389, "answer_id": 55257845, "question_id": 55256493, "link": "https://stackoverflow.com/questions/55256493/how-can-it-be-possible-to-search-the-file-for-a-match-in-a-new-input/55257845#55257845", "title": "How can it be possible to search the file for a match in a new input?", "body": "<p>Store the <strong>account number</strong> and <strong>pin</strong> separated by comma(,) and single entry in each line.</p>\n\n<ul>\n<li>acount.txt</li>\n</ul>\n\n<p>4654654688481,1234</p>\n\n<pre><code>char *account,*pin;\nFILE *myfile = fopen ( filename, \"r\" );     \nif(myfile)\n{ \n      char entry [100]; //maximum line size \n      while(fgets(entry,sizeof(entry),myfile)!= NULL)\n      {\n        account=strtok(entry,\",\");\n        pin = strtok(NULL,\",\");\n        //match these with user input if matches break out of loop\n      }\n      fclose (myfile);\n}\n</code></pre>\n\n<p>you can do something like this. you will able to retrieve the \"account\" and \"pin\"</p>\n"}], "owner": {"reputation": 25, "user_id": 8352900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b13ju.jpg?s=128&g=1", "display_name": "AJ AJ", "link": "https://stackoverflow.com/users/8352900/aj-aj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553075389, "creation_date": 1553070916, "last_edit_date": 1553074055, "question_id": 55256493, "link": "https://stackoverflow.com/questions/55256493/how-can-it-be-possible-to-search-the-file-for-a-match-in-a-new-input", "title": "How can it be possible to search the file for a match in a new input?", "body": "<p>I am new to C language and I need help. <br>\nThe Program will ask the user the account number and Account Pin. Then will search the File \"Account.txt\". If the Account Number and Pin are matched to what was written on the file then will display another Option, such as <strong>Balance</strong> <strong>inquiry</strong>,<strong>Deposit</strong>, <strong>withdrawal</strong> and <strong>Quit</strong>.<br>\nHow can it be possible to search the file for a match? What exactly will I do?</p>\n\n<p>Here's some code:</p>\n\n<pre><code>void OpenAnAccount() {\n  FILE * fptr;\n  fptr = fopen(\"Account.txt\", \"w\");\n\n  if (fptr == NULL) {\n    printf(\"File does not exists \\n\");\n  }\n\n  printf(\"*************************************\\n\\n\");\n  printf(\"\\n ACCOUNT CREATION \");\n\n  printf(\"\\n**********************************\\n\");\n  printf(\"Enter Your Account Number :\\n\");\n  scanf(\"%d\", &amp; acctno);\n  printf(\"Enter your Name:\\n\");\n  scanf(\"%s\", &amp; acctname);\n  printf(\"Enter your Account Pin: \\n\");\n  scanf(\"%d\", &amp; acctpin);\n  printf(\"Please Enter Your Initial Deposit :\");\n  scanf(\"%f\", &amp; dep);\n  fprintf(fptr, \"%d%s%d%f\\n\", acctno, acctname,\n    acctpin);\n}\n\nvoid BankTransactions() {\n  int AN, AP;\n  printf(\"Enter 5 digits Account Number :\\n\");\n  scanf(\"%d\", &amp; AN);\n  printf(\"Enter 4 digits Accoount Pin :\\n\");\n  scanf(\"%d\", &amp; AP);\n}\n</code></pre>\n"}, {"tags": ["c", "embedded", "stm32", "usart"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553069771, "post_id": 55256101, "comment_id": 97244004, "body": "Number of stop bits, data bits is wrong?"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553071775, "post_id": 55256101, "comment_id": 97244947, "body": "Sorry i forget to mention some points. I had applied logic for 1 start bit , 8 data bit and 1 stop bit."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1553072175, "post_id": 55256101, "comment_id": 97245150, "body": "It&#39;s bad practise to have long delays (or any delays) in interrupt handlers, they should be as short as possible. Is there any reason you&#39;re bit banging rather than using one of the many USARTs available in the STM32?"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553072417, "post_id": 55256101, "comment_id": 97245278, "body": "Those delay are calibrated for baudrate for example for 9600 baudrate, delay time is calibrated as 1\\9600 = 104 us. There is no particular reason for this i was trying it for research purpose only."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 5, "creation_date": 1553074223, "post_id": 55256101, "comment_id": 97246312, "body": "This codes defeats the whole purpose of having an ISR in the first place. Use the UART&#39;s own interrupt or use DMA. These delays are nonsense. Bit-banging UART is nonsense; every single MCU released during the past 40 years has got UART peripheral hardware."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553081360, "post_id": 55256101, "comment_id": 97250621, "body": "The <i>hardware</i> serial transceivers on STM32 are (mostly) USARTS (i..e they support synchronous and asynchronous timing), but what you are implementing here is a <i>UART</i> only."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553083721, "post_id": 55256101, "comment_id": 97252069, "body": "@Lundin - but not every micro the ability to assign a UART Rx to an arbitrary pin;  usually only a subset of pins or a specific pin, and the board design if pre-existing may not have exposed all or any UART pins in any case - so not complete nonsense - just a last resort solution to possible hardware limitations.  The solution outlined in my answer was for an existing design with a single serial port, with a need for asymmetric  baud rates.  Helpfully on STM32 you can independently enable the USART Tx and Rx, so the hardware Tx was used for the high speed output and the soft-UART for the Rx."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553102354, "post_id": 55256101, "comment_id": 97264653, "body": "Note that waiting for the STOP bit serves no purpose - its purpose is largely only to ensure that the subsequent start bit is a transition to which the bit sampling can be synchronised.  A delay following the STOP bit is certainly unnecessary and will cause you to miss the start of the second character.  That said, even without that it is a terrible solution to put delays in an interrupt handler - while data is streaming you will spend near 100% CPU time in the interrupt context getting nothing done (except higher priority interrupts)."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553104213, "post_id": 55256101, "comment_id": 97265629, "body": "@Lundin i am not doing it for creating any uart for any controller, i did this for better understanding of UART. Further i am fully aware of UART Interrupts and DMA, i just strike in my mind that how this thing works, so i tried to implement it in my own ways."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553104350, "post_id": 55256101, "comment_id": 97265708, "body": "@Clifford thanks for your reply. It is really helpful and i will try to implement it. Might, not waiting for stop bit will help me out. I will try this."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553104526, "post_id": 55256101, "comment_id": 97265792, "body": "@Vaibhav - See the addition to my answer on the STOP bit, not my comment.  No it does not help, unless you want to handle framing errors."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553104807, "post_id": 55256101, "comment_id": 97265947, "body": "Another issue with your implementation, is that the time between the START bit transition and the <i>centre</i> of the first data bit is <code>delay_time * 3 &#47; 2</code> - you are dangerously sampling close to the bit transitions rather then the bit centre.  Again - see my answer, not my comments - now with pictures!."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553108566, "post_id": 55256101, "comment_id": 97267799, "body": "i understand what your are saying i will take care of these points during another test. Thanks"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553153362, "post_id": 55256101, "comment_id": 97281307, "body": "@Clifford Or you could, you know, design the hardware correctly. It will likely be both cheaper and better to fix the PCB layout."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1553160661, "post_id": 55256101, "comment_id": 97284621, "body": "@Lundin It is clearly off topic, but there are of course commercial considerations.  My point was simply not to dismiss the idea as &quot;nonsense&quot;, even if this implementation or that attempt to achieve 115200 bps as an academic exercise is nonsense."}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553072078, "post_id": 55256730, "comment_id": 97245111, "body": "the logic i had written is working fine for single character. Rest as interrupt is falling edge triggered so during start condition the interrupt get automatically called. Then r0 is taking care of start condition an r9 is taking care of stop condition."}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553072378, "post_id": 55256730, "comment_id": 97245253, "body": "I would assume you re-enable the interrupt before the falling edge of the stop bit. That gives you an additional trigger and a shift by one bit. Check the &quot;garbage&quot; you get after the first character - If it&#39;s shifted by one bit, that&#39;s the problem."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553072568, "post_id": 55256730, "comment_id": 97245371, "body": "what i am thinking that i was late for catching falling edge for next character. Stop bit is generated when line is pulled high as per the general usart timing diagram"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553102696, "post_id": 55256730, "comment_id": 97264832, "body": "@Vaibhav unnecessarily sampling the stop-bit an delaying is probably the reason you are only getting one character - you are in the interrupt context when the next start bit arrives. The stop bit can be ignored; it is only there to ensure the start bit is a transition."}], "tags": [], "owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "is_accepted": false, "score": 0, "last_activity_date": 1553071834, "creation_date": 1553071834, "answer_id": 55256730, "question_id": 55256101, "link": "https://stackoverflow.com/questions/55256101/usart-receiver-on-stm32/55256730#55256730", "title": "USART receiver on STM32", "body": "<p>I can't see in your code where you take account of the <em>start bit</em> that is normally part of a serial transmission. You seem to be only looking for 8 data bits and a stop bit.</p>\n\n<p>With the convention of \"start bit is the inverse of stop bit\" there will be an additional edge your code detects between characters, thus apparently shifting the bit stream you detect by one bit.</p>\n"}, {"comments": [{"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553104998, "post_id": 55259684, "comment_id": 97266034, "body": "your code might not help me with 115200 baud rate. Because in many cases you had jump instructions in your code when written in assembly and i only have 8 us while working with 115200 buad rate. many sensors are pre-programmed at 115200 baud rate. But i like your logic and will try to implement it with some modifications"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553105211, "post_id": 55259684, "comment_id": 97266150, "body": "@Vaibhav : A soft UART at 115200 is ambitious in any event (8.7 microseconds per bit).  Your solution just means your processor will be able to do nothing with the data it receives if it is streaming, because it is always in the interrupt handler."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553161132, "post_id": 55259684, "comment_id": 97284868, "body": "@Vaibhav : In a previous comment you suggested that this was an academic exercise.  As such, achieving 115200 will add nothing to your understanding of UART.  It seems that your primary issue is simply one of incorrect timing - the delay after the start bit transition being too short. In many cases, the CPU load imposed by a high-speed soft UART will compromise the actual function of your application."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553177976, "post_id": 55259684, "comment_id": 97294838, "body": "being as academic exercise does not means that i will stop it if i was able to achieve a level. Exercise ends when i am able to achieve every level. Thanks for your concern."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 1, "creation_date": 1553181397, "post_id": 55259684, "comment_id": 97297221, "body": "@Vaibhav : You missed my point - going ever faster does not enhance your &quot;<i>better understanding of UART</i>&quot; which is your stated aim in the comment.  Moreover to what extent is 115200 &quot;<i>every level</i>&quot; - the STM32 h/w UART can achieve rates in the mega-bits-per-second range. Besides your question does not state a desired bit rate, and only 9600 is mentioned by you in comments.  That this solution may not achieve 115200 is an unfair criticism.  It allows other processes to run concurrently whilst yours will choke the processor."}, {"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1553184586, "post_id": 55259684, "comment_id": 97299290, "body": "I have previously implemented bit-banged UART reception for the purpose of automatically calculating received baud rates.  One thing you can do is enter your routine on a falling edge (which you assume is the start bit), then keep a timer running and record every time you see an edge after that.  Eventually, the signal goes back high (idle) and your &quot;character&quot; is done.  Then, you analyze the edges you saw and try to figure out what the bit time could be.  Usually, there&#39;s only one or two periods that work.  Finally, use start, stop &amp; parity to figure out the likely bit rate."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553185362, "post_id": 55259684, "comment_id": 97299768, "body": "@Vaibhav :  I have updated the answer to give an explanation of the issues with your solution other than simple interrupt handler abuse, and to propose a fix using your method.   My original answer then just remains a better practical solution if the application is to do any real work."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1553185566, "post_id": 55259684, "comment_id": 97299897, "body": "@DaveM.  I am not sure how baud rate detection is relevant to the question or why you have addressed your comment to my answer."}, {"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1553185590, "post_id": 55259684, "comment_id": 97299908, "body": "@clifford it is a reason to do bit-banging UART reception, similar to what the original poster was trying to do.  My method focuses on <i>edges</i> of the serial signal, rather than trying to find the middle of the bit time (as you correctly point out, that is probably why the original code didn&#39;t work right).  The upside of &quot;edge&quot; focus is that you can recover the baud rate.  The downside is, you can&#39;t count on seeing an edge between every two bits, since successive bits might have the same value."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1553196206, "post_id": 55259684, "comment_id": 97305277, "body": "@DaveM. In that case you should apply the comment to the question, not my answer.  Or post an answer."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553420218, "post_id": 55259684, "comment_id": 97371143, "body": "@Vaibhav It should be noted that the 38400 baud I suggested was achieved was on a real-time system with other work to do.  If your application is doing little else, (and in your implementation it has no choice), then 115200 would easily be achievable. You are sweating the small stuff worrying about a few single instructions."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553448064, "post_id": 55259684, "comment_id": 97378906, "body": "@Clifford 1. to receive data on usart in any case controller is servicing usart receiver at that moment.  Holding the current process. 2. i my case i also doing that so that i didn&#39;t miss any bit, because any bit loss result is corrupt data. 3. I am satisfied with your logic will try that out once get a chance for it."}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "edited": false, "score": 0, "creation_date": 1553448378, "post_id": 55259684, "comment_id": 97379013, "body": "Once Just think about how normal UART transmitter receiver works."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553449336, "post_id": 55259684, "comment_id": 97379310, "body": "I have no idea what your last comment means.  The one before that for point 1 for interrupt driven Rx, you get one interrupt per character, while the hardware is receiving the character you are free to do other work.  In your case you are in the interrupt context for 100% of the character receive time, by not needlessly waiting for the stop but, that can be improved to 80% while the per-character interrupt handling of a real UART is easily a tiny fraction of 1% - so don&#39;t tell me it makes no difference!  Using DMA the software overhead decreases further."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553449653, "post_id": 55259684, "comment_id": 97379422, "body": "Further even if you poll the UART, you have up to two frame periods to read the data before an overrun occurs, so plenty of time to do something else.  In my soft RX set the interrupt priority higher than any other if there are other interrupts and you need high speed. The maximum speed can probably be improved greatly by replacing the standard peripheral library calls with direct register access - more so that worrying about the number of implicit jump instructions."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1553450099, "post_id": 55259684, "comment_id": 97379533, "body": "I think your question was about why your implementation did not work.  I think I have answered that, the alternative (more practical) solution you can take or leave. But if my indication of your erroneous timing was correct you might consider accepting this answer."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 7, "last_activity_date": 1553185465, "last_edit_date": 1553185465, "creation_date": 1553081240, "answer_id": 55259684, "question_id": 55256101, "link": "https://stackoverflow.com/questions/55256101/usart-receiver-on-stm32/55259684#55259684", "title": "USART receiver on STM32", "body": "<p>The fundamental problem with your solution is that you are sampling the bits at the transition point rather then the bit centre.  On detection of the START transition, you delay one bit period only, so sample <code>r1</code> at the bit transition rather then the bit <em>centre</em> - this will almost certainly result in errors, especially at high speed where the edges may not be very fast.  The first delay should be 1.5 bit periods long. (<code>delay_time * 2 / 3</code>) as illustrated below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/icObo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/icObo.png\" alt=\"enter image description here\"></a></p>\n\n<p>A second problem is that you unnecessarily delay after the STOP bit, which will cause you to miss the next START transition because it may occur before you clear the interrupt flag. Your work is done as soon as you have <code>r8</code>.</p>\n\n<p>Sampling <code>r0</code> and <code>r9</code> serves no purpose you discard them in any case, and the state <code>r0</code> is implicit in any event form the EXTI transition, and <code>r9</code> would only not be 1 if the sender was generating invalid frames.  Moreover if you are not sampling <code>r9</code> the delay before it also becomes unnecessary. These lines should be removed:</p>\n\n<pre><code>delay_us(delay_time);\nr9 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\n</code></pre>\n\n<p>That would at least give you two bit periods where your processor could do other work other then being stuck in the interrupt context, but delaying is an interrupt handler is not good practice - it blocks execution of normal code and all lower priority interrupts making the solution unsuited to real-time systems.  In this case if the soft-UART Rx is all the system has to do, you are likely to get better results by simply polling the GPIO rather then using interrupts - at least then other interrupts could run normally, and it is much simpler to implement.</p>\n\n<p>Your \"unrolled-loop\" implementation also serves no real purpose with the delays in place - even at very high bit rates a loop overhead is likely to be insignificant over the duration of the frame, and if it were you could tweak the delays a little to compensate:</p>\n\n<pre><code>void EXTI0_IRQHandler(void)\n{\n    delay_us(delay_time * 2 / 3);\n    for( int i = 7; i &gt;= 0; i-- )\n    {\n        x |= GPIOA-&gt;IDR &lt;&lt; i ;\n        delay_us(delay_time);\n    }\n\n    EXTI-&gt;PR |= 0X00000001;\n    buff1[z++] = x;\n    x = 0 ;\n    return ;\n}\n</code></pre>\n\n<p>A more robust solution for a soft receiver that will play well with other processes in your system, should use the EXTI interrupt only to detect the start bit; the handler should disable the EXTI, and start a timer at the baud rate plus half a bit period.  The interrupt handler for the timer, samples the GPIO pin at the centre of the bit period, and on the first interrupt after the EXTI, changes the period to one bit period.  For each timer interrupt it samples and counts the bits until a whole data word has been shifted in, when it disables the timer and re-enables the EXTI for the next start bit.</p>\n\n<p>I have successfully used this technique on STM32 running at 120MHz at 4800 and pushed it to 38400, but at 26 microseconds per bit it gets quite busy in the interrupt context, and your application presumably has other things to do?</p>\n\n<p>The following is a slightly genericised version of my implementation.  It uses STM32 Standard Peripheral Library calls rather then direct register access or the later STM32Cube HAL, but you can easily port it one way or the other as you need.  The framing is N,8,1.</p>\n\n<pre><code>#define SOFT_RX__BAUD = 4800u ;\n#define SOFT_RX_TIMER_RELOAD = 100u ;\n\nvoid softRxInit( void )\n{\n    // Enable SYSCFG clock\n    RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);\n\n    // Connect the EXTI Line to GPIO Pin\n    SYSCFG_EXTILineConfig( EXTI_PortSourceGPIOB, EXTI_PinSource0 );\n\n    TIM_Cmd( TIM10, DISABLE);\n\n    // NVIC initialisation\n    NVIC_InitTypeDef NVIC_InitStructure = {0,0,0,DISABLE};\n    NVIC_InitStructure.NVIC_IRQChannel = TIM1_UP_TIM10_IRQn;\n    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 12; \n    NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;\n    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\n    NVIC_Init(&amp;NVIC_InitStructure);\n\n    // Enable peripheral clock to timers\n    RCC_APB2PeriphClockCmd(RCC_APB2Periph_TIM10, ENABLE);\n\n    TIM_ARRPreloadConfig( TIM10, DISABLE );\n\n    // Generate soft Rx rate clock (4800 Baud)\n    TIM_TimeBaseInitTypeDef init = {0};\n    TIM_TimeBaseStructInit( &amp;init ) ;\n    init.TIM_Period = static_cast&lt;uint32_t&gt;( SOFT_RX_TIMER_RELOAD );\n    init.TIM_Prescaler = static_cast&lt;uint16_t&gt;( (TIM10_ClockRate() / (SOFT_RX__BAUD * SOFT_RX_TIMER_RELOAD)) - 1 );\n    init.TIM_ClockDivision = 0;\n    init.TIM_CounterMode = TIM_CounterMode_Up;\n    TIM_TimeBaseInit( TIM10, &amp;init ) ;\n\n    // Enable the EXTI Interrupt in the NVIC\n    NVIC_InitStructure.NVIC_IRQChannel = EXTI9_5_IRQn;\n    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 12;  \n    NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;\n    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\n    NVIC_Init( &amp;NVIC_InitStructure );\n\n    // Dummy call to handler to force initialisation \n    // of UART frame state machine\n    softRxHandler() ;\n}\n\n// Soft UART Rx START-bit interrupt handler\nvoid EXTI0_IRQHandler()\n{\n    // Shared interrupt, so verify that it is the correct one\n    if( EXTI_GetFlagStatus( EXTI_Line0 ) == SET )\n    {\n        // Clear the EXTI line pending bit.\n        // Same as EXTI_ClearITPendingBit( EXTI_Line11 )\n        EXTI_ClearFlag( EXTI_Line0 ) ;\n\n        // Call Soft UART Rx handler\n        softRxHandler() ;\n    }\n}\n\nvoid TIM1_UP_TIM10_IRQHandler( void )\n{\n    // Call Soft UART Rx handler\n    softRxHandler() ;\n\n    TIM_ClearITPendingBit( TIM10, TIM_IT_Update );\n}\n\n// Handler for software UART Rx\ninline void softRxHandler()\n{\n    static const int START_BIT = -1 ;\n    static const int STOP_BIT = 8 ;\n    static const int HALF_BIT = SOFT_RX_TIMER_RELOAD / 2;\n    static const int FULL_BIT = SOFT_RX_TIMER_RELOAD ;\n    static int rx_bit_n = STOP_BIT ;\n    static const uint8_t RXDATA_MSB = 0x80 ;\n    static uint8_t rx_data = 0 ;\n    static EXTI_InitTypeDef extiInit = { EXTI_Line0,\n                                         EXTI_Mode_Interrupt,\n                                         EXTI_Trigger_Falling,\n                                         DISABLE } ;\n\n    // Switch START-bit/DATA-bit\n    switch( rx_bit_n )\n    {\n        case START_BIT :\n        {\n            // Stop waiting for START_BIT\n            extiInit.EXTI_LineCmd = DISABLE;\n            EXTI_Init( &amp;extiInit );\n\n            // Enable the Interrupt\n            TIM_ClearITPendingBit( TIM10, TIM_IT_Update );\n            TIM_ITConfig( TIM10, TIM_IT_Update, ENABLE );\n\n            // Enable the timer (TIM10)\n            // Set time to hit centre of data LSB\n            TIM_SetAutoreload( TIM10, FULL_BIT + HALF_BIT ) ;\n            TIM_Cmd( TIM10, ENABLE );\n\n            // Next = LSB data\n            rx_data = 0 ;\n            rx_bit_n++ ;\n        }\n        break ;\n\n        // STOP_BIT is only set on first-time initialisation as a state, othewise it is\n        // transient within this scase.\n        // Use fall through and conditional test to allow\n        // case to handle both initialisation and UART-frame (N,8,1) restart.\n        case STOP_BIT :\n        default :   // Data bits\n        {\n            TIM_ClearITPendingBit( TIM10, TIM_IT_Update );\n\n            if( rx_bit_n &lt; STOP_BIT )\n            {\n                if( rx_bit_n == 0 )\n                {\n                    // On LSB reset time to hit centre of successive bits\n                    TIM_SetAutoreload( TIM10, FULL_BIT ) ;\n                }\n\n                // Shift last bit toward LSB (emulate UART shift register)\n                rx_data &gt;&gt;= 1 ;\n\n                // Read Rx bit from GPIO\n                if( GPIO_ReadInputDataBit( GPIOB, GPIO_Pin_0 ) != 0 )\n                {\n                    rx_data |= RXDATA_MSB ;\n                }\n\n                // Next bit\n                rx_bit_n++ ;\n            }\n\n            // If initial state or last DATA bit sampled...\n            if( rx_bit_n == STOP_BIT )\n            {\n                // Stop DATA-bit sample timer\n                TIM_Cmd( TIM10, DISABLE );\n\n                // Wait for new START-bit\n                rx_bit_n = START_BIT ;\n                extiInit.EXTI_LineCmd = ENABLE;\n                EXTI_Init( &amp;extiInit );\n\n                // Place character in Rx buffer\n                serialReceive( rx_data ) ;\n            }\n        }\n        break ;\n    }\n}\n</code></pre>\n\n<p>The code works in the same way as a real UART as illustrated in the timing diagrem above with the exception that in my implementation the STOP bit is not actually sampled - it is unnecessary; it only serves to ensure that the subsequent START bit is a 1 -> 0 transition and can generally be ignored.  A real UART would probably generate a framing error if it were not 1, but if you were not going to handle such errors in any event, there is no purpose in checking.</p>\n"}, {"tags": [], "owner": {"reputation": 174, "user_id": 5793303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca3f5c1b60217f34afd5233750e4cff6?s=128&d=identicon&r=PG&f=1", "display_name": "Babajan", "link": "https://stackoverflow.com/users/5793303/babajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1556412113, "last_edit_date": 1556412113, "creation_date": 1556383734, "answer_id": 55882755, "question_id": 55256101, "link": "https://stackoverflow.com/questions/55256101/usart-receiver-on-stm32/55882755#55882755", "title": "USART receiver on STM32", "body": "<p>You mentioned that character 't' is received when string \"test\" is sent. \nIntroduce sufficient inter character delay in the string. \nHopefully it works. \nYou can use docklite for sending string with inter character delay. </p>\n"}], "owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1603007549, "creation_date": 1553069268, "last_edit_date": 1553079568, "question_id": 55256101, "link": "https://stackoverflow.com/questions/55256101/usart-receiver-on-stm32", "title": "USART receiver on STM32", "body": "<p>Hi I am currently working on USART communication trying to transmit and receive data from any GPIO pin.</p>\n\n<p>I am succeed to transmit data at any baud-rate when it comes to receiving i got stuck at a point.</p>\n\n<p>I was able to receive a character at a time. Pin is set as external falling edge interrupt used a RX pin.</p>\n\n<p>But when i transmit a string like \"test\" from terminal to controller only \"t\" is received rest 3 character is garbage value. I was thinking that after receiving first character and saving it, the Interrupt is not triggered as fast for next character.</p>\n\n<p>Many things are hard coded in this sample code for test purpose.</p>\n\n<p>Here the sample code for receiver</p>\n\n<pre><code>void EXTI0_IRQHandler(void){\nr0 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr1 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr2 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr3 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr4 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr5 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr6 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr7 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr8 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr9 = GPIOA-&gt;IDR;\ndelay_us(delay_time);\nr1 = r1 &amp; 0x00000001;\nr2 = r2 &amp; 0x00000001;\nr3 = r3 &amp; 0x00000001;\nr4 = r4 &amp; 0x00000001;\nr5 = r5 &amp; 0x00000001;\nr6 = r6 &amp; 0x00000001;\nr7 = r7 &amp; 0x00000001;\nr8 = r8 &amp; 0x00000001;\nx |= r8;\nx = x &lt;&lt; 1;\nx |= r7;\nx = x &lt;&lt; 1;\nx |= r6;\nx = x &lt;&lt; 1;\nx |= r5;\nx = x &lt;&lt; 1;\nx |= r4;\nx = x &lt;&lt; 1;\nx |= r3;\nx = x &lt;&lt; 1;\nx |= r2;\nx = x &lt;&lt; 1;\nx |= r1;\nbuff1[z++] = x;\nEXTI-&gt;PR |= 0X00000001;\nx=0;\nreturn ;}\n</code></pre>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c++", "c", "pointers", "variable-assignment"], "comments": [{"owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "edited": false, "score": 0, "creation_date": 1553068393, "post_id": 55255818, "comment_id": 97243378, "body": "Please provide the definition of class/struct ekf_t."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1553068554, "post_id": 55255818, "comment_id": 97243458, "body": "Just compile it as C, not C++ - you can still link it with your C++ code of course."}, {"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "edited": false, "score": 0, "creation_date": 1553068771, "post_id": 55255818, "comment_id": 97243559, "body": "Ensure <code>x</code> and <code>P</code> type of the fields in <code>ekf_t</code> are pointer to double <code>double *</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553068804, "post_id": 55255818, "comment_id": 97243583, "body": "All those members are arrays, and you can&#39;t assign to arrays. Pick up a good beginners&#39; book."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553069697, "post_id": 55255818, "comment_id": 97243969, "body": "Not a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553069718, "post_id": 55255818, "comment_id": 97243978, "body": "It is neither <i>minimal nor complete</i>"}, {"owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553075598, "post_id": 55255818, "comment_id": 97247167, "body": "@AnttiHaapala With the new context, I understand that the question is not complete. However, at the time of writing this question, I believed that the error was rooted in the way the code was ported from C to C++ and not a syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "edited": false, "score": 0, "creation_date": 1553075481, "post_id": 55255932, "comment_id": 97247087, "body": "Here is what I don&#39;t understand. If it works for the examples given in the repository, I am just recreating the entire same thing within my program. Shouldn&#39;t it work?"}, {"owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "edited": false, "score": 0, "creation_date": 1553075642, "post_id": 55255932, "comment_id": 97247199, "body": "I believe that they would be arrays in the original code too, being assigned to a double. Which is why I&#39;m confused."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "edited": false, "score": 0, "creation_date": 1553075775, "post_id": 55255932, "comment_id": 97247286, "body": "Which example file is this happening in? It would be interesting to have a look."}, {"owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "edited": false, "score": 0, "creation_date": 1553125804, "post_id": 55255932, "comment_id": 97274768, "body": "if you look into /extras/c, there is a GPS example that uses this and doesn&#39;t spit out an error."}, {"owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "edited": false, "score": 0, "creation_date": 1553127545, "post_id": 55255932, "comment_id": 97275216, "body": "it compiles, now to check if it functions in the manner that we want it to."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1553068643, "creation_date": 1553068643, "answer_id": 55255932, "question_id": 55255818, "link": "https://stackoverflow.com/questions/55255818/error-assignment-to-expression-with-array-type/55255932#55255932", "title": "error assignment to expression with array type", "body": "<p>According to <a href=\"https://github.com/ericbarch/arduino-libraries/blob/master/TinyEKF/tiny_ekf_struct.h\" rel=\"nofollow noreferrer\">this</a>, <code>ekf.x</code> is of type <code>double x[]</code>. You can't just assign to an array like <code>ekf-&gt;x = dptr;</code>, as the error says. If you want to copy data from <code>dptr</code> to <code>ekf-&gt;x</code>, you can use <code>memcpy</code>:</p>\n\n<pre><code>memcpy(&amp;ekf-&gt;x, dptr, sizeof(ekf-&gt;x));\n</code></pre>\n\n<p>The same goes for all the other assignments, most of those fields are <code>double</code> arrays.</p>\n"}], "owner": {"reputation": 2032, "user_id": 4805357, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/muA8J.jpg?s=128&g=1", "display_name": "SDG", "link": "https://stackoverflow.com/users/4805357/sdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55255932, "answer_count": 1, "score": 0, "last_activity_date": 1553068643, "creation_date": 1553068167, "question_id": 55255818, "link": "https://stackoverflow.com/questions/55255818/error-assignment-to-expression-with-array-type", "title": "error assignment to expression with array type", "body": "<p>I have a function named <code>unpack</code>, and compiling the C++ code leads to a couple of errors. The code is below:  </p>\n\n<pre><code>static void unpack(void *v, ekf_t *ekf, int n, int m) {\n    /* skip over n, m in data structure */\n    char *cptr = (char *) v;\n    cptr += 2 * sizeof(int);\n\n    double *dptr = (double *) cptr;\n    ekf-&gt;x = dptr;\n    dptr += n;\n    ekf-&gt;P = dptr;\n    dptr += n * n;\n    ekf-&gt;Q = dptr;\n    dptr += n * n;\n    ekf-&gt;R = dptr;\n    dptr += m * m;\n    ekf-&gt;G = dptr;\n    dptr += n * m;\n    ekf-&gt;F = dptr;\n    dptr += n * n;\n    ekf-&gt;H = dptr;\n    dptr += m * n;\n    ekf-&gt;Ht = dptr;\n    dptr += n * m;\n    ekf-&gt;Ft = dptr;\n    dptr += n * n;\n    ekf-&gt;Pp = dptr;\n    dptr += n * n;\n    ekf-&gt;fx = dptr;\n    dptr += n;\n    ekf-&gt;hx = dptr;\n    dptr += m;\n    ekf-&gt;tmp0 = dptr;\n    dptr += n * n;\n    ekf-&gt;tmp1 = dptr;\n    dptr += n * m;\n    ekf-&gt;tmp2 = dptr;\n    dptr += m * n;\n    ekf-&gt;tmp3 = dptr;\n    dptr += m * m;\n    ekf-&gt;tmp4 = dptr;\n    dptr += m * m;\n    ekf-&gt;tmp5 = dptr;\n}\n</code></pre>\n\n<p>And I get these errors propagated over every line of the code: </p>\n\n<pre><code>.../src/ekf.c:203:12: error: assignment to expression with array type\n     ekf-&gt;x = dptr;\n            ^\n.../src/ekf.c:205:12: error: assignment to expression with array type\n     ekf-&gt;P = dptr;\n</code></pre>\n\n<p>It should be noted that the code <code>unpack</code> was grabbed from a C library. I have tried using an <code>extern</code>, but this does not seem to work too well. Now, when I <code>make</code> the original repository (<a href=\"https://github.com/simondlevy/TinyEKF\" rel=\"nofollow noreferrer\">https://github.com/simondlevy/TinyEKF</a>), it seems to compile without a problem. The compile command for TinyEKF, which contains and uses this code, is:  </p>\n\n<p><code>gcc -Wall -I. -I../../src -o gps_ekf gps_ekf.c ../../src/tiny_ekf.c -lm\n</code></p>\n\n<p>This is found within <code>/extras/c/</code> within the repository and certainly uses the <code>unpack</code> function. </p>\n"}, {"tags": ["c", "struct", "free"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1553067310, "post_id": 55255574, "comment_id": 97242906, "body": "It has nothing do with <code>free</code> read error message properly.It says you are declaring <code>l</code> two times."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1553067347, "post_id": 55255574, "comment_id": 97242920, "body": "Deallocation of memory under a pointer will not undeclare a variable. You can only declare a variable in a scope once."}, {"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "edited": false, "score": 0, "creation_date": 1553067363, "post_id": 55255574, "comment_id": 97242931, "body": "You define <code>l</code> for a second time in the same code block ..."}, {"owner": {"reputation": 59, "user_id": 2765418, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001085962444/picture?type=large", "display_name": "Dominic Gibson", "link": "https://stackoverflow.com/users/2765418/dominic-gibson"}, "edited": false, "score": 0, "creation_date": 1553067534, "post_id": 55255574, "comment_id": 97243005, "body": "After free l is still a pointer. But it points to an undefined memory section."}], "answers": [{"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1553067558, "post_id": 55255651, "comment_id": 97243023, "body": "<code>you can&#39;t declare a variable twice in the same function</code> If you could mention in the same scope instead of same function."}], "tags": [], "owner": {"reputation": 33, "user_id": 7976865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7563ab5688dc537af9c84c25587cf880?s=128&d=identicon&r=PG&f=1", "display_name": "UndefinedUserAtSO", "link": "https://stackoverflow.com/users/7976865/undefineduseratso"}, "is_accepted": false, "score": 2, "last_activity_date": 1553067853, "last_edit_date": 1553067853, "creation_date": 1553067478, "answer_id": 55255651, "question_id": 55255574, "link": "https://stackoverflow.com/questions/55255574/unable-to-free-a-struct/55255651#55255651", "title": "Unable to Free a struct", "body": "<p>You can't declare a variable twice in the same scope. That's why you get a redefinition error.</p>\n\n<p>Your list pointer is a variable as well. You must not re-declare <code>l</code> in your main function.</p>\n\n<p>Your compiler already knows that it's a <code>list *</code>, so you should remove the <code>list *</code> on line 19.</p>\n\n<p>also i think you misunderstand what <code>free</code> does. it de allocates the memory that you allocated with <code>malloc</code> and thus makes the memory at the pointer's address unusable within your program. you must re use <code>malloc</code> (or you can directly use <code>realloc</code> without need to use <code>free</code> before).</p>\n"}], "owner": {"reputation": 1927, "user_id": 953419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0f79e690bef0b6c98676b5751056e0a1?s=128&d=identicon&r=PG", "display_name": "seamus", "link": "https://stackoverflow.com/users/953419/seamus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553069040, "creation_date": 1553067141, "last_edit_date": 1553069040, "question_id": 55255574, "link": "https://stackoverflow.com/questions/55255574/unable-to-free-a-struct", "title": "Unable to Free a struct", "body": "<p>I was unable to free a struct. My understanding of 'free(void *)' is that after freeing the pointer, the variable &amp; memory address can be reused. This is not the case below,</p>\n\n<pre><code>struct list {\n  struct list_node * head;\n  int size;\n  };\ntypedef struct list list;\n\n//create\nlist * create_list() {\n    list * l = (list *) malloc(sizeof(list));\n    l-&gt;head = NULL;\n    l-&gt;size = 0;\n    return l;\n}\n\nint main(int argc, char const *argv[]) {\n\n    list * l = create_list();\n    free(l);\n    list * l = create_list();\n\n    return 0;\n}\n</code></pre>\n\n<blockquote>\n  <p>main.c:25:12: error: redefinition of 'l'\n      list * l = create_list();\n             ^ main.c:23:12: note: previous definition is here\n      list * l = create_list();\n             ^ 1 error generated.</p>\n</blockquote>\n"}, {"tags": ["c", "union", "strict-aliasing", "type-punning"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 1, "creation_date": 1553066038, "post_id": 55254998, "comment_id": 97242415, "body": "Not related to your question but If uint64_repr is supposed to represent the bytes of uint64_t use \u201dunsigned char\u201d, not \u201dchar\u201d."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1553066368, "post_id": 55254998, "comment_id": 97242530, "body": "@Fredrik Sure, thanks."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 1, "creation_date": 1553067098, "post_id": 55254998, "comment_id": 97242824, "body": "The program is OK (although you don&#39;t need <code>&amp;()</code>). As for the exact meaning, gotta unpack the language somehow..."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553067266, "post_id": 55254998, "comment_id": 97242885, "body": "@AlexeyFrunze Thanks. But I have some question. Is it common to use <code>union</code> for type-punning? I mean if we have a stack-allocated object with some declared type in order to reinterpret it as another type <i>in a conforming way</i> we have to define a union containing the two and use it to access this object."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 2, "creation_date": 1553067818, "post_id": 55254998, "comment_id": 97243145, "body": "Type punning (in either form) is quite common in low-level code that deals with a variety of types (compilers/interpreters/JITs, OSes, protocols). In C there are two general ways (other than accessing unsigned as signed and vice versa): <code>memcpy()</code> and <code>union</code>. In C++ of those two there&#39;s just <code>memcpy()</code>."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553068317, "post_id": 55254998, "comment_id": 97243339, "body": "<code>The New C Standard: An Economic and Cultural Commentary</code> says of <code>\u2014 an aggregate or union type that includes one of the aforementioned types among its members (including, recursively, a member of a subaggregate or contained union)</code>: <code>A particular object may be an element of an array or a member of a structure or union type. Objects having one of these derived types can be accessed as a whole; for instance, using an assignment operator (the array object will need to be a member of a structure or union type). It is this access as a whole that in turn accesses the stored value(s) of the members</code>"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 1, "creation_date": 1564267927, "post_id": 55254998, "comment_id": 100975527, "body": "@AlexeyFrunze: The Standard defines the meaning of <code>someUnion.someArray[index]</code> as being equivalent to <code>*(someUnion.someArray+index)</code>.  Neither clang nor gcc will reliably recognize the latter form as being an access to <code>someUnion</code>.  Does the Standard make any distinction between the forms, require compilers to recognize the second, or rely upon compilers to recognize patterns beyond what it actually requires?"}], "answers": [{"comments": [{"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1553068972, "post_id": 55255921, "comment_id": 97243638, "body": "Thanks for shedding the light about aliasing through <code>union</code>s. But they mentioned <i>an aggregate or union type</i>. Can we modify your example as <code>typedef struct { float f; unsigned u;} f2s;</code> to be used for aliasing purpose?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "edited": false, "score": 0, "creation_date": 1553069134, "post_id": 55255921, "comment_id": 97243722, "body": "What you are doing with the <code>union</code> and the same in my example, is simply allowing the bytes in memory (which are the same when the union has a value) to be treated as having either an effective type of <code>float</code> or <code>unsigned</code> and the compiler not having problems. So yes, you can rename it <code>myfloat2unsigned</code> or anything you like."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1553072194, "post_id": 55255921, "comment_id": 97245164, "body": "So what is the answer to the question? Is the behavior of the program well-defined? (I guess yes, but please clarify)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1553074097, "post_id": 55255921, "comment_id": 97246244, "body": "Yes, the answer is the code is well defined. There are a number of cases where you are simply &#39;looking at data&#39; through another type (or through another window if that analogy helps). Using a pointer to view data of another, while technically a violation, depending on how it is done, rarely has any consequences. It is using a pointer of a different type to attempt to modify where you see the greatest risk of corruption/undefined behavior due to type-size or padding mismatches. It&#39;s not worth tempting fate in those cases."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 3, "last_activity_date": 1553068601, "creation_date": 1553068601, "answer_id": 55255921, "question_id": 55254998, "link": "https://stackoverflow.com/questions/55254998/aliasing-through-unions/55255921#55255921", "title": "Aliasing through unions", "body": "<p>What is means is using a <code>union</code> is one of the standard compliant ways to avoid type punning and the strict aliasing violation that would otherwise occur if you attempted to access a stored value through a pointer of a different type.</p>\n\n<p>Take for example <code>unsigned</code> and <code>float</code>, generally both 32-bits and in certain cases looking at the stored value from either <code>unsigned*</code> or <code>float*</code> may be needed. You cannot for example do:</p>\n\n<pre><code>    float f = 3.3;\n    // unsigned u = *(unsigned *)&amp;f;  /* violation */\n</code></pre>\n\n<p>Following <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5p7\" rel=\"nofollow noreferrer\">6.5(p7)</a> you can use a <code>union</code> between both types and access the same information as either <code>unsigned</code> or <code>float</code> without type-punning a pointer or running afoul of the strict aliasing rule, e.g.</p>\n\n<pre><code>typedef union {\n    float f;\n    unsigned u;\n} f2u;\n...    \n    float f = 3.3;\n    // unsigned u = *(unsigned *)&amp;f;  /* violation */\n    f2u fu = { .f = f };\n    unsigned u = fu.u;                /* OK - no violation */\n</code></pre>\n\n<p>So the strict aliasing rule prevents accessing memory with an effective-type through a pointer of another type, unless that pointer is <code>char</code> type or a pointer to a member of a union between the two types.</p>\n\n<p>(<strong>note:</strong> that section of the standard is one that is anything but an example of clarity. (you can read it 10 times and still scratch your head) Its intent is to curb the abuse of pointer types, while still recognizing that a block of memory in any form must be capable of being accessed through a character type, (and a <code>union</code> is among the other allowable manners of access).)</p>\n\n<p>Compilers have gotten much better in the past few years at flagging violations of the rule.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 2, "last_activity_date": 1553099344, "creation_date": 1553099344, "answer_id": 55265731, "question_id": 55254998, "link": "https://stackoverflow.com/questions/55254998/aliasing-through-unions/55265731#55265731", "title": "Aliasing through unions", "body": "<p>The bullet point serves two purposes.  First of all, if one recognizes that an access to an lvalue which is, or might be, visibly based upon an lvalue of a particular type should be recognized as an lvalue, or possible lvalue, of the latter type, then given something like:</p>\n\n<pre><code>union U {int x[10]; float y[10];} u;\n</code></pre>\n\n<p>an lvalue which is visibly derived from <code>u</code> would be allowed to access all of the objects contained therein.  The range of situations in which an implementation would recognize that an lvalue is based upon another is a quality-of-implementation issue, with some quality compilers like icc being able to recognize, given something like:</p>\n\n<pre><code>int load_array_element(int *array, int i) { return array[i]); }\n...\nint test(int i) { return load_array_element(&amp;u.x, i); }\n</code></pre>\n\n<p>that anything that <em>particular</em> call to <code>load_array_element</code> might do with <code>*array</code> would done with <code>u</code> (it is being given an address of an lvalue directly formed from <code>u</code>, after all), and other compilers like clang and gcc being unable to recognize even a construct like <code>*(u.x+i)</code> as an lvalue based on <code>u</code>.</p>\n\n<p>A second purpose of the bullet is to suggest that even if a compiler is too primitive to keep track of lvalue derivation in straight-line code, it should recognize that given declarations:</p>\n\n<pre><code>int *p,i;\nstruct foo { int x;} foo;\n</code></pre>\n\n<p>if it sees <code>*p=1; i=foo.x;</code> without having paid any attention to where <code>p</code> came from, it must ensure that the write to <code>*p</code> is performed before the read of <code>foo.x</code>.  Even if that should only really be necessary in cases where a compiler which had been bothering to pay attention would have been able to see that <code>p</code> had been formed from <code>foo</code>, describing things in those terms would have increased apparent compiler complexity compared with making the access to <code>foo.x</code> force the completion of any pending writes to the targets of integer pointers.</p>\n\n<p>Note that if one is interested only in cases where a struct or union member is accessed via freshly-derived pointer, there's no need to include a general permission to access the struct or union object via lvalue of member type.  Given the code sequence: <code>foo.x = 1; p = &amp;foo.x; i=*p;</code>, the act of taking the address of <code>foo.x</code> should cause the compiler to complete any pending writes to <code>foo.x</code> before running any code that might use the address (a compiler that has no idea what downstream code would do with the address could simply complete the write immediately).  If the code sequence were <code>foo.x = 1; i = *p;</code>, the act of accessing <code>foo.x</code> via the lvalue <code>foo</code> would mean that any existing pointer that might identify that storage would be \"stale\", and thus a compiler would be under no obligation to recognize that such a pointer might identify the same storage as <code>foo.x</code>.</p>\n\n<p>Note that despite footnote 88 which clearly says that the purpose of the \"strict aliasing rule\" is to specify when objects are allowed to alias, the interpretation by gcc and clang interpret the rule as an excuse to ignore cases in which objects are accessed by lvalues which are quite visibly derived from them.  Perhaps in retrospect the authors of the Standard should have included a provision \"Note that this rule makes no attempt to forbid low-quality compilers from behaving in obtuse fashion, but is not intended to invite such behavior\" but the authors of C89 had no reason to expect that the rule would be interpreted as it has, and the authors of clang and gcc would almost certainly veto any suggestion to add such language now.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "accepted_answer_id": 55255921, "answer_count": 2, "score": 3, "last_activity_date": 1553099344, "creation_date": 1553064610, "last_edit_date": 1553066448, "question_id": 55254998, "link": "https://stackoverflow.com/questions/55254998/aliasing-through-unions", "title": "Aliasing through unions", "body": "<p>The <code>6.5(p7)</code> has a bullet about <code>union</code>s and <code>aggregate</code>s:</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue\n  expression that has one of the following types:</p>\n  \n  <p>[...]</p>\n  \n  <p>\u2014 an aggregate or union type that includes one of the aforementioned\n  types among its members (including, recursively, a member of a\n  subaggregate or contained union), or</p>\n</blockquote>\n\n<p>This is not quite clear what it means. Does it require at <em>least one member</em> or <em>all members</em> to satisfy the strict aliasing rule. Particularly about <code>union</code>s:</p>\n\n<pre><code>union aliased{\n    unsigned char uint64_repr[sizeof(uint64_t)];\n    uint64_t value;\n};\n\nint main(int args, const char *argv[]){\n    uint64_t some_random_value = 123;\n    union aliased alias;\n    memcpy(&amp;(alias.uint64_repr), &amp;some_random_value, sizeof(uint64_t));\n    printf(\"Value = %\" PRIu64 \"\\n\", alias.value);\n}\n</code></pre>\n\n<p><a href=\"http://coliru.stacked-crooked.com/a/4f82ff7ec75a303a\" rel=\"nofollow noreferrer\">DEMO</a></p>\n\n<p>Is the behavior of the program well-defined? If no, what does the bullet mean?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1612, "user_id": 1955268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNvCE.jpg?s=128&g=1", "display_name": "Priyank Panchal", "link": "https://stackoverflow.com/users/1955268/priyank-panchal"}, "edited": false, "score": 0, "creation_date": 1553058393, "post_id": 55253763, "comment_id": 97239825, "body": "Marcel, welcome to StackOverflow. Your question is not clear as to what is it that you need. Please be specific and show what you have tried till now. Please check <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a>"}, {"owner": {"reputation": 3717, "user_id": 1215996, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ff628cd135c5f60ce0dfda4b40ac06e?s=128&d=identicon&r=PG", "display_name": "Sumit Trehan", "link": "https://stackoverflow.com/users/1215996/sumit-trehan"}, "edited": false, "score": 0, "creation_date": 1553059216, "post_id": 55253763, "comment_id": 97240049, "body": "What do you mean without arrays ?"}, {"owner": {"reputation": 15619, "user_id": 1548468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745dce203d52699e63a575b3103ad70?s=128&d=identicon&r=PG", "display_name": "Botje", "link": "https://stackoverflow.com/users/1548468/botje"}, "edited": false, "score": 0, "creation_date": 1553060733, "post_id": 55253763, "comment_id": 97240486, "body": "The solution will involve three things: taking the right-most digit, shifting everything to the right, and prepending the digit to your number. Which have you tried and which are you having trouble with?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1553066060, "post_id": 55253763, "comment_id": 97242423, "body": "What is the question? Please code <code>RightRotateDigit(int num)</code> for me?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1553288225, "post_id": 55253763, "comment_id": 97343546, "body": "Are you allowed to handle your input as a string rather than an integer? That would make this exercise much simpler."}, {"owner": {"reputation": 17, "user_id": 11229875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y5cSete-BD0/AAAAAAAAAAI/AAAAAAAADek/y858O6ljN-0/photo.jpg?sz=128", "display_name": "Marcel Mhmood", "link": "https://stackoverflow.com/users/11229875/marcel-mhmood"}, "reply_to_user": {"reputation": 3717, "user_id": 1215996, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ff628cd135c5f60ce0dfda4b40ac06e?s=128&d=identicon&r=PG", "display_name": "Sumit Trehan", "link": "https://stackoverflow.com/users/1215996/sumit-trehan"}, "edited": false, "score": 0, "creation_date": 1553288395, "post_id": 55253763, "comment_id": 97343612, "body": "@SumitTrehan i cant use arrays in my homework but here idk if it&#39;s useful to use but, never mind."}, {"owner": {"reputation": 17, "user_id": 11229875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y5cSete-BD0/AAAAAAAAAAI/AAAAAAAADek/y858O6ljN-0/photo.jpg?sz=128", "display_name": "Marcel Mhmood", "link": "https://stackoverflow.com/users/11229875/marcel-mhmood"}, "reply_to_user": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1553288563, "post_id": 55253763, "comment_id": 97343672, "body": "@Govind Parmar i still didnt reached strings but, it would be great if you can show me how it is simpler. Thank you"}, {"owner": {"reputation": 17, "user_id": 11229875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y5cSete-BD0/AAAAAAAAAAI/AAAAAAAADek/y858O6ljN-0/photo.jpg?sz=128", "display_name": "Marcel Mhmood", "link": "https://stackoverflow.com/users/11229875/marcel-mhmood"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553380024, "post_id": 55253763, "comment_id": 97364805, "body": "@DavidC.Rankin i want to know what&#39;s the difference to do with left rotation and right rotation i already done right rotation. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 11040825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3_v55N1kEZw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpHTqYwOVBxRekjR8w5knSDvY6Ew/mo/photo.jpg?sz=128", "display_name": "Madhav Sarpal", "link": "https://stackoverflow.com/users/11040825/madhav-sarpal"}, "edited": false, "score": 0, "creation_date": 1553061475, "post_id": 55254258, "comment_id": 97240704, "body": "why do you hardcode the value 10000?..the number will not always be 5 digit long"}, {"owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "reply_to_user": {"reputation": 196, "user_id": 11040825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3_v55N1kEZw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpHTqYwOVBxRekjR8w5knSDvY6Ew/mo/photo.jpg?sz=128", "display_name": "Madhav Sarpal", "link": "https://stackoverflow.com/users/11040825/madhav-sarpal"}, "edited": false, "score": 0, "creation_date": 1553061872, "post_id": 55254258, "comment_id": 97240840, "body": "i am just giving the answer of particular query. This logic is called palandrom. You can find full code online for your search for palandrom a number."}], "tags": [], "owner": {"reputation": 196, "user_id": 11139937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb20157f20488d087487a13a9544987?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/11139937/vaibhav"}, "is_accepted": false, "score": -2, "last_activity_date": 1553060715, "creation_date": 1553060715, "answer_id": 55254258, "question_id": 55253763, "link": "https://stackoverflow.com/questions/55253763/left-circular-moving/55254258#55254258", "title": "Left circular moving", "body": "<p>Hi this logic might help you with you problem</p>\n\n<pre><code>int r=0,num = 12345;\nr = num % 10;\nnum = num / 10;\nnum = r * 10000 + num;\n/* print num and your answer will be 51234 */\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 11040825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3_v55N1kEZw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpHTqYwOVBxRekjR8w5knSDvY6Ew/mo/photo.jpg?sz=128", "display_name": "Madhav Sarpal", "link": "https://stackoverflow.com/users/11040825/madhav-sarpal"}, "is_accepted": false, "score": 2, "last_activity_date": 1553064962, "last_edit_date": 1553064962, "creation_date": 1553061323, "answer_id": 55254380, "question_id": 55253763, "link": "https://stackoverflow.com/questions/55253763/left-circular-moving/55254380#55254380", "title": "Left circular moving", "body": "<pre><code>#include &lt;stdio.h&gt;  \n#include &lt;math.h&gt;\n\nint getdig(int n){          //to get the no of digits in a number\n  int count=0;\n  while(n%10&gt;0){\n    count ++;\n    n=n/10;\n  }\n  return count;\n}\n\nint RightRotateDigit(int num) {           //exmpl 12345\n  int rightmost=num%10;                    //get the last digit 5\n  num=num-rightmost;                       // num is now 12340\n  num=num/10;                               //num is now 1234\n  int dig=getdig(num)                     //get the no of digits in 1234 i.e 4\n  int add=rightmost*pow(10,dig) ;         //5*10000=50000\n  num=num+add;                             //num is now 51234\n  return num;\n}\n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1553394202, "post_id": 55254409, "comment_id": 97367282, "body": "Please don&#39;t use <code>using namespace std</code> in answers. It&#39;s a VERY bad habit. Also, the question is about C and not C++, so you might as well delete this answer. (Yes, I know the question had the C++ tag before. It&#39;s a common mistake.)"}], "tags": [], "owner": {"reputation": 162, "user_id": 8950836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L7qy4.jpg?s=128&g=1", "display_name": "C_Raj", "link": "https://stackoverflow.com/users/8950836/c-raj"}, "is_accepted": false, "score": 3, "last_activity_date": 1553061483, "creation_date": 1553061483, "answer_id": 55254409, "question_id": 55253763, "link": "https://stackoverflow.com/questions/55253763/left-circular-moving/55254409#55254409", "title": "Left circular moving", "body": "<pre><code>#include &lt;iostream&gt;\nusing namespace std;\n\n// steps:\n// number example : 12345\n// get the first digit : 5\n// get the rest number : 1234\n// get the number of digit in rest number : 4\n// shifted number : rest number + firstDigit x 10^(num of digit)\n//                : 1234        + 5          x 10^4\n//                : 1234        + 50000 =   51234\nint rotateRight(int num) {\n    int firstDigit = num % 10;\n    int restNumber = num / 10;\n    int numberOfDigit = 0;\n    int temp = restNumber;\n    while (temp != 0) {\n        temp /= 10;\n        numberOfDigit++;\n    }\n    return restNumber + firstDigit * pow(10, numberOfDigit);\n}\n\nint main() {\n    int num = 12345;\n    cout &lt;&lt; rotateRight(num) &lt;&lt; endl;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11229875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-y5cSete-BD0/AAAAAAAAAAI/AAAAAAAADek/y858O6ljN-0/photo.jpg?sz=128", "display_name": "Marcel Mhmood", "link": "https://stackoverflow.com/users/11229875/marcel-mhmood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1553380418, "creation_date": 1553057354, "last_edit_date": 1553380418, "question_id": 55253763, "link": "https://stackoverflow.com/questions/55253763/left-circular-moving", "title": "Left circular moving", "body": "<p>The code contains Right Circular moving which is for example the number <strong>12345</strong> will be <strong>51234</strong>.</p>\n\n<p>the question is how i can make <strong>left circular moving</strong> which is for example <strong>12345</strong> will be <strong>23451</strong>, my number is bettween 3 digits to 10 not only 5 digits. Please Help?</p>\n\n<p>Thank you.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint mPow(long n, long b);\nlong Counts(long);\nint main() {\nlong q;\nprintf(\"Please Enter a number \\n\");\nscanf(\"%ld\",&amp;q);\nprintf(\"Right Rotate:%ld \\n\",(q%10)*(mPow(10,Counts(q)-1))+q/10);\n\nreturn 0;\n}\nlong Counts(long q) {\nint count=0;\n      while(q!=0) {\n               q/=10;\n               count++;\n}\nreturn count;\n}\nlong mPow(long n,long b) { //n=&gt;Base, b=&gt;power\nlong ret=1;\nwhile(b!=0) {\n        ret = ret*n;\n        b--;\n }\n }\n</code></pre>\n"}, {"tags": ["c", "malloc", "realloc"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1553056058, "post_id": 55253561, "comment_id": 97239265, "body": "Have you tried debugging? Obvious thing to check <code>intervals</code> is valid and <code>intervals[j]</code> is initialized."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1553056471, "post_id": 55253561, "comment_id": 97239343, "body": "@John3136 Yes I checked the nIntervals is fine, intervals is fine too with desired values of intervals getting printed in the loop just above the realloc moreover, they are integers, so should be fine in any case. I have made some changes to question please have a loop"}, {"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1553056590, "post_id": 55253561, "comment_id": 97239382, "body": "Apart from what @John3136 says, be cautious about the values of <code>intervals[j]</code> as well as there&#39;s a chance for a multiplication overflow. If that happens later in the code you might access memory you&#39;ve never allocated which would also create a seg fault."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553056678, "post_id": 55253561, "comment_id": 97239408, "body": "@aep definitely, I&#39;ll keep this in mind once I get through this, Thanks for the input."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 3, "creation_date": 1553056707, "post_id": 55253561, "comment_id": 97239416, "body": "Problem would seem to be in the code you&#39;ve skipped via <code>...Some Code...</code>"}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1553056892, "post_id": 55253561, "comment_id": 97239461, "body": "@John3136 I am stuck on this for 4 hours, the whole function is here!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 1, "creation_date": 1553057093, "post_id": 55253561, "comment_id": 97239496, "body": "This doesn&#39;t seem right: <code>for(i = 0; i &lt;= intervals[j]; i++)</code>."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "edited": false, "score": 0, "creation_date": 1553057131, "post_id": 55253561, "comment_id": 97239505, "body": "What&#39;s wrong with it? @dyukha"}, {"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 1, "creation_date": 1553057157, "post_id": 55253561, "comment_id": 97239513, "body": "<code>tempTwo[intervals[j]]</code> isn&#39;t right. This along with what @dyukha mentioned is definitely an out-of-bound access."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 0, "creation_date": 1553057228, "post_id": 55253561, "comment_id": 97239533, "body": "You access index outside of bounds, like aep has shown."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1553057572, "post_id": 55253561, "comment_id": 97239604, "body": "Consider using <code>valgrind</code>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1553057594, "post_id": 55253561, "comment_id": 97239610, "body": "<code>realloc()</code> can fail, and you&#39;re not checking for that.   If it returns <code>NULL</code>, the previously allocated memory must be released.   Also, you are explicitly casting the returned values from <code>malloc()</code> and <code>realloc()</code>, and it appears there is no <code>#include &lt;stdlib.h&gt;</code>.   The combined effect is undefined behaviour (since, without <code>&lt;stdlib.h&gt;</code> (directly or indirectly) the compiler assumes <code>malloc()</code> and <code>realloc()</code> return <code>int</code> - and a pointer is not guaranteed to survive a round trip of conversions (pointer to int and back))."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1553057631, "post_id": 55253561, "comment_id": 97239624, "body": "Are you hinting towards memory leak? @jxh"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1553057740, "post_id": 55253561, "comment_id": 97239652, "body": "<code>valgrind</code> would have detected out of bound accesses."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1553058443, "post_id": 55253561, "comment_id": 97239838, "body": "@Peter I do have the header included, also I have added checks for realloc by taking a temporary pointer and assigning it to tempOne if it not NULL! I suppose this the check you&#39;re talking about ?"}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553059174, "post_id": 55253561, "comment_id": 97240039, "body": "@aep Yes, there was an out of bound access. Updated the code but the problem still remains!"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1553059243, "post_id": 55253561, "comment_id": 97240060, "body": "@Milind - The checks you&#39;re doing result in the function returning, and will cause a leak if there is an error in <code>realloc()</code>.    The code you have posted does not <code>#include &lt;stdlib.h&gt;</code>.   There is also an off-by-one error in one of your <code>for</code> loops.  Look carefully at <code>for(i = 0; i &lt;= intervals[j]; i++)</code>"}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1553059674, "post_id": 55253561, "comment_id": 97240186, "body": "@Peter Thanksyou! Fixed it! Working fine now! :) Can you please post it as an answer so that I can upvote? Also can you please throw some light on how realloc was failing by OOB access? I suspect I was corrupting the memory, is it?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1553060486, "post_id": 55253561, "comment_id": 97240409, "body": "Accessing a value past the end of an array can mean accessing memory that doesn&#39;t exist.  Although it&#39;s more common for writing to non-existent memory to cause a problem, reading from non-existent memory can too."}, {"owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 0, "creation_date": 1553061172, "post_id": 55253561, "comment_id": 97240623, "body": "Got that! @Peter"}], "owner": {"reputation": 749, "user_id": 4764839, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e66rj.jpg?s=128&g=1", "display_name": "Liger", "link": "https://stackoverflow.com/users/4764839/liger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1553059252, "creation_date": 1553055691, "last_edit_date": 1553059252, "question_id": 55253561, "link": "https://stackoverflow.com/questions/55253561/realloc-couldnt-allocate-memory-when-used-in-loop", "title": "Realloc couldn&#39;t allocate memory when used in loop", "body": "<p>I am trying to implement Simpson 1/3 rule in C and facing a problem with using malloc inside a for loop.</p>\n\n<p>My current implementation is </p>\n\n<pre><code>int integrateSimpson(Integrate *intereg)\n{\nint i, j, iLoop, last;\n\ndouble *tempOne = (double *) malloc(sizeof(double) * 1);\ndouble *tempTwo = (double *) malloc(sizeof(double) * 1);\n\ndouble dx, sumOdd, sumEven, area;\n\ndouble lowerLimit = intereg-&gt;lowerLimit;\ndouble upperLimit = intereg-&gt;upperLimit;\nint *intervals = intereg-&gt;intervals;\nint nIntervals = intereg-&gt;nIntervals;\nint method = intereg-&gt;method;\n\nfor(j = 0; j &lt; nIntervals; j++ )\n{\n    printf(\"Number of Intervals: %d\",nIntervals);\n    for(iLoop = 0; iLoop &lt; nIntervals; iLoop++){\n        printf(\"\\nIntervals: %d\", intervals[iLoop]);\n    }\n    tempOne = (double *) realloc(tempOne, sizeof(double) * intervals[j]);\n    tempTwo = (double *) realloc(tempTwo, sizeof(double) * intervals[j]);\n    if(tempTwo == NULL || tempOne == NULL)\n    {\n        TRACE(\"Could not realloc memory to temporary arrays\");\n        return EXIT_FAILURE;\n    }\n\n    if(intervals[j] % 2 != 0)\n    {\n        TRACE(\"Found odd interval, adding 1 to make it even\");\n        intervals[j] = intervals[j] + 1;\n    }\n\n    dx = (upperLimit - lowerLimit) / intervals[j];\n    for(i = 0; i &lt;= intervals[j]; i++)\n    {\n        tempOne[i] = lowerLimit + i * dx;\n\n        tempTwo[i] = intereg-&gt;func(tempOne[i]);\n    }\n\n    sumOdd = 0;\n    sumEven = 0;\n\n    for(i = 1; i &lt; intervals[j]; i++)\n    {\n        if(i % 2 == 1)\n        {\n            sumOdd +=  tempTwo[i];\n        }\n        else\n        {\n            sumEven += tempTwo[i];\n        }\n    }\n    printf(\"\\nPassed %d time\", j );\n    last = intervals[j] - 1;\n    area = dx / 3 * (tempTwo[0] + tempTwo[last] + 4 * sumOdd + 2 * sumEven);\n    intereg-&gt;areaUnderCurve[j]  = area;\n    intereg-&gt;resultMatrix[method - 1][j] = intereg-&gt;areaUnderCurve[j];\n}\n\nfree(tempOne);\ntempOne = NULL;\n\nfree(tempTwo);\ntempTwo = NULL;\nreturn EXIT_SUCCESS; \n}\n</code></pre>\n\n<p>I tried to debug this and found that for <code>intervals = {2,8,16,64}</code> the loop works fine for the first time even the realloc part but with the second iteration for some reason, realloc doesn't work and I get a segmentation fault. I tried to reproduce this problem in the following way but the code below works fine</p>\n\n<pre><code>int i;\ndouble *temp;\n\n/* Initial memory allocation */\ntemp = (double *) malloc(sizeof(double)*1);\n\n/* Reallocating memory */\nfor(i = 0;i&lt;10;i++)\n{\n   temp = (double *) realloc(temp, sizeof(double)* i);\n}\nfree(temp);\ntemp = NULL;\n</code></pre>\n\n<p>I know that realloc basically assigns a new memory at the same time frees the memory pointed by the pointer passed to it. But what is wrong that I am doing here?\nAlso is it a good way to use malloc with loops?</p>\n\n<p>Any lead is appreciated!</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553073110, "post_id": 55253518, "comment_id": 97245676, "body": "Any chance you could use modern C++ instead of C to minimize on the ugly macros?"}, {"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553097528, "post_id": 55253518, "comment_id": 97261624, "body": "Just exploring the limits of macros, I would just use regular functions for tests like <code>void test_foo()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1553097594, "post_id": 55264828, "comment_id": 97261668, "body": "But what about what <a href=\"https://www.quora.com/In-C-how-do-I-define-a-macro-receiving-a-block/answer/Petr-Skocik\" rel=\"nofollow noreferrer\">this</a> guy said."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1553097745, "post_id": 55264828, "comment_id": 97261769, "body": "He&#39;s addressing the same concern I go over; he just doesn&#39;t discuss the &quot;hug&quot; option.  The CPP does match parentheses, and there&#39;s no valid C body that mismatches them, so &quot;hugging&quot; works fine.  Note that I&#39;m using a variadic macro (<code>UNWRAP</code>) to &quot;unhug&quot; it in the expansion."}], "tags": [], "owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "is_accepted": true, "score": 2, "last_activity_date": 1553098938, "last_edit_date": 1553098938, "creation_date": 1553096697, "answer_id": 55264828, "question_id": 55253518, "link": "https://stackoverflow.com/questions/55253518/c-macro-for-defining-test-methods-with-callbacks/55264828#55264828", "title": "C Macro for defining test methods with callbacks", "body": "<p>Looks like you're building some sort of mini test framework using the c preprocessor.</p>\n\n<p>There's a caveat for the bodies; to the C preprocessor, curly brackets and square brackets are just tokens.  Parenthesized expressions are recognized (i.e., parentheses are matched), and commas are recognized as delimiters.  So for example, this macro invocation:</p>\n\n<pre><code>test(dosomething, { int a = add(1, 1); assert(a == 2); })\n</code></pre>\n\n<p>...has two arguments despite having two commas (because the second comma is \"hugged\" in a parenthesized set), but that's a bit misleading.  This invocation:</p>\n\n<pre><code>test(dosomething, { enum { red, green, blue }; assert(red+1==green); })\n</code></pre>\n\n<p>...has <em>four</em> arguments: 1: <code>dosomething</code>, 2: <code>{ enum { red</code>, 3: <code>green</code>, and 4: <code>blue }; assert(red+1==green); }</code>.  If you're going to do this, you probably want to cover cases like this... there are basic strategies: (a) hug the body in parentheses (you can unwrap it in expansion), or (b) use variadic macros.</p>\n\n<blockquote>They need to be iterated over.</blockquote>\n\n<p>Sounds like a job for <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">x-macros</a> (below I'll be using the parameterized-macro flavor of x-macros).</p>\n\n<blockquote>But more than that, I would like to pass a callback for async functions to say they are complete, like this:</blockquote>\n\n<p>...you can't add an argument in the middle, but the braces don't have to be part of this (they don't help anyway, since the preprocessor ignores them).  So for the above, we probably want to pick the hug option.  That leaves your invocations looking like this:</p>\n\n<pre><code>test(dosomething, (int a=add(1,1); assert(a==2);), done)\n</code></pre>\n\n<p>However, since we're ripping the curly braces out, we can put them in arbitrary places in our expansion and do arbitrary things in between.  Since I'm guessing you want the same kind of async thing going on, we could just put that thing in the expansion that generates the definition rather as an argument.</p>\n\n<p>Here's roughly what it would look like, using a parameterized macro version of x-macros, and applying an async on expansion (using semaphores to demonstrate how arbitrary this could be):</p>\n\n<pre><code>#define APPLY_TEST_MACROS(macro) \\\n    macro(test_add, (int a=add(1,1); assert(a==2);  )) \\\n    macro(test_sub, (int a=sub(5,2); assert(a==3);  )) \\\n    macro(test_mul, (int a=mul(3,4); assert(a==12); ))\n\n#define UNWRAP(...) __VA_ARGS__\n#define MAKE_ASYNC_SEM(NAME_, BODY_) \\\n   void NAME_() { \\\n      sem_wait(&amp;test_sem_ctl); print(#NAME_); sem_post(&amp;test_sem_ctl); \\\n      UNWRAP BODY_ \\\n      sem_wait(&amp;test_sem_ctl); \\\n      if (0==--tests_remaining) sem_post(&amp;test_sem_done); \\\n      sem_post(&amp;test_sem_ctl); \\\n   }\n#define COUNT_TESTS(NAME_, BODY_) +1\nsem_t test_sem_ctl;\nsem_t test_sem_done;\nvoid init_semaphores() {\n   sem_init(&amp;test_sem_ctl, 0, 1);\n   sem_init(&amp;test_sem_done, 0, 0);\n}\n// iterate over tests to count them\nunsigned int tests_remaining = APPLY_TEST_MACROS(COUNT_TESTS);\n// define the tests\nAPPLY_TEST_MACROS(MAKE_ASYNC_SEM)\n</code></pre>\n\n<p>...and so forth (I'm stopping here because the idea is to convey the idea, not code it for you).  The x-macro layout allows you to iterate in the preprocessor, so you can do something like spawn a thread per test; you could <em>also</em> just use this same approach to build an array of test functions if, say, you want to feed your tests to a thread pool.</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 55264828, "answer_count": 1, "score": 2, "last_activity_date": 1553098938, "creation_date": 1553055451, "last_edit_date": 1553062700, "question_id": 55253518, "link": "https://stackoverflow.com/questions/55253518/c-macro-for-defining-test-methods-with-callbacks", "title": "C Macro for defining test methods with callbacks", "body": "<p>So you can dynamically define a method with its own name like this:</p>\n\n<pre><code>#define test(name) void name() { print(\"#name\"); }\n</code></pre>\n\n<p>Then you can call it like:</p>\n\n<pre><code>test(foo);\nfoo();\n</code></pre>\n\n<p>I'm wondering though if you can make a \"callback\"-style form, like this:</p>\n\n<pre><code>#define test(name, body) void name() { print(#name); body(); }\n</code></pre>\n\n<p>Where it invokes a body that is defined as sort of a \"block\" like this:</p>\n\n<pre><code>test(dosomething, {\n  int a = add(1, 1);\n  assert(a == 2);\n})\n</code></pre>\n\n<p>But more than that, I would like to pass a callback for async functions to say they are complete, like this:</p>\n\n<pre><code>test(dosomething, { (done)\n  int a = add(1, 1);\n  assert(a == 2);\n  done();\n})\n</code></pre>\n\n<p>In addition, I am defining these outside of the <code>main</code>, so it would be defined in the same scope as a normal function. Because of that, the tests aren't going to automatically run. They need to be <em>iterated over</em>. As such, they probably need to be pushed into an array of some sort. So wondering how that could be done, if macros allow you to sort of capture stuff into an array, or to build up an enum one <code>#define</code> at a time.</p>\n\n<pre><code>#define test(name, body) void name() { \\\n  print(#name); \\\n} \\\n\\\nTESTS[CURRENT_TEST++] = &amp;name \\ // push the test into a TESTS array.\n</code></pre>\n\n<p>So then in <code>main</code> you can iterate over them:</p>\n\n<pre><code>int\nmain() {\n  iterate over TESTS...\n}\n</code></pre>\n\n<p>To summarize, I am wondering how to <code>#define</code> this at the file body level (i.e. not in main, but at the level of functions):</p>\n\n<pre><code>void afunction() { printf(\"Foo\"); }\n\ntest(dosomething, { (done)\n  int a = add(1, 1);\n  assert(a == 2);\n  done();\n})\n\nvoid anotherfunction() { printf(\"Bar\"); }\n</code></pre>\n\n<p>such that I can iterate over the tests in <code>main</code>.</p>\n\n<ul>\n<li><a href=\"https://www.quora.com/In-C-how-do-I-define-a-macro-receiving-a-block/answer/Petr-Skocik\" rel=\"nofollow noreferrer\">This</a> suggests blocks are possible in macros.</li>\n</ul>\n"}, {"tags": ["c", "struct", "embedded", "cortex-m"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553055814, "post_id": 55253482, "comment_id": 97239220, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 2, "creation_date": 1553057006, "post_id": 55253482, "comment_id": 97239482, "body": "If you are running above code on X86 processor then it&#39;s not possible to write to arbitrary memory address like <code>0xXXXXX</code>. Your code causes  <b>UB</b>"}, {"owner": {"reputation": 9, "user_id": 11224910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qOeOkg1B2e8/AAAAAAAAAAI/AAAAAAAAa9I/wve-aLUU8Z4/photo.jpg?sz=128", "display_name": "Vybhav Jayaraman", "link": "https://stackoverflow.com/users/11224910/vybhav-jayaraman"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1553057140, "post_id": 55253482, "comment_id": 97239508, "body": "@Achal I am running my code on ARM cortex M4 processor"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 2, "creation_date": 1553057329, "post_id": 55253482, "comment_id": 97239553, "body": "As here <a href=\"https://stackoverflow.com/questions/4532000/how-to-assign-pointer-address-manually-in-c-programming-language\">How to assign pointer address manually in C programming language?</a> @crowder quoted &quot;Arbitrary address  must be some kind of &quot;<b>well-known address</b>&quot; and those are typically (though by no means always) <b>read-only</b> ."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1553070313, "post_id": 55253482, "comment_id": 97244251, "body": "Where is this address, in RAM or flash or some other kind of memory? If in flash memory, then it&#39;s probable to that you need to use special methods to write into it, you cannot use simple assignment."}, {"owner": {"reputation": 9, "user_id": 11224910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qOeOkg1B2e8/AAAAAAAAAAI/AAAAAAAAa9I/wve-aLUU8Z4/photo.jpg?sz=128", "display_name": "Vybhav Jayaraman", "link": "https://stackoverflow.com/users/11224910/vybhav-jayaraman"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1553070604, "post_id": 55253482, "comment_id": 97244385, "body": "@user694733 its in flash memory"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1553071508, "post_id": 55253482, "comment_id": 97244811, "body": "In that case you should check the user manual of your processor to see what kind of flash memory programming interfaces it offers."}, {"owner": {"reputation": 9, "user_id": 11224910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qOeOkg1B2e8/AAAAAAAAAAI/AAAAAAAAa9I/wve-aLUU8Z4/photo.jpg?sz=128", "display_name": "Vybhav Jayaraman", "link": "https://stackoverflow.com/users/11224910/vybhav-jayaraman"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1553075391, "post_id": 55253482, "comment_id": 97247027, "body": "@user694733 ,it provides 1MB of flash memory . I am using only 8KB of Flash memory dedicated for Application usage. What is the special method to write into flash ?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1553076545, "post_id": 55253482, "comment_id": 97247807, "body": "I don&#39;t know. It depends on your microcontroller model. Like I said, you need to check your user manual to see if it&#39;s possible, and how it&#39;s possible."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1553086741, "post_id": 55253482, "comment_id": 97254016, "body": "You might browse the web pages of the flash vendor or your board vendor to find application notes regarding flash programming. Maybe the vendor provides some library as well. It depends on vendor, model and your usage of the chips."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1553086361, "creation_date": 1553086361, "answer_id": 55261220, "question_id": 55253482, "link": "https://stackoverflow.com/questions/55253482/accessing-typedef-struct-elements/55261220#55261220", "title": "Accessing typedef struct elements", "body": "<p>You can't write to flash memory as if it was RAM and that's it. Flash being ROM. This would be why all your variables allocated in flash is/must be <code>const</code> qualified, meaning read-only.</p>\n\n<p>It is possible to change flash and your part could have dedicated data flash/eeprom for this purpose. But writing to such parts of the memory isn't something a compiler will do for you. You need to write a flash programming driver yourself. As in, you have to study the flash programming part in the manual + app notes.</p>\n"}], "owner": {"reputation": 9, "user_id": 11224910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qOeOkg1B2e8/AAAAAAAAAAI/AAAAAAAAa9I/wve-aLUU8Z4/photo.jpg?sz=128", "display_name": "Vybhav Jayaraman", "link": "https://stackoverflow.com/users/11224910/vybhav-jayaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553086486, "creation_date": 1553055081, "last_edit_date": 1553086486, "question_id": 55253482, "link": "https://stackoverflow.com/questions/55253482/accessing-typedef-struct-elements", "title": "Accessing typedef struct elements", "body": "<p>I have declared a tydef struct as shown below.</p>\n\n<pre><code>#define START_ADDR 0xXXXXX\ntypedef struct{\n     uint32_t checksum;\n     uint16_t index[len];\n} block;\n</code></pre>\n\n<p>I changed the memory allocation of block using the below statement:</p>\n\n<pre><code>block *value = (block*) START__ADDR;\n</code></pre>\n\n<p>I verified the change in memory allocation as well and no issue with it.\nNow i am trying to update the value of checksum using </p>\n\n<pre><code>value-&gt;checksum=0xa5a5a5a5;\n</code></pre>\n\n<p>But the value of checksum is <strong>0x00000000</strong> and not getting updated to <strong>0xa5a5a5a5</strong>.\nCan anyone please tell me how can i change the value of checksum.</p>\n\n<p>Thanks in advance.</p>\n\n<p>Regards \nVybhav </p>\n"}, {"tags": ["c", "algorithm", "compression", "lossless-compression"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1553053830, "post_id": 55253128, "comment_id": 97238819, "body": "I&#39;m not sure what sort of answer you&#39;re looking for here. Have you studied any lossless compression schemes? This might be a good place to start: <a href=\"https://en.wikipedia.org/wiki/Huffman_coding\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Huffman_coding</a> and <a href=\"https://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch</a>"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1553054028, "post_id": 55253128, "comment_id": 97238870, "body": "Not sure what you&#39;re asking, but yes any practical compression algorithm will need to write arbitrary numbers of bits to the output."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1553054270, "post_id": 55253128, "comment_id": 97238915, "body": "&quot;Do lossless compression algorithms work on the bit level?&quot; --&gt; some do, some do not.  As to what you should do, step 1: code via what every algorithm you best understand."}, {"owner": {"reputation": 18716, "user_id": 240457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ffaa31b18c7c5ac916d95f172b7ac?s=128&d=identicon&r=PG", "display_name": "mcdowella", "link": "https://stackoverflow.com/users/240457/mcdowella"}, "edited": false, "score": 0, "creation_date": 1553061260, "post_id": 55253128, "comment_id": 97240645, "body": "<a href=\"https://en.wikipedia.org/wiki/Arithmetic_coding\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Arithmetic_coding</a> is concerned more with probabilities than bits"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1553074582, "post_id": 55253128, "comment_id": 97246523, "body": "<i>Plain Input</i> usually is interpreted using <i>smallest addressable units</i> - bytes, mostly. <i>Compressed/encoded IO</i> used to be done with variable bit length codes, and has gone <a href=\"https://en.m.wikipedia.org/wiki/Arithmetic_coding\" rel=\"nofollow noreferrer\">beyond</a>."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1553106098, "post_id": 55253128, "comment_id": 97266555, "body": "(Try creating a compressor producing output shorter than <a href=\"https://en.m.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch#Variable-width_codes\" rel=\"nofollow noreferrer\">&quot;the BSD compress(1)&quot;</a> implementation of LZW, but decompressible by any compatible implementation.)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10443186"}, "edited": false, "score": 0, "creation_date": 1553094722, "post_id": 55256334, "comment_id": 97259620, "body": "Nice! I though so."}, {"owner": {"reputation": 7311, "user_id": 1462282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5wvoe.jpg?s=128&g=1", "display_name": "Sahil Chhabra", "link": "https://stackoverflow.com/users/1462282/sahil-chhabra"}, "edited": false, "score": 0, "creation_date": 1582790720, "post_id": 55256334, "comment_id": 106900431, "body": "Can you please elaborate what do you mean by &#39;this is best done at bit level where your strings attached the individual bits...&#39;? Thanks"}, {"owner": {"reputation": 111, "user_id": 11195933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HgVyt7fkL2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWYMxHILyGnpyD8_xGvV_ODL28CA/mo/photo.jpg?sz=128", "display_name": "M&#225;rio Uhr&#237;k", "link": "https://stackoverflow.com/users/11195933/m%c3%a1rio-uhr%c3%adk"}, "reply_to_user": {"reputation": 7311, "user_id": 1462282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5wvoe.jpg?s=128&g=1", "display_name": "Sahil Chhabra", "link": "https://stackoverflow.com/users/1462282/sahil-chhabra"}, "edited": false, "score": 1, "creation_date": 1582883160, "post_id": 55256334, "comment_id": 106937806, "body": "@SahilChhabra added an example for bit-level file compression"}], "tags": [], "owner": {"reputation": 111, "user_id": 11195933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HgVyt7fkL2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfWYMxHILyGnpyD8_xGvV_ODL28CA/mo/photo.jpg?sz=128", "display_name": "M&#225;rio Uhr&#237;k", "link": "https://stackoverflow.com/users/11195933/m%c3%a1rio-uhr%c3%adk"}, "is_accepted": true, "score": 1, "last_activity_date": 1582883136, "last_edit_date": 1582883136, "creation_date": 1553070234, "answer_id": 55256334, "question_id": 55253128, "link": "https://stackoverflow.com/questions/55253128/do-lossless-compression-algorithms-work-on-the-bit-level/55256334#55256334", "title": "Do lossless compression algorithms work on the bit level?", "body": "<h2>The intuition behind simple file compression</h2>\n\n<p>Consider mapping <strong><em>M: K -> V</em></strong>.</p>\n\n<p>The requirements for such a mapping is that any input string <strong><em>k</em></strong> can be specifically mapped to some hopefully shorter string <strong><em>M(k) = v</em></strong>.</p>\n\n<h2>Example (with text)</h2>\n\n<p>Your input file is </p>\n\n<pre><code>aaaaaaaaaabbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccccaaaaaaaaaa\n</code></pre>\n\n<p>Compression algorithm should find some mapping <strong><em>M</em></strong> that would offer nice compression, without taking too long to do it. \nIn this case, intuitively, you could use:</p>\n\n<pre><code>M(aaaaaaaaaa) = a\nM(bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb) = b\nM(ccccc) = c\n</code></pre>\n\n<p>And the compressed file becomes</p>\n\n<pre><code>abca\n</code></pre>\n\n<p>You can decompress the file doing the same thing in reverse.</p>\n\n<p><em>(note that the mapping needs to be somehow stored alongside/inside the compressed file, so that you know how to decompress it later)</em></p>\n\n<h3>Now you can probably already guess that this is best done at bit level where your strings are individual bits.</h3>\n\n<h2>Example (with bits)</h2>\n\n<p>Your input file is </p>\n\n<pre><code>11111111101010101010101010101010101010000000000000\n</code></pre>\n\n<p>Compression algorithm should find some mapping <strong><em>M</em></strong> that would offer nice compression, without taking too long to do it. \nIn this case, intuitively, you could use:</p>\n\n<pre><code>M(111111111) = 11\nM(0101010101010101010101010101) = 01\nM(0000000000000) = 00\n</code></pre>\n\n<p>And the compressed file becomes</p>\n\n<pre><code>110100\n</code></pre>\n\n<p>A strong advantage of doing it at the bit level is that it can be used for any file type.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10443186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 55256334, "answer_count": 1, "score": 1, "last_activity_date": 1582883136, "creation_date": 1553052465, "last_edit_date": 1553054967, "question_id": 55253128, "link": "https://stackoverflow.com/questions/55253128/do-lossless-compression-algorithms-work-on-the-bit-level", "title": "Do lossless compression algorithms work on the bit level?", "body": "<p>Let's for example say that I have a file, and I want to create a compression algorithm in C, should my algorithm get the bit representation of that file, work on it and write a new file that only my algorithm would know how to uncompress?</p>\n"}, {"tags": ["c", "language-lawyer", "type-punning"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553052551, "post_id": 55252865, "comment_id": 97238508, "body": "Alignment is not the potential UB here, by anti-aliasing is a concern perhaps with <code>struct contains_64_t *c64_ptr = (struct contains_64_t*) buf_2_64t;</code>.  <code>printf(&quot;Value = %lu\\n&quot;, c64_ptr -&gt; value);</code> is certainly UB with 32-bit <code>long</code>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553052739, "post_id": 55252865, "comment_id": 97238555, "body": "@chux Why is casting to a suitably aligned pointer UB? Or you mean UB is caused by incorrect use of <code>printf</code>? Fixed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553052992, "post_id": 55252865, "comment_id": 97238607, "body": "Some 1)  <i>casting</i> is not the UB concern, <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">anti-aliasing</a> UB may apply here.  2) <code>%lu</code> is for <code>unsigned long</code>, not necessarily <code>uint64_t</code>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553053060, "post_id": 55252865, "comment_id": 97238621, "body": "@chux Agree with <code>2)</code>. Replaced it with <code>PRIu64</code> defined in <code>inttypes.h</code>."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553053605, "post_id": 55252865, "comment_id": 97238754, "body": "@chux Anyway if we do not align the pointer to stack-allocated buffer we cannot convert it. So UB will also come at <code>struct contains_64_t *c64_ptr = (struct contains_64_t*) buf_2_64t;</code> otherwise the Standard permits such convertation at <code>6.2.3.2(p7)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "is_accepted": false, "score": 2, "last_activity_date": 1553063317, "creation_date": 1553063317, "answer_id": 55254730, "question_id": 55252865, "link": "https://stackoverflow.com/questions/55252865/reinterpreting-suitably-aligned-pointers-to-object-with-declared-type/55254730#55254730", "title": "Reinterpreting suitably aligned pointers to object with declared type", "body": "<p><code>memcpy()</code>'s look OK.</p>\n\n<p><code>c64_ptr -&gt; value</code> is UB.</p>\n\n<blockquote>\n  <p>An object shall have its stored value accessed only by an lvalue\n  expression that has one of the following types:</p>\n  \n  <p>\u2014 a type compatible with the effective type of the object,</p>\n  \n  <p>\u2014 a qualified version of a type compatible with the effective type of\n  the object,</p>\n  \n  <p>\u2014 a type that is the signed or unsigned type corresponding to the\n  effective type of the object,</p>\n  \n  <p>\u2014 a type that is the signed or unsigned type corresponding to a\n  qualified version of the effective type of the object,</p>\n  \n  <p>\u2014 an aggregate or union type that includes one of the aforementioned\n  types among its members (including, recursively, a member of a\n  subaggregate or contained union), or</p>\n  \n  <p>\u2014 a character type.</p>\n</blockquote>\n\n<p>Look up <code>compatible</code> in the standard to complete the picture.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553063317, "creation_date": 1553050329, "last_edit_date": 1553056700, "question_id": 55252865, "link": "https://stackoverflow.com/questions/55252865/reinterpreting-suitably-aligned-pointers-to-object-with-declared-type", "title": "Reinterpreting suitably aligned pointers to object with declared type", "body": "<p>The Standard allows us to cast pointers to object type to each other if they are suitably aligned. <code>6.3.2.3(p7)</code>:</p>\n\n<blockquote>\n  <p>A pointer to an object type may be converted to a pointer to a\n  different object type. If the resulting pointer is not correctly\n  aligned68) for the referenced type, the behavior is undefined.</p>\n</blockquote>\n\n<p>The Standard allows us to copy object representation into <code>char[sizeof(the_object_type)]</code> <code>6.2.6.1(p4)</code>:</p>\n\n<blockquote>\n  <p>The value may be copied into an object of type unsigned char [n]\n  (e.g., by memcpy); the resulting set of bytes is called the object\n  representation of the value.</p>\n</blockquote>\n\n<p>Also, The Standard explicitly states that</p>\n\n<blockquote>\n  <p>Two values (other than NaNs) with the same object representation\n  compare equal, but values that compare equal may have different object\n  representations.</p>\n</blockquote>\n\n<p>Consider the following code:</p>\n\n<pre><code>struct contains_64_t{\n    uint64_t value;\n};\n\nint main(int args, const char *argv[]){\n    _Alignas(struct contains_64_t) \n        char buf_2_64t[2 * sizeof(struct contains_64_t)];\n    struct contains_64_t c64_1;\n    c64_1.value = 1;\n    struct contains_64_t c64_2;\n    c64_2.value = 2;\n    memcpy(buf_2_64t, &amp;c64_1, sizeof(c64_1));\n    memcpy(buf_2_64t + sizeof(c64_1), &amp;c64_2, sizeof(c64_2));\n\n    //suitably aligned, ok\n    struct contains_64_t *c64_ptr = (struct contains_64_t*) buf_2_64t; \n    printf(\"Value %\"PRIu64\"\\n\", c64_ptr -&gt; value);\n}\n</code></pre>\n\n<p><strong><em>QUESTION:</em></strong> Is it pedantic to write code like this? If no, what kind of problem we may run into if doing so?</p>\n\n<p>From what I see,</p>\n\n<p>we can cast <code>char*</code> to <code>struct contains_64_t</code> since it is suitably aligned. But the problem is that the declared type of <code>buf</code> is <code>char[2 * sizeof(struct contains_64_t)]</code>. So formally speaking we cannot access the <code>buf</code> through an lvalue of type <code>struct contains_64_t *</code>.</p>\n\n<p>But that would be strange since we have suitably aligned pointer and literally identical object representation. Surely we could declare <code>struct contains_64_t buf[2];</code>, but the solution would not work in case of <code>struct</code> containing <strong><em>variably length array</em></strong></p>\n\n<p>UPD: Would doing such buffer alignment be enough if we assume we are compiling with GCC?</p>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1553050833, "post_id": 55252794, "comment_id": 97238154, "body": "Your compiler isn&#39;t warning you about that? Always compile with <code>-Wall -Wextra</code> with GCC or clang, or whatever is done to turn on warnings with other compilers. And read up on <code>scanf()</code> formats."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 3, "creation_date": 1553050936, "post_id": 55252794, "comment_id": 97238179, "body": "And <code>fflush()</code> is undefined on input streams like <code>stdin</code>. See <a href=\"http://c-faq.com/stdio/stdinflush.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/stdinflush.html</a> and <a href=\"http://c-faq.com/stdio/stdinflush2.html\" rel=\"nofollow noreferrer\">c-faq.com/stdio/stdinflush2.html</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1553051909, "post_id": 55252794, "comment_id": 97238382, "body": "Afif Windy, Who or what text suggest the <code>s</code> in <code>&quot;%[A-Z a-z]s&quot;</code>?"}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "edited": false, "score": 0, "creation_date": 1553052097, "post_id": 55252794, "comment_id": 97238426, "body": "No, there&#39;s no warning whatsoever. The compiler doesn&#39;t detect any error in the code, it just doesn&#39;t want to work the way I need it to be.  My compiler is Dev-C++. I found out about fflush() somewhere online and it was written as fflush_stdin(). I tried using that in my codes, but it doesn&#39;t work. It somehow works when I write it as fflush(stdin). But, I can&#39;t say for sure why or how since I haven&#39;t actually fully grasp its concept yet.  Thank you, I will read your recommendations."}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553052277, "post_id": 55252794, "comment_id": 97238463, "body": "@chux I just thought so, as I need to input a &quot;name&quot; string in the struct. Is there a problem? It works just fine."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1553052713, "post_id": 55252794, "comment_id": 97238543, "body": "Replace <code>&quot;%[A-Z a-z]s&quot;</code> with <code>&quot;%9[A-Z a-z]&quot;</code> and review <code>[</code>  <a href=\"http://man7.org/linux/man-pages/man3/scanf.3.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1553052980, "post_id": 55252794, "comment_id": 97238603, "body": "The digit <code>1</code> is ASCII and ISO 8859-x code point 49; the digit <code>2</code> is code point 50; etc.  They&#39;re also the code points in Unicode, too (<code>1</code> maps to U+0031 or 49; <code>2</code> maps to U+0032 or 50).  However, the format strings are a mess; it is hard to explain why they&#39;re all wrong."}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553053157, "post_id": 55252794, "comment_id": 97238648, "body": "@chux it works just as fine. Can you explain? I also tried doing the same for %[0-9]d in the first scanf() turning it to scanf(%[0-9], &amp;input_max). It also works fine, but it didn&#39;t solve my problem where it turns the input of 1 to 49."}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553053421, "post_id": 55252794, "comment_id": 97238712, "body": "@JonathanLeffler Ah, I guess I have suspected that was the case. Also, interestingly, when I remove the scanset and just write it as scanf(%d, &amp;input_max), only then it takes 1 as a 1, and 2 as a 2, and so on. Maybe I&#39;ll add this as a note in an edit."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 4, "creation_date": 1553060569, "post_id": 55252794, "comment_id": 97240431, "body": "the scanf input format specifier <code>%[...]</code> ALWAYS inputs a string into memory.  The trailing <code>s</code> or <code>d</code> that the posted code is using, means the next char in <code>stdin</code> will be a <code>s</code> or a <code>d</code>  It has nothing to do with the actual variable.  So that <code>s</code> or <code>d</code> is an error.  Suggest removing that extraneous character"}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553070734, "post_id": 55252794, "comment_id": 97244434, "body": "@user3629249 Now, I understand the problem. Because of the scanset, my scanf doesn&#39;t read my input as integers, but as strings. So, is there no alternative to put out an error with whitespace for integers, then?"}, {"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 1, "creation_date": 1553072238, "post_id": 55252794, "comment_id": 97245183, "body": "Use <code>fgets</code> and check white spaces there except trailing <code>\\n</code>. If there is no any space use <code>sscanf</code> with the format <code>%i</code> for integrals."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "edited": false, "score": 0, "creation_date": 1553075008, "post_id": 55256862, "comment_id": 97246793, "body": "For a baby such as myself, your answer is still a lot to take in, but I&#39;m truly grateful. I understand only some of the points you mentioned. I&#39;ll try my best to wrap my head around the rest."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "edited": false, "score": 1, "creation_date": 1553077213, "post_id": 55256862, "comment_id": 97248183, "body": "I&#39;ll try to explain a bit more."}, {"owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "edited": false, "score": 1, "creation_date": 1553133782, "post_id": 55256862, "comment_id": 97276522, "body": "That was such a thorough explanation! Thank you so very much! I&#39;ll try my best to study it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1553157443, "post_id": 55256862, "comment_id": 97283054, "body": "Please do not advocate the use of <code>strncpy</code> to beginners. <code>strncpy</code> is a source of bugs and misunderstandings. Write an alternative function that ensures the destination is null terminated."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 2, "creation_date": 1553157529, "post_id": 55256862, "comment_id": 97283088, "body": "<code>match_telephone</code> has a bug: <code>sscanf(line, &quot;%128[0-9 ]&quot;, tmp)</code> should be <code>sscanf(line, &quot;%127[0-9 ]&quot;, tmp)</code>, same problem in <code>match_name</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1553157805, "post_id": 55256862, "comment_id": 97283225, "body": "Also you should have proper checks for end of file. As coded, you have undefined behavior n premature end of file with probable endless loops."}], "tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": true, "score": 4, "last_activity_date": 1553081710, "last_edit_date": 1553081710, "creation_date": 1553072246, "answer_id": 55256862, "question_id": 55252794, "link": "https://stackoverflow.com/questions/55252794/scanf-nd-x-or-scanf0-9d-x-turns-1-into-49-and-2-into-50/55256862#55256862", "title": "scanf(&quot;%[^\\n]d&quot;, x) or scanf(&quot;%[0-9]d&quot;, x) turns 1 into 49 and 2 into 50", "body": "<p>You are mistaking <code>[</code> to be a modifier for <code>%s</code> and <code>%d</code>\u2014e.g. <code>%3d</code>\u2014 it is not. <code>%[</code> itself is a conversion specifier and works like <code>%s</code>.</p>\n\n<p>So, as pointed out in the comment by @user3629249, <code>s</code> and <code>d</code> at the end of the <code>%[</code> specifier (e.g. in <code>%[^\\n A-Z a-z]s</code>) are extraneous. Also the <em>spaces</em> in <code>%[</code>  matter.  So <code>%[A-z\u00a0a-z]</code> is different from <code>%[A-Za-z]</code></p>\n\n<p>Let's look at the problems that you get when you compile with format warnings turned on. (-Wformat if you are using gcc or clang) and you will get something like:</p>\n\n<pre><code>foo.c:19:68: warning: format specifies type 'char *' but the argument has type 'int *' [-Wformat]\n  while (printf(\"Input the amount of data! \") &amp;&amp; scanf(\"%[0-9]*d\", &amp;input_max)&lt;1) {\n                                                        ~~~~~      ^~~~~~~~~~\n                                                        %d\nfoo.c:29:55: warning: format specifies type 'char *' but the argument has type 'char (*)[21]' [-Wformat]\n    while (printf(\"Name\\t: \") &amp;&amp; scanf(\"%[A-Z a-z]s\", &amp;bio[index_struct].name)&lt;1) {\n                                        ~~~~~~~~~     ^~~~~~~~~~~~~~~~~~~~~~~\nfoo.c:34:54: warning: format specifies type 'char *' but the argument has type 'char (*)[65]' [-Wformat]\n    while (printf(\"Address\\t: \") &amp;&amp; scanf(\"%[^\\n]s\", &amp;bio[index_struct].address)&lt;1) {\n                                           ~~~~      ^~~~~~~~~~~~~~~~~~~~~~~~~~\nfoo.c:39:78: warning: format specifies type 'char *' but the argument has type 'char (*)[11]' [-Wformat]\n    while (printf(\"Birthdate\\t: (YYYY/MM/DD)\\n\") &amp;&amp; scanf(\"%[^\\n A-Z a-z]s\", &amp;bio[index_struct].date)&lt;1) {\n                                                           ~~~~~~~~~~~~~     ^~~~~~~~~~~~~~~~~~~~~~~\nfoo.c:44:67: warning: format specifies type 'char *' but the argument has type 'char (*)[17]' [-Wformat]\n    while (printf(\"Phone Number\\t: \") &amp;&amp; scanf(\"%[^\\n A-Z a-z]s\", &amp;bio[index_struct].phone)&lt;1) {\n                                                ~~~~~~~~~~~~~     ^~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>There are other problems with your code:</p>\n\n<ol>\n<li>you indexing your Biodata from 1 to 10 (look at <code>index_struct</code> for loop) however it's declared as an array of size 10 <code>Biodata bio[10];</code> </li>\n</ol>\n\n<p>In C arrays are <code>0</code> based, so they go from <code>0</code> to <code>size-1</code> and your <em>for-loop</em> would run into a segmentation fault because <code>bio[10]</code> will be undefined. </p>\n\n<ol start=\"2\">\n<li><p>you are asking for <code>input_max</code> <em>inside</em> your for-loop but you need it for the for-loop.  </p></li>\n<li><p>What happens if input_max is bigger than the declared size of <code>bio</code> array?</p></li>\n</ol>\n\n<p>Some other good things to consider:</p>\n\n<ol start=\"4\">\n<li><p>printf is a bad function to use for reporting errors, errors should go to stderr, not stdout so it's better to use fprintf and specify stderr.</p></li>\n<li><p>since you are interested in ensuring that inputs are parsed correctly why not create your own parser rather than using scanf? </p></li>\n<li><p>you are forcing a re-prompt on error, let's break that up into its own function.</p></li>\n</ol>\n\n<h1>Let's do it together.</h1>\n\n<h3>Note on the style of C and naming conventions I use below</h3>\n\n<p>My C style is a bit different than yours and I have my reasons :-), and since it's just opinion, let's go with mine.</p>\n\n<h2>The struct with some comments on what we want in it</h2>\n\n<pre><code>struct biodata {\n    char name[21];        /* format: FirstName LastName */\n    char address[65];     /* format: Free-form upto 65 chars */\n    char birthday[11];    /* format: YYYY/MM/DD */\n    char phone[17];       /* format: up to digits or a spaces */\n};\n</code></pre>\n\n<h2>Some matchers</h2>\n\n<p>Below is a set of match functions, that receives an input line and tells us if the line fully matches what we expect. If it does it returns true otherwise it returns false.  You will need to <code>#include &lt;stdbool.h&gt;</code> for this.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;time.h&gt;\n\nstruct biodata {\n        char name[21];        /* format: FirstName LastName */\n        char address[65];     /* format: Free-form upto 65 chars */\n        char birthday[11];    /* format: YYYY/MM/DD */\n        char phone[17];       /* format: up to digits or a spaces */\n};\n\n\nbool match_name(const char *line)\n{\n    char tmp[128];\n        return line!=NULL\n        &amp;&amp; sscanf(line, \"%128[A-Za-z]%128[ ]%128[A-Za-z]\", tmp, tmp, tmp) == 3\n        &amp;&amp; strlen(tmp) &lt; 21;\n}\n\nbool match_address(const char *line)\n{\n    return line != NULL\n        &amp;&amp; strlen(line) &gt; 5\n        &amp;&amp; strlen(line) &lt; 65; /* no format check here, maybe later */\n}\n\nbool match_telephone(const char *line) \n{\n    char tmp[128];\n    return line  /* notice the alternate form of checking line!=NULL */\n        &amp;&amp; sscanf(line, \"%128[0-9 ]\", tmp)==1\n        &amp;&amp; strlen(tmp) &lt; 17;\n}\n\n/* here we'll use strptime to see if our line is a valid date */\nbool match_birthday(const char *line) \n{\n     struct tm tm; /* time structure */\n     if(!line)\n          return false;\n\n     return strptime(line, \"%Y/%m/%d\", &amp;tm) != NULL;\n}\n\nchar * ask(const char *prompt, char *line, size_t maxlen) \n{\n    printf(\"%-30s:\", prompt);\n    fflush(stdout);\n    fgets(line, maxlen, stdin);\n    return line; /* we return the pointer for ease of use */\n}\n\n/* a test function */\nvoid test_matchers() {\n\n    char line[256];\n    /* remember ask returns our line so we are able to pass it to our matchers */\n    while(!match_name(ask(\"Name (first last)\", line, sizeof(line))))\n        ;\n    while(!match_address(ask(\"Address (at least 5 chars)\", line, sizeof(line))))\n        ;\n    while(!match_birthday(ask(\"Birthday (YYYY/MM/DD)\", line, sizeof(line))))\n        ;\n    while(!match_telephone(ask(\"Telephone (max 16 digits)\", line, sizeof(line))))\n        ;\n}\n\n\nint main() \n{\n     test_matchers();\n     return 0;\n}\n</code></pre>\n\n<p>Test it out.  </p>\n\n<pre><code>$ ./bar\n\nName (first last)             :Ahmed Masud\nAddress (at least 5 chars)    :1999 Somewhere Out there, Bingo, Bongo, 10002, USA\nBirthday (YYYY/MM/DD)         :1970/01/10\nTelephone (max 16 digits)     :1-201-555-1212\n</code></pre>\n\n<p>Now let's copy things to our structure in a reasonable way</p>\n\n<h1>Function to print biodata</h1>\n\n<pre><code>/* add a function to print a biodata */\n\nvoid print_bio(const struct biodata *bio)\n{\n    printf(\"***** bio data *****\\n\"\n       \"Name: %-10s\\nAddress: %-64s\\nBirthday: %-10s\\nPhone: %-16s\\n\",\n           bio-&gt;name, bio-&gt;address,\n           bio-&gt;birthday, bio-&gt;phone);\n}\n</code></pre>\n\n<h1>new main function</h1>\n\n<p>notice most of it is like <code>test_matches</code>. Except we have added the copying of\nline to appropriate field</p>\n\n<pre><code>int main()\n{\n\n    char line[256];\n    struct biodata bio;\n\n    while(!match_name(ask(\"Name (first last)\", line, sizeof(line))))\n        ;\n    strncpy(bio.name, line, sizeof(bio.name));\n\n    while(!match_address(ask(\"Address (at least 5 chars)\", line, sizeof(line))))\n        ;\n    strncpy(bio.address, line, sizeof(bio.address));\n\n    while(!match_birthday(ask(\"Birthday (YYYY/MM/DD)\", line, sizeof(line))))\n        ;\n    strncpy(bio.birthday, line, sizeof(bio.birthday));\n\n    while(!match_telephone(ask(\"Telephone (max 16 digits)\", line, sizeof(line))))\n        ;\n    strncpy(bio.phone, line, sizeof(bio.phone));\n\n    print_bio(&amp;bio);\n    return 0;\n}\n</code></pre>\n\n<p>Okay so we can prompt the user and get things into our structure but it's clunky to do it in main, so let's make it into its own function. </p>\n\n<pre><code>int get_bio(struct biodata *bio)\n{\n\n    char line[256];\n\n    while(!match_name(ask(\"Name (first last)\", line, sizeof(line))))\n        ;\n    strncpy(bio-&gt;name, line, sizeof(bio-&gt;name));\n\n    while(!match_address(ask(\"Address (at least 5 chars)\", line, sizeof(line))))\n        ;\n    strncpy(bio-&gt;address, line, sizeof(bio-&gt;address));\n\n    while(!match_birthday(ask(\"Birthday (YYYY/MM/DD)\", line, sizeof(line))))\n        ;\n    strncpy(bio-&gt;birthday, line, sizeof(bio-&gt;birthday));\n\n    while(!match_telephone(ask(\"Telephone (max 16 digits)\", line, sizeof(line))))\n        ;\n    strncpy(bio-&gt;phone, line, sizeof(bio-&gt;phone));\n\n    return 0;\n}\n\n\nint main()\n{\n    struct biodata bio[3]; /* let's get 3 records */\n        int i;\n\n        /* bio is made up of a bunch of struct biodata's so we divide its size by sizeof the struct biodata to get how many (in our case 3) */\n\n        for(i = 0; i &lt; sizeof(bio)/sizeof(struct biodata); i++)\n        {\n            printf(\"\\n\\nEnter record number: %d\\n\", 1+i); /* why 1+i here ? :) */\n            get_bio(&amp;bio[i]);\n        }\n\n        for(i=0; i &lt; sizeof(bio)/sizeof(struct biodata); i++)\n        {\n                print_bio(&amp;bio[i]);\n\n        }\n    return 0;\n}\n</code></pre>\n\n<h1>Exercise</h1>\n\n<p>I will leave the rest of the functionality as an exercise.</p>\n\n<p>Meanwhile, I would like you to consider the way we developed this.  Starting from the inner-most functionality and moving slowly outwards.</p>\n\n<p>Break down the problem like bits of lego and work on the inner parts first, test that they do exactly what you want them to do, then slowly build around them.  </p>\n\n<p>Obviously, the matchers should have been developed individually and tested before developing ask. I leave it to you to break that down.</p>\n"}], "owner": {"reputation": 43, "user_id": 11218896, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PSr62BXdr14/AAAAAAAAAAI/AAAAAAAAURQ/6Kv080XQa_E/photo.jpg?sz=128", "display_name": "35arata", "link": "https://stackoverflow.com/users/11218896/35arata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 55256862, "answer_count": 1, "score": 4, "last_activity_date": 1553081710, "creation_date": 1553049735, "last_edit_date": 1553074244, "question_id": 55252794, "link": "https://stackoverflow.com/questions/55252794/scanf-nd-x-or-scanf0-9d-x-turns-1-into-49-and-2-into-50", "title": "scanf(&quot;%[^\\n]d&quot;, x) or scanf(&quot;%[0-9]d&quot;, x) turns 1 into 49 and 2 into 50", "body": "<h3>Problem:</h3>\n\n<p>I am having problems with <code>scanf()</code>. I know from reading forums and the like that <code>scanf()</code> is pretty problematic in C, but I'm just still learning the basics, so I don't know all the details. </p>\n\n<h3>The code snippet that I'd like to solve.</h3>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n\nstruct Biodata {\n    char name[21],\n    address[65],\n    date[11],\n    phone[17];\n};\n\nint main() {\n    struct Biodata bio[10];\n    int input_max = 0,\n    index_struct = 0;\n    while (printf(\"Input the amount of data! \") &amp;&amp; scanf(\"%[0-9]*d\", &amp;input_max) &lt; 1) {\n        printf(\"Error! Please, try again!\\n\\n\");\n       fflush(stdin);\n    }\n    for (index_struct = 1; index_struct &lt;= input_max; index_struct++) {\n        printf(\"Your input data count is %d.\\n\", input_max);\n        printf(\"Data %d.\\n\", index_struct);\n        fflush(stdin);\n        while (printf(\"Name\\t: \") &amp;&amp; scanf(\"%[A-Z a-z]s\", &amp;bio[index_struct].name) &lt; 1) {\n            printf(\"Error! Please, try again!\\n\\n\");\n            fflush(stdin);\n        }\n        fflush(stdin);\n        while (printf(\"Address\\t: \") &amp;&amp; scanf(\"%[^\\n]s\", &amp;bio[index_struct].address) &lt; 1) {\n            printf(\"Error! Please, try again!\\n\\n\");\n            fflush(stdin);\n        }\n        fflush(stdin);\n        while (printf(\"Birthdate\\t: (YYYY/MM/DD)\\n\") &amp;&amp; scanf(\"%[^\\n A-Z a-z]s\", &amp;bio[index_struct].date) &lt; 1) {\n            printf(\"Error! Please, try again!\\n\\n\");\n            fflush(stdin);\n        }\n        fflush(stdin);\n        while (printf(\"Phone Number\\t: \") &amp;&amp; scanf(\"%[^\\n A-Z a-z]s\", &amp;bio[index_struct].phone) &lt; 1) {\n            printf(\"Error! Please, try again!\\n\\n\");\n            fflush(stdin);\n        }\n        fflush(stdin);\n        printf(\"\\n\");\n    }\n    printf(\"Input the index number you'd like the data to be pulled from! \");\n    scanf(\"%d\", &amp;index_struct);\n    printf(\"%-10s\\n%-64s\\n%-10s\\n%-16s\",\n           bio[index_struct].name, bio[index_struct].address,\n           bio[index_struct].date, bio[index_struct].phone);\n    return 0;\n}\n</code></pre>\n\n<p>I'm trying to make every input to be able to output an error, when the input is a whitespace. The scansets of <code>[^\\n]</code> or <code>[A-Z]</code> or <code>[0-9]</code> usually helps me in the simpler cases. But, in this one, when I input any number as an input in <code>input_max</code> for  </p>\n\n<pre><code>while (printf(\"Input the amount of data! \") &amp;&amp; scanf(\"%[0-9]*d\", &amp;input_max) &lt; 1) {\n    printf(\"Error! Please, try again!\\n\\n\");\n    fflush(stdin);\n} \n</code></pre>\n\n<p>The <code>input_max</code> gives out different numbers than the ones it was given. What is happening here? What can I do to get around it?</p>\n\n<p>I also don't exactly understand how that snippet of code works as error output as I found that somewhere online.</p>\n\n<p><strong>EDIT:</strong> as @JonathanLeffler have suggested, the <code>scanf()</code> takes my input as code points in either ASCII, ISO 8859-x, or Unicode, or in all of them. But, the input stays as they are when I remove the scanset, turning it into <code>scanf(%d, &amp;input_max)</code>. But, I do need the scanset so I can input a whitespace and have the error message I set up to pop up when I input a whitespace in the <code>scanf()</code>.</p>\n"}, {"tags": ["c", "libc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1553051997, "post_id": 55252458, "comment_id": 97238404, "body": "Note: <code>gets()</code> is not in the standard library of C11/C17."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553052403, "post_id": 55252458, "comment_id": 97238478, "body": "@chux Linker warns with <code>warning: the </code>gets&#39; function is dangerous and should not be used` when using it. I use C11."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1553052848, "post_id": 55252458, "comment_id": 97238580, "body": "Alex, be sure to try <code>gcc -std=c11 -Wall -Wextra -Wconversion file1.c</code>"}, {"owner": {"reputation": 71, "user_id": 11229567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/153b25fdb9fcd23a0df6f48b1ed1ad0c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11229567/alex"}, "edited": false, "score": 0, "creation_date": 1553053039, "post_id": 55252458, "comment_id": 97238618, "body": "the warning is a different matter and has to do with overflow protection"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553060821, "post_id": 55252458, "comment_id": 97240507, "body": "the warning about <code>gets()</code> is NOT about overflow protection but rather about the function <code>gets()</code> has been depreciated for years and completely removed in the last two versions of the C programing language"}], "answers": [{"comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1553061019, "post_id": 55252894, "comment_id": 97240572, "body": "Overriding standard library functions is undefined behaviour, although it often (but not always) &quot;works as expected&quot;. See <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">section 7.1.3 (Reserved Identifiers)</a> of the C standard, particularly paragraph 2."}], "tags": [], "owner": {"reputation": 164, "user_id": 3293508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61178dde90b08af3b22073884f54db84?s=128&d=identicon&r=PG", "display_name": "Nguyen Cong", "link": "https://stackoverflow.com/users/3293508/nguyen-cong"}, "is_accepted": false, "score": 1, "last_activity_date": 1553050641, "creation_date": 1553050641, "answer_id": 55252894, "question_id": 55252458, "link": "https://stackoverflow.com/questions/55252458/redefining-functions-lin-libc/55252894#55252894", "title": "Redefining functions lin libC", "body": "<p>Because you can override functions from standard libraries in C, check <a href=\"https://hackerboss.com/overriding-system-functions-for-fun-and-profit/\" rel=\"nofollow noreferrer\">this</a></p>\n"}, {"tags": [], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1553054026, "last_edit_date": 1553054026, "creation_date": 1553050802, "answer_id": 55252919, "question_id": 55252458, "link": "https://stackoverflow.com/questions/55252458/redefining-functions-lin-libc/55252919#55252919", "title": "Redefining functions lin libC", "body": "<p>You ran into undefined behavior see <code>N1570 6.9(p5) External definition</code>:</p>\n\n<blockquote>\n  <p>If an identifier declared with external linkage is used in an\n  expression (other than as part of the operand of a <code>sizeof</code> or <code>_Alignof</code>\n  operator whose result is an integer constant), somewhere in the entire\n  program there shall be exactly one external definition for the\n  identifier; otherwise, there shall be no more than one.161)</p>\n</blockquote>\n\n<p>As can be seen. The Standard allows 2 possibilities: </p>\n\n<ol>\n<li>exactly one definition </li>\n<li>no more than one definition.</li>\n</ol>\n\n<p>This <strong><em>might</em></strong> depend on the linkage of <code>libc</code> which itself is system dependent. In case you link <code>libc</code> statically the linker will complain. In case of dynamic linking it have no reasong of complaining. </p>\n\n<p>If you take a look at <code>objdump</code> you will find <code>plt</code> section like</p>\n\n<pre><code>898:   e8 b3 fe ff ff          callq  750 &lt;gets@plt&gt;\n</code></pre>\n\n<p>Anyway the behavior is undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": false, "score": 1, "last_activity_date": 1553064226, "creation_date": 1553064226, "answer_id": 55254909, "question_id": 55252458, "link": "https://stackoverflow.com/questions/55252458/redefining-functions-lin-libc/55254909#55254909", "title": "Redefining functions lin libC", "body": "<p>add option <strong>-whole-archive</strong> in the link phase, as below:</p>\n\n<pre><code>gcc -c -ofile1.o file1.c\ngcc -ofile1 -Wl,--whole-archive -lc file1.o -Wl,--no-whole-archive\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>file1.o: In function `gets':\nfile1.c:(.text+0x0): multiple definition of `gets'\nfile1.o: In function `main':\nfile1.c:(.text+0x18): undefined reference to `gets@@GLIBC_2.2.5'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11229567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/153b25fdb9fcd23a0df6f48b1ed1ad0c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/11229567/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1553064226, "creation_date": 1553046858, "question_id": 55252458, "link": "https://stackoverflow.com/questions/55252458/redefining-functions-lin-libc", "title": "Redefining functions lin libC", "body": "<p>Assume the following simple <code>C</code> code:</p>\n\n<p><code>file1.c</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar* gets(char* i){\n  return i;\n}\n</code></pre>\n\n<p>which is redefining the libC native function <code>gets</code>.</p>\n\n<p>This compiles fine with <code>gcc file1.c</code>.</p>\n\n<p>My question is howcome the linker isn't complaining about <code>duplicate symbols</code> as this function is also defined in libC itself? </p>\n"}, {"tags": ["c", "windows", "directory"], "comments": [{"owner": {"reputation": 5996, "user_id": 1152524, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b2e23f3f9bf82e6fe806261f50b2f9b6?s=128&d=identicon&r=PG&f=1", "display_name": "txtechhelp", "link": "https://stackoverflow.com/users/1152524/txtechhelp"}, "edited": false, "score": 0, "creation_date": 1553044700, "post_id": 55252199, "comment_id": 97236967, "body": "Take a look at <a href=\"https://stackoverflow.com/a/27645241/1152524\">this</a> answer; this gets you what you need in Qt at run time."}, {"owner": {"reputation": 5162, "user_id": 2785528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc85984f1234637fa4ec24d93ae51bc?s=128&d=identicon&r=PG&f=1", "display_name": "2785528", "link": "https://stackoverflow.com/users/2785528/2785528"}, "edited": false, "score": 0, "creation_date": 1553045909, "post_id": 55252199, "comment_id": 97237182, "body": "Your choice of words is interesting.  Though it may be true that &quot;the C program ... runs on the source directory [where it was created] &quot;, are you saying the executable can not be run from any other directory?   Have you tried to copy the exe (and perhaps some support files)  to &#39;some other directory&#39; and then not been able to run it there?  For instance, I have moved sol.exe (to another windows machine) with success."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1553047619, "post_id": 55252199, "comment_id": 97237543, "body": "Search term: &quot;Working directory&quot;. <a href=\"https://stackoverflow.com/questions/3485166/change-the-current-working-directory-in-c\">This question targets C++, but the results should be nigh-identical in C.</a>"}, {"owner": {"reputation": 5681, "user_id": 1150918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81acdd9b6273c7860ac440c99eb747c?s=128&d=identicon&r=PG", "display_name": "Kamiccolo", "link": "https://stackoverflow.com/users/1150918/kamiccolo"}, "edited": false, "score": 0, "creation_date": 1553079868, "post_id": 55252199, "comment_id": 97249755, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3485166/change-the-current-working-directory-in-c\">Change the current working directory in C++</a>"}, {"owner": {"reputation": 21, "user_id": 11229452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WxCry69uOsY/AAAAAAAAAAI/AAAAAAAAA2I/tp8tBuYIq6g/photo.jpg?sz=128", "display_name": "Jobin Jose", "link": "https://stackoverflow.com/users/11229452/jobin-jose"}, "edited": false, "score": 0, "creation_date": 1553134743, "post_id": 55252199, "comment_id": 97276714, "body": "You don&#39;t get what I meant here I know I can move my .exe file and run it anywhere I need. But what I need is to do something like select directory to run the code from the program itself, because it creates folders on that directory and manipulates files in that directory."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11229735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-D70CiX6CKuE/AAAAAAAAAAI/AAAAAAAAB8g/G_7tNpsPosY/photo.jpg?sz=128", "display_name": "Estail Se", "link": "https://stackoverflow.com/users/11229735/estail-se"}, "is_accepted": false, "score": -1, "last_activity_date": 1553054289, "creation_date": 1553054289, "answer_id": 55253390, "question_id": 55252199, "link": "https://stackoverflow.com/questions/55252199/select-directory-inside-the-c-program-to-run-it-there/55253390#55253390", "title": "Select directory inside the C program to run it there", "body": "<p>It is not possible. It depends upon your IDE and your compiler.\nThanks!</p>\n"}], "owner": {"reputation": 21, "user_id": 11229452, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WxCry69uOsY/AAAAAAAAAAI/AAAAAAAAA2I/tp8tBuYIq6g/photo.jpg?sz=128", "display_name": "Jobin Jose", "link": "https://stackoverflow.com/users/11229452/jobin-jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1553054289, "creation_date": 1553044405, "last_edit_date": 1553046727, "question_id": 55252199, "link": "https://stackoverflow.com/questions/55252199/select-directory-inside-the-c-program-to-run-it-there", "title": "Select directory inside the C program to run it there", "body": "<p>By default the C program after compilation runs on the source directory where all the other files are automatically created(.exe,.o,.c).</p>\n\n<p>How can I choose the directory where I want to run it from inside the program?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1553044247, "post_id": 55252150, "comment_id": 97236871, "body": "<code>printf(&quot;\\n&quot;,py);</code> Didn&#39;t you miss the <code>%d</code>?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553044383, "post_id": 55252150, "comment_id": 97236904, "body": "<code>getBits</code> is defined to return an <code>unsigned int</code>. What is this line supposed to do?? --&gt; <code>int py[32]=getBits(x,p,n);</code>"}, {"owner": {"reputation": 13, "user_id": 11152111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d12d18fd212c13ae33472340d1e683?s=128&d=identicon&r=PG&f=1", "display_name": "hassan", "link": "https://stackoverflow.com/users/11152111/hassan"}, "edited": false, "score": 0, "creation_date": 1553045070, "post_id": 55252150, "comment_id": 97237040, "body": "how do i store the the unsigned int into array or bits. Function is returning me bits of integer passed"}, {"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "reply_to_user": {"reputation": 25937, "user_id": 338904, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/dea29233fa03ea84f8a853102deb0344?s=128&d=identicon&r=PG", "display_name": "e2-e4", "link": "https://stackoverflow.com/users/338904/e2-e4"}, "edited": false, "score": 0, "creation_date": 1553046701, "post_id": 55252150, "comment_id": 97237349, "body": "@Ring&#216; That would only print the address of the array."}], "answers": [{"comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553046747, "post_id": 55252371, "comment_id": 97237361, "body": "Would recommend modifying the function to take <code>x</code> as <code>unsigned int</code>"}, {"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553046898, "post_id": 55252371, "comment_id": 97237399, "body": "@MFisherKDX could, but the arithmetic right shift would not matter in the &amp; against the least significant bit UPTO 32 times."}, {"owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1553046982, "post_id": 55252371, "comment_id": 97237422, "body": "@MFisherKDX to keep it consistent with the post, i will change it, though. Thanks."}], "tags": [], "owner": {"reputation": 206, "user_id": 10714410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/705ed7b594eb8631bf15b78a0ee90f9d?s=128&d=identicon&r=PG&f=1", "display_name": "RJM", "link": "https://stackoverflow.com/users/10714410/rjm"}, "is_accepted": true, "score": 3, "last_activity_date": 1553047444, "last_edit_date": 1553047444, "creation_date": 1553046096, "answer_id": 55252371, "question_id": 55252150, "link": "https://stackoverflow.com/questions/55252150/conversion-of-int-to-bit-wrong-return-type/55252371#55252371", "title": "Conversion of int to bit wrong return type", "body": "<p>There is a lot wrong here, such as the assignment at run time to the array. </p>\n\n<p>To store the separate bits of a 32-bit int into the array elements, you could use something as follows. </p>\n\n<pre><code>//assumes bits has been declared as unsignef char bits[32]\nvoid get_bits32(unsigned char * bits, unsigned int x) {\n    for(int i = 0; i &lt; 32; i++)\n        bits[i] = (x &gt;&gt; i) &amp; 1u;\n}\n</code></pre>\n\n<p>You could modify this to specify the number of bits or length of the array as follows. </p>\n\n<pre><code>void get_bits32(unsigned char * bits, int n, unsigned int x) {\n    for(int i = 0; i &lt; n; i++)\n        bits[i] = (x &gt;&gt; i) &amp; 1u;\n}\n</code></pre>\n\n<p>Here a char array is used, as you anticipate only 0s or 1s. </p>\n\n<p>This version stores the least significant bit at position 0 of the array. </p>\n\n<p>To print this, you must print each element of the array, ex.</p>\n\n<pre><code>for(int i = 0; i &lt; n; i++)\n    printf(\"%d\", bits[i]);\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11152111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d12d18fd212c13ae33472340d1e683?s=128&d=identicon&r=PG&f=1", "display_name": "hassan", "link": "https://stackoverflow.com/users/11152111/hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55252371, "answer_count": 1, "score": -1, "last_activity_date": 1553047444, "creation_date": 1553043929, "question_id": 55252150, "link": "https://stackoverflow.com/questions/55252150/conversion-of-int-to-bit-wrong-return-type", "title": "Conversion of int to bit wrong return type", "body": "<p>i have developed a function to convert int to 32 bits. the problem is i am trying to put the returned bits into array type of int but it's not coming. Should i use char array. As i need to pass the bits to another function bit by bit so i need to store them in array. Below is the code:</p>\n\n<pre><code> int main()\n{\n\nint x=24; // int whose 32 bits i need\nint n=32; // number of bits needed\nint p=0; // starting position.\n\nint py[32]=getBits(x,p,n);\nprintf(\"\\n\",py);\nreturn 0;\n}\n\n\nunsigned getBits(unsigned x, unsigned p, unsigned n) {\n  return (x &gt;&gt; (p + 1 - n)) &amp; ~(~0 &lt;&lt; n);\n }\n</code></pre>\n"}, {"tags": ["c++", "c", "cpputest"], "comments": [{"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553046680, "post_id": 55251920, "comment_id": 97237341, "body": "Why <code>TEST_GROUP_C_WRAPPER</code> defined both in <code>.c</code> &amp; <code>.cpp</code>. Just casting my eyes over the manual I assume it should be defined only in <code>.cpp</code>."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "reply_to_user": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553047179, "post_id": 55251920, "comment_id": 97237460, "body": "What do you mean by that?"}, {"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553049135, "post_id": 55251920, "comment_id": 97237819, "body": "Your <code>TEST_GROUP_C_WRAPPER(common_algos){}</code> is defined both in <code>commonTest.cpp</code> &amp; <code>commonTest.c</code>. Isn&#39;t just one definition needed in <code>.cpp</code> file i.e. don&#39;t you need to remove that definition from your <code>commonTest.c</code> file ?"}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "reply_to_user": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553049894, "post_id": 55251920, "comment_id": 97237957, "body": "Thanks for telling me about that. I&#39;ll update the post."}, {"owner": {"reputation": 773, "user_id": 5265558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0n94.jpg?s=128&g=1", "display_name": "Perette", "link": "https://stackoverflow.com/users/5265558/perette"}, "edited": false, "score": 0, "creation_date": 1553049990, "post_id": 55251920, "comment_id": 97237982, "body": "If you&#39;re calling C functions from C++, the include files need to either include or be wrapped in <a href=\"https://stackoverflow.com/questions/1041866/what-is-the-effect-of-extern-c-in-c\">extern &quot;C&quot;</a>.  This tells the C++ compiler not to perform <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_72/rzarg/name_mangling.htm\" rel=\"nofollow noreferrer\">name mangling</a> on functions declared therein.  Not using the <code>extern &quot;C&quot;</code> form when required results in linker errors, as the expected (mangled) and actual (unmangled) names don&#39;t match up."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "edited": false, "score": 0, "creation_date": 1553050483, "post_id": 55251920, "comment_id": 97238084, "body": "Could you perhaps provide an answer to this post? I think what you&#39;re suggesting is interesting, but I&#39;m not exactly sure what functions I should wrap in <code>extern &quot;C&quot;</code>."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "edited": false, "score": 0, "creation_date": 1553050700, "post_id": 55251920, "comment_id": 97238132, "body": "Plus, I thought the point of the <code>*C_WRAPPER</code> macros were to allow an interface for CppUTest and C."}, {"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553051804, "post_id": 55251920, "comment_id": 97238357, "body": "Is <code>commonTest.c</code> file actually compiled. Do you have the <code>commonTest</code> object file to link against. I had a look at your <code>Makefile</code> but, I couldn&#39;t find as where the <code>.c</code> file is compiled."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "edited": false, "score": 0, "creation_date": 1553052009, "post_id": 55251920, "comment_id": 97238407, "body": "As far as I could look from the manual, I don&#39;t think commonTest.c is actually touched at all :/ . However, I don&#39;t know precisely what I&#39;m supposed to do with it, or how do I link it with commonTest.cpp"}, {"owner": {"reputation": 1393, "user_id": 3648103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9badfef4d6302fd25825df1ea5ffaf06?s=128&d=identicon&r=PG&f=1", "display_name": "aep", "link": "https://stackoverflow.com/users/3648103/aep"}, "edited": false, "score": 0, "creation_date": 1553052895, "post_id": 55251920, "comment_id": 97238586, "body": "<code>.c</code> file should definitely be compiled and link against the generating executable. You compile <code>commonTest.c</code> with <code>cc</code> and link against that object to create your test executable. Have a look at here as how to achieve this with Makefiles. <a href=\"https://stackoverflow.com/questions/40164827/how-to-make-a-makefile-for-c-and-c-with-sources-in-subdirectories\" title=\"how to make a makefile for c and c with sources in subdirectories\">stackoverflow.com/questions/40164827/&hellip;</a>."}, {"owner": {"reputation": 773, "user_id": 5265558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0n94.jpg?s=128&g=1", "display_name": "Perette", "link": "https://stackoverflow.com/users/5265558/perette"}, "edited": false, "score": 0, "creation_date": 1553053165, "post_id": 55251920, "comment_id": 97238652, "body": "If it&#39;s the <code>extern &quot;C&quot;</code> issue, the &quot;right&quot; (opinion?) way to do it is to add it to the .h files <i>for the code being compiled with a C compiler</i>.  <a href=\"https://stackoverflow.com/questions/2168241/is-it-required-to-add-extern-c-in-source-file-also\">See this thread</a>.  If you can&#39;t modify them (perhaps they come with a library), you can instead wrap the corresponding <code>#include</code> directives <i>in .cpp files being compiled with C++</i>.  Effectively, the <code>extern &quot;C&quot;</code> is telling the C++ compiler, &quot;hey, this stuff here was compiled with a C compiler, and thus has unmangled names.&quot;"}], "owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553049915, "creation_date": 1553041939, "last_edit_date": 1553049915, "question_id": 55251920, "link": "https://stackoverflow.com/questions/55251920/connecting-cpputest-to-c-interface", "title": "Connecting CppUTest to C Interface", "body": "<p>I'm using CppUTest to handle unit testing with my C library. However, I'm having an issue when compiling the test file.</p>\n\n<p>Here's my <code>Makefile</code> (The <code>CPPUTEST_HOME</code> var is an environment variable):</p>\n\n<pre><code>CPPFLAGS += -I$(CPPUTEST_HOME)/include\nCXXFLAGS += -include $(CPPUTEST_HOME)/include/CppUTest/MemoryLeakDetectorNewMacros.h\nCFLAGS += -include $(CPPUTEST_HOME)/include/CppUTest/MemoryLeakDetectorMallocMacros.h\nLD_LIBRARIES = -L$(CPPUTEST_HOME)/lib -lCppUTest -lCppUTestExt\n\nall:\n        c++ -g -Wall $(CPPFLAGS) $(CXXFLAGS) $(CFLAGS) commonTest.cpp -o commonTest $(LD_LIBRARIES)\n\nclean:\n        rm -rf *.dSYM commonTest\n</code></pre>\n\n<p>When I run <code>make</code>, the following output is given:</p>\n\n<pre><code>Undefined symbols for architecture x86_64:\n  \"_test_common_algos_commonCalloc_wrapper_c\", referenced from:\n      TEST_common_algos_commonCalloc_Test::testBody() in commonTest-992552.o\n  \"_test_common_algos_commonMalloc_wrapper_c\", referenced from:\n      TEST_common_algos_commonMalloc_Test::testBody() in commonTest-992552.o\n  \"_test_common_algos_commonRealloc_wrapper_c\", referenced from:\n      TEST_common_algos_commonRealloc_Test::testBody() in commonTest-992552.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [all] Error 1\n</code></pre>\n\n<p>To me, this seems like a linking problem. However, I don't think I've done anything wrong according to <a href=\"https://cpputest.github.io/manual.html#c_interface\" rel=\"nofollow noreferrer\">the manual</a>:</p>\n\n<p><code>commonTest.c</code>:</p>\n\n<pre><code>#include \"../common.h\"\n#include \"CppUTest/TestHarness_c.h\"\n\nvoid *ptr = NULL;\nint list[10] = {1, 2, 32, 33, 2, 5, 7, 3, 9, 34};\n\nTEST_GROUP_C(common_algos)\n{\n\n};\n\nTEST_C(common_algos, commonMalloc)\n{\n  ptr = malloc_c(6);\n  CHECK_EQUAL_C_INT(algos_error, ALGOS_OK);\n  strncpy(ptr, \"Hello\", 5);\n  CHECK_EQUAL_C_STRING(\"Hello\", ptr);\n  free_c(ptr);\n}\n\nTEST_C(common_algos, commonCalloc)\n{\n  ptr = calloc_c(sizeof(int), 10);\n  CHECK_EQUAL_C_INT(algos_error, ALGOS_OK);\n  memcpy(ptr, list, sizeof(int)*10);\n  for (int i = 0; i &lt; 10; i++)\n      CHECK_EQUAL_C_INT(list[i], ptr[i]);\n  free_c(ptr);\n}\n\nTEST_C(common_algos, commonRealloc)\n{\n  ptr = malloc_c(10);\n  CHECK_EQUAL_C_INT(ALGOS_OK, algos_error);\n  memcpy(ptr, list, sizeof(int)*10);\n  ptr = realloc_c(ptr, 20);\n  CHECK_EQUAL_C_INT(ALGOS_OK, algos_error);\n  memcpy(ptr + 10, list, sizeof(int)*10);\n  for (int i = 9; i &lt; 19; i++)\n      CHECK_EQUAL_C_INT(list[i-9], ptr[i]);\n  free_c(ptr);\n}\n</code></pre>\n\n<p><code>commonTest.cpp</code>:</p>\n\n<pre><code>#include \"CppUTest/CommandLineTestRunner.h\"\n#include \"CppUTest/TestHarness_c.h\"\n\nTEST_GROUP_C_WRAPPER(common_algos)\n{\n\n};\n\nTEST_C_WRAPPER(common_algos, commonMalloc);\nTEST_C_WRAPPER(common_algos, commonCalloc);\nTEST_C_WRAPPER(common_algos, commonRealloc);\n\n\nint main(int ac, char **av)\n{\n return RUN_ALL_TESTS(ac, av);\n}\n</code></pre>\n\n<p>Lastly, my directory structure:</p>\n\n<pre><code>common\n  |______ common.c\n  |\n  |______ common.h\n  |\n  |______ test\n           |\n           |____commonTest.c\n           |\n           |____commonTest.cpp\n</code></pre>\n\n<p>For some context, I'm not a C++ programmer, and I'm not experienced with using CppUTest, so bear with me.</p>\n\n<p>Thanks for any help and feel free to ask questions.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553041487, "post_id": 55251854, "comment_id": 97236217, "body": "<code>strtok</code> is not reentrant. You can&#39;t process two strings at the same time."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1553041504, "post_id": 55251854, "comment_id": 97236221, "body": "you should use strncpy rather than strcpy to avoid overwriting the buffers allocated in the struct."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553041964, "post_id": 55251854, "comment_id": 97236334, "body": "... and you don&#39;t check for <code>NULL</code> pointer returned by <code>strtok</code> before it gets dereferenced by <code>strcpy</code>."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1553042222, "post_id": 55251854, "comment_id": 97236410, "body": "This code is not analyzable as-is due to the latent buffer overruns. Replace strcpy with strncpy for all of those copies into structs."}], "owner": {"reputation": 1, "user_id": 11229360, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fHv9kZ5vp-4/AAAAAAAAAAI/AAAAAAAAAV0/KTBV_cUfaL8/photo.jpg?sz=128", "display_name": "btwdan", "link": "https://stackoverflow.com/users/11229360/btwdan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553041308, "creation_date": 1553041308, "question_id": 55251854, "link": "https://stackoverflow.com/questions/55251854/segmentation-fault-and-struct", "title": "segmentation fault AND STRUCT", "body": "<p>My goal is to store in the struct the items in the file. The file format \nlooks like this:</p>\n\n<p>XXXXX:TEMP>20:AC=OFF<br>\nYYYYY:TEMP&lt;20:AC=ON   (etc)</p>\n\n<p>All I am getting is segmentation fault (core dumped). I am guessing it is because of the struct. The code in the <em>while</em> I'm pretty sure it works, but I might be wrong.</p>\n\n<pre><code>char *rule=(char*)malloc(sizeof(char)*80);  \nFILE *regra;\nregra=fopen(\"SensorRules2.txt\", \"r+\");\n\n\ntypedef struct r{\n\n    char divisao[20];\n    char sens[10];\n    char op[2];\n    int val;\n    char atuadores[10];\n    char estado[3];\n}reg;\n\n\n\nreg linha[42];\nint l=0;\n\nswitch(atoi(MoteID)){\n    case 1:\n\n    while(fgets(rule, 80, regra)){\n\n        strcpy(linha[l].divisao, strtok(rule, \":\"));            \n        aux=strtok(NULL, \":\");\n        strcpy(linha[l].sens, strtok(aux, \"&gt;\"));\n        strcpy(linha[l].op, \"&gt;\");\n        if(linha[l].sens == NULL){\n         strcpy(linha[l].sens, strtok(aux, \"&lt;\"));\n         strcpy(linha[l].op, \"&lt;\");\n        }\n        linha[l].val=atoi(strtok(NULL, \":\"));\n        strcpy(linha[l].atuadores, strtok(NULL, \"=\"));\n        strcpy(linha[l].estado, strtok(NULL, \" \"));\n\n        l++;\n    }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1553041062, "post_id": 55251799, "comment_id": 97236138, "body": "String Literals CANNOT be modified (except on ancient hardware not relevant here) You can use a <i>compound literal</i> <code>char *ptr = (char[]){ &quot;Harris&quot; };</code> (C99+)"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1553041194, "post_id": 55251821, "comment_id": 97236165, "body": "Which will buy a SegFault in this case. (but your note on quotes is correct)."}, {"owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553041453, "post_id": 55251821, "comment_id": 97236209, "body": "So, a strdup then.  Hard to answer these on a phone waiting for Chinese takeout."}], "tags": [], "owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "is_accepted": false, "score": 2, "last_activity_date": 1553041126, "creation_date": 1553041126, "answer_id": 55251821, "question_id": 55251799, "link": "https://stackoverflow.com/questions/55251799/c-string-literals-and-pointers-assignment/55251821#55251821", "title": "C String Literals and Pointers Assignment", "body": "<p>ptr[4]='a';</p>\n\n<p>Single quotes for character constants.</p>\n"}, {"comments": [{"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1553041441, "post_id": 55251843, "comment_id": 97236206, "body": "So I broke my own rule about answer and close because on reload after answer someone found a dupe target."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553041486, "post_id": 55251843, "comment_id": 97236215, "body": "There are only about 100 on the topic <code>:)</code>"}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 3, "last_activity_date": 1553041235, "creation_date": 1553041235, "answer_id": 55251843, "question_id": 55251799, "link": "https://stackoverflow.com/questions/55251799/c-string-literals-and-pointers-assignment/55251843#55251843", "title": "C String Literals and Pointers Assignment", "body": "<p>While you can assign a constant to a char pointer, you can't normally write to it. Fix your code:</p>\n\n<pre><code>char ptr []= \"Harris\";\n</code></pre>\n\n<p>For not-your-legacy code use -fwritable-strings.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9871833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1553041330, "accepted_answer_id": 55251843, "answer_count": 2, "score": 1, "last_activity_date": 1553041565, "creation_date": 1553040918, "last_edit_date": 1553041166, "question_id": 55251799, "link": "https://stackoverflow.com/questions/55251799/c-string-literals-and-pointers-assignment", "closed_reason": "Duplicate", "title": "C String Literals and Pointers Assignment", "body": "<p>I was looking at tutorials for C and pointers on the internet and found a debugging example and am wondering how to fix this block of code? I have been looking for a while and can't find out how to make it work. I want to replace the <code>'i'</code> in <code>\"Harris\"</code> with an <code>\"a\"</code>.</p>\n\n<pre><code>char * ptr = (char *) \"Harris\";\n\nptr[4]=\"a\";\n</code></pre>\n"}, {"tags": ["c++", "c", "arrays", "pointers", "unions"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 7, "creation_date": 1553040868, "post_id": 55251769, "comment_id": 97236088, "body": "<code>uint8_t* pa = u.pnt;</code> does not set <code>pa</code> to the <i>address</i> of the member. It should be <code>uint8_t** pa = &amp;u.pnt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 3, "last_activity_date": 1553041182, "creation_date": 1553041182, "answer_id": 55251830, "question_id": 55251769, "link": "https://stackoverflow.com/questions/55251769/different-addresses-of-a-pointer-and-an-array-in-a-union/55251830#55251830", "title": "Different addresses of a pointer and an array in a union", "body": "<p>The result of expression <code>u.pnt</code> is not the address of the union member <code>u.pnt</code>. It is the value of the member. But the member has an indeterminate value, so your program has undefined behaviour.</p>\n\n<p>To get the address, you can use the address-of operator (just like when you took the address of the other member):</p>\n\n<pre><code>uint8_t** pa = &amp;u.pnt;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11229348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf48f4005b4ca8a68de7162b0c254f5?s=128&d=identicon&r=PG&f=1", "display_name": "peter tomson", "link": "https://stackoverflow.com/users/11229348/peter-tomson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1553041193, "creation_date": 1553040722, "last_edit_date": 1553041193, "question_id": 55251769, "link": "https://stackoverflow.com/questions/55251769/different-addresses-of-a-pointer-and-an-array-in-a-union", "title": "Different addresses of a pointer and an array in a union", "body": "<p>I want to get the address of the first element of an array. This array is in an union with a pointer.</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdint.h&gt;\n\nunion l_array_0_uint8_t {\n  uint8_t *pnt;\n  uint8_t array[8];\n\n};\n\nint main()\n{\n    union l_array_0_uint8_t u;\n    uint8_t* aa = &amp;(u.array[0]);\n    uint8_t* pa = u.pnt;\n    printf(\"array   inner: %p\\n\", aa);\n    printf(\"Pointer inner: %p\\n\", pa);\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>array   inner: 0x7ffdad959050\nPointer inner: 0x7ffdad959140\n</code></pre>\n\n<p>Why do this two addresses differ? I expected the array and the pointer to have the same address.</p>\n"}, {"tags": ["c", "file-io"], "comments": [{"owner": {"reputation": 7, "user_id": 11229287, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nu_R0BelQU8/AAAAAAAAAAI/AAAAAAAAADs/DsyFj_N1eU8/photo.jpg?sz=128", "display_name": "Andy Nguyen", "link": "https://stackoverflow.com/users/11229287/andy-nguyen"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553039891, "post_id": 55251586, "comment_id": 97235882, "body": "@Fredrik Considering p, at, and bt are the arrays, do I need to do anything in distributing them correctly or does sscanf automatically fill the arrays with the integers it reads?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553040285, "post_id": 55251586, "comment_id": 97235978, "body": "Like this: <code>if (sscanf(str, &quot;%d %d %d&quot;, &amp;p[totalJobs], &amp;at[totalJobs], &amp;bt[totalJobs]) == 3)</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553040566, "post_id": 55251586, "comment_id": 97236025, "body": "Have you learned about structures yet?  It looks as though you&#39;d do better with an array of structures rather than three parallel arrays.  You should check to ensure that you don&#39;t overflow your arrays, whether there&#39;s one array of structures or three parallel arrays of numbers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553040732, "post_id": 55251586, "comment_id": 97236064, "body": "Structures are particularly useful if you need to sort the data based on one particular member."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553041056, "post_id": 55251586, "comment_id": 97236137, "body": "Re the edit: change <code>char *str[256];</code> to <code>char str[256];</code>"}, {"owner": {"reputation": 7, "user_id": 11229287, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nu_R0BelQU8/AAAAAAAAAAI/AAAAAAAAADs/DsyFj_N1eU8/photo.jpg?sz=128", "display_name": "Andy Nguyen", "link": "https://stackoverflow.com/users/11229287/andy-nguyen"}, "edited": false, "score": 0, "creation_date": 1553041276, "post_id": 55251586, "comment_id": 97236181, "body": "Thanks! I finally got it! I&#39;ll include the updates on Stack Overflow."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553041605, "post_id": 55251586, "comment_id": 97236249, "body": "It would be more useful to future readers if you don&#39;t modify the faulty code in the question. Otherwise there&#39;s no question. You can post the solution as an answer, but newcomers often thing they should be modifying the code they posted. SO isn&#39;t really a step-by-step code correction service."}], "answers": [{"tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": false, "score": 0, "last_activity_date": 1553076104, "creation_date": 1553076104, "answer_id": 55258078, "question_id": 55251586, "link": "https://stackoverflow.com/questions/55251586/how-to-read-input-file-and-store-integers-into-array-in-c/55258078#55258078", "title": "How to read input file and store integers into array in C", "body": "<p>Your code has many problems.</p>\n\n<p>1) Your arrays aren't initialized, which is a sure-fire way of getting unreadable output and potentially very bad bugs.</p>\n\n<p>2) Several of the variables in your code aren't declared. In the future, please post the code EXACTLY as it is for you, so that it is immediately compilable. A tried and true way of not getting any answers to your questions is to post code that needs to be substantially edited before it even compiles: people generally just go \"screw this, not worth it\" and you really can't blame them.</p>\n\n<p>3) Your way of reading files is inefficient both in terms of performance wise code structure. The best way of reading files is to read them in one go, and then parse them to get what you need out of them.</p>\n\n<p>4) Your printfs in the last for-loop are completely wrong, which is strange because in the commented out printfs above as well as sscanf you seem to understand how format string work. I think this is an error of not reading your code VERY carefully. Please do that from now on.</p>\n\n<p>Here's a complete program that I think does roughly what you require:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char** argv) {\n    #define jobArrayLength (6ULL)\n    #define stringLength   (256ULL)\n    int  pList[jobArrayLength] = {0}, wtList[jobArrayLength] = {0}, btList[jobArrayLength] = {0};\n    int  totalJobs = 0; // Used to not be declared\n    char str[stringLength] = {0} ; // Used to be uninitialized\n\n    FILE *input;\n    input = fopen(argv[1], \"r\"); \n    if (input == NULL) {\n        printf(\"File not found. \\n\");\n        exit(1);\n    }\n\n    fread(str, 1, stringLength, input); // Used to be sizeof str which is wrong\n    fclose(input);\n    int i; // Used to not be declared\n    int stringIndex = 0;\n    for (i = 0; i &lt; jobArrayLength; i++) {\n        if (sscanf(str + stringIndex, \"%d %d %d\", pList + i, wtList + i, btList + i) == 3) { // used to not index into the array\n            totalJobs++;\n            while (str[stringIndex++] != '\\n' &amp;&amp; stringIndex != stringLength) {} // Skip to next row of numbers\n        } else {\n            printf(\"Input text is not in 3 column format. Please check. \\n\");\n        }\n    }\n\n    //printf(\"Scheduling algorithm: %s\\n\", argv[2]);\n    //printf(\"Total %d tasks are read from \\\"%s\\\". press 'enter' to start...\\n\", totalJobs, input);\n    //printf(\"==================================================================\\n\");\n    for (i = 0; i &lt; jobArrayLength; i++) {\n        printf(\"%d, %d, %d\\n\", pList[i], wtList[i], btList[i]); // Used to just print an int array element, which is not how printf works.\n    }\n    getchar();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11229287, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nu_R0BelQU8/AAAAAAAAAAI/AAAAAAAAADs/DsyFj_N1eU8/photo.jpg?sz=128", "display_name": "Andy Nguyen", "link": "https://stackoverflow.com/users/11229287/andy-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553076104, "creation_date": 1553039336, "last_edit_date": 1553041768, "question_id": 55251586, "link": "https://stackoverflow.com/questions/55251586/how-to-read-input-file-and-store-integers-into-array-in-c", "title": "How to read input file and store integers into array in C", "body": "<p>I am working on a CPU Scheduler simulator in C and I have an input file with the following:</p>\n\n<pre><code>1 0 10\n2 0 9\n3 3 5\n4 7 4\n5 10 6\n6 10 7\n</code></pre>\n\n<p>I would like to store the numbers in a first, second, and third columns in an array separately in the following manner:</p>\n\n<pre><code>a1[0] = 1     a2[0] = 0     a3[0] = 10\na1[1] = 2     a2[1] = 0     a3[1] = 9\na1[2] = 3     a2[2] = 3     a3[2] = 5\na1[3] = 4     a2[3] = 7     a3[3] = 4\na1[4] = 5     a2[4] = 10    a3[4] = 6\na1[5] = 6     a2[5] = 10    a3[5] = 7  \n</code></pre>\n\n<p>I am having trouble understanding how to implement this through C implementation. My current code is as follows:</p>\n\n<pre><code>int pList[len], wtList[len], btList[len];\n\nchar *str[256];\nchar *token[30];\n\nFILE *input;\n\ninput = fopen(argv[1], \"r\");\n\nif (input == NULL) {\n    printf(\"File not found. \\n\");\n    exit(1);\n}\n\nwhile (fgets(str, sizeof str, input)) {\n    if (sscanf(str, \"%d %d %d\", &amp;pList, &amp;wtList, &amp;btList) == 3) { \n        totalJobs++;\n    } else {\n        printf(\"Input text is not in 3 column format. Please check. \\n\");\n    }\n}\n\nfclose(input);\n\n//printf(\"Scheduling algorithm: %s\\n\", argv[2]);\n//printf(\"Total %d tasks are read from \\\"%s\\\". press 'enter' to start...\\n\", totalJobs, input);\n//printf(\"==================================================================\\n\");\nfor (i = 0; i &lt; 6; i++) {\n    printf(pList[i]);\n    printf(wtList[i]);\n    printf(btList[i]);\n}\n</code></pre>\n\n<p>Ideally I would want an abstract implementation of putting these numbers into an array because the input file should be able to have more or less rows and still work. I apologize if my formatting is off as I am new with using Stack Overflow. Thanks in advance for the help and please let me know if my question is still unclear.</p>\n\n<p>UPDATE 1: I did the following corrections as stated and I am now getting a <code>Segmentation fault (Core dumped)</code> error. Could it be because I did not have a <code>*</code> in front of the arrays?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1553039201, "post_id": 55251556, "comment_id": 97235709, "body": "What debugging have you done? Where have you narrowed the problem down to?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1553039334, "post_id": 55251556, "comment_id": 97235739, "body": "<code>float sup_sum</code> and all the other accumulators are not initialised to <code>0.0</code>. And <code>while ( !feof(in) )</code> combined with no input error checking is almost guaranteed to duplicate the final data / break the array. Please see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while ( !feof (file) )</code> wrong?</a>"}, {"owner": {"reputation": 1, "user_id": 11229288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e99964e782c24f269624935ae3ba1e?s=128&d=identicon&r=PG&f=1", "display_name": "DMat10", "link": "https://stackoverflow.com/users/11229288/dmat10"}, "edited": false, "score": 0, "creation_date": 1553039465, "post_id": 55251556, "comment_id": 97235765, "body": "I tried removing the last for loop that calculates the temperature average for Lake St. Clair and putting it into an identical program (without other for loops) and it results in a correct value. Then, I put the last for loop back and removed any other for loop. When any one for loop is removed, the correct values are displayed, but when the number of for loops is the same as it is currently, the St.Clair Lake average temperature shows the incorrect value. I have not been able to successfully fix this."}, {"owner": {"reputation": 1, "user_id": 11229288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e99964e782c24f269624935ae3ba1e?s=128&d=identicon&r=PG&f=1", "display_name": "DMat10", "link": "https://stackoverflow.com/users/11229288/dmat10"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553039636, "post_id": 55251556, "comment_id": 97235802, "body": "@WeatherVane Thank you so much! This fixed my problem :) Although, may I ask why the first few averages displayed correctly even though they were not initialized to 0.0?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553039687, "post_id": 55251556, "comment_id": 97235818, "body": "That&#39;s fine but did you really re-write the <code>feof</code> thing in that space of time?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553039717, "post_id": 55251556, "comment_id": 97235834, "body": "Well, **** happens, that what happened. That&#39;s like asking why you didn&#39;t have to pay the train fare, when you didn&#39;t fare the train fare."}, {"owner": {"reputation": 1, "user_id": 11229288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e99964e782c24f269624935ae3ba1e?s=128&d=identicon&r=PG&f=1", "display_name": "DMat10", "link": "https://stackoverflow.com/users/11229288/dmat10"}, "edited": false, "score": 0, "creation_date": 1553040054, "post_id": 55251556, "comment_id": 97235922, "body": "No, I meant to the average calculation problem. I will rewrite my loop."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1553054509, "post_id": 55251556, "comment_id": 97238968, "body": "Do <b>not</b> use a bare <code>fscanf(in, &quot;%f&quot;, ...);</code>, test the return value of <code>fscanf()</code> to determine is the scan succeeded.  <a href=\"https://linux.die.net/man/3/fscanf\" rel=\"nofollow noreferrer\">ref</a>"}], "owner": {"reputation": 1, "user_id": 11229288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e99964e782c24f269624935ae3ba1e?s=128&d=identicon&r=PG&f=1", "display_name": "DMat10", "link": "https://stackoverflow.com/users/11229288/dmat10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553039157, "creation_date": 1553039110, "last_edit_date": 1553039157, "question_id": 55251556, "link": "https://stackoverflow.com/questions/55251556/i-have-a-problem-with-my-last-average-calculation-reading-file-and-storing-val", "title": "I have a problem with my last average calculation ( Reading file and storing values into arrays )", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\n    FILE *in;\n    float day[365],sup[365],mich[365],huron[365],erie[365],ont[365],stclr[365]; \n    int i,j;\n    float year; \n    float sup_sum,mich_sum,huron_sum,erie_sum,ont_sum,stclr_sum;\n    float sup_avg,mich_avg,huron_avg,erie_avg,ont_avg,stclr_avg; \n    int counter = 0; \n\n\n    in = fopen(\"C:\\\\Users\\\\TEMP.DESKTOP-O4G383R.000\\\\Desktop\\\\CPS Term Project\\\\term_proj_data.txt\",\"r\"); \n\n    while ( !feof(in) )\n    {\n\n    for( i = 0; i &lt; 2920; i++)\n    {//outer for loop   \n\n    for (j = 0; j &lt; 8; j++)\n    {//inner for loop \n\n    if (j == 0)         \n    fscanf(in, \"%f\", &amp;year);\n\n    if (j == 1)         \n    fscanf(in, \"%f\", &amp;day[i]);\n\n    if (j == 2)         \n    fscanf(in, \"%f\", &amp;sup[i]);\n\n    if (j == 3)         \n    fscanf(in, \"%f\", &amp;mich[i]);\n\n    if (j == 4)         \n    fscanf(in, \"%f\", &amp;huron[i]);\n\n    if (j == 5)         \n    fscanf(in, \"%f\", &amp;erie[i]);\n\n    if (j == 6)         \n    fscanf(in, \"%f\", &amp;ont[i]);\n\n    if (j == 7)         \n    fscanf(in, \"%f\", &amp;stclr[i]);\n\n    }//inner for loop \n\n    }//outer for loop \n\n    }\n\n    printf(\"%.2f\", stclr[5]);\n\n    /*--------------Calculating averages----------------------*/\n\n    //lake Superior \n    for (i = 0; i &lt; 365; i++)\n    {\n    sup_sum += sup[i]; \n    counter++;\n    }\n    sup_avg = sup_sum / counter; \n\n    printf(\"\\n\\n Lake Superior temp avg:%f\", sup_avg);\n    counter = 0; \n\n    //lake Michigan \n    for (i = 0; i &lt; 365; i++)\n    {\n    mich_sum += mich[i]; \n    counter++;\n    }\n    mich_avg = mich_sum / counter; \n\n    printf(\"\\n\\n Lake Michigan temp avg:%f\", mich_avg);\n    counter = 0; \n\n    //lake Huron \n    for (i = 0; i &lt; 365; i++)\n    {\n    huron_sum += huron[i]; \n    counter++;\n    }\n    huron_avg = huron_sum / counter; \n\n    printf(\"\\n\\n Lake Huron temp avg:%f\", huron_avg);\n    counter = 0; \n\n    //lake Erie  \n    for (i = 0; i &lt; 365; i++)\n    {\n    erie_sum += erie[i]; \n    counter++;\n    }\n    erie_avg = erie_sum / counter; \n\n    printf(\"\\n\\n Lake Erie temp avg:%f\", erie_avg);\n    counter = 0; \n\n    //lake Ontario   \n    for (i = 0; i &lt; 365; i++)\n    {\n    ont_sum += ont[i]; \n    counter++;\n    }\n    ont_avg = ont_sum / counter; \n\n    printf(\"\\n\\n Lake Ontario temp avg:%f\", ont_avg);\n    counter = 0; \n\n    //lake St.Clair    \n    for (i = 0; i &lt; 365; i++)\n    {\n    stclr_sum += stclr[i]; \n    counter++;\n    }\n    stclr_avg = stclr_sum / counter; \n\n    printf(\"\\n\\n Lake St.Clair temp avg:%f\", stclr_avg);\n    counter = 0; \n\n    return 0;\n}\n</code></pre>\n\n<p>The whole idea of my program is to read values from a txt file and store them into arrays. Then I must calculate the average temperature for each lake for 365 days. Everything is working fine for me except that the last average temperature gives an incorrect value.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2oIJ8.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I am not quite sure what is causing this. I am no expert in C. I am a student learning the language right now. </p>\n"}, {"tags": ["c++", "c", "linux", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 5, "creation_date": 1553038222, "post_id": 55251438, "comment_id": 97235441, "body": "would help to have an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1553038695, "post_id": 55251438, "comment_id": 97235577, "body": "So you added code to shut down the program if it detects <code>read()</code> blocking for too long, and you observe that the thread in which the affected read occurs seems to spontaneously &quot;disappear&quot;.  Chances are excellent that the thread is <i>terminating</i> rather than disappearing mysteriously, and this is supported by the fact that you can afterward <code>pthread_join()</code> it.  With nothing else to go on, I&#39;d suppose that the watchdog code you added is responsible, one way or the other."}], "answers": [{"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553040675, "creation_date": 1553040675, "answer_id": 55251759, "question_id": 55251438, "link": "https://stackoverflow.com/questions/55251438/thread-disappears-when-blocking-on-read-how-do-i-debug-it/55251759#55251759", "title": "thread &#39;disappears&#39; when blocking on read() how do i debug it?", "body": "<p><code>read</code> is a cancellation point, so if your application calls <code>pthread_cancel</code> to terminate the thread at some point, the thread will cease to exist (after executing the cleanup actions).  Joining a canceled thread succeeds and yields the special value <code>PTHREAD_CANCELED</code> for the <code>void *</code> value optionally filled out by <code>pthread_join</code>.</p>\n\n<p>If you replace <code>read</code> with an endless loop, then there is no cancellation point, the cancellation request is not acted upon, and <code>pthread_join</code> will also wait indefinitely.</p>\n"}], "owner": {"reputation": 545, "user_id": 1373940, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8d8c15f120adc6cd646e56cf92abcb34?s=128&d=identicon&r=PG", "display_name": "Piotr", "link": "https://stackoverflow.com/users/1373940/piotr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553117433, "creation_date": 1553038134, "last_edit_date": 1553117433, "question_id": 55251438, "link": "https://stackoverflow.com/questions/55251438/thread-disappears-when-blocking-on-read-how-do-i-debug-it", "title": "thread &#39;disappears&#39; when blocking on read() how do i debug it?", "body": "<p>I have a multithreaded application, in c++ running under Linux (Fedora 27). One of the threads keep reading data from a file on the local disk using low-level IO (open, read, etc.) and supplies that data to a buffer that is rotated between other threads.</p>\n\n<p>Now, i suddenly ran into a strange problem where read() would start blocking infinitely for no apparent reason at arbitrary offset into the file. I added a monitor thread that would detect this block (by setting a timestamp before entering read() ) and attempt to shut down the program when it occurred.</p>\n\n<p>The weird thing now, is that at the end of the main thread, it waits for <code>pthread_join</code>, and on that read thread - it returns 0 (success).</p>\n\n<p>I tried again, but replaced the call to <code>read()</code> with a <code>while(1);</code> and now, <code>pthread_join</code> does not finish as expected.</p>\n\n<p>I then examined the program in gdb, and to my surprise when i reach the <code>pthread_join</code>, the read thread is GONE!</p>\n\n<p>Looking at <code>info thread</code> when the monitor thread detects a blocking <code>read()</code> the thread is still there, but at some point it disappears, and i can't catch it!</p>\n\n<p>I'm trying to catch this thread exiting and i'm looking for ideas on how to do so. I am using <code>pthread_cleanup_push/pop</code> but my function is not being invoked by the read thread (all other threads do).</p>\n\n<p>any ideas? i'm at my wits end!</p>\n\n<p>edit ----------------------------------------</p>\n\n<p>it appears to have something to do with <code>syslog</code> being called from a completely unrelated thread.</p>\n"}, {"tags": ["c", "arrays", "string", "char", "int"], "comments": [{"owner": {"reputation": 4168, "user_id": 6273251, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fCGXep-7snc/AAAAAAAAAAI/AAAAAAAAADk/nk_YDFGfkc0/photo.jpg?sz=128", "display_name": "Random Davis", "link": "https://stackoverflow.com/users/6273251/random-davis"}, "edited": false, "score": 0, "creation_date": 1553038376, "post_id": 55251404, "comment_id": 97235490, "body": "Did this not provide enough info? <a href=\"https://stackoverflow.com/questions/10186765/what-is-the-difference-between-char-array-vs-char-pointer-in-c\" title=\"what is the difference between char array vs char pointer in c\">stackoverflow.com/questions/10186765/&hellip;</a>"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1553038541, "post_id": 55251404, "comment_id": 97235541, "body": "What do you think will happen if you call <code>change(&quot;HEY&quot;);</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1553194598, "post_id": 55251404, "comment_id": 97304568, "body": "not all strings are mutable, so not all strings can be changed.  That is why the usual method is to  <code>malloc()</code> enough memory and produce the changed string inside the resulting allocated memory"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "edited": false, "score": 0, "creation_date": 1553088504, "post_id": 55253112, "comment_id": 97255075, "body": "Got the point, thank you. Anyway if I get char array or pointer to array in parameter, I should be able to get it&#39;s length by calling function strlen(), so another parameter &quot;length&quot; is not needed. Is it correct?"}, {"owner": {"reputation": 773, "user_id": 5265558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0n94.jpg?s=128&g=1", "display_name": "Perette", "link": "https://stackoverflow.com/users/5265558/perette"}, "reply_to_user": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "edited": false, "score": 2, "creation_date": 1553089195, "post_id": 55253112, "comment_id": 97255530, "body": "It depends.  <code>strlen()</code> counts <i>the bytes in the string up until a null</i>--i.e., the length of the current data in the string.  It doesn&#39;t tell you the capacity of the array those bytes are in.  If you&#39;re extracting data from the string, or only modifying bytes inside it, you&#39;re good.  If you&#39;re expanding the string, the function needs to be told the capacity to use this approach safely."}], "tags": [], "owner": {"reputation": 773, "user_id": 5265558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a0n94.jpg?s=128&g=1", "display_name": "Perette", "link": "https://stackoverflow.com/users/5265558/perette"}, "is_accepted": true, "score": 3, "last_activity_date": 1553052290, "creation_date": 1553052290, "answer_id": 55253112, "question_id": 55251404, "link": "https://stackoverflow.com/questions/55251404/modifying-string-in-function-c/55253112#55253112", "title": "Modifying string in function C", "body": "<p>If you <em>only</em> need to change existing characters in the string, and the string will be in a variable, and you don't mind the side-effect of your original string being modified, then your solution may be acceptable and indeed easier.  But:</p>\n\n<ul>\n<li><p>What if you want to get a modified string, but also want to retain the original?  To avoid destroying an arbitrary-sized original, you need to <code>malloc</code> space, make a copy, and modify that.</p></li>\n<li><p>And what if you want to extend the string?  If your change is to add \" YOU\" to the string, it can't modify the original because there's no space for it--it'll cause a <a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\" rel=\"nofollow noreferrer\">buffer overflow</a>, since there's only 4 bytes allocated for \"HEY\" (three letters plus the null terminator).  Again, the solution involves <code>malloc</code>ing space to work with.</p></li>\n</ul>\n\n<p>Functions that make changes using your technique typically need a <code>size</code> or <code>length</code> parameter to avoid overflowing the array and causing a crash and a potential security risk.  But although that avoids the overflow, there's still the question of what happens if there's not enough space: Silently drop some data? Pass back a flag or special value to indicate there wasn't enough space, and expect the caller to handle it?  In the long run, it ends up easier to write it right the first time, and <code>malloc</code>/<code>calloc</code> the space and deal with having to free it up later and all that.</p>\n"}], "owner": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 55253112, "answer_count": 1, "score": 0, "last_activity_date": 1553052290, "creation_date": 1553037940, "question_id": 55251404, "link": "https://stackoverflow.com/questions/55251404/modifying-string-in-function-c", "title": "Modifying string in function C", "body": "<p>Let's say I want to modify char array using function.\nI am always seeing people using malloc, calloc, or pointers to modify int, char, or 2D arrays.\nAm I right, if I say, that string can be returned from function only if I use malloc, create that array pointer and return him? Then why not getting/altering string, by passing it to function parameter?\nIsn't my demonstration, which is using char array in parameter easier, than allocating/freeing? Is my concept wrong, or why am I never seeing people passing arrays to function? I am only seeing codes with passing like \"char *array\", not \"char array[]\", using malloc etc, when I see this method of altering char array easy. Am I missing something?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid change(char array[]){\n    array[0]='K';\n}\n\nint main(){\n\n    char array[]=\"HEY\";\n    printf(\"%s\\n\", array);\n    change(array);\n    printf(\"%s\\n\",array );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553037581, "post_id": 55251313, "comment_id": 97235224, "body": "why not <code>return &quot;TOWER_OF_POWER&quot;;</code> -- make <code>findButtonText</code> return <code>const char *</code>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553037754, "post_id": 55251313, "comment_id": 97235290, "body": "<code>char *rtnTxt[] = { NULL };</code> is declared local to <code>findButtonTxt</code>. When the function returns, <code>rtnTxt</code> no longer exists. You can do <code>char *rtnTxt;</code> and then <code>rtnTxt = &quot;TOWER_OF_POWER&quot;;</code> and <code>return rtnTxt;</code> to return a <i>Pointer To the String Literal</i>."}, {"owner": {"reputation": 1, "user_id": 11127561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af1d1a371a0e550d3b1b09d95b0df6d?s=128&d=identicon&r=PG&f=1", "display_name": "jbreaper", "link": "https://stackoverflow.com/users/11127561/jbreaper"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553038538, "post_id": 55251313, "comment_id": 97235540, "body": "@MFisherKDX I wish i could do it that way, but the version of BGI my Lecturer gave me will only work with it the way I showed, and even that took 2 weeks and the help of several lab helpers to get to."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553038876, "post_id": 55251313, "comment_id": 97235628, "body": "Unfortunately, the way you showed won&#39;t work. See comment by @David"}], "answers": [{"tags": [], "owner": {"reputation": 607, "user_id": 1452351, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a124ed341afc9a9379101e9cb74a6253?s=128&d=identicon&r=PG&f=1", "display_name": "Shane", "link": "https://stackoverflow.com/users/1452351/shane"}, "is_accepted": false, "score": 0, "last_activity_date": 1553038104, "last_edit_date": 1553038104, "creation_date": 1553037791, "answer_id": 55251383, "question_id": 55251313, "link": "https://stackoverflow.com/questions/55251313/returning-an-array-of-individual-chars/55251383#55251383", "title": "returning an array of individual chars", "body": "<p>I am assuming C based on the code. </p>\n\n<p>You can't return a stack allocated array as a pointer. </p>\n\n<pre><code> char *rtnTxt[] = { NULL }; //Don't do this\n</code></pre>\n\n<p>You should malloc an array and then use strncpy</p>\n\n<pre><code>#define MAX_STRING 256 // modify this to what ever your max string will be\nchar *rtnTxt = malloc(sizeof(char)*MAX_STRING);\n</code></pre>\n\n<p>Then down in your switch you can strcpy</p>\n\n<pre><code>strcpy (rtnTxt ,\"What I want to copy\");\n</code></pre>\n\n<p>Then return the result </p>\n\n<pre><code>return rtnTxt;\n</code></pre>\n\n<p>Here is the complete solution</p>\n\n<pre><code>#define MAX_STRING 256\nchar * findButtonTxt(int reference) {\n    char *rtnTxt = malloc(sizeof(char)*MAX_STRING);\n\n    switch (reference) {\n        case 1:\n        strcpy (rtnTxt ,\"Tower of power\");\n        break;\n    }\nreturn rtnTxt;\n}\n</code></pre>\n\n<p>Finally don't forget to call <strong>free</strong> when you are done or you will have a memory leak :) </p>\n"}], "owner": {"reputation": 1, "user_id": 11127561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af1d1a371a0e550d3b1b09d95b0df6d?s=128&d=identicon&r=PG&f=1", "display_name": "jbreaper", "link": "https://stackoverflow.com/users/11127561/jbreaper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553038104, "creation_date": 1553037331, "question_id": 55251313, "link": "https://stackoverflow.com/questions/55251313/returning-an-array-of-individual-chars", "title": "returning an array of individual chars", "body": "<p>I'm currently working on a university project where I'm making a game in c. I'm trying to make a selection of button based menus and need to be able to get the text into a few different menus. I'm trying to use a switch case based function to return the text for the buttons.</p>\n\n<pre><code>char * findButtonTxt(int reference) {\n    char *rtnTxt[] = { NULL };\n\n    switch (reference) {\n    case 1:\n        rtnTxt[] = { \"T\", \"O\", \"W\", \"E\", \"R\", \"_\", \"O\", \"F\", \"_\", \"P\", \"O\", \"W\", \"E\", \"R\", NULL };\n        return rtnTxt;\n        break;\n    default:\n        return \"T\", \"O\", \"W\", \"E\", \"R\", \"_\", \"O\", \"F\", \"_\", \"P\", \"O\", \"W\", \"E\", \"R\", NULL;\n    }\n}\n</code></pre>\n\n<p>I want it to use it like this</p>\n\n<pre><code>    txt = findButtonTxt((4 * curMenu) + i + 1);\n    betterText(20, (getmaxy() - (25 + (50 * i))) - 30, txt);\n</code></pre>\n\n<p>this is what I have so far, I need it to return the array this way because it's the only way I can get the text to display using the version of BGI I have.</p>\n\n<p>This is what is currently working.</p>\n\n<pre><code>    char *twrTxt[] = { \"T\", \"O\", \"W\", \"E\", \"R\", \"_\", \"O\", \"F\", \"_\", \"P\", \"O\", \"W\", \"E\", \"R\", NULL };\n\nbetterText((getmaxx() / 2), 0, twrTxt);\n</code></pre>\n\n<p>Sorry for the long question.\nthanks for the help in advanced.</p>\n"}, {"tags": ["c", "list", "gcc"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1553036273, "post_id": 55251147, "comment_id": 97234861, "body": "You need to include a header in every file that depends on its contents."}, {"owner": {"reputation": 59, "user_id": 11229135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3irOy.gif?s=128&g=1", "display_name": "Martian", "link": "https://stackoverflow.com/users/11229135/martian"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1553036574, "post_id": 55251147, "comment_id": 97234924, "body": "I feel stupid, i thought i don&#39;t have to since i had included it before the  &quot;delete_functions.h&quot; &quot;insert_functions.h&quot; &quot;functionality_functions.h&quot; i thought the compiler wouldn&#39;t want to &quot;find&quot; it again latter in the code, anyways thanks a lot, you saved me."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1553036681, "post_id": 55251147, "comment_id": 97234949, "body": "@Ph For future reference: You question includes every file except the ones where the error occurs. In this case the problem was easy to spot, but in other cases it will be 100% impossible to debug without seeing the code..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553036778, "post_id": 55251147, "comment_id": 97234971, "body": "With <code>typedef char AirportCode[4];</code> why not <code>AirportCode Airport;</code> in <code>struct nodetype</code>?? You create the <code>typedef</code>, but aren&#39;t using it?"}, {"owner": {"reputation": 59, "user_id": 11229135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3irOy.gif?s=128&g=1", "display_name": "Martian", "link": "https://stackoverflow.com/users/11229135/martian"}, "reply_to_user": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1553037221, "post_id": 55251147, "comment_id": 97235102, "body": "@John3136 yes you are right and thanks for mentioning i really didn&#39;t know where the problem was and i thought that the part of the code i posted was enough, wrong assumption for sure. I am really new into programing and just got in stactoverflow so I don&#39;t know my way around here, but thank you know that I know i will be more specific about my code, and #include the right files\ud83d\ude07"}, {"owner": {"reputation": 59, "user_id": 11229135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3irOy.gif?s=128&g=1", "display_name": "Martian", "link": "https://stackoverflow.com/users/11229135/martian"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553037347, "post_id": 55251147, "comment_id": 97235145, "body": "@DavidC.Rankin  typedef char AirportCode[4] helps me a lot latter in the program as john mentioned It was my fault for not posting the whole program, how else could evrybody else know"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553037606, "post_id": 55251147, "comment_id": 97235233, "body": "No biggie, using <code>char Airport[4];</code> is fine -- it was just curious being only 2-lines below the <code>typedef</code>."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 11229135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3irOy.gif?s=128&g=1", "display_name": "Martian", "link": "https://stackoverflow.com/users/11229135/martian"}, "edited": false, "score": 0, "creation_date": 1553037459, "post_id": 55251236, "comment_id": 97235183, "body": "Yes I can see my fault now, that fixed my problem thank you very much!!"}], "tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553036682, "creation_date": 1553036682, "answer_id": 55251236, "question_id": 55251147, "link": "https://stackoverflow.com/questions/55251147/unknown-type-name-in-c-struct-while-ussing-gcc/55251236#55251236", "title": "&quot;unknown type name&quot; in c struct while ussing gcc", "body": "<p>According to the GCC error message, there error is in  the <code>delete_functions.c</code> file.</p>\n\n<p>Presumably, it looks like this at the beginning:</p>\n\n<pre><code>#include \"delete_functions.h\"\n</code></pre>\n\n<p>Since <code>delete_functions.h</code> does not itself include <code>types.h</code>, you need to include it first:</p>\n\n<pre><code>#include \"types.h\"\n#include \"delete_functions.h\"\n</code></pre>\n\n<p>Alternatively, you can add <strong>include guards</strong> to your headers so, that they can safely be included multiple times, like this for <code>types.h</code>:</p>\n\n<pre><code>#ifndef TYPES_H\n#define TYPES_H\n\ntypedef char AirportCode[4];\ntypedef struct nodetype{\n    char Airport[4];\n    struct nodetype *next;\n} nodetype;\n\n#endif\n</code></pre>\n\n<p>And for <code>delete_functions.h</code>:</p>\n\n<pre><code>#ifndef DELETE_FUNCTIONS_H\n#define DELETE_FUNCTIONS_H\n\nvoid Delete(nodetype *list,char node[4]);\nvoid DeleteLast(nodetype *list);\n\n#endif\n</code></pre>\n\n<p>The <code>*_H</code> include guard macros are necessary because otherwise, <code>main.c</code> would not compile anymore: each type in <code>types.h</code> can only be defined once per translation unit, and without the guards, every <code>*.h</code> would bring in another definition, leading to compiler errors.</p>\n"}], "owner": {"reputation": 59, "user_id": 11229135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3irOy.gif?s=128&g=1", "display_name": "Martian", "link": "https://stackoverflow.com/users/11229135/martian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553036682, "creation_date": 1553036141, "question_id": 55251147, "link": "https://stackoverflow.com/questions/55251147/unknown-type-name-in-c-struct-while-ussing-gcc", "title": "&quot;unknown type name&quot; in c struct while ussing gcc", "body": "<p>I have a program which is processing list in c, it  is working perfectly as long as I have it in one source file, when I try to separate it and compile it got this error \u201c delete_functions.c:15:13: error: unknown type name \u2018nodetype\u2019 \u201d same error goes for functionality_functions.c and insert_functions.c here is the code </p>\n\n<p>main.c </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include \"types.h\"\n#include \"delete_functions.h\"\n#include \"insert_functions.h\"\n#include \"functionality_functions.h\"\n\nint main(){\n    //i did not upload all the main function code because it is way to long\n}\n</code></pre>\n\n<p>types.h</p>\n\n<pre><code>typedef char AirportCode[4];\ntypedef struct nodetype{\n    char Airport[4];\n    struct nodetype *next;\n} nodetype;\n</code></pre>\n\n<p>delete_functions.h</p>\n\n<pre><code>void Delete(nodetype *list,char node[4]);\nvoid DeleteLast(nodetype *list);\n</code></pre>\n\n<p>functionality_functions.h</p>\n\n<pre><code>void print(nodetype *head);\nnodetype *search(nodetype *list,char item[4]);\nnodetype *create();\n</code></pre>\n\n<p>insert_functions.h</p>\n\n<pre><code>void *InsertLast(nodetype *list,char item[4]);\nvoid *InsertAfter(nodetype *list,char item[4],char node[4]);\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1553035681, "post_id": 55251036, "comment_id": 97234702, "body": "That should not even compile - at least not without warnings. It is <code>strcpy(char*, char*)</code> not <code>strcpy(char*, char)</code> Also note that (assuming this is &quot;close&quot;)  you&#39;ll need to malloc 2 chars. One for the value and one for the 0 terminator"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1553037539, "post_id": 55251036, "comment_id": 97235209, "body": "Pay attention to the prefix of the function name <b><i>str...</i></b> expects to operate on C-strings. A C-string includes the <i>nul-terminating</i> character at the end (otherwise it is simply a character array). A minimum you need 2-characters of storage to store a 1-character string. Your alternative is to allocate a single-character and <b>assign</b> the character to your <code>table[i].str</code> (note using an 8-byte pointer to 1-byte or storage to store 1-bytes is 900% inefficient."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 2, "last_activity_date": 1553035684, "creation_date": 1553035684, "answer_id": 55251077, "question_id": 55251036, "link": "https://stackoverflow.com/questions/55251036/copying-1-single-character-into-string/55251077#55251077", "title": "Copying 1 single character into string", "body": "<p>Three problems:</p>\n\n<p>1) You have to allocate an extra byte for the null terminator of the target string:</p>\n\n<pre><code>table[i].str = malloc(2);\n</code></pre>\n\n<p>2) You have to pass a pointer to the source to strcpy (this probably caused your segfault):</p>\n\n<pre><code>strcpy(table[i].str,&amp;temp);\n</code></pre>\n\n<p>3) The source string has to be null terminated, which it isn't in your code. This is not easy to fix directly. But you do not need strcpy() anyway, just set the two bytes directly:</p>\n\n<pre><code>table[i].str[0] = i;\ntable[i].str[1] = 0;\n</code></pre>\n\n<p>Then it should work as you expect.</p>\n"}], "owner": {"reputation": 133, "user_id": 10453354, "user_type": "registered", "profile_image": "https://graph.facebook.com/1903495193049921/picture?type=large", "display_name": "Kent Wong", "link": "https://stackoverflow.com/users/10453354/kent-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553035684, "creation_date": 1553035348, "question_id": 55251036, "link": "https://stackoverflow.com/questions/55251036/copying-1-single-character-into-string", "title": "Copying 1 single character into string", "body": "<p>I am trying to create a ASCII table using a customized Abstract data type</p>\n\n<pre><code>typedef struct dictionary {\n    int code;\n    char* str;\n}dictionary;\n</code></pre>\n\n<p>and I encounter an exception when trying to do the following code</p>\n\n<pre><code>dictionary table[4096];\nvoid preset() {\n    for (int i = 0; i &lt; 256; i++) {\n        char temp = 0 + i;\n        table[i].str = (char *) malloc(sizeof(char));\n        strcpy(table[i].str,temp);\n    }\n}\n</code></pre>\n\n<p>I don't understand how I access memory wrongly, can someone help ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "edited": false, "score": 1, "creation_date": 1553031651, "post_id": 55250375, "comment_id": 97233344, "body": "You can\u2019t really do that in C. Make a big lookup table and use that."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1553031695, "post_id": 55250375, "comment_id": 97233354, "body": "This obviously is an XY problem. Please describe the problem you are trying to solve this way, we can then help you find a way which is possible. At a guess, that would be an array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1553031705, "post_id": 55250375, "comment_id": 97233361, "body": "You could use <code>var = someArray[arg]</code>."}, {"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1553032266, "post_id": 55250375, "comment_id": 97233548, "body": "If <code>NUM1000</code> was <code>332790</code>, I&#39;d say use <code>void func(int arg) { var = (arg - 1) * 333 + 123; }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1553032854, "post_id": 55250417, "comment_id": 97233748, "body": "This the &#39;only&#39; sane way to do it \u2014 at least, it is the simplest and most reliable way of doing it, once you&#39;ve got the array initialized correctly."}, {"owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1553033417, "post_id": 55250417, "comment_id": 97233943, "body": "@TomKarzes Yes, you&#39;re right of course -- updated with a comment to that effect."}], "tags": [], "owner": {"reputation": 119716, "user_id": 643383, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/uQ5JF.png?s=128&g=1", "display_name": "Caleb", "link": "https://stackoverflow.com/users/643383/caleb"}, "is_accepted": false, "score": 2, "last_activity_date": 1553033339, "last_edit_date": 1553033339, "creation_date": 1553031723, "answer_id": 55250417, "question_id": 55250375, "link": "https://stackoverflow.com/questions/55250375/how-to-form-define-constant-name-in-c/55250417#55250417", "title": "How to form #define constant name in C?", "body": "<blockquote>\n  <p>How can I achieve this without using if or switch statement ?</p>\n</blockquote>\n\n<p><strong>You can put all 1000 constants in an array</strong> and then use <code>arg</code> to select the one you want.</p>\n\n<pre><code>int list[1000] = {NUM1, NUM2, NUM3, NUM4...NUM1000};\n\nvoid func(int arg){\n    var = list[arg - 1];   // use arg-1 because C arrays start from zero\n}\n</code></pre>\n\n<blockquote>\n  <p>How to form #define constant name in C?</p>\n</blockquote>\n\n<p><strong>You can't, and if you could it wouldn't help you.</strong> Macros created with #define are handled by the preprocessor. That is, before your code is sent to the compiler itself, the preprocessor scans through it and replaces each macro name (e.g. <code>NUM1</code>) with the corresponding value (e.g. <code>123</code>). The resulting code is then passed on to the compiler, so the compiler never even sees the macro names. So even if you <em>could</em> somehow create the macro name at dynamically at run time, there'd be no way to connect that name back to the value that was associated with it in the source code.</p>\n"}, {"tags": [], "owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1553037055, "creation_date": 1553037055, "answer_id": 55251279, "question_id": 55250375, "link": "https://stackoverflow.com/questions/55250375/how-to-form-define-constant-name-in-c/55251279#55251279", "title": "How to form #define constant name in C?", "body": "<p>Why bother with <code>#define</code>s. Just use one array to define you constants and access them through your function.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n\nconst int KNums[] = {\n        123, // 1\n        456, // 2\n        789, // 3\n        //...  fill in the missing elements\n        111213 // 1000\n};\nstatic_assert(sizeof KNums / sizeof *KNums == 1000,\n        \"You need 1000 elements for this to work\");\n\nint var;\n\nvoid func(int arg) {\n    assert((1 &lt;= arg) &amp;&amp; (arg &lt;= 1000));\n    var = KNums[arg - 1];\n}\n\nint main(void) {\n    func(3);\n    printf(\"%d\\n\", var);\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4221707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafac1ee1efc320092f641f6c28899b1?s=128&d=identicon&r=PG", "display_name": "Aniket Sirsath", "link": "https://stackoverflow.com/users/4221707/aniket-sirsath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1553037055, "creation_date": 1553031491, "last_edit_date": 1553032794, "question_id": 55250375, "link": "https://stackoverflow.com/questions/55250375/how-to-form-define-constant-name-in-c", "title": "How to form #define constant name in C?", "body": "<p>I have a list of #defines in header file.\ne.g</p>\n\n<pre><code>#define NUM1 123\n#define NUM2 456\n#define NUM3 789\n...\n#define NUM1000  111213\n</code></pre>\n\n<p>In my function I get an <code>int</code> argument <code>arg</code>. The value of <code>arg</code> can be between  1 to 1000.\nbased of the arg value I want to assign above defines to a variable. \ni.e </p>\n\n<pre><code>void func(int arg){\n    if (arg == 1) {var = NUM1;}\n    ....\n    if (arg == 50) {var = NUM50;}\n    ....\n    if (arg == 1000) {var = NUM1000;}\n}\n</code></pre>\n\n<p>How can I achieve this without using if or switch statement?\nI tried using char array to form <code>#define</code> constant name:</p>\n\n<pre><code>void func(int arg){\n    char name[10];\n    sprintf(name,\"NUM%d\",arg);\n    var = name;\n}\n</code></pre>\n\n<p>But I don't see the expected value.\nAny help will be appreciated.  </p>\n"}, {"tags": ["c", "logical-operators", "primality-test", "relational-operators"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1553030570, "post_id": 55250116, "comment_id": 97232960, "body": "<code>0</code>, <code>1</code>, <code>2</code>, ..., and <code>7</code> are the 3-bit numbers. Of these <code>2</code>, <code>3</code>, <code>5</code>, and <code>7</code> are prime. Am I missing something?"}, {"owner": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 1, "creation_date": 1553030645, "post_id": 55250116, "comment_id": 97232984, "body": "I think OP just wants to know which way is faster, which would depend on CPU architecture. But yeah, otherwise just take input as an integer and <code>return (num != 4) &amp;&amp; (num != 6)</code>..."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 804, "user_id": 5893772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EATNh.png?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/5893772/reticulated-spline"}, "edited": false, "score": 1, "creation_date": 1553031247, "post_id": 55250116, "comment_id": 97233196, "body": "@ReticulatedSpline <code>0</code> and <code>1</code> are not primes. You need to check for them too."}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 2, "creation_date": 1553031562, "post_id": 55250116, "comment_id": 97233312, "body": "I think <code>x3 ? x1 : x2</code> should do the trick (assuming <code>x3</code> represents the most-significant of the 3 bits)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553031859, "post_id": 55250116, "comment_id": 97233412, "body": "Easy to do <code>bool primeArray[8] = { false, ... };</code> and then look it up with no bit twiddling needed. Clear and simple."}], "answers": [{"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 1, "last_activity_date": 1553067506, "last_edit_date": 1553067506, "creation_date": 1553032735, "answer_id": 55250605, "question_id": 55250116, "link": "https://stackoverflow.com/questions/55250116/primality-test-using-logical-or-relational-operators-on-a-3-bit-number/55250605#55250605", "title": "Primality test using logical or relational operators on a 3-bit number", "body": "<p>Because there are not many inputs, you can define a pre-computed table PRIME that has 1 on the positions of prime numbers and 0 for the rest.</p>\n\n<p>For example, PRIME(0,1,1) = 1 while PRIME(1,0,1)=0, i.e. PRIME(3)=true, PRIME(6)=false.</p>\n"}, {"comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1553036671, "post_id": 55251075, "comment_id": 97234948, "body": "Except <a href=\"https://primes.utm.edu/notes/faq/one.html\" rel=\"nofollow noreferrer\">1 is not prime</a>. See also <a href=\"http://mathworld.wolfram.com/PrimeNumber.html\" rel=\"nofollow noreferrer\">here</a>. From the latter article: &quot;The number 1 is a special case which is considered neither prime nor composite. Although the number 1 used to be considered a prime, it requires special treatment in so many definitions and applications involving primes greater than or equal to 2 that it is usually placed into a class of its own.&quot;"}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1553037598, "post_id": 55251075, "comment_id": 97235231, "body": "I think the best you can do with bitwise ops is <code>(x3 &amp; x1) | (~x3 &amp; x2)</code>. In boolean algebra, this would be of the form <code>AC + (!A)B</code> (don&#39;t know how to do an A with a bar over it), and I&#39;m not aware of any rule that would allow simplifying it further. I could be wrong about this, but all of the online boolean algebra expression simplifiers I&#39;ve tried seem to agree it can&#39;t be simplified."}], "tags": [], "owner": {"reputation": 11, "user_id": 11228965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6duZWq2OHB0/AAAAAAAAAAI/AAAAAAAAADc/94yOmenOBjk/photo.jpg?sz=128", "display_name": "Jim", "link": "https://stackoverflow.com/users/11228965/jim"}, "is_accepted": false, "score": 1, "last_activity_date": 1553035664, "creation_date": 1553035664, "answer_id": 55251075, "question_id": 55250116, "link": "https://stackoverflow.com/questions/55250116/primality-test-using-logical-or-relational-operators-on-a-3-bit-number/55251075#55251075", "title": "Primality test using logical or relational operators on a 3-bit number", "body": "<p>The shorter solution is:</p>\n\n<pre><code>int isPrime(unsigned char x3, unsigned char x2, unsigned char x1) {\n  return x1 | (x2 &amp; ~x3);\n}\n</code></pre>\n\n<ul>\n<li><code>x1</code> is to match all odd numbers. In the interval [1..7] they are all prime.</li>\n<li><code>(x2 &amp; ~x3)</code> is to match the value 2 (in fact it match 2 and 3).</li>\n</ul>\n\n<p>With Compiler Explorer you can compare the code generated by various compilers on various architectures. Example with gcc x86_64 vs ARM64 : <a href=\"https://godbolt.org/z/JwtES4\" rel=\"nofollow noreferrer\">https://godbolt.org/z/JwtES4</a></p>\n\n<p>Note: For a small function like that a <code>#define</code> will be faster and shorted than a function call.</p>\n\n<pre><code>#define isPrime(x3,x2,x1) ((x1) | ((x2) &amp; ~(x3)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "is_accepted": true, "score": 3, "last_activity_date": 1553043888, "last_edit_date": 1553043888, "creation_date": 1553041014, "answer_id": 55251806, "question_id": 55250116, "link": "https://stackoverflow.com/questions/55250116/primality-test-using-logical-or-relational-operators-on-a-3-bit-number/55251806#55251806", "title": "Primality test using logical or relational operators on a 3-bit number", "body": "<p><strong>Bitwise</strong></p>\n\n<p>I think the best you can do here is <code>(x3 &amp; x1) | (~x3 &amp; x2)</code>. In boolean algebra, this would be expressed as <code>AC + (!A)B</code>.<code>*</code> None of the usual rules for simplifying boolean algebra expressions would seem to apply here, and several online boolean algebra expression simplifiers seem to agree.</p>\n\n<p><code>*</code> <em>(the second <code>A</code> would normally be written with a bar over it, but I don't know how to do that in markdown).</em></p>\n\n<p>So you'd get something like this (using <code>uchar</code> as shorthand for <code>unsigned char</code>):</p>\n\n<pre><code>uchar f_bitwise(uchar x3, uchar x2, uchar x1) \n{\n   return (x3 &amp; x1) | (~x3 &amp; x2);\n}\n</code></pre>\n\n<p>The assembly produced by this (with <code>-O0</code> and discarding the function call overhead), looks like this:</p>\n\n<pre><code>movzx   eax, BYTE PTR [rbp-4]  # move x3 into register eax\nand     al, BYTE PTR [rbp-12]  # bitwise AND the lower half of eax with x1\nmov     ecx, eax               # store the result in ecx\ncmp     BYTE PTR [rbp-4], 0    # compare x3 with 0\nsete    al                     # set lower half of eax to 1 if x3 was equal to 0\nmov     edx, eax               # store the result in edx (this now equals ~x3)\nmovzx   eax, BYTE PTR [rbp-8]  # move x2 into eax\nand     eax, edx               # bitwise AND ~x3 (in edx) with x2 (in eax)\nor      eax, ecx               # finally, bitwise OR eax and ecx\n</code></pre>\n\n<p>The result is stored in <code>eax</code>. </p>\n\n<p><strong>Logical</strong></p>\n\n<p>Looking at the bits of values 0-7, and trying to discern an easy pattern to key off of, you notice that for values 0-3, the number is prime if and only if <code>x2</code> is 1. Likewise, for values 4-7, the number is prime if and only if <code>x1</code> is 1. This observation yields a simple expression: <code>x3 ? x1 : x2</code>. </p>\n\n<p>I have no proof that this is the shortest possible expression using logical operators, so if someone has a shorter version, by all means post it in a comment. However, it does seem unlikely that there's a shorter version, given that this is essentially a single logical operator, as you can see if you expand the ternary operator into a proper <code>if</code>/<code>else</code>:</p>\n\n<pre><code>uchar f_logical(uchar x3, uchar x2, uchar x1) \n{\n   if (x3 != 0) \n      return x1;\n   else\n      return x2;\n}\n</code></pre>\n\n<p>The assembly produced by this is as follows (again with <code>-O0</code> and not counting the function call overhead):</p>\n\n<pre><code>cmp     BYTE PTR [rbp-4], 0      # compare x3 with 0\nje      .L2                      # if equal, jump to label L2\nmovzx   eax, BYTE PTR [rbp-12]   # move x1 into register eax\njmp     .L4                      # jump to label L4 (i.e., return from function)\n.L2: \nmovzx   eax, BYTE PTR [rbp-8]    # move x2 into register eax\n.L4:\n# Function return. Result is once again stored in eax.\n</code></pre>\n\n<p>I haven't tested the performance of either of these functions, but just from looking at the assembly, it seems almost certain that <code>f_logical</code> would run faster than <code>f_bitwise</code>. It uses significantly fewer instructions, and although fewer instructions doesn't always equate to faster, none of these instructions seem like they would be particularly expensive in terms of CPU cycles. </p>\n\n<p>If you cancel out the instructions that both functions have in common and compare what's left, you get:</p>\n\n<p><code>f_logical</code>: <code>je</code>, <code>jmp</code></p>\n\n<p><code>f_bitwise</code>: <code>and</code> (2), <code>mov</code> (2), <code>sete</code>, <code>or</code></p>\n\n<p>As for <em>why</em> the logical version is shorter, I think the answer is branching. With only bitwise operations and no branching, you have to account for all possibilities in a single expression. </p>\n\n<p>For instance, in <code>(x3 &amp; x1) | (~x3 &amp; x2)</code>, it would be nice to get rid of the <code>~x3</code> on the right hand side, given that <em>you</em> already know <code>x3</code> is zero there, given that the right hand side represents the test for values 0-3. But the computer has no way of knowing this, and you can't factor it out into a simpler expression. </p>\n\n<p>With the ability to branch, you can split the problem into two sub-problems using a single comparison operator. Again, this works because for values 0-3, the <code>x2</code> bit is essentially an \"is prime\" bit, and for values 4-7, the <code>x1</code> bit is an \"is prime\" bit.</p>\n\n<p>Also, alinsoar is correct that a lookup table would be faster, but only if the value <em>isn't</em> split into individual bits. With the bit values in separate variables, you either have to reconstruct the number using something like <code>x3&lt;&lt;2 | x2&lt;&lt;1 | x1</code>, or you have to define your lookup table as a 3D array, in which case the compiler generates a bunch of extra instructions to do the address arithmetic necessary to index a 3D array.</p>\n"}], "owner": {"reputation": 303, "user_id": 8006233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wvxaO.png?s=128&g=1", "display_name": "CyberFox", "link": "https://stackoverflow.com/users/8006233/cyberfox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 55251806, "answer_count": 3, "score": 0, "last_activity_date": 1553067506, "creation_date": 1553030194, "question_id": 55250116, "link": "https://stackoverflow.com/questions/55250116/primality-test-using-logical-or-relational-operators-on-a-3-bit-number", "title": "Primality test using logical or relational operators on a 3-bit number", "body": "<p>I am looking forward to check if a 3 bits number is prime using both logical and relational operators.The number is represented using 3 variables with bits 7-1 set to 0 and only the bit on position 0 being the actual data. Suppose we have:</p>\n\n<pre><code>unsigned char x3, x2, x1;\n</code></pre>\n\n<p>One can assume that a prime number is function <code>f</code> which outputs <code>1</code> if the number is prime, <code>0</code> otherwise.</p>\n\n<p>How would one solve this using bit-wise operations (logical operators) as optimal as possible? One can assume that a minimum conjunctive/disjunctive form can be extracted from a K.V. diagram of the truth table. </p>\n\n<p>How would one solve this using relational operators? </p>\n\n<p>Which one would be faster?</p>\n\n<p>Some useful data:</p>\n\n<pre><code>CDF: (~x2 &amp; X1) | (X0 &amp; X2)\nCCF: (X1 | X2) &amp; (X0 | ~X2)\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553030167, "post_id": 55250078, "comment_id": 97232812, "body": "&quot;Hello world&quot; is a string literal, so only a pointer to it will be passed. And yes, the stack is freed when the function is returning. So.. what&#39;s your concern?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1553030668, "post_id": 55250078, "comment_id": 97232996, "body": "No, the string literal will not be on the stack. See <a href=\"http://port70.net/~nsz/c/c99/n1256.html#6.4.5\" rel=\"nofollow noreferrer\">C99 p6.4.5</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553030844, "post_id": 55250078, "comment_id": 97233060, "body": "It&#39;s possibly a compiler option whether string literals are shared or duplicated. This is a good reason for read-only string literals."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553031335, "post_id": 55250078, "comment_id": 97233227, "body": "If you want to save about 100 bytes memory (where it&#39;s duplicated) you can assign a pointer <code>char *hw = &quot;Hello World&quot;;</code> and pass that pointer to <code>snprintf</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553033074, "post_id": 55250078, "comment_id": 97233833, "body": "@WeatherVane: better to use <code>const char hw[] = &quot;Hello World&quot;;</code> since that saves you an extra pointer&#39;s worth of memory.  (Your code has a pointer and a string; the array has just a string \u2014 the array address is a constant.)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553035106, "post_id": 55250078, "comment_id": 97234507, "body": "@JonathanLeffler ... but at the expense of a duplicated string, which has to be copied into the array at runtime. You have two arrays."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553035610, "post_id": 55250078, "comment_id": 97234678, "body": "@WeatherVane \u2014 well, it&#39;d be a <code>static</code> array, and possibly at file scope.  It wouldn&#39;t be an automatic array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553036016, "post_id": 55250078, "comment_id": 97234780, "body": "@JonathanLeffler I had assumed it would be automatic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553036069, "post_id": 55250078, "comment_id": 97234797, "body": "@WeatherVane \u2014 I noticed, and that was careless of me not to add <code>static</code> as it left it open for interpretation.  If the data is constant, there&#39;s no reason not to make it <code>static</code> \u2014 to save copying as you diagnosed."}], "answers": [{"tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 4, "last_activity_date": 1553031536, "last_edit_date": 1553031536, "creation_date": 1553030698, "answer_id": 55250212, "question_id": 55250078, "link": "https://stackoverflow.com/questions/55250078/does-snprintf-use-root-memory-by-format-specifier/55250212#55250212", "title": "does snprintf() use root memory by format specifier?", "body": "<p>The string literal <code>\"Hello World\"</code> has \"static storage duration\". Practically this means it is not on the \"stack\".  The Standard doesn't specify whether identical string literals are \"collapsed\" into one instance or not.</p>\n\n<p>From C11 6.4.5: String Literals</p>\n\n<blockquote>\n  <ol start=\"6\">\n  <li>... The multibyte character\n  sequence is then used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. \n  ...<br>\n  7 It is unspecified whether these arrays are distinct provided their elements have the\n  appropriate values. If the program attempts to modify such an array, the behavior is\n  undefined</li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<p>\"Stack\" is in quotes above, because the standard doesn't ever mention \"Stack\" or \"Heap\" or \"ROM\".  There's only \"automatic\" or \"allocated\" or \"static\" storage duration.  Most compilers do have a one-to-one mapping of the concepts.</p>\n"}], "owner": {"reputation": 11, "user_id": 11228867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7d507d71384c38a20cbebb64fc44ece?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Tran", "link": "https://stackoverflow.com/users/11228867/michael-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1553035312, "answer_count": 1, "score": 1, "last_activity_date": 1553035352, "creation_date": 1553030004, "last_edit_date": 1553031487, "question_id": 55250078, "link": "https://stackoverflow.com/questions/55250078/does-snprintf-use-root-memory-by-format-specifier", "closed_reason": "Duplicate", "title": "does snprintf() use root memory by format specifier?", "body": "<p>For instance, I have 10 of these calls in a function,</p>\n\n<pre><code>snprintf(dest, sizeof(dest), \"%s\", \"Hello World\");\n</code></pre>\n\n<p>Then, would <code>\"Hello World\"</code> be stored on the stack a total of ten times (resulting in 11+(1) bytes * 10 = 110 bytes)? </p>\n\n<p>Please let me hear your thoughts.\nThanks.</p>\n"}, {"tags": ["c", "windows", "service", "certificate", "cryptoapi"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553032675, "post_id": 55249755, "comment_id": 97233691, "body": "in your call <code>CryptAcquireContext</code> you use <i>pszContainer</i> as <code>NULL</code> - so default key container name is used. but this is different between user and service. you need use concrete name. not 0 here"}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553035082, "post_id": 55249755, "comment_id": 97234496, "body": "Thanks for the suggestion. You mean choose any unique container name? I read the remarks at [<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/wincrypt/nf-wincrypt-cryptacquirecontexta]\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/api/wincrypt/&hellip;</a> (CryptAcquireContext) but it wasn&#39;t clear to me what it is supposed to be set to."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553035615, "post_id": 55249755, "comment_id": 97234681, "body": "but you can get <code>CRYPT_KEY_PROV_INFO</code> from cerificat via <code>CertGetCertificateContextProperty</code> with <code>CERT_KEY_PROV_INFO_PROP_ID</code> and use <i>pwszContainerName, pwszProvName, dwProvType</i>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553037433, "post_id": 55249755, "comment_id": 97235168, "body": "really you not need call <code>CryptAcquireContext</code> at all. in encrypt <code>EncryptParams.hCryptProv</code> - <i>This member is not used and should be set to NULL.</i> in decrypt - your error in call <code>CertOpenSystemStore(hCryptProv, cStore);</code> but instead you need open the same store as in encrypt - <code>CertOpenStore(CERT_STORE_PROV_SYSTEM, X509_ASN_ENCODING, 0, CERT_SYSTEM_STORE_LOCAL_MACHINE, L&quot;MY&quot;)</code> and code will be much more simply"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553039916, "post_id": 55249755, "comment_id": 97235890, "body": "you can you something like <a href=\"https://pastebin.com/kLZxYWZa\" rel=\"nofollow noreferrer\">pastebin.com/kLZxYWZa</a>"}, {"owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553082741, "post_id": 55249755, "comment_id": 97251464, "body": "@RbMm - thanks for the sample code. It works if both the encrypt and decrypt are done in the same program. But if the encrypt is done in one program and the decrypt in another I still get <code>CRYPT_E_NO_DECRYPT_CERT (0x8009200C)</code> from <code>CryptDecryptMessage</code>."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1553084335, "post_id": 55249755, "comment_id": 97252476, "body": "ok, i special check <a href=\"https://pastebin.com/CSQnW9i2\" rel=\"nofollow noreferrer\">this code</a> when run <code>DecryptMsg</code> from exe started with <i>lsass.exe</i> as parent process (under <i>LocalSystem</i> token) and all work correct. <code>CRYPT_E_NO_DECRYPT_CERT</code> say that you open store where no certificat which used to encode message. so you open different stores in encode and decode process. but if use say <code>CertOpenStore(CERT_STORE_PROV_SYSTEM, X509_ASN_ENCODING, 0, CERT_SYSTEM_STORE_LOCAL_MACHINE, L&quot;MY&quot;)</code> - will be the same store"}], "owner": {"reputation": 2060, "user_id": 1231882, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/nkdVI.jpg?s=128&g=1", "display_name": "Neil Weicher", "link": "https://stackoverflow.com/users/1231882/neil-weicher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1553028589, "creation_date": 1553028589, "question_id": 55249755, "link": "https://stackoverflow.com/questions/55249755/cryptdecryptmessage-returns-crypt-e-no-decrypt-cert-when-executed-inside-service", "title": "CryptDecryptMessage returns CRYPT_E_NO_DECRYPT_CERT when executed inside service running under LSA", "body": "<p>I created an RSA Certificate with a Private Key in LocalMachine/My store.</p>\n\n<p>I then created a simple Windows console app in C to:</p>\n\n<ul>\n<li>locate the cert by thumbprint</li>\n<li>encrypt a buffer with <code>CryptEncryptMessage</code></li>\n<li>write the buffer out to a file</li>\n</ul>\n\n<p>I then wrote a small service app, also in C to:</p>\n\n<ul>\n<li>read the buffer</li>\n<li>decrypt with <code>CryptDecryptMessage</code></li>\n</ul>\n\n<p>It all works fine as long as the service app is not running under the Local System Account (LSA). In that case, <code>CryptDecryptMessage</code> generates <code>CRYPT_E_NO_DECRYPT_CERT (0x8009200C)</code>. This is despite that the Cert is in LocalMachine/My</p>\n\n<p>I tried to strip down the code as much as possible but it is still rather long. I'm hoping there is some flag setting I am getting wrong. Or is this expected behavior? Thanks for taking a look.</p>\n\n<h1>Windows console app</h1>\n\n<pre><code>int __cdecl main(int argc, CHAR* argv[])\n{\n    HCERTSTORE hSysStore = NULL;\n    DWORD err;\n    PCHAR    certThumbprint   = \"14FE20556FC106DA4C561707ABDFEACEB8CAAC98\";\n    PCERT_CONTEXT pContext = NULL;\n    BYTE*    pbEncryptedBlob = NULL;\n    DWORD    cbEncryptedBlob;\n    BYTE bPlain[255] = {0};\n    DWORD cbContent;\n    strcpy_s(bPlain, sizeof(bPlain)-1, argv[1]);\n    cbContent = strlen(bPlain)+1;\n    err = myGetCertFromThumb(CERT_SYSTEM_STORE_LOCAL_MACHINE, L\"MY\", certThumbprint, &amp;hSysStore, &amp;pContext);\n    if (err != 0)\n        goto cleanup;\n    pbEncryptedBlob = malloc(BUF_SZ);\n    cbEncryptedBlob = BUF_SZ;\n    /**** code below ****/\n    err = myEncryptMsg(pContext, bPlain, cbContent, pbEncryptedBlob, &amp;cbEncryptedBlob);\n    if (err != 0)\n        goto cleanup;\n    printf(\"Encrypted msg size=%d\\n\", cbEncryptedBlob);\n\n    /****  write cbEncryptedBlob to file  ****/\n\ncleanup:\n    if (pbEncryptedBlob)\n        free(pbEncryptedBlob);\n    if (pContext)\n        CertFreeCertificateContext(pContext);\n    if (hSysStore != NULL)\n        CertCloseStore(hSysStore, CERT_CLOSE_STORE_CHECK_FLAG);\n    return(err);\n}\n\nDWORD myEncryptMsg(PCERT_CONTEXT pContext, BYTE* pbPlain, DWORD cbPlainszsz, BYTE* pbCipher, DWORD *pcbCiphersz)\n{\n    BOOL rc;\n    DWORD err;\n    PCCERT_CONTEXT RecipientCertArray[1];\n    DWORD EncryptAlgSize;\n    HCRYPTPROV hCryptProv;\n    CRYPT_ALGORITHM_IDENTIFIER EncryptAlgorithm;\n    CRYPT_ENCRYPT_MESSAGE_PARA EncryptParams;\n    DWORD EncryptParamsSize;\n    rc = CryptAcquireContext(\n        &amp;hCryptProv,        // Address for handle to be returned.\n        NULL,               // Use the current user's logon name.\n        NULL,               // Use the default provider.\n        PROV_RSA_FULL,      // Need to both encrypt and sign.\n        0);              // No flags needed.\n    if (rc) \n        goto keyset_exists;\n    err = GetLastError();\n    if (err != NTE_BAD_KEYSET)\n        goto cleanup;\n    rc = CryptAcquireContext(\n        &amp;hCryptProv,        // Address for handle to be returned.\n        NULL,               // Use the current user's logon name.\n        NULL,               // Use the default provider.\n        PROV_RSA_AES,      // Need to both encrypt and sign.\n        CRYPT_NEWKEYSET);              // No flags needed.\n    if (!rc) \n    {\n        err = GetLastError();\n        goto cleanup;\n    }\nkeyset_exists:\n    RecipientCertArray[0] = pContext;\n    EncryptAlgSize = sizeof(EncryptAlgorithm);\n    memset(&amp;EncryptAlgorithm, 0, EncryptAlgSize);\n    EncryptAlgorithm.pszObjId = szOID_NIST_AES256_CBC;\n    EncryptParamsSize = sizeof(EncryptParams);\n    memset(&amp;EncryptParams, 0, EncryptParamsSize);\n    EncryptParams.cbSize =  EncryptParamsSize;\n    EncryptParams.dwMsgEncodingType = (PKCS_7_ASN_ENCODING | X509_ASN_ENCODING);\n    EncryptParams.hCryptProv = hCryptProv;\n    EncryptParams.ContentEncryptionAlgorithm = EncryptAlgorithm;\n    rc = CryptEncryptMessage(\n        &amp;EncryptParams,\n        1,\n        RecipientCertArray,\n        pbPlain,\n        cbPlainszsz,\n        pbCipher,\n        pcbCiphersz);\n    if (!rc)\n    {\n        err = GetLastError();\n        goto cleanup;\n    }\n    err = 0;\ncleanup:\n    if(hCryptProv)\n        CryptReleaseContext(hCryptProv,0);\n    return(err);\n}\n</code></pre>\n\n<h1>Windows Service App</h1>\n\n<pre><code>BYTE * someRoutineInsideService()\n{\n    DWORD err;\n    BYTE*    pbEncryptedBlob = NULL;\n    DWORD    cbEncryptedBlob;\n    BYTE* pbDecryptedMessage = NULL;\n    DWORD cbDecryptedMessage;\n    pbEncryptedBlob = malloc(BUF_SZ);\n    cbEncryptedBlob = BUF_SZ;\n\n    /**** read pbEncryptedBlob from file ****/\n\n    pbDecryptedMessage = malloc(BUF_SZ);\n    cbDecryptedMessage = BUF_SZ;\n    /**** code below ****/\n    err = myDecryptMessage(\"MY\", pbEncryptedBlob, cbEncryptedBlob, pbDecryptedMessage, &amp;cbDecryptedMessage);\n    if (err != 0)\n        goto cleanup;\ncleanup:\n    if (pbEncryptedBlob)\n        free(pbEncryptedBlob);\n    return(pbDecryptedMessage);\n}\n\nDWORD myDecryptMessage(LPSTR cStore, BYTE *pbEncryptedBlob, DWORD cbEncryptedBlob, BYTE *pbDecryptedMessage, DWORD *cbDecryptedMessage)\n{\n    HCERTSTORE CertStoreArray[1];\n    CRYPT_DECRYPT_MESSAGE_PARA  DecryptParams;\n    DWORD  DecryptParamsSize = sizeof(DecryptParams);\n    HCRYPTPROV hCryptProv = 0;                      // CSP handle\n    HCERTSTORE hStoreHandle = 0;\n    DWORD err = 0;\n    BOOL rc;\n    rc = CryptAcquireContext(\n        &amp;hCryptProv,        // Address for handle to be returned.\n        NULL,               // Use the current user's logon name.\n        NULL,               // Use the default provider.\n        PROV_RSA_FULL,      // Need to both encrypt and sign.\n        0);              // No flags needed.\n    if (!rc)\n    {\n        err = GetLastError();\n        goto cleanup;\n    }\n    hStoreHandle = CertOpenSystemStore(hCryptProv, cStore);\n    if (hStoreHandle == NULL)\n    {\n        err = GetLastError();\n        goto cleanup;\n    }\n    CertStoreArray[0] = hStoreHandle;\n    memset(&amp;DecryptParams, 0, DecryptParamsSize);\n    DecryptParams.cbSize = DecryptParamsSize;\n    DecryptParams.dwMsgAndCertEncodingType = (PKCS_7_ASN_ENCODING | X509_ASN_ENCODING);\n    DecryptParams.cCertStore = 1;\n    DecryptParams.rghCertStore = CertStoreArray;\n    rc = CryptDecryptMessage(\n              &amp;DecryptParams,\n              pbEncryptedBlob,\n              cbEncryptedBlob,\n              pbDecryptedMessage,\n              cbDecryptedMessage,\n              NULL);\n    if (!rc)\n    {\n        err = GetLastError();    \n        /**** returns 0x8009200C (CRYPT_E_NO_DECRYPT_CERT) if service run under LSA ****/\n        goto cleanup;\n    }\ncleanup:\n    if(hCryptProv)\n        rc = CryptReleaseContext(hCryptProv,0);\n    return(err);\n}\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1553029471, "post_id": 55249792, "comment_id": 97232570, "body": "Note also that TabPart.nom[20] is out of bounds, and even assigning a char to it will cause an error."}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 2, "last_activity_date": 1553029477, "last_edit_date": 1553029477, "creation_date": 1553028746, "answer_id": 55249792, "question_id": 55249753, "link": "https://stackoverflow.com/questions/55249753/struct-erreur-while-assigning-a-char/55249792#55249792", "title": "struct erreur while assigning a char", "body": "<pre><code>TabPart[0].nom[20]=\"alami\";\n</code></pre>\n\n<p>You should replace this by</p>\n\n<pre><code>strcpy(TabPart[0].nom, \"alami\");\n</code></pre>\n\n<p>TabPart.nom[0] is a <code>char</code>, while \"alami\" is a <code>char*</code> (i.e. a <code>pointer to a char</code>).</p>\n\n<p>You cannot assign to a <code>char</code> a <code>pointer to a char</code>, as they are not compatible.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 11047629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QCW92.png?s=128&g=1", "display_name": "Cathal O&#39;Callaghan", "link": "https://stackoverflow.com/users/11047629/cathal-ocallaghan"}, "is_accepted": false, "score": 1, "last_activity_date": 1553029350, "creation_date": 1553029350, "answer_id": 55249937, "question_id": 55249753, "link": "https://stackoverflow.com/questions/55249753/struct-erreur-while-assigning-a-char/55249937#55249937", "title": "struct erreur while assigning a char", "body": "<p>You cant just assign a char in a struct with an = sign. You need to use a function like strcpy to copy it into the char array.</p>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": true, "score": 1, "last_activity_date": 1553030002, "last_edit_date": 1553030002, "creation_date": 1553029536, "answer_id": 55249979, "question_id": 55249753, "link": "https://stackoverflow.com/questions/55249753/struct-erreur-while-assigning-a-char/55249979#55249979", "title": "struct erreur while assigning a char", "body": "<p>You are attempting to assign a <code>char *</code> to an element of a char array, which is not what you want to do.  You could use strcpy to copy it into the array, or you can instead initialize the character array with a string literal.</p>\n\n<pre><code>typedef struct\n{\n  char nom[20];\n  char prenom[30];\n  int dej;\n  int din;\n  int hot;\n  int num;\n}Participant;\n\nParticipant TabPart[10] = {{\"alami\", \"iliass\", 0, 1, 2, 1}};\n</code></pre>\n\n<p>Alternatively, you can use a designated initializer to be more explicit about what each field is:</p>\n\n<pre><code>Participant TabPart[10] = {{ .nom = \"alami\", .prenom = \"iliass\", .dej = 0,\n        .din = 1, .hot = 2, .num = 1}};\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10022643, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_C0yyBqJTIM/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3aujmZJ-zlsrP47VGwg-5sPxnyHA/mo/photo.jpg?sz=128", "display_name": "iliass dahman", "link": "https://stackoverflow.com/users/10022643/iliass-dahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55249979, "answer_count": 3, "score": 1, "last_activity_date": 1553030002, "creation_date": 1553028581, "last_edit_date": 1553029838, "question_id": 55249753, "link": "https://stackoverflow.com/questions/55249753/struct-erreur-while-assigning-a-char", "title": "struct erreur while assigning a char", "body": "<p>I have this error :</p>\n\n<blockquote>\n  <p>warning: assignment makes integer from pointer without a cast <code>[-Wint-conversion]</code>\n  <code>TabPart[0].nom[20]=\"alami\";</code></p>\n</blockquote>\n\n<p>while compiling this code :</p>\n\n<pre><code>typedef struct\n{\n  char nom[20];\n  char prenom[30];\n  int dej;\n  int din;\n  int hot;\n  int num;\n}Participant;\n\nParticipant TabPart[10];\nTabPart[0].nom[20]=\"alami\";\nTabPart[0].prenom[30]=\"iliass\";\nTabPart[0].dej=0;\nTabPart[0].din=1;\nTabPart[0].hot=2;\nTabPart[0].num=1;\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1553028368, "post_id": 55249675, "comment_id": 97232102, "body": "Not sure why DVed. It&#39;s a good question."}, {"owner": {"reputation": 185, "user_id": 6226201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1fe643279bcdb12775babdbfec6a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey Kocin", "link": "https://stackoverflow.com/users/6226201/bailey-kocin"}, "edited": false, "score": 0, "creation_date": 1553028376, "post_id": 55249675, "comment_id": 97232108, "body": "Why not run it?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 185, "user_id": 6226201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1fe643279bcdb12775babdbfec6a8a?s=128&d=identicon&r=PG&f=1", "display_name": "Bailey Kocin", "link": "https://stackoverflow.com/users/6226201/bailey-kocin"}, "edited": false, "score": 3, "creation_date": 1553028396, "post_id": 55249675, "comment_id": 97232117, "body": "@BaileyKocin Because it won&#39;t prove anything."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1553028402, "post_id": 55249675, "comment_id": 97232119, "body": "b/c one compiler&#39;s behavior does not prove anything about the standard."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553028507, "post_id": 55249675, "comment_id": 97232165, "body": "To the question - yes, this code is safe."}, {"owner": {"reputation": 27, "user_id": 11228634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87d281b470c554c266693d3e079e15?s=128&d=identicon&r=PG&f=1", "display_name": "TheGreatestWizard", "link": "https://stackoverflow.com/users/11228634/thegreatestwizard"}, "edited": false, "score": 0, "creation_date": 1553029306, "post_id": 55249675, "comment_id": 97232507, "body": "I&#39;m clear now, thank you all for the fast response!"}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 1, "creation_date": 1553029592, "post_id": 55249675, "comment_id": 97232613, "body": "I would definitely make the function signature <code>const char* getStr()</code>.  It is undefined behavior if you ever attempt to modify the string literal."}, {"owner": {"reputation": 27, "user_id": 11228634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87d281b470c554c266693d3e079e15?s=128&d=identicon&r=PG&f=1", "display_name": "TheGreatestWizard", "link": "https://stackoverflow.com/users/11228634/thegreatestwizard"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1553030572, "post_id": 55249675, "comment_id": 97232961, "body": "@AShelly Yes, that&#39;s a good habit. Thanks for letting me know!"}], "owner": {"reputation": 27, "user_id": 11228634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad87d281b470c554c266693d3e079e15?s=128&d=identicon&r=PG&f=1", "display_name": "TheGreatestWizard", "link": "https://stackoverflow.com/users/11228634/thegreatestwizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1553029324, "answer_count": 0, "score": 0, "last_activity_date": 1553028503, "creation_date": 1553028224, "last_edit_date": 1553028503, "question_id": 55249675, "link": "https://stackoverflow.com/questions/55249675/since-char-pointer-string-is-saved-in-read-only-data-segment-can-we-treat-them", "closed_reason": "Duplicate", "title": "Since char pointer string is saved in read-only data segment, can we treat them as global constant?", "body": "<p>I'm new to C. I'm told that if I declare a char pointer that points to a string, the string will not be stored in stack but in a read-only shared memory area. Thus, can we treat the string as static or a global constant?(The string will never be collected unless we use free().)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nchar* getStr(void){\n    char* str = \"some string\";\n    return str;\n}\n\nint main(void){\n    char* p = getStr();\n    printf(\"Got %s\",p);\n    return 0;\n}\n</code></pre>\n\n<p>If I run the code above, is there a chance that I get a segfault error? Is the code safe to use?</p>\n\n<p>Please help, thank you all!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1553026826, "post_id": 55249321, "comment_id": 97231406, "body": "Don&#39;t use <code>&amp;</code> for strings in scanf: <code>scanf(&quot;%s&quot;, mnoz);</code>"}, {"owner": {"reputation": 3, "user_id": 11228661, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QoENVzBSS_0/AAAAAAAAAAI/AAAAAAAAAL0/6Kkrr-16zqY/photo.jpg?sz=128", "display_name": "Rabbit Sk", "link": "https://stackoverflow.com/users/11228661/rabbit-sk"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1553026886, "post_id": 55249321, "comment_id": 97231427, "body": "thank you, i will try this and will post the results."}, {"owner": {"reputation": 3, "user_id": 11228661, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QoENVzBSS_0/AAAAAAAAAAI/AAAAAAAAAL0/6Kkrr-16zqY/photo.jpg?sz=128", "display_name": "Rabbit Sk", "link": "https://stackoverflow.com/users/11228661/rabbit-sk"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1553027000, "post_id": 55249321, "comment_id": 97231478, "body": "nope, i removed &amp; and its still the same."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553027557, "post_id": 55249321, "comment_id": 97231716, "body": "You got lazy (or, more likely, careless): <code>if(strcmp(mnoz, crna) == 0)                 m = 1;             else if(strcmp(mnoz, braon))                 m = 10;             else if(strcmp(mnoz, crvena)) \u2026</code> \u2014 the first one is correct, the rest are not.  Note that if you entered <code>braon</code>, you&#39;d get <code>m == 100</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1553027685, "post_id": 55249321, "comment_id": 97231780, "body": "Incidentally, if you know about structures, the code is crying out for the use of arrays of structures \u2014 and loops.  If you only know about arrays, you could probably improve the code with arrays and loops."}, {"owner": {"reputation": 3, "user_id": 11228661, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QoENVzBSS_0/AAAAAAAAAAI/AAAAAAAAAL0/6Kkrr-16zqY/photo.jpg?sz=128", "display_name": "Rabbit Sk", "link": "https://stackoverflow.com/users/11228661/rabbit-sk"}, "edited": false, "score": 0, "creation_date": 1553027860, "post_id": 55249321, "comment_id": 97231869, "body": "ooh shoot, its just im in a hurry its 11PM and i gotta finish this by tomorow, thank you so much. I know i can improve it but as i said im in a big hurry."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553035215, "post_id": 55249321, "comment_id": 97234543, "body": "The color of the forth band is a &#39;tolerance&#39;, not a multiplier. AND you cannot put a &#39;double&#39;, like .1 into a int variable. When compiling, always enable the warnings, then fix those warnings. ( for gcc, at a minimum use; <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> ) Note: other compilers use different options to produce the same thing"}], "answers": [{"tags": [], "owner": {"reputation": 90, "user_id": 10344380, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MzKXMAWMczk/AAAAAAAAAAI/AAAAAAAADzU/C19YhMYPXZk/photo.jpg?sz=128", "display_name": "Danielr", "link": "https://stackoverflow.com/users/10344380/danielr"}, "is_accepted": true, "score": 2, "last_activity_date": 1553028217, "creation_date": 1553028217, "answer_id": 55249672, "question_id": 55249321, "link": "https://stackoverflow.com/questions/55249321/calculating-resistance-by-colors-on-the-resistor/55249672#55249672", "title": "Calculating resistance by colors on the resistor", "body": "<p>You forgot to compare with 0 to see if the string is equal:</p>\n\n<pre><code> if(strcmp(mnoz, crna) == 0)\n            m = 1;\n        else if(strcmp(mnoz, braon) == 0)\n            m = 10;\n        else if(strcmp(mnoz, crvena) == 0)\n            m = 100;\n        else if(strcmp(mnoz, narandzasta) == 0)\n            m = 1000;\n        else if(strcmp(mnoz, zuta)==0)\n            m = 10000;\n        else if(strcmp(mnoz, zelena) == 0)\n            m = 100000;\n        else if(strcmp(mnoz, plava) == 0)\n            m = 1000000;\n        else if(strcmp(mnoz, ljubicasta) == 0)\n            m = 10000000;\n        else if(strcmp(mnoz, siva) == 0)\n            m = 100000000;\n</code></pre>\n\n<p>And you declare m as int and in the final uses as double, your code corrected:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;string.h&gt;\n\nint main(){\n\n    int unos;\n    char crna[20] = \"crna\";\n    char braon[20] = \"braon\";\n    char crvena[20] = \"crvena\";\n    char narandzasta[20] =\"narandzasta\";\n    char zuta[20] = \"zuta\";\n    char zelena[20] = \"zelena\";\n    char plava[20] = \"plava\";\n    char ljubicasta[20] = \"ljubicasta\";\n    char siva[20] = \"siva\";\n    char bela[20] = \"bela\";\n    char zlatna[20] = \"zlatna\";\n    char srebrna[20] = \"srebrna\";\n\n    puts(\"Unesite broj prstenova:\");\n    scanf(\"%i\", &amp;unos);\n\n    if(unos == 5){\n\n            int c1, c2, c3, t;\n            double m=0;\n            char unos1[20] = \"\\0\";\n            int r;\n\n            puts(\"Unesi boju 1. prstena:\");\n            scanf(\"%s\", unos1);\n\n            if(strcmp(unos1, crna) == 0)\n                c1 = 0;\n            else if(strcmp(unos1, braon) == 0)\n                c1 = 1;\n            else if(strcmp(unos1, crvena) == 0)\n                c1 = 2;\n            else if(strcmp(unos1, narandzasta) == 0)\n                c1 = 3;\n            else if(strcmp(unos1, zuta) == 0)\n                c1 = 4;\n            else if(strcmp(unos1, zelena) == 0)\n                c1 = 5;\n            else if(strcmp(unos1, plava) == 0)\n                c1 = 6;\n            else if(strcmp(unos1, ljubicasta) == 0)\n                c1 = 7;\n            else if(strcmp(unos1, siva) == 0)\n                c1 = 8;\n            else if(strcmp(unos1, bela) == 0)\n                c1 = 9;\n\n            char unos2[20] = \"\\0\";\n\n            puts(\"Unesi boju 2. prstena:\");\n            scanf(\"%s\", unos2);\n\n            if(strcmp(unos2, crna) == 0)\n                c2 = 0;\n            else if(strcmp(unos2, braon) == 0)\n                c2 = 1;\n            else if(strcmp(unos2, crvena) == 0)\n                c2 = 2;\n            else if(strcmp(unos2, narandzasta) == 0)\n                c2 = 3;\n            else if(strcmp(unos2, zuta) == 0)\n                c2 = 4;\n            else if(strcmp(unos2, zelena) == 0)\n                c2 = 5;\n            else if(strcmp(unos2, plava) == 0)\n                c2 = 6;\n            else if(strcmp(unos2, ljubicasta) == 0)\n                c2 = 7;\n            else if(strcmp(unos2, siva) == 0)\n                c2 = 8;\n            else if(strcmp(unos2, bela) == 0)\n                c2 = 9;\n\n            char unos3[20] = \"\\0\";\n\n            puts(\"Unesi boju 3. prstena:\");\n            scanf(\"%s\", unos3);\n\n            if(strcmp(unos3, crna) == 0)\n                c3 = 0;\n            else if(strcmp(unos3, braon) == 0)\n                c3 = 1;\n            else if(strcmp(unos3, crvena) == 0)\n                c3 = 2;\n            else if(strcmp(unos3, narandzasta) == 0)\n                c3 = 3;\n            else if(strcmp(unos3, zuta) == 0)\n                c3 = 4;\n            else if(strcmp(unos3, zelena) == 0)\n                c3 = 5;\n            else if(strcmp(unos3, plava) == 0)\n                c3 = 6;\n            else if(strcmp(unos3, ljubicasta) == 0)\n                c3 = 7;\n            else if(strcmp(unos3, siva) == 0)\n                c3 = 8;\n            else if(strcmp(unos3, bela) == 0)\n                c3 = 9;\n\n            char mnoz[20] = \"\\0\";\n            puts(\"Unesi boju 4. prstena:\");\n            scanf(\"%s\", mnoz);\n\n            if(strcmp(mnoz, crna) == 0)\n                m = 1;\n            else if(strcmp(mnoz, braon) == 0)\n                m = 10;\n            else if(strcmp(mnoz, crvena) == 0)\n                m = 100;\n            else if(strcmp(mnoz, narandzasta) == 0)\n                m = 1000;\n            else if(strcmp(mnoz, zuta) == 0)\n                m = 10000;\n            else if(strcmp(mnoz, zelena) == 0)\n                m = 100000;\n            else if(strcmp(mnoz, plava) == 0)\n                m = 1000000;\n            else if(strcmp(mnoz, ljubicasta) == 0)\n                m = 10000000;\n            else if(strcmp(mnoz, siva) == 0)\n                m = 100000000;\n            //else if(strcmp(mnoz, bela))\n                //m = 10*10*10*10*10*10*10*10*10;\n            else if(strcmp(mnoz, zlatna))\n                m = 0.1;\n            else if(strcmp(mnoz, srebrna))\n                m = 0.01;\n\n            r = ((c1*100)+(c2*10)+(c3*1)) * m;\n            printf(\"%lf,%i\",m,r);\n\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11228661, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QoENVzBSS_0/AAAAAAAAAAI/AAAAAAAAAL0/6Kkrr-16zqY/photo.jpg?sz=128", "display_name": "Rabbit Sk", "link": "https://stackoverflow.com/users/11228661/rabbit-sk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 55249672, "answer_count": 1, "score": 0, "last_activity_date": 1611693862, "creation_date": 1553026642, "last_edit_date": 1611693862, "question_id": 55249321, "link": "https://stackoverflow.com/questions/55249321/calculating-resistance-by-colors-on-the-resistor", "title": "Calculating resistance by colors on the resistor", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;string.h&gt;\n\nint main(){\n\n    int unos;\n    char crna[20] = \"crna\";\n    char braon[20] = \"braon\";\n    char crvena[20] = \"crvena\";\n    char narandzasta[20] =\"narandzasta\";\n    char zuta[20] = \"zuta\";\n    char zelena[20] = \"zelena\";\n    char plava[20] = \"plava\";\n    char ljubicasta[20] = \"ljubicasta\";\n    char siva[20] = \"siva\";\n    char bela[20] = \"bela\";\n    char zlatna[20] = \"zlatna\";\n    char srebrna[20] = \"srebrna\";\n\n    puts(\"Unesite broj prstenova:\");\n    scanf(\"%i\", &amp;unos);\n\n    if(unos == 5){\n\n            int c1, c2, c3, m=0, t;\n            char unos1[20] = \"\\0\";\n            int r;\n\n            puts(\"Unesi boju 1. prstena:\");\n            scanf(\"%s\",&amp;unos1);\n\n            if(strcmp(unos1, crna) == 0)\n                c1 = 0;\n            else if(strcmp(unos1, braon) == 0)\n                c1 = 1;\n            else if(strcmp(unos1, crvena) == 0)\n                c1 = 2;\n            else if(strcmp(unos1, narandzasta) == 0)\n                c1 = 3;\n            else if(strcmp(unos1, zuta) == 0)\n                c1 = 4;\n            else if(strcmp(unos1, zelena) == 0)\n                c1 = 5;\n            else if(strcmp(unos1, plava) == 0)\n                c1 = 6;\n            else if(strcmp(unos1, ljubicasta) == 0)\n                c1 = 7;\n            else if(strcmp(unos1, siva) == 0)\n                c1 = 8;\n            else if(strcmp(unos1, bela) == 0)\n                c1 = 9;\n\n            char unos2[20] = \"\\0\";\n\n            puts(\"Unesi boju 2. prstena:\");\n            scanf(\"%s\", &amp;unos2);\n\n            if(strcmp(unos2, crna) == 0)\n                c2 = 0;\n            else if(strcmp(unos2, braon) == 0)\n                c2 = 1;\n            else if(strcmp(unos2, crvena) == 0)\n                c2 = 2;\n            else if(strcmp(unos2, narandzasta) == 0)\n                c2 = 3;\n            else if(strcmp(unos2, zuta) == 0)\n                c2 = 4;\n            else if(strcmp(unos2, zelena) == 0)\n                c2 = 5;\n            else if(strcmp(unos2, plava) == 0)\n                c2 = 6;\n            else if(strcmp(unos2, ljubicasta) == 0)\n                c2 = 7;\n            else if(strcmp(unos2, siva) == 0)\n                c2 = 8;\n            else if(strcmp(unos2, bela) == 0)\n                c2 = 9;\n\n            char unos3[20] = \"\\0\";\n\n            puts(\"Unesi boju 3. prstena:\");\n            scanf(\"%s\", &amp;unos3);\n\n            if(strcmp(unos3, crna) == 0)\n                c3 = 0;\n            else if(strcmp(unos3, braon) == 0)\n                c3 = 1;\n            else if(strcmp(unos3, crvena) == 0)\n                c3 = 2;\n            else if(strcmp(unos3, narandzasta) == 0)\n                c3 = 3;\n            else if(strcmp(unos3, zuta) == 0)\n                c3 = 4;\n            else if(strcmp(unos3, zelena) == 0)\n                c3 = 5;\n            else if(strcmp(unos3, plava) == 0)\n                c3 = 6;\n            else if(strcmp(unos3, ljubicasta) == 0)\n                c3 = 7;\n            else if(strcmp(unos3, siva) == 0)\n                c3 = 8;\n            else if(strcmp(unos3, bela) == 0)\n                c3 = 9;\n\n            char mnoz[20] = \"\\0\";\n            puts(\"Unesi boju 4. prstena:\");\n            scanf(\"%s\", &amp;mnoz);\n\n            if(strcmp(mnoz, crna) == 0)\n                m = 1;\n            else if(strcmp(mnoz, braon))\n                m = 10;\n            else if(strcmp(mnoz, crvena))\n                m = 100;\n            else if(strcmp(mnoz, narandzasta))\n                m = 1000;\n            else if(strcmp(mnoz, zuta))\n                m = 10000;\n            else if(strcmp(mnoz, zelena))\n                m = 100000;\n            else if(strcmp(mnoz, plava))\n                m = 1000000;\n            else if(strcmp(mnoz, ljubicasta))\n                m = 10000000;\n            else if(strcmp(mnoz, siva))\n                m = 100000000;\n            //else if(strcmp(mnoz, bela))\n                //m = 10*10*10*10*10*10*10*10*10;\n            else if(strcmp(mnoz, zlatna))\n                m = 0.1;\n            else if(strcmp(mnoz, srebrna))\n                m = 0.01;\n\n            r = ((c1*100)+(c2*10)+(c3*1)) * m;\n            printf(\"%i,%i\",m,r);\n\n    }\n\n    return 0;\n\n}\n</code></pre>\n\n<p>So everything is ok, but the variable \"m\" is always 10 and if I enter \"narandzasta\" when it asks \"Unesi boju 4. prstena:\" it should be 1000. I can translate names of ints and chars to English if needed. I am a beginner in programming (we just started learning strings).</p>\n"}, {"tags": ["c", "arrays", "function", "dynamic", "dynamic-arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1553024684, "post_id": 55248856, "comment_id": 97230422, "body": "Well.. it looks like MSVC does not support VLAs. Another good reason to switch to some standard-compliant compiler."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1553024722, "post_id": 55248856, "comment_id": 97230441, "body": "<code>struct Album *Alben = malloc(albumsize * sizeof *Alben); if(Alben) { &#47;* use Alben *&#47;; free(Alben); } else { &#47;* error *&#47; }</code>"}, {"owner": {"reputation": 196, "user_id": 11040825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3_v55N1kEZw/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpHTqYwOVBxRekjR8w5knSDvY6Ew/mo/photo.jpg?sz=128", "display_name": "Madhav Sarpal", "link": "https://stackoverflow.com/users/11040825/madhav-sarpal"}, "edited": false, "score": 0, "creation_date": 1553024918, "post_id": 55248856, "comment_id": 97230543, "body": "struct Album *Alben=(struct Album *)malloc(sizeof(struct Album)*albumsize); is what you use to get a dynamic array which has its size defined at runtime rather than compiletime."}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1553025125, "post_id": 55248856, "comment_id": 97230640, "body": "Hmmm yeah MSVC seems to use a MS-C++ Compiler which don&#39;t offers VLA .. @pmg i can not use the struct Album as pointers because I would have to refactor all other functions because the &quot;Read&quot; / &quot;Sort&quot; Function are all implementet which Array operator like .releaseYear ....."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1553025245, "post_id": 55248856, "comment_id": 97230707, "body": "@BlindRob Pointers fully support the syntax that you use for array indexing, so switching to dynamic allocation would not lead to an issue. Moreover, arrays &quot;decay&quot; to pointers when passed to functions, so you wouldn&#39;t see much difference anyway."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1553025277, "post_id": 55248856, "comment_id": 97230723, "body": "Try it @BlindRob! Replace your <code>Alben[index].releaseYear</code> by mine <code>Alben[index].releaseYear</code> :)"}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1553026162, "post_id": 55248856, "comment_id": 97231134, "body": "@dasblinkenlight sorry I have troubles with the formatting ... so lets take this function as an example <code>void sortAlbenByYearASC(struct Album yourArray[], int arraysize) { \tstruct Album tmp;  \tfor (int i = arraysize; i &gt; 1; i--) \t{ \t\tfor (int j = 0; j &lt; i - 1; j++) \t\t{ \t\t\tif (yourArray[j].releaseYear &gt; yourArray[j + 1].releaseYear) \t\t\t{ \t\t\t\ttmp = yourArray[j]; \t\t\t\tyourArray[j] = yourArray[j + 1]; \t\t\t\tyourArray[j + 1] = tmp; \t\t\t} \t\t} \t} }</code> --&gt; here I would have to replace transfer parameter to an pointer and also change the .releaseYear to an -&gt; or? .."}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "edited": false, "score": 0, "creation_date": 1553026212, "post_id": 55248856, "comment_id": 97231157, "body": "In my case this would be a big change because I have like 15 functions around this struct[] - Array :-("}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1553026404, "post_id": 55248856, "comment_id": 97231230, "body": "@BlindRob No, you would not have any problem passing a pointer for an &quot;array&quot; parameter because in C empty square brackets <code>[]</code> in parameter declaration denote a pointer anyway. Give it a try!"}, {"owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1553029568, "post_id": 55248856, "comment_id": 97232607, "body": "@dasblinkenlight ah thanks that&#39;s intressing was a nice transition .. arrays are nearlly the same as pointers ... :-) Learned alot and still standing there whit strange errors .. Project.exe has triggered a breakpoint. From this: <code>int testsize = 4; struct Album *Alben = malloc(testsize * sizeof(*Alben)); ReadFile(inputFile, Alben); printf(&quot;Unsorted Data: \\n&quot;); printAlben(Alben, testsize);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1553024813, "creation_date": 1553024813, "answer_id": 55248942, "question_id": 55248856, "link": "https://stackoverflow.com/questions/55248856/define-arraysize-using-an-int-value-from-a-function-in-c/55248942#55248942", "title": "define arraysize using an int value from a function in c", "body": "<p>Microsoft does not support any remotely modern C standards.  Variable Length Arrays were introduced in C99, but MSVC is still stuck on C89.  You will need to either just create a statically-sized array large enough to hold whatever you may need, or malloc an array of the appropriate size.</p>\n"}, {"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553024907, "post_id": 55248945, "comment_id": 97230536, "body": "@ChristianGibbons yep. And in 2019 when I say &#39;C standard&#39; I mean the C11."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1553025036, "post_id": 55248945, "comment_id": 97230595, "body": "You&#39;ll make C17 cry. :("}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553025169, "post_id": 55248945, "comment_id": 97230657, "body": "@ChristianGibbons I am very sorry to C17, how can I make it up to him?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553025529, "post_id": 55248945, "comment_id": 97230831, "body": "I find using a sufficiently modern compiler and passing in <code>-std=c17</code> usually does the trick.  Or a cookie.  My compiler at work is too old, so I usually settle for cookies."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1553025579, "post_id": 55248945, "comment_id": 97230851, "body": "Isn&#39;t it C18 yet ? :)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553025701, "post_id": 55248945, "comment_id": 97230909, "body": "@EugeneSh. wait until it turns 21! :) :) :)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553025753, "post_id": 55248945, "comment_id": 97230933, "body": "@EugeneSh. You&#39;ve got me there.  I forgot it got pushed back that far."}], "tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1553024819, "creation_date": 1553024819, "answer_id": 55248945, "question_id": 55248856, "link": "https://stackoverflow.com/questions/55248856/define-arraysize-using-an-int-value-from-a-function-in-c/55248945#55248945", "title": "define arraysize using an int value from a function in c", "body": "<p>MSVC is not a C compiler. It is a C++ compiler with some C compatibility. As far as I know, Microsoft does not provide pure C compiler.</p>\n\n<p>Since VLA (Variable length arrays) are not part of C++ standard, they are part of C standard (and optional even there) MSVC decided not to support them. You will have to use dynamic memory allocation for your array, which I admit is not very convenient.</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1553024841, "creation_date": 1553024841, "answer_id": 55248951, "question_id": 55248856, "link": "https://stackoverflow.com/questions/55248856/define-arraysize-using-an-int-value-from-a-function-in-c/55248951#55248951", "title": "define arraysize using an int value from a function in c", "body": "<p>Although C standard allows variable-length arrays (VLA) Visual Studio compilers are not fully standard-compliant (relevant <a href=\"https://stackoverflow.com/q/48615184/335858\">Q&amp;A</a>).</p>\n\n<p>However, I would discourage use of VLA in this situation even if they were supported, because sufficiently large <code>albumsize</code> may lead to undefined behavior.</p>\n\n<p>A better approach is to allocate memory dynamically, like this:</p>\n\n<pre><code>struct Album *Alben = malloc(albumsize * sizeof(*Alben));\n... // Use the allocated memory here. Once you are done, free it.\nfree(Alben);\n</code></pre>\n\n<p>Note that one important difference between <code>Alben</code>-the-pointer and <code>Alben</code>-the-array is what you get from <code>sizeof</code>: array would report the size of its data, while pointer would report the size of the pointer alone. For that reason you need to keep the value of <code>albumsize</code> around - for example, for iterating the array in a loop.</p>\n"}], "owner": {"reputation": 23, "user_id": 11156037, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DcL8aDODbwA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdwmVbG2V_XS3ZFfV63mFv2T-9zQQ/mo/photo.jpg?sz=128", "display_name": "BlindRob", "link": "https://stackoverflow.com/users/11156037/blindrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55248951, "answer_count": 3, "score": 1, "last_activity_date": 1553024841, "creation_date": 1553024364, "question_id": 55248856, "link": "https://stackoverflow.com/questions/55248856/define-arraysize-using-an-int-value-from-a-function-in-c", "title": "define arraysize using an int value from a function in c", "body": "<p>i want to make my array more flexible. My input comes from a file. I get the information of how big my array needs to be from a function. </p>\n\n<p>My Codesample looks like this:</p>\n\n<pre><code>int albumsize = getAlbumnumberFromFile(inputFile);\nstruct Album Alben[albumsize];\n</code></pre>\n\n<p>Now I have to following problem ... I can't do something like this. My IDE (Visual Studio 2017) says this Error: </p>\n\n<blockquote>\n  <p>expression must have a constant value</p>\n</blockquote>\n\n<p>Thanks \nAlex</p>\n"}, {"tags": ["c", "arrays", "copy", "malloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1553023583, "post_id": 55248622, "comment_id": 97229904, "body": "Right. <code>sizeof</code> won&#39;t help you here, you will need to keep track of the array length yourself."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1553023795, "post_id": 55248622, "comment_id": 97230004, "body": "<code>sizeof</code> of a pointer returns the size of the pointer itself, not whatever data it might point to."}, {"owner": {"reputation": 3693, "user_id": 5494721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHK5j.png?s=128&g=1", "display_name": "OznOg", "link": "https://stackoverflow.com/users/5494721/oznog"}, "edited": false, "score": 0, "creation_date": 1553024228, "post_id": 55248622, "comment_id": 97230227, "body": "if the size is not that big you could take your array on the stack, then sizeof would work"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9529088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb986ab7411eb9dd3c3050f71273e71?s=128&d=identicon&r=PG&f=1", "display_name": "MirEso", "link": "https://stackoverflow.com/users/9529088/mireso"}, "edited": false, "score": 0, "creation_date": 1553026848, "post_id": 55248754, "comment_id": 97231413, "body": "Hello, thank you very much! now i have problem of my program crashing when i try to take part of the array, then deepcopy using memcpy that part of aray to another while moving trough starting point of arrays via for cycle, where can be problem of crashing?"}], "tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": true, "score": 1, "last_activity_date": 1553023950, "creation_date": 1553023950, "answer_id": 55248754, "question_id": 55248622, "link": "https://stackoverflow.com/questions/55248622/c-array-copying/55248754#55248754", "title": "C Array copying", "body": "<p><code>sizeof</code> operator only \"works\" on arrays that are statically declared (eg: <code>double my_array[10]</code>).  Otherwise, <code>sizeof</code> returns the size of the pointer, which is not what you want.</p>\n\n<p>To properly copy a dynamically allocated array, you need to know the size of that array.  In your case, that's <code>input_array_size</code>:</p>\n\n<pre><code>memcpy(output_array_pointer, input_array_pointer, input_array_size * sizeof(double));\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9529088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcb986ab7411eb9dd3c3050f71273e71?s=128&d=identicon&r=PG&f=1", "display_name": "MirEso", "link": "https://stackoverflow.com/users/9529088/mireso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55248754, "answer_count": 1, "score": 0, "last_activity_date": 1553029365, "creation_date": 1553023480, "last_edit_date": 1553029365, "question_id": 55248622, "link": "https://stackoverflow.com/questions/55248622/c-array-copying", "title": "C Array copying", "body": "<p>I made myself an array:</p>\n\n<pre><code>double* input_array_pointer;\ninput_array_pointer = (double*)malloc(input_array_size * sizeof(double));\n\nfill_array(input_array);\n</code></pre>\n\n<p>Now I have array full of doubles.</p>\n\n<p>I need to make output array which need to be copy of input array but all I got myself is pointer pointing to input array.\n(Therefore, all the work I make on output array\u2014such as changing certain numbers\u2014 is being applied to input array.)</p>\n\n<p>Here's how I do it which is WRONG:</p>\n\n<pre><code>double* output_array_pointer;\n    output_array_pointer = (double*)malloc(array_size * sizeof(double))/*memory allocation using malloc*/\n\nmemcpy(output_array_pointer, input_array_pointer, (sizeof(input_array_pointer))+1);\n</code></pre>\n\n<p>What is the correct way to do it?</p>\n"}, {"tags": ["c", "function", "function-pointers", "typedef"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1553021230, "post_id": 55247995, "comment_id": 97228789, "body": "It can be assigned if declared as <code>fnr *t;</code>, or without needing the <code>*</code> at variable declaration time, just change the <code>typedef</code> to <code>typedef void (*fnr)(int);</code> so you can use <code>fnr t;</code> and assign it normally. That said, I&#39;m extremely unclear on your goal here. <code>typedef</code> just allows you to alias complicated things to simple names, you seem to want it to do something very different."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553021259, "post_id": 55247995, "comment_id": 97228807, "body": "<i>&quot;good use(not just creating pointers)&quot;</i> Using function typedefs for making pointer-to-function types <i>readable</i> is one of the most important uses of them, imho. <i>&quot;<code>fnr t;</code> is a useless string&quot;</i> <code>fnr t;</code> expands to <code>void t(int x);</code>. Do you know what function declarations are and what they&#39;re used for? Whether it&#39;s a good idea to use typedefs to declare functions is a different question."}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553022231, "post_id": 55247995, "comment_id": 97229276, "body": "@HolyBlackCat this is not a function declaration, this is type definition. If you declare the function with the same name it won&#39;t work"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 1, "creation_date": 1553022370, "post_id": 55247995, "comment_id": 97229348, "body": "@IlyaPakhmutov It&#39;s a function declaration, <a href=\"http://coliru.stacked-crooked.com/a/da866b146ec2150f\" rel=\"nofollow noreferrer\">see for yourself</a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553022460, "post_id": 55247995, "comment_id": 97229398, "body": "@HolyBlackCat It might be more obvious if you declare it before <code>main</code> and define after."}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "reply_to_user": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553022506, "post_id": 55247995, "comment_id": 97229422, "body": "@HolyBlackCat i seemed you just used function, but not fnr t;"}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1553022565, "post_id": 55247995, "comment_id": 97229455, "body": "You&#39;re right, it wasn&#39;t a good example. Check out this: <a href=\"http://coliru.stacked-crooked.com/a/140a93812bbe6ad6\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/140a93812bbe6ad6</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1553022588, "post_id": 55247995, "comment_id": 97229476, "body": "@IlyaPakhmutov In that example the line <code>fnr t;</code> is exactly the same as <code>void t(int x);</code> which is a function declaration."}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553022862, "post_id": 55247995, "comment_id": 97229608, "body": "@EugeneSh. This sounds convincing, yet still half useless, but thanks for clarifying :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553022916, "post_id": 55247995, "comment_id": 97229631, "body": "Well.. half useless = half useful :)"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1553022000, "post_id": 55248062, "comment_id": 97229170, "body": "Ok, that doesn&#39;t seem obvious, that I know, what fPointers are, but the question was: Was this typedef of a function is for? I know i can create pointers out of it, but C does not even have a bool in its standard, but this, obviously useless typedef is presented. But most of all, I cannot assign anything to it. The only thing it does is clarify the func pointer pass to callback functions."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 2, "creation_date": 1553022945, "post_id": 55248062, "comment_id": 97229646, "body": "@IlyaPakhmutov <i>&quot;C does not even have a bool in its standard&quot;</i> C has booleans since C11. <i>&quot;this, obviously useless typedef is presented&quot;</i> It has some uses, as the answer shows. It doesn&#39;t seem wise to me to specifically forbid typedefing function types (while allowing all other types) just because they allegedly don&#39;t have many uses."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 1, "creation_date": 1553022971, "post_id": 55248062, "comment_id": 97229661, "body": "@IlyaPakhmutov C has a Boolean type, btw... <code>_Bool</code>.  Also see the <code>&lt;stdbool.h&gt;</code> header."}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1553023162, "post_id": 55248062, "comment_id": 97229735, "body": "@Shawn I... did&#39;t even know that... why so complex why not just <code>bool</code> (rhetorical question). I guess I&#39;m old"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 3, "creation_date": 1553023502, "post_id": 55248062, "comment_id": 97229876, "body": "@IlyaPakhmutov it was only added 20 years ago, but sadly much C educational material has yet to catch up to C99, much less newer versions. C uses reserved identifiers for new keywords to avoid breaking existing code (lots of older stuff typedefed or defined <code>bool</code>) and provides a header to let you use a more conventional non-reserved name if you want: <code>_Bool</code> and <code>bool</code>, <code>_Complex</code> and <code>complex</code>, etc."}, {"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1553023707, "post_id": 55248062, "comment_id": 97229955, "body": "@Shawn at this point I find myself ignorant, because I can hardly read (because of me) and questions to teachers of prog or programmers is the only way for me to get knowledge. That&#39;s why I came up to idea of learning in-depths of a C and C++. I want to git gud :)"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 8, "last_activity_date": 1553025953, "last_edit_date": 1553025953, "creation_date": 1553021173, "answer_id": 55248062, "question_id": 55247995, "link": "https://stackoverflow.com/questions/55247995/typedef-function-and-is-it-useful/55248062#55248062", "title": "Typedef function and is it useful?", "body": "<p>You've declared <code>fnr</code> as a function type.  While a function type cannot be assigned to, a pointer to a function type can.  For example:</p>\n\n<pre><code>typedef void fnr(int x);\n\nvoid f(int x)\n{\n    printf(\"x=%d\\n\", x);\n}\n\nint main()\n{\n    fnr *t = f;\n    t(1);\n}\n</code></pre>\n\n<p>You could also define the typedef as a function pointer:</p>\n\n<pre><code>typedef void (*fnr)(int x);\n...\nfnr t = f;\n</code></pre>\n\n<p>Using a typedef for a function pointer is most useful when a function pointer is either passed to or returned from a function.  As an example, let's look at the <code>signal</code> function which does both:</p>\n\n<pre><code>  typedef void (*sighandler_t)(int);\n\n  sighandler_t signal(int signum, sighandler_t handler);\n</code></pre>\n\n<p>The second parameter to this function is a pointer to a signal handling function, and it also returns a pointer to a signal handling function.  Without the typedef, it would look like this:</p>\n\n<pre><code>void (*signal(int signum, void (*handler)(int)))(int)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 0, "creation_date": 1553023460, "post_id": 55248555, "comment_id": 97229866, "body": "because the content of a FILE is a placeholder     ` typedef struct _iobuf     {         void* _Placeholder;     } FILE;`"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "edited": false, "score": 1, "creation_date": 1553024661, "post_id": 55248555, "comment_id": 97230415, "body": "@IlyaPakhmutov: It&#39;s because the thing <code>FILE</code> aliases varies <i>widely</i> by platform.  On my SLES10 system it&#39;s <code>typedef struct _IO_FILE FILE;</code>, where <code>_IO_FILE</code> is <code>struct _IO_FILE { int _flags; char* _IO_read_ptr; char * _IO_read_end; char* _IO_read_base; ...};</code>, whereas on MaxOS it&#39;s <code>typedef struct __sFILE { unsigned char *_p; int _r; int _w; short _flags; ... } FILE;</code>."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1553024907, "last_edit_date": 1553024907, "creation_date": 1553023181, "answer_id": 55248555, "question_id": 55247995, "link": "https://stackoverflow.com/questions/55247995/typedef-function-and-is-it-useful/55248555#55248555", "title": "Typedef function and is it useful?", "body": "<p>The <code>typedef</code> facility acts primarily as an abstraction mechanism - it's used to create an alias for a type name that either hides or simplifies implementation details.  The <code>FILE</code> type in <code>stdio.h</code> is probably the canonical example in C - <code>FILE</code> is a typedef name for some other type (often a <code>struct</code> type) that stores state information for a stream.  We don't mess with a <code>FILE</code> object's contents directly - instead, we create a pointer to a <code>FILE</code> that's operated on by the various C I/O routines (<code>fopen</code>, <code>fclose</code>, <code>fread</code>, <code>fwrite</code>, <code>fscanf</code>, <code>fprintf</code>, etc.).  </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As for typedef-ing function types...</p>\n\n<p>You'll often see it used to simplify a callback declaration:</p>\n\n<pre><code>typedef void (*callback)( /* callback arguments */ );\n...\nvoid do_something( T arg1, T arg2, callback c );\n</code></pre>\n\n<p><code>callback</code> is an alias for the type \"pointer to function taking <em>some callback arguments</em> and returning <code>void</code>\".</p>\n"}], "owner": {"reputation": 149, "user_id": 11175208, "user_type": "registered", "profile_image": "https://graph.facebook.com/2283141461942567/picture?type=large", "display_name": "Ilya  Pakhmutov", "link": "https://stackoverflow.com/users/11175208/ilya-pakhmutov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 1, "closed_date": 1553028470, "accepted_answer_id": 55248062, "answer_count": 2, "score": 2, "last_activity_date": 1553028524, "creation_date": 1553020945, "last_edit_date": 1553026433, "question_id": 55247995, "link": "https://stackoverflow.com/questions/55247995/typedef-function-and-is-it-useful", "closed_reason": "Duplicate", "title": "Typedef function and is it useful?", "body": "<p>I'm studying in-depths of languages, so I can understand what's happening in code, rather than print some things and watch and see what happens.</p>\n\n<p>Recently, in search for better implementation for class function table I found myself stumbled upon this C language standard: <a href=\"http://www.iso-9899.info/wiki/Typedef_Function_Type\" rel=\"nofollow noreferrer\">http://www.iso-9899.info/wiki/Typedef_Function_Type</a></p>\n\n<p>I've tried it out and it seems working feature:</p>\n\n<pre><code>typedef void fnr(int x);\n\nmain()\n{\n    fnr t;\n}\n</code></pre>\n\n<p>This seemed a glorious day for me searching the way to pack up functions into my structure, until I realized, that  <code>fnr t;</code> is not as useful as I had intended. It can neither be assigned, nor used the proper way I wished it to be (probably lambda for C-users). It does not even exist in disassembly!</p>\n\n<p>What does this language feature do? What can it be used for besides simplifying function pointers?</p>\n"}, {"tags": ["c", "string", "recursion", "cs50", "brute-force"], "comments": [{"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1553025735, "post_id": 55247912, "comment_id": 97230924, "body": "There&#39;s a <a href=\"https://cs50.stackexchange.com/\">cs50 stack exchange site</a> if you&#39;re interested."}], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": false, "score": 1, "last_activity_date": 1553021432, "creation_date": 1553021432, "answer_id": 55248129, "question_id": 55247912, "link": "https://stackoverflow.com/questions/55247912/c-cycle-through-all-possible-lowercase-strings/55248129#55248129", "title": "C - Cycle through all possible lowercase strings", "body": "<p>You print after you return from you recursion, but you should print when the recursion has reached the end (or beginning, in your case) of the string. In other words, printing should be an alternative branch to recursing:</p>\n\n<pre><code>void stringcycler(int n, int len, char *pass)\n{\n    if (n != 0) {\n        for (pass[len - n] = 'a'; pass[len - n] &lt;= 'z'; pass[len - n]++) {            \n            stringcycler(n - 1, len, pass);\n        }\n    } else {\n        printf(\"%s \", pass);\n    }\n}\n</code></pre>\n\n<p>The <code>if</code> part constructs the strings as it recurses further down. The <code>else</code> part does something with the constructed string. (Of course, you must include <code>'z'</code> in your loop. Your original code only prints the z in the last place, because it prints after ther recursion returns, which means thet the char buffer is in a condition that wouldn't (re-)enter the loop.)</p>\n"}, {"tags": [], "owner": {"reputation": 3717, "user_id": 1215996, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ff628cd135c5f60ce0dfda4b40ac06e?s=128&d=identicon&r=PG", "display_name": "Sumit Trehan", "link": "https://stackoverflow.com/users/1215996/sumit-trehan"}, "is_accepted": false, "score": 0, "last_activity_date": 1553065634, "last_edit_date": 1553065634, "creation_date": 1553065218, "answer_id": 55255129, "question_id": 55247912, "link": "https://stackoverflow.com/questions/55247912/c-cycle-through-all-possible-lowercase-strings/55255129#55255129", "title": "C - Cycle through all possible lowercase strings", "body": "<p>Below is a generic backtracking algorithm for generating the password. The idea here is to imagine filling the slots for a given char array <code>a</code>. We will be generating the possible candidates for the given position <code>k</code> for the array <code>a</code>. I have taken the candidates as lower case ascii letters <code>a-z</code> and upper case ASCII letters <code>A-Z</code>. If you want to include other ASCII characters, just modify the construct_candidates function accordingly.\nOnce the array is filled i.e. k becomes <code>PASS_LEN</code>, we know we have generated the password, we can process it however we like, I have just printed the password here.\nThe value of PASS_LEN macro can be adjusted to generate password of any desired length.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define PASS_LEN 2\n\nstatic char* construct_candidates (char a[], int k, int *count)\n{\n    /* Lower case ASCII */\n    int min1 = 97; \n    int max1 = 122; \n\n    /* Upper case ASCII */\n    int min2 = 65; \n    int max2 = 90; \n\n    *count = (max1 - min1 + 1) + (max2 - min2 + 1); \n    char *cand = calloc(*count, sizeof(char));\n    if (cand == NULL) {\n        printf(\"malloc failed\\n\");\n        return NULL;\n    }   \n    int idx = 0;\n    for (int i = min1; i &lt;= max1; i++) {\n        cand[idx] = i;\n        idx++;\n    }   \n    for (int i = min2; i &lt;= max2; i++) {\n        cand[idx] = i;\n        idx++;\n    }   \n\n    return cand;\n}\n\nstatic void backtrack(char a[], int k)\n{\n    int i;\n    if (k == PASS_LEN) {\n        for (i = 0; i &lt; PASS_LEN; i++) {\n            printf(\"%c\", a[i]);\n        }   \n        printf(\"\\n\");\n        return;\n    }   \n\n    int cand_count = 0;\n    char *cand = construct_candidates(a, k, &amp;cand_count);\n    if (cand == NULL) {\n        printf(\"Failed to get candidates\\n\");\n        return;\n    }   \n    for (i = 0; i &lt; cand_count; i++) {\n        a[k] = cand[i];\n        backtrack(a, k + 1); \n    }\n    free(cand);\n}\n\nint main()\n{\n    char a[PASS_LEN] = {'\\0'};\n    backtrack(a, 0); \n}\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 11227857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6699c10e897e48d631ea343533b36589?s=128&d=identicon&r=PG&f=1", "display_name": "gazm2k5", "link": "https://stackoverflow.com/users/11227857/gazm2k5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555611401, "creation_date": 1553020571, "last_edit_date": 1555611401, "question_id": 55247912, "link": "https://stackoverflow.com/questions/55247912/c-cycle-through-all-possible-lowercase-strings", "title": "C - Cycle through all possible lowercase strings", "body": "<p>I'm learning C with the CS50 course problem set 2, using the crypt function to brute force guess a password. Currently writing a function that prints all possible strings of a certain length, eg:</p>\n\n<pre><code>aa\nab\n...\naz\nba\n...\nzy\nzz\n</code></pre>\n\n<p>I've written a fairly simple recursive function to do so:</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;crypt.h&gt;\n#include &lt;string.h&gt;\n\nvoid stringcycler(int n, int passLength, char *pass)\n// Scrolls through all lowercase letter combinations for a string of length passLength\n// Expects an integer value of the length of the strng as both n and passLength\n// Also expects a char* array of length passLength with all chars set to 'a' (and a null character)\n{\n    if(n != 0)\n    {\n        for(pass[passLength - n] = 'a'; pass[passLength - n] &lt; 'z'; pass[passLength - n]++)\n        {            \n            stringcycler(n-1, passLength, pass);\n            printf(\"%s\\n\", pass);\n            // return 0;\n        }\n    }\n}\n\n\nint main()\n{    \n    // Initialise char *c, and scroll through letters\n    int passLength = 2; // The number of characters you want to brute force guess\n    char pass[passLength + 1]; //  Add 1 for the null character\n    int i;\n\n    for(i = 0; i &lt; passLength; i++) pass[i] = 'a'; // Set every char in pass to 'a'\n    pass[passLength] = '\\0'; // Set null character at the end of string\n\n    stringcycler(passLength, passLength, pass);\n\n    return 0;\n}\n</code></pre>\n\n<p>It works for the most part, but only goes to yz. Whenever it sees a z it basically skips, so it goes to yz, then never does za to zz. If I add an = to the for loop line:</p>\n\n<pre><code>pass[passLength - n] &lt; 'z';\n</code></pre>\n\n<p>ie.</p>\n\n<pre><code>pass[passLength - n] &lt;= 'z';\n</code></pre>\n\n<p>Then it prints '{' characters in the mix. Any help? And another question is, how can I change this to work for all combos of upper and lower case too, is there a neat way of doing it?</p>\n"}, {"tags": ["c", "c-preprocessor", "c11"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1553020623, "post_id": 55247506, "comment_id": 97228501, "body": "You can obtain the preprocessed source by passing the <code>-E</code> flag to <code>gcc</code>.  I think that you will confirm this way that the problem does not arise from the preprocessor mixing up macro arguments."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1553021561, "post_id": 55247506, "comment_id": 97228938, "body": "Note also that generic selection is logically a feature of the base language, not dependent on the preprocessor, though it doesn&#39;t make much sense to use it outside a macro.  In code such as yours, expansion of the macro by the preprocessor leaves generic selection expressions in the resulting C code for the next translation stage to handle."}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 0, "creation_date": 1553022933, "post_id": 55247506, "comment_id": 97229639, "body": "Related: <a href=\"https://stackoverflow.com/a/24746034/5754656\">stackoverflow.com/a/24746034/5754656</a>"}], "answers": [{"comments": [{"owner": {"reputation": 518, "user_id": 4637938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtHFq.png?s=128&g=1", "display_name": "bd2357", "link": "https://stackoverflow.com/users/4637938/bd2357"}, "edited": false, "score": 0, "creation_date": 1553023731, "post_id": 55248524, "comment_id": 97229971, "body": "Thanks Just saw it myself, I was considering a no-op of some sort but I really wanted the compile to fail if the incorrect types were used."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1553023757, "post_id": 55248524, "comment_id": 97229985, "body": "And this is one of the reasons it matters that generic selection is part of the language syntax, not a form of macro expansion.  All of the expressions involved must conform to the language requirements, and those include that the argument expression to a generic selection be matchable, by type, to one of the generic associations.  This is a <i>constraint</i>, no less.  That such an expression is not <i>evaluated</i> matters not a whit."}], "tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": true, "score": 6, "last_activity_date": 1553023011, "creation_date": 1553023011, "answer_id": 55248524, "question_id": 55247506, "link": "https://stackoverflow.com/questions/55247506/c-macro-generic-gives-unexpected-compiler-error/55248524#55248524", "title": "C macro _Generic gives unexpected compiler error", "body": "<p>The problem is that every branch of a generic selection must be valid, even if they are not evaluated.</p>\n\n<p>For example, your first macro:</p>\n\n<pre><code>bob(i1, s1)\n</code></pre>\n\n<p>Expands to (types added for clarity):</p>\n\n<pre><code>_Generic( ((int32_t) i1),\n  int32_t: _Generic( ((int16_t) s1),\n    int16_t: \"s-l\",\n    int8_t:  \"c-l\" ),\n  int16_t: _Generic( ((int16_t) s1),  // The error is here\n    int32_t: \"l-s\",\n    int8_t:  \"c-s\"),\n  int8_t:_Generic( ((int16_t) s1),\n    int32_t: \"l-c\",\n    int16_t: \"s-c\")\n)\n</code></pre>\n\n<p>Obviously the <code>uint32_t</code> branch is valid: It just selects <code>\"s-l\"</code>. But the <code>int16_t</code> branch is <em>not</em> valid, as <code>from</code> (An <code>int16_t</code> itself) does not have a corresponding branch.</p>\n\n<p>In this particular scenario, it wouldn't hurt to add a self-conversion operator that does nothing. </p>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 4637938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtHFq.png?s=128&g=1", "display_name": "bd2357", "link": "https://stackoverflow.com/users/4637938/bd2357"}, "is_accepted": false, "score": 2, "last_activity_date": 1553107438, "last_edit_date": 1553107438, "creation_date": 1553023566, "answer_id": 55248641, "question_id": 55247506, "link": "https://stackoverflow.com/questions/55247506/c-macro-generic-gives-unexpected-compiler-error/55248641#55248641", "title": "C macro _Generic gives unexpected compiler error", "body": "<p>A-Ha Moment, Thanks to John Bollinger in comments.</p>\n\n<p>If I Hand expand the Macro into code:</p>\n\n<pre><code>void main(void)\n{\n    int32_t i1;\n    int16_t s1;\n    int8_t  c1;\n\n    printf(\"%s\\n\", \n    _Generic( i1 , int32_t: _Generic(s1, int16_t: \"s-l\", int8_t: \"c-l\" ), \n                   int16_t: _Generic(s1, int32_t: \"l-s\", int8_t: \"c-s\" ),   // &lt;-- No int16_t here\n                   int8_t:  _Generic(s1, int32_t: \"l-c\", int16_t: \"s-c\") ) );\n\n}\n</code></pre>\n\n<p>It becomes obvious that this will not compile unless the paths not taken are stripped out which I guess is not what happens. </p>\n\n<p>So I guess default case to error condition is the correct method?</p>\n\n<p>Edit: So I still have not figured out how to get the default case to throw a compiler error, however I discovered if I put a call in the default case to a non-existant function it will compile but will throw a linker error if I violate the rule I was trying to enforce.  Not great but better than a runtime error.</p>\n\n<pre><code>char *this_function_does_not_exist(); // fake function prototype\n#define bob( to, from ) \\\n    _Generic( to , \\\n    int32_t: _Generic(from,  \\\n      default: this_function_does_not_exist(), \\\n      int16_t: \"s-l\", \\\n      int8_t:  \"c-l\" ) , \\\n    int16_t: _Generic(from, \\\n      default: this_function_does_not_exist(), \\\n      int32_t: \"l-s\", \\\n      int8_t:  \"c-s\") , \\\n    int8_t:_Generic(from, \\\n      default: this_function_does_not_exist(), \\\n      int32_t: \"l-c\",  \\\n      int16_t: \"s-c\")  \\\n    )\n</code></pre>\n\n<p>If anyone who reads this has a better, C11, way to in effect embed a _Static_assert inside a _Generic let me know.  (I know I can embed a _Generic inside a _Static_assert, it just gets really ugly and I don't want to maintain duplicate logic)</p>\n"}], "owner": {"reputation": 518, "user_id": 4637938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtHFq.png?s=128&g=1", "display_name": "bd2357", "link": "https://stackoverflow.com/users/4637938/bd2357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 2, "accepted_answer_id": 55248524, "answer_count": 2, "score": 7, "last_activity_date": 1553107682, "creation_date": 1553019155, "last_edit_date": 1553107682, "question_id": 55247506, "link": "https://stackoverflow.com/questions/55247506/c-macro-generic-gives-unexpected-compiler-error", "title": "C macro _Generic gives unexpected compiler error", "body": "<p>Using gcc.exe (Rev3, Built by MSYS2 project) 8.2.0.</p>\n\n<p>I was trying to build a macro to automatically do type conversions between two types, where the two parameters should never be the same type. My problem is the compiler throws an error if I don't also include the same type case.\nWhat I wanted:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n// Macro to return string based on two different types\n#define bob( to, from ) \\\n    _Generic( to , \\\n    int32_t: _Generic(from,  \\\n      int16_t: \"s-l\", \\\n      int8_t:  \"c-l\" ) , \\\n    int16_t: _Generic(from, \\\n      int32_t: \"l-s\", \\\n      int8_t:  \"c-s\") , \\\n    int8_t:_Generic(from, \\\n      int32_t: \"l-c\",  \\\n      int16_t: \"s-c\")  \\\n    )\n\n    void main(void)\n    {\n        int32_t i1;\n        int16_t s1;\n        int8_t  c1;\n\n        printf(\"%s\\n\", bob(i1,s1));\n        printf(\"%s\\n\", bob(i1,c1));\n        printf(\"%s\\n\", bob(s1,c1));\n        printf(\"%s\\n\", bob(s1,i1));\n        printf(\"%s\\n\", bob(c1,s1));\n        printf(\"%s\\n\", bob(c1,s1));\n\n    }\n</code></pre>\n\n<p></p>\n\n<pre><code>$ gcc gbug.c -o gbug.exe\ngbug.c: In function 'main':\ngbug.c:23:27: error: '_Generic' selector of type 'short int' is not compatible with any association\n     printf(\"%s\\n\", bob(i1,s1));\n                           ^~\ngbug.c:9:19: note: in definition of macro 'bob'\n int16_t: _Generic(from, \\\n                   ^~~~\ngbug.c:24:27: error: '_Generic' selector of type 'signed char' is not compatible with any association\n     printf(\"%s\\n\", bob(i1,c1));\n                           ^~\ngbug.c:12:17: note: in definition of macro 'bob'\n int8_t:_Generic(from, \\\n                 ^~~~\ngbug.c:25:27: error: '_Generic' selector of type 'signed char' is not compatible with any association\n     printf(\"%s\\n\", bob(s1,c1));\n                           ^~\ngbug.c:12:17: note: in definition of macro 'bob'\n int8_t:_Generic(from, \\\n                 ^~~~\ngbug.c:26:27: error: '_Generic' selector of type 'int' is not compatible with any association\n     printf(\"%s\\n\", bob(s1,i1));\n                           ^~\ngbug.c:6:19: note: in definition of macro 'bob'\n int32_t: _Generic(from,  \\\n                   ^~~~\ngbug.c:27:27: error: '_Generic' selector of type 'short int' is not compatible with any association\n     printf(\"%s\\n\", bob(c1,s1));\n                           ^~\ngbug.c:9:19: note: in definition of macro 'bob'\n int16_t: _Generic(from, \\\n                   ^~~~\ngbug.c:28:27: error: '_Generic' selector of type 'short int' is not compatible with any association\n     printf(\"%s\\n\", bob(c1,s1));\n                           ^~\ngbug.c:9:19: note: in definition of macro 'bob'\n int16_t: _Generic(from, \\\n</code></pre>\n\n<p>This example is the simplest that I have found that will fail.</p>\n\n<p>If I add in the \"same type\" conversion lines like this:</p>\n\n<pre><code>#define bob( to, from ) \\\n_Generic( to , \\\nint32_t: _Generic(from,  \\\n  int16_t: \"s-l\", \\\n  int32_t: \"bug\", \\\n  int8_t: \"c-l\" ) , \\\nint16_t: _Generic(from, \\\n  int32_t: \"l-s\", \\\n  int16_t: \"bug\", \\\n  int8_t: \"c-s\") , \\\nint8_t:_Generic(from, \\\n  int32_t: \"l-c\",  \\\n  int8_t: \"bug\", \\\n  int16_t: \"s-c\")  \\\n)\n</code></pre>\n\n<p>It build and runs with the expected result:</p>\n\n<pre><code>$ ./gbug.exe\ns-l\nc-l\nc-s\nl-s\ns-c\ns-c\n</code></pre>\n\n<p>verifying that I am not using the macro to expand any same type conditions.\nI understand _Generic is not a string substitution macro but I also thought that if you could use it without a default case it would correctly throw a compile error if you used an unknown type (or an unsupported combination of types, which is the behaviour I wanted)\nIt is like the pre-processor is getting the two macro parameters mixed up.</p>\n\n<p>Edit: So I have a better understanding, (See my answer below) but still looking to get the macro to throw a compile error if the two parameters are the same type. So far I have a trick to force a link error which is still better than a runtime error.</p>\n"}, {"tags": ["java", "c", "unix", "process"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1553019174, "post_id": 55247479, "comment_id": 97227755, "body": "<a href=\"https://stackoverflow.com/q/3075682\">stackoverflow.com/q/3075682</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1553020020, "post_id": 55247479, "comment_id": 97228176, "body": "I believe there is no nice way for this. You could use something hackish, like starting <code>bash -c &quot;exec -a foo &#47;bin&#47;sleep 100&quot;</code>, which should do about what you want"}, {"owner": {"reputation": 522, "user_id": 2767099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194d258f1349e17e10d500066107e59f?s=128&d=identicon&r=PG&f=1", "display_name": "rainhacker", "link": "https://stackoverflow.com/users/2767099/rainhacker"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1553522303, "post_id": 55247479, "comment_id": 97404057, "body": "@Ctx : This worked for me. I can accept it if you can post your comment as an answer. Feel free to add this line to your answer : <code>new ProcessBuilder(&quot;bash&quot;, &quot;-c&quot;, &quot;exec -a newProcessName startProcessCommand&quot;)</code>"}], "owner": {"reputation": 522, "user_id": 2767099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194d258f1349e17e10d500066107e59f?s=128&d=identicon&r=PG&f=1", "display_name": "rainhacker", "link": "https://stackoverflow.com/users/2767099/rainhacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553019055, "creation_date": 1553019055, "question_id": 55247479, "link": "https://stackoverflow.com/questions/55247479/change-process-name-of-c-child-process-started-by-java-parent-process", "title": "Change process name of &#39;C&#39; child process started by Java parent process", "body": "<p>I have a Java process which starts a subprocess using ProcessBuilder.java. The subprocess is a third party binary, written in C. Is there a way to change the default name of the child process which is printed in ps command output in Linux? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1553019187, "post_id": 55247475, "comment_id": 97227765, "body": "Tip: Don&#39;t sprinkle numbers like <code>1000</code> through your code, instead <code>#define</code> a constant or have a variable that defines this."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1553020172, "post_id": 55247475, "comment_id": 97228250, "body": "The function instantiation at the point of the first <code>return</code> ceases so you aren&#39;t actually returning both lines with <code>return puts(line1);</code> followed by <code>return puts(line2);</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1553020213, "post_id": 55247475, "comment_id": 97228266, "body": "It makes no sense to return <code>puts(line1)</code>, and it makes even sense to try to return <code>puts(line2)</code> afterwards."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1553020325, "post_id": 55247475, "comment_id": 97228332, "body": "@bigwillydos And <code>puts</code> doesn&#39;t return lines anyway."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1553020364, "post_id": 55247475, "comment_id": 97228352, "body": "Is the function supposed to return the first line from the first file that differs, or from the second file, or both?"}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1553020441, "post_id": 55247475, "comment_id": 97228402, "body": "@SteveSummit yep, but he&#39;s new here tho and likely new to C programming so figured I&#39;d just comment on what I saw as the bigger misconception between those two"}, {"owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1553020492, "post_id": 55247475, "comment_id": 97228433, "body": "@SteveSummit The function is supposed to return both lines"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1553026194, "post_id": 55247475, "comment_id": 97231149, "body": "Check what <code>fgets</code> returns... It doesn&#39;t return <code>EOF</code> ever. Doesn&#39;t your compiler give you a warning? Turn on warnings (<code>-Wall -Wextra</code> is good for <i>gcc</i> and <i>clang</i>, for example) and <i>fix them</i> as first step."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1553027025, "post_id": 55247475, "comment_id": 97231491, "body": "&quot;return,&quot; you keep using that word. I do not think it means what you think it means. <a href=\"https://en.cppreference.com/w/cpp/language/return\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/language/return</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1553092286, "post_id": 55247475, "comment_id": 97257721, "body": "@L0KiZ When you say the function is supposed to return both lines, did you mean it is supposed to print out both lines?"}, {"owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1553093596, "post_id": 55247475, "comment_id": 97258776, "body": "@SteveSummit Yes, for example if in file1 contains text: &quot;Hello&quot; and for file2 &quot;Hi&quot;. Program should print &quot;Hello&quot; -- &quot;Hi&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": true, "score": 0, "last_activity_date": 1553095212, "creation_date": 1553095212, "answer_id": 55264316, "question_id": 55247475, "link": "https://stackoverflow.com/questions/55247475/c-function-to-find-lines-that-differ-from-each-other/55264316#55264316", "title": "C function to find lines that differ from each other", "body": "<p>Yeah that doesn't work so good. Here are the bugs:</p>\n\n<pre><code>return -1;\n</code></pre>\n\n<p>Does not compile. Did you mean</p>\n\n<pre><code>return (char*)-1;\n</code></pre>\n\n<p>Also, leaks memory. Do:</p>\n\n<pre><code> if (f1) fclose(f1);\n if (f2) fclose(f2);\n return (char*)-1;\n</code></pre>\n\n<p>Oops you read from <code>file1</code> twice:</p>\n\n<pre><code>while (fgets(line1, sizeof(line1), file1) != NULL &amp;&amp; fgets(line2, sizeof(line2), file1) != NULL)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>while (fgets(line1, sizeof(line1), file1) != NULL &amp;&amp; fgets(line2, sizeof(line2), file2) != NULL)\n</code></pre>\n\n<p>Memory trashing:</p>\n\n<pre><code>line3=strcat(line1,line2);\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>strcat(strcpy(a,line1),line2);\n</code></pre>\n\n<p>Only ever checks first line because early return:</p>\n\n<pre><code>else\n{\n    return NULL;\n}\n</code></pre>\n\n<p>Just eliminate that block.</p>\n\n<p>Oops forgot to check for errors:</p>\n\n<pre><code>char* diff = difference(\"testifile.c\", \"testifile2.c\");\n\nchar* diff = difference(\"testifile.c\", \"testifile2.c\");\nif (diff == (char *)-1) {\n    /* handle file open error */\n}\nelse if (diff == NULL) {\n    /* handle no difference */\n}\nelse {\n     /* your message */\n     free(diff);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 55264316, "answer_count": 1, "score": 0, "last_activity_date": 1553095212, "creation_date": 1553019051, "last_edit_date": 1553093878, "question_id": 55247475, "link": "https://stackoverflow.com/questions/55247475/c-function-to-find-lines-that-differ-from-each-other", "title": "C function to find lines that differ from each other", "body": "<p>I am trying to implement the function that compares two files. The function should restore the first lines that differ from each other. If the files are the same, NULL will be returned. The function ends as soon as either of the files ends, and then NULL is returned. I think my if functions doesn't work and so on this function don't return the lines.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>char *difference(const char* file1, const char* file2)\n{\n    char line1[1000];\n    char line2[1000];\n    char *a = malloc(1000 * sizeof(char));\n\n    FILE *f1 = fopen(file1, \"r\");\n    FILE *f2 = fopen(file2, \"r\");\n    if (!f1 || !f2) // checking if there is any error \n    {\n        return -1; \n    }\n\n    while (fgets(line1, sizeof(line1), file1) != NULL &amp;&amp; fgets(line2, sizeof(line2), file1) != NULL)\n{\n    if (strcmp(line1, line2) != 0)\n    {\n        strcpy(a, line1);\n        strcpy(a, line2);\n\n    }\n    else\n    {\n        return NULL;\n    }\n}\n\nfclose(f1);\nfclose(f2);\nreturn a;\n\nint main(void)\n\n    char* diff = difference(\"testifile.c\", \"testifile2.c\");\n    printf(\"\\n--- Difference:\\n\");\n    printf(\"%s\", diff);\n\n    free(diff);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1553018836, "post_id": 55247386, "comment_id": 97227595, "body": "Please check the return value from <code>scanf</code> which in this case must be <code>1</code> and <code>2</code> respectively in the first and second call."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1553018933, "post_id": 55247386, "comment_id": 97227647, "body": "If you skip the <code>scanf</code> part and just use <a href=\"https://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> you can read in one character at a time and parse this in a more generic way."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553018955, "post_id": 55247386, "comment_id": 97227654, "body": "What is it supposed to do with letters?"}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553019141, "post_id": 55247386, "comment_id": 97227734, "body": "@EugeneSh. If I use letters, it gives answer f.e: &quot;0.00 + 0.00 = 0.00&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553019182, "post_id": 55247386, "comment_id": 97227760, "body": "Note that <code>scanf(&quot;%lf %lf&quot;,&amp;s, &amp;b);</code> is expecting pointers to <code>double s, b;</code> variables but you defined <code>int a, b;</code> Is this the exact code?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553019224, "post_id": 55247386, "comment_id": 97227786, "body": "Ah, I see. I thought you want it to work with letters somehow as well."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1553019226, "post_id": 55247386, "comment_id": 97227788, "body": "Is <code>&amp;s</code> a typo? I assume you meant <code>&amp;a</code>. But <code>a</code> and <code>b</code> are type <code>int</code> and the <code>%lf</code> in the <code>scanf</code> call expects <code>a</code> and <code>b</code> to be type <code>double</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553019293, "post_id": 55247386, "comment_id": 97227825, "body": "After the edit, you still have the wrong variable type, or format specifier (or both??) Don&#39;t you get a compiler warning?"}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1553019297, "post_id": 55247386, "comment_id": 97227829, "body": "@IanAbbott Thanks, it was a typo."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1553019419, "post_id": 55247386, "comment_id": 97227894, "body": "If <code>scanf</code> does not return 2 for the second case (two <code>double</code>s), you should report an error as that means the input to the program is invalid. Similarly for the first case (one <code>char</code>), you should check that <code>scanf</code> returned 1."}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553019465, "post_id": 55247386, "comment_id": 97227917, "body": "@WeatherVane I dont get a compiler warning. What should be the correct variable type?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553019538, "post_id": 55247386, "comment_id": 97227945, "body": "You should be using <code>double a, b;</code> Does your compiler have a warning level setting?"}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553019676, "post_id": 55247386, "comment_id": 97228020, "body": "@WeatherVane I use Dev-C++, i think there isnt a warning level setting."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553020090, "post_id": 55247386, "comment_id": 97228216, "body": "Have you tried the option <code>-Wall</code>? Or &quot;Tools - Compiler Options - Settings - Warnings&quot;."}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553021776, "post_id": 55247386, "comment_id": 97229039, "body": "@EugeneSh. If it is possible, I would like that if one of the a or b is letter, then the answer would be just a and b written together with operator. F.e: 2/s or s*9 or s+s"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1553020284, "post_id": 55247783, "comment_id": 97228307, "body": "That won&#39;t trap <code>EOF</code>. You should explicitly check the number of items to be scanned: <code>if(scanf(&quot;%c&quot;, &amp;operator) != 1)</code> In the case of the two floating point operands, you must check for <code>2</code> because the first might have a valid entry, but the second might not, in which case <code>fscanf</code> will return <code>1</code> instead of <code>2</code> which your check won&#39;t catch."}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "edited": false, "score": 0, "creation_date": 1553020575, "post_id": 55247783, "comment_id": 97228472, "body": "If I put the line you added, my code jumps straight to default and prints &quot;Error&quot; even if i put correct operator and numbers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553020659, "post_id": 55247783, "comment_id": 97228521, "body": "Whose line? Sayed&#39;s or mine?"}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553020963, "post_id": 55247783, "comment_id": 97228658, "body": "@WeatherVane Both. Where I should put the line: right after first scanf or later?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553021029, "post_id": 55247783, "comment_id": 97228687, "body": "That does not make sense: it <i>is</i> the <code>scanf</code> line."}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553021155, "post_id": 55247783, "comment_id": 97228742, "body": "@WeatherVane Can You somehow give the correct code, please?"}, {"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553021490, "post_id": 55247783, "comment_id": 97228897, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/190323/discussion-between-martin-suits-and-weather-vane\">continue this discussion in chat</a>."}, {"owner": {"reputation": 499, "user_id": 10135562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHu8H.jpg?s=128&g=1", "display_name": "Sayed Muhammad Idrees", "link": "https://stackoverflow.com/users/10135562/sayed-muhammad-idrees"}, "edited": false, "score": 0, "creation_date": 1553022521, "post_id": 55247783, "comment_id": 97229433, "body": "Sorry for the bad code. maybe you should check the updated code now."}], "tags": [], "owner": {"reputation": 499, "user_id": 10135562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHu8H.jpg?s=128&g=1", "display_name": "Sayed Muhammad Idrees", "link": "https://stackoverflow.com/users/10135562/sayed-muhammad-idrees"}, "is_accepted": false, "score": 0, "last_activity_date": 1553022535, "last_edit_date": 1553022535, "creation_date": 1553020121, "answer_id": 55247783, "question_id": 55247386, "link": "https://stackoverflow.com/questions/55247386/how-to-check-whether-the-entered-symbol-is-char-or-not/55247783#55247783", "title": "How to check whether the entered symbol is char or not?", "body": "<p><strong>UPDATED:</strong></p>\n\n<p>i found my Ooldest code in library Folder maybe it helps you in that problem. This will definitely Work.</p>\n\n<pre><code>char operator;\nprintf(\"Enter the Operation in ( * , / , - , + )\");\nscanf(\"%s\",&amp;operator);\nif(operator!='+' || operator!='-' || operator!='*' || operator!='/')\n{\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "edited": false, "score": 0, "creation_date": 1553025700, "post_id": 55248201, "comment_id": 97230908, "body": "As you know dividing by 0 cant be done. So how to make the program to give error when dividing by 0?"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 1, "last_activity_date": 1553021686, "creation_date": 1553021686, "answer_id": 55248201, "question_id": 55247386, "link": "https://stackoverflow.com/questions/55247386/how-to-check-whether-the-entered-symbol-is-char-or-not/55248201#55248201", "title": "How to check whether the entered symbol is char or not?", "body": "<p>I have made the corrections discussed in comments</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {                                            // correct definition\n\n    char operator;\n    double a,b;                                             // correct type\n\n    printf(\"Enter the operator (+, -, *, /): \");\n    if(scanf(\"%c\", &amp;operator) != 1) {                       // add error check\n        puts(\"Bad operator entered\");\n        return 1;\n    }\n\n    printf(\"Enter two number and seperate them with space: \");\n    if(scanf(\"%lf %lf\",&amp;a, &amp;b) != 2) {                      // add error check\n        puts(\"Bad value(s) entered\");\n        return 1;\n    }\n\n    switch(operator)\n    {\n        case '+':\n            printf(\"%.2lf + %.2lf = %.2lf\",a, b, a + b);\n            break;\n\n        case '-':\n            printf(\"%.2lf - %.2lf = % 2lf\",a, b, a - b);    // corrected typo\n            break;\n\n        case '*':\n            printf(\"%.2lf * %.2lf = %.2lf\",a, b, a * b);\n            break;\n\n        case '/':\n            printf(\"%.2lf / %.2lf = %.2lf\",a, b, a / b);\n            break;\n\n        default:\n            printf(\"Error!\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "is_accepted": false, "score": 0, "last_activity_date": 1553765063, "creation_date": 1553765063, "answer_id": 55394062, "question_id": 55247386, "link": "https://stackoverflow.com/questions/55247386/how-to-check-whether-the-entered-symbol-is-char-or-not/55394062#55394062", "title": "How to check whether the entered symbol is char or not?", "body": "<p>I got it working. It was easier to do than I thought.\nSo the right code, I'll put comment to answer.\n    #include </p>\n\n<pre><code>int main(void) {                                            // correct definition\n\nchar operator;\ndouble a,b;                                             // correct type\n\nprintf(\"Enter the operator (+, -, *, /): \");\nif(scanf(\"%c\", &amp;operator) != 1) {                       // add error check\n    puts(\"Bad operator entered\");\n    return 1;\n}\n\nprintf(\"Enter two number and seperate them with space: \");\nif(scanf(\"%lf %lf\",&amp;a, &amp;b) != 2) {                      // add error check\n    puts(\"Bad value(s) entered\");\n    return 1;\n}\n\nswitch(operator)\n{\n    case '+':\n        printf(\"%.2lf + %.2lf = %.2lf\",a, b, a + b);\n        break;\n\n    case '-':\n        printf(\"%.2lf - %.2lf = % 2lf\",a, b, a - b);    // corrected typo\n        break;\n\n    case '*':\n        printf(\"%.2lf * %.2lf = %.2lf\",a, b, a * b);\n        break;\n\n    case '/':\n        if(b!=0){                                    //added an if-sentence\n            printf(\"%.2lf / %.2lf = %.2lf\\n\",a, b, \n            a / b);\n        }\n        else\n            printf(\"Can't divide by zero\\n\");\n        break;\n\n\n    default:\n        printf(\"Error!\");\n}\nreturn 0;\n}\n</code></pre>\n\n<p>Basically, I just put an if-sentence to case('/').</p>\n"}], "owner": {"reputation": 85, "user_id": 8631221, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7c4a18596aec29df6ee456b918c44473?s=128&d=identicon&r=PG&f=1", "display_name": "\u0161m98", "link": "https://stackoverflow.com/users/8631221/%c5%a1m98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55248201, "answer_count": 3, "score": -2, "last_activity_date": 1553765063, "creation_date": 1553018735, "last_edit_date": 1553019252, "question_id": 55247386, "link": "https://stackoverflow.com/questions/55247386/how-to-check-whether-the-entered-symbol-is-char-or-not", "title": "How to check whether the entered symbol is char or not?", "body": "<p>I have a problem with calculator. I want to program a calculator, but it \"works\" with letters too. If I enter f.e letters \"s\" and \"u\", i get answer 0. How to repair that?  </p>\n\n<pre><code># include &lt;stdio.h&gt;\n\nint main() {\n\nchar operator;\nint a,b;\n\nprintf(\"Enter the operator (+, -, *, /): \");\nscanf(\"%c\", &amp;operator);\n\nprintf(\"Enter two number and seperate them with space: \");\nscanf(\"%lf %lf\",&amp;a, &amp;b);\n\nswitch(operator)\n{\n    case '+':\n        printf(\"%.2lf + %.2lf = %.2lf\",a, b, a + b);\n        break;\n\n    case '-':\n        printf(\"% 2lf - %.2lf = % 2lf\",a, b, a - b);\n        break;\n\n    case '*':\n        printf(\"%.2lf * %.2lf = %.2lf\",a, b, a * b);\n        break;\n\n    case '/':\n        printf(\"%.2lf / %.2lf = %.2lf\",a, b, a / b);\n        break;\n\n\n    default:\n        printf(\"Error!\");\n\n}\n\nreturn 0;\n}\n</code></pre>\n\n<p>Sorry, if the question has been up here.<br>\nThe link to answer is also appreciated!<br>\nCheers!</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1553016723, "post_id": 55246835, "comment_id": 97226522, "body": "You have a function named <code>read</code>, and you are attempting to assign a value to it as if it were a variable, and then attempting to return it as if it were a variable."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1553016788, "post_id": 55246835, "comment_id": 97226563, "body": "Note that <a href=\"https://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> returns an <code>int</code>. This is actually very crucial and important for that comparison against <code>EOF</code>."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 2, "creation_date": 1553016853, "post_id": 55246835, "comment_id": 97226588, "body": "just <code>return b</code> instead of <code>read = b; return read</code>.  But also make b an <code>int</code>."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1553016930, "post_id": 55246835, "comment_id": 97226625, "body": "And to top it all, there is a function named read other than yours."}], "answers": [{"tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 2, "last_activity_date": 1553016857, "creation_date": 1553016857, "answer_id": 55246918, "question_id": 55246835, "link": "https://stackoverflow.com/questions/55246835/why-do-i-get-this-error-and-warning-error-and-warning-is-in-the-description/55246918#55246918", "title": "Why do I get this error and warning? Error and warning is in the description", "body": "<p>The error is quite correct.\nThis line of code:</p>\n\n<pre><code>read = b;\n</code></pre>\n\n<p>attempts to assign the value of <code>b</code>, which is a <code>char</code>, to <code>read</code>, which is a function returning an <code>int</code>.</p>\n\n<p>Delete the line and just return <code>b</code>. The compiler will promote the <code>char</code> to an <code>int</code> for you. Or, better, change <code>b</code> to an <code>int</code>, because as you may not know (but as Some programmer dude pointed out above), <code>fgetc</code> returns an <code>int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 4409108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlfZM.jpg?s=128&g=1", "display_name": "rallen911", "link": "https://stackoverflow.com/users/4409108/rallen911"}, "is_accepted": true, "score": 0, "last_activity_date": 1553017831, "creation_date": 1553017831, "answer_id": 55247154, "question_id": 55246835, "link": "https://stackoverflow.com/questions/55246835/why-do-i-get-this-error-and-warning-error-and-warning-is-in-the-description/55247154#55247154", "title": "Why do I get this error and warning? Error and warning is in the description", "body": "<p>As mentioned in the first response by Christian, you are trying to assign your function name <strong><em>read</em></strong> to the value <strong><em>b</em></strong>.</p>\n\n<p>You simply need to:</p>\n\n<pre><code>return b;\n</code></pre>\n\n<p>Looking at your code, it looks like it will just return <strong><em>EOF</em></strong>, as that is the last value that <strong><em>b</em></strong> will have before you return.  Not sure why you would need to do that, so thought I would mention it.</p>\n\n<p>You could improve it a little by using a do/while like:</p>\n\n<pre><code>do\n{\n    b = fgetc(fptr);\n    printf (\"%c\", b);\n} while( b != EOF );\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11115121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8af7266daee3874f6317f2f367edc88?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Mathuse", "link": "https://stackoverflow.com/users/11115121/luca-mathuse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 55247154, "answer_count": 2, "score": -1, "last_activity_date": 1553017831, "creation_date": 1553016565, "last_edit_date": 1553016769, "question_id": 55246835, "link": "https://stackoverflow.com/questions/55246835/why-do-i-get-this-error-and-warning-error-and-warning-is-in-the-description", "title": "Why do I get this error and warning? Error and warning is in the description", "body": "<p>I have a problem that I can't fix. \nI get the error:error: non-object type 'int ()' is not assignable\n  read = b;\nAnd the warning: warning: incompatible pointer to integer conversion returning 'int ()' from a function with result type 'int' [-Wint-conversion]\n  return read;</p>\n\n<p>And I want to return the value b to main and I want to know why it doesn't work. I hope you can help me.\nHere's the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint read()\n{\n  FILE *fptr;\n  char b;\n  fptr = fopen(\"./chat.txt\",\"r\");\n\n  if(fptr == NULL)\n  {\n    printf(\"Something went wrong\");\n  }\n\n  b = fgetc(fptr);\n  while(b != EOF)\n  {\n    printf (\"%c\", b);\n    b = fgetc(fptr);\n  }\n  fclose(fptr);\n  read = b;\n\n  return read;\n} \n</code></pre>\n"}, {"tags": ["c", "moving-average"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 8, "creation_date": 1553015784, "post_id": 55246572, "comment_id": 97226033, "body": "I really don&#39;t understand <i>what</i> you are trying to do, let alone <i>how</i>."}, {"owner": {"reputation": 81, "user_id": 6192787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb3e6b79051237c2c0dc9cefbcb4c727?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6192787/david"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553015868, "post_id": 55246572, "comment_id": 97226073, "body": "I am trying to do an average on 2 number on parallel, for example: averege_value1 = [10,10,20,20....] , averege_value1 = [15,15,40,20....] lets say i have another 1000000000 values in each of them, therefore I dont want to pass the max value of UINT64,"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1553015877, "post_id": 55246572, "comment_id": 97226077, "body": "this doesn&#39;t compile ..."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553015902, "post_id": 55246572, "comment_id": 97226091, "body": "What is your input data? What are you expecting as output?"}, {"owner": {"reputation": 81, "user_id": 6192787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb3e6b79051237c2c0dc9cefbcb4c727?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6192787/david"}, "edited": false, "score": 1, "creation_date": 1553016270, "post_id": 55246572, "comment_id": 97226275, "body": "I can&#39;t do regular averaging of (A1+A2......+An)/n because the numerator will exceed UINT64"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1553016441, "post_id": 55246572, "comment_id": 97226361, "body": "Well, now it appears to be an XY-problem."}, {"owner": {"reputation": 1893, "user_id": 1787434, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85f5a5c15e84e4a9aec84dc8be822010?s=128&d=identicon&r=PG", "display_name": "the_storyteller", "link": "https://stackoverflow.com/users/1787434/the-storyteller"}, "edited": false, "score": 0, "creation_date": 1553016672, "post_id": 55246572, "comment_id": 97226490, "body": "It sounds to me like you&#39;re saying you want to sum the first n elements, then divide by n, repetitively.  <code>uint64 avg; for(uint64 i = 0; i &lt; len(ara); i ++) { avg = (avg + ara[i]) &#47; 2; }</code> If you do that you&#39;ll have loss of accuracy, because at each step you&#39;ll loose the decimal places."}, {"owner": {"reputation": 1101, "user_id": 3958521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GorZx.jpg?s=128&g=1", "display_name": "bigwillydos", "link": "https://stackoverflow.com/users/3958521/bigwillydos"}, "edited": false, "score": 0, "creation_date": 1553017791, "post_id": 55246572, "comment_id": 97227070, "body": "I think this is an example that might help you out <a href=\"https://gist.github.com/bmccormack/d12f4bf0c96423d03f82\" rel=\"nofollow noreferrer\">gist.github.com/bmccormack/d12f4bf0c96423d03f82</a>"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1553029412, "post_id": 55246572, "comment_id": 97232546, "body": "Are you saying that there is an array of <code>struct</code> and you want to get moving averages of two of the variables in that <code>struct</code>? <code>struct { UINT64 a[2]; }</code> perhaps? I assume you mean cumulative moving average? <a href=\"https://en.wikipedia.org/wiki/Moving_average\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Moving_average</a>"}], "owner": {"reputation": 81, "user_id": 6192787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb3e6b79051237c2c0dc9cefbcb4c727?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6192787/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553015578, "creation_date": 1553015578, "question_id": 55246572, "link": "https://stackoverflow.com/questions/55246572/using-same-array-for-moving-average-in-c", "title": "Using same array for moving average in C", "body": "<p>I would like to use a moving average on 2 vars using the same array.\nMy problem is that I am using the array RAW_RESULT for both of them, and the value of \"averege_value1\" gets on the average of averege_value2.\nWhat is the proper way to deal with such a case?</p>\n\n<p>Thanks</p>\n\n<pre><code>UINT64 averege_value1,averege_value2;\nUINT64 RAW_RESULT[2];\n\nUINT64 MovingAverage(UINT64 average_value[] , UINT32 counter){\n\n        average_value[0] =  average_value[0] + (average_value[1] / (UINT64)counter) - (average_value[0] / (UINT64)counter);\n        return average_value[0];\n}\n\nint main() {\n    int counter = 0;\n\n    RAW_RESULT[1] = somevalue1;\n    averege_value1 = MovingAverage(move_avg_tti.RAW_RESULT, counter);\n\n    RAW_RESULT[1] = somevalue2;\n    averege_value2 = MovingAverage(move_avg_tti.RAW_RESULT, counter);\n\n    counter++;\n    return 0\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1553015061, "post_id": 55246398, "comment_id": 97225652, "body": "<code>array</code> is not allocated."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1553015146, "post_id": 55246398, "comment_id": 97225694, "body": "Have you initialized <i>all</i> pointers? Are all pointers pointing to some valid memory of enough size?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553015217, "post_id": 55246398, "comment_id": 97225731, "body": "Aside: you are using a linked list, but controlling it with the number of elements, instead of with the <code>NULL</code> value sentinel link intended for the purpose."}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1553015281, "post_id": 55246398, "comment_id": 97225767, "body": "Although the array not being allocated is probably what&#39;s causing the issue, you should probably check that list is not null before trying to set <code>array[i] = list -&gt; val</code>"}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553015692, "post_id": 55246398, "comment_id": 97225994, "body": "i am sure that list is not null and  I don&#39;t really understand how can I fix this problem. Could you please help me to write the most important steps of my code?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553016010, "post_id": 55246398, "comment_id": 97226140, "body": "Parse a linked list like this: <code>while(list != NULL &amp;&amp; i &lt; length) { array[i++] = list-&gt;val; list = list-&gt;next; }</code>"}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553016067, "post_id": 55246398, "comment_id": 97226164, "body": "@EugeneSh. I have tried with array=(int *)malloc(2*sizeof(int)); But still the problem."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553016209, "post_id": 55246398, "comment_id": 97226230, "body": "Tried where? If done in the right place it should work."}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1553016267, "post_id": 55246398, "comment_id": 97226272, "body": "@WeatherVane I tried, but not the problem."}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553016374, "post_id": 55246398, "comment_id": 97226319, "body": "@EugeneSh. I have added the &quot;array=(int *)malloc(2*sizeof(int));&quot; in the funktion of copylist and in front of for()."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1553016403, "post_id": 55246398, "comment_id": 97226342, "body": "So no, you should do it in <code>main</code>."}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553016749, "post_id": 55246398, "comment_id": 97226540, "body": "But it a task for us and we can&#39;t change or add anything in main(). Is there other ways that I can copy the value of the list to array?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553017931, "post_id": 55246398, "comment_id": 97227157, "body": "@Yun you <b>need</b> to modify <i>main</i> because even the array is allocated in <i>copylist</i>  that will have no impact in <i>main</i> (the call is not <code>copylist(list, &amp;array, 2);</code> for instance)"}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553018085, "post_id": 55246398, "comment_id": 97227236, "body": "@bruno thank you, i wil ask our teacher."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553016627, "post_id": 55246705, "comment_id": 97226460, "body": "I have added the malloc for array in the funktion of copylist but still dosen&#39;t work. have I putted it in a wrong place?for our Task we can not change anything in the main()."}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553016827, "post_id": 55246705, "comment_id": 97226582, "body": "now I know the malloc in main is OK but I can only write the code in funktion copy."}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "reply_to_user": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553017567, "post_id": 55246705, "comment_id": 97226962, "body": "The way main is written could not work without being edited, array starts off as null and then is attempted to be indexed at the end of the program which is undefined behavior and likely a guaranteed segmentation fault. If this is an assignment you should ask your teacher why it&#39;s left null, it seems like a mistake on their end."}, {"owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "edited": false, "score": 0, "creation_date": 1553018015, "post_id": 55246705, "comment_id": 97227204, "body": "thank you. I will ask my teacher."}], "tags": [], "owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "is_accepted": false, "score": 2, "last_activity_date": 1553016095, "creation_date": 1553016095, "answer_id": 55246705, "question_id": 55246398, "link": "https://stackoverflow.com/questions/55246398/why-does-it-lead-to-a-segmentation-fault/55246705#55246705", "title": "Why does it lead to a segmentation fault?", "body": "<p>Currently all that you're passing as an array is a null pointer because you instantiate it as</p>\n\n<pre><code>int *array = NULL;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>int *array = malloc(2 * sizeof(int));\n</code></pre>\n\n<p>which allocates enough space for two integers on the heap. (two being the amount of items you're using in this test).</p>\n\n<p>Also, You should use</p>\n\n<pre><code>int i = 0;\nwhile(list != NULL) {\n\n    array[i] = list-&gt;val;\n    list = list-&gt;next;\n    i++;\n}\n</code></pre>\n\n<p>instead of passing the length value, as you know when you reach the end of a linked list when you reach a null value. If someone were to input the wrong length by accident in your program it would lead to another segmentation fault.</p>\n"}], "owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1553168276, "answer_count": 1, "score": -5, "last_activity_date": 1553016095, "creation_date": 1553014930, "last_edit_date": 1553015292, "question_id": 55246398, "link": "https://stackoverflow.com/questions/55246398/why-does-it-lead-to-a-segmentation-fault", "closed_reason": "Not suitable for this site", "title": "Why does it lead to a segmentation fault?", "body": "<p>It just shows me: [1] 10531 Segmentation fault.\nI don't what is the problem of my code!(I have defined a list and add an element into the list. But it just failed and I don't know how to change it.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct ll {\n    int val;\n    struct ll *next;\n} ll_t;\n\nvoid copylist(ll_t* list, int* array, int length) {\n    int i;\n    for (i = 0; i &lt; length; i++) {\n        array[i] = list-&gt;val;\n        list = list-&gt;next;\n    }\n}\n\nint main() {\n    ll_t *list = NULL;\n    int *array = NULL;\n    list = malloc(sizeof (ll_t));\n    list-&gt;val = 1;\n    list-&gt;next = NULL;\n\n    ll_t *add1 = NULL;\n    add1 = malloc(sizeof (ll_t));\n    add1-&gt;val = 2;\n    add1-&gt;next = NULL;\n    list-&gt;next = add1;\n    int j;\n    copylist(list, array, 2);\n    for (j = 0; j &lt; 2; j++) {\n        printf(\"the content of array is: %d\\n\", array[j]);\n    }\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "musl"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1553191435, "post_id": 55246192, "comment_id": 97303106, "body": "regarding: <code>-I..&#47;lib</code>  This is telling the compiler where the header files are located, NOT where the libraries are located.  To tell the linker where the libraries are located use <code>-L..&#47;lib</code>   Notice the capital &#39;L&#39; rather than the capital &#39;I&#39;`"}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1553256198, "post_id": 55246192, "comment_id": 97326743, "body": "You&#39;re right of course. The setup was kind of weird. The header files were not needed for the library in question. That library was in the standard lookup path of the linker."}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1553017941, "post_id": 55246403, "comment_id": 97227161, "body": "@Antti you mean from the author of musl himself?"}, {"owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "edited": false, "score": 1, "creation_date": 1553075718, "post_id": 55246403, "comment_id": 97247245, "body": "Of course, that was it. I could get my hands on the source and compiled it against musl. Works fine."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 7, "last_activity_date": 1553014945, "creation_date": 1553014945, "answer_id": 55246403, "question_id": 55246192, "link": "https://stackoverflow.com/questions/55246192/musl-gcc-undefined-reference-to-memcpy-chk/55246403#55246403", "title": "musl-gcc: undefined reference to __memcpy_chk", "body": "<p>The include paths in your question are all glibc files, so it looks like the library you're trying to link to was built with glibc. This can sometimes be made to work, but there are limitations. In your case, it was built with the glibc version of <code>_FORTIFY_SOURCE</code>, which uses symbols from glibc that are not presently available in musl (the <code>_FORTIFY_SOURCE</code> implementation typically used on musl works differently). Making this work has been on the long-term agenda for a long time, but not a priority; if you can, it's much better to rebuild the library against musl.</p>\n"}], "owner": {"reputation": 166, "user_id": 8087149, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d87e6ae6e611403413dfa063800952e?s=128&d=identicon&r=PG&f=1", "display_name": "Gilrich", "link": "https://stackoverflow.com/users/8087149/gilrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2578, "favorite_count": 1, "accepted_answer_id": 55246403, "answer_count": 1, "score": 6, "last_activity_date": 1561825317, "creation_date": 1553014209, "last_edit_date": 1561825317, "question_id": 55246192, "link": "https://stackoverflow.com/questions/55246192/musl-gcc-undefined-reference-to-memcpy-chk", "title": "musl-gcc: undefined reference to __memcpy_chk", "body": "<p>I need to compile a C program against musl-libc to make it run on an embedded device. However, I'm failing to compile the program. The source depends on a couple libraries which I pass to the linker like so:</p>\n\n<p><code>/usr/local/musl/bin/musl-gcc app.c -o app -I../lib -lzlog -lfilter</code></p>\n\n<p>This is the output I get:</p>\n\n<pre><code>/usr/local/musl/lib/libzlog.a(category.o): In function `strcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__memcpy_chk'\n/usr/local/musl/lib/libzlog.a(conf.o): In function `strcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__strcpy_chk'\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__strcpy_chk'\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__strcpy_chk'\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__strcpy_chk'\n/usr/local/musl/lib/libzlog.a(event.o): In function `sprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:33: undefined reference to `__sprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:33: undefined reference to `__sprintf_chk'\n/usr/local/musl/lib/libzlog.a(format.o): In function `memcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:53: undefined reference to `__memcpy_chk'\n/usr/local/musl/lib/libzlog.a(record.o): In function `strcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__memcpy_chk'\n/usr/local/musl/lib/libzlog.a(rotater.o): In function `snprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/local/musl/lib/libzlog.a(rule.o): In function `syslog':\n/usr/include/x86_64-linux-gnu/bits/syslog.h:31: undefined reference to `__syslog_chk'\n/usr/local/musl/lib/libzlog.a(rule.o): In function `strcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__strcpy_chk'\n/usr/local/musl/lib/libzlog.a(rule.o): In function `memcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:53: undefined reference to `__memcpy_chk'\n/usr/local/musl/lib/libzlog.a(spec.o): In function `sprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:33: undefined reference to `__sprintf_chk'\n/usr/local/musl/lib/libzlog.a(zc_profile.o): In function `vfprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:127: undefined reference to `__vfprintf_chk'\n/usr/local/musl/lib/libzlog.a(zc_profile.o): In function `fprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:97: undefined reference to `__fprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:97: undefined reference to `__fprintf_chk'\n/usr/local/musl/lib/libzlog.a(zc_util.o): In function `snprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64: undefined reference to `__snprintf_chk'\n/usr/local/musl/lib/libzlog.a(buf.o): In function `strcpy':\n/usr/include/x86_64-linux-gnu/bits/string3.h:110: undefined reference to `__memcpy_chk'\n/usr/local/musl/lib/libzlog.a(buf.o): In function `vsnprintf':\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:77: undefined reference to `__vsnprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:77: undefined reference to `__vsnprintf_chk'\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:77: undefined reference to `__vsnprintf_chk'\ncollect2: error: ld returned 1 exit status\n\n</code></pre>\n\n<p>The same command with gcc works fine.\nAre these functions not implemented in musl?</p>\n"}, {"tags": ["c", "arrays", "char", "int", "quicksort"], "comments": [{"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 2, "creation_date": 1553014314, "post_id": 55246171, "comment_id": 97225257, "body": "Why do you declare lArray as a char pointer and not an int pointer? Doing so would resolve this quite nicely it seems."}, {"owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1553014628, "post_id": 55246171, "comment_id": 97225422, "body": "Yes in this solution i can resolve this problem, but the goal is to do a generic quiksort, for exemple in the future i can give an array of struct to my quicksort. It&#39;s a study exercise."}, {"owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "reply_to_user": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "edited": false, "score": 0, "creation_date": 1553014783, "post_id": 55246171, "comment_id": 97225503, "body": "And before this exercise i made a quicksort only on int array. My professor tell me , &quot;now make your quicksort generic, you must use char cast because the size of char (1) can be multiply with other type size."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1553026140, "post_id": 55246171, "comment_id": 97231123, "body": "You should not use a <code>(void *)</code> cast in <code>quicksort</code>. 6.3.2.3 &quot;A pointer to void may be converted to or from a pointer to any incomplete or object type.&quot; C and C++ differ in this way."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 3, "last_activity_date": 1553075511, "last_edit_date": 1553075511, "creation_date": 1553014817, "answer_id": 55246371, "question_id": 55246171, "link": "https://stackoverflow.com/questions/55246171/c-array-char-compare-to-array-int/55246371#55246371", "title": "C array char compare to array int", "body": "<p>Quic sort calls your compare function with pointers to the elements to be compared. In your compare function <code>cmp</code> (or any othe name you want to use), you first cast these void pointers to the type that they are pointing to, in your case to <code>int</code>. Then you compare them:</p>\n\n<pre><code>int cmp(void* x1,void* x2)\n{\n    int *v1= (int *)x1, *v2= (int *)x2;\n    return (*v1&lt;*v2);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int cmp(void* x1,void* x2)\n{\n    return (*((int *)x1) &lt; *((int *)x2));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "edited": false, "score": 0, "creation_date": 1553015698, "post_id": 55246481, "comment_id": 97225998, "body": "More precisly : In my int array i have the number 383 at the first index. When I do : char <i>lArray = (char</i>) array;  And take the 1st element of lArray i have 127, because int and char dont have the same size, but if i compare 127 with other cell of the l tab maybe 127 was lower than this cell but the real number was highter"}], "tags": [], "owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "is_accepted": false, "score": 0, "last_activity_date": 1553015210, "creation_date": 1553015210, "answer_id": 55246481, "question_id": 55246171, "link": "https://stackoverflow.com/questions/55246171/c-array-char-compare-to-array-int/55246481#55246481", "title": "C array char compare to array int", "body": "<p>I did not think to change the comparison function according to the type to compare my elements, but thereby what the type to convert my void array on the quicksort ?\nFor example: </p>\n\n<pre><code>quicksort(void *array,int numberElem,int size, cmp(void*,void*)){\n**HERE** *lArray;\nlArray= (**HERE***)array; \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "edited": false, "score": 0, "creation_date": 1553019643, "post_id": 55247407, "comment_id": 97227999, "body": "Thanks a lot for your help and for taking the time to make a complete example. I think I&#39;ve understand :  1)Use char cast in the local context of the sort  for pointing. 2)Use a specific compare function in function of the type passed in parameter. It&#39;s that ?"}, {"owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "reply_to_user": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "edited": false, "score": 0, "creation_date": 1553020740, "post_id": 55247407, "comment_id": 97228547, "body": "Yes, but I want to stress the part about multiplying the element size with the index of the element you&#39;re trying to access. That&#39;s the actual trick that makes this work."}, {"owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "edited": false, "score": 0, "creation_date": 1553024730, "post_id": 55247407, "comment_id": 97230452, "body": "I fully understood what you explained to me, and the error came from my comparison function and not from my quicksort, because I was trying to compare integers larger than 128 so the char did not allow a correct comparison."}], "tags": [], "owner": {"reputation": 644, "user_id": 6363580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SGK6.jpg?s=128&g=1", "display_name": "brothir", "link": "https://stackoverflow.com/users/6363580/brothir"}, "is_accepted": true, "score": 0, "last_activity_date": 1553037972, "last_edit_date": 1553037972, "creation_date": 1553018810, "answer_id": 55247407, "question_id": 55246171, "link": "https://stackoverflow.com/questions/55246171/c-array-char-compare-to-array-int/55247407#55247407", "title": "C array char compare to array int", "body": "<p>The way to do this is to multiply size by the index of the element you're accessing (pay attention to <code>Param1</code> and <code>Param2</code> in the the insertion sort). I took the time to write a fairly lengthy example with insertion sort rather than quicksort: the general structure behind the type genericness is the same but you'll obviously have to apply quicksort rather than selection sort.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint CmpChar(void* Param1, void* Param2) {\n    char  P1 = *((char*) Param1);\n    char  P2 = *((char*) Param2);\n    return P1 &lt; P2;\n}\n\nint CmpShort(void* Param1, void* Param2) {\n    short  P1 = *((short*) Param1);\n    short  P2 = *((short*) Param2);\n    return P1 &lt; P2;\n}\n\nint CmpInt(void* Param1, void* Param2) {\n    int    P1 = *((int*) Param1);\n    int    P2 = *((int*) Param2);\n    return P1 &lt; P2;\n}\n\nint CmpLong(void* Param1, void* Param2) {\n    long long P1 = *((long long*) Param1);\n    long long P2 = *((long long*) Param2);\n    return    P1 &lt; P2;\n}\n\nvoid GenericInsertionSort(void* Array, int Length, int Size, int Cmp(void*, void*)) {\n    char* lArray = (char*) Array;\n    void* Temp = malloc(Size);\n    for (int i = 0; i &lt; (Length - 1); i++) {\n        int j = i + 1;\n        void* Param1 = lArray + Size*j;\n        void* Param2 = lArray + Size*(j - 1);\n        while (j &amp;&amp; Cmp(Param1, Param2)) {\n            memcpy(Temp, Param2, Size);\n            memcpy(Param2, Param1, Size);\n            memcpy(Param1, Temp, Size);\n            j--;\n            Param1 = ((char*) Param1 - Size);\n            Param2 = ((char*) Param2 - Size);\n        }\n    }\n}\n\nint main(void) {\n    long long   A1[] = {5, 3, 1, 4, 2};\n    int         A2[] = {5, 3, 1, 4, 2};\n    short       A3[] = {5, 3, 1, 4, 2};\n    char        A4[] = {5, 3, 1, 4, 2};\n    GenericInsertionSort(A1, 5, 8, CmpLong);\n    GenericInsertionSort(A2, 5, 4, CmpInt);\n    GenericInsertionSort(A3, 5, 2, CmpShort);\n    GenericInsertionSort(A4, 5, 1, CmpChar);\n\n    for (int i = 0; i &lt; 5; i++) {\n        printf(\"%llu == %d == %d == %d\\n\", A1[i], A2[i], A3[i], A4[i]);\n    }\n    getchar();\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11210974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d9ea5d5531c1278c29786f24524ca1?s=128&d=identicon&r=PG&f=1", "display_name": "gulver", "link": "https://stackoverflow.com/users/11210974/gulver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55247407, "answer_count": 3, "score": 0, "last_activity_date": 1555162140, "creation_date": 1553014161, "last_edit_date": 1555162140, "question_id": 55246171, "link": "https://stackoverflow.com/questions/55246171/c-array-char-compare-to-array-int", "title": "C array char compare to array int", "body": "<p>I work currently on in place generic Quicksort.<br>\nI start with an int array which is randomly generated to do some tests.</p>\n\n<p>The specification of the quiksort is :<br>\n<code>quicksort(void *array,int numberElem,int size, cmp(void*,void*))</code></p>\n\n<p>cmp a compare function.</p>\n\n<p>So :\nI call the function in my main like : </p>\n\n<pre><code>int main(void){\n int myArray= .....randomly;\n quicksort((void *)myArray,100,sizeof(int),cmp)\n}\n</code></pre>\n\n<p>Then in my quicksort :</p>\n\n<pre><code>quicksort(void *array,int numberElem,int size, cmp(void*,void*)){\nchar *lArray;\nlArray= (char*)array;\n}\n</code></pre>\n\n<p>Now the question is :<br>\nHow I can compare 2 cell (realy int cells) of my char lArray using size ?</p>\n\n<p>I ve been some research and not find answer.\nThanks for ready and sorry if my english was little bad.</p>\n"}, {"tags": ["c", "for-loop", "pointers", "crash", "calloc"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 2, "creation_date": 1553013917, "post_id": 55245965, "comment_id": 97225046, "body": "<code>memcpy(Vector, makeVector(dimension), dimension);</code>  --&gt; here <code>Vector</code> is <code>NULL</code> and you are writing to it -- which is undefined behavior.  Why not <code>Vector = makeVector(dimension)</code> ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1553014126, "post_id": 55245965, "comment_id": 97225145, "body": "do <code>srand(time(0));</code> only one time on your program else you will retry the same values becayse no chance to move to an other second"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553014329, "post_id": 55245965, "comment_id": 97225264, "body": "i also don&#39;t understand why you are subtracting 1 from dimension in <code>makeVector</code>.  That doesn&#39;t look right"}, {"owner": {"reputation": 3, "user_id": 11219904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ab9bb044111c3b4272866acfe1cba5?s=128&d=identicon&r=PG&f=1", "display_name": "ProudSalsa", "link": "https://stackoverflow.com/users/11219904/proudsalsa"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553014656, "post_id": 55245965, "comment_id": 97225437, "body": "@MFisherKDX The 1. dimension should be the 0. position in the array. 10th dimension is on array pos. 9"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553014781, "post_id": 55245965, "comment_id": 97225502, "body": "arrays are zero-indexed in C.  So you have an off by one error.  Inside <code>makeVector</code> you are allocating space for <code>dimension-1</code> elements.  But then in <code>main</code> you are accessing <code>dimension</code> elements."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553014853, "post_id": 55245965, "comment_id": 97225537, "body": "why to make simple ? ^^"}, {"owner": {"reputation": 3, "user_id": 11219904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ab9bb044111c3b4272866acfe1cba5?s=128&d=identicon&r=PG&f=1", "display_name": "ProudSalsa", "link": "https://stackoverflow.com/users/11219904/proudsalsa"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553014925, "post_id": 55245965, "comment_id": 97225579, "body": "@MFisherKDX yes but i also substract one from int k in the main function. So it works again. I admit this is kinda weird programming ^^. I keep that in mind"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553015111, "post_id": 55245965, "comment_id": 97225680, "body": "No.  When you use <code>calloc</code> to allocate space for N elements, the valid indices are 0 to N-1 inclusive.  In <code>makeVector</code> you are allocating space for <code>dimension-1</code> ints ... from Vector[0] to Vector[dimension-2].  In <code>main</code> you are indexing <code>dimension</code> ints ... from Vector[0] to Vector[dimension-1]."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553015203, "post_id": 55245965, "comment_id": 97225723, "body": "@bruno -- I don&#39;t understand what you mean by: &quot;why to make simple ? ^^&quot;"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1553015325, "post_id": 55245965, "comment_id": 97225783, "body": "it was a joke, I speak about the <i>dimension</i> management with the -1/+1 and finally lost the last entry, this is a little <i>Shadock</i> ^^"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553015388, "post_id": 55245965, "comment_id": 97225827, "body": "Yes.  Needs to simplify and index from 0.  Otherwise the OP will confuse himself/herself."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1553015416, "post_id": 55245965, "comment_id": 97225842, "body": "@MFisherKDX and worst confuse us :-)"}, {"owner": {"reputation": 3, "user_id": 11219904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ab9bb044111c3b4272866acfe1cba5?s=128&d=identicon&r=PG&f=1", "display_name": "ProudSalsa", "link": "https://stackoverflow.com/users/11219904/proudsalsa"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 1, "creation_date": 1553015538, "post_id": 55245965, "comment_id": 97225907, "body": "@MFisherKDX Ok TY very much. Now i get it^^. Its just the way calloc works ... i see. TY for your help bruno and MFisherKDX"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1553014888, "last_edit_date": 1553014888, "creation_date": 1553014514, "answer_id": 55246289, "question_id": 55245965, "link": "https://stackoverflow.com/questions/55245965/problem-with-filling-a-pointer-array-with-random-numbers-initialised-by-calloc/55246289#55246289", "title": "problem with filling a pointer array with random numbers initialised by calloc", "body": "<p>your main problem is :</p>\n\n<pre><code>memcpy(Vector, makeVector(dimension), dimension);\n</code></pre>\n\n<p>while <em>Vector</em> is a null pointer, so the behavior is undefined</p>\n\n<p>do</p>\n\n<pre><code>Vector = makeVector(dimension);\n</code></pre>\n\n<hr>\n\n<p>An other problem is to redo <code>srand(time(0));</code> is <em>makeVector</em>, the execution time is almost nothing so you reinitialize the random generation to give you again the same values (there is almost no change to have the time changing).</p>\n\n<p>Do <code>srand(time(0));</code> only one time during the execution</p>\n\n<hr>\n\n<p>In</p>\n\n<pre><code>for (int k = 1; k &lt;= dimension; k++) {\n  printf(\"%d. Dimension: %d\\n\", k, Vector[k - 1]);\n}\n</code></pre>\n\n<p>you access to the non initialized last entry of the vector because in <em>makeVector</em> :</p>\n\n<pre><code>for (int i = 0; i &lt; (dimension - 1); i++) {\n    Vector[i] = rand() % 25;\n }\n</code></pre>\n\n<p>must be</p>\n\n<pre><code>for (int k = 1; k &lt; dimension; k++) {\n  printf(\"%d. Dimension: %d\\n\", k, Vector[k - 1]);\n}\n</code></pre>\n\n<p>or of course modify the initialization loop to not lost the last entry</p>\n\n<hr>\n\n<p>Compilation and execution after the changes :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra m.c\npi@raspberrypi:/tmp $ ./a.out\n-----1. Vector-----\n1. Dimension: 18\n2. Dimension: 21\n3. Dimension: 22\n4. Dimension: 21\n5. Dimension: 2\n6. Dimension: 0\n7. Dimension: 24\n-----2. Vector-----\n1. Dimension: 20\n2. Dimension: 24\n3. Dimension: 13\n-----3. Vector-----\n1. Dimension: 3\n-----4. Vector-----\n1. Dimension: 5\n2. Dimension: 24\n3. Dimension: 10\n4. Dimension: 4\n5. Dimension: 20\n-----5. Vector-----\n1. Dimension: 19\n2. Dimension: 7\n3. Dimension: 24\n4. Dimension: 24\n5. Dimension: 16\n6. Dimension: 11\n-----6. Vector-----\n1. Dimension: 10\n2. Dimension: 14\n3. Dimension: 17\n4. Dimension: 9\n5. Dimension: 9\n-----7. Vector-----\n1. Dimension: 9\n2. Dimension: 8\n3. Dimension: 19\n4. Dimension: 9\n5. Dimension: 7\n-----8. Vector-----\n1. Dimension: 6\n2. Dimension: 8\n3. Dimension: 23\n-----9. Vector-----\n1. Dimension: 14\n2. Dimension: 13\n3. Dimension: 12\n4. Dimension: 13\n-----10. Vector-----\n1. Dimension: 18\n2. Dimension: 10\n3. Dimension: 3\n4. Dimension: 12\n5. Dimension: 20\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>Execution under <em>valgrind</em></p>\n\n<pre><code>pi@raspberrypi:/tmp $ valgrind ./a.out\n==29590== Memcheck, a memory error detector\n==29590== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\n==29590== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info\n==29590== Command: ./a.out\n==29590== \n-----1. Vector-----\n1. Dimension: 21\n2. Dimension: 16\n3. Dimension: 3\n4. Dimension: 11\n5. Dimension: 11\n6. Dimension: 8\n7. Dimension: 13\n8. Dimension: 8\n9. Dimension: 23\n-----2. Vector-----\n1. Dimension: 11\n2. Dimension: 3\n3. Dimension: 5\n4. Dimension: 21\n5. Dimension: 18\n6. Dimension: 4\n-----3. Vector-----\n1. Dimension: 20\n2. Dimension: 15\n3. Dimension: 4\n4. Dimension: 17\n5. Dimension: 0\n6. Dimension: 2\n7. Dimension: 21\n-----4. Vector-----\n1. Dimension: 24\n2. Dimension: 6\n3. Dimension: 20\n4. Dimension: 10\n5. Dimension: 1\n6. Dimension: 19\n-----5. Vector-----\n1. Dimension: 19\n2. Dimension: 24\n3. Dimension: 19\n-----6. Vector-----\n1. Dimension: 7\n2. Dimension: 10\n-----7. Vector-----\n1. Dimension: 5\n2. Dimension: 6\n3. Dimension: 4\n4. Dimension: 10\n5. Dimension: 11\n6. Dimension: 2\n7. Dimension: 4\n-----8. Vector-----\n1. Dimension: 0\n2. Dimension: 1\n-----9. Vector-----\n1. Dimension: 6\n2. Dimension: 18\n3. Dimension: 12\n4. Dimension: 10\n5. Dimension: 16\n-----10. Vector-----\n==29590== \n==29590== HEAP SUMMARY:\n==29590==     in use at exit: 0 bytes in 0 blocks\n==29590==   total heap usage: 11 allocs, 11 frees, 1,212 bytes allocated\n==29590== \n==29590== All heap blocks were freed -- no leaks are possible\n==29590== \n==29590== For counts of detected and suppressed errors, rerun with: -v\n==29590== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 6 from 3)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11219904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ab9bb044111c3b4272866acfe1cba5?s=128&d=identicon&r=PG&f=1", "display_name": "ProudSalsa", "link": "https://stackoverflow.com/users/11219904/proudsalsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 55246289, "answer_count": 1, "score": 0, "last_activity_date": 1553014888, "creation_date": 1553013543, "last_edit_date": 1553013944, "question_id": 55245965, "link": "https://stackoverflow.com/questions/55245965/problem-with-filling-a-pointer-array-with-random-numbers-initialised-by-calloc", "title": "problem with filling a pointer array with random numbers initialised by calloc", "body": "<ol>\n<li><p>my program should create 10 Vectors each with a random dimension between 1 and 10 and each dimension filled with random numbers between 0 and 24.</p>\n\n<pre><code>int * makeVector(int dimension) {\n  int * Vector = NULL;\n\n  Vector = (int*) calloc(dimension - 1, sizeof(int));\n  if (NULL == Vector) exit(1);\n\n  srand(time(0));\n\n  for (int i = 0; i &lt; (dimension - 1); i++) {\n    Vector[i] = rand() % 25;\n  }\n\n  return Vector; \n}\n\nint main() {\n  srand(time(0));\n\n  for (int i = 1; i &lt;= 10; i++) {\n    printf(\"-----%d. Vector-----\\n\", i);\n    fflush(stdout);\n    int dimension = (rand() % 10) + 1;\n    int *Vector = NULL;\n\n    memcpy(Vector, makeVector(dimension), dimension);\n\n    for (int k = 1; k &lt;= dimension; k++) {\n      printf(\"%d. Dimension: %d\\n\", k, Vector[k - 1]);\n    }\n    if (Vector) {\n      free(Vector);\n      Vector = NULL;\n    }\n  }\n  return 0;\n}\n</code></pre></li>\n<li><p>My Problem: There are no warnings and no errors showing up! \nThough the For-Loop in the makeVector function doesnt seems to work at all.</p>\n\n<pre><code>for (int i = 0; i &lt; (dimension - 1); i++) {\n     Vector[i] = rand() % 25;\n}\n</code></pre></li>\n</ol>\n\n<p>int i only equals 0 the first time and nothing happens. The For-Loop skips and the program gets terminated with the exit value:-1.073.741.819</p>\n\n<p>PS: Im pretty new to programming ... could interpreted the Debugger wrong.</p>\n\n<p>Thank you in advance!</p>\n"}]