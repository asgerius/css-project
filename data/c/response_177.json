[{"tags": ["c"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1527722588, "post_id": 50614579, "comment_id": 88239010, "body": "Could you give an example of your input and expected output?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1527722632, "post_id": 50614579, "comment_id": 88239024, "body": "<code>char function[] = {};</code>  what is this supposed to mean?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527722683, "post_id": 50614579, "comment_id": 88239041, "body": "@wildplasser It&#39;s a GNU extension for a zero size array. <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Zero-Length.html</a>"}, {"owner": {"reputation": 154, "user_id": 3926412, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/386ec047887b2fbf66561f8f1023379f?s=128&d=identicon&r=PG&f=1", "display_name": "Kolt Penny", "link": "https://stackoverflow.com/users/3926412/kolt-penny"}, "edited": false, "score": 1, "creation_date": 1527722795, "post_id": 50614579, "comment_id": 88239059, "body": "You&#39;re getting the Segmentation fault because the array <code>function</code> is of a fixed size of none. Use a pointer to a char instead and allocate with malloc or establish a big enough size for the array."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1527723864, "post_id": 50614579, "comment_id": 88239314, "body": "warning are there not because the compiler writers hate you , but because they are trying to help"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1527792701, "post_id": 50614579, "comment_id": 88271869, "body": "@pm100 But those warnings are off by default and complex to turn on because compiler writers hate you. ;)"}], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1527723725, "last_edit_date": 1527723725, "creation_date": 1527723170, "answer_id": 50614674, "question_id": 50614579, "link": "https://stackoverflow.com/questions/50614579/split-a-string-into-an-array-of-strings/50614674#50614674", "title": "Split a string into an array of strings", "body": "<p>Compiler warnings reveal your problems.</p>\n\n<pre><code>cc -Wall -Wshadow -Wwrite-strings -Wextra -Wconversion -std=c99 -pedantic -g   -c -o test.o test.c\ntest.c:7:21: warning: use of GNU empty initializer extension [-Wgnu-empty-initializer]\n  char function[] = {};\n                    ^\ntest.c:7:21: warning: zero size arrays are an extension [-Wzero-length-array]\ntest.c:18:15: warning: format specifies type 'char *' but the argument has type 'char (*)[0]'\n      [-Wformat]\n  scanf(\"%s\", &amp;function);\n         ~~   ^~~~~~~~~\n</code></pre>\n\n<p>These are all related. <code>char function[] = {}</code> is a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html\" rel=\"nofollow noreferrer\">GNU extension to declare a 0 size array</a>. Then you try to put stuff into it, but it's size 0. So there's going to be an overflow.</p>\n\n<p>Instead, you need to allocate some space to <code>function</code> and be sure to limit <code>scanf</code> to only that size, no larger.</p>\n\n<pre><code>// {0} initializes all characters to 0.\n// 1024 is a good size for a static input buffer.\nchar function[1024] = {0};\n\n// one less because of the null byte\nscanf(\"%1023s\", &amp;function);\n</code></pre>\n\n<hr>\n\n<p>The next warning...</p>\n\n<pre><code>test.c:23:17: warning: incompatible pointer to integer conversion assigning to 'char' from 'char *';\n      dereference with * [-Wint-conversion]\n    word[cpt++] = pch;\n                ^ ~~~\n                  *\n</code></pre>\n\n<p>is because you're trying to put the string (<code>char *</code>) <code>pch</code> where a character (<code>char</code>) goes. Even if you're only reading a single character from <code>strtok</code> (which you cannot guarantee) it always returns a string. You want an array of strings (<code>char **</code>). It also helps to have descriptive variable names.</p>\n\n<pre><code>char *word;                 // this was pch\nchar *words[nb_terms];      // this was word\n</code></pre>\n\n<p>After changing <code>pch</code> to <code>word</code>, and <code>word</code> to <code>words</code> in the rest of the code it all works.</p>\n\n<pre><code>  size_t word_idx = 0;\n  for(\n      char *word = strtok(function,\"+\");\n      word != NULL;\n      word = strtok(NULL, \"+\")\n  ) {\n      words[word_idx++] = word;\n  }\n</code></pre>\n\n<p>I'll add <a href=\"http://c-faq.com/stdio/scanfprobs.html\" rel=\"nofollow noreferrer\">the usual caveats about <code>scanf</code></a>.</p>\n"}], "owner": {"reputation": 388, "user_id": 5239619, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/351607c737f45d3f904f8915507f03cc?s=128&d=identicon&r=PG&f=1", "display_name": "ben", "link": "https://stackoverflow.com/users/5239619/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 50614674, "answer_count": 1, "score": 0, "last_activity_date": 1527723725, "creation_date": 1527722466, "question_id": 50614579, "link": "https://stackoverflow.com/questions/50614579/split-a-string-into-an-array-of-strings", "title": "Split a string into an array of strings", "body": "<p>It's been a while that I haven't written programs in C. I am used to write code in C#.</p>\n\n<p>So, I want to split the user string input into an array of strings using a delimiter. \nI did this, but when I want to fetch the array I have a segmentation fault. \nAs an example, I want just to print one element of the array.</p>\n\n<p>I have checked on the net, but nothing worked. </p>\n\n<p>Any hints ?</p>\n\n<p>Thanks</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n\nint main ()\n{\n\n  char function[] = {};\n  char * pch;\n  int cpt = 0;\n  int nb_terms = 0;\n\n  printf(\"Entrez le nombre de termes :\\n\");\n  scanf(\"%d\", &amp;nb_terms);\n\n  char word[nb_terms];\n\n  printf(\"Entrez votre fonction en n'utilisant que les 5 caract\u00e8res suivants (a,b,c,d et +) :\\n\");\n  scanf(\"%s\", &amp;function);\n\n  pch = strtok (function,\"+\");\n  while (pch != NULL)\n  {\n    word[cpt++] = pch;\n    printf (\"%s\\n\",pch);\n    pch = strtok (NULL, \"+\");\n  }\n\n  printf (\"%s\\n\",&amp;word[1]);\n\n  return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "swift", "pointers", "language-interoperability"], "comments": [{"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527728523, "post_id": 50614575, "comment_id": 88240400, "body": "There are quite a few interesting things going on here...  What problems did you encounter while trying various approaches?"}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527798087, "post_id": 50614575, "comment_id": 88274528, "body": "Sure, most of the issues were related to mismatch of casting/mapping of data types. I&#39;m still new to swift types so tried few: UnsafeMutablePointer CChar/Int8 type, ? &amp; ! meaning, strdup for string assignment, Also checked COpaquePointer which seems to be deprecated in new version. The common error for char** assignment was &#39;Cannot convert x to UnsafeMutablePointer&lt;UnsafeMutablePointer&lt;Int8&gt;?&gt;!&#39;."}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527812821, "post_id": 50614575, "comment_id": 88279190, "body": "Looks like you really need to study some documentation.  This site is for short, specific questions/answers, not for tutorial requests and cannot be a substitute for working through technical documentation.  Please see <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>.  In addition to the resources I mentioned in my answer, you might also want to carefully read through <a href=\"https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/#//apple_ref/doc/uid/TP40014216-CH2-ID0\" rel=\"nofollow noreferrer\">developer.apple.com/library/content/documentation/Swift/&hellip;</a>.  By now have you been able to read/write var2 and var3? Is var1 the only remaining problem?"}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527874663, "post_id": 50614575, "comment_id": 88307663, "body": "Actually, I&#39;ve been going through all posts and seen these too. My title was clear about mapping char** to respective type in swift. The summary was to explain the surroundings and get people&#39;s opinion on ways to implement. var2 &amp; var3 successful as before, this question was mainly targeted for var1 which gives me error &#39;Cannot convert x to UnsafeMutablePointer&lt;UnsafeMutablePointer&lt;Int8&gt;?&gt;!&#39;. The reference links included have similar scope and question type, just that it did not work for me as I&#39;m dealing with OPTIONAL type[?/!]."}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527875445, "post_id": 50614575, "comment_id": 88308048, "body": "@AnatoliP : edited question with all attempts and type of error returned."}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1527899303, "post_id": 50614575, "comment_id": 88315615, "body": "good point about the title focusing on <code>char**</code>, which would be <code>var1</code>.  In cases like this I would suggest just narrowing down the question to <code>var1</code>, so there is less of a chance of misunderstanding.  I&#39;ll play around with <code>var1</code>, should be doable."}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1528229264, "post_id": 50614575, "comment_id": 88425330, "body": "@AnatoliP : Sure looking forward to it."}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1528231581, "post_id": 50614575, "comment_id": 88426392, "body": "@AnatoliP : thank you for taking time to implement the functionality. The following code assignment was successful, though passing this structure to other functions which will access the parameters say one of the strings describing the list of var1 strings is NULL. Can you make sense of it. Really appreciate the effort!"}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1528244233, "post_id": 50614575, "comment_id": 88430212, "body": "Sorry, @George, I don&#39;t know the library you are trying to use and there are too many possibilities to even try to speculate.  You may want to come up with a very brief specific example that shows the problem and ask a new question.  That way you are more likely to get more assistance faster."}, {"owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "reply_to_user": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1528319971, "post_id": 50614575, "comment_id": 88467295, "body": "@AnatoliP : The library is very simple/operational. It&#39;s just making sure that list does not contain empty string. I believe it might be the pointer may not be correctly pointing to string or if it&#39;s correctly mapped, We need to make sure it does not contains empty string. I&#39;ve accepted your answer, I hope to get to bottom of this, let me know if you&#39;ve any thoughts!"}, {"owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "edited": false, "score": 0, "creation_date": 1528337151, "post_id": 50614575, "comment_id": 88471875, "body": "is the problem a NULL pointer or an empty string?  Anyway, you may want to do some debugging and once you can narrow down the problem(s) so that you can write a simple code example to reproduce them, post it as part of a new question.  Or maybe pose separate questions if there are several distinct problems."}], "answers": [{"tags": [], "owner": {"reputation": 4371, "user_id": 5196056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e60f19699f947713c612d70b80524a?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoli P", "link": "https://stackoverflow.com/users/5196056/anatoli-p"}, "is_accepted": true, "score": 0, "last_activity_date": 1528165049, "last_edit_date": 1528165049, "creation_date": 1527735570, "answer_id": 50616013, "question_id": 50614575, "link": "https://stackoverflow.com/questions/50614575/assign-an-array-of-swift-strings-to-a-c-structure-variable-taking-a-char-valu/50616013#50616013", "title": "Assign an array of Swift strings to a C structure variable taking a char ** value", "body": "<p>This is quite a broad question, so here are some references and observations with a few examples.  Hopefully these are helpful.</p>\n\n<p>Please see Apple's documentation for <code>UnsafeMutablePointer</code> struct and also <code>String</code> and <code>NSString</code>:</p>\n\n<p><a href=\"https://developer.apple.com/documentation/swift/unsafemutablepointer\" rel=\"nofollow noreferrer\">https://developer.apple.com/documentation/swift/unsafemutablepointer</a></p>\n\n<p><a href=\"https://developer.apple.com/documentation/swift/string\" rel=\"nofollow noreferrer\">https://developer.apple.com/documentation/swift/string</a></p>\n\n<p><a href=\"https://developer.apple.com/documentation/foundation/nsstring\" rel=\"nofollow noreferrer\">https://developer.apple.com/documentation/foundation/nsstring</a></p>\n\n<p>Another useful reading is Apple's docs about C and Swift interop:  <a href=\"https://developer.apple.com/documentation/swift/imported_c_and_objective_c_apis\" rel=\"nofollow noreferrer\">https://developer.apple.com/documentation/swift/imported_c_and_objective_c_apis</a></p>\n\n<p>In this answer I'm also leaving out a lot of memory management aspects as well as things such as keeping track of the size of <code>var1</code> and <code>var2</code> arrays, since I don't know the specifics of your library.</p>\n\n<p>Regarding the snippet for initializing the structure, you can't use the type name as the variable name and <code>init</code> will confuse the Swift compiler because it's reserved for naming class initializers. Let's name the variable <code>myArgs</code> instead of <code>args</code> and assume the C library initialization function is named <code>initialize</code>; if it's indeed <code>init</code>, one can easily write a wrapper named differently.  Another problem with the snippet is that <code>myArgs</code> will remain unchanged after initialization, <code>Ptr</code> will actually get initialized, so you would have to use <code>Ptr</code> to access the initialized <code>args</code> structure.  Thus we can omit <code>Ptr</code> and use implicit bridging to pass <code>myArgs</code> to the initialization function.  The snippet becomes</p>\n\n<pre><code>var myArgs = args()\ninitialize(&amp;myArgs)\n</code></pre>\n\n<p>Now you can access the members as follows:</p>\n\n<pre><code>// Assuming var1 is an array of at least 2 C strings.\n// See Swift documentation about optionals on how to deal with \n// cases when this assumption breaks down\nlet s1 = String(cString: myArgs.var1[0]!)  // 1st element of var1\nlet s2 = String(cString: myArgs.var1[1]!)  // 2nd element of var1\nmyArgs.var2.pointee                   // 1st element of var2\n(myArgs.var2 + 1).pointee             // 2nd element of var2\nlet s = String(cString: myArgs.var3)  // value of var3\n</code></pre>\n\n<p>Now let's set var1 to be <code>{\"aa\", \"bbb\"}</code>:</p>\n\n<pre><code>            var var1Buffer = \nUnsafeMutablePointer&lt;UnsafeMutablePointer&lt;Int8&gt;?&gt;.allocate(capacity: 2)\n            var var1a : NSString = \"aa\"\n            var var1b : NSString = \"bbb\"\n            var var1aBuffer = UnsafeMutablePointer&lt;Int8&gt;.allocate(\n        capacity: var1a.length + 1)\n            var var1bBuffer = UnsafeMutablePointer&lt;Int8&gt;.allocate(\n        capacity: var1b.length + 1)\n            if (var1a.getCString(var1aBuffer, maxLength: var1a.length + 1,\n    encoding: String.Encoding.utf8.rawValue)\n                &amp;&amp; var1b.getCString(var1bBuffer, maxLength: var1b.length + 1,\n    encoding: String.Encoding.utf8.rawValue)) {\n                var1Buffer[0] = var1aBuffer\n                var1Buffer[1] = var1bBuffer\n                myArgs.var1 = var1Buffer\n            } else { print(\"Encoding failed...\")}\n</code></pre>\n\n<p>Here is an example of setting var2 to be an array of 5 elements equal to 200:</p>\n\n<pre><code>var var2Buffer = UnsafeMutablePointer&lt;UInt8&gt;.allocate(capacity: 5);\nvar2Buffer.initialize(repeating: 200, count: 5)\nmyArgs.var2 = var2Buffer\n</code></pre>\n\n<p>And setting the value of var3:</p>\n\n<pre><code>let newVar3 : NSString = \"This is new variable 3\"\nvar var3Buffer = UnsafeMutablePointer&lt;Int8&gt;.allocate(capacity: newVar3.length + 1)\nif (newVar3.getCString(var3Buffer, maxLength: newVar3.length + 1, encoding: String.Encoding.utf8.rawValue)) {\n    myArgs.var3 = var3Buffer\n} else { print(\"Encoding failed...\") }\n</code></pre>\n\n<p>The above examples assume UTF8 encoding.  </p>\n"}], "owner": {"reputation": 43, "user_id": 9274898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59ffdf74892cb2604cbf3339bd91a946?s=128&d=identicon&r=PG&f=1", "display_name": "George davies", "link": "https://stackoverflow.com/users/9274898/george-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 50616013, "answer_count": 1, "score": 3, "last_activity_date": 1528165049, "creation_date": 1527722439, "last_edit_date": 1527875295, "question_id": 50614575, "link": "https://stackoverflow.com/questions/50614575/assign-an-array-of-swift-strings-to-a-c-structure-variable-taking-a-char-valu", "title": "Assign an array of Swift strings to a C structure variable taking a char ** value", "body": "<p>I'm trying to interact with an old C terminal app/library from Swift. I've successfully integrated the source code and bridged the headers from C to Swift. The code compiles and runs, I can access all functions from C - library into swift.</p>\n\n<p>There is a structure in C - library which I need to initialize[Function already exists which takes pointer] and assign values to structure variables[Manually].</p>\n\n<p>C-structure:</p>\n\n<pre><code>Struct args{\nchar ** var1;\nunsigned char * var2;\nchar * var3;\n}\n</code></pre>\n\n<p>and Initialization function call:</p>\n\n<pre><code>init(args * ptr);\n</code></pre>\n\n<p>How to call the function inside swift and assign values to var1 and var2?</p>\n\n<p>1.Will following snippet successfully initialize the structure?</p>\n\n<pre><code>let Ptr = UnsafeMutablePointer&lt;args&gt;.allocate(capacity: 1)\nvar args = args()\nPtr.pointee = args\ninit(Ptr)\n</code></pre>\n\n<p>2.How to assign values to var1, var2 &amp; var3 assuming we successfully initialize?</p>\n\n<p>They are mapped as:</p>\n\n<pre><code>var1: UnsafeMutablePointer&lt;UnsafeMutablePointer&lt;Int8&gt;?&gt;!\nvar2: UnsafeMutablePointer&lt;Uint8&gt;!\nvar3: UnsafeMutablePointer&lt;Int8&gt;!    \n</code></pre>\n\n<p>For example\n<em>var1 = {\"a\", \"b\"}</em>, <em>var2 = {1,2,3}</em> and <em>var3 = \"a\"</em></p>\n\n<p>I've tested following links and did not work:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29469158/how-to-pass-an-array-of-swift-strings-to-a-c-function-taking-a-char-parameter\">How to pass an array of Swift strings to a C function taking a char ** parameter\n</a> : gives 'inout[UnsafeMutablePointer?] to type UnsafeMutablePointer?>!' error</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38275377/convert-a-swift-array-of-string-to-a-to-a-c-string-array-pointer?noredirect=1&amp;lq=1\">Convert a Swift Array of String to a to a C string array pointer\n</a> : gives 'inout[UnsafeMutablePointer?] to type UnsafeMutablePointer?>!' error</p>\n\n<p><a href=\"https://oleb.net/blog/2016/10/swift-array-of-c-strings/\" rel=\"nofollow noreferrer\">No built-in support for arrays of C strings</a> : this one needs more efforts and hoping to get easier version</p>\n\n<p><a href=\"https://gist.github.com/neilpa/b430d148d1c5f4ae5ddd\" rel=\"nofollow noreferrer\">github - Swift wrappers for C functions taking char** arguments\n</a> : gives 'inout[UnsafeMutablePointer] to type UnsafeMutablePointer?>!' error</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527721978, "post_id": 50614491, "comment_id": 88238878, "body": "First of all <code>*(flow + i*n + j)</code> means that you have missed providing declaration and definition for <code>flow</code>, <code>i</code>, <code>n</code> and <code>j</code>. Please provide some context, without that relevant information, your question too broad."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1527723031, "post_id": 50614491, "comment_id": 88239111, "body": "Strongly strongly STRONGLY recommend grabbing yourself <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">a good book</a> and get familiar with C++ (not to be confused with C) or you will be totally &lt;expletive deleted&gt;ed when the course gets into full swing. A decent Algorithms course is hard enough. Tacking learning C++ at the same time without a good reference onto that is a good way to have to take the course twice."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1527723075, "post_id": 50614491, "comment_id": 88239121, "body": "If buying text books and food simultaneously is a problem, as it often is with students, here&#39;s a link to a good stop-gap since you are already familiar with programming: <a href=\"https://isocpp.org/tour\" rel=\"nofollow noreferrer\">isocpp.org/tour</a> . It&#39;s terse, but it&#39;s free."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1527722537, "post_id": 50614550, "comment_id": 88238997, "body": "This is basically treating <code>flow</code> as a pointer to a 2-d array in row-major order, and incrementing <code>flow[i][j]</code>."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1527724358, "post_id": 50614550, "comment_id": 88239417, "body": "Yes, and that&#39;s more of a C-thing to do rather than C++. In C++, you&#39;d probably just overload []."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527749777, "post_id": 50614550, "comment_id": 88246459, "body": "More accurately, the multiplication operator <code>*</code> has highest precedence so <code>i</code> binds to <code>n</code> and <code>i*n</code> is calculated first. From thereon, the <code>+</code> operator has left-to-right associativity,  so <code>flow + i*n</code> is calculated next, the result of the expression being of same pointer type as <code>flow</code>. And then that result <code>+ j</code> is calculated, the result again being of the same pointer type. Meaning that strictly speaking <code>i*n + j</code> is never calculated. Does it matter? Well maybe, <code>i*n+j</code> could in theory give an integer overflow which won&#39;t necessarily happen with pointer arithmetic."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 5, "last_activity_date": 1527758968, "last_edit_date": 1527758968, "creation_date": 1527722203, "answer_id": 50614550, "question_id": 50614491, "link": "https://stackoverflow.com/questions/50614491/what-does-flow-in-j-mean-in-c-i-have-no-idea-what-this-topic-is-called/50614550#50614550", "title": "what does *(flow + i*n + j) mean in C? I have no idea what this topic is called", "body": "<p>It's hard to be sure without more context, but given the expression</p>\n\n<pre><code> *(flow + i*n + j) += minFlowPath;\n</code></pre>\n\n<p>it's likely that <code>flow</code> is a pointer.  The subexpression <code>flow + i*n + j</code> constitutes <em>pointer arithmetic</em>.  Addition of a pointer and an integer yields a new pointer pointing to an element counted beyond the original pointer, so here we're pointing to the element which is <code>i*n + j</code> elements beyond wherever <code>flow</code> points.  (As Barmar points out in a comment, this suggests that <code>flow</code> is being treated as a flattened 2D array, accessing the <code>i,j</code>th element.)</p>\n\n<p>Given any pointer or pointer-valued expression, the unary <code>*</code> operator access the value that the pointer points to.  So</p>\n\n<pre><code> *(flow + i*n + j)\n</code></pre>\n\n<p>is the value which is <code>i*n + j</code> past whatever <code>flow</code> points to.</p>\n\n<p>When you access a pointer using <code>*</code> in this way, you get something called an <em>lvalue</em>, a technical term meaning that you can do more than just fetch the pointed-to value, you can also <em>modify</em> the pointed-to value.  And that's exactly what we do here.  C's <code>+=</code> operator adds to a value, in-place.  So whatever the pointed-to value was, we add the value <code>minFlowPath</code> to it.</p>\n\n<p>To learn more about this, read up on <em>pointer arithmetic</em>, <em>pointer indirection</em>, and <em>assignment operators</em>.</p>\n"}], "owner": {"reputation": 13, "user_id": 3424522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2c383244b37f63873a8dfad35a3977?s=128&d=identicon&r=PG&f=1", "display_name": "user3424522", "link": "https://stackoverflow.com/users/3424522/user3424522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1527740451, "answer_count": 1, "score": -5, "last_activity_date": 1527758968, "creation_date": 1527721679, "last_edit_date": 1527722001, "question_id": 50614491, "link": "https://stackoverflow.com/questions/50614491/what-does-flow-in-j-mean-in-c-i-have-no-idea-what-this-topic-is-called", "closed_reason": "Needs more focus", "title": "what does *(flow + i*n + j) mean in C? I have no idea what this topic is called", "body": "<p>I am new to C and C++ Programming however I saw in my Algorithms class(I transferred from a Java oriented school to a C++ oriented curriculum) that I had no idea what this meant:  </p>\n\n<pre><code>*(flow + i*n + j) += minFlowPath;\n</code></pre>\n\n<p>I am not sure what this pointer thing is called. I want to learn the logic of what that means and what is being stored. Thank you\nPlease redirect me.</p>\n"}, {"tags": ["c", "file", "pipe", "fork", "stdin"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527721762, "post_id": 50614486, "comment_id": 88238815, "body": "There&#39;s no &quot;should&quot; about it. One process cannot close a different process&#39;s files, no matter what the relationship may be between the processes or the files."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527722008, "post_id": 50614486, "comment_id": 88238881, "body": "On the other hand, you very much should check the return values of your function calls, at least when you care whether they succeeded."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1527722340, "post_id": 50614486, "comment_id": 88238954, "body": "Also, since the parent creates all the pipes in advance, every child needs to close the write end of every pipe, except the one, if any, it is going to use.  For its part, the parent needs to close each write end <i>before</i> waiting on the child that&#39;s reading from that pipe."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527722557, "post_id": 50614486, "comment_id": 88239003, "body": "Overall, I think this question would be much easier to answer if it were reduced to a <i>bona fide</i> <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527722849, "post_id": 50614486, "comment_id": 88239070, "body": "It would probably be better to create just one pipe in each iteration of the fork/exec loop, rather than creating them all ahead of time."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527722963, "post_id": 50614486, "comment_id": 88239095, "body": "The parent needs wait until after it has created all the children before calling <code>wait()</code>. Then it should call it in a loop until there are no children. Or it could just wait for the last child."}], "owner": {"reputation": 475, "user_id": 6632592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9385343c8b8b01b484af9c19f7cb4e02?s=128&d=identicon&r=PG&f=1", "display_name": "Kareem Aboughazala", "link": "https://stackoverflow.com/users/6632592/kareem-aboughazala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 480, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527721636, "creation_date": 1527721636, "question_id": 50614486, "link": "https://stackoverflow.com/questions/50614486/calling-dup2-in-child-process-causing-parents-stdin-to-close", "title": "calling dup2 in child process causing parent&#39;s stdin to close", "body": "<p>I am trying to write a custom shell in C that supports multiple pipes using <code>fork</code>, <code>dup2</code> and <code>pipe</code>. My approach is for <code>c1 | c2 | c3</code>, create a 2 x 2 matrix to store two pipes, fork three child processes sequentially, call <code>dup2</code> to duplicate <code>stdin</code> and <code>stdout</code> to the correct pipe then call <code>exec</code>. </p>\n\n<p>The shell works fine for the following commands: <code>\"echo foo\"</code>, <code>\"ls | grep something | wc\"</code>. But for some reason when I execute a line containing only one pipe like for example <code>\"ls | grep something\"</code>, the shell executes this command as expected but exits without waiting to read more lines. I spent hours trying to figure out why it exists when given a line with one pipe but works fine with more than one pipe but had no luck. </p>\n\n<p>Here is the code that creates the child processes and runs the commands:</p>\n\n<pre><code>int main()\n{\n    char input_line[1000];\n    size_t size;\n    size_t chars;\n\n    while(fgets(input_line, sizeof(input_line), stdin))\n    {\n        input_line[strcspn(input_line, \"\\n\")] = 0;\n        struct PARSE_INFO* parse_info = initialize_parseInfo();\n        Parse(input_line, parse_info);\n        int num_commands = parse_info-&gt;num_commands;\n        int num_pipes = parse_info-&gt;num_pipes;\n        int pipes[num_pipes][2];\n        bool piping = num_pipes &gt; 0;\n\n        // Piping the pipes\n        for(int i = 0; i &lt; num_pipes; i++)\n            pipe(pipes[i]);\n\n        int i;\n        for(i = 0; i &lt; num_commands; i++)\n        {\n            struct COMMAND* command = (parse_info-&gt;commands)[i];\n            int num_args = command-&gt;argnum;\n\n            char* newargv[num_args + 2];\n            create_argv(command, newargv, \"/usr/bin\");  \n\n            int pid = fork();\n\n            if(pid == 0) // Child\n            {\n                char* newenviron[] = { NULL };       \n\n                if(piping)\n                {\n                    if(i &lt; num_commands - 1) // Not at end of pipe so write to next pipe\n                    {\n                        dup2(pipes[i][1], STDOUT_FILENO);\n                    }\n                    if(i &gt; 0)                       // Not at beginning of pipe so read from previous pipe\n                    {\n                        dup2(pipes[i - 1][0], STDIN_FILENO);\n                        close(pipes[i -1][0]);\n                    }\n                }\n                execve(newargv[0], newargv, newenviron);\n                perror(\"execve\");\n            }\n            else  // Parent\n            {\n                int status = 0;\n                wait(&amp;status);\n                close(pipes[i][1]);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I tested the functions called here independently and they seem to work fine so I chose not to include them to reduce clutter. I suspect that I am not closing the pipes correctly. What's puzzling me is that, if I understand this correctly, calling <code>dup2</code> in a child process should only modify the file descriptors in that process and not affect the parent process, I am not sure why it's causing <code>stdin</code> to close in the parent process. </p>\n\n<p>During my debugging efforts, I tried reading some input from <code>stdin</code> at the end of the while loop by adding this code after the else block:</p>\n\n<pre><code>char someinput[256];\nfgets(someinput, sizeof(someinput), stdin);\nprintf(\"End of loop input: %s\\n\");\n</code></pre>\n\n<p>The program still terminated and did not wait to read any input. I tried printing someinput and it contained the command inputed from stdin at the beginning of the loop using from first call to fgets.  Any help would be really appreciated! </p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1527721554, "post_id": 50614424, "comment_id": 88238757, "body": "<code>struct result * result_elements</code> is a pointer."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1527724465, "post_id": 50614424, "comment_id": 88239443, "body": "You&#39;re trying to initialize a pointer with a structure value. Perhaps you mean <code>struct result * result_elements = &amp;(struct result){ NULL, 0 };</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1527744093, "post_id": 50614475, "comment_id": 88244030, "body": "Or <code>&amp;(struct result){NULL, 0}</code>"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 3, "last_activity_date": 1527722210, "last_edit_date": 1527722210, "creation_date": 1527721587, "answer_id": 50614475, "question_id": 50614424, "link": "https://stackoverflow.com/questions/50614424/excess-elements-in-scalar-initializer-for-struct/50614475#50614475", "title": "Excess elements in scalar initializer for struct", "body": "<p>This is a pointer</p>\n\n<pre><code>struct result * result_elements /**/;\n</code></pre>\n\n<p>You try to initialise it with</p>\n\n<pre><code>{ NULL, 0 }\n</code></pre>\n\n<p>You could initialise it e.g. with a scalar initialiser like</p>\n\n<pre><code>NULL\n</code></pre>\n\n<p>You could initialise a separate (non-pointer) variable with your non-scalar initialiser, e.g.</p>\n\n<pre><code>struct result avariable = { NULL, 0 };\n</code></pre>\n\n<p>And then you could initialise your pointer like</p>\n\n<pre><code>struct result * result_elements = &amp;avariable;\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 8548624, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/8fbd984504893a8592288bd056455cb7?s=128&d=identicon&r=PG&f=1", "display_name": "Hews", "link": "https://stackoverflow.com/users/8548624/hews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3211, "favorite_count": 1, "accepted_answer_id": 50614475, "answer_count": 1, "score": 3, "last_activity_date": 1527722210, "creation_date": 1527721222, "question_id": 50614424, "link": "https://stackoverflow.com/questions/50614424/excess-elements-in-scalar-initializer-for-struct", "title": "Excess elements in scalar initializer for struct", "body": "<p>I have a struct called <code>result</code> that has the following definition:</p>\n\n<pre><code>struct result {\nvoid** elements;\nsize_t n_elements;\n};\n</code></pre>\n\n<p>But when I try to initialise it with the following properties <code>{ NULL, 0 }</code> I receive the following warning:</p>\n\n<pre><code>warning: excess elements in scalar initializer\nstruct result * result_elements = { NULL, 0 };\n</code></pre>\n\n<p>Is this an error because it's expecting a 2D array? If so, I thought NULL was permissible?</p>\n\n<p>Cheers :) </p>\n"}, {"tags": ["c", "binary-search-tree"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1527721221, "post_id": 50614411, "comment_id": 88238657, "body": "I suggest you read this next <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 119, "user_id": 9872992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1ac119fcfbd4732e3c7abe93a0cfe8?s=128&d=identicon&r=PG&f=1", "display_name": "Impropio", "link": "https://stackoverflow.com/users/9872992/impropio"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1527721326, "post_id": 50614411, "comment_id": 88238690, "body": "The code compiles and works with a lot of trees, but there are some cases (unknown to me because I don&#39;t make the test) that it does fail"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1527721752, "post_id": 50614411, "comment_id": 88238813, "body": "I&#39;m sure that article is able to help you with that too."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1527729612, "post_id": 50614411, "comment_id": 88240615, "body": "What behavior do you expect from <code>AbsoluteDifference</code>?  You may be surprised to know it will always return 1 no matter what arguments you supply...  Except perhaps when integer overflow occurs."}, {"owner": {"reputation": 119, "user_id": 9872992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1ac119fcfbd4732e3c7abe93a0cfe8?s=128&d=identicon&r=PG&f=1", "display_name": "Impropio", "link": "https://stackoverflow.com/users/9872992/impropio"}, "edited": false, "score": 0, "creation_date": 1527729867, "post_id": 50614411, "comment_id": 88240657, "body": "My mistake, it&#39;s supposed to be a Boolean function"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1527730117, "post_id": 50614411, "comment_id": 88240704, "body": "Yet it still serves no purpose.  You may as well just say <code>avl = 1</code>.  I also suggest you supply code that compiles, when asking a question."}], "owner": {"reputation": 119, "user_id": 9872992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d1ac119fcfbd4732e3c7abe93a0cfe8?s=128&d=identicon&r=PG&f=1", "display_name": "Impropio", "link": "https://stackoverflow.com/users/9872992/impropio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527730207, "creation_date": 1527721175, "last_edit_date": 1527730207, "question_id": 50614411, "link": "https://stackoverflow.com/questions/50614411/why-is-my-code-for-checking-if-a-bst-tree-is-avl-wrong", "title": "Why is my code for checking if a BST tree is AVL wrong?", "body": "<p>Hi I wrote this code that checks if a given BST is AVL or not, and in my mind it works but in the test it doesn't. \nThe structure is a classic BST, with an integer, left and right.</p>\n\n<pre><code>bool AbsoluteDifference(int a, int b)\n{\nreturn ((a-b) &lt;= 1)) ||(b-a) &lt;= 1)); \n} \n\n void aux_avl (BST b , int &amp;l_var, bool &amp;isAVL)\n{\nif (b == NULL)\n  l_var--;  \n  //In consecuence of not asking if the left or right is NULL or not\n  //when I make the recursive call, if it is I have to decrease the value\nelse if (isAVL == true)//I don't want to keep checking if I already know that it's not AVL\n\n{\n\n   int l_left = l_var + 1;\n   aux_avl(b-&gt;left,l_left,isAVL);\n\n   int l_right = l_var +1;\n   aux_avl(b-&gt;right, l_right,isAVL); \n\n   isAVL = AbsoluteDifference(l_left,l_right);\n\n   lvar = max(l_left,l_right);\n}\n}\n\nbool is_AVL(BST b)\n{\n   if (b == NULL)\n      return true;\n   else\n  {\n     int l_var =0;\n     bool isAVL = true;\n     auxavl(b,l_var,isAVL);\n\n     return isAVL;\n  }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527717926, "post_id": 50613839, "comment_id": 88237781, "body": "Please see <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input/28462221#28462221\">Removing trailing newline character from fgets() input</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527718053, "post_id": 50613839, "comment_id": 88237820, "body": "Perhaps your first and second names are longer than 3 characters (5 to include newline and string terminator). If the first is longer, the excess won&#39;t be thrown away but read into the second <code>fgets</code>. Don&#39;t be mean with your buffer size."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527719206, "post_id": 50613839, "comment_id": 88238133, "body": "As I understand it you are entering a 4-character name first, such as <b>four</b> and so as the buffer has only 5 (incl terminator) the trailing newline is read as the second input, so of  course the second <code>printf</code> does not show anything."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1527721725, "post_id": 50613839, "comment_id": 88238805, "body": "<code>size_t len = strlen(buffer)-1;</code> strlen() can return zero."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1527791891, "last_edit_date": 1527791891, "creation_date": 1527782111, "answer_id": 50628331, "question_id": 50613839, "link": "https://stackoverflow.com/questions/50613839/printf-and-fgets-dont-remove-the-line-break/50628331#50628331", "title": "printf and fgets don&#39;t remove the line break", "body": "<blockquote>\n  <p>When I put \"four\" in after the first printf, then I can't write in the second printf.</p>\n</blockquote>\n\n<p>The user is not only typing <kbd>f</kbd><kbd>o</kbd><kbd>u</kbd><kbd>r</kbd>, but also <kbd>enter</kbd>.  So the true <em>line</em> of input is 5 characters of <code>\"four\\n\"</code>.</p>\n\n<p>The following code will only read 4 characters into <code>buffer[5]</code>, leave the <code>'\\n\"</code> in <code>stdin</code> for the next <code>fgets()</code>.   <code>fgets()</code>  read one less than 5 to leave  room for the appended <em>null character</em>.</p>\n\n<pre><code>char buffer[5]= {0};\nfgets(buffer,sizeof(buffer),stdin);\n</code></pre>\n\n<hr>\n\n<p>Avoid too small a buffer, instead recommend 2x the largest expected size.  E.g. <a href=\"http://www.historyrundown.com/top-5-people-with-the-longest-names/\" rel=\"nofollow noreferrer\">longest name</a></p>\n\n<pre><code>#define NAME_MAX 585\n#define BUF_SIZE ((NAME_MAX + 1 /* \\n */ + 1 /* \\0 */)*2)\nchar buffer[BUF_SIZE] = {0};\nprintf(\"Put your name: \");  \nif (fgets(buffer,sizeof buffer,stdin)) {\n  // process buffer only if `fgets()` succeeds\n</code></pre>\n\n<hr>\n\n<p>Avoid a hacker exploit.  The following is certainly UB should the nefarious user enter a <em>null character</em> as the first character.  <kbd>Ctrl @</kbd><kbd>o</kbd><kbd>u</kbd><kbd>r</kbd><kbd>enter</kbd>.</p>\n\n<pre><code>size_t len = strlen(buffer)-1;\nif (buffer[len] == '\\n')\n</code></pre>\n\n<p>Instead</p>\n\n<pre><code>size_t len = strlen(buffer);\nif (len &gt; 0 &amp;&amp; buffer[len-1] == '\\n') {\n  buffer[--len] = '\\0';\n}\n\n// Now use `buffer and `len`\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9790886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ad5d63e3c9fa1a15f5fc0ba987db15?s=128&d=identicon&r=PG&f=1", "display_name": "jhonnna", "link": "https://stackoverflow.com/users/9790886/jhonnna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 50628331, "answer_count": 1, "score": 1, "last_activity_date": 1527791891, "creation_date": 1527717160, "last_edit_date": 1527781543, "question_id": 50613839, "link": "https://stackoverflow.com/questions/50613839/printf-and-fgets-dont-remove-the-line-break", "title": "printf and fgets don&#39;t remove the line break", "body": "<p>When I put <code>\"four\"</code> in after the first <code>printf</code>, then I can't write in the second <code>printf</code>. </p>\n\n<p>Why does this happen?   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char buffer[5]= {0};\n    char buffer2[5]= {0};\n\n    printf(\"Put your name: \"); //i put four\n    fgets(buffer,sizeof(buffer),stdin);\n    size_t len = strlen(buffer)-1;\n\n    if (buffer[len] == '\\n')\n        buffer[len] = '\\0';\n\n    printf(\"Put your second name: \");\n    fgets(buffer2,sizeof(buffer2),stdin);\n    printf(\"%s\",buffer2);\n}\n</code></pre>\n"}, {"tags": ["c", "static", "compiler-construction"], "comments": [{"owner": {"reputation": 18613, "user_id": 818182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/89b420763192c3b763f4cffa789fe39f?s=128&d=identicon&r=PG", "display_name": "Austin Brunkhorst", "link": "https://stackoverflow.com/users/818182/austin-brunkhorst"}, "edited": false, "score": 1, "creation_date": 1527716701, "post_id": 50613707, "comment_id": 88237394, "body": "I think this is mainly a result of avoiding introduction of new keywords to the language at all costs."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527716894, "post_id": 50613707, "comment_id": 88237464, "body": "Nothing to understand here. The language is designed this way. You may also ask why <code>to have</code> has so many meanings and functions in English."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527717189, "post_id": 50613707, "comment_id": 88237568, "body": "Hey,  <code>const</code> is another candidate."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1527717981, "post_id": 50613707, "comment_id": 88237797, "body": "Unfortunately this answer is now closed and the duplicate is closed as well... C Committee tried to limit the introduction of new keywords for compatibility with existing code that used the keyword as an identifier. They tried to overwork or overload existing keywords as much as possible."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1527718023, "post_id": 50613707, "comment_id": 88237812, "body": "Quoting C Rationale document: <i>&quot;Where possible, however, new features have been added by overloading existing keywords, as, for example, long double instead of extended. It is recognized that each added keyword will require some existing code that used it as an identifier to be rewritten. No meaningful programs are known to be quietly changed by adding the new keywords.&quot;</i>"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1527718146, "post_id": 50613707, "comment_id": 88237851, "body": "They also admitted it causes some confusion for storage-class specifier. <i>&quot;C89 separated from the overloaded keywords for storage classes the various concepts of scope, linkage, name space, and storage duration. This has traditionally been a major area of confusion.&quot;</i>"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1527725582, "post_id": 50613707, "comment_id": 88239740, "body": "Decisions 1-3 were taken not by the C committee but by Kernighan and Ritchie. Unfortunately. Probably a mishmash of opinion and backwards compatibility. Off topic."}, {"owner": {"reputation": 149, "user_id": 4838766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fze4q.png?s=128&g=1", "display_name": "adamj537", "link": "https://stackoverflow.com/users/4838766/adamj537"}, "edited": false, "score": 0, "creation_date": 1527726063, "post_id": 50613707, "comment_id": 88239840, "body": "Thanks for the informative comments! I understand that my question is a duplicate (oops!) but shouldn&#39;t one of the two questions be open for new answers?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1527753388, "post_id": 50613707, "comment_id": 88248415, "body": "Then you get to C++ and class members... :((   OP is right - there is too much keyword overloading in these languages:("}], "owner": {"reputation": 149, "user_id": 4838766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fze4q.png?s=128&g=1", "display_name": "adamj537", "link": "https://stackoverflow.com/users/4838766/adamj537"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1527716822, "answer_count": 0, "score": 2, "last_activity_date": 1527716358, "creation_date": 1527716358, "question_id": 50613707, "link": "https://stackoverflow.com/questions/50613707/why-does-static-keyword-have-such-varied-usage-in-c", "closed_reason": "Duplicate", "title": "Why does &quot;static&quot; keyword have such varied usage in C?", "body": "<p>I'm familiar with several uses for the keyword \"static\" in C:</p>\n\n<ul>\n<li>Static variables within a function will maintain their value between function calls.</li>\n<li>Static (global) variables in a file cannot be accessed outside the file they're declared in.</li>\n<li>Static functions cannot be accessed outside the file they're declared in.</li>\n<li><a href=\"https://stackoverflow.com/questions/3430315/what-is-the-purpose-of-static-keyword-in-array-parameter-of-function-like-char\">This obscure use as part of an array type declaration as an argument to a function.</a></li>\n</ul>\n\n<p>The first use has to do with an entity's <em>lifetime</em>, the second and third uses have to do with an entity's <em>visibility</em>, the fourth use has to do with <em>optimization</em>, and it seems strange to me that one keyword would act so differently depending on where it is used.  Is there some strange detail of how static is usually implemented in compilers that makes it easy for this one keyword to do all of the above?  What is the underlying functionality that \"static\" provides which results in these varied behaviors?</p>\n"}, {"tags": ["c", "vector", "allocation"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527716081, "post_id": 50613633, "comment_id": 88237173, "body": "<code>fscanf</code> is taking more than 2 parameters."}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 1, "creation_date": 1527716801, "post_id": 50613633, "comment_id": 88237431, "body": "MULTIPLE error. Uninitializes variables (<code>count</code> and others), wrong used fscanf. I guesss compiler give many warnings and You ignore it"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1527717194, "post_id": 50613633, "comment_id": 88237570, "body": "enabling the warnings and reading them would allow to avoid most errors..."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7763625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26ef2b6521f4402f5534f4c0e9bd5e61?s=128&d=identicon&r=PG&f=1", "display_name": "themarksmaker", "link": "https://stackoverflow.com/users/7763625/themarksmaker"}, "edited": false, "score": 0, "creation_date": 1527716897, "post_id": 50613720, "comment_id": 88237467, "body": "solved it, thanks!!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1527716396, "creation_date": 1527716396, "answer_id": 50613720, "question_id": 50613633, "link": "https://stackoverflow.com/questions/50613633/c-program-stopped-working-after-using-scanf-instead-of-var-0/50613720#50613720", "title": "C Program stopped working after using scanf instead of var=0", "body": "<p>Two issues here, both in <code>main</code>.  First:</p>\n\n<pre><code>fscanf(\"%d\", &amp;z);\n</code></pre>\n\n<p>This function expects a <code>FILE *</code> for the first argument, which you didn't specify.  Presumably you wanted to read from the console instead, so use <code>scanf</code>:</p>\n\n<pre><code>scanf(\"%d\", &amp;z);\n</code></pre>\n\n<p>Second issue:</p>\n\n<pre><code>fprintf(g,\"%d %d\", functie(v,nr,z));\n</code></pre>\n\n<p>Your format string is expecting two integer arguments, but you're only passing in one.  Get rid of the extra format specifier:</p>\n\n<pre><code>fprintf(g,\"%d\", functie(v,nr,z));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 2961275, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/14ed23ee520952babad27e84c593e3c1?s=128&d=identicon&r=PG&f=1", "display_name": "JackLThornton", "link": "https://stackoverflow.com/users/2961275/jacklthornton"}, "is_accepted": false, "score": 0, "last_activity_date": 1527716857, "creation_date": 1527716857, "answer_id": 50613785, "question_id": 50613633, "link": "https://stackoverflow.com/questions/50613633/c-program-stopped-working-after-using-scanf-instead-of-var-0/50613785#50613785", "title": "C Program stopped working after using scanf instead of var=0", "body": "<p>fscanf will not be delimited by newlines. Best thing to do is eat through file a line at a time with fgets. So, add a line buffer to the top of main:</p>\n\n<pre><code>char line[16];  // assuming integers will actually be small\n</code></pre>\n\n<p>After opening your file as above with 'f':</p>\n\n<pre><code>if (fgets(line, sizeof(line), f))\n{\n    int count = atoi(line);\n    int *v = (int *) malloc(count * sizeof(int));\n    for (int i = 0; i &lt; count &amp;&amp; fgets(line, sizeof(line), f); ++i)\n    {\n        v[i] = atoi(line);\n    }\n}\n</code></pre>\n\n<p>You should absolutely add error checking to the above, which is minimal and for concept only (e.g. guard against bad input, buffer overflow, exceptions, count being wrong leaving you uninitialized integers at the end of the array, etc.) as this will only work if your input file is perfect. Note that 16 is generally a ridiculously small length for a line buffer. Also only do your logic against your vector if (a) the file opens, and (b) passes the first test, which is an integral number of entries.</p>\n"}], "owner": {"reputation": 31, "user_id": 7763625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26ef2b6521f4402f5534f4c0e9bd5e61?s=128&d=identicon&r=PG&f=1", "display_name": "themarksmaker", "link": "https://stackoverflow.com/users/7763625/themarksmaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1527860378, "accepted_answer_id": 50613720, "answer_count": 2, "score": -2, "last_activity_date": 1527716857, "creation_date": 1527715957, "question_id": 50613633, "link": "https://stackoverflow.com/questions/50613633/c-program-stopped-working-after-using-scanf-instead-of-var-0", "closed_reason": "Not suitable for this site", "title": "C Program stopped working after using scanf instead of var=0", "body": "<p>So I have this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint functie ( int v[], int nr, int z)\n{\n    int i,count;\n    scanf(\"%d\", &amp;z);\n    for(i=0;i&lt;nr;i++) {\n        if(z==v[i]) {\n            count=count+1;\n        }\n    }\n    return z;\n}\n\nint main()\n{\n    int i,nr,z;\n    fscanf(\"%d\", &amp;z);\n    FILE *f;\n    FILE *g;\n    f=fopen(\"data-in.txt\", \"r\");\n    fscanf(f,\"%d\",&amp;nr);\n    int *v=malloc(nr*sizeof(int));\n    for(i=0;i&lt;nr;i++) {\n        fscanf(f,\"%d\",&amp;v[i]);\n    }\n    g=fopen(\"data-out.txt\", \"w\");\n    fprintf(g,\"%d %d\", functie(v,nr,z));\n    fclose(f);\n    fclose(g);\n    free(v);\n}\n</code></pre>\n\n<p>and before I had int z=0; instead of trying to scanf my var z.\nWhen I run this I get a stopped working error.</p>\n\n<p>I have an array with numbers (integers) read from file, first line is the number of elements and second line the elements.\nI need a var lets say z to check how many times an element appears in vector (check if scanned number z is equal to an element and +1 count )</p>\n\n<p>example:</p>\n\n<p>in file</p>\n\n<p>4 (cuz I have 4 elements )</p>\n\n<p>1 2 3 3 ( my elements )</p>\n\n<p>than scan z as 3\nz==3 true \ncount=1\nagain\ncount=2</p>\n"}, {"tags": ["c", "image-processing", "copy", "freeimage"], "comments": [{"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1527718674, "post_id": 50613552, "comment_id": 88238004, "body": "You don&#39;t need to copy the image, you just need to allocate a buffer (or 3) that you can write to while filtering. Using <code>malloc</code> just like you did here. After filtering you can free the memory for the original image if  you don&#39;t need that any more, and have that image point to the new buffers."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8297986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/987bc62d08d20c2a328d416bdc3b1fec?s=128&d=identicon&r=PG&f=1", "display_name": "Cmylife", "link": "https://stackoverflow.com/users/8297986/cmylife"}, "edited": false, "score": 0, "creation_date": 1527808858, "post_id": 50623305, "comment_id": 88278300, "body": "Actually it doesn&#39;t copy the contents of the pixels. But just creating the buffer and doing a sweep pixel by pixel copying it gives me what I want"}], "tags": [], "owner": {"reputation": 455, "user_id": 4855828, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/O1jE2.jpg?s=128&g=1", "display_name": "Cryckx", "link": "https://stackoverflow.com/users/4855828/cryckx"}, "is_accepted": false, "score": 2, "last_activity_date": 1527767462, "last_edit_date": 1527767462, "creation_date": 1527766364, "answer_id": 50623305, "question_id": 50613552, "link": "https://stackoverflow.com/questions/50613552/c-best-way-to-make-a-buffer-copy-of-an-image-map/50623305#50623305", "title": "C: Best way to make a buffer copy of an Image Map", "body": "<p>If you want to improve performances,you should try to avoid copies which are time-consuming specially for large arrays.</p>\n\n<p>But I assume you can't, so there is a solution :</p>\n\n<pre><code>Image imgCopy;\nimgCopy.width  = img.width \nimgCopy.height  = img.height\n</code></pre>\n\n<p>In a first time you allocate memory :</p>\n\n<pre><code>imgCopy.r = (float*)malloc(sizeof(float) * imgCopy.width * imgCopy.height );\nimgCopy.g = (float*)malloc(sizeof(float) * imgCopy.width * imgCopy.height );\nimgCopy.b = (float*)malloc(sizeof(float) * imgCopy.width * imgCopy.height );\n</code></pre>\n\n<p>Then you can copy the pointer's content :</p>\n\n<pre><code>*(imgCopy.r) = *(img.r);\n*(imgCopy.g) = *(img.r);\n*(imgCopy.b) = *(img.r);\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8297986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/987bc62d08d20c2a328d416bdc3b1fec?s=128&d=identicon&r=PG&f=1", "display_name": "Cmylife", "link": "https://stackoverflow.com/users/8297986/cmylife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527767462, "creation_date": 1527715472, "question_id": 50613552, "link": "https://stackoverflow.com/questions/50613552/c-best-way-to-make-a-buffer-copy-of-an-image-map", "title": "C: Best way to make a buffer copy of an Image Map", "body": "<p>I have a struct that basically has these contents:</p>\n\n<pre><code>typedef struct {\n  unsigned int width, height;\n  float *r, *g, *b;\n} image;\n</code></pre>\n\n<p>Using the FreeImage.h library I am able to open a certain image and associate the pixels with its RGB colours. So the code is as follows:</p>\n\n<pre><code>imagem open_image(char *name_of_file) {\n  FIBITMAP *bitmapIn;\n  int x, y;\n  RGBQUAD color;\n  image I;\n\n  bitmapIn = FreeImage_Load(FIF_JPEG, name_of_file, 0);\n\n  if (bitmapIn == 0) {\n    printf(\"Error! File not found - %s\\n\", name_of_file);\n  } else {\n    printf(\"File found!\\n\");\n   }\n\n  x = FreeImage_GetWidth(bitmapIn);\n  y = FreeImage_GetHeight(bitmapIn);\n\n  I.width = x;\n  I.height = y;\n  I.r = malloc(sizeof(float) * x * y);\n  I.g = malloc(sizeof(float) * x * y);\n  I.b = malloc(sizeof(float) * x * y);\n\n   for (int i=0; i&lt;x; i++) {\n     for (int j=0; j &lt;y; j++) {\n      int idx;\n      FreeImage_GetPixelColor(bitmapIn, i, j, &amp;color);\n\n      idx = i + (j*x);\n\n      I.r[idx] = color.rgbRed;\n      I.g[idx] = color.rgbGreen;\n      I.b[idx] = color.rgbBlue;\n    }\n   }\n  return I;\n}\n</code></pre>\n\n<p>So now when I call the function in my main file like:</p>\n\n<pre><code>image img = open_image(\"file_name\");\n</code></pre>\n\n<p>I have my image \"map\" in my reference named img.</p>\n\n<p>Basically what I want to know is what is the best way to make a copy of this img so that I can apply a filter in this buffer img, for exemple a blur filter. That way when I get the surrounding pixels values to write to the central one, it is always the original pixels so get the pixels from \"img\" and write them with the filter to the \"img_buffer\".</p>\n\n<p>I guess I could just make another reference named img_buff and call the open_image function again but that takes to much real and user time.</p>\n\n<p>So how would you suggest I made the copy? From my research I found that memcpy() maybe won't do the trick since it gives me a shallow copy but not to sure about it.</p>\n\n<p>Any suggestion that won't take to much more real/user time is welcome!</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527712417, "post_id": 50612935, "comment_id": 88235819, "body": "What is the point of right-padding a line with spaces - you would not be able to see them?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527712931, "post_id": 50612935, "comment_id": 88236009, "body": "@NeilButterworth Most likely this will have something else concatenated after it. Notice that there&#39;s no newline."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 2, "creation_date": 1527713192, "post_id": 50612935, "comment_id": 88236083, "body": "The question is tagged C++, so why are you using C style formatting via <code>sprintf()</code> at all, and not C++ style formatting via <code>std::ostream</code>, such as <code>std::ostringstream</code>? You can pad and align the output using the <a href=\"http://en.cppreference.com/w/cpp/io/manip/setw\" rel=\"nofollow noreferrer\"><code>std::setw()</code></a> and <a href=\"http://en.cppreference.com/w/cpp/io/manip/left\" rel=\"nofollow noreferrer\"><code>std::left</code></a> stream manipulators."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527713839, "post_id": 50612935, "comment_id": 88236360, "body": "<a href=\"https://ideone.com/EpihqE\" rel=\"nofollow noreferrer\">Live Demo for C++</a>"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527713844, "post_id": 50612935, "comment_id": 88236362, "body": "@RemyLebeau: TBH, even in C++ I&#39;d use <code>sprintf</code> (actually, my wrapper which handles the buffer by itself and returns an <code>std::string</code>), way more concise and easier to read, without all those stupid formatters (and the time lost to check which is sticky and which is not) in the way. Then to pad right I&#39;d just call <code>.resize(20, &#39; &#39;)</code>. <code>oss &lt;&lt; std::setfill(&#39;0&#39;) &lt;&lt; std::setw(2) &lt;&lt; month &lt;&lt; &quot;&#47;&quot; &lt;&lt; std::setw(2) &lt;&lt; day &lt;&lt; &quot;&#47;&quot; &lt;&lt; std::setw(4) &lt;&lt; year;</code> - seriously? I cannot even see that we are talking about a date in <code>mm&#47;dd&#47;yyyy</code> format without parsing through a row of line noise."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527714138, "post_id": 50612935, "comment_id": 88236465, "body": "@MatteoItalia perhaps, but the C++ way is much safer. Too many times, people get the <code>printf</code> format string wrong (case in point)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1527714176, "post_id": 50612935, "comment_id": 88236489, "body": "<code>sprintf(lcdContent_line1, &quot;%-19s&quot;, lcdContent_line1);</code> has the source and destination overlap.  This is <i>undefined behavior</i> and a wrong solution.  Better to post your answer as an answer below than appending to the question.  The question needs a bit more detail and your answer is wrong.  DV until repaired."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527714930, "post_id": 50612935, "comment_id": 88236758, "body": "@RemyLebeau: <a href=\"https://ideone.com/5VDW4T\" rel=\"nofollow noreferrer\">that&#39;s why you have to domesticate it a bit...</a>"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527715147, "post_id": 50612935, "comment_id": 88236836, "body": "@MatteoItalia C++11 and later have <a href=\"http://en.cppreference.com/w/cpp/io/manip/put_time\" rel=\"nofollow noreferrer\"><code>std::put_time()</code></a>, which is closer to the <code>printf</code> functionality without losing safety.  I updated <a href=\"https://ideone.com/EpihqE\" rel=\"nofollow noreferrer\">my demo</a> to show it"}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1527715353, "post_id": 50612935, "comment_id": 88236916, "body": "@RemyLebeau: that&#39;s nice and everything for this use case, but I still find absurd that C++ still doesn&#39;t have a type-safe, placeholder-based formatting straight in the standard."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1527715426, "post_id": 50612935, "comment_id": 88236944, "body": "@MatteoItalia feel free to write your own implementation and submit it to the C++ committee for review."}], "answers": [{"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": true, "score": 3, "last_activity_date": 1527713202, "last_edit_date": 1527713202, "creation_date": 1527712537, "answer_id": 50612979, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50612979#50612979", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>AFAIK there's no way to do it in a single step; your second example is wrong because input and output overlap (actually, they are the same string), and this is definitely not allowed.</p>\n\n<p>You may fix it by using a separate buffer and let an <code>sprintf</code> pad your string, or you may come up with more clever stuff, such as</p>\n\n<pre><code>for(int i = sprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\n    i &lt; 20; ++i) lcdContent_line1[i] = ' ';\nlcdContent_line1[20] = 0;\n</code></pre>\n\n<p>to pad it inplace. </p>\n\n<p>But honestly, in this case the easiest solution is probably</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%02d/%02d/%04d          \", month, day, year);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "edited": false, "score": 0, "creation_date": 1527873563, "post_id": 50613184, "comment_id": 88307153, "body": "I&#39;m not sure I understand what you mean by 10 circa about. Could you clarify this solution? What does the %*c formatting do? Why are their 5 arguments but only 4 format placeholders?"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "reply_to_user": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "edited": false, "score": 0, "creation_date": 1527877236, "post_id": 50613184, "comment_id": 88308832, "body": "1. &quot;circa&quot; - ... count characters You require. 2. <a href=\"https://linux.die.net/man/3/sprintf\" rel=\"nofollow noreferrer\">linux.die.net/man/3/sprintf</a> and find here <code>%*</code> example. Star is very interesting (gets one more parameters than simple arguments)"}], "tags": [], "owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "is_accepted": false, "score": 4, "last_activity_date": 1527877358, "last_edit_date": 1527877358, "creation_date": 1527713532, "answer_id": 50613184, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613184#50613184", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>My proposal</p>\n\n<pre><code>int whatYouWant = 10 circa about;\nsprintf(lcdContent_line1, \"%02d/%02d/%04d%*c\", month, day, year, whatYouWant, ' ');\n</code></pre>\n\n<p>Update: Link to documentation: <a href=\"https://linux.die.net/man/3/sprintf\" rel=\"nofollow noreferrer\">https://linux.die.net/man/3/sprintf</a>\nand here go to example </p>\n\n<pre><code>printf(\"%*d\", width, num);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1527714351, "creation_date": 1527714351, "answer_id": 50613352, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613352#50613352", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>In addition to the answer of Jacek Cz, which is based on a fixed size date format, you could use <code>%n</code> to get the number of characters of a non-fixed format. See the following code demonstrating this on the example of a single integral value with variable length in the output:</p>\n\n<pre><code>int main() {\n\n    char x[50];\n    int nrOfChars=0;\n    sprintf(x,\"%d%n\",123567,&amp;nrOfChars);\n    sprintf(x+nrOfChars,\"%*c|\",20-nrOfChars,' ');\n\n    printf(\"012345678901234567890123456789\\n\");\n    printf(\"%s\\n\",x);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>012345678901234567890123456789\n123567              |\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1527715052, "creation_date": 1527715052, "answer_id": 50613464, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint/50613464#50613464", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p><code>sprintf</code> conveniently returns \"the number of characters printed (excluding the null byte used to end output to strings).\" (Found in <code>man sprintf</code> although roughly the same wording appears in the C standard.)</p>\n\n<p>So: </p>\n\n<pre><code>char lcdContent_line1[40]; /* Or whatever you need */\n/* Use snprintf just in case */\nint printed = snprintf(lcdContent_line1, sizeof(lcdContent), \n                       \"%02d/%02d/%04d\", month, day, year);\nif (printed &gt;= 0 &amp;&amp; printed &lt; 20)\n  sprintf(lcdContent_line1 + printed, \"%*s\", 20 - printed, \"\");\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 3664012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3dc9411b4c9a7800a70b5d91d5f18195?s=128&d=identicon&r=PG&f=1", "display_name": "Iridium237", "link": "https://stackoverflow.com/users/3664012/iridium237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 50612979, "answer_count": 4, "score": 2, "last_activity_date": 1527877358, "creation_date": 1527712346, "last_edit_date": 1527805534, "question_id": 50612935, "link": "https://stackoverflow.com/questions/50612935/is-there-a-way-to-pad-a-char-array-that-contains-formatted-elements-using-sprint", "title": "Is there a way to pad a char array that contains formatted elements using sprintf?", "body": "<p>So I'm using sprintf to produce a formatted char[] for displaying the date.</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\n</code></pre>\n\n<p>But I would also like to have the entire result right-padded with spaces for a total length of 20 characters. I've tried:</p>\n\n<pre><code>sprintf(lcdContent_line1, \"%-20s\", lcdContent_line1);\n</code></pre>\n\n<p>But that just blows out the whole thing. Is there a way to compose the format string so that I can right pad this entire thing?</p>\n\n<p>EDIT:</p>\n\n<p>LOLOL simple solution:</p>\n\n<pre><code>memset(lcdContent_line1, 0, 20);\nsprintf(lcdContent_line1, \"%02d/%02d/%04d\", month, day, year);\nsprintf(lcdContent_line1, \"%-19s\", lcdContent_line1);\n</code></pre>\n\n<p>Turns out I was overrunning the buffer with %-20s since that was the entire length, you have to leave room for the 0. >.&lt;</p>\n\n<p>EDIT 2:</p>\n\n<p>Thanks to @chux for pointing out that this is, in fact, a terrible solution that has no right to work as well as it does. Undefined behavior hell is a real place where you will be sent at the first sign of defiance.</p>\n"}, {"tags": ["c", "string", "matrix", "bit-manipulation", "bits"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 3, "creation_date": 1527708366, "post_id": 50612087, "comment_id": 88234090, "body": "Define &quot;didn&#39;t work properly&quot;."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527708375, "post_id": 50612087, "comment_id": 88234093, "body": "<code>void main</code> is wrong. <code>main</code> should return <code>int</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1527708383, "post_id": 50612087, "comment_id": 88234098, "body": "&#39;temp = 0;&#39; no matter how many times you shift up 0, it&#39;s still 0."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527708409, "post_id": 50612087, "comment_id": 88234116, "body": "You want to shift <code>result</code>, not <code>temp</code> (which you don&#39;t need at all...)."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527708479, "post_id": 50612087, "comment_id": 88234147, "body": "<i>&quot;Is it right?&quot;</i> - since the output isn&#39;t what you expect, you can probably conclude <i>no</i>, it isn&#39;t right. Either <code>temp</code> or <code>result</code> is pointless in this, depending on which one you feel inclined to take the time to remove. Either way, one should go."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1527708524, "post_id": 50612087, "comment_id": 88234174, "body": "<code>prog.c:7:8: error: \u2018i\u2019 undeclared (first use in this function)</code> <code>prog.c:7:15: error: \u2018SIZE\u2019 undeclared (first use in this function)</code> <code>prog.c:9:11: error: \u2018j\u2019 undeclared (first use in this function)</code> <code>prog.c:5:22: warning: variable \u2018result\u2019 set but not used</code>"}, {"owner": {"reputation": 103, "user_id": 9741306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a7342386e559a424a98c3551b29715?s=128&d=identicon&r=PG&f=1", "display_name": "Asm .", "link": "https://stackoverflow.com/users/9741306/asm"}, "edited": false, "score": 0, "creation_date": 1527709334, "post_id": 50612087, "comment_id": 88234540, "body": "i&#39;ve done some edits. This code isnt supposed to print out the value of result after the nested loop without an additional function. My only question is: is the variable &quot;result&quot; contains bits after the loop or not? According to the example in the start topic."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1527709344, "post_id": 50612087, "comment_id": 88234543, "body": "you want to shift first then place the bit.  and also just do a bit comparison in the string not subtraction."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1527709464, "post_id": 50612087, "comment_id": 88234591, "body": "if the array has the binary/decimal value 0 and 1 vs ASCII value 0 and 1 then it should work other than being shifted left one because you have the shift last (msbit shifted off the end).  can instead do result &lt;&lt;= 1;  if stuff &amp; 1 then result |= 1;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1527709682, "post_id": 50612087, "comment_id": 88234687, "body": "Posting compilable code that demonstrates the problem is appreciated.  Code that does not compile lacks clarity and is more difficult.  &quot;didn&#39;t work properly.&quot;  is not informative.  Post the output seen and expected as well as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527709978, "post_id": 50612087, "comment_id": 88234826, "body": "in addition you have not shown what <code>SIZE</code> is. You say it did not work properly, but how do you review the result? That too needs to be in the question. Show some examples."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1527710203, "post_id": 50612087, "comment_id": 88234934, "body": "I prefer those solutions that shift a mask one position each time round.  Not all hardware has a barrel shifter."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527718088, "post_id": 50612087, "comment_id": 88237834, "body": "Well, now the code can&#39;t be right because, as old_timer pointed out, you are making an adjustment, then shifting, that means this whole thing will end with... a shift. That means the top bit will be lost and the bottom bit will be clear, <i>guaranteed</i>. Follow his advice; shift, then set the bit."}], "answers": [{"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1527710263, "post_id": 50612399, "comment_id": 88234953, "body": "@PeterJ_01: Rather than feeling icky because someone asked me to do their homework problem, I prefer the more satisfying feeling of showing someone the better way to solve a technical problem."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527710353, "post_id": 50612399, "comment_id": 88234995, "body": "and if instead of <code>&#39;0&#39;</code> will be <code>&#39; &#39;</code> and instead of <code>&#39;1&#39;</code> <code>&#39;x&#39;</code>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527710858, "post_id": 50612399, "comment_id": 88235205, "body": "@PeterJ_01: No question there is value to understanding fundamentals, but an alternate representation of the input is not an excuse to not use already tested and correctly implemented C library functions. So, for <code>&#39; &#39;</code> and <code>&#39;x&#39;</code>, transform the input into what is expected by the function, then call the function."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 2, "last_activity_date": 1527709707, "creation_date": 1527709707, "answer_id": 50612399, "question_id": 50612087, "link": "https://stackoverflow.com/questions/50612087/how-to-concatenate-bit-by-bit-in-c/50612399#50612399", "title": "How to concatenate bit by bit in c?", "body": "<p>Converting the text representation of an integer into its integer value can be done using <code>strtoull()</code>.</p>\n\n<pre><code>char buf[sizeof(matrix)+1];\nmemcpy(buf, matrix, sizeof(matrix));\nbuf[sizeof(matrix)] = '\\0';\nresult = strtoull(buf, NULL, 2);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 483, "user_id": 7452238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5339f527b561933b4e1eceaf7e42d9?s=128&d=identicon&r=PG&f=1", "display_name": "bobra", "link": "https://stackoverflow.com/users/7452238/bobra"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527715868, "post_id": 50612442, "comment_id": 88237112, "body": "@chux here you are"}], "tags": [], "owner": {"reputation": 483, "user_id": 7452238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5339f527b561933b4e1eceaf7e42d9?s=128&d=identicon&r=PG&f=1", "display_name": "bobra", "link": "https://stackoverflow.com/users/7452238/bobra"}, "is_accepted": false, "score": 1, "last_activity_date": 1527715844, "last_edit_date": 1527715844, "creation_date": 1527709890, "answer_id": 50612442, "question_id": 50612087, "link": "https://stackoverflow.com/questions/50612087/how-to-concatenate-bit-by-bit-in-c/50612442#50612442", "title": "How to concatenate bit by bit in c?", "body": "<p>try this</p>\n\n<pre><code>const int mx_size = 8;\n\n\nint main() {\n    unsigned long long result = 0;\n\n    bool  matrix[8][8]; // lets that the matrix is already filled by '1' and '0'\n    for (int i =0; i &lt; mx_size; ++i)\n        matrix[i][i] = 1;\n\n    for (int i = 0; i &lt; mx_size; i++) {\n        for (int j = 0; j &lt; mx_size; j++) {         \n            result |= (unsigned long long)matrix[i][j] &lt;&lt; (i*mx_size + j);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1527710413, "last_edit_date": 1527710413, "creation_date": 1527710038, "answer_id": 50612484, "question_id": 50612087, "link": "https://stackoverflow.com/questions/50612087/how-to-concatenate-bit-by-bit-in-c/50612484#50612484", "title": "How to concatenate bit by bit in c?", "body": "<p>Here you have the code (a bit more</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nuint64_t convert(char matrix[8][8], int order, char zero)\n{\n    uint8_t byte;\n    uint64_t result = 0;\n    for(size_t row = 0; row &lt; 8; row++)\n    {\n        byte = 0;\n        for(size_t column = 0; column &lt; 8; column++)\n        {\n            byte &lt;&lt;= 1;\n            byte |= matrix[row][column] != zero ? 1 : 0; //anything != defined zero char is 1\n        }\n        if (order)\n        {\n            result |= (uint64_t)byte &lt;&lt; (8 * row);\n        }\n        else\n        {\n            result |= (uint64_t)byte &lt;&lt; (56 - 8 * row);\n        }\n    }\n    return result;\n}\n\nint main(void) {\n    char matrix[8][8] = \n    {\n        {'1','0','1','0','1','0','1','0'},\n        {'0','1','0','1','0','1','0','1'},\n        {'1','1','1','0','0','0','1','1'},\n        {'0','0','0','1','1','1','0','0'},\n        {'1','1','1','1','1','0','0','0'},\n        {'0','0','0','0','1','1','1','1'},\n        {'1','1','0','0','1','1','0','0'},\n        {'0','0','1','1','0','0','1','1'},\n    };\n\n    unsigned long long result = convert(matrix, 0, '0');\n\n    for(size_t index = 0; index &lt; 64; index ++)\n        printf(\"%1d\", !!(result &amp; (1ULL &lt;&lt; index)));\n    printf(\"\\n\");\n    result = convert(matrix,1, '0');\n    for(size_t index = 0; index &lt; 64; index ++)\n        printf(\"%1d\", !!(result &amp; (1ULL &lt;&lt; index)));\n    printf(\"\\n\");\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9741306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76a7342386e559a424a98c3551b29715?s=128&d=identicon&r=PG&f=1", "display_name": "Asm .", "link": "https://stackoverflow.com/users/9741306/asm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1527715844, "creation_date": 1527708275, "last_edit_date": 1527709614, "question_id": 50612087, "link": "https://stackoverflow.com/questions/50612087/how-to-concatenate-bit-by-bit-in-c", "title": "How to concatenate bit by bit in c?", "body": "<p>I have matrix of '1' and '0' with the dimensions 8x8. I need to store the whole matrix in one <strong>unsigned long long</strong> variable bit by bit. How can i do that?</p>\n\n<p>For example, let's take the matrix of '1' and '0' that is 2x2:\nThe matrix 2x2:</p>\n\n<pre><code>1 0\n0 1\n</code></pre>\n\n<p>The variable must contain: 1001 in bits.\nThe same example, but over the matrix 8x8 and unsigned long long variable.</p>\n\n<p>That's what i've tried to do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n  unsigned long long result = 0;\n  char matrix[8][8]; // lets that the matrix is already filled by '1' and '0'\n  for (i=0; i&lt;SIZE; i++)\n   {\n     for (j=0; j&lt;SIZE; j++)\n      {\n        result = result | ((unsigned long long)(matrix[i][j] - '0'));\n        result &lt;&lt;= 1;\n      }\n   }\n   return 0;\n}\n</code></pre>\n\n<p>Is it right? I implemented this nested loop in my algorithm and that didn't work properly.</p>\n"}, {"tags": ["c", "pointers", "structure"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527707678, "post_id": 50611904, "comment_id": 88233793, "body": "@WeatherVane And it&#39;s wrong.  See the problem? <code>p = (struct s2 *)malloc(sizeof(struct S2));</code>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527707836, "post_id": 50611904, "comment_id": 88233863, "body": "Anyways, <code>p-&gt;p1</code> is not the same as <code>s2.p1</code>.  <code>p</code> gets a copy of the contents of <code>s2</code>, but does not point to <code>s2</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527707858, "post_id": 50611904, "comment_id": 88233871, "body": "test.c(17): warning C4133: &#39;=&#39;: incompatible types - from &#39;s2 *&#39; to &#39;S2 *&#39;. test.c(24): warning C4473: &#39;printf&#39; : not enough arguments passed for format string. test.c(24): note: placeholders and their parameters expect 5 variadic arguments, but 4 were provided. test.c(24): note: the missing variadic argument 5 is required by format string &#39;%d&#39;."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527707918, "post_id": 50611904, "comment_id": 88233891, "body": "<code>.code.tio.c:17:7: warning: assignment to \u2018struct S2 *\u2019 from incompatible pointer type \u2018struct s2 *\u2019</code>  <code>.code.tio.c:24:34: warning: format \u2018%d\u2019 expects a matching \u2018int\u2019 argument</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527707985, "post_id": 50611904, "comment_id": 88233928, "body": "&quot;<i>They both point</i>&quot; - no, they don&#39;t. <code>s2</code> is not a pointer."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1527708093, "post_id": 50611904, "comment_id": 88233970, "body": "s2 is storage class auto, allocated on the stack. p is allocated dynamically on the heap. They are two different chunks of memory. *p = s2 copies the contents of one to the other, but they are still different structures in different places."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1527708193, "post_id": 50611904, "comment_id": 88234011, "body": "Aside: Who or what text suggested the cast <code>(struct s2 *)</code> in <code>p = (struct s2 *)malloc(sizeof(struct S2));</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 5325067, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0de99c01c9c50323415b1498fb0e2ae?s=128&d=identicon&r=PG&f=1", "display_name": "ad3angel1s", "link": "https://stackoverflow.com/users/5325067/ad3angel1s"}, "is_accepted": false, "score": 4, "last_activity_date": 1527707780, "creation_date": 1527707780, "answer_id": 50611972, "question_id": 50611904, "link": "https://stackoverflow.com/questions/50611904/structure-can-anyone-figure-this-out/50611972#50611972", "title": "Structure..can anyone figure this out?", "body": "<p>Because you copied the contents of s2 into the structure pointed by p and then you updated s2 contents.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1527708828, "creation_date": 1527708828, "answer_id": 50612207, "question_id": 50611904, "link": "https://stackoverflow.com/questions/50611904/structure-can-anyone-figure-this-out/50612207#50612207", "title": "Structure..can anyone figure this out?", "body": "<blockquote>\n  <p>Why does p->p1 produce 1, ....?</p>\n</blockquote>\n\n<p>Because code last assigned <code>p-&gt;p1</code> with the value of 1 with ****</p>\n\n<pre><code>//              v--- p1 member\nstruct S2 s2 = {1,2,3,0};\nstruct S2 *p;\np = (struct s2 *)malloc(sizeof(struct S2));\n*p = s2;  // ****  This copies the contents of `s2` to `*p`.\n</code></pre>\n\n<blockquote>\n  <p>Why does ... s2.p1 produces 0?</p>\n</blockquote>\n\n<p>Because code <em>later</em> assigned 0 to <code>s2.p1</code> with</p>\n\n<pre><code>//              v--- p1 member\nstruct S2 s2 = {1,2,3,0};\n...\ns2.p1 = 0;\n</code></pre>\n\n<blockquote>\n  <p>They (<code>p-&gt;p1</code>,  <code>s2.p1</code>) both point to the exact same thing</p>\n</blockquote>\n\n<p>No, they do not.  <code>p</code> is a pointer assigned with a value from allocated memory and <code>s2</code> is an object defined with <code>struct S2 s2</code>.  The allocated memory and the object <code>s2</code> are not the same location.  <code>s2</code> as a structure, never points to anything.  <a href=\"https://stackoverflow.com/questions/50611904/structure-can-anyone-figure-this-out#comment88233928_50611904\">@melpomene</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8669871, "user_type": "registered", "profile_image": "https://graph.facebook.com/824490701061626/picture?type=large", "display_name": "Noel Nosse", "link": "https://stackoverflow.com/users/8669871/noel-nosse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 50612207, "answer_count": 2, "score": -2, "last_activity_date": 1527708828, "creation_date": 1527707477, "last_edit_date": 1527707773, "question_id": 50611904, "link": "https://stackoverflow.com/questions/50611904/structure-can-anyone-figure-this-out", "title": "Structure..can anyone figure this out?", "body": "<p>Why does p->p1 produce 1, while s2.p1 produces 0? They both point to the exact same thing, and this does NOT happen with p->p2 and s2.p2.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct S1{\n    int p1, p2;\n};\nstruct S2{\n    int p1;\n    struct S1 s1;\n    int p2;\n};\n\nint main (void){\n    int s = 0;\n    struct S2 s2 = {1,2,3,0};\n    struct S2 *p;\n    p = (struct s2 *)malloc(sizeof(struct S2));\n\n    *p = s2;\n\n\n    s2.p1 = 0;\n    printf(\"p-&gt;p1 %d,s2.p1 %d   \\n\\n\",p-&gt;p1, s2.p1 );\n    printf(\"%d\\t %d\\t %d\\t %d\\t %d\\n\",p-&gt;p1 , s2.p1 , p-&gt;p2 , p-&gt;s1.p2 );\n    s = p-&gt;p1 + s2.p1 + p-&gt;p2 + p-&gt;s1.p2;\n\n    free(p);\n    printf(\"%d\", s);\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "makefile", "header-files", "code-organization"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1527707491, "post_id": 50611899, "comment_id": 88233714, "body": "Pass the corresponding definition via <code>-D</code> to the compiler. And in the source code check with <code>#ifdef</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527708064, "post_id": 50611899, "comment_id": 88233957, "body": "Why bother with separate compilation if you have to recompile <code>fnc.c</code> separately anyway?"}, {"owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527708784, "post_id": 50611899, "comment_id": 88234289, "body": "@melpomene How can I do this without compiling <code>fnc.c</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1527708175, "post_id": 50612026, "comment_id": 88234008, "body": "You could also do it &quot;statically&quot;: Put <code>#include &quot;header1.h&quot;</code> <code>#include &quot;fnc.c&quot;</code> in <code>fnc1.c</code>, and <code>#include &quot;header2.h&quot;</code> <code>#include &quot;fnc.c&quot;</code> in <code>fnc2.c</code>. Then put the usual rules for <code>fnc1.c</code> and <code>fnc2.c</code> in your Makefile."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527708227, "post_id": 50612026, "comment_id": 88234025, "body": "@melpomene Maybe worth to be an additional answer."}, {"owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "edited": false, "score": 0, "creation_date": 1527708699, "post_id": 50612026, "comment_id": 88234250, "body": "Thanks. Should there be a space between <code>-D</code> and <code>CONFIG1</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "edited": false, "score": 0, "creation_date": 1527708757, "post_id": 50612026, "comment_id": 88234281, "body": "@sodiumnitrate No space needed."}, {"owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527708811, "post_id": 50612026, "comment_id": 88234297, "body": "@melpomene I&#39;m trying to merge different copies of <code>fnc.c</code> so that whenever I make a modification to one of them, I don&#39;t have to go back and modify <code>fnc2.c</code>, etc."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "edited": false, "score": 0, "creation_date": 1527708841, "post_id": 50612026, "comment_id": 88234311, "body": "@sodiumnitrate That&#39;s what my solution achieves. Why would you need to modify <code>fnc2.c</code>? It&#39;s only two lines."}, {"owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527709103, "post_id": 50612026, "comment_id": 88234421, "body": "@melpomene In other cases where <code>fnc2.c</code> would have more lines."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1527709251, "post_id": 50612026, "comment_id": 88234494, "body": "@melpomene <a href=\"https://stackoverflow.com/questions/50611899/choosing-different-header-file-depending-on-instructions-from-makefile#comment88234311_50612026\">It&#39;s only two lines.</a>  is certainly a result of OP nicely posting a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "edited": false, "score": 0, "creation_date": 1527712372, "post_id": 50612026, "comment_id": 88235801, "body": "@sodiumnitrate <code>fnc2.c</code> is static. I don&#39;t understand what lines you would want to add. You&#39;d only modify <code>fnc.c</code>."}, {"owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1527718528, "post_id": 50612026, "comment_id": 88237959, "body": "@melpomene Oh, I see. Sorry I misunderstood -- I thought you were suggesting me to make a duplicate of <code>fnc.c</code> and call it <code>fnc2.c</code>. I think this is a good alternate answer."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 3, "last_activity_date": 1527708261, "last_edit_date": 1527708261, "creation_date": 1527708047, "answer_id": 50612026, "question_id": 50611899, "link": "https://stackoverflow.com/questions/50611899/choosing-different-header-file-depending-on-instructions-from-makefile/50612026#50612026", "title": "Choosing different header file depending on instructions from Makefile", "body": "<p>You can use the <code>-D</code> compiler flag to define a symbol that will be visible to preprocessor. And then to check it with the preprocessor <code>#ifdef</code> directive. Such as:</p>\n\n<p>Makefile:</p>\n\n<pre><code>main1: main1.o fnc1.o\n    gcc main1.o fnc1.o -o main1.x\n\nmain2: main2.o fnc2.o\n    gcc main2.o fnc2.o -o main2.x\n\nmain1.o: main1.c\n    gcc -c main1.c\n\nmain2.o: main2.c\n    gcc -c main2.c\n\nfnc1.o:\n    gcc -o fnc1.o -c fnc.c -DCONFIG1\n\nfnc2.o:\n    gcc -o fnc2.o -c fnc.c -DCONFIG2\n</code></pre>\n\n<p>And your source:</p>\n\n<pre><code>#ifdef CONFIG1\n#include \"header1.h\"\n#elif defined(CONFIG2)\n#include \"header2.h\"\n#else\n#error \"blah\"\n#endif\n\nint fnc(){\n    // do stuff\n}\n</code></pre>\n\n<ul>\n<li>Note - this is neither tested nor an optimal solution. Just giving the idea</li>\n</ul>\n"}], "owner": {"reputation": 2430, "user_id": 2112406, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/08f12ca88bb187b4dc0a373cf413e50c?s=128&d=identicon&r=PG", "display_name": "sodiumnitrate", "link": "https://stackoverflow.com/users/2112406/sodiumnitrate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 50612026, "answer_count": 1, "score": 2, "last_activity_date": 1527708261, "creation_date": 1527707425, "question_id": 50611899, "link": "https://stackoverflow.com/questions/50611899/choosing-different-header-file-depending-on-instructions-from-makefile", "title": "Choosing different header file depending on instructions from Makefile", "body": "<p>I am trying to reorganize someone's code and I seem to have hit a wall.\nI have a function <code>int fnc()</code> in <code>fnc.c</code> that is called by either <code>main1.c</code> or <code>main2.c</code>. An executable is compiled from either <code>main1.c</code> or <code>main2.c</code> using a makefile:</p>\n\n<pre><code>main1: main1.o fnc.o\n    gcc main1.o fnc.o -o main1.x\n\nmain2: main2.o fnc.o\n    gcc main2.o fnc.o -o main2.x\n\nmain1.o: main1.c\n    gcc -c main1.c\n\nmain2.o: main2.c\n    gcc -c main2.c\n\nfnc.o:\n    gcc -c fnc.c\n</code></pre>\n\n<p>The only problem is, there are two header files <code>header1.h</code> and <code>header2.h</code> to be included in the preamble of <code>fnc.c</code> <strong>depending on whether main1.x or main2.x is compiled</strong>:</p>\n\n<pre><code>#include \"header1.h\"\n\nint fnc(){\n    // do stuff\n}\n</code></pre>\n\n<p>Is it possible to select which header to be loaded depending on whether one types <code>make main1</code> or <code>make main2</code>?</p>\n"}, {"tags": ["c", "buffer-overflow"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527703394, "post_id": 50610889, "comment_id": 88231751, "body": "Options available are depending on your gcc version and how it was compiled."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1527703736, "post_id": 50610889, "comment_id": 88231901, "body": "I can&#39;t see that option in the documentation for 8.1 at least - look up your version&#39;s manual <a href=\"https://gcc.gnu.org/onlinedocs/\" rel=\"nofollow noreferrer\">here</a>. The 8.1 doc for -fstack-protector is under <a href=\"https://gcc.gnu.org/onlinedocs/gcc-8.1.0/gcc/Instrumentation-Options.html#Instrumentation-Options\" rel=\"nofollow noreferrer\">Program Instrumentation Options</a>."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 9871727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSNoF.png?s=128&g=1", "display_name": "Trevor Tracy", "link": "https://stackoverflow.com/users/9871727/trevor-tracy"}, "is_accepted": true, "score": 1, "last_activity_date": 1527706061, "last_edit_date": 1527706061, "creation_date": 1527704680, "answer_id": 50611243, "question_id": 50610889, "link": "https://stackoverflow.com/questions/50610889/fno-stack-protector-is-not-working/50611243#50611243", "title": "-fno-stack-protector is not working", "body": "<p>You are correctly doing the command but it is unrecgonized due to your configuration. </p>\n\n<p><code>gcc -fno-stack-protector bo.c</code></p>\n\n<p>I would recommend reinstalling gcc or trying in another linux distro. Also feel free to look at this article on <a href=\"https://stackoverflow.com/questions/10712972/what-is-the-use-of-fno-stack-protector\">the use of -fno-stack-protector</a> as it gives some insight as to why it may be disabled. (Do to possible configurations with Makefile disabling the flag)</p>\n\n<p>--------Edit----------</p>\n\n<p>After looking further into this, I would recommend looking at: <code>-fstack-protector-all</code> or <code>-fstack-protector</code></p>\n\n<p>I was messing around with your code and found this might be what you're trying to do and your current setup may allow it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JIEOV.png\" rel=\"nofollow noreferrer\">My CMD Output</a></p>\n"}, {"tags": [], "owner": {"reputation": 433, "user_id": 3649174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0da70c533c8778a9912da68a4a6f82f4?s=128&d=identicon&r=PG&f=1", "display_name": "VIII", "link": "https://stackoverflow.com/users/3649174/viii"}, "is_accepted": false, "score": 0, "last_activity_date": 1578626970, "creation_date": 1578626970, "answer_id": 59675166, "question_id": 50610889, "link": "https://stackoverflow.com/questions/50610889/fno-stack-protector-is-not-working/59675166#59675166", "title": "-fno-stack-protector is not working", "body": "<p>I think the correct command like this :</p>\n\n<pre><code>gcc -o bo bo.c -fno-stack-protector\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 8051390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/339ede5ba6ab5c0f93b3752e9843674f?s=128&d=identicon&r=PG&f=1", "display_name": "xscorp7", "link": "https://stackoverflow.com/users/8051390/xscorp7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2697, "favorite_count": 0, "accepted_answer_id": 50611243, "answer_count": 2, "score": 0, "last_activity_date": 1578626970, "creation_date": 1527703194, "question_id": 50610889, "link": "https://stackoverflow.com/questions/50610889/fno-stack-protector-is-not-working", "title": "-fno-stack-protector is not working", "body": "<p>I have written the following C program to see the working of buffer overflows. I have saved this program file with name <strong>bo.c</strong> </p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n    #include&lt;string.h&gt;\n\n    int authentication(char *key)\n    {\n        int auth=0;\n        char pass[10];\n        strcpy(pass, key);\n        if(strcmp(pass, \"hello\")==0)\n            auth=1; \n        else\n            auth=0;\n        return auth;\n    }\n\n    int main(int argc, char *argv[])\n    {\n        if(authentication(argv[1]))\n        {\n            printf(\"----------------------------------\\nACCESS  GRANTED\\n---------------------------------\");\n}\n        else\n        {\n            printf(\"Access Denied! Wrong password!\");\n        }\n    return 0;\n    }   \n</code></pre>\n\n<p>But I am not able to see the effect of buffer overflow because the stack is protected. But when I am compiling it with the -fno-stack-protector flag, it is showing that it is an unrecognized option.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tFUJE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tFUJE.png\" alt=\"enter image description here\"></a></p>\n\n<p>What is the problem here? Am I doing something wrong in the usage of the <strong>gcc</strong> command?</p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1527704423, "post_id": 50610781, "comment_id": 88232258, "body": "If I understood correctly you want to implement <code>ls -l | wc &gt; outputfile</code> ?"}, {"owner": {"reputation": 65, "user_id": 9802165, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l76lDHJg74o/AAAAAAAAAAI/AAAAAAAAAZk/hJAYGO-4Hcs/photo.jpg?sz=128", "display_name": "Sulav k", "link": "https://stackoverflow.com/users/9802165/sulav-k"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1527705033, "post_id": 50610781, "comment_id": 88232507, "body": "yes , @achal   I wish to do that"}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1528097650, "post_id": 50610781, "comment_id": 88360536, "body": "Hi @Sulavk I answered your question. Have a look."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9802165, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l76lDHJg74o/AAAAAAAAAAI/AAAAAAAAAZk/hJAYGO-4Hcs/photo.jpg?sz=128", "display_name": "Sulav k", "link": "https://stackoverflow.com/users/9802165/sulav-k"}, "edited": false, "score": 0, "creation_date": 1527711738, "post_id": 50611612, "comment_id": 88235544, "body": "Hi , is there way to make it work just by using dup and dup2. I am not familiar how library works"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 65, "user_id": 9802165, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l76lDHJg74o/AAAAAAAAAAI/AAAAAAAAAZk/hJAYGO-4Hcs/photo.jpg?sz=128", "display_name": "Sulav k", "link": "https://stackoverflow.com/users/9802165/sulav-k"}, "edited": false, "score": 0, "creation_date": 1527763167, "post_id": 50611612, "comment_id": 88254345, "body": "I&#39;ll do a quick rundown of what the dup and fnctl methods do in the body..."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 3, "last_activity_date": 1527776959, "last_edit_date": 1527776959, "creation_date": 1527706272, "answer_id": 50611612, "question_id": 50610781, "link": "https://stackoverflow.com/questions/50610781/implementing-pipe-and-redirection-together-in-c/50611612#50611612", "title": "implementing pipe and redirection together in C", "body": "<p>So for the redirection aspect you need to use dup2() within the fork on the file handles. To set up the pipe, you need to use pipe() in the main thread to create the handles you will then dup2() inside the fork.</p>\n\n<p>Note that you have to be super-careful that pipe() doesn't give you a low-numbered file handle. You can use fcntrl(F_DUPFD, ...) to bully them to high numbers. Also, use CLOEXEC to get rid of all the rubbish secondary handles floating around.</p>\n\n<p>Pseudocode:</p>\n\n<pre><code>fin = open(\"input\", read)\npipeIO = pipe()\nfout = open(\"output\", write)\n\nfin2 = fcntrl(F_DUPFD_CLOEXEC, fin, 3);   close fin\npipeI2 = fcntrl(F_DUPFD_CLOEXEC, pipeI, 3);   close pipeI\npipeO2 = fcntrl(F_DUPFD_CLOEXEC, pipeO, 3);   close pipeO\nfout2 = fcntrl(F_DUPFD_CLOEXEC, fout, 3);   close fout\n\nfork \n{\n   dup(fin2, 0)\n   dup(pipeO2, 1)\n  exec Command1\n}\nclose fin2\nclose pipeO2\nfork \n{\n   dup(pipeI2, 0)\n   dup(out2, 1)\n   exec Command2\n}\nclose fout2\nclose pipeI2\n\nwait\n</code></pre>\n\n<p>Alternatively, the second fork could chain-exec:</p>\n\n<p>Pseudocode:</p>\n\n<pre><code>fin = open(\"input\", read)\npipeIO = pipe()\nfout = open(\"output\", write)\n\nfin2 = fcntrl(F_DUPFD_CLOEXEC, fin, 3);   close fin\npipeI2 = fcntrl(F_DUPFD_CLOEXEC, pipeI, 3);   close pipeI\npipeO2 = fcntrl(F_DUPFD_CLOEXEC, pipeO, 3);   close pipeO\nfout2 = fcntrl(F_DUPFD_CLOEXEC, fout, 3);   close fout\n\nfork \n{\n   dup(fin2, 0)\n   dup(pipeO2, 1)\n  exec Command1\n}\ndup(pipeI2, 0)\ndup(out2, 1)\nexec Command2\n</code></pre>\n\n<p>You are clearly already aware that when you fork, the child effectively gets all handles duplicated, and at the point when the code actually executes, only one version must be open. Either the parent or the child must close each handle that it is not interested in. By using CLOEXEC we reduce that need, though if you want to keep the parent process as a monitor, then it needs to close all its copies of all those handles.</p>\n\n<p>A quick rundown of the dup functions:</p>\n\n<p>0 = pipe(handle[2])<br>\nThis creates a pair of handles that are attached to each other as input and output. Classically you can communicate with a fork by one process writing in to one handle of the fork and the other process reading out of the other handle, whichever way round you want to use them. In this case, we are using the pipe to communicate between the two child processes, and the parent is not involved. </p>\n\n<p>handle = dup(handle)<br>\nThis creates a duplicate handle at the lowest unused slot. If your program has closed stdin/stdout/stderr it will reuse those, which will be problematic. Also these handles stay live in exec calls.</p>\n\n<p>handle = dup2(handle,trghandle)<br>\nThis creates a duplicate handle at the index you specify. It will silently close any existing use of trghandle, which can be both useful and annoying!</p>\n\n<p>handle = dup3(handle,trghandle, flags)<br>\nThis creates a duplicate handle at the index you specify. It will silently close any existing use of trghandle, which can be both useful and annoying! You can specify flags such as CLOEXEC, which automatically closes the handle when you call exec. CLOEXEC is really useful in avoiding having to explicitly close files.</p>\n\n<p>int fcntl(int fd, int cmd, ... /* arg */ );<br>\n F_DUPFD (int) Duplicate the file descriptor fd using the lowest-numbered available file descriptor greater than or equal to arg.<br>\nF_DUPFD_CLOEXEC (int; since Linux 2.6.24) As for F_DUPFD, but additionally set the close-on-exec flag for the duplicate file descriptor.<br>\n... which makes it easy to avoid stdin/stdout. </p>\n"}, {"tags": [], "owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "is_accepted": true, "score": 0, "last_activity_date": 1528097580, "creation_date": 1528097580, "answer_id": 50675440, "question_id": 50610781, "link": "https://stackoverflow.com/questions/50610781/implementing-pipe-and-redirection-together-in-c/50675440#50675440", "title": "implementing pipe and redirection together in C", "body": "<p>You want to execute </p>\n\n<pre><code>ls -l   |   wc   &gt;   outputfile\n |           |         |\np-1        p-2      redirect the o/p of ls | wc to outputfile\n</code></pre>\n\n<p>To achieve above you need to create the process(p-1 and p-2) using <code>fork()</code> system call &amp; then use <code>dup()</code> or <code>dup2()</code> system call to redirect the o/p where it is intended. </p>\n\n<p>here is sample code</p>\n\n<pre><code>int main(int argc,char *argv[]) {\n        int fd[2];\n        pid_t cpid;\n        close(1); /* so that output file should get file descriptor 1 */\n        int file_dsptr = open(argv[3],O_CREAT|O_TRUNC |O_WRONLY , 0664); /* file should be exist in current directory, otherwise use O_CREAT | O_TRUNC */\n        printf(\"[%d]\\n\",file_dsptr);\n\n        if(argc == 4){\n                if(pipe(fd) == -1){\n                        perror(\"error in pipe creation\");\n                        exit(EXIT_FAILURE);\n                }\n                cpid = fork();\n                if( cpid == 0 ){ /*child process */\n                        close( fd[0] ); /* close read end of pipe */\n                        if( -1 == dup2(fd[1] , file_dsptr)){ /* duplicate fd[1] to fd where data.txt points */\n                                exit( EXIT_FAILURE );\n                        }\n                        if(-1 == execlp(argv[1] , argv[1] , NULL )){ /* executes the commands */\n                                exit( EXIT_FAILURE );\n                        }\n                        close( fd[1] );\n                        _exit( EXIT_SUCCESS );\n                }\n                else if(cpid &gt; 0){\n                        wait( NULL ); /* wait for child to completes */\n                        close( fd[1] ); /* close write end of pipe */\n                        if( -1 == dup2(fd[0] , STDIN_FILENO)) {\n                                exit( EXIT_FAILURE );\n                        }\n                        if(-1 == execlp(argv[2] , argv[2], NULL )) {\n                                exit( EXIT_FAILURE );\n                        }\n                        close( fd[0] );\n                        _exit( EXIT_SUCCESS );\n                }\n                else{\n                        fprintf(stderr, \"fork failed\\n\");\n                        exit(EXIT_FAILURE);\n                }\n        }\n        else{\n                fprintf(stderr, \"Usage Msg :. ./a.out ls wc data.txt \\n\");\n                exit(EXIT_FAILURE);\n        }\n        return 0;\n}\n</code></pre>\n\n<p>As I mentioned in comments run above code like</p>\n\n<pre><code>gcc -Wall test.c\n./a.out ls  wc  outputfile\n</code></pre>\n\n<p>And check the content of <code>outputfile</code> now, it should be result of <code>ls | wc</code>.</p>\n"}], "owner": {"reputation": 65, "user_id": 9802165, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l76lDHJg74o/AAAAAAAAAAI/AAAAAAAAAZk/hJAYGO-4Hcs/photo.jpg?sz=128", "display_name": "Sulav k", "link": "https://stackoverflow.com/users/9802165/sulav-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4663, "favorite_count": 1, "accepted_answer_id": 50675440, "answer_count": 2, "score": 2, "last_activity_date": 1528097580, "creation_date": 1527702745, "last_edit_date": 1527707162, "question_id": 50610781, "link": "https://stackoverflow.com/questions/50610781/implementing-pipe-and-redirection-together-in-c", "title": "implementing pipe and redirection together in C", "body": "<p>I am working on making a minimal shell in C. I understand how pipe and redirection work. I have two programs, one program that handles redirection, for example <code>ls -l &gt; outputfile</code>. I have another program that handles one pipe, for example, <code>ls - l | wc</code>.  The main trouble I am having is to put them together. Basically, I want to be able to implement both <strong>pipe</strong> and <strong>redirection</strong> in one program. Below is part of the code for pipe.</p>\n\n<pre><code>   pipe(p);\n      if (fork() == 0) {\n      dup2(p[1], 1);\n      close(p[0]);\n      execvp(upstream[0], upstream );\n      exit(1);\n    }\n    if (fork() == 0) {\n    dup2(p[0], 0);\n\n    close(p[1]);\n    execvp(downstream[0], downstream);\n    exit(1);\n    }\n    else { /* Parent */\n        /*  so Close both ends of pipe */\n    close(p[0]);\n    close(p[1]);\n</code></pre>\n\n<p>I would appreciate highly if I can get some pointer on this one. I am not sure in which part of my code, I am supposed to implement redirection.\nThanks in Advance</p>\n"}, {"tags": ["c", "windows", "driver", "low-level", "windows-kernel"], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 4917303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-tQ6JhO6s9qg/AAAAAAAAAAI/AAAAAAAAAHg/m5MVLqdIDvs/photo.jpg?sz=128", "display_name": "Oriel Cochavi", "link": "https://stackoverflow.com/users/4917303/oriel-cochavi"}, "edited": false, "score": 0, "creation_date": 1527705847, "post_id": 50611298, "comment_id": 88232908, "body": "Thanks. I suspected the thread is only hung in ExAllocatePoolWithTag but I wasn&#39;t sure and the fact I saw TerminateThread call made me think the thread gets terminated. Again, Thanks for the advice and the answer."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 335, "user_id": 4917303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-tQ6JhO6s9qg/AAAAAAAAAAI/AAAAAAAAAHg/m5MVLqdIDvs/photo.jpg?sz=128", "display_name": "Oriel Cochavi", "link": "https://stackoverflow.com/users/4917303/oriel-cochavi"}, "edited": false, "score": 1, "creation_date": 1527706038, "post_id": 50611298, "comment_id": 88233012, "body": "@OrielCochavi - insert normal kernel mode apc in callback. and inside it normal routine - allocate memory and do inject (you can even reinitialize and reuse apc object here - for insert user mode apc for inject). do main task not from callback (which is in critical region) but outside. and you view that here allocate memory work ok."}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": true, "score": 2, "last_activity_date": 1527704886, "creation_date": 1527704886, "answer_id": 50611298, "question_id": 50610741, "link": "https://stackoverflow.com/questions/50610741/windows-kernel-driver-zwallocatevirtualmemory-causing-thread-to-terminate/50611298#50611298", "title": "Windows Kernel Driver: ZwAllocateVirtualMemory causing thread to terminate", "body": "<p>at first side note - not call <code>PsLookupProcessByProcessId</code> from image notify routine. this is simply not need. check that <code>ProcessId == PsGetCurrentProcessId()</code>. and if yes - use current process pointer (as you and use in call <code>ZwAllocateVirtualMemory</code> - <code>NtCurrentProcess()</code>) otherwise just exist.</p>\n\n<p>now about main - \"ZwAllocateVirtualMemory causing thread to terminate\" - of course no. thread <strong>not terminate</strong>. it <strong>hung</strong>. at first if thread is terminate - because this is single thread in process at this stage - all process is terminate. but you yourself say that <em>The process is still visible from task manager</em>. also how you view call stack of terminated thread ? this also say that thread not terminated but wait inside <code>ExAllocatePoolWithTag</code></p>\n\n<p>problem that callback is execute in some critical region and <em>The actions that you can perform in this routine are restricted</em> (The operating system calls the driver's process-notify routine at PASSIVE_LEVEL inside a critical region with normal kernel APCs disabled). one of the restrictions - is call <code>ZwAllocateVirtualMemory</code> - it hung in callback, which you and can see.</p>\n\n<p>so you can not call <code>ZwAllocateVirtualMemory</code> and do injection direct from callback. but solution exist. insert normal kernel apc to current thread. it will be not executed in-place because - normal kernel APCs disabled in callback. but just after you exit from callback and apc will be enabled - your apc executed. and here (in normal routine) you already can call <code>ZwAllocateVirtualMemory</code> and do dll injection</p>\n"}], "owner": {"reputation": 335, "user_id": 4917303, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-tQ6JhO6s9qg/AAAAAAAAAAI/AAAAAAAAAHg/m5MVLqdIDvs/photo.jpg?sz=128", "display_name": "Oriel Cochavi", "link": "https://stackoverflow.com/users/4917303/oriel-cochavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 50611298, "answer_count": 1, "score": 1, "last_activity_date": 1527704886, "creation_date": 1527702606, "question_id": 50610741, "link": "https://stackoverflow.com/questions/50610741/windows-kernel-driver-zwallocatevirtualmemory-causing-thread-to-terminate", "title": "Windows Kernel Driver: ZwAllocateVirtualMemory causing thread to terminate", "body": "<p>I'm trying to write an APC dll injection driver, I've found <a href=\"https://www.rohitab.com/discuss/topic/40737-inject-dll-from-kernel-mode/\" rel=\"nofollow noreferrer\">this</a> example and thought to modify it to my needs.</p>\n\n<p>I use <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntddk/nc-ntddk-pcreate_process_notify_routine_ex\" rel=\"nofollow noreferrer\">PcreateProcessNotifyRoutineEx</a> to obtain the ProcessId for specific applications I targeting, in this case, \"iexplore.exe\" and then use <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntddk/nc-ntddk-pload_image_notify_routine\" rel=\"nofollow noreferrer\">PloadImageNotifyRoutine</a> to check if ntdll.dll is already loaded and initialized (from <a href=\"https://stackoverflow.com/a/50304959/4917303\">this recommendation</a>), and if ntdll.dll is loaded, I call \"my\" InjectDLL function.</p>\n\n<p>This is the PloadImageNotifyRoutine function that is calling InjectDll:</p>\n\n<pre><code>VOID PloadImageNotifyRoutine(\n    _In_ PUNICODE_STRING FullImageName,\n    _In_ HANDLE ProcessId,\n    _In_ PIMAGE_INFO ImageInfo\n)\n{\n    PEPROCESS Process = NULL;\n    PETHREAD Thread = NULL;\n    PCHAR pTeb = nullptr;\n    DWORD ArbitraryUserPointer = 0;\n    PCHAR pszProcessNameA = nullptr;\n\n    pTeb = (PCHAR)__readfsdword(0x18);\n    ArbitraryUserPointer = *(DWORD*)(pTeb + 0x014);\n\n    // If ArbitraryUserPointer points to kernel32.dll it means ntdll.dll is done loading.\n    if (FALSE == IsStringEndWith((wchar_t*)ArbitraryUserPointer, L\"\\\\kernel32.dll\"))\n    {\n        return;\n    }\n\n    if (!NT_SUCCESS(PsLookupProcessByProcessId(ProcessId, &amp;Process)))\n    {\n        return;\n    }\n\n    pszProcessNameA = (PCHAR)PsGetProcessImageFileName(Process);\n    if (FALSE == StringNCompare(pszProcessNameA, \"iexplore.exe\", GetStringLength(\"iexplore.exe\")))\n    {\n        return;\n    }\n\n    Thread = KeGetCurrentThread();\n    InjectDll(MODULE_PATH, Process, Thread);\n    ObDereferenceObject(Process);\n}\n</code></pre>\n\n<p>And this is the InjectDll function:</p>\n\n<pre><code>BOOLEAN InjectDll(PWCHAR pModulePath, PEPROCESS Process, PETHREAD Thread)\n{\n    PKINJECT mem;\n    ULONG size;\n\n    mem = NULL;\n    size = 4096;\n\n    if (!NT_SUCCESS(ZwAllocateVirtualMemory(NtCurrentProcess(), (PVOID*)&amp;mem, 0, &amp;size, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE)))\n    {\n        return FALSE;\n    }\n\n    //more code ...\n}\n</code></pre>\n\n<p>I removed here some checks so it would be more clear.</p>\n\n<p>I tried to debug it a little, but it seems like <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/ntifs/nf-ntifs-ntallocatevirtualmemory\" rel=\"nofollow noreferrer\">ZwAllocateVirtualMemory</a> is trying to allocate memory, failing at some point and terminate the thread.</p>\n\n<p>After it calls ExAllocatePoolWithTag it starting to free memory, unmapping sections and terminate the thread (&lt;= calls I saw at the stack while debugging - didn't really trace each call, but looked at it in general view).</p>\n\n<p>The stack before the thread get terminated:</p>\n\n<pre><code>nt!ExAllocatePoolWithTag+0x195\nnt!NtAllocateVirtualMemory+0x1066\nnt!KiSystemServicePostCall\nnt!ZwAllocateVirtualMemory+0x11\nkernel_apc_dll_injector!InjectDll+0x54\nkernel_apc_dll_injector!PloadImageNotifyRoutine+0x2b0\nnt!PsCallImageNotifyRoutines+0x62\n</code></pre>\n\n<p>The process is still visible from task manager, but its Memory is 92k and has no CPU usage, probably because it didn't \"cleaned up\" properly.</p>\n\n<p>I don't know if my analysis is right, and maybe it even unnecessary for this problem.</p>\n"}, {"tags": ["c", "algorithm", "parallel-processing", "hashmap", "atomic"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1527702656, "post_id": 50610594, "comment_id": 88231372, "body": "Note I&#39;ve asked a slightly different question <a href=\"https://cs.stackexchange.com/questions/92512/is-it-possible-to-implement-64-bit-cmpxchg-from-32-bit-cmpxchg\">on CS.SE</a>. That question is more general: if there is an answer to it, then there is an answer to this one, obviously. This one is more specific, because there could be a way to extend this hash-table to 64-bit keys without needing to implement 64-bit cmpxchg."}, {"owner": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 0, "creation_date": 1527704238, "post_id": 50610594, "comment_id": 88232164, "body": "Since the size of your hash table is finite, doesn&#39;t that mean you will get collisions anyway ?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 0, "creation_date": 1527704780, "post_id": 50610594, "comment_id": 88232416, "body": "@curiousguy The algorithm works as long as there is 1 empty space on the array. I could fill an array of size <code>2^32</code> (4294967296) with random 64-bit keys and there would be only 50% chance of collisions."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1527728580, "post_id": 50610594, "comment_id": 88240411, "body": "@MaiaVictor: The probability of collisions would be only about 39%, actually; birthday paradox and all. For <code>k</code>-bit uniform random numbers, the probability of a collision reaches 50% at <code>n</code> numbers, <code>n \u2248 0.833*2^((k+1)&#47;2)</code>; for 64-bit keys, that&#39;s slightly over five billion numbers. I just added the approximation and some numbers <a href=\"https://math.stackexchange.com/a/2793623/318422\">here</a>."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1527781635, "post_id": 50610594, "comment_id": 88266417, "body": "Please specify what exactly you mean using <code>collision</code> (let alone <code>collision after</code> <i>n</i> <code>insertions</code>). What are the consequences of one such <code>collision</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 8106387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1433443270035771/picture?type=large", "display_name": "Paul McGee", "link": "https://stackoverflow.com/users/8106387/paul-mcgee"}, "is_accepted": true, "score": 2, "last_activity_date": 1527825081, "last_edit_date": 1527825081, "creation_date": 1527781091, "answer_id": 50628029, "question_id": 50610594, "link": "https://stackoverflow.com/questions/50610594/is-it-possible-to-adapt-this-lock-free-32-bit-hash-table-algorithm-for-64-bit-ke/50628029#50628029", "title": "Is it possible to adapt this lock-free 32-bit hash-table algorithm for 64-bit keys?", "body": "<p>I'm not sure from the question whether you are still wanting to retain the lock-free characteristic, or just want to get 64-bit key/value storage up &amp; running. (?)</p>\n\n<p>There is a 64-bit MurmurHash3 posted here by @kol:\n<a href=\"https://stackoverflow.com/questions/8509180/hashing-a-small-number-to-a-random-looking-64-bit-integer\">hashing a small number to a random looking 64 bit integer</a> </p>\n\n<p>Clearly, if you introduced a second array to assert key-location ownership, and respected that for value storage, you could then read and CAS 64-bit values in two steps, then release ownership.  That doesn't get you lock-free, of course.</p>\n\n<p>---------------  Edit:  ---------------<br>\nThe author has at least two videos on his hash table, both from 2007:</p>\n\n<p>Advanced Topics in Programming Languages: A Lock-Free Hash Table\n<a href=\"https://www.youtube.com/watch?v=HJ-719EGIts\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=HJ-719EGIts</a>  </p>\n\n<p>A Fast Wait-Free Hash Table<br>\n<a href=\"https://youtu.be/WYXgtXWejRM\" rel=\"nofollow noreferrer\">https://youtu.be/WYXgtXWejRM</a>  </p>\n\n<p>He relates his program flow to a finite-state machine. Disregarding the issue of growing the table, there are four states a location can be in before a potential mutation is applied to that location.  Key/Value = [nil/nil], [X/nil], [X/X], [nil/X].  </p>\n\n<p>Reading the state in preparation for mutation does not guarantee, under concurrency, that the state remains unchanged at the time the mutation is applied.  </p>\n\n<p>With 32 bit operations, we have the following logic:<br>\n- If the read key = the desired key, the value can be written to the location.<br>\n- If the read key = nil, and the value = non-nil, then another thread is mutating the location.<br>\n- if the read key = nil, and the value = nil, then the location can be written via a successful key CAS.  </p>\n\n<p>If you want to use 32 bit atomic operations to store 64 bit data without locking, then the state diagram is increased in size, with more failure states, eg:<br>\n- You could read a half-created Key.<br>\n- A CAS update of one half of a Value entry may be stomped by another thread, failing on the second CAS.<br>\n- A CAS creation of one half of a Key entry may be stomped by another thread, failing on the second CAS.<br>\n-  The 32 bit representation of array initialiser 'nil' should be excluded from occurring as either half of a 64 bit key or value  </p>\n\n<p>The process of increasing the table size adds some more states to consider, also. </p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 1, "accepted_answer_id": 50628029, "answer_count": 1, "score": 7, "last_activity_date": 1527825081, "creation_date": 1527701932, "last_edit_date": 1527702829, "question_id": 50610594, "link": "https://stackoverflow.com/questions/50610594/is-it-possible-to-adapt-this-lock-free-32-bit-hash-table-algorithm-for-64-bit-ke", "title": "Is it possible to adapt this lock-free 32-bit hash-table algorithm for 64-bit keys?", "body": "<h2>Problem &amp; context</h2>\n\n<p><a href=\"http://preshing.com/20130605/the-worlds-simplest-lock-free-hash-table/\" rel=\"noreferrer\">This</a> post describes a lock-free 32-bit hash-table algorithm. The core of the algorithm is a lock-free linear search, which is used to insert a key-val pair in a (logical) list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h37F7.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/h37F7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code provided:</p>\n\n<pre><code>void ArrayOfItems::SetItem(uint32_t key, uint32_t value)\n{\n    for (uint32_t idx = 0;; idx++)\n    {\n        uint32_t prevKey = mint_compare_exchange_strong_32_relaxed(&amp;m_entries[idx].key, 0, key);\n        if ((prevKey == 0) || (prevKey == key))\n        {\n            mint_store_32_relaxed(&amp;m_entries[idx].value, value);\n            return;\n        }\n    }\n}\n</code></pre>\n\n<p>For a specific problem, I need to insert random key-val pairs in a table. As such, I need at least 64-bit keys, because with 32-bits there is 50% chance of collision after 65536 insertions, which is too low. Unfortunately, I <a href=\"https://stackoverflow.com/questions/50608802/opencl-error-undefined-reference-to-z12atom-cmpxchgpvu8clglobalmmm\">do not have</a> 64-bit cmpxchg as a primitive.</p>\n\n<h2>Question</h2>\n\n<p>Is it possible to generalize the hash-table above to 64-bit keys, using only 32-bit cmpxchg?</p>\n"}, {"tags": ["c#", "c", "marshalling", "com-interop", "unsafe"], "comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1527702415, "post_id": 50610552, "comment_id": 88231249, "body": "As a sidenote... with C# 7.0 can you <code>ref return</code> a <code>Marshal.ReadInt32</code>? (or in general, can you create a managed ref return value from an address?)"}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 1, "creation_date": 1527702595, "post_id": 50610552, "comment_id": 88231339, "body": "It <i>might</i> be useful to show the C function that allocates the 2D array.  Maybe anyone who can&#39;t infer the layout from the C# access won&#39;t be able to answer your question, but I&#39;m not sure about that.  (Since instructing the marshaller and using unsafe are two different skill sets, technically)"}, {"owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "reply_to_user": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 1, "creation_date": 1527703385, "post_id": 50610552, "comment_id": 88231744, "body": "@zzxyz : Hmmm, interesting. I was hoping that keeping the allocation opaque would simplify matters, not complicate them. For what it&#39;s worth: the allocation itself <i>is</i> hidden under the API, so I&#39;m happy to change that, if it makes any difference."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527704078, "post_id": 50610552, "comment_id": 88232072, "body": "@Ziv - What I can&#39;t quite remember is whether your 2D array is contiguous, or an actual pointer to an array of pointers.  I believe it must be the latter since otherwise your C# code would need the &quot;width&quot; to make sense of <code>[i][j]</code> ... == (<code>[i*width + j</code>) for contiguous memory."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1527709505, "post_id": 50610552, "comment_id": 88234610, "body": "You&#39;ll be much ahead if you let the C# code create the array.  That avoids having to copy the array content, the native code can write directly to the managed array.  You&#39;d then declare the field as IntPtr and use GCHandle to pin the array.  Doesn&#39;t make it safe, but easy enough to make it correct."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1527710334, "post_id": 50610552, "comment_id": 88234986, "body": "If not the function, you should show the actual C type definitions. Since we&#39;re dealing with pointers here and marshaling, we would need to know the exact size and layouts for these objects."}, {"owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "reply_to_user": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1527737657, "post_id": 50610552, "comment_id": 88242364, "body": "@JeffMercado : The C-type definitions I brought here are the ones I&#39;m using; I&#39;ve just foobar&#39;d the names."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "reply_to_user": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527738944, "post_id": 50610552, "comment_id": 88242643, "body": "I guess what I was looking for ultimately is the layout of the array as @zzxyz was wondering. If it&#39;s a flat contiguous array array vs an array of pointers. You could let the marshaller do all the work, but you need to know the exact layout as it is in memory to get it right."}, {"owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "reply_to_user": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1527739511, "post_id": 50610552, "comment_id": 88242764, "body": "@JeffMercado It&#39;s an array of pointers (I&#39;m not sure a <code>MyPodStruct**</code> could be otherwise, without some legerdemain). Definitely not the most efficient, but in this instance my priority is for the API to be as simple and clear as possible."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1527740108, "post_id": 50610552, "comment_id": 88242895, "body": "Sorry, not exactly what I meant. It&#39;s meant to represent a 2d array. So is that backed by a single array doing pointer math to index into it (<code>arr[i*width + j]</code>)? Or is it an array of arrays (<code>arr[i][j]</code>)?"}, {"owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "reply_to_user": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "edited": false, "score": 0, "creation_date": 1527740788, "post_id": 50610552, "comment_id": 88243045, "body": "@JeffMercado : Ah! I see the ambiguity now. It&#39;s the second, an array of arrays. (I&#39;ll edit to clarify.)"}], "answers": [{"comments": [{"owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "edited": false, "score": 1, "creation_date": 1527741392, "post_id": 50611261, "comment_id": 88243208, "body": "Thank you! This is something I didn&#39;t know how to do. If I understand you correctly, this means making the <code>MyPodStruct**</code> member an opaque pointer, and manually interpreting that memory, according to the underlying array-of-arrays structure. (I come from C/C++, where this would be like using <code>void*</code> and then casting to the real type...)"}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "reply_to_user": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "edited": false, "score": 1, "creation_date": 1527744347, "post_id": 50611261, "comment_id": 88244124, "body": "@Ziv Yes. Note that in the first example the original array is read upon request, while in the second example the original array is immediately copied to managed memory."}], "tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": false, "score": 2, "last_activity_date": 1527710306, "last_edit_date": 1527710306, "creation_date": 1527704773, "answer_id": 50611261, "question_id": 50610552, "link": "https://stackoverflow.com/questions/50610552/can-i-marshal-a-c-struct-with-a-2d-array-without-using-unsafe/50611261#50611261", "title": "Can I marshal a C-struct with a 2d array without using &quot;unsafe&quot;?", "body": "<p>Mmmmh... I'll post some code, that probably you don't need :-)</p>\n\n<p>I'm using the latest compiler (C# 7.0) (<a href=\"https://www.nuget.org/packages/Microsoft.Net.Compilers\" rel=\"nofollow noreferrer\">nuget</a>) plus an unsafe library (<a href=\"https://www.nuget.org/packages/System.Runtime.CompilerServices.Unsafe/\" rel=\"nofollow noreferrer\">nuget</a>).</p>\n\n<p>The point here is that I don't want to marshal by copy the <code>Unmanaged2d</code> struct, nor I want to copy the array. I want to use them \"in place\". I'll use the <code>ref return</code> plus some <code>Unsafe.As*</code> methods to read the single <code>MyPodStruct</code> when asked, and a bidimensional indexer to hide everything. sadly the <code>Unsafe.As*</code> require the <code>unsafe</code> keyword, because its methods accept <code>void*</code> instead of accepting <code>IntPtr</code>.</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential, Size = 16)]\npublic struct MyPodStruct // Plain Old Data\n{\n    public double a;\n    public double b;\n};\n\n[StructLayout(LayoutKind.Sequential)]\npublic struct Unmanaged2d\n{\n    public IntPtr arr;\n    public int n;\n    public int m;\n\n    public unsafe ref MyPodStruct this[int x, int y]\n    {\n        get\n        {\n            if (x &lt; 0 || x &gt;= n)\n            {\n                throw new ArgumentOutOfRangeException(nameof(x));\n            }\n\n            if (y &lt; 0 || y &gt;= m)\n            {\n                throw new ArgumentOutOfRangeException(nameof(y));\n            }\n\n            IntPtr ptr = Marshal.ReadIntPtr(arr, x * sizeof(IntPtr));\n            IntPtr ptr2 = ptr + y * 16; // 16 == sizeof(MyPodStruct)\n            return ref Unsafe.AsRef&lt;MyPodStruct&gt;(ptr2.ToPointer());\n        }\n    }\n}\n\nunsafe_Init2d(ref unsafeRes, n, m);\n\n// We increase all the values of a and b, just to show that we can!\nfor (int i = 0; i &lt; u.n; i++)\n{\n    for (int j = 0; j &lt; u.m; j++)\n    {\n        u[i, j].a += 10;\n        u[i, j].b++;\n    }\n}\n\n// We print them\nfor (int i = 0; i &lt; u.n; i++)\n{\n    Console.WriteLine(string.Join(\";\", Enumerable.Range(0, u.m).Select(x =&gt; string.Format($\"({u[i, x].a},{u[i, x].b})\"))));\n}\n</code></pre>\n\n<p>As a sidenote, it seems that using <code>IntPtr</code> to make \"unsafe\" code \"safe\" is getting frowned upon. See for example <a href=\"https://github.com/dotnet/corefx/issues/18946#issuecomment-297579578\" rel=\"nofollow noreferrer\">here</a> where a request for an overload to <code>Span&lt;T&gt;(void*)</code> that accept a <code>Span&lt;T&gt;(IntPtr)</code> and has been closed because:</p>\n\n<blockquote>\n  <p>We want operations with pointers to be explicit operation with pointers, and not hide them behind IntPtr that tend to give people a false sense of safety.</p>\n</blockquote>\n\n<p>and <a href=\"https://github.com/dotnet/coreclr/issues/18150#issuecomment-392530423\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In general what you want to do can be done with some <code>Marshal.ReadIntPtr</code> plus <code>BitConverter.Int64BitsToDouble(Marshal.ReadInt64(...))</code>, like:</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct Unmanaged2d\n{\n    public IntPtr arr;\n    public int n;\n    public int m;\n\n    public static MyPodStruct[,] Fill2dResult()\n    {\n        Unmanaged2d unsafeRes = new Unmanaged2d();\n\n        //unsafe_Init2d(ref unsafeRes, n, m); // I have n, m from elsewhere\n        //unsafe_Fill2dResult(ref unsafeRes);\n\n        MyPodStruct[,] res = new MyPodStruct[unsafeRes.n, unsafeRes.m];\n\n        for (int i = 0; i &lt; unsafeRes.n; i++)\n        {\n            IntPtr row = Marshal.ReadIntPtr(unsafeRes.arr, i * IntPtr.Size);\n\n            for (int j = 0, offset = 0; j &lt; unsafeRes.m; j++)\n            {\n                // Automatic marshaling of MyPodStruct\n                // res[i, j] = Marshal.PtrToStructure&lt;MyPodStruct&gt;(row + j * (sizeof(double) + sizeof(double)));\n\n                // Manual marshaling\n\n                // a\n                long temp1 = Marshal.ReadInt64(row, offset);\n                double dbl1 = BitConverter.Int64BitsToDouble(temp1);\n                offset += sizeof(double);\n\n                // b\n                long temp2 = Marshal.ReadInt64(row, offset);\n                double dbl2 = BitConverter.Int64BitsToDouble(temp2);\n                offset += sizeof(double);\n\n                res[i, j] = new MyPodStruct { a = dbl1, b = dbl2 };\n            }\n        }\n\n        //unsafe_Free2d(ref unsafeRes);\n\n        return res;\n    }\n}\n</code></pre>\n\n<p>This code doesn't technically contain anything that is <code>unsafe</code>, but it is as much unsafe as your code.</p>\n\n<p>Ah... and in C#, what you have in C is called a jagged array. It is an array of arrays (a first level of arrays of pointers that point to many second level arrays of elements). It isn't a multidimensional array.</p>\n"}], "owner": {"reputation": 2325, "user_id": 299713, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vz8ZL.png?s=128&g=1", "display_name": "Ziv", "link": "https://stackoverflow.com/users/299713/ziv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1527740919, "creation_date": 1527701728, "last_edit_date": 1527740919, "question_id": 50610552, "link": "https://stackoverflow.com/questions/50610552/can-i-marshal-a-c-struct-with-a-2d-array-without-using-unsafe", "title": "Can I marshal a C-struct with a 2d array without using &quot;unsafe&quot;?", "body": "<p>I have a C DLL that I'm writing a C# interop class for.</p>\n\n<p>In the C DLL, one of the key methods fills a 2d structure; the structure is allocated and freed by helper methods, like so:</p>\n\n<pre><code>// Simple Struct Definition -- Plain Old Data\ntypedef struct MyPodStruct_s\n{\n    double a;\n    double b;\n} MyPodStruct;\n\ntypedef struct My2dArray_s\n{\n    MyPodStruct** arr; // allocated by Init2d;\n                       // array of arrays.\n                       // usage: arr[i][j] for i&lt;n,j&lt;m\n    int n;\n    int m;\n} My2dArray;\n\nvoid Init2d(My2dArray* s, int n, int m);\nvoid Free2d(My2dArray* s);\n\n// fill according to additional work elsewhere in the code:\nvoid Fill2dResult(My2dArray* result);\n</code></pre>\n\n<p>Simply marshaling <code>My2dArray.arr</code> as a pointer to a pointer looks like an issue. <strong>Is there any way I can marshal this for C#, so that I <em>don't</em> need the C# code to be unsafe?</strong><br>\n(I'd strongly prefer to avoid modifying my C API if possible, or at least keeping the changes minimal, but this is an option if it's the only way.)</p>\n\n<p>Here's the unsafe C# code I have presently (simplified slightly from the real thing). It works fine and does what I want, but requires unsafe usage:</p>\n\n<pre><code>class FooInterop\n{\n    public struct MyPodStruct // Plain Old Data\n    {\n        public double a;\n        public double b;\n    };\n\n    [StructLayout(LayoutKind.Sequential)]\n    private unsafe struct unmanaged2d\n    {\n        public MyPodStruct** arr;\n        public int n;\n        public int m;\n    };\n\n    [DllImport(\"Foo.DLL\", EntryPoint = \"Init2d\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern void unsafe_Init2d(ref FooInterop.unmanaged2d, int n, int m);\n    [DllImport(\"Foo.DLL\", EntryPoint = \"Free2d\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern void unsafe_Free2d(ref FooInterop.unmanaged2d);\n    [DllImport(\"Foo.DLL\", EntryPoint = \"Fill2dResult\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern void unsafe_Fill2dResult(ref FooInterop.unmanaged2d);\n\n    public static FooInterop.MyPodStruct[,] Fill2dResult()\n    {\n        unmanaged2d unsafeRes = new unmanaged2d();\n        FooInterop.MyPodStruct[,] res;\n\n        unsafe_Init2d(ref unsafeRes, n, m); // I have n, m from elsewhere\n        unsafe_Fill2dResult(ref unsafeRes );\n        res = new FooInterop.MyPodStruct[n,m];\n\n        for (int i=0; i&lt;n; ++i)\n        {\n            for (int j=0; j&lt;m; ++j)\n            {\n                unsafe\n                {\n                    res[i, j] = unsafeRes.arr[i][j];\n                }\n            }\n        }\n\n        unsafe_Free2d(ref unsafeRes );\n\n        return res;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "math", "sudoku"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1527701967, "post_id": 50610540, "comment_id": 88231008, "body": "I can&#39;t be the only one that is struggling to find the <i>question</i> in this question."}, {"owner": {"reputation": 1, "user_id": 9871510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7iIFDMZAbfI/AAAAAAAAAAI/AAAAAAAAAz4/hGHcGN_opEA/photo.jpg?sz=128", "display_name": "Francesco Porcelli", "link": "https://stackoverflow.com/users/9871510/francesco-porcelli"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527702190, "post_id": 50610540, "comment_id": 88231135, "body": "okay, the problem is that the output is wrong but i don&#39;t know were i&#39;m wrong!"}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1527702366, "post_id": 50610540, "comment_id": 88231227, "body": "Try freelancers&#39; site."}, {"owner": {"reputation": 1, "user_id": 9871510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7iIFDMZAbfI/AAAAAAAAAAI/AAAAAAAAAz4/hGHcGN_opEA/photo.jpg?sz=128", "display_name": "Francesco Porcelli", "link": "https://stackoverflow.com/users/9871510/francesco-porcelli"}, "edited": false, "score": 0, "creation_date": 1527702651, "post_id": 50610540, "comment_id": 88231370, "body": "I want to specify that is not a work, just a school project and one of the reasons that the code is posted here is to make it readable to my colleagues and teacher."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527702978, "post_id": 50610540, "comment_id": 88231529, "body": "Does the question assume that <code>int solutions[9][9][9]</code> will hold all possible solutions? That array can hold only 9 solutions. There are apparently 6,670,903,752,021,072,936,960 possible Soduko solutions. The array size you need will depend on the number of pre-filled cells there are."}, {"owner": {"reputation": 1, "user_id": 9871510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7iIFDMZAbfI/AAAAAAAAAAI/AAAAAAAAAz4/hGHcGN_opEA/photo.jpg?sz=128", "display_name": "Francesco Porcelli", "link": "https://stackoverflow.com/users/9871510/francesco-porcelli"}, "edited": false, "score": 1, "creation_date": 1527703564, "post_id": 50610540, "comment_id": 88231832, "body": "int solutions[9][9][9] is formatted as you see on the top, each solutions[9][9][ ] contains 9 numbers from 1 to 9 at the beginning, but they are replaced by 0&#39;s when the program runs until only 1 solution is different from 0. I don&#39;t understand when you say &quot;6,670,903,752,021,072,936,960 possible Soduko solutions&quot;, are they the quantity of solutions?"}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1527704510, "post_id": 50610540, "comment_id": 88232299, "body": "@Francesco Porcelli, I mean it&#39;s hard for brain and probably cost 5-15$"}], "owner": {"reputation": 1, "user_id": 9871510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7iIFDMZAbfI/AAAAAAAAAAI/AAAAAAAAAz4/hGHcGN_opEA/photo.jpg?sz=128", "display_name": "Francesco Porcelli", "link": "https://stackoverflow.com/users/9871510/francesco-porcelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527703871, "creation_date": 1527701656, "last_edit_date": 1527703871, "question_id": 50610540, "link": "https://stackoverflow.com/questions/50610540/extracting-a-number-from-a-3d-array-that-is-the-only-one-in-the-row-or-in-the-co", "title": "Extracting a number from a 3d array that is the only one in the row or in the column c / c++", "body": "<p>What i'm trying to do is a non-recorsive sudoku solver, I have an array sudoku[9][9] that is the sudoku itself with 0 as empty spaces and an array of arrays solutions[9][9][9] where all the possible solution are initially filled (from 1 to 9) and they became 0's if they don't respect one of the rules. \nI'll explain with an example, ignoring for a second the 3*3 square rule for easiness:\nif the first 3 rows of the sudoku matrix are</p>\n\n<pre><code>0 9 0 3 4 6 8 7 5\n7 8 0 5 0 2 6 3 0\n6 2 3 9 5 1 7 8 4\n</code></pre>\n\n<p>in the first 27 rows of the solution matrix we'll have</p>\n\n<pre><code>0.0 120000000    1.0 123456789   2.0 123456789\n0.1 123456789    1.1 123456789   2.1 123456789\n0.2 120000000    1.2 100400009   2.2 123456789\n0.3 123456789    1.3 123456789   2.3 123456789\n0.4 123456789    1.4 100000009   2.4 123456789\n0.5 123456789    1.5 123456789   2.5 123456789\n0.6 123456789    1.6 123456789   2.6 123456789\n0.7 123456789    1.7 123456789   2.7 123456789\n0.8 123456789    1.8 100000009   2.8 123456789\n</code></pre>\n\n<p>I need a function that checks if there is no solution equal to mine in the solutions of the other free cells (row, column, 3*3 square). If so return that solution (mine is correct). for example in this case it have to return \"4\" for the cell 1.2, since in the other free cells (1.4 and 1.8), \"4\" is not a solution. I'm having a very  hard time doing the loop chain, here is my code only for the check in the solutions of the row (still, for easiness), the printf is only for debugging purpose:</p>\n\n<pre><code>    int verifyequalsolutions (int sudoku[9][9], int solutions[9][9][9], int i, int j)\n{\n    int k=0, a=0, z=0;\n    int rowsolution=0;\n\n    for (k=1; k&lt;9; k++)             //scanning solutions[i][j][k], i'm cycling k to compare every existing pre-existing solution for my element\n    {\n        for (a=0; a&lt;9; a++)         //\n        {\n            if (a!=j &amp;&amp; sudoku[i][a]==0)\n            {\n            for (z=1;z&lt;9;z++)       //scanning solutions[i][a][z]\n                    {\n                          if (solutions[i][j][k]==solutions[i][a][z])\n                        {   rowsolution=0;\n                            a=10;\n                            z=10;\n                            break;\n                        }\n                        else if (z&lt;=9) {rowsolution=solutions[i][j][k];}\n                    }\n            }\n        }\n    }\n    if (rowsolution!=0)\n    {\n        printf(\"for [%d][%d] i found something in the row!: %d\\n\",i,j, rowsolution);\n        return rowsolution;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Since the output is actually wrong I want to analize my doubts one by one:\nis my loop exit legit? can i just increase the for variable over the condition to exit?</p>\n\n<p>I hope that someone finds this challange interesting and is so kind to help me.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "linux", "memory", "x86", "tlb"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1527700801, "post_id": 50610281, "comment_id": 88230349, "body": "This is mostly architecture specific."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1527700942, "post_id": 50610281, "comment_id": 88230419, "body": "Without knowing the precise characteristics of the CPU this is running on and how the compiler will generate machine instructions this is not possible. Also if this is just C code, please, <b>please</b> do not tag as C++ for no reason."}, {"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527700956, "post_id": 50610281, "comment_id": 88230428, "body": "@EugeneSh. While it is indeed mostly architecture specific, I can&#39;t help but wonder if there might be a way to pull this off reliably by using <code>volatile</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1527701000, "post_id": 50610281, "comment_id": 88230445, "body": "@Frank How would <code>volatile</code> help on a system without any cache or tlb?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1527701144, "post_id": 50610281, "comment_id": 88230528, "body": "@Frank <code>volatile</code> is just a way of avoiding compiler optimizations that assume the data can&#39;t change unless written to by the code."}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1527701719, "post_id": 50610281, "comment_id": 88230894, "body": "Where did you get those words like &#39;tlb&#39;?"}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "edited": false, "score": 0, "creation_date": 1527701936, "post_id": 50610281, "comment_id": 88230992, "body": "added architecture specific info"}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527702037, "post_id": 50610281, "comment_id": 88231047, "body": "@tadman  I added architecture, OS and toolchain info"}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527702094, "post_id": 50610281, "comment_id": 88231084, "body": "@EugeneSh. Added info related to arch, OS and toolchain"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527702117, "post_id": 50610281, "comment_id": 88231098, "body": "&quot;x86 CPU&quot; is not specific enough, that may as well say &quot;some kind of computer&quot;. For this kind of thing you&#39;ll need a specific Intel or AMD part number. Xeon, i7, i5, i3, Pentium, Epyc, Ryzen, they&#39;re all substantially different, even between &quot;generations&quot;. A Xeon 2670 and 2670v3 are two radically different chips despite the same base part number."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1527702176, "post_id": 50610281, "comment_id": 88231127, "body": "@tadman And apparently it would be pretty hard to get the processor-specific answer. Too narrow.."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527702235, "post_id": 50610281, "comment_id": 88231156, "body": "@EugeneSh. I&#39;m not disagreeing with that, either. This would be really difficult to do reliably on a single target CPU, but at least it would be theoretically possible with enough experimentation."}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527702298, "post_id": 50610281, "comment_id": 88231191, "body": "@tadman Added processor specific info into the question"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527702333, "post_id": 50610281, "comment_id": 88231208, "body": "There&#39;s no easy answer here. The first question you should be asking is &quot;How do I know if the TLB has been invalidated?&quot; and to get that answer you need to read the processor documentation. That is a nice CPU though."}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1527702826, "post_id": 50610281, "comment_id": 88231456, "body": "@tadman Found this question that might be useful <a href=\"https://stackoverflow.com/questions/20183273/how-to-test-main-memory-access-time?noredirect=1&amp;lq=1\" title=\"how to test main memory access time\">stackoverflow.com/questions/20183273/&hellip;</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1527725652, "post_id": 50610281, "comment_id": 88239756, "body": "Are you trying to measure TLB evictions from needing to load new entries?  i.e. capacity misses and conflict misses.  In that case touch a single line per 4k page (preferably chosen to avoid L1d conflict misses).  Use <code>volatile</code> loads.  Disable anonymous hugepages, or account for it in your microbenchmark.  Or are you trying to measure cases where the kernel used <code>invlpg</code> to actively invalidate a TLB entry?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1527725855, "post_id": 50610281, "comment_id": 88239800, "body": "Basically you should read up on how Zen&#39;s TLB works (i.e. fully associative or not), and design your microbenchmark to confirm that.  It&#39;s much easier to write a microbenchmark when you already know the result you&#39;re expecting, so you should aim for this most of the time :P  If not, it&#39;s easy to actually measure something without realizing it."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527739913, "post_id": 50610281, "comment_id": 88242847, "body": "The code accesses only a 4KB array, which can be contained within a single page or at most two pages. So the code only fills one or two TLB entries."}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527780635, "post_id": 50610281, "comment_id": 88265723, "body": "@HadiBrais Could you change the code so that it fills up all tlb entries?"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527785311, "post_id": 50610281, "comment_id": 88268306, "body": "Not easy. That will take some effort."}, {"owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1527791196, "post_id": 50610281, "comment_id": 88271145, "body": "@HadiBrais Please post as solution. Even pseducode is fine. I will do the effort. I am looking for clear guidelines"}], "owner": {"reputation": 119, "user_id": 3746364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/338ee891b3830a92166f60531b5de376?s=128&d=identicon&r=PG&f=1", "display_name": "tulamba", "link": "https://stackoverflow.com/users/3746364/tulamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527702416, "creation_date": 1527700691, "last_edit_date": 1527702416, "question_id": 50610281, "link": "https://stackoverflow.com/questions/50610281/how-to-generate-x86-cpu-to-main-memory-traffic-in-c-to-fill-and-invalidate-tlb-b", "title": "How to generate x86 CPU to main memory traffic in C to fill and invalidate TLB buffer on linux machine", "body": "<p>I want to generate x86 CPU to Memory traffic on Linux OS (Ubuntu 18) using gcc tool chain that should first fill up tlb (translation look aside buffer) and then cause tlb invalidates as it has already filled up. I have created simple code below but I am not sure if it can achieve the goal of filling up tlb and then invalidating it</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n\nint array[1000];\n\nint i;\nlong sum = 0;\n\nfor(i=0; i &lt; 1000;i++)\n{\n    array[i] = i;   \n}\n\n\nfor(i=0; i &lt; 1000;i++)\n{\n    sum += array[i] \n}\n\nreturn 0;\n\n}\n</code></pre>\n\n<p>Here is the processor specific info in case it is useful</p>\n\n<pre><code>processor       : 0\nvendor_id       : AuthenticAMD\ncpu family      : 23\nmodel           : 1\nmodel name      : AMD EPYC 7281 16-Core Processor\nstepping        : 2\nmicrocode       : 0x8001227\ncpu MHz         : 2694.732\ncache size      : 512 KB\nphysical id     : 0\nsiblings        : 32\ncore id         : 0\ncpu cores       : 16\napicid          : 0\ninitial apicid  : 0\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 13\nwp              : yes\n</code></pre>\n\n<p>The crux is to have answers to the following</p>\n\n<ol>\n<li>what triggers tlb invalidates to happen?  </li>\n<li>How can one test tlb invalidates did happen?</li>\n</ol>\n"}, {"tags": ["c++", "c", "language-lawyer", "standards", "new-operator"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701024, "post_id": 50610274, "comment_id": 88230465, "body": "I am going to guess <a href=\"https://twitter.com/shafikyaghmour/status/991384169895755776\" rel=\"nofollow noreferrer\">pointer provenance</a> a lot of the details are going to be in WG14 defect reports though :-("}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701155, "post_id": 50610274, "comment_id": 88230536, "body": "@ShafikYaghmour the link to the tweet is broken :( Is there a link to that defect report somewhere?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527701214, "post_id": 50610274, "comment_id": 88230568, "body": "Fixed the link, sorry"}, {"owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1527701249, "post_id": 50610274, "comment_id": 88230593, "body": "I would expect <code>behavior is as if the size were some nonzero value</code> to imply non-null addresses returned are unique."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 5, "creation_date": 1527701703, "post_id": 50610274, "comment_id": 88230880, "body": "It goes way back into pre-standard history, and just seems like <a href=\"https://wg21.link/LWG9\" rel=\"nofollow noreferrer\">the way it has always been</a>."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "edited": false, "score": 0, "creation_date": 1527701738, "post_id": 50610274, "comment_id": 88230903, "body": "@John I&#39;ve just added the relevant part of the C standard for that to the answer. The caveat is that the C standard does not require the non-null addresses to be unique; it requires the memory allocations to be disjoint."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1527702079, "post_id": 50610274, "comment_id": 88231076, "body": "@BoPersson thanks! That&#39;s maybe as close as I am going to get for a definitive answer. I still wonder why that was specifically prohibited by ARM 5.3.3. :/"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1527702540, "post_id": 50610274, "comment_id": 88231312, "body": "@BoPersson why isn&#39;t it an answer?"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1527702583, "post_id": 50610274, "comment_id": 88231333, "body": "But <a href=\"http://eel.is/c++draft/basic.stc.dynamic.allocation#footnote-36\" rel=\"nofollow noreferrer\">the footnote says it is to be compatible w/ malloc/calloc</a> so I think disjoint means unique or at leas that is the interpretation."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1527702678, "post_id": 50610274, "comment_id": 88231384, "body": "@SergeyA The defect report contains no rationale beyond &quot;ARM 5.3.3 forbid this&quot; (no reason mentioned). It&#39;s a really good hint, but I don&#39;t know if it alone can be considered an answer. It might maybe be the best answer there ever is though :/"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1527702798, "post_id": 50610274, "comment_id": 88231450, "body": "@ShafikYaghmour That&#39;s not what the C standard says though, and if the intent was to be compatible with C the C++ standard would have kept the semantics. The <a href=\"https://github.com/llvm-mirror/libcxx/blob/master/src/new.cpp#L71\" rel=\"nofollow noreferrer\">libc++</a>  and <a href=\"https://github.com/gcc-mirror/gcc/blob/da8dff89fa9398f04b107e388cb706517ced9505/libstdc%2B%2B-v3/libsupc%2B%2B/new_opa.cc#L95\" rel=\"nofollow noreferrer\">libstdc++</a> implementation of the two new operators mentioned transform zero into a 1byte sized allocation making them disjoint. That is, clang and gcc don&#39;t assume in practice that malloc behaves that way."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 1, "creation_date": 1527728784, "post_id": 50610274, "comment_id": 88240454, "body": "I&#39;d argue that the implementation-defined aspect of <code>malloc</code>/<code>calloc</code>/<code>realloc</code> is something of a defect.  It means that a <code>NULL</code> response can actually signal <i>success</i> if 0 bytes were requested, hence the check for success has to look something like <code>if ((size == 0) || (returnedPointer != NULL)) ...</code> and functions accepting that pointer as an argument may not realize that <code>NULL</code> may actually be &quot;valid.&quot;  I&#39;m not too surprised that C++98 chose to remove this issue, and of course it wasn&#39;t always the case that <code>operator new</code> threw an exception when allocation failed."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527729225, "post_id": 50610274, "comment_id": 88240552, "body": "&quot;It means that a NULL response can actually signal success if 0 bytes were requested&quot; But does it? It might also mean &quot;failed to allocate zero bytes&quot;. In any case, you can&#39;t dereference the returned pointer, and if one is checking for <code>size == 0</code>, why is one still calling <code>malloc(0)</code> then?"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 1, "creation_date": 1527732256, "post_id": 50610274, "comment_id": 88241127, "body": "One could check for <code>size == 0</code> before calling <code>malloc</code>, of course.  The point is that that check must happen <i>somewhere</i>.  If we knew that successful <code>malloc</code> would always return a non-<code>NULL</code> pointer, then we could just check <code>if (returnedPointer != NULL)</code> after calling <code>malloc</code> -- a check that we&#39;d have to do in any case -- and never have to worry about the <code>size == 0</code> special case."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1527736777, "post_id": 50610274, "comment_id": 88242190, "body": "@JoshuaGreen I can imagine an implementation of <code>malloc</code> where it does something like <code>if(available(p) &gt;= size) return p;</code>, the check for <code>size == 0</code> need not be explicit"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1527813932, "post_id": 50610274, "comment_id": 88279429, "body": "@PasserBy, what is <code>available</code> and where is <code>p</code> coming from? More concretely, I can imagine: a) Wanting <code>malloc</code> to return a new non-<code>NULL</code> pointer on 0-byte allocations. b) Being OK with <code>malloc</code> returning <code>NULL</code> on 0-byte allocations. If the library provides (a), then I can wrap it with a check to get (b).  If the library provides (b), then I can&#39;t construct (a) out of that.  One could -- and probably would -- argue that there&#39;s no reason to force that strengthened contract on programs that don&#39;t need it, but it does make life simpler in ways that can&#39;t really be simulated otherwise."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "reply_to_user": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 0, "creation_date": 1527815815, "post_id": 50610274, "comment_id": 88279771, "body": "@PasserBy, I&#39;d be much happier with the current situation if I could determine the 0-size allocation behavior of <code>malloc</code> at compile-time by testing a predefined macro.  As it is, we have <a href=\"https://wiki.sei.cmu.edu/confluence/display/c/MEM04-C.+Beware+of+zero-length+allocations\" rel=\"nofollow noreferrer\">this warning</a>."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "reply_to_user": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528020973, "post_id": 50610274, "comment_id": 88340551, "body": "@JoshuaGreen that&#39;s because there has been enough research about zero-allocation vulnerabilities, mostly by microsoft security engineering center, that have shown how to exploit these in some cases."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528251638, "post_id": 50610274, "comment_id": 88431668, "body": "@gnzlbg, I agree with the warning, as this forces people to think about what they&#39;re doing.  I think specifying the behavior and/or allowing programmers to determine the behavior would help.  The claim &quot;In cases where the memory allocation functions return a non-null pointer, reading from or writing to the allocated memory area results in undefined behavior&quot; strikes me as trying to make this case seem worse than it is.  After all, reading from or writing outside of the allocated area is <i>always</i> undefined, so this statement is just a specific case that follows from the allocated area being 0."}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528251963, "post_id": 50610274, "comment_id": 88431743, "body": "To continue that thought, the first &quot;Noncompliant Code Example&quot; is hardly fair.  For an &quot;arbitrary&quot; <code>size</code>, what sort of <code>&#47;* Continue processing list *&#47;</code> code would make sense, and what would it try to do in the <code>size == 0</code> case if the author weren&#39;t specifically thinking about it?"}, {"owner": {"reputation": 1344, "user_id": 1019990, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ae752103140fb371af11b1719a36eaa?s=128&d=identicon&r=PG", "display_name": "Joshua Green", "link": "https://stackoverflow.com/users/1019990/joshua-green"}, "edited": false, "score": 0, "creation_date": 1528252067, "post_id": 50610274, "comment_id": 88431766, "body": "(Hallvard Furuseth&#39;s comment at that page is along these lines.)"}], "answers": [{"comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1527710797, "post_id": 50612074, "comment_id": 88235180, "body": "But one could argue that they are the same object."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527723893, "post_id": 50612074, "comment_id": 88239324, "body": "The overloads of <code>operator new</code> mentioned in the question only return raw memory: they have nothing to do with objects AFAICT."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "edited": false, "score": 1, "creation_date": 1527727733, "post_id": 50612074, "comment_id": 88240229, "body": "^That. Aliasing is a non-issue, memory returned by <code>operator new</code> is not an object. By the time an object is created, it may either be the only object there, or it destroyed a previous object by reusing its memory."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1527805967, "post_id": 50612074, "comment_id": 88277589, "body": "IMHO, rather than requiring that objects have a unique identity, the Standard should instead have said that an object of size N occupies N+1 addresses, the first N of which each identify a different byte owned by the object and the last N of which each immediately follow those same bytes in the same order.  Requiring that compilers pretend that empty objects take up a byte adds complexity to the language without serving a useful purpose.  Any code that wants to ensure an object&#39;s address will be unique could simply make sure its size isn&#39;t zero."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 0, "creation_date": 1527818894, "post_id": 50612074, "comment_id": 88280407, "body": "When are zero sized objects not subobjects of classes of size at least one?"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527934168, "post_id": 50612074, "comment_id": 88321541, "body": "@Emilio Is <code>void* operator new(size_t)</code> a <code>new-expression</code> (cppreference only says that&#39;s a function called by some of them)? What&#39;s the type of the created region of storage?"}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1527962366, "post_id": 50612074, "comment_id": 88329356, "body": "@gnzlbg A new expression is <code>new A</code> returning <code>A*</code>. It results in a call to to operator new (sizeof(A)) and a subsequent call to the A constructor.  if you call <code>new A</code> twice, you need two distinct A*, hence <code>opeator new</code> must return two distinct <code>void*</code>. Even if the size is 0."}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528020636, "post_id": 50612074, "comment_id": 88340466, "body": "@EmilioGaravaglia The thing is I am not asking about <code>new-expression</code>s in my question, but about the explicit <code>operator new</code> function calls that allocate raw memory and are used like this:   <code>void* ptr = operator new(size);</code>. AFAICT that&#39;s just a normal function call and not a <code>new-expression</code> (no types involved). If these are <code>new-expression</code>s it would be nice to add a source to your answer, because otherwise nothing in it applies to the question."}, {"owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "reply_to_user": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 1, "creation_date": 1528037829, "post_id": 50612074, "comment_id": 88345207, "body": "@gnzlbg: the point is that <code>operator new</code> must return memory that is suitable for object construction. So it must never be twice the same address (without an <code>operator delete</code>)"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528122506, "post_id": 50612074, "comment_id": 88375417, "body": "That argument makes sense. I think the unique address argument does not apply everywhere now that <code>[[no_unique_address]]</code> has been merged into the <code>std</code> (two zero-sized objects can share the same address). However, this attribute cannot be used in any places where operator new could actually return the same address for two zero-sized objects, so it does not apply here."}], "tags": [], "owner": {"reputation": 18808, "user_id": 924727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=128&d=identicon&r=PG", "display_name": "Emilio Garavaglia", "link": "https://stackoverflow.com/users/924727/emilio-garavaglia"}, "is_accepted": true, "score": 8, "last_activity_date": 1527839811, "last_edit_date": 1527839811, "creation_date": 1527708203, "answer_id": 50612074, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero/50612074#50612074", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>The problem is that <strong>objects</strong> (no matter their size) in C++ <strong>must have a unique identity</strong>. So different coexisting objects (no matter their size) must have different address, since <strong>two pointer that compare as equal are assumed to point to a same object</strong>.</p>\n\n<p>If you admit that zero-sized objects can have same address you cannot anymore distinguish if two address are or not a same object.</p>\n\n<hr>\n\n<p>Many comments about the \"new does not return objects\" issue.</p>\n\n<p>Please FORGET OOP terminology in this context:</p>\n\n<p>C++ specification have a precise definition of what the word \"Object\" means.</p>\n\n<p><a href=\"http://en.cppreference.com/w/cpp/language/object\" rel=\"noreferrer\">CPP Reference:Object</a></p>\n\n<p>In particular:</p>\n\n<blockquote>\n  <p>C++ programs create, destroy, refer to, access, and manipulate objects.\n  An object, in C++, is a region of storage that has</p>\n  \n  <ul>\n  <li>size (can be determined with sizeof);</li>\n  <li>alignment requirement (can be determined with alignof);</li>\n  <li>storage duration (automatic, static, dynamic, thread-local);</li>\n  <li>lifetime (bounded by storage duration or temporary);</li>\n  <li>type;</li>\n  <li>value (which may be indeterminate, e.g. for default-initialized non-class types);</li>\n  <li>optionally, a name. </li>\n  </ul>\n  \n  <p>The following entities are not objects: value, reference, function,\n  enumerator, type, non-static class member, bit-field, template, class or\n  function template specialization, namespace, parameter pack, and this.</p>\n  \n  <p>A variable is an object or a reference that is not a non-static data member,\n  that is introduced by a declaration.</p>\n  \n  <p>Objects are created by definitions, new-expressions, throw-expressions, when\n  changing the active member of a union, and where temporary objects are\n  required. </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528294334, "post_id": 50712543, "comment_id": 88453503, "body": "Thanks for the link, will check it out :)"}, {"owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "edited": false, "score": 0, "creation_date": 1528294548, "post_id": 50712543, "comment_id": 88453644, "body": "Note that in C++20 you can&#39;t use two pointers to see if they are the same object, because zero-sized data members are allowed to share their address with other objects (<code>[[no_unique_address]]</code>), so that will only work sometimes, at best."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1539018462, "post_id": 50712543, "comment_id": 92340333, "body": "If a programmer doesn&#39;t care whether the address of a zero-sized object compares equal to anything or not, then user-code handling of boundary conditions could be minimized by guaranteeing that if <code>p</code> and <code>q</code> is a valid pointer or the return of <code>malloc(0)</code>, then <code>p+0</code> and <code>p-0</code> will be equivalent to <code>p</code>, <code>p-p</code> will be equivalent to 0, <code>p&gt;p</code>, <code>p&lt;p</code>, and <code>p!=p</code> will all yield zero, <code>p&gt;=p</code>, <code>p==p,</code> and <code>p&lt;=p</code> will all yield 1, <code>memcpy(p,q,0) and </code>memmove(p,q,0)` will yield <code>p</code>, <code>p==q</code> and <code>p!=q</code> will yield 0 or 1, etc. all without side-effects.  IMHO, malloc(0) should be allowed to..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1539018574, "post_id": 50712543, "comment_id": 92340385, "body": "...return a null pointer only on those systems which would uphold all of the above guarantees <i>anyway</i>.  Outside a few cases where one wants to generate a unique token (which could be better served with a proper &quot;unique token&quot; type) I&#39;m not sure why code should care about whether a pointer to a &quot;zero-sized object&quot; compares equal or unequal to anything else."}], "tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": false, "score": 1, "last_activity_date": 1528261215, "creation_date": 1528261215, "answer_id": 50712543, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero/50712543#50712543", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>The reason is simply that code should not require special handling of boundary conditions. Many, I would say most, algorithms have to deal with zero-sized objects as boundary conditions. Less common is the algorithm that compare pointers to objects to see if they are the same object, but this still should work even for zero-sized objects.</p>\n\n<p>However, your question assumes that this is a change. Apart from a brief hiatus in the late 1980's all C and C++ implementations that I am aware of have always behaved like this.</p>\n\n<p>The original C compiler by dmr behaved like this but then around 1987 the draft C standard specified that malloc of a zero sized object return NULL. This was truly bizarre and even the final C-89 standard made it implementation-defined but I have never since encountered an implementation that did this horrible thing.</p>\n\n<p>I talk more about this in <a href=\"http://devmethodologies.blogspot.com/2011/11/zero.html\" rel=\"nofollow noreferrer\">my blog</a> in the section \"Malloc Madness\".</p>\n"}], "owner": {"reputation": 6527, "user_id": 1422197, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6bcbddbd9c7b31aaff8cf25a356bc96c?s=128&d=identicon&r=PG", "display_name": "gnzlbg", "link": "https://stackoverflow.com/users/1422197/gnzlbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 2, "accepted_answer_id": 50612074, "answer_count": 2, "score": 12, "last_activity_date": 1528261215, "creation_date": 1527700675, "last_edit_date": 1528122765, "question_id": 50610274, "link": "https://stackoverflow.com/questions/50610274/what-is-the-rationale-behind-returning-unique-addresses-for-allocations-of-zero", "title": "What is the rationale behind returning unique addresses for allocations of zero size in C++?", "body": "<p>What is the rationale behind returning unique addresses for allocations of zero size in C++?</p>\n\n<p>Background: the C11 standard says about malloc (7.20.3 Memory management functions):</p>\n\n<blockquote>\n  <p>If the size of the space requested is zero, the behavior is implementation defined: either a null pointer is returned, or the behavior is as if the size were some nonzero value, except that the returned pointer shall not be used to access an object.</p>\n</blockquote>\n\n<p>That is, as I see it, <code>malloc</code> always succeeds for allocations of zero size since the only you can do with the pointer of a zero-sized allocation is call some other memory allocation function like <code>free</code> with it:</p>\n\n<ul>\n<li>if <code>malloc</code> returns <code>NULL</code>, <code>free(NULL)</code> is ok so this can be considered a success,</li>\n<li>if it returns some other value, that's also a success (because it isn't <code>NULL</code>), the only condition is that <code>free</code> on the value should also work.</li>\n</ul>\n\n<p>Also, C11 (also 7.20.3) does not specify that the address returned from malloc must be unique, only that they must point to disjoint memory regions:</p>\n\n<blockquote>\n  <p>The pointer returned if the allocation succeeds is suitably aligned so that it may be assigned to a pointer to any type of object and then used to access such an object or an array of such objects in the space allocated (until the space is explicitly deallocated). The lifetime of an allocated object extends\n  from the allocation until the deallocation. Each such allocation shall yield a pointer to an object disjoint from any other object.</p>\n</blockquote>\n\n<p>All objects of zero size are disjoint AFAICT, and that would mean that <code>malloc</code> can return the same pointer for multiple zero-sized allocations (e.g. <code>NULL</code> would be fine), or different pointers each time, or the same pointer for some, etc.</p>\n\n<p>Then C++98 came along with two raw memory allocation functions: </p>\n\n<pre><code>void* operator new(std::size_t size);\nvoid* operator new(std::size_t size, std::align_val_t alignment);\n</code></pre>\n\n<p>Note that these functions only return raw memory: they do not create or initialize any objects of any type AFAICT.</p>\n\n<p>You call them like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;new&gt;\nint main() {\n    void* ptr = operator new(std::size_t{0});\n    std::cout &lt;&lt; ptr &lt;&lt; std::endl;\n    operator delete(ptr, std::size_t{0});\n    return 0;\n}\n</code></pre>\n\n<p>The <code>[new.delete.single]</code> section of the C++17 standard explains them, but the key guarantee as I see it is given in <code>[basic.stc.dynamic.allocation]</code>:</p>\n\n<blockquote>\n  <p>Even if the size of the space requested is zero, the request can fail. If the request succeeds, the value returned shall be a non-null pointer value (7.11) p0 different from any previously returned value p1, unless that value p1 was subsequently passed to an operator delete. Furthermore, for the library allocation functions in 21.6.2.1 and 21.6.2.2, p0 shall represent the address of a block of storage disjoint from the storage for any other object accessible to the caller. The effect of indirecting through a pointer returned as a request for zero size is undefined.38</p>\n</blockquote>\n\n<p>That is, they must always return distinct pointers on success. That's a bit change from <code>malloc</code>.</p>\n\n<p>My question is: <strong>What is the rationale behind this change?</strong> (that is, behind returning unique addresses for allocations of zero size in C++)</p>\n\n<p>Ideally the answer would be just a link to the paper (or some other source) that explored the alternatives and motivated their semantics. Typically I go for The Design and Evolution of C++ for these C++98 questions, but Section 10 (Memory Management) does not mention anything about it. Otherwise, some sort of authoritative reference would be nice.</p>\n\n<hr>\n\n<p>Disclaimer: I <a href=\"https://www.reddit.com/r/cpp/comments/8n79wj/were_zerosized_memory_allocations_a_good_idea_in/\" rel=\"noreferrer\">asked it on reddit</a> but I did not ask nicely enough so I did not got any useful answer. I would like to kindly ask you that if you only have an hypothesis, please feel free to post it as an answer but mention that it is only an hypothesis. </p>\n\n<p>Also, on reddit people went on and on about zero-sized types, whether I have a proposal to change the standard, etc. This question is about the semantics of the raw memory allocation functions when passed a size equal to zero. If topics like zero-sized types are relevant for your answer, please include them! But try not to get too derailed with tangential issues.</p>\n\n<p>Also, on reddit people also threw arguments like \"that's for optimization purposes\" without really being able to mention anything more concrete. I'd expect something more concrete than \"because optimizations\" in an answer. For example, one redditor mentioned aliasing optimizations, but I wondered which kind of aliasing optimizations apply to pointers that cannot be dereferenced, and wasn't able to get anyone to comment on that. So maybe if you are going to mention optimizations, a small example that shows it would enrich the discussion.</p>\n"}, {"tags": ["c", "linux", "pthreads", "posix", "mutex"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527700514, "post_id": 50610150, "comment_id": 88230184, "body": "For one thing, you need to initialize your mutex and condition variables before you use them."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1527700754, "post_id": 50610150, "comment_id": 88230328, "body": "You perform a busy wait instead of waiting on your CV.  You signal your CVs even though nobody ever waits on them."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1527700821, "post_id": 50610150, "comment_id": 88230356, "body": "every thread opens the file and calls <code>fscanf()</code> once inside the <code>while</code> loop. How could that lead to anything but the first integer being read? You should open the file only once"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1527700972, "creation_date": 1527700972, "answer_id": 50610347, "question_id": 50610150, "link": "https://stackoverflow.com/questions/50610150/how-to-write-integers-from-file-to-buffer-using-posix-pthreads-in-linux/50610347#50610347", "title": "How to write integers from file to buffer using POSIX pthreads in Linux?", "body": "<p>You have numerous problems with the way you use your synchronization objects, some of which I described in comments, but the problem you asked about:</p>\n\n<blockquote>\n  <p>the loop runs forever and it keeps reading only the first integer on the file</p>\n</blockquote>\n\n<p>occurs because each thread opens the file freshly each time it wants to read a number.  <em>Of course</em> it then always reads the same number (the first), and never sees the end of the file.</p>\n\n<p>Instead, open the file just once for the whole program, probably in <code>main()</code>.</p>\n"}], "owner": {"reputation": 563, "user_id": 6658186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/44ngv.jpg?s=128&g=1", "display_name": "Pegasus008", "link": "https://stackoverflow.com/users/6658186/pegasus008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 50610347, "answer_count": 1, "score": 2, "last_activity_date": 1527700972, "creation_date": 1527700181, "question_id": 50610150, "link": "https://stackoverflow.com/questions/50610150/how-to-write-integers-from-file-to-buffer-using-posix-pthreads-in-linux", "title": "How to write integers from file to buffer using POSIX pthreads in Linux?", "body": "<p>I want to write a program to get integers from a file and put them in a buffer using multiple threads. The buffer size is 20 and there are 100 integers. I can't use for-loop because one thread should read one integer at a time. As an example, if we are using one thread that thread must run 100 times to read the data from the file to buffer. I wrote following code to using POSIX pthreads. But the loop runs forever and it keeps reading only the first integer on the file. Can someone point me out the error, please? (The integers are not separated by a comma.Ex: 1 2 3 4 ....etc upto 100 )</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n\npthread_mutex_t m;\npthread_cond_t  r;\npthread_cond_t w;\nFILE *fp;\nint cnt_w = 0;\nint cnt_r= 0;\n\nint value;\nint buf[20];\nint cnt = 0;\nint z = 0;\nint flag =0;\n\n\nvoid *read(void *parm);\nvoid *write(void *parm);\n\nint main(int argc, char argv[])\n{\n\n    pthread_t rid[2];\n    pthread_t wid[2];\n\n\n\n\n    for( int i = 0; i&lt; 2; i++)\n    {\n        printf(\"Writer %d Starts \\n\",i+1);\n        pthread_create(&amp;wid[i], NULL, write, i);\n    }\n\n\n//    for(int i = 0; i &lt; 2; i++)\n//    {\n//        printf(\"Reader %d Starts \\n\",i+1);\n//        pthread_create(&amp;rid[i],NULL,read,i);\n//    }\n\n//    for(int i = 0; i &lt; 2; i++)\n//    {\n//        pthread_join(rid[i],NULL);\n//    }\n\n\n    for(int i = 0; i &lt; 2; i++)\n    {\n        pthread_join(wid[i], NULL);\n    }\n\n    for(int i =0;i&lt;3;i++)\n    {\n        printf(\"%d \",buf[i]);\n    }\n\n    return 0;\n}\n\nvoid *read(void *parm)\n{\n\n\n}\n\nvoid *write(void *parm)\n{\n    int x = (int)parm ;\n    int y = 0;\n\n    while(flag != -1) {\n        pthread_mutex_lock(&amp;m);\n        printf(\"Writer %d Locked Mutex\\n\", x + 1);\n        while (cnt != 0) {\n            printf(\"Writer %d is waiting\\n\", x + 1);\n        }\n\n        cnt++;\n        printf(\"Writer %d Access CS \\n\", x + 1);\n\n        if ((fp = fopen(\"/home/pegasus/2/shared_data.txt\", \"r\")) == NULL) {\n            fprintf(stderr, \"Couldn't find the file\");\n        } else {\n            fscanf(fp, \"%d\", &amp;value);\n            buf[z] = value;\n\n\n            printf(\"Buf value = %d\\n\", buf[z]);\n            y++;\n            printf(\"z = %d\\n\", z);\n            z = z + y;\n            printf(\"z = %d\\n\", z);\n            sleep(1);\n\n            if (feof(fp)) {\n                flag = -1;\n                break;\n            }\n\n            fclose(fp);\n        }\n        printf(\"Writer %d Finished Access CS \\n\", x + 1);\n        printf(\"x = %d \\n\", y);\n\n        cnt = 0;\n        pthread_cond_signal(&amp;r);\n        printf(\"Signal Reader\\n\");\n        pthread_cond_signal(&amp;w);\n        printf(\"Signal Writer\\n\");\n\n\n        printf(\"Writer %d Unlocked Mutex\\n\", x + 1);\n        pthread_mutex_unlock(&amp;m);\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "makefile", "cmake", "qmake", "fingerprint"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1527699127, "post_id": 50609841, "comment_id": 88229450, "body": "The actual error is probably reported before the lines you quote."}, {"owner": {"reputation": 384, "user_id": 7834942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdf8702dcdfaa54a181b21e1ffab4a5?s=128&d=identicon&r=PG&f=1", "display_name": "thedeg123", "link": "https://stackoverflow.com/users/7834942/thedeg123"}, "edited": false, "score": 0, "creation_date": 1527700820, "post_id": 50609841, "comment_id": 88230354, "body": "Please include your Makefile so we can better address your question."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 0, "creation_date": 1527700907, "post_id": 50609841, "comment_id": 88230395, "body": "Please <a href=\"https://stackoverflow.com/posts/50609841/edit\">edit</a> your question to include the relevant info, don&#39;t post answers which aren&#39;t answers."}], "answers": [{"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": true, "score": 1, "last_activity_date": 1527701448, "creation_date": 1527701448, "answer_id": 50610479, "question_id": 50609841, "link": "https://stackoverflow.com/questions/50609841/compilation-error-fingerprint/50610479#50610479", "title": "Compilation error fingerprint", "body": "<p>You probably need to install a few packages which the fingerprint package depends on. I just compiled <code>fingerprint-gui-1.08</code> in Debian 9 and to complete the build process I needed to install the following packages:</p>\n\n<pre><code>sudo apt install libfakekey-dev libfprint-dev libpam0g-dev libpolkit-qt-1-dev libqca2-dev libusb-1.0-0-dev qt4-dev-tools qt4-qmake\n</code></pre>\n\n<p>Remember to run <code>qmake-qt4</code> before running <code>make</code> as the <code>README</code> file says.</p>\n"}], "owner": {"reputation": 41, "user_id": 9871522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f99a7b20f50a98f01f7c2b772b4bbea1?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/9871522/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 50610479, "answer_count": 1, "score": -1, "last_activity_date": 1527701621, "creation_date": 1527698912, "last_edit_date": 1527701621, "question_id": 50609841, "link": "https://stackoverflow.com/questions/50609841/compilation-error-fingerprint", "title": "Compilation error fingerprint", "body": "<pre><code>cd bin/ &amp;&amp; make -f Makefile \nmake[1]: Entering directory '/home/jimmy/Downloads/fingerprint-gui-1.08/bin'\ncd fingerprint-gui/ &amp;&amp; make -f Makefile \nmake[2]: Entering directory '/home/jimmy/Downloads/fingerprint-gui-1.08/bin/fingerprint-gui'\ng++ -m64 -Wl,-O1 -o fingerprint-gui GlobalsImg.o DeviceHandler.o AboutImpl.o ExistDialogImpl.o Fingerprint.o FingerprintData.o UpekDevice.o GenericDevice.o FingerprintGUI.o MainWindowImpl.o SavedDialogImpl.o MessageDialogImpl.o PamTester.o xmlwriter.o UserSettings.o UsbDevice.o moc_DeviceHandler.o moc_AboutImpl.o moc_ExistDialogImpl.o moc_Fingerprint.o moc_FingerprintDevice.o moc_FingerprintData.o moc_MainWindowImpl.o moc_SavedDialogImpl.o moc_MessageDialogImpl.o moc_PamTester.o qrc_GUI-res.o qrc_About-res.o    -L/usr/lib/x86_64-linux-gnu -lusb-1.0 -lfprint -lpam -ldl -lqca -lpthread -lQtXml -lQtGui -lQtCore \n/usr/bin/ld: cannot find -lfprint\ncollect2: error: ld returned 1 exit status\nMakefile:155: recipe for target 'fingerprint-gui' failed\nmake[2]: *** [fingerprint-gui] Error 1\nmake[2]: Leaving directory '/home/jimmy/Downloads/fingerprint-gui-1.08/bin/fingerprint-gui'\nMakefile:45: recipe for target 'sub-fingerprint-gui-make_default' failed\nmake[1]: *** [sub-fingerprint-gui-make_default] Error 2\nmake[1]: Leaving directory '/home/jimmy/Downloads/fingerprint-gui-1.08/bin'\nMakefile:39: recipe for target 'sub-bin-make_default' failed\nmake: *** [sub-bin-make_default] Error 2\n</code></pre>\n\n<p>This is output of make operation of pakage fingerprint.</p>\n\n<p>During the process I also 3 times have some problem with enclude but I have resolve installing 3 pagkage using apt. </p>\n\n<pre><code>#############################################################################\n# Makefile for building: fingerprint\n# Generated by qmake (2.01a) (Qt 4.8.7) on: Wed May 30 17:00:42 2018\n# Project:  fingerprint.pro\n# Template: subdirs\n# Command: /usr/bin/qmake-qt4 PREFIX=/usr -o Makefile fingerprint.pro\n#############################################################################\n\nfirst: make_default\nMAKEFILE      = Makefile\nQMAKE         = /usr/bin/qmake-qt4\nDEL_FILE      = rm -f\nCHK_DIR_EXISTS= test -d\nMKDIR         = mkdir -p\nCOPY          = cp -f\nCOPY_FILE     = $(COPY)\nCOPY_DIR      = $(COPY) -r\nINSTALL_FILE  = install -m 644 -p\nINSTALL_PROGRAM = install -m 755 -p\nINSTALL_DIR   = $(COPY_DIR)\nDEL_FILE      = rm -f\nSYMLINK       = ln -f -s\nDEL_DIR       = rmdir\nMOVE          = mv -f\nCHK_DIR_EXISTS= test -d\nMKDIR         = mkdir -p\nSUBTARGETS    =  \\\n        sub-bin\n\nbin//$(MAKEFILE): \n    @$(CHK_DIR_EXISTS) bin/ || $(MKDIR) bin/ \n    cd bin/ &amp;&amp; $(QMAKE) /home/jimmy/Downloads/fingerprint-gui-1.08/bin/bin.pro PREFIX=/usr -o $(MAKEFILE)\nsub-bin-qmake_all:  FORCE\n    @$(CHK_DIR_EXISTS) bin/ || $(MKDIR) bin/ \n    cd bin/ &amp;&amp; $(QMAKE) /home/jimmy/Downloads/fingerprint-gui-1.08/bin/bin.pro PREFIX=/usr -o $(MAKEFILE)\nsub-bin: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE)\nsub-bin-make_default: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) \nsub-bin-make_first: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) first\nsub-bin-all: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) all\nsub-bin-clean: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) clean\nsub-bin-distclean: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) distclean\nsub-bin-install_subtargets: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) install\nsub-bin-uninstall_subtargets: bin//$(MAKEFILE) FORCE\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) uninstall\n\nMakefile: fingerprint.pro  /usr/share/qt4/mkspecs/linux-g++-64/qmake.conf /usr/share/qt4/mkspecs/common/unix.conf \\\n        /usr/share/qt4/mkspecs/common/linux.conf \\\n        /usr/share/qt4/mkspecs/common/gcc-base.conf \\\n        /usr/share/qt4/mkspecs/common/gcc-base-unix.conf \\\n        /usr/share/qt4/mkspecs/common/g++-base.conf \\\n        /usr/share/qt4/mkspecs/common/g++-unix.conf \\\n        /usr/share/qt4/mkspecs/qconfig.pri \\\n        /usr/share/qt4/mkspecs/features/qt_functions.prf \\\n        /usr/share/qt4/mkspecs/features/qt_config.prf \\\n        /usr/share/qt4/mkspecs/features/exclusive_builds.prf \\\n        /usr/share/qt4/mkspecs/features/default_pre.prf \\\n        /usr/share/qt4/mkspecs/features/release.prf \\\n        /usr/share/qt4/mkspecs/features/default_post.prf \\\n        /usr/share/qt4/mkspecs/features/shared.prf \\\n        /usr/share/qt4/mkspecs/features/unix/gdb_dwarf_index.prf \\\n        /usr/share/qt4/mkspecs/features/warn_on.prf \\\n        /usr/share/qt4/mkspecs/features/qt.prf \\\n        /usr/share/qt4/mkspecs/features/unix/thread.prf \\\n        /usr/share/qt4/mkspecs/features/moc.prf \\\n        /usr/share/qt4/mkspecs/features/resources.prf \\\n        /usr/share/qt4/mkspecs/features/uic.prf \\\n        /usr/share/qt4/mkspecs/features/yacc.prf \\\n        /usr/share/qt4/mkspecs/features/lex.prf \\\n        /usr/share/qt4/mkspecs/features/include_source_dir.prf\n    $(QMAKE) PREFIX=/usr -o Makefile fingerprint.pro\n/usr/share/qt4/mkspecs/common/unix.conf:\n/usr/share/qt4/mkspecs/common/linux.conf:\n/usr/share/qt4/mkspecs/common/gcc-base.conf:\n/usr/share/qt4/mkspecs/common/gcc-base-unix.conf:\n/usr/share/qt4/mkspecs/common/g++-base.conf:\n/usr/share/qt4/mkspecs/common/g++-unix.conf:\n/usr/share/qt4/mkspecs/qconfig.pri:\n/usr/share/qt4/mkspecs/features/qt_functions.prf:\n/usr/share/qt4/mkspecs/features/qt_config.prf:\n/usr/share/qt4/mkspecs/features/exclusive_builds.prf:\n/usr/share/qt4/mkspecs/features/default_pre.prf:\n/usr/share/qt4/mkspecs/features/release.prf:\n/usr/share/qt4/mkspecs/features/default_post.prf:\n/usr/share/qt4/mkspecs/features/shared.prf:\n/usr/share/qt4/mkspecs/features/unix/gdb_dwarf_index.prf:\n/usr/share/qt4/mkspecs/features/warn_on.prf:\n/usr/share/qt4/mkspecs/features/qt.prf:\n/usr/share/qt4/mkspecs/features/unix/thread.prf:\n/usr/share/qt4/mkspecs/features/moc.prf:\n/usr/share/qt4/mkspecs/features/resources.prf:\n/usr/share/qt4/mkspecs/features/uic.prf:\n/usr/share/qt4/mkspecs/features/yacc.prf:\n/usr/share/qt4/mkspecs/features/lex.prf:\n/usr/share/qt4/mkspecs/features/include_source_dir.prf:\nqmake: qmake_all FORCE\n    @$(QMAKE) PREFIX=/usr -o Makefile fingerprint.pro\n\nqmake_all: sub-bin-qmake_all FORCE\n\nmake_default: sub-bin-make_default FORCE\nmake_first: sub-bin-make_first FORCE\nall: sub-bin-all FORCE\nclean: sub-bin-clean FORCE\ndistclean: sub-bin-distclean FORCE\n    -$(DEL_FILE) Makefile\ninstall_subtargets: sub-bin-install_subtargets FORCE\nuninstall_subtargets: sub-bin-uninstall_subtargets FORCE\n\nupek-lib:\n    install -d $(INSTALL_ROOT)/usr/lib; if uname -a | grep -q x86_64; then install -m 644 ./upek/lib64/libbsapi.so.4.0 ./upek/lib64/libbsapi.so.4.3 $(INSTALL_ROOT)/usr/lib; else install -m 644 ./upek/lib/libbsapi.so.4.0 ./upek/lib/libbsapi.so.4.3 $(INSTALL_ROOT)/usr/lib; fi; ldconfig\n\nupek-rules:\n    install -d $(INSTALL_ROOT)/etc/udev/rules.d; install -m 644 ./upek/91-fingerprint-gui-upek.rules $(INSTALL_ROOT)/etc/udev/rules.d\n\nupek-cfg:\n    install -d $(INSTALL_ROOT)/etc; install -m 644 ./upek/upek.cfg $(INSTALL_ROOT)/etc/upek.cfg\n\nupek-dir:\n    install -d $(INSTALL_ROOT)/var/upek_data; groupadd -f -r plugdev; chown root:plugdev $(INSTALL_ROOT)/var/upek_data; chmod 0775 $(INSTALL_ROOT)/var/upek_data\n\nupek-udevadm:\n    if command -v udevadm &gt;/dev/null; then for ID in 2015 2016; do udevadm trigger --subsystem-match=usb --attr-match=idVendor=0483 --attr-match=idProduct=$ID; done; for ID in 2015 2016 2020 1000 1001 1002 1003 3000 3001 5002 5003; do udevadm trigger --subsystem-match=usb --attr-match=idVendor=147e --attr-match=idProduct=$ID; done; fi\n\ninstall-upek: upek-lib upek-rules upek-cfg upek-dir upek-udevadm\n\nuninstall-upek:\n    rm -f $(INSTALL_ROOT)/usr/lib/libbsapi.so.4.0; rm -f $(INSTALL_ROOT)/usr/lib/libbsapi.so.4.3; rm -rf $(INSTALL_ROOT)/var/upek_data; rm -f $(INSTALL_ROOT)/etc/udev/rules.d/91-fingerprint-gui-upek.rules; ldconfig\n\nuser-data:\n    find /var/lib/fingerprint-gui -exec chown root:root {} +; find /var/lib/fingerprint-gui -type d -exec chmod 755 {} +; find /var/lib/fingerprint-gui -type f -exec chmod 600 {} +; rm -f $(INSTALL_ROOT)/fingerprint-suid\n\nsub-bin-check: bin/$(MAKEFILE)\n    cd bin/ &amp;&amp; $(MAKE) -f $(MAKEFILE) check\ncheck: sub-bin-check\n\nmocclean: compiler_moc_header_clean compiler_moc_source_clean\n\nmocables: compiler_moc_header_make_all compiler_moc_source_make_all\ninstall: install_subtargets  FORCE\n\nuninstall:  uninstall_subtargets FORCE\n\nFORCE:\n</code></pre>\n\n<p>I'm a biginner in make field and I realy don't know how I coudl interpet this output. </p>\n\n<p>I'm using Debian. </p>\n\n<p>Sorry I'm noob :D </p>\n\n<p>Thanks for the help\nThanks for patience</p>\n"}, {"tags": ["c", "bitmap"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527698744, "post_id": 50609775, "comment_id": 88229265, "body": "Give us an example with inputs and the desired outputs."}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527698821, "post_id": 50609775, "comment_id": 88229306, "body": "@ThomasJager I already did, screen resolution 320*240, 180*180 image, position 120,120. I need to map 120,120 into the bitmap coordinates and renders it on the screen at 120,120"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527699078, "post_id": 50609775, "comment_id": 88229427, "body": "What doesn&#39;t work about what you&#39;ve done? In what way does it not work?"}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527699205, "post_id": 50609775, "comment_id": 88229493, "body": "The placement of the image using the above equations, doesn&#39;t work as expected, there are a lot of offsets there, for example If I&#39;m centing the bitmap into the center of the screen, it&#39;s offseted to the right"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527699207, "post_id": 50609775, "comment_id": 88229494, "body": "What do you mean by &quot;placed correctly&quot;? What does the image size have to do with where it is placed? At 1:1 it will overflow the bottom of the screen. Are you asking how to scale it so it fits? It also depends on whether screen pixels are &quot;square&quot; and they are frequently not (for reasons best known to the designers). The screen from 120 to bottom is 120 pixels. So the 180x180 image has to be scaled by 2/3."}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527699666, "post_id": 50609775, "comment_id": 88229699, "body": "I&#39;m not talking about scaling, I&#39;m talking about translating an image into screen. I&#39;m drawing the bitmap manually, for each row, col, draw pixel. so I want to translate it correctly"}, {"owner": {"reputation": 198, "user_id": 9317706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd96f97c58b306523bb8defb014daab6?s=128&d=identicon&r=PG&f=1", "display_name": "purec", "link": "https://stackoverflow.com/users/9317706/purec"}, "edited": false, "score": 0, "creation_date": 1527700251, "post_id": 50609775, "comment_id": 88230028, "body": "float??? What do you want to do with float and pixels?"}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527709156, "post_id": 50609775, "comment_id": 88234443, "body": "I have edited the post"}, {"owner": {"reputation": 17958, "user_id": 1971013, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/EtqFE.jpg?s=128&g=1", "display_name": "meaning-matters", "link": "https://stackoverflow.com/users/1971013/meaning-matters"}, "edited": false, "score": 0, "creation_date": 1527709743, "post_id": 50609775, "comment_id": 88234712, "body": "If you&#39;re translating, why the angle?"}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527709785, "post_id": 50609775, "comment_id": 88234733, "body": "translate then rotate"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527709727, "post_id": 50612344, "comment_id": 88234704, "body": "I put x,y at the center of the screen (320,240) but its drawn as this in the post"}, {"owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "reply_to_user": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527710167, "post_id": 50612344, "comment_id": 88234908, "body": "What is the output if you just draw it without translating"}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527710351, "post_id": 50612344, "comment_id": 88234994, "body": "with 0,0 x,y,  xgoal = 67, ygoal = 27.. image is 186*186, screen resolution 320*240"}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527710496, "post_id": 50612344, "comment_id": 88235062, "body": "and with 0,0 its centered in the middle... which means the origin is shifted to the center of the screen.. which that I don&#39;t want"}, {"owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "reply_to_user": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527710734, "post_id": 50612344, "comment_id": 88235159, "body": "Can you verify that if you draw something on the screen at 0,0 it would be on top left."}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527710778, "post_id": 50612344, "comment_id": 88235175, "body": "I verified it, without the translating code, Its set to 0,0"}, {"owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "reply_to_user": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527713031, "post_id": 50612344, "comment_id": 88236037, "body": "Just do it step by step, you would figure it out. First try translation. If that worked then move to rotation. Translation is just adding some constant to x or y. Should be pretty straight forward. Try just constant values to move the image."}, {"owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527713707, "post_id": 50612344, "comment_id": 88236306, "body": "here is it without rotation, <a href=\"https://pastebin.com/hcygg9jE\" rel=\"nofollow noreferrer\">pastebin.com/hcygg9jE</a> it still at 0,0 it moves the bitmap into origin, instead of top left"}, {"owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "reply_to_user": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527715876, "post_id": 50612344, "comment_id": 88237115, "body": "What is x and y here. Is this is a point where you want to start putting a image on screen"}, {"owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "reply_to_user": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "edited": false, "score": 0, "creation_date": 1527774687, "post_id": 50612344, "comment_id": 88261880, "body": "you are adding x and y to xgoal and ygoal and then again adding i and j to it. You dont need x and y. Just set it to zero. In this case image should appear in center"}], "tags": [], "owner": {"reputation": 1, "user_id": 9866377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c21e2c48d9b4dff34f8ef06530cd4b29?s=128&d=identicon&r=PG&f=1", "display_name": "Rizwan Macknojia", "link": "https://stackoverflow.com/users/9866377/rizwan-macknojia"}, "is_accepted": false, "score": 0, "last_activity_date": 1527709488, "creation_date": 1527709488, "answer_id": 50612344, "question_id": 50609775, "link": "https://stackoverflow.com/questions/50609775/convert-screen-coordinates-into-bitmap-coordinates/50612344#50612344", "title": "Convert screen coordinates into bitmap coordinates", "body": "<p>If you want to draw image in the center of screen then you need to translate all the pixel. Assuming top left corner of the screen is (0,0)</p>\n\n<pre><code>    uint16_t relx = 320/2 - w/2 ;\n    uint16_t rely = 240/2 - h/2;\n    uint16_t xgoal = relx + x;\n    uint16_t ygoal = rely + y;\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7634504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015d692603181e102edff64437d3a62b?s=128&d=identicon&r=PG&f=1", "display_name": "andre ahmed", "link": "https://stackoverflow.com/users/7634504/andre-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527709745, "creation_date": 1527698621, "last_edit_date": 1527709745, "question_id": 50609775, "link": "https://stackoverflow.com/questions/50609775/convert-screen-coordinates-into-bitmap-coordinates", "title": "Convert screen coordinates into bitmap coordinates", "body": "<p>I have a screen resoultion of 320*240. and an Image for example 180*180.</p>\n\n<p>I would like to convert a position 120,120 for example into the bitmap coordinates, so that it's placed correctly on the 320*240 screen coordinates.</p>\n\n<p>Here is my attempt</p>\n\n<pre><code>// w, h width and height of an image\n// position x,y on the screen coordinates\n\nvoid Rasterizer::DrawBitmap(int w, int h, int x, int y, float angle)\n{ \n    uint16_t pixel;\n\n    float relx = w/ (float)320;\n    float rely = h/ (float)240;\n    uint16_t xgoal = (x * relx) + w/2;\n    uint16_t ygoal = (y * rely) + h/2;\n\n    float midX, midY;\n    float deltaX, deltaY;\n    int rotX, rotY;\n    int i, j;\n    midX = w / 2.0f;\n    midY = h / 2.0f;\n    for (i = 0; i &lt; w; i++)\n        for (j = 0; j &lt; h; j++) {\n            deltaX = i - midX;\n            deltaY = j - midY;\n            rotX = (int)(midX + deltaX * sin(angle) + deltaY * cos(angle));\n            rotY = (int)(midY + deltaX * cos(angle) - deltaY * sin(angle));\n            if (rotX &gt;= 0 &amp;&amp; rotX &lt; w &amp;&amp; rotY &gt;= 0 &amp;&amp; rotY &lt; h) {\n                SetPixel(xgoal + i,ygoal +j , bitmap[(rotX*w + rotY )]);\n            }\n        }\n\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/W109t.png\" rel=\"nofollow noreferrer\">show</a></p>\n"}, {"tags": ["c", "visual-studio-2015", "intrinsics", "cpuid", "aes-ni"], "comments": [{"owner": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 0, "creation_date": 1527848823, "post_id": 50609654, "comment_id": 88292688, "body": "Note that the &#39;official&#39; Microsoft solution is <a href=\"https://msdn.microsoft.com/en-us/library/hskdteyh.aspx\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 21, "user_id": 9871543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a92792e47e9ca4dac3b063b57641239?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/9871543/tom-clabault"}, "reply_to_user": {"reputation": 3352, "user_id": 2439725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/428ff617402eb64c48ed6dfc153617f9?s=128&d=identicon&r=PG", "display_name": "wim", "link": "https://stackoverflow.com/users/2439725/wim"}, "edited": false, "score": 0, "creation_date": 1529407015, "post_id": 50609654, "comment_id": 88853111, "body": "Yup, thanks but since it is C++, I didn&#39;t really read the entire paper. Anyway, thank you"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 1925112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51281a4afc5b98c86148d038345d39b8?s=128&d=identicon&r=PG", "display_name": "dr18", "link": "https://stackoverflow.com/users/1925112/dr18"}, "is_accepted": false, "score": 0, "last_activity_date": 1609788360, "creation_date": 1609788360, "answer_id": 65568609, "question_id": 50609654, "link": "https://stackoverflow.com/questions/50609654/how-to-check-aes-ni-support-with-cpuid/65568609#65568609", "title": "How to check AES-NI support with __cpuid?", "body": "<p>The AES bit is in ECX (25th bit), so you should use cpuInfo[2].</p>\n"}], "owner": {"reputation": 21, "user_id": 9871543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a92792e47e9ca4dac3b063b57641239?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Clabault", "link": "https://stackoverflow.com/users/9871543/tom-clabault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609812404, "creation_date": 1527698197, "last_edit_date": 1609812404, "question_id": 50609654, "link": "https://stackoverflow.com/questions/50609654/how-to-check-aes-ni-support-with-cpuid", "title": "How to check AES-NI support with __cpuid?", "body": "<p>I'm looking for a way to check whether or not does my CPU support AES-NI instructions. I found on the Internet a lot of things, that worked but a lot of them were inline assembly code and since I'm under Microsoft Visual Studio and that I'm compiling in x64, that doesn't work. Visual Studio doesn't support x64 inline assembly code and x64 is crucial to me.</p>\n\n<p>So I found the intrinsic function __cpuid(). The thing is that I don't know a word of assembly / intrinsic uses etc... ( I was just copy-pasting the code I found )</p>\n\n<p>So I'm here to ask you about the code below I wrote on my own using pieces of code of the Internet. The output is \"AES-Ni supported\" but it doesn't mean that my code is right and really retrieving the AES-NI capacity of my CPU.</p>\n\n<pre><code>int cpuInfo[4] = { -1 };\n\n__cpuid(cpuInfo, 1);\n_Bool returned = ((cpuInfo[3] &amp; 0x2000000) != 0);\n\nif (returned == 1)\n    printf(\"AES-NI supported\");\nelse\n    printf(\"AES-NI not-supported\");\n</code></pre>\n"}, {"tags": ["c", "mpi", "openmpi"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1527703739, "post_id": 50609598, "comment_id": 88231904, "body": "have you considered machine dependent byte order issues, struct padding issues, and other message scrambling issues in your approach to sending an array of struct?  (assuming your message trafficking will include targeting a broad spectrum of differing computer types)"}, {"owner": {"reputation": 17, "user_id": 5918621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc0fb73fa2093e7ebec6770cd50efea?s=128&d=identicon&r=PG&f=1", "display_name": "UnisaTripboard Unisa", "link": "https://stackoverflow.com/users/5918621/unisatripboard-unisa"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1527704112, "post_id": 50609598, "comment_id": 88232090, "body": "yes, but i don&#39;t understand how to send..."}, {"owner": {"reputation": 1996, "user_id": 3357105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c368973a174d114614a9debc188dad1?s=128&d=identicon&r=PG&f=1", "display_name": "ptb", "link": "https://stackoverflow.com/users/3357105/ptb"}, "edited": false, "score": 0, "creation_date": 1527705259, "post_id": 50609598, "comment_id": 88232629, "body": "It is difficult to help without a reproducible example."}, {"owner": {"reputation": 17, "user_id": 5918621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc0fb73fa2093e7ebec6770cd50efea?s=128&d=identicon&r=PG&f=1", "display_name": "UnisaTripboard Unisa", "link": "https://stackoverflow.com/users/5918621/unisatripboard-unisa"}, "edited": false, "score": 0, "creation_date": 1527705590, "post_id": 50609598, "comment_id": 88232768, "body": "i have to resolve n-body problem for precision in parallel"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 2, "creation_date": 1527717579, "post_id": 50609598, "comment_id": 88237693, "body": "Please edit your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Meanwhile, you can learn about derived datatypes."}], "answers": [{"comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1527986219, "post_id": 50656030, "comment_id": 88334781, "body": "is this a sarcastic/humorous answer ? MPI derived datatypes is the best fit (for performance, portability and ease of use) here. And it also works on heterogeneous systems as long as your MPI library can support such configurations."}, {"owner": {"reputation": 165, "user_id": 3640029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef75d62e28ffbada2349a18d244cb609?s=128&d=identicon&r=PG&f=1", "display_name": "user3640029", "link": "https://stackoverflow.com/users/3640029/user3640029"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1527997923, "post_id": 50656030, "comment_id": 88336336, "body": "The comment is absurd. While it is possibly better to use MPI_FLOAT, the question is about sending  a struct. Copying and packing the array is the only way to use MPI_FLOAT. As we don&#39;t know the reason, why the data is in a struct, we should still support the one asking the question."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1528001910, "post_id": 50656030, "comment_id": 88336892, "body": "<code>MPI_FLOAT</code> is <b>not</b> a derived datatype. Let\u2019s agree to disagree on everything else."}, {"owner": {"reputation": 165, "user_id": 3640029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef75d62e28ffbada2349a18d244cb609?s=128&d=identicon&r=PG&f=1", "display_name": "user3640029", "link": "https://stackoverflow.com/users/3640029/user3640029"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1528003691, "post_id": 50656030, "comment_id": 88337206, "body": "I never said anything about MPI_FLOAT. The question is about struct. My answer is correct and you provide only advices that are correct though not fitting the situation of the question."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1528010566, "post_id": 50656030, "comment_id": 88338415, "body": "I read <code>MPI_FLOAT</code> twice in your reply to my comment. You may have never said anything about it, but you definitely wrote twice about. I only mentioned that to state this is not a derived datatype, and I never wrote this should be used. Anyway, let&#39;s one more try (try to) agree to disagree."}], "tags": [], "owner": {"reputation": 165, "user_id": 3640029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef75d62e28ffbada2349a18d244cb609?s=128&d=identicon&r=PG&f=1", "display_name": "user3640029", "link": "https://stackoverflow.com/users/3640029/user3640029"}, "is_accepted": false, "score": -1, "last_activity_date": 1527935983, "creation_date": 1527935983, "answer_id": 50656030, "question_id": 50609598, "link": "https://stackoverflow.com/questions/50609598/how-to-send-structure-as-array-over-mpi/50656030#50656030", "title": "How to send structure as array over MPI?", "body": "<p>First, note that the approach is valid for homogeneous clusters with identical architectures.</p>\n\n<p>For the general case and high stability, choose a safe transport protocol such as JSON or protocol buffers.</p>\n\n<p>Third, boost::serialization into stringstreams can be handy. Similar limitations, but no libraries needed.</p>\n\n<p>Anyways, now the answer: when sending structs as you want to, do so with data type MPI_CHAR and count N * sizeof(Struct)</p>\n\n<p>For receiving, either you already know N or use MPI_Probe and extract count from message. This will be a number of bytes. Allocate a buffer of this size, MPI_RECV into it and reinterpret it as a Buffer array through casting.</p>\n\n<p>The rationale is to go via MPI_CHAR as the struct might have padding.</p>\n"}], "owner": {"reputation": 17, "user_id": 5918621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc0fb73fa2093e7ebec6770cd50efea?s=128&d=identicon&r=PG&f=1", "display_name": "UnisaTripboard Unisa", "link": "https://stackoverflow.com/users/5918621/unisatripboard-unisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527935983, "creation_date": 1527697960, "last_edit_date": 1527699463, "question_id": 50609598, "link": "https://stackoverflow.com/questions/50609598/how-to-send-structure-as-array-over-mpi", "title": "How to send structure as array over MPI?", "body": "<p>I have this structure</p>\n\n<p>typedef struct { float x, y, z, vx, vy, vz; } Body;</p>\n\n<pre><code>float *buf, *bufSlave;\nBody *p;\nbytes = nBodies*sizeof(Body);\nbuf = (float*)malloc(bytes);\np = (Body*)buf;\n</code></pre>\n\n<p>How to send 15 elements with MPI_SEND and how receive with MPI_RECEIVE? <br></p>\n\n<pre><code>MPI_Send(&amp;p[(i - 1) * lung], 6, MPI_FLOAT, i, 99, MPI_COMM_WORLD); \n</code></pre>\n\n<p>I have segmentation fault.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1527696980, "post_id": 50609313, "comment_id": 88228347, "body": "Looks like someone have defined function or macro named <code>_</code>."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 1, "creation_date": 1527697407, "post_id": 50609313, "comment_id": 88228583, "body": "Note that if you suspect something <i>might</i> be a macro, you can compile with <code>-E</code> to see what the code looks like after preprocessing."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 6, "last_activity_date": 1527697049, "creation_date": 1527697049, "answer_id": 50609350, "question_id": 50609313, "link": "https://stackoverflow.com/questions/50609313/underscore-before-a-c-function-parameter/50609350#50609350", "title": "Underscore before a C function parameter", "body": "<p>Usually (and conventionally in many, but not all, free software) <code>_</code>  is a <code>#define</code>-d macro for something like <a href=\"http://man7.org/linux/man-pages/man3/gettext.3.html\" rel=\"noreferrer\">gettext(3)</a>, to ease <a href=\"https://en.wikipedia.org/wiki/Internationalization_and_localization\" rel=\"noreferrer\">internationalization &amp; localization</a> of software.</p>\n"}], "owner": {"reputation": 343, "user_id": 9268324, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1b0f34a628a160b9de602fd855bc1a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Shoblade X", "link": "https://stackoverflow.com/users/9268324/shoblade-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 50609350, "answer_count": 1, "score": 4, "last_activity_date": 1527697049, "creation_date": 1527696913, "question_id": 50609313, "link": "https://stackoverflow.com/questions/50609313/underscore-before-a-c-function-parameter", "title": "Underscore before a C function parameter", "body": "<p>I was looking through the source codes for the C CoreUtils, and I found this code that I don't recognize:</p>\n\n<pre><code>printf (_(\"Usage: %s [OPTION]...\\n\"), program_name);\n</code></pre>\n\n<p>Why is there an underscore before the format string?  What does it do?</p>\n"}, {"tags": ["c", "string", "zero-padding"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527696568, "post_id": 50609190, "comment_id": 88228111, "body": "Padded where? In memory? When printing? In same string? In a different one?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1527696625, "post_id": 50609190, "comment_id": 88228143, "body": "Using the <code>printf</code> function family you can 0 pad a string as well as an integer. Have a read of the man page."}, {"owner": {"reputation": 7456, "user_id": 1202400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ddf9dd040b42f80911e4a53010dfc7?s=128&d=identicon&r=PG", "display_name": "unxnut", "link": "https://stackoverflow.com/users/1202400/unxnut"}, "edited": false, "score": 0, "creation_date": 1527696721, "post_id": 50609190, "comment_id": 88228194, "body": "You can use 0 padding but gcc warns that it leads to undefined behavior with <code>s</code>."}, {"owner": {"reputation": 669, "user_id": 3284537, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2301619be0bf5021b8e2ba0088ad271c?s=128&d=identicon&r=PG&f=1", "display_name": "Emiliano", "link": "https://stackoverflow.com/users/3284537/emiliano"}, "edited": false, "score": 2, "creation_date": 1527697776, "post_id": 50609190, "comment_id": 88228763, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/276827/string-padding-in-c\">String Padding in C</a>"}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1527697207, "post_id": 50609356, "comment_id": 88228470, "body": "This should be a comment or probably a close-as-duplicate vote."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527697228, "post_id": 50609356, "comment_id": 88228488, "body": "Please don&#39;t post link-only answers."}, {"owner": {"reputation": 669, "user_id": 3284537, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2301619be0bf5021b8e2ba0088ad271c?s=128&d=identicon&r=PG&f=1", "display_name": "Emiliano", "link": "https://stackoverflow.com/users/3284537/emiliano"}, "edited": false, "score": 0, "creation_date": 1527697246, "post_id": 50609356, "comment_id": 88228503, "body": "probably you right but meantime the user get his answer"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1527697321, "post_id": 50609356, "comment_id": 88228544, "body": "The user should have made his own attempt. No effort was shown. It does not help to spoon-feed people who ask &quot;write my code for me&quot;."}, {"owner": {"reputation": 669, "user_id": 3284537, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2301619be0bf5021b8e2ba0088ad271c?s=128&d=identicon&r=PG&f=1", "display_name": "Emiliano", "link": "https://stackoverflow.com/users/3284537/emiliano"}, "edited": false, "score": 0, "creation_date": 1527707206, "post_id": 50609356, "comment_id": 88233576, "body": "I will do but copy paste the code seems to me worst than paste the link"}], "tags": [], "owner": {"reputation": 669, "user_id": 3284537, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2301619be0bf5021b8e2ba0088ad271c?s=128&d=identicon&r=PG&f=1", "display_name": "Emiliano", "link": "https://stackoverflow.com/users/3284537/emiliano"}, "is_accepted": false, "score": 1, "last_activity_date": 1527707379, "last_edit_date": 1527707379, "creation_date": 1527697081, "answer_id": 50609356, "question_id": 50609190, "link": "https://stackoverflow.com/questions/50609190/add-leading-zeros-to-a-string-value-in-c/50609356#50609356", "title": "Add leading zeros to a string value in C", "body": "<p>here you are an example</p>\n\n<pre><code>int targetStrLen = 10;           // Target output length  \nconst char *myString=\"Hello\";   // String for output \nconst char *padding=\"0000000000000000000000000000000000000000000000000000000000000\";\n\nint padLen = targetStrLen - strlen(myString); // Calc Padding length\nif(padLen &lt; 0) padLen = 0;    // Avoid negative length\n\nprintf(\"[%*.*s%s]\", padLen, padLen, padding, myString);  // LEFT Padding \nprintf(\"[%s%*.*s]\", myString, padLen, padLen, padding);  // RIGHT Padding \n</code></pre>\n\n<p>If you have some doubt see this answer\n<a href=\"https://stackoverflow.com/a/9741091/3284537\">https://stackoverflow.com/a/9741091/3284537</a>\nwhere I extract the code</p>\n"}], "owner": {"reputation": 111, "user_id": 6559324, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/49f5827db31783816970ec63f7d8258f?s=128&d=identicon&r=PG&f=1", "display_name": "Ezzedeen Saghier", "link": "https://stackoverflow.com/users/6559324/ezzedeen-saghier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1527707379, "creation_date": 1527696483, "question_id": 50609190, "link": "https://stackoverflow.com/questions/50609190/add-leading-zeros-to-a-string-value-in-c", "title": "Add leading zeros to a string value in C", "body": "<p>it's requested that a given string <code>char input_str[5] = \"Hello\";</code> must be padded with leading character = <code>0</code>. so the result will have a fixed length of <code>10</code> characters: <code>out_put == \"00000Hello\"</code>.</p>\n\n<p>any idea how to do so in C?   </p>\n"}, {"tags": ["c++", "c", "programming-languages"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 4, "creation_date": 1527696129, "post_id": 50609077, "comment_id": 88227838, "body": "C or C++?  if C++ the answer is pretty much never unless interfacing with C; since lambdas and std::function have replaced them"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 3, "creation_date": 1527696152, "post_id": 50609077, "comment_id": 88227853, "body": "Isn&#39;t a function pointer the only way to pass functions in C? How would you implement a callback without functions pointers?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 8, "creation_date": 1527696217, "post_id": 50609077, "comment_id": 88227895, "body": "&quot;I didn&#39;t get any proper justification for this.&quot; Try coding up a library, you&#39;ll get your justification pretty quickly :-)"}, {"owner": {"reputation": 7456, "user_id": 1202400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4ddf9dd040b42f80911e4a53010dfc7?s=128&d=identicon&r=PG", "display_name": "unxnut", "link": "https://stackoverflow.com/users/1202400/unxnut"}, "edited": false, "score": 1, "creation_date": 1527696330, "post_id": 50609077, "comment_id": 88227973, "body": "Look at the implementation of <code>qsort</code>.  See how it allows for user-defined comparator with possibly user-defined data types."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1527696446, "post_id": 50609077, "comment_id": 88228042, "body": "If you are interested in embedded, study the source code of the Linux kernel (or just some drivers inside it)"}, {"owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1527696621, "post_id": 50609077, "comment_id": 88228140, "body": "@Carcigenicate - callback is nothing but an address of function which indirect called by other function or some other entity. My statement may be misinterpret. But my query is why same cannot be done via direct call.  You may be answering correctly but for my explanation give a practical use case scenario. That&#39;s why I asked to give some realistic example."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1527696694, "post_id": 50609077, "comment_id": 88228180, "body": "The purpose of callbacks is that you&#39;re passing the function pointer to another function. That other function doesn&#39;t know what function to call unless you tell it."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1527696779, "post_id": 50609077, "comment_id": 88228229, "body": "@Vikere Callback typically means giving a function to some code to have them use it to &quot;call back&quot; at a future time. That necessarily involves passing a function, or something representing a function like a pointer. I&#39;m not sure what you mean by callback then in this question. If you&#39;re just calling a function in the scope that it was defined in, no, you wouldn&#39;t necessarily need a pointer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1527697688, "post_id": 50609077, "comment_id": 88228723, "body": "Try making a generic heap data structure in C that can hold any type of data.  You will discover the utility of function pointers in carrying out this task."}, {"owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1527697823, "post_id": 50609077, "comment_id": 88228783, "body": "@Carcigenicate Yes you are very correct. So to clarify - if there is a function taking function pointer as argument - void sum (int, int (*)()) So, it means 2nd part could be mapped to any function of same signature. Is it correct??"}, {"owner": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1527698366, "post_id": 50609077, "comment_id": 88229063, "body": "Try implementing the <code>qsort</code> stdlib function without a function pointer. Then come back and ask again."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1527701113, "post_id": 50609077, "comment_id": 88230509, "body": "a) it is a ghee whiz feature of the language so why not use it, just like bitfields.  b) it should be easy to see cases where you cannot determine at runtime what you are calling, does that REQUIRE function calls?  no absolutely not.  but it is a quick and dirty way to do it, even if it is not a runtime thing.  generic code that connects to some peripheral, the peripheral can come in through bluetooth or usb but is at some level handled the same way, have a bluetooth transport and a usb transport, glue in the function pointers at discovery and use for the duration. zillion other examples."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "reply_to_user": {"reputation": 4888, "user_id": 5785362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a786fd81952576dc07942023bf8830b?s=128&d=identicon&r=PG", "display_name": "tofro", "link": "https://stackoverflow.com/users/5785362/tofro"}, "edited": false, "score": 0, "creation_date": 1527701166, "post_id": 50609077, "comment_id": 88230542, "body": "@tofro @unxnut actually you can make a generic <code>qsort</code> without function pointers with macros but i am not say it the right way."}], "answers": [{"tags": [], "owner": {"reputation": 233737, "user_id": 1774667, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/b6516fec2c5997b867545d285304cf12?s=128&d=identicon&r=PG", "display_name": "Yakk - Adam Nevraumont", "link": "https://stackoverflow.com/users/1774667/yakk-adam-nevraumont"}, "is_accepted": false, "score": 0, "last_activity_date": 1527696690, "creation_date": 1527696690, "answer_id": 50609251, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609251#50609251", "title": "Why to use function pointer?", "body": "<p>There is a concept in programming called DRY -- don't repeat yourself.</p>\n\n<p>Suppose you have 121 buttons in your UI.  Each one of them behaves much the same, except when you press the button, a different operation happens.</p>\n\n<p>You can (A) use virtual inheritance to dispatch to the right operation (requiring a class per button), or (B) use a function pointer (or a <code>std::function</code>) stored in the class in order to call the right \"on click\" handler, or (C) have every single button be a distinct type.</p>\n\n<p>A virtual function is implemented in every compiler I have examined as a complex table that, in the end, is a collection of function pointers.</p>\n\n<p>So your choices are function pointers or generating 121 completely distinct buttons that happen to mostly behave the same.</p>\n\n<p>In any situation where you want to decouple the caller and the called, you must use something akin to a function pointer.  There are a ridiculous number of cases, from work queues to thread off tasks, callbacks, etc.</p>\n\n<p>In tiny programs where everything is hard coded, hard coding every call can work.  But hard coded stuff like this <em>doesn't scale</em>.  When you want to update those 121 buttons each hand-implemented, knowing their points of customization is going to be ridiculously difficult.  And they <em>will</em> fall out of sync.</p>\n\n<p>And 121 is a modest number of buttons.  What about an app with 10,000?  And you want to update every button's behavior to handle touch-based input?</p>\n\n<p>Even more, when you type erase, you can reduce binary size significantly.  121 copies of a class implementing a button is going to take more executable space than 1 class, each of which stores a function pointer or two.</p>\n\n<p>Function pointers are but one type of \"type erasure\".  Type erasure reduces binary size, provides clearer contracts between provider and consumer, and makes it easier to refactor behavior around the type erased data.</p>\n"}, {"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1527698162, "creation_date": 1527698162, "answer_id": 50609642, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609642#50609642", "title": "Why to use function pointer?", "body": "<blockquote>\n  <p>1) callbacks - same can be achieved by direct call.</p>\n</blockquote>\n\n<p>Not in all cases, since the caller may not know at compile-time what function must be called. For instance, this is typical in libraries since they cannot know in advance your code.</p>\n\n<p>However, it can also happen in your own code: whenever you want to re-use partially a function, you can either:</p>\n\n<ul>\n<li>Create several versions of that function, each calling a different function. Duplicates code, very bad maintenance. Good performance unless hit by code bloat.</li>\n<li>Pass a function pointer (or callable in general in C++). Flexible, less code, performance might suffer in some cases.</li>\n<li>Create a set of branches (<code>if</code>/<code>switch</code> chain), if you know in advance the set of possible functions to call. Rigid, but might be faster than a function pointer for small number of branches.</li>\n<li>In C++, create a templated version. Same as the first case, but automated; so good maintenance. Code bloat might be an issue.</li>\n<li>Factor out the common code so that callers can call whatever they need piece by piece. Sometimes this isn't possible/easy -- specially when parametrizing complex algorithms that you want to keep reusable (e.g. <code>qsort()</code>). In C++, see the STL (Standard Template Library).</li>\n</ul>\n\n<blockquote>\n  <p>2) Asynchronous or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</p>\n</blockquote>\n\n<p>Some event systems are designed so that you simply configure which function(s) will be triggered when a given event happens. If this is an external library with a C interface, they have no choice but to use function pointers.</p>\n\n<p>Some other systems let you create your own event loop and you fetch the events somehow and do whatever you want with them; so they avoid callbacks.</p>\n\n<blockquote>\n  <p>3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</p>\n</blockquote>\n\n<p>See the first case.</p>\n"}, {"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527698643, "post_id": 50609646, "comment_id": 88229217, "body": "I am not sure you have made your case here and have certainly not addressed the specific usage of function-pointers described in the question. You have introduced an additional use, which is fine, but seems unlikely to convince the OP of their utility in the specific circumstances he has asked about."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527698874, "post_id": 50609646, "comment_id": 88229331, "body": "@Clifford <a href=\"https://en.wikipedia.org/wiki/Callback_(computer_programming)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Callback_(computer_programming)</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527699245, "post_id": 50609646, "comment_id": 88229511, "body": "I am not sure why you have addressed that link to me, or how it relates to either your answer or my previous comment.  My point is simply that the question is rather broad but your answer rather much narrower.  Moreover it is a good example, but perhaps not a complete answer - also somewhat succinct - you have answered a question with a question, and given the nature of the original question, I doubt the OP will even understand your answer."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1527699729, "post_id": 50609646, "comment_id": 88229724, "body": "@Clifford In paragraph one the poster questions the use of callbacks. I have provided an example which illustrates its necessity. I doubt it is unclear to anyone."}], "tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 1, "last_activity_date": 1527698170, "creation_date": 1527698170, "answer_id": 50609646, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609646#50609646", "title": "Why to use function pointer?", "body": "<p>Without function pointers, how would you implement a function which calculates the integral of any real-valued function?</p>\n\n<pre><code>typedef double (*Function)(double);\n\ndouble Integral(Function f, double a, double b);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 3, "last_activity_date": 1527698740, "last_edit_date": 1527698740, "creation_date": 1527698233, "answer_id": 50609665, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50609665#50609665", "title": "Why to use function pointer?", "body": "<blockquote>\n  <p>1) callbacks - same can be achieved by direct call.</p>\n</blockquote>\n\n<p>Not true.  For a direct call, the caller must know the function name <em>and</em> signature when the code is compiled, and can only ever call that one function.  A callback is defined at <em>runtime</em> and can be changed dynamically, while the caller need only know the <em>signature</em>, not the name.  Moreover each instance of an object may have a different callback, whereas with a direct call, all instances must call the same function.</p>\n\n<blockquote>\n  <p>2) Asynchronous or synchronous event handling - anyway event has to be\n  identified, based on which element no. in function pointer array got\n  updated. But the same can be also done via direct call.</p>\n</blockquote>\n\n<p>Not sure what you mean, but an event handler is simply a kind of callback.  The event may be identified by the caller and different call-back handlers called through pointers.  Your point only stands if there is one event handler for all event types and the user is to be responsible for identification.</p>\n\n<blockquote>\n  <p>3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</p>\n</blockquote>\n\n<p>See (1) and (2) above.  Often it is a means to hook platform independent third-party library code into a specific platform without having to deliver source-code or for system events that require user/application-defined handlers.</p>\n\n<p>I would not sweat it however - if all your application requirements can be resolved without using a pointer to a function, then you don't need a pointer to a function.  When you need one, you will probably know.  You will most likely encounter it when you have to use an API that requires it before you ever implement an interface yourself that does.  For example in the standard library the <code>qsort()</code> function requires a pointer to a function in order to define how two objects of arbitrary type are to be ordered - allowing <code>qsort()</code> to support any type of object - it is a way in C of making a function \"<em>polymorphic</em>\".  C++ supports polymorphism directly, so there is often less need for explicit function-pointers in C++ - although internally polymorphism is implemented using function pointers in any case.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 3, "last_activity_date": 1527703977, "creation_date": 1527703977, "answer_id": 50611081, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50611081#50611081", "title": "Why to use function pointer?", "body": "<p>Some more things function pointers are often used for:</p>\n\n<ul>\n<li><strong>Runtime polymorphism:</strong> You can define a structure that encapsulates a function pointer, or a pointer to a function table.  This enables you to call the specified function at runtime, even for a type of client object that did not exist when your library was written.  You can use this to implement multiple dispatch or something like the visitor design pattern in C.  This is also how C++ classes and their <code>virtual</code> member functions were originally implemented under the hood.</li>\n<li><strong>Closures:</strong> These can be structures containing a function pointer and one or more of its arguments.</li>\n<li><strong>State Machines:</strong> Instead of a <code>switch</code> with a <code>case</code> for each state label, I\u2019ve often found it convenient to give the handler for each state its own function.  The current state is the function you\u2019re in, the state transitions are tail-recursive calls, and the program variables are parameters. The state labels then become function pointers, which you might store in a table or return from a function. </li>\n<li><strong>Higher-Order Functions:</strong> Two examples from the C standard library are <code>qsort()</code> and <code>btree()</code>, which generalize the type of elements and the comparison function.</li>\n<li><strong>Low-Level Support:</strong> Shared-library loaders, for example, need this.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "is_accepted": false, "score": 0, "last_activity_date": 1527709622, "creation_date": 1527709622, "answer_id": 50612377, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer/50612377#50612377", "title": "Why to use function pointer?", "body": "<p>Thanks all for actively participating in this discussion. Thanks for giving practical examples like -</p>\n\n<p>1) Implement Library function</p>\n\n<p>2) Look qsort</p>\n\n<p>3) Refer Linux Kernel</p>\n\n<p>4) Generic Heap data structure in C</p>\n\n<p>I feel qsort() <code>void qsort(void *base, size_t nitems, size_t size, int (*compar)(const void *, const void*)) s</code> is quite sufficient to clear my 1) &amp; 3) point.</p>\n\n<p><strong>1) callbacks - same can be achieved by direct call.\n3) In some post I had seen people commenting it is to be used when it is not known which function to call. I didn't get any proper justification for this.</strong></p>\n\n<p>Mainly by callbacks - it is a provision of calling a function for which the body is not yet defined. And it expected that the definition of the function will be provided later during run-time. So, compilation won't be hindered due to lack of function definition. Practical use if someone consider above qsort() function. In this the user is responsible for providing the function definition for compare() like -</p>\n\n<pre><code>int compare (int* a, int* b)\n{\n  //User defined body based on problem requirement\n}\n</code></pre>\n\n<p>Lets consider a practical scenario where multiple threads have their respective compare function. In case of direct call every thread need to implement their own sorting function or if a common function then implementation would be much more bulky. But by using the callback method all threads can use same function for sorting, since the sorting algo remain same for all threads. \nConsidering a <strong>layered architecture</strong> mainly higher layers have an abstract view of lower layer. So, here if say we have qsort() function [User defined qsort] implemented at application layer and lets say underlying application there is a ADC driver layer which capture sample and provide to application for sorting. Then for application it is not necessary to understand the definition of function responsible for collecting and providing the samples. But application will only focus on obtaining the sample. Hence, that main application won't know which function to call. Respective ADC driver will simply make a call to application using the qsort() and provide needful data.</p>\n\n<p>Regarding 2 point still confused -\n<strong>2) Asynchronous or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</strong></p>\n\n<p>From above discussion I conclude that if event handlers pointed to some library function, then it need to be implemented via pointer to function. And secondly to create an independent and handy code it is necessary to maintain function pointer. Lets say between application and driver we have an interfacing layer. So, if either application or driver changes anytime it won't affect or very least affect each other. And this interface layer is implemented using pointer to function. But consider below scenario -</p>\n\n<pre><code>int (*fptr[10]) (void) =\n{\n    function1;     //function for starting LED\n    function2;     //function for relay operation\n      .\n      .\n    function10;    //function for motor control\n}\n</code></pre>\n\n<p>lets say we have GPIO0.0 - GPIO0.10 has been mapped to the function pointer array. i.e. GPIO0.0 - 0th element of fptr\n             .\n             .\n            GPIO0.10 - 10th element of fptr\nThese GPIO pins has been configured for level triggered interrupt and their respective ISR will update the array element no. <code>i=GPIO_Value;</code> further the scheduler have an thread which will call the function pointer array -</p>\n\n<pre><code>fptr[i]();\n</code></pre>\n\n<p>Does the use of function pointer is justifiable here??</p>\n"}], "owner": {"reputation": 1, "user_id": 6829781, "user_type": "registered", "profile_image": "https://graph.facebook.com/866765673425352/picture?type=large", "display_name": "Vikere", "link": "https://stackoverflow.com/users/6829781/vikere"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2972, "favorite_count": 4, "closed_date": 1527708993, "answer_count": 6, "score": -6, "last_activity_date": 1527709622, "creation_date": 1527696039, "last_edit_date": 1527703958, "question_id": 50609077, "link": "https://stackoverflow.com/questions/50609077/why-to-use-function-pointer", "closed_reason": "Duplicate", "title": "Why to use function pointer?", "body": "<p>I hope its an extremely repetitive question. And my advance excuse to all the viewers who find it annoying.</p>\n\n<p>Although I am bit experienced programmer, but I cannot justify the use of function pointer over direct call. Scenarios where I unable to find the differences are -</p>\n\n<p>1) <strong>callbacks</strong> - same can be achieved by direct call.</p>\n\n<p>2) <strong>Asynchronous</strong> or synchronous event handling - anyway event has to be identified, based on which element no. in function pointer array got updated. But the same can be also done via direct call.</p>\n\n<p>3) In some post I had seen people commenting it is to be used when it is <strong>not known which function to call.</strong> I didn't get any proper justification for this.</p>\n\n<p>I really appreciate if someone can explain me using above scenarios with practical and really simple realistic example.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 40, "user_id": 7746379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22bd7507c00954e52cd82f8f0184ae?s=128&d=identicon&r=PG&f=1", "display_name": "valkorai", "link": "https://stackoverflow.com/users/7746379/valkorai"}, "edited": false, "score": 0, "creation_date": 1527694820, "post_id": 50608670, "comment_id": 88227077, "body": "Oh, like @Kevin said in comment. Didn&#39;t think about this stupid thing.. Thank you ! I&#39;ll accept your answer as soon as I can."}, {"owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "reply_to_user": {"reputation": 40, "user_id": 7746379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22bd7507c00954e52cd82f8f0184ae?s=128&d=identicon&r=PG&f=1", "display_name": "valkorai", "link": "https://stackoverflow.com/users/7746379/valkorai"}, "edited": false, "score": 0, "creation_date": 1527694882, "post_id": 50608670, "comment_id": 88227117, "body": "@valkorai pretty much, there it&#39;s explained better."}], "tags": [], "owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "is_accepted": true, "score": 0, "last_activity_date": 1527694703, "creation_date": 1527694703, "answer_id": 50608670, "question_id": 50608614, "link": "https://stackoverflow.com/questions/50608614/returns-true-with-var-names-but-false-with-current-values/50608670#50608670", "title": "&gt;= returns true with var names but false with current values", "body": "<p>It's because you're comparing an unsigned value with a signed value. During this, your signed value is promoted to an unsigned, and -1 when converted to an unsigned  is much much bigger than your max capacity variable.</p>\n\n<p>Be careful when mixing types. To fix this, you could either make your max_capacity a signed value, or explicitly cast it to signed int before making a comparison. </p>\n"}, {"tags": [], "owner": {"reputation": 1105, "user_id": 8408461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eRqhA.jpg?s=128&g=1", "display_name": "Bob Jacobsen", "link": "https://stackoverflow.com/users/8408461/bob-jacobsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1527694941, "creation_date": 1527694941, "answer_id": 50608755, "question_id": 50608614, "link": "https://stackoverflow.com/questions/50608614/returns-true-with-var-names-but-false-with-current-values/50608755#50608755", "title": "&gt;= returns true with var names but false with current values", "body": "<p>It can be confusing to compare an int and an unsigned int. </p>\n\n<p>In this case, to do the comparison the (signed) top_position value is cast to an unsigned. The -1 ends up as 0xFF..FF and the comparison is done against that. </p>\n\n<p>Best practice: use int or use unsigned int, don\u2019t mix them. </p>\n"}], "owner": {"reputation": 40, "user_id": 7746379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22bd7507c00954e52cd82f8f0184ae?s=128&d=identicon&r=PG&f=1", "display_name": "valkorai", "link": "https://stackoverflow.com/users/7746379/valkorai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1527695479, "accepted_answer_id": 50608670, "answer_count": 2, "score": 0, "last_activity_date": 1527695668, "creation_date": 1527694571, "last_edit_date": 1527695668, "question_id": 50608614, "link": "https://stackoverflow.com/questions/50608614/returns-true-with-var-names-but-false-with-current-values", "closed_reason": "Duplicate", "title": "&gt;= returns true with var names but false with current values", "body": "<p>I'm actually facing some weird issue while coding for university project.</p>\n\n<p>I've implemented a stack struct, and trying to make basic functions to manipulate it.</p>\n\n<pre><code>typedef struct _stack {\n    unsigned int max_capacity;\n    int* array;\n    int top_position;\n} stack;\n\nint isFull(stack* s){\n    return s-&gt;top_position &gt;= (s-&gt;max_capacity - 1);\n}\n\nint isEmpty(stack* s){\n    return s-&gt;top_position == -1;\n}\n\nvoid push(stack* s, int elt){\n    if (isFull(s)) return;\n    s-&gt;array[++s-&gt;top_position] = elt;\n}\n\nint pop(stack* s){\n    return s-&gt;array[s-&gt;top_position--];\n}\n\nint peek(stack* s){\n    return s-&gt;array[s-&gt;top_position];\n}\n\nstack* createStack(unsigned int capacity){\n    stack* s = malloc(sizeof(stack));\n    s-&gt;max_capacity = capacity;\n    s-&gt;array = malloc(sizeof(int) * capacity);\n    s-&gt;top_position = -1;\n    return s;\n}\n</code></pre>\n\n<p>But when I try to test it, I got akward results :</p>\n\n<pre><code>stack* s = createStack(5);\nif(isFull(s)) printf(\"Stack full.\\n\");\nprintf(\"Stack top position : %d, stack capacity : %d\\n\", s-&gt;top_position, s-&gt;max_capacity);\nprintf(\"-1 &gt;= 4 : %d\\n\", -1 &gt;= 4);\nprintf(\"top position &gt;= (capacity - 1) : %d\\n\", s-&gt;top_position &gt;= (s-&gt;max_capacity - 1));\n</code></pre>\n\n<p>returning </p>\n\n<pre><code>Stack full.\nStack top position : -1, stack capacity : 5\n-1 &gt;= 4 : 0\ntop position &gt;= (capacity - 1) : 1\n</code></pre>\n\n<p>I don't understand the reason why my function isFull is returning a non-zero value when instantiating a new stack.</p>\n\n<p>I put a strict-equality condition instead of greater-or-equal, and now it's working fine, but I need to understand the deep reason of my mistake, can you help me and explain me why the first version wasn't working ?</p>\n\n<p>Thanks.</p>\n\n<p>EDIT: This question is not really a duplicate of the answer linked in comment. Actually I didn't figured that I was comparing signed and unsigned values.</p>\n"}, {"tags": ["c++", "c", "post-increment", "pre-increment"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527693807, "post_id": 50608320, "comment_id": 88226442, "body": "You are right.."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1527693815, "post_id": 50608320, "comment_id": 88226446, "body": "You are correct. The explaining code is not equivalent to the code above it. Indeed, <code>pattern ++;</code> first uses the variable (assigns it) and then increments it."}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527693904, "post_id": 50608320, "comment_id": 88226511, "body": "You might benefit from throwing that book away.  <a href=\"https://stackoverflow.com/questions/388242/\">We have a carefully curated list of suggestions</a>."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "edited": false, "score": 0, "creation_date": 1527693925, "post_id": 50608320, "comment_id": 88226525, "body": "Ok, thanks. It&#39;s very weird, because I already discovered some other faults in this book, while it had a really good rating."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694036, "post_id": 50608320, "comment_id": 88226585, "body": "Don&#39;t believe the ratings... I guess. Believe the experts recommendations."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527694056, "post_id": 50608320, "comment_id": 88226602, "body": "@Drew Dormann One has to say, that the book isn&#39;t about c++ itsself, it&#39;s about arduino. However, I&#39;m a bit dissapointed."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694078, "post_id": 50608320, "comment_id": 88226615, "body": "Explains a lot. :)"}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "edited": false, "score": 0, "creation_date": 1527694246, "post_id": 50608320, "comment_id": 88226716, "body": "@DrewDormann Just out of curiosity, do you have such a list of books in other languages, too? (german)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694358, "post_id": 50608320, "comment_id": 88226783, "body": "@SomeWindowsUser My lecturer (one of the best in one of the leading institutions) in computer science back few decades ago was pretty strict about it: Never learn C or C++ by any books written not in English or even translated. Perhaps it was changed since then..."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527694462, "post_id": 50608320, "comment_id": 88226859, "body": "@EugeneSh. But I don&#39;t think there are no good books in other languages, I just think they are harder to find/pretty rare."}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1527695244, "post_id": 50608320, "comment_id": 88227337, "body": "Start <a href=\"https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list\">here</a> and see if there are any translations available."}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527698557, "post_id": 50608320, "comment_id": 88229170, "body": "This illustrates why expressions with side-effects is not a good idea."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527711674, "post_id": 50608320, "comment_id": 88235513, "body": "@AugustKarlstrom Sorry, what do you mean with &quot;expressions with side-effects&quot;? Do you mean that there is a problem if a book covers 2 different topics, or did I get this wrong?"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527712811, "post_id": 50608320, "comment_id": 88235970, "body": "@SomeWindowsUser To be precise, I mean sub-expressions with side-effects. An expression with a side-effect changes the state of the computation, for instance by assigning a new value to a variable. Such expressions are hard to read and can lead to undefined behavior. That&#39;s why most programming languages don&#39;t provide such constructs."}, {"owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527713236, "post_id": 50608320, "comment_id": 88236104, "body": "@AugustKarlstrom Ok, I think I get it now, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "is_accepted": true, "score": 6, "last_activity_date": 1527693831, "creation_date": 1527693831, "answer_id": 50608369, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable/50608369#50608369", "title": "Assigning an incremented variable", "body": "<p>you are right</p>\n\n<pre><code>PORTB = pattern++;\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>PORTB = pattern;\npattern = pattern + 1;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "is_accepted": false, "score": 2, "last_activity_date": 1527695811, "last_edit_date": 1527695811, "creation_date": 1527694513, "answer_id": 50608593, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable/50608593#50608593", "title": "Assigning an incremented variable", "body": "<p>Prefix form <code>[--,++]a</code> do action (increment or decrement), and then use the result</p>\n\n<p>For example:</p>\n\n<pre><code>  int a[] = {0,1,2};\n  int i = -1;\n  std::cout&lt;&lt; a[++i] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[++i] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[++i] &lt;&lt; std::endl;\n</code></pre>\n\n<p>Equivalent form  </p>\n\n<pre><code> int a[] = {0,1,2}; \n int i = -1;\n for(int j =0; j &lt; 3; j = j + 1) {\n  i = i + 1; // action first\n  std::cout&lt;&lt; a[i] &lt;&lt; ' ';\n }\n std::cout&lt;&lt; std::endl; \n</code></pre>\n\n<p>Postfix form <code>a[++,--]</code> use value as it is, then increment or decrement variable</p>\n\n<p>For example:</p>\n\n<pre><code>  int a[] = {0,1,2};\n  int i = 0;\n  std::cout&lt;&lt; a[i++] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[i++] &lt;&lt; ' ';\n  std::cout&lt;&lt; a[i] &lt;&lt; std::endl;\n</code></pre>\n\n<p>Equivalent form  </p>\n\n<pre><code> int a[] = {0,1,2}; \n int i = 0;\n for(int j =0; j &lt; 3; j = j + 1) {\n  std::cout&lt;&lt; a[i] &lt;&lt; ' ';\n  i = i + 1; // action after\n }\n std::cout&lt;&lt; std::endl; \n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9587360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c30e39cf78d8c7f40ffabf29cfa0aa1b?s=128&d=identicon&r=PG&f=1", "display_name": "some_user", "link": "https://stackoverflow.com/users/9587360/some-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 50608369, "answer_count": 2, "score": 1, "last_activity_date": 1528146258, "creation_date": 1527693624, "last_edit_date": 1528146258, "question_id": 50608320, "link": "https://stackoverflow.com/questions/50608320/assigning-an-incremented-variable", "title": "Assigning an incremented variable", "body": "<pre><code>PORTB = pattern ++;\n//The author explains te upper code with the code below\npattern = pattern + 1;\nPORTB = pattern;\n\nPORTB = ++ pattern; //That's what I think is right\n</code></pre>\n\n<p>I think this code is wrong, as the post-increment should add 1, after using it in the statement, so for the code below, there has to be an pre-increment e. But as I am not that familiar with c/c++ (only read one book), I wanted to know whether I'm messing something up, or the author is just wrong.</p>\n\n<p>Edit: The Book is not about c/c++, it's about arduino.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 5880, "user_id": 5447906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e7767d98b4c136d54b4be77dd24f112?s=128&d=identicon&r=PG", "display_name": "anton_rh", "link": "https://stackoverflow.com/users/5447906/anton-rh"}, "edited": false, "score": 0, "creation_date": 1527693590, "post_id": 50608303, "comment_id": 88226286, "body": "Sorry, if this is a dup. I really couldn&#39;t find a similar question."}, {"owner": {"reputation": 5880, "user_id": 5447906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e7767d98b4c136d54b4be77dd24f112?s=128&d=identicon&r=PG", "display_name": "anton_rh", "link": "https://stackoverflow.com/users/5447906/anton-rh"}, "edited": false, "score": 0, "creation_date": 1527694117, "post_id": 50608303, "comment_id": 88226637, "body": "The only workaround I can think of is to add <code>void* ptr</code> to <code>list_head</code> and set it to pointer to <code>my_struct</code> in each node. But there is a small waste of resources in this case (each node contains an additional pointer, and each node requires additional initialization)."}, {"owner": {"reputation": 55, "user_id": 4803204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae277dfea761b69b21ff0f41e1538059?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Derber", "link": "https://stackoverflow.com/users/4803204/robert-derber"}, "edited": false, "score": 1, "creation_date": 1527697619, "post_id": 50608303, "comment_id": 88228679, "body": "Is <a href=\"https://stackoverflow.com/questions/10269685/kernels-container-of-any-way-to-make-it-iso-conforming\">this</a> what you&#39;re looking for?"}, {"owner": {"reputation": 5880, "user_id": 5447906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e7767d98b4c136d54b4be77dd24f112?s=128&d=identicon&r=PG", "display_name": "anton_rh", "link": "https://stackoverflow.com/users/5447906/anton-rh"}, "reply_to_user": {"reputation": 55, "user_id": 4803204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae277dfea761b69b21ff0f41e1538059?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Derber", "link": "https://stackoverflow.com/users/4803204/robert-derber"}, "edited": false, "score": 0, "creation_date": 1527741488, "post_id": 50608303, "comment_id": 88243234, "body": "@RobertDerber, oh yeah. Exactly. Thank you! It seems that my google-fu is still bad -_-"}, {"owner": {"reputation": 5880, "user_id": 5447906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e7767d98b4c136d54b4be77dd24f112?s=128&d=identicon&r=PG", "display_name": "anton_rh", "link": "https://stackoverflow.com/users/5447906/anton-rh"}, "reply_to_user": {"reputation": 55, "user_id": 4803204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae277dfea761b69b21ff0f41e1538059?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Derber", "link": "https://stackoverflow.com/users/4803204/robert-derber"}, "edited": false, "score": 1, "creation_date": 1527753016, "post_id": 50608303, "comment_id": 88248210, "body": "BTW, the linked list implementation that uses <code>container_of</code>: <a href=\"https://stackoverflow.com/a/50619249/5447906\">stackoverflow.com/a/50619249/5447906</a>"}], "owner": {"reputation": 5880, "user_id": 5447906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5e7767d98b4c136d54b4be77dd24f112?s=128&d=identicon&r=PG", "display_name": "anton_rh", "link": "https://stackoverflow.com/users/5447906/anton-rh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "closed_date": 1527741595, "answer_count": 0, "score": 0, "last_activity_date": 1527693558, "creation_date": 1527693558, "question_id": 50608303, "link": "https://stackoverflow.com/questions/50608303/get-pointer-to-struct-by-pointer-to-its-member", "closed_reason": "Duplicate", "title": "Get pointer to struct by pointer to its member", "body": "<p>Is there a <strong>portable</strong> way to get a pointer to a structure if you have a pointer to a member of that structure?</p>\n\n<p>There is a linked list implementation in Linux kernel (<a href=\"https://elixir.bootlin.com/linux/v4.4/source/include/linux/list.h\" rel=\"nofollow noreferrer\">1</a>):</p>\n\n<pre><code>struct list_head {\n    struct list_head *next, *prev;\n};\n\nstatic inline void __list_add(struct list_head *new,\n                  struct list_head *prev,\n                  struct list_head *next)\n{\n    next-&gt;prev = new;\n    new-&gt;next = next;\n    new-&gt;prev = prev;\n    prev-&gt;next = new;\n}\n\nstatic inline void list_add(struct list_head *new, struct list_head *head)\n{\n     __list_add(new, head, head-&gt;next);\n}\n\n#define list_entry(ptr, type, member) \\\n    container_of(ptr, type, member)\n</code></pre>\n\n<p>The idea is that this implementation is generic. You can use it with any <code>struct</code> type:</p>\n\n<pre><code>struct my_struct {\n    int my_data;\n\n    struct list_head node;\n};\n\nvoid example()\n{\n    struct list_head head;\n    struct my_struct element1 = { 1 };\n    struct my_struct element2 = { 2 };\n\n    head.next = head.prev = &amp;head;   // head &lt;-&gt; head\n    list_add(&amp;element1.node, &amp;head); // head &lt;-&gt; {1} &lt;-&gt; head\n    list_add(&amp;element2.node, &amp;head); // head &lt;-&gt; {2} &lt;-&gt; {1} &lt;-&gt; head\n\n    struct my_struct *front_element = list_entry(&amp;head.next, struct my_struct, node);\n\n    printf(\"front element data: %d\\n\", front_element-&gt;my_data); // will print \"2\"\n}\n</code></pre>\n\n<p>Elements of <code>list_head</code> are linked with each other, but there are only pointers to <code>list_head</code> and there are no pointers to <code>my_struct</code> (that contains <code>list_head</code> inside). However having a pointer to the <code>node</code> member of <code>my_struct</code>, you can convert this pointer to a pointer to <code>my_struct</code> itself using the <code>list_entry</code> macro. This is done using tricky pointer arithmetic (the offset of the member in the struct is subtracted from the address of the member).</p>\n\n<p>But the implementation of the <code>container_of</code> macro is not portable because it uses <em>gcc</em> extensions and deferencing of null pointer (which is generally UB):</p>\n\n<pre><code>#define container_of(ptr, type, member) ({          \\\n    const typeof( ((type *)0)-&gt;member ) *__mptr = (ptr);    \\\n    (type *)( (char *)__mptr - offsetof(type,member) );})\n</code></pre>\n\n<p>Is there a way to make a portable implementation of this macro?</p>\n"}, {"tags": ["c", "undefined-behavior", "operator-precedence"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1527693655, "post_id": 50608248, "comment_id": 88226327, "body": "It is undefined. The side effects are not deferred. They are <i>guaranteed</i> to take place after the sequence point, but not mandated <i>not</i> to take place before."}, {"owner": {"reputation": 1722, "user_id": 1905491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6e7e2cd68aa5392653859edad43b7340?s=128&d=identicon&r=PG", "display_name": "stefanct", "link": "https://stackoverflow.com/users/1905491/stefanct"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1527759594, "post_id": 50608248, "comment_id": 88252112, "body": "Would the downvoter please explain his/her vote so that we can improve the question?"}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1527696543, "creation_date": 1527696543, "answer_id": 50609208, "question_id": 50608248, "link": "https://stackoverflow.com/questions/50608248/order-of-evaluation-subexpressions-sequence-points-and-postfix-increments-in-c/50609208#50609208", "title": "Order of evaluation: subexpressions, sequence points and postfix increments in C", "body": "<p>Side effects don't <em>have</em> to be deferred until the sequence point -- they may be applied immediately upon evaluation.  Or not.  </p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011</a> has some slightly different (more precise) language:</p>\n\n<blockquote>\nIf a side effect on a scalar object is unsequenced relative to either a different side effect\non the same scalar object or a value computation using the value of the same scalar\nobject, the behavior is undefined.</blockquote>\n\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C 2011, &sect;6.5 &para;2</a></em></sup></p>\n\n<p><code>i++</code> has a side effect on <code>i</code>, <code>b[i]</code> uses <code>i</code> in a value computation, and the two subexpressions are <em>unsequenced</em> relative to each other (i.e., there is no intervening sequence point).  Thus, the behavior of <code>b[i] + i++</code> is undefined.  </p>\n"}, {"tags": [], "owner": {"reputation": 1722, "user_id": 1905491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6e7e2cd68aa5392653859edad43b7340?s=128&d=identicon&r=PG", "display_name": "stefanct", "link": "https://stackoverflow.com/users/1905491/stefanct"}, "is_accepted": false, "score": 1, "last_activity_date": 1527759503, "last_edit_date": 1527759503, "creation_date": 1527696554, "answer_id": 50609213, "question_id": 50608248, "link": "https://stackoverflow.com/questions/50608248/order-of-evaluation-subexpressions-sequence-points-and-postfix-increments-in-c/50609213#50609213", "title": "Order of evaluation: subexpressions, sequence points and postfix increments in C", "body": "<p>\u00a76.5.2.4 states</p>\n\n<blockquote>\n  <p>The side effect of updating the stored value of the operand shall occur between the previous and the next sequence point.</p>\n</blockquote>\n\n<p>Just like Eugene's comment suggested. In case this is not clear enough the statement cited in the question in \u00a7 6.5 (1)</p>\n\n<blockquote>\n  <p>the prior value shall be read only to determine the value to be stored.</p>\n</blockquote>\n\n<p>is violated directly as well. The value of <code>i</code> is not just read to determine the value after incrementing but also as operand of the subscript operator.</p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/1895922/sequence-points-and-partial-order\">question</a> and <a href=\"https://stackoverflow.com/a/1895947/1905491\">its accepted answer</a> might give additional insights as it discusses the sequence points introduced by the <code>,</code> operator and its interaction with the potential UB-provoking behavior of assignments.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1527696704, "creation_date": 1527696704, "answer_id": 50609254, "question_id": 50608248, "link": "https://stackoverflow.com/questions/50608248/order-of-evaluation-subexpressions-sequence-points-and-postfix-increments-in-c/50609254#50609254", "title": "Order of evaluation: subexpressions, sequence points and postfix increments in C", "body": "<p>Your quotation from section 6.5 is the relevant one:</p>\n\n<blockquote>\n  <p>Between the previous and next sequence point an object shall have its\n  stored value modified at most once by the evaluation of an expression.\n  [In that event, f]urthermore, the prior value\n  shall be read [between those sequence points] only to determine the value\n  to be stored.</p>\n</blockquote>\n\n<p>(Clarifications mine.)</p>\n\n<p>In your statement, the value of <code>i</code> is both modified and used as an index into <code>b</code>.  Your statement contains no internal sequence points, so these effects must occur between the same pair of sequence points.  The statement therefore violates the quoted requirement.  Section 4, paragraph 2 then applies:</p>\n\n<blockquote>\n  <p>If a ''shall'' or ''shall not'' requirement that appears outside of a\n  constraint is violated, the behavior is undefined. [...]</p>\n</blockquote>\n\n<p>That's all there is to it.  No other considerations are required.  Your argument about actual order of operations is completely irrelevant.</p>\n\n<p>Nevertheless, your claim that</p>\n\n<blockquote>\n  <p>the side effects of the whole statement are deferred until after all\n  these evaluations because that's the only sequence point.</p>\n</blockquote>\n\n<p>reflects a serious misunderstanding of sequence points.  Sequence points do not represent times <em>when</em> things happen, but rather boundaries <em>between which</em> things happen.  Not only are side effects not deferred to the next sequence point, they are far less constrained (by the standard) than operations involved in computing the values of expressions.</p>\n"}], "owner": {"reputation": 1722, "user_id": 1905491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6e7e2cd68aa5392653859edad43b7340?s=128&d=identicon&r=PG", "display_name": "stefanct", "link": "https://stackoverflow.com/users/1905491/stefanct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1527759503, "creation_date": 1527693410, "question_id": 50608248, "link": "https://stackoverflow.com/questions/50608248/order-of-evaluation-subexpressions-sequence-points-and-postfix-increments-in-c", "title": "Order of evaluation: subexpressions, sequence points and postfix increments in C", "body": "<p>A discussion arose around the C statement <code>x = b[i] + i++;</code> and its definedness.</p>\n\n<p>The argument for said statement to be undefined goes something like this:</p>\n\n<p>\u00a7 6.5 of C99 states:</p>\n\n<blockquote>\n  <p>[\u2026] the order of evaluation of subexpressions and the order in which side effects take place are both unspecified.</p>\n</blockquote>\n\n<p>Thus it is not guaranteed that <code>i</code> is incremented after it is used in the subscript operator as index of the array.</p>\n\n<p>However, I interpret said specification differently.</p>\n\n<p>\u00a7 6.5 of C99 additionally states:</p>\n\n<blockquote>\n  <p>Between the previous and next sequence point an object shall have its stored value\n  modified at most once by the evaluation of an expression. Furthermore, the prior value\n  shall be read only to determine the value to be stored.</p>\n</blockquote>\n\n<p>\u00a7 5.1.2.3 of C99 states:</p>\n\n<blockquote>\n  <p>At\n  certain specified points in the execution sequence called sequence points, all side effects\n  of previous evaluations shall be complete and no side effects of subsequent evaluations\n  shall have taken place.</p>\n</blockquote>\n\n<p>A list of sequence points is given in annex C and only the following matches the statement in question IMHO.</p>\n\n<blockquote>\n  <p>The end of a full expression</p>\n</blockquote>\n\n<p>The evaluation of <code>b[i]</code> (the value of element <code>i</code> of <code>b</code>) and that of <code>i++</code> (just <code>i</code>) can happen in any order before the addition (and evaluation of <code>=</code>, which is the value of the RHS) is done. However, the side effects of the whole statement are deferred until after all these evaluations because that's the only sequence point. In this case the side effects are the change of <code>x</code> and the increment of <code>i</code>.</p>\n\n<p>Who is right? Are there additional paragraphs relevant for the argument? Is it any different in C++?</p>\n"}, {"tags": ["c", "cblas"], "owner": {"reputation": 11, "user_id": 8206391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57a30c3fc90811e3793d27dc3ed0d434?s=128&d=identicon&r=PG&f=1", "display_name": "sinok1", "link": "https://stackoverflow.com/users/8206391/sinok1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527694542, "creation_date": 1527692867, "last_edit_date": 1527694542, "question_id": 50608054, "link": "https://stackoverflow.com/questions/50608054/how-can-i-use-cblas-dgemv-in-order-to-multiply-different-dimension-vectors", "title": "how can i use cblas dgemv in order to multiply different dimension vectors?", "body": "<p>I have a vector <code>sigma[40000]</code> and another one <code>u[200]</code>.</p>\n\n<p>I want to use <code>dgemv</code> in order to multiply the first <strong>200</strong> numbers of <code>sigma</code> with <code>u</code>, and then the next <strong>200-400</strong> again with <code>u</code> until I use all of the numbers of <code>sigma</code>.</p>\n\n<p><strong>I have something like this:</strong></p>\n\n<pre><code>for(i=0; i&lt;200; i++)\n{\n    for(j=0; j&lt;200; j++)\n    {\n        sum = sum +sigma[i*200 + j]*u[j]\n    }\n\n    z=...+sum;\n}\n</code></pre>\n\n<p><strong>I want to make something like this:</strong></p>\n\n<pre><code>cblas_dgemv(CblasRowMajor,CblasNoTrans,1,200,1,u,200,sigma,1,0,return,1)\n\nfor(i=0; i&lt;200; i++)\n{\n    sum=...+return[i];\n}\n</code></pre>\n\n<p>The return value is a vector (<code>return[200]</code>) in which <code>return[0]=sigma[0-199]*u[0-199]</code>.</p>\n"}, {"tags": ["c", "windows", "sockets"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1527692572, "post_id": 50607736, "comment_id": 88225613, "body": "I guess your server sample is not yet complete. (I once wrote wrapper classes for socket server/clients and forgot almost everything about internals since then.) However, next step would be to <code>accept()</code> a connection. There are quite a lot docs on MSDN which might be helpful. For the start, this is the link where I stopped my recalling: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms737593(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN: Complete Winsock Server Code</a>"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1527692580, "post_id": 50607736, "comment_id": 88225616, "body": "<code>listen</code> only declares that the socket will be used for incoming connection and sets up a queue for it. The <code>accept</code> call is necessary to actually wait for a new connection. You should google for <i>socket tutorial C</i> for some examples"}, {"owner": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527693208, "post_id": 50607736, "comment_id": 88226039, "body": "Thank you sooooooo much!!! I thought listen() actually waits calls.. Thank you and Thank you again!"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527693218, "post_id": 50607938, "comment_id": 88226046, "body": "Thank you sooooooo much!!! I thought listen() actually waits calls.. Thank you and Thank you again!"}, {"owner": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527696402, "post_id": 50607938, "comment_id": 88228016, "body": "Sure I will upload it in the text!"}, {"owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "reply_to_user": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527697482, "post_id": 50607938, "comment_id": 88228616, "body": "atoi should not be used in htons(atoi(1000)), as it expects a string as input, you can just do address_of_server.sin_port = htons(10000);."}, {"owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "reply_to_user": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527697502, "post_id": 50607938, "comment_id": 88228625, "body": "apart from that, you need to check the return values of bind &amp; listen, and check with WSAGetLastError what the particular error was that happened."}, {"owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "reply_to_user": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527697556, "post_id": 50607938, "comment_id": 88228648, "body": "probably your bind &amp; listen haven&#39;t succeeded so accept won&#39;t work either"}, {"owner": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "edited": false, "score": 0, "creation_date": 1527740884, "post_id": 50607938, "comment_id": 88243071, "body": "Wow I really appreciate your help :) I fixed my code!! Thank you so much !!!! I think I should study more about socket programming in c. Thank you and thank you again!"}], "tags": [], "owner": {"reputation": 2348, "user_id": 5820440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQxPRvll8zs/AAAAAAAAAAI/AAAAAAAAFZ8/meZGJQSwVro/photo.jpg?sz=128", "display_name": "Sami Sallinen", "link": "https://stackoverflow.com/users/5820440/sami-sallinen"}, "is_accepted": false, "score": 2, "last_activity_date": 1527692539, "creation_date": 1527692539, "answer_id": 50607938, "question_id": 50607736, "link": "https://stackoverflow.com/questions/50607736/socket-programming-using-windows-10-and-c-visual-studio-2015/50607938#50607938", "title": "Socket programming using Windows 10 and C (Visual Studio 2015)", "body": "<p>After listen() you need to call accept() to get a new connected socket. listen() just starts the listening and does not wait for any client to connect.</p>\n"}], "owner": {"reputation": 105, "user_id": 9752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f602489a2e7c6a9db7511e77549c9276?s=128&d=identicon&r=PG&f=1", "display_name": "allentando", "link": "https://stackoverflow.com/users/9752820/allentando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527696649, "creation_date": 1527691954, "last_edit_date": 1527696649, "question_id": 50607736, "link": "https://stackoverflow.com/questions/50607736/socket-programming-using-windows-10-and-c-visual-studio-2015", "title": "Socket programming using Windows 10 and C (Visual Studio 2015)", "body": "<p>I wrote socket server code using windows 10 and C (visual studios 2015) but I think bind or listen code is wrong.</p>\n\n<p>When I execute my code, It doesn't wait until client is connected. It is finished after print out \"winsock initialization success\" and \"creating socket success\".</p>\n\n<p>Help me please.</p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;winsock2.h&gt;\n\nint main(int argc, char *argv[]) {\n\n    WSADATA wsaData;\n\n    struct sockaddr_in address_of_server;\n    struct sockaddr_in address_of_client;\n\n    int socket_of_client;\n    int size_of_address_of_client = sizeof(address_of_client);\n\n    if (WSAStartup(MAKEWORD(2, 2), &amp;wsaData) == 0) {\n        printf(\"winsock initialization success\\n\");\n    }\n    else {\n        printf(\"winsock initialization failure\\n\");\n    }\n\n    SOCKET socket_of_server = socket(AF_INET, SOCK_STREAM, 0);\n\n    if (socket_of_server == -1) {\n        printf(\"creating socket failure\\n\");\n    }\n    else {\n        printf(\"creating socket success\\n\");\n    }\n\n    memset(&amp;address_of_server, 0, sizeof(address_of_server));\n    address_of_server.sin_family = AF_INET;\n    address_of_server.sin_addr.s_addr = htonl(INADDR_ANY);\n    address_of_server.sin_port = htons(atoi(10000));\n\n    bind(socket_of_server, (struct sockaddr*)&amp;address_of_server, sizeof(address_of_server));\n\n    listen(socket_of_server, 5);\n\n    socket_of_client = accept(socket_of_server, (struct sockaddr*)&amp;address_of_client, &amp;size_of_address_of_client);\n\n    WSACleanup();\n\n}\n</code></pre>\n"}, {"tags": ["c", "generics", "makefile"], "comments": [{"owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "edited": false, "score": 0, "creation_date": 1527691032, "post_id": 50607332, "comment_id": 88224507, "body": "Arent you overwriting variable  OBJFILES in consecutive lines?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527692494, "post_id": 50607455, "comment_id": 88225554, "body": "I still get this error:  make: *** No rule to make target <code>%(SRCFILES)&#39;, needed by </code>all&#39;.  Stop."}, {"owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "reply_to_user": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527692797, "post_id": 50607455, "comment_id": 88225772, "body": "Also try  <code>OBJFILES := $(patsubst %.c,%.o,$(SRCFILES))</code>"}, {"owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "reply_to_user": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527692872, "post_id": 50607455, "comment_id": 88225815, "body": "You want to use patsubst like this  <code>$(patsubst %suffix,%replacement,$(var))</code>"}, {"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527693309, "post_id": 50607455, "comment_id": 88226107, "body": "That got it to start but I got an error that I think has to do with the flags. If you see my original makefile, when I am making the generic .o files, you use cflags but when I am making the abc_test file, I call LDFlags. Anyway to differentiate that?"}, {"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527693450, "post_id": 50607455, "comment_id": 88226189, "body": "Also... my CCFlags has a hardcoded path to another file in it. If the file I am compiling is in one directory up, does that hardcoded path get screwed up? I think that is the error I am having now"}, {"owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "reply_to_user": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527694038, "post_id": 50607455, "comment_id": 88226588, "body": "expand your question with the new error. Hard to say anything without seeing the error"}, {"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527694824, "post_id": 50607455, "comment_id": 88227084, "body": "If you look at the original makefile, most of the lines are compiling with (CCFLAGS) and one line is compiling with (LDFLAGS) how can I differentiate them generically?"}, {"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527695078, "post_id": 50607455, "comment_id": 88227236, "body": "the error I am getting is: gcc -c (filepath) %&lt; -o %@      [NEWLINE]                                                                    /bin/sh: -o: No such file or directory. [NEWLINE] Sorry I am not sure how to make a new line in the comment here so I put the brackets with newline as a line break"}, {"owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "reply_to_user": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527695260, "post_id": 50607455, "comment_id": 88227351, "body": "I cant say much without seeing the Makefile and you keep changing the scope of the question. Edit the question and report your new error below the old question."}, {"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527696802, "post_id": 50607455, "comment_id": 88228237, "body": "I just updated my post. There is a separator bug, trying to find it now although I am very new to makefiles"}], "tags": [], "owner": {"reputation": 684, "user_id": 2243184, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c3c3d532ae26d2aab62b89440ad21a8c?s=128&d=identicon&r=PG", "display_name": "physicist", "link": "https://stackoverflow.com/users/2243184/physicist"}, "is_accepted": true, "score": 0, "last_activity_date": 1527792496, "last_edit_date": 1527792496, "creation_date": 1527691128, "answer_id": 50607455, "question_id": 50607332, "link": "https://stackoverflow.com/questions/50607332/creating-a-more-generic-makefile/50607455#50607455", "title": "Creating a more generic makefile", "body": "<p><em>I would recommend you read about the basics of Makefile. This is a useful link <a href=\"https://www.gnu.org/software/make/manual/html_node/Introduction.html\" rel=\"nofollow noreferrer\">intro to makefile</a></em></p>\n\n<p>The variable <code>OBJFILES</code> is being over-written in consecutive lines in the example provided. I suspect removing line</p>\n\n<p><code>OBJFILES: all</code></p>\n\n<p>and using patsubst as</p>\n\n<p><code>$(patsubst %suffix,%replacement,$(var))</code></p>\n\n<p>might help.</p>\n\n<p>@edit: Since now you asked  on how to use <code>LDFLAGS</code> and get rid of the 'missing separator' error, here are some suggestions.</p>\n\n<ul>\n<li>Purpose of <code>LDFLAGS</code> is to use to provide link time flags to compiler when all the object files are linked to make the final executable. They could look like this</li>\n</ul>\n\n<blockquote>\n<pre><code>all: $(PROG)\n\n$(PROG): $(OBJFILES)\n    $(CC) $(CFLAGS) $(OBJFILES) -o $@ $(LDFLAGS)\n</code></pre>\n</blockquote>\n\n<ul>\n<li>The error '<em>missing seperator</em>' is fixed by inserting tabs instead of space in the beginning of a line describing an action/recipe to a rule. Open the Makefile again in an editor and remove the spaces in front of below lines and replace with tab.. the arrow I am using to show a tab</li>\n</ul>\n\n<blockquote>\n<pre><code>----&gt;$(CC) $(CFLAGS) $(OBJFILES) -o $@ $(LDFLAGS)\n\n----&gt;$(CC) $(CFLAGS) %&lt; -o %@\n\n----&gt;$(CC) $(CFLAGS) knownfile.c\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527693511, "post_id": 50608185, "comment_id": 88226229, "body": "That was one of my issues. I am able to at least get it to start running now, it just can&#39;t find files now which probably means my paths are screwed up. I just asked a question on the other post:   &quot;Also... my CCFlags has a hardcoded path to another file in it. If the file I am compiling is in one directory up, does that hardcoded path get screwed up? I think that is the error I am having now &quot;"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "edited": false, "score": 0, "creation_date": 1527693851, "post_id": 50608185, "comment_id": 88226471, "body": "@Krixen, we can answer only the question you&#39;ve actually presented, not (to us) hypotheticals about related situations.  However, if you&#39;re concerned that incorrect flags are being emitted then you can always examine <code>make</code>&#39;s output to see exactly what commands are actually issued.  Capture the output in a file if necessary to avoid the command of interest scrolling away to oblivion."}, {"owner": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1527701506, "post_id": 50608185, "comment_id": 88230761, "body": "FYI, the POSIX standard (and all implementations I&#39;m familiar with) allows for both <code>$()</code> and <code>${}</code> as well; that&#39;s not a GNU make extension.  I personally always use <code>$()</code> unless there&#39;s some inner parentheses which would conflict."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 69991, "user_id": 939557, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/3VPea.png?s=128&g=1", "display_name": "MadScientist", "link": "https://stackoverflow.com/users/939557/madscientist"}, "edited": false, "score": 0, "creation_date": 1527702121, "post_id": 50608185, "comment_id": 88231100, "body": "Thanks, @MadScientist, I guess that was a longstanding misconception of mine, or maybe a memory from days when full POSIX compliance was rare.  Anyway, corrected."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1527701842, "last_edit_date": 1527701842, "creation_date": 1527693234, "answer_id": 50608185, "question_id": 50607332, "link": "https://stackoverflow.com/questions/50607332/creating-a-more-generic-makefile/50608185#50608185", "title": "Creating a more generic makefile", "body": "<p>This line does not do what you think it does:</p>\n\n<pre><code>OBJFILES: all\n</code></pre>\n\n<p>Or at least I assume so, for although it is mostly harmless, it is also useless.  It declares that a <em>target</em> named 'OBJFILES' depends on target 'all'.  It also happens to be the first target in the file, so it is the default target, but because 'all' is its prerequiste, it will cause the 'all' target to be rebuilt by default.  This is precisely what would happen if you omitted that line altogether.  Note, too, that this has nothing to do with the <em>variable</em> <code>$(OBJFILES)</code>.</p>\n\n<p>Your main problem appears to be that you are using the wrong syntax for most of your variable references.  The values of variables with multi-character names are obtained via expressions of the form <code>$(VAR)</code> or <code>${VAR}</code>, <strong><em>not</em></strong> <code>%(var)</code>.  The parentheses / braces can be omitted for single-character names.  I advise you to favor the form with parentheses over the one with curly braces, especially in commands in recipes, for the latter is easy to confuse with shell syntax.</p>\n"}], "owner": {"reputation": 45, "user_id": 9870872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379a305137f43f68da0478dc9a1bf46?s=128&d=identicon&r=PG&f=1", "display_name": "Krixen", "link": "https://stackoverflow.com/users/9870872/krixen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 50607455, "answer_count": 2, "score": 1, "last_activity_date": 1527792496, "creation_date": 1527690735, "last_edit_date": 1527696778, "question_id": 50607332, "link": "https://stackoverflow.com/questions/50607332/creating-a-more-generic-makefile", "title": "Creating a more generic makefile", "body": "<p>I have the following makefile:</p>\n\n<pre><code>CC=gcc\nCFLAGS= ---\nLDFLAGS = ---\n\nall: abc_test   \nabc_test: abc_test.o defn_abc.o abc.o cmocka_compass.o\n    $(CC) $(LDFLAGS) abc_test.o defn_abc.o abc.o cmocka_compass.o -o \nabc_test    \nabc_test.o : abc_test.c \n    $(CC) $(CFLAGS) abc_test.c \ndefn_abc.o : ../defn_abc.c\n    $(CC) $(CFLAGS) ../defn_abc.c\nabc.o : ../abc.c\n    $(CC) $(CFLAGS) ../abc.c    \nknownfile.o : ../../../../../knownpath.c \n    $(CC) $(CFLAGS) ../../../../../knownpath.c\nclean: \n    rm *o *.log abc_test\n</code></pre>\n\n<p>Which will work (changed some files names) but I want to make it generic. I tried the following but I keep getting errors that there are no targets.</p>\n\n<pre><code>CC=gcc\nCFLAGS= ---\nLDFLAGS = ---\n\nSRCFILES := $(shell find ../ -name '*.c')\nOBJFILES := $(patsubst %.c,%.o,%(SRCFILES))\n\nOBJFILES: all\nall: $(OBJFILES)\n\n%.o: %.c\n    $(CC) $(CFLAGS) %&lt; -o %@\n\nknownfile.o : knownpath.c \n    $(CC) $(CFLAGS) knownpath.c\n</code></pre>\n\n<p>the make file is a test folder, which contains all the test code (abs_test.c). This is also where all the objects should go. One directory up contains the c files defn_abc.c and abc.c. </p>\n\n<p>Any idea what I am doing wrong?</p>\n\n<hr>\n\n<p>UPDATE: Here is my latest makefile, with the error 'missing separator'</p>\n\n<pre><code>CC=gcc\nCFLAGS=-c -Wall -DUNIT_TESTING -DSYS_LINUX -Ipath1 -Ipath2\nLDFLAGS = -Wl,---\n\n\nSRCFILES := $(shell find ../ -name '*.c')\nOBJFILES := $(patsubst %.c,%.o,$(SRCFILES))\n\nall: $(PROG)\n\n$(PROG): $(OBJFILES)\n    $(CC) $(CFLAGS) $(OBJFILES) -o $@ $(LDFLAGS)\n\nall: $(OBJFILES)\n\n%.o: %.c\n    $(CC) $(CFLAGS) %&lt; -o %@\n\nknownfile.o : knownpath.c \n    $(CC) $(CFLAGS) knownfile.c\n</code></pre>\n"}, {"tags": ["c++", "c", "lua"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527689924, "post_id": 50606847, "comment_id": 88223684, "body": "If <code>luaL_loadstring</code> something you&#39;re trying to implement? If so, what have you tried?"}, {"owner": {"reputation": 651, "user_id": 6834680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OvYt2.png?s=128&g=1", "display_name": "Egor   Skriptunoff", "link": "https://stackoverflow.com/users/6834680/egor-skriptunoff"}, "edited": false, "score": 1, "creation_date": 1527691307, "post_id": 50606847, "comment_id": 88224701, "body": "Concatenate <code>&quot;return &quot;</code> with <code>TableFromStr</code> and invoke <code>luaL_dostring</code>"}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1527691331, "post_id": 50607305, "comment_id": 88224717, "body": "Suggestion: Add the relevant content (code example)  from the 2nd link directly into your answer.  Leaving the link intact is fine to provide a reference of where the example code came from, but the link by itself may disappear at some point, rendering your answer less useful."}], "tags": [], "owner": {"reputation": 4124, "user_id": 2828480, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/30ce285bfd170cf3834d9591fab207e0?s=128&d=identicon&r=PG&f=1", "display_name": "Konrad", "link": "https://stackoverflow.com/users/2828480/konrad"}, "is_accepted": true, "score": 3, "last_activity_date": 1527691626, "last_edit_date": 1527691626, "creation_date": 1527690665, "answer_id": 50607305, "question_id": 50606847, "link": "https://stackoverflow.com/questions/50606847/how-to-create-a-lua-table-from-a-string/50607305#50607305", "title": "How to create a lua table from a string?", "body": "<p>You have to use <code>luaL_dostring</code> </p>\n\n<p><a href=\"https://www.lua.org/manual/5.1/manual.html#luaL_dostring\" rel=\"nofollow noreferrer\">https://www.lua.org/manual/5.1/manual.html#luaL_dostring</a></p>\n\n<p>If you're using Lua 5.1 make sure <code>luaL_dostring</code> is correctly defined. See: <a href=\"http://lua-users.org/lists/lua-l/2006-04/msg00218.html\" rel=\"nofollow noreferrer\">http://lua-users.org/lists/lua-l/2006-04/msg00218.html</a></p>\n\n<blockquote>\n  <p>In Lua 5.1, <code>luaL_dostring</code> is defined as <code>luaL_loadstring(L, s) || lua_pcall(L, 0, 0, 0)</code></p>\n  \n  <p>and so it ignores returns.</p>\n  \n  <p>Try this:</p>\n\n<pre><code>#undef luaL_dostring\n#define luaL_dostring(L,s)    \\   (luaL_loadstring(L, s) || lua_pcall(L, 0, LUA_MULTRET, 0))\n</code></pre>\n</blockquote>\n\n<p>It's possible that you will also have to prepend your string with <code>return</code></p>\n"}], "owner": {"reputation": 55, "user_id": 7093543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b54ef375501043de103218d174f5cfc?s=128&d=identicon&r=PG&f=1", "display_name": "\u971c\u6708\u5e7b\u591c", "link": "https://stackoverflow.com/users/7093543/%e9%9c%9c%e6%9c%88%e5%b9%bb%e5%a4%9c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 50607305, "answer_count": 1, "score": 1, "last_activity_date": 1527691626, "creation_date": 1527689358, "question_id": 50606847, "link": "https://stackoverflow.com/questions/50606847/how-to-create-a-lua-table-from-a-string", "title": "How to create a lua table from a string?", "body": "<p>I have a c function, used to return a table to lua, but the table is created from a string, not lua_newtable, how to do this?</p>\n\n<pre><code>int GetTable(lua_State* L)\n{\n    //this string is generated at runtime, so i can not use lua_newtable\n    const char* TableFromStr = \"{a = 123, b = 456, d = {x = 1, y = 9} }\";\n    //i want to push the table to the top stack\n    luaL_loadstring(L, TableFromStr);\n    //return 1 table, lua code can get the table\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "limit"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527690015, "post_id": 50607042, "comment_id": 88223746, "body": "Thanks. Does bash&#39;s <code>ulimit</code> also work by reading and writing from and to <code>&#47;etc&#47;security&#47;limits.conf</code>?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527693836, "post_id": 50607042, "comment_id": 88226462, "body": "Uh. No. <code>ulimit</code> works by calling <code>getrlimit</code> and <code>setrlimit</code>. <i>Nothing</i> writes to <code>&#47;etc&#47;security&#47;limits.conf</code>, and the only thing that reads it is the pam_limits module. What part of my answer gave you the impression that it was otherwise?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527694482, "post_id": 50607042, "comment_id": 88226872, "body": "Sry. What kinds of applications work by reading and writing from and to /etc/security/limits.conf?  Are they exactly those which rely on pam_limits module?"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527695101, "post_id": 50607042, "comment_id": 88227251, "body": "For example, is bash&#39;s signal handling trap for SIGQUIT implemented based on  both <code>&#47;etc&#47;security&#47;limits.conf</code> and <code>setrlimit()</code>, so it reads from <code>&#47;etc&#47;security&#47;limits.conf</code>, and calls <code>setrlimit()</code> to change the core file size limit to the values in <code>&#47;etc&#47;security&#47;limits.conf</code>, and then tries to create a core dump file?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527695204, "post_id": 50607042, "comment_id": 88227311, "body": "Again, <b>nothing</b> writes to /etc/security/limits.conf in the course of normal operation; it only changes when the system is being upgraded or reconfigured, and the tools used that are typically things like <code>vi</code> and <code>dpkg</code>, which are general-purpose system administration tools. In principle, there could be applications that <i>read</i> from limits.conf without using pam_limits to do it, but I don&#39;t know why anyone would bother, it doesn&#39;t look fun to parse."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527695364, "post_id": 50607042, "comment_id": 88227414, "body": "Bash doesn&#39;t have a special handler for SIGQUIT and is not involved in the process of creating a core dump.  The kernel writes a core dump as part of the &quot;default action&quot; for SIGQUIT, if and only if the rlimit for core dumps is large enough; that rlimit may have been established by <code>login</code> according to what it says in limits.conf, or it may have been adjusted by hand using <code>ulimit</code>, or whatever."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527695462, "post_id": 50607042, "comment_id": 88227477, "body": "I think you need to read a book on the basic architecture of Unix systems; your follow-up questions suggest you are confused at the level of basic design principles.  The usual recommendation is W. Richard Stevens&#39; <i>Advanced Programming in the Unix Environment</i>.  There might be a better introductory text nowadays, but I don&#39;t know what it is.  (I learned nearly everything I know from the manpages and the POSIX specification, but I am That Kind Of Nerd.)"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527699167, "post_id": 50607042, "comment_id": 88229468, "body": "Thanks. I am reading APUE, which has made huge impact on me and it is still making. I don&#39;t find in APUE that <code>login</code> sets up the resource limits from <code>&#47;etc&#47;security&#47;limits.conf</code>. Neither can I find that <code>login</code> sets up default signal handlers, for which  I have some confusions <a href=\"https://unix.stackexchange.com/questions/446947/where-does-a-bash-process-get-its-default-signal-handlers-traps\" title=\"where does a bash process get its default signal handlers traps\">unix.stackexchange.com/questions/446947/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 3, "last_activity_date": 1527694083, "last_edit_date": 1527694083, "creation_date": 1527689892, "answer_id": 50607042, "question_id": 50606753, "link": "https://stackoverflow.com/questions/50606753/do-getrlimit-and-setrlimit-work-by-reading-from-and-writing-to-etc-sec/50607042#50607042", "title": "Do `getrlimit()` and `setrlimit()` work by reading from and writing to `/etc/security/limits.conf`?", "body": "<p>In fact, it's the other way around: <code>/etc/security/limits.conf</code> controls calls made to <code>getrlimit</code> and <code>setrlimit</code>.</p>\n\n<p><code>getrlimit</code> and <code>setrlimit</code> read and write kernel state associated with the calling process.  They do not access any file at all.  Like most kernel state associated with a particular process, the resource limits are <em>inherited</em> (copied into) <code>fork</code>-ed children.</p>\n\n<p><code>/etc/security/limits.conf</code> is never modified automatically (except possibly by a system upgrade); it's intended for the sysadmin to edit, by hand.</p>\n\n<p>The <a href=\"http://man7.org/linux/man-pages/man1/login.1.html\" rel=\"nofollow noreferrer\"><code>login</code></a> program (technically, the <a href=\"http://man7.org/linux/man-pages/man8/pam_limits.8.html\" rel=\"nofollow noreferrer\">pam_limits</a> module that it may load, and does load in Ubuntu 18's default configuration) reads <code>/etc/security/limits.conf</code>, and uses the information in that file to make a series of calls to <a href=\"http://man7.org/linux/man-pages/man2/getrlimit.2.html\" rel=\"nofollow noreferrer\"><code>setrlimit</code></a>, establishing resource limits for the user's initial shell.  Those resource limits then inherit to all processes started by the shell, and so on transitively.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 50607042, "answer_count": 1, "score": 0, "last_activity_date": 1527694083, "creation_date": 1527689083, "question_id": 50606753, "link": "https://stackoverflow.com/questions/50606753/do-getrlimit-and-setrlimit-work-by-reading-from-and-writing-to-etc-sec", "title": "Do `getrlimit()` and `setrlimit()` work by reading from and writing to `/etc/security/limits.conf`?", "body": "<p>In Linux (e.g. Ubuntu 18.04 or other), do <code>getrlimit()</code> and <code>setrlimit()</code> work by reading from and writing to <code>/etc/security/limits.conf</code>?</p>\n\n<p>I am trying to understand the relations between <code>getrlimit()</code> and <code>setrlimit()</code> and <code>/etc/security/limits.conf</code>. Thanks.</p>\n"}, {"tags": ["c", "mongodb", "driver"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527697251, "post_id": 50606683, "comment_id": 88228509, "body": "Take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>, and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Why do you think you&#39;re getting this error? If you suspect you coded it up incorrectly, post an MCVE, otherwise, drop the C tag. You&#39;ve given no indication that this isn&#39;t a <a href=\"https://superuser.com/\">SuperUser</a> systems configuration question. While lots of things can cause connection refused failures, the first things that comes to mind is firewall configuration and authentication issues, non of which can be diagnosed without the appropriate logs and configuration files. Not a good SO question."}], "owner": {"reputation": 31, "user_id": 6161484, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-y4C9gOP8WpY/AAAAAAAAAAI/AAAAAAAAABo/j2PM7A6ql6I/photo.jpg?sz=128", "display_name": "Alex Katebi", "link": "https://stackoverflow.com/users/6161484/alex-katebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527688873, "creation_date": 1527688873, "question_id": 50606683, "link": "https://stackoverflow.com/questions/50606683/mongo-c-client-loses-connection-with-error", "title": "Mongo C client loses connection with error", "body": "<p>No suitable servers found (<code>serverSelectionTryOnce</code> set): [connection refused calling ismaster on 'mongodb:27017']</p>\n\n<p>Why am I getting this error message? Thanks!</p>\n"}, {"tags": ["c", "linux", "environment-variables"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527689370, "post_id": 50606668, "comment_id": 88223258, "body": "The <code>&quot;en_US.UTF-8&quot;</code> is probably the character set to be used. That other locale variables have this value is strange. I would expect that Monetary would be <code>&quot;$&quot;</code> and Time would be the time format or the time zone. At least the timezone is used by the date &amp; time library functions."}, {"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1527689452, "post_id": 50606668, "comment_id": 88223323, "body": "Perhaps <a href=\"https://docs.oracle.com/cd/E19253-01/817-2521/overview-39/index.html\" rel=\"nofollow noreferrer\">What Is a Locale</a> can help."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527689512, "post_id": 50606668, "comment_id": 88223370, "body": "The C language doesn&#39;t use the &quot;environment list&quot; itself. It&#39;s up to you to make use of it. For example you could use <a href=\"http://en.cppreference.com/w/c/program/getenv\" rel=\"nofollow noreferrer\"><code>getenv</code></a> to read <code>LC_COLLATE</code> and use it for a <a href=\"http://en.cppreference.com/w/c/locale/setlocale\" rel=\"nofollow noreferrer\"><code>setlocale</code></a> call and then use <a href=\"http://en.cppreference.com/w/c/string/byte/strcoll\" rel=\"nofollow noreferrer\"><code>strtoll</code></a> for locale-aware string comparisons."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527689568, "post_id": 50606668, "comment_id": 88223420, "body": "POSIX systems will probably use it more frequently, maybe even internally in system calls. But you have to read the manual pages of the calls to find out."}], "answers": [{"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1527689901, "post_id": 50606965, "comment_id": 88223665, "body": "@andreee Oops, did not notice <code>C</code> tag."}, {"owner": {"reputation": 35869, "user_id": 7512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d064a7aca29011d3246302b27c41f4d9?s=128&d=identicon&r=PG", "display_name": "slim", "link": "https://stackoverflow.com/users/7512/slim"}, "edited": false, "score": 1, "creation_date": 1527690092, "post_id": 50606965, "comment_id": 88223803, "body": "I removed the C++ namespacing to make it C, and the function-wrapping, which was extraneous."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1527690150, "post_id": 50606965, "comment_id": 88223833, "body": "What does the <code>&#39;</code> flag in the format specifier do? It&#39;s non-standard."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1527690412, "post_id": 50606965, "comment_id": 88224052, "body": "@IanAbbott <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fprintf.html\" rel=\"nofollow noreferrer\">It is a POSIX format specifier</a> for formatting with thousand grouping. An extension to the ISO C standard."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1575906523, "post_id": 50606965, "comment_id": 104714340, "body": "The list in this answe is incomplete. I believe the POSIX specifications for the functions in that list cover it <i>if you also dig though them all to find the other functions specified on the same page as each one</i>. An obvious omission is all the <code>printf</code> variants, but there are a good many more too, like mb/wc variants, etc."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1575906572, "post_id": 50606965, "comment_id": 104714366, "body": "@R.. True, this is why <i>POSIX setlocale documentation contains an <b>incomplete</b> list of locale-dependent functions affected by it</i>."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 12, "last_activity_date": 1527739935, "last_edit_date": 1527739935, "creation_date": 1527689694, "answer_id": 50606965, "question_id": 50606668, "link": "https://stackoverflow.com/questions/50606668/which-components-use-the-locale-variables/50606965#50606965", "title": "Which components use the locale variables?", "body": "<p><a href=\"http://en.cppreference.com/w/c/locale/setlocale\" rel=\"nofollow noreferrer\">By default, C's standard library functions use the \"C\" locale</a>. You can switch it to the user locale to enable locale-specific:</p>\n\n<ul>\n<li>Character handling</li>\n<li>Collating</li>\n<li>Date/time formatting</li>\n<li>Numeric editing</li>\n<li>Monetary formatting</li>\n<li>Messaging</li>\n</ul>\n\n<p>POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setlocale.html\" rel=\"nofollow noreferrer\"><code>setlocale</code></a> documentation contains an incomplete list of locale-dependent functions affected by it:</p>\n\n<blockquote>\n  <p>catopen, exec, fprintf, fscanf, isalnum, isalpha, isblank, iscntrl, isdigit, isgraph, islower, isprint, ispunct, isspace, isupper, iswalnum, iswalpha, iswblank, iswcntrl, iswctype, iswdigit, iswgraph, iswlower, iswprint, iswpunct, iswspace, iswupper, iswxdigit, isxdigit, localeconv, mblen, mbstowcs, mbtowc, newlocale, nl_langinfo, perror, psiginfo, setlocale, strcoll, strerror, strfmon, strftime, strsignal, strtod, strxfrm, tolower, toupper, towlower, towupper, uselocale, wcscoll, wcstod, wcstombs, wcsxfrm, wctomb</p>\n</blockquote>\n\n<p>E.g.:</p>\n\n<pre><code>printf(\"%'d\\n\", 1000000000);\nprintf(\"Setting LC_ALL to %s\\n\", getenv(\"LANG\"));\nsetlocale(LC_ALL, \"\"); // Set user-preferred locale.\nprintf(\"%'d\\n\", 1000000000);\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>1000000000\nSetting LC_ALL to en_US.UTF-8\n1,000,000,000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 5, "last_activity_date": 1527698884, "last_edit_date": 1527698884, "creation_date": 1527698362, "answer_id": 50609699, "question_id": 50606668, "link": "https://stackoverflow.com/questions/50606668/which-components-use-the-locale-variables/50609699#50609699", "title": "Which components use the locale variables?", "body": "<blockquote>\n  <p>I have read that every process has a set of locale variables associated with it.</p>\n</blockquote>\n\n<p>That's not really true, or at least it is highly over-simplified.</p>\n\n<p>Many standard library functions (and non-standard library functions) modify their behaviour based on a set of locale configurations which are maintained in some hidden global object within the standard library implementation. (In some library implementations, the locale configuration is maintained per-thread rather than globally, using thread-local static variables.) That may seem to be associated with a process, since typically each process has a single instance of the standard library's runtime, but it's important to understand that -- despite appearances -- locale support is part of the library, not the OS kernel. (Of course, nothing in any standard defines where the kernel's boundaries are, or even what a kernel might be. You could run your program \"bare metal\" or you might have an OS which considers it useful to implement the standard library within system calls. I'm talking here about common cases.)</p>\n\n<p>Basic locale configuration is defined by the C standard in section 7.11 (of the C11 standard), which defines two interfaces: </p>\n\n<ul>\n<li><p><code>setlocale</code>, which modifies the library's locale configuration, and</p></li>\n<li><p><code>localeconv</code>, which queries <em>part of</em> the locale configuration, allowing user code to conform to the locale's numeric formatting conventions (including monetary formatting).</p></li>\n</ul>\n\n<p>The locale configuration is divided into a number of more-or-less independent components, called \"categories\". (The C++ standard library calls these \"facets\", which is also a commonly-used word.) There are five categories defined by the C standard and one more defined by Posix, but the categories are open-ended; individual standard library implementations are free to add additional categories. For example, the Gnu standard C library used on most Linux systems currently has a total of 12 categories. (See <code>man 7 locale</code> on your system for a current list.)</p>\n\n<p>The standard categories are:</p>\n\n<ul>\n<li><code>LC_CTYPE</code>:    Character classification and case conversion.</li>\n<li><code>LC_COLLATE</code>:    Collation order.</li>\n<li><code>LC_MONETARY</code>:    Monetary formatting.</li>\n<li><code>LC_NUMERIC</code>:    Numeric, non-monetary formatting.</li>\n<li><code>LC_TIME</code>:    Date and time formats.</li>\n</ul>\n\n<p>and the Posix extension is:</p>\n\n<ul>\n<li><code>LC_MESSAGES</code>:    Formats of informative and diagnostic messages and interactive responses. </li>\n</ul>\n\n<p>Aside from <code>localeconv</code>, which only provides access to specific configurations from the <code>LC_NUMERIC</code> and <code>LC_MONETARY</code> categories, there is no way to query any specific configuration.</p>\n\n<p>Also, there is no standard way at all to set a single configuration. All you can do is use <code>setlocale</code> to configure an entire category, using a library-dependent and non-standardised locale name (which is just a character string). More precisely, two locale names are standardised:</p>\n\n<ul>\n<li><p>The C standard defines the locale name <code>C</code>.</p></li>\n<li><p>Posix defines the locale name <code>POSIX</code>. However, Posix specifies that the corresponding locale shall be identical to the locale named <code>C</code>.</p></li>\n</ul>\n\n<p>The details for locale-naming are (or should be) detailed in the <code>locale</code> documentation for the environment you're working in, but normally a locale-aware program will never call <code>setlocale</code> with a string constant other than the standard names, or the empty string. (I'll get to that in a minute.)</p>\n\n<p>The <code>setlocale</code> interface allows the program to set an individual locale category, or to set all locale categories to the same locale name. It also returns a string which can be used to return to a previously configured locale category (or complete configuration).</p>\n\n<p>The category names shown in the list of categories above are macros defined in <code>&lt;locale.h&gt;</code>. An additional macro, <code>LC_ALL</code>, is also defined by that header file: <code>LC_ALL</code>. One of these macros must be used as the first argument to <code>setlocale</code>.</p>\n\n<p>The C and Posix standards both require that the initial locale setting on program startup is the <code>C</code> locale. Many aspects of the <code>C</code> locale are standardised (and somewhat more aspects of the <code>Posix</code> locale are standardised). This standardisation allows a programmer to predict how numeric conversions will work, for example.</p>\n\n<p>But it is often the case that a programmer will want to interact with the program's user with that user's own locale preferences. It is obviously not desirable that every single program have its own idiosyncratic mechanism for determining what the user's locale preferences are, so the standard library provides a mechanism for setting the locale (or individual locale categories) to whatever the default locale is configured to: calling <code>setlocale</code> with the empty string (<code>\"\"</code>) as a locale name. The C standard does not specify any particular mechanism for configuring this information; it merely assumes that one exists.</p>\n\n<p>(Side note: Calling <code>setlocale</code> with an empty string as locale name is <em>not</em> the same as calling <code>setlocale</code> with <code>NULL</code> as locale name. <code>NULL</code> tells <code>setlocale</code> to not change any locale setting, but it will still return the string associated with the current locale. This avoids the need for a <code>getlocale</code> interface.)</p>\n\n<p>Posix does specify a mechanism for configuring user preferences, and it also insists that (most) standardised command-line utilities operate in the default locale. That mechanism uses environment variables whose names correspond to the <code>setlocale</code> category macros.</p>\n\n<p>On a Posix implementation, when the program calls <code>setlocale(LC_X, \"\");</code> the library will proceed to examine the current environment:</p>\n\n<ol>\n<li><p>First, it looks for the environment variable <code>LC_ALL</code>. If that is defined and has a non-empty value, it is used to define the locale.</p></li>\n<li><p>Otherwise, if the first argument to <code>setlocale</code> was not <code>LC_ALL</code> it looks for the environment variable whose name is the same as that argument. If that is defined and has a non-empty value, it is used to define the locale.</p></li>\n<li><p>Otherwise, if the environment variable <code>LANG</code> is defined and has a non-empty value, it is used (in some implementation dependent way) to construct a locale name. (<code>LANG</code> is supposed to indicate the user's language, which is an important part of their locale preferences.)</p></li>\n<li><p>Finally, some system-wide default is used.</p></li>\n</ol>\n\n<p>Environment variables are generally initialised by the <code>login</code> program (or GUI equivalent) on the basis of system configuration files. (The precise mechanism varies from distribution to distribution and documentation is often difficult to find.)</p>\n\n<p>As mentioned, almost all standard shell utilities are required by Posix to do the equivalent of <code>setlocale(LC_ALL, \"\");</code> in order to operate in the user's configured locale. Every utility's manpage (or other documentation) should specify whether it does this or not, but it's reasonable to assume that it does unless there is some information to the contrary.</p>\n\n<p>Also, many (but not all) standard library string functions are locale-aware. Library interfaces which are definitely not locale-aware include <code>isdigit</code> and <code>isxdigit</code>, which always respond on the basis of the <code>C</code> locale, and <code>strcmp</code>, which compares strings in the same way as <code>memcmp</code>, using the <code>char</code> value (interpreted as an <code>unsigned int</code>) to determine collation order. (<code>strcoll</code> is locale-aware, if you want to do comparison according to <code>LC_COLLATE</code>.) And the character encodings used for wide and multibyte characters are controlled (in some unspecified way) by the <code>LC_CTYPE</code> category.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 4, "last_activity_date": 1527740533, "last_edit_date": 1527740533, "creation_date": 1527701511, "answer_id": 50610499, "question_id": 50606668, "link": "https://stackoverflow.com/questions/50606668/which-components-use-the-locale-variables/50610499#50610499", "title": "Which components use the locale variables?", "body": "<p>Many programs set the locale, and use it at least for internationalization.  Some specific examples:</p>\n\n<pre><code>LANG=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This is the locale for any category you didn\u2019t specifically set to something else.  It allows the system to add new locale variables in a backward-compatible way.</p>\n\n<pre><code>LC_COLLATE=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This selects which language\u2019s sorting order is used on strings.  For example, <em>Ch</em> is considered a letter in Spanish and would come after <em>Cz</em>.  One C library function that uses it is <code>strcoll()</code>, and POSIX commands that do include <code>ls</code> (when you sort files by name) and <code>sort</code>.</p>\n\n<pre><code>LC_CTYPE=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This determines the current character encoding.  In C11, you can set this and then use wide-character input and output, such as <code>wprintf()</code>.  The library will transparently convert between wide characters and the character set used by the outside world.  This still doesn\u2019t quite work on Windows, unless you do some extra magic, but elsewhere, UTF-8 has become the standard.  An increasing number of programs, such as clang (as of version 7), no longer support anything but UTF-8.</p>\n\n<pre><code>LC_MESSAGES=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This determines what language and character set you see localized messages in.  In C on Unix/Linux, these would typically be loaded from a <code>.po</code> file by the <code>gettext</code> library.</p>\n\n<pre><code>LC_MONETARY=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This affects how <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strfmon.html\" rel=\"nofollow noreferrer\"><code>strfmon()</code></a> formats monetary quantities.</p>\n\n<pre><code>LC_NUMERIC=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This determines the <a href=\"https://www.youtube.com/watch?v=l4bmZ1gRqCc\" rel=\"nofollow noreferrer\">formatting of numbers</a> that aren\u2019t amounts of money.</p>\n\n<pre><code>LC_TIME=\"en_GB.UTF-8\"\n</code></pre>\n\n<p>This affects the formatting of time.  Try <code>LC_TIME=fr_FR.UTF-8 date</code> in the shell to see an example.  (Or use <code>locale -a | grep UTF</code> to select some suitably-exotic locale.)  Also a good test of whether your timezone and <code>ntpd</code> are working properly.</p>\n\n<pre><code>LC_ALL=\n</code></pre>\n\n<p>Use <code>LANG</code> instead of this.  It sets every locale category at once, but it overrides the values in all the other locale variables.  It exists for backward compatibility.</p>\n\n<p>For example, I use <code>LANG=en_US.utf8</code> on my Linux box, but I override <code>LC_TIME=en_GB.utf8</code> to get 24-hour time in English.  This would not be possible to do if <code>LC_ALL</code> were set.</p>\n\n<p><code>LANG</code> also allows your defaults to carry over into whatever other locale information your system supports, such as <code>LC_ADDRESS</code>, <code>LC_IDENTIFICATION</code>, <code>LC_RESPONSE</code>, <code>LC_MEASUREMENT</code> and <code>LC_TELEPHONE</code>.</p>\n"}], "owner": {"reputation": 625, "user_id": 7978647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae0f076bd86bd8d9e89b1ed3fa0a32a?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7978647/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 3, "answer_count": 3, "score": 13, "last_activity_date": 1527740533, "creation_date": 1527688848, "last_edit_date": 1527730974, "question_id": 50606668, "link": "https://stackoverflow.com/questions/50606668/which-components-use-the-locale-variables", "title": "Which components use the locale variables?", "body": "<p>I have read that every process has a set of locale variables associated with it. For example, these are the locale variables associated with the <code>bash</code> process on my system:</p>\n\n<pre><code>$ locale\nLANG=\"en_GB.UTF-8\"\nLC_COLLATE=\"en_GB.UTF-8\"\nLC_CTYPE=\"en_GB.UTF-8\"\nLC_MESSAGES=\"en_GB.UTF-8\"\nLC_MONETARY=\"en_GB.UTF-8\"\nLC_NUMERIC=\"en_GB.UTF-8\"\nLC_TIME=\"en_GB.UTF-8\"\nLC_ALL=\n</code></pre>\n\n<p>I want to know who actually uses these locale variables.</p>\n\n<p>Do the C standard functions (for example: <code>fwrite()</code>) and the Linux system calls use them? Does the behavior of some C standard functions or some Linux system call differ depending on the value of some locale variable?</p>\n\n<p>Or is it only certain programs that can use these locale variables? For example, I can write a program that will display messages to the user in a different language depending on the value of the <code>LANG</code> locale variable.</p>\n"}, {"tags": ["c", "segmentation-fault", "compression"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527687333, "post_id": 50606069, "comment_id": 88221662, "body": "Now is the perfect time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>. Specifically how to use a debugger to catch the crash &quot;in action&quot; and locate when and where it happens in your program and what the values of all variables might be at that point."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527687411, "post_id": 50606069, "comment_id": 88221721, "body": "Also note that the <code>&quot;t&quot;</code> in <code>&quot;rt&quot;</code> and <code>&quot;wt&quot;</code> is Microsoft-specific extension, it&#39;s not standard."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1527687467, "post_id": 50606069, "comment_id": 88221779, "body": "Lastly, what happens if you can&#39;t open the output file? Or, indeed, can&#39;t open the <i>input</i> file?"}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "edited": false, "score": 0, "creation_date": 1527687478, "post_id": 50606069, "comment_id": 88221794, "body": "Ohh ok, let me try to get rid of that and see how it goes."}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "edited": false, "score": 0, "creation_date": 1527687558, "post_id": 50606069, "comment_id": 88221863, "body": "It&#39;s meant to print out &#39;Error reading file&#39; when text file doesn&#39;t exist&#39;, I am going to manually create a text file."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527687619, "post_id": 50606069, "comment_id": 88221914, "body": "Yes if the input file can&#39;t be opened you print an error message. And then what? Should you really continue with the program as if nothing happened?"}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527687666, "post_id": 50606069, "comment_id": 88221950, "body": "The program should break, I forgot to insert a exit statement after fp==NULL"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1527687746, "post_id": 50606069, "comment_id": 88222021, "body": "You should also check that <code>fptr != NULL</code>."}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527687801, "post_id": 50606069, "comment_id": 88222066, "body": "Ok thanks for the help @Someprogrammerdude in fixing my programming logic now it executes without segmentation fault."}, {"owner": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1527688108, "post_id": 50606069, "comment_id": 88222316, "body": "<code>count[n]+=1;</code> what is <code>count[n]</code> here ?    what if <code>n</code> value read from file is <code>1000</code> then it would be like accessing <code>count[1000]</code> but you declared only 256 as size of <code>count</code> array. probably you want to recheck this <code>count[n]+=1</code> statement."}, {"owner": {"reputation": 411, "user_id": 2355561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c3b43b98852d663878542ad3ff4bff?s=128&d=identicon&r=PG", "display_name": "Austin Stephens", "link": "https://stackoverflow.com/users/2355561/austin-stephens"}, "edited": false, "score": 0, "creation_date": 1527688492, "post_id": 50606069, "comment_id": 88222586, "body": "I think the idea is to use the decimal value of ascii characters, which should be fine with a size of 256, no? And then they&#39;re printing that to a file if count[i] &gt; 0."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 11619, "user_id": 5346306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BsACH.jpg?s=128&g=1", "display_name": "Achal", "link": "https://stackoverflow.com/users/5346306/achal"}, "edited": false, "score": 0, "creation_date": 1527688701, "post_id": 50606069, "comment_id": 88222759, "body": "@achal <code>n</code> is a single character pulled from <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>fgetc</code></a> and loaded into an <code>int</code>. It will be in <code>[0..255]</code>, unless EOF is hit (which the OP checks for and breaks accordingly). In short, that part of this is ok."}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "edited": false, "score": 0, "creation_date": 1527690411, "post_id": 50606069, "comment_id": 88224050, "body": "Hello, my aim is to get RLE Compression working. This is the characters in the input file &quot;AAAAAA333333FFFFF22222&quot; but then this is the compressed output: &quot; 2536A6F5&quot;, the output should be &quot;6A635F22&quot; I think I need to implement more condition checking, can anybody give me hints what I need to add in my if statement so it prints it out correctly?"}, {"owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "edited": false, "score": 0, "creation_date": 1527690933, "post_id": 50606069, "comment_id": 88224430, "body": "Yep, sorry typo"}], "owner": {"reputation": 63, "user_id": 7983677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f9556c1df744181df8a17425dd9e33?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7983677/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527690986, "creation_date": 1527687162, "last_edit_date": 1527690986, "question_id": 50606069, "link": "https://stackoverflow.com/questions/50606069/segmentation-core-fault-dumped-in-c-fixed-rle-compression", "title": "Segmentation Core Fault Dumped in C - Fixed, RLE Compression", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main (void)\n\n{\n    int count[256] = { 0 };\n    int n;\n    int p;\n    FILE * fp;\n    FILE * fptr;\n    fp = fopen(\"financials.txt\", \"rt\");\n    fptr = fopen(\"compressed_financials.txt\", \"wt\");\n\nif (fp == NULL)\n{\n    printf(\"Error file doesn't exist\");\n\n}   \n\nwhile((n=fgetc(fp)))\n{\n    if(n == EOF)\n    {\n        break;\n    }   \n    else\n    count[n]+=1;\n}\n\n\nfor (p=0; p &lt; 256; p++)\n{\n    if(count[p] &gt; 0)\n    {\n        fprintf(fptr, \"%c%d\", p, count[p]);\n    }\n}\n\nfclose(fp);\nfclose(fptr);\nreturn 0;\n}\n</code></pre>\n\n<p>Hello, when I am executing the program I get a Segementation fault (core dumped). What have I done incorrectly in my programming logic that causes this? From what I can understand, I might have used the pointers incorrectly which causes to access memory that doesn't exist. I am trying to implement RLE compression BTW.</p>\n\n<p>I managed to get it to work now, RLE compression is half working but outputting the wrong structure. This is the characters in the input file \"AAAAAA333333FFFFF22222\" but then this is the compressed output: \" 2536A6F5\", the output should be \"6A635F52\" I think I need to implement more condition checking, can anybody give me hints what I need to add in my if statement so it prints it out correctly?</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527689945, "post_id": 50605952, "comment_id": 88223699, "body": "@ThomasJager A snippet taken from the IOCCC is a horrible duplicate. It is only borderline on-topic here to begin with."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527687663, "post_id": 50606044, "comment_id": 88221948, "body": "I understand that <code>gcc -E</code> might show different output than what is actually sent to compiler. However, if you look at the program I posted, it seems <code>A</code> wasn&#39;t replaced by <code>--4</code> (there would be a compiler error) but by something else such as <code>- -4</code>. Why is it the latter and not the former?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527687804, "post_id": 50606044, "comment_id": 88222076, "body": "@bjorn93 It&#39;s the latter because the mighty standard sayeth &quot;there shall be white-space.&quot; :) It&#39;s all in the answer."}, {"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527688705, "post_id": 50606044, "comment_id": 88222765, "body": "Doesn&#39;t that part of the standard concern the definition of object-like macros? In other words, such macros should be defined as <code>#define identifier replacement_list</code> with space between identifier and replacement_list. This is not the white space I&#39;m talking about."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527689128, "post_id": 50606044, "comment_id": 88223080, "body": "@bjorn93 My bad. I&#39;ll see if I can find the proper paragraph."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1527697731, "post_id": 50606044, "comment_id": 88228736, "body": "Inserting the space is proper because it properly represents the result of preprocessing. If <code>gcc -E</code> produced <code>--B</code>, then compiling that would produce the tokens <code>--</code> and <code>B</code>. That is different than the true result of the original preprocessing, which is the tokens <code>-</code>, <code>-</code>, and <code>B</code>. So the space is needed to properly portray the result of preprocessing."}, {"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1527702418, "post_id": 50606044, "comment_id": 88231253, "body": "@EricPostpischil Is tokenization unambiguously (for the most part) specified in the C standards? How do we guarantee this is the correct way to separate into tokens?"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 1, "creation_date": 1527703577, "post_id": 50606044, "comment_id": 88231837, "body": "@bjorn93 Yes. Tokenization is, for the most part, well specified in the C standards. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4p3\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.4p3</a> Whitespace, unless inside a string or character literal, cannot be part of a token and is unambiguously a way to separate tokens. But realize that the preprocessor will normally turn segments of text that qualify as tokens into integers (normally also called tokens) which it will pass directly to the compiler (this implementation isn&#39;t standard mandated, it&#39;s just usual practice). Thus <code>--</code> will corespond to one integer and <code>-</code> will correspond to another."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527703587, "post_id": 50606044, "comment_id": 88231840, "body": "@bjorn93 When pasting the integer for &#39;-&#39; next to another, the preprocessor will simply pass 2 integers to the compiler proper (instead of 1 which it would pass for <code>--</code>). It&#39;s only when the preprocessor is asked to generate text that it will need to deal with the space insertion part (at least if it wants to make your life easier)."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 3, "last_activity_date": 1527697651, "last_edit_date": 1527697651, "creation_date": 1527687094, "answer_id": 50606044, "question_id": 50605952, "link": "https://stackoverflow.com/questions/50605952/preprocessing-tokens-vs/50606044#50606044", "title": "Preprocessing Tokens: &#39;- -&#39; vs. &#39;--&#39;", "body": "<p>The preprocessor works on tokens, not strings. Macro substitution without <code>##</code> cannot create a new token and so, if the preprocessor output goes to a textfile as opposed to going straight into the compiler, preprocessors insert whitespace so that the outputted textfile can be used as C input again without changed semantics.</p>\n\n<p>The space insertion doesn't seem to be in the standard, but then the standard describes the preprocessor as working on tokens and as feeding its output to the compiler proper, not a textfile.</p>\n"}, {"comments": [{"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527701318, "post_id": 50609861, "comment_id": 88230623, "body": "So, the space in the output is needed merely to separate the tokens. Why does the <code>-traditional-cpp</code> option produce <code>--B</code> though? Is the preprocessor not using tokens in that case?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 1, "creation_date": 1527724864, "post_id": 50609861, "comment_id": 88239545, "body": "Older C compilers did not treat this border case correctly. Depending on whether the C preprocessor was a separate utility with its output piped to the compiler or built into the compiler, this behavior could be used to paste tokens together. A non-portable side effect of the implementation."}, {"owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 0, "creation_date": 1527729224, "post_id": 50609861, "comment_id": 88240551, "body": "So is the example we&#39;re talking about (in your post) the way preprocessing should be done according to the standards? That is, it&#39;s not compiler-dependent but follows from the standards?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "edited": false, "score": 1, "creation_date": 1527772392, "post_id": 50609861, "comment_id": 88260307, "body": "@bjorn93: Yes, this is correct. What I described in my answer follows from the C Standard. The Standard is a lot more precise and covers some other intricate corner cases... Fully understanding the C preprocessor is a life time commitment: I wrote several implementations that pass most of the validation tests I could find, and I still learn new tricks regularly. For example, try and explain why <code>printf(&quot;%x\\n&quot;, 0x2e+1);</code> produces a syntax error instead of printing <code>2f</code>?"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1527698992, "creation_date": 1527698992, "answer_id": 50609861, "question_id": 50605952, "link": "https://stackoverflow.com/questions/50605952/preprocessing-tokens-vs/50609861#50609861", "title": "Preprocessing Tokens: &#39;- -&#39; vs. &#39;--&#39;", "body": "<p>Focusing on the white space insertion is missing the issue.</p>\n\n<p>The macro <code>A</code> is defined as the sequence of preprocessing tokens <code>-</code> and <code>B</code>.</p>\n\n<p>When the compiler parses a fragment of source code <code>-A</code>, it produces 2 tokens <code>-</code> and <code>A</code>. <code>A</code> is expanded as part of the preprocessing phase and the tokens are converted to C tokens: <code>-</code>, <code>-</code> and <code>B</code>.</p>\n\n<p>If <code>B</code> is itself defined as a macro (<code>#define B 4</code>), <code>A</code> would expand to <code>-</code>, <code>-</code>, <code>4</code>, which is parsed as an expression evaluating to the value <code>4</code> with type <code>int</code>.</p>\n\n<p><code>gcc -E</code> produces text. For the text to convert back to the same sequence of tokens as the original source code, a space needs to be inserted between the two <code>-</code> tokens to prevent <code>--</code> to be parsed as a single token.</p>\n"}], "owner": {"reputation": 173, "user_id": 9870439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/107e581e3a67d78028852524ab6cd42d?s=128&d=identicon&r=PG&f=1", "display_name": "bjorn93", "link": "https://stackoverflow.com/users/9870439/bjorn93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 50609861, "answer_count": 2, "score": 4, "last_activity_date": 1527698992, "creation_date": 1527686839, "last_edit_date": 1527693536, "question_id": 50605952, "link": "https://stackoverflow.com/questions/50605952/preprocessing-tokens-vs", "title": "Preprocessing Tokens: &#39;- -&#39; vs. &#39;--&#39;", "body": "<p>Why does the (GCC) preprocessor create two tokens <code>- -B</code> instead of a single one <code>--B</code> in the following example? What is the logic that the former should be correct and not the latter?</p>\n\n<pre><code>#define A -B\n-A\n</code></pre>\n\n<p>Output according to <code>gcc -E</code>:</p>\n\n<pre><code>- -B\n</code></pre>\n\n<p>After all, <code>--</code> is a valid operator, so theoretically a valid token as well.</p>\n\n<p>Is this specific to the GCC preprocessor or does this follow from the C standards?</p>\n"}, {"tags": ["c", "binary-tree"], "comments": [{"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1527686116, "post_id": 50605643, "comment_id": 88220754, "body": "Why don&#39;t you work on _root but you declare another variable ?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1527686131, "post_id": 50605643, "comment_id": 88220766, "body": "Assuming that the type of e.g. <code>p-&gt;left</code> is <code>tree*</code> (I have to assume since you don&#39;t provide a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>), then what do you think <code>&amp;p-&gt;left</code> will give you?"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527687546, "post_id": 50605643, "comment_id": 88221847, "body": "Move parts of the code to a separate file and provide a minimal, complete and verifiable example and post it here."}, {"owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "reply_to_user": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1527687984, "post_id": 50605643, "comment_id": 88222217, "body": "@Hearner I work with dev c++ program, it doesn&#39;t recognize the element with *_root"}, {"owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527688022, "post_id": 50605643, "comment_id": 88222245, "body": "@Someprogrammerdude programmer dude tree is a type that already points to a node, so what&#39;s the meaning of assuming that p-&gt;left is of type tree*, even though, &amp;p-&gt;left still gives a error on this case since it is not a pointer to a node bout a pointer  points to a pointer that points to a node."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1527688092, "post_id": 50605643, "comment_id": 88222306, "body": "Well how could we know? That&#39;s why <a href=\"http://idownvotedbecau.se/nomcve/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nomcve</a>, and also <a href=\"http://idownvotedbecau.se/nodebugging/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/nodebugging</a>"}, {"owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "edited": false, "score": 0, "creation_date": 1527689588, "post_id": 50605643, "comment_id": 88223432, "body": "here is a part of the code: <a href=\"https://1drv.ms/u/s!AkEail-kUdTkl21C-yZ0-bpSPm5s\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1527690173, "post_id": 50605643, "comment_id": 88223851, "body": "Crash seems to be triggered because you are using freed memory. Without a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> hard to say."}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "edited": false, "score": 0, "creation_date": 1527691031, "post_id": 50607238, "comment_id": 88224504, "body": "@AugustKarlstorm thanks, I thought the last instruction is done automatically but seems I have a misunderstanding of how free() works. thanks again :)"}], "tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": true, "score": 1, "last_activity_date": 1527691115, "last_edit_date": 1527691115, "creation_date": 1527690456, "answer_id": 50607238, "question_id": 50605643, "link": "https://stackoverflow.com/questions/50605643/c-function-to-erase-all-the-binary-tree-elements/50607238#50607238", "title": "c function to erase all the binary tree elements", "body": "<p>You are not setting <code>*_root</code> to NULL. Since the function calls itself recursively, only the first actual parameter will be the root node, so I would instead simply name the parameter <em>t</em>. Also, the left/right null checks are not needed. Try this:</p>\n\n<pre><code>void free_tree(tree *t) {\n    tree p = *t;\n    if (p != NULL) {\n        free_tree(&amp;p-&gt;left);\n        free_tree(&amp;p-&gt;right);\n        free(p);\n        *t = NULL;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 9063787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GtWoC.jpg?s=128&g=1", "display_name": "Hocine Abdellatif", "link": "https://stackoverflow.com/users/9063787/hocine-abdellatif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50607238, "answer_count": 1, "score": -3, "last_activity_date": 1527691115, "creation_date": 1527685953, "question_id": 50605643, "link": "https://stackoverflow.com/questions/50605643/c-function-to-erase-all-the-binary-tree-elements", "title": "c function to erase all the binary tree elements", "body": "<p>a C-lang function that erase all the elements of the tree, it doesn't crush when I call it but the result when I'm trying to display the tree or call any function giving it the (_root) as a parameter, it crushes</p>\n\n<pre><code>void free_tree(tree *_root) {//testing, not working\n    tree p= *_root;\n    if (p) {\n        if (p-&gt;left) free_tree(&amp;p-&gt;left);\n        if (p-&gt;right) free_tree(&amp;p-&gt;right);\n        free(p);\n    }\n}\n</code></pre>\n\n<p>I verified any other thing outside the function that can cause the bug but seems everything works great, thanks anyone can answer</p>\n"}, {"tags": ["c", "multiprocessing", "pipe", "fork"], "comments": [{"owner": {"reputation": 1140, "user_id": 4892907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aE5LujU7Dz0/AAAAAAAAAAI/AAAAAAAAAfA/umYfIt-WSuI/photo.jpg?sz=128", "display_name": "xxxvodnikxxx", "link": "https://stackoverflow.com/users/4892907/xxxvodnikxxx"}, "edited": false, "score": 0, "creation_date": 1527687924, "post_id": 50605526, "comment_id": 88222174, "body": "Maybe you can also try to print <code>someinput</code> value, just got an idea, if there are not some chars at <code>stdin</code>.."}, {"owner": {"reputation": 475, "user_id": 6632592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9385343c8b8b01b484af9c19f7cb4e02?s=128&d=identicon&r=PG&f=1", "display_name": "Kareem Aboughazala", "link": "https://stackoverflow.com/users/6632592/kareem-aboughazala"}, "reply_to_user": {"reputation": 1140, "user_id": 4892907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-aE5LujU7Dz0/AAAAAAAAAAI/AAAAAAAAAfA/umYfIt-WSuI/photo.jpg?sz=128", "display_name": "xxxvodnikxxx", "link": "https://stackoverflow.com/users/4892907/xxxvodnikxxx"}, "edited": false, "score": 0, "creation_date": 1527716705, "post_id": 50605526, "comment_id": 88237396, "body": "<code>someinput</code> contains the original line inputted to the shell using the first fgets call."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527741954, "post_id": 50605526, "comment_id": 88243369, "body": "You shouldn&#39;t wait in the parent until you&#39;ve launched all commands in the pipeline.  You wait on each command to complete before starting the next, but if the first process fills its output pipe buffer, it will block indefinitely, so your main program will never get to launch the second.  Granted, simple programs with minimal data flows won&#39;t have problems, but in general, that&#39;s a flawed implementation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527742003, "post_id": 50605526, "comment_id": 88243379, "body": "You should explicitly exit if <code>execve()</code> fails.  As it stands, the child process continues with the rest of the loop, leading to chaos."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527742197, "post_id": 50605526, "comment_id": 88243438, "body": "You aren&#39;t closing enough file descriptors in the children. <b>Rule of thumb</b>: If you <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/dup2.html\" rel=\"nofollow noreferrer\"><code>dup2()</code></a> one end of a pipe to standard input or standard output, close both of the original file descriptors from <code>pipe()</code> as soon as possible. In particular, that means before using any of the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/execvp.html\" rel=\"nofollow noreferrer\"><code>exec*()</code></a> family of functions. The rule also applies with either <code>dup()</code> or <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fcntl.html\" rel=\"nofollow noreferrer\"><code>fcntl()</code></a> with <code>F_DUPFD</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527742264, "post_id": 50605526, "comment_id": 88243454, "body": "The parent also needs to close all the pipes after it has launched all the children (and before it waits for any of them)."}], "owner": {"reputation": 475, "user_id": 6632592, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9385343c8b8b01b484af9c19f7cb4e02?s=128&d=identicon&r=PG&f=1", "display_name": "Kareem Aboughazala", "link": "https://stackoverflow.com/users/6632592/kareem-aboughazala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1560682621, "creation_date": 1527685606, "last_edit_date": 1560682621, "question_id": 50605526, "link": "https://stackoverflow.com/questions/50605526/custom-shell-terminating-after-reading-one-command", "title": "custom shell terminating after reading one command", "body": "<p>I am trying to write a custom shell in C that supports multiple pipes using <code>fork</code>, <code>dup2</code> and <code>pipe</code>. My approach is for <code>c1 | c2 | c3</code> create a 2 x 2 matrix to store two pipes, fork three child processes sequentially, call <code>dup2</code> to duplicate <code>stdin</code> and <code>stdout</code> to the correct pipe then call <code>exec</code>. </p>\n\n<p>The shell works fine for the following commands: <code>\"echo foo\"</code>, <code>\"ls | grep something | wc\"</code>. But for some reason when I execute a line containing only one pipe like for example <code>\"ls | grep something\"</code>, the shell executes this command as expected but exits without waiting to read more lines. I spent hours trying to figure out why it exists when given a line with one pipe but works fine with more than one pipe but had no luck. </p>\n\n<p>Here is the code that creates the child processes and runs the commands:</p>\n\n<pre><code>int main()\n{\n    char input_line[1000];\n    size_t size;\n    size_t chars;\n\n    while(fgets(input_line, sizeof(input_line), stdin))\n    {\n        input_line[strcspn(input_line, \"\\n\")] = 0;\n        struct PARSE_INFO* parse_info = initialize_parseInfo();\n        Parse(input_line, parse_info);\n        int num_commands = parse_info-&gt;num_commands;\n        int num_pipes = parse_info-&gt;num_pipes;\n        int pipes[num_pipes][2];\n        bool piping = num_pipes &gt; 0;\n\n        // Piping the pipes\n        for(int i = 0; i &lt; num_pipes; i++)\n            pipe(pipes[i]);\n\n        int i;\n        for(i = 0; i &lt; num_commands; i++)\n        {\n            struct COMMAND* command = (parse_info-&gt;commands)[i];\n            int num_args = command-&gt;argnum;\n\n            char* newargv[num_args + 2];\n            create_argv(command, newargv, \"/usr/bin\");  \n\n            int pid = fork();\n\n            if(pid == 0) // Child\n            {\n                char* newenviron[] = { NULL };       \n\n                if(piping)\n                {\n                    if(i &lt; num_commands - 1) // Not at end of pipe so write to next pipe\n                    {\n                        dup2(pipes[i][1], STDOUT_FILENO);\n                    }\n                    if(i &gt; 0)                       // Not at beginning of pipe so read from previous pipe\n                    {\n                        dup2(pipes[i - 1][0], STDIN_FILENO);\n                        close(pipes[i -1][0]);\n                    }\n                }\n                execve(newargv[0], newargv, newenviron);\n                perror(\"execve\");\n            }\n            else  // Parent\n            {\n                int status = 0;\n                wait(&amp;status);\n                close(pipes[i][1]);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I tested the functions called here independently and they seem to work fine so I chose not to include them to reduce clutter. I suspect that I am not closing the pipes correctly. What's puzzling me is that, if I understand this correctly, calling <code>dup2</code> in a child process should only modify the file descriptors in that process and not affect the parent process, I am not sure why it's causing <code>stdin</code> to close in the parent process. </p>\n\n<p>During my debugging efforts, I tried reading some input from <code>stdin</code> at the end of the while loop by adding this code after the else block:</p>\n\n<pre><code>char someinput[256];\nfgets(someinput, sizeof(someinput), stdin);\nprintf(\"End of loop input: %s\\n\");\n</code></pre>\n\n<p>The program still terminated and did not wait to read any input. Any help would be really appreciated! </p>\n"}, {"tags": ["python", "c", "cython", "cythonize"], "comments": [{"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 3, "creation_date": 1527680311, "post_id": 50603694, "comment_id": 88216543, "body": "if it is c the name would be <code>math.h</code>, <code>cmath</code> is the c++ notation"}, {"owner": {"reputation": 4837, "user_id": 9769953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f14a586643a20c8d68010f7a329f5a04?s=128&d=identicon&r=PG", "display_name": "0 0", "link": "https://stackoverflow.com/users/9769953/0-0"}, "edited": false, "score": 1, "creation_date": 1527680449, "post_id": 50603694, "comment_id": 88216617, "body": "Also, use a C compiler, e.g. <code>gcc</code>, instead of a C++ compiler (<code>g++</code> here)."}, {"owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "edited": false, "score": 0, "creation_date": 1527685041, "post_id": 50603694, "comment_id": 88219962, "body": "I tried adding the flag &quot;language=&#39;c++&#39; to cythonize, and # distutils: language=c++ to the beginning of every file, but &lt;cmath&gt; still does not work."}, {"owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "edited": false, "score": 0, "creation_date": 1527685203, "post_id": 50603694, "comment_id": 88220085, "body": "well ok I also had to change the extension to .cpp, not .c, and now it works"}], "answers": [{"tags": [], "owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "is_accepted": false, "score": 0, "last_activity_date": 1527770437, "creation_date": 1527770437, "answer_id": 50624573, "question_id": 50603694, "link": "https://stackoverflow.com/questions/50603694/can-not-find-libraries-in-c-code/50624573#50624573", "title": "Can not find libraries in C code", "body": "<p>The definition should be against the header, not the implementation:</p>\n\n<pre><code>cdef extern from \"cfile.h\":\n    pass\n</code></pre>\n\n<p>If using C++ libraries, must add <code>language='c++'</code> directive to setuptools/cythonize.</p>\n\n<pre><code>cythonize(&lt;..&gt;,\n          language=\"c++\",\n      )\n</code></pre>\n\n<p>See also <a href=\"https://cython.readthedocs.io/en/latest/src/userguide/wrapping_CPlusPlus.html\" rel=\"nofollow noreferrer\">docs</a>.</p>\n"}], "owner": {"reputation": 1002, "user_id": 886878, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d3b4ee9bc3b69059b76a8dd3b323d237?s=128&d=identicon&r=PG", "display_name": "Jonathan Lindgren", "link": "https://stackoverflow.com/users/886878/jonathan-lindgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1531052866, "creation_date": 1527680250, "last_edit_date": 1531052866, "question_id": 50603694, "link": "https://stackoverflow.com/questions/50603694/can-not-find-libraries-in-c-code", "title": "Can not find libraries in C code", "body": "<p>I am trying to compile a module using cython, but the compiler can not find include libraries in an external c file (I use <code>cmath</code> as example, but other libraries that I want such as <code>cstdio</code>, <code>cstdint</code>, <code>cstring</code> have the same issue)</p>\n\n<p>A minimal example is composed of the following 4 simple files:</p>\n\n<p>cfile.c:</p>\n\n<pre><code>#include &lt;cmath&gt;\n</code></pre>\n\n<p>test_pxd.pxd:</p>\n\n<pre><code>cdef extern from \"cfile.c\":\n    pass\n</code></pre>\n\n<p>test.pyx:</p>\n\n<pre><code>cimport test_pxd\n</code></pre>\n\n<p>setup.py:</p>\n\n<pre><code>from distutils.core import Extension, setup\nfrom Cython.Build import cythonize\n\nsources = ['test.pyx']\n\nextension = [Extension('test',sources)]\n\nsetup(ext_modules=cythonize(extension,force=True))\n</code></pre>\n\n<p>If I run the <code>setup.py</code> with:</p>\n\n<pre><code> python3 setup.py build_ext --inplace\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>cfile.c:1:17: fatal error: cmath: No such file or directory</p>\n</blockquote>\n\n<p>It should be noted that just compiling the c file directly, eg with <code>g++ -c cfile.c</code>, does not require any extra linking for the compiler to find these libraries.</p>\n\n<p>How can I make the compiler in cython find the <code>cmath</code> (and other, such as <code>cstdio</code>, <code>cstdint</code>, <code>cstring</code>) libraries in an external c file?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 4, "creation_date": 1527680404, "post_id": 50603683, "comment_id": 88216597, "body": "<code>int**</code> would be a staggered-array instead of a multi-dimensional array. Your <code>calloc</code> call allocates an array-of-pointers but you don&#39;t allocate those sub-arrays. Note that staggered-arrays in C are a bad idea unless you really need a &quot;non-rectangular-sized&quot; buffer because of increased memory fragmentation risk and needing to <code>free</code> all of the child arrays. Returning <code>int**</code> by itself without indicating the length of the buffer means that consumers won&#39;t be able to <code>free</code> it properly."}, {"owner": {"reputation": 1390, "user_id": 6804762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b41e265dcfe306ac9138ed4bca68c0ce?s=128&d=identicon&r=PG", "display_name": "xoxel", "link": "https://stackoverflow.com/users/6804762/xoxel"}, "edited": false, "score": 0, "creation_date": 1527680470, "post_id": 50603683, "comment_id": 88216636, "body": "That has been a while since i&#39;ve done som C but, i feel like you are messing up your **ptr, you are allowing him 4 pointers on int <code>int*</code> but those are not allocated themselves to receive ints, you also need to allcoate space for wichever number of ints you need in those pointers."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1527680996, "post_id": 50603683, "comment_id": 88217029, "body": "See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "reply_to_user": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527707842, "post_id": 50603683, "comment_id": 88233865, "body": "@AugustKarlstrom If I create 2d array just by initializing, I can not return it, because is is considered as local variable. And also, int **solve() is given to me, I can not change it. If you meant something different, please try to share example code to let me better understand. Thank you :)"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1527712405, "post_id": 50603683, "comment_id": 88235814, "body": "@victory Never mind, I was wrong. In C you cannot define a function which takes a two-dimensional array of any size (in both dimensions)."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1527681052, "post_id": 50603816, "comment_id": 88217069, "body": "This is not a 2D array. See <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>."}, {"owner": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "edited": false, "score": 0, "creation_date": 1527682581, "post_id": 50603816, "comment_id": 88218164, "body": "Solved the issue. Could you also clarify, why does r=3, and c=4? How should it be, if I used 4x4 2D array?"}, {"owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "edited": false, "score": 1, "creation_date": 1527700042, "post_id": 50603816, "comment_id": 88229895, "body": "r and c are row and column :p"}], "tags": [], "owner": {"reputation": 185, "user_id": 9602261, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Eugene Mart", "link": "https://stackoverflow.com/users/9602261/eugene-mart"}, "is_accepted": true, "score": 1, "last_activity_date": 1527680614, "creation_date": 1527680614, "answer_id": 50603816, "question_id": 50603683, "link": "https://stackoverflow.com/questions/50603683/return-of-int-function-in-c/50603816#50603816", "title": "Return of int** function in c", "body": "<p>I would add a comment under your question, but I lack reputation.</p>\n\n<pre><code>int r = 3, c = 4, i, j, count;\n\nint **arr = (int **)malloc(r * sizeof(int *));\nfor (i=0; i&lt;r; i++)\n     arr[i] = (int *)malloc(c * sizeof(int));\n</code></pre>\n\n<p>That's how 2d array allocation must look like. </p>\n\n<p>The difference between malloc and calloc is that calloc zero-initializes allocated memory, so they are interchangeable in your case.</p>\n"}], "owner": {"reputation": 183, "user_id": 9473420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b94e19777286be9f5c934308e9f6f9?s=128&d=identicon&r=PG&f=1", "display_name": "victory", "link": "https://stackoverflow.com/users/9473420/victory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 50603816, "answer_count": 1, "score": 0, "last_activity_date": 1527680614, "creation_date": 1527680220, "question_id": 50603683, "link": "https://stackoverflow.com/questions/50603683/return-of-int-function-in-c", "title": "Return of int** function in c", "body": "<p>I am struggling with function int** Solve(). I did not find solution anywhere, or maybe I can not express my problem accuratelly. I am unable return right value, I always get compilator error or segmentation fault. How to initialize int ptr**, which I want to return from function? Note that function type (int**) is given, and I am not able to change it. I tried to use calloc, because if I wanted to return something line int ptr[4][4], it said I am returning local variable. I don't know what to do, and ptr does not have to be int** maybe. I just want to return right elements and using return ptr. My code:</p>\n\n<pre><code>int** Solve(){\n    int array[6][6];\n\n    //some determining of array's elements...\n\n    int **ptr=calloc(4,sizeof(int*));\n    for(int i=0;i&lt;4;i++){\n        for(int j=0;j&lt;4;j++){\n            ptr[i][j]=array[i+1][j+1];\n        }\n    }\n\n    return ptr;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1527688181, "post_id": 50603312, "comment_id": 88222361, "body": "Because <code>checkmat</code>&#39;s <code>mat</code> is a pointer-to-pointer-to-pointer, and <code>main</code>&#39;s <code>mat</code> is a pointer to a 2D array. These have nothing in common."}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1527689360, "post_id": 50606499, "comment_id": 88223247, "body": "You can&#39;t just cast a <code>float (*)[4]</code> to a <code>float *</code> and expect things to work."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1527689529, "post_id": 50606499, "comment_id": 88223389, "body": "this the array the continues block of memory.  it does not matter in this case. The pointer points to the first element of the array (just the type is different). But for you I have changed it"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1527689689, "post_id": 50606499, "comment_id": 88223509, "body": "You&#39;re still treating a 2D array as a 1D array.  Declare the function as <code>void checkmat(float mat[rows][cols] ,float * max,float * min, size_t cols, size_t rows)</code> and reference it properly in the function, and pass <code>mat</code> directly."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1527692015, "post_id": 50606499, "comment_id": 88225217, "body": "@dbush and? It is 100% correct"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1527692386, "last_edit_date": 1527692386, "creation_date": 1527688397, "answer_id": 50606499, "question_id": 50603312, "link": "https://stackoverflow.com/questions/50603312/error-message-expected-float-but-argument-is-of-type-float/50606499#50606499", "title": "Error message &quot;expected \u2018float ***\u2019 but argument is of type \u2018float *\u2019", "body": "<p>You do not need any *** pointers</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;float.h&gt;\n\nvoid checkmat(float * mat,float * max,float * min, size_t cols, size_t rows){\n\n    float sum=0,sum2=0,flag=1;\n\n    for(int i=0;i&lt;rows;i++){\n        for(int j=0;j&lt;cols;j++){\n            sum+=(mat[i * cols + j]);\n            sum2+=(mat[i * cols + j]);\n        }\n        if(sum &gt; *max)\n            *max=sum;\n        if(flag){\n            *min=sum;\n            flag=0;\n        }\n        if(sum2&lt; *min)\n            *min =sum2;\n    }\n}\n\nint main()\n{\n   float mat[4][4]={{1,2,3,4},{5,6,7.6,8},{9,1,2.9,3},{4,5,6,7}};\n   float min=FLT_MAX,max=-FLT_MAX;\n\n   checkmat((&amp;mat[0][0],&amp;max,&amp;min, sizeof(mat) / sizeof(mat[0]), sizeof(mat[0]) / sizeof(mat[0][0]));\n\n   printf(\"Size of the matrix is %zu x %zu. %f is max %f is min \\n\", max, min, sizeof(mat) / sizeof(mat[0]), sizeof(mat[0]) / sizeof(mat[0][0]));\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527691163, "post_id": 50606789, "comment_id": 88224591, "body": "<code>float (*foo1)[][c]</code> is not a pointer to a 2D array.  <code>foo1</code> is a pointer to a 1D array of <code>float *</code>.  With <code>float (*foo2)[r][c]</code>, <code>foo2</code> is a pointer to a 2D array."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527691306, "post_id": 50606789, "comment_id": 88224699, "body": "<code>arr == arr[0]</code> compares pointers of different types and readily generates a warning like &quot;comparison of distinct pointer types lacks a cast&quot;."}], "tags": [], "owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "is_accepted": true, "score": 1, "last_activity_date": 1527689197, "creation_date": 1527689197, "answer_id": 50606789, "question_id": 50603312, "link": "https://stackoverflow.com/questions/50603312/error-message-expected-float-but-argument-is-of-type-float/50606789#50606789", "title": "Error message &quot;expected \u2018float ***\u2019 but argument is of type \u2018float *\u2019", "body": "<p>As @Quentin mentioned, there is a difference between the two variables.</p>\n\n<pre><code>float ***\n</code></pre>\n\n<p>This is a pointer to a pointer to a pointer. I assume you used this because you thought that is how arrays are stored. It's a common misconception that a 2D array is always a array of pointers pointing to arrays.</p>\n\n<p>Rather a pointer to a 2D array should be written as:</p>\n\n<pre><code>float (*)[][height]\n</code></pre>\n\n<p>In these cases 2D arrays are stored in memory column-after-column (when in column-major mode). Therefore if you have declare a 2D array:</p>\n\n<pre><code>float arr[5][10];\n</code></pre>\n\n<p>then the following will be true</p>\n\n<pre><code>arr == arr[0]\n</code></pre>\n\n<p>as the variable 'arr' points to the first element of the 2D array, which is also the start of the first column. </p>\n\n<p>Also, you don't need to create a pointer to the array, as the array variable itself is already a pointer. So, to answer your question, your function parameters are declared incorrectly. It should be:</p>\n\n<pre><code>void checkmat(float mat[M][N],float * max,float * min){...}\n</code></pre>\n\n<p>NB: You need to specify the array size in the function.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1527693048, "creation_date": 1527693048, "answer_id": 50608114, "question_id": 50603312, "link": "https://stackoverflow.com/questions/50603312/error-message-expected-float-but-argument-is-of-type-float/50608114#50608114", "title": "Error message &quot;expected \u2018float ***\u2019 but argument is of type \u2018float *\u2019", "body": "<p>It is often incorrectly said that pointers and arrays are equivalent in C.  Your code is an example of this not being the case.</p>\n\n<p>In most contexts, an array will decay to a pointer to its first member.  This only applies to the outermost array dimension however.  For example, a <code>float [4]</code>, which is an array of <code>float</code>, will decay to <code>float *</code>.  But a <code>float [4][4]</code>, which is an array of <code>float [4]</code> decays into a <code>float (*)[4]</code> (i.e. a pointer to an array of <code>float [4]</code>), <strong>not</strong> a <code>float **</code>.</p>\n\n<p>In your case you pass <code>&amp;mat</code>, which has type <code>float (*)[4][4]</code>, to a function expecting a <code>float ***</code>.  These types are not compatible, hence the error.</p>\n\n<p>The proper way to define the function is:</p>\n\n<pre><code>void checkmat(int rows, int cols, float mat[rows][cols] ,float * max,float * min)\n</code></pre>\n\n<p>This way you pass the 2D array to your function, along with the size of each dimension.</p>\n\n<p>You then use <code>mat</code> in the function like this:</p>\n\n<pre><code>       sum += mat[i][j];\n       sum2 += mat[j][i];\n</code></pre>\n\n<p>And you call the function like this, passing in <code>mat</code> directly instead of its address as well as its dimensions:</p>\n\n<pre><code>checkmat(n,n,mat,&amp;max,&amp;min);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9607173, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156250316968540/picture?type=large", "display_name": "Tal Alfi", "link": "https://stackoverflow.com/users/9607173/tal-alfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "closed_date": 1527710544, "accepted_answer_id": 50606789, "answer_count": 3, "score": 0, "last_activity_date": 1527693048, "creation_date": 1527679064, "last_edit_date": 1527687729, "question_id": 50603312, "link": "https://stackoverflow.com/questions/50603312/error-message-expected-float-but-argument-is-of-type-float", "closed_reason": "Duplicate", "title": "Error message &quot;expected \u2018float ***\u2019 but argument is of type \u2018float *\u2019", "body": "<p>I have this code:</p>\n\n<pre><code>void checkmat(float *** mat,float * max,float * min){\n\n    float sum=0,sum2=0,flag=1;\n\n    for(int i=0;i&lt;n;i++){\n        for(int j=0;j&lt;n;j++){\n            sum+=(*mat[i][j]);\n            sum2+=(*mat[j][i]);\n        }\n        if(sum&gt;(*max))\n            (*max)=sum;\n        if(flag){\n            (*min)=sum;\n            flag=0;\n        }\n        if(sum2&lt;(*min))\n            (*min)=sum2;\n\n    sum=0;\n    sum2=0;\n    }\n\n\n}\n\nint main(){\n\n    float mat[n][n]={{1,2,3,4},{5,6,7.6,8},{9,1,2.9,3},{4,5,6,7}};\n    float min=0,max=0;\n\ncheckmat(&amp;mat,&amp;max,&amp;min);\n\nprintf(\"%f is max %f is min \\n\",max,min);\n\n}\n</code></pre>\n\n<p>For now, it doesn't really matter what the code does. I'm interested in why I get this error message from the compiler:</p>\n\n<pre><code>test3.c: In function \u2018main\u2019:\ntest3.c:38:10: warning: passing argument 1 of \u2018checkmat\u2019 from incompatible pointer type [-Wincompatible-pointer-types]\n checkmat(&amp;mat,&amp;max,&amp;min);\n          ^\ntest3.c:8:6: note: expected \u2018float ***\u2019 but argument is of type \u2018float (*)[4][4]\u2019\n void checkmat(float *** mat,float * max,float * min){\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c", "locale", "codepage-437"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 0, "creation_date": 1527680911, "post_id": 50603699, "comment_id": 88216978, "body": "Pardon my ignorance, but what is <code>assert</code> in your code"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 0, "creation_date": 1527681230, "post_id": 50603699, "comment_id": 88217187, "body": "A very cheap and simple substitute for error checking, it&#39;s a C macro, see <a href=\"http://en.cppreference.com/w/c/error/assert\" rel=\"nofollow noreferrer\">assert</a>. <code>assert checks if its argument [...] compares equal to zero. If it does, assert outputs implementation-specific diagnostic information on the standard error output and calls abort()</code>. It&#39;s good to check every system call return value."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 0, "creation_date": 1527681483, "post_id": 50603699, "comment_id": 88217379, "body": "@Real Note that <code>assert(0)</code> essentially crashes the program. Any serious program should use more robust error handling."}, {"owner": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 0, "creation_date": 1527682233, "post_id": 50603699, "comment_id": 88217908, "body": "It&#39;s alright, it&#39;s just an assignment for a data structures class in my uni, nothing too serious. Heck, i wasn&#39;t even required to print a tree like this, but i&#39;m trying to stand out from others to get better grades obviously"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "edited": false, "score": 1, "creation_date": 1527682642, "post_id": 50603699, "comment_id": 88218200, "body": "@Real You may also need to check that the output device can handle characters from CP437 and CP1252 (or whatever is used in Portuguese) at the same time. Better to go the Unicode route if the output device can handle it. Or you could use the &quot;poor man&#39;s&quot; line-drawing characters <code>+-|</code> etc."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1527680271, "creation_date": 1527680271, "answer_id": 50603699, "question_id": 50603067, "link": "https://stackoverflow.com/questions/50603067/using-code-page-437-and-setlocale-at-the-same-time/50603699#50603699", "title": "Using code page 437 and setlocale at the same time", "body": "<p>Just save the current locale, and then restore:</p>\n\n<pre><code>void func_with_my_own_locale(void) {\n   const char * localesave = setlocale(LC_ALL, NULL);\n   assert(localesave != NULL); // or some fprintf(stderr, ....);\n   if (setlocale(LC_ALL, \"CP437\" /* or \"\" */) == NULL) {\n       assert(0);\n   }\n   ...... \n   if (setlocale(LC_ALL, localesave) == NULL) {\n       assert(0);\n   }\n}\n</code></pre>\n\n<p>Notice, locale is shared between all threads in a process, so you need to pause all other threads (or make sure they don't call any locale  dependent functions) while calling such function.</p>\n\n<p>From <a href=\"http://pubs.opengroup.org/onlinepubs/000095399/functions/setlocale.html\" rel=\"nofollow noreferrer\">posix setlocale</a>:</p>\n\n<blockquote>\n  <p>Upon successful completion, setlocale() shall return the string associated with the specified category for the new locale. Otherwise, setlocale() shall return a null pointer and the program's locale is not changed.<br>\n  A null pointer for locale causes setlocale() to return a pointer to the  string associated with the category for the program's current locale.<br>\n  The string returned by setlocale() is such that a subsequent call with that string and its associated category shall restore that part of the program's locale.</p>\n</blockquote>\n"}], "owner": {"reputation": 93, "user_id": 9142951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dcc29f1cb510c7b1d310eed47d7f618?s=128&d=identicon&r=PG&f=1", "display_name": "Real", "link": "https://stackoverflow.com/users/9142951/real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 50603699, "answer_count": 1, "score": 1, "last_activity_date": 1527680271, "creation_date": 1527678314, "question_id": 50603067, "link": "https://stackoverflow.com/questions/50603067/using-code-page-437-and-setlocale-at-the-same-time", "title": "Using code page 437 and setlocale at the same time", "body": "<p>There's a few special characters from code page 437 that i want to use within a function that prints n-ary trees so i can do something like this:</p>\n\n<p><a href=\"http://www.randygaul.net/wp-content/uploads/2015/06/Capture1.png\" rel=\"nofollow noreferrer\">http://www.randygaul.net/wp-content/uploads/2015/06/Capture1.png</a>\n(Basically something similar to the <code>tree</code> command in linux)</p>\n\n<p>The problem is, my algorithm is using <code>setlocale(LC_ALL, \"Portuguese\")</code> which messes up with those special characters. I wanted to know if i can somehow apply C default locale to that function alone.</p>\n"}, {"tags": ["c", "operators"], "comments": [{"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 2, "creation_date": 1527677721, "post_id": 50602832, "comment_id": 88214765, "body": "undefined behavior i think because there are multiple assignment and reads of the same value in the same line"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1527678176, "post_id": 50602832, "comment_id": 88215087, "body": "Well, what output do you get <i>when you run it</i>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1527679370, "post_id": 50602832, "comment_id": 88215923, "body": "Not a duplicate but please read <a href=\"https://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior-in-c\">Why are these constructs (using ++) undefined behavior in C?</a>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1527679832, "post_id": 50602832, "comment_id": 88216236, "body": "@klutt: Running a program reveals only one instance of how it may behave. It does not tell you when the behavior is undefined, and it does not tell you how it may behave with other C implementations. It is <b>not</b> a proper method for answeting questions such as this."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1527679969, "post_id": 50602832, "comment_id": 88216323, "body": "Everyone: can&#39;t close this as &quot;unclear&quot;. It is perfectly clear and contains a MCVE. I was trigger-happy myself and closed as dupe to i++ questions but it is not a good dupe so I re-opened it. &quot;I find this newbie FAQ uninteresting&quot; is not a valid close reason. Either find a good duplicate or stay clear of the question. Voting to re-open."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527681037, "post_id": 50602832, "comment_id": 88217057, "body": "@SteveSummit: Neither you nor Lundin think it&#39;s a good enough question to be upvoted."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1527681065, "post_id": 50602832, "comment_id": 88217077, "body": "@Bathsheba Fixed."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527681104, "post_id": 50602832, "comment_id": 88217097, "body": "@SteveSummit: Let&#39;s leave it up a bit longer then."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1527685631, "post_id": 50602832, "comment_id": 88220374, "body": "@EricPostpischil Nope, but writing what it does when you run it at least shows some effort."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1527688597, "post_id": 50602832, "comment_id": 88222673, "body": "@klutt: Asking people to jump through hoops that are unproductive tasks to satisfy your notions of effort serves no purpose."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1527688793, "post_id": 50602832, "comment_id": 88222822, "body": "@EricPostpischil I disagree. Especially since one of the reasons to vote down is &quot;does not show any research effort&quot; which this question clearly does not."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1527689078, "post_id": 50602832, "comment_id": 88223048, "body": "@EricPostpischil: I hope you don&#39;t mind but I&#39;ve added the output that I get with an old Turbo C compiler I have lying around still. Note that the <code>#include &lt;conio.h&gt;</code> is evidence enough that a Turbo C compiler is used."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1527693396, "post_id": 50602832, "comment_id": 88226152, "body": "@klutt: Asking somebody to do something productive might be reasonable. Asking somebody to do an <b>unproductive task</b> is not. It serves no purpose, wastes time and effort, and misleads people about what methods are useful for finding information. If you had asked not what output they get but rather what documents did they search for information, you might have established a lack of effort. But asking for somebody to do something useless is nothing more than ask them to perform for your entertainment."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1527695266, "post_id": 50602832, "comment_id": 88227354, "body": "@klutt In cases like these, asking someone to &quot;just try it&quot; is not just unproductive, it&#39;s downright counterproductive. Questioners always want to know what the &quot;right answer&quot; is, and it&#39;s very hard to learn that the right answer is that there is no right answer. Trying it just tends to reinforce the notion that what today&#39;s compiler happens to emit might be &quot;right&quot;."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527760646, "post_id": 50602832, "comment_id": 88252732, "body": "@SteveSummit Maybe you&#39;re right. I&#39;ll think of it."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1527760665, "post_id": 50602832, "comment_id": 88252747, "body": "@EricPostpischil See above"}], "answers": [{"comments": [{"owner": {"reputation": 2127, "user_id": 3233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmZpG.jpg?s=128&g=1", "display_name": "Gerard H. Pille", "link": "https://stackoverflow.com/users/3233365/gerard-h-pille"}, "edited": false, "score": 0, "creation_date": 1527677924, "post_id": 50602912, "comment_id": 88214900, "body": "Where is left for you?"}], "tags": [], "owner": {"reputation": 143, "user_id": 8720012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039247b3d75cbd0c9512adc4f25413c8?s=128&d=identicon&r=PG&f=1", "display_name": "Bharadwaj", "link": "https://stackoverflow.com/users/8720012/bharadwaj"}, "is_accepted": false, "score": -6, "last_activity_date": 1527677926, "last_edit_date": 1527677926, "creation_date": 1527677802, "answer_id": 50602912, "question_id": 50602832, "link": "https://stackoverflow.com/questions/50602832/compound-assignment-operators-in-c/50602912#50602912", "title": "Compound Assignment Operators in C", "body": "<p>It depends on the compiler ! But theoretically <code>28</code> is the answer ! \nThe assignment will be from right to left so <code>a +=a += a += 2;</code> can be break down as </p>\n\n<pre><code>5+2=7 a+=2\n7+7=14 a+=a+=2\n14+14=28 a+=a+=a+=2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527678086, "post_id": 50602925, "comment_id": 88215017, "body": "What is now undefined? Can you give an example of another outcome?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527678161, "post_id": 50602925, "comment_id": 88215073, "body": "@PaulOgilvie: I&#39;ve clarified that. Another outcome is that the compiler eats my cat."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527678242, "post_id": 50602925, "comment_id": 88215136, "body": "You mean the compiler could have cached a copy of a, which is not updated in the next step, so another outcome could have been 8?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527678281, "post_id": 50602925, "comment_id": 88215157, "body": "@PaulOgilvie: Some compilers don&#39;t actually increase <code>a</code> until the end of the statement."}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1527678291, "post_id": 50602925, "comment_id": 88215164, "body": "The value of <code>a</code> is only required to be written once in the whole statement.   Since the grouping implies writing a value to it more than once, those writes are unsequenced, and the behaviour is undefined."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1527678391, "post_id": 50602925, "comment_id": 88215213, "body": "Could you add this to your solution so it is more clear why it is not defined?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1527678772, "post_id": 50602925, "comment_id": 88215521, "body": "This answer would be better if you&#39;d just leave the first paragraph, and remove any attempt to reason with undefined behaviour. In it&#39;s current state your answer implies that 28 is predictable outcome, when predictable outcome is impossible."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1527679074, "post_id": 50602925, "comment_id": 88215716, "body": "@user694733: I know, rationalising UB is an automatic -1. I feel you can sort of get away with it if you stick to a particular toolchain (here conio.h is the clue). Tell you what, I&#39;ll put a line in the answer."}, {"owner": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1527679447, "post_id": 50602925, "comment_id": 88215975, "body": "i agree its an undefined behaviors but i tested multiple compilers on godbolt with max optimization and none broke the code"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 2909, "user_id": 9691656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6944dacfe20c1ae8aa3cf5131b2cde3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyker", "link": "https://stackoverflow.com/users/9691656/tyker"}, "edited": false, "score": 0, "creation_date": 1527679617, "post_id": 50602925, "comment_id": 88216084, "body": "@Tyker, try one of the earlier MSVC compilers."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1527679093, "last_edit_date": 1527679093, "creation_date": 1527677855, "answer_id": 50602925, "question_id": 50602832, "link": "https://stackoverflow.com/questions/50602832/compound-assignment-operators-in-c/50602925#50602925", "title": "Compound Assignment Operators in C", "body": "<p>The behaviour of your program is <em>undefined</em> as you are reading from and writing to <code>a</code> in an <em>unsequenced</em> step.</p>\n\n<hr>\n\n<p>What your ancient compiler is doing is correctly following the C grammar rules and is <em>grouping</em> the expression as</p>\n\n<pre><code>a += (a += (a += 2))\n</code></pre>\n\n<p>But grouping is <strong>not</strong> the same as <em>sequencing</em>. From this point the behaviour is undefined. Your compiler appears to evaluate the above to</p>\n\n<pre><code>a += (a += 7)\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>a += 14\n</code></pre>\n\n<p>to yield <code>28</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1527692284, "last_edit_date": 1527692284, "creation_date": 1527690226, "answer_id": 50607155, "question_id": 50602832, "link": "https://stackoverflow.com/questions/50602832/compound-assignment-operators-in-c/50607155#50607155", "title": "Compound Assignment Operators in C", "body": "<p>This is a tough question without an easy, obvious answer.</p>\n\n<p>The expression is probably undefined, in which case it's meaningless to ask \"what could be the possible output?\", because it could be <em>anything</em>.</p>\n\n<p>If it's undefined, it's because there are multiple writes (stores) to <code>a</code> without any intervening sequence points. The rightmost <code>a += 2</code> computes 7 and prepares to store it into <code>a</code>.  Next we have the middle <code>a +=</code>, which tries to take the 7 and add it to... what?  The old or the new value of <code>a</code>?  If it's the old we compute 5+7= 12 and if it's the new we compute 7+7=14, and whichever value we compute, we prepare to store <em>it</em> into <code>a</code>, but does it \"win\" and overwrite the value that the rightmost <code>a += 2</code> tried to store, or not?  And then the arguments (and the multiplicity of different interpretations and possible answers) proliferate for the leftmost <code>a +=</code>.</p>\n\n<p>Not all assignment expressions are undefined, of course.  For example, the old standby</p>\n\n<pre><code>a = a + 1\n</code></pre>\n\n<p>is well-defined.  It both fetches from <code>a</code> and assigns to <code>a</code>, but in this case we don't have to ask, \"what if it assigns to <code>a</code> before it fetches from it?\", because obviously, it <em>has</em> to fetch from <code>a</code> first, in the process of computing the new value to be assigned.  But this argument doesn't rescue <code>a += a += 2</code>, I don't think.</p>\n\n<p>There are newer rules about \"sequencing\" which do away with the old concept of \"sequence points\", and the new rules might render this expression well-defined, but I'm not sure.</p>\n\n<p>Unless you're interested in frustrating, head-banging puzzles, it's best to steer clear of expressions like this one.  You obviously wouldn't have any use for an expression like this in a real program.  It's nearly impossible to figure out (a) if the expression is well-defined and (b) if so, what it's supposed to do, so a program containing an expression like this is unmaintainable; you have to be a hard-core language lawyer to properly understand it.</p>\n\n<p>Naturally it's important to understand how simpler, saner expressions like <code>a += 2</code> or <code>x += y[i++]</code> work.  But for something insane like <code>a += a += a += 2</code>, don't fall into the trap of asking \"Wouldn't it help me understand C better if I understand what it means?\", because the only thing to understand is that it's borderline, if not absolutely, meaningless.</p>\n\n<p>See also SO's canonical entry on undefined expressions, <a href=\"https://stackoverflow.com/questions/949433/why-are-these-constructs-using-undefined-behavior-in-c?\">Why are these constructs (using ++) undefined behavior in C?</a> (although none of the answers there cover this particular case).</p>\n"}], "owner": {"reputation": 35, "user_id": 9706034, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-67wTj3aI2UM/AAAAAAAAAAI/AAAAAAAAYC0/C997Lql5aMs/photo.jpg?sz=128", "display_name": "Kaustubh Dange", "link": "https://stackoverflow.com/users/9706034/kaustubh-dange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 1, "answer_count": 3, "score": -3, "last_activity_date": 1527694686, "creation_date": 1527677582, "last_edit_date": 1527694686, "question_id": 50602832, "link": "https://stackoverflow.com/questions/50602832/compound-assignment-operators-in-c", "title": "Compound Assignment Operators in C", "body": "<p>What is the output of the following program, and why?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nint main()\n{\n    int a=5;\n    a +=a += a += 2;\n    printf(\"%d\",a);\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "header-files", "paradigms"], "answers": [{"tags": [], "owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "is_accepted": false, "score": 3, "last_activity_date": 1527699130, "last_edit_date": 1527699130, "creation_date": 1527677984, "answer_id": 50602966, "question_id": 50602755, "link": "https://stackoverflow.com/questions/50602755/functions-declared-and-defined-in-a-c-file/50602966#50602966", "title": "Functions declared and defined in a .c file", "body": "<p>Splitting a complex routine in multiple smaller routines might make the code easier to understand and also would allow you to follow the single responsibility principle (<a href=\"https://stackoverflow.com/questions/10620022/what-is-an-example-of-the-single-responsibility-principle\">What is an example of the Single Responsibility Principle?</a>). By declaring and defining them only in a <code>.c</code> file (and declaring them <code>static</code>), you can hide the internal details from users.</p>\n\n<p>If you, for instance, create a library, then your header could only show the public functions you'd like your users to use.</p>\n\n<p>So only put your functions in a header if you'd like those functions available to anyone who includes the header.</p>\n\n<p>If you'd like to keep a function internal to your <code>.c</code> file, seriously consider adding the static keyword as well: <a href=\"https://stackoverflow.com/questions/7813593/what-is-the-advantage-of-static-function\">what is the advantage of static function?</a></p>\n\n<p>---edit---</p>\n\n<blockquote>\n  <p>How can we access one of those functions in a source file from other source file ?</p>\n</blockquote>\n\n<p>If the function isn't <code>static</code>, you could technically declare it anywhere* you'd like and use it there as well. Though, by the above argument, this would be bad practice.</p>\n\n<p>Example:</p>\n\n<p>a.c</p>\n\n<pre><code>int secret_a(int x)\n{\n    return x+1;\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n//access a secret function from a.c\nint secret_a(int);\n\nint main()\n{\n    printf(\"secret_a(3) gives: %d\\n\", secret_a(3));\n    return 0;\n}\n</code></pre>\n\n<ul>\n<li>(*) anywhere allowed by the C language</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1527678175, "creation_date": 1527678175, "answer_id": 50603023, "question_id": 50602755, "link": "https://stackoverflow.com/questions/50602755/functions-declared-and-defined-in-a-c-file/50603023#50603023", "title": "Functions declared and defined in a .c file", "body": "<blockquote>\n  <p>How can we access one of those functions in a source file from other source file ?</p>\n</blockquote>\n\n<p>That is the whole idea with defining some functions in the header, and some only in the c-file.</p>\n\n<p>The functions defined in the header, can be called by other source files.\nThe functions only defined in the source file, can be hidden - it is a usual practice to mark functions, only declared in a source file, as static.\nThat makes their visibility limited to the file-scope (only code inside the same file can 'see' the functions).</p>\n"}, {"tags": [], "owner": {"reputation": 583, "user_id": 4912037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8ad5a96e60d4a5086e0c5b3cfb19ce?s=128&d=identicon&r=PG&f=1", "display_name": "yashC", "link": "https://stackoverflow.com/users/4912037/yashc"}, "is_accepted": false, "score": 0, "last_activity_date": 1527678685, "creation_date": 1527678685, "answer_id": 50603194, "question_id": 50602755, "link": "https://stackoverflow.com/questions/50602755/functions-declared-and-defined-in-a-c-file/50603194#50603194", "title": "Functions declared and defined in a .c file", "body": "<p>The reason why this is done is to split the code into a more cleaner and sorted format so that functions concerning a particular operation can be grouped together in to one file and then called from other file. NOTE: this is not mandatory to do but a good programming practice.</p>\n\n<p>Now there are two ways to do it :\n1. including the files \n2. Declaring the function as extern and then linking them at linking time.</p>\n\n<p>1.\nIncluding the file is the method that you are probably seeing in your code at hand. Functions are defined in one file and that file is included using #include\"filename.[h/c]\" and then calling the function as it were declared in the given file.</p>\n\n<p>file_to_include.c</p>\n\n<pre><code>void my_func()\n{\nprintf(\"Hello!\\n\");\n}\n</code></pre>\n\n<p>file_that_include.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include\"file_to_include.c\"\nint main()\n{\n my_func();\n return 0;\n }\n</code></pre>\n\n<p>to compile you just do </p>\n\n<pre><code>gcc file_that_include.c\n</code></pre>\n\n<ol start=\"2\">\n<li>using extern you can do the same but with out using the #include directive</li>\n</ol>\n\n<p>file_to_include.c</p>\n\n<pre><code>void my_func()\n{\nprintf(\"Hello!\\n\");\n}\n</code></pre>\n\n<p>file_that_include.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nextern void my_func();\nint main()\n{\n my_func();\n return 0;\n }\n</code></pre>\n\n<p>In this case while compiling you need to provide both files to the compiler </p>\n\n<pre><code>gcc file_that_include.c file_to_include.c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8102463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ORiIP.jpg?s=128&g=1", "display_name": "BlinkFan", "link": "https://stackoverflow.com/users/8102463/blinkfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527681303, "creation_date": 1527681303, "answer_id": 50604036, "question_id": 50602755, "link": "https://stackoverflow.com/questions/50602755/functions-declared-and-defined-in-a-c-file/50604036#50604036", "title": "Functions declared and defined in a .c file", "body": "<p>I would suggest reading up on the \"extern\" keyword.</p>\n\n<p>From what I can understand in your question you have two files - \"code.h\" and \"code.c\". However, \"code.h\" only declares certain functions in \"code.c\":</p>\n\n<p>code.h</p>\n\n<pre><code>int func1();\nint func2();\n</code></pre>\n\n<p>code.c</p>\n\n<pre><code>int func1()\n{\n  return 1;\n}\n\nint func2()\n{ \n  return 2;\n}\n\nint func3()\n{ \n  return 3;\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"code.h\"\n\nextern int func3();\n\nint main()\n{\n  printf(\"%d \", func1());\n  printf(\"%d \", func2());\n  printf(\"%d \", func3());\n}\n</code></pre>\n\n<p>Compiling using gcc:</p>\n\n<blockquote>\n  <p>gcc main.c code.c</p>\n</blockquote>\n\n<p>yields:</p>\n\n<pre><code>main.c: In function \u2018main\u2019:\nmain.c:10:17: warning: implicit declaration of function \u2018func3\u2019 [-Wimplicit-function-declaration]\n   printf(\"%d \", func3());\n</code></pre>\n\n<p>and when executed:</p>\n\n<pre><code>1 2 3\n</code></pre>\n\n<p>The \"extern\" keyword basically tells the compiler \"there is a definition for a function with this declaration\" for compiling. During linking the linker will find the definition, and link to it.</p>\n\n<p>This is however a clumsy way of doing it, since the caller (\"main.c\") needs to know what is going on in \"code.c\", and continually add more extern declaration, etc. etc.</p>\n\n<p>So rather include functions you which to have global scope in \"code.h\". If there are functions in \"code.c\" which od not have global scope, consider making them \"static\".</p>\n\n<p>Some more reading:\n<a href=\"https://stackoverflow.com/questions/856636/effects-of-the-extern-keyword-on-c-functions\">Effects of the extern keyword on C functions</a></p>\n"}], "owner": {"reputation": 45, "user_id": 7984479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddeb3b6cf4d4f4c46ff888990f9ba12a?s=128&d=identicon&r=PG&f=1", "display_name": "karra", "link": "https://stackoverflow.com/users/7984479/karra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1921, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1527699130, "creation_date": 1527677346, "last_edit_date": 1527677538, "question_id": 50602755, "link": "https://stackoverflow.com/questions/50602755/functions-declared-and-defined-in-a-c-file", "title": "Functions declared and defined in a .c file", "body": "<p>As I was going through a huge source code, I came across some files where there is only one function declared in, let's say, \"code.h\" but in \"code.c\" there are many functions declared and defined.</p>\n\n<p>What is the exact use of declaring and defining functions in .c files ? \nHow can we access one of those functions in a source file from  other source file ?</p>\n\n<p>It would be helpful if anyone can provide an example. Thanks</p>\n"}, {"tags": ["c", "eclipse", "compilation"], "comments": [{"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 0, "creation_date": 1527677148, "post_id": 50602555, "comment_id": 88214393, "body": "It looks like a make-build issue, could you add your makefile/scons/compilation command/...?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527680758, "post_id": 50602555, "comment_id": 88216855, "body": "Eclipse was designed to be a mysterious linker error generator. Crap like this is exactly the reason why it shouldn&#39;t be used. Be aware that the path you include as per your answer get silently translated to an absolute path behind the lines, <a href=\"https://stackoverflow.com/questions/27905795/eclipse-cant-find-header-filers-even-though-include-paths-have-been-set\">see this</a>. So the IDE meltdown may just continue from there. I&#39;d strongly recommend to avoid Eclipse at all costs."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527682955, "post_id": 50602555, "comment_id": 88218421, "body": "I saw after the change that my project has changed its <code>my_package&#47;.cproject</code> file (added <code>&lt;listOptionValue builtIn=&quot;false&quot; value=&quot;&amp;quot;${workspace_loc:&#47;headers}&amp;quot;&quot;&#47;&gt;</code> line) - is that the silent translation you meant?"}], "answers": [{"tags": [], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "is_accepted": true, "score": 0, "last_activity_date": 1527677432, "creation_date": 1527677432, "answer_id": 50602781, "question_id": 50602555, "link": "https://stackoverflow.com/questions/50602555/include-x-y-h-works-from-one-project-file-but-not-from-other-need-to-change/50602781#50602781", "title": "#include &lt;x/y.h&gt; works from one project file but not from other? need to change file configurations?", "body": "<p><em>This what fixed it for me but if someone has another answer, I'd love to hear it</em></p>\n\n<p>So, it turns out I just needed to do the exact same thing in the GNU C++ tab also:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OHkOV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OHkOV.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/LpKAV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LpKAV.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 50602781, "answer_count": 1, "score": 2, "last_activity_date": 1527677432, "creation_date": 1527676688, "last_edit_date": 1527677170, "question_id": 50602555, "link": "https://stackoverflow.com/questions/50602555/include-x-y-h-works-from-one-project-file-but-not-from-other-need-to-change", "title": "#include &lt;x/y.h&gt; works from one project file but not from other? need to change file configurations?", "body": "<p>I have a some code files and a directory with some header files in sub-directories, structured like this:</p>\n\n<pre><code>code\\my_file.c\ncode2\\other_file.c\nheaders\n</code></pre>\n\n<p>where <code>headers</code> contains the sub-directories <code>openssl, curl</code>. </p>\n\n<p>When I use <code>#include &lt;openssl/evp.h&gt;</code> inside <code>my_file.c</code> it fails with:</p>\n\n<blockquote>\n  <p><code>fatal error: openssl/evp.h: No such file or directory</code></p>\n</blockquote>\n\n<p>However, it works from <code>other_file.c</code></p>\n\n<p>Additionally, when I include the full path <code>#include \"../headers/openssl/evp.h</code> it works fine.</p>\n\n<p>Is there a reason one file in my project knows to find the <code>openssl</code> dir and the other doesn't? </p>\n\n<p><em>Using Eclipse</em></p>\n\n<p>I tried changing properties, by adding an include path:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OqOLn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OqOLn.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RnFUc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RnFUc.png\" alt=\"enter image description here\"></a></p>\n\n<p>but it didn't work...</p>\n"}, {"tags": ["c", "list", "pointers", "nodes", "dynamic-allocation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527676107, "post_id": 50602318, "comment_id": 88213714, "body": "This is the perfect time to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your programs</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1527676151, "post_id": 50602318, "comment_id": 88213741, "body": "A couple of possible hints though: Don&#39;t forget that <code>char</code> strings in C are really called <b><i>null-terminated</b> byte strings</i>. That <i>null-terminator</i> need space too. And think about what happens when you assign a pointer to another pointer (the effect could be seen quite easily if stepping through your code line by line in a debugger, watching the actual value of the pointer variable, i.e. where they point)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527676441, "post_id": 50602318, "comment_id": 88213942, "body": "On an unrelated note, <code>sizeof(char)</code> is defined by the C specification to <i>always</i> be equal to <code>1</code>. Don&#39;t need it in your <code>malloc</code> calls."}, {"owner": {"reputation": 9, "user_id": 9869235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOVdh.jpg?s=128&g=1", "display_name": "Alessia", "link": "https://stackoverflow.com/users/9869235/alessia"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1527676928, "post_id": 50602318, "comment_id": 88214257, "body": "@Someprogrammerdude I&#39;m using CodeBlocks as IDE and I tried to debug, but it seems not working with pointers. I&#39;ll try to add a char for the null-terminated string but I don&#39;t think that&#39;s the problem\u2026 since the current node is allocated correctly."}], "owner": {"reputation": 9, "user_id": 9869235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOVdh.jpg?s=128&g=1", "display_name": "Alessia", "link": "https://stackoverflow.com/users/9869235/alessia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527675979, "creation_date": 1527675979, "question_id": 50602318, "link": "https://stackoverflow.com/questions/50602318/ordered-list-in-c-returning-just-one-node-head-overwritten", "title": "ordered list in C returning just one node (head overwritten)", "body": "<p>I'm trying to create an ordered list in C, given a specific prototype:</p>\n\n<pre><code>int insertInOrder (list_t list, char *surname, char *name);\n</code></pre>\n\n<p>The function should insert all nodes in the correct position (alphabetically ordered by surname first, name then - compared in function\n <strong>comparison</strong>) and return 1 if the insertion went through, 0 if the node is a duplicate.</p>\n\n<p><strong>comparison</strong> returns 1 if the first parameter is greater then the second, -1 if it is lesser and 0 if the two parameters are equal.\nI defined:</p>\n\n<pre><code>typedef struct list *list_t;\n\ntypedef struct node *link;\n\nstruct node{\n    char *name;\n    char *surname;\n    link next;\n};\n\nstruct list{\n    link head;\n};\n</code></pre>\n\n<p>This is my function:</p>\n\n<pre><code>int insertInOrder (list_t list, char *cognome, char *nome){\n    link t = list-&gt;head;\n    link p;\n\n    link x = malloc(sizeof(*x));\n    x-&gt;name = malloc(strlen(name)*sizeof(char));\n    x-&gt;name = name;\n    x-&gt;surname = malloc(strlen(surname)*sizeof(char));\n    x-&gt;surname = surname;\n    x-&gt;next = NULL;\n\n\n    if(list-&gt;head == NULL){\n        list-&gt;head = x;\n        return 1;\n    }\n    else{\n        while(t!=NULL){\n            if(comparison(t,x)&lt;0){\n                p = t;\n                t = t-&gt;next;\n            }\n            else if(comparison(t,x)&gt;0){\n                if(t == list-&gt;head){\n                    x-&gt;next = list-&gt;head;\n                    list-&gt;head = x;\n                    return 1;\n                }\n                else{\n                    p-&gt;next = x;\n                    x-&gt;next = t;\n                    return 1;\n               }\n            }\n            else if(comparison(t,x)==0)\n                return 0;\n        }\n        p-&gt;next = x;\n        return 1;\n    }\n}\n</code></pre>\n\n<p><strong>t</strong> is the pointer to the current node, <strong>p</strong> is the pointer to the previous one.</p>\n\n<p>When I print the list, the head is overwritten (the new node replace the old one and the list appears as if it has just one node) and I can't understand why.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hIQQZ.png\" rel=\"nofollow noreferrer\">console result</a></p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1527673668, "post_id": 50601477, "comment_id": 88212124, "body": "Your module is clearly loading if it is able to print those debug messages. What exactly is not working? Your kernel appears to check, but not require, module signatures."}], "owner": {"reputation": 43, "user_id": 5541271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e59c34324333b85de1050c4e8dfd541?s=128&d=identicon&r=PG&f=1", "display_name": "BitByte", "link": "https://stackoverflow.com/users/5541271/bitbyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "closed_date": 1527691025, "answer_count": 0, "score": 2, "last_activity_date": 1527673518, "creation_date": 1527673518, "question_id": 50601477, "link": "https://stackoverflow.com/questions/50601477/how-to-solve-module-verification-failed-signature-and-or-required-key-missing", "closed_reason": "Duplicate", "title": "How to solve :module verification failed: signature and/or required key missing - tainting kernel", "body": "<p>Ive been giving this piece of code but it doesn't seem to work.</p>\n\n<pre><code>#include&lt;linux/module.h&gt;\n\nint proc_init (void) {\n  printk(KERN_INFO \"helloModule: kernel module initialized\\n\");\n  return 0;\n}\n\nvoid proc_cleanup(void) {\n  printk(KERN_INFO \"helloModule: performing cleanup of module\\n\");\n}\n\nMODULE_LICENSE(\"GPL\");\nmodule_init(proc_init);\nmodule_exit(proc_cleanup);\n</code></pre>\n\n<p>And this is the given maker file:</p>\n\n<pre><code>CONFIG_MODULE_SIG=n\n\nobj-m += helloModule.o\n\nall:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\n\nclean:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n</code></pre>\n\n<p>I was told if in the maker file I change:  </p>\n\n<pre><code>CONFIG_MODULE_SIG=n to CONFIG_MODULE_SIG=0 \n</code></pre>\n\n<p>it would work but I still get Module verification failed: signature.\nHere are the full results if it helps:</p>\n\n<pre><code>[ 1092.186460] helloModule: module verification failed: signature and/or required key missing - tainting kernel\n[ 1092.188510] helloModule: kernel module initialized\n[ 2245.128462] helloModule: performing cleanup of module\n[ 2250.667037] helloModule: kernel module initialized\n[ 2305.815511] helloModule: performing cleanup of module\n[ 2357.490185] helloModule: kernel module initialized\n[ 2526.267464] usb 1-1: USB disconnect, device number 2\n[ 2526.718539] usb 1-1: new full-speed USB device number 3 using ohci-pci\n[ 2527.105378] usb 1-1: New USB device found, idVendor=80ee, idProduct=0021\n[ 2527.105388] usb 1-1: New USB device strings: Mfr=1, Product=3, SerialNumber=0\n[ 2527.105393] usb 1-1: Product: USB Tablet\n[ 2527.105399] usb 1-1: Manufacturer: VirtualBox\n[ 2527.152019] input: VirtualBox USB Tablet as /devices/pci0000:00/0000:00:06.0/usb1/1-1/1-1:1.0/0003:80EE:0021.0002/input/input8\n[ 2527.232240] hid-generic 0003:80EE:0021.0002: input,hidraw0: USB HID v1.10 Mouse [VirtualBox USB Tablet] on usb-0000:00:06.0-1/input0\n[ 2865.057333] helloModule: performing cleanup of module\n[ 2888.205365] helloModule: kernel module initialized\n[ 3021.971994] helloModule: performing cleanup of module\n[ 3045.980743] helloModule: kernel module initialized\n[ 3358.220063] helloModule: performing cleanup of module\n[ 3438.762378] helloModule: kernel module initialized\n[ 3950.763573] helloModule: performing cleanup of module\n[ 4001.871200] helloModule: kernel module initialized\n[ 4146.644108] helloModule: performing cleanup of module\n[ 4230.781248] helloModule: kernel module initialized\n[ 4354.724930] helloModule: performing cleanup of module\n[ 4356.440943] helloModule: kernel module initialized\n[ 4376.318716] helloModule: performing cleanup of module\n</code></pre>\n\n<p>My ubuntu version is 16.04 LTS</p>\n"}, {"tags": ["c", "volatile"], "comments": [{"owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1527672735, "post_id": 50601122, "comment_id": 88211435, "body": "Never use <code>volatile</code> for multi-threading purposes unless you understand your CPU reordering guarantees (note that the article you linked is about embedded systems, not general x86 CPUs). Use mutexes or atomics for multi-threaded access instead."}, {"owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1527673004, "post_id": 50601122, "comment_id": 88211626, "body": "The first article you&#39;ve linked to does not say anything about heap variables because there is generally no dynamic allocations on small embedded systems. If there were, there would be no difference from global variables. But, again, do not refer to articles about embedded when working with x86."}, {"owner": {"reputation": 4975, "user_id": 1609201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vbpcs.png?s=128&g=1", "display_name": "Elist", "link": "https://stackoverflow.com/users/1609201/elist"}, "reply_to_user": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1527673469, "post_id": 50601122, "comment_id": 88211964, "body": "Thanks, didn&#39;t think about not referring to heap on embedded systems. So, in my simple example case, since I only change each variable once in a multithreaded environment (hence no mutex needed?), can I assume the code will work as is, or should I still use atomics?"}, {"owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1527673813, "post_id": 50601122, "comment_id": 88212217, "body": "You should use atomics (because CPU optimizes code as well as the compiler itself, and <code>volatile</code> has no effect on that) and you should use <code>pthread_join</code> instead of that <code>while</code> loop."}, {"owner": {"reputation": 4975, "user_id": 1609201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vbpcs.png?s=128&g=1", "display_name": "Elist", "link": "https://stackoverflow.com/users/1609201/elist"}, "reply_to_user": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 0, "creation_date": 1527673899, "post_id": 50601122, "comment_id": 88212283, "body": "Off course, the <code>while</code> loop is only for demonstration."}], "owner": {"reputation": 4975, "user_id": 1609201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vbpcs.png?s=128&g=1", "display_name": "Elist", "link": "https://stackoverflow.com/users/1609201/elist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1527672774, "answer_count": 0, "score": 0, "last_activity_date": 1527672569, "creation_date": 1527672569, "question_id": 50601122, "link": "https://stackoverflow.com/questions/50601122/c-volatile-on-heap-variable-in-multithreaded-application", "closed_reason": "Duplicate", "title": "c - volatile on heap variable in multithreaded application", "body": "<p>I have read in <a href=\"https://barrgroup.com/Embedded-Systems/How-To/C-Volatile-Keyword\" rel=\"nofollow noreferrer\">several</a> <a href=\"https://www.geeksforgeeks.org/understanding-volatile-qualifier-in-c/\" rel=\"nofollow noreferrer\">places</a> that the <code>volatile</code> keyword should be used on:</p>\n\n<blockquote>\n  <p><strong>Global</strong> variables accessed by multiple tasks within a multi-threaded application</p>\n</blockquote>\n\n<p>I want to make sure I get it right - if I have a heap allocated variable, say a struct holding an integer, should I also use <code>volatile</code> or should it be considered as non-global variable?</p>\n\n<p>And if only global variables should be declared <code>volatile</code>, why is the difference?</p>\n\n<p>Simple Example:</p>\n\n<pre><code>struct my_struct\n{\n    int still_running;\n    int keep_running; // should it be declared 'int volatile'?\n};\n\ntypedef struct my_struct *my_struct_t;\n\nstatic void *my_thread_func(void *v)\n{\n    my_struct_t s = (my_struct_t) v;\n    do\n    {\n        printf(\"thread still running.\\n\");\n    } while (s-&gt;keep_running);\n\n    printf(\"thread stopping.\\n\");\n    s-&gt;still_running = 0;\n\n    return NULL;\n}\n\nint main(int argc, char **argv)\n{\n    my_struct_t s = (my_struct_t)malloc(sizeof(struct my_struct));\n    s-&gt;keep_running = 1;\n    s-&gt;still_running = 1;\n\n    pthread_t t;\n    pthread_create(&amp;t, NULL, my_thread_func, s);\n\n    usleep(1000);\n    s-&gt;keep_running = 0;\n\n    while(s-&gt;still_running);\n    free(s);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1527671724, "post_id": 50600800, "comment_id": 88210701, "body": "AFAIK that depends on the type of call , and thereafter its an implementation detail."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 14, "creation_date": 1527671849, "post_id": 50600800, "comment_id": 88210803, "body": "You can return structs in C as well."}, {"owner": {"reputation": 81, "user_id": 9869142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6324b3a83388a63621b7bc7dceb6d8?s=128&d=identicon&r=PG&f=1", "display_name": "iso532", "link": "https://stackoverflow.com/users/9869142/iso532"}, "reply_to_user": {"reputation": 32882, "user_id": 1870760, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/NAAkp.png?s=128&g=1", "display_name": "Hatted Rooster", "link": "https://stackoverflow.com/users/1870760/hatted-rooster"}, "edited": false, "score": 0, "creation_date": 1527671866, "post_id": 50600800, "comment_id": 88210817, "body": "@SombreroChicken - You mean that it can change with different architectures?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1527671951, "post_id": 50600800, "comment_id": 88210865, "body": "Even single architecture can have many calling conventions."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1527671977, "post_id": 50600800, "comment_id": 88210881, "body": "This question is super unclear. Please provide context and more explanation of the answer that you are trying to find."}, {"owner": {"reputation": 81, "user_id": 9869142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6324b3a83388a63621b7bc7dceb6d8?s=128&d=identicon&r=PG&f=1", "display_name": "iso532", "link": "https://stackoverflow.com/users/9869142/iso532"}, "edited": false, "score": 0, "creation_date": 1527672076, "post_id": 50600800, "comment_id": 88210947, "body": "I will add a code"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527672361, "post_id": 50600800, "comment_id": 88211149, "body": "Even within a particular calling convention, the exact passing is defined by other factors like size of the <code>struct</code> etc. You need to read the ABI document to know the exact way of passing or returning arguments."}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527672667, "post_id": 50600800, "comment_id": 88211400, "body": "&quot;(stack, heap, etc)?&quot;  what&#39;s etc here?  Are you just asking is the memory on the stack or heap for a return value for a function?"}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 1, "creation_date": 1527672840, "post_id": 50600800, "comment_id": 88211516, "body": "If the struct is small, it might very well fit in the <code>eax</code> register."}, {"owner": {"reputation": 5576, "user_id": 767632, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75a05c23a398c887e8f085b9c870586c?s=128&d=identicon&r=PG", "display_name": "yeputons", "link": "https://stackoverflow.com/users/767632/yeputons"}, "edited": false, "score": 4, "creation_date": 1527673100, "post_id": 50600800, "comment_id": 88211697, "body": "Depends on architecture, ABI, compiler, compiler flags, etc. It&#39;s generally either in register(s) (if the structure is small enough) or on stack, like a local variable."}, {"owner": {"reputation": 81, "user_id": 9869142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6324b3a83388a63621b7bc7dceb6d8?s=128&d=identicon&r=PG&f=1", "display_name": "iso532", "link": "https://stackoverflow.com/users/9869142/iso532"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527673186, "post_id": 50600800, "comment_id": 88211763, "body": "@UKMonkey - Yes. but also if it on the stack, so where? on the caller stack or in other place?"}, {"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 3, "creation_date": 1527673387, "post_id": 50600800, "comment_id": 88211896, "body": "A function doesn&#39;t have its own stack.  A thread does - meaning &quot;where&quot; on the stack is a question that doesn&#39;t really make any sense"}, {"owner": {"reputation": 2887, "user_id": 2422450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65c899826b7012b67268ee1899b40419?s=128&d=identicon&r=PG", "display_name": "Lanting", "link": "https://stackoverflow.com/users/2422450/lanting"}, "edited": false, "score": 1, "creation_date": 1527674101, "post_id": 50600800, "comment_id": 88212419, "body": "related: <a href=\"https://stackoverflow.com/questions/4931195/calling-convention-for-function-returning-struct\">Calling convention for function returning struct</a>"}, {"owner": {"reputation": 81, "user_id": 9869142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6324b3a83388a63621b7bc7dceb6d8?s=128&d=identicon&r=PG&f=1", "display_name": "iso532", "link": "https://stackoverflow.com/users/9869142/iso532"}, "reply_to_user": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 0, "creation_date": 1527675200, "post_id": 50600800, "comment_id": 88213148, "body": "@UKMonkey - I meant which function allocates the memory for that. But anyway PSkocik&#39;s answer explain that."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1527699502, "post_id": 50600800, "comment_id": 88229608, "body": "there are already tons of related and duplicate questions: <a href=\"https://stackoverflow.com/q/42411819/995714\">C++ on x86-64: when are structs/classes passed and returned in registers?</a>, <a href=\"https://stackoverflow.com/q/39068492/995714\">C/C++ returning struct by value under the hood</a>, <a href=\"https://stackoverflow.com/q/2155730/995714\">How do C compilers implement functions that return large structures?</a>, <a href=\"https://stackoverflow.com/q/24741218/995714\">how c compiler treats a struct return value from a function, in ASM</a>, <a href=\"https://stackoverflow.com/q/6731140/995714\">How does C return a structure?</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1527699568, "post_id": 50600800, "comment_id": 88229651, "body": "<a href=\"https://stackoverflow.com/q/22957175/995714\">How does function ACTUALLY return struct variable in C?</a>, <a href=\"https://stackoverflow.com/q/50600800/995714\">Return value via stack/register question(https://stackoverflow.com/q/5366121/995714), [Where are returned values stored?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3596, "user_id": 1753435, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b81cf3b8c8432e0bcac7322120a09b56?s=128&d=identicon&r=PG", "display_name": "andreee", "link": "https://stackoverflow.com/users/1753435/andreee"}, "edited": false, "score": 1, "creation_date": 1527674186, "post_id": 50601622, "comment_id": 88212474, "body": "<i>&#39;[...] should &quot;secretly&quot; write to them via a pointer&#39;</i>: In fact, most popular compilers do it that way. Check <a href=\"https://godbolt.org/g/WhFjMP\" rel=\"nofollow noreferrer\">godbolt.org/g/WhFjMP</a> for the output of different compilers on x86-64: almost always a pointer to RBP + offset is returned as in <code>mov eax, DWORD PTR [rbp-4]</code>."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 8, "last_activity_date": 1527674967, "last_edit_date": 1527674967, "creation_date": 1527673960, "answer_id": 50601622, "question_id": 50600800, "link": "https://stackoverflow.com/questions/50600800/where-are-returned-values-stored/50601622#50601622", "title": "Where are returned values stored?", "body": "<p>In C this depends on the ABI of the platform.</p>\n\n<p>On <a href=\"https://github.com/hjl-tools/x86-psABI/wiki/x86-64-psABI-r252.pdf\" rel=\"noreferrer\">x86_64 linux</a>, there are several classes of data types but in simple terms, small simple structs (~ &lt;= 2 longs) are returned in registers and large ones through the stack.</p>\n\n<p>The latest C++ should guarantee RVO (Return Value Optimization) I believe, which means structs/classes should get allocated on the stack in the caller and the callee should \"secretly\" write to them via a pointer (C ABIs/compilers can do this too, but in C++, RVO additionally avoids destruction and copy-construction).</p>\n\n<p>You can always look at the assembly or write a benchmark to verify the passing convention.  </p>\n\n<p>(In my opinion, it is, however, best to limit oneself to simple return types in C so you don't have to worry. (Original C didn't even allow one to return structs.) In C++ with RVO it shouldn't matter.)</p>\n"}], "owner": {"reputation": 81, "user_id": 9869142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6324b3a83388a63621b7bc7dceb6d8?s=128&d=identicon&r=PG&f=1", "display_name": "iso532", "link": "https://stackoverflow.com/users/9869142/iso532"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 1, "accepted_answer_id": 50601622, "answer_count": 1, "score": 6, "last_activity_date": 1527688834, "creation_date": 1527671646, "last_edit_date": 1527687282, "question_id": 50600800, "link": "https://stackoverflow.com/questions/50600800/where-are-returned-values-stored", "title": "Where are returned values stored?", "body": "<p>I know that coding with C, the return value of a function return to caller using %eax register. </p>\n\n<p>With c++ it is also possible to return structs and not just 'Primitive' types, so when a function returns a struct, where is the returned value stored (stack, heap, etc)?</p>\n\n<p>Example Code:</p>\n\n<pre><code>class Student\n{\nprivate:\n    int m_id;\npublic:\n    Student(int id)\n    {\n        m_id = id;\n    };\n    ~Student();\n    int getId()\n    {\n        return m_id;\n    };\n};\n\nStudent myFunc()\n{\n    return Student(123);\n}\n\nint main()\n{\n    //How does 'student1' get the value from the function?\n    //Does 'myFunc' write directly to the stack of main?\n    Student student1 = myFunc();\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "openssl", "nonblocking"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9869023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc5fcb757110b0a901d4101c14f1963?s=128&d=identicon&r=PG&f=1", "display_name": "sklein", "link": "https://stackoverflow.com/users/9869023/sklein"}, "edited": false, "score": 0, "creation_date": 1527672519, "post_id": 50600518, "comment_id": 88211272, "body": "Thank you dlmeetei for your time! My problem is that even if poll tells that the socket is readable, SSL_read() may return WANT_READ if not a full TLS-record has been received. So I&#39;m still stuck in the read. Furthermore if it only became readable as part of the renegotiation (initiated by the other side) I&#39;m stuck in the read although the other side has send nothing... Or am I wrong about this?"}], "tags": [], "owner": {"reputation": 7087, "user_id": 1389898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f2a3f2624a47edc48464d4929a7508?s=128&d=identicon&r=PG", "display_name": "dlmeetei", "link": "https://stackoverflow.com/users/1389898/dlmeetei"}, "is_accepted": false, "score": 0, "last_activity_date": 1527670826, "creation_date": 1527670826, "answer_id": 50600518, "question_id": 50600275, "link": "https://stackoverflow.com/questions/50600275/calling-ssl-write-when-ssl-read-returned-want-read/50600518#50600518", "title": "Calling SSL_write() when SSL_read() returned WANT_READ", "body": "<p><code>SSL_ERROR_WANT_WRITE</code> or <code>SSL_ERROR_WANT_READ</code> does not necessarily mean an error condition. It signifies that in order to proceed further, Read or write must be done first.</p>\n\n<p>Hence, if your <code>SSL_read</code> is returning either one of these. If you have to wait the condition to be fulfilled just the example in the book that you have mentioned. Untill then calling any other SSL API including <code>SSL_write</code> will not work.</p>\n\n<p>Perhaps, you can use ,if not used, select/poll/epoll or whatever to know any network activity on your socket</p>\n"}], "owner": {"reputation": 1, "user_id": 9869023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bc5fcb757110b0a901d4101c14f1963?s=128&d=identicon&r=PG&f=1", "display_name": "sklein", "link": "https://stackoverflow.com/users/9869023/sklein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 635, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527670826, "creation_date": 1527670126, "question_id": 50600275, "link": "https://stackoverflow.com/questions/50600275/calling-ssl-write-when-ssl-read-returned-want-read", "title": "Calling SSL_write() when SSL_read() returned WANT_READ", "body": "<p>I'm working on a client-application that uses OpenSSL for TLS using non-blocking I/O. Both sides of the connection may write at any time, indicating some state-change. So I need to check the socket regularly for new data to become available. If nothing has been received my code should immediately continue with the next task: sending new data from the client to the server.</p>\n\n<p>But I'm not sure, how I can do this with the OpenSSL-API: Calling <code>SSL_read()</code> on a socket where no data has been received (as the other side did not send anything) always results in an error-code of <code>SSL_ERROR_WANT_READ</code> (or even <code>SSL_ERROR_WANT_WRITE</code> in case of a renegotiation). In that case may I just continue with the next task and call <code>SSL_write()</code> to write other data to server? </p>\n\n<p>The man-page doesn't talk about this in detail. It just mentions that the arguments of the repeated read-call need to be exactly the same as before. The book <em>Network Security with OpenSSL</em> by Viega et. al. contains an example of non-blocking I/O. But the author waits for <code>SSL_read()</code> to succeed (reading 1 or more bytes) and only then calls <code>SSL_write()</code> to send data to the other side, which means that no write-operation is possible until data from the other side has been received. For my purpose this would not work.</p>\n\n<p>In a nutshell: If <code>SSL_read()</code> returns with <code>SSL_ERROR_WANT_WRITE</code> or <code>SSL_ERROR_WANT_READ</code> may I just call <code>SSL_write()</code> with other data before I repeat the read? And if not, how can I achieve that read-if-available-and-write-thing?</p>\n"}, {"tags": ["c", "lua"], "comments": [{"owner": {"reputation": 651, "user_id": 6834680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OvYt2.png?s=128&g=1", "display_name": "Egor   Skriptunoff", "link": "https://stackoverflow.com/users/6834680/egor-skriptunoff"}, "edited": false, "score": 1, "creation_date": 1527671380, "post_id": 50600271, "comment_id": 88210449, "body": "Replace <code>lua_settable(L, -2); &#47;&#47;set root.bar[0]</code> with <code>lua_settable(L, -3);</code>"}, {"owner": {"reputation": 651, "user_id": 6834680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OvYt2.png?s=128&g=1", "display_name": "Egor   Skriptunoff", "link": "https://stackoverflow.com/users/6834680/egor-skriptunoff"}, "edited": false, "score": 0, "creation_date": 1527671525, "post_id": 50600271, "comment_id": 88210549, "body": "Replace <code>lua_pushnumber(L, -2); &#47;&#47;set current item index to 2</code> with <code>lua_pushnumber(L, 2);</code>"}], "owner": {"reputation": 185, "user_id": 357366, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2185c59502aab79a52a762aebbd3fda5?s=128&d=identicon&r=PG", "display_name": "anatoly.kryzhanosky", "link": "https://stackoverflow.com/users/357366/anatoly-kryzhanosky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527671692, "creation_date": 1527670124, "question_id": 50600271, "link": "https://stackoverflow.com/questions/50600271/child-table-with-keys", "title": "Child table with keys", "body": "<p>good day\ni need return structure from C code to Lua.\nMy structure has named fields, one of them is array of other named structure:</p>\n\n<pre><code>{\n    \"foo\": 1,\n    \"bar\": [\n        {\"field1\": 11, \"field2\": 12},\n        {\"field1\": 21, \"field2\": 22}\n    ],\n    \"baz\": 3\n}\n</code></pre>\n\n<p>i wrote this code:</p>\n\n<pre><code>lua_createtable(L, 0, 3); //0 indexed items, 3 keyed items\n\nlua_pushnumber(L, 1);\nlua_setfield(L, -2, \"foo\"); //root.foo = 1;\n\nlua_createtable(L, 2, 0); //child table for bar field with 2 indexed items and 0 keyed\n\nlua_pushnumber(L, 1); // set current item index to 1\n\nlua_createtable(L, 0, 2); // child table with 2 keyed items\n\nlua_pushnumber(L, 11);\nlua_setfield(L, -2, \"field1\"); //root.bar[0].field1 = 11;\n\nlua_pushnumber(L, 12);\nlua_setfield(L, -2, \"field2\"); //root.bar[0].field2 = 12;\n\nlua_settable(L, -2); //set root.bar[0]\n\nlua_pushnumber(L, -2); //set current item index to 2\n\nlua_createtable(L, 0, 2); //table for second bar items with 2 keys\n\nlua_pushnumber(L, 21);\nlua_setfield(L, -2, \"field1\"); //root.bar[1].field1 = 21;\n\nlua_pushnumber(L, 22);\nlua_setfield(L, -2, \"field2\"); //root.bar[1].field2 = 22;\n\nlua_settable(L, -2); //set root.bar[1]\nlua_setfield(L, -2, \"bar\"); //set root.bar\n\nlua_pushnumber(L, 3);\nlua_setfield(L, -2, \"baz\"); //root.baz = 3;\n</code></pre>\n\n<p>but it failed with exception. previous i try to do this without lua_settable and call lua_setfield(L, -2, \"bar\") for child table after lua_createtalbe(L, 2, 0) but then i receive structure with follow fields:</p>\n\n<pre><code>root.field1 = 21\nroot.field2 = 22\nroot.baz = 3\n</code></pre>\n\n<p>how can i achieve target structure?</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1527669338, "post_id": 50599928, "comment_id": 88209096, "body": "Usually you should keep track of the elements you added to the set in say a separate array and then iterate over that. You can check if an fd is in a set using <code>FD_ISSET</code>"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1527670604, "post_id": 50599928, "comment_id": 88209881, "body": "Don&#39;t use <code>select</code>. Use <code>poll</code>. It&#39;s easier to use anyway, and the former has fundamental interface flaws that make it impossible to use high fd numbers without undefined behavior and hacks."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1527670451, "last_edit_date": 1527670451, "creation_date": 1527669291, "answer_id": 50599995, "question_id": 50599928, "link": "https://stackoverflow.com/questions/50599928/in-c-how-can-i-access-iterate-through-file-descriptors-that-are-added-dynamicall/50599995#50599995", "title": "In C how can I access/iterate through file descriptors that are added dynamically to an fd_set?", "body": "<p>Keep your <em>own</em> list of connected \"users\", like a linked list of structures containing what is needed for each user (like username and other data) <em>and</em> the socket descriptor.</p>\n\n<p>Then if you need to send a message to all users just iterate over this list. Since the structures contain all information about the user, it's easy to skip one or more users when iterating, for example to not send to the user from which the message originated.</p>\n\n<hr>\n\n<p>Simple example</p>\n\n<pre><code>struct user\n{\n    char  *name;    // Name of the user\n    SOCKET socket;  // Socket descriptor for communication\n    // Other data needed for the user...\n    struct user *next;  // For linking into a list\n};\n\n// The list of all users\nstruct user *users = NULL;\n\n// Broadcast a message to *all* connected users\nvoid broadcast(const char *message)\n{\n    for (struct user *u = users; u != NULL; u = u-&gt;next)\n    {\n        send(u-&gt;socket, message, strlen(message), 0);\n    }\n}\n\n// Broadcast to all except a specific user\nvoid broadcast_except_name(const char *message, const char *name)\n{\n    for (struct user *u = users; u != NULL; u = u-&gt;next)\n    {\n        if (strcmp(u-&gt;name, name) != 0)\n        {\n            send(u-&gt;socket, message, strlen(message), 0);\n        }\n    }\n}\n\n// Broadcast to all except a specific socket\nvoid broadcast_except_socket(const char *message, SOCKET socket)\n{\n    for (struct user *u = users; u != NULL; u = u-&gt;next)\n    {\n        if (u-&gt;socket != socket)\n        {\n            send(u-&gt;socket, message, strlen(message), 0);\n        }\n    }\n}\n</code></pre>\n\n<p><sub>[Functions for creating or otherwise operating on the list omitted]</sub></p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1527669467, "creation_date": 1527669467, "answer_id": 50600057, "question_id": 50599928, "link": "https://stackoverflow.com/questions/50599928/in-c-how-can-i-access-iterate-through-file-descriptors-that-are-added-dynamicall/50600057#50600057", "title": "In C how can I access/iterate through file descriptors that are added dynamically to an fd_set?", "body": "<p>Get in the habit of reading manpages. The one for <a href=\"https://linux.die.net/man/2/select\" rel=\"nofollow noreferrer\">select(2)</a> lists the macros provided for <code>fd_set</code>:</p>\n\n<pre><code>   void FD_CLR(int fd, fd_set *set);\n   int  FD_ISSET(int fd, fd_set *set);\n   void FD_SET(int fd, fd_set *set);\n   void FD_ZERO(fd_set *set);\n</code></pre>\n\n<p>You can use <code>FD_SET</code> and <code>FD_ISSET</code> macros to set or test the bits in <code>fd_set</code> that correspond to your filedescriptors.</p>\n"}, {"tags": [], "owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "is_accepted": false, "score": 1, "last_activity_date": 1527669576, "creation_date": 1527669576, "answer_id": 50600098, "question_id": 50599928, "link": "https://stackoverflow.com/questions/50599928/in-c-how-can-i-access-iterate-through-file-descriptors-that-are-added-dynamicall/50600098#50600098", "title": "In C how can I access/iterate through file descriptors that are added dynamically to an fd_set?", "body": "<p>In C, you use the macro <code>FD_ISSET</code> to find out whether a given bit is set or not. See the <a href=\"http://manpages.ubuntu.com/manpages/xenial/en/man2/select.2.html\" rel=\"nofollow noreferrer\">manual page for <code>select</code>(2)</a> for details.</p>\n\n<p>The basic idea is that first you zero the set with <code>FD_ZERO</code>, then you set some bits with <code>FD_SET</code>, then you call <code>select()</code> (or <code>pselect()</code>, according to taste). When <code>select()</code> returns you iterate over the set and use <code>FD_ISSET</code> to find out whether you can do a non-blocking I/O operation on the specified descriptor.</p>\n\n<p>There are many examples on the net; for example, <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_72/rzab6/xnonblock.htm\" rel=\"nofollow noreferrer\">an example from IBM</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 7909380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207030823408016/picture?type=large", "display_name": "Ashley Shirley", "link": "https://stackoverflow.com/users/7909380/ashley-shirley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1527670451, "creation_date": 1527669050, "question_id": 50599928, "link": "https://stackoverflow.com/questions/50599928/in-c-how-can-i-access-iterate-through-file-descriptors-that-are-added-dynamicall", "title": "In C how can I access/iterate through file descriptors that are added dynamically to an fd_set?", "body": "<p>I am trying to implement a server / multi client program in Linux with C using select() and fd_sets. I am trying to broadcast messages sent from one connected client to all other connected clients but I don't know how to access the sockets for other clients in the fd_set once they are added dynamically. I am trying to replicate an implementation of this I found in C++ but the fd_set in C doesn't have the properties as C++. This is the code I'm trying to replicate:</p>\n\n<pre><code>for(int i = 0; i &lt; master.fd_count; i++)\n{\n    SOCKET outSock = master.fd_array[i];\n    if(outSock != listening &amp;&amp; outSock != sock)\n    {\n        send(outSock, buffer, 250);\n    }\n}\n</code></pre>\n\n<p>where <code>master</code> is the fd_set, <code>listening</code> is the original socket listening for new clients and <code>sock</code> is the socket the message about to be broadcast came from.</p>\n\n<p>Can any one help me learn how to access the fd_set socket elements to be able to do <code>!=</code> comparisons on them like in the example. Or alternatively, point me to another method to implement the multi client setup where I can broadcast a message back to all connected clients. I initially tried using multi processes with  <code>fork()</code> pipes but I could not find enough information on how to implement that properly.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "edited": false, "score": 0, "creation_date": 1527668068, "post_id": 50599369, "comment_id": 88208268, "body": "How can you compile it without declaration ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527669009, "post_id": 50599369, "comment_id": 88208865, "body": "This is because you are using a 30 years old dinosaur compiler. Get a new compiler or use your current one correctly, for example <code>gcc -std=c99</code>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 1758283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449c667deda9bca40f7cf86236ee60c?s=128&d=identicon&r=PG", "display_name": "Wei-Tsung Su", "link": "https://stackoverflow.com/users/1758283/wei-tsung-su"}, "edited": false, "score": 0, "creation_date": 1527668555, "post_id": 50599651, "comment_id": 88208570, "body": "Why gcc consider that it is a warning not an error if the prototype is not given? Since I can pass the compilation without giving prototype."}, {"owner": {"reputation": 2651, "user_id": 3371258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hmVpr.png?s=128&g=1", "display_name": "Candy Gumdrop", "link": "https://stackoverflow.com/users/3371258/candy-gumdrop"}, "reply_to_user": {"reputation": 71, "user_id": 1758283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449c667deda9bca40f7cf86236ee60c?s=128&d=identicon&r=PG", "display_name": "Wei-Tsung Su", "link": "https://stackoverflow.com/users/1758283/wei-tsung-su"}, "edited": false, "score": 0, "creation_date": 1527669832, "post_id": 50599651, "comment_id": 88209401, "body": "@Wei-TsungSu Calling a function without first declaring it is valid in C89 (and implicitly declares the function as <code>int ()</code>\u2014see PSkocic&#39;s answer), but is invalid in newer C standards (C99+).  GCC may allow it anyway in newer standards for backwards-compatibility."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1527671249, "last_edit_date": 1527671249, "creation_date": 1527668258, "answer_id": 50599651, "question_id": 50599369, "link": "https://stackoverflow.com/questions/50599369/passing-parameters-to-function-in-different-file-gcc/50599651#50599651", "title": "Passing parameters to function in different file (gcc)", "body": "<p>Before using <code>add</code> in <code>Main.c</code>, it needs to know the declaration for this function. Without using function prototype in this case the behavior of the program would be undefined. You can either add a prototype before <code>main</code> as you did or you can create a separate <code>Add.h</code> file and put the prototype there.<br>\nIn second case you need to add <code>Add.h</code> to both <code>.c</code> files.  </p>\n\n<p>Add.h  </p>\n\n<pre><code>#ifndef ADD_H\n#define ADD_H\n\nint add(int x, int y;\n\n#endif\n</code></pre>\n\n<p>Add.c</p>\n\n<pre><code>#include \"Add.h\"\nint add(int x, int y) { return x + y;}\n</code></pre>\n\n<p>Main.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#inclide \"Add.h\"\n\nint main(void) {\n    printf(\"%d\\n\", add(10, 20));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1527668934, "post_id": 50599677, "comment_id": 88208809, "body": "This would work (since #inclusion is just text-pasting), but is a very bad practice especially in a larger project where it&#39;ll lead to linker conflicts when the header is included in multiple translation units. It&#39;s very highly advisable that headers shouldn&#39;t contain (non-static, non-inline) function definitions."}], "tags": [], "owner": {"reputation": 31, "user_id": 9786170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uuvyhU6hlmY/AAAAAAAAAAI/AAAAAAAAAAc/xLNI9avIz9w/photo.jpg?sz=128", "display_name": "vbhv", "link": "https://stackoverflow.com/users/9786170/vbhv"}, "is_accepted": false, "score": 0, "last_activity_date": 1527668324, "creation_date": 1527668324, "answer_id": 50599677, "question_id": 50599369, "link": "https://stackoverflow.com/questions/50599369/passing-parameters-to-function-in-different-file-gcc/50599677#50599677", "title": "Passing parameters to function in different file (gcc)", "body": "<p>To make this work, first of all, you have to include the \"add.c\" file into the \"main.c\". Coz main.c doesn't know about \"add\" function in add.c. (Also you should not make '.c' file to add a function or something. Instead use '.h')</p>\n\n<p>Now the solution should look like this...</p>\n\n<p>add.h</p>\n\n<pre><code>int add(int x, int y){\n    return x + y;\n}\n</code></pre>\n\n<p>main.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include \"add.h\"\nint main(void){\n    printf(\"%d\\n\", add(10, 20));\n    return 0;\n}\n</code></pre>\n\n<p>Make sure to keep both the files in same directory.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 1, "last_activity_date": 1527669631, "last_edit_date": 1527669631, "creation_date": 1527668337, "answer_id": 50599682, "question_id": 50599369, "link": "https://stackoverflow.com/questions/50599369/passing-parameters-to-function-in-different-file-gcc/50599682#50599682", "title": "Passing parameters to function in different file (gcc)", "body": "<p>Without the declaration, which is more specifically a prototype (a declaration with specified parameter types), you're relying on an implicit prototype-less declaration of the function (which is now an obsolescent feature of C).</p>\n\n<p>The implicit prototype for function <code>f</code> is <code>int f()</code>\u2014a function returning <code>int</code> and taking an unspecified number of parameters.</p>\n\n<p>The way functions without prototypes are called is the arguments are <em>promoted</em> (lesser than <code>int</code> integer types to <code>int</code> and <code>float</code>s to <code>double</code>s) and passed to the function in an implementation-defined way. If the arguments don't match the definition, the behavior is undefined (your case).</p>\n\n<p>You could fix this (while still relying on the implicit declaration)  by providing explicit casts:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n//nothing (probably will get a compiler warning) or\nint add(); /*=params unspecified*/ \nint main(void) {\n    printf(\"%d\\n\", add((int)10.5, (int)20.5));\n}\n</code></pre>\n\n<p>thereby removing the UB (undefined behavior), or you can include the prototype as you have, which will make the compiler convert passed-in <code>float</code>s to match the expected types (<code>int</code>). In other words, with the prototype, the compiler will insert these casts for you, seeing that a conversion from <code>float</code> to <code>int</code> in (argument) assignment.</p>\n\n<p>The preferred way to solve this is with a prototype included via a header which is also included in the implementation file (Add.c) so as to allow to compiler to verify the call is consistent with the definition.</p>\n"}], "owner": {"reputation": 71, "user_id": 1758283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1449c667deda9bca40f7cf86236ee60c?s=128&d=identicon&r=PG", "display_name": "Wei-Tsung Su", "link": "https://stackoverflow.com/users/1758283/wei-tsung-su"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1527671249, "creation_date": 1527667347, "last_edit_date": 1527668091, "question_id": 50599369, "link": "https://stackoverflow.com/questions/50599369/passing-parameters-to-function-in-different-file-gcc", "title": "Passing parameters to function in different file (gcc)", "body": "<p>I wrote an add function for int in Add.c. Then, I passed real numbers to this add function in Main.c. The codes are shown as follows.</p>\n\n<p>If I have declaration of add function before calling it, the answer is correct as 30. However, if the declaration does not exist, the answer is incorrect. Why?    </p>\n\n<p>Add.c</p>\n\n<pre><code>int add(int x, int y) { return x + y;}\n</code></pre>\n\n<p>Main.c</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint add(int, int); // If this does not exist, the answer is not 30.\nint main(void) {\n    printf(\"%d\\n\", add(10.5, 20.5));\n}\n</code></pre>\n"}, {"tags": ["c", "regex"], "comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "reply_to_user": {"reputation": 148466, "user_id": 2319407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98O16.jpg?s=128&g=1", "display_name": "Dmitry Bychenko", "link": "https://stackoverflow.com/users/2319407/dmitry-bychenko"}, "edited": false, "score": 0, "creation_date": 1527665332, "post_id": 50598736, "comment_id": 88206603, "body": "Didn&#39;t change... Also, wouldn&#39;t the anchors accept empty strings? quoting MAN: <code>Match-beginning-of-line operator (^) matches the empty string immediately after a newline</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1527665470, "post_id": 50598736, "comment_id": 88206705, "body": "The dot must be escaped and the first number with dot pattern must be grouped, the limiting quantifier should quantify that group. Also, anchor the pattern and use <code>REG_EXTENDED</code> flag: <code>&quot;^([0-9]{1,3}\\\\.){3}[0-9]{1,3}$&quot;</code> + <code>regcomp(&amp;regex, &quot;^([0-9]{1,3}\\\\.){3}[0-9]{1,3}$&quot;, REG_EXTENDED)</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1527667396, "post_id": 50598736, "comment_id": 88207876, "body": "Looks like my answer is complete now."}], "answers": [{"comments": [{"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527684266, "post_id": 50598939, "comment_id": 88219346, "body": "Thanks for the elaboration! what about &lt;username&gt;:&lt;password&gt; regex? I though of <code>&quot;^[a-zA-Z0-9$-_.+!*&#39;(),]+:[a-zA-Z0-9$-_.+!*&#39;(),]+$&quot;</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527684356, "post_id": 50598939, "comment_id": 88219417, "body": "@CIsForCookies You are welcome. Password regex depends on the requirements, and it is a different question. Just note that <code>$-_</code> creates a range inside the bracket expression."}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 0, "creation_date": 1527685391, "post_id": 50598939, "comment_id": 88220207, "body": "Ok, I have one final question about a file path. Would this regex have any obvious problems I missed? <code>&quot;^[[a-zA-Z0-9_]+[&#47;]?]*[a-zA-Z0-9_]+\\\\.[a-zA-Z]+$&quot;</code>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1527685833, "post_id": 50598939, "comment_id": 88220530, "body": "@CIsForCookies Yes, a lot. It does not match any Windows file path (like <code>C:\\Windows\\test.txt</code>), and it does not match lots of valid Linux file paths. You know, there are files without extensions. And <code>[[a-zA-Z0-9_]+[&#47;]?]*</code> looks fishy. Probably you meant <code>[a-zA-Z0-9_]+(&#47;[a-zA-Z0-9_]+)*</code>. You are re-inventing a wheel here. Use the dedicated libraries if you can find any."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1527667132, "last_edit_date": 1527667132, "creation_date": 1527665936, "answer_id": 50598939, "question_id": 50598736, "link": "https://stackoverflow.com/questions/50598736/regex-matches-wrong-strings/50598939#50598939", "title": "regex matches wrong strings", "body": "<p>Use</p>\n\n<pre><code>int ret = regcomp(&amp;regex, \"^([0-9]{1,3}\\\\.){3}[0-9]{1,3}$\", REG_EXTENDED);\n</code></pre>\n\n<p>Or, a more efficient one:</p>\n\n<pre><code>int ret = regcomp(&amp;regex, \"^[0-9]{1,3}(\\\\.[0-9]{1,3}){3}$\", REG_EXTENDED);\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/u6zuTt/1\" rel=\"nofollow noreferrer\">this regex demo</a> that also matches wrong IP addresses like <code>1.2.34.567</code> and <code>123.456.789.123</code>. So, I'd suggest a more precise one (source: <a href=\"https://www.regular-expressions.info/ip.html\" rel=\"nofollow noreferrer\">regular-expresions.info</a>):</p>\n\n<pre><code>\"^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\\\\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}$\"\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/u6zuTt/2/\" rel=\"nofollow noreferrer\">this regex demo</a>.</p>\n\n<p>See the <a href=\"https://ideone.com/bRzUQL\" rel=\"nofollow noreferrer\">C demo</a>. The output is</p>\n\n<pre><code>0.0.0.0 - Match\n123.456.789.123 - No Match\na.b.c.d - No Match\n1.2.34.567 - No Match\n1111.1.1.1 - No Match\n.1.1.1 - No Match\n1,1,1,1 - No Match\n</code></pre>\n\n<p><strong>POIs</strong></p>\n\n<ul>\n<li>The dot matches any char, so you must escape it with <code>\\\\</code> in the pattern</li>\n<li>If you have to repeat a sequence of patterns, you need to <em>group</em> them and quantify the group: <code>[0-9]{1,3}\\\\.{3}</code> => <code>([0-9]{1,3}\\\\.){3}</code></li>\n<li>To match the whole string, you need <em>anchors</em>, <code>^</code> and <code>$</code> around the pattern</li>\n<li>To make the <code>$</code> anchor work, you need to pass <code>REG_EXTENDED</code> flag to <code>regcomp</code>. It is also required if you plan to use <code>{3}</code> without having to escape the <code>{</code> and <code>}</code>. Else, you would have to follow the BRE POSIX specs and write a limiting quantifier like <code>\\{3\\}</code></li>\n<li>As <code>[0-9]{1,3}</code> matches any 3 digits, the original pattern is not really validating IP addresses, so you need to restrict the octet values to <code>0</code>..<code>255</code>. Thus, an alternation group <code>(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])</code> should be used to match one octet.</li>\n</ul>\n\n<p>Here is the octet pattern explanation:</p>\n\n<ul>\n<li><code>25[0-5]</code> - <code>250</code> to <code>255</code></li>\n<li><code>|</code> - or</li>\n<li><code>2[0-4][0-9]</code> - <code>200</code> to <code>249</code></li>\n<li><code>|</code> - or</li>\n<li><code>1[0-9][0-9]</code> - <code>100</code> to <code>199</code></li>\n<li><code>|</code> - or</li>\n<li><code>[1-9]?[0-9]</code> - <code>0</code> to <code>99</code>.</li>\n</ul>\n"}], "owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 50598939, "answer_count": 1, "score": 1, "last_activity_date": 1527667132, "creation_date": 1527665168, "last_edit_date": 1527665704, "question_id": 50598736, "link": "https://stackoverflow.com/questions/50598736/regex-matches-wrong-strings", "title": "regex matches wrong strings", "body": "<p>I'm trying to use <code>regex.h</code> with no success. I'm trying to match an IP address</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;regex.h&gt;\n\n#define No_Regex_Flags 0\n\nvoid check_RE(char * r, regex_t RE)\n{\n    printf (\"%s - %s\\n\", r, !regexec(&amp;RE, r, 0, NULL, 0) ? \"Match\" : \"No Match\");\n}\n\nint main ()\n{\n    regex_t regex;\n    int ret = regcomp(&amp;regex, \"[0-9]{1,3}.{3}[0-9]{1,3}\", No_Regex_Flags);\n    if(ret)\n        printf(\"err1\\n\");\n\n    char  RE_list[][32] = \n    {\n        \"0.0.0.0\",\n        \"123.456.789.123\",\n        \"a.b.c.d\",\n        \"1.2.34.567\",\n        \"1111.1.1.1\",\n        \".1.1.1\",\n        \"1,1,1,1\"\n    };\n\n    for(int i = 0; i &lt; sizeof(RE_list) / sizeof(RE_list[0]); i++)\n        check_RE(RE_list[i], regex);\n\n    return 0;\n}\n</code></pre>\n\n<p>However, the output I get is always a match:</p>\n\n<pre><code>0.0.0.0 - Match\n123.456.789.123 - Match\na.b.c.d - Match\n1.2.34.567 - Match\n1111.1.1.1 - Match\n.1.1.1 - Match\n1,1,1,1 - Match\n</code></pre>\n\n<p>Why is that?</p>\n"}, {"tags": ["c", "doubly-linked-list"], "comments": [{"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1527664286, "post_id": 50598363, "comment_id": 88205919, "body": "<code>&lt;malloc.h&gt;</code> is deprecated (and linux-specific), use <code>&lt;stdlib.h&gt;</code> instead."}, {"owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1527664344, "post_id": 50598363, "comment_id": 88205961, "body": "Typecasting at <code>(node*)malloc(sizeof(node));</code> is needless. Read more on this at <a href=\"https://stackoverflow.com/q/605845/4228131\">Do I cast the result of malloc?</a>"}, {"owner": {"reputation": 1, "user_id": 9868451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uU1GemfGsh8/AAAAAAAAAAI/AAAAAAAAAFM/O-r_FS0L87A/photo.jpg?sz=128", "display_name": "Debasrito Lahiri", "link": "https://stackoverflow.com/users/9868451/debasrito-lahiri"}, "reply_to_user": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "edited": false, "score": 0, "creation_date": 1527664615, "post_id": 50598363, "comment_id": 88206127, "body": "I did that. But, it doesn&#39;t solve my problem."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1527668180, "post_id": 50598363, "comment_id": 88208330, "body": "Your program has undefined behavior because you assign the pointer to a local variable to your <code>start</code> node, and then attempt to deference that later."}, {"owner": {"reputation": 1322, "user_id": 1087492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RU0jR.jpg?s=128&g=1", "display_name": "Lloyd Macrohon", "link": "https://stackoverflow.com/users/1087492/lloyd-macrohon"}, "edited": false, "score": 0, "creation_date": 1527673530, "post_id": 50598363, "comment_id": 88212019, "body": "You need to allocate node in your input function. Also, you dereference n1-&gt;previous (i.e. n1-&gt;previous-&gt;next) which may also be NULL, but check for it afterwards. All your node objects should be pointers, otherwise you are calling free on an object that is on the stack."}, {"owner": {"reputation": 1, "user_id": 9868451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uU1GemfGsh8/AAAAAAAAAAI/AAAAAAAAAFM/O-r_FS0L87A/photo.jpg?sz=128", "display_name": "Debasrito Lahiri", "link": "https://stackoverflow.com/users/9868451/debasrito-lahiri"}, "edited": false, "score": 0, "creation_date": 1527857318, "post_id": 50598363, "comment_id": 88297819, "body": "Thanks. I just had to check for both n1-&gt;previous and n1-&gt;next whether they were null or not together I.e &amp;&amp; both condns. in one if. I also had to add another line for n1-&gt;next!= NULL condn. That did it. I will give the new corrected code below if possible."}], "owner": {"reputation": 1, "user_id": 9868451, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uU1GemfGsh8/AAAAAAAAAAI/AAAAAAAAAFM/O-r_FS0L87A/photo.jpg?sz=128", "display_name": "Debasrito Lahiri", "link": "https://stackoverflow.com/users/9868451/debasrito-lahiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527665351, "creation_date": 1527664010, "last_edit_date": 1527665351, "question_id": 50598363, "link": "https://stackoverflow.com/questions/50598363/deletion-algorithm-of-doubly-linked-list", "title": "Deletion algorithm of doubly linked list", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;malloc.h&gt;\n\nstruct list {\n    char name[30];\n    char subject1[30];\n    char subject2[30];\n    struct list* next;\n    struct list* previous;\n};\n\ntypedef struct list node;\n\nnode input(node* n1)\n{\n    node n2;\n    n2.previous=n1;\n    n1-&gt;next=&amp;n2;\n    n2.next=NULL;\n    scanf(\"%s\",n2.name);\n    scanf(\"%s\",n2.subject1);\n    scanf(\"%s\",n2.subject2);\n    return n2;\n}\n\nvoid delete(node *n1)\n{\n    if(n1-&gt;next!=NULL)  \n        n1-&gt;previous-&gt;next=n1-&gt;next;\n    else\n        n1-&gt;previous-&gt;next=NULL;\n    if(n1-&gt;previous!=NULL)  \n        n1-&gt;next-&gt;previous=n1-&gt;previous;\n    printf(\"\\nDeleting....\");\n    free(n1);\n}\n\nint main()\n{\n    node* start;\n    start=(node*)malloc(sizeof(node));\n    node n1=input(start);\n    node n2=input(&amp;n1);\n    start-&gt;previous=NULL;\n    printf(\"%s %s %s %s %s %s\",n1.name,n1.subject1,n1.subject2,n2.name,n2.subject1,n2.subject2);\n    delete(&amp;n1);\n    delete(&amp;n2);\n    delete(start);\n    return 0;\n}\n</code></pre>\n\n<p>The deletion is not happening properly. It's giving an unhandled exception returning 255 error. Also, in books only the n1 node is being deleted and the start(header) and last node is being left as it is. But, I want to delete all the nodes and header. Please explain and correct. Also, I am writing this code in C and C++. Please correct accordingly.</p>\n"}, {"tags": ["c", "fopen"], "answers": [{"comments": [{"owner": {"reputation": 144, "user_id": 9153443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a851333a9ec10d92ea818d7514a0735b?s=128&d=identicon&r=PG&f=1", "display_name": "RSSB", "link": "https://stackoverflow.com/users/9153443/rssb"}, "edited": false, "score": 0, "creation_date": 1527666269, "post_id": 50598913, "comment_id": 88207202, "body": "What it means by combinations and what are those &#39;eight&#39; combinations and in the last part do you mean to say that flag must not be neither _EOF nor _ERR nor their combination of any sort(with each other or with any other flag bit)? Please reply"}, {"owner": {"reputation": 767, "user_id": 4694206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/701006f9bb2efc54349e1bce7b21ea0a?s=128&d=identicon&r=PG&f=1", "display_name": "wahab", "link": "https://stackoverflow.com/users/4694206/wahab"}, "edited": false, "score": 1, "creation_date": 1527670624, "post_id": 50598913, "comment_id": 88209909, "body": "There are eight (2^3) possible combinations of these three flags and any combination can be used because these flags are independent of each other. The example given by @rici tests that file fp is open for reading and both _EOF and _ERR flags are 0."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1527665846, "creation_date": 1527665846, "answer_id": 50598913, "question_id": 50598201, "link": "https://stackoverflow.com/questions/50598201/kr-fopen-and-fillbuf/50598913#50598913", "title": "k&amp;r fopen and fillbuf", "body": "<p>The enum values are flag bits and the <code>flag</code> member can have several of them set. (Not all combinations are meaningful, but many are; the <code>__READ</code>, <code>__EOF</code> and <code>__ERR</code> flags are independent of each other and all eight combinations are possible.).</p>\n\n<p>Consequently</p>\n\n<pre><code>if((fp-&gt;flag &amp; (_READ|_EOF|_ERR))!=_READ)\n</code></pre>\n\n<p>Tests that the file is open for reading and has neither the error nor the EOF flags set.</p>\n"}], "owner": {"reputation": 144, "user_id": 9153443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a851333a9ec10d92ea818d7514a0735b?s=128&d=identicon&r=PG&f=1", "display_name": "RSSB", "link": "https://stackoverflow.com/users/9153443/rssb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50598913, "answer_count": 1, "score": 1, "last_activity_date": 1527665846, "creation_date": 1527663509, "question_id": 50598201, "link": "https://stackoverflow.com/questions/50598201/kr-fopen-and-fillbuf", "title": "k&amp;r fopen and fillbuf", "body": "<p>I have a question regarding the other question asked on stack overflow:- <a href=\"https://stackoverflow.com/questions/41792701/segmentation-fault-on-c-kr-fopen-and-fillbuf\">segmentation fault on c K&amp;R fopen and fillbuf</a>. In this question there is a discussion of flags in struct _iobuf. These are used as different access modes. But down here in enum flags there are are some particular values of flags. So will 'flag' take only these particular values or these are some standard values whereas flag can take some other values as well? My doubt arises from the fact that while defining the array _iob only the three standard values (for stdin, stdout, stderr) were given(out of 20) so the fp can take some other values as well(17 others at the same time). The second doubt is that if flag can take only the defined values like(_READ,_WRITE etc.), then in int _fillbuf() function in place of writing                </p>\n\n<pre><code>if((fp-&gt;flag &amp; (_READ|_EOF|_ERR))!=_READ)\n</code></pre>\n\n<p>can we write as </p>\n\n<pre><code>if((fp-&gt;flag==_WRITE || fp-&gt;flag== _UNBUF))\n</code></pre>\n\n<p>because out of the given fixed flag values it still makes sense.</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "edited": false, "score": 0, "creation_date": 1527662708, "post_id": 50597906, "comment_id": 88205032, "body": "<code>temp-&gt;next-&gt;prev1</code> == <code>(*(*temp).next).prev</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1527663062, "post_id": 50597906, "comment_id": 88205253, "body": "Why would you write <code>temp-&gt;next-&gt;prev</code> instead of <code>temp</code> though?"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1527663159, "post_id": 50597906, "comment_id": 88205319, "body": "@Lundin possibly to check if the links are correct. <code>temp-&gt;next-&gt;prev == temp</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1527663270, "post_id": 50597906, "comment_id": 88205383, "body": "@KamiKaze If <code>temp-&gt;next-&gt;prev</code> is incorrect, why would <code>temp-&gt;next</code> be any better? Though I suppose could like this might rather make sense during insertion of a new node in a linked list."}], "answers": [{"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 4, "last_activity_date": 1527662870, "creation_date": 1527662870, "answer_id": 50598011, "question_id": 50597906, "link": "https://stackoverflow.com/questions/50597906/how-a-pointer-accesss-a-data-member-of-structure/50598011#50598011", "title": "how a pointer accesss a data member of structure", "body": "<p>The field selector \".\", which is a postfix operator, has higher precedence than pointer dereference \"*\", which is a prefix operator, so the expression should be <code>(*(*temp).next).prev</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8664472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1502170286487742/picture?type=large", "display_name": "Saurabh Kapoor", "link": "https://stackoverflow.com/users/8664472/saurabh-kapoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527662870, "creation_date": 1527662511, "last_edit_date": 1527662637, "question_id": 50597906, "link": "https://stackoverflow.com/questions/50597906/how-a-pointer-accesss-a-data-member-of-structure", "title": "how a pointer accesss a data member of structure", "body": "<p>I am making a doubly link list and  I used <code>temp-&gt;next-&gt;prev</code> for accessing the previous address of the next node and when I wrote <code>*((*temp).next).prev</code> instead of the previous syntax it didn't work .can anyone please explain the mistake and the reason of the mistake ?</p>\n"}, {"tags": ["c", "graph", "adjacency-list"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662388, "post_id": 50597763, "comment_id": 88204842, "body": "What do you mean by &quot;call the adjacency list into the struct array&quot;?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662462, "post_id": 50597763, "comment_id": 88204886, "body": "If this is a homework you might consider approaching it according to the quite well-accepted compromise described here: <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\" title=\"how do i ask and answer homework questions\">meta.stackoverflow.com/questions/334822/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9610023"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662468, "post_id": 50597763, "comment_id": 88204888, "body": "a better way to say it is i dont know how to properly call the struct for the adjacency list into the graph struct i made, because I need it inside there"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662527, "post_id": 50597763, "comment_id": 88204928, "body": "Thatis using again exactly the unclear phrase. Please try to reword especially that part. Note that &quot;calling&quot; usually refers to using a function, not a data structure."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662713, "post_id": 50597763, "comment_id": 88205037, "body": "Do you know the concept of a &quot;linked list&quot;? If not read up on that topic and redo some practice assignments on it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9610023"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527662920, "post_id": 50597763, "comment_id": 88205160, "body": "i don&#39;t know if this would sound clearer, but my main confusion is around the typedef and the pointer to it, (typedef adjListNode* AdjList;) does this mean if i just call AdjList,  i will be able to access all the struct values within?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9610023"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527663012, "post_id": 50597763, "comment_id": 88205211, "body": "i realised my compilation error is gone after i change it to AdjList array instead of struct AdjList* array, but i&#39;m not sure what the problem was (why the error happened)?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527663221, "post_id": 50597763, "comment_id": 88205357, "body": "I did not notice you mentioning a compilation error. But I see you have shown code and then deleted it again. Do show your own work, that is good. Also give all the details you have about the compiler error, especially quote it verbatim and somehow identify the line it is referring to, because line numbers probably do not help. For this it is important to make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527663300, "post_id": 50597763, "comment_id": 88205401, "body": "I am sorry but I have to leave now. I will be back in some 10 hours. Meanwhile work on your question, probably someone else will also help you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9610023"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527663375, "post_id": 50597763, "comment_id": 88205454, "body": "Thank you for your help, I realised I haven&#39;t researched before asking a question, I&#39;ll thank your advice from the answer and try to go through it before asking when I specifically know the problem."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527663465, "post_id": 50597763, "comment_id": 88205499, "body": "My pleasure, you are on the right way. If and when my answer has helped you (<b>not</b> now), or any other answer which might occur meanwhile, keep this in mind: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 0, "last_activity_date": 1527663094, "creation_date": 1527663094, "answer_id": 50598084, "question_id": 50597763, "link": "https://stackoverflow.com/questions/50597763/c-programming-structs-and-typedefs-for-graph-with-adjacency-list/50598084#50598084", "title": "C Programming: Structs and typedefs for Graph with adjacency list", "body": "<p>Offering help according to <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">How do I ask and answer homework questions?</a></p>\n\n<p>Hint 1)<br>\nMake sure that you are confortable with the concept of \"linked lists\", especially \"single linked lists\". It is a very important tool for this assignment.<br>\nIf necessary do a tutorial on that topic first, or read up in your class material and redo some of the practice assignments on that.<br>\nThen look for two examples of linked lists in the data structures you have shown.  </p>\n\n<p>Hint 2)<br>\nThe graph is going to be represented with one list of nodes and for each of them a list of adjacancies. Look those terms up, too.<br>\nNote that each of those lists is of unknown length, which changes which each new graph. So arrays with fixed lengths do not help. For each node you need to be able to name any number of adjacant other nodes. And you need to be able to work with any number of nodes.  </p>\n\n<p>Hint 3)<br>\nPut 1) and 2) together. How can 2) be solved by using the tools from 1)?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9610023"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 50598084, "answer_count": 1, "score": 1, "last_activity_date": 1527663099, "creation_date": 1527661945, "last_edit_date": 1527663099, "question_id": 50597763, "link": "https://stackoverflow.com/questions/50597763/c-programming-structs-and-typedefs-for-graph-with-adjacency-list", "title": "C Programming: Structs and typedefs for Graph with adjacency list", "body": "<pre><code>typedef struct GraphRep *Graph;\ntypedef int Vertex;\n\ntypedef struct _adjListNode {\nVertex         w;\nint         weight;\nstruct _adjListNode *next;\n} adjListNode;\n\ntypedef adjListNode* AdjList;\n</code></pre>\n\n<p>The header file I have has these features, my task is to create a adjacency list graph using this from scratch, so far i have these:</p>\n\n<pre><code>struct GraphRep{\nint nV;                // number of vertices (also == to size of array)\nstruct AdjList* array; // array where each index is the vertex pointing to a \n                       // list of its adjacent nodes\n};\n</code></pre>\n\n<p>First of all, I'm confused about how to properly call the adjacency list into the struct array, im not sure how to typedefs and structs work well.</p>\n\n<p>This is also homework, I mainly want help around understanding what the code is doing how its linked.</p>\n"}, {"tags": ["c", "qa-c"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9961975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cTiavsjrNzs/AAAAAAAAAAI/AAAAAAAACcQ/vXSUeqEw2pE/photo.jpg?sz=128", "display_name": "Axel F.", "link": "https://stackoverflow.com/users/9961975/axel-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1529414231, "last_edit_date": 1529414231, "creation_date": 1529411492, "answer_id": 50928529, "question_id": 50597719, "link": "https://stackoverflow.com/questions/50597719/prqa-how-to-ignore-some-specific-files/50928529#50928529", "title": "PRQA: How to ignore some specific files?", "body": "<p>Currently struggling with a similar issue. The PRQA manual is lacking examples here. Actually the syntax is:</p>\n\n<pre><code>qacli pprops --sync-setting &lt;setting&gt; --set &lt;value&gt;\n</code></pre>\n\n<p>which in your case means</p>\n\n<pre><code>qacli.exe pprops -P C:\\my_project --sync-setting FILE_FILTER --set \"generated_stuff\\*.c\"\n</code></pre>\n\n<p>Hope that helps!</p>\n\n<p>Edit: I didn't get it to work with wildcards. </p>\n\n<pre><code>qacli.exe pprops -P C:\\my_project --sync-setting FILE_FILTER --set generated_stuff\n</code></pre>\n\n<p>works, though.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 10656949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b7ddbe1af835f1ea4fcb46fd5027d0?s=128&d=identicon&r=PG&f=1", "display_name": "WeeGee", "link": "https://stackoverflow.com/users/10656949/weegee"}, "is_accepted": false, "score": 0, "last_activity_date": 1576518776, "creation_date": 1576518776, "answer_id": 59361919, "question_id": 50597719, "link": "https://stackoverflow.com/questions/50597719/prqa-how-to-ignore-some-specific-files/59361919#59361919", "title": "PRQA: How to ignore some specific files?", "body": "<p>From the integrated help:</p>\n\n<blockquote>\n  <p>Using the textbfFile Filter, it is possible to filter out individual source files and folders. String matching is used, and so, for example, project/subproject will filter the folder /home/project/subproject, as well as project/subproject1.cpp.</p>\n</blockquote>\n\n<p>So it uses a simple 1:1 string match, without wildcards or other advanced stuff.</p>\n"}], "owner": {"reputation": 744, "user_id": 1430552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d51a94cb59008a20e13f6cbc2ad5c6b?s=128&d=identicon&r=PG", "display_name": "Bart Mensfort", "link": "https://stackoverflow.com/users/1430552/bart-mensfort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 795, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1576518776, "creation_date": 1527661804, "last_edit_date": 1527667017, "question_id": 50597719, "link": "https://stackoverflow.com/questions/50597719/prqa-how-to-ignore-some-specific-files", "title": "PRQA: How to ignore some specific files?", "body": "<p>I have a framework, which generates 7000 PRQA warnings. 5000 warnings are created by automatically created files. I want to remove those files from the analysis. How to do this? \nI tried: </p>\n\n<pre><code>qacli.exe pprops -P C:\\my_project --sync-setting \"generated_stuff\\*.c\" --set  \n</code></pre>\n\n<p>This is not working, what is wrong?</p>\n"}, {"tags": ["android", "c++", "c", "cmake", "android-ndk"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1527666616, "post_id": 50597692, "comment_id": 88207420, "body": "It is difficult to say anything from given image: CMake cannot find compilers, but a reason is absent on the image. Instead, provide <b>textual representation of the errors</b>. When use toolchain, it is too late to set compiler in the <code>CMakeLists.txt</code>. You need to pass variables to cmake itself (via <code>-D</code> option). Also, you use incorrect variable for C++ compiler. Correct one is shown in the error message."}, {"owner": {"reputation": 1, "user_id": 9778327, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FTabKcrc-4Q/AAAAAAAAAAI/AAAAAAAAASM/Eo_a0ebvMSM/photo.jpg?sz=128", "display_name": "Kaustubh Bhatter", "link": "https://stackoverflow.com/users/9778327/kaustubh-bhatter"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1527671356, "post_id": 50597692, "comment_id": 88210428, "body": "Let me add the library to give a better picture. After that I used the standard SDK Manager to add NDK, CMake and LLDB. Though the library has another CMakeLists.txt. But its rather blank. I am new to NDK. Please check out the library. Thanks!"}], "owner": {"reputation": 1, "user_id": 9778327, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FTabKcrc-4Q/AAAAAAAAAAI/AAAAAAAAASM/Eo_a0ebvMSM/photo.jpg?sz=128", "display_name": "Kaustubh Bhatter", "link": "https://stackoverflow.com/users/9778327/kaustubh-bhatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527755229, "creation_date": 1527661703, "last_edit_date": 1527755229, "question_id": 50597692, "link": "https://stackoverflow.com/questions/50597692/an-error-with-cmake-and-ndk-on-android-when-opening-a-pre-existing-github-librar", "title": "An error with CMAKE and NDK on Android when opening a pre-existing github library. (Using Windows 10)", "body": "<p>So as mentioned, I am trying to open a github zip. It uses NDK and CMAKE. Now the main issue is I am getting these two errors:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W2pMw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W2pMw.png\" alt=\"Error Image\"></a>\nIncomplete line: </p>\n\n<pre><code>Error while executing 'C:\\sdk\\cmake\\3.6.4111459\\bin\\cmake.exe' with arguments {-HE:\\SpeedTest\\iperf3-android-master\\app -BE:\\SpeedTest\\iperf3-android-master\\app\\.externalNativeBuild\\cmake\\release\\armeabi -GAndroid Gradle - Ninja -DANDROID_ABI=armeabi -DANDROID_NDK=C:\\sdk\\ndk-bundle -DCMAKE_LIBRARY_OUTPUT_DIRECTORY=E:\\SpeedTest\\iperf3-android-master\\app\\build\\intermediates\\cmake\\release\\obj\\armeabi -DCMAKE_BUILD_TYPE=Release -DCMAKE_MAKE_PROGRAM=C:\\sdk\\cmake\\3.6.4111459\\bin\\ninja.exe -DCMAKE_TOOLCHAIN_FILE=C:\\sdk\\ndk-bundle\\build\\cmake\\android.toolchain.cmake -DANDROID_NATIVE_API_LEVEL=18 -DCMAKE_C_FLAGS=-I./src/ -IE:\\SpeedTest\\iperf3-android-master\\app -DCMAKE_CXX_FLAGS=}\n</code></pre>\n\n<p>I installed MinGW (C drive itself) and added packages:</p>\n\n<ol>\n<li>mingw32-gcc (all 5 classes)</li>\n<li>mingw-gcc-g++ (all 4 classes).</li>\n</ol>\n\n<p>It didn't work.</p>\n\n<p>Note my SDK folder is also in C drive which contains ndk &amp; cmake (downloaded via SDK Manager).</p>\n\n<p>In my <code>CMakeLists.txt</code> I also manually changed the path to:</p>\n\n<pre><code>set(CMAKE_C_COMPILER C:/MinGW/bin/gcc)\nset(CMAKE_C++_COMPILER C:/MinGW/bin/g++)\n</code></pre>\n\n<p>This is the library I am trying to execute:</p>\n\n<p><a href=\"https://github.com/t-higuchi/iperf3-android/tree/master/app\" rel=\"nofollow noreferrer\">https://github.com/t-higuchi/iperf3-android/tree/master/app</a></p>\n\n<p>After that I used the standard SDK Manager to add NDK, CMake and LLDB.\nThough the library has another CMakeLists.txt. But its rather blank. If I am to make changes then how do I do. Which terminal window to give CMake commands (if any). I am new to NDK. Please check out the library. </p>\n\n<p>Any help?</p>\n"}, {"tags": ["c++", "c", "linux", "service"], "comments": [{"owner": {"reputation": 779, "user_id": 9220132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r70Mx.jpg?s=128&g=1", "display_name": "jwm", "link": "https://stackoverflow.com/users/9220132/jwm"}, "edited": false, "score": 0, "creation_date": 1527662624, "post_id": 50597624, "comment_id": 88204991, "body": "What do you think the <code>system</code> call does? What do you think the error means?"}, {"owner": {"reputation": 294, "user_id": 2007980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gEDH.gif?s=128&g=1", "display_name": "schaiba", "link": "https://stackoverflow.com/users/2007980/schaiba"}, "edited": false, "score": 0, "creation_date": 1527664283, "post_id": 50597624, "comment_id": 88205917, "body": "Are you using VirtualBox by any chance?"}, {"owner": {"reputation": 977, "user_id": 1261664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fb810cf7313d38d554fdea16371519f?s=128&d=identicon&r=PG", "display_name": "Victor Istomin", "link": "https://stackoverflow.com/users/1261664/victor-istomin"}, "edited": false, "score": 0, "creation_date": 1527677750, "post_id": 50597624, "comment_id": 88214786, "body": "Perhaps, it needs terminal (tty) for some reason? For example, it may want to ask for sudo password, but there is no stdin. <a href=\"https://unix.stackexchange.com/a/339645/280408\">unix.stackexchange.com/a/339645/280408</a>"}, {"owner": {"reputation": 1, "user_id": 9868285, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892017667528263/picture?type=large", "display_name": "\uc815\uc778\uc218", "link": "https://stackoverflow.com/users/9868285/%ec%a0%95%ec%9d%b8%ec%88%98"}, "reply_to_user": {"reputation": 977, "user_id": 1261664, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2fb810cf7313d38d554fdea16371519f?s=128&d=identicon&r=PG", "display_name": "Victor Istomin", "link": "https://stackoverflow.com/users/1261664/victor-istomin"}, "edited": false, "score": 0, "creation_date": 1527731970, "post_id": 50597624, "comment_id": 88241072, "body": "I&#39;m not using VirtualBox. And I don&#39;t know the error means. But @VictorIstomin you are right. I&#39;m using setsid(); before system call. Because it runs with daemon. I test variable method and finally I erase setsid(); Now it works. thanks."}], "owner": {"reputation": 1, "user_id": 9868285, "user_type": "registered", "profile_image": "https://graph.facebook.com/1892017667528263/picture?type=large", "display_name": "\uc815\uc778\uc218", "link": "https://stackoverflow.com/users/9868285/%ec%a0%95%ec%9d%b8%ec%88%98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527675354, "creation_date": 1527661440, "last_edit_date": 1527675354, "question_id": 50597624, "link": "https://stackoverflow.com/questions/50597624/c-c-controlling-linux-service-in-my-app", "title": "c/c++ Controlling Linux service in my app", "body": "<p>I want to start or stop mariadb in my app.\nSo, I am just using</p>\n\n<pre><code>system(\"systemctl start mariadb.service\");\n</code></pre>\n\n<p>But it does not work.</p>\n\n<p>Error is:</p>\n\n<blockquote>\n  <p>Error creating textual authentication agent: Error opening current controlling terminal for the process (`/dev/tty'): No such device or address (polkit-error-quark, 0)</p>\n</blockquote>\n\n<p>What should I do?</p>\n\n<p>My app runs with root and daemon\nThanks.</p>\n"}, {"tags": ["c", "linux", "udp"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1527664338, "post_id": 50597609, "comment_id": 88205956, "body": "I&#39;m guessing that the two message streams come from two different peers, or two different ports on the same peer, yes?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1527666460, "post_id": 50597609, "comment_id": 88207310, "body": "Use a third thread to do the receiving and despatch to whichever of the original two threads is appropriate. Or revise your &#39;design constraint&#39;. Design constraints should not specify a threading model."}, {"owner": {"reputation": 1, "user_id": 9863620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e477d783d9fd59a4b562259614a4798?s=128&d=identicon&r=PG&f=1", "display_name": "manohar", "link": "https://stackoverflow.com/users/9863620/manohar"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1527667600, "post_id": 50597609, "comment_id": 88207993, "body": "@MartinJames thanks , No see the msg expected on thread1 received on thread2 that means its coming from same peer. Now the as soon as we read using recvfrom we erase data from buffer and so sender wont be able to send it again and that will lead here packet drop for expected receiving thread."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1527676003, "post_id": 50597609, "comment_id": 88213658, "body": "@manohar In response to your now-deleted comment &#39; is there any other approach other then having a third thread ...&#39;: yes, there is, and I have already stated it."}, {"owner": {"reputation": 1, "user_id": 9863620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e477d783d9fd59a4b562259614a4798?s=128&d=identicon&r=PG&f=1", "display_name": "manohar", "link": "https://stackoverflow.com/users/9863620/manohar"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1527742464, "post_id": 50597609, "comment_id": 88243513, "body": "Thanks @EJP i will look into that one. Comment were deleted from this thread was unexpected to me too. anyway thanks for your suggestion looking in that direction too."}], "owner": {"reputation": 1, "user_id": 9863620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e477d783d9fd59a4b562259614a4798?s=128&d=identicon&r=PG&f=1", "display_name": "manohar", "link": "https://stackoverflow.com/users/9863620/manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527667477, "creation_date": 1527661345, "last_edit_date": 1527666173, "question_id": 50597609, "link": "https://stackoverflow.com/questions/50597609/udp-packet-on-2-thread-with-same-port", "title": "UDP packet on 2 thread with same port", "body": "<p>Due design constraint I have to open 2 thread for <code>recvfrom(UDP packet)</code>, for two different operations which are running parallel. </p>\n\n<ol>\n<li>Data received on an unexpected thread which leads to not receiving data and both thread timeout after a time expiry.</li>\n<li>I tried <code>MSG_PEEK</code> and then communication bet. threads using a signal which I dropped later on.</li>\n</ol>\n\n<p>Is there any approach I can follow here? </p>\n"}, {"tags": ["c", "pointers"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "edited": false, "score": 0, "creation_date": 1528977775, "post_id": 50597981, "comment_id": 88716623, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/173143/discussion-on-answer-by-kami-kaze-how-can-2-c-programs-produce-identical-numeric\">moved to chat</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1528978881, "post_id": 50597981, "comment_id": 88717240, "body": "@JHBonarius moving two comments to chat is really not warranted. It&#39;s a waste of time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "reply_to_user": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1528979196, "post_id": 50597981, "comment_id": 88717442, "body": "@JHBonarius you flagged the second last comment, asking they be moved to chat. Which comments? How is it over moderating? Moving comments into a chat is completely harmless."}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528980377, "post_id": 50597981, "comment_id": 88718254, "body": "@YvetteColomb Sorry for the confusion I flagged the comments (and I just took a random one at the bottom). I did not further specify the point from which on it should be moved (as I did not have one in mind). I do not feel anything of high value is lost, as it seems everything in this QA is in vain anyway."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "edited": false, "score": 0, "creation_date": 1528981270, "post_id": 50597981, "comment_id": 88718890, "body": "@KamiKaze ah yeh, it was you who flagged the comment. I figured it wouldn&#39;t hurt to pop them all into a chat. Are you ok with that?"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1528981639, "post_id": 50597981, "comment_id": 88719128, "body": "I would think it is okay, but up to (and including) this <a href=\"https://chat.stackoverflow.com/transcript/message/42924397#42924397\">chat.stackoverflow.com/transcript/message/42924397#42924397</a> I would figure it is still relevant to the answer."}], "tags": [], "owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1527662784, "creation_date": 1527662784, "answer_id": 50597981, "question_id": 50597266, "link": "https://stackoverflow.com/questions/50597266/how-can-i-make-a-pointer-point-to-all-the-elements-in-an-array/50597981#50597981", "title": "How can I make a pointer point to all the elements in an array?", "body": "<p>I completly lost myself in the presentation of your code. This is by no means a good question and this might not be the correct answer or maybe it is correct but there might be more things wrong....</p>\n\n<p>Why do you do this:</p>\n\n<pre><code>YCbCr_MCU[0]= &amp;(color[x].YCbCr_MCU[0]);\nYCbCr_MCU[1]= &amp;(color[x].YCbCr_MCU[1]);\nYCbCr_MCU[2]= &amp;(color[x].YCbCr_MCU[2]);\n</code></pre>\n\n<p>This looks like your three pointers in the array point to the variables that are ordered in an array. For this just one pointer is enough.</p>\n\n<pre><code>uint8_t *YCbCr_MCU =  &amp;(color[x].YCbCr_MCU[0])\n</code></pre>\n\n<p>from this point on you could access all members of just by the pointer  and these conditions would hold:</p>\n\n<pre><code>YCbCr_MCU[0] == color[x].YCbCr_MCU[0];\nYCbCr_MCU[1] == color[x].YCbCr_MCU[1];\nYCbCr_MCU[2] == color[x].YCbCr_MCU[2];\n</code></pre>\n\n<p>This would make it easier to work with the code.</p>\n\n<p>The real problem seems to be here:</p>\n\n<pre><code>uint8_t *MCU_Y = YCbCr_MCU[0]; // here YCbCr_MCU[0] is a pointer so this is valid.\n....\nindex = i * (8 * nb_MCU_H)  + j;\nR = (MCU_Cr[index] - 128) * 1.402f + MCU_Y[index]; // look at the MCU_Y here\n</code></pre>\n\n<p>for every index other than <code>0</code> this is invalid (okay to be more precise <code>1</code> and <code>2</code> would be okay to get <code>color[x].YCbCr_MCU[1];</code> or <code>color[x].YCbCr_MCU[1];</code></p>\n"}], "owner": {"reputation": 539, "user_id": 6525712, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/656b10da18de6f302492451ce5322494?s=128&d=identicon&r=PG&f=1", "display_name": "a_sid", "link": "https://stackoverflow.com/users/6525712/a-sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1529742543, "creation_date": 1527659814, "last_edit_date": 1529711575, "question_id": 50597266, "link": "https://stackoverflow.com/questions/50597266/how-can-i-make-a-pointer-point-to-all-the-elements-in-an-array", "title": "How can I make a pointer point to all the elements in an array?", "body": "<p>I am trying to write a C code where a pointer can point to all the elements in an array. However, after I dereference the pointer I get the <code>Segmentation Fault</code> error.</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid func_equal(int32_t *input, uint8_t *output)\n{\n    for (int i= 0; i &lt; 4; i++)\n    {\n        output[i]= input[i]; \n    }\n}\n\nint main()\n{\n    uint8_t* my_point;\n    int32_t someNum[4];\n\n    for (int i= 0; i &lt; 4; i++)\n    {\n        someNum[i]= 2 + (4*i);\n    }\n\n    func_equal(someNum, my_point);\n\n    printf(\"my_point (dereferenced) is %d\\n\", *(my_point));\n    printf(\"---------\\n\");\n\n    for (int i= 0 ; i &lt; 4; i++)\n    {\n        printf(\"my_point (dereferenced) is %d\\n\", *(my_point+i));\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>As one can see in my code, I created a pointer called <code>my_point</code> and I want to make it point to the array <code>someNum</code>. However, when I run the code <a href=\"https://www.onlinegdb.com/\" rel=\"nofollow noreferrer\">here</a> I get the following output:</p>\n\n<pre><code>my_point (dereferenced) is 2                                                                                                   \n---------                                                                                                                      \nSegmentation fault\n</code></pre>\n\n<p><strong>How can I modify <code>my_point</code> to point to ALL the elements in <code>someNum</code>?</strong></p>\n"}, {"tags": ["c", "struct", "enums", "identifier"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1527658968, "post_id": 50597026, "comment_id": 88203239, "body": "Move the enum definition to File2.h and don&#39;t include File1.h"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 1, "last_activity_date": 1527659127, "last_edit_date": 1527659127, "creation_date": 1527658816, "answer_id": 50597059, "question_id": 50597026, "link": "https://stackoverflow.com/questions/50597026/using-datatypes-of-each-other-2-header/50597059#50597059", "title": "Using datatypes of each other (2 Header)", "body": "<p>That's an infinite include loop. You can fix this by putting all types in a single header.</p>\n\n<p>Alternatively, you could get fancy:</p>\n\n<p>File1.h:</p>\n\n<pre><code>typedef enum\n{\n   MY_VARIABLE\n} ENUM_FILE1;\n\n#include \"File2.h\"\n\ntypedef struct\n{\n   STRUCT_FILE_2 name;\n} STRUCT_FILE1;\n</code></pre>\n\n<p>But doing that would be pointless because you couldn't ever use <code>File2.h</code> on its own; you'd always have to <code>#include \"File1.h\"</code> anyway. So in the end you'd still have effectively just one header.</p>\n"}], "owner": {"reputation": 21, "user_id": 8359425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0643a64fed5875be0664a295c7793a4c?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/8359425/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527659299, "creation_date": 1527658611, "last_edit_date": 1527658787, "question_id": 50597026, "link": "https://stackoverflow.com/questions/50597026/using-datatypes-of-each-other-2-header", "title": "Using datatypes of each other (2 Header)", "body": "<p>I'm trying somethin like that:</p>\n\n<p>File 1.h:</p>\n\n<pre><code>#include \"File2.h\"\n\ntypdef enum\n{\n   MY_VARIABLE\n}ENUM_FILE1;\n\ntypedef struct\n{\n   STRUCT_FILE_2 name\n}STRUCT_FILE1;\n</code></pre>\n\n<p>File 2.h:</p>\n\n<pre><code>#include \"File1.h\"\n\ntypdef struct\n{\n   ENUM_FILE1 name;\n}STRUCT_FILE2;\n</code></pre>\n\n<p>But the indentifier ENUM_FILE1 is unknown. Why? And how can I fix it?</p>\n"}, {"tags": ["c", "posix", "string-literals"], "comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527674365, "post_id": 50596439, "comment_id": 88212610, "body": "You don&#39;t need any explicit guarantee the data won&#39;t be written to. Unless the function is specified to modify some object, it doesn&#39;t do it."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527686169, "post_id": 50596439, "comment_id": 88220802, "body": "@R.. It&#39;d be better if it were explicitly said. I can&#39;t imagine why posix_spawn would want to modify the arguments but there are certainly cases where a pointer can be as-if-const (i.e., the target will be written to but changes will be reverted on return). I use such pointers (commenting them as-if-const)  quite a bit for strings where I need to temporarily insert a <code>\\0</code>."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1527687615, "post_id": 50596439, "comment_id": 88221912, "body": "@PSkocik: There can&#39;t be such cases. Any such implementation would have data races and thereby be non-thread-safe."}], "answers": [{"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 1, "last_activity_date": 1527662356, "creation_date": 1527662356, "answer_id": 50597873, "question_id": 50596439, "link": "https://stackoverflow.com/questions/50596439/can-string-literals-be-passed-in-posix-spawns-argv/50597873#50597873", "title": "Can string literals be passed in posix_spawn&#39;s argv?", "body": "<p>I'm pretty sure the type was chosen for compatibility with the <code>char **argv</code> argument to <code>main</code> (and <code>execve</code>).  (Although in a traditional implementation with proper process separation, the kernel eventually has to make a copy.)</p>\n\n<p>POSIX does not seem to say that these arrays are modified, but I'm pretty confident that no existing implementation will modify them.  There could be some reasons for using different arguments (and executable names), but those will be <em>longer</em>, so <code>posix_spawn</code> has to allocate memory for a copy anyway, and cannot perform the modification in-place.</p>\n"}, {"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527687803, "post_id": 50604922, "comment_id": 88222072, "body": "This answer is not correct. The presence or absence of a const qualifier in the pointed to type has no relevance to whether the interface can clobber data it&#39;s not explicitly specified to modify."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527690382, "post_id": 50604922, "comment_id": 88224025, "body": "@R.. <a href=\"https://stackoverflow.com/questions/50596439/can-string-literals-be-passed-in-posix-spawns-argv/50604922?noredirect=1#comment88222072_50604922\">Disagree.</a>  With parameter <code>const foo * bar</code>, code  indicates that it will not modify that data pointed to by <code>bar</code> (not without UB)."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1527683962, "creation_date": 1527683962, "answer_id": 50604922, "question_id": 50596439, "link": "https://stackoverflow.com/questions/50596439/can-string-literals-be-passed-in-posix-spawns-argv/50604922#50604922", "title": "Can string literals be passed in posix_spawn&#39;s argv?", "body": "<blockquote>\n  <p>is there a guarantee somewhere that it is OK to pass a string literal? Or are we risking a segfault?</p>\n</blockquote>\n\n<p>Given, there is a technical segfault risk as <code>argv</code> expects a non-<code>const</code> array of <code>char*</code> and providing a <em>string literal</em> can lead to UB.  With a function   perhaps modeling <code>main(int argc, char *argv[])</code>, code can write to <code>argv[0]</code>.</p>\n\n<blockquote>\n  <p><code>int main(int argc, char *argv[])</code><br>\n  ...<br>\n  The parameters <code>argc</code> and <code>argv</code> and the strings pointed to by the <code>argv</code> array shall be <strong>modifiable</strong> by the program, and retain their last-stored values between program startup and program termination. C11 \u00a75.1.2.2.1 2</p>\n</blockquote>\n\n<pre><code>int foo(......., char *const argv[restrict], char *const envp[restrict]);\n\nchar *v[] = { \"foo.exe\", \"bar\", NULL };\nfoo( NULL, \"foo.exe\", NULL, NULL, v, NULL );\n</code></pre>\n\n<hr>\n\n<p><strong>Alternative</strong></p>\n\n<p>Although with <code>posix_spawn()</code>, I doubt a write will occur, a solution with C99 employs a <em>compound literal</em> rather than a <em>string literal</em> and so avoids UB potential.</p>\n\n<pre><code>// char *v[] = { \"foo.exe\", \"bar\", NULL };\nchar *v2[] = { (char [8]){\"foo.exe\"}, (char [4]){\"bar\"}, NULL };\nposix_spawn( NULL, \"foo.exe\", NULL, NULL, v2, NULL );\n</code></pre>\n\n<p>Now  <code>posix_spawn()</code> can write to <code>v2[0]</code> </p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527719313, "post_id": 50609390, "comment_id": 88238162, "body": "The line of reasoning is good about standard functions. Yet it does not detail <code>posix_spawn()</code> documentation lacks side effects.  Instead, per my reading of &quot;The argv and envp arguments specify the argument list and   environment for the program that is executed in the child process,    as for execve in <a href=\"http://man7.org/linux/man-pages/man3/posix_spawn.3.html\" rel=\"nofollow noreferrer\">posix_spawn</a>, <code>posix_spawn()</code> treats <code>argv</code> ..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527719318, "post_id": 50609390, "comment_id": 88238164, "body": "....  like <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\">execve</a> which in turn has &quot;The argument vector and environment can be accessed by the called program&#39;s main function, when it is defined as:    <code>int main(int argc, char *argv[], char *envp[])</code>&quot;.  As <code>main()</code> <code>argv</code> can have its strings pointed to by the argv array modified, it is reasonable to consider, <code>argv</code> of <code>posix_spawn()</code> incurs the same possibility."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527724469, "post_id": 50609390, "comment_id": 88239446, "body": "@chux: For <code>execve</code>, that&#39;s after the running process image has been completely replaced by the call to exec and <i>everything has ceased to exist</i>. Whether it was mutable or not is irrelevant at that point because the original object no longer exists."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1527724679, "post_id": 50609390, "comment_id": 88239488, "body": "In the case of <code>posix_spawn</code>, unlike <code>execve</code> the caller does not cease to exist; a child process is created with arguments copied from the <code>argv</code> passed to <code>posix_spawn</code>. This is a completely different process; modifying the <code>argv</code> array received by <code>main</code> in the new process has no effect on the <code>argv</code> passed to <code>posix_spawn</code>. You&#39;re wrongly conflating them just because they have the same name."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 3, "last_activity_date": 1527697196, "creation_date": 1527697196, "answer_id": 50609390, "question_id": 50596439, "link": "https://stackoverflow.com/questions/50596439/can-string-literals-be-passed-in-posix-spawns-argv/50609390#50609390", "title": "Can string literals be passed in posix_spawn&#39;s argv?", "body": "<p>Using string literals is perfectly fine here.</p>\n\n<p>Whether a pointer argument (or pointer data pointed to by an argument) points to const-qualified type has nothing to do with whether the function can modify a pointed-to object. This is purely a matter of the contract of the function in question. As a convention, it's usually preferable to use const-qualified pointers in arguments when the object won't be modified:</p>\n\n<ol>\n<li>to allow passing pointers to const-qualified objects without casts, and</li>\n<li>as an indication that the object won't be modified.</li>\n</ol>\n\n<p>but there is no requirement to do so in the C language. And for functions that use double-pointer types in their interfaces, there's often a tradeoff here. Since <code>T *</code> and <code>const T *</code> cannot alias one another, the interface has to choose the form more likely for the caller to want; if the caller wants the other form, it has to make a temporary copy to pass to the function. This is the case for <code>posix_spawn</code>.</p>\n\n<p>In general, when it comes to standard functions (C or POSIX), they <strong>cannot have any observable side effects except as specified</strong>. Unless the DESCRIPTION for the function documents that it will modify an object \"belonging to\" the application, or which the application has access to, it cannot modify it; doing so is non-conforming. This is why functions which return pointers to static storage explicitly document it. For example, POSIX documents for <code>strerror</code>:</p>\n\n<blockquote>\n  <p>The returned string pointer might be invalidated or the string content might be overwritten by a subsequent call to strerror(),</p>\n</blockquote>\n\n<p>Short of such documentation, an application could assume that the string returned by <code>strerror</code> is never modified by the implementation.</p>\n\n<p>Since <code>posix_spawn</code> is not documented to modify the strings pointed to by its <code>argv</code> array, it does not modify them.</p>\n\n<p>Further, note that <code>posix_spawn</code> is required to be thread-safe, and does not place any explicit constraint on applications for concurrent access to the <code>argv</code> strings. As such, any modification would introduce data races, thereby rendering <code>posix_spawn</code> non-thread-safe, contrary to specification.</p>\n"}], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 50609390, "answer_count": 3, "score": 6, "last_activity_date": 1527697196, "creation_date": 1527654733, "question_id": 50596439, "link": "https://stackoverflow.com/questions/50596439/can-string-literals-be-passed-in-posix-spawns-argv", "title": "Can string literals be passed in posix_spawn&#39;s argv?", "body": "<p>For <a href=\"http://pubs.opengroup.org/onlinepubs/009696899/functions/posix_spawn.html\" rel=\"noreferrer\">the <code>posix_spawn</code> function</a> its prototype is:</p>\n\n<pre><code>int posix_spawn(pid_t *restrict pid, const char *restrict path,\n   const posix_spawn_file_actions_t *file_actions,\n   const posix_spawnattr_t *restrict attrp,\n   char *const argv[restrict], char *const envp[restrict]);\n</code></pre>\n\n<p>Notably, the <code>argv</code> parameter points to an array of <code>char *</code> pointers (i.e. pointers to mutable characters). Further, the documentation does not seem to give any guarantee that the data will not be written to. </p>\n\n<p>My question is: is there a guarantee somewhere that it is OK to pass a string literal?  Or are we risking a segfault?</p>\n\n<p>Sample code:</p>\n\n<pre><code>char *v[] = { \"foo.exe\", \"bar\", NULL };\nposix_spawn( NULL, \"foo.exe\", NULL, NULL, v, NULL );\n</code></pre>\n"}, {"tags": ["c", "vector", "macros", "unions"], "comments": [{"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 5, "creation_date": 1527653257, "post_id": 50596172, "comment_id": 88201583, "body": "Probably impossible."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1527664722, "post_id": 50596172, "comment_id": 88206203, "body": "in C++ it is doable <code>~224 KByte</code> of code (<a href=\"https://retrocomputing.stackexchange.com/a/6055/6868\">here _vec2&lt;T&gt; C++ template example for dvec2,ivec2,vec2,bvec2</a> ) However  C lacks the tools to do it (at least to my knowledge) and macros alone will not allow you all the combinations of access (or at least I do not see it). You are missing some coordinates there are <code>xyzw , rgba , stpq</code> for <code>vec4</code> and the access can be any like <code>yzx, xyw,wzy,xgq...</code> and constructors also combined too like <code>vec3(vec2,float),vec3(float,vec2),vec3(float,float,float),ve&zwnj;&#8203;c4(vec3,float),vec4(&zwnj;&#8203;flaot,vec2,float)</code> ..."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1527664974, "post_id": 50596172, "comment_id": 88206369, "body": "as you can see there are a lot of combinations to support all the <code>vec2&#47;3&#47;4</code> correctly. However I do not code in C (I am more C++ like coder) so I could be missing some stuff ..."}, {"owner": {"reputation": 1235, "user_id": 1904755, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/68879b1c8cb87f19c86a3b48ad573d1c?s=128&d=identicon&r=PG", "display_name": "&#233;tale-cohomology", "link": "https://stackoverflow.com/users/1904755/%c3%a9tale-cohomology"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1527668484, "post_id": 50596172, "comment_id": 88208519, "body": "@Spektre Yes, in C++ it seems intuitively possible, not least of all because you can overload the <code>[]</code> operator (I think I&#39;ve seen it done before). Thanks for the reference, too!"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 1, "creation_date": 1527668803, "post_id": 50596172, "comment_id": 88208717, "body": "@&#233;tale-cohomology the code in the link is missing just the final touch: <code>typedef _vec2&lt;float &gt;  vec2; typedef _vec3&lt;float &gt;  vec3; typedef _vec4&lt;float &gt;  vec4; typedef _vec2&lt;double&gt; dvec2; typedef _vec3&lt;double&gt; dvec3; typedef _vec4&lt;double&gt; dvec4; typedef _vec2&lt;bool  &gt; bvec2; typedef _vec3&lt;bool  &gt; bvec3; typedef _vec4&lt;bool  &gt; bvec4; typedef _vec2&lt;int   &gt; ivec2; typedef _vec3&lt;int   &gt; ivec3; typedef _vec4&lt;int   &gt; ivec4; typedef _vec2&lt;DWORD &gt; uvec2; typedef _vec3&lt;DWORD &gt; uvec3; typedef _vec4&lt;DWORD &gt; uvec4; </code> without the template the code would be 5x longer"}], "owner": {"reputation": 1235, "user_id": 1904755, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/68879b1c8cb87f19c86a3b48ad573d1c?s=128&d=identicon&r=PG", "display_name": "&#233;tale-cohomology", "link": "https://stackoverflow.com/users/1904755/%c3%a9tale-cohomology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1546970168, "creation_date": 1527652658, "last_edit_date": 1546970168, "question_id": 50596172, "link": "https://stackoverflow.com/questions/50596172/glsl-like-vector-access-in-c", "title": "GLSL-like vector access in C", "body": "<p>In GLSL you can access the components of a vector using both names and indices, eg. if you have a <code>vec2 foo</code> then you can do do stuff like <code>foo.x</code> and <code>foo[0]</code>.</p>\n\n<p>Is it possible to replicate this interface in C?</p>\n\n<p>I currently have the following:</p>\n\n<pre><code>typedef union{\n  struct{  float x1, x2;  };\n  struct{  float  x,  y;  };\n  float d[2];\n}vec2;\n</code></pre>\n\n<p>which allows me to access the components of a <code>vec2 foo</code> like <code>foo.x</code> and <code>foo.d[0]</code>.</p>\n\n<p>Is it possible to dispense of that nasty <code>.d</code>, arriving at <code>foo[0]</code>? (By any means, perhaps using some (even nastier) macro trickery?)</p>\n"}, {"tags": ["c", "linux", "limit", "ulimit"], "answers": [{"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 2, "last_activity_date": 1527656702, "creation_date": 1527656702, "answer_id": 50596729, "question_id": 50596153, "link": "https://stackoverflow.com/questions/50596153/what-are-the-relation-and-difference-between-sysconf-and-getrlimit/50596729#50596729", "title": "What are the relation and difference between `sysconf()` and `getrlimit()`?", "body": "<p><code>sysconf</code> is a general-purpose function to get value of many different <strong>system configuration</strong> variables, not only resources limits. Some represent system-wide limits. <code>sysconf</code> have no setting function counterpart (some of these values are not dynamic). All of these values shall not change across two calls in the same process (see exception below). </p>\n\n<p><code>getrlimit</code> is a function to get value of <strong>resource limits</strong>. Its setting counterpart is <code>setrlimit</code>(on which there can be some restrictions).</p>\n\n<p>Both are defined by POSIX, and standard says nothing about overlapping except for <code>OPEN_MAX</code> which may change during process lifetime.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527656702, "creation_date": 1527652556, "last_edit_date": 1592644375, "question_id": 50596153, "link": "https://stackoverflow.com/questions/50596153/what-are-the-relation-and-difference-between-sysconf-and-getrlimit", "title": "What are the relation and difference between `sysconf()` and `getrlimit()`?", "body": "<p>What are the relation and difference between <code>sysconf()</code> and <code>getrlimit()</code>?</p>\n<p>Do they provide two different ways to report the limits of the same resources?</p>\n<p>When shall we use which?</p>\n<p>Thanks.</p>\n<p>I have found two contradictory comments on the two functions:</p>\n<p>From <a href=\"http://forums.devshed.com/programming-42/whats-difference-sysconf-rlimit-955656.html\" rel=\"nofollow noreferrer\">http://forums.devshed.com/programming-42/whats-difference-sysconf-rlimit-955656.html</a></p>\n<blockquote>\n<p>If I remember correctly, the sysconf() stuff cannot be changed by a\nprocess (i.e.) they are configured at a kernel level and need a\nrecompile of the operating system kernel and/or C libraries to change\nthem. You can only read those values, but not alter them at runtime.</p>\n<p>With setrlimit()/getrlimit(), you can read and change the values\n(within reason) of certain resources at runtime. For instance, you can\ncall setrlimit() to set the max. core dump size of a process, which is\nuseful if a process crashed often and you don't want to fill your hard\ndisk up with large files.</p>\n<p>The parameters you can read/set with rlimit are different from the\nparameters that you can read with sysconfig(). They deal with\ndifferent system knobs.</p>\n<p>sysconf() and getrlimit() return the values of different resource settings (<strong>without overlap</strong>), so you call the appropriate one depending on what information your program seeks.</p>\n</blockquote>\n<p>But from APUE:</p>\n<blockquote>\n<p>For example, we can use the <strong>ulimit</strong> command built into the Bourne-again\nshell to change the maximum number of \ufb01les our processes can have open\nat one time. This generally  requires  special  (superuser)\nprivileges  if  the  limit  is  to  be  effectively unlimited.  But\nonce  set  to  in\ufb01nite, <strong>sysconf</strong> will  report LONG_MAX as  the  limit\nfor OPEN_MAX. A program that relies on this value as the upper bound\nof \ufb01le descriptors to close, as shown in Figure 2.17, will waste a lot\nof time trying to close 2,147,483,647 \ufb01le descriptors, most of which\naren\u2019t even in use.</p>\n<p>Systems that support the XSI option in the Single\nUNIX Speci\ufb01cation will provide the <strong>getrlimit</strong>(2) function  (Section\n7.11).  It can  be  used  to  return  the  maximum number of descriptors that a process can have open. With it, we can detect that\nthere is no con\ufb01gured upper bound to the number of open \ufb01les our\nprocesses can open, so we can avoid this problem.</p>\n</blockquote>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 3, "creation_date": 1527650400, "post_id": 50595844, "comment_id": 88200892, "body": "Take the semicolon off the end of your while loop. Also, you probabaly want to query the user again when the temperatures entered are invalid. And you should get in the habit of checking the return value of scanf for invalid input."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1527650413, "post_id": 50595844, "comment_id": 88200895, "body": "well first of all, you&#39;ll want to remove the <code>;</code> at the end of the <code>while</code> loop,, but more importantly, that shouldn&#39;t be a <code>while</code> loop to begin with. If you do enter bad values that will loop forever on the <code>printf</code>, you never give the user a chance to re-enter them. The semi-colon masks the body of the loop (so there is no body). if you enter the values you say, the loop is false, and it drops to the next statement, the <code>printf</code>. If you did enter bad values, you would infinitely loop and never reach the <code>printf</code> or anything else, making your program hang."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1527652031, "post_id": 50595844, "comment_id": 88201252, "body": "@yano -- that looks like something that could be expanded upon slightly and turned into an answer. (and since he is looping, he will need to validate <code>EOF</code>, <i>matching or input</i> failures, and presumably <code>break</code> after the validation of the values.)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527743250, "post_id": 50595844, "comment_id": 88243735, "body": "@DavidC.Rankin good looking out, however, I was just passing through.  J...S has got it covered!"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1527652160, "post_id": 50596090, "comment_id": 88201300, "body": "Add a solid scolding about always validating the return of <code>scanf</code> and removing extraneous characters on <i>matching</i> failure and you have something there. (currently a keyboard slip, e,g. <code>23a</code> will just loop until the loop is exhausted)"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1527652726, "post_id": 50596090, "comment_id": 88201455, "body": "@DavidC.Rankin I added something about it.Thanks"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1527653023, "post_id": 50596090, "comment_id": 88201530, "body": "Yep, much better. One of the most common problems is the incorrect use of <code>scanf</code> by new C programmers, it is always worth a couple of additional paragraphs to make sure they leave with at least a firm understanding of what they need to do."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 4, "last_activity_date": 1527652646, "last_edit_date": 1527652646, "creation_date": 1527652026, "answer_id": 50596090, "question_id": 50595844, "link": "https://stackoverflow.com/questions/50595844/c-program-code-aid/50596090#50596090", "title": "C program code aid", "body": "<p>As pointed out in the comments, because of the immediate semicolon, the <code>while</code> loop has no body.</p>\n\n<p>The conditions are checked and the <code>printf()</code> right after the <code>while</code> will always be executed. So the <code>while</code> loop here as of now is useless for those values of <code>high</code> and <code>low</code>. But had the condition for the loop been true, it would've been an infinite loop.</p>\n\n<p>And <code>while</code> seems out of place there. You also need to prompt the user to re-enter correct values in case invalid values are entered.\\</p>\n\n<p>You could do something like</p>\n\n<pre><code>if (high &gt; 40 || low &lt; -40 || high &lt; low) \n{\n    printf(\"Incorrect values, temperatures must be in the range - 40 to 40, high must be greater than low.\\n\");\n    i--;\n}\n</code></pre>\n\n<p>in place of the loop and that <code>printf()</code>.</p>\n\n<p><code>i</code> is decremented if invalid input is found so that at the end of the loop when <code>i++</code> is done, the variable value remains the same.</p>\n\n<p>Edit:</p>\n\n<p>The user may enter invalid input like characters when you are expecting numbers. In such a case, <code>scanf()</code> will leave the input unconsumed on the input buffer and an infinite loop can arise if that invalid data is not consumed before the <code>scanf()</code> in the next iteration.</p>\n\n<p><code>scanf()</code> returns the number of successful assignments.</p>\n\n<pre><code>if( scanf(\"%d\", &amp;high)!=1 )\n{\n    printf(\"\\nInvalid input.\");\n    i--;\n    consumeBufferData(); //see the link\n    continue;\n}\nif( scanf(\"%d\", &amp;low)!=1 )\n{\n    printf(\"\\nInvalid input.\");\n    i--;\n    consumeBufferData(); //see the link\n    continue;\n}\n</code></pre>\n\n<p>If invalid input is found you should consume the invalid data. See <a href=\"https://stackoverflow.com/questions/7898215/how-to-clear-input-buffer-in-c\">this</a> post to see a discussion on how to do that.</p>\n\n<p>Something like</p>\n\n<pre><code>void consumeBufferData()\n{\n    int c;\n    while( (c=getchar())!='\\n' &amp;&amp; c!=EOF );\n}\n</code></pre>\n\n<p>might suffice.</p>\n"}], "owner": {"reputation": 11, "user_id": 9867680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30779177e7d9c3b4558d1baa7569a441?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/9867680/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527652646, "creation_date": 1527649996, "last_edit_date": 1527651857, "question_id": 50595844, "link": "https://stackoverflow.com/questions/50595844/c-program-code-aid", "title": "C program code aid", "body": "<p>Can anyone help me with this and tell me why my program keeps telling me the values are incorrect? My code runs and there are no bugs. However if I enter a high temperature of 20 and a low temperature of 10, the printf statement keeps coming up saying the value is incorrect. But it shouldn\u2019t be because I  said that if high is greater than 40 or low is less than -40 or high is greater than low! Can anyone help me? Thank you.</p>\n\n<pre><code>#define NUMS3 \n#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\nint high, low;\n\nint main(void)\n{ \n    printf(\"---=== IPC Temperature Analyzer ===--- \\n\");\n    for (int i = 1; i &lt; 4; i++) \n    {\n        printf(\"Enter the high value for day %d:\", i);\n        scanf(\"%d\", &amp;high);\n\n        printf(\"Enter the low value for day %d:\", i);\n        scanf(\"%d\", &amp;low);      \n        while (high &gt; 40 || low &lt; -40 || high &lt; low); \n        {\n            printf(\"Incorrect values, temperatures must be in the range \"\n                   \"-40 to 40, high must be greater than low.\\n\");\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "sockets", "networking", "tcp"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1527648889, "post_id": 50595649, "comment_id": 88200557, "body": "Is this a curiosity thing or are you trying to design a program that actually relies on the size of the buffers?"}, {"owner": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1527659151, "post_id": 50595649, "comment_id": 88203286, "body": "Thank you for response.I am a beginner. I just want to understand the conception of socket buffer, so I wrote this program to checkout whether I really understand it.But the result makes me confused."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1527720095, "post_id": 50595649, "comment_id": 88238393, "body": "I think Linux includes some overhead per packet in the socket buffer size. For most programming you need to know <i>that</i> there&#39;s a socket buffer, but the exact size etc. is unreliable."}, {"owner": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1527734709, "post_id": 50595649, "comment_id": 88241698, "body": "Thank you,I will keep this in mind."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "edited": false, "score": 0, "creation_date": 1527659403, "post_id": 50595786, "comment_id": 88203388, "body": "Thank you for response, I am just curious about the conception of socket buffer, and want to simulate the process on the book.But the result is not the same as book."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "edited": false, "score": 0, "creation_date": 1527661001, "post_id": 50595786, "comment_id": 88204155, "body": "What result is not the same as what book? and why should it be? unless you are running exactly the same hardward and software?"}, {"owner": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "edited": false, "score": 0, "creation_date": 1527734410, "post_id": 50595786, "comment_id": 88241624, "body": "The book is Unix Network Programming(Volume1,3rd),Section 2.11.I have no idea why and how it should be.I do not have the same hardware or software, if I cannot get the right phenomenon,all I can do is keep this conception in mind.Thanks."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "edited": false, "score": 0, "creation_date": 1527735768, "post_id": 50595786, "comment_id": 88241951, "body": "The point is that there <i>isn&#39;t</i> a reason why it should be the same. Every hardware, every operating system, indeed every <i>connection</i> can behave differently, subject only to the defined semantics of the operations, which do not include exactly reproducing results from 25-year-old textbooks, good as this one undoubtedly is."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 1, "last_activity_date": 1527661172, "last_edit_date": 1527661172, "creation_date": 1527649463, "answer_id": 50595786, "question_id": 50595649, "link": "https://stackoverflow.com/questions/50595649/socket-send-and-receive-buffer/50595786#50595786", "title": "Socket Send And Receive Buffer", "body": "<ol>\n<li><p>There is no evidence here that the client writes did not block. On the contrary, the fact that all the writes were 100,000 bytes except the last, when you ran out of input, shows that it <em>must</em> have blocked, to transfer all that data into a socket buffer that is smaller.</p></li>\n<li><p>TCP segmentizes, and IP packetises, the data sent over the wire. You have no control over that process. In any case a <code>read()</code> can transfer any amount of bytes from 1 up to the count supplied, or zero upwards in non-blocking mode. It is a streaming protocol, not a messaging protocol. There is no other guarantee about how much any individual <code>read()</code> will return at a time.</p></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 9411130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a92a70fb8894c1c7d9446d90b6040b40?s=128&d=identicon&r=PG&f=1", "display_name": "Greetlist", "link": "https://stackoverflow.com/users/9411130/greetlist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3441, "favorite_count": 0, "accepted_answer_id": 50595786, "answer_count": 1, "score": 0, "last_activity_date": 1527661172, "creation_date": 1527648154, "last_edit_date": 1527649096, "question_id": 50595649, "link": "https://stackoverflow.com/questions/50595649/socket-send-and-receive-buffer", "title": "Socket Send And Receive Buffer", "body": "<p>I tried to learn about the conception of Socket-Send(Receive)-Buffer.And I wrote these codes:\nClient:</p>\n\n<pre><code>int client = socket(AF_INET, SOCK_STREAM, 0);\nint s = getsockopt(client, SOL_SOCKET, SO_SNDBUF, &amp;sendBuffSize, &amp;len);\nint status = connect(client, (struct sockaddr*)&amp;addr, sizeof(struct sockaddr_in));\nprintf(\"The send buff size is : %d.\\n\", sendBuffSize);\nchar buf[100000];\nint n, wn;\nint fd = open(\"./1.txt\", O_RDONLY);\nwhile ((n = read(fd, buf, sizeof(buf))) &gt; 0) {\n    wn = write(client, buf, n);\n    printf(\"Write %d bytes.\\n\", wn);\n}\n</code></pre>\n\n<p>Server: I set the connected client as <strong>Non-block</strong>,and add this client into the epoll.Once the client sends data to the server, I put the main thread into sleep[ten seconds].</p>\n\n<pre><code>char buf[8192];\nsleep(10);\nint rn;\nwhile ((rn = read(events[i].data.fd, buf, sizeof(buf))) &gt; 0) {\n    printf(\"Read %d bytes.\\n\", rn);\n}\n</code></pre>\n\n<p>The client send Buffer size is 16384 and the server receive Buffer size is 20000[setsockopt].</p>\n\n<p>According to the book:The client calls the write function will block if the socket send buffer is full. </p>\n\n<p>But I get the result[Client] :\n<a href=\"https://i.stack.imgur.com/SxTgU.png\" rel=\"nofollow noreferrer\">Result</a></p>\n\n<p>And the server :\n<a href=\"https://i.stack.imgur.com/E6cec.png\" rel=\"nofollow noreferrer\">Result</a></p>\n\n<p>Questions:</p>\n\n<ol>\n<li>Receive buffer size + Send buffer size &lt; 100000; but why the write function do not block?</li>\n<li>Why the server read 8192 + 6808 = 15000 bytes instead of read continuously 8192 bytes?</li>\n</ol>\n"}, {"tags": ["c", "macros", "c-preprocessor", "evaluation"], "comments": [{"owner": {"reputation": 757, "user_id": 824501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQCRZ.png?s=128&g=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/824501/stan"}, "edited": false, "score": 0, "creation_date": 1527651619, "post_id": 50595314, "comment_id": 88201156, "body": "As none of <code>FOO</code>, <code>FOO_*</code> and <code>BAR_*</code> can be modified, how to prevent the substitution from <code>FOO</code> to <code>99</code> that happens in <code>PRINT(FOO)</code>?"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 757, "user_id": 824501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQCRZ.png?s=128&g=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/824501/stan"}, "edited": false, "score": 0, "creation_date": 1527652996, "post_id": 50595314, "comment_id": 88201525, "body": "@Stan - indeed a problem... which is why I am looking for SE gurus for a creative idea... 8-)"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 757, "user_id": 824501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQCRZ.png?s=128&g=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/824501/stan"}, "edited": false, "score": 0, "creation_date": 1527653494, "post_id": 50595314, "comment_id": 88201643, "body": "@Stan - I was hoping maybe a reordering of the underlying macro cascade will do the trick, but you emphasized the point that the root of the problem is the API macro itself."}, {"owner": {"reputation": 757, "user_id": 824501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQCRZ.png?s=128&g=1", "display_name": "Stan", "link": "https://stackoverflow.com/users/824501/stan"}, "edited": false, "score": 0, "creation_date": 1527653944, "post_id": 50595314, "comment_id": 88201761, "body": "Indeed, it&#39;d be much more elegant to abandon the macro idea in this case. What&#39;s the original need for such an implementation? Can&#39;t <code>FOO</code>, <code>BAR</code> be arrays? As you mentioned in another comment there&#39;re hundreds of macros, to increase the flexibility, we may also consider encapsulating all the macros into &quot;actual&quot; variables and functions."}], "answers": [{"comments": [{"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527653198, "post_id": 50595905, "comment_id": 88201566, "body": "This may be the start of a solution. However, how&#39;d you detect when <code>FOO</code> is used, rather than <code>BAR</code>? In practice, <code>FOO</code> and <code>BAR</code> are a list of 100&#39;s of macros, which we receive from an external source. A minority of them have the problem expressed in this question."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527653282, "post_id": 50595905, "comment_id": 88201592, "body": "Maybe if, in the definition of <code>PRINT()</code> you could save the <code>mac</code> value into a temporary macro, then undef <code>mac</code>, call <code>PRINT()</code> and then redefine with the temp macro as its new value?"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 1, "creation_date": 1527654569, "post_id": 50595905, "comment_id": 88201898, "body": "@ysap I was trying but could not find a solution if the macros is used hundreds of times."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 2, "creation_date": 1527655392, "post_id": 50595905, "comment_id": 88202135, "body": "@ysap Macros aren&#39;t variables.  You assign a macro with a <code>#define</code>, and you can&#39;t <code>#define</code> from a replacement list.  The closest you can do to semantics like &quot;saving off&quot; are value-only things using complex techniques, such as those done by boost pp slots, which involve <code>#include</code> (another thing you can&#39;t do inside a macro)."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 1, "creation_date": 1527689917, "post_id": 50595905, "comment_id": 88223677, "body": "@HWalters - you are correct, of course, which is why I post such questions in SE. Many times you get some novel ideas of how to exploit C features."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1527650593, "creation_date": 1527650593, "answer_id": 50595905, "question_id": 50595314, "link": "https://stackoverflow.com/questions/50595314/how-to-defer-a-macro-substitution-in-a-concatenate-stringify-cascade/50595905#50595905", "title": "How to defer a macro substitution in a concatenate-stringify cascade", "body": "<p>If you can do something each time <code>FOO</code> is used, you could first undefine the macro inorder for it expand as you want and then redefine it as in</p>\n\n<pre><code>#undef FOO\nPRINT(FOO);\n#define FOO 99\n</code></pre>\n\n<p>in which case it will expand to</p>\n\n<pre><code>printf(\"FOO\" \": \" \"12\" \"34\" \"\\n\");\n\nprintf(\"BAR\" \": \" \"56\" \"78\" \"\\n\");\n</code></pre>\n\n<p>to print what you want.</p>\n"}, {"comments": [{"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527689695, "post_id": 50596396, "comment_id": 88223512, "body": "Thanks for the elaborate explanation. Basically, what @Stan said in the comment to the question."}], "tags": [], "owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "is_accepted": false, "score": 2, "last_activity_date": 1527654468, "creation_date": 1527654468, "answer_id": 50596396, "question_id": 50595314, "link": "https://stackoverflow.com/questions/50595314/how-to-defer-a-macro-substitution-in-a-concatenate-stringify-cascade/50596396#50596396", "title": "How to defer a macro substitution in a concatenate-stringify cascade", "body": "<blockquote>How can I defer the expansion of the FOO macro ... NOTE: assume the PRINT() macro signature cannot be changed (i.e., can't add a parameter, etc.)</blockquote>\n\n<p>You can't.</p>\n\n<p>Macro expansions go through a series of steps:</p>\n\n<ul>\n<li>Argument substitution</li>\n<li>Paste and stringification in no particular order</li>\n<li>Rescan and further replacement</li>\n</ul>\n\n<p>Argument substitution occurs with your arguments; in the case of the invocation <code>PRINT(FOO)</code>, <code>FOO</code>; and it's the very first step.  By the time you even get the preprocessor to recognize that something in your replacement list is a macro, you've long past argument substitution.</p>\n\n<p>The rule for argument substitution is that if any of your parameters are mentioned in your replacement list, and those parameters are being neither stringified nor pasted, then the corresponding argument is fully evaluated and those mentions of the parameters are replaced with the result.  In this case, <code>PRINT(FOO)</code>, after argument substitution, results in the replacement list:</p>\n\n<pre><code>printf(#mac \": \" MAKE_MAC(99) \"\\n\")\n</code></pre>\n\n<p>Again, <code>MAKE_MAC</code>'s definition doesn't matter; it's not even recognized as a macro until rescan and further replacement.  </p>\n\n<p>Now, without your restriction, you could defer <code>FOO</code> from expanding... by adding a second parameter to <code>PRINT</code> and pasting to it (that disqualifies it from <code>a.s.</code>, and by the time rescan and replacement comes along it'd be invoking your next macro).  But with your restriction, you're DOA.</p>\n"}, {"comments": [{"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527689810, "post_id": 50597326, "comment_id": 88223597, "body": "Thanks for the elaborate explanation. Basically, what @Stan said in the comment to the question. I am selecting this answer over the other one  b/c you provided the quote from the standard."}, {"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "reply_to_user": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527690831, "post_id": 50597326, "comment_id": 88224356, "body": "@ysap Not sure to understand your comment. I&#39;ve answered the original question: how to define <code>PRINT</code> to get output <code>FOO: 1234 BAR: 5678</code>."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527693837, "post_id": 50597326, "comment_id": 88226465, "body": "Marian - of course, I failed to read the 2nd part of your answer. Coincidentally, I was thinking along the same lines just before you posted your comment, but you helped nail the solution. I modified the program and now it builds just right!"}], "tags": [], "owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "is_accepted": true, "score": 1, "last_activity_date": 1527666339, "last_edit_date": 1592644375, "creation_date": 1527660070, "answer_id": 50597326, "question_id": 50595314, "link": "https://stackoverflow.com/questions/50595314/how-to-defer-a-macro-substitution-in-a-concatenate-stringify-cascade/50597326#50597326", "title": "How to defer a macro substitution in a concatenate-stringify cascade", "body": "<p>The actual expansion of FOO to 99 happens at the moment when PRINT is expanded and before its body is re-scanned one more time. The relevant part of the ANSI standard is:</p>\n<blockquote>\n<p>6.10.3.1 Argument substitution</p>\n<p>1 After the arguments for the invocation of a function-like macro have been identified,\nargument substitution takes place. A parameter in the replacement list, unless preceded\nby a # or ## preprocessing token or followed by a ## preprocessing token (see below), is\nreplaced by the corresponding argument after all macros contained therein have been\nexpanded. Before being substituted, each argument\u2019s preprocessing tokens are\ncompletely macro replaced as if they formed the rest of the preprocessing file; no other\npreprocessing tokens are available.</p>\n</blockquote>\n<p>In your case you can avoid expansion of FOO (inside mac) by replacing</p>\n<pre><code>#define PRINT(mac) printf(#mac &quot;: &quot; MAKE_MAC(mac) &quot;\\n&quot;)\n</code></pre>\n<p>with</p>\n<pre><code>#define PRINT(mac) printf(#mac &quot;: &quot; CONCAT(mac##_ONE, mac##_TWO) &quot;\\n&quot;)\n</code></pre>\n"}], "owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 50597326, "answer_count": 3, "score": 2, "last_activity_date": 1527666339, "creation_date": 1527645369, "last_edit_date": 1527647654, "question_id": 50595314, "link": "https://stackoverflow.com/questions/50595314/how-to-defer-a-macro-substitution-in-a-concatenate-stringify-cascade", "title": "How to defer a macro substitution in a concatenate-stringify cascade", "body": "<p>This is a follow-up question to <a href=\"https://stackoverflow.com/q/50593593/274579\">this one</a> (and also closer to the actual problem at hand).</p>\n\n<p>If I have the following case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define FOO_ONE 12\n#define FOO_TWO 34\n#define BAR_ONE 56\n#define BAR_TWO 78\n\n#define FOO 99\n\n#define STRINGIFY(mac) #mac\n#define CONCAT(mac1, mac2) STRINGIFY(mac1) STRINGIFY(mac2)\n#define MAKE_MAC(mac) CONCAT(mac##_ONE, mac##_TWO)\n\n#define PRINT(mac) printf(#mac \": \" MAKE_MAC(mac) \"\\n\")\n\nvoid main(int argc, char *argv[])\n{\n    PRINT(FOO);\n    PRINT(BAR);\n}\n</code></pre>\n\n<p>As can be seen, the stringified, concatenated macros are then substituted inside a <code>printf()</code> statement which itself is inside a macro.</p>\n\n<p>Because <code>FOO</code> is defined (as <code>99</code>), it happens that it is expanded before the concatenation with <code>_ONE</code> and <code>_TWO</code>, effectively creating the tokens <code>99_ONE</code> and <code>99_TWO</code>.</p>\n\n<p>This program outputs:</p>\n\n<pre><code>FOO: 99_ONE99_TWO\nBAR: 5678\n</code></pre>\n\n<p>How can I defer the expansion of the FOO macro (effectively, eliminating it altogether, to get the required output of:</p>\n\n<pre><code>FOO: 1234\nBAR: 5678\n</code></pre>\n\n<p>NOTE: assume the <code>PRINT()</code> macro signature cannot be changed (i.e., can't add a parameter, etc.). However its implementation can be changed. Also, <code>FOO</code>, <code>FOO_*</code> and <code>BAR_*</code> definitions cannot be modified as well.</p>\n"}, {"tags": ["c", "multithreading", "sockets", "select"], "comments": [{"owner": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 2, "creation_date": 1527646079, "post_id": 50595197, "comment_id": 88199893, "body": "You ought to show your server code, too."}, {"owner": {"reputation": 495, "user_id": 7248145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GSHZs.png?s=128&g=1", "display_name": "christk", "link": "https://stackoverflow.com/users/7248145/christk"}, "reply_to_user": {"reputation": 22751, "user_id": 2399879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UxMS5.jpg?s=128&g=1", "display_name": "Crowman", "link": "https://stackoverflow.com/users/2399879/crowman"}, "edited": false, "score": 0, "creation_date": 1527668571, "post_id": 50595197, "comment_id": 88208577, "body": "@PaulGriffiths updated post"}], "owner": {"reputation": 495, "user_id": 7248145, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GSHZs.png?s=128&g=1", "display_name": "christk", "link": "https://stackoverflow.com/users/7248145/christk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527684900, "creation_date": 1527644115, "last_edit_date": 1527684900, "question_id": 50595197, "link": "https://stackoverflow.com/questions/50595197/how-to-connect-a-client-to-multiple-servers-which-are-held-in-threads-in-c", "title": "how to connect a client to multiple servers which are held in threads in c", "body": "<p>i successfully connected a client to one server which handles I/O through select function,then i created more servers with threads.In client i created new sockets , i made connection to those servers in different port numbers successfully and sent the first message from a server to client and client to server respectively.Although select in those servers can handle new connections , it is not recognizing I/O from existing connected sockets.</p>\n\n<p>client:</p>\n\n<pre><code>bzero(buffer,1024);\nvalread = read( sock , buffer, 1024);//receive first message\nprintf(\"%s\\n\",buffer );\nwhile (1) {\n  bzero(buffer,1024);\n  printf(\"write:\\n\");\n  fgets(buffer,1024,stdin);//write something\n  buffer[strcspn(buffer, \"\\n\")] = 0;\n  if (strcmp(buffer,\"exit***\")==0) {\n     valread = write(sock, buffer, strlen(buffer));\n     exit(1);\n  }\n  send(sock , buffer , strlen(buffer) , 0 );//here program stuck and waiting for select in server, but in server nothing happens\n  bzero(buffer,1024);\n  valread = read( sock , buffer, 1024);\n  printf(\"%s\\n\",buffer );\n}\n</code></pre>\n\n<p>in a situation with a single server and many clients,it works but in a multi server situation(in threads) like this, it stuck in the select function.Is there any bug with threads and select?</p>\n\n<p><strong>update</strong></p>\n\n<p>i found that the error is in fgets(buffer,1024,stdin);\nIn the first iteration ,fgets is not waiting for user to type something and \nit passes 0 bytes to send function...The server cannot handle this.</p>\n\n<p><strong>solution</strong>\nbefore that code i added while ((getchar()) != '\\n'); to clear the buffer which probably had a new line inside and caused that behaviour</p>\n"}, {"tags": ["c", "pointers", "malloc", "gmp"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527644483, "post_id": 50595149, "comment_id": 88199560, "body": "You don&#39;t malloc enough space. Read the documentation of <code>mpz_get_str</code> to see how to use it properly"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1533144198, "post_id": 50595149, "comment_id": 90242398, "body": "If you want it to be removed, then use the delete link below the tags and remove it."}], "owner": {"reputation": 232, "user_id": 9867311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8987fb82181f0e60e832600d8076123?s=128&d=identicon&r=PG&f=1", "display_name": "Rudra", "link": "https://stackoverflow.com/users/9867311/rudra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533142731, "creation_date": 1527643717, "last_edit_date": 1533142731, "question_id": 50595149, "link": "https://stackoverflow.com/questions/50595149/problems-with-pointers-and-array", "title": "Problems with pointers and array", "body": "<p>Posting this question after 3-4 days of frantic online search but nothing helped. Honestly, at this point I think I don't even know what to search for anymore. I really need some \"pointers\" on how to deal with pointers and arrays, this thing is killing me.</p>\n\n<p>I am simply trying to compute integer exponentiation using binary exponentiation method. Here is my code for computing 2^n as example -</p>\n\n<pre><code>#include &lt;stdlib.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;gmp.h&gt;\n\n// Compute z = x^n\nvoid mpz_binexp_pow(mpz_t z, const mpz_t x, const mpz_t n) {\n\n/*\n * Local variables\n */\n    char *pointer = NULL;\n    char *pc = NULL;\n    char *c = NULL;\n\n    pointer = (char*) malloc(sizeof(mpz_t));\n    pc = pointer;\n\n/*\n *  Get the binary representation of the exponent\n */\n    c = mpz_get_str(pointer,2,n);\n    c[strlen(c)+1] = '\\0';\n\n    printf(\"%s\\n\\n\",c);\n\n/*\n *  Perform left to right binary exponentiation steps\n */\n    /*for(int i = 0;i&lt;strlen(c);i++) {\n        mpz_pow_ui(z, z, 2);\n        if (c[i] == '1')\n            mpz_mul(z, z, x);\n        printf(\"%c - \\n\", c[i]);\n        //gmp_printf(\"%Zd\\n\", z);\n    }*/\n\n    while(*c){\n        mpz_pow_ui(z, z, 2);\n        if (*c == '1')\n            mpz_mul(z, z, x);\n        c++;\n        printf(\"%c - \\n\", *c);\n        //gmp_printf(\"%Zd\\n\", z);\n    }\n\n    free(pc);\n}\n\nint main(int argc, char *argv[]) {\n\nmpz_t z;    mpz_init(z);    mpz_set_ui(z,1);\nmpz_t x;    mpz_init(x);    mpz_set_ui(x,2);\nmpz_t n;    mpz_init(n);    mpz_set_ui(n,1449728);\nmpz_binexp_pow(z,x,n);\n\nreturn 0;\n}\n</code></pre>\n\n<p>Everything works fine for small exponents like 2, 3 etc.. but things really get crazy for relatively larger numbers like the one shown(I need this to work for way larger exponents than what I show here)</p>\n\n<p>Now when I run this code multiple times I get the right output only about 1 in 15 executions which I think doesn't really matter. I am not able to figure out what is going wrong. I get the right binary rep. of the exponent which I can see by printing it out. For example, the binary rep. of exponent 1449728 is 101100001111100000000. Now, when I get inside the loop to perform l2r steps, almost every time the program gets messed up after the third zero in the last zero sequence i.e it executes correctly until 1011000011111000<strong>this point</strong>. Sometimes I see some other characters like '?' and '>' instead of the rest of the zeros and sometimes I just don't see anything, the program gets stuck. What is going on?</p>\n\n<p>I am very certain this is a pointer issue and my pointer knowledge is extremely weak but I would really like hints on how to fix this and also the reasoning behind what is happening and what I am doing wrong.</p>\n\n<p><strong>EDIT</strong>\nThis question has been resolved. I wish for this question to be closed or removed.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1527643747, "post_id": 50595146, "comment_id": 88199437, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527643963, "post_id": 50595146, "comment_id": 88199462, "body": "You read out of bounds of your allocation (you resize to <code>n-1</code> but you keep reading <code>n</code> items). Maybe you meant to decrement <code>n</code> in the &quot;trying to remove the duplicate&quot; case, but that loop won&#39;t correctly remove duplicates that are not at the end"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1527657799, "post_id": 50595146, "comment_id": 88202831, "body": "You will want to look at <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><b>Why is while ( !feof (file) ) always wrong?</b></a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527664543, "post_id": 50595146, "comment_id": 88206085, "body": "You will also need to look at <a href=\"https://stackoverflow.com/questions/15740024/\">Why trailing white space in a <code>scanf()</code> format string is a bad idea</a>."}, {"owner": {"reputation": 797, "user_id": 99124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb4a98e32eb0337a855061470ea7a19?s=128&d=identicon&r=PG", "display_name": "mlp", "link": "https://stackoverflow.com/users/99124/mlp"}, "edited": false, "score": 0, "creation_date": 1527713326, "post_id": 50595146, "comment_id": 88236145, "body": "Don&#39;t cast the result of a call to <code>malloc()</code>, <code>realloc()</code>, etc. It&#39;s unnecessary (<code>void *</code> is automatically converted to any pointer type) and potentially dangerous (if the correct prototype is not in scope, the cast may silence the compiler&#39;s otherwise-helpful warning and generate bad code for you)."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1527656169, "post_id": 50596530, "comment_id": 88202346, "body": "This answer might well be appropriate on <a href=\"https://pt.stackoverflow.com/\">Stack Overflow em Portugu&#234;s</a> but is not appropriate on the English-language site."}, {"owner": {"reputation": 29, "user_id": 9719107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Cpsw.jpg?s=128&g=1", "display_name": "Lorhan Sohaky", "link": "https://stackoverflow.com/users/9719107/lorhan-sohaky"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527700614, "post_id": 50596530, "comment_id": 88230248, "body": "The names of the files are in Portuguese, so I answered in Portuguese"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1527702895, "post_id": 50596530, "comment_id": 88231487, "body": "I understand the urge \u2014 but the question was in English, as it is supposed to be, and the answer should be in English, too (though I&#39;d have no problem with English and Portugese saying the same). I don&#39;t entirely agree with the policy \u2014 I certainly have limited sympathy with those demanding that the code be in English \u2014 but it is the SO policy that questions are asked in English. I&#39;ve not down-voted you either. I got abused in comments recently for translating a question with Google Translate \u2014 apparently, there are those who think you can&#39;t do for others what they could/should do themselves."}], "tags": [], "owner": {"reputation": 29, "user_id": 9719107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6Cpsw.jpg?s=128&g=1", "display_name": "Lorhan Sohaky", "link": "https://stackoverflow.com/users/9719107/lorhan-sohaky"}, "is_accepted": false, "score": 0, "last_activity_date": 1527659180, "last_edit_date": 1527659180, "creation_date": 1527655382, "answer_id": 50596530, "question_id": 50595146, "link": "https://stackoverflow.com/questions/50595146/delete-element-from-a-dynamic-array-c/50596530#50596530", "title": "Delete element from a dynamic array C", "body": "<p>What you will have to do is move the repeated elements to the end of the list and then remove them.</p>\n"}, {"tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": false, "score": 1, "last_activity_date": 1527658113, "last_edit_date": 1527658113, "creation_date": 1527657556, "answer_id": 50596845, "question_id": 50595146, "link": "https://stackoverflow.com/questions/50595146/delete-element-from-a-dynamic-array-c/50596845#50596845", "title": "Delete element from a dynamic array C", "body": "<p>This:</p>\n\n<pre><code>for(j=n;j&gt;=0;j--){\n    ...\n}\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>for(j=n-1;j&gt;=0;j--){\n    ...\n}\n</code></pre>\n\n<p>Otherwise you are going out of bound.</p>\n\n<p>Than this:</p>\n\n<pre><code>if(v[j]==v[j-1])\n     v=(int*)realloc(v,(n-1)*sizeof(int));\n</code></pre>\n\n<p>is reallocating but not removing doubles. Meaning that you if you have</p>\n\n<pre><code>1 2 2 5\n</code></pre>\n\n<p>all this code does is remove <code>5</code> so you end up with</p>\n\n<pre><code>1 2 2\n</code></pre>\n\n<p>And in case where you reallocate and downsize your array in memory is not going to move it is going to stay where it is, thus in many cases you can still access <code>5</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1527710450, "last_edit_date": 1527710450, "creation_date": 1527704904, "answer_id": 50611303, "question_id": 50595146, "link": "https://stackoverflow.com/questions/50595146/delete-element-from-a-dynamic-array-c/50611303#50611303", "title": "Delete element from a dynamic array C", "body": "<p>You have a couple of problems. First, your look and <code>if</code> conditions invoke <em>Undefined Behavior</em> by reading outside the bounds of <code>v</code> in</p>\n\n<pre><code>for(j=n;j&gt;=0;j--){\n    if(v[j]==v[j-1])\n</code></pre>\n\n<p>When <code>j = n</code> you read 1-past the end of the array, <strong>and</strong> where <code>j = 0</code>, you read 1-before the beginning of the array. A better approach would be:</p>\n\n<pre><code>    i = n - 1;      /* set i to last element */\n    while (i--)     /* loop removing the duplicates */\n        /* if current equals next */\n        if (v[i] == v[i + 1]) { \n        ...\n</code></pre>\n\n<p>Next, rather than using <code>realloc</code> to trim block from the end, you should use <code>memmove</code> to remove duplicates. (<code>realloc</code> can do nothing for <code>1, 2, 2, 3, 4</code>) Instead simply backup over each element, checking for duplicates, and moving the end elements forward to overwrite the duplicate. Don't worry about <code>realloc</code> until you have removed all duplicates -- then <code>realloc</code> once, e.g.</p>\n\n<pre><code>    i = n - 1;      /* set i to last element */\n    while (i--)     /* loop removing the duplicates */\n        /* if current equals next */\n        if (v[i] == v[i + 1]) { /* use memmove - blocks overlap */\n            memmove (&amp;v[i], &amp;v[i + 1], (n - i - 1) * sizeof *v);\n            n--;    /* decrement count */\n        }\n\n    /* final reallocation */\n    tmp = realloc (v, n * sizeof *v);   /* never realloc to original ptr */\n    if (tmp == NULL) {                  /* validate reallocation */\n        perror (\"realloc-final\");\n        return 1;\n    }\n    v = tmp;        /* then assign new block to original pointer */\n</code></pre>\n\n<p><strong>note:</strong> do not <code>realloc</code> to the original pointer itself. Instead use a temporary pointer, and then validate that the <code>realloc</code> succeeded <strong>before</strong> assigning the address for the new block of memory to the original pointer.</p>\n\n<p>Putting together a short example that uses an initialized array of jumbled numbers rather than reading from a file (since none was provided), you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n/* simple qsort compare - sort int ascending */\nint compare (const void *a, const void *b)\n{\n    return (*(int*)a &gt; *(int*)b) - (*(int*)a &lt; *(int*)b);\n}\n\nint main (void) {\n\n    int a[] = {5,1,5,5,2,8,3,2,6,9,4,8,1,4,3,6,9,2,7,7},  /* numbers */\n        n = sizeof a / sizeof *a,   /* number of elements */\n        *v = NULL,                  /* pointer to allocate */\n        i;\n    void *tmp;  /* temp pointer to realloc, never realloc w/original */\n\n    v = malloc (n * sizeof *v); /* don't cast return of malloc, always\n                                * use 'n * sizeof dereferenced pointer'\n                                */\n    memcpy (v, a, n * sizeof *v);       /* copy a to v */\n    qsort (v, n, sizeof *v, compare);   /* sort v */\n\n    for (i = 0; i &lt; n; i++){            /* output sorted v */\n        printf (\"a[%2d]: %d\\n\", i, v[i]);\n    }\n\n    i = n - 1;      /* set i to last element */\n    while (i--)     /* loop removing the duplicates */\n        /* if current equals next */\n        if (v[i] == v[i + 1]) { /* use memmove - blocks overlap */\n            memmove (&amp;v[i], &amp;v[i + 1], (n - i - 1) * sizeof *v);\n            n--;    /* decrement count */\n        }\n\n    /* final reallocation */\n    tmp = realloc (v, n * sizeof *v);   /* never realloc to original ptr */\n    if (tmp == NULL) {                  /* validate reallocation */\n        perror (\"realloc-final\");\n        return 1;\n    }\n    v = tmp;        /* then assign new block to original pointer */\n\n    printf (\"Retirados:\\n\");\n    for (i = 0; i &lt; n; i++){\n        printf (\"a[%2d]: %d\\n\", i, v[i]);\n    }\n\n    free (v);   /* don't forget to free memory you allocate */\n#if defined (_WIN32) || defined (_WIN64)\n    getchar();  /* just use getchar() to hold terminal open on windows */\n#endif\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> <code>qsort</code> was used in place of your <code>OrdenarQuicksort</code> since you did not provide the <code>OrdenarQuicksort</code> code)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/array_rm_dups\na[ 0]: 1\na[ 1]: 1\na[ 2]: 2\na[ 3]: 2\na[ 4]: 2\na[ 5]: 3\na[ 6]: 3\na[ 7]: 4\na[ 8]: 4\na[ 9]: 5\na[10]: 5\na[11]: 5\na[12]: 6\na[13]: 6\na[14]: 7\na[15]: 7\na[16]: 8\na[17]: 8\na[18]: 9\na[19]: 9\nRetirados:\na[ 0]: 1\na[ 1]: 2\na[ 2]: 3\na[ 3]: 4\na[ 4]: 5\na[ 5]: 6\na[ 6]: 7\na[ 7]: 8\na[ 8]: 9\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/array_rm_dups\n==26625== Memcheck, a memory error detector\n==26625== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==26625== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==26625== Command: ./bin/array_rm_dups\n==26625==\na[ 0]: 1\na[ 1]: 1\na[17]: 8\n&lt;snip&gt;\na[18]: 9\na[19]: 9\nRetirados:\na[ 0]: 1\na[ 1]: 2\na[ 2]: 3\na[ 3]: 4\na[ 4]: 5\na[ 5]: 6\na[ 6]: 7\na[ 7]: 8\na[ 8]: 9\n==26625==\n==26625== HEAP SUMMARY:\n==26625==     in use at exit: 0 bytes in 0 blocks\n==26625==   total heap usage: 2 allocs, 2 frees, 116 bytes allocated\n==26625==\n==26625== All heap blocks were freed -- no leaks are possible\n==26625==\n==26625== For counts of detected and suppressed errors, rerun with: -v\n==26625== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p><strong>Validate All File Opens &amp; Reads</strong></p>\n\n<p>Reading from a file, you must validate the <code>fopen</code> and you must validate each <code>fscanf</code>. There is no reason to include the <code>'\\n'</code> in your <em>format string</em>, the <code>\"%d\"</code> (and in fact all numeric) <em>format specifiers</em> consume leading <em>whitespace</em> (which includes <code>' '</code>, <code>'\\t'</code> and <code>'\\n'</code>).</p>\n\n<p>When using <code>malloc</code> or <code>realloc</code>, do not cast the result -- there is no reason to. Both return <code>void*</code> which can be assigned to any pointer type without a cast, see: <a href=\"http://stackoverflow.com/q/605845/995714\">Do I cast the result of malloc?</a></p>\n\n<p>Putting those pieces together, your open and read could be done something like:</p>\n\n<pre><code>    f = fopen (\"InteirosComRepetidos.txt\",\"r\");\n    if (f == NULL) {    /* validate file open for reading */\n        perror (\"fopen-InteirosComRepetidos.txt\");\n        return 1;   /* if it isn't, exit */\n    }\n    v = malloc (sizeof *v); /* don't cast return of malloc, and if you always\n                             * use 'sizeof dereferenced pointer', times some\n                             * amount, you will always get your allocations\n                             * correct */\n\n    while (fscanf (f, \"%d\", &amp;v[n]) == 1) {  /* loop on validated scanf return */\n        tmp = realloc (v, (n+1) * sizeof *v); /* never realloc ptr iself */\n        if (tmp == NULL) {  /* validate realloc succeeded/handle failure */\n            perror (\"realloc-v\");\n            return 1;\n        }\n        v = tmp;    /* assign reallocated pointer to v */\n        n++;        /* advance counter */\n    }\n</code></pre>\n\n<p><strong>note:</strong> you never <code>realloc</code> and assign the result to the original pointer (e.g. <code>v = realloc (v, ...)</code>). <code>realloc</code> can fail and when it does, it returns <code>NULL</code>. In that case, you have just lost the reference to your original block of memory -- resulting in not being able to use or <code>free</code> that memory (you have created a <em>memory leak</em>). Instead, always <code>realloc</code> with a temporary pointer (e.g. <code>void *tmp = realloc (v, ...)</code>) and validate that the reallocation succeeds before assigning <code>v = tmp;</code>. That way, in the event <code>realloc</code> fails, you still have your reference to the original block of memory in <code>v</code> (which still holds (or points to) all your original values before your attempted <code>realloc</code>)</p>\n"}], "owner": {"reputation": 31, "user_id": 9446559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2deb9b844a0e188c61d6e3aaeda9116?s=128&d=identicon&r=PG&f=1", "display_name": "R&#250;ben Cardoso", "link": "https://stackoverflow.com/users/9446559/r%c3%baben-cardoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1527710450, "creation_date": 1527643696, "last_edit_date": 1527655867, "question_id": 50595146, "link": "https://stackoverflow.com/questions/50595146/delete-element-from-a-dynamic-array-c", "title": "Delete element from a dynamic array C", "body": "<p>I'm doing some exercises for my class, and I'm stuck with a problem.\nThe exercise asks to fill a dynamic array with data from a file, order the data and then delete the duplicate data.\nMy problem is in the last one, I cannot delete the duplicated numbers.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int main(){\n    FILE *f;\n    int *v;\n    int n=0,i,j;\n\n    f=fopen(\"InteirosComRepetidos.txt\",\"r\");\n    v=(int*)malloc(sizeof(int));\n\n    while(!feof(f)){\n        v=(int*)realloc(v,(n+1)*sizeof(int));\n        fscanf(f,\"%d\\n\",&amp;v[n]);\n        n++;\n    }\n\n    OrdenarQuicksort(v,0,n);\n\n    for(i=0;i&lt;n;i++){\n        printf(\"%d\\n\",v[i]);\n    }\n    //Trying to remove the duplicate\n    for(j=n;j&gt;=0;j--){\n        if(v[j]==v[j-1])\n            v=(int*)realloc(v,(n-1)*sizeof(int));\n    }\n\n    printf(\"Retirados:\\n\");\n    for(i=0;i&lt;n;i++){\n        printf(\"%d\\n\",v[i]);\n    }\n    system(\"pause\");\n    return 0;}  \n</code></pre>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["c#", "c", "vb.net", "ruby-on-rails-3", "xamarin"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1527643006, "post_id": 50595057, "comment_id": 88199273, "body": "the XAML is not really relevant.  It would be more helpful to post the code of your renderer, and perhaps a screenshot illustrating the incorrect behavior"}, {"owner": {"reputation": 1, "user_id": 9866437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d1bb316f62b846299d7c9224960c083?s=128&d=identicon&r=PG&f=1", "display_name": "Hamadda", "link": "https://stackoverflow.com/users/9866437/hamadda"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1527644140, "post_id": 50595057, "comment_id": 88199494, "body": "The same code for IOS at this link <a href=\"https://stackoverflow.com/questions/38106050/xamarin-custom-buttonrenderer-text-under-image\" title=\"xamarin custom buttonrenderer text under image\">stackoverflow.com/questions/38106050/&hellip;</a>"}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1527644151, "post_id": 50595057, "comment_id": 88199499, "body": "Just use a <code>button</code>... <code>&lt;Button  x:Name=&quot;btn2&quot; ContentLayout=&quot;Top,0&quot; BackgroundColor=&quot;White&quot; Image=&quot;iconRes.png&quot;  HorizontalOptions=&quot;CenterAndExpand&quot; Text=&quot;click me&quot; &#47;&gt;</code>"}, {"owner": {"reputation": 1, "user_id": 9866437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d1bb316f62b846299d7c9224960c083?s=128&d=identicon&r=PG&f=1", "display_name": "Hamadda", "link": "https://stackoverflow.com/users/9866437/hamadda"}, "edited": false, "score": 0, "creation_date": 1527646164, "post_id": 50595057, "comment_id": 88199908, "body": "The problem specially with iOS on &lt;ContentLayout=&quot;Top,0&quot;&gt;if the text wider than the image the image moves to the right but not goes to newline."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1527648120, "post_id": 50595057, "comment_id": 88200381, "body": "I am confused, are you working with Xamarin or iOS? You keep mentioning iOS related issues, is the .Net and Android button working for you then?"}, {"owner": {"reputation": 1, "user_id": 9866437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d1bb316f62b846299d7c9224960c083?s=128&d=identicon&r=PG&f=1", "display_name": "Hamadda", "link": "https://stackoverflow.com/users/9866437/hamadda"}, "edited": false, "score": 0, "creation_date": 1527699810, "post_id": 50595057, "comment_id": 88229778, "body": "Am working with XamarinForms... the result at the Android is fine."}], "owner": {"reputation": 1, "user_id": 9866437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d1bb316f62b846299d7c9224960c083?s=128&d=identicon&r=PG&f=1", "display_name": "Hamadda", "link": "https://stackoverflow.com/users/9866437/hamadda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527647991, "creation_date": 1527642664, "last_edit_date": 1527647991, "question_id": 50595057, "link": "https://stackoverflow.com/questions/50595057/xamrin-forms-buttonimage-renderer-text-under-image", "title": "Xamrin Forms --- buttonImage renderer-text-under-image", "body": "<p><strong>Here is the code for the custom Renderer in iOS.</strong> .<br>\nmy point is i want the text to be under then image, i tried XLabs ImageButton but it's looks like they are not working with the new XamarinForms anymore ....</p>\n\n<p><em>Xamarin.iOS...</em> . </p>\n\n<p>/* . </p>\n\n<blockquote>\n  <p>Blockquote </p>\n</blockquote>\n\n<pre><code>public class ButtonCustomRendererIOS : ButtonRenderer\n    {\n        public ButtonCustomRendererIOS()\n        {\n        }\n\n        protected override void OnElementChanged(ElementChangedEventArgs&lt;Button&gt; e)\n        {\n            base.OnElementChanged(e);\n            if(e.NewElement !=null)\n            {\n                if (Control != null)\n                {\n\n#if DEBUG\n                    Control.HorizontalAlignment = UIControlContentHorizontalAlignment.Center;\n                    Control.VerticalAlignment   =   UIControlContentVerticalAlignment.Center;\n\n                    Control.Layer.CornerRadius = 15;\n                    Control.Layer.BorderWidth = 5;\n                    Control.Layer.BorderColor = Color.Red.ToCGColor();\n\n                    var uiImage = UIImage.FromFile(((Button)e.NewElement).Image.File);\n                    var lineHeight = Control.TitleLabel.Font.LineHeight;\n                    Control.ImageEdgeInsets = new UIEdgeInsets(-lineHeight, uiImage.Size.Width + (uiImage.Size.Width / 2), 0, 0);\n                    Control.TitleEdgeInsets = new UIEdgeInsets(uiImage.Size.Height, -uiImage.Size.Width, 0, 0);\n                    uiImage.Dispose();\n#endif\n\n\n                }\n            }\n        }\n    }\n</code></pre>\n\n<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n\n<p>*/ . </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1527642379, "post_id": 50594910, "comment_id": 88199137, "body": "If you want 32 binary bits plus a <code>&#39;\\0&#39;</code>, then you need an array of 33 characters. Also, the code needs to convert the integer values <code>0</code> and <code>1</code> to the character values <code>&#39;0&#39;</code> and <code>&#39;1&#39;</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527642954, "post_id": 50594910, "comment_id": 88199266, "body": "You need to learn what is ascii representation of the digit and the number represented by this digit"}, {"owner": {"reputation": 17, "user_id": 7039898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba335f32baff0cee235228be3418da9?s=128&d=identicon&r=PG&f=1", "display_name": "Aizshing", "link": "https://stackoverflow.com/users/7039898/aizshing"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1527644922, "post_id": 50594910, "comment_id": 88199658, "body": "@user3386109, I was totally distracted about the &#39;0&#39; and &#39;1&#39;, it turns out that this and the 33 characters was the problem! rotfl Thanks for the help!"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1527645534, "post_id": 50594910, "comment_id": 88199782, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23286738/is-it-necessary-to-supply-the-null-character-when-declaring-an-characters-array\">Is it necessary to supply the null character when declaring an character&#39;s array?</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1527647824, "post_id": 50594910, "comment_id": 88200313, "body": "Please explain <code>bits = (char *)malloc</code>... , where <code>bits</code> is an <code>int *</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527647948, "post_id": 50594910, "comment_id": 88200340, "body": "<code>1 &lt;&lt; 31</code> causes undefined behaviour (if you have 32-bit ints), you should use <code>uint32_t</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1527666029, "post_id": 50594910, "comment_id": 88207062, "body": "If you used to have <code>char[32]</code> before, why would you want to make it an array of integers now?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1527666436, "post_id": 50594910, "comment_id": 88207297, "body": "you also shouldn&#39;t <a href=\"https://stackoverflow.com/q/605845/995714\">cast the result of malloc in C</a>"}, {"owner": {"reputation": 17, "user_id": 7039898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba335f32baff0cee235228be3418da9?s=128&d=identicon&r=PG&f=1", "display_name": "Aizshing", "link": "https://stackoverflow.com/users/7039898/aizshing"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1528092974, "post_id": 50594910, "comment_id": 88358328, "body": "@M.M totally wrong casting, I meant (int*)malloc(...). Also, thanks for the tip about casting the result of a malloc."}], "owner": {"reputation": 17, "user_id": 7039898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba335f32baff0cee235228be3418da9?s=128&d=identicon&r=PG&f=1", "display_name": "Aizshing", "link": "https://stackoverflow.com/users/7039898/aizshing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527641403, "creation_date": 1527641403, "question_id": 50594910, "link": "https://stackoverflow.com/questions/50594910/converting-types-resulting-in-bug", "title": "Converting types resulting in bug", "body": "<p>I got stuck in a univ project as follows:\nI was doing it before I knew the format of the input, so I started reading it with %s, and it was a char[32].\nThen when the project was released, I realized I needed to read the input as int.\nSo now I started to read it as int and now I don't want to make again all other functions I made, and they are receiving the arguments as an array of chars (char[32]).\nSo I made a function to convert the int value to int*, because I can't return char[32]. Hence I did, on main, a simple for to pass the values in int* to char[32]. The problem is that, when I print it on main, I see exactly the same values, but when I pass this new char[32] to my functions, I get a bug now. I guess my problem is because of '\\0' or something like this.</p>\n\n<p>A simple demonstration is below:</p>\n\n<pre><code>int* convert_dec_to_bin(int n){\n    printf(\"\\n\");\n    int i, j, k;\n    int *bits;\n    bits = (char*)malloc(32*sizeof(int));\n    for(i = 31, j = 0; i &gt;= 0; --i){\n        printf(\"%d\", n &amp; 1 &lt;&lt; i ? 1 : 0);\n        if(n &amp; 1 &lt;&lt; i){\n            bits[j] = 1;\n        }else{\n            bits[j] = 0;\n        }\n        j++;\n    }\n    printf(\"\\n\");\n    return bits;\n}\n\n\nint main(){\n\n\n    int i, k, instructionNameInt;\n    char type;\n    int *bits;\n    char bitsC[32];\n    //char instructionBinary[32]; I was reading like this before, ignore this line\n    int instructionBinary; //Now I read like this\n    scanf(\"%d\", &amp;instructionBinary);\n    bits = convert_dec_to_bin(instructionBinary); //This is a function where I pass the int decimal input to 32 bits in binary as int*.\n\n    //Making probably the wrong conversion here, I tried to put '\\0' in the end but somehow I failed\n    for(k = 0; k &lt; 32; k++){\n        bitsC[k] = bits[k];\n    }\n    printf(\"\\n\");\n\n\n    type = determine_InstructionType(bitsC);\n\n    printf(\"TYPE: %c\\n\", type);\n\n    instructionNameInt = determine_InstructionName(bitsC, type);\n\n    And several other functions...\n</code></pre>\n\n<p>Can someone light me up how can I fix it? I spent several hours and still didn't achieve to pass this correctly to an array of chars.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1527639636, "post_id": 50594593, "comment_id": 88198576, "body": "perhaps this question and answers will shine some light on your very similar question: <a href=\"https://stackoverflow.com/q/38215004/1212725\">stackoverflow.com/q/38215004/1212725</a>"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1527640905, "post_id": 50594593, "comment_id": 88198833, "body": "@bruceg  still dont know what situation recursive is a good use, although that post surely does help, thanks."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1527640940, "post_id": 50594593, "comment_id": 88198839, "body": "A na&#239;ve recursive solution has to calculate <code>fib(40)</code> once, but that means calculating <code>fib(39)</code> once and <code>fib(38)</code> once. Calculating <code>fib(39)</code> means calculating <code>fib(38)</code> and <code>fib(37)</code> \u2014 so that&#39;s two lots of <code>fib(38)</code> that will be calculated.  Of course, each of those also calculates <code>fib(37)</code> and <code>fib(36)</code>, so <code>fib(37)</code> is calculated 3 times, and \u2026 it quickly builds up to a lot of recursive function calls, which is why the recursive solution takes more time than the iterative solution.  No: (na&#239;ve) recursive Fibonacci sequence is a bad idea. A not-so-naive version stashes values as it goes."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1527643132, "post_id": 50594593, "comment_id": 88199306, "body": "Recursion is good only in the school. In the real programming is useless and some standards ban it completely as very dangerous and error prone. It is usually slower and consumes a lots of of the resources (time, stack space etc)"}, {"owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527643744, "post_id": 50594593, "comment_id": 88199435, "body": "@JonathanLeffler the not-so-naive version has advantages, is equal or still worse than iterative way?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527644474, "post_id": 50594593, "comment_id": 88199558, "body": "A not-so-na&#239;ve recursive solution is still slower than an iterative solution, especially an iterative solution that stashes values as it goes."}], "answers": [{"comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527642437, "post_id": 50594900, "comment_id": 88199153, "body": "A good idea, but this doesn&#39;t really answer the OP&#39;s question."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527646344, "post_id": 50594900, "comment_id": 88199944, "body": "It does, though the question is underformulated."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527648598, "post_id": 50594900, "comment_id": 88200488, "body": "&quot;how do i print every number of fibonacci sequence without repeat every step?&quot;  Seems fairly well formed to me."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1527648999, "post_id": 50594900, "comment_id": 88200582, "body": "Yes, but if you read the question body, this function only <i>calculates</i> F, while they are printed else where, and the only issue is about <code>fib</code> taking too long at large argument valued."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": false, "score": 1, "last_activity_date": 1527641325, "creation_date": 1527641325, "answer_id": 50594900, "question_id": 50594593, "link": "https://stackoverflow.com/questions/50594593/in-this-example-how-do-i-print-the-sequence-only-once-recursive-function/50594900#50594900", "title": "in this example how do i print the sequence only once? (recursive function)", "body": "<p>You can easily optimize the recursive solution by memoizing the already-computed values:</p>\n\n<pre><code>int fib(int n) {\n    static int cache[48] = {0}; // should be enough to hold all int fibs\n    if(n &lt; 2) return n; // initial conditions\n    else if(cache[n]) return cache[n]; // a value already computed and memoized\n    else return cache[n] = fib(n - 1) + fib(n - 2); // the largest so far\n}\n</code></pre>\n\n<p>Should speed up the computation by, uh, some factor.</p>\n"}, {"tags": [], "owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "is_accepted": true, "score": 0, "last_activity_date": 1527653294, "creation_date": 1527653294, "answer_id": 50596249, "question_id": 50594593, "link": "https://stackoverflow.com/questions/50594593/in-this-example-how-do-i-print-the-sequence-only-once-recursive-function/50596249#50596249", "title": "in this example how do i print the sequence only once? (recursive function)", "body": "<p>Imperative languages like C do not always map well to functional definitions of algorithms.</p>\n\n<p>Non-recursive is generally faster because both the compiler and processor can more easily optimize/parallel'ize the execution and you're not wasting energy, needlessly pushing and popping the stack. Either way, all you need are the previous two fib values to calculate the next one:</p>\n\n<pre><code>void PrintNFibs(unsigned n)\n{\n    size_t a = 1;\n    size_t b = 1;\n    size_t sum;\n    printf(\"0\\n1\\n1\\n\");\n    while ( n-- )\n    {\n        sum = a + b;\n        printf(\"%zu\\n\", sum);\n        a = b;\n        b = sum;\n    }\n}\n</code></pre>\n\n<p>It's one thing to define an algorithm in terms of itself (recursion) and another to implement it efficiently in C. For something as simple as Fibonacci however, I would not use recursion, but here's one anyway:</p>\n\n<pre><code>void PrintNFibsR(unsigned n)\n{\n    static size_t a = 0;\n    static size_t b = 1;\n    static size_t sum;\n    sum = a + b;\n\n    if ( a == 0 )\n    {\n        printf(\"0\\n1\\n\");\n    }\n\n    printf(\"%zu\\n\", sum);\n    if ( n &gt; 1 )\n    {\n        a = b;\n        b = sum;\n        PrintNFibsR(n - 1);\n    }\n}\n</code></pre>\n\n<p>Notice that all we're really doing here is passing the loop counter. Wasteful but technically recursive, if not actually functional. The problem with writing C code that looks just like the recursive Fibonacci algorithm definition, is it burns energy and stack space for no good reason. The only way you can print the values in the correct order without calculating and storing each one of them in advance, is to alter the algorithm.</p>\n"}], "owner": {"reputation": 128, "user_id": 9806533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j7zEj.jpg?s=128&g=1", "display_name": "raijin", "link": "https://stackoverflow.com/users/9806533/raijin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 50596249, "answer_count": 2, "score": 0, "last_activity_date": 1527653294, "creation_date": 1527638499, "question_id": 50594593, "link": "https://stackoverflow.com/questions/50594593/in-this-example-how-do-i-print-the-sequence-only-once-recursive-function", "title": "in this example how do i print the sequence only once? (recursive function)", "body": "<p>just a fibonacci algorithm, how do i print every number of fibonacci sequence without repeat every step?</p>\n\n<p>Does recursive functions is a good use in any way? I know it is more legible, but there is a visible delay in this simple algorithm if i put n = 40, whereas the iterative way of doing it is instantaneous. </p>\n\n<pre><code>int fib(int n)\n{   \n    if (n == 0)\n    {\n        return 0;\n    }\n    else if (n == 1)\n    {\n        return 1;\n    }\n\n    return fib(n - 1) + fib(n - 2);\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "gdb", "reverse-engineering", "objdump"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 4, "creation_date": 1527637789, "post_id": 50594438, "comment_id": 88198154, "body": "Traditionally, binaries are loaded to fixed addresses on Unix.  You can have binaries whose load address is only determined at runtime, this is called PIE (position independent executable)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1527639027, "post_id": 50594438, "comment_id": 88198443, "body": "... and every process gets its own virtual address space, so fixed addresses do not create a risk of address collisions."}, {"owner": {"reputation": 190, "user_id": 6292128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86d69b38297441ffb0669edb14c1777?s=128&d=identicon&r=PG&f=1", "display_name": "Julien S&#233;veno-Piltant", "link": "https://stackoverflow.com/users/6292128/julien-s%c3%a9veno-piltant"}, "edited": false, "score": 0, "creation_date": 1527684767, "post_id": 50594438, "comment_id": 88219743, "body": "Yes you are both right actually, I did not think about the address space. Thank you for your answers guys."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1527639513, "creation_date": 1527639513, "answer_id": 50594707, "question_id": 50594438, "link": "https://stackoverflow.com/questions/50594438/why-addresses-of-instructions-from-gdb-and-objdump-are-the-same/50594707#50594707", "title": "Why addresses of instructions from GDB and Objdump are the same?", "body": "<p>GDB disables ASLR by default.  If you <code>set disable-randomization off</code>, then a PIE executable (Position Indepdent) will load at a randomized address even when you <code>run</code> it from inside GDB.</p>\n\n<p>See <a href=\"https://stackoverflow.com/q/43367427\">32-bit absolute addresses no longer allowed in x86-64 Linux?</a> for more about PIE.</p>\n\n<p>Position-<em>dependent</em> executables are <em>always</em> loaded at the same address, and only their stack address can be randomized.  The code+data can hard-code addresses as 32-bit absolute, and they don't contain relocation info for every place where that was done.  (e.g. like <code>mov $string, %edi</code> ; <code>call puts</code>).</p>\n\n<p>Look at gcc's code-gen for Hello World with/without <code>-fPIE</code> <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdio.h%3E%0D%0Aint+main()%7B%0D%0A++++printf(%22Hello+World!!%5Cn%22)%3B%0D%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:38.86283704572098,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3+-std%3Dgnu11+-Wall+-fPIE&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:47.67631078175198,l:&#39;4&#39;,m:33.74870197300104,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g73,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3+-std%3Dgnu11+-Wall&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+7.3+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),l:&#39;4&#39;,m:66.25129802699897,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:61.13716295427902,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on the Godbolt compiler explorer</a>.</p>\n\n<pre><code>.LC0:\n    .string \"Hello World!\"\nmain:\n    lea     rdi, .LC0[rip]     # RIP-relative with -fPIE\n    sub     rsp, 8\n    call    puts@PLT\n    xor     eax, eax\n    add     rsp, 8\n    ret\n</code></pre>\n\n<p>but with <code>-fno-PIE</code> (the default on Godbolt, often not the default on modern Linux distros), you get <code>mov     edi, OFFSET FLAT:.LC0</code>, a 32-bit absolute address.</p>\n\n<p>(The rest of the code is the same, except it emits <code>call puts</code> and lets the linker convert that to <code>call puts@PLT</code>.  Use <code>-fno-plt</code> to inline an indirect <code>call</code> through the GOT address.)</p>\n"}], "owner": {"reputation": 190, "user_id": 6292128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86d69b38297441ffb0669edb14c1777?s=128&d=identicon&r=PG&f=1", "display_name": "Julien S&#233;veno-Piltant", "link": "https://stackoverflow.com/users/6292128/julien-s%c3%a9veno-piltant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 1, "accepted_answer_id": 50594707, "answer_count": 1, "score": 0, "last_activity_date": 1527639513, "creation_date": 1527637219, "question_id": 50594438, "link": "https://stackoverflow.com/questions/50594438/why-addresses-of-instructions-from-gdb-and-objdump-are-the-same", "title": "Why addresses of instructions from GDB and Objdump are the same?", "body": "<p>I am diving into Reverse Engineering, which is really fun.</p>\n\n<p>I have a question however: why the addresses of instructions I get from <strong>GDB</strong> and <strong>Objdump</strong> are the same?</p>\n\n<p><strong>Shouldn't the binary be loaded at a different address every time?</strong></p>\n\n<p>Thank you.\nJulien</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1527666064, "post_id": 50594221, "comment_id": 88207082, "body": "TCHAR is no benefit to you because you aren&#39;t supporting Windows 98. So use wchar_t and stick exclusively to the native Unicode API."}], "answers": [{"comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 1, "creation_date": 1527635944, "post_id": 50594254, "comment_id": 88197719, "body": "Often you can add &quot;A&quot; to the end of a function name to pick the ASCII version but according to MSDN this is one of the win32 functions that only has a unicode version -- &quot;<i>Out</i> PWSTR  *ppszPath&quot; so it&#39;s not an alias for SHGetKnownFolderPathW, that does not exist."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1527636054, "post_id": 50594254, "comment_id": 88197745, "body": "@DaveS Ah, yes, good point, I was thinking of the older special folder functions. Using the &quot;A&quot; version is not a good idea, it cannot handle all Unicode paths."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 0, "creation_date": 1527636882, "post_id": 50594254, "comment_id": 88197946, "body": "I believe <code>printf(&quot;%S\\n&quot;, path);</code> is also an option?"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1527638132, "post_id": 50594254, "comment_id": 88198227, "body": "<code>tchar</code> is intended for situations where the result will be <code>char</code> when <code>UNICODE</code> is not defined, and <code>wchar_t</code> when it is defined. That&#39;s not the case here, so <code>tchar</code> doesn&#39;t fit at all."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "edited": false, "score": 1, "creation_date": 1527640926, "post_id": 50594254, "comment_id": 88198837, "body": "@zzxyz %S is the same as %ls in this case"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 0, "creation_date": 1527641011, "post_id": 50594254, "comment_id": 88198862, "body": "@JerryCoffin UNICODE is defined because SHGetKnownFolderPath takes a wide string pointer. TCHAR must map to WCHAR for the OPs posted code to compile."}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "edited": false, "score": 2, "creation_date": 1527643709, "post_id": 50594254, "comment_id": 88199425, "body": "@Anders: That&#39;s my point: the whole point of TCHAR is to map to either char or wchar_t. In this case, you can&#39;t do that, so it shouldn&#39;t be using TCHAR at all. It should use wchar_t (or WCHAR) since it must always use wide characters to work."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 0, "last_activity_date": 1527636087, "last_edit_date": 1527636087, "creation_date": 1527635628, "answer_id": 50594254, "question_id": 50594221, "link": "https://stackoverflow.com/questions/50594221/getting-path-to-the-desktop-for-current-user-in-c-using-winapi/50594254#50594254", "title": "Getting path to the desktop for current user in C using WinAPI", "body": "<p>It prints a single character because you tried to print a wide string as a narrow string. You probably have UNICODE/_UNICODE defined so TCHAR is WCHAR.</p>\n\n<p>If you insist on using TCHAR you should use the correct printing function from tchar.h:</p>\n\n<pre><code>_tprintf(_T(\"%s\\n\"), path);\n</code></pre>\n\n<p>Otherwise you can use the wide version:</p>\n\n<pre><code>wprintf(L\"%s\\n\", path);\n</code></pre>\n\n<p>Or the worst solution, convert the string to a narrow codepage string:</p>\n\n<pre><code>printf(\"%ls\\n\", path); // This might not display all Unicode characters correctly\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 3, "last_activity_date": 1527649405, "creation_date": 1527649405, "answer_id": 50595783, "question_id": 50594221, "link": "https://stackoverflow.com/questions/50594221/getting-path-to-the-desktop-for-current-user-in-c-using-winapi/50595783#50595783", "title": "Getting path to the desktop for current user in C using WinAPI", "body": "<p><code>SHGetKnownFolderPath()</code> outputs a <code>wchar_t*</code> pointer, not a <code>TCHAR*</code> pointer. There is no ANSI version of <code>SHGetKnownFolderPath()</code>, so you should not be using <code>TCHAR</code> at all in this situation. In fact, your code will not compile unless <code>UNICODE</code> is defined so <code>TCHAR</code> maps to <code>wchar_t</code>.</p>\n\n<p>The reason you only see the 1st character is because you are passing a <code>wchar_t*</code> where a <code>char*</code> is expected.  On Windows, <code>wchar_t</code> is 16-bit, and so <code>wchar_t*</code> strings are encoded in UCS-2 or UTF-16LE.  All ASCII characters in UCS-2/UTF-16LE have their high 8 bits set to 0.  Your use of <code>printf()</code> is expecting a null terminated <code>char*</code> string, so the high 0x00 byte of the 1st <code>wchar_t</code> character gets misinterpreted as a null terminator.</p>\n\n<p>To do what you want, you need to print out the returned path as-is as a wide string, not as a (misinterpreted) narrow string.</p>\n\n<p>You could use <code>%S</code> with <code>printf()</code>, eg:</p>\n\n<pre><code>PWSTR path;\nif (SHGetKnownFolderPath(&amp;FOLDERID_Desktop, 0, NULL, &amp;path) == S_OK)\n{\n    printf(\"%S\\n\", path);\n    CoTaskMemFree(path);\n}\n</code></pre>\n\n<p>But this is not portable across compilers. You should use <code>%s</code> with <code>wprintf()</code> instead:</p>\n\n<pre><code>PWSTR path;\nif (SHGetKnownFolderPath(&amp;FOLDERID_Desktop, 0, NULL, &amp;path) == S_OK)\n{\n    wprintf(L\"%s\\n\", path);\n    CoTaskMemFree(path);\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9173202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74b8cbbc89a8e78230134b4a32d00414?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/9173202/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 50594254, "answer_count": 2, "score": 0, "last_activity_date": 1527649405, "creation_date": 1527635316, "question_id": 50594221, "link": "https://stackoverflow.com/questions/50594221/getting-path-to-the-desktop-for-current-user-in-c-using-winapi", "title": "Getting path to the desktop for current user in C using WinAPI", "body": "<p>I'm very new to WinAPI programming. I was wondering how I could get the path of the user's Desktop and then print out the full path to the console. This is my current code:</p>\n\n<pre><code>TCHAR* path = 0;\nHRESULT result = SHGetKnownFolderPath(&amp;FOLDERID_Desktop, 0, NULL, &amp;path);\nif (result == S_OK)\n{\n    printf(\"%s\\n\", path);\n}\nCoTaskMemFree(path)\n</code></pre>\n\n<p>It does find the path, but it prints out \"C\" for the path rather than the entire path with slashes. What am I missing?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 2, "creation_date": 1527633129, "post_id": 50593901, "comment_id": 88196949, "body": "What do you mean by &quot;full name&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2100815"}, "edited": false, "score": 0, "creation_date": 1527633228, "post_id": 50593901, "comment_id": 88196979, "body": "What is the full name of <code>x</code> in a statement like <code>int x = 0;</code>?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527652778, "post_id": 50593901, "comment_id": 88201467, "body": "<a href=\"https://stackoverflow.com/questions/27949512/what-does-f-stand-for-in-c-standard-library-function-names\" title=\"what does f stand for in c standard library function names\">stackoverflow.com/questions/27949512/&hellip;</a>"}, {"owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527692267, "post_id": 50593901, "comment_id": 88225403, "body": "@M.M this question was reopened after the English was cleaned up enough to make the question comprehensible."}], "answers": [{"tags": [], "owner": {"reputation": 49854, "user_id": 16287, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Ogq0T.png?s=128&g=1", "display_name": "Drew Dormann", "link": "https://stackoverflow.com/users/16287/drew-dormann"}, "is_accepted": false, "score": 8, "last_activity_date": 1527633755, "creation_date": 1527633755, "answer_id": 50594005, "question_id": 50593901, "link": "https://stackoverflow.com/questions/50593901/what-does-the-letter-f-stand-for-in-printf-scanf-and-g-in-seekg/50594005#50594005", "title": "What does the letter \u2018f\u2019 stand for in printf(), scanf() and \u2018g\u2019 in seekg()", "body": "<p><code>printf</code> is an abbreviation for \"print formatted\"</p>\n\n<p><code>scanf</code> is an abbreviation for \"scan formatted\"</p>\n\n<p><code>seekg</code> is an abbreviation for \"seek the <em>get</em> (read) <em>pointer</em>\"... as opposed to <code>seekp</code>, which manages the <em>put</em> (write) <em>pointer</em>.</p>\n"}], "owner": {"reputation": 67, "user_id": 8389169, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LQgtx_qVRwE/AAAAAAAAAAI/AAAAAAAABao/Z6WHpRF-u_k/photo.jpg?sz=128", "display_name": "Semalion K", "link": "https://stackoverflow.com/users/8389169/semalion-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1527647554, "creation_date": 1527633084, "last_edit_date": 1527642908, "question_id": 50593901, "link": "https://stackoverflow.com/questions/50593901/what-does-the-letter-f-stand-for-in-printf-scanf-and-g-in-seekg", "title": "What does the letter \u2018f\u2019 stand for in printf(), scanf() and \u2018g\u2019 in seekg()", "body": "<p>I can't find the full name (expanded meaningful name) of the functions <code>printf()</code>, <code>scanf()</code>, <code>seekg()</code>.</p>\n\n<p>These guys seem to be like below \u25bc</p>\n\n<p>printf</p>\n\n<ul>\n<li>print format</li>\n<li>print format string</li>\n<li>print function</li>\n</ul>\n\n<p>scanf</p>\n\n<ul>\n<li>scan format</li>\n<li>scan format string</li>\n<li>scan function</li>\n</ul>\n\n<p>seekg</p>\n\n<ul>\n<li>seekGlobalFileStreamCursor (What the..?)</li>\n</ul>\n\n<p>Can you say where the names come from, or what they mean?</p>\n"}, {"tags": ["c", "pointers", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 0, "creation_date": 1527631952, "post_id": 50593652, "comment_id": 88196641, "body": "It just doesn&#39;t print leading zeros."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1527632659, "post_id": 50593652, "comment_id": 88196836, "body": "All values smaller than <code>int</code> are promoted and passed to <code>printf</code> (or any other variadic function) as <code>int</code>. This is why it works. Try it with larger types and you will run into problems."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1527637838, "post_id": 50593743, "comment_id": 88198167, "body": "<code>uint8_t</code> is default promoted to <code>int</code>, not <code>unsigned int</code>, because promotion is value preserving and the range of <code>uint8_t</code> always fits into <code>int</code> without needing to go to <code>unsigned int</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1527652881, "post_id": 50593743, "comment_id": 88201496, "body": "@JonathanLeffler ...making it technically undefined behaviour , since <code>unsigned int</code> is expected but <code>int</code> received, although we usually don&#39;t worry about that"}], "tags": [], "owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "is_accepted": true, "score": 8, "last_activity_date": 1527705305, "last_edit_date": 1527705305, "creation_date": 1527632003, "answer_id": 50593743, "question_id": 50593652, "link": "https://stackoverflow.com/questions/50593652/how-c-printf-function-knows-the-integer-size-passed/50593743#50593743", "title": "How C printf function knows the integer size passed?", "body": "<p>It doesn't know.  In both cases you're giving <code>printf</code> an <code>[unsigned] int</code>, due to the <em>default argument promotions</em>.  Your code is equivalent to this:<sup>1</sup></p>\n\n<pre><code>printf(\"uint32_t 0x%x\\n\", (unsigned int)(uint32_t) X);\nprintf(\"uint8_t  0x%x\\n\", (int)(uint8_t) X);\n</code></pre>\n\n<p>The promotion rule is:</p>\n\n<blockquote>\n  <p><strong>[6.3.1.1]</strong> If an <code>int</code> can represent all values of the original type [...], the value is converted to an <code>int</code>; otherwise, it is converted to an <code>unsigned int</code>.</p>\n</blockquote>\n\n<p>The only rule that <code>printf</code> follows at this point is to not print leading zeros.</p>\n\n<p>Note that mapping a signed <code>int</code> to <code>%x</code> is technically undefined behaviour.</p>\n\n<p><hr>\n<sup>1. I'm assuming you have 32-bit <code>int</code>s here.</sup></p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1527684032, "creation_date": 1527684032, "answer_id": 50604956, "question_id": 50593652, "link": "https://stackoverflow.com/questions/50593652/how-c-printf-function-knows-the-integer-size-passed/50604956#50604956", "title": "How C printf function knows the integer size passed?", "body": "<p>In </p>\n\n<pre><code>printf(\"uint8_t  0x%x\\n\", (uint8_t) X);\n</code></pre>\n\n<p><code>uint8_t</code> is definitely a lower-ranking type than <code>int</code>, and so <code>uint8_t</code> will be promoted to <code>int</code> and <code>\"%x\"</code> will work.</p>\n\n<pre><code>//potentially invokes UB depending on platform\nprintf(\"uint32_t  0x%x\\n\", (uint32_t) X); \n</code></pre>\n\n<p>is nonportable code. In theory, you don't know what real type <code>uint32_t</code> is and so you should be using the <code>PRIx32</code> macro from <code>inttypes.h</code>. For consistency/simplicity's sake, you can use <code>PRIx8</code> for <code>uint8_t</code> too.</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdio.h&gt;\nint main()\n{\n    uint32_t X = 0xAABBCCDD;\n    printf(\"uint8_t  0x%\" PRIx8 \"\\n\", (uint8_t) X);\n    printf(\"uint32_t 0x%\" PRIx32 \"\\n\", (uint32_t) X);\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9791115, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mohammad Nabil", "link": "https://stackoverflow.com/users/9791115/mohammad-nabil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 1, "accepted_answer_id": 50593743, "answer_count": 2, "score": 2, "last_activity_date": 1527705305, "creation_date": 1527631563, "question_id": 50593652, "link": "https://stackoverflow.com/questions/50593652/how-c-printf-function-knows-the-integer-size-passed", "title": "How C printf function knows the integer size passed?", "body": "<p>In the following sample code, how did printf knew the size that shall be printed for uint8_t while the mentioned format is only \"0x%x\" and passd type is uint32_t? how did printf know that in first call it must print 4 bytes and the second call it must only print 1 byte?</p>\n\n<pre><code>uint32_t X = 0xAABBCCDD;\nprintf(\"uint32_t 0x%x\\n\", (uint32_t) X);\nprintf(\"uint8_t  0x%x\\n\", (uint8_t) X);\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>uint32_t 0xaabbccdd\nuint8_t  0xdd\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527651595, "post_id": 50593647, "comment_id": 88201149, "body": "&quot;I came across another question&quot;  - the accepted answer to that question is correct (and there are no &quot;warnings&quot;), however that question does not involve <code>const</code> in any way so it is not clear why you have linked it"}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527653433, "post_id": 50593647, "comment_id": 88201623, "body": "The op was trying to put literal constant strings inside a non-const array. GCC normally warns. And in my case due to <code>-Werror</code>, it fails with errors instead."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527653483, "post_id": 50593647, "comment_id": 88201637, "body": "String literals are not <code>const</code> in C.  The code was correct. You see warnings because you use the switch <code>-Wwrite-strings</code> which intentionally produces warnings for correct code."}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527653893, "post_id": 50593647, "comment_id": 88201753, "body": "I thought string literals are stored in read-only section irrespective of warning switches, unless <code>-fwritable-strings</code> is also used. But you&#39;re right, the standard doesn&#39;t specify such a behaviour though. Corrected my question&#39;s wording. Thanks."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527654317, "post_id": 50593647, "comment_id": 88201841, "body": "They could be stored in read-only area, but either way there is no <code>const</code> qualifier.  It is just undefined behaviour with no diagnostic to write them, in Standard C. The <code>-Wwrite-strings</code> attempts to catch write attempts, but also gives false positives when you need to call an API that isn&#39;t const-correct"}], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1527633028, "post_id": 50593868, "comment_id": 88196929, "body": "Changing it like your suggestion doesn&#39;t match with posix_spawn() function signature. See <a href=\"http://pubs.opengroup.org/onlinepubs/009696899/functions/posix_spawn.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009696899/functions/&hellip;</a>. Does this mean, I have to <code>strdup()</code> every string inside <code>argv</code>?"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1527634142, "post_id": 50593868, "comment_id": 88197243, "body": "No, if you create arrays of pointers to non-<code>const</code> <code>char</code>s (for example, remove the <code>const</code> from <code>exe</code>), it should work. But I am somewhat surprised; I would not expect <code>posix_spawn</code> to want to actually change the values passed in so I don&#39;t know why it wants them mutable. I&#39;m not certain, but I also think as long as it doesn&#39;t <i>actually</i> change anything it is perfectly defined to cast away the <code>const</code>ness of the pointers."}, {"owner": {"reputation": 1101, "user_id": 3936601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b55dba01070e7c3a4ee30b401d084d8?s=128&d=identicon&r=PG", "display_name": "Evan Benn", "link": "https://stackoverflow.com/users/3936601/evan-benn"}, "edited": false, "score": 2, "creation_date": 1527637076, "post_id": 50593868, "comment_id": 88197993, "body": "once the pointers get deep, const becomes very tricky and hard to understand: <a href=\"https://stackoverflow.com/questions/5055655/double-pointer-const-correctness-warnings-in-c\" title=\"double pointer const correctness warnings in c\">stackoverflow.com/questions/5055655/&hellip;</a>"}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 1101, "user_id": 3936601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b55dba01070e7c3a4ee30b401d084d8?s=128&d=identicon&r=PG", "display_name": "Evan Benn", "link": "https://stackoverflow.com/users/3936601/evan-benn"}, "edited": false, "score": 0, "creation_date": 1527638598, "post_id": 50593868, "comment_id": 88198332, "body": "@EvanBenn Yeah, definitely. I suppose that could change details of why the API is designed with non-<code>const</code> <code>char</code>s, but I don&#39;t think it changes my answer."}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "reply_to_user": {"reputation": 1101, "user_id": 3936601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b55dba01070e7c3a4ee30b401d084d8?s=128&d=identicon&r=PG", "display_name": "Evan Benn", "link": "https://stackoverflow.com/users/3936601/evan-benn"}, "edited": false, "score": 0, "creation_date": 1527644853, "post_id": 50593868, "comment_id": 88199638, "body": "@EvanBenn Makes sense. But how do I avoid this specific case here? Use <code>pragama</code>?"}, {"owner": {"reputation": 1101, "user_id": 3936601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3b55dba01070e7c3a4ee30b401d084d8?s=128&d=identicon&r=PG", "display_name": "Evan Benn", "link": "https://stackoverflow.com/users/3936601/evan-benn"}, "reply_to_user": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1527665551, "post_id": 50593868, "comment_id": 88206754, "body": "@UnmannedPlayer Daniel H&#39;s answer is good, you could be strdup&#39;ing or similar, IF you want to heed the -Wwrite-strings warning. Presumably posix_spawn will not modify the strings, so it is reasonably safe to &#39;discard the const qualifier&#39;. The common librarys are full of such things eg char* index(const char* input...). Const correctness is a battle that cannot be won in C."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527733964, "post_id": 50593868, "comment_id": 88241515, "body": "It is not required to copy the actual content of the strings ;  you can safely cast <code>const char *</code> to <code>char *</code> and then read the const strings through that pointer."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1527735177, "post_id": 50593868, "comment_id": 88241813, "body": "@M.M Yep, and I do say that. On some level I don&#39;t like that solution because my instincts were formed in C++ where the safe conversions are actually possible and people design APIs accordingly (or those who don&#39;t shouldn&#39;t be trusted to not actually modify the strings), but it&#39;s probably what I&#39;d go with too."}], "tags": [], "owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1527634613, "last_edit_date": 1527634613, "creation_date": 1527632868, "answer_id": 50593868, "question_id": 50593647, "link": "https://stackoverflow.com/questions/50593647/how-to-correctly-declare-a-const-string-array/50593868#50593868", "title": "How to correctly declare a const string array?", "body": "<p>The declaration <code>char *const argv[]</code> makes <code>argv</code> an array of constant pointers to <em>mutable</em> <code>char</code>s. Once you create the array, you cannot change where the pointers point (you can't say <code>argv[0] = \"/bin/some_other_program\"</code>), but you can change the characters themselves (so <code>argv[1][1] = 'b'</code>, to make it so you pass <code>-b</code> instead).</p>\n\n<p>However, the pointers you are assigning as elements of <code>argv</code> are pointers to constant <code>char</code>s. It's undefined behavior to actually do any of those assignments even if the type of <code>argv</code> will let you, hence the warning. Since you can't change the type of the function, you need to get rid of the <code>const</code>ness somehow. Options are to use <code>strdup</code>, to put the strings into <code>char[]</code> variables (which implicitly also copies them), or to cast away the <code>const</code> at this level (which is UB if the program actually modifies the values but should be safe if it does not). <a href=\"https://godbolt.org/g/CgcETw\" rel=\"nofollow noreferrer\">Here</a> are examples using the latter two methods.</p>\n"}, {"comments": [{"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1527653600, "post_id": 50596082, "comment_id": 88201679, "body": "I can&#39;t modify the signature of <code>posix_spawn</code> so it accepts <code>const char *const []</code>, no? Also, your answer works for this instance though. I have changed my code to wrap <code>posix_spawn</code> so it works like how you&#39;ve shown in the answer."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1527733866, "last_edit_date": 1527733866, "creation_date": 1527651989, "answer_id": 50596082, "question_id": 50593647, "link": "https://stackoverflow.com/questions/50593647/how-to-correctly-declare-a-const-string-array/50596082#50596082", "title": "How to correctly declare a const string array?", "body": "<p>The function in question, <code>posix_spawn</code>, expects a pointer to (the first element of) an array of pointer to non-const <code>char</code>. Despite this, the function does not modify the character strings.  </p>\n\n<p>For historical reasons this situation of poor const-correctness in C APIs is not uncommon. </p>\n\n<p>You can pass string literals to it without any warning in Standard C, because string literals have type: array of non-const char.  (Modifying them is undefined behaviour with no diagnostic required).</p>\n\n<p>If you use the <code>-Wwrite-strings</code> flag to try and get warnings about potential UB then it will give you these false positives for the cases where you interact with a non-const-correct API.</p>\n\n<hr>\n\n<p>The intended way to consume the API in C89 would be to use:</p>\n\n<pre><code>char exe[] = \"/usr/bin/some/exe\";\n\nchar * argv[] = {\n    NULL,\n    \"-a\",\n    \"-b\",\n    NULL\n};\n\nargv[0] = exe;\nshow(argv);\n</code></pre>\n\n<p>Note that in C89 it is not possible to have your array be <code>const</code> and also be initialized with the local variable <code>exe</code>. This is because C89 requires all initializers in a braced list to be <em>constant expressions</em>, the definition of which excludes the address of a local variable.</p>\n\n<p>If you want to use <code>-Wwrite-strings</code> then you could suppress the warning by using <code>(char *)\"-a\"</code> instead of <code>\"-a\"</code> and so on.</p>\n\n<hr>\n\n<p>It was suggested in comments to use <code>const char *</code> for the string type and then use a cast, like so:</p>\n\n<pre><code>const char exe[] = \"/usr/bin/some/exe\";\n\nconst char * argv[] = {\n    NULL,\n    \"-a\",\n    \"-b\",\n    NULL\n};\nargv[0] = exe;\nshow((char **)argv);\n</code></pre>\n\n<p>However this probably violates the <em>strict aliasing rule</em>.  Even though the rule allows a <code>const T</code> to be aliased as a <code>T</code>, this rule does not \"recurse\" ; it is probably not allowed to alias <code>const char *</code> as <code>char *</code> , although the rule's wording is not 100% clear.  <a href=\"https://stackoverflow.com/questions/45124063/is-it-okay-for-int-and-const-int-to-alias\">See this question for further discussion</a>.</p>\n\n<p>If you wanted to offer a wrapper that accepts <code>const char **</code> and calls <code>posix_spawn</code> , and not violate the C Standard, then you would actually have to make a copy of the pointer list into an array of <code>char *</code>.  (But you do not have to actually copy the string content)</p>\n"}], "owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 50596082, "answer_count": 2, "score": 1, "last_activity_date": 1527733866, "creation_date": 1527631542, "last_edit_date": 1527653972, "question_id": 50593647, "link": "https://stackoverflow.com/questions/50593647/how-to-correctly-declare-a-const-string-array", "title": "How to correctly declare a const string array?", "body": "<p>This is a silly question, but I can't seem to get it right. I came across another <a href=\"https://stackoverflow.com/questions/29205864/how-to-declare-a-constant-2d-string-array-in-c\">question</a>, but the answer given doesn't properly address the warnings in my specific use case.</p>\n\n<p>I'm trying to declare an array of constant strings to pass as <code>argv</code> in <a href=\"http://pubs.opengroup.org/onlinepubs/009696899/functions/posix_spawn.html\" rel=\"nofollow noreferrer\"><code>posix_spawn</code></a> function, but GCC complains about <code>const</code> being discarded. See a sample code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/* Similar signature as posix_spawn() shown for brevity. */\nstatic void show(char *const argv[])\n{\n    unsigned i = 0;\n\n    while(argv[i] != NULL) {\n        printf(\"%s\\n\", argv[i++]);\n    }\n}\n\nint main(void)\n{\n    const char exe[] = \"/usr/bin/some/exe\";\n\n    char *const argv[] = {\n        exe,\n        \"-a\",\n        \"-b\",\n        NULL\n    };\n\n    show(argv);\n\n    return 0;\n}\n</code></pre>\n\n<p>And compile it as:</p>\n\n<pre><code>gcc -std=c89 -Wall -Wextra -Wpedantic -Wwrite-strings test.c -o test \ntest.c: In function \u2018main\u2019:\ntest.c:17:9: warning: initializer element is not computable at load time [-Wpedantic]\n         exe,\n         ^\ntest.c:17:9: warning: initialization discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\ntest.c:18:9: warning: initialization discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\n         \"-a\",\n         ^\ntest.c:19:9: warning: initialization discards \u2018const\u2019 qualifier from pointer target type [-Wdiscarded-qualifiers]\n         \"-b\",\n         ^\n</code></pre>\n\n<p>Since, <code>exe</code> is itself a constant string like <code>\"-a\"</code> and <code>\"-b\"</code>, I thought it's correct. But GCC seems to disagree. Removing <code>exe</code> from the array and removing <code>-Wwrite-strings</code> compiles without warnings. Maybe I am missing something too basic.</p>\n\n<p>How does one declare a const array of strings?</p>\n"}, {"tags": ["c", "macros", "c-preprocessor", "evaluation"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527632004, "post_id": 50593593, "comment_id": 88196656, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5459868/concatenate-int-to-string-using-c-preprocessor\">Concatenate int to string using C Preprocessor</a>"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527632858, "post_id": 50593593, "comment_id": 88196884, "body": "@0andriy - I don&#39;t think it is the same case - in my question, the value is assigned to a macro name which is itself the result of the concatenation of two parts. In your suggestion, each name evaluates to a separate value, and the two are then concatenated."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1527632938, "post_id": 50593593, "comment_id": 88196903, "body": "Two answers below are exactly what that Q is about. So, it&#39;s <b>exact</b> duplication."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527634322, "post_id": 50593593, "comment_id": 88197286, "body": "@0andriy - again, I don&#39;t think so. It is possible that the answers here solve the other problem as well, but the question itself, as much as my understanding of the other problem is, is different. I could be wrong, though."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527634488, "post_id": 50593593, "comment_id": 88197342, "body": "I barely see the difference in the expected output and what any of proposed answers here. And answers here are repeating what is duplicated in the link I had provided."}], "answers": [{"tags": [], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "is_accepted": false, "score": 2, "last_activity_date": 1527632610, "creation_date": 1527632610, "answer_id": 50593836, "question_id": 50593593, "link": "https://stackoverflow.com/questions/50593593/how-to-concatenate-evaluate-and-stringify-macros/50593836#50593836", "title": "How to concatenate, evaluate and stringify macros?", "body": "<p>You need to defer stringification by introducing a layer of indirection:</p>\n\n<pre><code>#define STRINGIFY_X(x) #x\n#define STRINGIFY(x) STRINGIFY_X(x)\n#define MAKE_MAC(mac) STRINGIFY(mac ## _ONE) STRINGIFY(mac ## _TWO)\n</code></pre>\n\n<p><a href=\"https://wandbox.org/permlink/NVVItKDzbMBuKx93\" rel=\"nofollow noreferrer\"><strong>live example on wandbox.org</strong></a></p>\n"}, {"comments": [{"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1527635876, "post_id": 50593837, "comment_id": 88197693, "body": "Thanks. Needed a few adjustments to my particular case, but this sent my in the right direction."}], "tags": [], "owner": {"reputation": 483, "user_id": 7452238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5339f527b561933b4e1eceaf7e42d9?s=128&d=identicon&r=PG&f=1", "display_name": "bobra", "link": "https://stackoverflow.com/users/7452238/bobra"}, "is_accepted": true, "score": 3, "last_activity_date": 1527638199, "last_edit_date": 1527638199, "creation_date": 1527632615, "answer_id": 50593837, "question_id": 50593593, "link": "https://stackoverflow.com/questions/50593593/how-to-concatenate-evaluate-and-stringify-macros/50593837#50593837", "title": "How to concatenate, evaluate and stringify macros?", "body": "<p>Try this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define FOO_ONE 12\n#define FOO_TWO 34\n#define BAR_ONE 56\n#define BAR_TWO 78\n\n#define STRINGIFY(arg) #arg\n#define CONCAT(arg1, arg2) STRINGIFY(arg1) STRINGIFY(arg2)\n\n#define MAC(arg) CONCAT(arg##_ONE, arg##_TWO)\n\nint main(){\n\n    printf(\"FOO: \" MAC(FOO) \"\\n\");\n    printf(\"BAR: \" MAC(BAR) \"\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>My output:</p>\n\n<pre><code>FOO: 1234\nBAR: 5678\n</code></pre>\n"}], "owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 50593837, "answer_count": 2, "score": 1, "last_activity_date": 1527638199, "creation_date": 1527631233, "last_edit_date": 1527632279, "question_id": 50593593, "link": "https://stackoverflow.com/questions/50593593/how-to-concatenate-evaluate-and-stringify-macros", "title": "How to concatenate, evaluate and stringify macros?", "body": "<p>I am trying to stringify the substitution (evaluation) of a macro concatenation. For example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\n#define FOO_ONE 12\n#define FOO_TWO 34\n#define BAR_ONE 56\n#define BAR_TWO 78\n\n#define MAKE_MAC(mac) // ... what to do here?\n\nvoid main(int argc, char *argv[])\n{\n    printf(\"FOO: \" MAKE_MAC(FOO) \"\\n\");\n    printf(\"BAR: \" MAKE_MAC(BAR) \"\\n\");\n}\n</code></pre>\n\n<p>The result I am seeking is:</p>\n\n<pre><code>FOO: 1234\nBAR: 5678\n</code></pre>\n\n<p>I tried a few forms, I think the best attempt is this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define STRINGIFY(mac) #mac\n#define CONCAT(mac1, mac2) STRINGIFY(mac1 ## mac2)\n#define MAKE_MAC(mac) CONCAT(mac, _ONE) CONCAT(mac, _TWO)\n</code></pre>\n\n<p>But, it only gets me this far:</p>\n\n<pre><code>FOO: FOO_ONEFOO_TWO\nBAR: BAR_ONEBAR_TWO\n</code></pre>\n\n<p>So, how can I add the extra step of evaluation of the resulting concatenated macro, before it gets stringified?</p>\n"}, {"tags": ["c", "multithreading", "parallel-processing", "pthreads"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1527631435, "post_id": 50593561, "comment_id": 88196475, "body": "Either your instructor needs to clarify WTH they&#39;re talking about, or you need to find another instructor. That <code>doneArray[j] == 1</code> madness is a bag of hammers all on it&#39;s own, as it has no concurrency protection (that we can see), and will predictably invoke <code>pthread_join</code> on already-joined threads in the latter loops of <code>i</code>. Either way, you&#39;re correct to question the sanity of their mandate."}, {"owner": {"reputation": 53, "user_id": 9404150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db431d01468d7362635671373d669f1?s=128&d=identicon&r=PG&f=1", "display_name": "S Jiles", "link": "https://stackoverflow.com/users/9404150/s-jiles"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527632336, "post_id": 50593561, "comment_id": 88196756, "body": "the only concurrency protection that I have is that the contents of doneArray are set to 1 within a mutex lock, but that does little to advance the argument as all your other points are valid points"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1527633790, "post_id": 50593561, "comment_id": 88197140, "body": "Even if you set it under the protection of a mutex, you don&#39;t <i>check</i> it <i>here</i> under the protection of the same mutex. That was the ultimate reason I brought it up in the first place. Regardless, the sanity of any of this is questionable, as you&#39;ve noticed. You gain little to proactively join prior, expiring threads in the same loop as starting new ones. Such a montage <i>begs</i> for a better solution (perhaps a work queue or crew model). There must be some reason <i>why</i> the instructor wants this. Does no one in the class have sufficient brass to <i>ask</i> ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1527637432, "post_id": 50593561, "comment_id": 88198072, "body": "Assuming there are no other threads in the process, the code you posted is exactly equivalent to <code>for(long i = 0; i &lt; numberOfThreads; i++) { body( ( void * ) i ); }</code>   Either you&#39;re not understanding your instructor&#39;s direction, or your instructor is utterly clueless.  Because you&#39;re right - there is absolutely no point in a single loop that on each loop iteration spawns one child thread and then waits on it to finish"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1527659597, "post_id": 50593561, "comment_id": 88203466, "body": "If the number of threads does not exceed your machine word width, the <code>doneArray</code> could be stored in an atomic. AFAIK, atomics are usually significantly faster than mutex guarded variables. (<a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow noreferrer\">C11 Atomic Library</a>)"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1527660264, "post_id": 50593561, "comment_id": 88203773, "body": "I asked myself if an array of <code>atomic_flag</code>s would work as well. I googled a while without finding any pro or con. Finally, I read a note about a fix: <i>Apart from that, the _Atomic (type-name) syntax is implemented.  The tests for applying _Atomic qualifiers to function or array types are fixed.</i> (concerning gcc) in <a href=\"https://gcc.gnu.org/ml/gcc-patches/2013-10/msg01415.html\" rel=\"nofollow noreferrer\">C11-atomic - Miscellaneous fixes 1/n</a>. So, it seems there&#39;s nothing bad about this that this isn&#39;t even mentioned anywhere (else)."}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1527669498, "post_id": 50593561, "comment_id": 88209199, "body": "Sidenote: In general, casting a long to void* is not a good idea. It may work on 64-bit Unix OS:es since they are LP64, i.e. longs and pointers are both 64 bits long. Windows is for example LLP64, so long is 32 bits on 64-bit Windows. (long long is 64 bits)"}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527684742, "post_id": 50593561, "comment_id": 88219721, "body": "@WhozCraig There is no harm in joining a thread more than one time. The first call will wait if necessary for the thread to die. All subsequent calls will return immediately."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1527685007, "post_id": 50593561, "comment_id": 88219932, "body": "@AndrewHenle, depends what that <code>sleep()</code> call is supposed to represent. Maybe the instructor meant it to be a stand-in for some function that would have done some actual work in some real program.  It <i>can</i> make sense to spawn a thread, <i>do some work</i>, and then join the thread. Of course, if you&#39;re doing that in a loop, in a real program, then you probably should be using a thread <i>pool</i>; but that probably is a topic for a later lesson."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1527685708, "post_id": 50593561, "comment_id": 88220433, "body": "@jameslarge <i>There is no harm in joining a thread more than one time.</i>  There most certainly is if thread ids get reused."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1527686536, "post_id": 50593561, "comment_id": 88221077, "body": "Oh Foo! You&#39;re right.  I misread <a href=\"http://man7.org/linux/man-pages/man3/pthread_join.3.html\" rel=\"nofollow noreferrer\">the documentation</a>.  It says that joining a thread that previously has been joined is UB."}], "owner": {"reputation": 53, "user_id": 9404150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5db431d01468d7362635671373d669f1?s=128&d=identicon&r=PG&f=1", "display_name": "S Jiles", "link": "https://stackoverflow.com/users/9404150/s-jiles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1527631423, "creation_date": 1527631057, "last_edit_date": 1527631423, "question_id": 50593561, "link": "https://stackoverflow.com/questions/50593561/create-join-pthread-in-same-loop", "title": "create/join pthread in same loop", "body": "<p>I have an array called doneArray that I store 1's in when a thread is finished. For example, in thread 4 right before I call <code>pthread_exit</code>, I set doneArray[4] to 1. So I can run through doneArray to see if a given thread has finished.</p>\n\n<p>In this loop in my <code>main()</code> code, I create a thread, then check if any threads have finished. If they do, I join them. The resulting behavior is crazy at times and doesn't work the same as if I had a separate join loop.</p>\n\n<pre><code>   for(long i = 0; i &lt; numberOfThreads; i++){\n\n      pthread_create(&amp;threads[i], NULL, body, (void*) i);\n\n      sleep(random() % 5 + 1);\n\n      //the loop that creates new threads should join threads that have finished\n      for(int j = 0; j &lt; numberOfThreads; j++){\n         if(doneArray[j] == 1){\n            pthread_join(threads[j], &amp;retval);\n         }\n      }\n\n   }\n</code></pre>\n\n<p>My instructor has told us to do the <code>pthread_create</code> and <code>pthread_join</code> in the same loop or we will lose points. I'm very confused, because I have previously been taught NOT to do this, and other answers I've seen on this website have been also saying to do the join in a separate loop:</p>\n\n<p><code>If we put the pthread_join() in the same loop with pthread_create(), the calling thread i.e. main() will wait for the thread 0 to finish its work before creating the thread 1. This would force the threads to execute sequentially, not in parallel. Thus it would kill the purpose of multi-threading.</code></p>\n"}, {"tags": ["c", "environment-variables"], "comments": [{"owner": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 0, "creation_date": 1527630977, "post_id": 50593506, "comment_id": 88196359, "body": "Are you sure it&#39;s exported? Try <code>EXAMPLE=test my_command</code>"}, {"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 1, "creation_date": 1527630979, "post_id": 50593506, "comment_id": 88196360, "body": "Are you running it under the same shell as <code>printenv</code>?"}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1527631085, "post_id": 50593506, "comment_id": 88196378, "body": "&quot;<i>unless I call  getenv(&quot;PATH&quot;)</i>&quot; are you saying <code>getenv</code> returns non-null for <code>&quot;PATH&quot;</code> or that after you call <code>getenv(&quot;PATH&quot;)</code> the call to <code>getenv(&quot;EXAMPLE&quot;)</code> works?"}, {"owner": {"reputation": 105, "user_id": 5752473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL3zS.jpg?s=128&g=1", "display_name": "I.Step", "link": "https://stackoverflow.com/users/5752473/i-step"}, "edited": false, "score": 0, "creation_date": 1527631197, "post_id": 50593506, "comment_id": 88196406, "body": "getenv(&quot;PATH&quot;) returns non-null for &quot;PATH&quot;. C program is run in the same terminal."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "reply_to_user": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 0, "creation_date": 1527631273, "post_id": 50593506, "comment_id": 88196426, "body": "what about @jspcal&#39;s suggestion of running<code>$ EXAMPLE=test .&#47;a.out</code> ?"}, {"owner": {"reputation": 105, "user_id": 5752473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL3zS.jpg?s=128&g=1", "display_name": "I.Step", "link": "https://stackoverflow.com/users/5752473/i-step"}, "reply_to_user": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 0, "creation_date": 1527631864, "post_id": 50593506, "comment_id": 88196609, "body": "Thanks @Ryan it worked that way with EXAMPLE=test ./a.out."}, {"owner": {"reputation": 105, "user_id": 5752473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL3zS.jpg?s=128&g=1", "display_name": "I.Step", "link": "https://stackoverflow.com/users/5752473/i-step"}, "reply_to_user": {"reputation": 47115, "user_id": 235354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097d761861529df52a6800744f1074d2?s=128&d=identicon&r=PG", "display_name": "jspcal", "link": "https://stackoverflow.com/users/235354/jspcal"}, "edited": false, "score": 0, "creation_date": 1527631888, "post_id": 50593506, "comment_id": 88196615, "body": "@jspcal Does it mean it is not exported properly?"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1527632247, "post_id": 50593506, "comment_id": 88196727, "body": "No, it means your shell secures environment and calls <code>execve()</code> with predefined set of variables. So, basically what you need is to inherit or access to the parent environment."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527632463, "post_id": 50593506, "comment_id": 88196788, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31034993/how-does-a-program-inherit-environment-variables\">How does a program inherit environment variables?</a> Good to read: <a href=\"https://unix.stackexchange.com/questions/130985/if-processes-inherit-the-parents-environment-why-do-we-need-export\" title=\"if processes inherit the parents environment why do we need export\">unix.stackexchange.com/questions/130985/&hellip;</a> One more thing is to run the program under non-root user or otherwise."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1527636004, "post_id": 50593506, "comment_id": 88197736, "body": "@0andriy Can you explain a little more about this &quot;secure environment&quot; feature?  It sounds like it quietly ignores an <code>export</code>, which sounds counterintuitive..."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1527644157, "post_id": 50593506, "comment_id": 88199500, "body": "@SteveSummit Perhaps I wasn&#39;t clear. Here is more detailed info: <a href=\"https://www.redhat.com/archives/fedora-selinux-list/2009-March/msg00033.html\" rel=\"nofollow noreferrer\">redhat.com/archives/fedora-selinux-list/2009-March/&hellip;</a>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1527645322, "post_id": 50593506, "comment_id": 88199730, "body": "@0andriy: the environment is secured by the kernel, not the shell. And if <code>EXAMPLE=test .&#47;a.out</code> works, then so will <code>export EXAMPLE=test; .&#47;a.out</code>, since there is no difference in the environment seen by the <code>exec</code> call."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1527671136, "post_id": 50593506, "comment_id": 88210283, "body": "The comments about selinux wackiness are almost surely unrelated to OP&#39;s problem."}], "owner": {"reputation": 105, "user_id": 5752473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL3zS.jpg?s=128&g=1", "display_name": "I.Step", "link": "https://stackoverflow.com/users/5752473/i-step"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 938, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527630822, "creation_date": 1527630739, "last_edit_date": 1527630822, "question_id": 50593506, "link": "https://stackoverflow.com/questions/50593506/c-program-getenv-returns-null", "title": "C program getenv() returns null", "body": "<p>After I call <code>export EXAMPLE=\"exampleValue\"</code> in terminal. I call command <code>printenv</code> I can clearly see my new environment variable.</p>\n\n<p>I compile C program and run it and in code I call <code>getenv(\"EXAMPLE\")</code>.\nBut it returns null every time, unless I call \n<code>getenv(\"PATH\")</code> or <code>getenv(\"HOME\")</code> or similar environment variables.</p>\n\n<pre><code>char* env_variable_name;\nenv_variable_name = getenv(\"EXAMPLE\");\n</code></pre>\n\n<p>Any explanation why I can't get value of EXAMPLE?</p>\n"}, {"tags": ["c++", "c", "qt", "gdb", "qt-creator"], "answers": [{"comments": [{"owner": {"reputation": 4236, "user_id": 1601703, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/07824cc1d45c4dbb45044a1c0963b221?s=128&d=identicon&r=PG", "display_name": "vasili111", "link": "https://stackoverflow.com/users/1601703/vasili111"}, "edited": false, "score": 0, "creation_date": 1527872173, "post_id": 50619772, "comment_id": 88306567, "body": "Tested kit cloning and it solves the problem. Also submitted issue ticket in MSYS2 MinGW packages."}], "tags": [], "owner": {"reputation": 470, "user_id": 4310923, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7zaTkfT_4Jo/AAAAAAAAAAI/AAAAAAAAAFg/1nMdwI6kiTg/photo.jpg?sz=128", "display_name": "Tobias Hunger", "link": "https://stackoverflow.com/users/4310923/tobias-hunger"}, "is_accepted": true, "score": 1, "last_activity_date": 1527754813, "creation_date": 1527754813, "answer_id": 50619772, "question_id": 50593191, "link": "https://stackoverflow.com/questions/50593191/how-to-change-debugger-in-qt-creator/50619772#50619772", "title": "How to change debugger in QT Creator?", "body": "<p>That kit was installed by the installer, which explicitly set that particular debugger. Those settings can not get changed via the UI! If there is something wrong there, then the Qt installer needs to be fixed.</p>\n\n<p>Of course you can clone the kit and edit the cloned kit to your liking.</p>\n\n<p>If you feel like wielding your text editor, then you can of course also change the settings that the installer wrote for Creator. They are stored in a file called profiles.xml somewhere in the \"share\" folder of your Qt Creator installation.</p>\n"}], "owner": {"reputation": 4236, "user_id": 1601703, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/07824cc1d45c4dbb45044a1c0963b221?s=128&d=identicon&r=PG", "display_name": "vasili111", "link": "https://stackoverflow.com/users/1601703/vasili111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 50619772, "answer_count": 1, "score": 0, "last_activity_date": 1527754813, "creation_date": 1527629191, "question_id": 50593191, "link": "https://stackoverflow.com/questions/50593191/how-to-change-debugger-in-qt-creator", "title": "How to change debugger in QT Creator?", "body": "<p><em>I use QT Creator from MSYS2.</em></p>\n\n<p>In QT creator <code>Tools &gt; Options &gt; Build and Run &gt; Kits</code> control which changes debugger is grey and I cannot change it, like in the screenshot below:\n<a href=\"https://i.stack.imgur.com/lxcLz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lxcLz.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is that in the kit for 32 bit software is set gdb for 64 bit software (which works incorrectly). I need to change 64 bit gdb in 32 bit kit to the gdb for 32 bit. How to do that?</p>\n\n<p>Here is also screenshot from debuggers tab:\n<a href=\"https://i.stack.imgur.com/jVREn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jVREn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "header-files"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 7, "creation_date": 1527628826, "post_id": 50593094, "comment_id": 88195565, "body": "If they&#39;re not used anywhere else (i.e. they&#39;re &quot;private&quot;) then there is no reason to declare them in a header file."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 3, "creation_date": 1527629388, "post_id": 50593094, "comment_id": 88195782, "body": "And functions and &quot;global&quot; variables that truly are only applicable within the .c module could be declared static."}], "answers": [{"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 2, "last_activity_date": 1527647891, "last_edit_date": 1527647891, "creation_date": 1527647054, "answer_id": 50595509, "question_id": 50593094, "link": "https://stackoverflow.com/questions/50593094/what-declarations-should-be-placed-in-a-c-header-file/50595509#50595509", "title": "What declarations should be placed in a C header file?", "body": "<p><code>#include</code> is a pre-processing step, so you can stick whatever in there. This is largely a question of style, but it is good programming practice to minimise the impact on the namespace. (Usually) using header files allows a primitive distinction between <em>public</em> and <em>private</em>, with the <em>public definitions</em> being put in the header. That way, a separate compilation unit can include the header and have the definitions resolved when one links them. Anything that is <em>private</em> to the compilation unit should not be included unless a <em>public</em> declaration has it as it's dependency. Some things that are useful (or essential) to put in header files,</p>\n\n<ul>\n<li><code>typedef</code>'s that are used in <em>public</em> functions, (eg, a pointer-to-function used as an argument to a non-<code>static</code> function that is also part of the header);</li>\n<li><code>enum</code> values that are used in <em>public</em> functions or are part of the <code>.h</code> file's purpose;</li>\n<li><code>struct</code> or <code>union</code> declarations, especially if they are in public functions. One does not need to define them if all functions use pointer values, (data hiding is good design, see <a href=\"https://stackoverflow.com/questions/1410563/what-is-the-difference-between-a-definition-and-a-declaration\">What is the difference between a definition and a declaration?</a>);</li>\n<li><code>#define</code> in header files should be used sparingly to avoid namespace conflicts, but sometimes it's part of the header's purpose;</li>\n<li>any <em>private</em> symbols should be <code>static</code>, thus eligible for extra optimisation; anything <code>static</code> should not be there, and <code>main</code> does not need a prototype, (see <a href=\"https://stackoverflow.com/questions/5020362/declare-main-prototype\">Declare main prototype</a>);</li>\n<li><code>extern</code> see <a href=\"https://stackoverflow.com/questions/12727881/c-what-is-the-use-of-extern-in-header-files\">C: What is the use of &#39;extern&#39; in header files?</a>.</li>\n</ul>\n\n<p>The <code>c</code> file should generally <code>#include</code> it's <code>h</code> file. There are some other uses of header files, too; for example, see <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/X_Macro</a>.</p>\n"}], "owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1527647891, "creation_date": 1527628722, "question_id": 50593094, "link": "https://stackoverflow.com/questions/50593094/what-declarations-should-be-placed-in-a-c-header-file", "title": "What declarations should be placed in a C header file?", "body": "<p>There exists a header file for almost each .c file in my project. All typedefs and function declarations are placed in header files. But is this a good practice? Some of the typedefs are used only in one of the .c files. Also some of the functions are not called by functions in other source files.</p>\n"}, {"tags": ["c", "output"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 6, "creation_date": 1527627247, "post_id": 50592746, "comment_id": 88194924, "body": "<code>%p</code> prints out the address of <code>buffer</code> in memory. Why would you expect it to be the same every time you run the program?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527627435, "post_id": 50592746, "comment_id": 88195006, "body": "You actually try to ask about different linking schemes for variables, don&#39;t you?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527627702, "post_id": 50592746, "comment_id": 88195111, "body": "How much do you know about different memories for variables? Do you know the meaning of &quot;local&quot;, &quot;global&quot;, &quot;dynamic&quot;, &quot;bss&quot;, &quot;data&quot;, &quot;explicitly initialised&quot;? can you use those terms to describe the differences between your programs? Do you know about how much of those is actually mentioned in C standard?"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527627507, "post_id": 50592813, "comment_id": 88195034, "body": "This does not explain anything about the differences between the four different programs. I think that it therefor somewhat misses the point of the question."}], "tags": [], "owner": {"reputation": 671, "user_id": 9796205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83X8u.jpg?s=128&g=1", "display_name": "Francesco Re", "link": "https://stackoverflow.com/users/9796205/francesco-re"}, "is_accepted": false, "score": 0, "last_activity_date": 1527627785, "last_edit_date": 1527627785, "creation_date": 1527627457, "answer_id": 50592813, "question_id": 50592746, "link": "https://stackoverflow.com/questions/50592746/different-outputs-in-c/50592813#50592813", "title": "different outputs in c", "body": "<p>The address of the allocated memory is always different, it depends on the free memory and on what memory range the operating system gives to your program.</p>\n\n<p>EDIT: Consider also that every variable you allocate in a function is allocated in the stack while others are allocated in the heap.</p>\n"}, {"tags": [], "owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "is_accepted": false, "score": 0, "last_activity_date": 1527627617, "creation_date": 1527627617, "answer_id": 50592855, "question_id": 50592746, "link": "https://stackoverflow.com/questions/50592746/different-outputs-in-c/50592855#50592855", "title": "different outputs in c", "body": "<p>For examples 2 and 3, the array is declared globally, i.e. not on the stack during execution. The other two have it declared on the stack while the program is running. These two schemes will have wildly different results. The differences between the results in each pair are more subtle, and are really up to the compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1527628427, "creation_date": 1527628427, "answer_id": 50593044, "question_id": 50592746, "link": "https://stackoverflow.com/questions/50592746/different-outputs-in-c/50593044#50593044", "title": "different outputs in c", "body": "<p>The text printed from <code>printf(\"address: %p\\n\", buffer);</code>  could be the same in all for programs (although unlikely) and as demonstrated by OP, they can be different.</p>\n\n<p>Many compilers arrange data in different groups (e.g. segments).  That is a property of the compiler and not C.  These groups are often based on the lifetime of the variable and how (if) it is initialized.</p>\n\n<p>Research your compiler for details.</p>\n\n<pre><code>char global_initialized_to_zero[10000];\nchar global_initialized[10000] = { 'a', 'b', 'c', '\\0' };\n\nint main() {\n  char local_uninitialized[10000];\n  char* allocated = malloc(10000);\n  ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527630363, "post_id": 50593128, "comment_id": 88196161, "body": "The reason the OS gives different blocks each time you run the program is because of <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow noreferrer\">ASLR</a>"}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527630541, "post_id": 50593128, "comment_id": 88196221, "body": "Yeah, and the stack would probably be different if you get a different PID. I love it when the comments have the &#39;more in depth than necessary&#39; stuff. :)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527689141, "post_id": 50593128, "comment_id": 88223088, "body": "Why would the stack depend on PID? Before ASLR, every process had the same memory layout."}, {"owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527689535, "post_id": 50593128, "comment_id": 88223396, "body": "In embedded systems each PID often gets its own stack. C is often used on embedded systems."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527690491, "post_id": 50593128, "comment_id": 88224122, "body": "Ahh, I generally assume we&#39;re talking about user-mode programs on OSes like Unix or Windows, where processes run in virtual memory, unless the question specifically states otherwise"}], "tags": [], "owner": {"reputation": 1209, "user_id": 4217072, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-d9p4Q8FtKsk/AAAAAAAAAAI/AAAAAAAAAC4/5Kn4PPeQKSI/photo.jpg?sz=128", "display_name": "LambdaBeta", "link": "https://stackoverflow.com/users/4217072/lambdabeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1527628900, "creation_date": 1527628900, "answer_id": 50593128, "question_id": 50592746, "link": "https://stackoverflow.com/questions/50592746/different-outputs-in-c/50593128#50593128", "title": "different outputs in c", "body": "<p>The reason, as others have touched on, is that the address of the buffer is\nprinted and it isn't always the same. The question though, is why?</p>\n\n<p>To answer this lets make a guess at where the compiler will put the buffer in\neach case.</p>\n\n<p>As background, there are multiple 'sections' in an assembly file that tell the\ncomputer what each series of 1s and 0s in the resulting executable mean.</p>\n\n<p>One such section is the 'data' section. This contains initialized read/write\ndata (in some cases it is read-only and read/write has another name).</p>\n\n<p>Another section is the 'text' section. This is read-only and contains the\nactual code you are running, converted into binary. Static constants can be put\nhere, since it is accessible at runtime.</p>\n\n<p>A third section is the 'bss' section. This contains read/write data but is\nuninitialized. When the code is setup to be run the computer doesn't have to\nworry about copying the data into this section, just making sure that it exists.</p>\n\n<p>Each of these sections will be mapped to some address in memory when the code\nruns. This doesn't describe all of the addresses that you will see over the\ncourse of execution however. There are two more!</p>\n\n<p>The \"heap\" is a name given to memory that your program can specifically ask for\nafter it starts running. This is useful because your program may not know\nexactly how much memory it needs until it gets going.</p>\n\n<p>The \"stack\" is a name given to memory that your program is given when it starts\nto essentially save scratch work. It is where local variables are saved.</p>\n\n<p>Thus we can visualize the memory of a running executable as:</p>\n\n<pre><code>|_00_| Program Code\n|_01_|\n|_02_|\n|_03_|\n|....|\n|_04_| Initialized Memory\n|_05_|\n|_06_|\n|_07_|\n|....|\n|_08_| Uninitialized Memory\n|_09_|\n|_10_|\n|_11_|\n....\n|_38_| Dynamic Memory (from malloc)\n|_39_|\n|_40_|\n|_41_|\n....\n|_96_| Program Stack (local variables)\n|_97_|\n|_98_|\n|_99_|\n</code></pre>\n\n<p>Now lets look at each example.</p>\n\n<h2>Number 1</h2>\n\n<p>The buffer was declared inside main's stack. Thus the buffer will likely be\nlocated there (though it is large enough that some compilers may move it\nelsewhere). The stack is often in memory near the end of addressible\nmemory that grows towards the static code.</p>\n\n<h2>Number 2</h2>\n\n<p>The buffer was declared in global scope. It was uninitialized, so it can go in\nthe uninitialized data section. If it was put in the initialized data section\nthen the operating system would have to initialize all 10kb of memory before\nstarting the code, which would waste time.</p>\n\n<h2>Number 3</h2>\n\n<p>The buffer was declared in global scope, but initialized. It can go in the\ninitialized data section. The operating system will have to initialize all 10kb\nof memory devoted to the buffer to 'a', 'b', 'c', then a bunch of zeroes.</p>\n\n<h2>Number 4</h2>\n\n<p>The buffer was declared by asking for more memory, so it will be some block that\nthe operating system gave it to use.</p>\n\n<p>Note that due to virtual addressing it is likely that the results for numbers\n1-3 would be the same each time you ran the code, but this one is almost certain\nto change on each execution as the operating system finds different blocks of\nmemory to give you.</p>\n\n<p>Visualizing all of this we see different addresses:</p>\n\n<pre><code>|_00_| Program Code\n|_01_|\n|_02_|\n|_03_|\n|....|\n|_04_| Initialized Memory\n|_05_|\n|_06_|\n|_07_| &lt;-- Number 3\n|....|\n|_08_| Uninitialized Memory\n|_09_|\n|_10_|\n|_11_| &lt;-- Number 2\n....\n|_38_| Dynamic Memory (from malloc)\n|_39_|\n|_40_|\n|_41_| &lt;-- Number 4\n....\n|_96_| Program Stack (local variables)\n|_97_|\n|_98_|\n|_99_| &lt;-- Number 1\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9865928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8e9c021d48ff0b25f2b125b84dd7ccb?s=128&d=identicon&r=PG&f=1", "display_name": "DEEK", "link": "https://stackoverflow.com/users/9865928/deek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "closed_date": 1527635992, "answer_count": 4, "score": -2, "last_activity_date": 1527628900, "creation_date": 1527627111, "question_id": 50592746, "link": "https://stackoverflow.com/questions/50592746/different-outputs-in-c", "closed_reason": "Needs details or clarity", "title": "different outputs in c", "body": "<p>these 4 programs all create an array with 10000 char elements and all have a different output. can anyone explain why ?</p>\n\n<p>number 1:</p>\n\n<pre><code>int main()\n{\nchar buffer[10000];\nprintf(\"address: %p\\n\", buffer);\nreturn 0;\n}\n</code></pre>\n\n<p>number 2:</p>\n\n<pre><code>char buffer[10000];\n\nint main()\n{\n    printf(\"address: %p\\n\", buffer);\n    return 0;\n}\n</code></pre>\n\n<p>number 3:</p>\n\n<pre><code>char buffer[10000] = { 'a', 'b', 'c', '\\0' };\nint main()\n{\n    printf(\"address: %p\\n\", buffer);\n    return 0;\n}\n</code></pre>\n\n<p>number 4:</p>\n\n<pre><code>int main()\n{\n    char* buffer = (char*)malloc(10000);\n    printf(\"address: %p\\n\", buffer);\n    free(buffer);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527627822, "post_id": 50592577, "comment_id": 88195159, "body": "There is no guarantee the <code>main</code> thread won&#39;t go off, locking the mutex, changing <code>nr</code>, signaling the cv (whether or not anyone is actually waiting on it), and unlocking the mutex, all before the child thread even locks the mutex, much less starts waiting on the cv. In that case, <code>nr</code> <i>can</i> be <code>1</code> (or <code>2</code>, etc) when the child finally gets the mutex. That means your <code>while</code> loop will be skipped (<code>nr&lt;=0</code> is not true), and whatever the current value of <code>nr</code> is will be printed on the way out. I&#39;ve run this several times, and gotten 1x1, 1x2, and 2x2, multiple times."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1527628009, "post_id": 50592577, "comment_id": 88195224, "body": "@WhozCraig &lt; Nice explanation, I think you should write it with its corrected code as answer."}, {"owner": {"reputation": 21, "user_id": 9866576, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arqady", "link": "https://stackoverflow.com/users/9866576/arqady"}, "edited": false, "score": 0, "creation_date": 1527628320, "post_id": 50592577, "comment_id": 88195362, "body": "Maybe some sleep commands will fix it then...right (aftrer the signal) ?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1527628370, "post_id": 50592577, "comment_id": 88195375, "body": "@Arqady every time someone &quot;controls&quot; thread concurrency with <code>sleep</code>, a kitten dies."}, {"owner": {"reputation": 51391, "user_id": 132382, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/20fc7ee8f405aa42e36eb73e841e5a36?s=128&d=identicon&r=PG", "display_name": "pilcrow", "link": "https://stackoverflow.com/users/132382/pilcrow"}, "edited": false, "score": 0, "creation_date": 1527628701, "post_id": 50592577, "comment_id": 88195521, "body": "Where do you initialize <code>cond</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": false, "score": 3, "last_activity_date": 1527631127, "creation_date": 1527631127, "answer_id": 50593576, "question_id": 50592577, "link": "https://stackoverflow.com/questions/50592577/global-variable-not-changing-in-thread/50593576#50593576", "title": "Global variable not changing in thread?", "body": "<p>As I mentioned in general comment, I'll repeat here:</p>\n\n<blockquote>\n  <p>There is no guarantee the main thread won't go off, locking the mutex,\n  changing nr, signaling the cv (whether or not anyone is actually\n  waiting on it), and unlocking the mutex, all before the child thread\n  even locks the mutex, much less starts waiting on the cv. In that\n  case, nr can be 1 (or 2, etc) when the child finally gets the mutex.\n  That means your while loop will be skipped (nr&lt;=0 is not true), and\n  whatever the current value of nr is will be printed on the way out.\n  I've run this several times, and gotten 1x1, 1x2, and 2x2, multiple\n  times.</p>\n</blockquote>\n\n<p>A simple fix for this involves using the cv/mtx pair you've set up for monitoring for changes from <code>main</code> to also monitor startup-start from <code>function</code>. First the code:</p>\n\n<p><strong>The Code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_mutex_t mtx = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t cond = PTHREAD_COND_INITIALIZER;\nint nr = -1;\n\nvoid* function(void* arg)\n{\n    // signal main to start up once we start waiting\n    pthread_mutex_lock(&amp;mtx);\n    nr = 0;\n    pthread_cond_signal(&amp;cond);\n\n    // now start waiting (which will unlock the mutex as well, which means\n    //  the main thread will be be able to acquire it and check nr safely\n    while(nr&lt;=0)\n        pthread_cond_wait(&amp;cond,&amp;mtx);\n\n    printf(\"Number %d is positive \\n\",nr);\n    pthread_mutex_unlock(&amp;mtx);\n    return NULL;\n}\n\nint main()\n{\n    pthread_t tid;\n\n    pthread_create(&amp;tid,NULL,function,NULL);\n\n    // wait until child is knowingly waiting\n    pthread_mutex_lock(&amp;mtx);\n    while (nr != 0)\n        pthread_cond_wait(&amp;cond, &amp;mtx);\n    pthread_mutex_unlock(&amp;mtx);\n\n    // now we know the child is ready to receive signals\n    int i;\n    for(i=0;i&lt;3;i++)\n    {\n        pthread_mutex_lock(&amp;mtx);\n\n        if(i==0)\n            nr=nr+1;\n        if(i==1)\n            nr=nr-2;\n        if(i==2)\n            nr=nr+3;\n\n        int isPos = (nr&gt;0);\n        pthread_mutex_unlock(&amp;mtx);\n\n        if (isPos)\n            pthread_cond_signal(&amp;cond);\n    }\n    pthread_join(tid,NULL);\n    return 0;\n}\n</code></pre>\n\n<p><strong>How It Works</strong></p>\n\n<p>The initial value of <code>nr</code> is established as <code>-1</code>. Only the child thread will change this directly to <code>0</code>, and even then only under the protection of the predicate mutex.</p>\n\n<pre><code>    // signal main to start up once we start waiting\n    pthread_mutex_lock(&amp;mtx);\n    nr = 0;\n    pthread_cond_signal(&amp;cond);\n</code></pre>\n\n<p>Note that after the above three lines, the child <em>still</em> owns the mutex. It atomically releases it <em>and</em> begins waiting for notifications with the first entry into the subsequent loop:</p>\n\n<pre><code>    while(nr&lt;=0)\n        pthread_cond_wait(&amp;cond,&amp;mtx);\n</code></pre>\n\n<p>Now, back in <code>main</code>, the startup creates the child thread, acquires the mutex, then monitors until <code>nr</code> is zero.</p>\n\n<pre><code>    pthread_create(&amp;tid,NULL,function,NULL);\n\n    // wait until child is knowingly waiting\n    pthread_mutex_lock(&amp;mtx);\n    while (nr != 0)\n        pthread_cond_wait(&amp;cond, &amp;mtx);\n    pthread_mutex_unlock(&amp;mtx);\n</code></pre>\n\n<p>The only way to make it past this is when <code>nr == 0</code>. When that happens, the child must have changed it, but more importantly, it also must be waiting on the condition variable (that is how we got the mutex; remember?) From that point on, the code is similar. Worth noting, I use the pthread initializers to ensure the mutex and cvar are properly stood up. Your original post was missing the cvar initialization.</p>\n\n<p>Lastly, doing multiple-predicate double-duty with a single cvar-mtx pair is <em>easy</em> to mess up, and can be <em>very</em> hard to detect edge cases when you did (mess up, that is). Be careful. This specific example is a hand-off sequence of duties, not concurrent duties, making it fairly trivial, so I'm comfortable in showing it.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 9866576, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Arqady", "link": "https://stackoverflow.com/users/9866576/arqady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1527631127, "creation_date": 1527626350, "question_id": 50592577, "link": "https://stackoverflow.com/questions/50592577/global-variable-not-changing-in-thread", "title": "Global variable not changing in thread?", "body": "<p>I'm trying to update a global variable in the main function and have a thread tell me when this variable is positive. </p>\n\n<p>The code: <a href=\"https://pastebin.com/r4DUHaUV\" rel=\"nofollow noreferrer\">https://pastebin.com/r4DUHaUV</a></p>\n\n<p>When I run it, only 2 shows up though 1 and 2 should be the correct answer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_t tid;\npthread_mutex_t mtx;\npthread_cond_t cond;\nint nr=0;\n\nvoid* function(void* arg)\n{\n        pthread_mutex_lock(&amp;mtx);\n        printf(\"Number in thread : %d \\n\",nr);\n        while(nr&lt;=0)\n                pthread_cond_wait(&amp;cond,&amp;mtx);\n        printf(\"Number %d is positive \\n\",nr);\n        pthread_mutex_unlock(&amp;mtx);\n\n}\n\nint main()\n{\n        pthread_mutex_init(&amp;mtx,NULL);\n        pthread_create(&amp;tid,NULL,function,NULL);\n        int i;\n        for(i=0;i&lt;3;i++)\n            {\n                int isPos=0;\n                pthread_mutex_lock(&amp;mtx);\n                if(i==0)\n                        nr=nr+1;\n                if(i==1)\n                        nr=nr-2;\n                if(i==2)\n                        nr=nr+3;\n                if(nr&gt;0)\n                        isPos=1;\n                if(isPos==1)\n                        pthread_cond_signal(&amp;cond);\n                pthread_mutex_unlock(&amp;mtx);\n            }\n        pthread_join(tid,NULL);\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers", "random"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1527624766, "post_id": 50592220, "comment_id": 88193750, "body": "What goes wrong?"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 3, "creation_date": 1527624772, "post_id": 50592220, "comment_id": 88193755, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: How to create a Minimal, Complete, and Verifiable example."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527624791, "post_id": 50592220, "comment_id": 88193770, "body": "Where is the rest of the code? You have &quot;two functions&quot; but only one is about random numbers."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1527625013, "post_id": 50592220, "comment_id": 88193881, "body": "You fill vetor from 0 to tamanho-1, then ask for vetor[tamanho], which is past the end of the array."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527625076, "post_id": 50592220, "comment_id": 88193917, "body": "That might not be the same <code>tamanho</code>, it might be called from a loop. we don&#39;t know."}, {"owner": {"reputation": 9, "user_id": 9856905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9856905", "link": "https://stackoverflow.com/users/9856905/user9856905"}, "edited": false, "score": 0, "creation_date": 1527625100, "post_id": 50592220, "comment_id": 88193924, "body": "The other function should just print the array and its size. The problem is that I got an overflow every time it runs"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527625157, "post_id": 50592220, "comment_id": 88193952, "body": "The other function does not print the array. You can&#39;t throw an array at the <code>%d</code> format specifier - it prints <i>one</i> value. Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input, the expected output, and the actual output as text <i>in the question</i>."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527625729, "post_id": 50592423, "comment_id": 88194226, "body": "Exactly what I had ready!."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527625812, "post_id": 50592423, "comment_id": 88194266, "body": "@WeatherVane great minds think alike!"}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": false, "score": 3, "last_activity_date": 1527625628, "creation_date": 1527625628, "answer_id": 50592423, "question_id": 50592220, "link": "https://stackoverflow.com/questions/50592220/generating-an-array-of-random-numbers-using-two-functions/50592423#50592423", "title": "Generating an array of random numbers using two functions", "body": "<p>As pointed out in the comments, your print_vetor function is wrong. You need a loop to iterate over each element in the array, just like you do when you generate the random numbers.</p>\n\n<pre><code>void print_vetor(int *vetor, int tamanho){\n    unsigned int i = 0;\n    for (i = 0; i &lt; tamanho; i++) {\n        printf(\"%d, \", vetor[i]);\n    }\n    printf(\"\\n%d\\n\", tamanho);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9856905, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9856905", "link": "https://stackoverflow.com/users/9856905/user9856905"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1527630689, "answer_count": 1, "score": -9, "last_activity_date": 1527626344, "creation_date": 1527624651, "last_edit_date": 1527626344, "question_id": 50592220, "link": "https://stackoverflow.com/questions/50592220/generating-an-array-of-random-numbers-using-two-functions", "closed_reason": "Not suitable for this site", "title": "Generating an array of random numbers using two functions", "body": "<p>I am trying to generate an array whose elements are random numbers in a range (between a min value and max value), but something goes wrong. Code right below. </p>\n\n<pre><code>void cria_aleatorio(int *vetor, int tamanho, int min, int max) {\n    int i=0;\n\n    for(i=0; i&lt;tamanho; i++)\n    {\n        vetor[i] = (rand() % (max - min + 1)) + min;\n    }\n}\n\nvoid print_vetor(int *vetor, int tamanho){\n    printf(\"%d\", vetor[tamanho]);\n    printf(\"%d\", tamanho);\n}\n</code></pre>\n"}, {"tags": ["c", "posix"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1527623527, "post_id": 50591907, "comment_id": 88193200, "body": "This is not a standard C function. RTFM for the library that contains fnmatch()."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527623553, "post_id": 50591907, "comment_id": 88193210, "body": "What is <code>fnmatch</code>?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1527623556, "post_id": 50591907, "comment_id": 88193212, "body": "Please give sample input, desired output and actual output for a few cases."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1527623603, "post_id": 50591907, "comment_id": 88193237, "body": "For reference, this is the definition of fnmatch: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1527624012, "post_id": 50591907, "comment_id": 88193420, "body": "If <code>fnmatch</code> is supposed to match patterns in a string, should you be using <code>[&#39;0&#39;-&#39;9&#39;]</code> and not <code>[0-9]</code>? Is there a similarity with <code>scanf</code>&#39;s <code>%[]</code>specifer?"}, {"owner": {"reputation": 826, "user_id": 1402389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/599c4eaaff0f5d2c3fe5feca6560173b?s=128&d=identicon&r=PG", "display_name": "FBergo", "link": "https://stackoverflow.com/users/1402389/fbergo"}, "edited": false, "score": 1, "creation_date": 1527624224, "post_id": 50591907, "comment_id": 88193500, "body": "The POSIX function fnmatch matches wildcard patterns, not regular expressions. Wildcard patterns are described in glob(7): <a href=\"http://man7.org/linux/man-pages/man7/glob.7.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man7/glob.7.html</a> ."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1527625789, "post_id": 50591907, "comment_id": 88194258, "body": "Please provide the complete code that fails to do what you expect. A complete example of the pattern and filename you want to match against, and the flags you have passed."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1527629017, "post_id": 50591907, "comment_id": 88195631, "body": "You may interest yourself in <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/regex.h.html\" rel=\"nofollow noreferrer\">regex.h</a>."}, {"owner": {"reputation": 11, "user_id": 9670974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_wK4bku8S3Y/AAAAAAAAAAI/AAAAAAAAAE4/LkHp3AufDj4/photo.jpg?sz=128", "display_name": "sanchu", "link": "https://stackoverflow.com/users/9670974/sanchu"}, "edited": false, "score": 0, "creation_date": 1527667404, "post_id": 50591907, "comment_id": 88207879, "body": "Updated the question, I hope it is clear what I want to do."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1527668006, "post_id": 50591907, "comment_id": 88208231, "body": "A more direct link to the <code>fnmatch()</code> POSIX spec: <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fnmatch.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/fnmatch.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 3, "creation_date": 1527668380, "post_id": 50591907, "comment_id": 88208459, "body": "As mentioned in a couple comments here, <code>fnmatch()</code> doesn&#39;t match regular expressions.  As a quick example, the fact that <code>patternTwo</code> starts with a <code>&#39;.&#39;</code> character means it won&#39;t match <code>&quot;0&quot;</code> since for <code>fnmatch()</code> a period matches a period (not any character like in a regex).  For example, try <code>fnmatch(patternTwo, &quot;.x0y1&quot;, 0)</code> will will show a match."}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 4, "last_activity_date": 1527807102, "creation_date": 1527807102, "answer_id": 50633867, "question_id": 50591907, "link": "https://stackoverflow.com/questions/50591907/fnmatch-usage-with-complicate-pattern-c/50633867#50633867", "title": "fnmatch usage with complicate pattern C", "body": "<p>Treat the pattern as a shell glob pattern. Given:</p>\n\n<pre><code>const char* patternTwo = \".?[a-z0-9]*?*[a-z0-9]\";\n</code></pre>\n\n<p>There is no way <code>\"0\"</code> will match that. An example of a string that will match it would be: <code>\".XaX9\"</code></p>\n\n<blockquote>\n  <p><code>.</code> matches <code>.</code><br>\n      <code>X</code> matches <code>?</code><br>\n      <code>a</code> matches <code>[a-z0-9]</code><br>\n      <code>X</code> matches <code>*?*</code><br>\n      <code>9</code> matches <code>[a-z0-9]</code></p>\n</blockquote>\n\n<p>The reason <code>fnmatch()</code> is different from <code>glob()</code> is so that the pattern <code>\"*\"</code> (which as a normal glob would match any string) will fail to match a file named <code>\".profile\"</code> because dot files are treated as hidden (it is function designed to perform a file name match).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7984904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faccfb6272a2cec3696034a63cad4959?s=128&d=identicon&r=PG&f=1", "display_name": "Linus", "link": "https://stackoverflow.com/users/7984904/linus"}, "is_accepted": false, "score": 0, "last_activity_date": 1618762137, "last_edit_date": 1618762137, "creation_date": 1618761718, "answer_id": 67150607, "question_id": 50591907, "link": "https://stackoverflow.com/questions/50591907/fnmatch-usage-with-complicate-pattern-c/67150607#67150607", "title": "fnmatch usage with complicate pattern C", "body": "<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;fnmatch.h&gt;\n\nint main(int argc, char **argv) {\n    const char *patternOne = &quot;[0-9]&quot;;\n    const char *patternTwo = &quot;.?[a-z0-9]*?*[a-z0-9]&quot;;\n    int res = fnmatch(patternTwo, &quot;0&quot;, FNM_EXTMATCH);\n    printf(&quot;Result: %d\\n&quot;,  res);\n}\n</code></pre>\n<p>Set <strong>FNM_EXTMATCH</strong> flag can use like <code>.?[a-z0-9]*?*[a-z0-9]</code> with pattern</p>\n<p><strong>FNM_EXTMATCH</strong>\nBesides the normal patterns, also recognize the extended patterns introduced in ksh. The patterns are written in the form explained in the following table where pattern-list is a | separated list of patterns.</p>\n<p><code>?(pattern-list)</code>\nThe pattern matches if zero or one occurrences of any of the patterns in the pattern-list allow matching the input string.</p>\n<p><code>(pattern-list)</code>\nThe pattern matches if zero or more occurrences of any of the patterns in the pattern-list allow matching the input string.</p>\n<p><code>+(pattern-list)</code>\nThe pattern matches if one or more occurrences of any of the patterns in the pattern-list allow matching the input string.</p>\n<p><code>@(pattern-list)</code>\nThe pattern matches if exactly one occurrence of any of the patterns in the pattern-list allows matching the input string.</p>\n<p><code>!(pattern-list)</code>\nThe pattern matches if the input string cannot be matched with any of the patterns in the pattern-list.</p>\n"}], "owner": {"reputation": 11, "user_id": 9670974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_wK4bku8S3Y/AAAAAAAAAAI/AAAAAAAAAE4/LkHp3AufDj4/photo.jpg?sz=128", "display_name": "sanchu", "link": "https://stackoverflow.com/users/9670974/sanchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3546, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1618762137, "creation_date": 1527623365, "last_edit_date": 1597934403, "question_id": 50591907, "link": "https://stackoverflow.com/questions/50591907/fnmatch-usage-with-complicate-pattern-c", "title": "fnmatch usage with complicate pattern C", "body": "<p>I'm only able to match simple patterns like: <code>&quot;[0-9]&quot;</code> with <code>fnmatch(&quot;[0-9]&quot;, tocheck, 0)</code>.</p>\n<p>If I try something more complicated with <code>?</code> or <code>.</code> or even a combination of these how do I use <code>fnmatch</code>?\nI saw there are some flags that can do the trick, but I don't know how to use because I'm fairly new to C.</p>\n<p>EDIT: I saw the comment asking to give more details:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;fnmatch.h&gt;\n\nint main(int argc, char **argv) {\n    const char *patternOne = &quot;[0-9]&quot;;\n    const char *patternTwo = &quot;.?[a-z0-9]*?*[a-z0-9]&quot;;\n    int res = fnmatch(patternTwo, &quot;0&quot;, 0);\n    printf(&quot;Result: %d\\n&quot;,  res);\n}\n</code></pre>\n<p>If I use <code>patternOne</code> the result is <code>0</code> and if I change the string to match, the result change correctly.\nHowever if I use <code>patternTwo</code> I never get the <code>0</code> result for whatever string I pass to <code>fnmatch</code>.\nI need to match something like this in my program. It is for an university exam, so the patterns are very intricate.</p>\n"}, {"tags": ["c", "linux", "process"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527624303, "post_id": 50591902, "comment_id": 88193542, "body": "Thanks. Can pid be a group leader and why?"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1527623345, "creation_date": 1527623345, "answer_id": 50591902, "question_id": 50591754, "link": "https://stackoverflow.com/questions/50591754/can-the-first-argument-to-setpgid-be-a-session-leader-or-a-group-leader/50591902#50591902", "title": "Can the first argument to setpgid() be a session leader or a group leader?", "body": "<p>A session leader is always a process group leader.  If you were to move it to another process group, it would no longer be the process group leader, which violates the preceding rule.</p>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527624705, "post_id": 50592189, "comment_id": 88193722, "body": "Sessions, jobs, and process groups have had a complex evolution in Unix. I still remember when it was possible to login and start seeing output from someone else who had gotten disconnected. :)"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1527624997, "post_id": 50592189, "comment_id": 88193869, "body": "@Barmar Yeah, this was all still in flux as recently as 4.3BSD, if I remember correctly.  And the glibc manual still has a warning in it that job control is optional! (It appears to have been mandatory since the 2001 revision of POSIX.)"}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527627005, "post_id": 50592189, "comment_id": 88194816, "body": "Thanks. &quot;a process that is only a process group leader, not a session leader, may put itself into another process group (ceasing to be a process group leader)&quot;. In which group are the other processes in the original group of the original group leader,  the original group whose gid is the pid of the original group leader, or the new group of the original group leader? See my update to my post"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527644723, "post_id": 50592189, "comment_id": 88199610, "body": "@Tim I <i>think</i> the answer is &quot;setpgid affects only one process, any other processes in the group it left remain in that group; nothing cares whether the pgid of a process group is actually the pid of a process in that group, and nothing much cares whether a process group has a leader&quot; but it doesn&#39;t actually come out and <i>say</i> that in the setpgid() spec, and I don&#39;t have enough brain right now to parse the entire job control spec and figure out whether that&#39;s right.  <a href=\"https://stackoverflow.com/questions/31916561/must-a-process-group-have-a-running-leader-process\" title=\"must a process group have a running leader process\">stackoverflow.com/questions/31916561/&hellip;</a> appears to be relevant."}, {"owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "edited": false, "score": 0, "creation_date": 1527822961, "post_id": 50592189, "comment_id": 88281141, "body": "Thanks. In &quot;a process that is only a process group leader, not a session leader, may put itself into another process group (ceasing to be a process group leader)&quot;, does this happen only when the process leader creates a new group and leads it, or can this happen also when switching the group leader to another existing group? <a href=\"https://stackoverflow.com/questions/50592958/can-a-leader-of-a-process-session-or-group-leave-for-another-existing-session-or\" title=\"can a leader of a process session or group leave for another existing session or\">stackoverflow.com/questions/50592958/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1527624498, "last_edit_date": 1592644375, "creation_date": 1527624498, "answer_id": 50592189, "question_id": 50591754, "link": "https://stackoverflow.com/questions/50591754/can-the-first-argument-to-setpgid-be-a-session-leader-or-a-group-leader/50592189#50592189", "title": "Can the first argument to setpgid() be a session leader or a group leader?", "body": "<p>This behavior is specified by POSIX (which means it applies to everything calling itself &quot;Unix&quot;, not just Linux).  <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgid.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgid.html</a> says:</p>\n<blockquote>\n<pre><code>ERRORS\n    [EPERM] The process indicated by the pid argument is a session leader.\n</code></pre>\n</blockquote>\n<p>The spec doesn't say why this rule exists, but I believe the rationale stated by dbush is correct: a <em>session</em> leader must always be a process group leader; if it could move into another process group, it would cease to be a process group leader, violating the invariant.</p>\n<p>However, a process that is only a process group leader, not a session leader, <em>may</em> put itself into another process group (ceasing to be a process group leader) and may then take itself back out of the process group and become a process group leader again.  Job control shells actually <em>have</em> to do this under some circumstances: note the bit at the bottom of the RATIONALE section of the spec</p>\n<blockquote>\n<p>One non-obvious use of setpgid() is to allow a job control shell to return itself to its original process group (the one in effect when the job control shell was executed). A job control shell does this before returning control back to its parent when it is terminating or suspending itself as a way of restoring its job control &quot;state&quot; back to what its parent would expect.</p>\n</blockquote>\n<p>POSIX doesn't explain why the job control shell would have changed its process group in the first place, but the <a href=\"https://www.gnu.org/software/libc/manual/html_node/Initializing-the-Shell.html\" rel=\"nofollow noreferrer\">GNU C Library manual section on implementing job control</a> fills in the gap:</p>\n<blockquote>\n<p>When a shell program that normally performs job control is started, it has to be careful in case it has been invoked from another shell that is already doing its own job control.</p>\n<p>A subshell that runs interactively has to ensure that it has been placed in the foreground by its parent shell before it can enable job control itself.</p>\n<p>[...]</p>\n<p>Once the subshell has been placed into the foreground by its parent shell, it can enable its own job control. It does this by calling <code>setpgid</code> to put itself into its own process group, and then calling <code>tcsetpgrp</code> to place this process group into the foreground.</p>\n</blockquote>\n<p>And then, of course, it has to undo that again if the subshell is suspended (e.g. Bash has a <code>suspend</code> builtin that does this).</p>\n<p>Also notice that a job control shell does <em>not</em> establish itself as a <em>session</em> leader, even if it's not a subshell of anything.  The session is initialized by whatever program is responsible for setting up the controlling terminal; that program is typically the parent and pre-<code>exec</code> identity of the outermost shell running in the terminal.  For instance, <a href=\"https://github.com/joejulian/xterm/blob/defc6dd5684a12dc8e56cb6973ef973e7a32caa3/main.c#L3588\" rel=\"nofollow noreferrer\"><code>xterm</code> calls <code>setsid</code></a> after opening a pseudoterminal and forking, but before <code>exec</code>-ing the program that will run in that terminal window.</p>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 50592189, "answer_count": 2, "score": 2, "last_activity_date": 1527628080, "creation_date": 1527622740, "last_edit_date": 1527628080, "question_id": 50591754, "link": "https://stackoverflow.com/questions/50591754/can-the-first-argument-to-setpgid-be-a-session-leader-or-a-group-leader", "title": "Can the first argument to setpgid() be a session leader or a group leader?", "body": "<p>From The Linux Programming Interface</p>\n\n<blockquote>\n<pre><code>#include &lt;unistd.h&gt;\nint setpgid(pid_t  pid , pid_t  pgid );\n</code></pre>\n  \n  <p>The pid argument may not specify a process that is a session leader. Violation\n  of this rule results in the error  EPERM .</p>\n</blockquote>\n\n<ol>\n<li>Why can't <code>pid</code> be a session leader?</li>\n<li><p>Can <code>pid</code> be a group leader and why? </p>\n\n<p>If yes, after the call to <code>setpgid()</code>, in which group will the other processes originally in the group\noriginally led by  process <code>pid</code> be:</p>\n\n<ul>\n<li>the original group whose gid is <code>pid</code> which now has lost process <code>pid</code> and has no group leader, or</li>\n<li>the new group <code>pgid</code> which process <code>pid</code> is changed to?</li>\n</ul>\n\n<p>I suspect the first might contradict to what the book described for <code>setsid()</code>:</p>\n\n<blockquote>\n  <p>The restriction against a process group leader being able to call setsid() is necessary because, without it, the process group leader would be able to place itself in another (new) session, while other members of the process group remained in the original session. (<strong>A new process group would not be created, since, by definition, the process group leader\u2019s process group ID is already the same as its process ID.</strong>) This  would  violate  the  strict  two-level  hierarchy  of  sessions  and  process  groups, whereby all members of a process group must be part of the same session.</p>\n</blockquote></li>\n</ol>\n\n<p>Thanks.</p>\n\n<p>Some related questions <a href=\"https://stackoverflow.com/questions/50592958/can-a-leader-of-a-process-session-or-group-leave-for-another-existing-session-or\">Can a leader of a process session or group leave for another existing session or group?</a></p>\n"}, {"tags": ["c", "algorithm", "function", "dynamic", "wrapper"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1527620960, "post_id": 50591321, "comment_id": 88192007, "body": "You shouldn&#39;t need mallocs to swap pointers."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1527621630, "post_id": 50591321, "comment_id": 88192319, "body": "What a peculiar piece of code. Why do you wait to call your own <code>malloc</code> before calling <code>memory__init()</code>? Are you chasing a bee in the woods?"}, {"owner": {"reputation": 35, "user_id": 8680581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b36a8ac3b451f4a7a9980f778e2095e?s=128&d=identicon&r=PG&f=1", "display_name": "Clark Kent", "link": "https://stackoverflow.com/users/8680581/clark-kent"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1535222226, "post_id": 50591321, "comment_id": 90990702, "body": "@RobertHarvey is it meant to automatically swapped when malloc is called, from my malloc to libc malloc, do the malloc, then swap back to my malloc, so it does not do malloc &gt; malloc &gt; malloc &gt; malloc &gt; malloc &gt; malloc loop cus it is calling itself recursively, it is meant to do malloc &gt; libc_malloc (swich back to malloc) so the next time malloc is called it switched to libc malloc then back to my malloc... with the reason being its use as a self resetting wrapper like how u wrap something then call dlsym(next) on it but u can no longer access the wrapper as it is now set to the next occurence"}], "owner": {"reputation": 35, "user_id": 8680581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b36a8ac3b451f4a7a9980f778e2095e?s=128&d=identicon&r=PG&f=1", "display_name": "Clark Kent", "link": "https://stackoverflow.com/users/8680581/clark-kent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527620880, "creation_date": 1527620880, "question_id": 50591321, "link": "https://stackoverflow.com/questions/50591321/c-dl-how-to-swap-a-function-pointer-for-another-function-pointer", "title": "C dl* how to swap a function pointer for another function pointer", "body": "<p>How do i safely swap a function for another function in C, as i have this</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;dlfcn.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nvoid *(*malloc_mem_real)(size_t);\nvoid *(*calloc_mem_real)(void*,size_t);\nvoid *(*realloc_mem_real)(void*,size_t);\nvoid (*free_mem_real)(void*);\n\nvoid memory__init(void) {\n    if (!malloc_mem_real) malloc_mem_real = dlsym(RTLD_NEXT, \"malloc\");\n    if (!calloc_mem_real) calloc_mem_real = dlsym(RTLD_NEXT, \"calloc\");\n    if (!realloc_mem_real) realloc_mem_real = dlsym(RTLD_NEXT, \"realloc\");\n    if (!free_mem_real) free_mem_real = dlsym(RTLD_NEXT, \"free\");\n}\n\n/*\nconst char *getObjectName (object *anObject) {\n    static char * (*func)();\n\n    if(!func)\n        func =  dlsym(RTLD_NEXT, \"getObjectName\");\n    printf(\"Overridden!\\n\");     \n    return(func(anObject));    // call original function\n}\n*/\n\nvoid* _malloc(size_t sz);\n\nint bit, saved;\n\nvoid swap_malloc() {\n    if (bit == 0) {\n        void *(* malloc)() = &amp;_malloc;\n        bit = 1;\n        write(1, \"1\\n\", 2);\n    }\n    else if (bit == 1) {\n        void *(* malloc)() = &amp;malloc_mem_real;\n        bit = 0;\n        write(1, \"0\\n\", 2);\n    }\n}\n\n\nvoid* _malloc(size_t sz) {\n    swap_malloc(); // should swap void* _malloc(size_t sz) for void* malloc(size_t __size), bit = 0\n    return malloc(sz*2); // returns libc malloc(sz*2);\n}\n\nvoid* malloc(size_t sz) {\n    if (saved == 0) {\n        memory__init(); // save real malloc address\n        saved = 1;\n    }\n    swap_malloc(); // should swap void* malloc(size_t sz) for void* _malloc(size_t sz), bit = 1\n    return malloc(sz); // returns _malloc(sz);\n}\n\nint main() {\n    char * h;\n    h = malloc(50); // should allocate 100 instead\n    printf(\"%p\\n\", h);\n    free(h);\n    return 0;\n}\n</code></pre>\n\n<p>which is meant to swap the files malloc for libc malloc but swap_malloc keeps being called recursively resulting in write: stack overflow</p>\n\n<p>The basic idea is this:</p>\n\n<p>calls malloc wrapper</p>\n\n<p>swich malloc wrapper to libc malloc</p>\n\n<p>Do functions that require libc malloc, for example printf</p>\n\n<p>switch libc malloc back to malloc wrapper</p>\n"}, {"tags": ["c", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 1, "creation_date": 1527620877, "post_id": 50591229, "comment_id": 88191965, "body": "<a href=\"https://stackoverflow.com/questions/2229498/passing-by-reference-in-c\">pass by reference in C</a>"}, {"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 2, "creation_date": 1527620923, "post_id": 50591229, "comment_id": 88191986, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2229498/passing-by-reference-in-c\">Passing by reference in C</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1527621084, "post_id": 50591229, "comment_id": 88192064, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/29088971/parameter-passing-in-c-pointers-addresses-aliases\">Parameter Passing in C - Pointers, Addresses, Aliases</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9866114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPKQ0.png?s=128&g=1", "display_name": "37712", "link": "https://stackoverflow.com/users/9866114/37712"}, "edited": false, "score": 0, "creation_date": 1527655768, "post_id": 50591318, "comment_id": 88202228, "body": "I don&#39;t understand, I though I was already passing in a pointer variable by using the <code>typedef struct node * link ;&#47;&#47; link is now type struct node pointer</code> why do I have to declare it as a pointer again? why cant I just use <code>link ptr</code>? isn&#39;t <code>link ptr</code> already a pointer type?"}, {"owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "reply_to_user": {"reputation": 5, "user_id": 9866114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPKQ0.png?s=128&g=1", "display_name": "37712", "link": "https://stackoverflow.com/users/9866114/37712"}, "edited": false, "score": 0, "creation_date": 1527693435, "post_id": 50591318, "comment_id": 88226180, "body": "@37712 the pointer is pointing at a node, a structure containing your value and the pointer for the next node. However, passing this pointer to a function you only pass the value of that pointer, that is, the address to the node. So you don&#39;t have access to the <code>head</code> you declared. You can access what that pointer pointed at but you cannot modify the pointer itself. Your code only modifies the <code>ptr</code> which is local to your function. Thus your <code>head</code> remains unchanged.To change the <code>head</code> you must give the function it&#39;s address, and the function must take a pointer to pointer, in this case link*"}], "tags": [], "owner": {"reputation": 353, "user_id": 5768266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mP1j8.gif?s=128&g=1", "display_name": "StereoBucket", "link": "https://stackoverflow.com/users/5768266/stereobucket"}, "is_accepted": true, "score": 1, "last_activity_date": 1527621374, "last_edit_date": 1527621374, "creation_date": 1527620853, "answer_id": 50591318, "question_id": 50591229, "link": "https://stackoverflow.com/questions/50591229/simple-linked-list-failing-to-print/50591318#50591318", "title": "simple linked list failing to print", "body": "<p>It's because you're passing a null pointer to your function and the condition for exiting the loop is for that pointer to be null, so nothing happens.\nYour <code>addFirst</code> function takes a pointer's value, but it cannot modify the <code>head</code> that you declared inside of main().\nTo modify <code>head</code> you need to pass a pointer to link, then you can dereference that pointer to access your <code>head</code> and you can then change it.</p>\n\n<pre><code>void addFirst(link *ptr, int val ){\n    link tmp = malloc(sizeof(struct node));// allocates memory for the node\n    tmp-&gt;item = val;\n    tmp-&gt;next = *ptr;\n    *ptr = tmp;\n}\n</code></pre>\n\n<p>Now you can change the head pointer. Just remember to pass the address to it when calling the function. <code>addFirst(&amp;head,i)</code></p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9866114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPKQ0.png?s=128&g=1", "display_name": "37712", "link": "https://stackoverflow.com/users/9866114/37712"}, "edited": false, "score": 0, "creation_date": 1527655573, "post_id": 50591426, "comment_id": 88202174, "body": "I don&#39;t understand, I though I was already passing in a pointer variable by using the <code>typedef struct node * link ;&#47;&#47; link is now type struct node pointer</code> why do I have to declare it as a pointer again? why cant I just use <code>link ptr</code>? isn&#39;t <code>link ptr</code> already a pointer type?"}, {"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "reply_to_user": {"reputation": 5, "user_id": 9866114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPKQ0.png?s=128&g=1", "display_name": "37712", "link": "https://stackoverflow.com/users/9866114/37712"}, "edited": false, "score": 0, "creation_date": 1527698186, "post_id": 50591426, "comment_id": 88228962, "body": "please see update. Feel free to ask  more questions if still not clear"}], "tags": [], "owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "is_accepted": false, "score": 1, "last_activity_date": 1527698147, "last_edit_date": 1527698147, "creation_date": 1527621353, "answer_id": 50591426, "question_id": 50591229, "link": "https://stackoverflow.com/questions/50591229/simple-linked-list-failing-to-print/50591426#50591426", "title": "simple linked list failing to print", "body": "<p>In the for loop</p>\n\n<pre><code>for(int i = 0; i&lt;3; i++){\n    addFirst(head, i);\n}\n</code></pre>\n\n<p>you create a bunch of pointers which all point to <code>NULL</code>. <code>head</code> is never changing since pointer itself is passed \"by value\". E.g. <code>head</code> is copied and all modifications to the pointer itself in <code>addFirst</code> are not visible outside.</p>\n\n<p>This is the same as with say <code>int</code>. Imagine <code>void foo(int x);</code>. Whatever this function does to x is not visible outside.</p>\n\n<p>However changes to the memory which <code>link ptr</code> points to are visible of course.</p>\n\n<p>E.g. this line does nothing:</p>\n\n<pre><code>   tmp-&gt;next = ptr;\n   ptr = tmp;      &lt;=== this line\n}\n</code></pre>\n\n<p>You can fix this in several ways. One is to return new node from <code>addFirst</code> and another one is to make <code>link ptr</code> to be a pointer to pointer: <code>link *ptr</code>. Since in this case you want to change pointer value (not pointee value):</p>\n\n<pre><code>//link *ptr here a pointer to pointer\nvoid addFirst(link * ptr, int val ){\n    link tmp = malloc(sizeof(struct node));// allocates memory for the node\n    tmp-&gt;item = val;\n    tmp-&gt;next = *ptr; //&lt;&lt;changed\n    *ptr = tmp;    //&lt;&lt;changed\n}\n</code></pre>\n\n<p>Do not forget to update declaration above also. And the call:</p>\n\n<pre><code>void addFirst(link * ptr, int val ); // add a node with given value to a list\n\n...\nfor(int i = 0; i&lt;3; i++){\n    addFirst(&amp;head, i);\n}\n</code></pre>\n\n<p>Then this code produces:</p>\n\n<pre><code>Printing Linked List:\n 2  1  0\n</code></pre>\n\n<p><strong>Added:</strong>\nIt's important to understand that working with linked list requires working with two different types of data.</p>\n\n<p>First is <code>struct node</code> and you pass around this type of data using <code>link</code>s.</p>\n\n<p>Second is <code>head</code>. This is a pointer to the very first node. When you would like to modify the head you find it is not a \"node\". It is something else. It's a \"name\" for the first node in the list. This name by itself is a pointer to node. See how memory layout for <code>head</code> is different from the list itself.</p>\n\n<pre><code>head[8 bytes]-&gt;node1[16 bytes]-&gt;node2[16 bytes]-&gt;...-&gt;nodek[16 bytes]-&gt;NULL;\n</code></pre>\n\n<p>by the way - the only thing which have lexical name here is <code>head</code>. All the nodes do not have name and accessible through <code>node-&gt;next</code> syntax.</p>\n\n<p>You can also imagine another pointer here, <code>link last</code> which will point to <code>nodek</code>. Again this will have different memory layout from nodes itself. And if you would like to modify that in a function you will need to pass to function pointer to that (e.g.pointer to pointer).</p>\n\n<p>Pointer and data it points to are different things. In your mind you need to separate them. Pointer is like <code>int</code> or <code>float</code>. It is passed \"by value\" to functions. Yes <code>link ptr</code> is already pointer and that permits you to update the data it points to. However the pointer itself is passed by value and updates to pointer (in your case <code>ptr=tmp</code>) are not visible outside. </p>\n\n<p><code>(*ptr).next=xxx</code> will be visible of course because data is updated (not pointer). That means you need to do one extra step - make changes to your pointer visible outside of function, e.g. convert the pointer itself (<code>head</code>) into data for another pointer, e.g. use <code>struct node **ptr</code> (first star here says this is pointer to a node, and the second star converts that pointer to data for another pointer.</p>\n"}], "owner": {"reputation": 5, "user_id": 9866114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dPKQ0.png?s=128&g=1", "display_name": "37712", "link": "https://stackoverflow.com/users/9866114/37712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 50591318, "answer_count": 2, "score": -1, "last_activity_date": 1527698147, "creation_date": 1527620525, "question_id": 50591229, "link": "https://stackoverflow.com/questions/50591229/simple-linked-list-failing-to-print", "title": "simple linked list failing to print", "body": "<p>I am learning how to make a linked list, but its failing to print out anything at all, and I cant figure out why??? please help. I believe it has something to do with my pointers but I don't know what it is.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n// typedef is used to give a data type a new name\ntypedef struct node * link ;// link is now type struct node pointer\n\n/*\n    typedef allows us to say \"link ptr\"\n    instead of \"struct node * ptr\"\n*/\n\nstruct node{\n    int item ;// this is the data\n    link next ;//same as struct node * next, next is a pointer\n};\n\nvoid printAll(link head); // print a linked list , starting at link head\nvoid addFirst(link ptr, int val ); // add a node with given value to a list\nlink removeLast(link ptr); // removes and returns the last element in the link\n\n//prints the link\nvoid printAll(link head){\n    link ptr = head;\n    printf(\"\\nPrinting Linked List:\\n\");\n    while(ptr != NULL){\n        printf(\" %d \", (*ptr).item);\n        ptr = (*ptr).next;// same as ptr-&gt;next\n    }\n    printf(\"\\n\");\n}\n\n//adds to the head of the link\nvoid addFirst(link ptr, int val ){\n    link tmp = malloc(sizeof(struct node));// allocates memory for the node\n    tmp-&gt;item = val;\n    tmp-&gt;next = ptr;\n    ptr = tmp;\n}\n\n// testing\nint main(void) {\n    link head = NULL;// same as struct node * head, head is a pointer type\n\n    //populating list\n    for(int i = 0; i&lt;3; i++){\n        addFirst(head, i);\n    }\n\n    printAll(head);\n\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<p>Printing Linked List:</p>\n\n<p>Process returned 0 (0x0) execution time : 0.059 s</p>\n\n<p>Press any key to continue</p>\n"}]