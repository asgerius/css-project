[{"tags": ["c"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519861857, "post_id": 49040515, "comment_id": 85086390, "body": "can you repeat the question?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519862126, "post_id": 49040515, "comment_id": 85086477, "body": "Do you mean <code>while(*s++ != &#39;\\0&#39;)</code> instead of indexing? That&#39;s legal."}, {"owner": {"reputation": 1, "user_id": 9426282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GS4rOmLLh0s/AAAAAAAAAAI/AAAAAAAAAJ4/wsvghsexPz0/photo.jpg?sz=128", "display_name": "Alejandro Estrada", "link": "https://stackoverflow.com/users/9426282/alejandro-estrada"}, "edited": false, "score": 0, "creation_date": 1519862300, "post_id": 49040515, "comment_id": 85086537, "body": "The code prints the string and its length. I need to modify this code so that it stills does the same, specifically by adding s = s+1 inside the while loop and then modifying the while condition. But the function still has to return i as the lenght of the string."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1519862478, "post_id": 49040515, "comment_id": 85086593, "body": "That&#39;s what I wrote: <code>s++</code> is <code>s = s + 1</code> so you can do <code>while(*s != &#39;\\0&#39;) { i++; s = s + 1; }</code>"}, {"owner": {"reputation": 1, "user_id": 9426282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GS4rOmLLh0s/AAAAAAAAAAI/AAAAAAAAAJ4/wsvghsexPz0/photo.jpg?sz=128", "display_name": "Alejandro Estrada", "link": "https://stackoverflow.com/users/9426282/alejandro-estrada"}, "edited": false, "score": 0, "creation_date": 1519862696, "post_id": 49040515, "comment_id": 85086656, "body": "it returns lenght of 1 when i do that change"}, {"owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "edited": false, "score": 0, "creation_date": 1519862770, "post_id": 49040515, "comment_id": 85086683, "body": "<code>%c</code> is for character not <code>%s</code>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519863687, "post_id": 49040515, "comment_id": 85086890, "body": "&quot;It returns length of 1 when I do that change&quot; -- Hmmm. I get 12 when I make the change suggested by @WeatherVane to your posted code. Oh, I see that now you have changed the posted code. You are missing the braces around your loop body."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519863807, "post_id": 49040515, "comment_id": 85086920, "body": "... so <code>i</code> is incremented only once."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519863925, "post_id": 49040515, "comment_id": 85086953, "body": "Please read the comments most carefully. I have edited your code indentation to show your mistake more clearly. But in future, please don&#39;t convert the question&#39;s code to an answer. The flow of comments won&#39;t make any sense to someone reading this later."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1519863947, "post_id": 49040515, "comment_id": 85086954, "body": "This is one reason that many consider it good style to <i>always</i> use braces with loop bodies: <code>while(*s != &#39;\\0&#39;) { s = s + 1; i++; }</code>, and even <code>while(s[i] != &#39;\\0&#39;) { i++; }</code>."}, {"owner": {"reputation": 1, "user_id": 9426282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GS4rOmLLh0s/AAAAAAAAAAI/AAAAAAAAAJ4/wsvghsexPz0/photo.jpg?sz=128", "display_name": "Alejandro Estrada", "link": "https://stackoverflow.com/users/9426282/alejandro-estrada"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519864263, "post_id": 49040515, "comment_id": 85087023, "body": "Thank you soo much @WeatherVane, sorry for the bad practice, this was my very first question in SO, trying to upvote or set your comment as the answer, but still finding out how, but still, thanks a lot"}], "answers": [{"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 0, "last_activity_date": 1519868504, "last_edit_date": 1519868504, "creation_date": 1519868155, "answer_id": 49041333, "question_id": 49040515, "link": "https://stackoverflow.com/questions/49040515/exercise-with-c-and-pointers/49041333#49041333", "title": "Exercise with C and pointers", "body": "<blockquote>\n  <p>it is only printing 1</p>\n</blockquote>\n\n<pre><code>int longitud_string(char *s){\nint i;\ni=0;                   // Set i = 0\nwhile(*s != '\\0')\n    s = s + 1;\ni++;                   // Set i = 1\nreturn i;              // return i (1)\n}\n</code></pre>\n\n<p>What you may have wanted is:</p>\n\n<pre><code>int longitud_string(char *s)\n{\n    int i = 0;\n    while(*s != '\\0')\n    {                 // Need brace here\n        s = s + 1;\n        i++;          //            Increment both in the loop\n\n    }                 // Close brace here.\n    return i;\n}\n</code></pre>\n\n<p>But we could simplify it like this:</p>\n\n<pre><code>int longitud_string(char *s)\n{\n    int i = 0;\n    while(s[i] != '\\0') {\n        i++;\n    }\n    return i;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2088, "user_id": 8524922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HfezG.jpg?s=128&g=1", "display_name": "Beyondo", "link": "https://stackoverflow.com/users/8524922/beyondo"}, "is_accepted": false, "score": 0, "last_activity_date": 1519895733, "creation_date": 1519895733, "answer_id": 49046315, "question_id": 49040515, "link": "https://stackoverflow.com/questions/49040515/exercise-with-c-and-pointers/49046315#49046315", "title": "Exercise with C and pointers", "body": "<p>First, let me optimize your code</p>\n\n<pre><code> int longitud_string(const char *s)\n{\n    int i = 0;  // Initalize it with 0\n    while(*s)   // No need to check for '\\0'\n        s++;    // Same as: s = s + 1 or s += 1\n    i++;    // Here you increament i only once cause you're outside the scopes of while() loop\n    return i;   // Returns i value which is equal to 1 cause it incremented only 1 time.\n}\n</code></pre>\n\n<p>You've missed the scopes in your while loop, so your code shall be</p>\n\n<pre><code>int longitud_string(const char *s)\n{\n    int i = 0;  // Initalize it with 0\n    while(*s)   // No need to check for '\\0'\n    {\n        s++;    // Same as: s = s + 1 or s += 1\n        i++;    // Incrementing every iteration of the loop, now it's working.\n    }\n    return i;   // Returns the number of iteration of the loop which is equal to the length of (s)\n}\n</code></pre>\n\n<p>Now we fixed the problem but we can optimize it more...</p>\n\n<pre><code>int getLength(const char* String)\n{\n    int i = 0;\n    while(String != NULL &amp;&amp; *String++ &amp;&amp; ++i);\n    return i;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9426282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GS4rOmLLh0s/AAAAAAAAAAI/AAAAAAAAAJ4/wsvghsexPz0/photo.jpg?sz=128", "display_name": "Alejandro Estrada", "link": "https://stackoverflow.com/users/9426282/alejandro-estrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519899272, "creation_date": 1519861719, "last_edit_date": 1519899272, "question_id": 49040515, "link": "https://stackoverflow.com/questions/49040515/exercise-with-c-and-pointers", "title": "Exercise with C and pointers", "body": "<p>Trying to edit the question so that it is more clear, this code here should print the string and its length, but instead of printing the length of 12, it is only printing 1. The argument (char *s) cannot be changed and the condition of the while loop has to be based on <code>s = s + 1</code> increment, though for the length, it still has to return i.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#define CADENA_PRUEBA \"Hola a todos\"\n\nint longitud_string(char *s){\nint i;\ni=0;\nwhile(*s != '\\0')\n    s = s + 1;\ni++;\nreturn i;\n}\n\nint main(void){\nchar string1[] = CADENA_PRUEBA;  \nprintf(\"cadena: %s\\n\", string1);\nprintf(\"longitud cadena: %d\\n\", longitud_string(string1));\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c#", "c", "arrays", "dll", "pass-by-reference"], "comments": [{"owner": {"reputation": 2024, "user_id": 1268696, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/9vs4D.jpg?s=128&g=1", "display_name": "FrankS101", "link": "https://stackoverflow.com/users/1268696/franks101"}, "edited": false, "score": 0, "creation_date": 1519861666, "post_id": 49040496, "comment_id": 85086341, "body": "we need to see your code to understand the problem and try to help you out"}, {"owner": {"reputation": 205, "user_id": 5208673, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fdeba0860110eefb55d921460b3d46b1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Johnson", "link": "https://stackoverflow.com/users/5208673/eric-johnson"}, "reply_to_user": {"reputation": 2024, "user_id": 1268696, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/9vs4D.jpg?s=128&g=1", "display_name": "FrankS101", "link": "https://stackoverflow.com/users/1268696/franks101"}, "edited": false, "score": 0, "creation_date": 1519861979, "post_id": 49040496, "comment_id": 85086424, "body": "Opps, I was still typing, and must have accidentally submitted it.  I am still typing the question on another tab.  Weird."}, {"owner": {"reputation": 2526, "user_id": 6218300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e998956e67bb176a9e00b8bb20bf4b58?s=128&d=identicon&r=PG&f=1", "display_name": "Florent DUGUET", "link": "https://stackoverflow.com/users/6218300/florent-duguet"}, "edited": false, "score": 1, "creation_date": 1519904382, "post_id": 49040496, "comment_id": 85101933, "body": "As a informational note, you can accelerate C# calculations on gpu using Hybridizer for example. Disclaimer : I work on the develop of that software."}], "answers": [{"tags": [], "owner": {"reputation": 205, "user_id": 5208673, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fdeba0860110eefb55d921460b3d46b1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Johnson", "link": "https://stackoverflow.com/users/5208673/eric-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1520263347, "creation_date": 1520263347, "answer_id": 49113738, "question_id": 49040496, "link": "https://stackoverflow.com/questions/49040496/passing-data-in-and-out-of-a-dll-from-c/49113738#49113738", "title": "Passing Data in and out of a DLL from C#", "body": "<p>I was able to solve the problem.  The line </p>\n\n<pre><code>items = (char**)malloc(itemCount);\n</code></pre>\n\n<p>should have been</p>\n\n<pre><code>items = (char**)malloc(itemCount*sizeof(char*));\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 5208673, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/fdeba0860110eefb55d921460b3d46b1?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Johnson", "link": "https://stackoverflow.com/users/5208673/eric-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1520263347, "creation_date": 1519861567, "last_edit_date": 1519862747, "question_id": 49040496, "link": "https://stackoverflow.com/questions/49040496/passing-data-in-and-out-of-a-dll-from-c", "title": "Passing Data in and out of a DLL from C#", "body": "<p>I am attempting to create a C# program that can pass data into a C/C++ DLL, store the data, and complete calculations on it.  The result would then be returned to the C# program.  The reason for not using C# for the calculations is that I am planning to accelerate it with CUDA.  </p>\n\n<p>I currently declaring a byte array in C#, and passing that as an argument to the DLL to send data.</p>\n\n<p>I then declare a byte array of the same size in C# and pass it as an argument to receive the data.  The DLL should then write the results into that memory.</p>\n\n<p>When I run the program, the correct numbers get printed to the screen.  (As I am writing 1,2,3... to the array twice, the addition of these is 2,4,6...)  \"The cat chased the mouse\" is then printed.  When I press a key, \"The mouse chased the cat\" is displayed, and the program crashes before it exits displaying a vshost32.exe stopped working error.\nI was able to solve this error from <a href=\"https://stackoverflow.com/questions/735621/vshost32-exe-crash-when-calling-unmanaged-dll\">this question</a>.</p>\n\n<p>Now when I attempt to run the EXE directly from windows explorer, I get the number 36 printed as the first step, but then I get the following error on the compute function call: </p>\n\n<blockquote>\n  <p>\"Unhanded exception: System.AccessViolationException Attempted to read\n  or write protected memory.  This is often an indication that other\n  memory is corrupt\"</p>\n</blockquote>\n\n<p>I know the DLL loaded correctly because the init function returned the correct number.  I am not sure why it would only be crashing when I am running it as an EXE and not in the debugger.  What could be causing this?</p>\n\n<p>Is there a different way I should be handling the memory exchange between the DLL and the C# program?  My goal is to avoid copying it using a Marshal Copy as I need this to be high performance.  The end goal would be the DLL copying the memory to or from the GPU and the GPU doing the calculations, so I see no reason to have it copied a 2nd time in the DLL before going to the GPU.</p>\n\n<p>C++ DLL Code (written as C code)</p>\n\n<pre><code>#include \"stdafx.h\"  \n#include \"stdlib.h\"\nconst int CONSTANT = 3;\nchar** items;\nint itemCount = 0;\nint xcnt = -1;\nint ycnt = -1;\n\nextern \"C\" int __declspec(dllexport) __stdcall init(int itemcount_local, int xcnt_local, int ycnt_local){\n    itemCount = itemcount_local;\n    xcnt = xcnt_local;\n    ycnt = ycnt_local;\n    items = (char**)malloc(itemCount);\n    if (items == NULL){\n        return -1;\n    }\n    for (int i = 0; i &lt; itemCount; i++){\n        items[i] = (char*)malloc(CONSTANT*xcnt*ycnt);\n        if (items[i] == NULL){\n            return -1;\n        }\n        for (int d = 0; d &lt; CONSTANT*xcnt*ycnt; d++){\n            items[i][d] = 0;\n        }\n    }\n    return CONSTANT*xcnt*ycnt;\n}\n\n//frees the memory created in init\nextern \"C\" void __declspec(dllexport) __stdcall cleanup(){\n    for (int i = 0; i &lt; itemCount; i++){\n        free(items[i]);\n    }\n    free(items);\n    return;\n}\n\nextern \"C\" void __declspec(dllexport) __stdcall loadItem(int index, char* data){\n    memcpy(items[index], data, CONSTANT*xcnt*ycnt);\n    return;\n}\n\n//fills the buffer with the computed result.  Buffer needs to be the size of CONSTANT*xcnt*ycnt\nextern \"C\" void __declspec(dllexport) __stdcall compute(char* buffer){\n    for (int x = 0; x &lt; CONSTANT*xcnt*ycnt; x++){\n        int sum = 0;\n        for (int i = 0; i &lt; itemCount; i++){\n            sum += items[i][x];\n        }\n        if (sum &gt; 255){ //saturate at 255\n            buffer[x] = 255;\n        }\n        else {\n            buffer[x] = sum;\n        }\n    }\n    return;\n}\n</code></pre>\n\n<p>C# code</p>\n\n<pre><code>class Program\n{\n[DllImport(\"DllTest1.dll\", CallingConvention=CallingConvention.StdCall, SetLastError = true, CharSet = CharSet.Ansi)]\npublic static extern int  init(int imagecount_local, int xres_local, int yres_local);\n\n[DllImport(\"DllTest1.dll\", CallingConvention=CallingConvention.StdCall, SetLastError = true, CharSet = CharSet.Ansi)]\npublic static extern void cleanup();\n\n[DllImport(\"DllTest1.dll\", CallingConvention=CallingConvention.StdCall, SetLastError = true, CharSet = CharSet.Ansi)]\npublic static extern void loadItem(int index, byte[] data);\n\n[DllImport(\"DllTest1.dll\", CallingConvention=CallingConvention.StdCall, SetLastError = true, CharSet = CharSet.Ansi)]\npublic static extern void compute(byte[] buffer);\n\nstatic void Main(string[] args)\n{\n\n    int x = 4, y = 3;\n    int total = x * y * 3;\n    Console.WriteLine(init(5, x, y));\n\n    byte[] a = new byte[total];\n\n    compute(a);\n    for (int i = 0; i &lt; total; i++)\n    {\n        Console.WriteLine(a[i]);\n    }\n\n    byte[] b = new byte[total];\n    for (int i = 0; i &lt; total; i++)\n    {\n        b[i] = (byte)i;\n    }\n    loadItem(0, b);\n    loadItem(1, b);\n\n    compute(a);\n    for (int i = 0; i &lt; total; i++)\n    {\n        Console.WriteLine(a[i]);\n    }\n\n    //cleanup();\n    Console.WriteLine(\"The cat chased the mouse\");\n    Console.ReadKey();\n    Console.WriteLine(\"The mouse chased the cat\");\n    return;\n}\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519861568, "post_id": 49040485, "comment_id": 85086318, "body": "They are not associated. Anyway, <code>b</code> was given the value of <code>a</code> and then overwritten by the return value from <code>malloc</code>."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1519861621, "post_id": 49040485, "comment_id": 85086331, "body": "a points to null, you assign a to b, now b points to null also, you point b to some memory you allocate then change the value stored there, a still points to null."}, {"owner": {"reputation": 397, "user_id": 5942350, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/441bdfead4798589a2b34c78386b2533?s=128&d=identicon&r=PG&f=1", "display_name": "ZEWEI CHU", "link": "https://stackoverflow.com/users/5942350/zewei-chu"}, "edited": false, "score": 0, "creation_date": 1519861627, "post_id": 49040485, "comment_id": 85086332, "body": "Oh yeah that makes sense."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519861756, "post_id": 49040485, "comment_id": 85086363, "body": "<a href=\"http://stackoverflow.com/q/605845/995714\">Do not cast <code>malloc</code></a> and don&#39;t forget to check if <code>malloc</code> returns <code>NULL</code> and to free the requested memory with <code>free(b)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 2, "last_activity_date": 1537083909, "last_edit_date": 1537083909, "creation_date": 1519861970, "answer_id": 49040550, "question_id": 49040485, "link": "https://stackoverflow.com/questions/49040485/pointer-value-not-changing-together/49040550#49040550", "title": "pointer value not changing together?", "body": "<p>After <code>b = (int*)malloc(sizeof(int));</code>, <code>b</code> points to the block of memory you just allocated and <code>a</code> still contains <code>NULL</code>.<br>\nWhen you do <code>*b = 10;</code> you store a 10 in the block of memory you allocated. Still, <code>a</code> doesn't point to anything.</p>\n\n<p>Since <code>a</code> is never made to point to anything, the <code>*a</code> in the <code>printf</code> doesn't make any sense.</p>\n"}], "owner": {"reputation": 397, "user_id": 5942350, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/441bdfead4798589a2b34c78386b2533?s=128&d=identicon&r=PG&f=1", "display_name": "ZEWEI CHU", "link": "https://stackoverflow.com/users/5942350/zewei-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537083909, "creation_date": 1519861481, "question_id": 49040485, "link": "https://stackoverflow.com/questions/49040485/pointer-value-not-changing-together", "title": "pointer value not changing together?", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(){\n  int* a = NULL;\n  int* b = a;\n  b = (int*)malloc(sizeof(int));\n  *b = 10;\n  printf(\"%d, %d\", *a, *b);\n  return 0;\n}\n</code></pre>\n\n<p>With the code above, I found that although I change the value that b dereferences, the value that a dereferences does not change. Can someone explains why? I thought they should change together. </p>\n"}, {"tags": ["c", "unix", "system-calls"], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31, "user_id": 9426226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ud4TY.jpg?s=128&g=1", "display_name": "Sebastian Oliva", "link": "https://stackoverflow.com/users/9426226/sebastian-oliva"}, "edited": false, "score": 3, "creation_date": 1519861163, "post_id": 49040358, "comment_id": 85086192, "body": "@SebastianOliva <i>I&#39;ve been staring at this all day, I can&#39;t believe I didn&#39;t see that</i>  Welcome to programming.  If you continue, this will not be the last time you do that, I can assure you. Remember there are two kinds of programmers in the world:  those that have written buggy code, and liars.  ;-)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1519863124, "post_id": 49040358, "comment_id": 85086763, "body": "Maybe when you&#39;ve been programming as long as I have you&#39;ll stop making tpyos."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 9, "last_activity_date": 1519860615, "creation_date": 1519860615, "answer_id": 49040358, "question_id": 49040262, "link": "https://stackoverflow.com/questions/49040262/o-trunc-in-system-call-open-not-actually-deleting-contents-of-file/49040358#49040358", "title": "O_TRUNC in system call &quot;open()&quot; not actually deleting contents of file", "body": "<p><code>O_TRUNC || O_WRONLY</code> is a <em>logical</em> \"or\" and almost certainly results in a <code>int</code> value of 1, which is usually what <code>O_WRONLY</code> is defined to.  You want a <em>bitwise</em> \"or\" with the <code>|</code> operator.  Note that it's just one <code>|</code> character:</p>\n\n<pre><code>fp = open(\"file.txt\", O_TRUNC | O_WRONLY);\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9426226, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ud4TY.jpg?s=128&g=1", "display_name": "Sebastian Oliva", "link": "https://stackoverflow.com/users/9426226/sebastian-oliva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1697, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1537085853, "creation_date": 1519859838, "last_edit_date": 1537085853, "question_id": 49040262, "link": "https://stackoverflow.com/questions/49040262/o-trunc-in-system-call-open-not-actually-deleting-contents-of-file", "title": "O_TRUNC in system call &quot;open()&quot; not actually deleting contents of file", "body": "<p>From what I understand, the <code>O_TRUNC</code> specifier for the <code>open()</code> function should delete what's in the file first, then start writing.<br>\nInstead what it's doing is just having me overwrite what's in the file as I go.<br>\nMy issue is the file contains the ASCII '11', and what it should do is read that and overwrite it to '8', but the file ends up as '81' as it's not deleting the whole thing before writing.<br>\nThe goal of the code is to read the number in the file, decrement it by 3, then put that number back in the file, using only system calls.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nint main(int argc, char*argv[]){\n\n    int fp = open(\"file.txt\", O_RDONLY);\n    char c1, c2, c3='\\n';\n\n    read(fp, &amp;c1, 1);\n    read(fp, &amp;c2, 1);\n    close(fp);\n    fp = open(\"file.txt\", O_TRUNC || O_WRONLY);\n\n    if (c2 == '\\n')\n        c1 -= 3;\n    else {\n        if (c2 &gt;= '0' &amp;&amp; c2 &lt;= '2' ) {\n            c1--;\n            c2 += 7;\n        }\n        else\n            c2 -= 3;\n\n    }\n    if (c1 != '0')\n        write(fp,&amp;c1,1);\n    if (c2 != '\\n')\n        write(fp,&amp;c2,1);\n    write(fp,&amp;c3,1);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sockets", "pointers", "receiver"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519859909, "post_id": 49040259, "comment_id": 85085829, "body": "C or C++, pick one please. Answers will be provided accordingly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519859948, "post_id": 49040259, "comment_id": 85085848, "body": "You can&#39;t jam 1GB of data into a socket without waiting for the socket to be writable, you&#39;ll flood the transmit buffer and probably crash your program. You&#39;ll need to use <code>select</code> to wait for the socket to be writable before attempting to write more data. If you want to ensure the data was transmitted correctly before writing more you&#39;ll need the client to acknowledge it somehow over the TCP stream. Most stream-based protocols have some kind of <i>framing</i> to deal with this."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1519859961, "post_id": 49040259, "comment_id": 85085853, "body": "&quot;But then after that, I&#39;m receiving the response which is throwing an error after the 1st iteration.&quot; - well what is the error??????"}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519860255, "post_id": 49040259, "comment_id": 85085951, "body": "@tadman Yepp , so changed the program a bit to accommodate for message received completely . I&#39;m just getting unspecified errir &#39;exit code 13&#39;"}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519860362, "post_id": 49040259, "comment_id": 85085980, "body": "@tadman, but looks like I can jam the socket , by iterating over <code>send</code> in a loop . Only problem is when I use <code>recv</code> it errors out."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1519860420, "post_id": 49040259, "comment_id": 85085995, "body": "Both send() and receive() have a return value. It can be -1 or 0, or anything upto (and including) their 3rd arguments. and, thus:  <code>buffer[bytesRcvd] = &#39;\\0&#39;;</code> is wrong, and so is <code>send(client_sock, buffer, tinfo-&gt;bufferSize, 0);</code>"}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519861096, "post_id": 49040259, "comment_id": 85086174, "body": "<code>send()</code> and <code>recv()</code> have a buffer behind them that is like 64KB, you can&#39;t just send 1GB of data like that...  <code>send()</code> will return a number that tells you exactly how many bytes it managed to queue for sending in this buffer, if it&#39;s lower than the amount of bytes you tried to <code>send()</code> you have to manage that accordingly."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519861370, "post_id": 49040259, "comment_id": 85086254, "body": "@tadman You won&#39;t crash your program. You will <i>block.</i>"}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519861375, "post_id": 49040259, "comment_id": 85086259, "body": "@Havenard . Interesting, any pointer how to manage that . close connection , create new , and start from where left ?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519861733, "post_id": 49040259, "comment_id": 85086358, "body": "Why can you not just send 1GB of data &#39;just like that&#39;?  If all the data cannot be buffered immediately, (as is likely the case!), then send() willl block until it has all been sent."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519861847, "post_id": 49040259, "comment_id": 85086386, "body": "I cannot see anywhere that the socket is set to non-blocking mode, so I don&#39;t understand many of the above comments - all that stuff about crashing. select etc:("}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519861853, "post_id": 49040259, "comment_id": 85086388, "body": "Because I&#39;m asked to measure the time difference when chunk size is changed, 32byte, 8 Byte etc. :("}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1519862343, "post_id": 49040259, "comment_id": 85086552, "body": "What error are you getting? Use <code>perror()</code> so you see the reason why <code>recv()</code> failed."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519862349, "post_id": 49040259, "comment_id": 85086555, "body": "@MartinJames You are correct. It is all drivel. In blocking mode, <code>send()</code> will block until all the data has been transferred. It will not crash and it will not return a lesser count."}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519862668, "post_id": 49040259, "comment_id": 85086649, "body": "I&#39;m banging over my head for last 12 hours. If there is anything unclear please suggest , I&#39;ll edit the post . Please dont down vote (loosing points is ok, but I want an answer so that I can get up and grab something to eat :()"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1519863254, "post_id": 49040259, "comment_id": 85086796, "body": "You&#39;ve been told what&#39;s unclear, twice, and you&#39;ve ignored it, twice. You will never get an answer until you tell us what the error was. It&#39;s impossible."}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519864262, "post_id": 49040259, "comment_id": 85087022, "body": "/Users/diesel/Desktop/Assignments&amp;Coursework/553/netcli/cmak&zwnj;&#8203;e-build-debug/netcli 32 1 Signal: SIGPIPE (signal SIGPIPE) Terminated due to signal 13"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1519864331, "post_id": 49040259, "comment_id": 85087035, "body": "@sapy please post this details in the question, not in the already very long comment section, people are going to overlook this detail."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519865725, "post_id": 49040259, "comment_id": 85087381, "body": "@sapy That buffer is internal to the system, you have to use the APIs provided by <code>socket.h</code> to manage sockets. Pretty sure there are functions to fetch how much space is available in the buffer (and change it&#39;s size aswell), but typically you just <code>select()</code> with a <code>writeset</code> to learn if there&#39;s space left and try to <code>send()</code> and check the return value of <code>send()</code> to know how much fit in there."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519865850, "post_id": 49040259, "comment_id": 85087413, "body": "Notice <code>send()</code> is always non-blocking for that reason, it doesn&#39;t really send anything, it just queues the data for sending because you don&#39;t have direct access to the network device. The system kernel will take care of sending it when the device isn&#39;t busy."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519865940, "post_id": 49040259, "comment_id": 85087438, "body": "@Havenard You are spreading a lot of misinfomation about this. <code>send()</code> is not &#39;always non-blocking`. It will block until all data has been transferred or an error occurs. This is clearly stated in the documentation."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1519868888, "post_id": 49040259, "comment_id": 85088075, "body": "@EJP Sure, so if there&#39;s network latency <code>send()</code> will sit there for several seconds? This is unheard of. You would have to use multi-threading for almost everything. It is in fact double buffered, and I can even state that at least in Windows this buffer is 64KB by default (not sure about Linux)."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1519869108, "post_id": 49040259, "comment_id": 85088131, "body": "@EJP <code>send()</code> only blocks if you try to use it with the buffer full, not until stuff is transfered."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519870098, "post_id": 49040259, "comment_id": 85088391, "body": "@Havenard Blocks until all the data has been transferred into the buffer, just as it says in the documentation. If the buffer is full and there is latency, it will certainly block until there is room in the buffer. That could indeed take several seconds, or minutes, and it is not at all unheard of. NB &#39;Blocks&#39; and &#39;always non-blocking&#39; are irreconcilable, and you&#39;ve claimed them both. Make up your mind."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1519870339, "post_id": 49040259, "comment_id": 85088455, "body": "@EJP That&#39;s literally like saying everything is &#39;blocking&#39; and there&#39;s no such thing as non-blocking because technically nothing happens instantly even if it happens really fast. Who&#39;s spreading misinformation here exactly?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 1, "creation_date": 1519911592, "post_id": 49040259, "comment_id": 85106204, "body": "@Havenard &#39;You would have to use multi-threading for almost everything&#39; is that a problem?  You usually have two choices - multiple threads and blocking calls, or non-blocking async.  If you use send() in default blocking mode, there is no issue with calling send() with large buffers.  If you need to do other stuff while send() is blocked, then yes, you should use more than one thread.  It&#39;s not unusual, strange or exceptional in any way."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519935964, "post_id": 49040259, "comment_id": 85120963, "body": "@MartinJames Those aren&#39;t the only options, you can use <code>select()</code> to wait for events on all sockets you are handling, simultaneously, so for all intents and purposes you are multi-tasking, without multi-threading, and nothing is blocking even though no socket is set to non-blocking. This is a really good way to handle things. Modern kernels support epoll that work even faster because you don&#39;t have to fill buffers with lists of FDs all the time, something that can be significantly resource consuming when handling thousands of connections."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519936072, "post_id": 49040259, "comment_id": 85121018, "body": "@MartinJames Personally I think non-blocking sockets should be avoided at all costs, trying to read from a socket when it&#39;s not ready is like being that annoying kid on the back seat that asks &quot;Are we there yet?&quot; every minute. This is far from professional and surely the worst way of handling multiple connections when you take performance in consideration."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519936307, "post_id": 49040259, "comment_id": 85121143, "body": "@Havenard I&#39;ve seen &#39;non-blocking&#39; clients with select().  Most seem to ignore the blocking &#39;connect&#39; call at the start - a call that can take a while to complete:("}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 1, "creation_date": 1519936469, "post_id": 49040259, "comment_id": 85121226, "body": "@Havenard neither blocking sockets, nor non-blocking sockets with select(), require &#39;Are we there yet?&#39; polling."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519936632, "post_id": 49040259, "comment_id": 85121321, "body": "@MartinJames Of course, but if you use non-blocking sockets it&#39;s because you have the intention to call a <code>recv()</code> or <code>send()</code> when the socket isn&#39;t ready, otherwise you wouldn&#39;t bother with it. I do agree with the <code>connect()</code> though, it can be handy to set it to non-blocking in that particular case."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1519942214, "post_id": 49040259, "comment_id": 85123959, "body": "@Havenard More nonsense. Blocking mode sends block until all the data had been transferred. Try it before you debate this further. Saying so is not in the least &#39;literally like like saying that everything is blocking&#39;: and misrepresentation is not a valid form of argument."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1519967277, "post_id": 49040259, "comment_id": 85131379, "body": "@EJP As far as I know there is no version of blocking where it waits until data is sent through the network. Blocking is only between the application and the kernel buffers. If there&#39;s space in the buffer to fit new data (when writing) or if there&#39;s data in the buffer to read, the respective <code>send()</code> / <code>recv()</code> returns immediately. <code>send()</code> will only block if the send buffer is full, and <code>recv()</code> will only block if the receive buffer is empty."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1519967392, "post_id": 49040259, "comment_id": 85131409, "body": "@EJP A blocking <code>recv()</code> is indirectly waiting for a network event as obviously, when new data reaches the buffer it&#39;s because something came through, but it doesn&#39;t actually deal with networking directly, just as you are not required to have a <code>recv()</code> waiting for data at all times to be able to receive it."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1520548130, "post_id": 49040259, "comment_id": 85372955, "body": "@Havenard Nobody has claimed that there is a &#39;version of blocking where it waits until data has been sent through the network&#39; or that &#39;<code>recv()</code> deal[s] directly with network events&#39;. You are making this all up. We are discussing the behaviour of <code>send()</code> in blocking mode as defined by Posix. If you don&#39;t know what that is, look it up, but in any case stop these straw-man arguments."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1520550233, "post_id": 49040259, "comment_id": 85373761, "body": "@EJP I have experience rewriting the whole socket library to validate IO in closed source applications that have security vulnerabilities. I&#39;m pretty sure I know how the whole circus work."}], "answers": [{"comments": [{"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519865900, "post_id": 49040977, "comment_id": 85087431, "body": "How to send 1 GB of data over socket then?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519865989, "post_id": 49040977, "comment_id": 85087449, "body": "@sapy Just send it. That&#39;s not the problem. The problem is that the peer is closing its socket before receiving it all."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "edited": false, "score": 0, "creation_date": 1519912049, "post_id": 49040977, "comment_id": 85106501, "body": "@sapy wireshark it.  When the peer closes the connection, you will see it.  &#39;Debugging 101&#39; says that you should split up complex problems until the are in solvable chunks.  With a network issue, you  first thought should be to use wireshark, or similar to identify which peer is causing the problem, so splitting the system into &#39;working&#39; and &#39;not-working&#39; client/server halves.  If you don&#39;t do that, you may well end up in a black hole of fear, uncertainty and doubt:("}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1519865183, "creation_date": 1519865183, "answer_id": 49040977, "question_id": 49040259, "link": "https://stackoverflow.com/questions/49040259/socket-receive-cant-be-in-for-loop/49040977#49040977", "title": "Socket receive can&#39;t be in for loop", "body": "<p><code>Signal: SIGPIPE</code> occurs when you write to a connection that has already been closed by the peer.</p>\n\n<p>So, your peer has closed the connection.</p>\n\n<p>Solution: don't.</p>\n\n<p>Everything you've been told here about <code>send()</code> crashing the program or returning short counts in blocking mode is nonsense. Posix requires that it block until all the data is transferred or an error occurs, and this is exactly what is happening.</p>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1520547708, "post_id": 49182308, "comment_id": 85372768, "body": "What do you mean &#39;almost&#39;? And &#39;probably&#39;?"}, {"owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1520555387, "post_id": 49182308, "comment_id": 85375280, "body": "By almost I mean, Your answer never explicitly says, &quot;Send and receive is possible inside the loop&quot;. &quot;Probably &quot; because there are times when the server does not close connection, and you don&#39;t get any error."}], "tags": [], "owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "is_accepted": true, "score": 0, "last_activity_date": 1520558107, "last_edit_date": 1520558107, "creation_date": 1520542689, "answer_id": 49182308, "question_id": 49040259, "link": "https://stackoverflow.com/questions/49040259/socket-receive-cant-be-in-for-loop/49182308#49182308", "title": "Socket receive can&#39;t be in for loop", "body": "<p>1) @EJP's answer was almost correct but Let me rephrase it. \"Socket receive can be in for loop\", there is nothing wrong with it apart from it is inefficient and bad approach. And it you will probably get <code>SIGPIPE</code> error if Server closed connection while your loop is still active.</p>\n\n<p>The obvious possible solution is to keep <code>receive</code> outside the loop as you don't need confirmation if each chunk sent (In most of the cases.)</p>\n\n<p>2) It's ok to keep receive outside <code>for</code> is TCP is used, OS will take care if the chunks are sent in order and no chunks are lost. So even if we move <code>receive</code> outside the loop it's fine.</p>\n"}], "owner": {"reputation": 6555, "user_id": 1647320, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TRm67.jpg?s=128&g=1", "display_name": "sapy", "link": "https://stackoverflow.com/users/1647320/sapy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 49182308, "answer_count": 2, "score": -3, "last_activity_date": 1520558107, "creation_date": 1519859811, "last_edit_date": 1519866137, "question_id": 49040259, "link": "https://stackoverflow.com/questions/49040259/socket-receive-cant-be-in-for-loop", "title": "Socket receive can&#39;t be in for loop", "body": "<p>I want to send let's say 1GB data in 32 bits chunk so inside the for-loop I'm doing <code>send(client_sock, buffer, tinfo-&gt;bufferSize, 0);</code> Which is fine. But then after that, I'm receiving the response which is throwing an <code>error</code>(as below) after the 1st iteration. If I put the <code>recv</code> out side <code>for loop</code> then it works fine. But then I won't be able to ensure if each chunk is sent properly.</p>\n\n<p>My question is</p>\n\n<ol>\n<li>Why can't we iterate over <code>receive</code> when we can iterate over<br>\n<code>send</code>?   </li>\n<li>Is it ok to keep receive out of the <code>for</code> and don't worry\nabout if every message is sent?</li>\n</ol>\n\n<p>N.B. - Can't use external libraries, its a POC project for college. 'send 1 Gb of data in 32 bits chunk over socket'</p>\n\n<pre><code>void *tcpClient(void *arg) {\n    struct thread_info * tinfo = (struct thread_info *)arg;\n    char * buffer = (char *)malloc(sizeof(char)*(tinfo-&gt;bufferSize));\n    memset(buffer, 'a', sizeof(char)*(tinfo-&gt;bufferSize));\n\n    int client_sock = socket(AF_INET, SOCK_STREAM, 0);\n    connect(client_sock, (struct sockaddr *)&amp;(tinfo-&gt;server_addr), sizeof(struct sockaddr));\n\n    long noOfChunks = oneGb/ tinfo-&gt;bufferSize;\n    for (int j = 0; j &lt; noOfChunks; ++j) {\n        int totalBytesRcvd = 0;\n        int bytesRcvd = 0;\n        send(client_sock, buffer, tinfo-&gt;bufferSize, 0);\n        while (totalBytesRcvd &lt; tinfo-&gt;bufferSize)\n        {\n            if ((bytesRcvd = recv(client_sock, buffer, tinfo-&gt;bufferSize, 0)) &lt;= 0)\n                error(\"recv() failed or connection closed prematurely\");\n            totalBytesRcvd += bytesRcvd; /* Keep tally of total bytes */\n\n        }\n        printf(buffer); /* Print the echo buffer */\n    }\n\n    free(buffer);\n}\n</code></pre>\n\n<p>Error I'm getting:</p>\n\n<pre><code>Signal: SIGPIPE (signal SIGPIPE)\nTerminated due to signal 13\n</code></pre>\n"}, {"tags": ["c", "arrays", "file", "multidimensional-array", "io"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519859905, "post_id": 49040009, "comment_id": 85085827, "body": "I&#39;d use <code>fgets(filename, sizeof filename, stdin);</code> instead of harcoding the 99. If you later change your mind and change <code>filename</code> to <code>char filename[50];</code> and you forget to change the size in <code>fgets</code>, you could overflow the buffer."}, {"owner": {"reputation": 1, "user_id": 9426092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb503011af0b486796643d245d55c78?s=128&d=identicon&r=PG&f=1", "display_name": "LookHeed", "link": "https://stackoverflow.com/users/9426092/lookheed"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519864934, "post_id": 49040009, "comment_id": 85087204, "body": "@Pablo result is still 0"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9426092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb503011af0b486796643d245d55c78?s=128&d=identicon&r=PG&f=1", "display_name": "LookHeed", "link": "https://stackoverflow.com/users/9426092/lookheed"}, "edited": false, "score": 0, "creation_date": 1519861104, "post_id": 49040204, "comment_id": 85086176, "body": "did that the result is still 0"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1519864940, "post_id": 49040204, "comment_id": 85087205, "body": "The OP&#39;s problem is in <code>while ((c = getc(file)) != EOF)...</code>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1519859865, "last_edit_date": 1592644375, "creation_date": 1519859420, "answer_id": 49040204, "question_id": 49040009, "link": "https://stackoverflow.com/questions/49040009/reading-rows-and-columns-from-file-in-c/49040204#49040204", "title": "Reading Rows and Columns from File in C", "body": "<h3>Problem 1</h3>\n<pre><code>int rows = 0;\nint columns = 0;\nfloat matrix[rows][columns];\nfloat sumOfRows[rows];\n</code></pre>\n<p>is not right.</p>\n<p>After that, the number of elements in <code>matrix</code> and <code>sumOfRows</code> is fixed. They won't change if you change the values of <code>rows</code> and <code>columns</code> later in your program.</p>\n<p>You need to read the values of <code>rows</code> and <code>columns</code> first before you define <code>matrix</code> and <code>sumOfRows</code>.</p>\n<h2>Problem 2</h2>\n<pre><code>    fscanf(file, &quot;%d&quot;, &amp;matrix[rows][columns]);\n\n    printf(&quot;%f&quot;,matrix[rows][columns]);\n</code></pre>\n<p>are not right either. Given the defition of <code>matrix</code>, use of <code>matrix[rows][columns]</code> is not right. They access the array using out of bounds indices.\nRemember that given an array of size <code>N</code>, the valid indices are <code>0</code> to <code>N-1</code>.</p>\n<hr />\n<p>Here's one way to proceed to resolve your problems:</p>\n<pre><code>fscanf(file, &quot;%d&quot;, &amp;rows);     // Use %d, not %f\nfscanf(file, &quot;%d&quot;, &amp;columns);  // Use %d, not %f\n\n// Now define the arrays.\nfloat matrix[rows][columns];\nfloat sumOfRows[rows];\n\n// Read the data of matrix\nfor (int i = 0; i &lt; rows; ++i )\n{\n   for (int j = 0; j &lt; columns; ++j )\n   {\n      fscanf(file, &quot;%f&quot;, &amp;matrix[i][j]);  // Use %f, not %d\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9426092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb503011af0b486796643d245d55c78?s=128&d=identicon&r=PG&f=1", "display_name": "LookHeed", "link": "https://stackoverflow.com/users/9426092/lookheed"}, "edited": false, "score": 0, "creation_date": 1519868605, "post_id": 49040970, "comment_id": 85088014, "body": "thanks a lot, it is reading the file now...however, when I try to output what row and column are after reading them from the file, I get row:0 column 3..it should be 4 rows and 5 columns. Any insight on why I might be having that issue?"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 1, "user_id": 9426092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb503011af0b486796643d245d55c78?s=128&d=identicon&r=PG&f=1", "display_name": "LookHeed", "link": "https://stackoverflow.com/users/9426092/lookheed"}, "edited": false, "score": 0, "creation_date": 1519873626, "post_id": 49040970, "comment_id": 85089199, "body": "In your example, it&#39;s 4 rows and 5 columns. Please include a <i>correct</i> example."}], "tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1519865155, "creation_date": 1519865155, "answer_id": 49040970, "question_id": 49040009, "link": "https://stackoverflow.com/questions/49040009/reading-rows-and-columns-from-file-in-c/49040970#49040970", "title": "Reading Rows and Columns from File in C", "body": "<p>Your problem (actually, two problems) are in the <code>if (file) {...</code> block. First, you use a loop to read all characters from the file. Because of that, at the end of the loop you are also at the end of the file. Any further calls to <code>fscanf</code> result in undefined behavior.</p>\n\n<p>Second, if the file did not open, you print a message (to the wrong output) and still continue to the <code>fscanf</code> part, which <em>definitely</em> leads to undefined behavior.</p>\n\n<p>Solution: Remove the <code>while</code> loop and fix the error handling code:</p>\n\n<pre><code>if(file) {\n    // Nothing!\n} else {\n    perror(filename);\n    return 1; // or return EXIT_FAILURE;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9426092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb503011af0b486796643d245d55c78?s=128&d=identicon&r=PG&f=1", "display_name": "LookHeed", "link": "https://stackoverflow.com/users/9426092/lookheed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2699, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519865155, "creation_date": 1519858447, "last_edit_date": 1519861066, "question_id": 49040009, "link": "https://stackoverflow.com/questions/49040009/reading-rows-and-columns-from-file-in-c", "title": "Reading Rows and Columns from File in C", "body": "<p>I am trying to read this input txt file with my C code:</p>\n\n<pre><code>4 3\n1.4 4.6 1\n1.6 6.65 1\n7.8 1.45 0\n7 -2 2\n</code></pre>\n\n<p>and separate them into rows and columns so that I can sort. I tried doing that but I kept getting weird numbers. </p>\n\n<p>So I tried printing out the rows and columns after I read them from the file and the output was zero. I realized then that my code is not reading the numbers from my text file properly. I have tried different means to fix to no avail. Any help or pointers will be highly appreciated.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt; //for bool\n\nint main(){\n\n    setvbuf(stdout, NULL,_IONBF, 0);\n\nint c;\nFILE *file;\nFILE *infile;\nchar filename[99];\nchar choice;\nint rows, columns;\n\n\n//while(choice == 'y' || choice == 'Y'){\n    printf(\"%s\", \"Enter file name: \");\n    fgets(filename, 99, stdin);\n    char *p = strchr(filename, '\\n'); // p will point to the newline in filename\n    if(p) *p = 0; \n    file = fopen(filename, \"r\");\n\n    if (file) {\n        while ((c = getc(file)) != EOF)\n            putchar(c);\n        fclose(file);\n    }\n    else{\n        puts(\"FILE NOT FOUND\");\n    }\n\n    //read rows and columns from file\n    printf(\"%s\",\"\\n\");\n    fscanf(file, \"%d\", &amp;rows);\n    fscanf(file, \"%d\", &amp;columns);\n\n    printf(\"%d\", rows);\n    printf(\"%d\", columns);\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "volatile"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 2, "creation_date": 1519858430, "post_id": 49039977, "comment_id": 85085320, "body": "volatile means just that.  It tells the compiler that it can assume nothing about the location and that it must reload each time.  Useful for I/O mapped registers (for example) where the compiler has no idea on what is actually there."}, {"owner": {"reputation": 13, "user_id": 9425819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f050ffadd379526d8abc663b8a78a?s=128&d=identicon&r=PG&f=1", "display_name": "Jone", "link": "https://stackoverflow.com/users/9425819/jone"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1519858486, "post_id": 49039977, "comment_id": 85085354, "body": "But the cast should be unnecessary in my opinion"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1519858525, "post_id": 49039977, "comment_id": 85085369, "body": "The volatile on <code>var1</code> seems not needed.  Generally the pointer as volatile is enough for my example."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1519858602, "post_id": 49039977, "comment_id": 85085410, "body": "If worried, look at the assembly output.  It will tell all..."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1519858606, "post_id": 49039977, "comment_id": 85085413, "body": "You&#39;re mistaken about the declaration, though. You&#39;ve declared a variable var1 <i>on the stack</i>, and initialized it from 0x2000000. But subsequent reads of that variable will come from its stack address."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1519858708, "post_id": 49039977, "comment_id": 85085446, "body": "Curious if that <code>var1</code> on stack would reload the stack value each time instead of placing it into a register.  That would be interesting and not what seems intended from the original code where it seems they want the address lookup each time..."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9425819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f050ffadd379526d8abc663b8a78a?s=128&d=identicon&r=PG&f=1", "display_name": "Jone", "link": "https://stackoverflow.com/users/9425819/jone"}, "edited": false, "score": 1, "creation_date": 1519860228, "post_id": 49040213, "comment_id": 85085941, "body": "Ok I think I got it, you mean (and the others people commenting too) that the &quot;volatile char var1&quot; implies that I will read the value from the stack every time I read &quot;var1&quot;. The value cached is dropped. But the real value is stored only once on the stack, so the value fetched by &quot;var1&quot; is only valable once."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 13, "user_id": 9425819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f050ffadd379526d8abc663b8a78a?s=128&d=identicon&r=PG&f=1", "display_name": "Jone", "link": "https://stackoverflow.com/users/9425819/jone"}, "edited": false, "score": 0, "creation_date": 1519860692, "post_id": 49040213, "comment_id": 85086068, "body": "@Jone Not quite.   <code>volatile char var1 = 5; printf(&quot;%d \\n&quot;, var1)\u037e printf(&quot;%d \\n&quot;, var1)\u037e printf(&quot;%d \\n&quot;, var1)\u037e</code> would require code to read <code>var1</code> 3-times and not optimize code to do <code>printf(&quot;5\\n5\\n5\\n&quot;);</code>.  But this has nothing to do with volatile data pointed to by <code>(volatile char *) 0x2000000</code>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1519859504, "creation_date": 1519859504, "answer_id": 49040213, "question_id": 49039977, "link": "https://stackoverflow.com/questions/49039977/use-of-volatile-for-registers/49040213#49040213", "title": "Use of volatile for registers", "body": "<blockquote>\n  <p>but is the volatile cast of a fixed address necessary, (?)</p>\n</blockquote>\n\n<p>Yes, consider the below.  Compiler could reason <code>(char *) 0x2000000</code> was read once, no need to read again for <code>volatile char var2 = * (char *) 0x2000000\u037e</code>.  Just use the value that was read before and saved away in some internal memory/register.  Targets <code>var1/var2</code>, being <code>volatile</code>, do  not affect the right-hand-side of the assignment.</p>\n\n<pre><code>volatile char var1 = * (char *) 0x2000000\u037e\nprintf(\"%d \\n\", var1)\u037e\nvolatile char var2 = * (char *) 0x2000000\u037e\nprintf(\"%d \\n\", var2)\u037e\n</code></pre>\n\n<hr>\n\n<p>The <code>volatile</code> with <code>volatile char var1</code> is not needed.  Defining a pointer to <code>volatile</code> data is likely more in line with coding goals.</p>\n\n<pre><code>volatile char *ptr1 = (volatile char *) 0x2000000\u037e\nprintf(\"%d \\n\", *ptr1)\u037e\nprintf(\"%d \\n\", *ptr1)\u037e  // A 2nd read of `(volatile char *) 0x2000000` occurs.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1519870434, "last_edit_date": 1519870434, "creation_date": 1519863809, "answer_id": 49040812, "question_id": 49039977, "link": "https://stackoverflow.com/questions/49039977/use-of-volatile-for-registers/49040812#49040812", "title": "Use of volatile for registers", "body": "<p>As you have written it, <code>volatile char var1 = * (volatile char *) 0x2000000\u037e</code>, this says to create an object named <code>var1</code> (allocated at a place the C implementation chooses) and to initialize it to a value read from 0x2000000. Every time <code>var1</code> is read, the copied value will be read from the place the implementation allocated. It will not be reread from 0x2000000.</p>\n\n<p>You may want <code>volatile char *var1 = (volatile char *) 0x2000000;</code>. This defines <code>var1</code> to be a pointer to 0x2000000. With this definition, every time <code>*var1</code> is used, the value will be read from 0x2000000.</p>\n"}], "owner": {"reputation": 13, "user_id": 9425819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497f050ffadd379526d8abc663b8a78a?s=128&d=identicon&r=PG&f=1", "display_name": "Jone", "link": "https://stackoverflow.com/users/9425819/jone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 1, "accepted_answer_id": 49040213, "answer_count": 2, "score": 1, "last_activity_date": 1519870434, "creation_date": 1519858242, "question_id": 49039977, "link": "https://stackoverflow.com/questions/49039977/use-of-volatile-for-registers", "title": "Use of volatile for registers", "body": "<p>I am wondering how efficient / is working the volatile declaration. In the following code:</p>\n\n<pre><code>volatile char var1 = * (volatile char *) 0x2000000\u037e\nprintf(\"%d \\n\", var1 + 1)\u037e\n</code></pre>\n\n<p>It means that every time I am using the variable \"var\", it will be loaded from the address memory 0x2000000, but is the volatile cast of a fixed address necessary, or is it only to fit the type of var1?</p>\n\n<p>Does this means that every time \"var1\" is read, it is read from memory, and not from a potential cached value? So in this code, we access two times the address 0x2000000?</p>\n"}, {"tags": ["c", "loops", "scanf"], "comments": [{"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 1, "creation_date": 1519858459, "post_id": 49039968, "comment_id": 85085338, "body": "where is the definition for <code>string_compare()</code>?"}, {"owner": {"reputation": 65, "user_id": 9182083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fda9275a4dae2772d59c1f4d34171dc?s=128&d=identicon&r=PG&f=1", "display_name": "dud3", "link": "https://stackoverflow.com/users/9182083/dud3"}, "reply_to_user": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1519858502, "post_id": 49039968, "comment_id": 85085360, "body": "Here is my string-compare method  int string_compare(char str1[], char str2[]) {     int ctr=strlen(str1);     int ctr2=strlen(str2); \tint counter=0;     if(strlen(str1)!=strlen(str2) ){     \treturn -1;     }     else{     for (int i = 0; i &lt; strlen(str1); ++i)     {     \tif(str1[i]==str2[i]){     \t\tcounter++;     \t}     }     if(counter==strlen(str1)){     \treturn 0;     }     else{     \treturn -1;     } } }"}, {"owner": {"reputation": 65, "user_id": 9182083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fda9275a4dae2772d59c1f4d34171dc?s=128&d=identicon&r=PG&f=1", "display_name": "dud3", "link": "https://stackoverflow.com/users/9182083/dud3"}, "reply_to_user": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1519858614, "post_id": 49039968, "comment_id": 85085416, "body": "oh sorry for this mess. My first question here :("}, {"owner": {"reputation": 2132, "user_id": 7089239, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/390a878ef8da2514a56dd703a896afe5?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/7089239/felix"}, "edited": false, "score": 0, "creation_date": 1519858645, "post_id": 49039968, "comment_id": 85085425, "body": "@dud3 Just edit the question to add the method"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1519858655, "post_id": 49039968, "comment_id": 85085430, "body": "No worries, don&#39;t post the code in a comment, it is unreadable, edit your question and post it there"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1519858828, "post_id": 49039968, "comment_id": 85085481, "body": "Hmmm, should you be passing in <code>newString[0]</code> to see if it is <code>QUIT</code> or <code>newString[ctr - 1]</code>?  In your input, is <code>QUIT</code> the last word entered or the first?  I&#39;m thinking last, as in <code>MRCT DISP QUIT</code>?"}, {"owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "edited": false, "score": 0, "creation_date": 1519859163, "post_id": 49039968, "comment_id": 85085599, "body": "In fact, the code in the while loop will only ever process the first word in the input, over and over"}, {"owner": {"reputation": 65, "user_id": 9182083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fda9275a4dae2772d59c1f4d34171dc?s=128&d=identicon&r=PG&f=1", "display_name": "dud3", "link": "https://stackoverflow.com/users/9182083/dud3"}, "edited": false, "score": 0, "creation_date": 1519859257, "post_id": 49039968, "comment_id": 85085627, "body": "Edited. By the way someone told me that i should use gets method. It worked. newString contains user input for example, if user enters MRCT 5, i have MRCT at newString[0] and 5 at newString[1]."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519860975, "post_id": 49039968, "comment_id": 85086140, "body": "@dud3 &quot;By the way someone told me that i should use gets method.&quot;  Using <code>gets()</code> is a <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">terrible choice</a> - and a hint to the quality of that advise.  Use <code>fgets()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519860119, "post_id": 49040144, "comment_id": 85085905, "body": "<code>&quot;%[^\\n]\\n&quot;</code> fails to read anything if the line begins with a <code>&quot;\\n&quot;</code>.  Otherwise <code>&quot;%[^\\n]\\n&quot;</code> will consume a <i>line</i> and all following white-space and blocks until following non-white-space detected.  Would not pass a code review.  Use <code>fgets()</code> to read a line."}], "tags": [], "owner": {"reputation": 142, "user_id": 4502212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fgbH3.jpg?s=128&g=1", "display_name": "Ebram Shehata", "link": "https://stackoverflow.com/users/4502212/ebram-shehata"}, "is_accepted": true, "score": -1, "last_activity_date": 1519859156, "creation_date": 1519859156, "answer_id": 49040144, "question_id": 49039968, "link": "https://stackoverflow.com/questions/49039968/scanf-method-does-not-working-in-while-loop/49040144#49040144", "title": "scanf() method does not working in while loop?", "body": "<p>Use: <code>scanf(\"%[^\\n]\\n\" , str1);</code> to get a line using <code>scanf</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 233613, "user_id": 14065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e1475012bb1630271c9165899bccd548?s=128&d=identicon&r=PG", "display_name": "Martin York", "link": "https://stackoverflow.com/users/14065/martin-york"}, "is_accepted": false, "score": 1, "last_activity_date": 1519861200, "last_edit_date": 1519861200, "creation_date": 1519859184, "answer_id": 49040149, "question_id": 49039968, "link": "https://stackoverflow.com/questions/49039968/scanf-method-does-not-working-in-while-loop/49040149#49040149", "title": "scanf() method does not working in while loop?", "body": "<p>The <code>scanf()</code> stops scanning after the first failure.</p>\n\n<p>So here:</p>\n\n<pre><code>scanf(\"%10[0-9a-zA-Z ]s\\n\",str1);\n</code></pre>\n\n<p>The scan tries to interpret three things:</p>\n\n<ul>\n<li>A string <code>%[]</code> into a variable <code>str1</code></li>\n<li>the character <code>s</code></li>\n<li>The character '\\n' which will result in a sequence of white space characters being read from the input.</li>\n</ul>\n\n<p>Note if the string is zero length it will fail at the string and not interpret the <code>s</code> or the <code>\\n</code> character.</p>\n\n<p>One: I suspect that <code>s</code> is an error and you don't want it.</p>\n\n<p>Two: Don't use <code>\"%[^\\n]\\n\"</code> to read a line. As this fails if the line is empty (just has the <code>\\n</code> character).</p>\n\n<pre><code>if (scanf(\"%10[0-9a-zA-Z ]\", str1) == 1)\n{\n    // Always check that the value was read.\n    // Then deal with it.\n    ....\n}\nscanf(\"%*[^\\n]\"); // Ignore any remaining character above 10.\n                  // Note this may still fail so don't add \\n on the end\n                  // Deal with end of line separately.\n\nchar c;\nif (scanf(\"%c\", &amp;c) == 1 &amp;&amp; c == '\\n')  // Now read the end of line character.\n{\n    // End of line correctly read.\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9182083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fda9275a4dae2772d59c1f4d34171dc?s=128&d=identicon&r=PG&f=1", "display_name": "dud3", "link": "https://stackoverflow.com/users/9182083/dud3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 49040144, "answer_count": 2, "score": -1, "last_activity_date": 1537165314, "creation_date": 1519858188, "last_edit_date": 1537165314, "question_id": 49039968, "link": "https://stackoverflow.com/questions/49039968/scanf-method-does-not-working-in-while-loop", "title": "scanf() method does not working in while loop?", "body": "<p>I've been out of this loop for 5 hours. My scanf method does not work.<br>\nHere is my loop.<br>\nI could not execute library's strcmp so I wrote myself.</p>\n\n<pre><code>int string_compare(char str1[], char str2[])//Compare method\n{    \n    int ctr=strlen(str1);\n    int ctr2=strlen(str2);\n    int counter=0;\n    if(strlen(str1)!=strlen(str2) ){//if their lengths not equal -1     \n        return -1;\n    } else\n    {\n        for (int i = 0; i &lt; strlen(str1); ++i)\n        {\n            if(str1[i]==str2[i]){ //looking for their chars\n                counter++;\n            }\n        }\n\n        if(counter==strlen(str1)){  \n            return 0;\n        } else\n        {\n            return -1;\n        }\n    }\n}\n\nchar str1[100]; //for users command\nchar newString[10][10]; //after spliting command i have\n\nwhile(string_compare(newString[0],\"QUIT\") != 0){\n    printf(\"Enter Commands For Execution\\n\");\n    scanf(\"%10[0-9a-zA-Z ]s\\n\",str1);\n    int i,j,ctr;\n    j=0; ctr=0;\n    for(i=0;i&lt;=(strlen(str1));i++)\n    {\n        // if space or NULL found, assign NULL into newString[ctr]\n        if(str1[i]==' '||str1[i]=='\\0')\n        {\n            newString[ctr][j]='\\0';\n            ctr++;  //for next word\n            j=0;    //for next word, init index to 0\n        } else\n        {\n            newString[ctr][j]=str1[i];\n            j++;\n        }\n    }\n\n    if(string_compare(newString[0],\"QUIT\") == 0){\n        printf(\"Quitting\\n\");\n        break;\n    }\n\n    if(string_compare(newString[0],\"MRCT\") == 0){\n        printf(\"hey\\n\");\n    }\n    if(string_compare(newString[0],\"DISP\") == 0){\n        printf(\"hey2\\n\");\n    }\n}\n</code></pre>\n\n<p>When I execute my c file,<br>\nthe loop asks me to enter command such as \"MRCT\".</p>\n\n<p>It forever prints </p>\n\n<pre><code>Enter Command\nhey\nEnter Command\nhey\n</code></pre>\n\n<p>My way of using <code>scanf()</code> does not work here.</p>\n"}, {"tags": ["c", "linux", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 6021, "user_id": 206404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/497437666710e8b13ee168bd7b62fcba?s=128&d=identicon&r=PG", "display_name": "Stephen Newell", "link": "https://stackoverflow.com/users/206404/stephen-newell"}, "edited": false, "score": 1, "creation_date": 1519858473, "post_id": 49039940, "comment_id": 85085344, "body": "Have you used gdb to figure out where your factory thread is hanging?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519858518, "post_id": 49039940, "comment_id": 85085366, "body": "I suspect your suspicion is correct. Do these threads share data? Seeing <code>bbuff_blocking_insert</code> and <code>stats_record_produced</code> would probably be helpful."}, {"owner": {"reputation": 52, "user_id": 6934657, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00c3cb703d278d660187817e5a6c697?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B", "link": "https://stackoverflow.com/users/6934657/alex-b"}, "edited": false, "score": 0, "creation_date": 1519859966, "post_id": 49039940, "comment_id": 85085857, "body": "I think it hangs because the bbuff_blocking_insert() has to wait for a semaphore, however at this point i am finished using the buffer and I want to stop all the threads. If I switch to pthread_cancel from pthread_join() it seems to stop hanging. Would this be a bad practice ?"}, {"owner": {"reputation": 321, "user_id": 6672509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8afc79ec49a7b5c692734aabd97d834?s=128&d=identicon&r=PG&f=1", "display_name": "user1048576", "link": "https://stackoverflow.com/users/6672509/user1048576"}, "edited": false, "score": 1, "creation_date": 1519861372, "post_id": 49039940, "comment_id": 85086256, "body": "When I add debug-printouts I always use:     fprintf(stderr, &quot;Candy factory %d stopped!\\n&quot;,i); instead of:     printf(&quot;Candy factory %d stopped!\\n&quot;,i); Things might get buffered. However I cannot see if that is your proble, since the entire code is not here. It is probably not the issue here, but it is a good practce to print to stderr which is normally not buffered."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519878979, "post_id": 49039940, "comment_id": 85090455, "body": "I would consider using <code>pthread_cancel</code> an extreme choice. As I&#39;m sure you&#39;ve read, that abruptly ends the thread without cleanup... surely there&#39;s a way to gracefully exit."}], "owner": {"reputation": 52, "user_id": 6934657, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00c3cb703d278d660187817e5a6c697?s=128&d=identicon&r=PG&f=1", "display_name": "Alex B", "link": "https://stackoverflow.com/users/6934657/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 865, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520108666, "creation_date": 1519858041, "last_edit_date": 1520108666, "question_id": 49039940, "link": "https://stackoverflow.com/questions/49039940/program-getting-stuck-during-pthread-join", "title": "program getting stuck during pthread_join()", "body": "<p>I am currently running this loop to close all my of \"factory\" threads however the execution doesn't reach the print statement following the <code>pthread_join()</code>. My understanding is that if the thread is already terminated then the <code>pthread_join()</code> will return instantly. I suspect the factory_thread is hanging </p>\n\n<pre><code> stop_thread_factories = true;\n\n for(int i=0; i&lt;factories; i++) {\n    printf(\"stopping Candy factory %d\\n\",i); \n    pthread_join(*factoryThreads[i], NULL);\n    printf(\"Candy factory %d stopped!\\n\",i);\n    //unction waits for the thread specified by thread to terminate. \n}\n</code></pre>\n\n<p>This is the factory thread function and I've added print statements to see where it gets stuck.</p>\n\n<pre><code>void* factory_thread(void* arg){\n\nint i = (intptr_t)arg;\n\nint wait_time;\nwhile(stop_thread_factories == false){\n\n    wait_time = rand()%4;   //wait times will be from 0 to 3\n    printf(\"\\tFactory %d ships candy &amp; waits %ds\\n\", i, wait_time);\n\n    //following steps in the outline in the assignment\n\n    candy_t* newCandy = malloc(sizeof(candy_t));\n    newCandy-&gt;time_stamp_in_ms = current_time_in_ms();\n    newCandy-&gt;factory_number = i;\n    printf(\"about to insert\\n\");\n    bbuff_blocking_insert(newCandy);\n    printf(\"done inserting\\n\");\n    stats_record_produced(i);\n    sleep(wait_time);\n}\n\nprintf(\"Candy-factory %d done\\n\", i);\n\npthread_exit(NULL);\n\nprintf(\"Just finished the exit call\\n\");\n\nreturn NULL;\n</code></pre>\n\n<p>}</p>\n\n<p>However this is the output I am left with and the program hangs on the next line. Any advice or tips would be greatly appreciated! This for a school assignment by the way.</p>\n\n<pre><code>stopping Candy factory 0\nCandy-factory 0 done\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1054, "user_id": 6106641, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/652b9195ab2ad7effd41fd7410661c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Archmede", "link": "https://stackoverflow.com/users/6106641/archmede"}, "edited": false, "score": 0, "creation_date": 1519857533, "post_id": 49039779, "comment_id": 85084927, "body": "<a href=\"https://en.wikibooks.org/wiki/C%2B%2B_Programming/Code/Standard_C_Library/Functions/scanf\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/C%2B%2B_Programming/Code/&hellip;</a>"}, {"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 1, "creation_date": 1519857585, "post_id": 49039779, "comment_id": 85084952, "body": "you are scanning the input into an &quot;int&quot;, that means it has memory assigned for an int and only an int. You can&#39;t scan a float into it. You should scan into a float and then convert it as you wish."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519857850, "post_id": 49039779, "comment_id": 85085079, "body": "&quot; if the user inputs 2.2 I would like the program to call it 2&quot; --&gt; What if <code>&quot;.2&quot;</code> is entered, what should code do?"}, {"owner": {"reputation": 189, "user_id": 6486215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYAdm.png?s=128&g=1", "display_name": "ACH", "link": "https://stackoverflow.com/users/6486215/ach"}, "edited": false, "score": 0, "creation_date": 1519858118, "post_id": 49039779, "comment_id": 85085180, "body": "Good question. I hadn&#39;t thought about that. I guess for my purposes I can assume that won&#39;t be an issue. My task: Write a Program that reads in 2 integers and then outputs their sum, product, remainder and average. I was just expecting my professor to test it out with a non-integer to see if we had thought about it. It&#39;s my first assignment in my first programming class. Thanks for the response."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519858969, "post_id": 49039779, "comment_id": 85085521, "body": "@ACH If possible, avoid <code>scanf()</code> and use <code>fgets()</code> to read a <i>line</i> of user input into a <i>string</i>.  In this case, code can then parse the string multiple times   as an <code>int</code>, <code>float</code> or whatever."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1537167934, "post_id": 49039779, "comment_id": 91668925, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1537168122, "post_id": 49039779, "comment_id": 91669001, "body": "Try <code>if (scanf(...) != &lt;expected_value&gt;) {fprintf(stderr, &quot;Error: bad input\\n&quot;); exit(EXIT_FAILURE);}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 5, "last_activity_date": 1537167990, "last_edit_date": 1537167990, "creation_date": 1519857650, "answer_id": 49039848, "question_id": 49039779, "link": "https://stackoverflow.com/questions/49039779/why-does-my-program-skip-to-completion-if-a-float-is-entered-first-but-works-wi/49039848#49039848", "title": "Why does my program skip to completion if a float is entered first, but works with integers?", "body": "<p>Because the first <code>scanf()</code> successfully reads the whole number part of the float as an integer and then the second <code>scanf()</code> tries to read another integer but fails because it runs into the decimal point.  The thing to realize is that <a href=\"https://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> for an integer will stop reading when it hits an non-numerical character, and that it will leave that character in the input stream.</p>\n"}], "owner": {"reputation": 189, "user_id": 6486215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yYAdm.png?s=128&g=1", "display_name": "ACH", "link": "https://stackoverflow.com/users/6486215/ach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49039848, "answer_count": 1, "score": 2, "last_activity_date": 1537167990, "creation_date": 1519857350, "last_edit_date": 1537167837, "question_id": 49039779, "link": "https://stackoverflow.com/questions/49039779/why-does-my-program-skip-to-completion-if-a-float-is-entered-first-but-works-wi", "title": "Why does my program skip to completion if a float is entered first, but works with integers?", "body": "<p>The problem I occurs when I input any float as the first number. Everything else just goes to completion, but the output looks like a stored memory address perhaps?<br>\nIf I use any integer the program works properly. I would like for the program to convert any numerical input from the user into integers.<br>\nWhile I explicitly ask for an integer input, if the user inputs 2.2 I would like the program to call it 2, and then move onto asking for their second input.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    // creating two variables\n    int firstNumber;\n    int secondNumber;\n\n    //asking user to input a number\n    printf(\"Enter your first integer value: \");\n    scanf(\"%d\", &amp;firstNumber);\n    printf(\"\\nThe integer value you entered is %d.\\n\", firstNumber);\n\n    //asking user to enter another number\n    printf(\"\\nEnter your second integer value: \");\n    scanf(\"%d\", &amp;secondNumber);\n    printf(\"\\nThe second integer value you entered is %d.\\n\", secondNumber);\n\n    /* system(\"pause\"); */\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1519855179, "post_id": 49039282, "comment_id": 85083932, "body": "Could you possibly explain the format(s) you are attempting to recognize with that code?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1519855289, "post_id": 49039282, "comment_id": 85083978, "body": "<code>while (q != NULL)</code> then <code>if (q != NULL) break;</code> ?? Suggests <code>char *q = strtok (p, &quot;:&quot;);</code> fails, but since you never check that <code>char *p = strtok (buf, &quot;@&quot;);</code> succeeds, it&#39;s hard to tell."}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1519855435, "post_id": 49039282, "comment_id": 85084044, "body": "@rici Basically it&#39;s a ten digit number followed by @ followed by an IP address (could be ipv4 could be ipv6, really doesn&#39;t matter, anything after the @ is not required.)"}, {"owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519855579, "post_id": 49039282, "comment_id": 85084111, "body": "@DavidC.Rankin Removing the while loop and it still returns NULL. if <code>char *p = strtok (buf, &quot;@&quot;);</code> doesn&#39;t succeed, it should just return the full string, no? I was hoping this would handle the case of there being just a number or a number@address."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519855718, "post_id": 49039282, "comment_id": 85084170, "body": "so basicaly you want everything up to the @ is that correct?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1519855798, "post_id": 49039282, "comment_id": 85084207, "body": "Where do the colons come in, then?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519855995, "post_id": 49039282, "comment_id": 85084305, "body": "You&#39;ve edited your post and removed the &quot;interesting&quot; bits, now you question makes no sense with your new code. Because you also have an error in the way you free the memory, I updated my answer to address that."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1519856027, "post_id": 49039282, "comment_id": 85084322, "body": "SAMPLE INPUT and EXPECTED OUTPUT in the question NOT COMMENTS - please"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1519856134, "post_id": 49039282, "comment_id": 85084361, "body": "The returned pointer <code>q</code> comes from the <code>free</code>d <code>buf</code> which is bad."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519856171, "post_id": 49039282, "comment_id": 85084377, "body": "@DavidC.Rankin unless <code>p</code> is <code>NULL</code>, the <code>strtok(p,...)</code> call shouldn&#39;t return <code>NULL</code>, if there are no delimiters in the string, <code>strtok</code> returns <code>p</code>."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1519856425, "post_id": 49039282, "comment_id": 85084472, "body": "Did you know that: <code>strtok</code> is <a href=\"https://www.freebsd.org/cgi/man.cgi?query=strtok&amp;sektion=3&amp;apropos=0&amp;manpath=freebsd#DESCRIPTION\" rel=\"nofollow noreferrer\">considered obsolete</a> by FreeBSD.  Microsoft states that the function poses a <a href=\"https://msdn.microsoft.com/en-us/library/2c8d19sb.aspx#Remarks\" rel=\"nofollow noreferrer\">security risk</a>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1519857191, "post_id": 49039282, "comment_id": 85084790, "body": "Yes, WV points out your main problem: even if GetPhoneNumber <i>did</i> parse things correctly, it returns a pointer to freed memory. This is C: you can&#39;t make a function that returns a string, because C doesn&#39;t really have a string type. You need to have the caller either allocate space and pass it in, or else have the caller free it when it&#39;s done."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 3, "last_activity_date": 1519860606, "last_edit_date": 1519860606, "creation_date": 1519855737, "answer_id": 49039431, "question_id": 49039282, "link": "https://stackoverflow.com/questions/49039282/splitting-a-string-to-remove-everything-after-a-delimiter/49039431#49039431", "title": "Splitting a string to remove everything after a delimiter", "body": "<p><strong>edit</strong></p>\n\n<p>This</p>\n\n<blockquote>\n  <p>If it's returning <code>NULL</code> because the <code>while</code> loops ends when <code>q</code> is <code>NULL</code>. So I\n  assume that the <code>q = strtok (NULL, \":\");</code> also returns <code>NULL</code> and that's why it\n  leaves the loop.</p>\n</blockquote>\n\n<p>makes no sense anymore, since you've edited your question and removed the code\nin question.</p>\n\n<p><strong>end edit</strong></p>\n\n<p>Regardless, you are using it wrong, though.</p>\n\n<p><code>strtok</code> returns a pointer to the original string plus an offset that marks the\nbeginning of the next token. The pointer is at an offset of <code>buf</code>. So when you\ndo <code>free(buf)</code>, you are making the pointers returned by <code>strtok</code> also invalid.</p>\n\n<p>You should also check <strong>first</strong> if <code>malloc</code> returns <code>NULL</code> and then try to parse\nit. Checking of <code>malloc</code> returning <code>NULL</code> after the parsing is wrong. Also you\nwould need to make a copy of the value you are returning.</p>\n\n<pre><code>char* GetPhoneNumber(const char* sCallee) {\n    char* buf = malloc(strlen(sCallee) + 1);\n    if(buf == NULL)\n        return NULL;\n\n    strcpy(buf, sCallee);\n\n    char *p = strtok (buf, \"@\");\n    if(p == NULL)\n    {\n        // no token found\n        free(buf);\n        return NULL;\n    }\n\n    char *q = strtok (p, \":\"); // makes no sense after your edit\n                               // I don't see any colons in your input\n                               // but I leave this to show you how\n                               // it would be done if colons were present\n\n    if(q == NULL)\n    {\n        // no token found\n        free(buf);\n        return NULL;\n    }\n\n    char *copy = malloc(strlen(q) + 1);\n    if(copy == NULL)\n    {\n        free(buf);\n        return NULL;\n    }\n\n    strcpy(copy, q);\n    free(buf);\n\n    return copy;\n}\n</code></pre>\n\n<p>Also when you call this function, you have to remember to free the pointer\nreturned by <code>GetPhoneNumber</code>.</p>\n\n<p><strong>edit2</strong></p>\n\n<p>To be honest, I don't see why you even use <code>strtok</code> if the number comes before\n<code>@</code>. You can use <code>strchr</code> instead:</p>\n\n<pre><code>char* GetPhoneNumber(const char* sCallee) {\n\n    if(sCallee == NULL)\n        return NULL;\n\n    char *p = strchr(sCallee, '@');\n\n    if(p == NULL)\n        return NULL; // wrong format\n\n    char *q = calloc(1, p - sCallee + 1);\n\n    if(q == NULL)\n        return NULL;\n\n    strncpy(q, sCallee, p - sCallee);\n\n    // q already \\0-terminated because of calloc\n\n    return q;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519856300, "post_id": 49039520, "comment_id": 85084430, "body": "I don&#39;t like your frees in the main. If the pointer you return were the second token, you were freeing a pointer that malloc didn&#39;t return, but an offset of it. I know that in this example, you are returning the first token anyway, but it would be better if you return a <code>malloc</code> copy anyway."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519856367, "post_id": 49039520, "comment_id": 85084451, "body": "You allocate for both <code>number</code> and <code>second</code> in <code>GetPhoneNumber</code>. There is no other way to do it. You cannot return a pointer from <code>GetPhoneNumber</code> to memory that has been freed -- UB. (recall <code>q</code> points to memory in <code>buf</code> allocated at the beginning of <code>GetPhoneNumber</code>, if you free there, you have nothing to return)."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519856571, "post_id": 49039520, "comment_id": 85084529, "body": "No, I&#39;m talking about <code>char *q = strtok (p, &quot;:&quot;);</code>. Here in this case <code>q</code> will be the same as <code>buf</code>, but let&#39;s say the number <code>p</code> were <code>&quot;abc:1234</code>&quot; and you do <code>strtok(p, &quot;:&quot;); q = strtok(NULL, &quot;:&quot;);</code> then <code>q</code> will be at an offset of <code>buf</code> and <code>free(q)</code> would be UB. That&#39;s way I said, it would be better to return a <code>strdup&#47;malloc</code> copy of <code>q</code> instead."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519856799, "post_id": 49039520, "comment_id": 85084618, "body": "It can&#39;t be <code>char *q = strtok (NULL, &quot;:&quot;);</code> or you will be searching in the region of <code>p</code> after the <code>@</code> symbol. You want to search within the token returned by <code>p</code>. (I&#39;ll wager my 1 malloc against your 2 <code>:)</code>"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519857104, "post_id": 49039520, "comment_id": 85084757, "body": "I think you don&#39;t get what I mean. In this example <code>q</code> will be equals to <code>buf</code>, so no problem there. But consider a different example: <code>&quot;Tina:1151551551@192.168.0.1&quot;</code> as an input string. <code>p</code> would point to <code>buff</code> after <code>p = strtok(buf, &quot;@&quot;);</code> and would be the string <code>&quot;Tina:1151551551</code>&quot;. To get to the number, you would have to do <code>strtok(p, &quot;:&quot;); q = strtok(NULL, &quot;:&quot;);</code> and now <code>q</code> points to <code>buf+5</code>. If you return <code>q</code> and the caller does <code>free(result_from_GetPhoneNumber);</code>, then it&#39;s doing <code>free(buf+5)</code> which is UB."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519857264, "post_id": 49039520, "comment_id": 85084821, "body": "@Pablo - I see what you mean, but if you only call <code>char *p = strtok (buf, &quot;@&quot;);</code> once and <code>char *q = strtok (p, &quot;:&quot;);</code> once, you will always be pointing at the beginning of the block allocated for <code>buf</code>. (if you call it any more than once -- then you have to copy as you did) I can always invent data that requires a second call, but I can only go by the data given."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1519857381, "post_id": 49039520, "comment_id": 85084868, "body": "@DavidC.Rankin: Not if the buffer starts with one or more colons (or at-signs). &quot;The start of the next token is determined by scanning forward for the next nondelimiter byte in str.&quot;"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519857597, "post_id": 49039520, "comment_id": 85084957, "body": "Wait, wait, wait... <code>p</code> scans for <code>@</code>. You don&#39;t care how many colons there are. <code>q</code> scans for the <b>first</b> token delimited by a <code>&#39;:&#39;</code> -- again, you don&#39;t care how many there are. If we invent a new Question saying I want the token <b>after</b> the first <code>&#39;:&#39;</code>, then of course you have to call <code>strtok</code> twice and in that case you need to alloc/copy before return because <code>q</code> would no longer point to the <b>beginning</b> of the allocation -- but that isn&#39;t the Question asked."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1519857615, "post_id": 49039520, "comment_id": 85084971, "body": "@DavidC.Rankin that&#39;s why I said that in this example it&#39;s fine, because <code>q</code> happens to point to the same location as <code>buf</code>. If the OP uses this code and then tries an input like I did, then the OP will get an error and probably wouldn&#39;t know why. That&#39;s why I said, in interest of correctness, it would be better to return a <code>malloced</code> copy, <b>even</b> if in this particular example you wouldn&#39;t need it."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519857648, "post_id": 49039520, "comment_id": 85084989, "body": "Yes, in that case I totally agree with you."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519857812, "post_id": 49039520, "comment_id": 85085063, "body": "@DavidC.Rankin I didn&#39;t reinvent the question, the OP had code where he/she actively parsed for colons, later changed the code and remove that part. That&#39;s why I assume that the real string the OP might be parsing may look in reality like the one &quot;I invented&quot;."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1519858354, "post_id": 49039520, "comment_id": 85085286, "body": "@DavidC.Rankin: I repeat: on the first call, strtok will return the address of the first character in the buffer which is not in the delimiter set. So if <code>p = strtok(buf, &quot;@&quot;)</code> does not return <code>buf</code> if the first character of <code>buf</code> is an <code>&#39;@&#39;</code>. Subsequently, <code>q = strtok(p, &quot;:&quot;)</code> will not return <code>p</code> if the first character of <code>p</code> is a colon. Consequently, if <code>buf</code> starts with one or more at-signs or colons, <code>q</code> will not be <code>buf</code> and <code>free(q)</code> will be UB."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519858599, "post_id": 49039520, "comment_id": 85085406, "body": "That is a case that I did not protect against. It could well occur. So in that case you are correct. I will note that."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519860938, "post_id": 49039520, "comment_id": 85086131, "body": "I&#39;m sorry, don&#39;t want to be peaky, but I think your check is also not 100% right, it would fail if you have more than one leading colon. It think it&#39;s best not to check <code>*p == &#39;:&#39;</code> but rather <code>char *q = strtok(p, &quot;:&quot;); if(q == NULL) { ... };</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519862578, "post_id": 49039520, "comment_id": 85086622, "body": "Why you want to keep changing the data is beyond me. Like I said, I can invent any string that will cause the single allocation case to fail. That wasn&#39;t question asked. However, just for the sake of completeness, and just to protect against a screwed up sip uri retrieval that returns 50 leading <code>&#39;@&#39;</code> followed by 100 leading <code>&#39;:&#39;</code>, allocating separately for the final return is the way to go. If your sip uri intermixes the 50 leading <code>&#39;@&#39;</code> and 100 leading <code>&#39;:&#39;</code> before the number -- you ain&#39;t getting it."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519862854, "post_id": 49039520, "comment_id": 85086702, "body": "@DavidC.Rankin hey, don&#39;t get mad at me, I&#39;m not trying to upset/bother you. I was only pointing out that on some inputs, the code would not work as intended. Because the data comes from an external source you cannot trust, you should add these extra checks, even when for the example strings provided by the OP you wouldn&#39;t need them. Sorry for trying to help."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519887934, "post_id": 49039520, "comment_id": 85093309, "body": "I&#39;m not at all, I appreciate the discussion and I do see the point, but there is a certain level of frustration associated with answering &#39;Question A&#39; only to be told it doesn&#39;t work for &#39;Question B&#39;. Now, is it fair to say, that won&#39;t work for &#39;Question B&#39; -- sure it is, but at some point you have to simply answer the question asked and not one that could have been asked. It would be the same as me pointing out that your solution fails for <code>&quot;@:@2109999999@&quot;</code> because there is always the possibility you get a second <code>&#39;@&#39;</code> before the digits... <code>:)</code>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 3, "last_activity_date": 1519862369, "last_edit_date": 1519862369, "creation_date": 1519856132, "answer_id": 49039520, "question_id": 49039282, "link": "https://stackoverflow.com/questions/49039282/splitting-a-string-to-remove-everything-after-a-delimiter/49039520#49039520", "title": "Splitting a string to remove everything after a delimiter", "body": "<p>Your code works fine, you just cannot <code>free(buf)</code> before the return or you release the memory holding <code>number</code> and <code>second</code> leading to <em>Undefined Behavior</em>. You further need to validate each step. Suggest something like:</p>\n\n<p>(<strong>Note:</strong> updateded to protect against a leading <code>'@'</code> in <code>sCallee</code> or a leading <code>':'</code> in <code>p</code> resulting in <code>NULL</code> being returned)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *GetPhoneNumber(const char* sCallee) \n{\n    if (*sCallee == '@') {  /* protect against leading '@' */\n        fprintf (stderr, \"invalid sCallee - leading '@'\\n\");\n        return NULL;\n    }\n\n    char* buf = malloc (strlen(sCallee) + 1);\n    if (!buf) {         /* if you allocate/validate */\n        perror (\"malloc - buf\");\n        return NULL;\n    }\n    strcpy(buf, sCallee);\n\n    char *p = strtok (buf, \"@\");    /* get first token with '@' */\n    if (!p) {   /* validate */\n        fprintf (stderr, \"error: strtok with '@' failed.\\n\");\n        return NULL;\n    }\n    if (*p == ':') {        /* protect against leading ':' */\n        fprintf (stderr, \"invalid p - leading ':'\\n\");\n        free (buf);\n        return NULL;\n    }\n    char *q = strtok (p, \":\");      /* get first token with ':' */\n\n//     free(buf);\n\n    return q;\n}\n\nint main () {\n\n    const char* raw_uri = \"2109999999:abc@10.0.0.1\";\n    char* number = GetPhoneNumber(raw_uri);\n\n    if (number == NULL) {\n        printf(\"I am screwed! %s comes out null!\\n\", raw_uri);\n    }\n    else {\n        printf (\"number: %s\\n\", number);\n        free (number);\n    }\n\n    char* second = GetPhoneNumber(\"2109999999\");\n\n    if (second == NULL) {\n        printf(\"This does not work either.\\n\");\n    }\n    else {\n        printf (\"second: %s\\n\", second);\n        free (second);\n    }\n}\n</code></pre>\n\n<p>(<strong>note:</strong> There is no need to cast the return of <code>malloc</code>, it is unnecessary. See: <a href=\"http://stackoverflow.com/q/605845/995714\"><strong>Do I cast the result of malloc?</strong></a>)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/strtokpnum\nnumber: 2109999999\nsecond: 2109999999\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/strtokpnum\n==24739== Memcheck, a memory error detector\n==24739== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==24739== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==24739== Command: ./bin/strtokpnum\n==24739==\nnumber: 2109999999\nsecond: 2109999999\n==24739==\n==24739== HEAP SUMMARY:\n==24739==     in use at exit: 0 bytes in 0 blocks\n==24739==   total heap usage: 2 allocs, 2 frees, 35 bytes allocated\n==24739==\n==24739== All heap blocks were freed -- no leaks are possible\n==24739==\n==24739== For counts of detected and suppressed errors, rerun with: -v\n==24739== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<hr>\n\n<p><strong>Protect Against All Corner Cases</strong></p>\n\n<p>Though not part of the question, there are possible corner cases such as multiple leading <code>'@'</code> and multiple leading <code>':'</code> in the secondary string. If you are going to protect against the possibility of having multiple leading <code>'@'</code> delimiters or multiple leading <code>':'</code> in the secondary string, then simply use the multiple allocation method. Adding any additional checks and you might as well just walk a pointer down <code>sCallee</code>.</p>\n\n<pre><code>char *gettok (const char *s, const char *d1, const char *d2)\n{\n    char *buf = malloc (strlen (s) + 1),\n        *p = NULL,\n        *q = NULL,\n        *s2 = NULL;\n\n    if (!buf) { /* validate allocation */\n        perror (\"malloc - buf\");\n        return NULL;\n    }\n    strcpy (buf, s);    /* copy s to buf */\n    if (!(p = strtok (buf, d1))) {  /* if token on d1 fails */\n        free (buf);                 /* free buf */\n        return NULL;\n    }\n    if (!(q = strtok (p, d2))) {    /* if token on d2 fails */\n        free (buf);                 /* free buf */\n        return NULL;\n    }\n\n    /* allocate/validate return */\n    if (!(s2 = malloc (strlen (q) + 1))) {\n        perror (\"malloc - s2\");\n        return NULL;\n    }\n    strcpy (s2, q); /* copy token */\n\n    free (buf);     /* free buf */\n\n    return s2;      /* return token */\n}\n</code></pre>\n\n<p>In that case you would simply call</p>\n\n<pre><code>gettok (\"@@@@@:::::2109999999:abc@10.0.0.1\", \"@\", \":');\n</code></pre>\n\n<p>and you are protected.</p>\n\n<p>(and if you are getting strings like that from your sip uri, fix that process)</p>\n"}], "owner": {"reputation": 4095, "user_id": 3957200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/25mzd.jpg?s=128&g=1", "display_name": "Cinder Biscuits", "link": "https://stackoverflow.com/users/3957200/cinder-biscuits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 49039431, "answer_count": 2, "score": 0, "last_activity_date": 1537506384, "creation_date": 1519855073, "last_edit_date": 1537506384, "question_id": 49039282, "link": "https://stackoverflow.com/questions/49039282/splitting-a-string-to-remove-everything-after-a-delimiter", "title": "Splitting a string to remove everything after a delimiter", "body": "<p>I am trying to parse the phone number out of a sip uri, or if the string is just a number, returning that. Basically, I want to chop off the @ and anything after it if it exists.<br>\nI wrote a small function using <code>strtok()</code> but the function always returns <code>NULL</code>.<br>\nCan anyone tell me what I'm doing wrong here? </p>\n\n<pre><code>char* GetPhoneNumber(const char* sCallee) {\n    char* buf = (char*)malloc(strlen(sCallee) + 1);\n    strcpy(buf, sCallee);\n    char *p = strtok (buf, \"@\");\n    char *q = strtok (p, \":\");\n    if (buf) {\n        free(buf);\n    }\n    return q;\n}\n\nint main() {\n    const char* raw_uri = \"2109999999@10.0.0.1\";\n    char* number = GetPhoneNumber(raw_uri);\n    if (number == NULL) {\n        printf(\"I am screwed! %s comes out null!\", raw_uri);\n    }\n    char* second = GetPhoneNumber(\"2109999999\");\n    if (second == NULL) {\n        printf(\"This does not work either.\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "entropy", "mbedtls"], "comments": [{"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1520715716, "post_id": 49039272, "comment_id": 85432408, "body": "Where are you getting the precompiled binaries? One thing that comes to mind is that some options in <code>mbedtls&#47;config.h</code> change the layout of data structures, so if you have a shared library that was compiled with a different <code>config.h</code>, you may get segfaults or other incorrect behavior."}, {"owner": {"reputation": 190, "user_id": 9149561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240c2522443201ed7cb252fcae710814?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Eldor", "link": "https://stackoverflow.com/users/9149561/ron-eldor"}, "reply_to_user": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1521986930, "post_id": 49039272, "comment_id": 85956034, "body": "In addition to @Gilles comment, pleasetry running your application with strace, so you could have additional information for the error"}, {"owner": {"reputation": 653, "user_id": 1950345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efa67d5890612632e062ede96a7c3be7?s=128&d=identicon&r=PG", "display_name": "reichhart", "link": "https://stackoverflow.com/users/1950345/reichhart"}, "reply_to_user": {"reputation": 190, "user_id": 9149561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/240c2522443201ed7cb252fcae710814?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Eldor", "link": "https://stackoverflow.com/users/9149561/ron-eldor"}, "edited": false, "score": 0, "creation_date": 1590398600, "post_id": 49039272, "comment_id": 109655117, "body": "@Ron: <code>strace</code> doesn&#39;t help here because no syscall happens. I&#39;m having the same issue. In <code>ltrace -S</code> I see the <code>mbedtls_entropy_init()</code> and then immediately the segfault. Will debug the lib now."}], "owner": {"reputation": 383, "user_id": 5104052, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-fmvf-rMxSHM/AAAAAAAAAAI/AAAAAAAAAw0/Hh-jm_6w5Uw/photo.jpg?sz=128", "display_name": "Yann Lelong", "link": "https://stackoverflow.com/users/5104052/yann-lelong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537506593, "creation_date": 1519855030, "last_edit_date": 1537506593, "question_id": 49039272, "link": "https://stackoverflow.com/questions/49039272/mbedtls-entropy-segmentation-fault-on-init", "title": "mbedtls entropy: Segmentation fault on init", "body": "<p>I'm currently working on a projet using <code>mbedtls</code> and specifically, I'm tring to set up an entropy context that would allow me to start a random number generator.<br>\nTrying to understand the mechanism, I looked at the sample program <code>gen_entropy</code>.<br>\nAlthough the pre-compiled executable does run properly, when I'm compiling the same <code>gen_entropy.c</code> file with <code>gcc -o new_gen_entropy gen_entropy.c</code>, I'm immediately getting a segfault. Same goes for my own program.<br>\nHas anyone encountered the same issue?<br>\nCould you please share a way to overcome that difficulty?</p>\n\n<p><code>gen_entropy.c</code></p>\n\n<pre><code>/**\n *  \\brief Use and generate multiple entropies calls into a file\n *\n *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved\n *  SPDX-License-Identifier: Apache-2.0\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\"); you may\n *  not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n *  This file is part of mbed TLS (https://tls.mbed.org)\n */\n\n#if !defined(MBEDTLS_CONFIG_FILE)\n#include \"mbedtls/config.h\"\n#else\n#include MBEDTLS_CONFIG_FILE\n#endif\n\n#if defined(MBEDTLS_PLATFORM_C)\n#include \"mbedtls/platform.h\"\n#else\n#include &lt;stdio.h&gt;\n#define mbedtls_fprintf    fprintf\n#define mbedtls_printf     printf\n#endif\n\n#if defined(MBEDTLS_ENTROPY_C) &amp;&amp; defined(MBEDTLS_FS_IO)\n#include \"mbedtls/entropy.h\"\n\n#include &lt;stdio.h&gt;\n#endif\n\n#if !defined(MBEDTLS_ENTROPY_C) || !defined(MBEDTLS_FS_IO)\nint main( void )\n{\n    mbedtls_printf(\"MBEDTLS_ENTROPY_C and/or MBEDTLS_FS_IO not defined.\\n\");\n    return( 0 );\n}\n#else\nint main( int argc, char *argv[] )\n{\n    FILE *f;\n    int i, k, ret;\n    mbedtls_entropy_context entropy;\n    unsigned char buf[MBEDTLS_ENTROPY_BLOCK_SIZE];\n\n    if( argc &lt; 2 )\n    {\n        mbedtls_fprintf( stderr, \"usage: %s &lt;output filename&gt;\\n\", argv[0] );\n        return( 1 );\n    }\n\n    if( ( f = fopen( argv[1], \"wb+\" ) ) == NULL )\n    {\n        mbedtls_printf( \"failed to open '%s' for writing.\\n\", argv[1] );\n        return( 1 );\n    }\n\n    mbedtls_entropy_init( &amp;entropy );\n\n    for( i = 0, k = 768; i &lt; k; i++ )\n    {\n        ret = mbedtls_entropy_func( &amp;entropy, buf, sizeof( buf ) );\n        if( ret != 0 )\n        {\n            mbedtls_printf(\"failed!\\n\");\n            goto cleanup;\n        }\n\n        fwrite( buf, 1, sizeof( buf ), f );\n\n        mbedtls_printf( \"Generating %ldkb of data in file '%s'... %04.1f\" \\\n                \"%% done\\r\", (long)(sizeof(buf) * k / 1024), argv[1], (100 * (float) (i + 1)) / k );\n        fflush( stdout );\n    }\n\n    ret = 0;\n\ncleanup:\n    mbedtls_printf( \"\\n\" );\n\n    fclose( f );\n    mbedtls_entropy_free( &amp;entropy );\n\n    return( ret );\n}\n#endif /* MBEDTLS_ENTROPY_C */\n</code></pre>\n"}, {"tags": ["c", "macos", "wait", "ptrace"], "comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1519852376, "post_id": 49038538, "comment_id": 85082529, "body": "Perhaps I should be using <code>strace</code> instead of <code>ptrace</code>, but I don&#39;t have <code>strace</code> on my Mac."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1519852379, "post_id": 49038538, "comment_id": 85082531, "body": "<a href=\"https://unix.stackexchange.com/a/58601/113238\">unix.stackexchange.com/a/58601/113238</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1519854017, "post_id": 49038821, "comment_id": 85083396, "body": "yeah I am trying to avoid a loop - trying to get a polling-free implementation...it&#39;s hard to figure out how to do that"}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1519854148, "post_id": 49038821, "comment_id": 85083463, "body": "in my case, I am not trying to create a debugger - I am just trying to listen to the process - I want the ptrace / dtrace / strace command to exit when the pid exits."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1519855898, "post_id": 49038821, "comment_id": 85084255, "body": "I need you to be more specific about what you mean by &quot;listen to the process&quot;.  Presumably you want to do something that is more than just a normal wait for the process to complete?  Whatever that thing is, that&#39;s what goes in the body of the ptrace/wait loop."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 1, "last_activity_date": 1519853101, "creation_date": 1519853101, "answer_id": 49038821, "question_id": 49038538, "link": "https://stackoverflow.com/questions/49038538/how-to-use-ptrace-to-observe-process-until-it-exits/49038821#49038821", "title": "How to use ptrace() to observe process until it exits?", "body": "<p>Your problem is probably that the <code>wait</code> call returns immediately, because the traced \"inferior\" process is suspended, you know, waiting for you to debug it.  You're going to need some kind of loop in which you make <code>ptrace</code> requests to inspect the child and then resume execution, and then call <code>wait</code> again to wait for it to suspend on the next breakpoint or whatever. Unfortunately the debugger API is extremely non-portable; you will have to write most of this program twice, once for OSX and once for Linux.</p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537676421, "creation_date": 1519851908, "last_edit_date": 1537676421, "question_id": 49038538, "link": "https://stackoverflow.com/questions/49038538/how-to-use-ptrace-to-observe-process-until-it-exits", "title": "How to use ptrace() to observe process until it exits?", "body": "<p>I am looking for a <code>ptrace()</code> call to observe a process until the process exits.</p>\n\n<p>I have this which compiles with gcc / cc on OSX:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/ptrace.h&gt;\n\n\nint main(int argc, char *argv[]) {\n    pid_t pidx = atoi(argv[1]);\n    printf(\"pid = %jd\\n\", (intmax_t) pidx);\n    ptrace(PT_ATTACHEXC, pidx, 0, 0);\n    wait(NULL);\n}\n</code></pre>\n\n<p>However, even with a valid/existing pid, this program will still exit immediately. I am trying to only exit this program after <code>pidx</code> dies.<br>\nIs this possible somehow?<br>\nIdeally I want something that works on both OSX and Linux.</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519851858, "post_id": 49038286, "comment_id": 85082228, "body": "yes you&#39;re going to need a loop that loops through <code>array</code> and locates the <code>struct animal</code> with the <code>id</code> of the animal that needs to be changed. In fact I would create a function <code>struct animal* locate_animal(char* id){ ... }</code> that returned a pointer to a <code>struct animal</code> if found (<code>NULL</code> if not found), and pass that pointer into your <code>update_*</code> functions. That will modularize functionality. <code>update_age</code> right now looks like a series of out-of-bounds accesses of <code>array</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519851858, "post_id": 49038286, "comment_id": 85082230, "body": "<code>strcpy(array-&gt;id, newanimal.id);</code>  looks like it is copying data always into the first element of <code>array</code>.  I&#39;d expect <code>array[size].id</code> or something like that."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519852174, "post_id": 49038286, "comment_id": 85082395, "body": "@chux yea forgot to edit that, but that function wasn&#39;t the point:d"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519852217, "post_id": 49038286, "comment_id": 85082427, "body": "also, use <a href=\"https://linux.die.net/man/3/strcmp\" rel=\"nofollow noreferrer\"><code>strcmp</code></a> to compare strings,, <code>==</code> compares pointer values, not what you want here."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519852284, "post_id": 49038286, "comment_id": 85082462, "body": "With <code>if (array[n].id == p_id)</code>, it is not clear that <code>array[n].id</code> has been assigned anywhere.  <code>array[n + 1].id</code> too."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519852293, "post_id": 49038286, "comment_id": 85082469, "body": "@yano yea sorry forgot to say that I&#39;m not allowed to do extra functions cause that struct animal is actually in header file which need to be unchanged, so I need to somehow loop it inside of these update functions"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519852630, "post_id": 49038286, "comment_id": 85082666, "body": "You can add functions without modifying the header file. If a stipulation of the assignment is &quot;no new functions&quot;, that&#39;s stupid. The whole point of a function is to modularize functionality. A function should do one thing and do it well. But if you&#39;re not allowed to add new functions, you&#39;ll need to put identical searcher code in each <code>update_</code> function. You must find the animal you&#39;re dealing with before you can modify it."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519852664, "post_id": 49038286, "comment_id": 85082686, "body": "@chux okay then I don&#39;t know what command will bring these ID&#39;s up"}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519852921, "post_id": 49038286, "comment_id": 85082824, "body": "@yano yea true, but should I then go through every index of the array and see if it matches with the given ID?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519853546, "post_id": 49038286, "comment_id": 85083143, "body": "yes, you must locate your animal (which is uniquely defined by its <code>id</code>) in order to figure out which animal you need to operate on. Since your data set isn&#39;t keyed with this <code>id</code>, you&#39;ll need to search through all your records until you find a match. This method of searching wouldn&#39;t efficiently scale well to a huge data set, but it certainly looks like your best/easiest option from what you&#39;ve shown. Don&#39;t forget you must use a function like <code>strcmp</code> to find out if the <code>id</code>s match."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519854155, "post_id": 49038286, "comment_id": 85083464, "body": "@yano  you mean something like that I edited to &#180;update_age function?&#180;"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519854595, "post_id": 49038286, "comment_id": 85083674, "body": "something like that, yes, but <code>array[i]</code> is a <code>struct animal</code> type, you need to further differentiate what field you&#39;re talking about: <code>for (unsigned int i=0; i&lt;size; i++){  if (strcmp(array[i].id, p_id) == 0){  array[i].age = newage; ...</code>"}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1519855188, "post_id": 49038286, "comment_id": 85083936, "body": "yea now I got it done, thank you super much! @yano"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537550198, "post_id": 49038286, "comment_id": 91839670, "body": "Please make an answer to your own question, in order to help others and in order to get this out of the list of unanswered questions."}], "owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537904634, "creation_date": 1519850921, "last_edit_date": 1592644375, "question_id": 49038286, "link": "https://stackoverflow.com/questions/49038286/struct-changing-existing-records-with-id-match-in-array", "title": "struct changing existing records with ID match in array", "body": "<blockquote>\n<p>Implement function '<code>update_age</code>' that changes the age ('<code>newage</code>') in one of the existing records in the array. The record to be changed is identified by the ID ('<code>p_id</code>'). If no record with matching ID are found, nothing is changed. The function returns 1, if a change was made, and 0 if no matching records were found. You can assume that there are no multiple entries with same ID.</p>\n<p>Implement function '<code>update_entrydate</code>' that changes the age ('<code>newdate</code>') in one of the existing records in the array. The record to be changed is identified by the ID ('<code>p_id</code>'). If no record with matching ID are found, nothing is changed. The function returns 1, if a change was made, and 0 if no matching records were found. You can assume that there are no multiple entries with same ID.</p>\n</blockquote>\n<p>That's my assignment here so both of those update functions are pretty much the same and here I have tried to write them and I just can't understand what goes wrong here? Maybe I need some kind of a loop inside these functions? <code>main</code> has to remain the same and function <code>add_record</code> is good so do not mind about that.</p>\n<p>My code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n// Single animal entry\nstruct animal {\n    char id[7]; // animal ID (6 characters) + terminating '\\0'\n    char *name; // animals name\n    char *species; // animal species (string)\n    unsigned char age; // animals age\n    struct date entrydate;  // date of the animals arrival\n};\n\nstruct animal *add_record(struct animal *array, unsigned int size, struct animal newanimal) \n{\n    int n = size + 1;\n    struct animal *newarray = realloc(array,  n*sizeof(*newarray));\n    if (!newarray) {\n        perror(&quot;realloc&quot;);\n        exit(EXIT_FAILURE);\n    }\n    array = newarray; \n    strcpy(array[n - 1].id, newanimal.id);\n    array[n - 1].name = malloc(strlen(newanimal.name) + 1);\n    strcpy(array[n - 1].name, newanimal.name);\n    array[n - 1].species = malloc(strlen(newanimal.species) + 1);\n    strcpy(array[n - 1].species, newanimal.species);\n    array[n - 1].age = newanimal.age;\n    array[n - 1].entrydate = newanimal.entrydate;\n    return array;\n\nint update_age(struct animal *array, unsigned int size, const char *p_id,\nunsigned char newage) {\n\n    for (int i = 0; !array; ++i) {\n    if (strcmp(array[i], p_id)==0) {\n        array[i] = newage;\n        return 1\n    }\n    }\n    return 0;\n}\n}\n\nint update_entrydate(struct animal *array, unsigned int size, const char *p_id,\nstruct date newdate) {\n    int n = size + 1;\n    if (array[n-1].id == p_id) {\n        array[n-1].entrydate = newdate;\n        return 1;\n    }\n    if (array[n].id == p_id) {\n        array[n].entrydate = newdate;\n        return 1;\n    }\n    if (array[n + 1].id == p_id) {\n        array[n + 1].entrydate = newdate;\n        return 1;\n    }\n    if (array[n + 2].id == p_id) {\n        array[n + 2].entrydate = newdate;\n        return 1;\n    }\n    else\n        return 0;\n}\nint main()\n{\n    /*making new animal zoo which I want to which all of them I need to\n      add to array in function add_record*/\n\n    struct animal zoo[] = {\n        { &quot;123456&quot;, &quot;Winnie-the-Pooh&quot;, &quot;Bear&quot;, 94,{ 1,1,1924 } },\n        { &quot;555666&quot;, &quot;Eeyore&quot;, &quot;Donkey&quot;, 92,{ 1,1,1926 } },\n        { &quot;773466&quot;, &quot;Piglet&quot;, &quot;Very Small Animal&quot;, 30,{ 31, 12, 2015 } },\n        { &quot;234567&quot;, &quot;Roo&quot;, &quot;Kangaroo&quot;, 5,{ 31, 12, 2015 } }\n    };\n    //this below is for the function add_record so do not mind\n    struct animal *array = NULL;\n    unsigned int len = 0;\n    for (unsigned int i = 0; i &lt; sizeof(zoo) / sizeof(struct animal); i++) {\n        struct animal *newarray = add_record(array, len, zoo[i]);\n        len++;\n        array = newarray;\n    }\n    //from here starts the part of this question\n    struct date day1 = { 0, 0, 0 };\n\n    if (!update_age(array, len, &quot;555666&quot;, 50))\n        printf(&quot;failed '555666'\\n&quot;);\n\n    if (!update_age(array, len, &quot;23456677&quot;, 3))\n        printf(&quot;failed '234567', invalid id\\n&quot;);\n\n    if (!update_entrydate(array, len, &quot;123456&quot;, day1))\n        printf(&quot;failed '111111'\\n&quot;);\n\n    if (!update_entrydate(array, len, &quot;999999&quot;, day1))\n        printf(&quot;failed '234567', no course\\n&quot;);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "macos", "strace", "ptrace"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1519851163, "post_id": 49038266, "comment_id": 85081862, "body": "Include <code>&lt;sys&#47;types.h&gt;</code> as well."}], "answers": [{"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1520586966, "creation_date": 1520586966, "answer_id": 49190297, "question_id": 49038266, "link": "https://stackoverflow.com/questions/49038266/compile-ptrace-program-on-osx/49190297#49190297", "title": "Compile ptrace() program on OSX", "body": "<p><code>caddr_t</code> is BSD specific type which is defined in <a href=\"https://www.freebsd.org/cgi/man.cgi?query=ptrace\" rel=\"nofollow noreferrer\"><code>&lt;sys/types.h</code></a> header. It's not present in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/\" rel=\"nofollow noreferrer\">POSIX</a>.</p>\n\n<p>Not quite relevant since you are on Mac OS. But on modern Linux systems that use glibc, it's exposed when <code>_DEFAULT_SOURCE</code> macro is defined. Systems having older glibc (older than glibc 2.20. <code>_BSD_SOURCE</code> has been deprecated since glibc 2.20) need to define <code>_BSD_SOURCE</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 2, "last_activity_date": 1520588905, "creation_date": 1520588905, "answer_id": 49190892, "question_id": 49038266, "link": "https://stackoverflow.com/questions/49038266/compile-ptrace-program-on-osx/49190892#49190892", "title": "Compile ptrace() program on OSX", "body": "<p><code>man ptrace</code> gives:</p>\n\n<pre><code>PTRACE(2)                   BSD System Calls Manual                  PTRACE(2)\n\nNAME\n     ptrace -- process tracing and debugging\n\nSYNOPSIS\n     #include &lt;sys/types.h&gt;\n     #include &lt;sys/ptrace.h&gt;\n\n     int\n     ptrace(int request, pid_t pid, caddr_t addr, int data);\n</code></pre>\n\n<p>then include <code>&lt;sys/types.h&gt;</code> as said.</p>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1520588905, "creation_date": 1519850870, "question_id": 49038266, "link": "https://stackoverflow.com/questions/49038266/compile-ptrace-program-on-osx", "title": "Compile ptrace() program on OSX", "body": "<p>I have this simple C program on MacOS:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/ptrace.h&gt;\n\n\nint main(int argc, char *argv[]) {\n    pid_t pid = atoi(argv[1]);\n    printf(\"pid = %jd\\n\", (intmax_t) pid);\n    return ptrace(PT_ATTACHEXC, pid, 0, 0);\n}\n</code></pre>\n\n<p>when I compile with gcc / cc, I get this error:</p>\n\n<blockquote>\n<pre><code>In file included from my-waiter.c:4:\n/usr/include/sys/ptrace.h:99:38: error: unknown type name 'caddr_t'\nint     ptrace(int _request, pid_t _pid, caddr_t _addr, int _data);\n                                         ^\n1 error generated.\n</code></pre>\n</blockquote>\n\n<p>does anyone know how to use <code>ptrace()</code> on OSX? I can't figure out how to get this to compile.</p>\n"}, {"tags": ["c", "gcc", "libc"], "answers": [{"tags": [], "owner": {"reputation": 15050, "user_id": 8605791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae3be140b26db13a86d624dba4ef1c8?s=128&d=identicon&r=PG&f=1", "display_name": "llllllllll", "link": "https://stackoverflow.com/users/8605791/llllllllll"}, "is_accepted": true, "score": 7, "last_activity_date": 1519850740, "creation_date": 1519850740, "answer_id": 49038236, "question_id": 49038088, "link": "https://stackoverflow.com/questions/49038088/does-gcc-links-to-libc-a-or-libc-so-by-default/49038236#49038236", "title": "Does gcc links to libc.a or libc.so by default?", "body": "<blockquote>\n  <p>How can I see which C library does gcc links against to, libc.a or libc.so, or something else?</p>\n</blockquote>\n\n<p>You can use <code>ldd</code> command to see all linked shared libraries. If <code>libc.so</code> is found, it's dynamic linking.</p>\n\n<blockquote>\n  <p>In what circumstance does it links to libc.so?</p>\n</blockquote>\n\n<p>gcc uses dynamic linking and links to <code>libc.so</code> by default. If you want static linking, pass <code>-static</code> flag.</p>\n\n<blockquote>\n  <p>Does libc.so need to be specified at run time like other shared libraries?</p>\n</blockquote>\n\n<p>Normally no, since it's configured by compiler automatically.</p>\n"}], "owner": {"reputation": 369, "user_id": 7932321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ce26d6d91181378aece5d13a910613d?s=128&d=identicon&r=PG&f=1", "display_name": "radiohead", "link": "https://stackoverflow.com/users/7932321/radiohead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2022, "favorite_count": 3, "accepted_answer_id": 49038236, "answer_count": 1, "score": 6, "last_activity_date": 1520016514, "creation_date": 1519850117, "last_edit_date": 1520016514, "question_id": 49038088, "link": "https://stackoverflow.com/questions/49038088/does-gcc-links-to-libc-a-or-libc-so-by-default", "title": "Does gcc links to libc.a or libc.so by default?", "body": "<p>I am using gcc 5.4.0 on Ubuntu 16.04 64 bit. When I compile a program:</p>\n\n<pre><code>gcc -o prog prog.c\n</code></pre>\n\n<p>GCC automatically links to the C standard library, so I don't have to specifically do that. </p>\n\n<ol>\n<li>How can I see which C library does gcc link against to, libc.a or libc.so, or something else?</li>\n<li>In what circumstance does it link to libc.so? Does libc.so need to be specified at run time like other shared libraries?</li>\n</ol>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "optimization"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 4, "creation_date": 1519850046, "post_id": 49038057, "comment_id": 85081301, "body": "It depends on the compiler and flags. It&#39;s possible it will be optimized, it&#39;s possible it won&#39;t."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519850082, "post_id": 49038057, "comment_id": 85081322, "body": "It&#39;s up to a specific compiler. But a conventional ones are very likely to optimize this."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1519850106, "post_id": 49038057, "comment_id": 85081331, "body": "Give <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> a try. It shows you the assembly produced by various compilers."}, {"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 0, "creation_date": 1519850232, "post_id": 49038057, "comment_id": 85081394, "body": "I would not rely on it to be optimized. There are many factors that can affect it on one side and it is pretty easy to force compiler to call it only once on another."}, {"owner": {"reputation": 1167, "user_id": 5339807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed5db3c9fa9b80760fc44ae03008f7a1?s=128&d=identicon&r=PG&f=1", "display_name": "mascoj", "link": "https://stackoverflow.com/users/5339807/mascoj"}, "edited": false, "score": 0, "creation_date": 1519850336, "post_id": 49038057, "comment_id": 85081449, "body": "Depends. But if you want that functionality why don&#39;t you just cache the return of your function yourself before the for loop?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519850425, "post_id": 49038057, "comment_id": 85081494, "body": "In the example <code>i &lt; object.coolFunc()</code> how would the compiler know whether the same value is returned on each loop, or a different one?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519850558, "post_id": 49038057, "comment_id": 85081554, "body": "@WeatherVane Constant folding along with Link Time Optimization?"}, {"owner": {"reputation": 196, "user_id": 4900124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036d10222e906cc1979840aab4751023?s=128&d=identicon&r=PG&f=1", "display_name": "Love T&#228;tting", "link": "https://stackoverflow.com/users/4900124/love-t%c3%a4tting"}, "edited": false, "score": 0, "creation_date": 1519850726, "post_id": 49038057, "comment_id": 85081627, "body": "You would need to rely on the compiler to assert that the value of the condition expression is not affected by the statements in the loop, ie that size and max_size does not change. If it cannot, then the compiler shouldn\u2019t optimise as it will change the semantics of the program."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1519850764, "post_id": 49038057, "comment_id": 85081644, "body": "see <a href=\"https://stackoverflow.com/q/26771692/1708801\">Loop with a zero execution time</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1519851207, "post_id": 49038057, "comment_id": 85081880, "body": "@EugeneSh. Optimising is great with an excellent compiler like gcc, but suppose you are coding for an MCU, some cross-compilers supplied by the chip manufacturer have been flaky at best. Although the received wisdom on SO is that the compiler is better than me, I was taught not to write lazy code and not to let the compiler do the work for me. If the loop condition can obviously be done before the loop, it&#39;s a no-brainer."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519851263, "post_id": 49038057, "comment_id": 85081911, "body": "@WeatherVane I agree that where the &quot;manual&quot;  optimization is obvious - better do it yourself."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1519852382, "post_id": 49038057, "comment_id": 85082533, "body": "FYI, if you are discussing the C language, use the C tag.  If you are discussing C++, use the C++ tag.  Rarely, you need to use both tags.  Reminder, C and C++ are distinct languages."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1519852533, "post_id": 49038057, "comment_id": 85082609, "body": "As far as optimization goes, a lot depends on the signature and content of the function.  For example, if a string doesn&#39;t change length inside the loop, the compiler can optimize the condition by calling the length function once instead of each iteration.  If your comparison function is called on a mutable object then the compiler will have a more difficult time optimizing (if optimization is possible)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1519863141, "post_id": 49038057, "comment_id": 85086768, "body": "This is not a duplicate of <a href=\"https://stackoverflow.com/questions/25696857/condition-check-in-for-loop-in-c\">condition check in for loop</a> because that question asks about computation inside the abstract C model, and its answer does not address optimization, whereas this question asks specifically about optimization, which is a question about compilers and opimization outside the model."}], "answers": [{"comments": [{"owner": {"reputation": 10915, "user_id": 5376789, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/6715b3506c7312f63950450070ed8345?s=128&d=identicon&r=PG&f=1", "display_name": "xskxzr", "link": "https://stackoverflow.com/users/5376789/xskxzr"}, "edited": false, "score": 0, "creation_date": 1519876142, "post_id": 49041683, "comment_id": 85089787, "body": "The value&#39;s not changing is not sufficient for <a href=\"https://en.wikipedia.org/wiki/Loop_invariant#Distinction_from_loop-invariant_code\" rel=\"nofollow noreferrer\">&quot;invariant&quot;</a>. As you mentioned below as the concept of pure function, the subexpression should have no side effect, or only have side effects that are equivalent between when the subexpression is inside the loop and when it is outside the loop."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1519871664, "last_edit_date": 1519871664, "creation_date": 1519871048, "answer_id": 49041683, "question_id": 49038057, "link": "https://stackoverflow.com/questions/49038057/does-c-optimize-the-check-portion-of-for-loops/49041683#49041683", "title": "Does c optimize the check portion of for loops?", "body": "<p>Any good compiler will optimize the controlling expression of a <code>for</code> loop by evaluating visibly invariant subexpressions in it just once, provided optimization is enabled. Here, \u201cinvariant\u201d means the value of the subexpression does not change while the loop is executing. \u201cVisibly\u201d means the compiler can see that the expression is invariant. There are things that can interfere with this:</p>\n\n<ul>\n<li><p>Suppose, inside the loop, some function is called and the address of <code>size</code> is passed as an argument. Since the function has the address of <code>size</code>, it could change the contents of <code>size</code>. Maybe the function does not do this, but the compiler might not be able to see the contents of the function. Its source code could be in another file. Or the function could be so complicated the compiler cannot analyze it. Then the compiler cannot see that <code>size</code> does not change.</p></li>\n<li><p><code>min</code> is not a standard C function, so your program must define it somewhere. As above, if the compiler does not know what <code>min</code> does or if it is too complicated for the compiler to analyze (not likely in this particular case, but in general), the compiler might not be able to see that it is a <a href=\"https://en.wikipedia.org/wiki/Pure_function\" rel=\"nofollow noreferrer\">pure function</a>.</p></li>\n</ul>\n\n<p>Of course, the C standard does not guarantee this optimization. However, as you become experienced in programming, your knowledge of compilers and other tools should grow, and you will become familiar with what is expected of good tools, and you will also learn to beware of issues such as those above. For simple expressions, you can expect the compiler to optimize. But you need to remain alert to things that can interfere with optimization.</p>\n"}], "owner": {"reputation": 1414, "user_id": 5183807, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/34e6711722a4f7d037a3b8ee8de5e491?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5183807/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519871664, "creation_date": 1519849993, "question_id": 49038057, "link": "https://stackoverflow.com/questions/49038057/does-c-optimize-the-check-portion-of-for-loops", "title": "Does c optimize the check portion of for loops?", "body": "<p>With the following code how many times would the min function actually be called</p>\n\n<pre><code>for (int i = 0; i &lt; min(size, max_size); i++) {\n   //Do something cool that does not involve changing the value of size or max size\n}\n</code></pre>\n\n<p>Would the compiler notice that they could just calculate the minimum and register it or should I explicitly create a variable to hold the value before entering the loop? What kinds of languages would be able to optimize this?</p>\n\n<p>As an extension if I were in an object oriented language with a similar loop except it looked more like this</p>\n\n<pre><code>for (int i = 0; i &lt; object.coolFunc(); i++) {\n   //Code that may change parameters and state of object but does not change the return value of coolFunc()\n}\n</code></pre>\n\n<p>What would be optimized?</p>\n"}, {"tags": ["c", "generics", "data-structures", "structure"], "comments": [{"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 4, "creation_date": 1519847448, "post_id": 49037421, "comment_id": 85079932, "body": "I don&#39;t see any generic way to compare two objects without knowing their type."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1519847874, "post_id": 49037421, "comment_id": 85080150, "body": "As with most things in C, you have to do that yourself. Happily, it&#39;s also usually the case that many other people have already done it, and probably better. If you really want to re-invent that wheel, go for it, but there are lots of good libraries out there."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519848739, "post_id": 49037421, "comment_id": 85080602, "body": "The data here is a <code>void*</code> it is not a <i>fully</i> generic data structure.  The <code>.data</code> member is insufficient to save wide math types, structures and it is not even certain to hold function pointers.  It is  certainly sufficient to hold an object pointer."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 4, "last_activity_date": 1537250090, "last_edit_date": 1537250090, "creation_date": 1519847722, "answer_id": 49037557, "question_id": 49037421, "link": "https://stackoverflow.com/questions/49037421/generic-data-structure-search-in-c/49037557#49037557", "title": "Generic data structure search in c", "body": "<p>There is no way of comparing two objects without knowing their data type.</p>\n\n<p>A first attempt would probably be to use something like <code>memcmp</code>, but this fails for at least three reasons: </p>\n\n<ol>\n<li>Without knowing the type, you do not know the size of the object. </li>\n<li>Even if you somehow could derive some size, comparing objects of type <code>struct</code> or <code>union</code> could lead to wrong result due to padding. </li>\n<li>A comparison based on the memory layout could at most achieve a \"shallow\" comparison, which may not represent \"equality\" in terms of the respective data type.</li>\n</ol>\n\n<p>So the only way (and this is used by generic libraries) is to define functions that accept user-defined comparison functions as parameters.</p>\n"}], "owner": {"reputation": 21, "user_id": 9127580, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b2c7a17833f5b970b5335d487afb3acb?s=128&d=identicon&r=PG&f=1", "display_name": "IDEN", "link": "https://stackoverflow.com/users/9127580/iden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537250173, "creation_date": 1519847189, "last_edit_date": 1537250173, "question_id": 49037421, "link": "https://stackoverflow.com/questions/49037421/generic-data-structure-search-in-c", "title": "Generic data structure search in c", "body": "<p>I'm trying to code a fully generic data structure library in c.<br>\nIs there any way or technique in c programming that allows searching data without knowing its type?<br>\nHere I have to define my compare function again upon my data type.</p>\n\n<pre><code>list.h\n\n\ntypedef struct _node\n{\n   void *data;\n   struct _node *next;\n}NODE;\n\ntypedef struct _list\n{\n   NODE *head;\n   NODE *tail;\n   NODE *current;\n}GLIST;\n\nint search(GLIST *list,void *data,int (*COMPARE)(void*,void*));\n</code></pre>\n\n<p>and </p>\n\n<pre><code>list.c\n\nint search(GLIST *list,void *data,int(*COMPARE)(void*,void*))\n{\n   list-&gt;current=list-&gt;head;\n   int cIndex=1;\n   while(list-&gt;current)\n   {\n       if(COMPARE(list-&gt;current-&gt;data,data))\n       {\n           printf(\"data found at position %i.\\n\",cIndex);\n           if(list-&gt;current-&gt;next==NULL)\n           {\n               return 1;\n           }\n       }\n       list-&gt;current=list-&gt;current-&gt;next;\n       cIndex++;\n   }\n   printf(\"NO DATA FOUND.\\n\");\n\n   return 0;\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>mycode.c\n\nint compare(void *list,void *data);\n\ntypedef struct _student\n{\n   int studentNumber;\n   char name[64];\n}STUDENT;\n\nint main()\n{\n  GLIST list;\n  //initializing list......\n  STUDENT stud;\n  //code .....\n  search(&amp;list,&amp;stud,compare) // I want an alternative of using compare here\n\n  search(&amp;list,&amp;stud);     // want the function be like this and also be generic !\n\n  return 0;\n}\n\n\nint compare(void *list,void *data)\n{ \n    // I do not wanna have to declare this function even \n   return !strcmp(((STUDENT*)list)-&gt;name,((STUDENT*)data)-&gt;name);\n}\n</code></pre>\n\n<p>I'm wondering if there is A COMMON thing to compare elements \"structures,unions,arrays\" upon it in c  or any technique else. </p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1519844771, "post_id": 49036607, "comment_id": 85078529, "body": "And another question showing why putting the assignment in the <code>if</code> clause is a <b>bad</b> idea.  What&#39;s wrong with two lines of <code>myOpenFile = fopen(&quot;name.txt&quot;, &quot;r&quot;); if (myOpenFile == NULL )...</code>?  What did you gain by stuffing all that into one line?  Well, other than non-working code."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1519845218, "post_id": 49036607, "comment_id": 85078779, "body": "@AndrewHenle Alternatively, removing the comparison would fix the condition: <code>if (myOpenFile = fopen(&quot;name.txt&quot;, &quot;r&quot;))</code> is fine."}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 1, "creation_date": 1519845621, "post_id": 49036607, "comment_id": 85079014, "body": "You let a <code>;</code> after the <code>if (...) </code>, so the bloc after is always executed"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537905016, "post_id": 49036607, "comment_id": 91951986, "body": "Has none of the answers below helped you? Not even if you combine both? Is there a special reason why you cannot accept one? Please read <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 4, "last_activity_date": 1519845611, "last_edit_date": 1519845611, "creation_date": 1519844111, "answer_id": 49036637, "question_id": 49036607, "link": "https://stackoverflow.com/questions/49036607/fopen-can-create-a-file-but-cannot-reopen-file-in-c/49036637#49036637", "title": "fopen can create a file but cannot reopen file in C", "body": "<pre><code>myOpenFile = fopen(\"name.txt\", \"r\") == NULL\n</code></pre>\n\n<p>would be</p>\n\n<pre><code>(myOpenFile = fopen(\"name.txt\", \"r\")) == NULL\n</code></pre>\n\n<p>Otherwise you were assigning to <code>myOpenFile</code> the result of <code>==</code> which is <code>0</code> or <code>1</code>. Remember <code>==</code> has <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">higher precedence</a> than <code>=</code>. So it does the comparison before assigning it to <code>myOpenFile</code>.</p>\n\n<p>Another major thing which might seem minor to you is - return value of <code>fgetc</code> is <code>int</code> not <code>char</code>. So <code>int c</code> will be correct usage over here - not <code>char c</code>.</p>\n\n<p>Your <code>c</code> was uninitialized - initialize with some value and then do the comparison. And as suggested it will be (melpomene)</p>\n\n<pre><code>while ((c = fgetc(myOpenFile))!=EOF)\n{\n     printf(\"%c\", c);\n}\n</code></pre>\n\n<p>Earlier you basically negated the value <code>-1</code> (EOF) and it is <code>0</code> and that <code>0</code> value is assigned to <code>c</code> and the result of assignment expression  is the value assigned which is <code>0</code> and that <code>0</code> being considered false - the loop is never entered.</p>\n\n<p>Also notice that earlier you printed the value of <code>c</code> when <code>EOF</code> is assigned to it. That is not what your intention is. The corrected code should be something like as shown above.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 2, "last_activity_date": 1519844637, "creation_date": 1519844637, "answer_id": 49036782, "question_id": 49036607, "link": "https://stackoverflow.com/questions/49036607/fopen-can-create-a-file-but-cannot-reopen-file-in-c/49036782#49036782", "title": "fopen can create a file but cannot reopen file in C", "body": "<p>Your code has a typo in </p>\n\n<pre><code>if(myOpenFile = fopen(\"name.txt\", \"r\") == NULL);\n    {\n        printf(\"No such file\\n\"); //no such file is executed\n        return 0;\n    }\n</code></pre>\n\n<p>The <code>;</code> at the end of the first line makes a code block that does nothing.\nThen the following code block is always executed.</p>\n\n<p>Aside: you are using the wrong variable type.</p>\n\n<pre><code>char c;\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>int c;\n</code></pre>\n\n<p>as the man page will tell you. Don't worry about </p>\n\n<pre><code>printf(\"%c\", c);\n</code></pre>\n\n<p>because was <code>char</code> is promoted to <code>int</code> anyway.</p>\n"}], "owner": {"reputation": 385, "user_id": 7384147, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155014606923755/picture?type=large", "display_name": "Puneet Chandhok", "link": "https://stackoverflow.com/users/7384147/puneet-chandhok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519845611, "creation_date": 1519843977, "last_edit_date": 1519844119, "question_id": 49036607, "link": "https://stackoverflow.com/questions/49036607/fopen-can-create-a-file-but-cannot-reopen-file-in-c", "title": "fopen can create a file but cannot reopen file in C", "body": "<p>I am unable to open a file I just created using <code>fopen()</code>, I tried this code on both Linux and Windows. I also tried this code using complete path.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main() {\n\n    char c;\n    FILE *myFile = fopen(\"name.txt\", \"w\"); //file name.txt created\n    fprintf(myFile, \"My name is %s\", \"Adam\"); //text saved\n    fclose(myFile); //file closed\n\n    FILE *myOpenFile;\n    if(myOpenFile = fopen(\"name.txt\", \"r\") == NULL);\n    {\n        printf(\"No such file\\n\"); //no such file is executed\n        return 0;\n    }\n\n    while (c=!EOF)\n    {\n        c = fgetc(myOpenFile);\n        printf(\"%c\", c);\n    }\n    fclose(myOpenFile);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1519844197, "post_id": 49036461, "comment_id": 85078223, "body": "Try -Wextra and -Wpedantic also."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1519844348, "post_id": 49036461, "comment_id": 85078313, "body": "<code>FP_TYPE</code> is not a macro, it&#39;s a typedef. You should use <code>#if FLOATINGPOINTSIZE == 64</code> because <code>FLOATINGPOINTSIZE</code> is a macro"}], "answers": [{"comments": [{"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1519850998, "post_id": 49036710, "comment_id": 85081772, "body": "yes - i was absolutely not implying a problem with the preprocessor or compiler but a bug of my own creation.. I must have slipped into english instead of C - it was still valid code but with a completely different meaning to that which I intended.."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1519851088, "post_id": 49036710, "comment_id": 85081818, "body": "@bph, I hope you got the answer to <i>what the preprocessor makes of it?</i> I imagine that was your main question."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1519851242, "post_id": 49036710, "comment_id": 85081899, "body": "I did, when you also replace FP_TYPE with 0 the preprocessors understanding of the situation becomes clear, i.e. 0 == 0 so will always equate to True"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 1, "creation_date": 1519851348, "post_id": 49036710, "comment_id": 85081953, "body": "@bph, I completely missed that aspect the problem when I wrote my answer but now I see it."}, {"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1519851445, "post_id": 49036710, "comment_id": 85082007, "body": "probably to be more accurate I should say when you understand what substitutions the preprocessor has made then the compilers understanding of the situation becomes clear"}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1519851395, "last_edit_date": 1592644375, "creation_date": 1519844339, "answer_id": 49036710, "question_id": 49036461, "link": "https://stackoverflow.com/questions/49036461/c-preprocessor-if-handling-of-non-integer-constant/49036710#49036710", "title": "C Preprocessor #if handling of non-integer constant", "body": "<blockquote>\n<p>The meaning is obvious to the programmer, but I'm not sure what the preprocessor makes of it?</p>\n<p>Its got to be a bug right?</p>\n</blockquote>\n<p>It's a bug from a user's point of view but it is not a bug in the preprocessor.</p>\n<pre><code>#if FP_TYPE == double\n</code></pre>\n<p>is interpreted as</p>\n<pre><code>#if 0 == 0\n</code></pre>\n<p>since neither <code>FP_TYPE</code> nor <code>double</code> is a known symbol for the pre-processor.</p>\n<p>From <a href=\"https://gcc.gnu.org/onlinedocs/cpp/If.html#If\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/cpp/If.html#If</a>:</p>\n<blockquote>\n<p>Identifiers that are not macros, which are all considered to be the number zero. This allows you to write <code>#if MACRO</code> instead of <code>#ifdef MACRO</code>, if you know that <code>MACRO</code>, when defined, will always have a nonzero value. Function-like macros used without their function call parentheses are also treated as zero.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "edited": false, "score": 0, "creation_date": 1519850509, "post_id": 49036717, "comment_id": 85081531, "body": "that is a superb answer - i had an inkling that that might be the case hence the mention of non integer constant in the OP title"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 6, "last_activity_date": 1519844361, "creation_date": 1519844361, "answer_id": 49036717, "question_id": 49036461, "link": "https://stackoverflow.com/questions/49036461/c-preprocessor-if-handling-of-non-integer-constant/49036717#49036717", "title": "C Preprocessor #if handling of non-integer constant", "body": "<blockquote>\n  <p>I have -Wall compiler setting to give me plenty of warnings but this\n  didn't get flagged up as an issue.</p>\n</blockquote>\n\n<p>The code is valid, but you are right to be concerned.</p>\n\n<blockquote>\n  <p>My question is how is the\n  preprocessor interpreting:</p>\n\n<pre><code>#if FP_TYPE == double\n</code></pre>\n</blockquote>\n\n<p>Good question.</p>\n\n<blockquote>\n  <p>The meaning is obvious to the programmer, but I'm not sure what the\n  preprocessor makes of it?</p>\n</blockquote>\n\n<p>The <em>intended</em> meaning seems obvious, and as the code's author, you know what you meant.  But what you appear to have intended indeed is not how the preprocessor interprets that conditional.</p>\n\n<p>The expression in a preprocessor conditional is interpreted as an integer constant expression.  Just like in a C <code>if</code> statement, if the expression evaluates to 0 then the condition is considered false, and otherwise it is considered true.  All macros in the expression are expanded before it is evaluated, and <strong>any remaining identifiers are replaced with 0</strong>.  Details are presented in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.1\" rel=\"noreferrer\">section 6.10.1 of the standard</a>.</p>\n\n<p>Supposing that there is no in-scope defnition of a macro named either <code>FP_TYPE</code> or <code>double</code> (and a <code>typedef</code> is <em>not</em> a macro definition), your conditional is equivalent to</p>\n\n<pre><code>#if 0 == 0\n</code></pre>\n\n<p>, which is always true.</p>\n\n<blockquote>\n  <p>Its got to be a bug right?</p>\n</blockquote>\n\n<p>The preprocessing result will not be what you intended, so it's a bug in your code.  The compiler, on the other hand, is correct to accept it.</p>\n"}], "owner": {"reputation": 9246, "user_id": 1041868, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6d476b07acb3919c356015e11ad97608?s=128&d=identicon&r=PG", "display_name": "bph", "link": "https://stackoverflow.com/users/1041868/bph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 1, "accepted_answer_id": 49036717, "answer_count": 2, "score": 0, "last_activity_date": 1537595128, "creation_date": 1519843417, "last_edit_date": 1537595128, "question_id": 49036461, "link": "https://stackoverflow.com/questions/49036461/c-preprocessor-if-handling-of-non-integer-constant", "title": "C Preprocessor #if handling of non-integer constant", "body": "<p>I have the following code snippet to allow me flip easily between double and float representations of floating point values:</p>\n\n<pre><code>#define FLOATINGPOINTSIZE 64\n\n#if FLOATINGPOINTSIZE == 64\ntypedef double FP_TYPE;\n#define FP_LIT_SUFFIX \n#else\ntypedef float FP_TYPE;\n#define FP_LIT_SUFFIX f\n#endif\n</code></pre>\n\n<p>At another location I had written the following:</p>\n\n<pre><code>/* set floating point limits used when initialising values that will be subject\n * to the MIN() MAX() functions\n *\n * uses values from float.h */\n#if FP_TYPE == double\n#define FPTYPE_MAX DBL_MAX\n#define FPTYPE_MIN DBL_MIN\n#else\n#define FPTYPE_MAX FLT_MAX\n#define FPTYPE_MIN FLT_MIN\n#endif\n</code></pre>\n\n<p>whereas I think I should have written:</p>\n\n<pre><code>#if FLOATINGPOINTSIZE == 64\n</code></pre>\n\n<p>I have <code>-Wall</code> compiler setting to give me plenty of warnings but this didn't get flagged up as an issue. Possibly <code>-Wall</code> is completely independent of the preprocessor though?  </p>\n\n<p>My question is how is the preprocessor interpreting:</p>\n\n<pre><code>#if FP_TYPE == double\n</code></pre>\n\n<p>The meaning is obvious to the programmer, but I'm not sure what the preprocessor makes of it?</p>\n\n<p>Its got to be a bug right?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519842925, "post_id": 49036306, "comment_id": 85077596, "body": "Making changes to the first element always"}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519843054, "post_id": 49036306, "comment_id": 85077656, "body": "Yea I thought about that but how can I manage the pointers to not make to changes to the first element always? @coderredoc"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 5, "last_activity_date": 1519843536, "last_edit_date": 1519843536, "creation_date": 1519843142, "answer_id": 49036392, "question_id": 49036306, "link": "https://stackoverflow.com/questions/49036306/adding-structs-to-dynamic-array-in-c/49036392#49036392", "title": "adding structs to dynamic array in C", "body": "<p>You have reallocated memory (suppose for <code>N</code> elements). Now for <code>N-1</code> elements would be the old ones and the last one would be extra element that you will get for this reallocation. </p>\n\n<p>So supposedly, the change should made to the last element. For example you would copy to <code>array[N-1].id</code> and same goes with other members also. That way you won't be overwriting the first element always with the newly added one. \nExample wise:-</p>\n\n<pre><code>strcpy(array[n-1].id, newanimal.id);\n</code></pre>\n\n<p>There is also another thing that you should check - the return value of <code>realloc</code> - it might return <code>NULL</code> in case of failure. Check it and if it non-NULL then only assign to designated pointer variable. Same thing I would have to say for <code>malloc</code> - check the return value.</p>\n\n<p>I would write <code>realloc</code> like this:-</p>\n\n<pre><code>struct animal *newarray = realloc(array,  n * sizeof *newarray);\nif(!newarray){\n   perror(\"realloc\");\n   exit(EXIT_FAILURE);\n}\narray = newarray;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1519843581, "post_id": 49036395, "comment_id": 85077883, "body": "or just use <code>array[size]</code>, which is <code>array[n-1]</code> per the remedial math prior."}, {"owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519844109, "post_id": 49036395, "comment_id": 85078166, "body": "Got it now thanks for you but like if I write lets say  &quot;array[n-1].id&quot; then what would be the same thing with arrow because &quot;array[n-1]-&gt;id&quot; is not working cause its pointer that way? @dbush"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "edited": false, "score": 0, "creation_date": 1519844304, "post_id": 49036395, "comment_id": 85078287, "body": "@michael The array index operator does an implicit pointer dereference.  Specifically, <code>array[i]</code> is the same as <code>*(array + i)</code>.  Since <code>array</code> has type <code>struct animal *</code>, <code>array[i]</code> has type <code>struct animal</code>, so you can&#39;t use <code>-&gt;</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1519843158, "creation_date": 1519843158, "answer_id": 49036395, "question_id": 49036306, "link": "https://stackoverflow.com/questions/49036306/adding-structs-to-dynamic-array-in-c/49036395#49036395", "title": "adding structs to dynamic array in C", "body": "<p><code>array</code> points to the first element of the list.  When you do this:</p>\n\n<pre><code>array-&gt;age = newanimal.age;\n</code></pre>\n\n<p>You're dereferencing that pointer and thus only updating the first element of the list.</p>\n\n<p>Since you have a pointer to the start of an array, you can index it like an array:</p>\n\n<pre><code>array[n-1].age = newanimal.age;\n</code></pre>\n\n<p>So anyplace in <code>add_record</code> you do a pointer to member dereference like <code>array-&gt;xxx</code> change it to an array index and member accesss like <code>array[n-1].xxx</code>.</p>\n\n<p>Note that we use <code>n-1</code> for the index since an array of size <code>n</code> has indexes from <code>0</code> to <code>n-1</code>.</p>\n"}], "owner": {"reputation": 87, "user_id": 9317849, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f80ccaee2c800b74e07c206aada91cd6?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/9317849/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49036392, "answer_count": 2, "score": 0, "last_activity_date": 1537595792, "creation_date": 1519842794, "last_edit_date": 1537595792, "question_id": 49036306, "link": "https://stackoverflow.com/questions/49036306/adding-structs-to-dynamic-array-in-c", "title": "adding structs to dynamic array in C", "body": "<blockquote>\n  <p>Implement function <code>add_record</code> that adds a new struct animal record to the dynamic array, and reallocates the array as needed. The start of the dynamic array is given in parameter <code>array</code>, and the current length of the array is given in parameter <code>size</code>. The new information to be added is given as parameter <code>newanimal</code>. Note that the content of <code>newanimal</code> needs to be copied to the array. Pay attention to which parameters are pointers and which are not.\n  The function returns address to the dynamic array after the addition.</p>\n</blockquote>\n\n<p>That's my assignment here, can someone explain me why my function <code>add_record</code> is not working ? Anything else here cannot be changed, only the function <code>add_record</code> can be.</p>\n\n<p>My code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\n\n// Single animal entry\nstruct animal {\n    char id[7]; // animal ID (6 characters) + terminating '\\0'\n    char *name; // animals name\n    char *species; // animal species (string)\n    unsigned char age; // animals age\n    struct date entrydate;  // date of the animals arrival\n};\n\nstruct animal *add_record(struct animal *array, unsigned int size, struct animal newanimal) \n{\n    int n = size + 1;\n    struct animal *newarray = realloc(array,  n*sizeof(struct animal));\n    array = newarray; \n\n    strcpy(array-&gt;id, newanimal.id); //copying new id to array\n\n    array-&gt;name = malloc(strlen(newanimal.name) + 1); //allocating memory for the string\n    strcpy(array-&gt;name, newanimal.name);   //copying the new name to array\n\n    array-&gt;species = malloc(strlen(newanimal.species) + 1); //allocating memory for the string\n    strcpy(array-&gt;species, newanimal.species); //copying the new species to array\n\n    array-&gt;age = newanimal.age;\n\n    array-&gt;entrydate = newanimal.entrydate;\n\n    return array;\n}\n\n\nint main()\n{\n    /*making new animal zoo which I want to which all of them I need to\n      add to array in function add_record*/\n\n    struct animal zoo[] = {\n        { \"123456\", \"Winnie-the-Pooh\", \"Bear\", 94,{ 1,1,1924 } },\n        { \"555666\", \"Eeyore\", \"Donkey\", 92,{ 1,1,1926 } },\n        { \"773466\", \"Piglet\", \"Very Small Animal\", 30,{ 31, 12, 2015 } },\n        { \"234567\", \"Roo\", \"Kangaroo\", 5,{ 31, 12, 2015 } }\n    };\n\n    struct animal *array = NULL;\n    unsigned int len = 0;\n    for (unsigned int i = 0; i &lt; sizeof(zoo) / sizeof(struct animal); i++) {\n        struct animal *newarray = add_record(array, len, zoo[i]);\n        len++;\n        array = newarray;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "openmpi"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537167353, "post_id": 49036279, "comment_id": 91668640, "body": "This basically asking for a tutorial, which is off-topic on StackOverflow."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1537189345, "post_id": 49036279, "comment_id": 91680979, "body": "FWIW, Open MPI is packaged by brew, which makes installation trivial."}], "owner": {"reputation": 59, "user_id": 8750607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95f3b65de8922209f2399161be3da46a?s=128&d=identicon&r=PG&f=1", "display_name": "wnl2367", "link": "https://stackoverflow.com/users/8750607/wnl2367"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 534, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537167321, "creation_date": 1519842687, "last_edit_date": 1537167321, "question_id": 49036279, "link": "https://stackoverflow.com/questions/49036279/install-open-mpi-mac-and-run-mpicc-and-mpiexec-on-c-programming-file", "title": "Install Open MPI mac and run mpicc and mpiexec on c programming file", "body": "<p>I want to install Open MPI on my MacBook Pro, and use terminal to run mpicc and mpiexec for my c programming file.  </p>\n\n<p>How can do it after I download the file(openmpi-3.0.0.tar.gz) from<br>\n<a href=\"https://www.open-mpi.org/software/ompi/v3.0/\" rel=\"nofollow noreferrer\">https://www.open-mpi.org/software/ompi/v3.0/</a>???</p>\n"}, {"tags": ["c", "syntax-error", "out-of-memory", "ctime"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519842571, "post_id": 49036215, "comment_id": 85077416, "body": "The <code>cards</code> array has an extra <code>,</code>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519842696, "post_id": 49036215, "comment_id": 85077480, "body": "You can&#39;t use <code>namespace</code> in c, and you are apparently trying to. Why?"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1519842783, "post_id": 49036215, "comment_id": 85077522, "body": "<code>#include &lt;ctime&gt;</code>  --&gt; <code>#include &lt;time.h&gt;</code> Header files without &quot;.h&quot; are usually C++ header files."}, {"owner": {"reputation": 29, "user_id": 9318062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31bdd48b9a61ce649a55b4ba9b5f6001?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaBryden", "link": "https://stackoverflow.com/users/9318062/ninjabryden"}, "edited": false, "score": 0, "creation_date": 1519842919, "post_id": 49036215, "comment_id": 85077592, "body": "Ok so I switched to time.h, but the problem with ctime unable to close still persists"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519955108, "post_id": 49036215, "comment_id": 85128163, "body": "If you want to answer your own question, just <a href=\"https://stackoverflow.com/help/self-answer\">post an answer</a>. Don&#39;t edit your question."}], "owner": {"reputation": 29, "user_id": 9318062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31bdd48b9a61ce649a55b4ba9b5f6001?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaBryden", "link": "https://stackoverflow.com/users/9318062/ninjabryden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519954977, "creation_date": 1519842390, "last_edit_date": 1519954977, "question_id": 49036215, "link": "https://stackoverflow.com/questions/49036215/ctime-error-making-me-unable-to-close-the-source-file-tab", "title": "ctime Error making me unable to close the source file tab", "body": "<p>I am attempting to use ctime in my .c source file code, but for some reason ctime is getting several syntax errors. Additionally, I cannot even close Visual Studios or the ctime tab at all because I keep getting an error saying \"The operation cannot be completed. Not enough storage is available to complete this operation\". Also, when I attempt to compile my code again I am taken to save a file, but the save button does not work at all. I am essentially stuck having my VS window up with no way to remove ctime to try something else. What should I do to deal with this issue?</p>\n\n<p>EDIT: This is the file attempting to save even when I switch to time.h</p>\n\n<p>c:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\VC\\Tools\\MSVC\\14.11.25503\\include\\ctime.*</p>\n\n<p>ctime syntax:</p>\n\n<pre><code>// ctime standard header\n#pragma once\n#ifndef _CTIME_\n#define _CTIME_\n#include &lt;yvals.h&gt;\n#include &lt;time.h&gt;\n\n#ifndef RC_INVOKED\n_STD_BEGIN\nusing _CSTD clock_t; using _CSTD size_t;\nusing _CSTD time_t; using _CSTD tm;\nusing _CSTD asctime; using _CSTD clock; using _CSTD ctime;\nusing _CSTD difftime; using _CSTD gmtime; using _CSTD localtime;\nusing _CSTD mktime; using _CSTD strftime; using _CSTD time;\n_STD_END\n#endif /* RC_INVOKED */\n#endif /* _CTIME_ */\n\n/*\n* Copyright (c) by P.J. Plauger. All rights reserved.\n* Consult your license regarding permissions and restrictions.\nV6.50:0009 */\n</code></pre>\n\n<p>Errors:</p>\n\n<p>-identifier \"namespace\" is undefined   Line 9</p>\n\n<p>-PCH warning: header stop needs to be at global scope. An IntelliSense PCH file was not generated   Line 17</p>\n\n<p>-syntax error: identifier 'std'   Line 9</p>\n\n<p>-syntax error: ';'   Line 9</p>\n\n<p>-found '{' at file scope (missing function header?)   Line 9</p>\n\n<p>-syntax error: '}'   Line 15</p>\n\n<p>-unexpected end-of-file found (My original .c file)   Line 75 (I only have 74 lines)</p>\n\n<p>My current code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;time.h&gt; //Edited from #include &lt;ctime&gt;\n\nvoid dealCard(char hand[][5]);\n\n//Global variables\nchar cards[5][14] =\n{\n    { 'A', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'T', 'K', 'Q', 'J' },\n    { 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C', 'C' },\n    { 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D', 'D' },\n    { 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H', 'H' },\n    { 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S', 'S' }\n};\nchar p1Hand[2][5] =\n{\n    { NULL, NULL, NULL, NULL, NULL },\n    { NULL, NULL, NULL, NULL, NULL }\n};\nchar p2Hand[2][5] =\n{\n    { NULL, NULL, NULL, NULL, NULL },\n    { NULL, NULL, NULL, NULL, NULL }\n};\n\nchar p1Name[15], p2Name[15];\n\nint main()\n{\n    srand(time(0));\n    printf(\"-------------\\n    POKER\\n-------------\\n\\n[CHARACTERS AFTER A SPACE WILL BE IGNORED]\\n\");\n    printf(\"\\nPlease enter player 1's name: \");\n    scanf(\" %[^\\n]%*c\", &amp;p1Name);\n    printf(\"%s\", p1Name);\n    getchar();\n\n\n    return 0;\n}\n\nvoid dealCard(char hand[][5])\n{\n    int x, y;\n    bool added = false;\nreset:\n    //Chooses a random card from the deck\n    x = (rand() % 4) + 1;\n    y = rand() % 14;\n\n    //Adds the card to the hand\n    if (cards[x][y] != NULL)\n    {\n        for (int i = 0; added == false; i++)\n        {\n            if (hand[0][i] == NULL)\n            {\n                added = true;\n                hand[0][i] = cards[0][y];\n                hand[1][i] = cards[x][y];\n                cards[x][y] = NULL;\n            }\n        }\n    }\n    else\n    {\n        goto reset;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "stdout", "stdin", "io-redirection", "bidirectional"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1519842437, "post_id": 49036209, "comment_id": 85077346, "body": "It is operating system specific, and it probably is not a good idea"}, {"owner": {"reputation": 125, "user_id": 3950614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ab8d2e24364992d1fb243f90d0ce2b?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Lawson", "link": "https://stackoverflow.com/users/3950614/connor-lawson"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1519844832, "post_id": 49036209, "comment_id": 85078574, "body": "I&#39;m not here to debate whether this is the best solution for my use case. There are certainly other ways to test the same thing. I&#39;m bothered by the lack of symmetry between STDIN/STOUT and other bidirectional files, and I want to know if it&#39;s possible to make this consistent."}], "answers": [{"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 2, "last_activity_date": 1519905756, "last_edit_date": 1519905756, "creation_date": 1519845780, "answer_id": 49037073, "question_id": 49036209, "link": "https://stackoverflow.com/questions/49036209/c-redirect-standard-input-output-to-a-single-bidirectional-file-descriptor/49037073#49037073", "title": "C - Redirect Standard Input/Output to a single, bidirectional file descriptor", "body": "<p>[I'm not sure this will answer your question, and I was going to just put it as a comment, but it got too long.]</p>\n\n<p>There are certainly many examples of \"bidirectional\" file descriptors in Unix and Linux -- serial ports and TCP streams pop immediately to mind.</p>\n\n<p>If you have one of those, you can set up a process that both reads and writes to it (that is, that uses that one fd as both stdin and stdout) by using <code>dup</code> or <code>dup2</code> to set it up as fd's 0, 1, <em>and</em> 2.</p>\n\n<p>Finally, if you're a process and you believe you've been given a bidirectional fd as 0, 1, and 2, you can just grab 0, 1, or 2 and both read from and write to it (that is, write to 0 or read from 1).</p>\n\n<p>But if fd's 0 and 1 aren't clones of each other, I don't know of a way to \"combine\" them into a single fd that permits both reading and writing.</p>\n\n<hr>\n\n<p>Addendum: You mentioned the nuisance of carrying around two file descriptors if you're using a standard Unix pipe.  I think the \"bidirectional\" alternative to a standard pipe would be a Unix-domain socket (evidently now called <code>PF_LOCAL</code>).</p>\n"}], "owner": {"reputation": 125, "user_id": 3950614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ab8d2e24364992d1fb243f90d0ce2b?s=128&d=identicon&r=PG&f=1", "display_name": "Connor Lawson", "link": "https://stackoverflow.com/users/3950614/connor-lawson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 49037073, "answer_count": 1, "score": 0, "last_activity_date": 1519905756, "creation_date": 1519842349, "last_edit_date": 1519845255, "question_id": 49036209, "link": "https://stackoverflow.com/questions/49036209/c-redirect-standard-input-output-to-a-single-bidirectional-file-descriptor", "title": "C - Redirect Standard Input/Output to a single, bidirectional file descriptor", "body": "<p>In certain contexts, such as when dealing with a serial device file, I am able to open a bidirectional file descriptor. However, STDIN/STDOUT are two separate, unidirectional files. <strong>Is it possible to create a bidirectional file descriptor from STDIN/STDOUT?</strong> I ask for interface symmetry purposes: when writing user functions that need to both <code>read</code> and <code>write</code>, it is inconvenient to need to specify a file descriptor for both directions (only) when dealing with standard pipes.</p>\n\n<p>There is a lot of discussion available about redirecting STDIN/STDOUT (for example using <code>dup2</code>), but this discussion is mostly concerned with piping input to/from subprocesses. I haven't found any information for combining two file descriptors into one.</p>\n\n<hr>\n\n<p>EDIT: Here's the original context for the question. <em>I don't care about solving this particular problem</em>; there are plenty of workarounds. I want to know about combining two unidirectional FDs into a single bidirectional one.</p>\n\n<p>I am developing a C utility to control some fancy electronics over UART on Linux, and I would like to test the input/output of my code by using canned transactions from a file. That is, my mocked device responses will come from a text file that I create beforehand and pipe in through STDIN, while the sent commands will go to STDOUT and be saved to a file. This will allow transaction validation before connecting the real electronics, which could malfunction if mishandled.</p>\n"}, {"tags": ["c++", "c", "ubuntu", "centos7", "g++4.8"], "comments": [{"owner": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 1, "creation_date": 1519842744, "post_id": 49036167, "comment_id": 85077506, "body": "GCC 5.1 itroduced a new <code>ABI</code>. Maybe worth looking at this <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/libstdc++/manual/using_dual_abi.html</a>"}, {"owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519845177, "post_id": 49036167, "comment_id": 85078756, "body": "@Iharob Thanks taking the time. If I had a choice, I&#39;d do the whole this in c++ like you suggested. Unfortunately, sometimes our hands are tied and we have to make things work in certain environments. That&#39;s where I am running into these sort of issues."}, {"owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "reply_to_user": {"reputation": 42006, "user_id": 3807729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UEUbF.jpg?s=128&g=1", "display_name": "Galik", "link": "https://stackoverflow.com/users/3807729/galik"}, "edited": false, "score": 0, "creation_date": 1519845479, "post_id": 49036167, "comment_id": 85078935, "body": "@Galik, Thanks for looking into this. On your GCC 5.1 suggestion, centos7 default GCC version is 4.8.5. I&#39;d like to move to 5.x, but I have to work with the std libraries available on the platform :("}, {"owner": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1519845826, "post_id": 49036167, "comment_id": 85079132, "body": "Calling C++ functions from C works perfectly fine if they&#39;re implemented as <code>extern &quot;C&quot;</code> and don&#39;t throw exceptions. Your problem has nothing to do with C vs C++. You just have a plain old code bug somewhere."}, {"owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "reply_to_user": {"reputation": 46978, "user_id": 856199, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CPtki.png?s=128&g=1", "display_name": "Nikos C.", "link": "https://stackoverflow.com/users/856199/nikos-c"}, "edited": false, "score": 0, "creation_date": 1519846376, "post_id": 49036167, "comment_id": 85079421, "body": "Thanks @Nikos. I thought so too about &#39;extern &quot;C&quot;&#39; stuff. However, if you look at the GDB session output things are changing as soon I enter the c++ function. BTW, this is in a single-threaded environment. You could still be correct about something else going on here which what I am trying to figure out."}], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "is_accepted": true, "score": 1, "last_activity_date": 1519857675, "creation_date": 1519857675, "answer_id": 49039855, "question_id": 49036167, "link": "https://stackoverflow.com/questions/49036167/crash-when-calling-c-function-from-c/49039855#49039855", "title": "Crash when calling C++ function from C", "body": "<p>It turns out my c++ and C libraries were getting compiled with different #defines, as a result, the C data-structure was different in both the libraries. This results in misaligned access on the c++ side. This problem could have happened in two c libraries as well.</p>\n\n<p>Thanks to all who responded.</p>\n"}], "owner": {"reputation": 301, "user_id": 5286435, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c377241bb619c9254d07897baaa86a8?s=128&d=identicon&r=PG&f=1", "display_name": "Dnj Abc", "link": "https://stackoverflow.com/users/5286435/dnj-abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 49039855, "answer_count": 1, "score": 0, "last_activity_date": 1519857675, "creation_date": 1519842171, "question_id": 49036167, "link": "https://stackoverflow.com/questions/49036167/crash-when-calling-c-function-from-c", "title": "Crash when calling C++ function from C", "body": "<p>I have a C++ library function which I am calling from a C function. The call passes in a C data-structure that is accessed by the C++ code. My program crashes in the C++ code when accessing the C data-structure. I've followed all the instructions in <a href=\"https://isocpp.org/wiki/faq/mixing-c-and-cpp\" rel=\"nofollow noreferrer\">C++ faq</a> related to mixing C-to-C++.</p>\n\n<p>The crash happens on a centos7 machine. Running the same code in debug mode does not result in a crash. The same code running on Ubuntu (16.04) does not result in a crash. Here's the GDB analysis of the crash.</p>\n\n<pre><code>(gdb) frame 5\n#5  0x00007fc28e79226e in ngx_http_setup_handler (r=0x2469040)\n    at /opt/platform/nginx-noname-module.c:201\n201       return ModProcessGetApi(r);\n(gdb) p r-&gt;unparsed_uri\n$1 = {len = 15, data = 0x24572c4 \"/__xx/stats/all HTTP/1.1\\r\\nUser-Agent\"}\n(gdb) down\n#4  0x00007fc28e7945b4 in ModProcessGetApi (r=r@entry=0x2469040)\n    at /opt/platform/nginx-body-handler.cc:274\n274   ss_rval_t rv = ProcessGetRequest(r, data, &amp;dsize);\n(gdb) p r-&gt;unparsed_uri\n$2 = {len = 38105792, data = 0xf &lt;Address 0xf out of bounds&gt;}\n(gdb)\n</code></pre>\n\n<p>As soon as the execution enters the C++ code, the C data structure shows address out of bounds. Here's is the glue code for c-to-c++ functions.</p>\n\n<pre><code>#if __cplusplus\nextern \"C\" {\n#endif\n\n#include &lt;nginx.h&gt;\n#include &lt;ngx_core.h&gt;\n#include &lt;ngx_log.h&gt;\n#include &lt;ngx_http.h&gt;\n\nngx_int_t ModPostRequestBodyHandler(ngx_http_request_t *r);\nngx_int_t ModProcessGetApi(ngx_http_request_t* r);\n\n#if __cplusplus\n}\n#endif\n</code></pre>\n\n<p>I would appreciate it if someone can shed some light on this. Are there any compiler options I need to use when mixing C and C++ code so that the C++ code can access the C data-structure properly? Here's the OS and compiler info:</p>\n\n<p>Centos Version: Crash happens</p>\n\n<p>OS: Centos 7, C++: g++ 4.8.5</p>\n\n<p>Ubuntu Versions: Crash does not happen.</p>\n\n<p>OS: Ubuntu 16.04, C++: g++ 5.4.0</p>\n\n<p>Not sure if it matters but I am running my app in a docker container on both OSes.</p>\n"}, {"tags": ["c", "openssl"], "answers": [{"comments": [{"owner": {"reputation": 5609, "user_id": 320594, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a910737958b20c55ae15e93529d11a09?s=128&d=identicon&r=PG", "display_name": "Jaime Hablutzel", "link": "https://stackoverflow.com/users/320594/jaime-hablutzel"}, "edited": false, "score": 0, "creation_date": 1520018249, "post_id": 49039857, "comment_id": 85157660, "body": "Maybe OpenSSL documentation should improve the following sentence:  <i>&quot;BIO_puts() attempts to write a null terminated string buf to BIO b.&quot;</i> in <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/BIO_puts.html#DESCRIPTION\" rel=\"nofollow noreferrer\">openssl.org/docs/man1.0.2/crypto/BIO_puts.html#DESCRIPTION</a> to clarify that even when it requires the input of a null-terminated string it won&#39;t write a null-terminated string."}], "tags": [], "owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "is_accepted": true, "score": 2, "last_activity_date": 1519857683, "creation_date": 1519857683, "answer_id": 49039857, "question_id": 49036152, "link": "https://stackoverflow.com/questions/49036152/correct-way-to-write-and-read-a-null-terminated-string-with-an-openssl-memory-bi/49039857#49039857", "title": "Correct way to write and read a null-terminated string with an OpenSSL memory BIO", "body": "<p>BIO_puts writes all the data in a string up until the NUL terminator - but it does not include the NUL terminator itself. Instead use BIO_write():</p>\n\n<pre><code>const char *mystr = \"Hello World\\n\";\n\nBIO_write(mem, mystr, strlen(mystr) + 1);\n</code></pre>\n\n<p>Or alternatively:</p>\n\n<pre><code>BIO_puts(mem, \"Hello World\\n\");\nBIO_write(mem, \"\", 1);\n</code></pre>\n"}], "owner": {"reputation": 5609, "user_id": 320594, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a910737958b20c55ae15e93529d11a09?s=128&d=identicon&r=PG", "display_name": "Jaime Hablutzel", "link": "https://stackoverflow.com/users/320594/jaime-hablutzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "accepted_answer_id": 49039857, "answer_count": 1, "score": 0, "last_activity_date": 1519857683, "creation_date": 1519842129, "question_id": 49036152, "link": "https://stackoverflow.com/questions/49036152/correct-way-to-write-and-read-a-null-terminated-string-with-an-openssl-memory-bi", "title": "Correct way to write and read a null-terminated string with an OpenSSL memory BIO", "body": "<p>If you execute the following example (almost entirely based on the official <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/BIO_s_mem.html#EXAMPLE\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.0.2/crypto/BIO_s_mem.html#EXAMPLE</a>):</p>\n\n<pre><code>#include &lt;openssl/bio.h&gt;\n#include &lt;openssl/buffer.h&gt;\n\nint main() {\n    BIO *mem = BIO_new(BIO_s_mem());\n    BIO_puts(mem, \"Hello World\\n\");\n\n    BUF_MEM *bptr;\n    BIO_get_mem_ptr(mem, &amp;bptr);\n    BIO_set_close(mem, BIO_NOCLOSE); /* So BIO_free() leaves BUF_MEM alone */\n    BIO_free(mem);\n\n    printf(\"%s\", bptr-&gt;data);\n\n    BUF_MEM_free(bptr);\n    return 0;\n}\n</code></pre>\n\n<p>It just <em>might</em> work as expected depending on the possibility that the uninialised <code>char</code> in the underlying memory buffer after the <code>\\n</code> is <code>\\000</code> by chance and this can be confirmed with the Valgrind report:</p>\n\n<pre><code>==17122== Conditional jump or move depends on uninitialised value(s)\n==17122==    at 0x52CCCC0: vfprintf (vfprintf.c:1632)\n==17122==    by 0x52D3898: printf (printf.c:33)\n==17122==    by 0x4008CC: main (test1.c:13)\n==17122==  Uninitialised value was created by a heap allocation\n==17122==    at 0x4C2DB8F: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)\n==17122==    by 0x4E9CE77: CRYPTO_malloc (in /lib/x86_64-linux-gnu/libcrypto.so.1.0.0)\n==17122==    by 0x4F4A4B3: BUF_MEM_grow_clean (in /lib/x86_64-linux-gnu/libcrypto.so.1.0.0)\n==17122==    by 0x4F4BBDD: mem_write (in /lib/x86_64-linux-gnu/libcrypto.so.1.0.0)\n==17122==    by 0x4F4AC8E: BIO_puts (in /lib/x86_64-linux-gnu/libcrypto.so.1.0.0)\n==17122==    by 0x40086E: main (test1.c:6)\n</code></pre>\n\n<p>Anyway, I have seen that this happened because the <code>BIO_puts</code> didn't write a null-terminated string into the memory BIO, even when <a href=\"https://www.openssl.org/docs/man1.0.2/crypto/BIO_puts.html\" rel=\"nofollow noreferrer\">https://www.openssl.org/docs/man1.0.2/crypto/BIO_puts.html</a> says:</p>\n\n<blockquote>\n  <p>BIO_puts() attempts to write a null terminated string buf to BIO b.</p>\n</blockquote>\n\n<p>So my question is what is the right way to write and read a null-terminated string with an OpenSSL memory BIO.</p>\n\n<p>Additionally, \u00bfusing this API in this way couldn't leak sensitive data?.</p>\n\n<p>Note I'm using OpenSSL <code>1.0.2g</code>.</p>\n"}, {"tags": ["c", "scanf", "interrupt"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519841597, "post_id": 49036017, "comment_id": 85076899, "body": "You can, just type something that is not numbers and press enter."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519841614, "post_id": 49036017, "comment_id": 85076912, "body": "Read a <i>line</i> of user input into a <i>string</i> with <code>fgets()</code>, then parse it for <code>int</code>."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1519841617, "post_id": 49036017, "comment_id": 85076917, "body": "Just enter <code>coderredoc</code> and it would fail. (Anything not a number you can put and press enter - it would fail."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1519841860, "post_id": 49036017, "comment_id": 85077048, "body": "Note that the trailing newline in the format string forces <code>scanf()</code> to keep reading until it gets a non-white-space character in the input after the 6th number."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1537167592, "post_id": 49036017, "comment_id": 91668755, "body": "Do you really have problems with getting the else part executed?  I feel that the idea of this is that it actually is meant to be the <i>easy</i> part. Can you describe what you do that gets the &quot;then&quot; part executed?"}], "owner": {"reputation": 1, "user_id": 9413851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T_R2gvwb4-k/AAAAAAAAAAI/AAAAAAAAAGs/-zYiQz5lCHg/photo.jpg?sz=128", "display_name": "Solo Trench", "link": "https://stackoverflow.com/users/9413851/solo-trench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "closed_date": 1519841808, "answer_count": 0, "score": 0, "last_activity_date": 1519841539, "creation_date": 1519841539, "question_id": 49036017, "link": "https://stackoverflow.com/questions/49036017/how-can-i-stop-reading-for-values-and-execute-the-else-statement", "closed_reason": "Duplicate", "title": "How can I stop reading for values and execute the else statement", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{   \n\n\n    int a, b, c, d, e, f, r=0; \n    r=scanf(\"%d %d %d %d %d %d\\n\", &amp;a, &amp;b, &amp;c, &amp;d, &amp;e, &amp;f);\n    if(r==6)\n    {\n        printf( \"Hello\" );\n    } \n    else\n    {\n        printf( \"BOOM!!\\n\" );\n        printf(\"The bomb has blown up\");\n    }\n\n}\n</code></pre>\n\n<p>I want the scanf to take only few inputs &lt; 6 and jump to the else part and execute it.</p>\n"}, {"tags": ["java", "c++", "c", "reverse-engineering", "libraries"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1519841336, "post_id": 49035917, "comment_id": 85076780, "body": "Note that there is no such languages as &quot;C/C++&quot;. There exists two <b><i>very</i></b> different languages C and C++ though."}, {"owner": {"reputation": 353, "user_id": 1859532, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/foSD1.jpg?s=128&g=1", "display_name": "Carl Jokl", "link": "https://stackoverflow.com/users/1859532/carl-jokl"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519844396, "post_id": 49035917, "comment_id": 85078340, "body": "This is true but C++ builds on C in a way designed to allow it to still interoperate with it and maintain levels of compatibility. The C++ runtime builds on top of C functionality such as when creating objects with &quot;new&quot; or deleting them leading to calls to alloc and free behind the scenes."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1519998157, "post_id": 49035917, "comment_id": 85145735, "body": "@CarlJokl, your assumptions are far very simplistic.  C++ allows for operator and function overload, for example, thing that you are obviating, and not obvious at all... only to put an example of how different languages they are."}, {"owner": {"reputation": 353, "user_id": 1859532, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/foSD1.jpg?s=128&g=1", "display_name": "Carl Jokl", "link": "https://stackoverflow.com/users/1859532/carl-jokl"}, "edited": false, "score": 0, "creation_date": 1519999108, "post_id": 49035917, "comment_id": 85146343, "body": "The difference in the language isn&#39;t really the point. C++ can make direct calls to C functions without having to go through a compatibility layer. For example a C++ program can use OpenGL functions exposed in plain C. A C program can call Direct3D implemented as C++ (albeit more messy). None of this requires a native ABI translation layer like JNI or PInvoke. Objective-C can call C directly as well but is a very different style of language. So I am talking about direct interoperability of the languages, not the specific syntax."}, {"owner": {"reputation": 353, "user_id": 1859532, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/foSD1.jpg?s=128&g=1", "display_name": "Carl Jokl", "link": "https://stackoverflow.com/users/1859532/carl-jokl"}, "edited": false, "score": 0, "creation_date": 1519999634, "post_id": 49035917, "comment_id": 85146676, "body": "An equivalent grouping might be things like Java, Scala, Groovy, Clojure etc which have very different syntax but due to running on the Java Virtual Machine are able to make calls into each other. Equivalents too would be the .Net family where C# .net and VB .net can call common libraries even though the syntax is very different it runs on the CLR and has a common language interface so the languages can call each other relatively directly."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 1859532, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/foSD1.jpg?s=128&g=1", "display_name": "Carl Jokl", "link": "https://stackoverflow.com/users/1859532/carl-jokl"}, "edited": false, "score": 0, "creation_date": 1519907608, "post_id": 49036827, "comment_id": 85103733, "body": "Thank you for the detailed answer. This relates to a discussion I had about tools that call into Minecraft world generation algorithms in order to try and determine the location of certain rare generated points of interest. So far I have only seen tools do this for the Java version. I questioned if it was practical to do the same thing with the native (&quot;Bedrock&quot;) edition. Not impossible, but certainly much more difficult."}], "tags": [], "owner": {"reputation": 119371, "user_id": 1919155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d7d26642f016f64f37619d209037dff?s=128&d=identicon&r=PG", "display_name": "Mats Petersson", "link": "https://stackoverflow.com/users/1919155/mats-petersson"}, "is_accepted": true, "score": 1, "last_activity_date": 1519844840, "creation_date": 1519844840, "answer_id": 49036827, "question_id": 49035917, "link": "https://stackoverflow.com/questions/49035917/c-c-exposure-of-functions-methods-vs-java/49036827#49036827", "title": "C/C++ exposure of functions / methods vs Java", "body": "<p>First of all, there are tools (of varying quality and capabilities) to reverse engineer compiled machine-code back to the original language [or another language, for that matter]. The biggest problem when doing this is that languages such as C and C++, the names of members in a structure don't have names, and often become \"flat\", so what is originally:</p>\n\n<pre><code> struct user\n {\n    std::string name;\n    int age;\n    int score;\n };\n</code></pre>\n\n<p>will become:</p>\n\n<pre><code> struct s0\n {\n     char *f0;\n     char *f1;\n     int f2;\n     int f3;\n };\n</code></pre>\n\n<p>[Note of course that <code>std::string</code> may be implemented in a dozen different ways, and the \"two pointers\" is just one plausible variant]</p>\n\n<p>Of course, if there is a header file describing how the library works, you can use the data structures in that to get better type information. Likewise, if there is debug information in the file, it can be used to form data structures and variable names in a much better way. But someone who wants to keep these things private will (most often) not ship the code with debug symbols, and only publish the actual necessary parts to call the public functionality.</p>\n\n<p>But if you understand how these are used [or read some code that for example displayed a \"user\", you can figure out what is the name, the age and what is the score.</p>\n\n<p>Understanding what is an array and what is separate fields can also be difficult. Which is it:</p>\n\n<pre><code> struct\n {\n    int x, y, z;\n };\n</code></pre>\n\n<p>or</p>\n\n<pre><code> int arr[3];\n</code></pre>\n\n<p>Several years ago, I started on a patience card game (Similar to \"Solitaire\"). To do that, I needed a way to display cards on the screen. So I thought \"well, there's one for the existing Solitaire on Windows, I bet I can figure out how to use that\", and indeed, I did. I could draw the Queen of Clubs or Two of Spades, as I wished. I never finished the actual game-play part, but I certainly managed to load the card-drawing functionality from a non-public shared library. Not rocket science by any means (there are people who do this for commercial games with thousands of functions and really complex data structures - this had two or three functions that you needed to call), but I didn't spend much time on it either, a couple of hours if I remember right, from coming up with the idea to having something that \"works\".</p>\n\n<p>But for the second part of your question, plugin-interfaces (such as filter plugins to Photoshop, or transitions in video editors), are very often implemented as \"shared libraries\" (aka \"dynamic link libraries\", DLLs).</p>\n\n<p>There are functions in the OS to load a shared library into memory, and to query for functions by their name. The interface of these functions is (typically) pre-defined, so a function pointer prototype in a header-file can be used to form the actual call.</p>\n\n<p>As long as the compiler for the shared library and the application code are using the the same ABI (application binary interface), all should work out when it comes to how arguments are passed from the caller to the function - it's not like the compiler just randomly uses whatever register it fancies, the parameters are passed in a well-defined order and which register is used for what is defined by the ABI specification for a given processor architecture. [It gets further more complicated if you have to know the contents of data structures, and there are different versions of such structures - say for example someone has a <code>std::string</code> that contains two pointers (start and end), and for whatever reason, the design is changed to be one pointer and a length - both the application code and the shared library need to be compiled with the same version of <code>std::string</code>, or bad things will happen!]</p>\n\n<p>Non-public API functions CAN be called, but they wouldn't be discoverable by calling the query for finding a function by name - you'd have to figure out some other way - for example by knowing that \"this function is 132 bytes on from the function XYZ\", and of course, you wouldn't have the function prototype either.</p>\n\n<p>There is of course the added complication where Java Bytecode is portable for many different processor architectures, machine code only works on a defined set of processors - code for x86 works on Intel and AMD processors (and maybe a few others), code for ARM processors work in chips developed with the ARM instruction set, and so on. You have to compile the C or C++ code for the given process.</p>\n"}], "owner": {"reputation": 353, "user_id": 1859532, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/foSD1.jpg?s=128&g=1", "display_name": "Carl Jokl", "link": "https://stackoverflow.com/users/1859532/carl-jokl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 49036827, "answer_count": 1, "score": 0, "last_activity_date": 1519852846, "creation_date": 1519841135, "last_edit_date": 1519852846, "question_id": 49035917, "link": "https://stackoverflow.com/questions/49035917/c-c-exposure-of-functions-methods-vs-java", "title": "C/C++ exposure of functions / methods vs Java", "body": "<p>The world of Minecraft Modding has made me curious about differences in mechanisms between Java and C/C++ libraries to allow methods / functions in the libraries to be invoked externally.</p>\n\n<p>My understanding is that Minecraft Modding came about due to the ability to decompile / reflect over Java in order to reverse engineer classes and methods that can be invoked from the library. I believe that the Java class specification includes quite a lot of metadata about the structure of classes allowing code to be used in ways other than intended.</p>\n\n<p>There are some obfuscation tools around that try to make it harder to reverse engineer Java but overall it seems to be quite difficult to prevent.</p>\n\n<p>I don't have the depth of knowledge in C/C++ to know to what degree the same can be done there.</p>\n\n<p>For C/C++ code is compiled natively ahead of time. The end result is an assembly of machine code specific for that platform. C/C++ has the notion of externalising functions so that they can be exposed from outside the library or executable. Some libraries also have an entry point.</p>\n\n<p>Typically when connecting to external functions there is a header file to list what functions are available to code against from the library.</p>\n\n<p>I would assume there would need to be a mechanism to map an exposed function to the address within the library / executable machine code assembly so the function calls get made in the right place.</p>\n\n<p>Typically connecting the function calls together with the address is the job of the linker. The linker still needs to somehow know where to find these functions.</p>\n\n<p>This makes me wonder if it is fundamentally possible to invoke non exported functions. If so would this require the ability to locate their address and understand their parameter format? </p>\n\n<p>function calls in C/C++ as I understand it is typically done by assigning the parameters to registers for simple functions or to an argument array for more complex functions. </p>\n\n<p>I don't know if the practice of invoking non-public API's in native code is common\nor if the inherent difficulty in doing so makes native code pretty safe from this kind of use.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519840790, "post_id": 49035800, "comment_id": 85076517, "body": "Would you mind extracting lines <i>30</i>, <i>31</i> and <i>51</i> or pointing out which ones are they."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1519840797, "post_id": 49035800, "comment_id": 85076520, "body": "Surely this warning has nothing to do with the fact the program is multithreaded."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1519840824, "post_id": 49035800, "comment_id": 85076533, "body": "There are no line numbers in SO code blocks."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519840828, "post_id": 49035800, "comment_id": 85076538, "body": "Please edit your question to show <i>where</i> the errors are (with comments in the code). And note that you declare both <code>start</code> and <code>join</code> to return values, but you never do. That leads to <i>undefined behavior</i>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519840891, "post_id": 49035800, "comment_id": 85076565, "body": "Not to mention that you have a pointer <code>data</code> in the <code>runner</code> function, a pointer you never initialize but still dereference."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519840986, "post_id": 49035800, "comment_id": 85076621, "body": "I found the lines, as this question is asking about the error/warning message I gave an answer. But you should take care of what the others commented."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1519841143, "last_edit_date": 1519841143, "creation_date": 1519840837, "answer_id": 49035850, "question_id": 49035800, "link": "https://stackoverflow.com/questions/49035800/multi-thread-program-in-c-assignment-from-incompatible-pointer-type/49035850#49035850", "title": "Multi-thread program in C - assignment from incompatible pointer type", "body": "<ol>\n<li><p>Your function pointers are meant to return <code>int</code> while the functions return <code>int *</code>.</p>\n\n<p>There is effectively a type mismatch, you either</p>\n\n<ul>\n<li><p>Change the function types defintions to return <code>int *</code></p>\n\n<pre><code>typedef int *(*Start) (void runner(void *), struct thread_data *params, pthread_t *thread);\ntypedef int *(*Join) (int id); \n</code></pre></li>\n<li><p>Or fix the functions to return <code>int</code></p>\n\n<pre><code>int start(void runner(void *), pthread_t* params, Thread *thread); \nint join(int id);\n</code></pre></li>\n</ul>\n\n<p>It depends, on what you <strong>really</strong> need.</p></li>\n<li><p>Your <code>runner</code> parameter is another function pointer apparently, but it's not declared as such, you have to fix it by writing something like</p>\n\n<pre><code>typedef int *(*Start) (void (*runner)(void *), ... )\n</code></pre>\n\n<p>instead.</p>\n\n<p>Fixing the definitions too of course.</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 9169086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36820da69f0f70dc38f8954a3548f4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Tony ", "link": "https://stackoverflow.com/users/9169086/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519841388, "creation_date": 1519840669, "last_edit_date": 1519841388, "question_id": 49035800, "link": "https://stackoverflow.com/questions/49035800/multi-thread-program-in-c-assignment-from-incompatible-pointer-type", "title": "Multi-thread program in C - assignment from incompatible pointer type", "body": "<p>Trying to get the output to be something like this in a Unix environment:</p>\n\n<p>Thread 0 - 0, Thread 1 - 0, Thread 2 - 0, Thread 2 - 1, Thread 2 - 2,\n Thread 3 - 0, ...      </p>\n\n<p>I'm sure that main() is fine, however this is my first time working with function pointers. I may be making some obvious mistakes. In summary...help.</p>\n\n<p>here's my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\nstruct thread_data {\n    int id;\n};\n\ntypedef int (*Start) (void runner(void *), struct thread_data *params, pthread_t *thread);\ntypedef int (*Join) (int id); \n\ntypedef struct _Thread {\n    pthread_t id;\n    Start start;\n    Join join;\n} Thread;\n\nvoid runner();\nint *start(void runner(void *), pthread_t* params, Thread *thread); \nint *join(int id);\n\nint main(int argc, char *argv[]) {\n    srand(time(0));\n\n    int i, num = 4;\n    struct thread_data params[num];\n    for (i=0; i&lt;num; i++) params[i].id = i;\n\n    Thread thread[num];\n    for (i=0; i&lt;num; i++) {\n        thread[i].start = start;\n        thread[i].join = join;\n    }\n\n    for (i=0; i&lt;num; i++) {\n        thread[i].start(runner, &amp;params[i], &amp;thread[i].id);\n    }\n\n    for (i=0; i&lt;num; i++) {\n        thread[i].join(thread[i].id);\n    }\n\n    pthread_exit(NULL);\n    return 0;\n}\nvoid runner(){\n        struct thread_data *data;\n        int i;\n        for (i = 0; i &lt; 10; i++){\n                printf(\"Thread %d - %d\\n\", data-&gt;id, i);\n                sleep((int) (rand()%2));\n        }\n}\nint *start(void runner(void *), pthread_t* params, Thread *thread){\n    pthread_create(&amp;thread-&gt;id, NULL, runner(void *), &amp;params);\n}\n\nint *join (int id){ \n    pthread_join(id, NULL); //thread-&gt;id, NULL)\n}\n</code></pre>\n\n<p>but am getting these errors</p>\n\n<pre><code>temp03.c: In function \u2018main\u2019:\ntemp03.c:30: warning: assignment from incompatible pointer type\ntemp03.c:31: warning: assignment from incompatible pointer type\ntemp03.c: In function \u2018start\u2019:\ntemp03.c:51: error: expected expression before \u2018void\u2019\ntemp03.c:51: error: invalid use of void expression\n</code></pre>\n\n<p>30 &amp; 31 are the thread[i]... ones and 51 is the last one</p>\n\n<pre><code>Thread thread[num];\nfor (i=0; i&lt;num; i++) {\n    thread[i].start = start;\n    thread[i].join = join;\n}\n\nint *start(void runner(void *), pthread_t* params, Thread *thread){\n    pthread_create(&amp;thread-&gt;id, NULL, runner(void *), &amp;params);\n}\n</code></pre>\n"}, {"tags": ["c", "constants", "ada"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1519840133, "post_id": 49035610, "comment_id": 85076210, "body": "Technically this is not a constant, it&#39;s a macro."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519840300, "post_id": 49035610, "comment_id": 85076293, "body": "You can&#39;t &quot;export&quot; these as they are not in the compiled binary at all."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1519840803, "post_id": 49035610, "comment_id": 85076521, "body": "<code>TEST : constant Integer := 4660;</code>"}, {"owner": {"reputation": 43, "user_id": 6798064, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UNtYC2qU6sI/AAAAAAAAAAI/AAAAAAAAGp0/KTiNPMabwaY/photo.jpg?sz=128", "display_name": "Sterisk", "link": "https://stackoverflow.com/users/6798064/sterisk"}, "edited": false, "score": 0, "creation_date": 1519844581, "post_id": 49035610, "comment_id": 85078433, "body": "Is there a way to make a constant equal to the macro and then export that to ada? How would I export and import that?"}, {"owner": {"reputation": 17509, "user_id": 1818839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c85353a93872849b5ef6041b2f28fb3?s=128&d=identicon&r=PG&f=1", "display_name": "user_1818839", "link": "https://stackoverflow.com/users/1818839/user-1818839"}, "edited": false, "score": 0, "creation_date": 1519845823, "post_id": 49035610, "comment_id": 85079130, "body": "Are you using <code>gcc -c -fdump-ada-spec</code> for the rest of your low level binding? The way I&#39;ve handled this is to add a second package for the bits the automatic binding generator doesn&#39;t handle ... here I&#39;d put <code>TEST : constant Integer := 16#1234#;</code> in that second package."}, {"owner": {"reputation": 43, "user_id": 6798064, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UNtYC2qU6sI/AAAAAAAAAAI/AAAAAAAAGp0/KTiNPMabwaY/photo.jpg?sz=128", "display_name": "Sterisk", "link": "https://stackoverflow.com/users/6798064/sterisk"}, "edited": false, "score": 0, "creation_date": 1519845909, "post_id": 49035610, "comment_id": 85079180, "body": "I&#39;m currently using an .ads for c imports and a .h for c exports."}, {"owner": {"reputation": 236, "user_id": 8506298, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/427dde9866d49ce780b0075850eb3d5f?s=128&d=identicon&r=PG", "display_name": "Jeffrey R. Carter", "link": "https://stackoverflow.com/users/8506298/jeffrey-r-carter"}, "edited": false, "score": 0, "creation_date": 1519894332, "post_id": 49035610, "comment_id": 85096219, "body": "<code>Test : constant := 16#1234#;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6798064, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UNtYC2qU6sI/AAAAAAAAAAI/AAAAAAAAGp0/KTiNPMabwaY/photo.jpg?sz=128", "display_name": "Sterisk", "link": "https://stackoverflow.com/users/6798064/sterisk"}, "edited": false, "score": 0, "creation_date": 1519852248, "post_id": 49037389, "comment_id": 85082446, "body": "Is there an alternative using export and import pragmas for c and ada respectively?"}, {"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "reply_to_user": {"reputation": 43, "user_id": 6798064, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UNtYC2qU6sI/AAAAAAAAAAI/AAAAAAAAGp0/KTiNPMabwaY/photo.jpg?sz=128", "display_name": "Sterisk", "link": "https://stackoverflow.com/users/6798064/sterisk"}, "edited": false, "score": 0, "creation_date": 1519933313, "post_id": 49037389, "comment_id": 85119548, "body": "See mods in answer about compiling the C source &amp; including in the link."}], "tags": [], "owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "is_accepted": true, "score": 7, "last_activity_date": 1519933338, "last_edit_date": 1519933338, "creation_date": 1519847048, "answer_id": 49037389, "question_id": 49035610, "link": "https://stackoverflow.com/questions/49035610/how-to-import-define-constants-from-h-file-to-ada/49037389#49037389", "title": "How to import #define constants from .h file to Ada?", "body": "<p>If you\u2019re asking how to write an Ada representation of this constant by hand, then the answer is</p>\n\n\n\n<pre class=\"lang-ada prettyprint-override\"><code>TEST : constant := 16#1234#;\n</code></pre>\n\n<p>If you want to maintain the relationship between the C and the Ada automatically, you can get <code>gcc</code> (or, better, <code>g++</code>; see at end) to do the grunt work. Given <code>sterisk.hh</code> containing your example,</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define TEST 0x1234\n</code></pre>\n\n<p>compile it with</p>\n\n<pre class=\"lang-ada prettyprint-override\"><code>g++ -c -fdump-ada-spec sterisk.hh\n</code></pre>\n\n<p>which generates in <code>sterisk_hh.ads</code></p>\n\n<pre class=\"lang-ada prettyprint-override\"><code>pragma Ada_2005;\npragma Style_Checks (Off);\n\nwith Interfaces.C; use Interfaces.C;\n\npackage sterisk_hh is\n\n   TEST : constant := 16#1234#;  --  sterisk.hh:1\n\nend sterisk_hh;\n</code></pre>\n\n<p>A third way would be to create a small C source which includes the header (here C is better; you don\u2019t want the name to be mangled in the object file) in say <code>sterisk.c</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"sterisk.hh\"\n\nconst int _name_thats_unlikely_to_clash = TEST;\n</code></pre>\n\n<p>and compile to <code>sterisk.o</code>:</p>\n\n<pre class=\"lang-ada prettyprint-override\"><code>gcc -c sterisk.c\n</code></pre>\n\n<p>Then, in your Ada source:</p>\n\n<pre class=\"lang-ada prettyprint-override\"><code>Test : constant Integer\nwith\n  Import,\n  External_Name =&gt; \"_name_thats_unlikely_to_clash\";\n</code></pre>\n\n<p>Of course, this way means you have to decide on a specific type for the constant, and it has to match the C type.</p>\n\n<p>Also, you need to include the C object file in your link:</p>\n\n<pre class=\"lang-ada prettyprint-override\"><code>gnatmake foo.adb -largs sterisk.o\n</code></pre>\n\n<hr>\n\n<p>Why is <code>g++</code> better than <code>gcc</code>? Because <code>g++</code> preserves more of the names in the C source, for example parameter names in functions.</p>\n"}], "owner": {"reputation": 43, "user_id": 6798064, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UNtYC2qU6sI/AAAAAAAAAAI/AAAAAAAAGp0/KTiNPMabwaY/photo.jpg?sz=128", "display_name": "Sterisk", "link": "https://stackoverflow.com/users/6798064/sterisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 504, "favorite_count": 0, "accepted_answer_id": 49037389, "answer_count": 1, "score": 1, "last_activity_date": 1519933338, "creation_date": 1519839833, "question_id": 49035610, "link": "https://stackoverflow.com/questions/49035610/how-to-import-define-constants-from-h-file-to-ada", "title": "How to import #define constants from .h file to Ada?", "body": "<p>I'm trying to move a constant from C to Ada that is located in a header file.</p>\n\n<p><em>file.h</em></p>\n\n<pre><code>#define TEST 0x1234\n</code></pre>\n\n<p>How would I export this constant to ada? I know to export functions and import them into ada but I can't seem to figure out how to do the same thing for constants.</p>\n"}, {"tags": ["c++", "c", ".net"], "comments": [{"owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "edited": false, "score": 2, "creation_date": 1519837979, "post_id": 49035041, "comment_id": 85074927, "body": "I wouldn&#39;t say that C or C++ is part of the .net framework - but that the framework would support them"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519837980, "post_id": 49035041, "comment_id": 85074930, "body": "No. The .NET Framework is a bunch of classes(libraries) abstracting some lower-level windows functionality. C and C++ are languages."}, {"owner": {"reputation": 417, "user_id": 8543849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb0976ee4767a00fce7fee6106afdca2?s=128&d=identicon&r=PG&f=1", "display_name": "E. Epstein", "link": "https://stackoverflow.com/users/8543849/e-epstein"}, "edited": false, "score": 0, "creation_date": 1519838381, "post_id": 49035041, "comment_id": 85075179, "body": "OK, so does that mean that I can use C in the .NET framework (with C# libraries for example)?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519838616, "post_id": 49035041, "comment_id": 85075328, "body": "Yes you can. But I would go with C#... C++ in the worst case."}, {"owner": {"reputation": 536, "user_id": 4881960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0970a38e2aa57cb1c119f8c1a9849fb?s=128&d=identicon&r=PG&f=1", "display_name": "freim", "link": "https://stackoverflow.com/users/4881960/freim"}, "edited": false, "score": 1, "creation_date": 1519839155, "post_id": 49035041, "comment_id": 85075681, "body": "C++ is not a part of .NET. Managed C++ is, and I am not sure if that can be called C++ in the first place."}, {"owner": {"reputation": 417, "user_id": 8543849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb0976ee4767a00fce7fee6106afdca2?s=128&d=identicon&r=PG&f=1", "display_name": "E. Epstein", "link": "https://stackoverflow.com/users/8543849/e-epstein"}, "edited": false, "score": 0, "creation_date": 1519839187, "post_id": 49035041, "comment_id": 85075697, "body": "What do you mean by &#39;in the worst case&#39;? Is it preferred to use a different language like VB?"}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 6, "creation_date": 1519839272, "post_id": 49035041, "comment_id": 85075749, "body": ".NET is analogous to JVM.  Microsoft&#39;s preferred languages for .NET are:  C#, VB.NET, and F#.  There are other languages that target .NET, just as there are languages like Kotlin, Clojure, and Scala that target JVM.  Getting C or C++ to interoperate with .NET is not easy, and unless you have a Really Good Reason, is not something I&#39;d recommend."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1519841079, "post_id": 49035041, "comment_id": 85076655, "body": "The link you give is for C and C++ with Visual Studio, but <i>not</i> for .NET. Microsoft has <i>yet another language</i>, confusingly called C++/CLI, that is for .NET. See <a href=\"https://docs.microsoft.com/sv-se/cpp/dotnet/dotnet-programming-with-cpp-cli-visual-cpp\" rel=\"nofollow noreferrer\">.NET Programming with C++/CLI</a>. As far as I know, people only use that when they <i>have to</i>. Otherwise use C# if you want .NET"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1519850035, "post_id": 49035041, "comment_id": 85081293, "body": "Microsoft has also made it quite clear in online postings that they do not intend to support modern C language features that are not present in C++, so they don&#39;t really even make a modern C compiler. They make a compiler for a C-like language that is a subset of C++."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1519840728, "creation_date": 1519840728, "answer_id": 49035821, "question_id": 49035041, "link": "https://stackoverflow.com/questions/49035041/is-c-a-part-of-the-net-framework/49035821#49035821", "title": "Is C a part of the .NET framework?", "body": "<p>C and C++ are both low level, you can always write code in C and C++ that would work with other languages. The main language for the .NET I think is C#. I don't think it's necessary for you to write C++ code for a .NET project. And if you had to, then you wouldn't need to ask this, because you would know that your question doesn't even make sense. Of course, since you don't know your question is ok.</p>\n\n<p>So in a sense, <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> and <a href=\"/questions/tagged/c%2b%2b\" class=\"post-tag\" title=\"show questions tagged &#39;c++&#39;\" rel=\"tag\">c++</a> are part of everything, and you can always write code in low level languages with interfaces for higher level ones like <a href=\"/questions/tagged/c%23\" class=\"post-tag\" title=\"show questions tagged &#39;c#&#39;\" rel=\"tag\">c#</a> with <a href=\"/questions/tagged/.net\" class=\"post-tag\" title=\"show questions tagged &#39;.net&#39;\" rel=\"tag\">.net</a> support. But that is quite specialized and is rarely needed.</p>\n"}, {"tags": [], "owner": {"reputation": 9367, "user_id": 4454124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c094d8979fb41b789a7c7f21d9329359?s=128&d=identicon&r=PG&f=1", "display_name": "mnistic", "link": "https://stackoverflow.com/users/4454124/mnistic"}, "is_accepted": true, "score": 1, "last_activity_date": 1519841294, "creation_date": 1519841294, "answer_id": 49035959, "question_id": 49035041, "link": "https://stackoverflow.com/questions/49035041/is-c-a-part-of-the-net-framework/49035959#49035959", "title": "Is C a part of the .NET framework?", "body": "<p>.NET Framework is an object oriented programming framework meant to be used with languages that it provides bindings for. Since C is not an object oriented language it wouldn't make sense to use it with the framework. Microsoft does provide <a href=\"https://en.wikipedia.org/wiki/C%2B%2B/CLI\" rel=\"nofollow noreferrer\">its own version of C++</a> (that is incompatible with standard C++) to be used with the .NET Framework.</p>\n"}], "owner": {"reputation": 417, "user_id": 8543849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb0976ee4767a00fce7fee6106afdca2?s=128&d=identicon&r=PG&f=1", "display_name": "E. Epstein", "link": "https://stackoverflow.com/users/8543849/e-epstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "closed_date": 1519844776, "accepted_answer_id": 49035959, "answer_count": 2, "score": 1, "last_activity_date": 1519841294, "creation_date": 1519837803, "question_id": 49035041, "link": "https://stackoverflow.com/questions/49035041/is-c-a-part-of-the-net-framework", "closed_reason": "Not suitable for this site", "title": "Is C a part of the .NET framework?", "body": "<p>I've searched the net for this, but I couldn't really find an answer. I've found this though: \n<a href=\"https://msdn.microsoft.com/en-us/library/hh875057.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/hh875057.aspx</a></p>\n\n<p>It says that C++ is a part of the .NET framework, and the headline writes \"C/C++\", but there wasn't much about C, so I wasn't able to understand if it is or not.</p>\n"}, {"tags": ["c", "assembly", "linux-kernel", "arm"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519849223, "post_id": 49034855, "comment_id": 85080850, "body": "The new code presumably changes register allocation for the earlier code, and / or maybe the compiler decides to optimistically do some things with registers before checking / returning.  Or simply save/restore some registers to the stack because the function now needs to save some args across calls.  If clobbing r0..r3 and memory below the stack pointer wasn&#39;t really safe at that point in <code>vector_swi</code>, then the first version with the function call only worked by chance.  I&#39;m not familiar enough with Linux&#39;s ARM entry point to say whether or not an ABI-compiliant function call is safe there."}], "answers": [{"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519862178, "post_id": 49040433, "comment_id": 85086494, "body": "Ah yes, so my guess was right that call clobbered registers were still holding something important at that point?  The entry point already saved them to the stack, but it uses them without reloading, right?"}, {"owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1519863577, "post_id": 49040433, "comment_id": 85086865, "body": "Yes, used without reloading for most system calls."}, {"owner": {"reputation": 2959, "user_id": 1761555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ca57c78ac2a76255a79004bb1d1529d?s=128&d=identicon&r=PG", "display_name": "Guru Prasad", "link": "https://stackoverflow.com/users/1761555/guru-prasad"}, "edited": false, "score": 0, "creation_date": 1519912897, "post_id": 49040433, "comment_id": 85107064, "body": "Don&#39;t C functions automatically have assembly generated that saves and restores registers? I took a look at 10-15 functions from <code>objdump</code> and they all start off with <code>mov ip, sp; push {r3, r4, ...}</code> and end with <code>ldm sp, {r3, r4, ....}</code>"}, {"owner": {"reputation": 2959, "user_id": 1761555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ca57c78ac2a76255a79004bb1d1529d?s=128&d=identicon&r=PG", "display_name": "Guru Prasad", "link": "https://stackoverflow.com/users/1761555/guru-prasad"}, "edited": false, "score": 0, "creation_date": 1519914798, "post_id": 49040433, "comment_id": 85108272, "body": "I&#39;m guessing what I should be doing is save the registers onto the stack, call my function and then load them back. Since I don&#39;t have a good understanding of assembly, Is there any way I can get the compiler to generate this assembly for me so that I can look it up and hand-write it into <code>vector_swi</code>?"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 1, "creation_date": 1519917410, "post_id": 49040433, "comment_id": 85110114, "body": "Just use <code>objdump -S</code> on the generated vmlinux or whatever your output is."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 2959, "user_id": 1761555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ca57c78ac2a76255a79004bb1d1529d?s=128&d=identicon&r=PG", "display_name": "Guru Prasad", "link": "https://stackoverflow.com/users/1761555/guru-prasad"}, "edited": false, "score": 0, "creation_date": 1519930894, "post_id": 49040433, "comment_id": 85118303, "body": "@GuruPrasad: The kernel already saved all the registers to the stack on entry with <code>stmia   sp, {r0 - r12}</code>.  You don&#39;t need to store them again, just use 4 <code>ldr</code> instructions to reload those registers after your function returns, using the right offset from <code>sp</code>.  Or if you can use <code>ldm</code> without an auto-increment/decrement addressing mode, that would work too.  (ldm and stm aren&#39;t magic; multiple separate <code>ldr</code> instructions aren&#39;t much slower, I think, just take more code size.)"}], "tags": [], "owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "is_accepted": true, "score": 3, "last_activity_date": 1519921950, "last_edit_date": 1519921950, "creation_date": 1519861147, "answer_id": 49040433, "question_id": 49034855, "link": "https://stackoverflow.com/questions/49034855/kernel-breaks-on-adding-new-code-that-never-runs/49040433#49040433", "title": "Kernel breaks on adding new code (that never runs)", "body": "<p>The first version will probably compile to just a return instruction as it has no side effect. The second needs to load <code>btm_enabled</code> and in the process overwrites one or two system call arguments.</p>\n\n<p>When calling a C function from assembly language you need to ensure that registers may be modified do not contain needed information.</p>\n\n<p>To solve your specific problem, you could update your code to read:</p>\n\n<pre><code>#ifdef CONFIG_BTM_BOUNDARIES\n        stmdb   sp!, {r0-r3, r12, lr}  @ &lt;--- New instruction\n        bl btm_entering_kernelspace    @ &lt;--- My function\n        ldmia   sp!, {r0-r3, r12, lr}  @ &lt;--- New instruction\n#endif\n</code></pre>\n\n<p>The new instructions store registers r0-r3, r12 and lr onto the stack and restore them after your function call. These are the only registers a C function is allowed to modify, saving r12 here is unnecessary here is it's value is not used, but doing so keeps the stack 8-byte aligned as required by the ABI.</p>\n"}], "owner": {"reputation": 2959, "user_id": 1761555, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ca57c78ac2a76255a79004bb1d1529d?s=128&d=identicon&r=PG", "display_name": "Guru Prasad", "link": "https://stackoverflow.com/users/1761555/guru-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 49040433, "answer_count": 1, "score": 3, "last_activity_date": 1519921950, "creation_date": 1519837192, "question_id": 49034855, "link": "https://stackoverflow.com/questions/49034855/kernel-breaks-on-adding-new-code-that-never-runs", "title": "Kernel breaks on adding new code (that never runs)", "body": "<p>I'm trying to add some logic at boundaries between userspace and kernelspace particularly on the ARM architecture.</p>\n\n<p>One such boundary appears to be the <code>vector_swi</code> routine implemented in <code>arch/arm/kernel/entry-common.S</code>. Right now, I have most of my code written in a C function which I would like to call somewhere at the start of <code>vector_swi</code>. </p>\n\n<p>Thus, I did the following:</p>\n\n<pre><code>ENTRY(vector_swi)\n        sub     sp, sp, #S_FRAME_SIZE\n        stmia   sp, {r0 - r12}                  @ Calling r0 - r12\n ARM(   add     r8, sp, #S_PC           )\n ARM(   stmdb   r8, {sp, lr}^           )       @ Calling sp, lr\n THUMB( mov     r8, sp                  ) \n THUMB( store_user_sp_lr r8, r10, S_SP  )       @ calling sp, lr\n        mrs     r8, spsr                        @ called from non-FIQ mode, so ok.\n        str     lr, [sp, #S_PC]                 @ Save calling PC\n        str     r8, [sp, #S_PSR]                @ Save CPSR\n        str     r0, [sp, #S_OLD_R0]             @ Save OLD_R0\n        zero_fp\n\n#ifdef CONFIG_BTM_BOUNDARIES\n        bl btm_entering_kernelspace    @ &lt;--- My function\n#endif\n</code></pre>\n\n<p>When the contents of my function are as follows everything works fine:</p>\n\n<pre><code>static int btm_enabled = 0;\nasmlinkage inline void btm_entering_kernelspace(void)\n{\n        int cpu;\n        int freq;\n        struct acpu_level *level;\n        if(!btm_enabled) {\n                return;\n        }\n        cpu = smp_processor_id();\n        freq = acpuclk_krait_get_rate(cpu);\n        (void) cpu;\n        (void) freq;\n        (void) level;\n}\n</code></pre>\n\n<p>However, when I add some additional code, the kernel enters into a crash-reboot loop.</p>\n\n<pre><code>static int btm_enabled = 0;\nasmlinkage inline void btm_entering_kernelspace(void)\n{\n        int cpu;\n        int freq;\n        struct acpu_level *level;\n        if(!btm_enabled) {\n                return;\n        }\n        cpu = smp_processor_id();\n        freq = acpuclk_krait_get_rate(cpu);\n        (void) cpu;\n        (void) freq;\n        (void) level;\n        // --------- Added code ----------\n        for (level = drv.acpu_freq_tbl; level-&gt;speed.khz != 0; level++) {\n                if(level-&gt;speed.khz == freq) {\n                        break;\n                }\n        }\n}\n</code></pre>\n\n<p>Although the first instinct is to blame the logic of the added code, please note that none of it should ever execute since <code>btm_enabled</code> is <code>0</code>.</p>\n\n<p>I have double-checked and triple-checked to make sure <code>btm_enabled</code> is <code>0</code> by adding a <code>sysfs</code> entry to print out the value of the variable (with the added code removed).</p>\n\n<p>Could someone explain what is going on here or what I'm doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1519832423, "post_id": 49033262, "comment_id": 85071233, "body": "You could use <a href=\"https://linux.die.net/man/2/stat\" rel=\"nofollow noreferrer\"><code>stat</code></a>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519832451, "post_id": 49033262, "comment_id": 85071254, "body": "<code>fopen</code> and friends <i>are</i> in <code>stdio</code> library."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1519832500, "post_id": 49033262, "comment_id": 85071290, "body": "@EugeneSh.he wants to do it <i>without</i> stdio stuff"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519832574, "post_id": 49033262, "comment_id": 85071343, "body": "Hm. The most portable way would be <i>to use</i> <code>stdio</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519832662, "post_id": 49033262, "comment_id": 85071404, "body": "you could use system primitives like <code>open</code> and <code>seek</code>, would that be OK? why would you want to avoid stdio?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1519832680, "post_id": 49033262, "comment_id": 85071415, "body": "@Jean-Fran&#231;oisFabre You can have branchiae instead :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519832703, "post_id": 49033262, "comment_id": 85071430, "body": "I&#39;m sorry, it&#39;s late :)"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1519832732, "post_id": 49033262, "comment_id": 85071455, "body": "If you don&#39;t use stdio, the code may be less portable, but it&#39;s certainly doable.  On a Unix system, the obvious solution is to use the <code>stat</code> system call."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1519832745, "post_id": 49033262, "comment_id": 85071469, "body": "<code>off_t size = lseek(fd, 0, SEEK_END);</code> or <code>off64_t size = lseek64(fd, 0, SEEK_END);</code>  would be equivalent system calls, but using <code>stat</code> (also a system call) makes more sense."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1519832813, "post_id": 49033262, "comment_id": 85071513, "body": "stat works fine on windows as well. but sounds like XY problem."}, {"owner": {"reputation": 11, "user_id": 9352082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a5700fead405f1f28c3824eb1318cf2?s=128&d=identicon&r=PG&f=1", "display_name": "P.George", "link": "https://stackoverflow.com/users/9352082/p-george"}, "edited": false, "score": 0, "creation_date": 1519923976, "post_id": 49033262, "comment_id": 85114639, "body": "thanks guys. I also found a way to do it. I use lseek to go to the beginning of the file i want to find it&#39;s size and then use lseek to end and the return value is the number of bytes. thanks all for your time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9258013"}, "edited": false, "score": 0, "creation_date": 1547349691, "post_id": 49033262, "comment_id": 95161282, "body": "I think you need <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getfilesizeex\" rel=\"nofollow noreferrer\">Windows API</a> or <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/stat.html\" rel=\"nofollow noreferrer\">Posix API</a>. huh..?"}], "owner": {"reputation": 11, "user_id": 9352082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a5700fead405f1f28c3824eb1318cf2?s=128&d=identicon&r=PG&f=1", "display_name": "P.George", "link": "https://stackoverflow.com/users/9352082/p-george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "closed_date": 1519832627, "answer_count": 0, "score": 0, "last_activity_date": 1537510193, "creation_date": 1519832259, "last_edit_date": 1537510193, "question_id": 49033262, "link": "https://stackoverflow.com/questions/49033262/how-to-find-file-size-without-stdio-library", "closed_reason": "Duplicate", "title": "How to find file size without stdio library?", "body": "<p>I am trying to find the size of a file without using stdio library.<br>\nThis way (see below) works perfectly, but I can't find a way to make that work without stdio library.</p>\n\n<pre><code>int getfilesize(const char *filename){\n\n   int size;\n   FILE *f;\n\n   f=fopen(filename, \"rb\");\n\n   //pointer check\n   if(f==NULL){\n      return (-1);\n   }\n\n   fseek(f, 0, SEEK_END);\n   size = ftell(f);\n   fclose(f);\n\n   return(size);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1519832062, "post_id": 49033160, "comment_id": 85070996, "body": "Remove the <code>&amp;</code>. Dunno why you are passing <code>i</code> to <code>fun</code> though..."}, {"owner": {"reputation": 628, "user_id": 8939165, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0gchW.jpg?s=128&g=1", "display_name": "Fabio_MO", "link": "https://stackoverflow.com/users/8939165/fabio-mo"}, "edited": false, "score": 0, "creation_date": 1519832224, "post_id": 49033160, "comment_id": 85071094, "body": "You print addresses instead of values. *p is the value, &amp;(*p) is the address"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1519832334, "post_id": 49033160, "comment_id": 85071163, "body": "Tip: <a href=\"https://stackoverflow.com/q/381542/589924\">Suggested reading</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519832358, "post_id": 49033160, "comment_id": 85071176, "body": "BTW, <code>fun</code> has no prototype. It should throw some warnings"}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1519832429, "post_id": 49033160, "comment_id": 85071241, "body": "What Eugene Sh. means is that <code>fun</code> is called before it&#39;s declared. That&#39;s a problem. Either change the order of your functions, or add <code>void fun(int *p, int i);</code> near the top to declare <code>fun</code> before it&#39;s defined."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1519832470, "post_id": 49033160, "comment_id": 85071266, "body": "For start, turn on all warnings and make the compiler report them as errors. <a href=\"https://godbolt.org/g/ZGYDt2\" rel=\"nofollow noreferrer\">This is what the compiler would tell you then</a>: 1) implicit declaration of function <code>fun</code> (<b>no prototype for <code>fun</code></b>), 2) <code>fun</code> return type defaults to <code>int</code> (<b>you forgot <code>void</code> at the beginning</b>), 3) format <code>%d</code> expects argument of type <code>int</code>, but argument 2 has type <code>int *</code> (<b>you are passing a pointer instead of a number</b>), 4) control reaches end of non-void function (<b>compiler thinks <code>fun</code> should return <code>int</code></b>)."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1519832987, "post_id": 49033160, "comment_id": 85071642, "body": "<code>&amp;</code> and <code>*</code> are opposite operators. <code>&amp;*p == p</code> and <code>*&amp;p == p</code> as well"}, {"owner": {"reputation": 1791, "user_id": 794606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9a1d5c337bdddae373bbdcb92fdb7077?s=128&d=identicon&r=PG", "display_name": "Jacek Cz", "link": "https://stackoverflow.com/users/794606/jacek-cz"}, "edited": false, "score": 0, "creation_date": 1519836454, "post_id": 49033160, "comment_id": 85073936, "body": "print isn typesafe. If You are not sure, what it is type, use itermedaite variable. Compiler give kind of warning"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 2, "last_activity_date": 1519832150, "creation_date": 1519832150, "answer_id": 49033225, "question_id": 49033160, "link": "https://stackoverflow.com/questions/49033160/array-and-pointer-relationship-why-this-code-not-prints-ai/49033225#49033225", "title": "array and pointer relationship,why this code not prints a[i]", "body": "<p><code>&amp;*x</code> side by side applied results in <code>x</code> and here that <code>x</code> is <code>p+i</code>. <code>p</code> is the pointer to the first element of the array and added <code>i</code> to it, the value is incremented by <code>sizeof *p</code> here <code>sizeof int</code> which is 4 bytes in your case. More clearly you printed <code>&amp;p[i]</code> in each iteration and that too with wrong format specifier. Use <code>%p</code> format specifier for printing address.</p>\n\n<p>If you want to print the array - remove the address of operator <code>&amp;</code> and instead use the value that you want to print <code>*(p+i)</code> or <code>p[i]</code>.</p>\n\n<p>You have passed <code>i</code> though not clear why. You have used hard-coded value for array length. Know that if your intention was to pass the size of the array you could pass <code>sizeof arr/sizeof arr[0]</code> - this term is nothing but the size of the array. </p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 5, "last_activity_date": 1519880136, "last_edit_date": 1519880136, "creation_date": 1519832428, "answer_id": 49033315, "question_id": 49033160, "link": "https://stackoverflow.com/questions/49033160/array-and-pointer-relationship-why-this-code-not-prints-ai/49033315#49033315", "title": "array and pointer relationship,why this code not prints a[i]", "body": "<p><code>*</code> and <code>&amp;</code> together here nullify each other's effect.  <code>&amp;*(p+i)</code> is equivalent to <code>(p+i)</code>. <code>(p+i)</code> gives the address of the <code>i</code><sup>th</sup> element of the array. To access the element's value you need to remove <code>&amp;</code> from that expression, which will be <code>*(p+i)</code> and is equivalent to <code>p[i]</code>.</p>\n\n<hr>\n\n<p><strong>Note:</strong> Instead of using a loop to initialize all elements of an array you can use initializer list as follows  </p>\n\n<pre><code>int a[10] = {0}; \n</code></pre>\n\n<p>Also you have to pass size of the array to the function. Your function should use that size to know the length of the array passed.  </p>\n\n<pre><code>fun(int *p, int size){\n    for (int i=0; i &lt; size; i++){\n        printf(\"%d\\n\", p[i]);\n    }\n}\n</code></pre>\n\n<p>Do not forget to add a function prototype before <code>main</code>  </p>\n\n<pre><code>void fun(int *p, int size);\n</code></pre>\n\n<p>and call it   </p>\n\n<pre><code>fun(a, sizeof(a)/sizeof(a[0]));\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8857141, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6zj9iPPe8iQ/AAAAAAAAAAI/AAAAAAAAABc/v1mR2Vh5DDc/photo.jpg?sz=128", "display_name": "SRIRAM GOVARDHANAM", "link": "https://stackoverflow.com/users/8857141/sriram-govardhanam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519880136, "creation_date": 1519831985, "last_edit_date": 1519832475, "question_id": 49033160, "link": "https://stackoverflow.com/questions/49033160/array-and-pointer-relationship-why-this-code-not-prints-ai", "title": "array and pointer relationship,why this code not prints a[i]", "body": "<p>i have tried a c program on array and pointers</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int a[10], i;\n    for(i=0; i&lt;10; i++)\n    {\n        a[i]=0;\n    }\n    fun(a,i);\n}\n\nfun(int *p, int i)\n{\n    for (i=0; i&lt;10; i++)\n    {\n        printf(\"%d\\n\", &amp;*(p+i));\n    }\n}\n</code></pre>\n\n<p>output is:</p>\n\n<pre><code>2752228\n2752232\n2752236\n2752240\n2752244\n2752248\n2752252\n2752256\n2752260\n2752264\n</code></pre>\n\n<p>it prints addresses instead of array elements</p>\n"}, {"tags": ["c", "multithreading", "data-structures", "concurrency", "synchronization"], "comments": [{"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1519834126, "post_id": 49032807, "comment_id": 85072420, "body": "You should add some language tag."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1519834237, "post_id": 49032807, "comment_id": 85072492, "body": "Also, note that CAS is needed only if you have multiple writers, which is not your case."}, {"owner": {"reputation": 295, "user_id": 4794937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wHzIrIu0emw/AAAAAAAAAAI/AAAAAAAAA0w/Kwp2KvdDlyw/photo.jpg?sz=128", "display_name": "Bingzheng Wu", "link": "https://stackoverflow.com/users/4794937/bingzheng-wu"}, "reply_to_user": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "edited": false, "score": 0, "creation_date": 1519869430, "post_id": 49032807, "comment_id": 85088224, "body": "@DanielLangr, thanks, I have added <code>c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 4794937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wHzIrIu0emw/AAAAAAAAAAI/AAAAAAAAA0w/Kwp2KvdDlyw/photo.jpg?sz=128", "display_name": "Bingzheng Wu", "link": "https://stackoverflow.com/users/4794937/bingzheng-wu"}, "edited": false, "score": 0, "creation_date": 1519870752, "post_id": 49033668, "comment_id": 85088545, "body": "Thanks. If the 2 pointer assignments are executed in the other order by compiler/CPU reordering when inserting items, the read threads may get an invalid pointer. I am not familiar with memory reordering, but I just take that my idea is not safe."}, {"owner": {"reputation": 295, "user_id": 4794937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wHzIrIu0emw/AAAAAAAAAAI/AAAAAAAAA0w/Kwp2KvdDlyw/photo.jpg?sz=128", "display_name": "Bingzheng Wu", "link": "https://stackoverflow.com/users/4794937/bingzheng-wu"}, "edited": false, "score": 0, "creation_date": 1519871781, "post_id": 49033668, "comment_id": 85088778, "body": "After some searching about memory reordering, I find that I can add <a href=\"http://preshing.com/20120625/memory-ordering-at-compile-time/\" rel=\"nofollow noreferrer\">Compiler Barriers</a> to avoid compiler reordering."}, {"owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "reply_to_user": {"reputation": 295, "user_id": 4794937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wHzIrIu0emw/AAAAAAAAAAI/AAAAAAAAA0w/Kwp2KvdDlyw/photo.jpg?sz=128", "display_name": "Bingzheng Wu", "link": "https://stackoverflow.com/users/4794937/bingzheng-wu"}, "edited": false, "score": 0, "creation_date": 1519892271, "post_id": 49033668, "comment_id": 85095217, "body": "@BingzhengWu Yes, but you need to avoid memory reordering as well. Do you have C11 compatible compiler? If yes, you can use <a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/atomic</a>."}], "tags": [], "owner": {"reputation": 18020, "user_id": 580083, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/085edb5b64d5db3362d784bd9d35f99c?s=128&d=identicon&r=PG", "display_name": "Daniel Langr", "link": "https://stackoverflow.com/users/580083/daniel-langr"}, "is_accepted": true, "score": 1, "last_activity_date": 1519856326, "last_edit_date": 1519856326, "creation_date": 1519833505, "answer_id": 49033668, "question_id": 49032807, "link": "https://stackoverflow.com/questions/49032807/is-one-insert-multi-read-list-safe-without-lock/49033668#49033668", "title": "Is one-insert-multi-read list safe without lock?", "body": "<p>You didn't specify the language and data types, but generally, that could be a <strong>data race</strong> (undefined behavior in C++), since one thread may modify <code>list_head</code> and other threads may read it at the same time.</p>\n\n<p>If these reads/writes are <em>atomic</em>, then there is no data race. To my best knowledge, on x86 architecture, reads and writes are atomic automatically. But this may not hold for other architectures.</p>\n\n<p>Moreover, <em>reordering</em> issues may broke things here, that's what <em>memory fences</em> are for, which are typically generated by the compiler when (sequentially consistent) atomic operations are involved. You update values of 2 pointers and, e.g., in C++ with <em>relaxed memory ordering</em>, threads are permitted to \"see\" these updates in a different order (generally due to compiler optimizations, out-of-order execution, CPU store buffers, etc.). See <a href=\"http://en.cppreference.com/w/cpp/atomic/memory_order\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/cpp/atomic/memory_order</a> for more details. </p>\n\n<p>In C++11, you need <code>std::atomic</code> to ensure atomic operations on <code>list_head</code>. With OpenMP, there is <code>#pragma atomic read/write (seq_cst)</code> directive.</p>\n"}], "owner": {"reputation": 295, "user_id": 4794937, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wHzIrIu0emw/AAAAAAAAAAI/AAAAAAAAA0w/Kwp2KvdDlyw/photo.jpg?sz=128", "display_name": "Bingzheng Wu", "link": "https://stackoverflow.com/users/4794937/bingzheng-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 49033668, "answer_count": 1, "score": 2, "last_activity_date": 1519869355, "creation_date": 1519830794, "last_edit_date": 1519869355, "question_id": 49032807, "link": "https://stackoverflow.com/questions/49032807/is-one-insert-multi-read-list-safe-without-lock", "title": "Is one-insert-multi-read list safe without lock?", "body": "<p>I have a problem about synchronization between threads. I know the normal synchronization method and lock-free list. But I have a strange (maybe) idea.</p>\n\n<p>I have a normal singly list in C language, linked by <code>next</code> pointer.</p>\n\n<p>There is only 1 thread who just insert items into this list, but never delete items. The way to add item:</p>\n\n<pre><code>new_item-&gt;next = list_head;\nlist_head = new_item;\n</code></pre>\n\n<p>There are some other threads who just traverse this list (read only).</p>\n\n<p>There is no lock at all.</p>\n\n<p>I think that this should be safe, because the read-only-threads will never get an invalid pointer.\nAm I right?</p>\n\n<p>I do not know how to search this on internet. What I get is all about lock-free list by CAS or something. So I ask it here.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 3, "creation_date": 1519830176, "post_id": 49032563, "comment_id": 85069747, "body": "Hope you haven&#39;t used any C++ added since the mid 1990s, and use a CFront compiler. Job done!"}, {"owner": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1519830222, "post_id": 49032563, "comment_id": 85069790, "body": "I&#39;m not sure what you mean. Mind expanding a bit?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519830445, "post_id": 49032563, "comment_id": 85069930, "body": "Please edit your post and fix the code formatting: this style is completely unreadable. For example, you must include blank lines between functions, as a bare minimum."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519830531, "post_id": 49032563, "comment_id": 85069995, "body": "@Lundin I fixed that."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519830545, "post_id": 49032563, "comment_id": 85070006, "body": "@GtlsGamr Bathsheba means that if any modern c++ is used, then there is no such thing as conversion. You need to write it in c from scratch, which is easier and faster than attemting to make it &quot;<i>work</i>&quot; which is impossible. Also, since you are writing it from scratch, use some concepts of structured programming and use functions to do a single thing that otherwise insert a lot of code into the <code>main()</code> and make it impossible to read and understand."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519830582, "post_id": 49032563, "comment_id": 85070033, "body": "Oh, and it doesn&#39;t even needs to be <i>that modern</i>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 1, "creation_date": 1519830666, "post_id": 49032563, "comment_id": 85070091, "body": "@machine_1 Not really, it is still a complete mess and we aren&#39;t doing the OP a favour by fixing it. They need to learn how to write proper source code."}, {"owner": {"reputation": 677, "user_id": 3785680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e7953767467649c81b58fe9e5a9278?s=128&d=identicon&r=PG&f=1", "display_name": "Outshined", "link": "https://stackoverflow.com/users/3785680/outshined"}, "edited": false, "score": 0, "creation_date": 1519830820, "post_id": 49032563, "comment_id": 85070192, "body": "Put member fields (bal, dep, etc...) into struct instead of class. Extract methods from a class and make them function with this struct passed as an argument. Use stdio.h instead of iostream. Fix minor syntax differences."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1519830864, "post_id": 49032563, "comment_id": 85070226, "body": "The issue is that do you really want to make the program look like <code>C</code>, or be <code>C</code> but look like C++?  If it&#39;s the latter, note that other <code>C</code>-only programmers will wonder why you wrote the code in the way you did, and not use basic <code>C</code> idioms."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519830843, "post_id": 49032776, "comment_id": 85070209, "body": "Also, functions sould be called something like <code>prev_class_set</code> ... and so on."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1519830908, "post_id": 49032776, "comment_id": 85070255, "body": "using typedef struct allows to be able to omit <code>struct</code> keyword in function prototypes"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1519830913, "post_id": 49032776, "comment_id": 85070263, "body": "Also virtual functions need to be handled through a function vector or function pointers."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1519830991, "post_id": 49032776, "comment_id": 85070312, "body": "@AjayBrahmakshatriya <i>function vector</i> is not a C term, as far as I know."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 3, "creation_date": 1519831059, "post_id": 49032776, "comment_id": 85070360, "body": "@machine_1 I don&#39;t think it&#39;s a term at all."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519832945, "post_id": 49032776, "comment_id": 85071606, "body": "Errr.. <code>obj-&gt;strcpy</code> ??"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1519834639, "post_id": 49032776, "comment_id": 85072708, "body": "@machine_1 I meant an array of function pointers.  (I used the term function vector because of similarity to interrupt vectors, pardon me for that)"}], "tags": [], "owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "is_accepted": false, "score": 8, "last_activity_date": 1519833485, "last_edit_date": 1519833485, "creation_date": 1519830722, "answer_id": 49032776, "question_id": 49032563, "link": "https://stackoverflow.com/questions/49032563/how-to-implement-member-functions-used-in-c-to-convert-the-same-program-in-c/49032776#49032776", "title": "How to implement member functions used in C++ to convert the same program in C?", "body": "<p>Following example works as long as you use the C like part of C++. No std or C++ features, that do not have a simple equivalent in C (e.g. templates).</p>\n\n<ol>\n<li><p>Use a struct instead of a class</p>\n\n<pre><code>struct prev_class {\n    long bal,dep,wdamt; int acno; char name[20], type;\n};\n</code></pre></li>\n<li><p>Convert your member functions to free functions using as a first parameter a pointer to that struct:</p>\n\n<pre><code>void prev_class_set(struct prev_class* obj, int x, char n[20], char t) {\n    obj-&gt;acno = x;\n    strcpy(obj-&gt;name, n);\n    obj-&gt;type = t;\n    obj-&gt;bal = 0;\n}\n</code></pre></li>\n<li><p>Substitute your C++ specific calls like <code>cout</code> or <code>cin</code> with C conform functions.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "edited": false, "score": 0, "creation_date": 1519831105, "post_id": 49032839, "comment_id": 85070386, "body": "Thank you! This is exactly what i was looking for!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1519831246, "post_id": 49032839, "comment_id": 85070474, "body": "&quot;convert class bank to struct bank, removing all private:/public&quot; That&#39;s just sloppy. The proper way is to replace the class with an opaque type. There&#39;s no reason to toss OO out the door just because you move to C."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519831379, "post_id": 49032839, "comment_id": 85070549, "body": "@Lundin that&#39;s true, but  the OP wrote <i>&quot;I just know basic level C&quot;</i> so I didn&#39;t want to make it any more complicated than necessary."}, {"owner": {"reputation": 55059, "user_id": 212858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1166c87b6f3fc2e6746da96b60fefb46?s=128&d=identicon&r=PG", "display_name": "Useless", "link": "https://stackoverflow.com/users/212858/useless"}, "edited": false, "score": 0, "creation_date": 1519831442, "post_id": 49032839, "comment_id": 85070599, "body": "Opaque types also require using pointers, so OP can&#39;t straightforwardly translate <code>&#47;*struct*&#47; bank cust[10];</code> from the original code"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1519831461, "post_id": 49032839, "comment_id": 85070610, "body": "Well, any would-be programmer has to study OO, no matter which language they settle for. It is a language-agnostic way to design computer programs. Some languages have more built-in support than others."}, {"owner": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "edited": false, "score": 0, "creation_date": 1519832544, "post_id": 49032839, "comment_id": 85071314, "body": "Hey man I tried what you told me and it compiles without any errors or warnings, but when i run it, it will force stop when I enter &quot;1&quot; for new customer. It says &quot;Process returned -1073741819 (0xC0000005)&quot;"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "edited": false, "score": 0, "creation_date": 1519832809, "post_id": 49032839, "comment_id": 85071510, "body": "@GtlsGamr you need to debug this or post another question. You probably misuse <code>scanf</code>, but without seeing your actual code it&#39;s hard to tell"}, {"owner": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "edited": false, "score": 0, "creation_date": 1519832982, "post_id": 49032839, "comment_id": 85071639, "body": "@MichaelWalz Yeah, i debugged it. I was using scanf the wrong way. Thanks again!"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 5, "last_activity_date": 1519831704, "last_edit_date": 1519831704, "creation_date": 1519830912, "answer_id": 49032839, "question_id": 49032563, "link": "https://stackoverflow.com/questions/49032563/how-to-implement-member-functions-used-in-c-to-convert-the-same-program-in-c/49032839#49032839", "title": "How to implement member functions used in C++ to convert the same program in C?", "body": "<p>Roughly like this:</p>\n\n<ul>\n<li>convert all class methods such as <code>set</code> to normal functions (more details below)</li>\n<li>convert all input/output from <code>cin/cout</code> to <code>scanf</code>/<code>printf</code></li>\n<li>convert <code>class bank</code> to <code>struct bank</code>, removing all <code>private:/public:</code></li>\n<li>add another <code>this</code> parameter to all converted class methods so you can emulate more ore less the C++ <code>this</code>, see below</li>\n</ul>\n\n<p>Converted <code>set</code> function (the name <code>set</code> has been replaced <code>bank_set</code>, that is not necessary, but it might prevent name collisions if there was already a free <code>set</code> function beforehand):</p>\n\n<pre><code>void bank_set(struct bank *this, int x, char n[20], char t)\n{\n    this-&gt;acno = x;\n    strcpy(this-&gt;name, n);\n    this-&gt;type = t;\n    this-&gt;bal = 0;\n}\n</code></pre>\n\n<p>Convert calls to class methods e.g like this:</p>\n\n<pre><code>cust[count].set(count, cname, ctype);\n</code></pre>\n\n<p>becomes:</p>\n\n<pre><code>bank_set(&amp;cust[count], count, cname, ctype);\n</code></pre>\n\n<p>Do the same for all other class methods.</p>\n\n<p>This only works because your C++ program is old fashioned \"C-like\" C++ and you're not using inheritance.</p>\n"}], "owner": {"reputation": 71, "user_id": 5246092, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bQhyjIvFL3c/AAAAAAAAAAI/AAAAAAAAAgA/WsjGiDu_TS8/photo.jpg?sz=128", "display_name": "GtlsGamr", "link": "https://stackoverflow.com/users/5246092/gtlsgamr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537676263, "creation_date": 1519830110, "last_edit_date": 1537676263, "question_id": 49032563, "link": "https://stackoverflow.com/questions/49032563/how-to-implement-member-functions-used-in-c-to-convert-the-same-program-in-c", "title": "How to implement member functions used in C++ to convert the same program in C?", "body": "<p>I need to convert a program from C++ to C, i.e. I need the same program but in C.<br>\nI used member functions for a class in C++ but I just know basic level C.<br>\nI know this can be done using structures, but how do I implement the class functions for Structure in C?<br>\nHere is the code. This is a simple program to make bank accounts and deposit, withdraw or display account status: </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;string.h&gt;\n\nint count = 0;\n\nusing namespace std;\n\nclass bank\n{\npublic:\n    long bal, dep, wdamt; \n    int acno; \n    char name[20], type;\npublic:\n    void set(int x, char n[20], char t)\n    {\n        acno = x;\n        strcpy(name, n);\n        type = t;\n        bal = 0;\n    }\n    void deposit(long z)\n    {\n        bal += z;\n        cout &lt;&lt; \"success!\";\n    }\n    void withdraw(long k)\n    {\n        bal -= k;\n        cout &lt;&lt; \"success!\";\n    }\n    void display()\n    {\n        cout &lt;&lt; \"\\n Name : \" &lt;&lt; name &lt;&lt; \"\\n AC BALANCE : \" &lt;&lt; bal;\n    }\n};\n\nint main()\n{\n    bank cust[10];\n    int c1, c2, cacno, i = 0, j = 0; \n    long cbal, cdep, cwdamt; \n    char cname[20], ctype;\n\n    while (j &lt; 10)\n    {\n\n        cout &lt;&lt; \"\\n \\n **** welcome to golu bank ****\";\n        cout &lt;&lt; \"\\n choose one of the following \\n1. New customer \\n2. Existing Customer \\n 3. Exit\";\n        cin &gt;&gt; c1;\n\n        switch (c1)\n        {\n        case 1: cout &lt;&lt; \"\\nnew customer. please enter name. \";\n            cin &gt;&gt; cname;\n            cout &lt;&lt; \"\\nEnter account type. \";\n            cin &gt;&gt; ctype;\n            cust[count].set(count, cname, ctype);\n            cout &lt;&lt; \"Hello! Your a/c number is \" &lt;&lt; cust[count].acno &lt;&lt; endl &lt;&lt; \"PRESS ENTER TO CONTINUE:\";\n            cin.get();\n            count++;\n            break;\n        case 2: cout &lt;&lt; \"Existing Customer. Enter account number\";\n            cin &gt;&gt; cacno;\n            while (i &lt; 10)\n            {\n                if (cacno == cust[i].acno)\n                {\n                    cout &lt;&lt; \"\\n Enter choice! \\n 1.Deposit \\n 2. Withdraw \\n 3. Display\\n 4.Exit\";\n                    cin &gt;&gt; c2;\n                    switch (c2)\n                    {\n                    case 1: cout &lt;&lt; \"Enter amount to deposit\";\n                        cin &gt;&gt; cdep;\n                        cust[i].deposit(cdep); break;\n                    case 2: cout &lt;&lt; \"Enter amount to withdraw\";\n                        cin &gt;&gt; cwdamt;\n                        if (cwdamt &gt; cust[i].bal)\n                            cout &lt;&lt; \"Insufficent funds!!!\";\n                        else\n                            cust[i].withdraw(cwdamt);\n                        break;\n                    case 3:  cust[i].display();\n                        break;\n                    case 4:  i = 11;\n                    default: \"Invalid choice\";\n                    }\n                }\n                else\n                    i++;\n            }\n        case 3: j = 11;\n        default: \"Invalid choice\";\n        }\n    }\n    return 0;\n    cin.get();\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "garbage", "gets", "puts"], "comments": [{"owner": {"reputation": 5535, "user_id": 1173638, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mq0Io.gif?s=128&g=1", "display_name": "Adder", "link": "https://stackoverflow.com/users/1173638/adder"}, "edited": false, "score": 5, "creation_date": 1519830060, "post_id": 49032507, "comment_id": 85069663, "body": "Try <code>char para[3][20];</code>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1519830108, "post_id": 49032507, "comment_id": 85069696, "body": "1. <code>gets</code> doesn&#39;t exist anymore (since C11). 2. Assuming you have an ancient implementation where <code>gets</code> is available, you can&#39;t anymore than 2 chars because there&#39;s no space per call (that&#39;s the reason you should <i>never</i> use <code>gets</code>!)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1519830527, "post_id": 49032507, "comment_id": 85069992, "body": "What you need to do, is to take your source of learning (teacher or book) and then burn it with fire. Then get a better one."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 5535, "user_id": 1173638, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mq0Io.gif?s=128&g=1", "display_name": "Adder", "link": "https://stackoverflow.com/users/1173638/adder"}, "edited": false, "score": 0, "creation_date": 1519830737, "post_id": 49032507, "comment_id": 85070139, "body": "@Adder, yes, but a 2D array contains the same number of chars right? so it shouldn&#39;t be an issue. True, the strings could be truncated, but garbage? no."}, {"owner": {"reputation": 5535, "user_id": 1173638, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mq0Io.gif?s=128&g=1", "display_name": "Adder", "link": "https://stackoverflow.com/users/1173638/adder"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519831097, "post_id": 49032507, "comment_id": 85070382, "body": "@Jean, input longer than 3 characters will overflow into the other strings. Moreover the strings would not contain a terminating zero at position 3"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519831150, "post_id": 49032507, "comment_id": 85070413, "body": "my point exactly. So mixed strings yes, garbage, no."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1519831156, "post_id": 49032507, "comment_id": 85070415, "body": "See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why <code>gets()</code> is so dangerous it should <b>never</b> be used!</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519831285, "post_id": 49032507, "comment_id": 85070500, "body": "See also <a href=\"https://stackoverflow.com/questions/2979209/\">Using <code>fflush(stdin)</code></a>"}, {"owner": {"reputation": 1, "user_id": 9424099, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "PapoShow", "link": "https://stackoverflow.com/users/9424099/paposhow"}, "reply_to_user": {"reputation": 5535, "user_id": 1173638, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mq0Io.gif?s=128&g=1", "display_name": "Adder", "link": "https://stackoverflow.com/users/1173638/adder"}, "edited": false, "score": 0, "creation_date": 1519832830, "post_id": 49032507, "comment_id": 85071525, "body": "@Adder it worked."}, {"owner": {"reputation": 1, "user_id": 9424099, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "PapoShow", "link": "https://stackoverflow.com/users/9424099/paposhow"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519832886, "post_id": 49032507, "comment_id": 85071564, "body": "@Jean-Fran&#231;oisFabre, Yes, it was mixed strings not garbage."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519833053, "post_id": 49032507, "comment_id": 85071689, "body": "@PapoShow you don&#39;t need to confirm. <i>we know</i> :)"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 2, "last_activity_date": 1519830094, "creation_date": 1519830094, "answer_id": 49032558, "question_id": 49032507, "link": "https://stackoverflow.com/questions/49032507/why-am-i-getting-garbage-in-for-loop-using-string-array-gets-and-puts/49032558#49032558", "title": "Why am i getting garbage in for loop using string array, gets and puts?", "body": "<pre><code>fflush(stdin);   \n</code></pre>\n\n<p>is undefined behavior. It should be one output or update stream which is passed to <code>fflush</code>. This, what you have done might result in something weird to normal behavior. </p>\n\n<p><code>gets</code> is deprecated and not meant to be used. Use <code>fgets</code> instead. You should be able to enter <code>2</code> characters and a <code>\\n</code> with the array size shown. Maybe you meant <code>para[3][20]</code>. <code>gets</code> has no safety over buffer overflow. That is there is <code>fgets</code> in the form of specifying the number of characters you want to read.</p>\n"}], "owner": {"reputation": 1, "user_id": 9424099, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "PapoShow", "link": "https://stackoverflow.com/users/9424099/paposhow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1519830094, "creation_date": 1519829949, "question_id": 49032507, "link": "https://stackoverflow.com/questions/49032507/why-am-i-getting-garbage-in-for-loop-using-string-array-gets-and-puts", "title": "Why am i getting garbage in for loop using string array, gets and puts?", "body": "<p>The puts function doesn't print the 3 strings as i input them. They contain garbage.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main ()\n{\n    char para[20][3];\n    int x;\n\n    for(x=0; x&lt;3; x++)\n    {\n      gets(para[x]);\n      fflush(stdin);        \n    }\n\n    for(x=0; x&lt;3; x++)\n      puts(para[x]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "accelerometer", "i2c"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1519829799, "post_id": 49032291, "comment_id": 85069492, "body": "Do the last numbers represent the sensor moving? did you try the &quot;self-test&quot; section?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519830228, "post_id": 49032291, "comment_id": 85069794, "body": "Given that these kind of MEMS accelerometers give the full span from 0 to 8G , it isn&#39;t clear what these values are supposed to mean. But please note that code like <code>read_buffer[0+i*6]&lt;&lt;8</code> is a severe bug on 8 and 16 bit microcontrollers. Always use unsigned large integer types when doing bit shifts."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1519830758, "post_id": 49032291, "comment_id": 85070152, "body": "If your point is not learning how to develop this driver try looking up <a href=\"https://github.com/Snowda/LIS2DH\" rel=\"nofollow noreferrer\">already existing implementation</a> on github."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1519831060, "post_id": 49032291, "comment_id": 85070362, "body": "@pbn That project seems to miss the actual I2C/SPI part? At least when interfacing these parts with SPI, they have various non-standard timing requirements, that have to be sorted with bit-banging. Overall they are messy to work with."}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1519831609, "post_id": 49032291, "comment_id": 85070730, "body": "@Lunding Correct me if I&#39;m wrong but for arduino &quot;Wire&quot; is the I2C. If I understood correctly OP wants to understand how to setup registers and not how to play with I2C configuration. I assumed I2C internals are on a lower level than OP question and read/write just works."}, {"owner": {"reputation": 11, "user_id": 9423257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert Rodr&#237;guez", "link": "https://stackoverflow.com/users/9423257/robert-rodr%c3%adguez"}, "edited": false, "score": 0, "creation_date": 1520215153, "post_id": 49032291, "comment_id": 85210128, "body": "I don&#39;t know where the problem is. Actually the datasheet of the accelerometer assumes that you always detect 1g while standing still. I can&#39;t find any option to disable/compensate it. Also it seems that the data reading is the correct for the configuration.  Anybody can help me?"}, {"owner": {"reputation": 11, "user_id": 9423257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert Rodr&#237;guez", "link": "https://stackoverflow.com/users/9423257/robert-rodr%c3%adguez"}, "reply_to_user": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 0, "creation_date": 1521705585, "post_id": 49032291, "comment_id": 85847370, "body": "I&#39;ve tried to adapt the implementation of @pbn and it keeps on getting weird values"}], "owner": {"reputation": 11, "user_id": 9423257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Robert Rodr&#237;guez", "link": "https://stackoverflow.com/users/9423257/robert-rodr%c3%adguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 654, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1532001836, "creation_date": 1519829320, "last_edit_date": 1519977554, "question_id": 49032291, "link": "https://stackoverflow.com/questions/49032291/how-to-read-values-with-accelerometer-lis2dh-on-i2c", "title": "How to read values with accelerometer lis2dh on I2C", "body": "<p>I've been trying to read acceleration values with the accelerometer, but I keep on reading near-0 values. I am not able to read the 1G acceleration it should usually read.</p>\n\n<p>Registers:</p>\n\n<pre><code>#define ACCEL_CTRL_REG1     0x20\n#define ACCEL_CTRL_REF      0x26\n#define ACCEL_OUT_X_L       0x28\n#define ACCEL_FIFO_CTRL     0x2E\n#define ACCEL_INT1_CFG      0x30\n#define ACCEL_INT1_SRC      0x31\n#define ACCEL_INT1_THS      0x32\n#define ACCEL_INT1_DURATION 0x33\n#define ACCEL_INT2_CFG      0x34\n#define ACCEL_INT2_SRC      0x35\n#define ACCEL_INT2_THS      0x36\n#define ACCEL_INT2_DURATION 0x37\n#define ACCEL_CLICK_CFG     0x38\n#define ACCEL_CLICK_SRC     0x39\n#define ACCEL_CLICK_THS     0x3A\n</code></pre>\n\n<p>Configuration:</p>\n\n<pre><code>//Start accel\nwrite_buffer[0] = ACCEL_CTRL_REG1 | 0x80; // Register | Autoincrement ON\nwrite_buffer[1] = (accel_range &lt;&lt; 4) | 0x0F; // Value: 50Hz | Low power | enable all axis\nwrite_buffer[2] = 0x09; // Value: INT1 Filter\nwrite_buffer[3] = 0x40; // Value: Enable IA interrupt on INT1\nwrite_buffer[4] = 0x00; // Value:\nwrite_buffer[5] = 0x48; // Value: Enable FIFO | latch Int1\nwrite_buffer[6] = 0x00; // Value: INT1\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, write_buffer,7);\n\n//Setup movent interrupt\nwrite_buffer[0] = ACCEL_INT1_THS | 0x80; // Register | Autoincrement ON\nwrite_buffer[1] = thr; // Threshold\nwrite_buffer[2] = dur; // Duration\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, write_buffer,3);\n\n//Dummy read to reset HP filter\nregisterAdrr = ACCEL_CTRL_REF;\nQl_IIC_Write_Read(1, ACCEL_ADDRESS, &amp;registerAdrr, 1,read_buffer, 1);\n\n//Enable interrupt\nwrite_buffer[0] = ACCEL_INT1_CFG; // Register\nwrite_buffer[1] = 0x2A; // Enable High on Z Y X\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, write_buffer,2);\n\nwrite_buffer[0] = ACCEL_FIFO_CTRL; // Register\nwrite_buffer[1] = 0xC0; // Stream-to-FIFO mode\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, write_buffer,2);\n</code></pre>\n\n<p>Also, I have to reset interrupts and FIFO after catching the interrupt</p>\n\n<pre><code>u8 registerAdrr[1]={ACCEL_INT1_SRC};\nret = Ql_IIC_Write_Read(1, ACCEL_ADDRESS, registerAdrr, 1,read_buffer, 1);\n\nread_buffer[0] = ACCEL_FIFO_CTRL; // Register\nread_buffer[1] = 0x00; // Bypass FIFO mode\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, read_buffer,2);\nread_buffer[0] = ACCEL_FIFO_CTRL; // Register\nread_buffer[1] = 0xC0; // Stream-to-FIFO mode\nret = Ql_IIC_Write(1, ACCEL_ADDRESS, read_buffer,2);\n</code></pre>\n\n<p>This is the code I use to read the values:</p>\n\n<pre><code>#define ACCEL_ADDRESS 0x30\ns32 ret = 0;\ns8 read_buffer[200];\nu8 registerAdrr[1]={ACCEL_OUT_X_L | 0x80}; // Autoincrement ON\nu8 i;\n\nQl_memset(read_buffer, 0, sizeof(read_buffer));\n\nfor (i=0; i&lt;32; i++)\n{\n    ret = Ql_IIC_Write_Read(1, ACCEL_ADDRESS, registerAdrr, 1, &amp;read_buffer[i*6], 6);\n    if(ret &lt; 0)\n    {\n        // Error\n        APP_DEBUG(\"\\r\\n&lt;--Failed !! IIC controller Ql_IIC_Write_Read channel 1 fail ret=%d--&gt;\\r\\n\",ret);\n        return -1;\n    }\n\n    APP_DEBUG(\"x:%d, y:%d, z:%d\\r\\n\", (read_buffer[0+i*6]&lt;&lt;8) + read_buffer[1+i*6], (read_buffer[2+i*6]&lt;&lt;8) + read_buffer[3+i*6], (read_buffer[4+i*6]&lt;&lt;8) + read_buffer[5+i*6]);\n}\n</code></pre>\n\n<p>This are the values I get. I just moved it while it was resting on my table, so it should show the gravity vector, but it just gets random numbers while standing:</p>\n\n<pre><code>[2018-02-28_12:47:05:137]Movement detected\n[2018-02-28_12:47:05:137]x:0, y:-1, z:-1\n[2018-02-28_12:47:05:137]x:0, y:-1, z:-1\n[2018-02-28_12:47:05:137]x:0, y:0, z:0\n[2018-02-28_12:47:05:137]x:0, y:-1, z:0\n[2018-02-28_12:47:05:137]x:0, y:0, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:-1, z:0\n[2018-02-28_12:47:05:137]x:-1, y:0, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:0, z:0\n[2018-02-28_12:47:05:137]x:-1, y:0, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:-1, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:0, z:0\n[2018-02-28_12:47:05:137]x:0, y:0, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:-1, z:0\n[2018-02-28_12:47:05:137]x:0, y:0, z:-1\n[2018-02-28_12:47:05:137]x:-1, y:0, z:0\n[2018-02-28_12:47:05:164]x:0, y:0, z:0\n[2018-02-28_12:47:05:164]x:0, y:0, z:-1\n[2018-02-28_12:47:05:164]x:0, y:1, z:-1\n[2018-02-28_12:47:05:164]x:-1, y:-1, z:0\n[2018-02-28_12:47:05:164]x:0, y:0, z:-1\n[2018-02-28_12:47:05:164]x:-1, y:0, z:0\n[2018-02-28_12:47:05:164]x:0, y:0, z:-1\n[2018-02-28_12:47:05:164]x:0, y:0, z:-1\n[2018-02-28_12:47:05:164]x:-1, y:0, z:-1\n[2018-02-28_12:47:05:164]x:0, y:0, z:0\n[2018-02-28_12:47:05:164]x:-1, y:0, z:-1\n[2018-02-28_12:47:05:164]x:-1, y:0, z:1\n[2018-02-28_12:47:05:164]x:0, y:-1, z:0\n[2018-02-28_12:47:05:164]x:-112, y:96, z:-117\n[2018-02-28_12:47:05:164]x:15, y:43, z:121\n[2018-02-28_12:47:05:191]x:-100, y:-73, z:105\n[2018-02-28_12:47:05:191]x:-64, y:-53, z:92\n</code></pre>\n\n<p>Datasheet of the LIS2DH:\n<a href=\"http://www.st.com/content/ccc/resource/technical/document/datasheet/c1/e1/62/31/d2/b1/4d/bb/DM00042751.pdf/files/DM00042751.pdf/jcr:content/translations/en.DM00042751.pdf\" rel=\"nofollow noreferrer\">http://www.st.com/content/ccc/resource/technical/document/datasheet/c1/e1/62/31/d2/b1/4d/bb/DM00042751.pdf/files/DM00042751.pdf/jcr:content/translations/en.DM00042751.pdf</a></p>\n\n<p>Thank you very much for your time.</p>\n"}, {"tags": ["c", "posix", "chmod", "file-rename", "chown"], "comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1519837334, "post_id": 49031335, "comment_id": 85074537, "body": "this answer <a href=\"https://unix.stackexchange.com/a/368641/92787\">unix.stackexchange.com/a/368641/92787</a> talks about this problem. It doesn&#39;t look like there is a solution for this. You have to choose either atomicity or keeping the owner&amp;permissions."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1520003226, "post_id": 49031335, "comment_id": 85149076, "body": "Does ZFS on Linux support the <code>rstchown</code> option?  That would be a solution if it&#39;s supported."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1520359833, "post_id": 49031335, "comment_id": 85279763, "body": "Nobody is going to thank you for putting effort into this.   Using file systems as ad hoc synchronization mechanisms was never a good idea, and in modern systems is a very bad idea.  As much as possible, you want your code to work in every possible environment; relying upon  single system image semantics works against this."}, {"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "reply_to_user": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 0, "creation_date": 1520527615, "post_id": 49031335, "comment_id": 85361917, "body": "@mevets: You&#39;re right, and in fact I&#39;m working on migrating away from a filesystem for this mechanism anyway. However, until the replacement system is in place, I want to do my utmost to avoid file corruption from the existing processes that are already unsafely manipulating shared state in this file, which is what prompted this question in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1519840433, "last_edit_date": 1519840433, "creation_date": 1519840060, "answer_id": 49035666, "question_id": 49031335, "link": "https://stackoverflow.com/questions/49031335/how-to-preserve-ownership-and-permissions-when-doing-an-atomic-file-replace/49035666#49035666", "title": "How to preserve ownership and permissions when doing an atomic file replace?", "body": "<p>I am by no means an expert in this area, but I don't think it's possible. This <a href=\"https://unix.stackexchange.com/a/368641/92787\">answer</a> seems to back this up. There has to be a compromise.</p>\n\n<p>Here are some possible solutions. Every one has advantages and disadvantages and weighted and chosen depending on the use case and scenario.</p>\n\n<ul>\n<li><p>Use <strong>atomic rename</strong>.  </p>\n\n<p><strong>Advantage</strong>: atomic operation</p>\n\n<p><strong>Disadvantage</strong>: possible to not keep owner/permissions</p></li>\n<li><p>Create a backup. <strong>Write file in place</strong></p>\n\n<p>This is what some text editor do.</p>\n\n<p><strong>Advantage</strong>: will keep owner/permissions  </p>\n\n<p><strong>Disadvantage</strong>: no atomicity. Can corrupt file. Other application might get a \"draft\" version of the file.</p></li>\n<li><p><strong>Set up permissions</strong> to the folder such that creating a new file is possible with the original owner &amp; attributes.</p>\n\n<p><strong>Advantages</strong>: atomicity &amp; owner/permissions are kept</p>\n\n<p><strong>Disadvantages</strong>: Can be used only in certain specific scenarios (knowledge at the time of creation of the files that would be edited, the security model must allow and permit this). Can decrease security.</p></li>\n<li><p>Create a <strong>daemon</strong>/service responsible for editing the files. This process would have the necessary permissions to create files with the respective owner &amp; permissions. It would accept requests to edit files.</p>\n\n<p><strong>Advantages</strong>: atomicity &amp; owner/permissions are kept. Higher and granular control to what and how can be edited.</p>\n\n<p><strong>Disadvantages</strong>. Possible in only specific scenarios. More complex to implement. Might require deployment and installation. Adding an attack surface. Adding another source of possible (security) bugs. Possible performance impact due to the added intermediate layer.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 842, "user_id": 2962393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76285cc6b167c3a818a5310bd4bbb183?s=128&d=identicon&r=PG&f=1", "display_name": "user2962393", "link": "https://stackoverflow.com/users/2962393/user2962393"}, "edited": false, "score": 0, "creation_date": 1520088610, "post_id": 49079630, "comment_id": 85176123, "body": "re: CAP_LEASE: What happens if another process has the file open or mmap()&#39;ed when the process obtains the exclusive lease?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 842, "user_id": 2962393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76285cc6b167c3a818a5310bd4bbb183?s=128&d=identicon&r=PG&f=1", "display_name": "user2962393", "link": "https://stackoverflow.com/users/2962393/user2962393"}, "edited": false, "score": 1, "creation_date": 1520174046, "post_id": 49079630, "comment_id": 85197974, "body": "@user2962393: If another process has it open or mapped, you don&#39;t get the exclusive lease."}, {"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 0, "creation_date": 1520527528, "post_id": 49079630, "comment_id": 85361861, "body": "All the answers on this question are good, but I think this one deserves the bounty because of the last paragraph: if we ensure that we have a dedicated local group with correct permissions (which in my case we do), then the file owner field becomes less important, and preserving it is not critical. This is ultimately the solution I ended up going with, at least for now. (Longer term I am migrating this particular bit of data into a dedicated database so that we can outsource the whole problem of locking and atomic updates.)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 3, "last_activity_date": 1520039461, "creation_date": 1520039461, "answer_id": 49079630, "question_id": 49031335, "link": "https://stackoverflow.com/questions/49031335/how-to-preserve-ownership-and-permissions-when-doing-an-atomic-file-replace/49079630#49079630", "title": "How to preserve ownership and permissions when doing an atomic file replace?", "body": "<blockquote>\n  <p>Is the only solution to ensure that the uid/gid of the file matches the current user and group of the process overwriting the file?</p>\n</blockquote>\n\n<p>No.</p>\n\n<p>In Linux, a process with the <code>CAP_LEASE</code> capability can obtain an exclusive lease on the file, which blocks other processes from opening the file for up to <code>/proc/sys/fs/lease-break-time</code> seconds. This means that technically, you can take the exclusive lease, replace the file contents, and release the lease, to modify the file atomically (from the perspective of other processes).</p>\n\n<p>Also, a process with the <code>CAP_CHOWN</code> capability can change the file ownership (user and group) arbitrarily.</p>\n\n<blockquote>\n  <p>Is there a safe way to [handle the case where the uid or gid does not match the current process], or do we necessarily lose the atomic guarantee?</p>\n</blockquote>\n\n<p>Considering that in general, files may have <a href=\"http://man7.org/linux/man-pages/man5/acl.5.html\" rel=\"nofollow noreferrer\">ACL</a>s and <a href=\"http://man7.org/linux/man-pages/man7/xattr.7.html\" rel=\"nofollow noreferrer\">xattr</a>s, it might be useful to create a helper program, that clones the ownership including ACLs, and extended attributes, from an existing file to a new file in the same directory (perhaps with a fixed name pattern, say <code>.new-################</code>, where <code>#</code> indicate random alphanumeric characters), if the real user (<code>getuid()</code>, <code>getgid()</code>, <code>getgroups()</code>) is allowed to modify the original file. This helper program would have at least the <code>CAP_CHOWN</code> capability, and would have to consider the various security aspects (especially the ways it could be exploited). (However, if the caller can overwrite the contents, and create new files in the target directory -- the caller must have write access to the target directory, so that they can do the rename/hardlink replacement --, creating a clone file on their behalf with empty contents <em>ought</em> to be safe. I would personally exclude target files owned by root user or group, though.)</p>\n\n<p>Essentially, the helper program would behave much like the <code>mktemp</code> command, except it would take the path to the existing target file as a parameter. It would then be relatively straightforward to wrap it into a library function, using e.g. <code>fork()</code>/<code>exec()</code> and pipes or sockets.</p>\n\n<p>I personally avoid this problem by using group-based access controls: dedicated (local) group for each set. The file owner field is basically just an informational field then, indicating the user that last recreated  (or was in charge of) said file, with access control entirely based on the group. This means that changing the mode and the group id to match the original file suffices. (Copying ACLs would be even better, though.) If the user is a member of the target group, they can do the <code>fchown()</code> to change the group of any file they own, as well as the <code>fchmod()</code> to set the mode, too.</p>\n"}, {"comments": [{"owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "edited": false, "score": 0, "creation_date": 1520527777, "post_id": 49103712, "comment_id": 85362020, "body": "This is an excellent answer, and I considered awarding it the bounty, but ultimately I gave Nominal Animal the nod. But thank you for your answer: the dance of making a backup file and copying data around was my second-favorite solution to this problem. And also thank you for pointing out that restricting myself to POSIX might be limiting my options here; in my specific case, Linux is of utmost importance (although compatibility with Mac OS is nice because developers use Macs for some of this software)."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1520225858, "creation_date": 1520225858, "answer_id": 49103712, "question_id": 49031335, "link": "https://stackoverflow.com/questions/49031335/how-to-preserve-ownership-and-permissions-when-doing-an-atomic-file-replace/49103712#49103712", "title": "How to preserve ownership and permissions when doing an atomic file replace?", "body": "<ul>\n<li>Do you have to worry about the file that's named being a symlink to a file somewhere else in the file system?</li>\n<li>Do you have to worry about the file that's named being one of multiple links to an inode (<code>st_nlink &gt; 1</code>).</li>\n<li>Do you need to worry about extended attributes?</li>\n<li>Do you need to worry about ACLs?</li>\n<li>Does the user ID and group IDs of the current process permit the process to write in the directory where the file is stored?</li>\n<li>Is there enough disk space available for both the old and the new files on the same file system?</li>\n</ul>\n\n<p>Each of these issues complicates the operation.</p>\n\n<p>Symlinks are relatively easy to deal with; you simply need to establish the <code>realpath()</code> to the actual file and do file creation operations in the directory containing the real path to the file.  From here on, they're a non-issue.</p>\n\n<p>In the simplest case, where the user (process) running the operation owns the file and the directory where the file is stored, can set the group on the file, the file has no hard links, ACLs or extended attributes, and there's enough space available, then you can get atomic operation with more or less the sequence outlined in the question \u2014 you'd do group and permission setting before executing the atomic <code>rename()</code> operation.</p>\n\n<p>There is an outside risk of TOCTOU \u2014 time of check, time of use \u2014 problems with file attributes.  If a link is added between the time when it is determined that there are no links and the rename operation, then the link is broken.  If the owner or group or permissions on the file change between the time when they're checked and set on the new file, then the changes are lost.  You could reduce the risk of that by breaking atomicity but renaming the old file to a temporary name, renaming the new file to the original name, and rechecking the attributes on the renamed old file before deleting it.  That is probably an unnecessary complication for most people, most of the time.</p>\n\n<p>If the target file has multiple hard links to it and those links must be preserved, or if the file has ACLs or extended attributes and you don't wish to work out how to copy those to the new file, then you might consider something along the lines of:</p>\n\n<ol>\n<li>write the output to a named temporary file in the same directory as the target file;</li>\n<li>copy the old (target) file to another named temporary file in the same directory as the target;</li>\n<li>if anything goes wrong during steps 1 or 2, abandon the operation with no damage done;</li>\n<li>ignoring signals as much as possible, copy the new file over the old file;</li>\n<li>if anything goes wrong during step 4, you can recover from the extra backup made in step 2;</li>\n<li>if anything goes wrong in step 5, report the file names (new file, backup of original file, broken file) for the user to clean up;</li>\n<li>clean up the temporary output file and the backup file.</li>\n</ol>\n\n<p>Clearly, this loses all pretense at atomicity, but it does preserve links, owner, group, permissions, ACLS, extended attributes. It also requires more space \u2014 if the file doesn't change size significantly, it requires 3 times the space of the original file (formally, it needs <code>size(old) + size(new) + max(size(old), size(new))</code> blocks). In its favour is that it is recoverable even if something goes wrong during the final copy \u2014 even a stray SIGKILL \u2014 as long as the temporary files have known names (the names can be determined).</p>\n\n<p>Automatic recovery from SIGKILL probably isn't feasible.  A SIGSTOP signal could be problematic too; a lot could happen while the process is stopped.</p>\n\n<p>I hope it goes without saying that errors must be detected and handled carefully with all the system calls used.</p>\n\n<p>If there isn't enough space on the target file system for all the copies of the files, or if the process cannot create files in the target directory (even though it can modify the original file), you have to consider what the alternatives are.  Can you identify another file system with enough space?  If there isn't enough space anywhere for both the old and the new file, you clearly have major issues \u2014 irresolvable ones for anything approaching atomicity.</p>\n\n<p>The <a href=\"https://stackoverflow.com/a/49079630/15168\">answer</a> by <a href=\"https://stackoverflow.com/users/1475978/nominal-animal\">Nominal Animal</a> mentions Linux capabilities.  Since the question is tagged POSIX and not Linux, it isn't clear whether those are applicable to you.  However, if they can be used, then <code>CAP_LEASE</code> sounds useful.</p>\n\n<ul>\n<li>How crucial is atomicity vs accuracy?</li>\n<li>How crucial is POSIX compliance vs working on Linux (or any other specific POSIX implementation)?</li>\n</ul>\n"}], "owner": {"reputation": 54296, "user_id": 128397, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/22b05e50077230ba919b240af4bc13cd?s=128&d=identicon&r=PG", "display_name": "Daniel Pryden", "link": "https://stackoverflow.com/users/128397/daniel-pryden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1520225858, "creation_date": 1519826478, "last_edit_date": 1519836912, "question_id": 49031335, "link": "https://stackoverflow.com/questions/49031335/how-to-preserve-ownership-and-permissions-when-doing-an-atomic-file-replace", "title": "How to preserve ownership and permissions when doing an atomic file replace?", "body": "<p>So, the normal POSIX way to safely, atomically replace the contents of a file is:</p>\n\n<ul>\n<li><code>fopen(3)</code> a temporary file on the same volume</li>\n<li><code>fwrite(3)</code> the new contents to the temporary file</li>\n<li><code>fflush(3)</code>/<code>fsync(2)</code> to ensure the contents are written to disk</li>\n<li><code>fclose(3)</code> the temporary file</li>\n<li><code>rename(2)</code> the temporary file to replace the target file</li>\n</ul>\n\n<p>However, on my Linux system (Ubuntu 16.04 LTS), one consequence of this process is that the ownership and permissions of the target file change to the ownership and permissions of the temporary file, which default to <code>uid</code>/<code>gid</code> and current <code>umask</code>.</p>\n\n<p>I thought I would add code to <code>stat(2)</code> the target file before overwriting, and <code>fchown(2)</code>/<code>fchmod(2)</code> the temporary file before calling <code>rename</code>, but that can fail due to <code>EPERM</code>.</p>\n\n<p>Is the only solution to ensure that the <code>uid</code>/<code>gid</code> of the file matches the current user and group of the process overwriting the file? Is there a safe way to fall back in this case, or do we necessarily lose the atomic guarantee?</p>\n"}, {"tags": ["c", "casting", "free", "void-pointers"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519825572, "post_id": 49031032, "comment_id": 85066518, "body": "It&#39;s probably c++."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519828168, "post_id": 49031032, "comment_id": 85068341, "body": "dave558, Curious, in this case, what type was <code>array1[i]</code>?  Was the allocation for it also employed a cast?"}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 6, "creation_date": 1519825893, "post_id": 49031068, "comment_id": 85066756, "body": "Even in C++ the cast isn&#39;t needed. <a href=\"https://www.ideone.com/Tlf1y0\" rel=\"nofollow noreferrer\">Life demo</a>. Correct me if I&#39;m wrong"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519827955, "post_id": 49031068, "comment_id": 85068192, "body": "Ah, come to think of it I believe C++ does not allow implicit conversion from <code>void*</code> to <code>type*</code>, but the other way around is ok."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1519830147, "post_id": 49031068, "comment_id": 85069731, "body": "It could be that the code is in a header file that&#39;s used in both C and C++ projects. I have a header file library or two that I made C++ compatible for the occasional use in a C++ project (though I much prefer C)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519830328, "post_id": 49031068, "comment_id": 85069862, "body": "I suppose it could also be there to cast away qualifiers, In which case the code is fishy, no matter C or C++."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1519862135, "post_id": 49031068, "comment_id": 85086482, "body": "Some people feel that it aids const-correctness to use a <code>const T *</code> for the case where a dynamically allocated object has its value set upon allocation and is not to be modified thereafter"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 7, "last_activity_date": 1519825598, "creation_date": 1519825598, "answer_id": 49031068, "question_id": 49031032, "link": "https://stackoverflow.com/questions/49031032/casting-to-void-before-freeing-memory-c-programming/49031068#49031068", "title": "Casting to void * before freeing memory (C programming)", "body": "<p>That cast is nonsense in C. </p>\n\n<p>It might be that they are compiling the code in a C++ compiler, in which case the cast is needed. But compiling C code with a C++ compiler is not a good idea in general. </p>\n"}], "owner": {"reputation": 337, "user_id": 2688068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbea6346c4195777716df638b4a6980c?s=128&d=identicon&r=PG&f=1", "display_name": "supmethods", "link": "https://stackoverflow.com/users/2688068/supmethods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "closed_date": 1519826483, "answer_count": 1, "score": 1, "last_activity_date": 1519859518, "creation_date": 1519825504, "last_edit_date": 1519859518, "question_id": 49031032, "link": "https://stackoverflow.com/questions/49031032/casting-to-void-before-freeing-memory-c-programming", "closed_reason": "Duplicate", "title": "Casting to void * before freeing memory (C programming)", "body": "<p>I came across this code and wondering why it has been casted to <code>void *</code> before freeing?</p>\n\n<pre><code>free((void *)array1[i]);\n</code></pre>\n\n<p>I have seen <code>free</code> used without casting in some articles, so I'm wondering why you would cast to <code>void *</code> when freeing memory?</p>\n\n<p>Here's how they have allocated and freed memory:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint **array1 = malloc(nrows * sizeof(int *));\nfor(i = 0; i &lt; nrows; i++)\n    array1[i] = malloc(ncolumns * sizeof(int));\n\nfor(i = 0; i &lt; nrows; i++)\n    free((void *)array1[i]);\nfree((void *)array1);\n</code></pre>\n\n<p>Referring to <a href=\"https://stackoverflow.com/questions/25339569/casting-free-argument-to-void\">this</a>, some gcc version may throw a warning but overall it's unnecessary. </p>\n"}, {"tags": ["c", "function", "file-io"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1519825507, "post_id": 49030997, "comment_id": 85066466, "body": "Please <a href=\"https://stackoverflow.com/posts/49030997/edit\">edit</a> your question and show a minimal example of the Questions.dat file. Show also an example of input and actuel/desired output"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519828496, "post_id": 49030997, "comment_id": 85068592, "body": "Save time and enable all compiler warnings.  Much faster feedback than a SO post."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519828747, "post_id": 49030997, "comment_id": 85068764, "body": "A problem with this code stems from using <code>scanf( ...</code> , <code>getch();</code> and and not checking the result.  Although fixable, it a weak design choice. I recommend to replace all user input with <code>fgets()</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1519828929, "post_id": 49030997, "comment_id": 85068877, "body": "<code>fflush(stdin)</code> is undefined behavior. <code>conio.h</code> is incredibly obsolete. You need a better source of learning C, your current one is teaching you bad practice."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1519832482, "post_id": 49030997, "comment_id": 85071275, "body": "You don&#39;t need, and shouldn&#39;t use, the <code>&amp;</code> in <code>scanf(&quot;%[^\\n]%*c&quot;, &amp;ques.question);</code> and related calls.  You should check the result from <code>scanf()</code>; you should limit the amount of data accepted to the size of the array: <code>if (scanf(&quot;%255[^\\n]&quot;%*c&quot;, ques.question) != 1) { \u2026problem!\u2026 }</code>.  You probably need to worry about overlong answers; for symmetry, you should worry about overlong questions, too."}], "owner": {"reputation": 39, "user_id": 6081411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d93f96708ba9148a133ea1b289df0d92?s=128&d=identicon&r=PG&f=1", "display_name": "A Angelo", "link": "https://stackoverflow.com/users/6081411/a-angelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519827212, "creation_date": 1519825400, "last_edit_date": 1519827212, "question_id": 49030997, "link": "https://stackoverflow.com/questions/49030997/function-successfully-writes-to-file-but-contents-do-not-show", "title": "Function successfully writes to file but contents do not show", "body": "<p>I have two functions that uses up a <code>.dat</code> file.\nThe first function adds a structure of a question and its answers to the file and the other is to view the questions in the file.</p>\n\n<p>The <code>addQues()</code> function is called <code>main</code> inside a loop that inquires if the user wants to add more questions. The problem is when the <code>addQues()</code> function is called the second time and onward, it successfully writes the question to the file but when the <code>viewQues()</code> function is called, the questions are not shown. The size of the file also increases after each succeeding call of <code>addques()</code></p>\n\n<pre><code>/*  the structure is as follows */\ntypedef struct {\n    char question[256];\n    char choiceA[32];\n    char choiceB[32];\n    char choiceC[32];\n    char choiceD[32];\n    char ans;\n    int num;    \n}question;\n\n/* function to add questions */\nvoid addQues(){\n    FILE *fileptr;\n    question catcher, ques;\n    int x;\n\n\n    fileptr = fopen(\"Questions.dat\", \"a+\");\n    if(fileptr != NULL){\n        catcher.num = 0;\n        while(fread(&amp;catcher, sizeof(question), 1, fileptr)!= 0){}\n\n        printf(\"There are %d questions. Please type in the Question you would like to add.\\n\\nQuestion: \", catcher.num);\n        fflush(stdin);\n        scanf(\"%[^\\n]%*c\", &amp;ques.question);\n\n        printf(\"Add four[4] choices to the question\\n\");\n\n        printf(\"\\nChoice a.: \");\n        fflush(stdin);\n        scanf(\"%[^\\n]%*c\", &amp;ques.choiceA);\n\n        printf(\"\\nChoice b.: \");\n        fflush(stdin);\n        scanf(\"%[^\\n]%*c\", &amp;ques.choiceB);\n\n        printf(\"\\nChoice c.: \");\n        fflush(stdin);\n        scanf(\"%[^\\n]%*c\", &amp;ques.choiceC);\n\n        printf(\"\\nChoice d.: \");\n        fflush(stdin);\n        scanf(\"%[^\\n]%*c\", &amp;ques.choiceD);\n\n        printf(\"\\nType the letter of the correct answer of this question.\\nAnswer: \");\n        fflush(stdin);\n        scanf(\"%c\", &amp;ques.ans);\n\n        ques.num = catcher.num+1;\n\n        printf(\"%s\", ques.question); /* made this snippet to make sure that white spaces in my input were recorded */\n        getch();\n\n        if(fwrite(&amp;ques, sizeof(question), 1,fileptr) == 1){\n            printf(\"File write was successful\\n\"); /* made this snippet to make sure if writing is successful. and it is successfull everytime */\n        }else{\n            printf(\"File write was unsuccessfull\");\n        }\n        getch();\n        fclose(fileptr);\n    }else{\n        printf(\"File either not found or does not exist.\");\n    }\n\n\n}\n\n/* code view the Questions in the file */\n\nvoid viewQues(){\n    FILE *fp;\n    question ques;\n\n    fp = fopen(\"Questions.dat\", \"r\");\n    if(fp != NULL){\n        while(fread(&amp;ques, sizeof(question), 1, fp) != 0){\n            printf(\"[%d] %s\\n\", ques.num, ques.question);\n            }\n\n        fclose(fp);\n    }else{\n        printf(\"File is either not found or does not exist.\");\n    }\n\n}\n</code></pre>\n\n<p>I am somehow confused because it somethimes works fluidly, sometimes it doesn't.</p>\n\n<p>This is only my 1st semester of taking up C-programming so I still have alot to learn.\nI am also quite new to this website please do forgive me if I may have violated any required format.</p>\n\n<p>EDIT:  <br/>\nThe program requires the user to input a question, 4 choices, and it's correct answer.</p>\n\n<p>in the <code>addQues</code> function before the program asks for input, it already notifies the user how many questions there are in the file.</p>\n\n<p>example is  <br/>\n<em>There are 0  question/s (this updates when a question is added). lease type in the Question you would like to add.</em>  <br/>  <br/>\n<em>Question: //user types What is the capital of Philippines?</em>  <br/>  <br/></p>\n\n<p><em>Enter  Choice A: // user types 'Manila'</em>  <br/>\n<em>Enter Choice B: // user types 'Cebu'</em>  <br/>\n<em>Enter Choice C:// user types 'Davao'</em>  <br/>\n<em>Enter Choice C:// user types 'Palawan'</em>  <br/>  <br/></p>\n\n<p><em>Enter the letter of the correct answer: // User types in 'a'</em>  <br/>  <br/></p>\n\n<p>Expected output would be  <br/></p>\n\n<p><em>[1] What is the capital of Philippines?</em></p>\n\n<p>after the second call and onwards the output that it shows is still only</p>\n\n<p><em>[1] What is the capital of Philippines?</em></p>\n\n<p>I am sorry I do not know how to make the sample scenario different from the rest of the text.</p>\n"}, {"tags": ["c", "powershell", "stdio"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 2, "creation_date": 1519824698, "post_id": 49030751, "comment_id": 85065873, "body": "Did you try entering a newline (by pressing ENTER key) or send EOF (by pressing ctrl+D)?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519824715, "post_id": 49030751, "comment_id": 85065882, "body": "You mention <code>gets()</code> and you shouldn&#39;t because it&#39;s no longer part of the standard library."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1519824790, "post_id": 49030751, "comment_id": 85065937, "body": "@P.P. on windows CTRL+D is actually CTRL+Z"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519824856, "post_id": 49030751, "comment_id": 85065987, "body": "@Jean-Fran&#231;oisFabre Indeed. I often forget that."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1519824905, "post_id": 49030751, "comment_id": 85066021, "body": "are you sure the code isn&#39;t just buffering the output? there are no <code>\\n</code> in your output calls"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519825049, "post_id": 49030751, "comment_id": 85066120, "body": "Try <code>printf(&quot;%c&quot;, ch);</code> --&gt; <code>{printf(&quot;%c&quot;, ch); fflush(stdout);}</code>"}, {"owner": {"reputation": 209, "user_id": 1685224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b1144bd01f8b18705e72a694b561d5d?s=128&d=identicon&r=PG", "display_name": "jreing", "link": "https://stackoverflow.com/users/1685224/jreing"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1519825213, "post_id": 49030751, "comment_id": 85066249, "body": "@P.P, Chris Turner, chux - tried your suggestions and it didn&#39;t work in Powershell."}, {"owner": {"reputation": 209, "user_id": 1685224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b1144bd01f8b18705e72a694b561d5d?s=128&d=identicon&r=PG", "display_name": "jreing", "link": "https://stackoverflow.com/users/1685224/jreing"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519825334, "post_id": 49030751, "comment_id": 85066346, "body": "@Iharob Al Asimi - is there any alternative you recommend instead?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 1, "creation_date": 1519825527, "post_id": 49030751, "comment_id": 85066488, "body": "@P.P. you can forget CTRL+Z AND powershell altogether. This pseudo unix crap from Microsoft just sucks."}, {"owner": {"reputation": 33567, "user_id": 1358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5f10d1a484dac4a364246bf9f410e9b?s=128&d=identicon&r=PG", "display_name": "EBGreen", "link": "https://stackoverflow.com/users/1358/ebgreen"}, "edited": false, "score": 0, "creation_date": 1519825690, "post_id": 49030751, "comment_id": 85066623, "body": "According to the OP it runs in cmd"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519825702, "post_id": 49030751, "comment_id": 85066630, "body": "@jreing Yes <code>fgets()</code> which takes the buffer size as a parameter and is hence safer."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519826285, "post_id": 49030751, "comment_id": 85067009, "body": "try <code>printf(&quot;hello world\\n&quot;);</code> (adding newline) and tell us if that prints"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519826406, "post_id": 49030751, "comment_id": 85067085, "body": "your code compiled with gcc works fine in my machine using powershell <code>PS S:\\&gt; .\\a.exe hello world hello you hello you</code>"}, {"owner": {"reputation": 33567, "user_id": 1358, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5f10d1a484dac4a364246bf9f410e9b?s=128&d=identicon&r=PG", "display_name": "EBGreen", "link": "https://stackoverflow.com/users/1358/ebgreen"}, "edited": false, "score": 0, "creation_date": 1519826615, "post_id": 49030751, "comment_id": 85067232, "body": "What version of powershell?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519827136, "post_id": 49030751, "comment_id": 85067559, "body": "I use windows 10"}, {"owner": {"reputation": 209, "user_id": 1685224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b1144bd01f8b18705e72a694b561d5d?s=128&d=identicon&r=PG", "display_name": "jreing", "link": "https://stackoverflow.com/users/1685224/jreing"}, "edited": false, "score": 0, "creation_date": 1519827314, "post_id": 49030751, "comment_id": 85067699, "body": "I compile with VS2015. Perhaps i should try gcc."}, {"owner": {"reputation": 209, "user_id": 1685224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b1144bd01f8b18705e72a694b561d5d?s=128&d=identicon&r=PG", "display_name": "jreing", "link": "https://stackoverflow.com/users/1685224/jreing"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519827349, "post_id": 49030751, "comment_id": 85067733, "body": "@Iharob Al Asimi: fgets() does the same, when compiled in VS."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1519827574, "post_id": 49030751, "comment_id": 85067899, "body": "@jreing I didn&#39;t mean that it would fix the problem, you need to check how <i>powershell</i> buffers IO which has to be the problem. But I consider this to be very strange, and wouldn&#39;t expect it. So you need to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that others can, 1. Confirm that the behavrio truly occurs or, 2. Find a mistake in your code and tell you how to fix it. For now, your reported behavior doesn&#39;t make sense in my opinion."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519829269, "post_id": 49030751, "comment_id": 85069128, "body": "Posting some exact keystrokes used as input used and output seen would add clarity.  AFAIK, no output is ever seen including <code>&quot;hello world&quot;</code>"}], "owner": {"reputation": 209, "user_id": 1685224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b1144bd01f8b18705e72a694b561d5d?s=128&d=identicon&r=PG", "display_name": "jreing", "link": "https://stackoverflow.com/users/1685224/jreing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519886418, "creation_date": 1519824578, "last_edit_date": 1519886418, "question_id": 49030751, "link": "https://stackoverflow.com/questions/49030751/running-scanf-or-gets-from-powershell-hangs", "title": "Running scanf or gets from powershell hangs", "body": "<p>We have a code that we wish to port to an environment whose main CLI is PowerShell. It had some problems so I've narrowed the code to the simplest:</p>\n\n<pre><code>#include \"stdafx.h\"\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    int ch =0;\n    printf(\"hello world\");\n    while ((ch = getchar()) != '\\n' &amp;&amp; ch != EOF)\n        printf(\"%c\", ch);\n\n    return 0;\n}\n</code></pre>\n\n<p>This app compiles as a Win32 console app in VS2015 and runs as expected on cygwin, VS debugger, cmd, but when I run it from Powershell it gets into an infinite loop until I press CTRL+C.\nI've searched all around for alternatives, replacement input functions, but basically we want to keep our code multi-platform and in plain C (no .NET functions etc). \nSame issue happens with simple programs that use functions that read from stdin such as scanf, gets.\nHow can we make this simple program run under powershell?</p>\n\n<p>Thanks in advance.</p>\n\n<p><strong>Update</strong>\nI was able to get this app running in the regular Powershell on a PC, I was using Powershell ISE before and it still doesn't work there.</p>\n\n<p>But when using the same app on a remote powershell from a Windows 10 IoT dashboard (my final destination for this project)- The behavior is still not as expected.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 12315, "user_id": 658031, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/711e76c263d03660772b5a5198d33671?s=128&d=identicon&r=PG", "display_name": "Saeid Yazdani", "link": "https://stackoverflow.com/users/658031/saeid-yazdani"}, "edited": false, "score": 2, "creation_date": 1519824639, "post_id": 49030743, "comment_id": 85065833, "body": "it should be <code>do....while</code>...that <code>do</code> you have only happens once and i will never be 9...one solution make <code>int i=0</code> to <code>static int i=0</code>"}, {"owner": {"reputation": 796, "user_id": 3745677, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5743492851bf6397e8b0ed332f793b65?s=128&d=identicon&r=PG&f=1", "display_name": "lolbas", "link": "https://stackoverflow.com/users/3745677/lolbas"}, "edited": false, "score": 2, "creation_date": 1519824653, "post_id": 49030743, "comment_id": 85065845, "body": "Please, properly format your code. It is just unreadable."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1519824736, "post_id": 49030743, "comment_id": 85065895, "body": "@MrAlan Please elaborate what the &quot;direct&quot; and &quot;indirect&quot; functions must do."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1519824762, "post_id": 49030743, "comment_id": 85065911, "body": "This doesn&#39;t compile."}, {"owner": {"reputation": 503, "user_id": 8830528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bc39faaf914ac3f42353f2e37f0311?s=128&d=identicon&r=PG&f=1", "display_name": "rbf", "link": "https://stackoverflow.com/users/8830528/rbf"}, "edited": false, "score": 0, "creation_date": 1519824902, "post_id": 49030743, "comment_id": 85066019, "body": "A recursive functions always need access to external variables. Either passed as a parameter or a global variable (which I would not suggest). Your Print function uses only a local variable"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9423887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QaXxcJxlLIs/AAAAAAAAAAI/AAAAAAAAAG0/WbCi-cMP9JU/photo.jpg?sz=128", "display_name": "MrAlan", "link": "https://stackoverflow.com/users/9423887/mralan"}, "edited": false, "score": 0, "creation_date": 1519825538, "post_id": 49030952, "comment_id": 85066496, "body": "No, I didn&#39;t need it, but I was just testing it, also it works, thank you very much."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "reply_to_user": {"reputation": 21, "user_id": 9423887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QaXxcJxlLIs/AAAAAAAAAAI/AAAAAAAAAG0/WbCi-cMP9JU/photo.jpg?sz=128", "display_name": "MrAlan", "link": "https://stackoverflow.com/users/9423887/mralan"}, "edited": false, "score": 0, "creation_date": 1519825616, "post_id": 49030952, "comment_id": 85066556, "body": "@MrAlan If the answer is satisfactory, you can accept/upvote it. Thanks"}, {"owner": {"reputation": 21, "user_id": 9423887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QaXxcJxlLIs/AAAAAAAAAAI/AAAAAAAAAG0/WbCi-cMP9JU/photo.jpg?sz=128", "display_name": "MrAlan", "link": "https://stackoverflow.com/users/9423887/mralan"}, "edited": false, "score": 1, "creation_date": 1519825748, "post_id": 49030952, "comment_id": 85066660, "body": "oh sorry first time here didn&#39;t know that D: Thanks again!"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1519827331, "post_id": 49030952, "comment_id": 85067713, "body": "@coredump In the original post the function does not have a parameter."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1519827785, "post_id": 49030952, "comment_id": 85068061, "body": "@VladfromMoscow And that&#39;s very bad, it should have a parameter."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1519827849, "post_id": 49030952, "comment_id": 85068110, "body": "@coredump It is not bad. It is interesting how to implement the function without a parameter that is how to implement the original function in the question."}, {"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1519827953, "post_id": 49030952, "comment_id": 85068190, "body": "@VladfromMoscow Yes, and that&#39;s more like a hack in that case. Don&#39;t have anything against hacks, but I&#39;d rather have boring, normal functions which takes parameters when reviewing code."}], "tags": [], "owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "is_accepted": false, "score": 3, "last_activity_date": 1519825669, "last_edit_date": 1519825669, "creation_date": 1519825220, "answer_id": 49030952, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49030952#49030952", "title": "How to end a recursive function?", "body": "<p>Let <code>i</code> be a parameter of the function.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint Print(int);\nint main()\n{\n    Print(9);\n    return 1;\n}\nint Print(int i)\n{\n    if (i &lt;= 0) {\n      return 1;\n    }\n    printf(\"%d\",i);\n    return Print(i-1);\n}\n</code></pre>\n\n<p>The <code>do...while</code> part seems weird, are you sure you need that?</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 4918069, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/163e0d056ea090ac0e9cef61316f0bb4?s=128&d=identicon&r=PG&f=1", "display_name": "H D", "link": "https://stackoverflow.com/users/4918069/h-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1519825536, "creation_date": 1519825536, "answer_id": 49031040, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49031040#49031040", "title": "How to end a recursive function?", "body": "<p><em>i</em> will never be 9 in your case. Hence calling of Print() again and again.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1519907429, "last_edit_date": 1519907429, "creation_date": 1519827274, "answer_id": 49031597, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49031597#49031597", "title": "How to end a recursive function?", "body": "<p>For starters according to the C Standard the function <code>main</code> without parameters shall be declared like</p>\n\n<pre><code>int main( void )\n</code></pre>\n\n<p>As for the recursive function (that shall be declared when it is defined like <code>int Print( void )</code>) then there are several problems.</p>\n\n<p>The first one is that the function returns nothing though it has the return type <code>int</code>.</p>\n\n<pre><code>int Print()\n{\n    // ...\n    Print();\n}\n</code></pre>\n\n<p>Secondly due to the do-while loop </p>\n\n<pre><code>do\n{\n    printf(\"%d\",i);\n    i++;\n}while(i&lt;10);\n</code></pre>\n\n<p>the condition in this statement</p>\n\n<pre><code>if(i==9)\n    return 1;\n</code></pre>\n\n<p>is never true because after the loop the variable <code>i</code> is equal to <code>10</code>. So the function has an indefinite recursion.</p>\n\n<p>And instead of a loop you should use a call to the function itself.</p>\n\n<p>The functions can be defined the following way as it is shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid direct_print( void )\n{\n    enum { N = 10 };\n    static int i = N;\n\n    if ( --i ) \n    {\n        direct_print();\n    }\n    printf( \"%d \", i );\n    ++i;\n}\n\nvoid reverse_print( void )\n{\n    enum { N = 10 };\n    static int i = N;\n\n    printf( \"%d \", --i );\n\n    if ( i ) \n    {\n        reverse_print();\n    }\n    ++i;\n}\n\n\nint main(void) \n{\n    direct_print();\n    putchar( '\\n' );\n    reverse_print();\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9 \n9 8 7 6 5 4 3 2 1 0 \n</code></pre>\n\n<p>Or a more straightfoward approach to define the functions <code>direct_print</code> and <code>reverse_print</code> is the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid direct_print( void )\n{\n    const unsigned int N = 10;\n    static unsigned int i;\n\n    if ( i &lt; N )\n    {\n        printf( \"%u \", i++ );\n        direct_print();\n    }\n    else\n    {\n        i = 0;\n    }\n}\n\nvoid reverse_print( void )\n{\n    const unsigned int N = 10;\n    static unsigned int i;\n\n    if ( i &lt; N )\n    {\n        printf( \"%u \", N - ++i );\n        reverse_print();\n    }\n    else\n    {\n        i = 0;\n    }\n}\n\nint main(void) \n{\n    direct_print();\n    putchar( '\\n' );\n    reverse_print();\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>Take into account that the functions would be more flexible if instead of the magic number <code>10</code> within the bodies of the functions they used a parameter.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid direct_print( unsigned int n )\n{\n    static unsigned int i;\n\n    if ( i == 0 ) i = n;\n\n    if ( n )\n    {\n        printf( \"%u \", i - n );\n        direct_print( n - 1 );\n    }\n\n    if ( i == n ) i = 0;\n}\n\nvoid reverse_print( unsigned int n )\n{\n    if ( n-- )\n    {\n        printf( \"%u \", n );\n        reverse_print( n );\n    }\n}\n\n\nint main(void) \n{\n    direct_print( 10 );\n    putchar( '\\n' );\n    reverse_print( 10 );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>The output is the same as shown for the previous program</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9 \n9 8 7 6 5 4 3 2 1 0 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 0, "last_activity_date": 1519833602, "creation_date": 1519833602, "answer_id": 49033701, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49033701#49033701", "title": "How to end a recursive function?", "body": "<p>Vlad from Moscow did already great writeup on the OP problems.</p>\n\n<p>I would like to add a solution with the stop_condition.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nvoid Print(int i, int stop_condition);\n\nint main(void)\n{\n  Print(0, 10);\n  putchar( '\\n' );\n\n  return 0;\n}\n\nvoid Print(int i, int stop_condition)\n{\n    printf(\"%d \",i++);\n\n    if(i&lt;stop_condition)\n        return Print(i, stop_condition);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 1 2 3 4 5 6 7 8 9 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1519847691, "last_edit_date": 1519847691, "creation_date": 1519844593, "answer_id": 49036772, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49036772#49036772", "title": "How to end a recursive function?", "body": "<p>In your function return condition <code>if(i==9)</code> will never meet, as it is always <code>i=10</code>. So your <code>Print()</code> function being keep calling recursively forever. First of all you need a situation exactly at what condition/situation you need to use a recursive function? In your example you are printing values from 1 to 9 with the help of a <code>while loop</code>. Now how can you achieve the same by using a recursive function?</p>\n\n<pre><code> void Print(int i)\n {\n       if( i == 0 )//when i become 0 you are not printing but returning \n          return;\n       else\n          Print(--i);//decrement the value by one each time you are calling it recursively\n       printf(\"%d\\n\",i);\n}\n</code></pre>\n\n<p>And you are calling it like:-</p>\n\n<pre><code>Print(10); // now it will print from 1 till 10;\n</code></pre>\n\n<p>But how it works? When you first time call this function with parameter 10, in the condition <code>if(i == 0)</code> it will fail as value of <code>i</code> in the first call is 10. In that condition O/S will store all the intermediate data/output (in this case it will store i = 10;) and function's IP(instruction pointer, last execution status that is <code>Print(--i);</code> which was the last executed statement in each  recursive functions) in a stack. And it will call with <code>Print(9);</code> in the first recursive call(Print(--i)). This whole process will continue till <code>Print(0)</code>. But when it call with <code>Print(0)</code> function will return without printing the value as it will return after condition <code>if( i == 0 )</code> because here <code>i</code> became <code>0</code>. From this point it will return to the previous call. How it returns to previous call? Once a recursive function return it <code>pop</code>s the stack and get the <code>IP</code> first and it's intermediate outputs i.e. value of <code>i</code>. In this case when it returns for the first time, <code>i</code>'s current values is <code>1</code>, so in the <code>printf</code> it will print 1. As that is the last line of the function and as per IP that is the remaining instruction to be execute. So it will return normally. Now it will get the IP from the stack where function's variable <code>i</code>'s intermediate value was 2 so it will print <code>2</code> and return and this will continue till it reached in first call where it's value was <code>10</code> and after it print <code>10</code> it will return to main.</p>\n\n<p>Hope this will help you.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9149118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ee9e3294a489aaf51fcad9038714019?s=128&d=identicon&r=PG&f=1", "display_name": "peter huge", "link": "https://stackoverflow.com/users/9149118/peter-huge"}, "is_accepted": false, "score": -1, "last_activity_date": 1519849135, "creation_date": 1519849135, "answer_id": 49037864, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function/49037864#49037864", "title": "How to end a recursive function?", "body": "<p>This is an finite loop using recursion, factorial of 5</p>\n\n<pre><code>              i = 5;\n              fact=1;\n               while(i)\n              {\n                 fact = fact*i;\n                  i- -;\n              }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9423887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QaXxcJxlLIs/AAAAAAAAAAI/AAAAAAAAAG0/WbCi-cMP9JU/photo.jpg?sz=128", "display_name": "MrAlan", "link": "https://stackoverflow.com/users/9423887/mralan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2008, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1519907429, "creation_date": 1519824555, "last_edit_date": 1519825100, "question_id": 49030743, "link": "https://stackoverflow.com/questions/49030743/how-to-end-a-recursive-function", "title": "How to end a recursive function?", "body": "<p>I'm trying to do a simple example of recursion functions (Both Direct and Indirect) and I can't seem to get it to end can you please help me and explain why? (Also I'm trying to do both Direct and Indirect in this program) Thank you for your help.</p>\n\n<pre><code>int Print();\nint main()\n{\n    Print();\n    return 1;\n}\nint Print()\n{\n    int i=0;\n    do\n    {\n        printf(\"%d\",i);\n        i++;\n    }while(i&lt;10);\n    if(i==9)\n        return 1;\n    Print();\n}\n</code></pre>\n\n<p>Edit: The recursion direct and indirect, the direct is supposed to be called from inside the same function and the indirect is supossed to be called from outside the function, also I apologize for not formatting and skipping the while</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 4, "creation_date": 1519824515, "post_id": 49030693, "comment_id": 85065761, "body": "you are already using <code>realloc</code> to dynamically change the buffer size, what exactly is the problem you are facing now?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1519824592, "post_id": 49030693, "comment_id": 85065802, "body": "note that <code>strcat(mem, line);</code> has a quadratic effect: each time you&#39;re calling it, you&#39;re reading the whole <code>mem</code> again to find the end of the string. When the file is big, it takes a lot of time."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519824601, "post_id": 49030693, "comment_id": 85065806, "body": "There are multiple ways of getting the size of the file, and allocate the exact amount needed. As well as the possibility to reallocate as you go along (which you seem to do now already)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519824696, "post_id": 49030693, "comment_id": 85065869, "body": "And what is the <code>is_not_binary</code> function supposed to do? Why are you calling it passing the <i>file name</i>? With a length much longer than the actual file name string?"}, {"owner": {"reputation": 6402, "user_id": 318877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/492a94be6b2d2dab66cd9b616854f7b5?s=128&d=identicon&r=PG", "display_name": "R&#246;rd", "link": "https://stackoverflow.com/users/318877/r%c3%b6rd"}, "edited": false, "score": 1, "creation_date": 1519825202, "post_id": 49030693, "comment_id": 85066242, "body": "You might consider using <code>read</code> or <code>fread</code> instead of <code>fgets</code> so you can read a fixed number of bytes each iteration. (This approach would also work with binary files, but that&#39;s no reason not to use it with text files. The functions specific for text files allow you to read a file line by line, but if that is not required, there&#39;s no harm in using the binary file functions.)"}], "answers": [{"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1519851723, "post_id": 49031399, "comment_id": 85082158, "body": "you have potential problems by not checking return of your <code>[c][re]alloc()</code> functions."}], "tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": false, "score": 1, "last_activity_date": 1519827336, "last_edit_date": 1519827336, "creation_date": 1519826678, "answer_id": 49031399, "question_id": 49030693, "link": "https://stackoverflow.com/questions/49030693/copying-a-file-into-char-array-dynamically/49031399#49031399", "title": "Copying a file into char array dynamically", "body": "<p>I coded up an example that makes use of fopen, fread, and the classic example doubling the buffer size as the content grows.</p>\n\n<pre><code>int main()\n{\n\n    const size_t initial_size = 1024;\n    char* contents = (char*)malloc(initial_size);\n    size_t length = 0;\n    size_t allocated = initial_size;\n\n    FILE* file = fopen(\"./sbatch_example.sh\", \"r\");\n    if (file)\n    {\n        while (1)\n        {\n            size_t remaining = allocated - length;\n            size_t result = 0;\n\n            if (remaining == 0)\n            {\n                contents = (char*)realloc(contents, allocated*2);\n                allocated = allocated*2;\n                remaining = allocated-length;\n            }\n\n            result = fread(contents+length, 1, remaining, file);\n            length += result;\n\n            if (result==0) /* EOF */\n            {\n                break;\n            }\n        }\n    }\n\n    if (file)\n    {\n        fclose(file);\n        file = NULL;\n    }\n\n    /* at this point, \"contents\" is your file data bytes\n       and \"length\" is the number of bytes copied into that array*/\n\n    /*optional: append a null char to the end of the buffer to make  it easier for debugging and print statements */\n    contents = (char*)realloc(contents, length+1);\n    contents[length] = '\\0';\n\n\n    free(contents);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1519833011, "post_id": 49031895, "comment_id": 85071657, "body": "Having allocated space for a null byte, don&#39;t forget to set it.  In theory, it would be a good idea to check that <code>nr</code> is equal to <code>1</code>, indicating that the file was not truncated between the <code>ftell()</code> and the <code>fread()</code>.  Or you could reverse the paremeters <code>fread(mem, 1, size, fp)</code> and check that the value in <code>nr</code> is <code>size</code>, but you&#39;ll know how many bytes were read even if the file was truncated.  You&#39;ll never know about a file that grew while you were accessing it (but that&#39;s normal \u2014 very few programs deal with that possibility)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519840219, "post_id": 49031895, "comment_id": 85076259, "body": "The return value from <code>ftell()</code> on a <i>text</i> file does not necessarily represent the number of character that will be read.  <code>size</code> can easily be more than <code>nr</code>."}, {"owner": {"reputation": 134, "user_id": 9413399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dbe87e2ba97927b690eef4c04ff0c9?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/9413399/kay"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519842140, "post_id": 49031895, "comment_id": 85077189, "body": "@chux, that&#39;s right. I missed. I revised my answer to add &quot;rewind&quot; before &quot;fread&quot;. Thanks for the notice."}], "tags": [], "owner": {"reputation": 134, "user_id": 9413399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70dbe87e2ba97927b690eef4c04ff0c9?s=128&d=identicon&r=PG&f=1", "display_name": "Kay", "link": "https://stackoverflow.com/users/9413399/kay"}, "is_accepted": false, "score": 1, "last_activity_date": 1519842041, "last_edit_date": 1519842041, "creation_date": 1519828113, "answer_id": 49031895, "question_id": 49030693, "link": "https://stackoverflow.com/questions/49030693/copying-a-file-into-char-array-dynamically/49031895#49031895", "title": "Copying a file into char array dynamically", "body": "<p>You can use ftell() to get the total length in advance and fread() to read a whole at one time as below.</p>\n\n<pre><code>FILE *fp = fopen(\"./sbatch_example.sh\", \"r\"); \nif (fp) {\n  fseek(fp, 0, SEEK_END);\n  size_t size = ftell(fp);\n  rewind(fp);\n  char *mem = malloc(size+1);\n  size_t nr = fread(mem, size, 1, fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 9299601, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5373926bae00b67f721c3fba623c662f?s=128&d=identicon&r=PG&f=1", "display_name": "ilapasle", "link": "https://stackoverflow.com/users/9299601/ilapasle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519842041, "creation_date": 1519824364, "last_edit_date": 1519827994, "question_id": 49030693, "link": "https://stackoverflow.com/questions/49030693/copying-a-file-into-char-array-dynamically", "title": "Copying a file into char array dynamically", "body": "<p>I have code for copying a text file (not binary) into an array of chars.</p>\n\n<p>I am trying to copy the contents of a <code>.txt</code> file into a <code>char*</code> array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool is_not_binary(const void *data, size_t len)\n{\n    return memchr(data, '\\0', len) != NULL;\n}\n\nint main(void)\n{\n    char* file_name=\"./bash_example.sh\";\n    FILE *file = fopen (file_name, \"r\");\n\n    size_t size = 64;\n    const size_t line_size = 300;\n    char *mem = malloc(size);\n\n    if (mem == NULL) {\n            perror(\"malloc\");\n            exit(EXIT_FAILURE);\n    }\n    *mem = 0;        \n\n    if (file != NULL &amp;&amp; is_not_binary(file_name,line_size)) {\n\n        char* line = malloc(line_size);\n\n        while (fgets(line, line_size, file) != NULL)  {\n\n            size_t total = strlen(mem) + strlen(line) + 1;\n            if (size &lt; total) {\n                    size_t newsize = (total &amp; ~1U) &lt;&lt; 1;\n                    char *tmp = realloc(mem, newsize);\n                    if (tmp == NULL) {\n                            perror(\"realloc\");\n                            exit(EXIT_FAILURE);\n                    }\n\n                    mem = tmp;\n                    size = newsize;\n            }\n            strcat(mem, line);\n\n        }\n    }\n\n    printf(\"%s\",mem);\n\n    return 0;\n}\n</code></pre>\n\n<p>But in my code I must specify a static size:</p>\n\n<pre><code>size_t size = 64;\nconst size_t line_size = 300;\n</code></pre>\n\n<p>I want to remove this and I want dynamic allocation, is it possible?\nActually it's static code, 64 and 300.</p>\n"}, {"tags": ["c", "debugging", "arm", "real-time", "uart"], "comments": [{"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 1, "creation_date": 1519860568, "post_id": 49030454, "comment_id": 85086037, "body": "Clarify what you mean by <i>&quot;too slow&quot;</i> and <i>&quot;amount of data&quot;</i>.  RS-232 is going to be the simplest interface, so be sure it won&#39;t meet requirements before you abandon it."}, {"owner": {"reputation": 129, "user_id": 2770342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d10427294d47ccfcc126e0ebfbbcc22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Non", "link": "https://stackoverflow.com/users/2770342/ben-non"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1519897001, "post_id": 49030454, "comment_id": 85097740, "body": "Sadly the uart controller on the board doesn&#39;t allow anything faster than 921600 baud. I also need to share the uart with other debug data so I&#39;m using a lot less than 921kbaud."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2770342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d10427294d47ccfcc126e0ebfbbcc22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Non", "link": "https://stackoverflow.com/users/2770342/ben-non"}, "edited": false, "score": 0, "creation_date": 1519897063, "post_id": 49033564, "comment_id": 85097785, "body": "Trying to get the ETM tracing working, it only shows 3 of the 4 cores for some reason. Working on it, thanks for your input."}, {"owner": {"reputation": 1469, "user_id": 2105592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0660c06174e5479ed2c6dcda818d0f?s=128&d=identicon&r=PG", "display_name": "Sean Houlihane", "link": "https://stackoverflow.com/users/2105592/sean-houlihane"}, "reply_to_user": {"reputation": 129, "user_id": 2770342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d10427294d47ccfcc126e0ebfbbcc22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Non", "link": "https://stackoverflow.com/users/2770342/ben-non"}, "edited": false, "score": 0, "creation_date": 1519897485, "post_id": 49033564, "comment_id": 85098067, "body": "There may be one etm shared between cores. Numproc should this in an etm."}], "tags": [], "owner": {"reputation": 1469, "user_id": 2105592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0660c06174e5479ed2c6dcda818d0f?s=128&d=identicon&r=PG", "display_name": "Sean Houlihane", "link": "https://stackoverflow.com/users/2105592/sean-houlihane"}, "is_accepted": false, "score": 1, "last_activity_date": 1519901713, "last_edit_date": 1519901713, "creation_date": 1519833211, "answer_id": 49033564, "question_id": 49030454, "link": "https://stackoverflow.com/questions/49030454/output-user-data-fast-on-cortex-r5/49033564#49033564", "title": "Output user data fast on Cortex R5", "body": "<p>The DCC is probably going to be slow, and maybe intrusive to use. You're limited to using JTAG to access this.</p>\n\n<p>The ETM ought to be able to trace this information, and you should be able to configure the filtering to trace just the accesses to a specific memory address. Its a very  long time since I looked in detail at the ETMv3 data trace, so I'm not sure if you need to trace the associated instruction or not. The debug tools also tend to be more focused on tracing instructions with data being an additional decoration rather than presenting a raw datastream, so processing the data might be non-trivial.</p>\n\n<p>The ETM should provide several bits of data throughput per cycle, so as long as the data is in small bursts there should be enough bandwidth. Obviously this is package dependant, but small numbers of Gbps are achievable (with a substantial protocol cost depending on what information you're trying to push through the trace stream).</p>\n\n<p>In some chips, an ETM can be shared between several processors (of the same type). ETCSCR[14:14] will be non-zero if this is the case, and then you're limited to selecting one core and tracing that (until the ETM is disabled/re-programmed).</p>\n"}], "owner": {"reputation": 129, "user_id": 2770342, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7d10427294d47ccfcc126e0ebfbbcc22?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Non", "link": "https://stackoverflow.com/users/2770342/ben-non"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519982216, "creation_date": 1519823595, "last_edit_date": 1519982216, "question_id": 49030454, "link": "https://stackoverflow.com/questions/49030454/output-user-data-fast-on-cortex-r5", "title": "Output user data fast on Cortex R5", "body": "<p>I'm trying to output some user data, character series, on a Cortex R5 to a PC.\nProblem is that the uart is too slow for the amount of data and I'm looking for something faster. I hoped ITM could be used but sadly that's only available for Cortex M-series. The data contains status info about processes which I'd like to visualise for a better insight.</p>\n\n<p>The Uart was running at the maximum of 921600 baud thus I'm looking for something faster than that. I'm looking for 2-5 Mbit.</p>\n\n<p>I found information of DCC (debug communication channel) and ETM but I can't really figure out their speeds and how I could use them with user data instead of tracing data.</p>\n\n<p>I have acces to tracers and debuggers (Green Hills SuperTrace and Realview ICE) so requiring those is no problem. I just can't figure out how to read the data. Perhaps I missed the obvious?</p>\n\n<p>Edit: For now it looks like the easiest way is to bypass the CP2105 which limits my uart to 921600. I'll connect the RX/TX pins from the SoC to a RPi which should be able to get much higher bauds. Ofcourse, I'll also need a logic level shifter since the SoC is only 2.5V tolerant (74LVC245). If this setup works I'll answer my question. Thanks for the input!</p>\n"}, {"tags": ["c", "multidimensional-array", "row-major-order", "column-major-order"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519839567, "post_id": 49030245, "comment_id": 85075922, "body": "&quot;How would you know if 3 is the number of columns or 4?&quot; is not important to answer to  &quot;Find the address of Array[1][2] in the array Array[3][4]&quot;.  The answer is independent of which dimension is called &quot;column&quot;.  Or are you asking something else?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9360176, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962956020400610/picture?type=large", "display_name": "Zextro", "link": "https://stackoverflow.com/users/9360176/zextro"}, "edited": false, "score": 0, "creation_date": 1519823705, "post_id": 49030300, "comment_id": 85065198, "body": "yes but what about a written question in which you are supposed to calculate the address of the matrix. If the question states to calculate it with the Column major Order formula, does the column number for array[3][4] be 3 or 4? because if it were a Row major order, it would definitely be 4."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 27, "user_id": 9360176, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962956020400610/picture?type=large", "display_name": "Zextro", "link": "https://stackoverflow.com/users/9360176/zextro"}, "edited": false, "score": 0, "creation_date": 1519825808, "post_id": 49030300, "comment_id": 85066699, "body": "@Zextro That depends? which one you want it to be? And that&#39;s the whole point of my answer. The interpretation is yours, and there is nothing predefined in this."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 0, "last_activity_date": 1519823095, "creation_date": 1519823095, "answer_id": 49030300, "question_id": 49030245, "link": "https://stackoverflow.com/questions/49030245/representation-of-column-major-order-vs-row-major-order/49030300#49030300", "title": "Representation of Column major order vs Row major order", "body": "<p>You can't know. There is no relation between how the computer represents the data and how you interpret it. Since you are \"<em>free</em>\" to interpret it the way you like, then it's your responsability to know which index is for rows and which one for columns.</p>\n\n<p>Usually you can, write the specification in comments in the code itself or write documentation for functions using the structure. Also, you could write functions to access the array that enforce the order of indexes. But then, it's still not immediately unambiguous but has the benefit that you can check for out of bound access.</p>\n"}], "owner": {"reputation": 27, "user_id": 9360176, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962956020400610/picture?type=large", "display_name": "Zextro", "link": "https://stackoverflow.com/users/9360176/zextro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "accepted_answer_id": 49030300, "answer_count": 1, "score": -2, "last_activity_date": 1519823095, "creation_date": 1519822898, "question_id": 49030245, "link": "https://stackoverflow.com/questions/49030245/representation-of-column-major-order-vs-row-major-order", "title": "Representation of Column major order vs Row major order", "body": "<p>Consider a 2D array \"Array\" that contains values : {1,2,3,4,5,6,7,8,9}. My major issue with the understanding of both orders is that if Row Major Order is to be represented as Array[i,j] (while i is row and j is column),</p>\n\n<pre><code>    [i0,j0][i0,j1][i0,j2]\n    [i1,j0][i1,j1][i1,j2]\n    [i2,j0][i2,j1][i2,j2]\n</code></pre>\n\n<p>So that if you are asked with a question such as \"find the address of element Array[1,2] in Array[2][2]\", you'd know that the number of rows come before the number of columns and it would be easy to put them in the formula: </p>\n\n<pre><code>    Base(Address) + w(dataSize){N(i - Row_lowerBound)+(j - Col_lowerBound)}\n    While 'N' is the number of columns\n</code></pre>\n\n<p>does it mean that the column order can be represented as Array[j,i] which would mean that the Column number appears earlier than the row number. So there is no way of knowing where the i,j,Row_lowerbound and Col_lowerbound values of Array[j][i] (e.g Array[3][4]) are to be put in the formula.</p>\n\n<p>for e.g if the question appears as: \"Find the address of Array[1][2] in the array Array[3][4]\" How would you know if 3 is the number of colmns or 4? How would you know whether the 'i' is 3 or 4?</p>\n"}, {"tags": ["c", "hex", "scanf"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519822371, "post_id": 49029977, "comment_id": 85064304, "body": "Use <code>fgets()</code> to read a <i>line</i> of user input, then parse it for with <code>strtol()</code> or <code>sscanf(  ,&quot;%x %n&quot;, )</code> for &quot;hex bytes&quot;."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1519822379, "post_id": 49029977, "comment_id": 85064310, "body": "You need to open the file with <code>&quot;wb&quot;</code> and be careful, you don&#39;t magically replace the bytes. Probably you have to copy the file to another file and rename it."}, {"owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "edited": false, "score": 0, "creation_date": 1519822442, "post_id": 49029977, "comment_id": 85064359, "body": "I know I need to open the file properly, but I am actually using r+, is it bad? Also, The problem is that the user input isn&#39;t treated as HEX but as plain text."}, {"owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519822471, "post_id": 49029977, "comment_id": 85064377, "body": "@chux mind giving a small example? I am quite new to this."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1519822668, "post_id": 49029977, "comment_id": 85064488, "body": "You are reading as text with %s. You need to convert that to binary."}, {"owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "edited": false, "score": 0, "creation_date": 1519822782, "post_id": 49029977, "comment_id": 85064580, "body": "I know, I tried %x but it won&#39;t do. And fgets needs a length to be specified, which I don&#39;t know. The user may input 4F FF 90 or even FF FF 90 90 90 etc. I have variable input size"}], "answers": [{"comments": [{"owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "edited": false, "score": 0, "creation_date": 1519823940, "post_id": 49030326, "comment_id": 85065371, "body": "This gives out: error: array initializer must be an initializer list or string literal for the unsigned char hexes[(sizeof buf)/2] = 0; and error: use of undeclared identifier &#39;end&#39; for the &quot;while (sscanf(p, &quot;%x %n&quot;, &amp;byte, &amp;end) == 1)&quot;"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1519824875, "last_edit_date": 1519824875, "creation_date": 1519823200, "answer_id": 49030326, "question_id": 49029977, "link": "https://stackoverflow.com/questions/49029977/use-scanf-to-take-hex-instructions-input-from-the-user-and-save-them-in-char-c/49030326#49030326", "title": "Use scanf to take hex instructions input from the user and save them in char. (C)", "body": "<p>General idea below.</p>\n\n<p>Do not use <code>scanf()</code>,  Use <code>fgets()</code> for reading a <em>line</em> of user input.</p>\n\n<p>Error checking omitted (noted with // **)</p>\n\n<pre><code> char buf[100];   // Use some reasonable upper bound of expected user input.\n\n puts(\"prompt for input\");\n fgets(buf, sizeof buf, stdin);     // **\n offset_ed = strtol(buf, NULL, 10); // **\n fseek(f, offset_ed, SEEK_SET);     // **\n\n puts(\"prompt for input\");\n fgets(buf, sizeof buf, stdin);  // **\n size_t byte_count = 0;\n unsigned char hexes[(sizeof buf)/2] = 0;  // place to save the \"hex bytes\"\n int n = 0;\n unsigned byte; \n</code></pre>\n\n<p>Now parse the string looking for hex input.</p>\n\n<pre><code> // Use \"%n\" to save the offset of the scan to later update `p`\n // Robust code would use `strtol()` for its better error handling\n char *p = buf;\n while (sscanf(p, \"%x %n\", &amp;byte, &amp;n) == 1) {\n   if (byte &gt; 0xFF) Handle_OutOfRange();\n   hexes[byte_count] = byte;\n   p += n;  \n }  \n\n if (byte_count == 0) Handle_EmptyUserInput();\n if (*p) Handle_ExtraJunkInUserInput();\n fwrite (hexes , byte_count, sizeof hexes[0], f); // **\n</code></pre>\n\n<hr>\n\n<p>OP had <code>scanf(\"%s\\n\",...</code>.  The <code>\"\\n\"</code> is a problem. <code>scanf()</code> will block until  the user entered some non-white-space after the expected input.  Avoid that.</p>\n\n<p>The problem <em>can</em> be handled with <code>scanf()</code>, yet it is ugly.  Effectively, code needs to look for the <code>'\\n'</code> somewhere after multiple \"hex\" bytes using <code>scanf(\"%*1[^\\n]\")</code> or the like.  <code>scanf()</code> is not the best tool for the overall coding goal here.  <code>scanf()</code> is rarely the sharpest tool in the shed.</p>\n"}, {"comments": [{"owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "edited": false, "score": 0, "creation_date": 1519823593, "post_id": 49030419, "comment_id": 85065127, "body": "Mind giving an example?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519827710, "post_id": 49030419, "comment_id": 85067997, "body": "<code>isupper()</code> and <code>toupper()</code> are both standard C library functions.   Better to use a different name here to avoid that conflict and code-misunderstanding."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519827834, "post_id": 49030419, "comment_id": 85068094, "body": "Using <code>#define ishexchar(c) ((c)&gt;=&#39;A&#39; &amp;&amp; (c)&lt;=&#39;F&#39;) || ((c)&gt;=&#39;a&#39; &amp;&amp; (c)&lt;=&#39;f&#39;)</code> would be more clear.  It works in ASCII and even <a href=\"https://en.wikipedia.org/wiki/EBCDIC\" rel=\"nofollow noreferrer\">EBCDIC</a>"}, {"owner": {"reputation": 306, "user_id": 3600107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f2b49005578a8f6ff85c1db0a7dcc03?s=128&d=identicon&r=PG&f=1", "display_name": "user3600107", "link": "https://stackoverflow.com/users/3600107/user3600107"}, "edited": false, "score": 0, "creation_date": 1519828129, "post_id": 49030419, "comment_id": 85068314, "body": "Thanks. I&#39;ll fix it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519917924, "post_id": 49030419, "comment_id": 85110506, "body": "Concerning   <code>#define toupper(c) c - 32</code>, better to add <code>()</code> to insure desire evaluation - <code>#define toupper(c) ((c) - 32)</code>.  Of course, makes no difference with OP&#39;s code, yet is good practice."}], "tags": [], "owner": {"reputation": 306, "user_id": 3600107, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9f2b49005578a8f6ff85c1db0a7dcc03?s=128&d=identicon&r=PG&f=1", "display_name": "user3600107", "link": "https://stackoverflow.com/users/3600107/user3600107"}, "is_accepted": true, "score": 2, "last_activity_date": 1519828174, "last_edit_date": 1519828174, "creation_date": 1519823479, "answer_id": 49030419, "question_id": 49029977, "link": "https://stackoverflow.com/questions/49029977/use-scanf-to-take-hex-instructions-input-from-the-user-and-save-them-in-char-c/49030419#49030419", "title": "Use scanf to take hex instructions input from the user and save them in char. (C)", "body": "<p>You have got the hexes as a string so you need to convert each of them to unsigned chars(a byte) before you can write them to a file.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#define ishexchar(c) (c&gt;='A' &amp;&amp; c&lt;='F') || (c&gt;='a' &amp;&amp; c&lt;='f')\n#define toupper(c) c - 32\n#define isupper(c) c&gt;='A' &amp;&amp; c&lt;='F'\n\nunsigned char hexconv(const char* str, int size){\n    unsigned char ret = 0;\n    for(int i=0; i&lt;size; i++){\n        if(ishexchar(str[i])){\n            char c = (isupper(str[i])) ? str[i] : toupper(str[i]);\n            ret = (ret*16) + (c - 'A') + 10;\n        }else{\n            ret = (ret*16) + (str[i] - '0');\n        }\n    }\n    return ret;\n}\n\nint main(){\n    printf(\"%x\\n\",hexconv(\"4b\", 2));\n}\n</code></pre>\n\n<p>The code above might need some modification for your needs but it compiles and works.</p>\n"}], "owner": {"reputation": 202, "user_id": 3143873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/302a42b959d1d3de611c1f420b98a43f?s=128&d=identicon&r=PG&f=1", "display_name": "RockSolid", "link": "https://stackoverflow.com/users/3143873/rocksolid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 1, "accepted_answer_id": 49030419, "answer_count": 2, "score": 1, "last_activity_date": 1519828174, "creation_date": 1519822108, "question_id": 49029977, "link": "https://stackoverflow.com/questions/49029977/use-scanf-to-take-hex-instructions-input-from-the-user-and-save-them-in-char-c", "title": "Use scanf to take hex instructions input from the user and save them in char. (C)", "body": "<p>So, I am building a program that should modify a specific number of bytes in a binary. You first input the binary, then the offset from which point you want the hex instructions to be replaced and then the bytes themselves.</p>\n\n<p>Example:\nI load example.exe\nI specify offset <code>0</code> (beginning of the file)\nI specify hex instructions: <code>4D FF 33 FD FE</code>\nThe first 5 instructions of the file should be replaced with the ones I provided. I use <code>fwrite</code> to do the modifications and <code>scanf</code> to get the offset and the hex instructions, however, I can't find a way to actually store them as hex. The fwrite actually writes <code>4D FF 33 FD FE</code> as text inside the binary file instead of hex. I assume I save them wrong in the <code>char</code> in the first place. I am new to C, so what I found online didn't really help.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>      scanf(\"%ld\",&amp;offset_ed);//get the offset from the user.\n      fseek(f, offset_ed, SEEK_SET);\n      printf(\"Specify HEX bytes to be written to the binary:  \");\n      scanf(\"%s\\n\", &amp;hexes);\n      fwrite (hexes , sizeof(char), sizeof(hexes), f);\n      fclose (f);\n</code></pre>\n\n<p>Where hexes is a char hexes;</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1519822211, "post_id": 49029956, "comment_id": 85064196, "body": "That&#39;s not how the preprocessor works. The DLL is compiled by the C compiler, where <code>__cplusplus</code> is <i>not</i> defined. That your application using the DLL is made from C++ is totally irrelevant to and disconnected from the DLL and the sources used to create it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519823775, "post_id": 49029956, "comment_id": 85065247, "body": "I am also curious about the <i>real</i> problem behind a solution like this? What leads you to ask this question? What is the problem, that makes you <i>think</i> you need to handle C and C++ differently?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "edited": false, "score": 0, "creation_date": 1519822927, "post_id": 49030101, "comment_id": 85064688, "body": "is there any way to check at  run time.. as i have a dll file which contains c functions and prototypes (ex. fopen, printf) they doesnt work while i call these from cpp at run time"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "edited": false, "score": 1, "creation_date": 1519823317, "post_id": 49030101, "comment_id": 85064950, "body": "@SaiKrishna No, there no way of knowing at run-time. The application and the DLL are totally separated from each other. It&#39;s better to think of the DLL as a separate program, when it comes to things like these. And the application could be written is just about any language, besides C or C++, making your assumption and wanted behavior flawed."}, {"owner": {"reputation": 787, "user_id": 6715227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NB84a.png?s=128&g=1", "display_name": "stetoc", "link": "https://stackoverflow.com/users/6715227/stetoc"}, "edited": false, "score": 0, "creation_date": 1519823345, "post_id": 49030101, "comment_id": 85064966, "body": "best shot would be to make different dlls for c and c++, and give them different names, and e.g. load library_c.dll in C app and library_cpp.dll in C++ app, to have both C and C++ functions included in DLL you need to link it to C and C++ runtimes, other thing I can think of you can make some kind of singleton for your library and get your functions from there, like: in c++: Library_CPP lib = GetCppLibrary();, and in c: Library lib = GetCLibrary();, they would only differ in name and implementation of algorithms, but would serve same end purpose, and you could pick if you want C or CPP func"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "edited": false, "score": 0, "creation_date": 1519823678, "post_id": 49030101, "comment_id": 85065183, "body": "@SaiKrishna A DLL does not (at least normally) contain standard library functions, such as <code>fopen</code> and <code>printf</code>. What <i>exactly</i> are you trying to do, and how? (Post a new question, and please be more specific than &quot;doesn&#39;t work&quot;.)"}, {"owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1519824816, "post_id": 49030101, "comment_id": 85065958, "body": "@molbdnilo Basically i have a very big .c file which reads the data from text file and process the data and write to another text file. Now to run tests on .c file i have third party application which accepts only .cpp file, instead of converting the entire .c file to .cpp i am creating a dll from .c and calling it from .cpp."}], "tags": [], "owner": {"reputation": 787, "user_id": 6715227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NB84a.png?s=128&g=1", "display_name": "stetoc", "link": "https://stackoverflow.com/users/6715227/stetoc"}, "is_accepted": true, "score": 1, "last_activity_date": 1519822464, "creation_date": 1519822464, "answer_id": 49030101, "question_id": 49029956, "link": "https://stackoverflow.com/questions/49029956/expected-behaviour-of-function-in-dll-file-written-in-c-and-calling-from-cpp-fil/49030101#49030101", "title": "expected behaviour of function in dll file written in c and calling from cpp file", "body": "<p>It doesn't work, because those defines are checked at compile time, you compiled it as C code, so compiler detected you're not using C++ so </p>\n\n<pre><code>#ifndef cplusplus\n</code></pre>\n\n<p>fired, non matching preprocesor directives are 'invisible' for compiler at compile time, just like you removed them manually from code, they don't work like runtime if</p>\n"}], "owner": {"reputation": 5, "user_id": 3999184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5544f430222eab0fb025b6401487c8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Krishna", "link": "https://stackoverflow.com/users/3999184/sai-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49030101, "answer_count": 1, "score": 0, "last_activity_date": 1519822464, "creation_date": 1519822057, "question_id": 49029956, "link": "https://stackoverflow.com/questions/49029956/expected-behaviour-of-function-in-dll-file-written-in-c-and-calling-from-cpp-fil", "title": "expected behaviour of function in dll file written in c and calling from cpp file", "body": "<p>I have written a  dll file in c and calling it from cpp but  i am not getting the expected behaviour please explain me how it works<br>\nmy dll files (.c and .h)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#if defined (WIN32)\n#if defined(FUNCTIONS_STATIC)\n#define FUNCTIONS_API\n#else\n#if defined(FUNCTIONS_EXPORTS)\n#define FUNCTIONS_API __declspec(dllexport)\n#else\n#define FUNCTIONS_API __declspec(dllimport)\n#endif\n#endif\n#else\n#define FUNCTIONS_API\n#endif\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n#ifdef MYMATHDLL_EXPORTS\n#define MYMATHDLL_API __declspec(dllexport) \n#else\n#define MYMATHDLL_API __declspec(dllimport) \n#endif\n#include &lt;conio.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;malloc.h&gt;\n#include &lt;math.h&gt;\n\n#define PI 3.1415\nMYMATHDLL_API double PowerOf3(double UserNumber);\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p><strong>.c</strong> </p>\n\n<pre><code>#ifdef __cplusplus\ndouble PowerOf3(double UserNumber)\n{\n    return UserNumber * UserNumber;\n}\n#endif\n#ifndef __cplusplus\n    double PowerOf3(double UserNumber)\n    {\n        return UserNumber ;\n    }\n\n#endif\n</code></pre>\n\n<p>i compiled above function as dll and using it in the cpp file</p>\n\n<p><strong>.cpp file</strong></p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;fstream&gt;    \n#include &lt;cmath&gt;\n#include &lt;windows.h&gt; \n#include &lt;stdio.h&gt;\n#include &lt;fstream&gt;\n#include \"modell.h\"\n#include \"modellfunktionen.h\"\n#ifdef __cplusplus\nextern \"C\"\n{\n#include \"MyMathDll.h\"\n}\n#endif   \nusing namespace std;\ntypedef double(*MYFUN2)( double op);\nint main(int argc, char** argv) {\n   widepath =\"C:\\\\Personal\\\\VB_practice\\\\MyMathDll\\\\x64\\\\Debug\\\\MyMathDll.dll\";\n    hMod = LoadLibraryA(widepath);\n    //cout &lt;&lt; widepath &lt;&lt; endl;\n    MYFUN2  pfun2 = (MYFUN2)GetProcAddress(hMod, \"PowerOf3\");\n    cout &lt;&lt; pfun2(10) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>gives me result 10 but i expect it 100 as cplusplus is defined. Where am i getting it wrong.</p>\n"}, {"tags": ["c", "embedded", "printf", "stm32", "uart"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1519821586, "post_id": 49029591, "comment_id": 85063801, "body": "Where is the UART setup etc? Have you verified that the UART works at all? Nobody can reproduce the problem with this little info."}, {"owner": {"reputation": 6079, "user_id": 34989, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f16eae47ba215ccc1fe3f05f1750adc?s=128&d=identicon&r=PG", "display_name": "Gerhard", "link": "https://stackoverflow.com/users/34989/gerhard"}, "edited": false, "score": 1, "creation_date": 1519825793, "post_id": 49029591, "comment_id": 85066689, "body": "Where is output.csv located?"}, {"owner": {"reputation": 476, "user_id": 5542689, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3debd7e91e7b5137c920dedd308b3447?s=128&d=identicon&r=PG&f=1", "display_name": "K. Koovalsky", "link": "https://stackoverflow.com/users/5542689/k-koovalsky"}, "edited": false, "score": 1, "creation_date": 1519829561, "post_id": 49029591, "comment_id": 85069336, "body": "Have You attached any filesystem?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1519860449, "post_id": 49029591, "comment_id": 85086004, "body": "What toolchain, are you using the STM32CubeMX tool?  You nave no filesystem support in your library retargetting code."}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1519860294, "creation_date": 1519860294, "answer_id": 49040318, "question_id": 49029591, "link": "https://stackoverflow.com/questions/49029591/print-data-into-file-using-stm32-nucleo/49040318#49040318", "title": "Print data into file using STM32 Nucleo", "body": "<p>Your <code>_write()</code> inplementation clearly supports only <code>stdout</code> and <code>stderr</code> streams and they are hard-linked (not redirectable) to the UART2.</p>\n\n<p>You need a filesystem, media, and appropriate device driver for that media, then you need to implement <code>_write()</code> to support file-descriptors other then <code>STDOUT_FILENO</code>(1) and <code>STDOUT_FILENO</code>(2) which refer to files.</p>\n"}], "owner": {"reputation": 13, "user_id": 7486927, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2wTpQo3vMyY/AAAAAAAAAAI/AAAAAAAAAEM/lCOMvHouohU/photo.jpg?sz=128", "display_name": "Weid Uncia", "link": "https://stackoverflow.com/users/7486927/weid-uncia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519860294, "creation_date": 1519820791, "last_edit_date": 1519821619, "question_id": 49029591, "link": "https://stackoverflow.com/questions/49029591/print-data-into-file-using-stm32-nucleo", "title": "Print data into file using STM32 Nucleo", "body": "<p>I'm sampling data from a pressure sensor using STM32F401RE. Using this function I can use the printf() to print data on terminal using \"Tera Term\".</p>\n\n<pre><code>int _write(int file, char *data, int len) {\n    int bytes_written;\n    if ((file != STDOUT_FILENO) &amp;&amp; (file != STDERR_FILENO)) {\n        errno = EBADF;\n        return -1;\n    }\n    HAL_UART_Transmit(&amp;huart2, (uint8_t*)data, len, 0xFFFFFFFFU);\n    return bytes_written;\n}\n</code></pre>\n\n<p>I tried to use this code, but it isn't working.</p>\n\n<pre><code>outfile = fopen(\"output.csv\", \"a\");\ndata = Read_Pressure();\nprintf(\"%d,%d\\r\\n\", time, data);\nfprintf(outfile, \"%d,%d\\r\\n\", time, data);\ntime++;\nfclose(outfile);\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519820618, "post_id": 49029479, "comment_id": 85063151, "body": "You do it by not using <code>fscanf</code> for the second part? Perhaps <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> is what you want?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519820712, "post_id": 49029479, "comment_id": 85063222, "body": "Also note that the <code>&quot;t&quot;</code> flag in your <code>fopen</code> call is a Windows Visual C extension. It&#39;s not part of standard C. So your code is not portable, and is not plain standard C."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9423645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bon Bobita", "link": "https://stackoverflow.com/users/9423645/bon-bobita"}, "edited": false, "score": 0, "creation_date": 1519820891, "post_id": 49029569, "comment_id": 85063359, "body": "But If the name is Penny Marie Sara ? There &#238;s three words... I think it is more complex. I tried already this."}, {"owner": {"reputation": 1043, "user_id": 9203185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8709b2b7524a21ab54a027392638f998?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy M.", "link": "https://stackoverflow.com/users/9203185/jeremy-m"}, "reply_to_user": {"reputation": 33, "user_id": 9423645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bon Bobita", "link": "https://stackoverflow.com/users/9423645/bon-bobita"}, "edited": false, "score": 0, "creation_date": 1519824811, "post_id": 49029569, "comment_id": 85065952, "body": "Then you just need to format your <code>file.txt</code> differently."}], "tags": [], "owner": {"reputation": 1043, "user_id": 9203185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8709b2b7524a21ab54a027392638f998?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy M.", "link": "https://stackoverflow.com/users/9203185/jeremy-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1519820741, "creation_date": 1519820741, "answer_id": 49029569, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file/49029569#49029569", "title": "Two words in a string from text file", "body": "<p>You shall use <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">fgets</a>.</p>\n\n<p><strong>Or</strong> you can try to do this :</p>\n\n<pre><code>fscanf(fp,\"%s %s %s\", s0, s, s1);\n{\n    printf(\"%s\\n\",s);\n    printf(\"%s\",s1);\n}\n</code></pre>\n\n<p>and declare s0 as a void*</p>\n"}, {"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519820908, "post_id": 49029575, "comment_id": 85063366, "body": "And what if there&#39;s only one part of the name (like <code>&quot;Maria&quot;</code>)? Or three (like <code>&quot;Maria Sarah Jane&quot;</code>)?"}, {"owner": {"reputation": 33, "user_id": 9423645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bon Bobita", "link": "https://stackoverflow.com/users/9423645/bon-bobita"}, "edited": false, "score": 0, "creation_date": 1519821488, "post_id": 49029575, "comment_id": 85063737, "body": "And If in the text file I have name Perry marrie /n name Ana Sarah Penny? I should use a while function?"}], "tags": [], "owner": {"reputation": 4102, "user_id": 7908770, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01c6edec3c808659a8e8f42d4259a4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Adi219", "link": "https://stackoverflow.com/users/7908770/adi219"}, "is_accepted": false, "score": 0, "last_activity_date": 1519820748, "creation_date": 1519820748, "answer_id": 49029575, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file/49029575#49029575", "title": "Two words in a string from text file", "body": "<p>Change your <code>fscanf</code> line to <code>fscanf(fp, \"%s %s %s\", s, s1, s2)</code>.</p>\n\n<p>Then you can <code>printf</code> your <code>s1</code> and <code>s2</code> variables to get \"Penny\" and \"Marie\".</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 8851729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-13jjL-LHLN0/AAAAAAAAAAI/AAAAAAAAASE/sSNw2-2hHkk/photo.jpg?sz=128", "display_name": "Rishaal", "link": "https://stackoverflow.com/users/8851729/rishaal"}, "is_accepted": false, "score": 0, "last_activity_date": 1519820861, "creation_date": 1519820861, "answer_id": 49029612, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file/49029612#49029612", "title": "Two words in a string from text file", "body": "<p>Try the function <code>fgets</code></p>\n\n<pre><code>   fp = fopen(\"file.txt\" , \"r\");\n   if(fp == NULL) {\n      perror(\"Error opening file\");\n      return(-1);\n   }\n   if( fgets (str, 60, fp)!=NULL ) {\n      /* writing content to stdout */\n      puts(str);\n   }\n   fclose(fp);\n</code></pre>\n\n<p>In the above piece of code it will write out the content with the maximum of 60 characters. You can make that part dynamic with <code>str(len)</code> if I'm not mistaken.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 8703564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ace1dc160086110b28c2d20807292c5?s=128&d=identicon&r=PG&f=1", "display_name": "hir12111", "link": "https://stackoverflow.com/users/8703564/hir12111"}, "is_accepted": false, "score": 3, "last_activity_date": 1519820872, "creation_date": 1519820872, "answer_id": 49029617, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file/49029617#49029617", "title": "Two words in a string from text file", "body": "<p>Change the fscanf format, just tell it to not stop reading until new line:</p>\n\n<p><code>fscanf(fp,\"%s %[^\\n]s\",s,s1);</code></p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1519912114, "last_edit_date": 1519912114, "creation_date": 1519828776, "answer_id": 49032100, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file/49032100#49032100", "title": "Two words in a string from text file", "body": "<p>The other answers address adjustments to your <code>fscanf</code> call specific to your stated need.  (Although <code>fscanf()</code> is not generally the best way to do what you are asking.)  Your question is specific about getting 2 words, <code>Penny</code> &amp; <code>Marie</code>, from a line in a file that contains: <code>name Penny Marie</code>.  And as asked in comments, what if the file contains more than 1 line that needs to be parsed, or the name strings contain a variable number of names. Generally, the following functions and techniques are more suitable and are more commonly used to read content from a file and parse its content into strings:  </p>\n\n<p><em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fopen.htm\" rel=\"nofollow noreferrer\">fopen() and its arguments.</a></em><br>\n<em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fgets.htm\" rel=\"nofollow noreferrer\">fgets()</a></em><br>\n<em><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\">strtok()</a></em> (or <a href=\"https://linux.die.net/man/3/strtok_r\" rel=\"nofollow noreferrer\">strtok_r()</a>)<br>\n<em><a href=\"https://codereview.stackexchange.com/questions/156477/c-program-to-count-number-of-lines-in-a-file\">How to determine count of lines in a file</a></em> (useful for creating an array of strings)<br>\n<em><a href=\"https://cboard.cprogramming.com/c-programming/143214-reading-array-strings-text-file.html\" rel=\"nofollow noreferrer\">How to read lines of file into array of strings</a></em>.  </p>\n\n<p>Deploying these techniques and functions can be adapted in many ways to parse content from files.  To illustrate, a small example using these techniques is implemented below that will handle your stated needs, including multiple lines per file and variable numbers of names in each line.  </p>\n\n<p>Given File: <code>names.txt</code> in local directory: </p>\n\n<blockquote>\n<pre><code>name Penny Marie\nname Jerry Smith\nname Anthony James\nname William Begoin\nname Billy Jay Smith\nname Jill Garner\nname Cyndi Elm\nname Bill Jones\nname Ella Fitz Bella Jay\nname Jerry\n</code></pre>\n</blockquote>\n\n<p>The following reads a file to characterize its contents in terms of number of lines, and longest line, creates an array of strings then populates each string in the array with names in the file, regardless the number of parts of the name.  </p>\n\n<pre><code>int main(void)\n{\n    // get count of lines in file:\n    int longest=0, i;\n    int count = count_of_lines(\".\\\\names.txt\", &amp;longest);\n\n    // create array of strings with information from above\n    char names[count][longest+2]; // +2 - newline and NULL\n    char temp[longest+2];\n    char *tok;\n\n    FILE *fp = fopen(\".\\\\names.txt\", \"r\");\n    if(fp)\n    {\n        for(i=0;i&lt;count;i++)\n        {\n            if(fgets(temp, longest+2, fp))// read next line\n            {\n                tok = strtok(temp, \" \\n\"); // throw away \"name\" and space \n                if(tok)\n                {\n                    tok = strtok(NULL, \" \\n\");//capture first name of line.\n                    if(tok)\n                    {\n                        strcpy(names[i], tok); // write first name element to string.\n                        tok = strtok(NULL, \" \\n\");\n                        while(tok) // continue until all name elements in line are read\n                        {   //concatenate remaining name elements\n                            strcat(names[i], \" \");// add space between name elements\n                            strcat(names[i], tok);// next name element\n                            tok = strtok(NULL, \" \\n\");\n                        }\n                    }\n                }\n            }\n\n        }\n    }\n    return 0;\n}\n\n\n// returns count, and passes back longest\nint count_of_lines(char *filename, int *longest)\n{\n    int count = 0;\n    int len=0, lenKeep=0;\n    int c;\n    FILE *fp = fopen(filename, \"r\");\n    if(fp)\n    {\n        c = getc(fp);\n        while(c != EOF)\n        {\n            if(c != '\\n') \n            {\n                len++;  \n            }\n            else\n            {\n                lenKeep = (len &lt; lenKeep) ? lenKeep : len;\n                len = 0;\n                count++;\n            }\n            c = getc(fp);\n        }\n        fclose(fp);\n        *longest = lenKeep;\n    }\n    return count;       \n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9423645, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bon Bobita", "link": "https://stackoverflow.com/users/9423645/bon-bobita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 5, "score": 3, "last_activity_date": 1519912114, "creation_date": 1519820524, "last_edit_date": 1519820632, "question_id": 49029479, "link": "https://stackoverflow.com/questions/49029479/two-words-in-a-string-from-text-file", "title": "Two words in a string from text file", "body": "<p>I'm trying to get two words in a string and I don't know how I can do it. I tried but if in a text file I have 'name Penny Marie' it gives me :name Penny. How can I get Penny Marie in s1? Thank you</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    printf(\"Hello world!\\n\");\n    char s[50];\n    char s1[20];\n\n    FILE* fp = fopen(\"file.txt\", \"rt\");\n    if (fp == NULL)\n        return 0;\n\n    fscanf(fp,\"%s %s\",s,s1);\n    {\n        printf(\"%s\\n\",s);\n        printf(\"%s\",s1);\n    }\n    fclose(fp);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "compilation"], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519819854, "post_id": 49029265, "comment_id": 85062673, "body": "i fixed that already."}], "tags": [], "owner": {"reputation": 3624, "user_id": 8013471, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jh4jO.jpg?s=128&g=1", "display_name": "cse", "link": "https://stackoverflow.com/users/8013471/cse"}, "is_accepted": true, "score": 1, "last_activity_date": 1519819893, "last_edit_date": 1519819893, "creation_date": 1519819822, "answer_id": 49029265, "question_id": 49029214, "link": "https://stackoverflow.com/questions/49029214/creating-a-pthread-in-c-using-that-to-wait-for-create-thread-to-finish-execution/49029265#49029265", "title": "creating a pthread in c using that to wait for create thread to finish execution", "body": "<p>In following loop you are incrementing <code>i</code> instead of <code>j</code>:</p>\n\n<pre><code>   for(j = 0; j &lt; 2; i++){\n    pthread_join(tid[j],NULL);\n}\n</code></pre>\n\n<p>Change it to following and it will work fine:</p>\n\n<pre><code>   for(j = 0; j &lt; 2; j++){\n    pthread_join(tid[j],NULL);\n}\n</code></pre>\n"}], "owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1519825725, "accepted_answer_id": 49029265, "answer_count": 1, "score": -1, "last_activity_date": 1519819893, "creation_date": 1519819609, "question_id": 49029214, "link": "https://stackoverflow.com/questions/49029214/creating-a-pthread-in-c-using-that-to-wait-for-create-thread-to-finish-execution", "closed_reason": "Not suitable for this site", "title": "creating a pthread in c using that to wait for create thread to finish execution", "body": "<p>the following code, I create a pthread, then I  Have the main thread wait for the created thread to finish execution:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid * createThread(void * u){\n  printf(\"Tread has been created\");\n}\n\nint main(){\n  //pthread_t tid;\n  //pthread_create(&amp;tid,NULL,&amp;createThread,NULL);\n  //printf(\"Main thread\");\n\n  //pthread_join(tid,NULL);\n\n  pthread_t tid[2];\n  int i;\n  for(i = 0; i &lt; 2; i++){\n    pthread_create(&amp;tid[i],NULL,&amp;createThread,NULL);\n  }\n  int j;\n  for(j = 0; j &lt; 2; i++){\n    pthread_join(tid[j],NULL);\n  }\n  return 0;\n}\n</code></pre>\n\n<p>when I run this by suing <code>gcc 1_4.c -lpthread</code> then <code>./a.out</code> I have to wait for a long time before I can see an answer in my terminal!</p>\n\n<p>what am I doing wrong or I cant see the problem with my for.</p>\n"}, {"tags": ["c", "visual-studio", "visual-studio-2017"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1519819080, "post_id": 49028236, "comment_id": 85062213, "body": "It is in <a href=\"https://www.jetbrains.com/help/resharper/ReSharper_by_Language_CPP.html\" rel=\"nofollow noreferrer\">the FM</a>, use the <code>__RESHARPER__</code> macro."}], "answers": [{"comments": [{"owner": {"reputation": 7197, "user_id": 587467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7787bdb4718fdc9b42fb46d671bd7eca?s=128&d=identicon&r=PG", "display_name": "Tar", "link": "https://stackoverflow.com/users/587467/tar"}, "edited": false, "score": 0, "creation_date": 1519818929, "post_id": 49028308, "comment_id": 85062121, "body": "This solution forces me to enter specific code just for the editor. Is there no way around it?"}, {"owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "reply_to_user": {"reputation": 7197, "user_id": 587467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7787bdb4718fdc9b42fb46d671bd7eca?s=128&d=identicon&r=PG", "display_name": "Tar", "link": "https://stackoverflow.com/users/587467/tar"}, "edited": false, "score": 1, "creation_date": 1519819571, "post_id": 49028308, "comment_id": 85062500, "body": "@Tar Only thing is to add it on project level, so code is not touched. <a href=\"https://msdn.microsoft.com/en-us/library/8c5ztk84.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/8c5ztk84.aspx</a>"}], "tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": true, "score": 1, "last_activity_date": 1519819704, "last_edit_date": 1519819704, "creation_date": 1519816655, "answer_id": 49028308, "question_id": 49028236, "link": "https://stackoverflow.com/questions/49028236/how-to-make-vs2017-ignore-a-specific-compilers-keyword/49028308#49028308", "title": "How to make VS2017 ignore a specific compiler&#39;s keyword?", "body": "<p>I am not sure about R#, but in VS you could try to define globally:</p>\n\n<pre><code>#ifdef __INTELLISENSE__\n#define _Interrupt1\n#endif\n</code></pre>\n\n<p>to hide <code>_Interrupt1</code> from Intellisense parsing.</p>\n\n<p>For completeness, thanks to @Hans Passant, use <code>__RESHARPER__</code> for RS </p>\n"}], "owner": {"reputation": 7197, "user_id": 587467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7787bdb4718fdc9b42fb46d671bd7eca?s=128&d=identicon&r=PG", "display_name": "Tar", "link": "https://stackoverflow.com/users/587467/tar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 49028308, "answer_count": 1, "score": 0, "last_activity_date": 1519819704, "creation_date": 1519816394, "question_id": 49028236, "link": "https://stackoverflow.com/questions/49028236/how-to-make-vs2017-ignore-a-specific-compilers-keyword", "title": "How to make VS2017 ignore a specific compiler&#39;s keyword?", "body": "<p>I use Visual Studio 2017 with ReSharper 2017.2 as the code editor for an embedded project. I managed to configure all but one thing:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7l9zp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7l9zp.png\" alt=\"snippet screenshot\"></a></p>\n\n<p>How do I make VS/R# ignore that specific keyword, <code>_Interrupt1</code>? (this error causes other side effects).</p>\n\n<p>I tried to add it as a preprocessor definition (Project's properties -> C/C++ -> Preprocessor -> Preprocessor Definitions), but it doesn't help.</p>\n"}, {"tags": ["c", "linux", "compilation", "fork"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1519815461, "post_id": 49027904, "comment_id": 85060080, "body": "Using C++ libraries to write in C?"}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519815517, "post_id": 49027904, "comment_id": 85060115, "body": "i AM SORRY DID i MAKE THAT MISTAKE BY USING A C++ LIBRARY HERE?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 4, "creation_date": 1519815541, "post_id": 49027904, "comment_id": 85060129, "body": "<code>iostream</code> doesn&#39;t exist in C"}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519815586, "post_id": 49027904, "comment_id": 85060150, "body": "@FedericoklezCulloca I see, okiI willremove that but how do I make sure the next error wont happen?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519815609, "post_id": 49027904, "comment_id": 85060166, "body": "How are you compiling this? You didn&#39;t tell."}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "reply_to_user": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1519815656, "post_id": 49027904, "comment_id": 85060195, "body": "like this: gcc 1_3.c, then later ./a.out"}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1519818440, "post_id": 49027904, "comment_id": 85061818, "body": "@S.N BTW, I rolled it back to show the original question (the actual question that is answered)"}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "reply_to_user": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1519818483, "post_id": 49027904, "comment_id": 85061850, "body": "@\u6c34\u98f2\u307f\u9ce5 alright np."}], "answers": [{"comments": [{"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519815749, "post_id": 49027987, "comment_id": 85060260, "body": "1_3.c:12:5: warning: passing argument 1 of \u2018fprintf\u2019 from incompatible pointer type [enabled by default] ."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519816139, "post_id": 49027987, "comment_id": 85060508, "body": "Did you just replace the 1st <code>printf()</code> by <code>fprintf()</code> ?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 1, "creation_date": 1519816201, "post_id": 49027987, "comment_id": 85060542, "body": "@S.N. you need to replace only the first printf with fprintf."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1519816311, "post_id": 49027987, "comment_id": 85060592, "body": "Yes, it&#39;s only the 1st one (i.e.: the one taking <code>stderr</code>)."}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519816642, "post_id": 49027987, "comment_id": 85060781, "body": "@\u6c34\u98f2\u307f\u9ce5 I think it should be written using a while loop to make sure the child process is terminated, because currently it doesnt do that. if I am correct!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1519816660, "post_id": 49027987, "comment_id": 85060796, "body": "Line 12 of the posted program does not have fprintf in it. You are compiling something else."}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1519816784, "post_id": 49027987, "comment_id": 85060873, "body": "@n.m. can u check it again I posted the new program."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519816820, "post_id": 49027987, "comment_id": 85060898, "body": "@S.N This new one seems to compile."}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519816879, "post_id": 49027987, "comment_id": 85060936, "body": "@\u6c34\u98f2\u307f\u9ce5 it does compile but I am not sure if the parent actually waits for the termination of a child process."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "edited": false, "score": 0, "creation_date": 1519816967, "post_id": 49027987, "comment_id": 85060990, "body": "It seems it does (i.e.: <code>waitpid()</code>), why do you say so?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 3, "creation_date": 1519816999, "post_id": 49027987, "comment_id": 85061008, "body": "@S.N. The compilation problem is solved. If you have another question, post another question."}, {"owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519817080, "post_id": 49027987, "comment_id": 85061053, "body": "@\u6c34\u98f2\u307f\u9ce5 I think in never goes to any of my if statements in the last if. thats why I think thats the problem."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519817216, "post_id": 49027987, "comment_id": 85061130, "body": "@S.N Both of your last if statements are mutually exclusive, i.e.: only one is executed."}, {"owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "reply_to_user": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "edited": false, "score": 0, "creation_date": 1519817294, "post_id": 49027987, "comment_id": 85061180, "body": "@S.N Anyway, as n.m. already suggested, if you have other problems regarding the execution of the child/parent processes, consider creating a fresh new question."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": true, "score": 6, "last_activity_date": 1519815771, "last_edit_date": 1519815771, "creation_date": 1519815647, "answer_id": 49027987, "question_id": 49027904, "link": "https://stackoverflow.com/questions/49027904/using-c-to-create-a-child-and-parent-process/49027987#49027987", "title": "using C to create a child and parent process", "body": "<p>Your error is in the first function call to <code>printf()</code>:</p>\n\n<pre><code>printf(stderr, \"Fork call failed! \\n\");\n</code></pre>\n\n<p>It should actually be <code>fprintf()</code> instead:</p>\n\n<pre><code>fprintf(stderr, \"Fork call failed! \\n\");\n</code></pre>\n\n<hr>\n\n<p>Also, don't forget to include:</p>\n\n<ul>\n<li><code>unistd.h</code> for <code>fork()</code>.</li>\n<li><code>sys/types.h</code> and <code>sys/wait.h</code> for <code>waitpid()</code>.</li>\n<li><code>stdlib.h</code> for <code>exit()</code>.</li>\n</ul>\n\n<p>and remove <code>#include &lt;iostream&gt;</code> since that is for C++.</p>\n"}], "owner": {"reputation": 1697, "user_id": 865150, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f4de71a5b13764353e5443b215bfe34?s=128&d=identicon&r=PG", "display_name": "S. N", "link": "https://stackoverflow.com/users/865150/s-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "accepted_answer_id": 49027987, "answer_count": 1, "score": 2, "last_activity_date": 1519836041, "creation_date": 1519815407, "last_edit_date": 1519819322, "question_id": 49027904, "link": "https://stackoverflow.com/questions/49027904/using-c-to-create-a-child-and-parent-process", "title": "using C to create a child and parent process", "body": "<p>I am making the following code in C. I am writing a program that creates a new process using <code>fork</code> system call. Then I want to check which one is active and finally if it's a child process return the list of all the directories within that file, or if it's a parent wait for termination of the child process.</p>\n\n<p>Following is my code: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;dirent.h&gt; \n#include &lt;iostream&gt;\n\n\nint main(){\n  int pid = fork();\n  if(pid &lt; 0){\n    printf(stderr, \"Fork call failed! \\n\");\n  }\n  else if(pid == 0){\n    printf(\"This process is the child from fork=%d\\n\", pid);\n    printf(\"Thecurrent file inside the directory are:\\n\");\n    DIR *d;\n    struct dirent *dir;\n    d = opendir(\".\");\n    if (d) {\n      while ((dir = readdir(d)) != NULL) {\n    printf(\"%s\\n\", dir-&gt;d_name);\n      }\n      closedir(d);\n    }\n    exit(0);\n  }\n  else{\n    printf(\"This process is the parent from fork=%d\\n\", pid);\n    int stats;    \n    //parent process waits for child to terminate\n    waitpid(pid, &amp;stats, 0);\n\n    if(stats == 0){\n      printf(\"This process is terminated.\");\n    }\n\n    if(stats == 1){\n      printf(\"This process is terminated and an error has occured.\");\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>fatal error: iostream: No such file or directory  #include &lt;iostream&gt;\n                    ^ compilation terminated.\n</code></pre>\n\n<p>If I remove <code>#include &lt;iostream&gt;</code>, I get:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>/usr/include/stdio.h:362:12: note: expected \u2018const char * __restrict__\u2019 but argument is of type \u2018struct _IO_FILE *\u2019\n</code></pre>\n\n<p>how can I fix this problem?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1519819063, "post_id": 49027801, "comment_id": 85062206, "body": "As <code>a</code> is a pointer to a mouse state, you must have memory for the mouse state itself. Either declare one as an auto variable, or use malloc to allocate one. And you can&#39;t do a <code>getmousestate(a-&gt;x);</code> because <code>x</code> is not a mouse state structure."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1519819426, "creation_date": 1519819426, "answer_id": 49029162, "question_id": 49027801, "link": "https://stackoverflow.com/questions/49027801/getmousestate-function-open-bgi-library/49029162#49029162", "title": "getmousestate function Open BGI library", "body": "<p>OK, beginner, let's start. You want to do:</p>\n\n<pre><code>g_mousestate *a;\ngetmousestate(a-&gt;x);\n</code></pre>\n\n<p>to get the x-position of the mouse. First note that you have declared <code>a</code> as a pointer, but no memory has been allocated for it (it points to nothing yet). So first you must have memory for the <code>g_mousestate</code> object:</p>\n\n<pre><code>g_mousestate a;\ngetmousestate(&amp;a);\n</code></pre>\n\n<p>Now <code>a</code> is no longer a pointer but an object and you pass a pointer to the <code>getmousestate</code> function by taking the address of <code>a</code> with the <code>&amp;</code> operator (\"address-of\").</p>\n\n<p>You need to do no more since, if you look at the definition of the function, you see that all members are filled in by it.</p>\n"}], "owner": {"reputation": 13, "user_id": 9423282, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ChBFqb9V_qk/AAAAAAAAAAI/AAAAAAAAAC0/xv9CqkUDuV8/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/9423282/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49029162, "answer_count": 1, "score": 1, "last_activity_date": 1519819426, "creation_date": 1519815139, "last_edit_date": 1519815671, "question_id": 49027801, "link": "https://stackoverflow.com/questions/49027801/getmousestate-function-open-bgi-library", "title": "getmousestate function Open BGI library", "body": "<p>I am currently using the out of date open BGI library for C as that is what my uni wants us to do but I can't figure out how to use this function.</p>\n\n<p><code>extern void getmousestate(g_mousestate *state);</code></p>\n\n<p>Definition:</p>\n\n<pre><code>void getmousestate(g_mousestate * state)\n{\n    CHECK_GRAPHCS_INITED\n    state-&gt;x = sharedStruct-&gt;mouseX;\n    state-&gt;y = sharedStruct-&gt;mouseY;\n    state-&gt;buttons = sharedStruct-&gt;mouseButton;\n}\n</code></pre>\n\n<p>g_mousestate Definition:</p>\n\n<pre><code>typedef struct mousestate {\n    int x, y;\n    int buttons;\n}g_mousestate;\n</code></pre>\n\n<p>sharedStruct definition:</p>\n\n<p><code>static SHARED_STRUCT * sharedStruct;</code></p>\n\n<p>SHARED_STRUCT Definition:</p>\n\n<pre><code>typedef struct\n{\n  int mouseX, mouseY;\n  int mouseButton;\n  int keyCode;\n  int keyLetter;\n  int visualPage;\n} SHARED_STRUCT;\n</code></pre>\n\n<p>The sort of thing I was trying to do to call:</p>\n\n<pre><code>g_mousestate *a;\ngetmousestate(a-&gt;x);\n</code></pre>\n\n<p>But I don't know what to initialize a to...</p>\n\n<p>I assumed this function could tell me what position the mouse is in and what buttons are being pressed etc, but I can't figure out how to call the function properly. Very much a beginner here, any help would be appreciated.</p>\n"}, {"tags": ["c", ".net", "azure", "azure-security", "shared-secret"], "comments": [{"owner": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519814439, "post_id": 49027391, "comment_id": 85059459, "body": "Console app... running in Azure on a VM with the automagically generated service principal added to Key Vault&#39;s Access Policies? What do you mean by <i>i have added my user as the Selected Principle</i>, that&#39;s not how it works, the VM has its own SPN, use it."}, {"owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "reply_to_user": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519814564, "post_id": 49027391, "comment_id": 85059530, "body": "I mean i added my AD user as a principle when setting up access policies in the azure vault"}, {"owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "reply_to_user": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519814718, "post_id": 49027391, "comment_id": 85059627, "body": "I am running the console app locally"}, {"owner": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519814811, "post_id": 49027391, "comment_id": 85059686, "body": "What do you mean <i>locally</i>? The whole point of MSI is that it&#39;s implemented in the Azure resource. There&#39;s no mechanism in place for your <b>local</b> dev machine to acquire an access token."}, {"owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "reply_to_user": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519815651, "post_id": 49027391, "comment_id": 85060193, "body": "Do i need to register my console app in azure? and use the applicationId and appSecret in the instance of the KeyVaultClient?"}, {"owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "reply_to_user": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519815739, "post_id": 49027391, "comment_id": 85060251, "body": "How can i use vault to get secrets from a windows forms app or a console app?"}, {"owner": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "edited": false, "score": 0, "creation_date": 1519818478, "post_id": 49027391, "comment_id": 85061846, "body": "Yes, you need to register your app with Azure AD to get a client_id and client_secret. You&#39;ll then use those to acquire an access token for your vault resource."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 8722843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e95bd74a5f9a7a1084716338fd2e7052?s=128&d=identicon&r=PG&f=1", "display_name": "Varun - MSFT", "link": "https://stackoverflow.com/users/8722843/varun-msft"}, "edited": false, "score": 1, "creation_date": 1535402092, "post_id": 49028466, "comment_id": 91044191, "body": "AzureServiceTokenProvider allows use of developer Visual Studio identity or Azure CLI for local development. Please do not use Client ID and secret for this. The intent of MSI and AzureServiceTokenProvider is to not have developers deal with explicit credentials. Please refer this to use Visual Studio/ Azure CLI for local development. <a href=\"https://docs.microsoft.com/en-us/azure/key-vault/service-to-service-authentication#local-development-authentication\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/key-vault/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19351, "user_id": 4148708, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jLI9o.jpg?s=128&g=1", "display_name": "evilSnobu", "link": "https://stackoverflow.com/users/4148708/evilsnobu"}, "is_accepted": true, "score": 8, "last_activity_date": 1535409516, "last_edit_date": 1535409516, "creation_date": 1519817179, "answer_id": 49028466, "question_id": 49027391, "link": "https://stackoverflow.com/questions/49027391/connection-to-azure-vault-using-msi/49028466#49028466", "title": "Connection to Azure Vault using MSI", "body": "<ol>\n<li>Enable Managed Service Identity in the <em>Configuration</em> blade under your virtual machine.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/6YtVo.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/6YtVo.png\" alt=\"Enable MSI in the virtual machine configuration blade\"></a></p>\n\n<ol start=\"2\">\n<li>Search for <em>NameOfYourVM</em> service principal and add it to your Key Vault under <em>Access Policies</em>. Add key/secret/certificate permissions.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/TpOTl.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/TpOTl.png\" alt=\"Add Service Principal to Key Vault\"></a></p>\n\n<ol start=\"3\">\n<li>On your Azure VM, run the console app.</li>\n</ol>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>class Program\n{\n    // Target C# 7.1+ in your .csproj for async Main\n    static async Task Main()\n    {\n        var azureServiceTokenProvider = new AzureServiceTokenProvider();\n\n        var keyVaultClient = new KeyVaultClient(\n              new KeyVaultClient.AuthenticationCallback(\n                    azureServiceTokenProvider.KeyVaultTokenCallback));\n\n        var secret = await keyVaultClient.GetSecretAsync(\n              \"https://VAULT-NAME.vault.azure.net/secrets/SECRET-NAME\");\n\n        Console.WriteLine(secret.Value);\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/46Aqx.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/46Aqx.png\" alt=\"Console output\"></a></p>\n\n<p><s>To run locally, create your very own Azure AD application registration (Web App/Web API type to make it a confidential client), add it to Key Vault and use its client_id and client_secret when acquiring the access token &mdash;<br>\n<a href=\"https://docs.microsoft.com/en-us/azure/key-vault/key-vault-use-from-web-application#gettoken\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/azure/key-vault/key-vault-use-from-web-application#gettoken</a></s></p>\n\n<p>As <a href=\"https://stackoverflow.com/users/8722843/varun-msft\">Varun</a> mentioned in the comments, there's now a better way to get an access token when running locally without exposing a service principal &mdash;</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/azure/key-vault/service-to-service-authentication#local-development-authentication\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/azure/key-vault/service-to-service-authentication#local-development-authentication</a></p>\n"}, {"tags": [], "owner": {"reputation": 1092, "user_id": 2098993, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/51cf6f9f9dc4e53d7fd5d8c226077811?s=128&d=identicon&r=PG", "display_name": "Snr", "link": "https://stackoverflow.com/users/2098993/snr"}, "is_accepted": false, "score": 3, "last_activity_date": 1525262122, "last_edit_date": 1525262122, "creation_date": 1525260646, "answer_id": 50133652, "question_id": 49027391, "link": "https://stackoverflow.com/questions/49027391/connection-to-azure-vault-using-msi/50133652#50133652", "title": "Connection to Azure Vault using MSI", "body": "<p>To run locally.</p>\n\n<ol>\n<li>install Azure Cli  </li>\n<li>Open Windows Powershell </li>\n<li>write <code>az login</code>  command (it will give an url and code ) </li>\n<li>Open Url and enter the code which is given with az login </li>\n</ol>\n\n<p>then get the secret value like this</p>\n\n<pre><code> var secret =  keyVaultClient.GetSecretAsync(\"https://VAULT-NAME.vault.azure.net/secrets/SECRET-NAME\").GetAwaiter().GetResult() ;\n     secret.Value; //will be your secret.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 250, "user_id": 3058292, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/l3xUv.jpg?s=128&g=1", "display_name": "Thilanka Ishara Gunathilake", "link": "https://stackoverflow.com/users/3058292/thilanka-ishara-gunathilake"}, "is_accepted": false, "score": 2, "last_activity_date": 1553233043, "creation_date": 1553233043, "answer_id": 55293482, "question_id": 49027391, "link": "https://stackoverflow.com/questions/49027391/connection-to-azure-vault-using-msi/55293482#55293482", "title": "Connection to Azure Vault using MSI", "body": "<p>a correct answer is already given above, here's an additional one :-)</p>\n\n<p><strong>Azure MSI applying with App Service &amp; Vault</strong></p>\n\n<ol>\n<li><p>Enable System Assigned Managed Identity for your App Service, check Identity section under settings.<a href=\"https://i.stack.imgur.com/pgYhc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pgYhc.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Add Policy under Vault</p></li>\n<li><p>configure your code behind</p>\n\n<p><a href=\"https://i.stack.imgur.com/p90fk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p90fk.png\" alt=\"enter image description here\"></a></p></li>\n</ol>\n"}], "owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6951, "favorite_count": 1, "accepted_answer_id": 49028466, "answer_count": 3, "score": 6, "last_activity_date": 1553233043, "creation_date": 1519813977, "last_edit_date": 1519814690, "question_id": 49027391, "link": "https://stackoverflow.com/questions/49027391/connection-to-azure-vault-using-msi", "title": "Connection to Azure Vault using MSI", "body": "<p>I am trying to connect to my azure vault from a console application with using MSI</p>\n\n<p>For this vault i have added my user as the Selected Principle<br>\nthe code i am using to connect is </p>\n\n<pre><code>var azureServiceTokenProvider = new AzureServiceTokenProvider();\n\nvar keyVaultClient = new KeyVaultClient(new KeyVaultClient.AuthenticationCallback(azureServiceTokenProvider.KeyVaultTokenCallback));\n\nvar secret = await keyVaultClient.GetSecretAsync(\"https://&lt;vaultname&gt;.vault.azure.net/secrets/&lt;SecretName&gt;\").ConfigureAwait(false);\n</code></pre>\n\n<p>I get the following exception</p>\n\n<blockquote>\n  <p>Microsoft.Azure.Services.AppAuthentication.AzureServiceTokenProviderException:\n  Parameters: Connectionstring: [No connection string specified],\n  Resource: <a href=\"https://vault.azure.net\" rel=\"noreferrer\">https://vault.azure.net</a>, Authority</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/iVNlg.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/iVNlg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "caching"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519814093, "post_id": 49027336, "comment_id": 85059261, "body": "The format string and the arguments doesn&#39;t match. The type of the result from <code>sizeof</code> is a <code>size_t</code>, which is an unsigned type of some implementation-specific width. You should be using e.g. <code>&quot;%zu&quot;</code> to print a <code>size_t</code> value. See <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">this <code>printf</code> (and family) reference</a> for more details."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519814265, "post_id": 49027336, "comment_id": 85059357, "body": "Break down what?"}, {"owner": {"reputation": 11, "user_id": 9423239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "unkowndude", "link": "https://stackoverflow.com/users/9423239/unkowndude"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519819392, "post_id": 49027336, "comment_id": 85062387, "body": "@Someprogrammerdude how would you optimize the code so the x array is accessed the same number of times as before but in a way which reduce the average memory access time?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9423239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "unkowndude", "link": "https://stackoverflow.com/users/9423239/unkowndude"}, "edited": false, "score": 0, "creation_date": 1519819988, "post_id": 49028887, "comment_id": 85062743, "body": "This made it more clear. Thanks.I am trying to understand the two while loops. The first one basically accesses the cache and appends 1 to it however the second one confuses me"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 11, "user_id": 9423239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "unkowndude", "link": "https://stackoverflow.com/users/9423239/unkowndude"}, "edited": false, "score": 0, "creation_date": 1519820009, "post_id": 49028887, "comment_id": 85062760, "body": "If this is all that is wondered about, then @unkowndude should probably get some beginners books to read. Even bad books would have explanations about <code>printf</code> and how it works, including the width and precision values."}, {"owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1519823091, "post_id": 49028887, "comment_id": 85064812, "body": "@Some programmer dude Well, you are right, books contains all the informations, but for a beginner a couple of line like that may be confusing. Again I have always found difficulties in retrieving information about printf, I&#39;ve never found a good source of help about stdio.h, and that&#39;s the reason I suggested to look in a c++ page."}, {"owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "edited": false, "score": 0, "creation_date": 1519823317, "post_id": 49028887, "comment_id": 85064951, "body": "Indeed, maybe the questions in the comments are not related to the main question, so please consider if you want to post new questions (and please follow guidelines in doing so)"}], "tags": [], "owner": {"reputation": 984, "user_id": 7322100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d535f0625b6537caf1380aa0a61083?s=128&d=identicon&r=PG", "display_name": "ErniBrown", "link": "https://stackoverflow.com/users/7322100/ernibrown"}, "is_accepted": false, "score": 0, "last_activity_date": 1519818583, "creation_date": 1519818583, "answer_id": 49028887, "question_id": 49027336, "link": "https://stackoverflow.com/questions/49027336/trying-to-under-a-cachetest-code-in-c/49028887#49028887", "title": "Trying to under a cachetest code in C", "body": "<p>Your code prints 3 values with some formatting features:</p>\n\n<ol>\n<li><strong>Size (bytes):%9d</strong>: this prints a %d value, which is a <em>decimal integer</em>. The 9 in between means that it prints at least 9 characters. If the number is represented by less than 9 numbers it fill with spaces. This value is taken from the second printf argument, csize*sizeof(int). As @Some programmer dude noticed, this operation returns a non signed number, so maybe you can change %d in %u</li>\n<li><strong>Stride (bytes):%4d</strong>: same as before, but only 4 characters as minimum lenght</li>\n<li><strong>read+write:%6.2f ns</strong>: prints a float value, minimum length is 6 character. The <code>.2</code> is the precision, the number of digits after the point.</li>\n<li><strong>\\n</strong>: new line special character</li>\n</ol>\n\n<p>Please refer to this: <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">http://www.cplusplus.com/reference/cstdio/printf/</a>\nOk, is cpp, but is more clear than the classic man page</p>\n"}], "owner": {"reputation": 11, "user_id": 9423239, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "unkowndude", "link": "https://stackoverflow.com/users/9423239/unkowndude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519818583, "creation_date": 1519813823, "last_edit_date": 1519816410, "question_id": 49027336, "link": "https://stackoverflow.com/questions/49027336/trying-to-under-a-cachetest-code-in-c", "title": "Trying to under a cachetest code in C", "body": "<p>I am trying to understand the following code and what it prints out exactly: </p>\n\n<p><a href=\"https://ideone.com/ddPVRe\" rel=\"nofollow noreferrer\">https://ideone.com/ddPVRe</a></p>\n\n<pre><code>           printf(\"Size (bytes):%9d, Stride (bytes):%4d, read+write:%6.2f ns\\n\",\n           csize*sizeof(int), stride*sizeof(int),\n           (double) sec*1e9/(steps*SAMPLE*stride*((limit-1)/stride+1)));\n</code></pre>\n\n<p>It stops at Size: 67108864 where R/W is 11.82 ns.</p>\n\n<p><a href=\"https://i.stack.imgur.com/seihj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/seihj.png\" alt=\"enter image description here\"></a></p>\n\n<p>From what I can see it basically prints the time it takes to access the array x. Can someone please break it down for me?  </p>\n"}, {"tags": ["c", "struct", "embedded", "uart", "memory-mapping"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1519811741, "post_id": 49026561, "comment_id": 85057755, "body": "You should probably find a good beginners book which explains pointers and the dereference operator <code>*</code>, to learn what it does."}, {"owner": {"reputation": 5703, "user_id": 1401213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb697eb985c37893ed06f3c3324c7c8?s=128&d=identicon&r=PG&f=1", "display_name": "kkrambo", "link": "https://stackoverflow.com/users/1401213/kkrambo"}, "edited": false, "score": 0, "creation_date": 1519822566, "post_id": 49026561, "comment_id": 85064426, "body": "Search for and read about &quot;memory mapped&quot; hardware/registers/structs. For example, articles such as <a href=\"https://www.embedded.com/electronics-blogs/programming-pointers/4025002/Mapping-memory\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9395427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/amj7S.jpg?s=128&g=1", "display_name": "Kater", "link": "https://stackoverflow.com/users/9395427/kater"}, "edited": false, "score": 0, "creation_date": 1519812805, "post_id": 49026788, "comment_id": 85058464, "body": "I see, that makes a lot of sense, thanks, appreciate the explanaion."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 3, "last_activity_date": 1519812287, "creation_date": 1519812287, "answer_id": 49026788, "question_id": 49026561, "link": "https://stackoverflow.com/questions/49026561/how-do-these-uart-structs-as-function-parameters-work/49026788#49026788", "title": "How do these uart structs as function parameters work?", "body": "<p>They use the struct <code>UARTINIT</code> as a way to visualize memory-mapped hardware registers in the UART hardware. The struct must correspond exactly to the register layout for this to work, so whoever wrote the code must ensure that no struct padding is active. (Generally not an issue on 8 or 16 bit MCUs, but will be on bigger cores.)</p>\n\n<p>So the struct pointer <code>pPort1</code> will point at the first register in one of potentially several UART hardwares on the chip. The registers are already \"allocated\" - they exist is the form of memory-mapped hardware. </p>\n\n<p>The <code>UART</code> struct seems to simply be a user-defined struct used for storing various settings and for shovelling data in and out of the UART hardware buffers. If so, this struct must be allocated somewhere in user RAM. Or possibly it is also a register memory map, in which case you have some very strange hardware.</p>\n\n<p>Some manner of documentation is needed to understand how its used. Code such as <code>((*Buff).read + 1) % (*Buff).max;</code> looks quite obscure; I have no idea why they aren't simply letting the driver read/write raw data bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1519813315, "creation_date": 1519813315, "answer_id": 49027154, "question_id": 49026561, "link": "https://stackoverflow.com/questions/49026561/how-do-these-uart-structs-as-function-parameters-work/49027154#49027154", "title": "How do these uart structs as function parameters work?", "body": "<blockquote>\n  <p>The call by reference method of passing arguments to a function copies the address of an argument into the formal parameter. Inside the function, the address is used to access the actual argument used in the call. It means the changes made to the parameter affect the passed argument.</p>\n</blockquote>\n\n<p><a href=\"https://www.tutorialspoint.com/cprogramming/c_function_call_by_reference.htm\" rel=\"nofollow noreferrer\">click here for more info</a></p>\n\n<p>Here you pass the pointers to the struct instead of the struct itself. <code>*Buff</code> \"dereferences\" the pointer. In other words <code>*Buff</code> would give you the structure pointed to by the pointer. </p>\n\n<p><a href=\"https://youtu.be/vjq-13YADeI\" rel=\"nofollow noreferrer\">for tutorial on dereferencing(haven't watched it but seems decent enough)</a> </p>\n\n<hr>\n\n<p>now you could have sent the struct directly as an  argument but what this does is creates a copy of the struct in the scope of the function. So any changes you make inside the function would effect that copy and not the original. So you send a pointer.</p>\n\n<hr>\n\n<p>Additionally it is not advisable to pass structs to function by value because they usually are pretty large and need to be copied into the stack for the function...blah blah(i could go on)</p>\n\n<hr>\n\n<p>Bottom line....</p>\n\n<p>you pass pointer to function....function updates values at pointer....drops mic(yayyy).</p>\n\n<p>would be glad to clarify should doubts arise. But try and see some tutorials regarding passing by reference, dereferencing etc.(should help) </p>\n"}], "owner": {"reputation": 63, "user_id": 9395427, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/amj7S.jpg?s=128&g=1", "display_name": "Kater", "link": "https://stackoverflow.com/users/9395427/kater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 49026788, "answer_count": 2, "score": -1, "last_activity_date": 1519813315, "creation_date": 1519811616, "last_edit_date": 1519812336, "question_id": 49026561, "link": "https://stackoverflow.com/questions/49026561/how-do-these-uart-structs-as-function-parameters-work", "title": "How do these uart structs as function parameters work?", "body": "<p>I have this code I'm trying to understand but I'm stuck, so maybe one of you good people could point me in the right direction. </p>\n\n<p>Taking it step by step I have this part of an initialisation...</p>\n\n<pre><code>volatile struct UART *pTXD1;\nvolatile struct UARTINIT *pPort1;\n</code></pre>\n\n<p>...the strcuts...</p>\n\n<pre><code>struct UARTINIT\n{\n    union SR_BYTE SR; /* Status register */\n    BYTE DR; /* Data register */\n    BYTE BRR1; /* Baud Rate reg 1 */\n    BYTE BRR2; /* Baud Rate reg 2 */\n    union CR1_BYTE CR1; /* Control register 1 */\n    union CR2_BYTE CR2; /* Control register 2 */\n    BYTE CR3; /* Control register 3 */\n    BYTE CR4; /* Control register 4 */\n};\n\nstruct UART\n{\n    BYTE *Buffer;\n    WORD max;\n    WORD read;\n    WORD write;\n    BYTE Baud;\n    BYTE stopp;\n};\n</code></pre>\n\n<p>...function call...</p>\n\n<pre><code>Transmit_Uart(pTXD1, pPort1);\n</code></pre>\n\n<p>...the function</p>\n\n<pre><code>void Transmit_Uart(struct UART *Buff, struct UARTINIT *USART)\n{\n    if ((*Buff).write != (*Buff).read)\n    {\n        if ((*USART).SR.bit.TC)\n        {\n            (*Buff).read = ((*Buff).read + 1) % (*Buff).max;\n            (*USART).DR = (*Buff).Buffer[(*Buff).read];\n        }\n    }\n    else\n        (*Buff).stopp = OFF;\n    return;\n}\n</code></pre>\n\n<p>My problem is that I don't understand what information is written into the structs.\nThe function is called with pTXD1 and pPort1 as parameters, but those two are just pointers to structs, are they not?</p>\n\n<p><em>I apologize if my question is not understandable, and will gladly provide further information as needed.</em></p>\n"}, {"tags": ["c", "cross-compiling", "embedded-linux", "busybox"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1519810195, "post_id": 49025932, "comment_id": 85056729, "body": "If your embedded Linux device is using an older version of uclibc, it probably doesn&#39;t have <code>setns</code> and <code>syncfs</code>."}, {"owner": {"reputation": 71, "user_id": 6663923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5cfe88fc792b0e3b06f57f7b4e3b5f?s=128&d=identicon&r=PG&f=1", "display_name": "MHD", "link": "https://stackoverflow.com/users/6663923/mhd"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1519810891, "post_id": 49025932, "comment_id": 85057203, "body": "I&#39;m using kernel V2.6 and arm-brcm-linux-gnueabi V4.4.2,Do you mean uclibc used in compilation process? how can I recognize of it&#39;s version?"}, {"owner": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1519811288, "post_id": 49025932, "comment_id": 85057438, "body": "Append information about your environment (environment variables), and versions of libraries used, and compiler (and libc used). I nice way to build it could be through buildroot, that for sure many of the problems you can get building would be fixed."}, {"owner": {"reputation": 71, "user_id": 6663923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5cfe88fc792b0e3b06f57f7b4e3b5f?s=128&d=identicon&r=PG&f=1", "display_name": "MHD", "link": "https://stackoverflow.com/users/6663923/mhd"}, "reply_to_user": {"reputation": 558, "user_id": 4207183, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FlaU_rcEFmQ/AAAAAAAAAAI/AAAAAAAAF-Y/UVEWfvV4tKE/photo.jpg?sz=128", "display_name": "Alejandro Visiedo Garc&#237;a", "link": "https://stackoverflow.com/users/4207183/alejandro-visiedo-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1519817502, "post_id": 49025932, "comment_id": 85061307, "body": "@AlejandroVisiedo Thank you for answer,I also try buildroot,but it needs some information about processor(e.g. endian, detailed version,etc.) which I am not aware,this is a black box device and I only develope app on it, total information I have is it run on the BCM5892 ,an ARM11 secure processor from broadcom.it runs on kenel V 2.6 and arm-brcm-linux-gnueabi V4.4.2 compiler, I also correctly set sysroot and cross compiler prefix,but how could I know which version of libc I&#39;m using ?"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4901799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XlYJo.jpg?s=128&g=1", "display_name": "catweazle", "link": "https://stackoverflow.com/users/4901799/catweazle"}, "is_accepted": false, "score": 0, "last_activity_date": 1554318441, "creation_date": 1554318441, "answer_id": 55502575, "question_id": 49025932, "link": "https://stackoverflow.com/questions/49025932/failure-on-cross-compiling-busybox/55502575#55502575", "title": "Failure on cross compiling busybox", "body": "<p>You can detect your glibc Version by inspecting the names of this link targets:</p>\n\n<pre><code>root@debianxc:/usr/src/busybox# file /opt/STM/STLinux-2.4/devkit/sh4/target/lib/libc.so.6\n/opt/STM/STLinux-2.4/devkit/sh4/target/lib/libc.so.6: symbolic link to libc-2.10.2.so\nroot@debianxc:/usr/src/busybox# file /opt/STM/STLinux-2.4/devkit/sh4/target/lib/ld-linux.so.2\n/opt/STM/STLinux-2.4/devkit/sh4/target/lib/ld-linux.so.2: symbolic link to ld-2.10.2.so\n</code></pre>\n\n<p>This indicates a glibc Version of 2.10.2.\nBut to get sure you can also do:</p>\n\n<pre><code>root@debianxc:/usr/src/busybox# strings /opt/STM/STLinux-2.4/devkit/sh4/target/lib/libc.so.6 | grep '^GLIBC_' | sort | uniq\nGLIBC_2.10\nGLIBC_2.2\nGLIBC_2.2.1\nGLIBC_2.2.2\nGLIBC_2.2.3\nGLIBC_2.2.4\nGLIBC_2.2.6\nGLIBC_2.3\nGLIBC_2.3.2\nGLIBC_2.3.3\nGLIBC_2.3.4\nGLIBC_2.4\nGLIBC_2.5\nGLIBC_2.6\nGLIBC_2.7\nGLIBC_2.8\nGLIBC_2.9\nGLIBC_PRIVATE\nroot@debianxc:/usr/src/busybox# strings /opt/STM/STLinux-2.4/devkit/sh4/target/lib/ld-linux.so.2 | grep '^GLIBC_' | sort | uniq\nGLIBC_2.2\nGLIBC_2.3\nGLIBC_2.4\nGLIBC_PRIVATE\n</code></pre>\n\n<p>As I experienced a similar issue when compiling busybox-1.30.1 for SH4 Kernel 2.6.32.59, I had had to prevent nsenter.c and sync.c from becoming compiled by the Makefile.</p>\n\n<p>So in your case, you could try to change your .config file.</p>\n\n<pre><code>root@debianxc:/usr/src/busybox# diff -d .config_from_defconfig .config\n4c4\n&lt; # Wed Apr  3 20:04:24 2019\n---\n&gt; # Wed Apr  3 20:09:45 2019\n273c273\n&lt; CONFIG_MKTEMP=y\n---\n&gt; # CONFIG_MKTEMP is not set\n304,305c304,305\n&lt; CONFIG_SYNC=y\n&lt; CONFIG_FEATURE_SYNC_FANCY=y\n---\n&gt; # CONFIG_SYNC is not set\n&gt; # CONFIG_FEATURE_SYNC_FANCY is not set\n316,318c316,318\n&lt; CONFIG_TOUCH=y\n&lt; CONFIG_FEATURE_TOUCH_NODEREF=y\n&lt; CONFIG_FEATURE_TOUCH_SUSV3=y\n---\n&gt; # CONFIG_TOUCH is not set\n&gt; # CONFIG_FEATURE_TOUCH_NODEREF is not set\n&gt; # CONFIG_FEATURE_TOUCH_SUSV3 is not set\n667c667\n&lt; CONFIG_NSENTER=y\n---\n&gt; # CONFIG_NSENTER is not set\n\n</code></pre>\n\n<p>These are the steps you could follow:</p>\n\n<pre><code>#Backup your .config\ncp .config .config.backup\n\n#Create a new config with this sed command. You will see its effect by the follow-up diff command below...\nsed -e '/^\\(CONFIG_\\)\\(\\(MKTEMP\\)\\|\\(TOUCH\\)\\|\\(NSENTER\\)\\|\\(SYNC\\)\\)=.*$/s/^\\([^=]*\\)=.*$/# \\1 is not set/' .config &gt;.newconfig\n\n#With this diff output you will see its effect\ndiff -d .config .newconfig\n\n#Overwrite current .config with .newconfig\ncp .newconfig .config\n\n#Now run make oldconfig, because some disablings need auto-disablings of other depending configs, too...\nmake oldconfig\n\n#See the effect ...\ndiff -d .config.old .config\n\n#make clean before re-compiling\nmake clean\n\n#make busybox with cross-compiler\nmake CROSS_COMPILE=sh4-linux-\n\n#Your new busybox is located in your working direktory\n\n#Optionally invoke make install to create dir tree with symlinks\nmake CROSS_COMPILE=sh4-linux- install\n\n#Tree's name is _install\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 71, "user_id": 6663923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5cfe88fc792b0e3b06f57f7b4e3b5f?s=128&d=identicon&r=PG&f=1", "display_name": "MHD", "link": "https://stackoverflow.com/users/6663923/mhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1554318441, "creation_date": 1519809667, "last_edit_date": 1519817526, "question_id": 49025932, "link": "https://stackoverflow.com/questions/49025932/failure-on-cross-compiling-busybox", "title": "Failure on cross compiling busybox", "body": "<p>I'm trying to cross compile busy box V 1.27.2 for my embedded Linux device. I set share library build and cross compiler prefix and Sysroot  to my compiler destinations. Compiler after trying to compile most library files is unable to link them.I received this:</p>\n\n<pre><code>Trying libraries: crypt m\nFailed: -Wl,--start-group  -lcrypt -lm  -Wl,--end-group\nOutput of:\n/home/bluebird/brcm-armtools-64bit/tools/le_arm11_external_20090306/bin/arm-brcm-linux-gnueabi-gcc -Wall -Wshadow -Wwrite-strings -Wundef -Wstrict-prototypes -Wunused -Wunused-parameter -Wunused-function -Wunused-value -Wmissing-prototypes -Wmissing-declarations -Wno-format-security -Wdeclaration-after-statement -Wold-style-definition -fno-builtin-strlen -finline-limit=0 -fomit-frame-pointer -ffunction-sections -fdata-sections -fno-guess-branch-probability -funsigned-char -static-libgcc -falign-functions=1 -falign-jumps=1 -falign-labels=1 -falign-loops=1 -fno-unwind-tables -fno-asynchronous-unwind-tables -fno-builtin-printf -Os -fpic -fvisibility=hidden --sysroot=/home/bluebird/brcm-armtools-64bit/tools/le_arm11_external_20090306/sysroot -o busybox_unstripped -Wl,--sort-common -Wl,--sort-section,alignment -Wl,--gc-sections -Wl,--start-group applets/built-in.o archival/lib.a archival/libarchive/lib.a console-tools/lib.a coreutils/lib.a coreutils/libcoreutils/lib.a debianutils/lib.a e2fsprogs/lib.a editors/lib.a findutils/lib.a init/lib.a libbb/lib.a libpwdgrp/lib.a loginutils/lib.a mailutils/lib.a miscutils/lib.a modutils/lib.a networking/lib.a networking/libiproute/lib.a networking/udhcp/lib.a printutils/lib.a procps/lib.a runit/lib.a selinux/lib.a shell/lib.a sysklogd/lib.a util-linux/lib.a util-linux/volume_id/lib.a archival/built-in.o archival/libarchive/built-in.o console-tools/built-in.o coreutils/built-in.o coreutils/libcoreutils/built-in.o debianutils/built-in.o e2fsprogs/built-in.o editors/built-in.o findutils/built-in.o init/built-in.o libbb/built-in.o libpwdgrp/built-in.o loginutils/built-in.o mailutils/built-in.o miscutils/built-in.o modutils/built-in.o networking/built-in.o networking/libiproute/built-in.o networking/udhcp/built-in.o printutils/built-in.o procps/built-in.o runit/built-in.o selinux/built-in.o shell/built-in.o sysklogd/built-in.o util-linux/built-in.o util-linux/volume_id/built-in.o -Wl,--end-group -Wl,--start-group -lcrypt -lm -Wl,--end-group\n==========\ncoreutils/lib.a(mktemp.o): In function `mktemp_main':\nmktemp.c:(.text.mktemp_main+0xbc): warning: the use of `mktemp' is dangerous, better use `mkstemp'\ncoreutils/lib.a(touch.o): In function `touch_main':\ntouch.c:(.text.touch_main+0x1f4): warning: warning: lutimes is not implemented and will always fail\nutil-linux/lib.a(nsenter.o): In function `nsenter_main':\nnsenter.c:(.text.nsenter_main+0x1b4): undefined reference to `setns'\ncoreutils/lib.a(sync.o): In function `sync_main':\nsync.c:(.text.sync_main+0x9c): undefined reference to `syncfs'\ncollect2: ld returned 1 exit status\nNote: if build needs additional libraries, put them in CONFIG_EXTRA_LDLIBS.\nExample: CONFIG_EXTRA_LDLIBS=\"pthread dl tirpc audit pam\"\nmake: *** [busybox_unstripped] Error 1\n</code></pre>\n\n<p>Also I have libm.so in my sysroot dir.</p>\n\n<p><strong>EDIT:</strong>\nI also try buildroot,but it needs some information about processor(e.g. endian, detailed version,etc.) which I am not aware,this is a black box device and I only develope app on it, total information I have is it run on the BCM5892 ,an ARM11 secure processor from broadcom.it runs on kenel V 2.6 and arm-brcm-linux-gnueabi V4.4.2 compiler, I also correctly set sysroot and cross compiler prefix,but how could I know which version of libc I'm using ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1519809052, "post_id": 49025652, "comment_id": 85056040, "body": "we don&#39;t care about your whole homework. It would be better to reduce the amount of code and text of your question and focus on the real problem, creating a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519809542, "post_id": 49025652, "comment_id": 85056341, "body": "Sorry, this is pretty much my first time uploading here. I got desperate."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1519809601, "post_id": 49025652, "comment_id": 85056379, "body": "Are you saying that the objective of all of this is to generate a <i>shuffled</i> deck from the various card attributes?"}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519809727, "post_id": 49025652, "comment_id": 85056451, "body": "basically yes. With random numbers. He doesn&#39;t want an array simply assigned appropriate values and then shuffled which would make it a lot easier and not have to check for dupes as there&#39;s a fixed amount of faces and cards."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1519809813, "post_id": 49025652, "comment_id": 85056504, "body": "So use a comparison function for the <code>singlecard</code> structure."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1519810003, "post_id": 49025652, "comment_id": 85056600, "body": "Your <code>LoadFace</code> and <code>LoadSuit</code> functions don&#39;t fit the spec - they&#39;re meant to be using the value in <code>cardnum</code> to work out what face/suit the card is not randomly picking it"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1519810110, "post_id": 49025652, "comment_id": 85056671, "body": "Just an hint, but when it is stated that <i>&quot;LoadFace() will go through the deck and put the appropriate value in &quot;face&quot; of the array by using just the &quot;cardnum&quot; the modulus operator to extract the value from the string &quot;A23456789TJQK.&quot;</i>, you should actually use the modulus operator to convert cardnum to a face (it&#39;s a one liner...). You should have already shuffled the deck in loaddeck()."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519810121, "post_id": 49025652, "comment_id": 85056680, "body": "Wouldn&#39;t that still involve a bunch of if statements? I feel like I&#39;m already using to many."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519810216, "post_id": 49025652, "comment_id": 85056756, "body": "I know I&#39;m not using cardnum as a param at the moment. I&#39;m just stuck on this comparison logic."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1519810935, "post_id": 49025652, "comment_id": 85057227, "body": "@TylerJTucker: Per your last edit, if you have to add each card attribute to the cards in the array separately, then yes, you&#39;re going to need a TON of conditional statements."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1519811381, "post_id": 49025652, "comment_id": 85057505, "body": "@MarkBenningfield Why? After having shuffled the deck of cards (their cardnum) you only need a modulus and an integer division to find the face and the suit given the card number."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519811451, "post_id": 49025652, "comment_id": 85057550, "body": "That&#39;s what I&#39;m worried about. It seems like the lab is not intended to have a TON of conditional statements. Is there an easy way of assigning a suit after a random number is chosen in the LoadFace function? Or am I still looking at loads of conditional statements?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1519811820, "post_id": 49025652, "comment_id": 85057805, "body": "OT: Your <code>CheckDupe</code> can be simplified a lot. Just <code>return</code> the first time you have <code>check = 1;</code> Then you&#39;ll get rid of a lot of (confusing) lines."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1519811969, "post_id": 49025652, "comment_id": 85057903, "body": "OT: Are you being taught to use global variables? It&#39;s (nearly) always a bad idea."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519812160, "post_id": 49025652, "comment_id": 85058022, "body": "I had more return statements at first but I kept getting a warning for GNU I think, saying that there&#39;s a chance of a returning nothing. something about -wreturn. LoadFace and LoadSuit were recursive at first and were giving me trouble so I added return variables. Then I resorted to just returning bool."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519812203, "post_id": 49025652, "comment_id": 85058054, "body": "Not being taught to use them, no worries haha. It&#39;s just for simplicity."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1519812718, "post_id": 49025652, "comment_id": 85058406, "body": "You can simplify to: <code>int CheckDupe(int n) {     int j;     for (j = 0; j &lt; deckSize; j++) {       if (n == Deck[j].cardnum || n == 0) return 1;     }     return 0; }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1519809385, "creation_date": 1519809385, "answer_id": 49025848, "question_id": 49025652, "link": "https://stackoverflow.com/questions/49025652/how-can-i-load-a-deck-of-cards-based-on-these-instructions-c/49025848#49025848", "title": "How can I load a deck of cards based on these instructions? C", "body": "<blockquote>\n  <p><code>CheckDup</code> will receive the trial number and the deck of cards as input, and will return back a Boolean.</p>\n</blockquote>\n\n<p>which would translate to the following declaration </p>\n\n<pre><code>bool CheckDup( const int trial, const struct singlecard deck[], const unsigned int deckSize );\n</code></pre>\n\n<p>And should check the <code>deck</code> if the <code>trial</code> card do not exists yet ( probably <code>true</code> if a duplicate is found ), probably by iterating through the <code>deck</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519809963, "post_id": 49025935, "comment_id": 85056581, "body": "Currently checkDup already checks if a card has been dealt. I want to figure out a way to insert nonduplicate faces into the single card struct, with matching suits. (as only A,2,3..K to a suit). In my output, the face 7 spade is on card 30 and 26 at the bottom."}, {"owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "reply_to_user": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519810102, "post_id": 49025935, "comment_id": 85056666, "body": "Sorry didnt get what you want. Please.. if you could explain it again"}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519810739, "post_id": 49025935, "comment_id": 85057102, "body": "checkDup and LoadDeck currently load the deck with a unique card number but not a unique card face and suit. It just counts the number of A faces 2 faces 3 faces King faces etc. It also makes sure that there are 13 cards in each suit. I want to insert unique faces and suits into the stuct array so that I don&#39;t have say two 7 of spades."}, {"owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "reply_to_user": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519812381, "post_id": 49025935, "comment_id": 85058178, "body": "I thought you had a unique card number for each card in the deck. If that is the case, you simply have a one to one correspondence between cardnum  and face and suit. you can simply take modulus like such <code>deck[i].face=faces[deck[i].cardnum%13]</code>(as described in the comments on the question)."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519812554, "post_id": 49025935, "comment_id": 85058298, "body": "I do have a unique card number. I&#39;ll look into taking the modulus of the card number."}], "tags": [], "owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1519811861, "last_edit_date": 1519811861, "creation_date": 1519809673, "answer_id": 49025935, "question_id": 49025652, "link": "https://stackoverflow.com/questions/49025652/how-can-i-load-a-deck-of-cards-based-on-these-instructions-c/49025935#49025935", "title": "How can I load a deck of cards based on these instructions? C", "body": "<p>This is what I understood from your question. </p>\n\n<p><em>you want to find out, using <code>checkDup()</code> if that card has already been dealt</em></p>\n\n<p>you could maintain an array (or list whatever) of the card numbers that have been dealt. Then simply search through that array every time <code>checkDup</code> is called. </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519812988, "post_id": 49026936, "comment_id": 85058579, "body": "After checking the comments it seems like the only way to accomplish this with said instructions is to use the modulus operator and the cardnum. Thanks, Chris, I&#39;ll look into it."}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519813285, "post_id": 49026936, "comment_id": 85058784, "body": "Won&#39;t this make it so the suits are in order? For example, based on my output. Won&#39;t the next 13 cards always be the same suit?                                                                                            [6 3-H] [36 5-H] [32 6-H] [50 8-H]  4 [42 3-H] [4 J-H] [18 3-H] [40 5-H]  8"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519814140, "post_id": 49026936, "comment_id": 85059291, "body": "No because to get the suit, you divide the cardnum by 4 (after subtracting 1 from it)"}, {"owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "edited": false, "score": 0, "creation_date": 1519814353, "post_id": 49026936, "comment_id": 85059407, "body": "well... This is why I&#39;m still in college lol Thanks, Chris. I got it working. I can&#39;t upvote your answer tho. I&#39;m too much of a pleb."}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 2, "last_activity_date": 1519815514, "last_edit_date": 1519815514, "creation_date": 1519812733, "answer_id": 49026936, "question_id": 49025652, "link": "https://stackoverflow.com/questions/49025652/how-can-i-load-a-deck-of-cards-based-on-these-instructions-c/49026936#49026936", "title": "How can I load a deck of cards based on these instructions? C", "body": "<p>The problems you are facing is because you've not read and followed your homework instructions properly, notably this bit:</p>\n\n<blockquote>\n  <p>LoadFace() will go through the deck and put the appropriate value in\n  \"face\" of the array by using just the \"cardnum\" the modulus operator\n  to extract the value from the string \"A23456789TJQK.\"</p>\n</blockquote>\n\n<p>Imagine you've listed out each card in order like so with the card number.</p>\n\n<pre><code> 1. Ace of Hearts\n 2. Two of Hearts\n ....\n 14. Ace of Diamonds\n 15. Two of Diamonds\n</code></pre>\n\n<p>Do you notice a pattern? Every 13th card has the same face. The modulus operator (aka <code>%</code>) can be used to find out which of those 13 faces a specific value of <code>cardnum</code> relates to like this. <code>cardnum % 13</code> will always be between 0 and 12. Because your first card starts at 1, you need to subtract 1 first before doing getting modulus. Your <code>LoadFace</code> function then becomes this.</p>\n\n<pre><code>void LoadFace() {\n    for (i = 0; i &lt; deckSize;) {\n        Deck[i].face = faces[(Deck[i].cardnum-1) % 13];\n    }\n}\n</code></pre>\n\n<p>If you want to know if two cards have the same face based on their <code>cardnum</code> you can just compare <code>Deck[a].cardnum % 13</code> and <code>Deck[b].cardnum % 13</code>.</p>\n\n<p>So long as you don't put the same <code>cardnum</code> in twice, you know your deck will always contain unique cards.</p>\n"}], "owner": {"reputation": 11, "user_id": 9422760, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Tyler J Tucker", "link": "https://stackoverflow.com/users/9422760/tyler-j-tucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 49026936, "answer_count": 3, "score": -3, "last_activity_date": 1519815514, "creation_date": 1519808743, "last_edit_date": 1519815304, "question_id": 49025652, "link": "https://stackoverflow.com/questions/49025652/how-can-i-load-a-deck-of-cards-based-on-these-instructions-c", "title": "How can I load a deck of cards based on these instructions? C", "body": "<p><strong>These are the instructions my professor gave me for a Lab in C</strong></p>\n\n<p><strong>--SOLVED--</strong></p>\n\n<pre><code>struct singlecard\n{\n  int cardnum;\n  char face;\n  char suit;\n};\n</code></pre>\n\n<p>Your program must have the functions named as follows:</p>\n\n<p>Main() - Calls \"LoadDeck()\" and \"DealCards().\"</p>\n\n<p>LoadDeck() will fill just the \"cardnum\" of the array with a unique number between 1 and 52.  It will do this by selecting a random number and then calling the function \"CheckDup()\" to see if the number is a duplicate.  It will then call \"LoadFace()\" and \"LoadSuit().\"</p>\n\n<p>CheckDup() will receive the trial number and the deck of cards as input, and will return back a Boolean.</p>\n\n<p>LoadFace() will go through the deck and put the appropriate value in \"face\" of the array by using just the \"cardnum\" the modulus operator to extract the value from the string \"A23456789TJQK.\"</p>\n\n<p>LoadSuit() will go through the deck and put the appropriate suit value in \"suit\" by using a method similar to \"LoadFace()\" where the suit string is \"HDCS.\"</p>\n\n<p>DealCards() will display the cards.</p>\n\n<p>**My question is, how can I check that there are no duplicate faces in each suit without a ton of if statements? Please disregard the fact that I'm not sending the \"cardnum\" as a parameter to the functions LoadFace and LoadSuit, Also I'm using srand(1) for debugging purposes. So far the output has unique card number and the correct amount of faces and suits (13, 4), but I'm not sure how I can insert a nonduplicate element from here.Any advice would be helpful. Also, a simple assign and shuffle of an array isn't allowed :( **</p>\n\n<p><strong>EDIT checkDup and LoadDeck currently load the deck with a unique card number but not a unique card face and suit. It just counts the number of A faces 2 faces 3 faces King faces etc. It also makes sure that there are 13 cards in each suit. I want to insert unique faces and suits into the stuct array so that I don't have say two 7 of spades.</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n\nstruct singlecard {\n    int cardnum;\n    char face;\n    char suit;\n};\n\n\nint i, deckSize = 52;\nchar suits[] = {\"HDCS\"};\nchar faces[] = {\"A23456789TJQK\"};\n\n\nvoid DealCards(struct singlecard Deck[]) {\n\n    //SortCards();\n    printf(\"\\n\\n\");\n    for (i = 0; i &lt; deckSize; i++) {\n        if ((i + 1) % 4 == 0) {\n            printf(\"[%d %c-%c]  %d\\n\", Deck[i].cardnum, Deck[i].face, Deck[i].suit, i + 1);\n        } else {\n            printf(\"[%d %c-%c] \", Deck[i].cardnum, Deck[i].face, Deck[i].suit);\n        }\n    }\n\n}\n\nint CheckDupe(struct singlecard Deck[],int n) {\n\n    int check = 0, j;\n    for (j = 0; j &lt; deckSize; j++) {\n        if (n == Deck[j].cardnum || n == 0) {\n           return check = 1;\n        }\n\n    }\n    return check;\n\n}\n\nvoid LoadSuit(struct singlecard Deck[],int n) \n{  \n        Deck[i].suit = suits[(n-1) % 4];\n}\n\nvoid LoadFace(struct singlecard Deck[],int n) {\n\n        Deck[i].face = faces[(n-1) % 13];\n\n} \nvoid LoadDeck(struct singlecard Deck[]){\n\n    srand(time(NULL));\n\n    for (i = 0; i &lt; deckSize;) {\n        int random_number = rand() % 53;\n        if (CheckDupe(Deck,random_number) == 0) {\n\n            Deck[i].cardnum = random_number;\n            LoadFace(Deck,Deck[i].cardnum);\n            LoadSuit(Deck,Deck[i].cardnum);\n            i++;\n        }\n    }   \n}\n\nint main(){\n    struct singlecard Deck[52];\n    LoadDeck(Deck);\n    DealCards(Deck);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Current Output</strong></p>\n\n<pre><code>[5 5-H] [36 T-S] [6 6-D] [29 3-H]  4\n[12 Q-S] [19 6-C] [25 Q-H] [13 K-H]  8\n[42 3-D] [38 Q-D] [14 A-D] [22 9-D]  12\n[16 3-S] [40 A-S] [51 Q-C] [35 9-C]  16\n[24 J-S] [4 4-S] [20 7-S] [43 4-C]  20\n[31 5-C] [9 9-H] [11 J-C] [48 9-S]  24\n[49 T-H] [18 5-D] [41 2-H] [21 8-H]  28\n[50 J-D] [52 K-S] [3 3-C] [27 A-C]  32\n[39 K-C] [8 8-S] [33 7-H] [23 T-C]  36\n[44 5-S] [17 4-H] [32 6-S] [45 6-H]  40\n[30 4-D] [28 2-S] [2 2-D] [7 7-C]  44\n[26 K-D] [34 8-D] [15 2-C] [47 8-C]  48\n[10 T-D] [37 J-H] [1 A-H] [46 7-D]  52\n</code></pre>\n"}, {"tags": ["c", "linux", "serial-port", "baud-rate"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1519808343, "post_id": 49025424, "comment_id": 85055663, "body": "Have you checked that the UART hardware in your PC even supports that baudrate? Otherwise it is mission impossible."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1519809046, "post_id": 49025424, "comment_id": 85056037, "body": "I think that if you set your receiver&#39;s baudrate to the next higher baudrate and assuming the same modulation technique (and manchester encoding) is used, the receiver will be able to receive the lower baudrate due to the self-clocking nature of the Manchester encoding (see <a href=\"https://en.wikipedia.org/wiki/Self-clocking_signal\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Self-clocking_signal</a> and <a href=\"https://stackoverflow.com/questions/25834577/why-in-manchester-encoding-the-bit-rate-is-half-of-the-baud-rate\" title=\"why in manchester encoding the bit rate is half of the baud rate\">stackoverflow.com/questions/25834577/&hellip;</a>)"}, {"owner": {"reputation": 1, "user_id": 9422791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Landry Leblanc", "link": "https://stackoverflow.com/users/9422791/landry-leblanc"}, "edited": false, "score": 0, "creation_date": 1519809608, "post_id": 49025424, "comment_id": 85056381, "body": "I&#39;ve tried with a baudrate of 921600 and it didn&#39;t work properly... I think this baudrate is just a crazy thing !"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1519810134, "post_id": 49025424, "comment_id": 85056687, "body": "@PaulOgilvie Plain old UART is neither Manchester encoded nor self-clocking. The baud rate setting must match (to within some <a href=\"https://www.allaboutcircuits.com/technical-articles/the-uart-baud-rate-clock-how-accurate-does-it-need-to-be/\" rel=\"nofollow noreferrer\">margin of error, say 3%</a>) on both ends."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519821141, "post_id": 49025424, "comment_id": 85063509, "body": "What was the result with <code>options.c_ispeed = options.c_ospeed = 875000;</code> instead of <code>int speed = atoi(&quot;115200&quot;); ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519917241, "post_id": 49030522, "comment_id": 85109987, "body": "Good that you have found a solution, yet to make this a good answer, post the relevant data here, not only a link."}], "tags": [], "owner": {"reputation": 1, "user_id": 9422791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Landry Leblanc", "link": "https://stackoverflow.com/users/9422791/landry-leblanc"}, "is_accepted": true, "score": -1, "last_activity_date": 1520238672, "last_edit_date": 1520238672, "creation_date": 1519823813, "answer_id": 49030522, "question_id": 49025424, "link": "https://stackoverflow.com/questions/49025424/uncommon-baud-rate-on-serial-port-linux/49030522#49030522", "title": "Uncommon baud rate on serial port - Linux", "body": "<p>Finally i've found another topic on stackoverflow wich is complete and solve my problem :  <a href=\"https://stackoverflow.com/questions/4968529/how-to-set-baud-rate-to-307200-on-linux/7152671#7152671\">How to set baud rate to 307200 on Linux?</a></p>\n\n<p>Here is my code with the modification :</p>\n\n<pre><code>static int rate_to_constant(int baudrate) {\n#define B(x) case x: return B##x\nswitch(baudrate) {\n    B(50);     B(75);     B(110);    B(134);    B(150);\n    B(200);    B(300);    B(600);    B(1200);   B(1800);\n    B(2400);   B(4800);   B(9600);   B(19200);  B(38400);\n    B(57600);  B(115200); B(230400); B(460800); B(500000); \n    B(576000); B(921600); B(1000000);B(1152000);B(1500000);\n    B(2000000);B(2500000);B(3000000);B(3500000);B(4000000); \ndefault: return 0;\n}\n#undef B\n}    \n\n\nint Custom_Baudrate(const char* Device, int rate)\n  {\n\n/*Declaration of all the variables needed*/\nstruct termios2 options;\nstruct serial_struct serinfo;\nint file=-1;\nint speed = 0;\nint r=rate;\n\n\n\n/* Open and configure serial port */\nfile = open(Device,O_RDWR|O_NOCTTY);\n\nif(file==-1){printf(\"\\nERROR : Unable to open the serial port\\n\\n\");return 1;}\n\nspeed = rate_to_constant(r);\n\n\n\n/*Find best Baudrate*/\nif (speed == 0) {\n\n    /* Custom divisor */\n    serinfo.reserved_char[0] = 0;\n    if (ioctl(file, TIOCGSERIAL, &amp;serinfo) &lt; 0) file=-1;\n    serinfo.flags &amp;= ~ASYNC_SPD_MASK;\n    serinfo.flags |= ASYNC_SPD_CUST;\n\n    serinfo.custom_divisor = ((serinfo.baud_base + (r / 2)) / r);\n\n    if (serinfo.custom_divisor &lt; 1) \n        serinfo.custom_divisor = 1;\n    if (ioctl(file, TIOCSSERIAL, &amp;serinfo) &lt; 0) file=-1;\n    if (ioctl(file, TIOCGSERIAL, &amp;serinfo) &lt; 0) file=-1;\n    if (serinfo.custom_divisor * r != serinfo.baud_base) {\n        warnx(\"actual baudrate is %d / %d = %f\",\n              serinfo.baud_base, serinfo.custom_divisor,\n              (float)\n              serinfo.baud_base / serinfo.custom_divisor);\n    }\n}\n\n\n\n/*Set the best Baudrate (if desired baudrate is unvailable, it's set automatically at 38400)*/\nfcntl(file, F_SETFL, 0);\ntcgetattr(file, &amp;options);\ncfsetispeed(&amp;options, speed ?: B38400);\ncfsetospeed(&amp;options, speed ?: B38400);\ncfmakeraw(&amp;options);\noptions.c_cflag |= (CLOCAL | CREAD);\noptions.c_cflag &amp;= ~CRTSCTS;\nif (tcsetattr(file, TCSANOW, &amp;options) != 0) file=-1;\n\n\n/*Read the serial port*/\ncommunicate_Serial_Port(file);\n\nclose(file);\nreturn 1;\n}\n</code></pre>\n\n<p>In this code you just have to precise wich baudrate you want and it find the nearest value that you can use. This value is based on the \"base baudrate\" of your device and it search a divisor to set the best baudrate. However, some baudrate should always being unavailable so this program will put the 38400 as a base (it's a choice).\nI've test it with several baudrate and it always work.</p>\n\n<p>I'm new on stackoverflow, i hope this post will complete correctly the question.</p>\n"}], "owner": {"reputation": 1, "user_id": 9422791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Landry Leblanc", "link": "https://stackoverflow.com/users/9422791/landry-leblanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2697, "favorite_count": 0, "accepted_answer_id": 49030522, "answer_count": 1, "score": 0, "last_activity_date": 1520238672, "creation_date": 1519807982, "last_edit_date": 1519916833, "question_id": 49025424, "link": "https://stackoverflow.com/questions/49025424/uncommon-baud-rate-on-serial-port-linux", "title": "Uncommon baud rate on serial port - Linux", "body": "<p>I'm currently trying to make a programm to read a serial port. On this port I receive data with a baud rate of 875000. It's really uncommon and I don't succeed to modified it. I've make a little C programm to do that but it didn't work with 875000... Here some part of the code with the programmation of the serial port : </p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;asm/termios.h&gt;\n    #include &lt;sys/fcntl.h&gt;\n    #include &lt;unistd.h&gt;\n    #include &lt;errno.h&gt;\n    #include &lt;string.h&gt;\n    #include \"test.h\"\n\n    void read_Serial_Port(const char* DEVICE_PORT)\n    {\n        int file;\n        struct ktermios options;\n        unsigned int nCountMax = 60;\n        bool b;\n\n        file = open(DEVICE_PORT, O_RDONLY | O_NOCTTY | O_NDELAY);\n\n        if(file == -1){perror(\"Unable to open the serial port\\n\");}\n        //printf(\"Serial port open successful !\\n\");\n        int speed = atoi(\"875000\");\n\n        ioctl(file, TCGETS2, &amp;options);     \n\n\n        options.c_ispeed = speed;\n        options.c_ospeed = speed;\n\n        options.c_cflag |= (CLOCAL | CREAD);              \n        options.c_cflag |= PARENB;                  \n        options.c_cflag |= PARODD; \n        options.c_cflag &amp;= ~CBAUD;\n\n        options.c_cflag |= BOTHER;                                          \n        options.c_cflag &amp;= ~CSIZE;                      \n        options.c_cflag |= CS8;     \n\n        ioctl(file, TCSETS2, &amp;options); \n\n\n        //printf(\"Reading serial port ...\\n\\n\"); \n        b = readMessage(file, nCountMax);\n\n        if (b == 0){printf(\"Error while reading serial port\\n\");}\n        //else printf(\"\\nSerial port read successful\\n\");\n\n        close(file);\n        //printf(\"Serial port closed\\n\");\n    };\n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1519806792, "creation_date": 1519806792, "answer_id": 49025120, "question_id": 49024790, "link": "https://stackoverflow.com/questions/49024790/how-to-open-eclipse-console-output-in-command-prompt/49025120#49025120", "title": "how to open eclipse console output in command prompt", "body": "<p>This is what I Understood from your question.</p>\n\n<p><em>You want to open the output of your c program in command prompt</em></p>\n\n<p>It's pretty simple. Just go the directory in which your executable is stored and run the .exe file</p>\n\n<pre><code>&lt;path&gt;filename.exe\n</code></pre>\n\n<hr>\n\n<p>If however you want to start eclipse from cmd you would have to add the <code>bin</code> folder to the <code>PATH</code> environment variable.</p>\n"}], "owner": {"reputation": 1, "user_id": 9370058, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aSorJP4ULCo/AAAAAAAAAAI/AAAAAAAAGJ0/zSw2szvO44E/photo.jpg?sz=128", "display_name": "Siddharth Lavate", "link": "https://stackoverflow.com/users/9370058/siddharth-lavate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519806792, "creation_date": 1519805581, "question_id": 49024790, "link": "https://stackoverflow.com/questions/49024790/how-to-open-eclipse-console-output-in-command-prompt", "title": "how to open eclipse console output in command prompt", "body": "<p>I am using eclipse oxygen IDE to practice c programming. I found that eclipse console window is not functioning as I want so! is there any way to open the output directly in command prompt window instead of inbuilt eclipse console.</p>\n"}, {"tags": ["c", "printf"], "answers": [{"comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1519814813, "post_id": 49025101, "comment_id": 85059689, "body": "C++ has raw string literal which makes life a bit easier. Unfortunately <a href=\"https://stackoverflow.com/q/24850244/995714\">C doesn&#39;t support it</a>"}, {"owner": {"reputation": 63, "user_id": 9419968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac3030dc2d3ec808a1ea6ff87ad70ed?s=128&d=identicon&r=PG&f=1", "display_name": "WhoKnows", "link": "https://stackoverflow.com/users/9419968/whoknows"}, "edited": false, "score": 0, "creation_date": 1519820029, "post_id": 49025101, "comment_id": 85062773, "body": "Thanks m8! I&#39;ll try it rn. <b>Edit</b>: It worked! Thanks, I&#39;ll keep that in mind for later"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1519836208, "post_id": 49025101, "comment_id": 85073769, "body": "Using <code>fputs(&quot;\u2026&quot;, stdout)</code> doesn&#39;t add the newline that <code>puts(&quot;\u2026&quot;)</code> does."}], "tags": [], "owner": {"reputation": 220, "user_id": 2565702, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/34f558b5702e999d9a0e08bc01232459?s=128&d=identicon&r=PG", "display_name": "jester", "link": "https://stackoverflow.com/users/2565702/jester"}, "is_accepted": true, "score": 5, "last_activity_date": 1519813814, "last_edit_date": 1519813814, "creation_date": 1519806731, "answer_id": 49025101, "question_id": 49024728, "link": "https://stackoverflow.com/questions/49024728/error-with-printf-c/49025101#49025101", "title": "Error with printf C", "body": "<p>In C strings, you need to double <code>\\</code> (i.e. <code>\"\\\\\"</code>) to represent one <code>'\\'</code>.</p>\n\n<p>So you could write your code as:</p>\n\n<pre><code>void pprint(){\n\n    int bs[6];\n    bs[0] = 7;\n    bs[1] = 1;\n    bs[2] = 2;\n    bs[3] = 3;\n    bs[4] = 4;\n    bs[5] = 5;\n    bs[6] = 6;\n\n    printf (\"(1)--------------------------------------------4T------5I        6P------7T-------------------------------------------(2)\\n\");\n    printf (\"[%i]                                           [%i]     [%i]       [%i]     [%i]                                           [%i]\\n\", bs[1], bs[4], bs[5], bs[6], bs[0], bs[2]);\n    printf (\" \\\\                                             |        \\\\       /        |                                             / \\n\");\n    printf (\"  \\\\                                            |         \\\\     /         |                                            /  \\n\");\n    printf (\"   \\\\                                           8T         \\\\ 9T/         10T                                          /   \\n\");\n    printf (\"    \\\\                                         [ ]----------[ ]----------[ ]                                         /    \\n\");\n    printf (\"     \\\\                                         |            |            |                                         /     \\n\");\n    printf (\"      \\\\                                        |            |            |                                        /      \\n\");\n    printf (\"      11P                                     12I          13I          14I                                     15P      \\n\");\n    printf (\"      [ ]-------------------------------------[ ]----------[ ]----------[ ]-------------------------------------[ ]      \\n\");\n    printf (\"        \\\\                                      \\\\            |            /                                      /        \\n\");\n    printf (\"         \\\\                                      16T        17I        18T                                      /         \\n\");\n    printf (\"          \\\\                                     [ ]--------[ ]--------[ ]                                     /          \\n\");\n    printf (\"           \\\\                                     \\\\          |          /                                     /           \\n\");\n    printf (\"           19M                                    20R      21P      22R                                    23M           \\n\");\n    printf (\"           [ ]------------------------------------[ ]------[ ]------[ ]------------------------------------[ ]           \\n\");\n    printf (\"             \\\\                                      \\\\               /                                      /             \\n\");\n    printf (\"              24P                                    25I   26I   27I                                    28I              \\n\");\n    printf (\"              [ ]                                    [ ]---[ ]---[ ]                                    [ ]              \\n\");\n    printf (\"                \\\\                                      \\\\    |    /                                      /                \\n\");\n    printf (\"                29I                                    30T 31P 32T                                    33I                \\n\");\n    printf (\"                [ ]------------------------------------[ ]-[ ]-[ ]------------------------------------[ ]                \\n\");\n    printf (\"                  \\\\                                       \\\\ | /                                       /                  \\n\");\n    printf (\"                   ----------------------------------------(3)----------------------------------------                   \\n\");\n    printf (\"                                                           [ ]                                                           \\n\");\n}\n</code></pre>\n\n<p>Note that where there are no replacements (using <code>%</code>), you should probably prefer <code>puts()</code> to <code>printf()</code> - but note that <code>puts()</code> includes its own final newline.</p>\n"}], "owner": {"reputation": 63, "user_id": 9419968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac3030dc2d3ec808a1ea6ff87ad70ed?s=128&d=identicon&r=PG&f=1", "display_name": "WhoKnows", "link": "https://stackoverflow.com/users/9419968/whoknows"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 49025101, "answer_count": 1, "score": -1, "last_activity_date": 1519813835, "creation_date": 1519805325, "last_edit_date": 1519813835, "question_id": 49024728, "link": "https://stackoverflow.com/questions/49024728/error-with-printf-c", "title": "Error with printf C", "body": "<p>So I've got this code in C that should print the map shown below.</p>\n\n<pre><code>printf (\"(1)--------------------------------------------4T------5I        6P------7T-------------------------------------------(2)\\n\");\nprintf (\"[%i]                                           [%i]     [%i]       [%i]     [%i]                                           [%i]\\n\", bs[1].leader, bs[4].leader, bs[5].leader, bs[6].leader, bs[7].leader, bs[2].leader);\nprintf (\" \\                                             |        \\       /        |                                             / \\n\");\nprintf (\"  \\                                            |         \\     /         |                                            /  \\n\");\nprintf (\"   \\                                           8T         \\ 9T/         10T                                          /   \\n\");\nprintf (\"    \\                                         [ ]----------[ ]----------[ ]                                         /    \\n\");\nprintf (\"     \\                                         |            |            |                                         /     \\n\");\nprintf (\"      \\                                        |            |            |                                        /      \\n\");\nprintf (\"      11P                                     12I          13I          14I                                     15P      \\n\");\nprintf (\"      [ ]-------------------------------------[ ]----------[ ]----------[ ]-------------------------------------[ ]      \\n\");\nprintf (\"        \\                                      \\            |            /                                      /        \\n\");\nprintf (\"         \\                                      16T        17I        18T                                      /         \\n\");\nprintf (\"          \\                                     [ ]--------[ ]--------[ ]                                     /          \\n\");\nprintf (\"           \\                                     \\          |          /                                     /           \\n\");\nprintf (\"           19M                                    20R      21P      22R                                    23M           \\n\");\nprintf (\"           [ ]------------------------------------[ ]------[ ]------[ ]------------------------------------[ ]           \\n\");\nprintf (\"             \\                                      \\               /                                      /             \\n\");\nprintf (\"              24P                                    25I   26I   27I                                    28I              \\n\");\nprintf (\"              [ ]                                    [ ]---[ ]---[ ]                                    [ ]              \\n\");\nprintf (\"                \\                                      \\    |    /                                      /                \\n\");\nprintf (\"                29I                                    30T 31P 32T                                    33I                \\n\");\nprintf (\"                [ ]------------------------------------[ ]-[ ]-[ ]------------------------------------[ ]                \\n\");\nprintf (\"                  \\                                       \\ | /                                       /                  \\n\");\nprintf (\"                   ----------------------------------------(3)----------------------------------------                   \\n\");\nprintf (\"                                                           [ ]                                                           \\n\");\n</code></pre>\n\n<p>Problem is, it doesn't print that. It skips lots of characters. Any ideas?</p>\n"}, {"tags": ["c", "dll"], "comments": [{"owner": {"reputation": 647, "user_id": 7923571, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4e62d182c335f07c1f883e5b8809e740?s=128&d=identicon&r=PG&f=1", "display_name": "Ferus7", "link": "https://stackoverflow.com/users/7923571/ferus7"}, "edited": false, "score": 1, "creation_date": 1519803448, "post_id": 49024185, "comment_id": 85053099, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1503943/how-to-decompile-a-dll-file-created-in-vs-net\">How to decompile a .dll file created in VS.net</a>   ||  <a href=\"https://stackoverflow.com/questions/41039254/is-there-any-way-to-convert-dll-file-to-cs-files\">Is there any way to convert .dll file to .cs files</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1519803676, "post_id": 49024185, "comment_id": 85053222, "body": "C or C#? Forget it for C. For c# it&#39;s possible, although variable names and/or function names will be gone, google &quot;c# decompiler&quot;. <i>&quot;but it didn&#39;t help&quot;</i>. How?"}, {"owner": {"reputation": 513, "user_id": 4632482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf9b25891575e11815e02ba7880b00e?s=128&d=identicon&r=PG", "display_name": "Peter Bruins", "link": "https://stackoverflow.com/users/4632482/peter-bruins"}, "edited": false, "score": 1, "creation_date": 1519803765, "post_id": 49024185, "comment_id": 85053267, "body": "<code>git checkout</code> ?"}, {"owner": {"reputation": 292, "user_id": 7440673, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AOzXH.jpg?s=128&g=1", "display_name": "Bakhtiyar Bekbergen", "link": "https://stackoverflow.com/users/7440673/bakhtiyar-bekbergen"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519804352, "post_id": 49024185, "comment_id": 85053516, "body": "@MichaelWalz code was written in the C"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1519805051, "post_id": 49024185, "comment_id": 85053858, "body": "If your code was written in C, forget decompiling and count your losses. You need to rewrite your code. Reflector can only decompile c# code."}], "answers": [{"comments": [{"owner": {"reputation": 292, "user_id": 7440673, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AOzXH.jpg?s=128&g=1", "display_name": "Bakhtiyar Bekbergen", "link": "https://stackoverflow.com/users/7440673/bakhtiyar-bekbergen"}, "reply_to_user": {"reputation": 2841, "user_id": 1384352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2611319a9386b31b758e869f9f59af?s=128&d=identicon&r=PG", "display_name": "Scovetta", "link": "https://stackoverflow.com/users/1384352/scovetta"}, "edited": false, "score": 0, "creation_date": 1519804544, "post_id": 49024279, "comment_id": 85053615, "body": "@Scovetta on C language"}, {"owner": {"reputation": 2841, "user_id": 1384352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e2611319a9386b31b758e869f9f59af?s=128&d=identicon&r=PG", "display_name": "Scovetta", "link": "https://stackoverflow.com/users/1384352/scovetta"}, "edited": false, "score": 1, "creation_date": 1519804676, "post_id": 49024279, "comment_id": 85053677, "body": "Best you can get back to is assembly. There are some decompilers that claim to get back to C but I\u2019ve never seen one produce anything legible. It\u2019s been a while though. Maybe give this a shot: <a href=\"https://derevenets.com\" rel=\"nofollow noreferrer\">derevenets.com</a>"}], "tags": [], "owner": {"reputation": 502, "user_id": 1532822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8cce83aadf2b0791824f9985f95ba5c?s=128&d=identicon&r=PG", "display_name": "Sudeep Reddy", "link": "https://stackoverflow.com/users/1532822/sudeep-reddy"}, "is_accepted": false, "score": 3, "last_activity_date": 1519803596, "creation_date": 1519803596, "answer_id": 49024279, "question_id": 49024185, "link": "https://stackoverflow.com/questions/49024185/convert-dll-file-to-source-code/49024279#49024279", "title": "Convert dll file to source code", "body": "<p>It's tough to get back your original source code from the DLL. You can try some decompiler tools to see if it works</p>\n\n<p><a href=\"https://www.jetbrains.com/decompiler/\" rel=\"nofollow noreferrer\">https://www.jetbrains.com/decompiler/</a></p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 9412510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VoDuX.png?s=128&g=1", "display_name": "Koenig", "link": "https://stackoverflow.com/users/9412510/koenig"}, "is_accepted": false, "score": 1, "last_activity_date": 1519804004, "creation_date": 1519804004, "answer_id": 49024386, "question_id": 49024185, "link": "https://stackoverflow.com/questions/49024185/convert-dll-file-to-source-code/49024386#49024386", "title": "Convert dll file to source code", "body": "<p>What you want to do is like separating the ingredients of a backed cake. You can separate some components, but not in the original quality. The DLL is not your source code - it's a product of your source code. Like the cake. Sorry. </p>\n"}], "owner": {"reputation": 292, "user_id": 7440673, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AOzXH.jpg?s=128&g=1", "display_name": "Bakhtiyar Bekbergen", "link": "https://stackoverflow.com/users/7440673/bakhtiyar-bekbergen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7688, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1519822587, "creation_date": 1519803263, "last_edit_date": 1519822587, "question_id": 49024185, "link": "https://stackoverflow.com/questions/49024185/convert-dll-file-to-source-code", "title": "Convert dll file to source code", "body": "<p>Half year ago I reinstalled operation system and unfortunately deleted source code which I converted to dll, and now I have only dll file and don't know how to convert it to source code, I tried to use reflector but it didn't help? Can anyone help me please?</p>\n\n<p><strong>UPD</strong></p>\n\n<p><em>is not a .NET module.</em> my main problem is here, when I trying to usr .Net reflector, and this error message when I add my dll to my programm 1C </p>\n\n<p>and reflector in my case doesn't work</p>\n\n<p><strong>system.type system.runtime.interopservices.marshal.gettypefromclsid</strong></p>\n"}, {"tags": ["c", "macos", "header-files", "libc"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1519803389, "post_id": 49023864, "comment_id": 85053075, "body": "<a href=\"https://stackoverflow.com/questions/2114896/why-are-strlcpy-and-strlcat-considered-insecure\">Why are strlcpy and strlcat considered insecure?</a>, in particular this answer: <a href=\"https://stackoverflow.com/a/2115015/584518\">stackoverflow.com/a/2115015/584518</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1519804174, "post_id": 49023864, "comment_id": 85053430, "body": "And of course <code>strcpy</code> is perfectly safe. People claiming otherwise have been brainwashed. Like with every other C function, library or user-defined, you have to know what the function does in order to use it."}], "answers": [{"comments": [{"owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 0, "creation_date": 1519804289, "post_id": 49023974, "comment_id": 85053488, "body": "I understand that OS X is based on BSD under the covers, so I&#39;m happy to accept the answer. But I note that OSX is /NOT BSD/, and absent a header file with the macro declarations for SUSv3 or DARWIN, there is no assurance that any particular BSD function is supported by any particular version of any Mac OS."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 0, "creation_date": 1519804397, "post_id": 49023974, "comment_id": 85053539, "body": "That&#39;s what I got from <code>man strlcpy</code> on a Mac running macOS High Sierra 10.13.3.  I haven&#39;t gone back in time to check, but I&#39;m tolerably certain that <code>strlcpy()</code> will be available on an macOS or on any Mac OS X that people are still running."}, {"owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "edited": false, "score": 0, "creation_date": 1519809267, "post_id": 49023974, "comment_id": 85056181, "body": "Sorry, got it now."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1519804478, "last_edit_date": 1519804478, "creation_date": 1519802391, "answer_id": 49023974, "question_id": 49023864, "link": "https://stackoverflow.com/questions/49023864/which-libc-strcpy-strlcpy-strncpy-should-i-use-on-mac-os-x/49023974#49023974", "title": "Which libc strcpy/strlcpy/strncpy should I use on Mac OS X?", "body": "<p>An extract from <code>man strlcpy</code> on a Mac running macOS High Sierra 10.13.3.</p>\n\n<blockquote>\n  <p>STRLCPY(3) \u2014 BSD Library Functions Manual \u2014 STRLCPY(3)</p>\n  \n  <p>NAME</p>\n  \n  <p>strlcpy, strlcat -- size-bounded string copying and concatenation</p>\n  \n  <p>LIBRARY</p>\n  \n  <p>Standard C Library (libc, -lc)</p>\n  \n  <p>SYNOPSIS</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nsize_t strlcpy(char * restrict dst, const char * restrict src, size_t dstsize);\n\nsize_t strlcat(char * restrict dst, const char * restrict src, size_t dstsize);\n</code></pre>\n  \n  <p>DESCRIPTION</p>\n  \n  <p>The strlcpy() and strlcat() functions copy and concatenate strings with the same input parameters and output result as snprintf(3).  They are designed to be safer, more consistent, and less error prone replacements for the easily misused functions strncpy(3) and strncat(3).</p>\n  \n  <p>strlcpy() and strlcat() take the full size of the destination buffer and guarantee NUL-termination if there is room.  Note that room for the NUL should be included in dstsize.</p>\n  \n  <p>strlcpy() copies up to dstsize - 1 characters from the string src to dst, NUL-terminating the\n       result if dstsize is not 0.</p>\n  \n  <p>strlcat() appends string src to the end of dst.  It will append at most dstsize - strlen(dst)\n       - 1 characters.  It will then NUL-terminate, unless dstsize is 0 or the original dst string\n       was longer than dstsize (in practice this should not happen as it means that either dstsize is\n       incorrect or that dst is not a proper string).</p>\n  \n  <p>If the src and dst strings overlap, the behavior is undefined.</p>\n</blockquote>\n"}], "owner": {"reputation": 1937, "user_id": 1335492, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2bb7485134a4957636621aa28e6f9fae?s=128&d=identicon&r=PG", "display_name": "david", "link": "https://stackoverflow.com/users/1335492/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 49023974, "answer_count": 1, "score": 0, "last_activity_date": 1519810309, "creation_date": 1519801929, "last_edit_date": 1519810309, "question_id": 49023864, "link": "https://stackoverflow.com/questions/49023864/which-libc-strcpy-strlcpy-strncpy-should-i-use-on-mac-os-x", "title": "Which libc strcpy/strlcpy/strncpy should I use on Mac OS X?", "body": "<p>I don't have an OS X development environment. I don't have the OS X header files.  I'm having to guess some of my library calls. At this point, one of the things I would like to use is <code>strlcpy()</code>.</p>\n\n<ol>\n<li><p>Is <code>strlcpy()</code> part of libc on OS X?</p></li>\n<li><p>If so, what is the declaration, or where on the web is a copy of the header file?</p></li>\n<li><p>If not, is it a part of a system library on OS X?</p></li>\n<li><p>If not, is there another \"safe\" <code>strcpy()</code> that is available on OS X?</p></li>\n</ol>\n"}, {"tags": ["c", "arrays", "array-sum"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1519801035, "post_id": 49023583, "comment_id": 85051959, "body": "Not sure what you&#39;re not sure of, but one thing <i>is</i> sure: since <code>temp</code> is never initialized nor assigned any determinate value, you can bank on the caller getting nothing but indeterminate garbage from that <code>return temp;</code>"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1519801083, "post_id": 49023583, "comment_id": 85051982, "body": "What&#39;s the problem with the code? Are you asking for someone to design and write the algorithm for you? Or do you have a specific question that I&#39;m missing?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1519801235, "post_id": 49023583, "comment_id": 85052056, "body": "You shouldn&#39;t need <code>temp</code> for any of this. Just move <code>sum</code> outside of both loops, assign it the first qualified value from the arrays, then run the loops and only reset <code>sum</code> to a lower value if <code>ar1[i] + ar2[j]</code> is less than the current value of <code>sum</code>. In the end, return <code>sum</code>. Not very complexity efficient, but it will work."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 3, "creation_date": 1519801283, "post_id": 49023583, "comment_id": 85052076, "body": "Consider that the minimum sum will be the sum of the minima, unless they have the same index. In that case, your two options become the sum of the minimum of one array and second smallest element of the other. This is an O(n) algorithm, not O(n^2)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1519801308, "post_id": 49023583, "comment_id": 85052086, "body": "Can you <i>quickly</i> find the minimal sum ignoring the different indices restriction? Can you find the <i>second smallest</i> sum just as quickly? The nested loop solution is too slow."}], "answers": [{"comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1519806465, "post_id": 49024540, "comment_id": 85054593, "body": "<code>ar[1]</code> seems to be a typo and should be <code>ar1[i]</code>, <code>ar2[1]</code> should be <code>ar2[i]</code>. Your code ignores the requirement, that the indexes should not be equal."}], "tags": [], "owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "is_accepted": false, "score": 0, "last_activity_date": 1519805777, "last_edit_date": 1519805777, "creation_date": 1519804595, "answer_id": 49024540, "question_id": 49023583, "link": "https://stackoverflow.com/questions/49023583/minimum-sum-of-two-elements-from-two-arrays-such-that-indices-are-not-same/49024540#49024540", "title": "Minimum sum of two elements from two arrays such that indices are not same", "body": "<p>The minimal sum of 2 elements from 2 arrays is the sum of its minimum elements.</p>\n\n<p>But, what happens when any of the arrays is 0 size...? The formulation of the question is undefined in this regard.</p>\n\n<p>The following worst-case time complexity is O(N) and worst-case space complexity is O(1):</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\nint twinArrays(int ar1_size, int* ar1, int ar2_size, int* ar2)\n{\n    int min1 = INT_MAX, min2 = INT_MAX;\n\n    for(int i = 0; i &lt; ar1_size; i++)\n        min1 = ar1[i] &lt; min1? ar[1]: min1;\n\n    for(int i = 0; i &lt; ar2_size; i++)\n        min2 = ar2[i] &lt; min2? ar2[1]: min2;\n\n    if (min1 &gt; 0 &amp;&amp; min2 &gt; INT_MAX - min1) {\n        /* handle overflow */\n        return INT_MAX;\n    } else if (min1 &lt; 0 &amp;&amp; min2 &lt; INT_MIN - min1) {\n        /* handle underflow */\n        return INT_MIN;\n    }\n    return min1 + min2;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 8627642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1490295051044337/picture?type=large", "display_name": "Saransh Choudhary", "link": "https://stackoverflow.com/users/8627642/saransh-choudhary"}, "edited": false, "score": 0, "creation_date": 1519881871, "post_id": 49025660, "comment_id": 85091273, "body": "What is the variable INT_MAX used for?"}, {"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "reply_to_user": {"reputation": 29, "user_id": 8627642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1490295051044337/picture?type=large", "display_name": "Saransh Choudhary", "link": "https://stackoverflow.com/users/8627642/saransh-choudhary"}, "edited": false, "score": 0, "creation_date": 1519892309, "post_id": 49025660, "comment_id": 85095234, "body": "<code>INT_MAX</code> is the maximun value that can be represented by an <code>int</code>, if another value was set, we would have the risk that the sum be bigger than the put value."}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1519808768, "creation_date": 1519808768, "answer_id": 49025660, "question_id": 49023583, "link": "https://stackoverflow.com/questions/49023583/minimum-sum-of-two-elements-from-two-arrays-such-that-indices-are-not-same/49025660#49025660", "title": "Minimum sum of two elements from two arrays such that indices are not same", "body": "<p>Your code was not so far of one solution, but: </p>\n\n<ul>\n<li><code>temp</code> should have been initialized to value big enough to be under the wanted result,</li>\n<li>when <code>i != j</code>, you should have compared <code>sum</code> to <code>temp</code> to store the result if <code>sum</code> was under <code>temp</code>,</li>\n<li><code>return</code> was miss placed.</li>\n</ul>\n\n<p>So your corrected code could looks like: </p>\n\n<pre><code>#include &lt;limits.h&gt;\n\nint twinArrays(int ar1_size, int* ar1, int ar2_size, int* ar2)\n{\n    int sum_min = INT_MAX;\n\n    /* for each element in ar1 */\n    for (int i = 0; i &lt; ar1_size; i++)\n    {\n\n        /* for each element in ar2 */\n        for (int j = 0; j &lt; ar2_size; t++)\n        {\n            /* go to next j if indices are the same */\n            if (i != j)\n            {\n                /* compute sum */\n                int sum = ar1[i] + ar2[j];\n\n                /* compare to best */\n                if (sum &lt; sum_min)\n                {\n                    /* remember the best */\n                    sum_min = sum;\n                }\n            }\n        }        \n    }\n\n    return sum_min;   \n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8627642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1490295051044337/picture?type=large", "display_name": "Saransh Choudhary", "link": "https://stackoverflow.com/users/8627642/saransh-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1519808768, "creation_date": 1519800784, "last_edit_date": 1519808234, "question_id": 49023583, "link": "https://stackoverflow.com/questions/49023583/minimum-sum-of-two-elements-from-two-arrays-such-that-indices-are-not-same", "title": "Minimum sum of two elements from two arrays such that indices are not same", "body": "<p>Given two arrays <code>ar1</code> and <code>ar2</code>, how can we find sum of two elements from two arrays such that indices are not same and their sum is minimum?  </p>\n\n<p>However, I have written the following, but I am not sure regarding storing the sum in a temporary variable and comparing the sum with the sum in the immediately next pass: </p>\n\n<pre><code>int twinArrays(int ar1_size, int* ar1, int ar2_size, int* ar2)\n{\n    int temp;\n    for(int i = 0; i &lt; ar1_size;i++) \n    {\n        for(int j=0; j &lt; ar2_size; j++) {\n            int sum=0;\n            if( i != j) \n                sum = ar1[i] + ar2[j];\n            }\n        }      \n        return temp;\n    }\n}\n</code></pre>\n\n<p>Suggestions in C would be helpful.</p>\n"}, {"tags": ["c", "time.h"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 8, "creation_date": 1519799829, "post_id": 49023356, "comment_id": 85051446, "body": "Research <code>strftime()</code> or just <code>sprintf(buffer, &quot;%02d:%02d:%02d&quot;...</code>"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 0, "creation_date": 1519799953, "post_id": 49023356, "comment_id": 85051493, "body": "<a href=\"http://www.cplusplus.com/reference/ctime/strftime/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/ctime/strftime</a>"}, {"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "edited": false, "score": 0, "creation_date": 1519803999, "post_id": 49023356, "comment_id": 85053363, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/1442116/how-to-get-date-and-time-value-in-c-program\" title=\"how to get date and time value in c program\">stackoverflow.com/questions/1442116/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1520074936, "post_id": 49024088, "comment_id": 85171981, "body": "Just doing <code>..., localtime(time(NULL));</code> would be even simpler."}, {"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1588618662, "post_id": 49024088, "comment_id": 108963076, "body": "@alk It would be if it worked.  But it doesn&#39;t  Nice job!"}], "tags": [], "owner": {"reputation": 26, "user_id": 5454656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YXK1o.jpg?s=128&g=1", "display_name": "June", "link": "https://stackoverflow.com/users/5454656/june"}, "is_accepted": true, "score": 1, "last_activity_date": 1519802869, "creation_date": 1519802869, "answer_id": 49024088, "question_id": 49023356, "link": "https://stackoverflow.com/questions/49023356/how-to-get-time-from-date-time/49024088#49024088", "title": "How to get time from date time", "body": "<p>try the following:</p>\n\n<pre><code>`\nstruct timeval cur_time;\ngettimeofday(&amp;cur_time, NULL);\nchar dateTime[10 + 1] = {0};\n\nstrftime(dateTime, 10, \"%H%M%S\", localtime(&amp;cur_time.tv_sec));\n`\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 49024088, "answer_count": 1, "score": 0, "last_activity_date": 1519802869, "creation_date": 1519799799, "question_id": 49023356, "link": "https://stackoverflow.com/questions/49023356/how-to-get-time-from-date-time", "title": "How to get time from date time", "body": "<p>Is there a function like ctime that will get just the hours, minutes, and seconds as a char*?</p>\n\n<p>I've tried </p>\n\n<pre><code>time_t time\nstruct tm* currtime = localtime(time);\nprintf(\"%d:%d:%d\", currtime-&gt;tm_hour, currtime-&gt;tm_min, currtime-&gt;tm_sec);\n</code></pre>\n\n<p>but in the case of single digit values it'll print 8:2:5 instead of 08:02:05.</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 1298, "user_id": 5359024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d1759b2f59cd77b2fc7fb059f0679312?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pittino", "link": "https://stackoverflow.com/users/5359024/michael-pittino"}, "edited": false, "score": 2, "creation_date": 1519799263, "post_id": 49023189, "comment_id": 85051220, "body": "Loop over it and count the characters until you find the terminator. But note that this signature is bad. You&#39;ll need an additional argument for the <code>char*</code> array size."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1519799271, "post_id": 49023189, "comment_id": 85051225, "body": "You need to compute that size before allocating the memory zone"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1298, "user_id": 5359024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d1759b2f59cd77b2fc7fb059f0679312?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pittino", "link": "https://stackoverflow.com/users/5359024/michael-pittino"}, "edited": false, "score": 2, "creation_date": 1519799305, "post_id": 49023189, "comment_id": 85051239, "body": "@MichaelPittino: the <code>data</code> parameter is an array of pointers ended by <code>NULL</code>"}, {"owner": {"reputation": 1298, "user_id": 5359024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d1759b2f59cd77b2fc7fb059f0679312?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pittino", "link": "https://stackoverflow.com/users/5359024/michael-pittino"}, "edited": false, "score": 1, "creation_date": 1519802378, "post_id": 49023189, "comment_id": 85052571, "body": "Ah, right. Well then all he needs to do is loop over the array of char-pointers and then loop over each individual char-pointer."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519803650, "post_id": 49023189, "comment_id": 85053201, "body": "Do you understand how to create a dynamically allocated copy of a single string (i.e. something like <code>char *mkcopy(char *str)</code>)?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 1298, "user_id": 5359024, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d1759b2f59cd77b2fc7fb059f0679312?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Pittino", "link": "https://stackoverflow.com/users/5359024/michael-pittino"}, "edited": false, "score": 0, "creation_date": 1519803653, "post_id": 49023189, "comment_id": 85053203, "body": "@Michael. Or use <code>strlen</code> presumably."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1519803668, "post_id": 49023189, "comment_id": 85053214, "body": "Basically, you will simply <code>strlen</code> each of the strings in <code>*data[]</code> and keep a running total insuring you allocate at least <code>+1</code> for the <i>nul-terminaing</i> character at each allocation/concatenation. You can do it in a single-loop with <code>realloc</code> or loop over the pointers first and <code>malloc</code> all at once."}, {"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "edited": false, "score": 0, "creation_date": 1519803693, "post_id": 49023189, "comment_id": 85053233, "body": "Use <a href=\"http://www.cplusplus.com/reference/cstring/strlen/?kw=strlen\" rel=\"nofollow noreferrer\">strlen</a> to obtain the length of the string"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519804268, "post_id": 49023189, "comment_id": 85053476, "body": "@melpomene - you mean by way of a function prototype exampe? <code>mkcopy</code>? (to be implemented via <code>malloc&#47;strcpy</code> or <code>strdup</code>)?"}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1519803877, "post_id": 49024331, "comment_id": 85053315, "body": "Missing check for overflow, missing check for <code>malloc</code> failing, assignment to <code>str[len]</code> is redundant, copying loop has O(n^2) performance. Would not recommend."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519804162, "post_id": 49024331, "comment_id": 85053425, "body": "@melpomene I don&#39;t understand the O(n^2) performance. How can you do it without going through all the strings? Also what is <code>n</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519804493, "post_id": 49024331, "comment_id": 85053590, "body": "<code>n</code> is the number of strings. See <a href=\"https://www.joelonsoftware.com/2001/12/11/back-to-basics/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2001/12/11/back-to-basics</a> for a detailed explanation."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805094, "post_id": 49024331, "comment_id": 85053884, "body": "That&#39;s right, I never thought about it, but that&#39;s actually true. @melpomene how do you think one could avoid this since that <code>strcat</code> only returns the <code>*dest</code> pointer? Should the strings be manually concatenated?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805143, "post_id": 49024331, "comment_id": 85053919, "body": "WTF? Is no one reading the article I linked to? Not only does it explain the problem, it also shows a solution that runs in linear time."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805209, "post_id": 49024331, "comment_id": 85053952, "body": "@melpomene you&#39;re right ahah, my bad there, thinking too fast without reading."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805331, "post_id": 49024331, "comment_id": 85054011, "body": "@melpomene OK, finally got it. My dumb head. Is it fixed now? (not talking about the contant hidden behind the big O)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805478, "post_id": 49024331, "comment_id": 85054105, "body": "No, your &quot;optimized&quot; version is identical to the other code."}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519805665, "post_id": 49024331, "comment_id": 85054203, "body": "@melpomene I forgot <code>strcat()</code> again :( It should look good (look linear) now."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1519805817, "post_id": 49024331, "comment_id": 85054280, "body": "Yes, that looks better. Note that you could replace <code>strcat</code> by <code>strcpy</code> in your last version because your code keeps the invariant that <code>p</code> always points at a NUL byte."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519820766, "post_id": 49024331, "comment_id": 85063257, "body": "Last code snippet is good yet the needed <code>p[0] = 0;</code> or <code>str[0] = 0;</code> is implied and not shown.  Recommend to add it."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": false, "score": 1, "last_activity_date": 1519822892, "last_edit_date": 1519822892, "creation_date": 1519803787, "answer_id": 49024331, "question_id": 49023189, "link": "https://stackoverflow.com/questions/49023189/how-can-i-predetermine-the-size-of-a-malloc-to-concatenate-an-array-of-strings/49024331#49024331", "title": "How can I predetermine the size of a malloc to concatenate an array of strings?", "body": "<p>An approach that goes through the strings twice seems good.</p>\n\n<p>The first pass counts the sum of the lengths:</p>\n\n<pre><code>size_t len = 0;\nfor (char** pstr = data; *pstr; pstr++)\n    len += strlen(*pstr);\n</code></pre>\n\n<p>The second pass concatenates all the strings:</p>\n\n<pre><code>char *str = malloc(len + 1);\nstr[0] = '\\0';\nfor (char** pstr = data; *pstr; pstr++)\n    strcat(str, *pstr);\nreturn str;\n</code></pre>\n\n<p>You can optimize the concatenation part by storing the end point of the last concatenation:</p>\n\n<pre><code>char *str = malloc(len + 1);\nstr[0] = '\\0';\n\nchar *p = str;\nfor (char** pstr = data; *pstr; pstr++) {\n    strcat(p, *pstr);\n    p += strlen(*pstr);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1519804233, "post_id": 49024352, "comment_id": 85053459, "body": "<code>*cur++</code> parses as <code>*(cur++)</code>. The <code>*</code> does nothing."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519804257, "post_id": 49024352, "comment_id": 85053471, "body": "Missing check for overflow, missing check for <code>malloc</code> failing."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519804423, "post_id": 49024352, "comment_id": 85053552, "body": "@melpomene you mean overflow of the <code>size_t</code> for a possibly very long array of long strings? This doesn&#39;t seem like that kind of homework... as per the <code>malloc</code> check, I know, but op just asked how to calculate the size, nothing more (added a note)."}], "tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1519804479, "last_edit_date": 1519804479, "creation_date": 1519803868, "answer_id": 49024352, "question_id": 49023189, "link": "https://stackoverflow.com/questions/49023189/how-can-i-predetermine-the-size-of-a-malloc-to-concatenate-an-array-of-strings/49024352#49024352", "title": "How can I predetermine the size of a malloc to concatenate an array of strings?", "body": "<p>First of all, to know the size of one string, you can use <code>strlen</code> from the library <code>string.h</code>. If you want to calculate the sum of all the sizes you can just use a loop and sum up all the <code>strlen</code>s, and add <code>1</code> for the terminal <code>NUL</code> character, like this:</p>\n\n<pre><code>char* append(char *data[]) {\n    char **cur, *res;\n    size_t len = 0;\n\n    for (cur = data; *cur != NULL; *cur++)\n        len += strlen(*cur);\n\n    res = malloc(len + 1);\n\n    // Now you can concatenate the strings...\n}\n</code></pre>\n\n<p>Oh, and don't forget to check that the pointer returned by <code>malloc</code> is valid (i.e. not <code>NULL</code>).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4905778"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1519822892, "creation_date": 1519799081, "last_edit_date": 1592644375, "question_id": 49023189, "link": "https://stackoverflow.com/questions/49023189/how-can-i-predetermine-the-size-of-a-malloc-to-concatenate-an-array-of-strings", "title": "How can I predetermine the size of a malloc to concatenate an array of strings?", "body": "<blockquote>\n<p>Implement the append function that has the prototype below. The function returns a string that represents the concatenation of all the strings present in an array of strings. For this problem, you can assume the end of the parameter array is marked by <code>NULL</code>. You need to allocate memory for the resulting string.  You may not modify the array parameter.</p>\n<pre><code>char* append(char *data[]); \n</code></pre>\n</blockquote>\n<p>I don't understand how to determine the size to <code>malloc</code> the pointer.</p>\n"}, {"tags": ["c", "arrays", "compare"], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 2, "last_activity_date": 1519799402, "last_edit_date": 1519799402, "creation_date": 1519797934, "answer_id": 49022956, "question_id": 49022942, "link": "https://stackoverflow.com/questions/49022942/one-dimensional-array-comparison-within-a-two-dimensional-array-in-c/49022956#49022956", "title": "One-dimensional array comparison within a two-dimensional array in C", "body": "<pre><code>static bool compare_arrays(uint8_t array_1[] , uint8_t array_2[][])\n</code></pre>\n\n<p>The second dimension must be present - otherwise compiler can't decide how much position to stride through when someone writes like <code>array_2[y][x]</code>.</p>\n\n<pre><code>static bool compare_arrays(uint8_t array_1[] , uint8_t array_2[][6])\n</code></pre>\n\n<p>Actually 2d array decays into pointer to it's first element - which is of type <code>uint8_t (*)[6]</code>. And the single dim array will similarly decay here into <code>uint8_t*</code>. Remember that the first dimension of passed array is not considered by compiler.Arrays declarations must have all, except the first, sizes defined. </p>\n"}], "owner": {"reputation": 433, "user_id": 5100678, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nd7k2.jpg?s=128&g=1", "display_name": "Purgoufr", "link": "https://stackoverflow.com/users/5100678/purgoufr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 49022956, "answer_count": 1, "score": 0, "last_activity_date": 1519799402, "creation_date": 1519797843, "question_id": 49022942, "link": "https://stackoverflow.com/questions/49022942/one-dimensional-array-comparison-within-a-two-dimensional-array-in-c", "title": "One-dimensional array comparison within a two-dimensional array in C", "body": "<p>I want to compare two arrays of different sizes in a particular function. I wrote a function like this:</p>\n\n<pre><code>static bool compare_arrays(uint8_t array_1[] , uint8_t array_2[][])\n{\n    static int index=0;\n    static bool isequal = false;\n\n    for(int i = 0 ; i&lt;count_current; i++ )\n    {\n        for(int j = 0; j&lt;6 ; j++ )\n        {\n            if (array_1[j] == array_2[i][j])            \n            {\n                index++ ;\n            }\n            else\n            {\n                index=0;\n                return false;\n            }\n        }\n        if (index == 6)\n        {\n            index=0;\n            isequal = true;\n            i = count_current + 2;\n        }\n        else\n        {\n            index=0;\n            isequal = false; \n        }   \n    }\n    return isequal;\n}\n</code></pre>\n\n<p>Define some variables;</p>\n\n<pre><code>static bool matching_array;\nstatic uint8_t one_dimensional_array[6];\nstatic uint8_t two_dimensional_array[10][6];    \n</code></pre>\n\n<p>Then I use the function like this;</p>\n\n<pre><code>matching_array= compare_arrays( one_dimensional_array, two_dimensional_array);\n</code></pre>\n\n<p>But I got an error like this;</p>\n\n<pre><code>..\\..\\..\\main.c(857): error:  #98: an array may not have elements of this type\n</code></pre>\n\n<p>Do you have any suggestion ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1519794531, "post_id": 49022252, "comment_id": 85049710, "body": "Since a double colon indicates an option with an optional argument, it\u2019s not going to work. <code>::</code> isn\u2019t really good design in the first place, though. How about having two separate options \u2013 one that takes an argument and one that doesn\u2019t?"}, {"owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1519795190, "post_id": 49022252, "comment_id": 85049895, "body": "Tried that. &#39;-w&#39; would crash. Unless you meant something else? I thought &quot;w:w&quot; or &quot;w:w:&quot; both crash."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1519795264, "post_id": 49022252, "comment_id": 85049922, "body": "They would be different letters."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519795370, "post_id": 49022252, "comment_id": 85049953, "body": "It&#39;s curious how similar this is to the code provided in the Q&amp;A (especially the answer) to <a href=\"https://stackoverflow.com/questions/49021769/getopt-how-to-set-a-default-value\"><code>getopt()</code> \u2014 how to set a default value?</a> but the posters are different."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519795473, "post_id": 49022252, "comment_id": 85049987, "body": "@JonathanLeffler OP probably copied the answer code, and now is trying to take it further."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1519795319, "creation_date": 1519795319, "answer_id": 49022479, "question_id": 49022252, "link": "https://stackoverflow.com/questions/49022252/getopt-flexibility-to-make-spaces-work-as-well/49022479#49022479", "title": "getopt flexibility to make spaces work as well", "body": "<p>with <code>::</code> (allows not to pass a value after the option), and a space, there would be an ambiguity between <code>-w 17</code> where <code>17</code> would be the value of the option and <code>-w 17</code> where <code>17</code> is another argument, which explains that getopt requires that the value is collated when using <code>::</code></p>\n\n<p>Even worse, think of the general case where there are other options. What would <code>-w -x</code> do ? <code>getopt</code> cannot predict that you're requiring a number after your option.</p>\n\n<p>I would just change the getopt line to:</p>\n\n<pre><code>while ((o = getopt(argc, argv, \"w:\")) != -1) {\n</code></pre>\n\n<p>now omitting <code>-w</code> still gives <code>10</code> as the value is defaulted beforehand.</p>\n"}], "owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 49022479, "answer_count": 1, "score": 2, "last_activity_date": 1519795319, "creation_date": 1519793961, "question_id": 49022252, "link": "https://stackoverflow.com/questions/49022252/getopt-flexibility-to-make-spaces-work-as-well", "title": "getopt flexibility to make spaces work as well", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;getopt.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char **argv) {\n    int o;\n    int w = 10;\n\n    while ((o = getopt(argc, argv, \"w::\")) != -1) {\n        switch (o) {\n            case 'w' :\n                if (optarg) {\n                    w = atoi(optarg);\n                }\n                break;\n        }\n\n    }\n    printf(\"%d\\n\", w);\n}\n</code></pre>\n\n<p>I want this to work</p>\n\n<pre><code>$ gcc -Wall theup.c\n$ ./a.out -w 17\n17\n</code></pre>\n\n<p>Currently does this</p>\n\n<pre><code>$ gcc -Wall theup.c\n$ ./a.out -w 17\n10\n</code></pre>\n\n<p>Is there any way to do this with getopt? It works for most of them like -w17 -w , but the space one doesn't work</p>\n"}, {"tags": ["c", "csv", "pic", "microchip", "nmea"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5043425, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1448084908541205/picture?type=large", "display_name": "Mathew Wright", "link": "https://stackoverflow.com/users/5043425/mathew-wright"}, "edited": false, "score": 0, "creation_date": 1519820298, "post_id": 49022767, "comment_id": 85062940, "body": "Are you doing this in a MPLAB X simulator?"}, {"owner": {"reputation": 75, "user_id": 5043425, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1448084908541205/picture?type=large", "display_name": "Mathew Wright", "link": "https://stackoverflow.com/users/5043425/mathew-wright"}, "edited": false, "score": 0, "creation_date": 1519827100, "post_id": 49022767, "comment_id": 85067534, "body": "Nevermind. My compiler was optimizing variables and not giving me the correct values in the watch screen. Thanks for the help."}], "tags": [], "owner": {"reputation": 17, "user_id": 4158656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7193aea635ce1f709ea0b8d71b3db797?s=128&d=identicon&r=PG&f=1", "display_name": "m0e", "link": "https://stackoverflow.com/users/4158656/m0e"}, "is_accepted": false, "score": 0, "last_activity_date": 1519796985, "creation_date": 1519796985, "answer_id": 49022767, "question_id": 49022203, "link": "https://stackoverflow.com/questions/49022203/parsing-nmea-csv-in-c-c-for-microchip/49022767#49022767", "title": "Parsing nmea csv in c++/c for microchip", "body": "<p>You're upper snippet is working for me, besides two minor issues: </p>\n\n<ul>\n<li><code>buf</code> should be <code>str2</code></li>\n<li>your array of char pointers is too small to hold all substrings</li>\n</ul>\n\n<p>For the second one, you need to convert your substring to the correct type first.</p>\n\n<p>__</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt; \n\nint main(){\n\n#define NUM_SUBSTRINGS 13\n\nchar str2[] = \"$GNRMC,011802.00,A,4104.22420,N,08131.66173,W,0.021,,280218,,,D*78\\n\";\nchar *p;\np = strtok(str2, \",\");\n\nchar * input[NUM_SUBSTRINGS];\nint i = 0;\n\nfor(i=0; i&lt;NUM_SUBSTRINGS; i++)\n{   \n    char *type = NULL;\n    float thisnum = 0.0;\n    if (i == 0){\n        type = p;\n    }\n\n    if (i == 1){\n        thisnum = strtof(p, NULL);\n    }\n\n    if(p != NULL)\n        printf(\"String %s, type: %s, num: %f\\n\", p, type, thisnum);\n\n    input[i] = p;\n    p = strtok(NULL, \",\");  \n\n}\nreturn 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5043425, "user_type": "registered", "accept_rate": 22, "profile_image": "https://graph.facebook.com/1448084908541205/picture?type=large", "display_name": "Mathew Wright", "link": "https://stackoverflow.com/users/5043425/mathew-wright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519820350, "creation_date": 1519793618, "last_edit_date": 1519820350, "question_id": 49022203, "link": "https://stackoverflow.com/questions/49022203/parsing-nmea-csv-in-c-c-for-microchip", "title": "Parsing nmea csv in c++/c for microchip", "body": "<p>How can I parse a comma separated char string? I've tried using strtok but I can't get it working. </p>\n\n<pre><code>     char str2[] = \"$GNRMC,011802.00,A,4104.22420,N,08131.66173,W,0.021,,280218,,,D*78\\n\";\n\n\n     char *p;\n\n     p = strtok(str2, \",\");\n\n\n\n\n       char *input[8];\n        int i = 0;\nfor( i=0;i&lt;8;i++)\n   {\n    input[i] = p;\n    p = strtok(NULL, \",\");  \n\n   }\n</code></pre>\n\n<p>Ideally I'd like to be able to set a variable to the string. Such as</p>\n\n<pre><code>if (i == 0){\nstring type = $GNRMC;\n}\n\nif (i == 1){\nfloat thisnum = 011802.00\n}\n</code></pre>\n\n<p>etc.</p>\n\n<p>This is being written for a pic so I can't use vectors.</p>\n"}, {"tags": ["c", "pipe", "fork", "parent-child"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1519794380, "post_id": 49022159, "comment_id": 85049672, "body": "Probably a buffering issue. Try <code>fflush(stdout)</code> after each <code>printf</code>."}, {"owner": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519796067, "post_id": 49022159, "comment_id": 85050158, "body": "@melpomene This works well for this sample, but I was hoping for an answer that wouldn&#39;t involve a lot of changes to the child source (there are quite a few print statements throughout the loop)"}, {"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "edited": false, "score": 0, "creation_date": 1519797004, "post_id": 49022159, "comment_id": 85050432, "body": "You can use <code>setvbuf(stdout, NULL, _IONBF, 0);</code> to turn off output buffering entirely."}, {"owner": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "reply_to_user": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "edited": false, "score": 0, "creation_date": 1519797593, "post_id": 49022159, "comment_id": 85050631, "body": "@Geoffrey Both of these solutions fix the issue for the sample code, but they don&#39;t seem to do what I am looking for (and it seems like the read function just wasn&#39;t meant to work the way I want it to). When I try this on my actual child program read will hang waiting for more to be written. I want read to return on the next instance of a write to stdout, not all future output to stdout"}, {"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "edited": false, "score": 1, "creation_date": 1519797700, "post_id": 49022159, "comment_id": 85050675, "body": "Ah, I see. <code>read</code> will read up to N bytes or until EOF, you likely want to look at <code>getline</code> instead. Failing that you can use <code>select</code> to determine if there is data to be read on the file descriptor before attempting to read. When reading from a file descriptor, be it a file, socket or pipe, you must account for reading more data then you want. Normally this is done by sending a header with each message that contains the length of the message. I will propose an answer with an example."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "edited": false, "score": 0, "creation_date": 1519800305, "post_id": 49023066, "comment_id": 85051622, "body": "This is perfect! It is exactly what I wanted to achieve and certainly worthy of updating the child source for. I am seeing one small issue where the data received is print out a 2 extra characters: &quot;@&quot;. I assume this is okay to use multiple times? Thank you very much, I am marking this as the answer. If I could +1 I would."}, {"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "reply_to_user": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "edited": false, "score": 0, "creation_date": 1519800376, "post_id": 49023066, "comment_id": 85051649, "body": "Please note I corrected some errors in the code, it may explain your 2 extra character problem if you have not tried it with the corrections."}, {"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "reply_to_user": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "edited": false, "score": 0, "creation_date": 1519800831, "post_id": 49023066, "comment_id": 85051857, "body": "Oh and yes, this can be used repeatedly, which is the entire idea. The message boundaries are well defined and each message can be extracted individually without problem. If you have multiple writers though you may want to alter the write to write the header and data in one operation so as to avoid a race condition where a 2nd writer could write a header before the 1st writer writes it&#39;s payload. Edit: actually I will update the example to do this."}, {"owner": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "edited": false, "score": 0, "creation_date": 1519804042, "post_id": 49023066, "comment_id": 85053379, "body": "I have it working twice like I wanted and it is working great! I noticed on the child side when writing there is an extra character at the start of the string. I think this is occurring on the memcpy line. When I adjust it the leading character will no longer be present, but the read call will hang :("}, {"owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "reply_to_user": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "edited": false, "score": 0, "creation_date": 1519804736, "post_id": 49023066, "comment_id": 85053708, "body": "I can&#39;t see any reason why you would see this behavior, please open a new question with sample code and I will have a look as the problem you are now describing is unrelated to your original question."}], "tags": [], "owner": {"reputation": 9140, "user_id": 637874, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e2e7daf0ad564b90a61d1aec8dea175?s=128&d=identicon&r=PG", "display_name": "Geoffrey", "link": "https://stackoverflow.com/users/637874/geoffrey"}, "is_accepted": true, "score": 0, "last_activity_date": 1519801156, "last_edit_date": 1592644375, "creation_date": 1519798490, "answer_id": 49023066, "question_id": 49022159, "link": "https://stackoverflow.com/questions/49022159/read-stdout-from-child-in-infinite-loop/49023066#49023066", "title": "read() stdout from child in infinite loop", "body": "<p>It seems you are trying to perform inter process communication (IPC). There is no 1 to 1 communication syncronization with reads/write, the parent or child can write as much as they want to the file descriptor at once, and since they are running asynchronously you must ensure you are ready to deal with this.</p>\n<p>Normally this is done by sending a header with each message that is a fixed size, containing the length of the payload. For example:</p>\n<h1>protocol header</h1>\n<pre><code>#include &lt;stdint.h&gt;\n\nstruct Message\n{\n  uint8_t length; // assuming a maximum message length of 255 bytes, adjust as needed.\n};\n</code></pre>\n<p>You can define extra things here, usually it's a good idea to include the version, perhaps a sequence ID, etc. It is important that if you are communicating across a network, this header's size is absolute on all hardware implementations, so the use of stdint defines is required to ensure compatibility between architectures. It is also a good idea to ensure the endian is consistent if working across architectures also.</p>\n<h1>sending a message</h1>\n<pre><code>const char data[] = &quot;example&quot;;\n\n// create a buffer large enough to pack the header and data into it\nconst uint8_t len = strlen(data) + 1;\nchar buffer[sizeof(struct Message) + len];\n\n// populate the header\nstruct Message *m = (struct Message *)buffer;\nm-&gt;length = len;\n\n// copy in the payload after the header\nmemcpy(buffer + sizeof(struct Message), data, len);\n\n// write the packed buffer\nwrite(fd, buffer, sizeof(struct Message) + len);\n</code></pre>\n<h1>reading a message</h1>\n<pre><code>struct Message m;\nif (read(fd, &amp;m, sizeof(struct Message)) != sizeof(struct Message))\n{\n  fprintf(stderr, &quot;Failed to read the header\\n&quot;);\n  exit(1);\n}\n\n// If required perform validation on the header here\n\nssize_t offset = 0;\nchar data[m.length];\nwhile(offset &lt; m.length)\n{\n  ssize_t r = read(fd, data + offset, m.length - offset);\n  if (r &lt; 0)\n  {\n    fprintf(stderr, &quot;Read of message body failed\\n&quot;);\n    exit(1);\n  }\n\n  if (r == 0)\n  {\n    fprintf(stderr, &quot;The sender closed the connection\\n&quot;);\n    exit(1);\n  }\n\n  offset += r;\n}\n\nprintf(&quot;Message Length: %u, Message Data: %s\\n&quot;, m.length, data);\n</code></pre>\n<p>The while loop to read is requires as the data may have been split up into chunks if the sender exceeded the write buffer and is now blocking waiting to write the remainder. The header can also be split across chunks and ideally should also be read using the same technique, but for brevity I have left this out.</p>\n"}], "owner": {"reputation": 43, "user_id": 7911205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3fc4e72bc0453b33cfb33d706b05028?s=128&d=identicon&r=PG&f=1", "display_name": "funcs", "link": "https://stackoverflow.com/users/7911205/funcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 49023066, "answer_count": 1, "score": 0, "last_activity_date": 1519801156, "creation_date": 1519793302, "last_edit_date": 1519794190, "question_id": 49022159, "link": "https://stackoverflow.com/questions/49022159/read-stdout-from-child-in-infinite-loop", "title": "read() stdout from child in infinite loop", "body": "<p>I am forking a child which will run an infinite loop and do some things. Text will be printed to stdout with printf when the child is in a 'ready' status. I am redirecting the child's stdout with a pipe so the parent can see it. When this text prints I would like the parent to be unblocked.</p>\n\n<p>The problem seems to be that the read() call will stay blocked even after the printf() call.</p>\n\n<p>Here is some sample code I am working with:</p>\n\n<p>parent: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main()\n{\n    int fd[2];\n    pipe(fd);\n    char buffer[256];\n\n    switch(fork())\n    {\n        case -1:\n            printf(\"fork failed\\n\");\n            _exit(1);\n        case 0:\n            printf(\"Starting progtest...\\n\");\n            close(fd[0]);\n            dup2(fd[1], STDOUT_FILENO);\n            close(fd[1]);\n            execl(\"progtest\", \"progtest\", NULL);\n\n            perror(\"exec failed\");\n            _exit(1);\n    }\n\n    close(fd[1]);\n    read(fd[0], &amp;buffer, sizeof(buffer));\n    close(fd[0]);\n\n    printf(\"buffer: %s\\n\", buffer);\n\n}\n</code></pre>\n\n<p>child:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    printf(\"ready\\n\");\n    while(1)\n    {\n        // stuff happens here\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I'm pretty sure the pipe is set up correctly. If I remove the infinite loop the parent will unblock and print \"ready\".</p>\n\n<p>Is there any way I can use read() while the child is still running? Am I going about this incorrectly by using pipes? I need to do this twice with two different status messages.</p>\n"}, {"tags": ["c", "getopt"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1519791403, "creation_date": 1519791403, "answer_id": 49021887, "question_id": 49021769, "link": "https://stackoverflow.com/questions/49021769/getopt-how-to-set-a-default-value/49021887#49021887", "title": "getopt how to set a default value", "body": "<p>Assuming you're using GNU getopt, the following should work:</p>\n\n<pre><code>    while ((o = getopt(argc, argv, \"w::\")) != -1) {\n        switch (o) {\n            case 'w' :\n                if (optarg) {\n                    w = atoi(optarg);\n                }\n                break;\n</code></pre>\n\n<p>A following <code>:</code> marks the option as requiring an argument. A double <code>:</code> makes the argument optional (this is a GNU extension). If there is no argument, <code>optarg</code> is <code>NULL</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1620, "favorite_count": 0, "accepted_answer_id": 49021887, "answer_count": 1, "score": 2, "last_activity_date": 1519791414, "creation_date": 1519790524, "last_edit_date": 1519791414, "question_id": 49021769, "link": "https://stackoverflow.com/questions/49021769/getopt-how-to-set-a-default-value", "title": "getopt how to set a default value", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;getopt.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(int argc, char **argv) {\n    int o;\n    int w = 10;\n\n    while ((o = getopt(argc, argv, \"w\")) != -1) {\n        switch (o) {\n            case 'w' :\n                w = atoi(optarg);\n                break;\n\n\n\n        }\n\n    }\n    printf(\"%d\\n\", w);\n}\n</code></pre>\n\n<p>Basically, I want -w to have if nothing is inputted. </p>\n\n<p>Consider these use cases</p>\n\n<pre><code>$ gcc -Wall fileabove.c\n$ ./a.out \n10\n$ ./a.out -w\n10\n$ ./a.out -w14\n14\n</code></pre>\n\n<p>I can't get the second one to work. Is there any way I can play around with getopt to get the expected result? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1519794766, "post_id": 49021022, "comment_id": 85049781, "body": "You&#39;ve got six different variables that are used as indexes. You can either use a debugger, or add some <code>printfs</code> to the code, to see what those indexes are doing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1519800651, "post_id": 49021022, "comment_id": 85051776, "body": "You&#39;ve not shown example input and expected vs actual output data.  That makes it hard to know what you think you&#39;re doing, or where you think your spiral copying moves each cell to.  An MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) includes inputs and outputs \u2014 and code that can be compiled and run.   (Also, hiding the definition of <code>g</code> after a comment is peculiar.)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519800811, "post_id": 49021022, "comment_id": 85051841, "body": "The line <code>B[m-1][i] = a[i][n];</code> is accessing array <code>a</code> out of bounds (<code>n</code> is too big).  That bodes ill.  Similarly, the line <code>B[i][l] = a[m][i];</code> is accessing <code>a</code> out of bounds (<code>m</code> is too big)."}], "owner": {"reputation": 1, "user_id": 9421730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0e737b24931f3721c9262ed994c563?s=128&d=identicon&r=PG", "display_name": "Michael Carta", "link": "https://stackoverflow.com/users/9421730/michael-carta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519849186, "creation_date": 1519784627, "last_edit_date": 1519849186, "question_id": 49021022, "link": "https://stackoverflow.com/questions/49021022/array-spiral-print-function", "title": "Array Spiral Print Function", "body": "<p>I need to make a function which takes two arrays and copies the data from one to the other in a spiral way. The problem is that when I'm trying to print B after I use the function it just prints the old B, nothing is changed. Any idea why this function is not changing the B array?</p>\n\n<pre><code>void spiralPrint(unsigned int m, unsigned int n, int a[m][n], int B[m][n])\n{\n   int i, k = 0, l = 0, g = 0;\n\n   while(k &lt; m &amp;&amp; l &lt; n)\n   {\n       /* Print the first row from the remaining rows */\n       for(i = l; i &lt; n; ++i)\n       {\n           B[k][i] = a[k][i];\n       }\n       k++;\n\n       /* Print the last column from the remaining columns */\n       for(i = k; i &lt; m; i++)\n       {\n           B[i][n - 1] = a[k][g];\n           g++;\n       }\n       n--;\n\n       /* Print the last row from the remaining rows */\n\n       if(k &lt; m)\n       {\n           for(i = n - 1; i &gt; l; --i)\n           {\n               B[m - 1][i] = a[i][n];\n           }\n           m--;\n       }\n\n       /* Print the first column from the remaining columns */\n       if(l &lt; n)\n       {\n           for(i = m - 1; i &gt;= k; --i)\n           {\n               B[i][l] = a[m][i];\n           }\n           l++;\n       }\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1519844017, "post_id": 49021019, "comment_id": 85078117, "body": "Note that in general, you can&#39;t &quot;remove&quot; commas once you&#39;ve written them.  The key is not to write the comma unless you want it.  The answers below all do that, one way or another.  Techniques such as seeking backwards a character and overwriting with a blank or newline work on files but not on pipes or terminals."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519785510, "post_id": 49021048, "comment_id": 85047507, "body": "what if I enter <code>0</code> several times ?"}, {"owner": {"reputation": 101, "user_id": 2309045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZ7k.png?s=128&g=1", "display_name": "Longarmx", "link": "https://stackoverflow.com/users/2309045/longarmx"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1519785746, "post_id": 49021048, "comment_id": 85047558, "body": "Then use a boolean or an index counter. This would be the more robust way regardless. Also, if it&#39;s <code>0</code> then the loop would break and you wouldn&#39;t print it anyway."}], "tags": [], "owner": {"reputation": 101, "user_id": 2309045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZ7k.png?s=128&g=1", "display_name": "Longarmx", "link": "https://stackoverflow.com/users/2309045/longarmx"}, "is_accepted": false, "score": 0, "last_activity_date": 1519784862, "creation_date": 1519784862, "answer_id": 49021048, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code/49021048#49021048", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>Print the comma before all but the first value. It's not elegant but it works.</p>\n\n<pre><code>if(x != 0)\n{\n    if(sum == x) // On the first pass, sum == x\n        printf(\"%d\", sum);\n    else\n        printf(\",%d\", sum);\n}\n</code></pre>\n\n<p>Of course, this could break if you have negative values. In that case, keeping a counter or bool would be better.</p>\n"}, {"tags": [], "owner": {"reputation": 5295, "user_id": 717523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b436aae08258d0a6b3f515eb03d5f15?s=128&d=identicon&r=PG", "display_name": "sg7", "link": "https://stackoverflow.com/users/717523/sg7"}, "is_accepted": false, "score": 1, "last_activity_date": 1519787643, "last_edit_date": 1519787643, "creation_date": 1519785339, "answer_id": 49021097, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code/49021097#49021097", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>You could use the following approach:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int x = 0;\n    int sum = 0;\n    int i = -1;\n    int ret;\n\n    while(1)\n    {\n        i++;\n        ret = scanf(\"%d\", &amp;x);\n\n        if(ret != 1)\n          break;\n\n        sum += x;\n\n        if(x != 0)\n        {\n            if(i == 0) \n               printf(\"%d\", sum);\n            else\n              printf(\",%d\", sum);\n        }\n        else\n        {\n            break;\n        }\n    }\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1\n2\n3\n0\n1,3,6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 0, "last_activity_date": 1519785549, "creation_date": 1519785549, "answer_id": 49021124, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code/49021124#49021124", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>print comma only after the first iteration (use a custom flag) , print result no matter what:</p>\n\n<pre><code>int first_iteration = 1;\n\n...\n\nif (!first_iteration)\n{\n   printf(\",\");\n}\nsum += x;\nfirst_iteration = 0;\nprintf(\"%d\", sum);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 9408375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884722e845ecf4934e0a248b1a7cb9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/9408375/ozymandias"}, "is_accepted": false, "score": 0, "last_activity_date": 1519785722, "creation_date": 1519785722, "answer_id": 49021142, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code/49021142#49021142", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>There is always a clumsy but tried-and-true method:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\n    int x, sum;\n    sum = 0;\n    comma = 0;\n    while(x)\n    {\n        scanf(\"%d\", &amp;x);\n        sum += x;\n        if(x != 0)\n        {\n            if (comma != 0)\n            {\n                printf(\",\");\n            }\n            printf(\"%d\", sum);\n            comma = 1;\n        }\n        else{\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1520437335, "last_edit_date": 1520437335, "creation_date": 1519785764, "answer_id": 49021145, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code/49021145#49021145", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>My preferred solution, adapted to the code in the question, is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{\n    int sum = 0;\n    int x;\n    const char *pad = \"\";   /* Or put a prefix here */\n    while (scanf(\"%d\", &amp;x) == 1 &amp;&amp; x != 0)\n    {\n        sum += x;\n        printf(\"%s%d\", pad, sum);\n        pad = \",\";          /* Or use \", \" if you prefer */\n    }\n    putchar('\\n');\n    return 0;\n}\n</code></pre>\n\n<p>Note that this code does not test the uninitialized variable <code>x</code> on the first iteration (unlike the code in the question), and it checks that the <code>scanf()</code> succeeds before using the value (unlike the code in the question).  These are routine precautions you should be taking.  It would be possible to adapt the code to keep track of how many bytes have been printed on the line (what's the return value from <code>printf()</code>?) and arrange for <code>pad</code> to contain <code>\"\\n\"</code> (instead of a comma, or <code>\",\\n\"</code> if you want a comma at the end of all lines except the last) when the line gets 'too long'.</p>\n\n<p>Note too that if you type the numbers at the program, the output gets messy.  If the program is reading from a built-in list of numbers, or reading from a file, then you get good outputs.</p>\n"}], "owner": {"reputation": 35, "user_id": 6285919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cBn6L.png?s=128&g=1", "display_name": "DamagedSoul97", "link": "https://stackoverflow.com/users/6285919/damagedsoul97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 49021145, "answer_count": 5, "score": 0, "last_activity_date": 1520437335, "creation_date": 1519784598, "last_edit_date": 1520434691, "question_id": 49021019, "link": "https://stackoverflow.com/questions/49021019/c-programming-removing-unnecessary-commas-from-result-of-prefix-sum-code", "title": "C Programming: Removing Unnecessary Commas From Result of Prefix Sum Code", "body": "<p>I recently made code in C that reads a set of numbers until zero (zero ends the number set) and prints its prefix sum:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    int x, sum;\n    sum = 0;\n    while(x)\n    {\n        scanf(\"%d\", &amp;x);\n        sum += x;\n        if(x != 0)\n        {\n            printf(\"%d,\", sum);    \n        }\n        else{\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>If I were to type <code>2 3 5 7 11 0</code>: It would print the following:</p>\n\n<pre><code>2,5,10,17,28,\n</code></pre>\n\n<p>I was wondering how to remove the comma by the number <code>28</code> or to add commas to numbers until the last number?</p>\n"}, {"tags": ["c", "string", "list", "substring", "strstr"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9421697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Herbert", "link": "https://stackoverflow.com/users/9421697/herbert"}, "edited": false, "score": 0, "creation_date": 1519832451, "post_id": 49022559, "comment_id": 85071253, "body": "Thanks a lot, that fixed it!"}], "tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1519797308, "last_edit_date": 1519797308, "creation_date": 1519795870, "answer_id": 49022559, "question_id": 49020964, "link": "https://stackoverflow.com/questions/49020964/checking-if-a-string-exists-using-a-substring-using-linked-lists/49022559#49022559", "title": "Checking if a string exists using a substring (using linked lists)", "body": "<blockquote>\n  <p>I should also mention that the substring used as an argument is wrote by the user using the fgets function.....<br>\n  So I'm confused as to why it doesn't work with a string that's input by the user.</p>\n</blockquote>\n\n<p>One possible reason that it doesn't work when you take input from user using <code>fgets()</code> function is that when user give input and press <code>ENTER</code> key, <code>fgets()</code> consider the newline character as a valid character and includes it in the input string given by the user. So, if the user gives input string <code>\"there\"</code> and press <code>Enter</code> key, the <code>fgets()</code> reads the characters from the input stream and stores them in the buffer like this:</p>\n\n<pre><code>+---------------------------+\n| t | h | e | r | e | \\n| \\0|\n+---------------------------+\n                      ^^\n</code></pre>\n\n<p>Remove the trailing newline character from the input buffer before passing it to the function which looks for the substring in the linked list:</p>\n\n<pre><code>inbuffer[strcspn(inbuffer, \"\\n\")] = 0; //inbuffer is buffer which holds input string given by user\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9421697, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Herbert", "link": "https://stackoverflow.com/users/9421697/herbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 49022559, "answer_count": 1, "score": 0, "last_activity_date": 1519797308, "creation_date": 1519784080, "last_edit_date": 1519785714, "question_id": 49020964, "link": "https://stackoverflow.com/questions/49020964/checking-if-a-string-exists-using-a-substring-using-linked-lists", "title": "Checking if a string exists using a substring (using linked lists)", "body": "<p>I need to make a function that receives a substring as an argument and checks if any of the strings in a linked list contain that substring. </p>\n\n<p>The function creates a new linked list with all of the strings that contain the substring given.</p>\n\n<p>The function looks like this:</p>\n\n<pre><code>    lista *lista_pesquisa_substring(lista *lst, char *substring)\n{\n    l_elemento *aux, *curr;\n    lista *lis2;\n    int i = 0, tamanho;\n    lis2 = lista_nova();\n    if(lst == NULL || substring == NULL){\n            return NULL;\n    }\n    for (aux = lst-&gt;inicio; aux != NULL; aux = aux-&gt;proximo)\n            {\n                curr = lista_elemento(lis2, i);\n                if (strstr(*aux-&gt;str, substring) != NULL)\n                {\n                    lista_insere(lis2, aux-&gt;str, curr);\n                    i++;\n                }\n            }\n            tamanho = lista_tamanho(lis2);\n            printf(\"Foram carregados %d jogos.\\n\", tamanho);\n            for(i = 0; i &lt; tamanho; i++)\n            {\n                curr = lista_elemento(lis2, i);\n                printf(\"Pos %d -&gt; %s\\n\", i, curr-&gt;str);\n            }\n            return lis2;\n        }\n</code></pre>\n\n<p>The if statement isn't working as intended. It only works if the substring given is exactly the same as a string from the linked list.</p>\n\n<p>For example, if a string from the linked list is \"Hello there\" and the substring given is \"Hello there\", the if statement works.\nBut if the substring is \"there\", the if doesn't work.</p>\n\n<p>EDIT:\nI should also mention that the substring used as an argument is wrote by the user using the fgets function.</p>\n\n<p>I have tried to use a pre-existing string instead to test it and it works. So I'm confused as to why it doesn't work with a string that's input by the user.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1052, "user_id": 3698648, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/199b49d13342baa233c08aac5793ed4d?s=128&d=identicon&r=PG&f=1", "display_name": "ntshetty", "link": "https://stackoverflow.com/users/3698648/ntshetty"}, "edited": false, "score": 0, "creation_date": 1519781907, "post_id": 49020662, "comment_id": 85046591, "body": "what is <code>optind</code> ?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1519782080, "post_id": 49020662, "comment_id": 85046633, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4917801/using-fseek-with-a-file-pointer-that-points-to-stdin\">Using fseek with a file pointer that points to stdin</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "edited": false, "score": 0, "creation_date": 1519782330, "post_id": 49020662, "comment_id": 85046697, "body": "Simply looking for an equivalent of fseek or ftell for stdin like &quot;echo hello&quot;, if it&#39;s possible."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1519782388, "post_id": 49020662, "comment_id": 85046713, "body": "@Basbas: As the suggested duplicate shows, there is no such thing. You can repeatedly get characters until you run out, and that&#39;s about it. Character streams aren&#39;t files; they have no defined end point until the stream is closed (after all, if the user manually typed inputs, rather than using <code>echo</code>, it would look roughly the same to your program, and the user may or may not <i>ever</i> hit Ctrl-D to signal end of stdin input)."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1519782536, "post_id": 49020743, "comment_id": 85046752, "body": "&quot;<i>But it will always fail because <code>stdin</code> is not seekable stream.</i>&quot; Not necessarily. <code>stdin</code> can refer to a pipe, terminal, normal file, socket, etc (it&#39;s inherited from the calling process). Normal files are seekable."}, {"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519782870, "post_id": 49020743, "comment_id": 85046845, "body": "@melpomene Yes, you are right. I fixed the answer. Thank you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "edited": false, "score": 0, "creation_date": 1519783407, "post_id": 49020743, "comment_id": 85046977, "body": "long num = ftell(stdin) always give&#39;s &#39;-1&#39;, if it were echo hello | ./a.out?"}, {"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 1, "creation_date": 1519783570, "post_id": 49020743, "comment_id": 85047024, "body": "if you do <code>echo hello | .&#47;a.out</code> then stdin of a.out is not normal file and is not seekable. Try making data file with content <code>hello</code> then do <code>.&#47;a.out &lt; data_file</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "edited": false, "score": 0, "creation_date": 1519783778, "post_id": 49020743, "comment_id": 85047077, "body": "So there&#39;s no way to do ftell(stdin) such that echo hello | ./a.out would work as wanted?"}, {"owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "edited": false, "score": 0, "creation_date": 1519783942, "post_id": 49020743, "comment_id": 85047121, "body": "@Basbas As you said, No."}], "tags": [], "owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "is_accepted": true, "score": 2, "last_activity_date": 1519784792, "last_edit_date": 1519784792, "creation_date": 1519782403, "answer_id": 49020743, "question_id": 49020662, "link": "https://stackoverflow.com/questions/49020662/is-there-a-fseek-and-ftell-equivalent-from-getc-files-for-getchar/49020743#49020743", "title": "Is there a fseek and ftell equivalent from getc files for getchar()?", "body": "<p>Since <code>getchar()</code> reads characters from <code>stdin</code>, you can use <code>fseek(stdin)</code> and <code>ftell()</code> on <code>stdin</code>. But calling those functions will always fail when <code>stdin</code> is not a normal file. Look at the link @lurker pointed.</p>\n\n<p>The following code returns -1 and ESPIPE (Illegal Seek)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\nmain() {\n        long pos;\n        pos = ftell(stdin);\n        printf(\"%ld\\n\", pos);\n        printf(\"errno=%d\\n\", errno);\n}\n\n$ ./a.out\n</code></pre>\n\n<p>However, when we run the same code with file redirection <code>ftell()</code> returns 0 without error. This time <code>stdin</code> of <code>./a.out</code> is a normal file and seekable.</p>\n\n<pre><code>$ ./a.out &lt; a.c\n</code></pre>\n\n<p>So the most viable solution to original poster is:</p>\n\n<pre><code>$ echo hello &gt; input.txt\n$ ./a.out &lt; input.txt\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9314692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 49020743, "answer_count": 1, "score": 1, "last_activity_date": 1519784792, "creation_date": 1519781768, "last_edit_date": 1519784048, "question_id": 49020662, "link": "https://stackoverflow.com/questions/49020662/is-there-a-fseek-and-ftell-equivalent-from-getc-files-for-getchar", "title": "Is there a fseek and ftell equivalent from getc files for getchar()?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\n\nint main(int argc, char **argv) {\n    int o;\n    int w = 80;\n    int p = 1;\n\n    int c;\n    int line_count = 0;\n    long remember_pos;\n    while ((c = getc(stdin)) != EOF) {\n        long num = ftell(stdin);\n        printf(\"%li\\n\", num);\n    }\n}\n</code></pre>\n\n<p>Basically processing the standard input when you do it in unix, like for example</p>\n\n<pre><code>$ gcc -Wall fileabove.c\n$ echo hello | ./a.out\n1\n2\n3\n4\n5\n6\n</code></pre>\n\n<p>I want it to process the 'hello' from echo. I want there to be a way to get to stdin[0] (in file's with fseek). Also get the position we are currently on (in file's with ftell)</p>\n\n<p>OR looking for any other way to keep track of unseekable standard input</p>\n"}, {"tags": ["c", "gcc", "macros", "c-preprocessor"], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1521413173, "post_id": 49025255, "comment_id": 85707398, "body": "How relevant this value when cross-compiling?"}, {"owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "reply_to_user": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1521448202, "post_id": 49025255, "comment_id": 85717024, "body": "These values are target dependent (like types and binary code). The host do no matter. Headers are also target dependent, and if you look carefully, you see <code>#ifdef</code> with arch name in normal headers (see <a href=\"https://stackoverflow.com/questions/152016/detecting-cpu-architecture-compile-time\" title=\"detecting cpu architecture compile time\">stackoverflow.com/questions/152016/&hellip;</a>). Note: on recent time, it is preferred not to do cross-compiling, but using an emulator and run gcc from there: there are a lot less problems with third party libraries (often their building scripts do not support cross-compiling)."}], "tags": [], "owner": {"reputation": 5450, "user_id": 2758823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Nxaq.jpg?s=128&g=1", "display_name": "Giacomo Catenazzi", "link": "https://stackoverflow.com/users/2758823/giacomo-catenazzi"}, "is_accepted": false, "score": 2, "last_activity_date": 1519807348, "creation_date": 1519807348, "answer_id": 49025255, "question_id": 49020637, "link": "https://stackoverflow.com/questions/49020637/conditional-code-depending-on-a-gcc-switch/49025255#49025255", "title": "Conditional code depending on a gcc switch", "body": "<p>You could use <code>INT_MAX</code> value from <code>&lt;limits.h&gt;</code>. This is C, so independent to compiler.</p>\n\n<p>You can also check <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html</a> to have some other predefined macros based on compiler options.</p>\n\n<p>In general in recent time, it is recommend to write code portable, also with <code>if</code> that tests conditions that true only on specific architectures. Optimizer will remove unneeded branches.</p>\n"}], "owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521412833, "creation_date": 1519781587, "last_edit_date": 1521412833, "question_id": 49020637, "link": "https://stackoverflow.com/questions/49020637/conditional-code-depending-on-a-gcc-switch", "title": "Conditional code depending on a gcc switch", "body": "<p>I'd like to cross-compile specific 32-bit and 64-bit code using an #if directive based on gcc switches.</p>\n\n<p>Are there any macros set by GCC I could use instead of setting a macro using the -D switch?</p>\n\n<p>Can I somehow pick up the switches used in the gcc command options to test them at the preprocessor stage?</p>\n\n<p>So far I found out that -m64 defines on my 64-bit machine</p>\n\n<pre><code>   __x86_64__\n</code></pre>\n\n<p>whereas -m32 undefines</p>\n\n<pre><code>   __i386__ __i486__ __i586__ __i686__\n</code></pre>\n"}, {"tags": ["c", "compiler-errors", "field"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 1, "creation_date": 1519781243, "post_id": 49020588, "comment_id": 85046414, "body": "&quot;I&#39;ve already declared the struct in the typedef above it&quot; But &quot;typedef above it&quot; declares it as an incomplete type, which is what the compiler is telling you. In any case, you can&#39;t embed a struct into itself. It makes no sense, if you think about it, since it produces an infinitely nested type."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9041032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ba0f7858a4717d75f33cf8db74206?s=128&d=identicon&r=PG&f=1", "display_name": "Mystik", "link": "https://stackoverflow.com/users/9041032/mystik"}, "edited": false, "score": 0, "creation_date": 1519782157, "post_id": 49020608, "comment_id": 85046652, "body": "Okay, thanks for the help!"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 0, "last_activity_date": 1519781356, "creation_date": 1519781356, "answer_id": 49020608, "question_id": 49020588, "link": "https://stackoverflow.com/questions/49020588/field-has-incomplete-type-structure-already-declared/49020608#49020608", "title": "Field has incomplete type; Structure already declared", "body": "<p>You can have a pointer to your struct inside your struct, but not an actual struct, which, for a stack, is probably what you are after.  </p>\n\n<pre><code>typedef struct Stack Stack;\n\nstruct Stack {\n    Stack *above;\n    Tree *t;\n    char *tag;\n};\n</code></pre>\n\n<p>Just think of it, if you had struct B inside struct A, well then there would be a struct C inside struct B, and a struct D inside struct C...on and on.</p>\n\n<pre><code>struct Stack {\n    Stack above {\n        Stack above {\n            Stack above {\n                Stack above\n                         ...............\n                Tree *t;\n                char *tag;\n            };\n            Tree *t;\n            char *tag;\n        };\n        Tree *t;\n        char *tag;\n    };\n    Tree *t;\n    char *tag;\n};\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9041032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f9ba0f7858a4717d75f33cf8db74206?s=128&d=identicon&r=PG&f=1", "display_name": "Mystik", "link": "https://stackoverflow.com/users/9041032/mystik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "closed_date": 1519781507, "accepted_answer_id": 49020608, "answer_count": 1, "score": 0, "last_activity_date": 1519781356, "creation_date": 1519781109, "question_id": 49020588, "link": "https://stackoverflow.com/questions/49020588/field-has-incomplete-type-structure-already-declared", "closed_reason": "Duplicate", "title": "Field has incomplete type; Structure already declared", "body": "<p>I'm currently programming in C, and had</p>\n\n<pre><code>typedef struct Stack Stack;\n\nstruct Stack {\n    Stack above;\n    Tree *t;\n    char *tag;\n};\n</code></pre>\n\n<p>I'm getting the error \"field 'above' has incomplete type\"\nI've already declared the struct in the typedef above it, so I'm not sure why I'm having issues. I've looked around, but haven't found anything that I can relate to this. Thanks!</p>\n"}, {"tags": ["c", "windows-kernel"], "comments": [{"owner": {"reputation": 923, "user_id": 8259873, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGaZY.png?s=128&g=1", "display_name": "nyr1o", "link": "https://stackoverflow.com/users/8259873/nyr1o"}, "edited": false, "score": 2, "creation_date": 1519786260, "post_id": 49020364, "comment_id": 85047692, "body": "Can you please read &quot;how to ask a good question on Stack Overflow&quot;? <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8625733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc501a383c1f083371b7040a60ef5b0c?s=128&d=identicon&r=PG&f=1", "display_name": "L.Hack", "link": "https://stackoverflow.com/users/8625733/l-hack"}, "edited": false, "score": 0, "creation_date": 1519881477, "post_id": 49031949, "comment_id": 85091158, "body": "OK.Thanks 666666666666666"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 1, "last_activity_date": 1519828288, "creation_date": 1519828288, "answer_id": 49031949, "question_id": 49020364, "link": "https://stackoverflow.com/questions/49020364/will-ntdll-kernel32threadinitthunkfunction-related-issues/49031949#49031949", "title": "Will ntdll.Kernel32ThreadInitThunkFunction related issues", "body": "<p><code>Kernel32ThreadInitThunkFunction</code> is global variable inside <code>ntdll.dll</code>. the <code>ntdll.dll</code> is only single dll which initially loaded to process from kernel (with exe). this dll must not have any dependencies, any static import. during process initialization <code>ntdll.dll</code> , in case this is not CLR image and sub-system is <code>IMAGE_SUBSYSTEM_WINDOWS_GUI</code> or <code>IMAGE_SUBSYSTEM_WINDOWS_CUI</code> - load <em>kernel32.dll</em> , query it for <code>BaseThreadInitThunk</code> function and store it pointer in <code>Kernel32ThreadInitThunkFunction</code>. it call it just before begin calls dll init routines for initialize terminal server</p>\n"}], "owner": {"reputation": 11, "user_id": 8625733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc501a383c1f083371b7040a60ef5b0c?s=128&d=identicon&r=PG&f=1", "display_name": "L.Hack", "link": "https://stackoverflow.com/users/8625733/l-hack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1519828288, "creation_date": 1519779443, "question_id": 49020364, "link": "https://stackoverflow.com/questions/49020364/will-ntdll-kernel32threadinitthunkfunction-related-issues", "title": "Will ntdll.Kernel32ThreadInitThunkFunction related issues", "body": "<p>Kernel32ThreadInitThunkFunction this global variable is not imported inside ntdll but his value is kernel32.BaseThreadInitThunk function This is why? How do PE know that it needs to load kernel32.BaseThreadInitThunk when it loads ntdll?</p>\n"}, {"tags": ["c", "pointers", "optimization", "struct"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1519779795, "post_id": 49020359, "comment_id": 85046053, "body": "If you want our help, then it would behoove you to post code that genuinely demonstrates the problem.  We generally ask for an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, but at minimum you should present code that actually compiles.  Yours does not.  Not even close, really."}, {"owner": {"reputation": 93, "user_id": 3768274, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/39bb37c9f1dd96b558e0ca699f9b5d89?s=128&d=identicon&r=PG&f=1", "display_name": "user3768274", "link": "https://stackoverflow.com/users/3768274/user3768274"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1519780642, "post_id": 49020359, "comment_id": 85046277, "body": "I understand. I intentionally stripped out details I saw as unnecessary, and left the most basic form of the code snippets in question. My intention is not to make this code compile-able but rather find a better way to define the structs in question and define *proc."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519781255, "post_id": 49020359, "comment_id": 85046419, "body": "Posting   <code>#if 0 static struct cycles c_start[PROC_CNT][CPU_CNT]; static struct cycles c_end[PROC_CNT][CPU_CNT]; #else</code> adds unnecessary code."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519781559, "post_id": 49020359, "comment_id": 85046499, "body": "I see 3 goals: 1) explain the code, 2)  point out any areas where ... not be optimal. 3)   if there was a smarter way to declare *proc.  Which one is most important?  If you want #2, you <i>must</i> post compile-able code. A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is useful in all cases."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1519781940, "post_id": 49020359, "comment_id": 85046596, "body": "By posting code that <i>is</i> compilable, you A) make sure that all relevant code is in the question B) make sure that you don&#39;t have typos like <code>c_stop</code> when you meant <code>c_end</code> C) make sure that the code is actually valid C code, unlike <code>proc[][].var1</code>. So your intention <i>should</i> be to post compile-able code."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1519781974, "post_id": 49020359, "comment_id": 85046604, "body": "May I ask - if you&#39;re assigning the same 3 globals to all procs, why do you need var1/var2/var3 at all? Can&#39;t you just read these values directly from the globals when you need them? Might they change later?"}, {"owner": {"reputation": 93, "user_id": 3768274, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/39bb37c9f1dd96b558e0ca699f9b5d89?s=128&d=identicon&r=PG&f=1", "display_name": "user3768274", "link": "https://stackoverflow.com/users/3768274/user3768274"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519784350, "post_id": 49020359, "comment_id": 85047243, "body": "@chux I think just #3 would be helpful. I can see why the other questions may be more difficult to answer given how vague I was in my post. proc[i][j].var1/2/3 end up being written thousands of times in my loops. Is there a different way to define *proc that may localize / make access to it faster? Is there any other way besides align() to ensure cache locality? Thanks everyone sorry for the confusion."}, {"owner": {"reputation": 93, "user_id": 3768274, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/39bb37c9f1dd96b558e0ca699f9b5d89?s=128&d=identicon&r=PG&f=1", "display_name": "user3768274", "link": "https://stackoverflow.com/users/3768274/user3768274"}, "reply_to_user": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1519784403, "post_id": 49020359, "comment_id": 85047257, "body": "@SHG Missed the [j] on my globals. They are all different. Sorry about that."}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1519784633, "post_id": 49020359, "comment_id": 85047319, "body": "Still, every time you need the global value of <code>proc[i][j].var1</code> (for any i) just use <code>global1[j]</code>. Why do you need to copy the globals&#39; values?"}, {"owner": {"reputation": 505, "user_id": 7906473, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PB84L.jpg?s=128&g=1", "display_name": "Parth K", "link": "https://stackoverflow.com/users/7906473/parth-k"}, "edited": false, "score": 0, "creation_date": 1519807367, "post_id": 49020359, "comment_id": 85055088, "body": "@user3768274 please add a link to the complete code so we can compile, test, and debug it for ourselves"}], "owner": {"reputation": 93, "user_id": 3768274, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/39bb37c9f1dd96b558e0ca699f9b5d89?s=128&d=identicon&r=PG&f=1", "display_name": "user3768274", "link": "https://stackoverflow.com/users/3768274/user3768274"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519783819, "creation_date": 1519779387, "last_edit_date": 1519783819, "question_id": 49020359, "link": "https://stackoverflow.com/questions/49020359/confusing-struct-definitions-references-degrading-performance", "title": "Confusing Struct Definitions &amp; References Degrading Performance", "body": "<p>I've been working on an issue where I need to optimize a piece of code for speed, and came across some struct definitions / references that confused me. I was hoping someone could explain the code below or point out any areas where the definitions may not be optimal.</p>\n\n<p>There are 3 relevant snippets of code as far as I can tell. I've had trouble keeping track between CycArr, cyc_inf, and CycInf, and was wondering if there was a smarter way to declare *proc.</p>\n\n<pre><code>#if 0\nstatic struct cycles c_start[PROC_CNT][CPU_CNT];\nstatic struct cycles c_end[PROC_CNT][CPU_CNT];\n#else\nstatic CycArr c_start;\nstatic CycArr c_end;\n#endif\n</code></pre>\n\n<p>... definitions of structs</p>\n\n<pre><code>struct cyc_inf\n{\n   int var1;\n   int var2;\n   int var3;\n}\n\ntypedef struct cyc_inf CycInf;\ntypedef CycInf CycArr [PROC_CNT][CPU_CNT];\n</code></pre>\n\n<p>... the nested for loops is where the speed drops, making me think there's a better way to use cyc_inf proc. </p>\n\n<pre><code>void function(int foo) \n{\n     struct cyc_inf *proc[PROC_CNT + CPU_CNT];\n\n     if (foo)\n         proc = c_start;\n     else\n         proc = c_end;\n\n     for (int i=0; i&lt;= PROC_CNT; i++)\n     {\n         for (int j=0; j&lt;= CPU_CNT; j++)\n         {\n             proc[i][j].var1 = global1[j];\n             proc[i][j].var2 = global2[j];\n             proc[i][j].var3 = global3[j];\n             ...\n         }\n     } \n}\n</code></pre>\n\n<p>... I have tried aligning the struct but didn't see any improvements. Is there a way to use malloc that is better? Any and all input is appreciated, thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519777808, "post_id": 49020122, "comment_id": 85045479, "body": "Did you do any debugging at all?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1519777849, "post_id": 49020122, "comment_id": 85045492, "body": "<code>char suits[] = { &#39;H&#39;,&#39;D&#39;,&#39;C&#39;,&#39;S&#39; };     int factor = cardnum % 5; return suits[factor];</code> --&gt; review the use of <code>5</code>."}, {"owner": {"reputation": 13, "user_id": 9421467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ch9dOXbVDgQ/AAAAAAAAAAI/AAAAAAAAAJM/ik7fMOSR-NU/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9421467/paul"}, "reply_to_user": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519779103, "post_id": 49020122, "comment_id": 85045832, "body": "@FurkanKambay For this specific issue, not too much, because I am not sure where the issue may lie. I tried checking if making srand(time(null)) to srand(1) would give me results but that didn&#39;t."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1519779168, "post_id": 49020122, "comment_id": 85045852, "body": "If <code>memcpy(aNewDeck, LoadDeck(), 52);</code> doesn&#39;t flag a fat compiler warning, your warnings are nowhere <i>near</i> high enough. And fyi, <code>LoadDeck</code> invokes <i>undefined behavior</i> by accessing the declared array out of range. That function should have the deck to initialize passed by argument, or wrapped in its own structure. Also, <code>LoadFace</code> should use <code>% 13</code>, not <code>% 14</code>. There are only 13 faces in standard deck (and in you array). Zero-based array indexing. Pretty important when learning C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519779303, "post_id": 49020122, "comment_id": 85045898, "body": "@Paul if you knew where the issue is, the debugger isn&#39;t necessary. Conversely, that is why you need it. When debugging, comment out <code>srand</code> so the results are repeatable."}, {"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519779309, "post_id": 49020122, "comment_id": 85045903, "body": "First do what chux said. That 5 needs to be 4. Then do some debugging. It may be something obvious."}, {"owner": {"reputation": 13, "user_id": 9421467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ch9dOXbVDgQ/AAAAAAAAAAI/AAAAAAAAAJM/ik7fMOSR-NU/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9421467/paul"}, "reply_to_user": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519780231, "post_id": 49020122, "comment_id": 85046185, "body": "@FurkanKambay  Update: I tried to make a premade struct singlecard array and this is the result (and I could not run it without making the array size 4 or else I would get a warning/s saying &quot;buffer &#39;aNewDeck&#39; of size 24 bytes will be overrun; 1 bytes will be written starting at offset 24&quot;  <a href=\"https://i.gyazo.com/8df23281baca006c58ca814fadfcd391.png\" rel=\"nofollow noreferrer\">i.gyazo.com/8df23281baca006c58ca814fadfcd391.png</a>"}, {"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519780846, "post_id": 49020122, "comment_id": 85046317, "body": "@Paul first off, did you do what the other comments said about the mod operator? The 5 in <code>LoadSuit</code> needs to be 4 and the 14 above needs to be 13. And about what you just said, since you are setting the value on index 3, the array needs to be of size 4 since index numbers start at 0. So that buffer error was normal."}, {"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519780968, "post_id": 49020122, "comment_id": 85046344, "body": "Once you correct those, try the same thing again with the hard-coded values. And please copy the console output instead of posting a link to a screen shot of it."}, {"owner": {"reputation": 13, "user_id": 9421467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ch9dOXbVDgQ/AAAAAAAAAAI/AAAAAAAAAJM/ik7fMOSR-NU/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9421467/paul"}, "reply_to_user": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519783384, "post_id": 49020122, "comment_id": 85046969, "body": "@FurkanKambay   Still messing around to fix it, but wanted to mention that I did correct those things already when I pasted that screenshot."}, {"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519783611, "post_id": 49020122, "comment_id": 85047034, "body": "In the image, you assign <code>cardnum</code>s of 0,1,2 but the others are for 1,2,3 so some of them look corrupt. Do it all for 0,1,2 so the length is 3 and see if the output looks good."}, {"owner": {"reputation": 13, "user_id": 9421467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ch9dOXbVDgQ/AAAAAAAAAAI/AAAAAAAAAJM/ik7fMOSR-NU/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9421467/paul"}, "reply_to_user": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519783740, "post_id": 49020122, "comment_id": 85047066, "body": "@FurkanKambay WOOPS forgot to change those after changing the first indexes lol.      [5 Q-S][3 6-H][24 A-D][-858993460 \u2560-\u2560][-858993460 \u2560-\u2560]    [-858993460 \u2560-\u2560][-85899346 0 \u2560-\u2560][-858993460 \u2560-\u2560]   It works now (With the hardcoded array), but I still get these additional outputs.  I also made the dealcards forloop use &quot;i &lt; sizeof(deck);&quot; instead of 52."}, {"owner": {"reputation": 692, "user_id": 4187549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zvrVY.png?s=128&g=1", "display_name": "Furkan Kambay", "link": "https://stackoverflow.com/users/4187549/furkan-kambay"}, "edited": false, "score": 0, "creation_date": 1519829219, "post_id": 49020122, "comment_id": 85069093, "body": "Can you try printing <code>sizeof(deck)</code> to the console?"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9408375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884722e845ecf4934e0a248b1a7cb9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/9408375/ozymandias"}, "is_accepted": false, "score": 0, "last_activity_date": 1519781108, "creation_date": 1519781108, "answer_id": 49020586, "question_id": 49020122, "link": "https://stackoverflow.com/questions/49020122/c-display-function-prints-nothing-out-trouble-using-a-parameter-for-display-f/49020586#49020586", "title": "C - Display function prints nothing out; Trouble using a parameter for display function", "body": "<p>I would add to comments, but have not the points so \"answer\" is the way ...</p>\n\n<p>In addition to the %13 and %4 and zero-based-indexing and random number generation there are other issues that need to be addressed:</p>\n\n<ul>\n<li>You specify the function LoadDeck returns a single structure, but you code that it returns an array</li>\n<li>The memcpy uses name of a function as an argument, a function that is stated to return a single structure which should trigger a SEGV (I think), but instead gets an array of structures so may fool the runtime system</li>\n<li>The memcpy of LoadDeck uses \"52\" as a \"bytes to copy\" argument but instead should specify \"52 * sizeof(struct)\" to copy</li>\n<li>You specified in LoadDeck that the array is declared in the function but returns that array into a single-structure slot.  This is incorrect because you cannot return a local-to-function variable since it goes out of scope at function exit and that memory location can be compromised by other operations.  This is also incorrect because a \"single slot\" is not the same in the call-stack as a full array.</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9421467, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ch9dOXbVDgQ/AAAAAAAAAAI/AAAAAAAAAJM/ik7fMOSR-NU/photo.jpg?sz=128", "display_name": "Paul", "link": "https://stackoverflow.com/users/9421467/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519781108, "creation_date": 1519777518, "question_id": 49020122, "link": "https://stackoverflow.com/questions/49020122/c-display-function-prints-nothing-out-trouble-using-a-parameter-for-display-f", "title": "C - Display function prints nothing out; Trouble using a parameter for display function", "body": "<p>I had to write a deck of cards generating program today, but I am not sure why the console window turns up nothing when I run it. The aim is to have it print all the cards from the struct array as such: \"...[42 4-C] [ 8 9-H] [43 5-S] [33 8-D] [34 9-C] [21 9-D]...\". The last build error I had before I got rid of it was when I tried to use LoadDeck() in the parameter of DealCards(), and it said singlecard was not compatible with singlecard*. I got rid of the error by making a new struct singlecard array, and using memcpy with LoadDeck() which returns a singlecard array. Need a bit of help.</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\nstruct singlecard LoadDeck();\nbool CheckDup(int trialNum, struct singlecard deck[]);\nchar LoadFace(int cardnum);\nchar LoadSuit(int cardnum);\nDealCards(struct singlecard deck[]);\nstruct singlecard\n{\n    int cardnum;\n    char face;\n    char suit;\n};\nint main()\n{\n    struct singlecard aNewDeck[52];\n    memcpy(aNewDeck, LoadDeck(), 52);\n    DealCards(aNewDeck);\n}\nstruct singlecard LoadDeck()\n{\n    struct singlecard deck[52];\n    srand(time(NULL));\n    int i=0;\n    int r = 1 + rand() % 52;\n\n    while (i &lt; 52)\n    {\n        if (CheckDup(r, deck) == false)\n        {\n            deck[i].cardnum = r;\n            deck[i].face = LoadFace(r);\n            deck[i].suit = LoadSuit(r);\n            i++;\n        }\n    }\n\n    return deck[52];\n}\nbool CheckDup(int trialNum, struct singlecard deck[])\n{\n    bool duplicate = false;\n    int i = 0;\n    while (i &lt; 52 || duplicate == false)\n    {\n        if (trialNum = deck[i].cardnum)\n        {\n            duplicate = true;\n        }\n        else\n        {\n            i++;\n        }\n    }\n    return duplicate;\n}\nchar LoadFace(int cardnum)\n{\n    char faces[] = { 'A','2','3','4','5','6','7','8','9','T','J','Q','K' };\n    int factor = cardnum % 14;\n    return faces[factor];\n}\nchar LoadSuit(int cardnum)\n{\n    char suits[] = { 'H','D','C','S' };\n    int factor = cardnum % 5;\n    return suits[factor];\n}\nDealCards(struct singlecard deck[])\n{\n    for (int i = 0; i &lt; 52; i++)\n    {\n        printf(\"[%d %c-%c]\", deck[i].cardnum, deck[i].face, deck[i].suit);\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "python-c-api", "python-extensions"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9037647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffadd3b39f76a0c62003ef75def79e3?s=128&d=identicon&r=PG&f=1", "display_name": "Hanson Duan", "link": "https://stackoverflow.com/users/9037647/hanson-duan"}, "edited": false, "score": 0, "creation_date": 1519777939, "post_id": 49020144, "comment_id": 85045514, "body": "Thanks! I just realized that I was casting to the wrong data type and that was a potential issue, which I assume some type conversion messes up the value of number when it gets parsed. I can&#39;t find documentation on Py_ssize_t, but would I be able to just cast to size_t without an issue?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 19, "user_id": 9037647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffadd3b39f76a0c62003ef75def79e3?s=128&d=identicon&r=PG&f=1", "display_name": "Hanson Duan", "link": "https://stackoverflow.com/users/9037647/hanson-duan"}, "edited": false, "score": 0, "creation_date": 1519778501, "post_id": 49020144, "comment_id": 85045648, "body": "@HansonDuan: The closest thing to documentation for <code>Py_ssize_t</code> is <a href=\"https://www.python.org/dev/peps/pep-0353/\" rel=\"nofollow noreferrer\">PEP 353</a>, which specifies it as the same size as <code>size_t</code> but signed, and as a typedef for <code>ssize_t</code> when <code>ssize_t</code> is available."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1519777699, "creation_date": 1519777699, "answer_id": 49020144, "question_id": 49020085, "link": "https://stackoverflow.com/questions/49020085/incorrect-message-length-when-using-c-python-api/49020144#49020144", "title": "Incorrect message length when using C python api", "body": "<p>You've specified the length as a <code>size_t</code>. The <code>s#</code> format does not take a <code>size_t</code>. <a href=\"https://docs.python.org/3/c-api/arg.html#strings-and-buffers\" rel=\"nofollow noreferrer\">It takes an <code>int</code> or <code>Py_ssize_t</code></a>, depending on whether the <code>PY_SSIZE_T_CLEAN</code> macro was <code>#define</code>d before including <code>Python.h</code>.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> For all <code>#</code> variants of formats (<code>s#</code>, <code>y#</code>, etc.), the type of the length argument (int or <code>Py_ssize_t</code>) is controlled by defining the macro <code>PY_SSIZE_T_CLEAN</code> before including <code>Python.h</code>. If the macro was defined, length is a <code>Py_ssize_t</code> rather than an <code>int</code>. This behavior will change in a future Python version to only support <code>Py_ssize_t</code> and drop <code>int</code> support. It is best to always define <code>PY_SSIZE_T_CLEAN</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 19, "user_id": 9037647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffadd3b39f76a0c62003ef75def79e3?s=128&d=identicon&r=PG&f=1", "display_name": "Hanson Duan", "link": "https://stackoverflow.com/users/9037647/hanson-duan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519777699, "creation_date": 1519777261, "question_id": 49020085, "link": "https://stackoverflow.com/questions/49020085/incorrect-message-length-when-using-c-python-api", "title": "Incorrect message length when using C python api", "body": "<p>I'm trying to extend libhydrogen (open source found here: <a href=\"https://github.com/jedisct1/libhydrogen/\" rel=\"nofollow noreferrer\">https://github.com/jedisct1/libhydrogen/</a>) to support calls to the underlying library in Python. However, I ran into a strange issue.\nSpecifically I have the following code:</p>\n\n<pre><code>static PyObject* crypto_secretbox_encrypt(PyObject* self, PyObject* args){\n    char* m;\n    size_t mlen;\n    uint64_t msg_id;\n    char *ctx;\n    size_t ctx_len;\n    const uint8_t *key; //this shouldn't matter its secret\n    size_t key_len;\n    PyArg_ParseTuple(args, \"s#|K|s#|s#\", &amp;m, &amp;mlen, &amp;msg_id, &amp;ctx, &amp;ctx_len, &amp;key, &amp;key_len); //only s# accepts null bytes, need to random pointers to store lengths\n    //printf(\"Parsed \\n\");\n    //printf(\"MSG: %s, MSG_ID: %\" PRIu64 \", CTX: %s\\n\", m, msg_id, ctx);\n    if(ctx_len != hydro_secretbox_CONTEXTBYTES){\n        PyErr_Format(PyExc_ValueError, \"Context not of correct size: Received %lu bytes\", ctx_len);\n        return NULL;\n    }\n\n    if(key_len != hydro_secretbox_KEYBYTES){\n        PyErr_Format(PyExc_ValueError, \"Key not of correct size: Received %lu bytes\", key_len);\n        return NULL;\n    }\n</code></pre>\n\n<p>Which is able to successfully parse the length of ctx, however, when it gets to the key it gets thrown the error, </p>\n\n<pre><code>  File \"cryptotest.py\", line 7, in &lt;module&gt;\n    c1 = crypto.secretbox_encrypt(\"message1\", 0, \"\\x00\"*8, '\\x00'*32);\nValueError: Key not of correct size: Received 140123308032032 bytes\n</code></pre>\n\n<p>Any ideas on why I'm unable to successfully parse the key length?</p>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1519777141, "post_id": 49020052, "comment_id": 85045295, "body": "And be sure to #include the .h file in whatever .c files need the struct&#39;s definition."}, {"owner": {"reputation": 105, "user_id": 7143959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3aa71f829217e21543ff67a662c914f5?s=128&d=identicon&r=PG&f=1", "display_name": "Omega Collision", "link": "https://stackoverflow.com/users/7143959/omega-collision"}, "edited": false, "score": 0, "creation_date": 1519777315, "post_id": 49020052, "comment_id": 85045359, "body": "I&#39;m including the .h file in both so I&#39;m thinking it&#39;s a problem with my makefile"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 105, "user_id": 7143959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3aa71f829217e21543ff67a662c914f5?s=128&d=identicon&r=PG&f=1", "display_name": "Omega Collision", "link": "https://stackoverflow.com/users/7143959/omega-collision"}, "edited": false, "score": 0, "creation_date": 1519777419, "post_id": 49020052, "comment_id": 85045391, "body": "@OmegaCollision It is not only if the .h file is included.  It is a question of what is in the .h file."}, {"owner": {"reputation": 105, "user_id": 7143959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3aa71f829217e21543ff67a662c914f5?s=128&d=identicon&r=PG&f=1", "display_name": "Omega Collision", "link": "https://stackoverflow.com/users/7143959/omega-collision"}, "edited": false, "score": 1, "creation_date": 1519780670, "post_id": 49020052, "comment_id": 85046283, "body": "Don&#39;t know why I didn&#39;t think to write a getter function. That was what I was trying to go for thank you"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1519777690, "last_edit_date": 1519777690, "creation_date": 1519777011, "answer_id": 49020052, "question_id": 49020005, "link": "https://stackoverflow.com/questions/49020005/incomplete-type-when-dereferencing-pointer-c/49020052#49020052", "title": "Incomplete type when dereferencing pointer C", "body": "<p>The other .c file does not see the <code>struct dyn_array</code> definition.  It has no understanding of the members like <code>size</code>.</p>\n\n<hr>\n\n<p>If more than 1 .c file needs to understand the structure, move the below to the .h file</p>\n\n<pre><code>struct dyn_array {\n  size_t size;\n  void* array;\n};\n</code></pre>\n\n<p>The alternative is to create a function that gets the member and keep the definition of <code>dyn_array_t</code> local  in <code>dyn_array.c</code>.  This is <a href=\"https://en.wikipedia.org/wiki/Information_hiding\" rel=\"nofollow noreferrer\">information hiding</a> - a good design goal.</p>\n\n<pre><code>// in dyn_array.h\ntypedef struct dyn_array dyn_array_t;\nsize_t get_size(const dyn_array_t* ready_queue);\n\n// in different.c\n#include &lt;dyn_array.h&gt;\nbool first_come_first_serve(dyn_array_t* ready_queue){\n  size_t limit = get_size(ready_queue); \n  //...\n}\n\n// in dyn_array.c\n#include &lt;dyn_array.h&gt;\n\nstruct dyn_array {\n    size_t size;\n    void* array;\n};\n\nsize_t get_size(const dyn_array_t* ready_queue) {\n   return ready_queue-&gt;size; \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "is_accepted": false, "score": 1, "last_activity_date": 1519777246, "creation_date": 1519777246, "answer_id": 49020084, "question_id": 49020005, "link": "https://stackoverflow.com/questions/49020005/incomplete-type-when-dereferencing-pointer-c/49020084#49020084", "title": "Incomplete type when dereferencing pointer C", "body": "<p>\"Incomplete Type\" means you have only declared / used the type, and not explained it. Your second <code>.c</code> file might <code>#include \"a.h\"</code> but note that the <strong>definition</strong> of <code>dyn_array</code> is in <code>a.c</code> and not <code>a.h</code></p>\n\n<p>To fix this, both declare and define <code>dyn_array</code> in <code>a.h</code>:</p>\n\n<pre><code>struct dyn_array {\n    size_t size;\n    void* array;\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1519807493, "last_edit_date": 1519807493, "creation_date": 1519807083, "answer_id": 49025198, "question_id": 49020005, "link": "https://stackoverflow.com/questions/49020005/incomplete-type-when-dereferencing-pointer-c/49025198#49025198", "title": "Incomplete type when dereferencing pointer C", "body": "<p>The compiler needs to complete the type definition to be able to dereference a pointer to it and access its fields.  You have to put the type definition in a header (possibly different than the one you used to put the <code>typedef</code> declaration) and include it in the second file also, to be able to access past the pointer.  The compiler allows you to access a pointer to incomplete type definition, as long as you don't need the details of that type.  As in your second file, the compiler knows nothing about how the structure is built, so it cannot access the <code>size</code> field.</p>\n\n<p>If you need some parts of your code not to be able to access the internal details of your data type, and others be completely aware of it, then prepare two header files (one public and other private) like this:</p>\n\n<h1>dynarry.h</h1>\n\n<pre><code>typedef struct dyn_array dyn_array_t;\nsize_t get_size(const dyn_array_t* ready_queue);\n</code></pre>\n\n<h1>dynarryP.h</h1>\n\n<pre><code>#include \"dynarry.h\"\nstruct dyn_array {\n    size_t size;\n    void *array;\n};\n</code></pre>\n\n<p>and then, in the modules using as clients the library include only the <code>\"dynarry.h\"</code>, while in the internal implementation you <code>#include \"dynarryP.h\"</code>.  This is somewhat similar to object oriented programming, in relation to <em>hidding internal implementation details</em>.</p>\n"}], "owner": {"reputation": 105, "user_id": 7143959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3aa71f829217e21543ff67a662c914f5?s=128&d=identicon&r=PG&f=1", "display_name": "Omega Collision", "link": "https://stackoverflow.com/users/7143959/omega-collision"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 49020052, "answer_count": 3, "score": 1, "last_activity_date": 1519807493, "creation_date": 1519776629, "question_id": 49020005, "link": "https://stackoverflow.com/questions/49020005/incomplete-type-when-dereferencing-pointer-c", "title": "Incomplete type when dereferencing pointer C", "body": "<p>I have a header file which gives the definition</p>\n\n<pre><code>typedef struct dyn_array dyn_array_t\n</code></pre>\n\n<p>I have a .c file which implements it</p>\n\n<pre><code>struct dyn_array {\n    size_t size;\n    void* array;\n};\n</code></pre>\n\n<p>In a different .c file I pass a pointer of this type to a function. </p>\n\n<pre><code>bool first_come_first_serve(dyn_array_t* ready_queue){\n    size_t limit = ready_queue-&gt;size; \n    //...\n} \n</code></pre>\n\n<p>I can't figure out what I'm doing wrong here.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1055, "user_id": 6141656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d5f8083a93983213b0723cd1aded79b?s=128&d=identicon&r=PG&f=1", "display_name": "C_Elegans", "link": "https://stackoverflow.com/users/6141656/c-elegans"}, "edited": false, "score": 0, "creation_date": 1519776669, "post_id": 49019985, "comment_id": 85045159, "body": "You mean standard <i>input</i>?"}, {"owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "reply_to_user": {"reputation": 1055, "user_id": 6141656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d5f8083a93983213b0723cd1aded79b?s=128&d=identicon&r=PG&f=1", "display_name": "C_Elegans", "link": "https://stackoverflow.com/users/6141656/c-elegans"}, "edited": false, "score": 0, "creation_date": 1519776765, "post_id": 49019985, "comment_id": 85045187, "body": "yes standard input sorry"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1519776925, "post_id": 49019985, "comment_id": 85045228, "body": "What is the requirement and what isn&#39;t working?"}, {"owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "edited": false, "score": 0, "creation_date": 1519777073, "post_id": 49019985, "comment_id": 85045275, "body": "&quot;$ echo hello | ./a.out -a14&quot; doesn&#39;t print hello as I want it too, for example. Is there a way to find out if a program doesn&#39;t have any arguments apart from command options?"}], "answers": [{"comments": [{"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "reply_to_user": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "edited": false, "score": 0, "creation_date": 1519780493, "post_id": 49020462, "comment_id": 85046246, "body": "I guess you mean <code>if (argc+1 != optind) </code>. I&#39;m not sure what are your requirements so it&#39;s hard to tell, but sounds very easy just to try and see if then you&#39;re getting the results you expect to get."}], "tags": [], "owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "is_accepted": true, "score": 0, "last_activity_date": 1519780171, "creation_date": 1519780171, "answer_id": 49020462, "question_id": 49019985, "link": "https://stackoverflow.com/questions/49019985/how-do-i-get-the-input-from-stdout-when-doing-getopts/49020462#49020462", "title": "How do I get the input from stdout when doing getOpts", "body": "<p>The reason is this if statement:</p>\n\n<pre><code>if(optind != 2) { ... }\n</code></pre>\n\n<p><code>optind</code> will be exactly 2 if you're using only arg <code>-a</code> <strong>OR</strong> arg <code>-b</code> (and not both), because then you have one argument and once you read it, the next opt index is 2. Then your if condition is false.</p>\n"}], "owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 49020462, "answer_count": 1, "score": -1, "last_activity_date": 1519780171, "creation_date": 1519776483, "question_id": 49019985, "link": "https://stackoverflow.com/questions/49019985/how-do-i-get-the-input-from-stdout-when-doing-getopts", "title": "How do I get the input from stdout when doing getOpts", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;getopt.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n\n    int o;\n    int a;\n    int b = 1;\n\n    while ((o = getopt(argc, argv, \"a:b\")) != -1) {\n        switch (o) {\n           case 'a' :\n                a = atoi(optarg);\n                break;\n\n\n            case 'b' :\n                b = 0;\n                break;\n            default :\n                printf(\"Error\\n\");\n                exit(1);\n        }\n    }\n\n    if(optind != 2) {\n        int c;\n        while((c = getchar()) != EOF) {\n            putchar(c);\n        }\n    }\n\n}\n</code></pre>\n\n<p>assuming this is legal: </p>\n\n<pre><code>$ gcc -Wall fileAbove.c\n$ ./a.out -a14 -b hi\n$ ./a.out -a14 hi\n$ ./a.out -b hi\n</code></pre>\n\n<p>Everything above is legal. How do I find the standard output ?</p>\n\n<pre><code>$ echo hello | ./a.out -a14 -b \nhello\n\n$ echo hello | ./a.out -a14\nhello\n</code></pre>\n\n<p>Like how do I know there is no \"./a.out -a10 -b (this part)\", if there isn't that part we process the standard output.</p>\n"}, {"tags": ["c", "compiler-warnings", "portability"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519776478, "post_id": 49019963, "comment_id": 85045094, "body": "Are you sure this &quot;eats&quot; whitespace?  Looks like it eats non-space."}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 2, "creation_date": 1519776527, "post_id": 49019963, "comment_id": 85045115, "body": "If the code is accessing a single byte, I don&#39;t see how the second condition, which uses a multi-char literal, could ever be true. Is line_buf a pointer to char?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519776641, "post_id": 49019963, "comment_id": 85045150, "body": "&quot;Eating&quot; <i>whitespace</i> is more like <code>while (isspace(line_buf[line_idx]) line_idx++;</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1519776661, "post_id": 49019963, "comment_id": 85045154, "body": "The canonical solution to what?  You can <i>probably</i> just delete the second condition, since it&#39;s not clear what it was ever intended to do, and it&#39;s reasonably clear that it will never, ever fire."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1519778772, "post_id": 49019963, "comment_id": 85045718, "body": "Use caution when cutting out magic. That code exists because at some time in the past (and possibly in the present) that value existed in <code>line_buf[]</code>. Figure out what the original problem was and fix <i>that</i>. Don\u2019t just remove code you think is misplaced."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1519779980, "post_id": 49019963, "comment_id": 85046107, "body": "@D&#250;thomhas: Not necessarily. The person who wrote that line of code might not have had a valid reason for it. It could have been a copy-and-paste error, for example."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1519780017, "post_id": 49019963, "comment_id": 85046129, "body": "@JonathonReinhart: It <i>could</i> be true because the value of a multi-character constant is implementation defined. If I use tcc, the value of <code>&#39;   &#39;</code> (two spaces) is the same as the value of <code>&#39; &#39;</code> (one space). (Those aren&#39;t being rendered correctly in this comment, but you get the idea.)"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 124, "user_id": 6438359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e85e5b3614e75c70f38d39736f72d02?s=128&d=identicon&r=PG&f=1", "display_name": "Tianjiao Huang", "link": "https://stackoverflow.com/users/6438359/tianjiao-huang"}, "edited": false, "score": 3, "creation_date": 1519784580, "post_id": 49019963, "comment_id": 85047306, "body": "@TianjiaoHuang: Actually, the <code>&amp;&amp;</code> and <code>||</code> operators are different and do enforce order. In your link look at Rules #2."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1519785809, "post_id": 49019963, "comment_id": 85047577, "body": "@KeithThompson It is a very dangerous philosophy to look at old code and assume that any one piece of it is a mistake."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1519788076, "post_id": 49019963, "comment_id": 85048099, "body": "@D&#250;thomhas: In this case, I disagree. If <code>line_buf</code> is an array of <code>char</code>, there is no way that comparing an element to <code>&#39;  &#39;</code> (2 spaces) could make sense. It&#39;s equally dangerous to assume that old code <i>isn&#39;t</i> a mistake. It could be a typo, or a copy-and-paste error, or the author might have wrongly thought that the code would check for two spaces (which it absolutely does not do)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1519807888, "post_id": 49019963, "comment_id": 85055398, "body": "@JonathonReinhart, probably the second case is not a space, but a literal tab character, not encoded as <code>\\t</code>, but as a literal tab between two quote chars."}, {"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1519820555, "post_id": 49019963, "comment_id": 85063110, "body": "@LuisColorado - I believe you are correct. It is two literal spaces in the code I have, but that might have been something that happened anywhere along the ling. Assuming that is the case, is replacing it with \\t the &quot;best solution&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1519820408, "post_id": 49021263, "comment_id": 85063011, "body": "Speed is not an issue, the largest file I&#39;ve seen, which was WAY on the long tail, was around 90k. This is pure ASCII, or at least its <i>supposed</i> to be, so strchr seems like the right solution."}], "tags": [], "owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "is_accepted": true, "score": 1, "last_activity_date": 1519786602, "creation_date": 1519786602, "answer_id": 49021263, "question_id": 49019963, "link": "https://stackoverflow.com/questions/49019963/removing-multi-char-constants-in-c/49021263#49021263", "title": "removing multi-char constants in C", "body": "<p><strong>Original question</strong></p>\n\n<p>There is no canonical or correct way. Multi-character constants have always been implementation defined. Look up the documentation for the compiler used when the code was written and figure out what was meant.</p>\n\n<p><strong>Updated question</strong></p>\n\n<p>You can match multiple characters using <a href=\"http://man7.org/linux/man-pages/man3/strchr.3.html\" rel=\"nofollow noreferrer\">strchr()</a>.</p>\n\n<pre><code>while (strchr( \" ,\", line_buf[++line_idx] ))\n{\n</code></pre>\n\n<p>Again, this does not account for that multi-char constant. You should figure out why that was there before simply removing it.</p>\n\n<p>Also, strchr() does not handle Unicode. If you are dealing with a UTF-8 stream, for example, you will need a function capable of handling it.</p>\n\n<p>Finally, if you are concerned about speed, <em>profile</em>. The compiler might get you better results using the three (or four) individual test expressions in the \u2018while\u2019 condition.</p>\n\n<p><strong>In other words, the multiple tests might be the best solution!</strong></p>\n\n<p>Beyond that, I smell some uncouth indexing: the way that <code>line_idx</code> is updated depends on the surrounding code to actuate the loop properly. Make sure that you don\u2019t create an off-by-one error when you update stuff.</p>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1519822892, "post_id": 49021978, "comment_id": 85064665, "body": "So the difference is that this will return 2 for the test &quot;GW&quot;, whereas strchr would return (say) 11, the location where it starts. Yes, this seems like the more useful solution."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "edited": false, "score": 0, "creation_date": 1519826970, "post_id": 49021978, "comment_id": 85067442, "body": "yes, because it will not skip non-matching characters -- which is why you give it the <i>address within</i> the string you wish to test."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1519791960, "creation_date": 1519791960, "answer_id": 49021978, "question_id": 49019963, "link": "https://stackoverflow.com/questions/49019963/removing-multi-char-constants-in-c/49021978#49021978", "title": "removing multi-char constants in C", "body": "<blockquote>\n  <p>UPDATE: to clarify, the question is \"what is the proper way to test\n  for the presence of a string of one or more characters at a given\n  index in another string\". Forgive me if I am using the wrong\n  terminology.</p>\n</blockquote>\n\n<p>Well, there are a number of ways, but the standard way is using <code>strspn</code> which has the prototype:</p>\n\n<pre><code>size_t strspn(const char *s, const char *accept);\n</code></pre>\n\n<p>and it cleverly:</p>\n\n<pre><code>calculates the length (in bytes) of the initial segment of s \nwhich consists entirely of bytes in accept.\n</code></pre>\n\n<p>This allows you to test for the <em>\"the presence of a string of one or more characters at a given index in another string\"</em> and tells you how many of the characters from that string were sequentially matched.</p>\n\n<p>For example, if you had <em>another string</em> say <code>char s = \"somestring\";</code> and wanted to know if it contained the letters <code>r, s, t</code>, say, in <code>char *accept = \"rst\";</code> beginning at the 5th character, you could test:</p>\n\n<pre><code>size_t n;\nif ((n = strspn (&amp;s[4], accept)) &gt; 0)\n    printf (\"matched %zu chars from '%s' at beginning of '%s'\\n\",\n           n, accept, &amp;s[4]);\n</code></pre>\n\n<p>To compare in order, you can use <code>strncmp (&amp;s[4], accept, strlen (accept));</code>. You can also simply use nestest loops to iterate over <code>s</code> with the characters in <code>accept</code>.</p>\n\n<p>All of the ways are <em>\"proper\"</em>, so long as they do not invoke <em>Undefined Behavior</em> (and are reasonable efficient).</p>\n"}], "owner": {"reputation": 8233, "user_id": 1469457, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/72853d2b57e37aab89afe61af4f74c62?s=128&d=identicon&r=PG", "display_name": "Maury Markowitz", "link": "https://stackoverflow.com/users/1469457/maury-markowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 49021263, "answer_count": 2, "score": 1, "last_activity_date": 1519791960, "creation_date": 1519776377, "last_edit_date": 1519783577, "question_id": 49019963, "link": "https://stackoverflow.com/questions/49019963/removing-multi-char-constants-in-c", "title": "removing multi-char constants in C", "body": "<p>Here's some code I found in a very old C library that's trying to eat whitespace from a file...</p>\n\n<pre><code>  while(\n    (line_buf[++line_idx] != ' ')  &amp;&amp;\n    (line_buf[  line_idx] != '  ') &amp;&amp;\n    (line_buf[  line_idx] != ',')  &amp;&amp;\n    (line_buf[  line_idx] != '\\0') )\n  {\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/7755202/multi-character-constant-warnings\">This great thread</a> explains <em>what</em> the problem is, but most of the answers are \"just ignore it\" or \"you should never do this\". What I don't see, however, is the canonical solution. Can anyone offer a way to code this test using the \"proper way\"?</p>\n\n<p><strong>UPDATE:</strong> to clarify, the question is \"what is the proper way to test for the presence of a string of one or more characters at a given index in another string\". Forgive me if I am using the wrong terminology.</p>\n"}, {"tags": ["c", "multithreading", "zeromq"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": true, "score": 1, "last_activity_date": 1519815175, "creation_date": 1519815175, "answer_id": 49027822, "question_id": 49019846, "link": "https://stackoverflow.com/questions/49019846/asynchronous-majordomo-pattern-example-using-the-czmq-4-1-0-new-zsock-api-update/49027822#49027822", "title": "Asynchronous Majordomo Pattern example using the CZMQ-4.1.0 new zsock API updated not working", "body": "<h2>Let's diagnose the as-is state, going step by step:</h2>\n\n<pre><code>int czmqMAJOR,\n    czmqMINOR,\n    czmqPATCH;\n\nzsys_version ( &amp;czmqMAJOR, &amp;czmqMINOR, &amp;czmqPATCH );\nprintf( \"INF: detected CZMQ( %d, %d, %d )-version\",\n         czmqMAJOR,\n         czmqMINOR,\n         czmqPATCH\n         );\nassert ( czmqMAJOR == CZMQ_VERSION_MAJOR &amp; \"Major: does not match\\n\" );\nassert ( czmqMINOR == CZMQ_VERSION_MINOR &amp; \"Minor: does not match\\n\" );\nassert ( czmqPATCH == CZMQ_VERSION_PATCH &amp; \"Patch: does not match\\n\" );\n</code></pre>\n\n<p>if this matches your expectations, you may hope the DLL-versions are both matching and found in proper locations.</p>\n\n<hr>\n\n<h2>Next:</h2>\n\n<p>may test the whole circus run in a non-blocking mode, to prove, there is no other blocker, but as briefly inspected, I have not found such option exposed in CZMQ-API, the native API allows one to flag a <strong><code>NOBLOCK</code></strong> option on <code>{ _send() | _recv() }-</code>operations, which prevents them from remaining blocked ( which may be the case for <code>DEALER</code> socket instance in cases on <code>_send()</code>-s, when there are not yet any counterparty with a POSACK-ed <code>.bind()/.connect()</code> state ).</p>\n\n<p>Here I did not find some tools to do this as fast as expected in native API. Maybe you will have more luck on going through this.</p>\n\n<hr>\n\n<h2>Test the presence of a global <code>Context()</code> instance, if it is ready:</h2>\n\n<p>add before a first socket instantiation, to be sure we are before any and all socket-generation and their respective <code>_bind()/_connect()</code> operation a following self-reporting row, using:</p>\n\n<pre><code> zsys_info ( \"INF: This system's Context() limit is %zu ZeroMQ sockets\",\n              zsys_socket_limit ()\n              );\n</code></pre>\n\n<hr>\n\n<h2>One may also enforce the <code>Context()</code> instantiation manually:</h2>\n\n<p>so as to be sure the global Context() instance is up and running, before any higher abstracted instances ask if for implementing additional internalities ( sockets, counters, handlers, port-management, etc. )</p>\n\n<pre><code>//  Initialize CZMQ zsys layer; this happens automatically when you create\n//  a socket or an actor; however this call lets you force initialization\n//  earlier, so e.g. logging is properly set-up before you start working.\n//  Not threadsafe, so call only from main thread. Safe to call multiple\n//  times. Returns global CZMQ context.\nCZMQ_EXPORT void *\n    zsys_init (void);\n\n//  Optionally shut down the CZMQ zsys layer; this normally happens automatically\n//  when the process exits; however this call lets you force a shutdown\n//  earlier, avoiding any potential problems with atexit() ordering, especially\n//  with Windows dlls.\nCZMQ_EXPORT void\n    zsys_shutdown (void);\n</code></pre>\n\n<p>and possibly better tune IO-performance, using this right at the initialisation state:</p>\n\n<pre><code>//  Configure the number of I/O threads that ZeroMQ will use. A good\n//  rule of thumb is one thread per gigabit of traffic in or out. The\n//  default is 1, sufficient for most applications. If the environment\n//  variable ZSYS_IO_THREADS is defined, that provides the default.\n//  Note that this method is valid only before any socket is created.\nCZMQ_EXPORT void\n    zsys_set_io_threads (size_t io_threads);\n</code></pre>\n\n<p>This manual instantiation gives one an additional benefit, from having the instance-handle void pointer, so that one can inspect it's current state and shape by <strong><code>zmq_ctx_get()</code></strong> tools:</p>\n\n<pre><code>void *aGlobalCONTEXT = zsys_init();\n\nprintf( \"INF: current state of the global Context()-instance has:\\n\" );\nprintf( \"     ( %d )-IO-threads ready\\n\", zmq_ctx_get( aGlobalCONTEXT,\n                                                       ZMQ_IO_THREADS\n                                                       )\n        );\nprintf( \"     ( %d )-ZMQ_BLOCKY state\\n\", zmq_ctx_get( aGlobalCONTEXT,\n                                                       ZMQ_BLOCKY\n                                                       )\n        ); // may generate -1 in case DLL is &lt;&lt; 4.2+\n...\n</code></pre>\n\n<hr>\n\n<hr>\n\n<h2>If unhappy with signal-handling, one may design and use another one:</h2>\n\n<pre><code>//  Set interrupt handler; this saves the default handlers so that a\n//  zsys_handler_reset () can restore them. If you call this multiple times\n//  then the last handler will take affect. If handler_fn is NULL, disables\n//  default SIGINT/SIGTERM handling in CZMQ.\nCZMQ_EXPORT void\n    zsys_handler_set (zsys_handler_fn *handler_fn);\n</code></pre>\n\n<p>where</p>\n\n<pre><code>//  Callback for interrupt signal handler\ntypedef void (zsys_handler_fn) (int signal_value);\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 3883790, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a6a0002ccf217293f7e063bbd2031c72?s=128&d=identicon&r=PG&f=1", "display_name": "onepix", "link": "https://stackoverflow.com/users/3883790/onepix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 1, "accepted_answer_id": 49027822, "answer_count": 1, "score": 1, "last_activity_date": 1519918563, "creation_date": 1519775541, "last_edit_date": 1519918563, "question_id": 49019846, "link": "https://stackoverflow.com/questions/49019846/asynchronous-majordomo-pattern-example-using-the-czmq-4-1-0-new-zsock-api-update", "title": "Asynchronous Majordomo Pattern example using the CZMQ-4.1.0 new zsock API updated not working", "body": "<p>After installing zmq and czmq with brew, I tried to compile and play the  <a href=\"http://zguide.zeromq.org/page:all#Asynchronous-Majordomo-Pattern\" rel=\"nofollow noreferrer\">Asynchronous-Majordomo-Pattern</a> but it did not work as it requires czmq v3. As far as I understood, I tried to update it to the v4, using <strong><code>zactor</code></strong> because</p>\n\n<blockquote>\n  <p><strong><code>zthread</code></strong> is deprecated in favor of <strong><code>zactor</code></strong> <a href=\"http://czmq.zeromq.org/czmq3-0:zthread\" rel=\"nofollow noreferrer\">http://czmq.zeromq.org/czmq3-0:zthread</a></p>\n</blockquote>\n\n<p>So right now the following code looks fine to me as updated async-majordomo pattern, but it does not work as expected, It does not create any thread when I run it via my terminal.</p>\n\n<pre><code>//  Round-trip demonstrator\n//  While this example runs in a single process, that is just to make\n//  it easier to start and stop the example. The client task signals to\n//  main when it's ready.\n\n#include \"czmq.h\"\n#include &lt;stdlib.h&gt;\n\nvoid dbg_write_in_file(char * txt, int nb_request) {\n    FILE * pFile;\n    pFile = fopen (\"myfile.txt\",\"a\");\n\n    if (pFile!=NULL)\n    {\n        fputs (txt, pFile);\n\n        char str_nb_request[12];\n        sprintf(str_nb_request, \"%d\", nb_request);\n        fputs (str_nb_request, pFile);\n\n        fputs (\"\\n\", pFile);\n        fclose (pFile);\n    }\n}\n\nstatic void\nclient_task (zsock_t *pipe, void *args)\n{\n    zsock_t *client = zsock_new (ZMQ_DEALER);\n    zsock_connect (client, \"tcp://localhost:5555\");\n    printf (\"Setting up test...\\n\");\n    zclock_sleep (100);\n\n    printf(\"child 1: parent: %i\\n\\n\", getppid());\n    printf(\"child 1: my pid: %i\\n\\n\", getpid());\n\n    int requests;\n    int64_t start;\n\n    printf (\"Synchronous round-trip test...\\n\");\n    start = zclock_time ();\n    for (requests = 0; requests &lt; 10000; requests++) {\n        zstr_send (client, \"hello\");\n\n        // stuck here /!\\\n\n        char *reply = zstr_recv (client);\n        zstr_free (&amp;reply);\n\n        // check if it does something\n        dbg_write_in_file(\"sync round-trip requests : \", requests);\n        // end check\n    }\n    printf (\" %d calls/second\\n\",\n        (1000 * 10000) / (int) (zclock_time () - start));\n\n    printf (\"Asynchronous round-trip test...\\n\");\n    start = zclock_time ();\n    for (requests = 0; requests &lt; 100000; requests++) {\n        zstr_send (client, \"hello\");\n\n        // check if it does something\n        dbg_write_in_file(\"async round-trip send requests : \", requests);\n        // end check\n    }\n    for (requests = 0; requests &lt; 100000; requests++) {\n        char *reply = zstr_recv (client);\n        zstr_free (&amp;reply);\n\n        // check if it does something\n        dbg_write_in_file(\"async round-trip rec requests : \", requests);\n        // end check\n    }\n    printf (\" %d calls/second\\n\",\n        (1000 * 100000) / (int) (zclock_time () - start));\n\n    zstr_send (pipe, \"done\");\n}\n\n//  Here is the worker task. All it does is receive a message, and\n//  bounce it back the way it came:\n\nstatic void\nworker_task (zsock_t *pipe, void *args)\n{\n    printf(\"child 2: parent: %i\\n\\n\", getppid());\n    printf(\"child 2: my pid: %i\\n\\n\", getpid());\n\n    zsock_t *worker = zsock_new (ZMQ_DEALER);\n    zsock_connect (worker, \"tcp://localhost:5556\");\n\n    while (true) {\n        zmsg_t *msg = zmsg_recv (worker);\n        zmsg_send (&amp;msg, worker);    \n    }\n    zsock_destroy (&amp;worker);\n}\n\n//  Here is the broker task. It uses the zmq_proxy function to switch\n//  messages between frontend and backend:\n\nstatic void\nbroker_task (zsock_t *pipe, void *args)\n{\n    printf(\"child 3: parent: %i\\n\\n\", getppid());\n    printf(\"child 3: my pid: %i\\n\\n\", getpid());\n\n    //  Prepare our sockets\n    zsock_t *frontend = zsock_new (ZMQ_DEALER);\n    zsock_bind (frontend, \"tcp://localhost:5555\");\n    zsock_t *backend = zsock_new (ZMQ_DEALER);\n    zsock_bind (backend, \"tcp://localhost:5556\");\n    zmq_proxy (frontend, backend, NULL);\n\n    zsock_destroy (&amp;frontend);\n    zsock_destroy (&amp;backend);\n}\n\n//  Finally, here's the main task, which starts the client, worker, and\n//  broker, and then runs until the client signals it to stop:\n\nint main (void)\n{\n    //  Create threads\n    zactor_t *client = zactor_new (client_task, NULL);\n    assert (client);    \n    zactor_t *worker = zactor_new (worker_task, NULL);\n    assert (worker);\n    zactor_t *broker = zactor_new (broker_task, NULL);\n    assert (broker);\n\n    //  Wait for signal on client pipe\n    char *signal = zstr_recv (client);\n    zstr_free (&amp;signal);\n\n    zactor_destroy (&amp;client);\n    zactor_destroy (&amp;worker);\n    zactor_destroy (&amp;broker);\n    return 0;\n}\n</code></pre>\n\n<p>When I run it, it looks like the program is stuck at the comment</p>\n\n<blockquote>\n  <p>// stuck here /!\\ </p>\n</blockquote>\n\n<p>Then when I kill it as it does not finish, or print anything at all, I need to press five time <kbd><strong>Ctrl+C</strong></kbd> ( ^C ). Only then, it looks more verbose on the console, like it was indeed running. <br>=> Note that I delete all my <code>printf()</code> steps' outputs, as it was really messy to read.</p>\n\n<p>When it runs, it does not write anything to the file, called by the <em><code>dbg_write_in_file()</code></em> function, only after sending five <kbd><strong>Ctrl+C</strong></kbd> ( ^C ).</p>\n\n<p>Both client worker and broker task return the same <code>getppid</code> number ( my terminal ) and <code>getpid</code> as the program itself.</p>\n\n<p>I use <code>gcc trippingv4.c -o trippingv4 -L/usr/local/lib -lzmq -lczmq</code> to compile.</p>\n\n<p>When I try to kill it :</p>\n\n<pre><code>./trippingv4\nSetting up test...\nchild 1: parent: 60967\n\nchild 1: my pid: 76853\n\nSynchronous round-trip test...\n^Cchild 2: parent: 60967\n\nchild 2: my pid: 76853\n\n^Cchild 3: parent: 60967\n\nchild 3: my pid: 76853\n\n^C^C^CE: 18-02-28 00:16:37 [76853]dangling 'PAIR' socket created at src/zsys.c:471\nE: 18-02-28 00:16:37 [76853]dangling 'DEALER' socket created at trippingv4.c:29\nE: 18-02-28 00:16:37 [76853]dangling 'PAIR' socket created at src/zsys.c:471\nE: 18-02-28 00:16:37 [76853]dangling 'DEALER' socket created at trippingv4.c:89\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Thanks for the detailed answer @user3666197. In first part, the compiler does not compile the assert call so I just show the value instead and compare visually, they are the same.</p>\n\n<pre><code>int czmqMAJOR,\nczmqMINOR,\nczmqPATCH;\n\nzsys_version ( &amp;czmqMAJOR, &amp;czmqMINOR, &amp;czmqPATCH );\nprintf( \"INF: detected CZMQ ( %d, %d, %d ) -version\\n\",\n         czmqMAJOR,\n         czmqMINOR,\n         czmqPATCH\n         );\n\nprintf( \"INF: CZMQ_VERSION_MAJOR %d, CZMQ_VERSION_MINOR %d, CZMQ_VERSION_PATCH %d\\n\",\n         CZMQ_VERSION_MAJOR,\n         CZMQ_VERSION_MINOR,\n         CZMQ_VERSION_PATCH\n         );\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code>INF: detected CZMQ ( 4, 1, 0 ) -version\nINF: CZMQ_VERSION_MAJOR 4, CZMQ_VERSION_MINOR 1, CZMQ_VERSION_PATCH 0\n</code></pre>\n\n<p>The zsys_info call does compile but does not show anything on the terminal, even with a <code>fflush(stdout)</code> just in case so I just used <code>printf</code> :</p>\n\n<pre><code>INF: This system's Context() limit is 65535 ZeroMQ socketsINF: current state of the global Context()-instance has:\n     ( 1 )-IO-threads ready\n     ( 1 )-ZMQ_BLOCKY state\n</code></pre>\n\n<p>Then I changed the global context thread value with <code>zsys_set_io_threads(2)</code> and/or <code>zmq_ctx_set (aGlobalCONTEXT, ZMQ_BLOCKY, false);</code>, still blocked. It looks like zactor does not works with systems threads as zthread was... or does not gives a similar behavior. Given my experience in zeromq (also zero) probably I trying something that can't be achieved.</p>\n\n<p><strong>Update solved but unproper</strong></p>\n\n<p>My main error was to not have properly initiate zactor instance</p>\n\n<blockquote>\n  <p>An actor function MUST call zsock_signal (pipe) when initialized and MUST listen to pipe and exit on $TERM command.</p>\n</blockquote>\n\n<p>And to not have blocked the zactor's proxy execution before it called <code>zactor_destroy (&amp;proxy);</code></p>\n\n<p>I let the final code below but you still need to exit at the end with <kbd><strong>Ctrl+C</strong></kbd> because I did not figure it out how to manage <code>$TERM</code> signal properly. Also, zactor still appears to not use system theads. It's probably design like this but I don't know how it's work behind the wood. </p>\n\n<pre><code>//  Round-trip demonstrator\n//  While this example runs in a single process, that is just to make\n//  it easier to start and stop the example. The client task signals to\n//  main when it's ready.\n\n#include &lt;czmq.h&gt;\n\nstatic void\nclient_task (zsock_t *pipe, void *args)\n{\n    assert (streq ((char *) args, \"Hello, Client\"));\n    zsock_signal (pipe, 0);\n\n    zsock_t *client = zsock_new (ZMQ_DEALER);\n    zsock_connect (client, \"tcp://127.0.0.1:5555\");\n\n    printf (\"Setting up test...\\n\");\n    zclock_sleep (100);\n\n    int requests;\n    int64_t start;\n\n    printf (\"Synchronous round-trip test...\\n\");\n    start = zclock_time ();\n    for (requests = 0; requests &lt; 10000; requests++) {\n        zstr_send (client, \"hello\");\n\n        zmsg_t *msgh = zmsg_recv (client);\n        zmsg_destroy (&amp;msgh);\n\n    }\n    printf (\" %d calls/second\\n\",\n        (1000 * 10000) / (int) (zclock_time () - start));\n\n    printf (\"Asynchronous round-trip test...\\n\");\n    start = zclock_time ();\n    for (requests = 0; requests &lt; 100000; requests++) {\n        zstr_send (client, \"hello\");\n    }\n    for (requests = 0; requests &lt; 100000; requests++) {\n        char *reply = zstr_recv (client);\n        zstr_free (&amp;reply);\n    }\n    printf (\" %d calls/second\\n\",\n        (1000 * 100000) / (int) (zclock_time () - start));\n\n    zstr_send (pipe, \"done\");\n    printf(\"send 'done' to pipe\\n\");\n}\n\n//  Here is the worker task. All it does is receive a message, and\n//  bounce it back the way it came:\n\nstatic void\nworker_task (zsock_t *pipe, void *args)\n{\n    assert (streq ((char *) args, \"Hello, Worker\"));\n    zsock_signal (pipe, 0);\n\n    zsock_t *worker = zsock_new (ZMQ_DEALER);\n    zsock_connect (worker, \"tcp://127.0.0.1:5556\");\n\n    bool terminated = false;\n    while (!terminated) {\n        zmsg_t *msg = zmsg_recv (worker);\n        zmsg_send (&amp;msg, worker);\n        // zstr_send (worker, \"hello back\"); // Give better perf I don't know why\n\n    }\n    zsock_destroy (&amp;worker);\n}\n\n//  Here is the broker task. It uses the zmq_proxy function to switch\n//  messages between frontend and backend:\n\nstatic void\nbroker_task (zsock_t *pipe, void *args)\n{\n    assert (streq ((char *) args, \"Hello, Task\"));\n    zsock_signal (pipe, 0);\n\n    //  Prepare our proxy and its sockets\n    zactor_t *proxy = zactor_new (zproxy, NULL);\n    zstr_sendx (proxy, \"FRONTEND\", \"DEALER\", \"tcp://127.0.0.1:5555\", NULL);\n    zsock_wait (proxy);\n    zstr_sendx (proxy, \"BACKEND\", \"DEALER\", \"tcp://127.0.0.1:5556\", NULL);\n    zsock_wait (proxy);\n\n    bool terminated = false;\n    while (!terminated) {\n        zmsg_t *msg = zmsg_recv (pipe);\n        if (!msg)\n            break;              //  Interrupted\n        char *command = zmsg_popstr (msg);\n\n        if (streq (command, \"$TERM\")) {\n            terminated = true;\n            printf(\"broker received $TERM\\n\");\n        }\n\n        freen (command);\n        zmsg_destroy (&amp;msg);\n    }\n\n    zactor_destroy (&amp;proxy);\n}\n\n//  Finally, here's the main task, which starts the client, worker, and\n//  broker, and then runs until the client signals it to stop:\n\nint main (void)\n{\n\n    //  Create threads\n    zactor_t *client = zactor_new (client_task, \"Hello, Client\");\n    assert (client);\n    zactor_t *worker = zactor_new (worker_task, \"Hello, Worker\");\n    assert (worker);\n    zactor_t *broker = zactor_new (broker_task, \"Hello, Task\");\n    assert (broker);\n\n    char *signal = zstr_recv (client);\n    printf(\"signal %s\\n\", signal);\n    zstr_free (&amp;signal);\n\n    zactor_destroy (&amp;client);\n    printf(\"client done\\n\");\n    zactor_destroy (&amp;worker);\n    printf(\"worker done\\n\");\n    zactor_destroy (&amp;broker);\n    printf(\"broker done\\n\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1519772517, "post_id": 49019332, "comment_id": 85043938, "body": "<code>hostname</code> is uninitialized,, you&#39;re not allocating any space for it, so <code>strcpy(hostname, inputVal);</code> invokes undefined behavior."}], "answers": [{"tags": [], "owner": {"reputation": 524, "user_id": 9249002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d30321c6cd41b504daf51b654cee09?s=128&d=identicon&r=PG&f=1", "display_name": "bebidek", "link": "https://stackoverflow.com/users/9249002/bebidek"}, "is_accepted": false, "score": 1, "last_activity_date": 1519772913, "creation_date": 1519772913, "answer_id": 49019430, "question_id": 49019332, "link": "https://stackoverflow.com/questions/49019332/c-dnslookup-throwing-segmentation-fault/49019430#49019430", "title": "C DNSlookup throwing Segmentation fault", "body": "<p>You don't need <code>inputVal</code> array at all as you scanf only one string. Use <code>char hostname[100]</code> instead and segfault should disappear.</p>\n"}, {"tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": false, "score": 2, "last_activity_date": 1519968520, "last_edit_date": 1519968520, "creation_date": 1519773009, "answer_id": 49019449, "question_id": 49019332, "link": "https://stackoverflow.com/questions/49019332/c-dnslookup-throwing-segmentation-fault/49019449#49019449", "title": "C DNSlookup throwing Segmentation fault", "body": "<p><code>hostname</code> is uninitialized, you're not allocating any space for it, so <code>strcpy(hostname, inputVal);</code> invokes undefined behavior.  You can solve this by allocating space for it, either dynamically:</p>\n\n<pre><code>char *hostname = malloc(100);\nif (hostname == NULL)\n{\n  // you can handle this error anyway you like, this is just an example\n  fprintf(stderr, \"Out of memory\\n\");\n  exit(-1);\n}\n...\n// after you're done using hostname, cleanup\nfree(hostname);\n</code></pre>\n\n<p>or you can assign space for it in automatic storage as you have done with <code>ip</code> and <code>inputVal</code>:</p>\n\n<pre><code>char hostname[100];\n</code></pre>\n\n<p>I prefer the automatic storage solution in this example. In fact I would probably get rid of <code>inputVal</code> altogether and just do</p>\n\n<pre><code>char hostname[100];\nscanf(\"%99s\", hostname);  // %99s ensures only 99 characters of data will be read from stdin,\n                          // leaving room for the NUL terminator. Hostnames can get\n                          // long, so you may want more than 100 characters.\n</code></pre>\n\n<p>and go from there.</p>\n"}], "owner": {"reputation": 11, "user_id": 6692505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gi3h.png?s=128&g=1", "display_name": "yOmar", "link": "https://stackoverflow.com/users/6692505/yomar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519968520, "creation_date": 1519772449, "question_id": 49019332, "link": "https://stackoverflow.com/questions/49019332/c-dnslookup-throwing-segmentation-fault", "title": "C DNSlookup throwing Segmentation fault", "body": "<p>Any ideas why this DNS lookup program is throwing a \"Segmentation fault: 11\"? </p>\n\n<p>I've found that it's to do with being out of allocated memory, but don't know where that's occurring.</p>\n\n<p>Thanks.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;arpa/inet.h&gt;\n\nint main()\n{\n    int sockfd;\n    struct addrinfo hints, *results, *p;\n    struct sockaddr_in *ip_access;\n    int rv;\n    char *hostname;\n    char ip[100], inputVal[100];\n\n    printf(\"Enter a domain name: \\n\");\n    scanf(\"%s\", inputVal);\n\n    strcpy(hostname, inputVal);\n\n    memset(&amp;hints, 0, sizeof hints);\n    hints.ai_family = AF_UNSPEC;\n    hints.ai_socktype = SOCK_STREAM;\n\n    if((rv = getaddrinfo(hostname, \"domain\", &amp;hints, &amp;results)) != 0)\n    {\n    fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(rv));\n    return 1;\n    }\n\n    // loop through structure using ai_next\n    for(p= results; p != NULL; p = p-&gt;ai_next)\n    {\n        // pass data into sockaddr in struct\n        ip_access = (struct sockaddr_in *) p-&gt;ai_addr;\n\n        printf(\"IP address is %s: \\n\", inet_ntoa(ip_access-&gt;sin_addr));\n    }\n    freeaddrinfo(results);\n\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "casting", "uart"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1519771282, "post_id": 49019128, "comment_id": 85043510, "body": "Can you give an example of (negative) numbers and which bit pattern you see?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519771576, "post_id": 49019128, "comment_id": 85043615, "body": "you&#39;re casting <code>int8_t</code> to <code>uint8_t</code> and the bits are changing?"}, {"owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1519772376, "post_id": 49019128, "comment_id": 85043886, "body": "This might be an endian issue."}, {"owner": {"reputation": 347, "user_id": 6809840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f207555580d17928bcfbbbf6e670b1fe?s=128&d=identicon&r=PG&f=1", "display_name": "Burstfulovic", "link": "https://stackoverflow.com/users/6809840/burstfulovic"}, "edited": false, "score": 0, "creation_date": 1519772384, "post_id": 49019128, "comment_id": 85043889, "body": "implicitly casting <code>int8_t</code> to <code>uint8_t</code>? Please give example of what you&#39;ve done and the outcome."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519773234, "post_id": 49019128, "comment_id": 85044148, "body": "On most systems casting int8_t to uint8_t doesn&#39;t change the bit pattern. Can you show the bit patterns before and after the cast?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519775407, "post_id": 49019128, "comment_id": 85044794, "body": "@immibis I&#39;d expect an all compliant systems casting <code>int8_t</code> to <code>uint8_t</code> to not change the bit pattern.  The width is 8 and <code>int8_t</code> uses 2&#39;s complement."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519775439, "post_id": 49019128, "comment_id": 85044807, "body": "@chux not all systems use 2&#39;s complement, also not all systems are properly compliant, also there&#39;s a good chance the bit patterns actually are the same and there&#39;s an error somewhere else."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519775514, "post_id": 49019128, "comment_id": 85044835, "body": "@immibis  As <code>int8_t</code> is specified by C to be 2&#39;s complement 8-bits, I agree: error somewhere else."}, {"owner": {"reputation": 1567, "user_id": 8870224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BomtF.jpg?s=128&g=1", "display_name": "samuelnj", "link": "https://stackoverflow.com/users/8870224/samuelnj"}, "reply_to_user": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "edited": false, "score": 0, "creation_date": 1519776796, "post_id": 49019128, "comment_id": 85045192, "body": "@smac89 you were right on the endianness of the systems. I had simplified the problem a little bit for the sake of asking a question, but essentially I was sending an int16_t in byte chunks and the entire endianness was messed up because the bytes were out of order, and the bits were reversed -_-"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519784463, "post_id": 49019128, "comment_id": 85047276, "body": "@immibis by &quot;most systems&quot; you mean &quot;all conforming systems which offer these types&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 124, "user_id": 6438359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e85e5b3614e75c70f38d39736f72d02?s=128&d=identicon&r=PG&f=1", "display_name": "Tianjiao Huang", "link": "https://stackoverflow.com/users/6438359/tianjiao-huang"}, "is_accepted": false, "score": 0, "last_activity_date": 1519778950, "creation_date": 1519778950, "answer_id": 49020305, "question_id": 49019128, "link": "https://stackoverflow.com/questions/49019128/sending-a-int8-t-as-a-uint8-t-without-changing-bit-pattern/49020305#49020305", "title": "Sending a int8_t as a uint8_t without changing bit pattern", "body": "<p>Make a pointer then cast the pointer, then the original data will not be cast</p>\n\n<pre><code>EUSART1_Write(*(uint8_t*)(&amp;signed_data_that_you_want_to_send));\n</code></pre>\n"}], "owner": {"reputation": 1567, "user_id": 8870224, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/BomtF.jpg?s=128&g=1", "display_name": "samuelnj", "link": "https://stackoverflow.com/users/8870224/samuelnj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519778950, "creation_date": 1519771164, "question_id": 49019128, "link": "https://stackoverflow.com/questions/49019128/sending-a-int8-t-as-a-uint8-t-without-changing-bit-pattern", "title": "Sending a int8_t as a uint8_t without changing bit pattern", "body": "<p>I am working on a PIC micro controller to send some information over a UART connection in byte chunks. Some of the information I'm sending over is of type int8_t. I want to preserve the bit pattern when sending the information over, but whether or not I explicitly cast, the underlying bit pattern gets changed when the int8_t is a negative value. The library function is declared roughly like this, and accepts a uint8_t to send data, so rewriting that is something that I don't want to do.</p>\n\n<p>For reference, the UART send function is declared like this:</p>\n\n<pre><code>void EUSART1_Write(uint8_t txData);\n</code></pre>\n\n<p>How would I go about sending data with type int8_t without changing the bit pattern using the function above? I think that it would be some sort of casting...</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 1, "creation_date": 1519772727, "post_id": 49019113, "comment_id": 85043985, "body": "<code>typeof(type_of_structure)</code> -&gt; <code>type_of_structure</code>? Also, have you compiled this? Was there an error? If not, did you check with <code>-pedantic -Wall</code> flags to be sure?"}, {"owner": {"reputation": 85, "user_id": 9421263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f20da8b61635934a73016037f2e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie Sale", "link": "https://stackoverflow.com/users/9421263/charlie-sale"}, "reply_to_user": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1519853701, "post_id": 49019113, "comment_id": 85083236, "body": "It compiles with -Wall and -pedantic. The typeof() is unnecessary."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1519773078, "creation_date": 1519773078, "answer_id": 49019459, "question_id": 49019113, "link": "https://stackoverflow.com/questions/49019113/create-a-struct-in-c-preprocessor/49019459#49019459", "title": "Create a struct in C Preprocessor", "body": "<p>Yes, it's possible, and your code is very close to correct.</p>\n\n<p>I'd drop the semicolon at the end of the macro definition.  I'd also drop the use of <code>typeof</code>; it's not portable and it's not needed unless you want to use an expression, rather than a type name, as the first argument to <code>create_union</code>.</p>\n\n<p>Here's how I'd probably define it.  (I don't bother with typedefs for struct or union types; I just use the name <code>struct foo</code> or <code>union foo</code> unless the type is intended to be completely opaque.  Feel free to use the typedef if you prefer.) (I've also used <code>unsigned char</code> rather than <code>char</code>, since that's how object representations are defined.)</p>\n\n<pre><code>#define CREATE_UNION(new_type, existing_type) \\\nunion new_type {                              \\\n      existing_type obj;                      \\\n      unsigned char rep[sizeof(existing_type)]; \\\n}\n</code></pre>\n\n<p>And you can then do:</p>\n\n<pre><code>CREATE_UNION(int_wrapper, int);\nint_wrapper foo;\n</code></pre>\n\n<p>Note that what you're defining is a <strong>union</strong>, not a <strong>structure</strong>.</p>\n"}], "owner": {"reputation": 85, "user_id": 9421263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f20da8b61635934a73016037f2e3a5?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie Sale", "link": "https://stackoverflow.com/users/9421263/charlie-sale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1211, "favorite_count": 0, "accepted_answer_id": 49019459, "answer_count": 1, "score": 1, "last_activity_date": 1519773078, "creation_date": 1519771088, "last_edit_date": 1519772563, "question_id": 49019113, "link": "https://stackoverflow.com/questions/49019113/create-a-struct-in-c-preprocessor", "title": "Create a struct in C Preprocessor", "body": "<p>Right now, I am writing a small project in C to test out some serialization techniques.\nOne way that I am doing this is through the use of unions. Something that I would like to try is creating a union in the C preprocessor that holds a user-defined structure. For example, something like this:</p>\n\n<pre><code>#define create_union(name_of_structure, type_of_structure) \\ \n                                                           \\\ntypedef union name_of_structure {                          \\                                 \n      typeof(type_of_structure) structure;                 \\                        \n      char buffer_that_holds_structure[sizeof(type_of_structure)]; \\\n} name_of_structure;\n\n/* Usage */\nstruct my_data {\n      int id;\n      int other_value;\n};\n\ncreate_union(my_data_t, struct my_data);\n/* Data type my_data_t (union my_data_t) now exists */\n</code></pre>\n\n<p>First of all, is this feasible? If it is, how would I go about doing this? If not, is there an alternative method I can use?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "optimization", "compiler-optimization", "matrix-multiplication"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1519771078, "post_id": 49019062, "comment_id": 85043420, "body": "Putting the <code>if</code> statements outside all of the loops would evaluate the expression only once rather than <code>M*N</code> times, but then you&#39;d be left with even more of a mess."}, {"owner": {"reputation": 7053, "user_id": 1162141, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7db6bfbfbb420620e6df76c0e406098d?s=128&d=identicon&r=PG", "display_name": "technosaurus", "link": "https://stackoverflow.com/users/1162141/technosaurus"}, "edited": false, "score": 0, "creation_date": 1519781105, "post_id": 49019062, "comment_id": 85046383, "body": "Why would you make a local copy of an array without bothering to make it line up with the other array in the innermost loop so that the indexing is the same and you get sequential access?  Hoisting the indexing calculations to the top in a single variable may help, but using <code>restrict</code> (if applicable) might let the compiler do it for you."}], "owner": {"reputation": 313, "user_id": 6132416, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/700ed0edf93046d4108c451b8e71f742?s=128&d=identicon&r=PG&f=1", "display_name": "okmanl", "link": "https://stackoverflow.com/users/6132416/okmanl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519770824, "creation_date": 1519770824, "question_id": 49019062, "link": "https://stackoverflow.com/questions/49019062/how-else-can-i-optimize-this-c-program-for-dgemm-blocked-matrix-multiplication", "title": "How else can I optimize this C program for dgemm blocked matrix multiplication?", "body": "<p>I have this C program for matrix multiplication, I've read about and tried loop unrolling... But other than that I have no idea how to speed up the C program. Could someone point me in the right direction of what else I can do? </p>\n\n<pre><code>const char* dgemm_desc = \"Simple blocked dgemm.\";\n\n#if !defined(BLOCK_SIZE)\n#define BLOCK_SIZE 41\n#endif\n\n#define min(a,b) (((a)&lt;(b))?(a):(b))\n\n/* This routine performs a dgemm operation\n *  C := C + A * B\n * where A, B, and C are lda-by-lda matrices stored in column-major format. \n * On exit, A and B maintain their input values. */\nvoid square_dgemm (int lda, double* A, double* B, double* C)\n{\n  /* For each block-row of A */\n  for (int i = 0; i &lt; lda; i += BLOCK_SIZE)\n    /* For each block-column of B */\n    for (int j = 0; j &lt; lda; j += BLOCK_SIZE)\n      /* Accumulate block dgemms into block of C */\n      for (int k = 0; k &lt; lda; k += BLOCK_SIZE)\n      {\n        /* Correct block dimensions if block \"goes off edge of\" the matrix */\n        int M = min (BLOCK_SIZE, lda-i);\n        int N = min (BLOCK_SIZE, lda-j);\n        int K = min (BLOCK_SIZE, lda-k);\n\n        /* Perform individual block dgemm */\nif( (M % BLOCK_SIZE &lt;= 2) &amp;&amp; (N % BLOCK_SIZE &lt;= 2) &amp;&amp; (K % BLOCK_SIZE &lt;= 1 ))\n        {\n            do_block_fast(lda, M, N, K, A + i + k*lda, B+ k + j *lda, C + i + j*lda);\n        }else\n        {\n            do_block(lda, M, N, K, A + i + k*lda, B + k + j*lda, C + i + j*lda);\n\n        }\n      }\n}\n</code></pre>\n\n<p>Main program, that calls the subroutines do_block_fast() and do_block().</p>\n\n<pre><code>void do_block_fast (int lda, int M, int N, int K, double* A, double* B, double* C)\n{\n static double a[BLOCK_SIZE*BLOCK_SIZE] __attribute__ ((aligned (16)));\n // make a local aligned copy of A's block\n   for( int j = 0; j &lt; K; j++ )\n    for( int i = 0; i &lt; M; i++ )\n     a[i+j*BLOCK_SIZE] = A[i+j*lda];\n   /* For each row i of A */\n    for (int i = 0; i &lt; M; ++i)\n    /* For each column j of B */\n         for (int j = 0; j &lt; N; ++j)\n         {\n           /* Compute C(i,j) */\n             double cij = C[i+j*lda];\n             //for (int k = 0; k &lt; K; ++k){\n              //  cij += a[i+k*BLOCK_SIZE] * B[k+j*lda];\n            // }\n\n             for (int k = 0; k &lt; K; k+= 41)\n             {\n                cij += a[i+k*BLOCK_SIZE] * B[k+j*lda];\n                cij += a[i+(k+1)*BLOCK_SIZE] * B[(k+1)+j*lda];\n                cij += a[i+(k+2)*BLOCK_SIZE] * B[(k+2)+j*lda];\n                cij += a[i+(k+3)*BLOCK_SIZE] * B[(k+3)+j*lda];\n                cij += a[i+(k+4)*BLOCK_SIZE] * B[(k+4)+j*lda];\n                cij += a[i+(k+5)*BLOCK_SIZE] * B[(k+5)+j*lda];\n                cij += a[i+(k+6)*BLOCK_SIZE] * B[(k+6)+j*lda];\n                cij += a[i+(k+7)*BLOCK_SIZE] * B[(k+7)+j*lda];\n                cij += a[i+(k+8)*BLOCK_SIZE] * B[(k+8)+j*lda];\n                cij += a[i+(k+9)*BLOCK_SIZE] * B[(k+9)+j*lda];\n                cij += a[i+(k+10)*BLOCK_SIZE] * B[(k+10)+j*lda];\n                cij += a[i+(k+11)*BLOCK_SIZE] * B[(k+11)+j*lda];\n                cij += a[i+(k+12)*BLOCK_SIZE] * B[(k+12)+j*lda];\n                cij += a[i+(k+13)*BLOCK_SIZE] * B[(k+13)+j*lda];\n                cij += a[i+(k+14)*BLOCK_SIZE] * B[(k+14)+j*lda];\n                cij += a[i+(k+15)*BLOCK_SIZE] * B[(k+15)+j*lda];\n                cij += a[i+(k+16)*BLOCK_SIZE] * B[(k+16)+j*lda];\n                cij += a[i+(k+17)*BLOCK_SIZE] * B[(k+17)+j*lda];\n                cij += a[i+(k+18)*BLOCK_SIZE] * B[(k+18)+j*lda];\n                cij += a[i+(k+19)*BLOCK_SIZE] * B[(k+19)+j*lda];\n                cij += a[i+(k+20)*BLOCK_SIZE] * B[(k+20)+j*lda];\n                cij += a[i+(k+21)*BLOCK_SIZE] * B[(k+21)+j*lda];\n                cij += a[i+(k+22)*BLOCK_SIZE] * B[(k+22)+j*lda];\n                cij += a[i+(k+23)*BLOCK_SIZE] * B[(k+23)+j*lda];\n                cij += a[i+(k+24)*BLOCK_SIZE] * B[(k+24)+j*lda];\n                cij += a[i+(k+25)*BLOCK_SIZE] * B[(k+25)+j*lda];\n                cij += a[i+(k+26)*BLOCK_SIZE] * B[(k+26)+j*lda];\n                cij += a[i+(k+27)*BLOCK_SIZE] * B[(k+27)+j*lda];\n                cij += a[i+(k+28)*BLOCK_SIZE] * B[(k+28)+j*lda];\n                cij += a[i+(k+29)*BLOCK_SIZE] * B[(k+29)+j*lda];\n                cij += a[i+(k+30)*BLOCK_SIZE] * B[(k+30)+j*lda];\n                cij += a[i+(k+31)*BLOCK_SIZE] * B[(k+31)+j*lda];\n                cij += a[i+(k+32)*BLOCK_SIZE] * B[(k+32)+j*lda];\n                cij += a[i+(k+33)*BLOCK_SIZE] * B[(k+33)+j*lda];\n                     ...\n                     ...\n               }\n             C[i+j*lda] = cij;\n          }\n}\n</code></pre>\n\n<p>Subroutine do_block_fast()... Basically since I know the value of K = 41, I just unrolled the innermost for loop by 41.</p>\n\n<pre><code>static void do_block (int lda, int M, int N, int K, double* A, double* B, double* C)\n{\n  /* For each row i of A */\n  for (int i = 0; i &lt; M; ++i)\n    /* For each column j of B */\n    for (int j = 0; j &lt; N; ++j)\n    {\n      /* Compute C(i,j) */\n      double cij = C[i+j*lda];\n      if(K % 8 == 0)\n      for(int k = 0; k &lt; K; k += 8){\n        cij += A[i+k*lda] * B[k+j*lda];\n        cij += A[i+(k+1)*lda] * B[(k+1)+j*lda];\n        cij += A[i+(k+2)*lda] * B[(k+2)+j*lda];\n        cij += A[i+(k+3)*lda] * B[(k+3)+j*lda];\n        cij += A[i+(k+4)*lda] * B[(k+4)+j*lda];\n        cij += A[i+(k+5)*lda] * B[(k+5)+j*lda];\n        cij += A[i+(k+6)*lda] * B[(k+6)+j*lda];\n        cij += A[i+(k+7)*lda] * B[(k+7)+j*lda];\n              }\n      else if(K % 7 == 0)\n      for(int k = 0; k &lt; K; k += 7){\n        cij += A[i+k*lda] * B[k+j*lda];\n        cij += A[i+(k+1)*lda] * B[(k+1)+j*lda];\n        cij += A[i+(k+2)*lda] * B[(k+2)+j*lda];\n        cij += A[i+(k+3)*lda] * B[(k+3)+j*lda];\n        cij += A[i+(k+4)*lda] * B[(k+4)+j*lda];\n        cij += A[i+(k+5)*lda] * B[(k+5)+j*lda];\n        cij += A[i+(k+6)*lda] * B[(k+6)+j*lda];\n              }\n      else if(K % 6 == 0)\n      for(int k = 0; k &lt; K; k += 6){\n        cij += A[i+k*lda] * B[k+j*lda];\n        cij += A[i+(k+1)*lda] * B[(k+1)+j*lda];\n        cij += A[i+(k+2)*lda] * B[(k+2)+j*lda];\n        cij += A[i+(k+3)*lda] * B[(k+3)+j*lda];\n        cij += A[i+(k+4)*lda] * B[(k+4)+j*lda];\n        cij += A[i+(k+5)*lda] * B[(k+5)+j*lda];\n              }\n      ...\n\n      else\n      for (int k = 0; k &lt; K; ++k)\n        cij += A[i+k*lda] * B[k+j*lda];\n      C[i+j*lda] = cij;\n    }\n}\n</code></pre>\n\n<p>Subroutine do_block(). Since I don't know the value of K I just used branching statements, to unroll the innermost for loop. </p>\n\n<p>Lastly here are the results of the program </p>\n\n<pre><code>Size: 31    Mflop/s:  2361.82   Percentage:  5.51\nSize: 32    Mflop/s:   2941.3   Percentage:  6.86\nSize: 96    Mflop/s:  2861.72   Percentage:  6.67\nSize: 97    Mflop/s:  2657.44   Percentage:  6.19\nSize: 127   Mflop/s:  3028.53   Percentage:  7.06\nSize: 128   Mflop/s:  2925.26   Percentage:  6.82\nSize: 129   Mflop/s:   2823.6   Percentage:  6.58\nSize: 191   Mflop/s:  2893.04   Percentage:  6.74\nSize: 192   Mflop/s:  2925.12   Percentage:  6.82\nSize: 229   Mflop/s:  2834.69   Percentage:  6.61\nSize: 255   Mflop/s:  2963.94   Percentage:  6.91\nSize: 256   Mflop/s:  2712.55   Percentage:  6.32\nSize: 257   Mflop/s:   2905.3   Percentage:  6.77\nSize: 319   Mflop/s:  2878.31   Percentage:  6.71\nSize: 320   Mflop/s:  2855.04   Percentage:  6.66\nSize: 321   Mflop/s:  2835.52   Percentage:  6.61\nSize: 417   Mflop/s:  2971.67   Percentage:  6.93\nSize: 479   Mflop/s:  2876.16   Percentage:  6.70\nSize: 480   Mflop/s:  2813.88   Percentage:  6.56\nSize: 511   Mflop/s:  2717.75   Percentage:  6.34\nSize: 512   Mflop/s:  1740.14   Percentage:  4.06\nSize: 639   Mflop/s:  2614.61   Percentage:  6.09\nSize: 640   Mflop/s:  2453.03   Percentage:  5.72\nSize: 767   Mflop/s:  2494.76   Percentage:  5.82\nSize: 768   Mflop/s:  2389.77   Percentage:  5.57\nSize: 769   Mflop/s:   2779.2   Percentage:  6.48\nAverage percentage of Peak = 6.38822\n</code></pre>\n"}, {"tags": ["c", "arrays", "linux", "char", "wavefront"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519770764, "post_id": 49018978, "comment_id": 85043275, "body": "<code>vert[0].x</code> is a <code>char[20]</code> and <code>exampleArray[0]</code> is a <code>char</code>. I think you&#39;re trying to copy strings, in which case you need to use something like <a href=\"https://linux.die.net/man/3/strcpy\" rel=\"nofollow noreferrer\"><code>strcpy</code></a>"}, {"owner": {"reputation": 1526, "user_id": 6242649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3799dd24776a7842835b9a2aec3a9a05?s=128&d=identicon&r=PG", "display_name": "Udayraj Deshmukh", "link": "https://stackoverflow.com/users/6242649/udayraj-deshmukh"}, "edited": false, "score": 0, "creation_date": 1519770911, "post_id": 49018978, "comment_id": 85043335, "body": "you can use strcpy to copy a char array into another. and for splitting the string into array use strtoken"}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1519770988, "post_id": 49018978, "comment_id": 85043377, "body": "I tried strcat, strcpy etc.....that&#39;s the issue, i simply want to parse the exampleArray and get the X,Y,Z points from it, and copy them into Vert[0].x, or Vert[1].X or Vert[2].Y etc. and I know exampleArray[i] is a Char but it is inside a loop , which means i&#39;m trying copy character by character into vert[0].x for example."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519771059, "post_id": 49018978, "comment_id": 85043411, "body": "What exactly did you try and how did it fail?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519771160, "post_id": 49018978, "comment_id": 85043467, "body": "Your <code>exampleArray</code> contents don&#39;t match your description of the format."}, {"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1519771518, "post_id": 49018978, "comment_id": 85043595, "body": "I&#39;m sorry that my question couldn&#39;t be understand by you guys, it is 4:00am, I&#39;ve not slept, very tired and i&#39;m working on multiple projects, and I have two different interviews at different places today as well...My supervisor has also given me some work to do....and right now these questions from you guys feels like bullets coming in and out from my brain....all i want now is die. :("}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1519772005, "post_id": 49018978, "comment_id": 85043766, "body": "I only see a single question (from me), so I don&#39;t understand what you mean by &quot;<i>these questions from you guys</i>&quot;. Also, I&#39;m only asking for basic information that should&#39;ve been part of your question, nothing crazy."}], "answers": [{"comments": [{"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1519771807, "post_id": 49019162, "comment_id": 85043697, "body": "These are just examples, actual data is quite larger than this, space is taken care of, i&#39;m not worried about the atof either...everything works fine...the only problem i&#39;m facing is that i can&#39;t parse the example array to copy character by character x, y, z points into their appropriate array which is the struct Vertices which has x,y,z char arrays inside it."}], "tags": [], "owner": {"reputation": 36, "user_id": 9408375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/884722e845ecf4934e0a248b1a7cb9d1?s=128&d=identicon&r=PG&f=1", "display_name": "Ozymandias", "link": "https://stackoverflow.com/users/9408375/ozymandias"}, "is_accepted": false, "score": 0, "last_activity_date": 1519771364, "creation_date": 1519771364, "answer_id": 49019162, "question_id": 49018978, "link": "https://stackoverflow.com/questions/49018978/array-of-of-struct-containing-array-of-char-as-members-c/49019162#49019162", "title": "Array of of Struct containing array of char as members - C", "body": "<p>Character arrays are not copied by simply pointing at them.  The function \"strcpy(vert[0].x, &amp;exampleArray[2])\" is needed, but even then there is no '\\0' immediately after that first number to indicate where to stop reading.  \"memcpy\" does not need a NULL ('\\0') but needs a length based on spaces.</p>\n\n<p>Further, the \"atof\" operation to plan to use requires a NULL terminator as well.</p>\n\n<p>I am concerned with your \"space planning\".  You have 64 copies of structures that will each require 60 characters (3840 total), but your exampleArray only has 200.  And the input string exampleArray has strings for numbers that must be no longer than 19 digits/decimals because you need the NULL terminator in each of x/y/z to exist.</p>\n\n<p>This is the pure technical evaluation of code issues, but your original post does not show more of the application design.  Help us understand your application design and more advice can be given.</p>\n"}, {"comments": [{"owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "edited": false, "score": 0, "creation_date": 1519834548, "post_id": 49019621, "comment_id": 85072662, "body": "Thank you so much, it is what I needed. I was tired and couldn&#39;t write a well explained question, I didn&#39;t even had the energy to copy the code sample from my program, but you got the idea of what I wanted to do. Thank you (y)"}], "tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 1, "last_activity_date": 1519774443, "last_edit_date": 1519774443, "creation_date": 1519774085, "answer_id": 49019621, "question_id": 49018978, "link": "https://stackoverflow.com/questions/49018978/array-of-of-struct-containing-array-of-char-as-members-c/49019621#49019621", "title": "Array of of Struct containing array of char as members - C", "body": "<p>You could use <code>strtok()</code> with delimiter <code>\" \\n\"</code> to get each piece and then <code>strcpy()</code> to place each token in your struct.</p>\n\n<pre><code>struct vertices {\n    char x[20];\n    char y[20];\n    char z[20];\n};\n\nint main(void)\n{\n    char exampleArray[200] = \"v 23.232000 32.33000 2.03900\\nv 9.20900 3.29000 1.0002\";\n    char *toStrtokVertex, *token;\n    char delim[5] = \" \\n\";\n    struct vertices V[10];\n    int i = 0;\n\n    toStrtokVertex = exampleArray;\n    while ((token = strtok(toStrtokVertex, delim)) != NULL) {\n\n        // ignore the `v`\n\n        // get x\n        if ((token = strtok(NULL, delim)) != NULL) {\n            strcpy(V[i].x, token);\n        }\n        else {\n            printf(\"INPUT ERROR\\n\");\n            exit(1);\n        }\n\n        // get y\n        if ((token = strtok(NULL, delim)) != NULL) {\n            strcpy(V[i].y, token);\n        }\n        else {\n            printf(\"INPUT ERROR\\n\");\n            exit(1);\n        }\n\n        // get z\n        if ((token = strtok(NULL, delim)) != NULL) {\n            strcpy(V[i].z, token);\n        }\n        else {\n            printf(\"INPUT ERROR\\n\");\n            exit(1);\n        }\n\n        // switch this to NULL to keep parsing the same string\n        toStrtokVertex = NULL;\n        i++;\n    }\n\n    for (int j = 0; j &lt; i; j++) {\n        printf(\"V[%d] (%s, %s, %s)\\n\", j, V[j].x, V[j].y, V[j].z);\n    }\n}\n</code></pre>\n\n<p>Note that I modified your input value to match your description.  You had</p>\n\n<pre><code>\"v 23.232000 32.33000 2.03900\\n 9.20900 3.29000 1.0002\"\n</code></pre>\n\n<p>which did not have a <code>v</code> after the <code>\\n</code> to start the next vertex, so I added a <code>v</code></p>\n\n<pre><code>\"v 23.232000 32.33000 2.03900\\nv 9.20900 3.29000 1.0002\"\n</code></pre>\n"}], "owner": {"reputation": 94, "user_id": 7763996, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/852f371407cfaf2dc04a7793cee75b99?s=128&d=identicon&r=PG&f=1", "display_name": "shinwari_afg", "link": "https://stackoverflow.com/users/7763996/shinwari-afg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1519809214, "accepted_answer_id": 49019621, "answer_count": 2, "score": 0, "last_activity_date": 1519834859, "creation_date": 1519770405, "last_edit_date": 1519834859, "question_id": 49018978, "link": "https://stackoverflow.com/questions/49018978/array-of-of-struct-containing-array-of-char-as-members-c", "closed_reason": "Not suitable for this site", "title": "Array of of Struct containing array of char as members - C", "body": "<p>I have a struct like this:</p>\n\n<pre><code>struct vertices{\n                  char x[20];\n                  char y[20];\n                  char z[20];\n                 };\n</code></pre>\n\n<p>and then in main I have an array of the struct vertices like this:</p>\n\n<pre><code>struct vertices vert[64];\n</code></pre>\n\n<p>plus an array of char in my main function like this:</p>\n\n<pre><code>char exampleArray[200]=\"v 23.232000 32.33000 2.03900\\nv 9.20900 3.29000 1.0002\\n\";\n</code></pre>\n\n<p>so what I want to do is to parse this big array containing a hundred or so vertices, and store each value in the corresponding x,y,z char arrays of the struct vertices, which later I'm gonna simply convert by calling on\n <code>float x=atof(vert[1].x)</code> and draw each one.</p>\n\n<p>But the problem is that I can't store , copy, concat characters from the raw array to the x,y,z arrays by any ways, i tried to do it by <code>vert[0].x=exampleArray[0], vert[0].x=exampleArray+i</code> etc inside different conditions like </p>\n\n<pre><code>if(SpaceCount==1)\n       {\n              vert[0].x[0]=exampleArray[i];\n              i++;\n\n        }\n</code></pre>\n\n<p>but all this doesn't work.</p>\n\n<p>I tried so many variations, couldn't list them all.\nBut the thing I want is to parse the exampleArray which has my vertices in raw format, every 3D vertix has spaces in between them, every vertix starts with a char V followed by a space, the first point is the X then followed by a space and then the Y point and after the Z point there is newline \\n character and then again a V for a new vertix.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 39159, "user_id": 1541563, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/U4EOh.png?s=128&g=1", "display_name": "Patrick Roberts", "link": "https://stackoverflow.com/users/1541563/patrick-roberts"}, "edited": false, "score": 0, "creation_date": 1519767265, "post_id": 49018271, "comment_id": 85041729, "body": "<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_rewind.htm\" rel=\"nofollow noreferrer\"><code>rewind(file);</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 6120, "user_id": 9214517, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uHHGLaUqJK4/AAAAAAAAAAI/AAAAAAAAAAA/EMWzo-f2N9c/photo.jpg?sz=128", "display_name": "adrtam", "link": "https://stackoverflow.com/users/9214517/adrtam"}, "is_accepted": true, "score": 6, "last_activity_date": 1519768668, "last_edit_date": 1519768668, "creation_date": 1519767348, "answer_id": 49018318, "question_id": 49018271, "link": "https://stackoverflow.com/questions/49018271/how-to-iterate-through-a-file-twice-by-using-whilec-getcfile-eof/49018318#49018318", "title": "How to iterate through a file twice by using while((c = getc(file)) != EOF)?", "body": "<p>Use <code>fseek</code> and <code>ftell</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv) {\n    int c;\n    FILE *file;\n    long remember_pos;\n    file = fopen(argv[1], \"r\");\n    if (file) {\n\n        while ((c = getc(file)) != EOF) {\n            remember_pos = ftell(file);\n            if (c == 'a') {\n                // loops through this part of the file without breaking the \n                // the original c\n            };\n            fseek(file, remember_pos, SEEK_SET);\n        }\n    }\n}\n</code></pre>\n\n<p>man page: <a href=\"https://www.freebsd.org/cgi/man.cgi?query=fseek\" rel=\"nofollow noreferrer\">https://www.freebsd.org/cgi/man.cgi?query=fseek</a></p>\n"}, {"tags": [], "owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1519767430, "creation_date": 1519767430, "answer_id": 49018337, "question_id": 49018271, "link": "https://stackoverflow.com/questions/49018271/how-to-iterate-through-a-file-twice-by-using-whilec-getcfile-eof/49018337#49018337", "title": "How to iterate through a file twice by using while((c = getc(file)) != EOF)?", "body": "<p>take a look at the command <a href=\"http://www.cplusplus.com/reference/cstdio/fseek/\" rel=\"nofollow noreferrer\">fseek reference</a></p>\n\n<p>it jumps to an offset from Start/End/Current-position of File</p>\n\n<p>to jump to start use <code>fseek(f, 0, SEEK_SET)</code> which is equivalent to <code>rewind(f)</code></p>\n"}], "owner": {"reputation": 233, "user_id": 8658491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1c86647a34b4c0a2df1e6c282b07fd4?s=128&d=identicon&r=PG&f=1", "display_name": "e t", "link": "https://stackoverflow.com/users/8658491/e-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 49018318, "answer_count": 2, "score": -1, "last_activity_date": 1519768668, "creation_date": 1519767131, "question_id": 49018271, "link": "https://stackoverflow.com/questions/49018271/how-to-iterate-through-a-file-twice-by-using-whilec-getcfile-eof", "title": "How to iterate through a file twice by using while((c = getc(file)) != EOF)?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char **argv) {\n    int c;\n    FILE *file;\n    file = fopen(argv[1], \"r\");\n    if (file) {\n\n        while ((c = getc(file)) != EOF) {\n            if (c == 'a') {\n                // loops through this part of the file without breaking the \n                // the original c\n            }\n        }\n\n\n    }\n}\n</code></pre>\n\n<p>Basically, this program has really no purpose just wondering if there is a easy way to loop twice in a file.</p>\n\n<p>like for example say the contents of a file is \"1234a456468\"</p>\n\n<p>when c is at index 4. I want to make another loop without affecting c, we'll call another variable d, where d is at index 4 as well and I can use d = getc(file) without it affecting c. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1519766115, "post_id": 49018047, "comment_id": 85041227, "body": "What&#39;s wrong? Except the fact you are appending the newline in the beginning instead of the end."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1519766205, "post_id": 49018047, "comment_id": 85041265, "body": "You say you&#39;re not getting the desired output, but haven&#39;t told us exactly what that is, nor what you&#39;re currently getting."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1519766231, "post_id": 49018047, "comment_id": 85041274, "body": "What&#39;s a decimal? A floating point number perhaps? Put together a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, and verifiable example</a> that shows all of the variable declarations."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1519766434, "post_id": 49018047, "comment_id": 85041374, "body": "I see a lot of differences just by reading it. You&#39;re obviously not printing &quot;and&quot; in your <code>cout</code> version, but you are in your <code>printf</code> version. Your <code>printf</code> version outputs a new line first, which your <code>cout</code> version doesn&#39;t do. If <code>A_ii</code> and <code>A_jj</code> are  &quot;decimals&quot; I assume you mean some kind of floating point? So the <code>%d</code> specifiers in the <code>printf</code> format are wrong (they&#39;re for integers). Your <code>printf</code> version puts spaces around <code>:</code> but your <code>cout</code> version does not. Maybe you just need to go through your <code>printf</code> format more carefully."}, {"owner": {"reputation": 768, "user_id": 5091507, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DnZgW.png?s=128&g=1", "display_name": "Alaleh Ahmadian", "link": "https://stackoverflow.com/users/5091507/alaleh-ahmadian"}, "edited": false, "score": 3, "creation_date": 1519766639, "post_id": 49018047, "comment_id": 85041462, "body": "if by decimal you mean they&#39;re doubles you should put <code>%f</code> instead of <code>%d</code>"}], "answers": [{"tags": [], "owner": {"reputation": 4598, "user_id": 9264702, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mHczh.jpg?s=128&g=1", "display_name": "Stephen Docy", "link": "https://stackoverflow.com/users/9264702/stephen-docy"}, "is_accepted": true, "score": 1, "last_activity_date": 1519766991, "creation_date": 1519766991, "answer_id": 49018237, "question_id": 49018047, "link": "https://stackoverflow.com/questions/49018047/printf-equivalent-of-cout-statement-strings-and-multiple-variables-in-same-sta/49018237#49018237", "title": "printf equivalent of cout statement (strings, and multiple variables in same statement)", "body": "<p>You almost have it right, you are just using the int <code>%d</code> format token for your decimals.  Try <code>%f</code> instead.</p>\n\n<pre><code>printf(\"\\nIndices and values: %d and %d : %f %f\", i, j, A_ii, A_jj);\n</code></pre>\n"}], "owner": {"reputation": 1178, "user_id": 3761166, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/yMEuq.png?s=128&g=1", "display_name": "Commoner", "link": "https://stackoverflow.com/users/3761166/commoner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 49018237, "answer_count": 1, "score": -4, "last_activity_date": 1519766991, "creation_date": 1519766061, "question_id": 49018047, "link": "https://stackoverflow.com/questions/49018047/printf-equivalent-of-cout-statement-strings-and-multiple-variables-in-same-sta", "title": "printf equivalent of cout statement (strings, and multiple variables in same statement)", "body": "<p>I am looking for the <code>printf</code> (<code>C</code>) equivalent of this <code>C++</code> output statement (<code>cout</code>):</p>\n\n<pre><code>cout &lt;&lt; \"Indices and values: \" &lt;&lt; i &lt;&lt; \" \" &lt;&lt; j &lt;&lt; \":\" &lt;&lt;A_ii &lt;&lt;\" \"&lt;&lt; A_jj &lt;&lt; endl;\n</code></pre>\n\n<p>Here <code>i</code>, <code>j</code> are integers and <code>A_ii</code>, <code>Ajj</code> are decimals. Presently, I am trying this, but it doesn't seem to give the desired output in <code>C</code>.</p>\n\n<p><code>printf(\"\\nIndices and values: %d and %d : %d %d\", i, j, A_ii, A_jj);</code></p>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["c", "function", "variables", "call", "local"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519765107, "post_id": 49017780, "comment_id": 85040747, "body": "Local variables are just that: Local. If you need to share them between methods you need to return them from the function and the calling function is responsible for capturing those return values and storing them somewhere."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1519765277, "post_id": 49017780, "comment_id": 85040850, "body": "local variables cease to exist when the functions they&#39;re in return.. recommend reading up on variable scope: <a href=\"https://www.google.com/search?source=hp&amp;ei=9caVWo_eCceK0wKW-qGgCw&amp;q=c+variable+scope&amp;oq=c+variable+scope&amp;gs_l=psy-ab.3..0l2j0i22i30k1l8.892.3064.0.3262.16.12.0.0.0.0.325.1016.0j4j1j1.6.0....0...1c.1.64.psy-ab..10.6.1013...0i131k1.0.QkODFhbFB8s\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519765853, "post_id": 49017780, "comment_id": 85041110, "body": "@tadman It&#39;s not meaningless in C.  An empty argument list means the function takes an unspecified number of arguments, while an unnamed <code>void</code> argument means the function takes no arguments.  In C++ they&#39;re equivalent."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1519766289, "post_id": 49017780, "comment_id": 85041299, "body": "@dbush Is this still the case in C99? I&#39;ve only seen that used in really old code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519766513, "post_id": 49017780, "comment_id": 85041404, "body": "You are complicating the problem by repeating similar but useless functions. Get <b>one</b> function working first, and I suggest you adopt a development style from this approach: don&#39;t write a wall of code without proving each step. The smaller the step you test and stretch, the better and easier it will be, even if it seems like too much work. You wrote several functions \u2013 and now they all need re-writing."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1519766515, "post_id": 49017780, "comment_id": 85041406, "body": "@tadman For function prototypes, yes it is the case in C99 and C11."}, {"owner": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519766781, "post_id": 49017780, "comment_id": 85041513, "body": "Guys thanks for contributing. I really appreciate it !! I solved it by making them global variables. But how can I do it by storing them in another function and get them as arguments ? Any reference..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1519766912, "post_id": 49017780, "comment_id": 85041573, "body": "@KlaydPro You can&#39;t.  Read up on passing parameters to and returning values from functions."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1519766060, "post_id": 49017892, "comment_id": 85041205, "body": "A third option would be to use malloc and pass the variables to the functions."}, {"owner": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519766404, "post_id": 49017892, "comment_id": 85041353, "body": "Ok I solved it with the 2nd way. But how can I do it with 1st way by storing them in another function and get them as arguments ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519766639, "post_id": 49017892, "comment_id": 85041461, "body": "@KlaydPro Have the functions return the values they read, then pass those values to the other functions that need them.  Also, don&#39;t recursively call <code>main</code> but use a loop instead."}, {"owner": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519767378, "post_id": 49017892, "comment_id": 85041787, "body": "I did sth like this :   void first (){ printf(&quot;Enter First number: &quot;); scanf(&quot;%f&quot;, &amp;a ); return a; }  Having: float a; as a global variable.  Now How can I read the returned value  to &quot;enter&quot; function?"}, {"owner": {"reputation": 524, "user_id": 9249002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d30321c6cd41b504daf51b654cee09?s=128&d=identicon&r=PG&f=1", "display_name": "bebidek", "link": "https://stackoverflow.com/users/9249002/bebidek"}, "edited": false, "score": 0, "creation_date": 1519767896, "post_id": 49017892, "comment_id": 85042043, "body": "Then you have a syntax error. <code>void</code> before function means that it doesn&#39;t return anything. You have to choose one option: either returning value or global variables."}, {"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1519768807, "post_id": 49017892, "comment_id": 85042488, "body": "Can\u2019t you also pass the variables by reference?"}], "tags": [], "owner": {"reputation": 524, "user_id": 9249002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3d30321c6cd41b504daf51b654cee09?s=128&d=identicon&r=PG&f=1", "display_name": "bebidek", "link": "https://stackoverflow.com/users/9249002/bebidek"}, "is_accepted": false, "score": -1, "last_activity_date": 1519765359, "creation_date": 1519765359, "answer_id": 49017892, "question_id": 49017780, "link": "https://stackoverflow.com/questions/49017780/how-to-call-a-local-variable-from-another-function-c/49017892#49017892", "title": "How to call a local variable from another function c", "body": "<p>Local variables (as name suggests) are local and can't keep their values after function ends. You have two options:</p>\n\n<ol>\n<li>Make functions first, second and third return their numbers and another functions get them as arguments.</li>\n<li>Make a,b,c global variables.</li>\n</ol>\n\n<p>The second one is much easier, but it's so called bad programming style.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9420922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd22cc8d765bf6b267eea459d2100fd?s=128&d=identicon&r=PG", "display_name": "AxW", "link": "https://stackoverflow.com/users/9420922/axw"}, "is_accepted": false, "score": 0, "last_activity_date": 1519765477, "creation_date": 1519765477, "answer_id": 49017912, "question_id": 49017780, "link": "https://stackoverflow.com/questions/49017780/how-to-call-a-local-variable-from-another-function-c/49017912#49017912", "title": "How to call a local variable from another function c", "body": "<p>For example declare <code>float a,b,c;</code> in your Main and change your functions to return a float\n<code>float first() { ... }</code>\nThen write<code>a = first();</code></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1519767845, "post_id": 49018272, "comment_id": 85042013, "body": "As a number of terminals do not flush <code>stdout</code> before <code>scanf()</code>, adding <code>fflush(stdout);</code> between <code>printf(&quot;%s&quot;, prompt);</code> and <code>if (scanf(...</code> insures the prompt is seen first."}, {"owner": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519767930, "post_id": 49018272, "comment_id": 85042060, "body": "Hats off !!! Thanks  a lot !  it was very clear. I am just beginning the journey of programming. So I am trying to acquire as much as possible by excellent  programmers as you !"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "edited": false, "score": 0, "creation_date": 1519768333, "post_id": 49018272, "comment_id": 85042270, "body": "@KlaydPro, you&#39;re welcome. I am glad I was able to contribute to your learning."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1519768279, "last_edit_date": 1519768279, "creation_date": 1519767138, "answer_id": 49018272, "question_id": 49017780, "link": "https://stackoverflow.com/questions/49017780/how-to-call-a-local-variable-from-another-function-c/49018272#49018272", "title": "How to call a local variable from another function c", "body": "<p>It's best if functions don't depend or modify data external to them. It's not always possible but it is better if they can be defined with that goal in mind.</p>\n\n<p>In your case, the functions <code>first</code>, <code>second</code>, and <code>third</code> are doing essentially the same thing. It will be better to use just one function and give it a more appropriate name, such as <code>read_float</code> and change the return type so that the value input by the user is returned to the calling function.</p>\n\n<p>Declare it as:</p>\n\n<pre><code>float read_float(char const* prompt);\n</code></pre>\n\n<p>Then, you can use it as:</p>\n\n<pre><code>float a = read_float(\"Enter the first number:\");\nfloat b = read_float(\"Enter the second number:\");\nfloat c = read_float(\"Enter the third number:\");\n</code></pre>\n\n<p>etc.</p>\n\n<p>The function <code>enter</code> does not correctly convey what it is doing. It should be renamed to something more appropriate, such as <code>display_input_values</code>. It can accept the values input by the user as its arguments. </p>\n\n<p>Declare it as:</p>\n\n<pre><code>void display_input_values(float a, float b, float c);\n</code></pre>\n\n<p>and use it as:</p>\n\n<pre><code>float a = read_float(\"Enter the first number:\");\nfloat b = read_float(\"Enter the second number:\");\nfloat c = read_float(\"Enter the third number:\");\ndisplay_input_values(a, b, c);\n</code></pre>\n\n<p>The <code>scan</code> function does not convey its meaning clearly either. You could divide <code>scan</code> to two functions -- one that returns you the option of whether to continue with the next inputs or to call a function that computes something with the user input.</p>\n\n<p>You can get the option from the user by using a function named <code>read_int</code> function as:</p>\n\n<pre><code>int option = read_int(\"Enter 1 for next round of inputs and 2 to compute with current input:\");\n</code></pre>\n\n<p>and use that returned value as:</p>\n\n<pre><code>if ( option == 2 )\n{\n   // Do the computations\n}\n</code></pre>\n\n<p>You also need another option to exit the program. The call to get the option needs to be:</p>\n\n<pre><code>char const* prompt = \"Enter 1 for next round of inputs.\\n\"\n                     \"Enter 2 to compute with current input.\\n\"\n                     \"Enter 3 to exit program.\\n\";\nint option = read_int(prompt);\n</code></pre>\n\n<p>Always add code to check whether <code>scanf</code> succeeded before proceeding to use the data that you were expecting to read into.</p>\n\n<hr>\n\n<p>Here's an updated version of your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nfloat read_float(char const* prompt);\nint read_int(char const* prompt);\nvoid display_input_values(float a, float b, float c);\nvoid math(float a, float b, float c);\n\nint main() \n{\n   while ( 1 )\n   {\n      float a = read_float(\"Enter first number: \");\n      float b = read_float(\"Enter second number: \");\n      float c = read_float(\"Enter third number: \");\n\n      display_input_values(a, b, c);\n\n\n      char const* prompt = \"Enter 1 for next round of inputs.\\n\"\n                           \"Enter 2 to compute with current input.\\n\"\n                           \"Enter 3 to exit program.\\n\";\n      int option = read_int(prompt);\n      if ( option == 3 )\n      {\n         break;\n      }\n\n      else if ( option == 2 )\n      {\n         math(a, b, c);\n      }\n   }\n}\n\n\nfloat read_float(char const* prompt)\n{\n   float num;\n   printf(\"%s\", prompt);\n\n   // For flushing the output of printf before scanf.\n   fflush(stdout);\n\n   if (scanf(\"%f\", &amp;num ) != 1)\n   {\n      print(\"Unable to read number. Exiting.\\n\");\n      exit(1);\n   }\n   return num;\n}\n\nint read_int(char const* prompt)\n{\n   int num;\n   printf(\"%s\", prompt);\n\n   // For flushing the output of printf before scanf.\n   fflush(stdout);\n\n   if (scanf(\"%d\", &amp;num ) != 1)\n   {\n      print(\"Unable to read number. Exiting.\\n\");\n      exit(1);\n   }\n   return num;\n}\n\nvoid display_input_values(float a, float b, float c)\n{\n  printf(\"You have entered a: %f, b: %f, c:%f\\n\", a, b, c);\n}\n\nvoid math(float a, float b, float c)\n{\n   // Do whatever makes sense to you.\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9420839, "user_type": "registered", "profile_image": "https://graph.facebook.com/169211083869319/picture?type=large", "display_name": "Klayd Pro", "link": "https://stackoverflow.com/users/9420839/klayd-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4815, "favorite_count": 0, "accepted_answer_id": 49018272, "answer_count": 3, "score": 0, "last_activity_date": 1519768279, "creation_date": 1519764829, "question_id": 49017780, "link": "https://stackoverflow.com/questions/49017780/how-to-call-a-local-variable-from-another-function-c", "title": "How to call a local variable from another function c", "body": "<p>I am new to programming. I would like to call from functions(first, second, third the variables in function \"enter\" and in function \"math\" accordingly).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid math (void);\nvoid first (void);\nvoid second (void);\nvoid third (void);\nvoid enter(void);\nvoid scan(void);\n\n\nint main() \n{\n\n first();  //function\n second(); //function\n third();  //function\n enter();  //function\n printf(\"\\n\\n Would you like to edit? (Y/N)\\n\\n\");\n scan();   //function\n return(0);\n}\n</code></pre>\n\n<p>Here is the user input: </p>\n\n<pre><code>void first (void){\nfloat a;\nprintf(\"Enter First number: \");\nscanf(\"%f\",&amp;a);\n }\n\n void second (void){\n float b;\n printf(\"Enter Second number: \");\n scanf(\"%f\",&amp;b);\n  }\n\n  void third (void){\n  float c;\n  printf(\"Enter Third number: \");\n  scanf(\"%f\", &amp;c );\n  }\n</code></pre>\n\n<p>How can I call the variables from the user input to the function below?</p>\n\n<pre><code>  void enter(){\n  float a,b,c;\n  printf(\"you have entered a: %f, b: %f, c:%f\", a,b,c);\n     }\n</code></pre>\n\n<p>This is the loop in case the user would like to edit or continue with the initial  input numbers. </p>\n\n<pre><code>    void scan(void){\n    int ch;\n    scanf(\"%d\", &amp;ch);\n    if (ch==1){\n        main();\n\n        }else{\n        math();\n        }\n        }\n</code></pre>\n\n<p>Here I would also like to call the input variables from function (first, second third) in order to perform some math calculations. </p>\n\n<pre><code>        void math (void){\n           float a,b,c;\n           float x,y,z;\n           x=a+b+c;\n           y= powf(x,2);\n           z=sqrt(y);\n\n           printf(\"Final Result of Addition is: %f \\n Final Result of \n           Multiplication is: %f \\n Final Result of squareroot  is:%f\\n \n           \",x,y,z);\n                          }\n</code></pre>\n"}, {"tags": ["c", "debugging", "readfile", "singly-linked-list", "interruption"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1519764928, "post_id": 49017763, "comment_id": 85040643, "body": "<code>malloc(sizeof(char))</code> allocates <b>1 byte</b>, only enough for a string terminator! Suggest <code>char* target = malloc(strlen(source) + 1));</code> or even <code>char* target = strdup(source);</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1519765271, "post_id": 49017763, "comment_id": 85040846, "body": "Please read <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">Why is the gets function so dangerous that it should not be used?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1519765832, "post_id": 49017840, "comment_id": 85041101, "body": "<code>char *target = strdup(source)</code> does all the heavy lifting for you"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1519765128, "creation_date": 1519765128, "answer_id": 49017840, "question_id": 49017763, "link": "https://stackoverflow.com/questions/49017763/program-execution-interrupted-when-certain-string-is-read-from-file/49017840#49017840", "title": "Program execution interrupted when certain String is read from File", "body": "<p>In <code>getString</code>, you're not allocating enough space for the string you want to copy:</p>\n\n<pre><code>char* target = (char*) malloc(sizeof(char));\n</code></pre>\n\n<p>This is only allocating space for a single character.  You need enough for the length of the string, plus 1 more for the null terminating byte:</p>\n\n<pre><code>char* target = malloc(sizeof(strlen(source) + 1);\n</code></pre>\n\n<p>You could actually replace the entire function with a call to <code>strdup</code>, which does the same thing.</p>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don't cast the return value of <code>malloc</code></a>, and <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">never use <code>gets</code></a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9419857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ab73831d4a770fcd25f17d4c5d0b04?s=128&d=identicon&r=PG&f=1", "display_name": "serene", "link": "https://stackoverflow.com/users/9419857/serene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1519765128, "creation_date": 1519764770, "question_id": 49017763, "link": "https://stackoverflow.com/questions/49017763/program-execution-interrupted-when-certain-string-is-read-from-file", "title": "Program execution interrupted when certain String is read from File", "body": "<p>I have a small problem with my code and hope you can help me.\nThis program below reads names that are written in a txt-file and stores them in a linked list and prints them back out on the command line.</p>\n\n<p>The list consists of the following names:</p>\n\n<pre><code>Gustav Mahler\nFrederic Chopin\nLudwig van Beethoven\nJohann-Wolfgang Von-Goethe\n</code></pre>\n\n<p>But when I run the program, the execution of the program is interrupted, either before printing the list or after. </p>\n\n<p>If I remove the last line it works perfectly, but when I add it back in to the list or replace it with a random combination like \"jlajfi3jrpi\u00f6k+kv\u00f6aj3jiijm. --aerjj\" it stops again.</p>\n\n<p>Can somebody please explain to me why the program execution gets interrupted? </p>\n\n<p>Thank you in advance ! :)</p>\n\n<p>Here's the Program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct list {\n    char* name;\n    struct list *next;\n}NODE;\n\nchar * getString(char *source);\n\nint main() {\n\nFILE *fpointer = NULL;              \nchar filename[100];\n\nputs(\"\\nEnter the name of the file:\\n\");\ngets(filename);\n\nif((fpointer = fopen(filename, \"r\")) == NULL ) {\n    printf(\"\\nThe file you have chosen is not valid.\\n\");\n    return 1;\n}\n\nchar buffer[200];\nNODE *head = NULL;\nNODE *current = NULL;\n\n\nwhile(fgets(buffer, 200, fpointer) != NULL) {\n\n    NODE *node = (NODE *) malloc(sizeof(NODE));                         \n    node -&gt; next = NULL;\n\n    node -&gt; name = getString(buffer);\n\n\n    if(head == NULL) {\n        head = node;\n    } else {\n        current -&gt; next = node;\n    }\n\n    current = node;\n\n}\n\ncurrent = head;\nwhile(current) {\n    printf(\"%s\", current -&gt; name);\n    current = current -&gt; next;\n}\n\n\nreturn 0;\n}\n\n\nchar * getString(char* source) {\n    char* target = (char*) malloc(sizeof(char));\n    strcpy(target, source);\n    return target;\n}\n</code></pre>\n"}, {"tags": ["c", "ubuntu", "opengl", "glfw"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519768648, "post_id": 49017718, "comment_id": 85042408, "body": "Did you run <code>make</code> before <code>sudo make install</code>?"}, {"owner": {"reputation": 33, "user_id": 7290597, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746588645659370/picture?type=large", "display_name": "Xiaotian Hu", "link": "https://stackoverflow.com/users/7290597/xiaotian-hu"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519779803, "post_id": 49017718, "comment_id": 85046057, "body": "Yes I did. The build was success, but somehow my test code could not link to the shared library."}, {"owner": {"reputation": 5405, "user_id": 4619958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cVA9W.png?s=128&g=1", "display_name": "ch271828n", "link": "https://stackoverflow.com/users/4619958/ch271828n"}, "edited": false, "score": 0, "creation_date": 1613611479, "post_id": 49017718, "comment_id": 117131338, "body": "That&#39;s actually <code>apt-get install libglfw3-dev</code>"}], "owner": {"reputation": 33, "user_id": 7290597, "user_type": "registered", "profile_image": "https://graph.facebook.com/1746588645659370/picture?type=large", "display_name": "Xiaotian Hu", "link": "https://stackoverflow.com/users/7290597/xiaotian-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1148, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519765071, "creation_date": 1519764565, "last_edit_date": 1519765071, "question_id": 49017718, "link": "https://stackoverflow.com/questions/49017718/why-installing-glfw-through-apt-get-works-but-manually-compiling-failed", "title": "Why installing glfw through apt-get works but manually compiling failed", "body": "<p>I tried to install glfw3 in ubuntu 16. I first followed the instruction in <a href=\"http://www.glfw.org/docs/latest/compile_guide.html\" rel=\"nofollow noreferrer\">glfw docs</a>: downloaded the source of glfw, built it into shared library by setting </p>\n\n<pre><code>cmake -DBUILD_SHARED_LIBS=ON \n</code></pre>\n\n<p>and installed it by typing:</p>\n\n<pre><code>sudo make install\n</code></pre>\n\n<p>But the installation failed. When I tried to compile the sample code found <a href=\"http://web.eecs.umich.edu/~sugih/courses/eecs487/glfw-howto/sample.cpp\" rel=\"nofollow noreferrer\">there</a>, some undefined reference errors appeared:</p>\n\n<pre><code>undefined reference to `glfwSetErrorCallback'\nundefined reference to `glfwInit'\nundefined reference to `glfwWindowHint'\nundefined reference to `glfwWindowHint'\nundefined reference to `glfwWindowHint'\nundefined reference to `glfwWindowHint'\nundefined reference to `glfwWindowHint'\nundefined reference to `glfwCreateWindow'\nundefined reference to `glfwTerminate'\nundefined reference to `glfwSetKeyCallback'\nundefined reference to `glfwMakeContextCurrent'\nundefined reference to `glfwGetProcAddress'\nundefined reference to `glfwTerminate'\nundefined reference to `glfwGetFramebufferSize'\nundefined reference to `glfwGetTime'\nundefined reference to `glfwSwapBuffers'\nundefined reference to `glfwPollEvents'\nundefined reference to `glfwGetTime'\nundefined reference to `glfwWindowShouldClose'\nundefined reference to `glfwTerminate\n</code></pre>\n\n<p>My compiling command was:</p>\n\n<pre><code>g++ glfwtest.c -lglfw -lGL\n</code></pre>\n\n<p>But when I changed my approach, and installed glfw3 directly using apt-get by typing:</p>\n\n<pre><code>sudo agt-get install libglwf3-dev\n</code></pre>\n\n<p>My test code was successfully compiled with the same compiling command.</p>\n\n<p>It is wired, does anyone know why?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 4, "creation_date": 1519763478, "post_id": 49017408, "comment_id": 85039875, "body": "Your question is equivalent to &quot;what is the purpose of header files?&quot;."}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1519763483, "post_id": 49017408, "comment_id": 85039879, "body": "For one thing, it would be difficult to respect the <a href=\"http://en.cppreference.com/w/cpp/language/definition#One_Definition_Rule\" rel=\"nofollow noreferrer\">one definition rule</a> using this approach. It seems to me like you do not quite understand the reason for header files and the difference between a header and a source file."}, {"owner": {"reputation": 8570, "user_id": 2293156, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e791e8e13500e516c9ae77299160a?s=128&d=identicon&r=PG", "display_name": "Amadeus", "link": "https://stackoverflow.com/users/2293156/amadeus"}, "edited": false, "score": 1, "creation_date": 1519763563, "post_id": 49017408, "comment_id": 85039928, "body": "You could try to compile it. Take a cofee meanwhile"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1519763569, "post_id": 49017408, "comment_id": 85039930, "body": "Nothing stopping you from using jpg files either."}, {"owner": {"reputation": 209335, "user_id": 661519, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1735ab1c8ba4229daa855ec6aad03065?s=128&d=identicon&r=PG", "display_name": "juanchopanza", "link": "https://stackoverflow.com/users/661519/juanchopanza"}, "edited": false, "score": 3, "creation_date": 1519763686, "post_id": 49017408, "comment_id": 85039991, "body": "Is there any reason for the C++ tag? C++ has many header only libraries BTW."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1519764380, "post_id": 49017408, "comment_id": 85040365, "body": "You are probably missing that .cpp files can be included just like .h files"}, {"owner": {"reputation": 3876, "user_id": 7478455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VP5WO.jpg?s=128&g=1", "display_name": "Mohammad Kanan", "link": "https://stackoverflow.com/users/7478455/mohammad-kanan"}, "edited": false, "score": 0, "creation_date": 1519764960, "post_id": 49017408, "comment_id": 85040661, "body": "header files <code>.h</code> are also reused when you want to share your classes .. it&#39;s not good then if another app compiles your class implementations that you put in a <code>.h</code> file!"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1519765334, "post_id": 49017408, "comment_id": 85040879, "body": "File extensions are just convention.  You can use any file extension.  So you could have the function definitions in .h file and your declarations in a &quot;.d&quot; file."}], "answers": [{"comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1519764669, "post_id": 49017528, "comment_id": 85040518, "body": "There&#39;s literally no difference between <code>.c</code> and <code>.h</code> except how they&#39;re referenced."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 2, "creation_date": 1519765511, "post_id": 49017528, "comment_id": 85040965, "body": "Both of you missed the first sentence."}], "tags": [], "owner": {"reputation": 7666, "user_id": 407071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e3b59a5454c27320f956ab3b177a60e?s=128&d=identicon&r=PG", "display_name": "Eric Finn", "link": "https://stackoverflow.com/users/407071/eric-finn"}, "is_accepted": false, "score": 1, "last_activity_date": 1519763863, "creation_date": 1519763863, "answer_id": 49017528, "question_id": 49017408, "link": "https://stackoverflow.com/questions/49017408/programming-with-just-header-files/49017528#49017528", "title": "Programming with just header files?", "body": "<p>Header files are different from source files by convention. Using the <code>.h</code> or <code>.hpp</code> extension communicates that the file is intended to be <code>#included</code> and is not meant to exist as a standalone source file. You can generally assume that <code>.h</code>/<code>.hpp</code> files are safe to include from multiple source files.</p>\n\n<p>Meanwhile, <code>.c</code> and <code>.cpp</code> extensions communicate that the file likely is intended to be a translation unit and is not suitable to be <code>#included</code> in other translation units.</p>\n\n<p>You could very well write an entire codebase with every file having any arbitrary extension, or none at all, if you really want to make it hard on yourself and anybody else working in the codebase.</p>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 6516820, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3s4ST.jpg?s=128&g=1", "display_name": "Althis", "link": "https://stackoverflow.com/users/6516820/althis"}, "edited": false, "score": 1, "creation_date": 1519764476, "post_id": 49017579, "comment_id": 85040427, "body": "Can&#39;t you still achieve modularization by using separate headers, though? Once you are done with the process of gluing them together, it would form a monolithic block of code, but the programmer still took advantage of the modularization during development."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 167, "user_id": 6516820, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3s4ST.jpg?s=128&g=1", "display_name": "Althis", "link": "https://stackoverflow.com/users/6516820/althis"}, "edited": false, "score": 1, "creation_date": 1519764617, "post_id": 49017579, "comment_id": 85040493, "body": "The difference is that with translation units, you have separate / independent modules in contrast to a large monolithic block. Note that you can compile / test / distribute  translation units separately, whereas a monolithic  block cannot be compiled / tested / distributed partly."}, {"owner": {"reputation": 167, "user_id": 6516820, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3s4ST.jpg?s=128&g=1", "display_name": "Althis", "link": "https://stackoverflow.com/users/6516820/althis"}, "edited": false, "score": 1, "creation_date": 1519764680, "post_id": 49017579, "comment_id": 85040520, "body": "I see. You should add this to your answer, or at least point here. This pretty much answered my question."}, {"owner": {"reputation": 2784, "user_id": 8413636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8c46d1ea221e93d32a1b3d2ee354cae?s=128&d=identicon&r=PG&f=1", "display_name": "zzxyz", "link": "https://stackoverflow.com/users/8413636/zzxyz"}, "reply_to_user": {"reputation": 167, "user_id": 6516820, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3s4ST.jpg?s=128&g=1", "display_name": "Althis", "link": "https://stackoverflow.com/users/6516820/althis"}, "edited": false, "score": 0, "creation_date": 1519764965, "post_id": 49017579, "comment_id": 85040666, "body": "@Althis - And even if you WANTED a large monolithic block, putting <i>all</i> your implementations in header files is a pain for various little technical reasons.  Solvable to a point, but you&#39;re fighting convention and the language at that point."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 7, "last_activity_date": 1519764994, "last_edit_date": 1519764994, "creation_date": 1519764053, "answer_id": 49017579, "question_id": 49017408, "link": "https://stackoverflow.com/questions/49017408/programming-with-just-header-files/49017579#49017579", "title": "Programming with just header files?", "body": "<p>Header files come with the concept of modularisation, i.e. of separating the source code of a large program into several independent parts, i.e. translation units. Thereby, implementation details are hidden to other translation units, and dependencies are dramatically reduced. But: if a translation unit A needs to call a function from another translation B, it needs to have the function prototype of the respective function, i.e. the function without the body - something like <code>int functionFromB(int x);</code> in order to tell the compiler how to call it. So translation unit A could simple write this prototype at the beginning; but usually functions from translation unit B (e.g. B.cpp) are exposed in a header file <code>B.h</code>, which comprises all the \"public\" functions of B in form of function prototypes. Same applies to type definitions and (global) variables. Then A simply can include <code>B.h</code> in order to have all the function prototypes et al. available without the necessity of knowing all the implementation details (like the function bodies).</p>\n\n<p>So you can write a large program completely in <code>.h</code>-files; yet you have to tell the compiler to treat them as translation units (usually only <code>.cpp</code>-files are treated as such), and you still have to provide function prototypes et al...</p>\n\n<p>With translation units, you have separate / independent modules. This is in contrast to a large monolithic block, which you get when you \"paste\" all the chunks of your program spread over different <code>.h</code>-files by <code>#include</code>-ing them \"together\". You can compile / test / distribute translation units separately, whereas a monolithic block cannot be compiled / tested / distributed partly.</p>\n"}, {"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1519764473, "creation_date": 1519764473, "answer_id": 49017691, "question_id": 49017408, "link": "https://stackoverflow.com/questions/49017408/programming-with-just-header-files/49017691#49017691", "title": "Programming with just header files?", "body": "<p>I thought of a strange analogy.</p>\n\n<p>You go to a restaurant.<br>\nThe waiter presents you with a menu. The menu is your interface to the kitchen.<br>\nYou pick the dish(es) you want to order.  </p>\n\n<p>Then,</p>\n\n<p>Option 1:</p>\n\n<p>The waiter asks you to move to the kitchen and see for yourself how the dishes are prepared. You remain in the kitchen until the food is served to you.</p>\n\n<p>Option 2:</p>\n\n<p>The waiter brings the food to your table after it is prepared in a kitchen that you don't necessarily see.</p>\n\n<p>Which one would you prefer?</p>\n\n<p>Putting the implementation in the .h file is analogous to Option 1. </p>\n\n<p>Putting the implementation in a .c/.cpp file somewhere else is analogous to Option 2.</p>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519772989, "post_id": 49017794, "comment_id": 85044066, "body": "I know of one program where the release build #includes all the .cpp files into one (they are designed for that) in order to allow better compiler optimization. The build takes 2 hours and some gigabytes of RAM. For one file."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1519775413, "post_id": 49017794, "comment_id": 85044795, "body": "@immibis That sounds like...fun."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 5, "last_activity_date": 1519764914, "creation_date": 1519764914, "answer_id": 49017794, "question_id": 49017408, "link": "https://stackoverflow.com/questions/49017408/programming-with-just-header-files/49017794#49017794", "title": "Programming with just header files?", "body": "<p>Header files are a necessity of C and C++ when you need to reference code or data structures across different files, something especially important when external programs that need to link against a library and the compiler has to understand how to use it.</p>\n\n<p>It's advantageous to break up your application into a series of <code>.c</code> or <code>.cpp</code> files in order to make the compilation process more efficient. Most compiler environments, where they're <code>Makefile</code> driven or IDE managed, have methods for detecting which files need to be recompiled when a change is made.</p>\n\n<p>In larger applications building all files can take considerable time, but recompiling a single <code>.cpp</code> file is often fairly quick. So long as you change only the <code>.cpp</code> source and don't touch the headers you can do a quick recompile and relink, ready for testing right away.</p>\n\n<p>If instead you put everything into a header file then you'd need to recompile everything, every time, which can be a painfully slow process.</p>\n\n<p>Keep in mind some code bases can take <em>hours</em> to rebuild, so this is not a sustainable practice.</p>\n"}], "owner": {"reputation": 167, "user_id": 6516820, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/3s4ST.jpg?s=128&g=1", "display_name": "Althis", "link": "https://stackoverflow.com/users/6516820/althis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 49017579, "answer_count": 4, "score": 0, "last_activity_date": 1519768532, "creation_date": 1519763379, "last_edit_date": 1519768532, "question_id": 49017408, "link": "https://stackoverflow.com/questions/49017408/programming-with-just-header-files", "title": "Programming with just header files?", "body": "<p>If a header file is just a piece of code that gets pasted onto another when I use <code>#include</code> then what is stopping me from programming in C using only .h files? You can even <code>#include</code> into other header files!</p>\n\n<p>I assume there must be some performance or workflow reason why this isn't more common, but if it exists I do not know what it is.</p>\n\n<p>Therefore my question is: <strong>What is the reason people don't program entire applications with just header files?</strong></p>\n"}, {"tags": ["c", "esp32"], "owner": {"reputation": 7202, "user_id": 3068233, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cbb28ff8b495b305b288cfa61247ad21?s=128&d=identicon&r=PG", "display_name": "Ulad Kasach", "link": "https://stackoverflow.com/users/3068233/ulad-kasach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 917, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1519762618, "creation_date": 1519762618, "question_id": 49017237, "link": "https://stackoverflow.com/questions/49017237/how-does-the-sntp-app-of-the-lwip-component-in-esp32-set-the-time-it-receives", "title": "How does the SNTP app of the lwip component in esp32 set the time it receives?", "body": "<p>The <a href=\"https://github.com/espressif/esp-idf/blob/master/components/lwip/apps/sntp/sntp.c\" rel=\"nofollow noreferrer\">SNTP app in the lwip component</a> of the espressif esp32 library sets the time of the system such that calling </p>\n\n<pre><code>sntp_setoperatingmode(SNTP_OPMODE_POLL); \nsntp_setservername(0, \"pool.ntp.org\");\nsntp_init();\nwait_until_time_updated();\nsntp_stop();\ntime(&amp;now);\n</code></pre>\n\n<p>sets the current time into <code>now</code>. </p>\n\n<p>The <code>time()</code> function is defined <a href=\"https://github.com/espressif/newlib-esp32/blob/master/newlib/libc/time/time.c\" rel=\"nofollow noreferrer\">here</a> and uses <code>_gettimeofday_r()</code> to retreive it. </p>\n\n<p><code>sntp_init()</code> utilizes <code>sntp_process()</code>, after receiving a response, to evaluate the response and set the time. From what I understand, it uses the function(?) <code>SNTP_SET_SYSTEM_TIME()</code> to set the time; however, I can not find where this function(?) is defined - and thus cant find how the <code>sntp</code> app sets the time that is retrieved by <code>time()</code>.   </p>\n\n<p>How does <code>sntp_init</code>, of the sntp app in the lwip component for esp32, set the time that is retrieved by <code>time()</code></p>\n"}, {"tags": ["c", "posix", "shared-memory"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1519761746, "post_id": 49016924, "comment_id": 85039012, "body": "How about giving it some non-zero <code>mode</code>?"}, {"owner": {"reputation": 53, "user_id": 8592473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63472c6193db736d7a00c7e1dd6e5e24?s=128&d=identicon&r=PG&f=1", "display_name": "bitrost", "link": "https://stackoverflow.com/users/8592473/bitrost"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519764685, "post_id": 49016924, "comment_id": 85040525, "body": "@EugeneSh. I tried changing the mode to S_IRWXU (stat.h is included). Also tried S_IRWXO and S_IRWXG. Still gives the same error"}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 2, "creation_date": 1519783579, "post_id": 49016924, "comment_id": 85047028, "body": "@bitrost: Probably becasue you ran the program at least once with a mode of 0 creating shm object you can&#39;t access that is now still there.  You need to remove it.  If you&#39;re running on Linux, try <code>ls &#47;dev&#47;shm</code> to see all the existing shm objects..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519860135, "post_id": 49016924, "comment_id": 85085910, "body": "The file: <code>shm.h</code> seems to be ,missing the prototypes for the functions in the file <code>shm.c</code>.  The file: <code>server.c</code> seems to be missing the statement: <code>#include &quot;shm.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519860347, "post_id": 49016924, "comment_id": 85085976, "body": "after the failure of the call to: <code>shm_open()</code> and calling <code>perror()</code>, the code needs to call <code>shm_unlink()</code> and <code>exit( EXIT_FAILURE )</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1519860834, "post_id": 49016924, "comment_id": 85086105, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can easily determine if there are any other problems in how the shared memory is being handled."}, {"owner": {"reputation": 53, "user_id": 8592473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63472c6193db736d7a00c7e1dd6e5e24?s=128&d=identicon&r=PG&f=1", "display_name": "bitrost", "link": "https://stackoverflow.com/users/8592473/bitrost"}, "edited": false, "score": 0, "creation_date": 1519865418, "post_id": 49016924, "comment_id": 85087298, "body": "Thanks - removing the existing object in /dev/shm solved the problem. It had not exited properly when previously run."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 5, "last_activity_date": 1519780592, "last_edit_date": 1519780592, "creation_date": 1519780263, "answer_id": 49020476, "question_id": 49016924, "link": "https://stackoverflow.com/questions/49016924/shared-memory-shm-open-causing-permission-denied/49020476#49020476", "title": "Shared memory - shm_open causing permission denied", "body": "<p>The line</p>\n\n<pre><code>fileDesc = shm_open(shname, O_CREAT | O_RDWR, 0);\n</code></pre>\n\n<p>gives no-one any access rights to the shared memory object. Once you create a shared memory object with no access rights, only the root user will be able to open it.</p>\n\n<p>Instead, use (for example)</p>\n\n<pre><code>fileDesc = shm_open(shname, O_CREAT | O_RDWR, S_IRWXU);\n</code></pre>\n\n<p>(You could allow other users to access the shared memory, obviously. But you need, at a minimum, to allow yourself to access it; otherwise, you won't be able to open it once you've created it.)</p>\n\n<p>Perhaps worth noting that your error message is incorrect, so you might be misleading yourself (and others). The call to <code>shm_open</code> does not fail when it is <em>creating</em> the shared memory object. What fails is opening an already created shared memory object without all permissions for the user.</p>\n"}], "owner": {"reputation": 53, "user_id": 8592473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63472c6193db736d7a00c7e1dd6e5e24?s=128&d=identicon&r=PG&f=1", "display_name": "bitrost", "link": "https://stackoverflow.com/users/8592473/bitrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5589, "favorite_count": 0, "accepted_answer_id": 49020476, "answer_count": 1, "score": 5, "last_activity_date": 1519780592, "creation_date": 1519761408, "question_id": 49016924, "link": "https://stackoverflow.com/questions/49016924/shared-memory-shm-open-causing-permission-denied", "title": "Shared memory - shm_open causing permission denied", "body": "<p>I am writing a program that uses POSIX shared memory and have an error that I am unsure how to fix. I looked for similar questions but could not find any relevant to this specific problem. </p>\n\n<p>Two files are involved - server.c, which contains the code run by the program, and shm.c, which contains functions that provide abstraction for handling the shared memory. This is an assignment, so I cannot deviate very far from the current structure.</p>\n\n<p>Below is the relevant code from each file:</p>\n\n<p>server.c</p>\n\n<pre><code>int shmFd;\n\nshmFd = createSHM(SHNAME);\n</code></pre>\n\n<p>shm.c</p>\n\n<pre><code>int createSHM(char * shname)\n{\n    int fileDesc;\n\n    fileDesc = shm_open(shname, O_CREAT | O_RDWR, 0);\n\n    if(fileDesc == -1)\n    {\n        perror(\"Error: Could not create shared memory space\");\n    }\n\n  return fileDesc;\n}\n</code></pre>\n\n<p>shm.h</p>\n\n<pre><code>#define SHNAME \"/shmserver\" \n</code></pre>\n\n<p>When I attempt to run the built program in the terminal, the following error appears: </p>\n\n<pre><code>Error: Could not create shared memory space: Permission denied \n</code></pre>\n\n<p>Any help would be much appreciated. </p>\n"}, {"tags": ["c++", "c", "winapi", "memory-mapped-files", "memory-mapping"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1519759563, "post_id": 49016459, "comment_id": 85037781, "body": "I don&#39;t like the way you are mixing different APIs... Anyway, take a look at documentation of the third parameter of <code>CreateFile</code>..."}, {"owner": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1519759680, "post_id": 49016459, "comment_id": 85037840, "body": "do you mean fopen and createfilemapping? I am trying to simulate the usecase"}, {"owner": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1519759728, "post_id": 49016459, "comment_id": 85037868, "body": "Don&#39;t files generally get opened (for writing) in exclusive mode, thereby preventing other applications from writing to them?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1519760130, "post_id": 49016459, "comment_id": 85038127, "body": "possible of course"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 374829, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 0, "creation_date": 1519761235, "post_id": 49016459, "comment_id": 85038753, "body": "@NicolBolas: <code>CreateFile</code> takes both an open mode as well as a share mode. You can open a file for writing, and still share it with other writers."}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 1, "creation_date": 1519765169, "post_id": 49016459, "comment_id": 85040791, "body": "using &quot;w+&quot; with fopen will try to re-create the file ! Try &quot;r+&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "edited": false, "score": 0, "creation_date": 1519765001, "post_id": 49017343, "comment_id": 85040689, "body": "I tried with changing the 3rd parameter of <code>CreateFiile</code> with <code>FILE_SHARED_WRITE</code> and now able to open file in write mode within the same process. But it is now allowed to open the same by another process."}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "reply_to_user": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "edited": false, "score": 1, "creation_date": 1519765378, "post_id": 49017343, "comment_id": 85040899, "body": "@user413201: replace &quot;w+&quot; with &quot;r+&quot; with fopen !"}, {"owner": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "edited": false, "score": 0, "creation_date": 1519768691, "post_id": 49017343, "comment_id": 85042428, "body": "So I assume with &quot;w+&quot; it will never succeed because file is already memory-mapped. Is it the case?"}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "reply_to_user": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "edited": false, "score": 1, "creation_date": 1519769050, "post_id": 49017343, "comment_id": 85042584, "body": "@user413201: yes. The point is if the file is already opened (by anything) then it&#39;s invalid to re-create it (&quot;w+&quot;) since this involves a delete and a create. It&#39;s possible to delete a file in use but it won&#39;t be deleted until the last handle to file (by any process) is closed."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1519769399, "post_id": 49017343, "comment_id": 85042735, "body": "@engf-010: &quot;w+&quot; is a <i>truncate</i> if it already exists, not a delete and create."}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1519769664, "post_id": 49017343, "comment_id": 85042844, "body": "@cdarke: I think you&#39;re right. Haven&#39;t used the function for decades! However ,that not quite true ,I just don&#39;t remember the last time !"}, {"owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "edited": false, "score": 0, "creation_date": 1519770729, "post_id": 49017343, "comment_id": 85043262, "body": "MSDN for fopen with &quot;w+&quot; says : opens an empty file for both reading and writing ,If the file exist ,its contents are destroyed. So this could also mean what I said before."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1519806373, "post_id": 49017343, "comment_id": 85054546, "body": "@engf-010: since truncation is one Win32 API call, whereas deleting it and creating it again is a lot more work (copying the security info, for example), plus there&#39;s a chance another process could grab it, it wouldn&#39;t make sense to do it as you say.  The UNIX compilers specifically use the word &quot;truncate&quot;, and I admit that Microsoft do things their own way ...."}], "tags": [], "owner": {"reputation": 3834, "user_id": 517580, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d04aa91a34f0171bcf5898f0b6d81101?s=128&d=identicon&r=PG", "display_name": "engf-010", "link": "https://stackoverflow.com/users/517580/engf-010"}, "is_accepted": false, "score": 0, "last_activity_date": 1519765105, "last_edit_date": 1519765105, "creation_date": 1519763129, "answer_id": 49017343, "question_id": 49016459, "link": "https://stackoverflow.com/questions/49016459/writing-to-memory-mapped-file-while-it-is-memory-mapped/49017343#49017343", "title": "writing to memory mapped file while it is memory-mapped", "body": "<p>The answer for a coherent shared use is simply :yes ,except for <strong>remote</strong> files. (see documentations of <code>CreateFileMapping</code> and/or <code>MapViewOfFile</code>).</p>\n\n<p>For shared use you must however open the file (<code>CreateFile</code>) in a shared-mode (which you didn't specify).\nI don't know in which share-mode <code>fopen</code> operates ,but I suspect your <code>fopen</code> fails because of the missing share-mode with <code>CreateFile</code>. If <code>fopen</code> still fails when using a shared-mode you should use <code>CreateFile</code> instead,</p>\n"}], "owner": {"reputation": 521, "user_id": 1669844, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a7c8af68b3c07151ea0e87a7e385ce9a?s=128&d=identicon&r=PG", "display_name": "user1669844", "link": "https://stackoverflow.com/users/1669844/user1669844"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519765105, "creation_date": 1519759474, "last_edit_date": 1519764888, "question_id": 49016459, "link": "https://stackoverflow.com/questions/49016459/writing-to-memory-mapped-file-while-it-is-memory-mapped", "title": "writing to memory mapped file while it is memory-mapped", "body": "<p>I have memory mapped a file on disk as follow:</p>\n\n<pre><code> const wchar_t fileName[] = L\"temp.txt\";\n HANDLE h = CreateFile(fileName, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);\n HANDLE fileMap = CreateFileMapping(h, NULL, PAGE_READWRITE, 0x0, 1024, NULL);\n char *ptr = (char *)MapViewOfFile(fileMap, FILE_MAP_WRITE | FILE_MAP_READ, 0, 0, 1024)\n</code></pre>\n\n<p>Is it possible to write to the same file by another process while it is memory mapped?</p>\n\n<p><code>FILE *fp = fopen(\"temp.txt\", \"w+\");\n if(NULL == fp) printf(\"Failed to open\\n\");</code></p>\n\n<p>Above code always prints 'Failed to open' if the file is memory mapped.</p>\n"}]