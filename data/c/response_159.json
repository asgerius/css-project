[{"tags": ["c"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1516837456, "post_id": 48433427, "comment_id": 83858316, "body": "Well, to start with, you&#39;re not storing anything in the subjects array. You allocate 100 characters for each subject string, but you never assign a subject to it."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516837861, "post_id": 48433427, "comment_id": 83858419, "body": "In addition, I don&#39;t see any code about searching."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 1, "creation_date": 1516838995, "post_id": 48433427, "comment_id": 83858787, "body": "Points for having taken the <a href=\"https://stackoverflow.com/tour\">tour</a>, have your read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> yet? You basically need to actually ask a specific question and supply a relevant MCVE."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516840249, "post_id": 48433427, "comment_id": 83859175, "body": "Flagging as off-topic for lack of specifics."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516847335, "post_id": 48433427, "comment_id": 83860886, "body": "@MarkBenningfield, ...you did? As of a few moments ago, I was the only close vote (since we have a bunch of code that <i>isn&#39;t</i> actually focused on/related to/necessary for being the shortest possible thing that can demonstrate a specific problem or error, as required by the MCVE definition)."}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 9226973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d158f1042e2c264f6ce9327dadbedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Snohdo", "link": "https://stackoverflow.com/users/9226973/snohdo"}, "is_accepted": false, "score": 0, "last_activity_date": 1516840458, "creation_date": 1516840458, "answer_id": 48433884, "question_id": 48433427, "link": "https://stackoverflow.com/questions/48433427/c-programming-grouping-multiple-strings-and-searching-for-it-using-an-unique-k/48433884#48433884", "title": "C programming : Grouping multiple strings and searching for it using an Unique key", "body": "<p>There were a number of issues I noticed and I'll address some of them, starting with the struct which I recommend defining like this:</p>\n\n<pre><code>struct studentpack {\n    int LogID;\n    char firstname[20];\n    char lastname[20];\n    int mark;\n    char *subjects[100];\n};\n</code></pre>\n\n<p>And under your main function, you can define the student entry for filling.</p>\n\n<pre><code>struct studentpack student;\n</code></pre>\n\n<p>which will be used over and over again in your code, as you did in your example, for filling from the user input.</p>\n\n<p>In the switch you really don't need any parenthesis around the case numbers.</p>\n\n<p>In addition to the printf statement in each case, try something like this:</p>\n\n<pre><code>case 1:\n    printf(\"%s\\n\", \"Mathematics\");\n    sprintf(student.subjects + i, \"%s\", \"Mathematics\");\n    break;\n</code></pre>\n\n<p>which will fill the subjects area that you memory allocated just prior.</p>\n\n<p>Finally, for grouping together the ID's I would suggest starting with something like this:</p>\n\n<pre><code>#define MAXGROUP 1000\n\nstruct studentpack *group = calloc(MAXGROUP, sizeof(struct studentpack));\n\nint studentno = 0;\n</code></pre>\n\n<p>And then after you print your subjects to the file (test that it is working first due to the sprintf change) you would assign to the group like this:</p>\n\n<pre><code>if (studentno &lt; MAXGROUP) {\n    memcpy(group+studentno, &amp;student, sizeof(struct studentpack));\n    studentno++;\n}\n</code></pre>\n\n<p>The above will store away the student. Next you will probably want to iterate through the group variable, accessing group[0].LogID, group[1].LogID, etc. (all the way up to a maximum of 1000) just to confirm that all your data is there in memory.</p>\n\n<p>For example you could write a function that steps through looking for a particular LogID and then calls a show or display function containing printf statements to see all the values on screen.</p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1516842637, "last_edit_date": 1516842637, "creation_date": 1516840996, "answer_id": 48433942, "question_id": 48433427, "link": "https://stackoverflow.com/questions/48433427/c-programming-grouping-multiple-strings-and-searching-for-it-using-an-unique-k/48433942#48433942", "title": "C programming : Grouping multiple strings and searching for it using an Unique key", "body": "<p>you need an array of students</p>\n\n<pre><code>struct student{\n    int LogID;\n    char firstname[20];\n    char lastname[20];\n    int mark;\n    char *subjects[100];\n};\n\n\n\nstruct student students[100];\n</code></pre>\n\n<p>you now have space for 100 students. They are students[0], students[1],...students[99]</p>\n\n<p>Now you can do</p>\n\n<pre><code>int studno = 0;\nWhile(something)\n{\n  printf(\"\\Enter Student Details:\\n\\nStudent ID: \");\n        scanf(\"%d\",&amp;(students[studno].LogID));\n\n....\n  studno++;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9250154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3531052a72123425fac5d92ea1e0aed6?s=128&d=identicon&r=PG&f=1", "display_name": "lessaint", "link": "https://stackoverflow.com/users/9250154/lessaint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1516847035, "creation_date": 1516836912, "last_edit_date": 1516847035, "question_id": 48433427, "link": "https://stackoverflow.com/questions/48433427/c-programming-grouping-multiple-strings-and-searching-for-it-using-an-unique-k", "title": "C programming : Grouping multiple strings and searching for it using an Unique key", "body": "<p>Let's say for example you are entering the personal information of a student and you create a unique ID number for each student. What I'm having problems with is grouping those strings, and storing them together, so that it can be accessed through the ID. </p>\n\n<p>I tried using memory allocation, however, it did not work out.</p>\n\n<p>I'm quite new to C, so I'm not exactly sure on what to do.\nHere is what I used :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct {\n  int LogID;\n  char firstname[20];\n  char lastname[20];\n  int mark;\n  char *subjects[100];\n} student;\n\nint reg(void);\n\nint main(void) {\n  reg();\n  return 0;\n}\n\n//Registration function\nint reg(void) {\n  int choice,shift,found,compare, nosub, y, sub, subcount;\n  char studentname[20];\n  FILE *fp;\n  FILE *fp2;\n\n  printf(\"Enter Student Details:\\n\\nStudent ID: \");\n  scanf(\"%d\",&amp;student.LogID);\n  printf(\"Name: \");\n  scanf(\"%s\",student.firstname);\n  printf(\"Surname: \");\n  scanf(\"%s\",student.lastname);\n  printf(\"How many subjects does the student take? \");\n  scanf(\"%d\", &amp;nosub);\n\n  //Opens a text file and prints the student's ID and firstname\n  fp2=fopen(\"subjects.txt\",\"a+\");\n  fprintf(fp2, \"\\n\\n%d\\t%s\", student.LogID, student.firstname);\n\n  int i = 1;\n  size_t malloc_size = 100; //Allocating memory size to store subjects student is taking\n  for(i = 0; i &lt; nosub; i++) {\n    student.subjects[i] = malloc(malloc_size * sizeof(char));\n    printf(\"Please enter the subject :\\n(1)Mathematics\\n(2)English\\n(3) Social Studies\\n(4)Science\\n\");\n    scanf(\"%d\", &amp;sub);\n\n    switch (sub) {\n    case (1) :\n      printf(\"Mathematics\\n\");\n      break;\n    case (2) :\n      printf(\"English\\n\");\n      break;\n    case (3) :\n      printf(\"Social Studies\\n\");\n      break;\n    case (4) :\n      printf(\"Science\\n\");\n      break;\n    }\n  }\n  for(i = 0; i &lt; nosub; i++) { //Prints subjects to file, but it doesn't work...\n    fprintf(fp2,\"%s\\n\", student.subjects[i]);\n  }\n  fclose(fp2);\n  free(student.subjects[i]);\n  student.subjects[i] = NULL;\n\n  fp=fopen(\"studentfile.txt\",\"a+\");\n//Prints certain student Information into another file...\n\n\n  fprintf(fp,\"\\n%d\\t%s\\t%s\\t\",student.LogID,student.firstname,\n          student.lastname);\n  fclose(fp);\n  printf(\"Registration has been successful\\n\");\n\n  getchar();\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "makefile"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1516836213, "post_id": 48433201, "comment_id": 83857974, "body": "Very likely, the library in question is incompatible because its contents are built for a different architecture than the program you&#39;re building is.  For example, they may be built for 32-bit x86, while you are building a 64-bit x86_64 binary.  Anyway, I cannot imagine why you would install random libraries you find on the Internet.  At minimum, obtain a source distribution and build a copy appropriate for your system.  Ideally, use your distro&#39;s package management system (yum / apt / etc.) to install an appropriate version of the library from a trusted source."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1516837460, "post_id": 48433201, "comment_id": 83858318, "body": "Seems to be that you are trying to link a 32bit lib into a 64bit compiled program or the other way around."}], "owner": {"reputation": 1, "user_id": 9264687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1800c2e1ac9292dcc5d0e24352437a8b?s=128&d=identicon&r=PG&f=1", "display_name": "user9264687", "link": "https://stackoverflow.com/users/9264687/user9264687"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 773, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516835332, "creation_date": 1516835332, "question_id": 48433201, "link": "https://stackoverflow.com/questions/48433201/skipping-incompatible-when-searching-for-lgpstk", "title": "skipping incompatible when searching for -lgpstk", "body": "<p>I am trying \"make\" command on my linux to create an exe file, but I keep getting an error </p>\n\n<blockquote>\n  <p>/usr/bin/ld: skipping incompatible ../../../shared/gpstk/src/libgpstk.a when searching for -lgpstk\n  /usr/bin/ld: cannot find -lgpstk\n  collect2: error: ld returned 1 exit status\n  ../../../shared/makehome/common.makefile:79: recipe for target '../../../shared/binflate/src/binflate' failed</p>\n</blockquote>\n\n<p>I have tried to download libraries through search online but I can't seem to get past this error. Can someone please help me out. </p>\n\n<p>Here is the makefile code:</p>\n\n<pre><code>TARGET        = linux\n\n#----------------------------------------------------------------- Directories\n# Where make will put outputs and intermediate files\nSVNROOTDIR    = ../../..\nOBJDIR        = $(SVNROOTDIR)/obj\nBINDIR        = $(SVNROOTDIR)/shared/binflate/src\nLIBDIR        = $(BINDIR)\n\n#--------------------------------------------------------------------- Outputs\n# What we are trying to build:\n# Note: If you want this makefile to build an EXECUTABLE, leave LIBRARY \n#       undefined, and vice versa if you want to build a static LIBRARY\nEXECUTABLE    = $(BINDIR)/binflate\nLIBRARY       = \n\n#--------------------------------------------------------------------- Sources\nSOURCES       = $(SVNROOTDIR)/shared/core/src/basetime.cpp \\\n        $(SVNROOTDIR)/shared/core/src/parameters.cpp \\\n        $(SVNROOTDIR)/shared/core/src/report.cpp \\\n        $(SVNROOTDIR)/shared/core/src/datalog.cpp \\\n        $(SVNROOTDIR)/shared/core/src/util.cpp \\\n        $(SVNROOTDIR)/shared/core/src/serialutil.cpp \\\n        $(SVNROOTDIR)/shared/core/src/signaltype.cpp \\\n        $(SVNROOTDIR)/shared/core/src/channeltype.cpp \\\n        $(SVNROOTDIR)/shared/core/src/gridframework.cpp \\\n        $(SVNROOTDIR)/shared/core/src/binhelper.cpp \\\n        $(SVNROOTDIR)/shared/core/src/observables.cpp \\\n        $(SVNROOTDIR)/shared/core/src/txid.cpp \\\n        $(SVNROOTDIR)/shared/core/src/ReportWrapper.cpp \\\n        $(SVNROOTDIR)/shared/binflate/src/binflate.cpp \n\n# include directories in gcc format\nINCL          = -I../include \\\n        -I$(SVNROOTDIR)/shared/core/include  \\\n        -I$(SVNROOTDIR)/shared/gpstk/include \n\n# Libraries\nLIBS          = -lm -lgpstk\n\n# Library include directories in gcc format (-Lpath/to/dir1 -Lpath/to/dir2)\nINCLLIB       = -L$(SVNROOTDIR)/shared/gpstk/src \\\n        -L/usr/local/lib\n\n# Predefine macros\nPREDEFINES    = \n\n#------------------------------------ Compilers, linkers, etc. and their flags\nCC            = g++\nCCFLAGS       = -g -Wall -Wno-unknown-pragmas \\\n        -Wno-uninitialized $(PREDEFINES)\n\nCCINCL        = $(INCL) \n\nLIBEXE        = ar\nLIBFLAGS      = rcs\nLIBINCL       =\n\nLNKEXE        = g++\nLNKFLAGS      =\nLNKINCL       = \n\nMD            = g++\nMDFLAGS       = -MM\nMDINCL        = $(INCL)\n\n\n#---------------------------------------------------------- Included Makefiles\ninclude $(SVNROOTDIR)/shared/makehome/common.makefile\n</code></pre>\n"}, {"tags": ["c", "sockets", "winsock2", "recv"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1516833652, "post_id": 48432879, "comment_id": 83857039, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc in C</a>"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1516833761, "post_id": 48432879, "comment_id": 83857082, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740668.aspx\" rel=\"nofollow noreferrer\">WSAECONNRESET: Connection reset by peer.</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1516833822, "post_id": 48432879, "comment_id": 83857125, "body": "That error code suggests that the problem is on the sending side, not the receiver."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1516833882, "post_id": 48432879, "comment_id": 83857144, "body": "You said that the first byte is the size of the string. But you&#39;re reading <code>int</code>, not a single byte. Also, your code assumes that <code>sizeof(int)</code> is the same on the sender and receiver."}, {"owner": {"reputation": 1, "user_id": 8353459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2699c5d64927ad02a0aaa45ed60547?s=128&d=identicon&r=PG&f=1", "display_name": "AmitRe", "link": "https://stackoverflow.com/users/8353459/amitre"}, "edited": false, "score": 0, "creation_date": 1516834294, "post_id": 48432879, "comment_id": 83857316, "body": "Sorry, I was wrong. it simply sends the string in two parts, 4 bytes for its length and then the string itself. Also, the error code doesn&#39;t really tell my anything."}, {"owner": {"reputation": 1, "user_id": 8353459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2699c5d64927ad02a0aaa45ed60547?s=128&d=identicon&r=PG&f=1", "display_name": "AmitRe", "link": "https://stackoverflow.com/users/8353459/amitre"}, "edited": false, "score": 0, "creation_date": 1516834431, "post_id": 48432879, "comment_id": 83857374, "body": "In addition, forgot to mention, I only run the client-server locally, as in the same pc."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1516835599, "post_id": 48432879, "comment_id": 83857780, "body": "Perhaps you should post the code from the &quot;sender&quot;, where it is sending &quot;the 4 bytes for its length andd then the string itself&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516835766, "post_id": 48432879, "comment_id": 83857833, "body": "&quot;we are defined to use send/recv with one byte at a time, while the first byte indicated the size of the string (in bytes)&quot; Either do that, or <a href=\"https://stackoverflow.com/posts/48432879/edit\">edit</a> your post and remove this passage."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1516836351, "post_id": 48432879, "comment_id": 83858024, "body": "@AmitRe Yes it does, WSAECONNRESET means the other side closed the connection."}, {"owner": {"reputation": 1, "user_id": 8353459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2699c5d64927ad02a0aaa45ed60547?s=128&d=identicon&r=PG&f=1", "display_name": "AmitRe", "link": "https://stackoverflow.com/users/8353459/amitre"}, "edited": false, "score": 0, "creation_date": 1516836665, "post_id": 48432879, "comment_id": 83858105, "body": "Thanks for the help! I edited my post, due to your comments. the main clue I think is that this code works on other pc."}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 0, "creation_date": 1516837071, "post_id": 48432879, "comment_id": 83858220, "body": "Your &quot;SendBuffer&quot; function does not send the &quot;4 byte&quot; length of the string, as you state in your description.  If it&#39;s sent elsewhere, prior to calling &quot;SendBuffer&quot;, then please post that code.  Otherwise, correct your description."}, {"owner": {"reputation": 1, "user_id": 8353459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2699c5d64927ad02a0aaa45ed60547?s=128&d=identicon&r=PG&f=1", "display_name": "AmitRe", "link": "https://stackoverflow.com/users/8353459/amitre"}, "edited": false, "score": 0, "creation_date": 1516837378, "post_id": 48432879, "comment_id": 83858298, "body": "SendString recieves a string and calls SendBuffer. The first call is of an int variable, which is 4 bytes long, and the second call is for the string itself."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1516837606, "post_id": 48432879, "comment_id": 83858356, "body": "why are you casting your variables?"}, {"owner": {"reputation": 897, "user_id": 3830887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa739aedfb6760abc3605091e12810e?s=128&d=identicon&r=PG&f=1", "display_name": "TonyB", "link": "https://stackoverflow.com/users/3830887/tonyb"}, "edited": false, "score": 1, "creation_date": 1516842100, "post_id": 48432879, "comment_id": 83859645, "body": "Perhaps you should run WireShark (or other network sniffer)  and see what is being sent &quot;over the wire&quot;...  Additionally, I googled &quot;windows 10054 error&quot; and found a couple of Windows Support postings talking about a hotfix for a problem related to a facility used by some anti-virus products... which could explain why your friend&#39;s PC doesn&#39;t have the problem... i.e. the two PC&#39;s use different anti-virus products and/or have different levels up updates applied.  <a href=\"https://support.microsoft.com/en-us/help/981344/an-application-may-receive-the-10054-error-when-the-application-receiv\" rel=\"nofollow noreferrer\">EXAMPLE</a>"}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516843199, "post_id": 48432879, "comment_id": 83859924, "body": "ECONNRESET, when not intentionally induced, is frequently a symptom of the other side unexpectedly crashing. Either that or a firewall."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1516848546, "post_id": 48432879, "comment_id": 83861167, "body": "I don&#39;t really see anything in the code that would cause the error, so it has to be external. But, on a side note, consider using <code>stdint.h</code> so you can use fixed-sized types like <code>int32_t</code>, as <code>int</code> is not guaranteed to be 4 bytes on all compilers or platforms.  Also, multi-byte integers should be sent in network byte order (big endian). Windows is little endian. <code>SendString()</code> should use <code>htonl()</code> to convert <code>TotalStringSizeInBytes</code> to network byte order before sending it, and <code>ReceiveString()</code> should use <code>ntohl()</code> to convert <code>TotalStringSizeInBytes</code> to host byte order after reading it."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1516849007, "post_id": 48432879, "comment_id": 83861276, "body": "Also, since you are sending the string length, sending a null terminator is redundant. I suggest dropping that, and have <code>ReceiveString()</code> allocate <code>StrBuffer</code> as <code>TotalStringSizeInBytes + 1</code> for a null terminator. Also, the check for <code>*OutputStrPtr != NULL</code> is unnecessary since <code>OutputStrPtr</code> is an output parameter. If <code>OutputStrPtr</code> is not NULL, initialize <code>*OutputStrPtr</code> to NULL before reading the string (or not, it is your choice what to output on error). If the caller passes in a pre-existing buffer on input, it has a logic error in its code, which would represent itself as a memory leak."}], "owner": {"reputation": 1, "user_id": 8353459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2699c5d64927ad02a0aaa45ed60547?s=128&d=identicon&r=PG&f=1", "display_name": "AmitRe", "link": "https://stackoverflow.com/users/8353459/amitre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516847803, "creation_date": 1516833524, "last_edit_date": 1516847803, "question_id": 48432879, "link": "https://stackoverflow.com/questions/48432879/sockets-in-c-recv-fails-after-one-byte", "title": "Sockets in C: recv fails after one byte", "body": "<p>I'm currently doing an assignment in which we are defined to use <code>send()</code>/<code>recv()</code> with two parts:</p>\n\n<blockquote>\n  <p>first send an int that indicates the length of the string (4 bytes) and then send the string itself.</p>\n</blockquote>\n\n<p>When I try to run the client/server on my PC, only the first <code>recv()</code> returns success, while the next one fails.</p>\n\n<p>When I run the <strong>same</strong> code on my partner's PC, it works well.</p>\n\n<p>The error I'm receiving for <code>recv()</code> is 10054.</p>\n\n<p>I am totally clueless, and have no idea how to approach this.</p>\n\n<p>The receiving code is:</p>\n\n<pre><code>TransferResult_t ReceiveString(char** OutputStrPtr, SOCKET sd){\n\n    /* Recv the the request to the server on socket sd */\n    int TotalStringSizeInBytes;\n    TransferResult_t RecvRes;\n    char* StrBuffer = NULL;\n\n    if ((OutputStrPtr == NULL) || (*OutputStrPtr != NULL))\n    {\n        printf(\"The first input to ReceiveString() must be \"\n            \"a pointer to a char pointer that is initialized to NULL. For example:\\n\"\n            \"\\tchar* Buffer = NULL;\\n\"\n            \"\\tReceiveString( &amp;Buffer, ___ )\\n\");\n        return TRNS_FAILED;\n    }\n\n    /* The request is received in two parts. First the Length of the string (stored in\n    an int variable ), then the string itself. */\n\n    RecvRes = ReceiveBuffer(\n        (char *)(&amp;TotalStringSizeInBytes),\n        (int)(sizeof(TotalStringSizeInBytes)), // 4 bytes\n        sd);\n\n    if (RecvRes != TRNS_SUCCEEDED) return RecvRes;\n\n    StrBuffer = (char*)malloc(TotalStringSizeInBytes * sizeof(char));\n\n    if (StrBuffer == NULL)\n        return TRNS_FAILED;\n\n    RecvRes = ReceiveBuffer(\n        (char *)(StrBuffer),\n        (int)(TotalStringSizeInBytes),\n        sd);\n\n    if (RecvRes == TRNS_SUCCEEDED)\n    {\n        *OutputStrPtr = StrBuffer;\n    }\n    else\n    {\n        free(StrBuffer);\n    }\n\n    return RecvRes;\n}\n</code></pre>\n\n<p>The <code>ReceiveBuffer</code> function is:</p>\n\n<pre><code>TransferResult_t ReceiveBuffer(char* OutputBuffer, int BytesToReceive, SOCKET sd){\n\n    char* CurPlacePtr = OutputBuffer;\n    int BytesJustTransferred;\n    int RemainingBytesToReceive = BytesToReceive;\n\n    while (RemainingBytesToReceive &gt; 0)\n    {\n        /* send does not guarantee that the entire message is sent */\n        BytesJustTransferred = recv(sd, CurPlacePtr, RemainingBytesToReceive, 0);\n        if (BytesJustTransferred == SOCKET_ERROR)\n        {\n            printf(\"recv() failed, error %d\\n\", WSAGetLastError());\n            return TRNS_FAILED;\n        }\n        else if (BytesJustTransferred == 0)\n            return TRNS_DISCONNECTED; // recv() returns zero if connection was gracefully disconnected.\n\n        RemainingBytesToReceive -= BytesJustTransferred;\n        CurPlacePtr += BytesJustTransferred; // &lt;ISP&gt; pointer arithmetic\n    }\n\n    return TRNS_SUCCEEDED;\n}\n</code></pre>\n\n<p>ADDED: the sending function:</p>\n\n<pre><code>TransferResult_t SendString( const char *Str, SOCKET sd ){\n    /* Send the the request to the server on socket sd */\n    int TotalStringSizeInBytes;\n    TransferResult_t SendRes;\n\n    /* The request is sent in two parts. First the Length of the string (stored in \n    an int variable ), then the string itself. */\n\n    TotalStringSizeInBytes = (int)( strlen(Str) + 1 ); // terminating zero also sent    \n\n    SendRes = SendBuffer( \n        (const char *)( &amp;TotalStringSizeInBytes ),\n        (int)( sizeof(TotalStringSizeInBytes) ), // sizeof(int) \n        sd );\n\n    if ( SendRes != TRNS_SUCCEEDED ) return SendRes ;\n\n    SendRes = SendBuffer( \n        (const char *)( Str ),\n        (int)( TotalStringSizeInBytes ), \n        sd );\n\n    return SendRes;\n}\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>TransferResult_t SendBuffer( const char* Buffer, int BytesToSend, SOCKET sd ){\n    const char* CurPlacePtr = Buffer;\n    int BytesTransferred;\n    int RemainingBytesToSend = BytesToSend;\n\n    while ( RemainingBytesToSend &gt; 0 )  \n    {\n        /* send does not guarantee that the entire message is sent */\n        BytesTransferred = send (sd, CurPlacePtr, RemainingBytesToSend, 0);\n        if ( BytesTransferred == SOCKET_ERROR ) \n        {\n            printf(\"send() failed, error %d\\n\", WSAGetLastError() );\n            return TRNS_FAILED;\n        }\n\n        RemainingBytesToSend -= BytesTransferred;\n        CurPlacePtr += BytesTransferred; // &lt;ISP&gt; pointer arithmetic\n    }\n\n    return TRNS_SUCCEEDED;\n}\n</code></pre>\n"}, {"tags": ["c", "file", "scanf", "fgets"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516833801, "post_id": 48432876, "comment_id": 83857107, "body": "You can use <code>strchr</code> to locate the position of the colon in the line. Or you can use <code>strtok</code> to parse the line"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516834157, "post_id": 48432876, "comment_id": 83857256, "body": "<i>&quot;we can&#39;t statically allocate C strings&quot;</i>. The simple way is to define a local array big enough to hold the longest input you expect. Use <code>fgets</code> and restrict the input length, as it requires."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516834305, "post_id": 48432876, "comment_id": 83857319, "body": "<i>&quot;I need the data presented after the colon.&quot;</i> Is there any guarantee that the data is presented in the same sequence?"}, {"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "edited": false, "score": 0, "creation_date": 1516834462, "post_id": 48432876, "comment_id": 83857382, "body": "If not you will need to use <code>strstr()</code> to find a decisive substring inside your line or a custom regexp matcher and then use <code>atoi()</code> for numbers or <code>strcmp()</code> for &quot;Yes&quot; and &quot;No&quot; statements according to what you think it is."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516839700, "post_id": 48432876, "comment_id": 83859007, "body": "Take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  You obviously haven&#39;t worked this problem hard enough to have sufficient code to have run into a real problem yet.  I&#39;d be willing to bet you can find other SO users who have worked exactly the same assignment.  Some of them probably got answers.  Lookup <code>malloc()</code> and <code>free()</code> or simply create an array on the stack for your string buffer.  Yes, <code>sscanf()</code> is a good choice for finding prefixes in strings and converting  tokens to whatever type you need.  With any luck, nobody here will post a solution to your homework assignment."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1516856560, "post_id": 48432876, "comment_id": 83863261, "body": "Or simply use <i>character oriented input</i> like <code>fgetc</code> and check for <code>&#39;:&#39;</code> and then <code>&#39;\\n&#39;</code> (the stuff in between, minus any leading or trailing whitespace, is what you want)"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "edited": false, "score": 1, "creation_date": 1516889956, "post_id": 48432876, "comment_id": 83881615, "body": "@ft_error <a href=\"https://stackoverflow.com/q/17710018/995714\"><code>atoi</code> is harmful and shouldn&#39;t be used</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1516888539, "creation_date": 1516888539, "answer_id": 48444595, "question_id": 48432876, "link": "https://stackoverflow.com/questions/48432876/reading-a-textfile-line-by-line-in-c/48444595#48444595", "title": "Reading a textfile line by line in C", "body": "<p>After opening the file with <code>fopen()</code>, you could do</p>\n\n<pre><code>float cash;\nint turnlimit, plyrno, mult, house;\nfscanf(fin, \"%*[^:]: %f\", &amp;cash);\nfscanf(fin, \"%*[^:]: %d\", &amp;turnlimit);\nfscanf(fin, \"%*[^:]: %d\", &amp;plyrno);\n</code></pre>\n\n<p>where <code>fin</code> is the <code>FILE</code> pointer.</p>\n\n<p><code>%[^:]</code> would scan till, but not including, a <code>:</code> is encountered and the <code>*</code> is for assignment suppression; meaning the value for it would be read but not assigned anywhere.</p>\n\n<p>After reading till the point before the <code>:</code>, the <code>:</code> itself followed by a space must be read. So a <code>:</code> must be there in the format string followed by a space.</p>\n\n<p>See <a href=\"https://stackoverflow.com/q/766516/5375464\">What is the purpose of using the [^ notation in scanf?</a> .</p>\n"}], "owner": {"reputation": 187, "user_id": 8391046, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5396a3d60d7467ac89caad0fba8efd38?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael", "link": "https://stackoverflow.com/users/8391046/ismael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516888539, "creation_date": 1516833516, "last_edit_date": 1516849003, "question_id": 48432876, "link": "https://stackoverflow.com/questions/48432876/reading-a-textfile-line-by-line-in-c", "title": "Reading a textfile line by line in C", "body": "<p>I need to be able to get data from a text file, which is presented in the following format:</p>\n\n<blockquote>\n  <p>Starting Cash: 1500<br>\n  Turn Limit (-1 for no turn limit): 10<br>\n  Number of Players Left To End Game: 1<br>\n  Property Set Multiplier: 2<br>\n  Number of Houses Before Hotels: 4<br>\n  Must Build Houses Evenly: Yes<br>\n  Put Money In Free Parking: No<br>\n  Auction Properties: No<br>\n  Salary Multiplier For Landing On Go: 1</p>\n</blockquote>\n\n<p>To clarify, I need the data presented after the colon. I'm not really sure how to approach this. I was reading other questions and they all said to use <code>fgets</code>, but I don't know how long each line will be and we can't statically allocate C strings, so where would I store the line pointed to by <code>fgets</code>? Also, is it possible to do this using <code>fscanf</code> (we have learned how to do <code>fscanf</code> but not learned <code>fgets</code>)? My idea when approaching this was to get each line, and then scan each line with sscanf (I think that would work) using the string literals that I don't need:</p>\n\n<pre><code>sscanf(str, \"Starting Cash: %d\", &amp;startingCash);\n</code></pre>\n\n<p>Would this work?</p>\n"}, {"tags": ["c", "arrays", "function", "printf", "scanf"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1516831935, "post_id": 48432520, "comment_id": 83856226, "body": "read() doesn&#39;t set the value of n in main--it sets a local copy. You need to make read take a pointer and pass in &amp;n."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1516831975, "post_id": 48432520, "comment_id": 83856243, "body": "<code>read(n,v);</code> and <code>print(n,v);</code> are using the <i>uninitiaised variable</i> <code>n</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516831989, "post_id": 48432520, "comment_id": 83856249, "body": "You may want to print some whitespace between your numbers. <code>%d</code> doesn&#39;t print any."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1516831992, "post_id": 48432520, "comment_id": 83856252, "body": "What @LeeDanielCrocker said. Or just have <code>read()</code> return the count instead of using a pointer parameter."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516832284, "post_id": 48432520, "comment_id": 83856381, "body": "The array <code>int v[100];</code> printed in <code>void print</code> is also unintialised. Please understand that local variables defined in a function have indeteminate value."}], "answers": [{"comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 3, "creation_date": 1516832327, "post_id": 48432620, "comment_id": 83856408, "body": "Global variable are usually not the answer. Here, they are not the answer."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1516832355, "post_id": 48432620, "comment_id": 83856430, "body": "Very bad solution, a cop-out. Please learn how to handle local variables."}], "tags": [], "owner": {"reputation": 73, "user_id": 7427294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbc4c380bfab552d2409355b7e9a706?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew T", "link": "https://stackoverflow.com/users/7427294/andrew-t"}, "is_accepted": false, "score": -2, "last_activity_date": 1516832716, "last_edit_date": 1516832716, "creation_date": 1516832258, "answer_id": 48432620, "question_id": 48432520, "link": "https://stackoverflow.com/questions/48432520/how-can-i-make-scanf-and-printf-functions-of-an-array-in-c/48432620#48432620", "title": "How can I make scanf and printf functions of an array in C?", "body": "<p>Ok, i solved it by declaring the variable n and v[100] globally.\nThanks. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I also tried to use the pointer and it looks something like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nvoid read(int a[], int* n)\n{\n    scanf(\"%d\",n);\n    for(int i=0;i&lt;*n;i++)\n    {\n        scanf(\"%d\",&amp;a[i]);\n    }\n}\nvoid print(int a[], int n)\n{\n    for(int i=0;i&lt;n;i++)\n        printf(\"%d \",a[i]);\n\n}\nvoid main()\n{\n    int a[20],n;\n    read(a,&amp;n);\n    print(a,n);\n}\n</code></pre>\n\n<p>And it works.</p>\n"}, {"comments": [{"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1516833098, "post_id": 48432679, "comment_id": 83856797, "body": "@FredLarson Wow thanks, i never realized that i was wrong. I am sure that i have it seen it written like that somewhere, too many wrong info on internet nowadays..."}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1516833139, "post_id": 48432679, "comment_id": 83856818, "body": "Maybe you were using the same lousy book quoted in the question."}, {"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1516833216, "post_id": 48432679, "comment_id": 83856849, "body": "@FredLarson No, i actually never opened a &quot;book&quot;, only online resources. I suspect wrong info just survives for a long time."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1516838111, "post_id": 48432679, "comment_id": 83858494, "body": "Learning C from online resources is probably not a good idea. Note that C functions are call by value, so I suspect that a function prototype like <code>void read(int n, int v[100]);</code> confuses many into thinking that the value of the array is passed in the function call. Yet: 1) array types in function prototypes are adjusted to appropriate pointers, making the actual prototype <code>void read(int n, int *v);</code>, and 2) arrays decay to pointers to their first elements in most expressions, so <code>read(n, v);</code> passes a pointer to the first element of <code>v</code> by value (a copy) to <code>read()</code>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516841183, "post_id": 48432679, "comment_id": 83859430, "body": "In all expressions except <code>sizeof</code>, <code>_Alignof</code> and when used with the unary <code>&amp;</code> operator. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">6.3.2.1 Lvalues, arrays, and function designators (p3)</a>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516842323, "post_id": 48432679, "comment_id": 83859704, "body": "@DavidC.Rankin -- tag-team instruction! Who says that learning C can&#39;t be exciting?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1516845309, "post_id": 48432679, "comment_id": 83860450, "body": "@DavidBowling Amen to that. If I can learn half of what there is to learn in C, it will be an unmitigated success. The more I learn, the more I learn I have to learn..."}], "tags": [], "owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "is_accepted": false, "score": 0, "last_activity_date": 1516833583, "last_edit_date": 1516833583, "creation_date": 1516832554, "answer_id": 48432679, "question_id": 48432520, "link": "https://stackoverflow.com/questions/48432520/how-can-i-make-scanf-and-printf-functions-of-an-array-in-c/48432679#48432679", "title": "How can I make scanf and printf functions of an array in C?", "body": "<p>This is what it should look like:</p>\n\n<pre><code>void read(int *array, int size)\n{\n    printf(\"Now enter %d values:\\n\", size);\n    for(int i = 0; i &lt; size; i++)\n    {\n        scanf(\"%d\", array + i);\n        /* array + i = &amp;(array[i]) */\n    }\n}\n\nvoid print(int *array, int size)\n{\n    printf(\"Here is your array:\\n\");\n    for(int i = 0; i &lt; size; i++)\n    {\n        printf(\"%d%c\", array[i], i == size - 1 ? '\\n' : ' ');\n        /* ternary puts spaces and \\n at the end */\n    }\n}\n\nint main()\n{\n    int size;\n    printf(\"Enter array size :\\n\");\n    scanf(\"%d\", &amp;size);\n    int array[size];  /* Keep one array */\n    read(array, size);\n    print(array, size);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516837670, "last_edit_date": 1516837670, "creation_date": 1516832574, "answer_id": 48432690, "question_id": 48432520, "link": "https://stackoverflow.com/questions/48432520/how-can-i-make-scanf-and-printf-functions-of-an-array-in-c/48432690#48432690", "title": "How can I make scanf and printf functions of an array in C?", "body": "<p>You don't initialize <code>n</code> in <code>main</code>. The <code>n</code> in <code>main</code> and the <code>n</code> in <code>read</code> are different variables, so changing <code>n</code> in <code>read</code> doesn't affect the <code>n</code> in <code>main</code>, which remains uninitialized and hence you have an undefined behaviour in <code>print</code>.</p>\n\n<p>You have to either pass <code>n</code> as a pointer or <code>read</code> must return <code>n</code>:</p>\n\n<pre><code>void read(int &amp;n, int v[100])\n{\n    scanf(\"%d\",n);\n    for(int i=0;i&lt;*n;i++)\n    {\n        scanf(\"%d\",&amp;v[i]);\n    }\n}\n\nint main()\n{\n    int v[100];\n    int n;\n    read(&amp;n,v);\n    print(n,v);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int read(int v[100])\n{\n    int n;\n    scanf(\"%d\",&amp;n);\n    for(int i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",&amp;v[i]);\n    }\n    return n;\n}\n\nint main()\n{\n    int v[100];\n    int n = read(v);\n    print(n,v);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 449, "user_id": 9897919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4315a79d0d04da3596dfa08d8d9d8f24?s=128&d=identicon&r=PG&f=1", "display_name": "Aniket", "link": "https://stackoverflow.com/users/9897919/aniket"}, "is_accepted": false, "score": 3, "last_activity_date": 1528207755, "creation_date": 1528207755, "answer_id": 50702228, "question_id": 48432520, "link": "https://stackoverflow.com/questions/48432520/how-can-i-make-scanf-and-printf-functions-of-an-array-in-c/50702228#50702228", "title": "How can I make scanf and printf functions of an array in C?", "body": "<p>Here is a program that does what you want it do to.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n// Function Prototypes Start\nvoid array_reader(int array_length, int array[]);\nvoid array_printer(int array_length, int array[]);\n// Function Prototypes End\n\n\nint main(void) {\n\n    int max_amt_to_scan;\n    printf(\"How many numbers would you like to scan in?\\n\");\n    scanf(\"%d\", &amp;max_amt_to_scan);\n\n    int num_array[max_amt_to_scan];\n\n    printf(\"Please enter %d numbers!\\n\", max_amt_to_scan);\n    array_reader(max_amt_to_scan, num_array);\n\n    printf(\"The numbers you entered were:\\n\");\n    array_printer(max_amt_to_scan, num_array);\n\n    return 0;\n}\n\n\n// Scans or reads in numbers, into an array\nvoid array_reader(int array_length, int array[]) {\n\n    int i = 0;\n    while (i &lt; array_length) {\n\n        scanf(\"%d\", &amp;array[i]);\n        i++;\n    }\n}\n\n\n// Prints out an array of numbers\nvoid array_printer(int array_length, int array[]) {\n\n    int i = 0;\n    while (i &lt; array_length) {\n\n        if (i == (array_length - 1)) {\n            printf(\"%d\\n\", array[i]);\n        } else {\n            printf(\"%d, \", array[i]);\n        }\n            i++;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7427294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdbc4c380bfab552d2409355b7e9a706?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew T", "link": "https://stackoverflow.com/users/7427294/andrew-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1528207755, "creation_date": 1516831787, "question_id": 48432520, "link": "https://stackoverflow.com/questions/48432520/how-can-i-make-scanf-and-printf-functions-of-an-array-in-c", "title": "How can I make scanf and printf functions of an array in C?", "body": "<p>I am trying to make two separate functions, one for a reading of an array, and another one for prining it. \nMy code looks something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid read(int n, int v[100])\n{\n    scanf(\"%d\",&amp;n);\n    for(int i=0;i&lt;n;i++)\n    {\n        scanf(\"%d\",&amp;v[i]);\n    }\n}\n\nvoid print(int n, int v[100])\n{\n    for(int i=0;i&lt;n;i++)\n    {\n        printf(\"%d\",v[i]);\n    }\n}\n\nint main()\n{\n    int v[100];\n    int n;\n    read(n,v);\n    print(n,v);\n}\n</code></pre>\n\n<p>But if i read something like this</p>\n\n<pre><code>5\n1\n2\n3\n4\n5\n</code></pre>\n\n<p>it prints this:</p>\n\n<pre><code>12345167773430408951321408978481140419686004089785612740906704021677734340894\n</code></pre>\n\n<p>and other numbers. Any suggestions?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516831928, "post_id": 48432516, "comment_id": 83856223, "body": "I don&#39;t think you get undefined reference for not including a header, you would get such an error when linking. Can you post the exact error?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1516832334, "post_id": 48432516, "comment_id": 83856414, "body": "Do you know how header files work?"}, {"owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1516832577, "post_id": 48432516, "comment_id": 83856531, "body": "@immibis, a header file essentially pastes its contents into the file during precompilation. It is like concatenating the files."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516833470, "post_id": 48432516, "comment_id": 83856957, "body": "headers generally have function prototypes/signatures/declarations. This just tells the compiler &quot;there&#39;s a function called <code>printmatrix</code> and it takes these arguments and returns this type&quot;. The compiler complains about an implicit declaration when you try to call a function whose signature it has no knowledge of. The &quot;undefined reference&quot; is a linker error (linking happens after compilation). This is the linker saying it can&#39;t find the definition (the actual code) of <code>printmatrix</code>. This code is presumably in your <code>.so</code> file."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516833949, "post_id": 48432516, "comment_id": 83857177, "body": "You&#39;re thinking about it wrong.  The form of the code after preprocessing is not a significant concern.  Although each translation unit that <code>#include</code>s your header will after preprocessing contain the header&#39;s contents, who cares?  As long as your headers contain only declarations and maybe macro definitions, as they should, then nothing in them ends up in the compiled binary.  But they do affect how the compiler constructs the stuff that <i>does</i> go in the binary."}, {"owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "edited": false, "score": 0, "creation_date": 1516834420, "post_id": 48432516, "comment_id": 83857371, "body": "I see. I have reserved .c for executables and shoved most of the essentials of my code into .h files. I will change this library over to the convention."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516833358, "post_id": 48432748, "comment_id": 83856908, "body": "No, in general header files should contain only <i>declarations</i>.  Definitions are exactly what they should not include."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516833476, "post_id": 48432748, "comment_id": 83856961, "body": "Also, although you certainly <i>can</i> use <code>extern</code> to declare a function, and doing so is harmless, it is unnecessary because external linkage is the default.  The situation is a bit different for variables, however."}, {"owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "edited": false, "score": 0, "creation_date": 1516834099, "post_id": 48432748, "comment_id": 83857232, "body": "I see how adding the line with extern is essentially the same as including the header file which contains the function declarations, however I am still curious as where my computer gets the declaration for dsyev_ from. There was no header or declaration involved. It must have received everything it needed from the -llapack option. Why can my libraries not do this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9232447"}, "reply_to_user": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "edited": false, "score": 0, "creation_date": 1516834325, "post_id": 48432748, "comment_id": 83857328, "body": "@TonyRuth It seems that your compiler is guessing the prototype of the functions you are calling hence the warning <code>implicit declaration of function</code>. If the compiler doesn&#39;t guess correctly you will start seeing segfaults."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "edited": false, "score": 1, "creation_date": 1516834369, "post_id": 48432748, "comment_id": 83857348, "body": "@TonyRuth, your computer <i>does not</i> get a declaration for <code>dsyev_</code>.  It has to guess, based on your usage.  Most compilers will do this for you, because it was specified by the original ANSI standard and was supported by pre-standardization C, but since C99 it is non-standard to call a function that does not have an in-scope declaration.  And it is risky, too, because the compiler can guess wrong."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9232447"}, "is_accepted": true, "score": 3, "last_activity_date": 1516833883, "last_edit_date": 1516833883, "creation_date": 1516832877, "answer_id": 48432748, "question_id": 48432516, "link": "https://stackoverflow.com/questions/48432516/link-shared-object-library-without-including-it/48432748#48432748", "title": "Link shared object library without including it", "body": "<p>In general, headers should only contain declerations: types, structs, function prototypes, classes, templates, etc... not code (unless it's for error handling).</p>\n\n<p>Headers are useful because they allow you to set the same exact declarations for both the library (the .so) and the interface to the library (the executable elf that will use the shared object).</p>\n\n<p>In order for linkage to complete successfully, your application should know the calling convention of the function: it may be a c-style call (cdecl), pascal style (WINAPI), fast-call or others - each one has a different method for calling.</p>\n\n<p>If you really don't want to use the libraries headers you can also define functions manually, using the <code>extern</code> keyword. It would probably just be the same like re-writing the header file(s) all over again (not recommended).</p>\n\n<p>For example, If the shared library has a <code>add()</code> function:</p>\n\n<pre><code>    int add(int a, int b) {\n      return a + b;\n    }\n</code></pre>\n\n<p>And you want to use that function within your application without a header, you could do this:</p>\n\n<pre><code>    extern int add(int, int);\n\n    int main() {\n      int a = 10, b = 20;\n      int r = add(a, b);\n      printf(\"%d + %d = %d\\n\", a, b, r);\n      return 0;\n    }\n</code></pre>\n\n<blockquote>\n  <p>It appears I am incorporating the header file into the final code twice, once while compiling the shared object and again when compiling the executable.</p>\n</blockquote>\n\n<p>That's how things should be done. You should include the same header in both project. Most major libraries do that. See <a href=\"https://github.com/libevent/libevent\" rel=\"nofollow noreferrer\">libevent</a> for example.</p>\n"}], "owner": {"reputation": 1130, "user_id": 2043876, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/49492119d7a66e43e549f0ff04d55598?s=128&d=identicon&r=PG", "display_name": "Tony Ruth", "link": "https://stackoverflow.com/users/2043876/tony-ruth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 48432748, "answer_count": 1, "score": 0, "last_activity_date": 1516833883, "creation_date": 1516831766, "last_edit_date": 1516832440, "question_id": 48432516, "link": "https://stackoverflow.com/questions/48432516/link-shared-object-library-without-including-it", "title": "Link shared object library without including it", "body": "<p>I am developing a library. The library will be compiled into a shared object (.so). To use the library, <a href=\"https://www.cs.swarthmore.edu/~newhall/unixhelp/howto_C_libraries.html\" rel=\"nofollow noreferrer\">https://www.cs.swarthmore.edu/~newhall/unixhelp/howto_C_libraries.html</a> says I need to both #include the header (.h) file and link the shared library -lmylib. They say the header file should contain function prototypes for the functions to be used while the actual code for the functions would be in the (.c) file. </p>\n\n<p>I tried compiling my code without #including the header file, and I receive and undefined reference error from the compiler, but it compiles successfully when the header is included.</p>\n\n<p>If I leave off the header I get both implicit declaration warnings and undefined reference errors :</p>\n\n<pre><code>warning: implicit declaration of function \u2018printmatrix\u2019\nundefined reference to `printmatrix'\n</code></pre>\n\n<p>However, the lapack function that I am calling does not need a header. It receive an implicit declaration warning but no error:</p>\n\n<pre><code>warning: implicit declaration of function \u2018dsyev_\u2019\n</code></pre>\n\n<p>Why do I need to include the header file? It appears I am incorporating the header file into the final code twice, once while compiling the shared object and again when compiling the executable. I have used other libraries, e.g. lapack where I can link the library without any #include statement.</p>\n"}, {"tags": ["c", "operating-system", "fork"], "comments": [{"owner": {"reputation": 3469, "user_id": 2245623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16c07f84d76b0a29e16e1c35faca43d?s=128&d=identicon&r=PG", "display_name": "Jan Kundr&#225;t", "link": "https://stackoverflow.com/users/2245623/jan-kundr%c3%a1t"}, "edited": false, "score": 1, "creation_date": 1516839444, "post_id": 48432248, "comment_id": 83858930, "body": "see the manpage of the <code>fork()</code> syscall, then."}, {"owner": {"reputation": 2928, "user_id": 5927758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QmcMj.png?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/5927758/mitch"}, "edited": false, "score": 0, "creation_date": 1516845688, "post_id": 48432248, "comment_id": 83860555, "body": "Zombies are only generated on exiting children whos parents do not wait on them."}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1516831167, "creation_date": 1516831167, "answer_id": 48432361, "question_id": 48432248, "link": "https://stackoverflow.com/questions/48432248/how-many-zombie-and-orphan-processes-are-created-by-these-fork/48432361#48432361", "title": "How many zombie and orphan processes are created by these fork()", "body": "<p>There is only one <code>fork</code>, so there is only 1 child. The parent exits without <code>wait</code>ing for a child process. The child enter in an endless loop and shortly thereafter the parent is exists, so it becomes an orphaned process. So: 0 zombies, 1 orphaned.</p>\n\n<p>However if the <code>fork</code> fails, then there is no child process at all and the parent exists anyway.</p>\n"}], "owner": {"reputation": 9, "user_id": 9264479, "user_type": "registered", "profile_image": "https://graph.facebook.com/515597882114602/picture?type=large", "display_name": "Ba Lan Vi\u1ec7t Nam", "link": "https://stackoverflow.com/users/9264479/ba-lan-vi%e1%bb%87t-nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516831167, "creation_date": 1516830732, "question_id": 48432248, "link": "https://stackoverflow.com/questions/48432248/how-many-zombie-and-orphan-processes-are-created-by-these-fork", "title": "How many zombie and orphan processes are created by these fork()", "body": "<pre><code>if (fork() == 0) for(;;) sleep(1);\nelse exit(0);\n</code></pre>\n\n<p>I know what is zombie and orphan process but dont know how to anwser this question.  Please explain me how many zombie and orphan processes can be generated by executing this code . Thanks!</p>\n"}, {"tags": ["c", "casting", "macros", "parameter-passing", "c-preprocessor"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 7, "creation_date": 1516830646, "post_id": 48432180, "comment_id": 83855566, "body": "Have you considered the option of <i>using the proper types</i> ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516831718, "post_id": 48432180, "comment_id": 83856125, "body": "The compiler does not know what to do with <code>big = (DemoUnion) c;</code> so I suggest <code>big.c = c;</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1516832297, "post_id": 48432180, "comment_id": 83856394, "body": "&quot;C allows us to cast to union types pretty easily&quot; No C does not, gcc does."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516832368, "post_id": 48432568, "comment_id": 83856438, "body": "There&#39;s not much point to a variadic macro, since you must know how many actual arguments function <code>FOO()</code> takes anyway.  As for your non-variadic example, do be careful.  Consider what it would do to <code>FOO(c - &#39;0&#39;)</code>, for instance, in light of operator precedence."}, {"owner": {"reputation": 368, "user_id": 2904562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e6e82a71d9209170823146567abca2?s=128&d=identicon&r=PG&f=1", "display_name": "Michal Butterweck", "link": "https://stackoverflow.com/users/2904562/michal-butterweck"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516832842, "post_id": 48432568, "comment_id": 83856671, "body": "Thx, good point with macro variable brackets. Variadic version is only for the first of argument - but have the same problem pointed out. It is possible to make an EVAL() macro to do this for every argument, but this looks hacky."}], "tags": [], "owner": {"reputation": 368, "user_id": 2904562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e6e82a71d9209170823146567abca2?s=128&d=identicon&r=PG&f=1", "display_name": "Michal Butterweck", "link": "https://stackoverflow.com/users/2904562/michal-butterweck"}, "is_accepted": false, "score": 0, "last_activity_date": 1516832583, "last_edit_date": 1516832583, "creation_date": 1516831977, "answer_id": 48432568, "question_id": 48432180, "link": "https://stackoverflow.com/questions/48432180/how-would-we-write-a-c-macro-to-insert-casts-into-function-calls/48432568#48432568", "title": "How would we write a C macro to insert casts into function calls?", "body": "<p>It is not possible to have define name with \"(\". However, you may use function macro:</p>\n\n<pre><code>#define FOO(X) FOO((DemoUnion) (X))\n</code></pre>\n\n<p>or with variable number of arguments:</p>\n\n<pre><code>#define FOO(...) FOO((DemoUnion) __VA_ARGS__)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1516832855, "last_edit_date": 1516832855, "creation_date": 1516832073, "answer_id": 48432588, "question_id": 48432180, "link": "https://stackoverflow.com/questions/48432180/how-would-we-write-a-c-macro-to-insert-casts-into-function-calls/48432588#48432588", "title": "How would we write a C macro to insert casts into function calls?", "body": "<blockquote>\n  <p>How might we write a preprocessor macro to replace every instance of:</p>\n\n<pre><code>func(\n</code></pre>\n  \n  <p>with</p>\n\n<pre><code>func((DemoUnion)?\n</code></pre>\n</blockquote>\n\n<p>We wouldn't write such a macro, because C does not afford a way to do it.  Macro expansion replaces the macro identifier and, for function-like macros, its argument list, with the macro's replacement text.  The <code>(</code> character cannot be part of a macro identifier, and it is not, by itself, an argument list.  Thus, <code>func(</code> is not a unit that is subject to macro expansion.</p>\n\n<p>You could, however, do this:</p>\n\n<pre><code>#define func(x) func((DemoUnion)(x))\n</code></pre>\n\n<p>That will have about the effect you describe, but it is specific to argument-list length.  Also, you do not have to worry about recursive expansion; C specifies that it does not happen.</p>\n\n<blockquote>\n  <p>Also, maybe a macro to replace <code>func((DemoUnion)(DemoUnion)</code> with\n  <code>func((DemoUnion)</code></p>\n</blockquote>\n\n<p>Nope.  Macro replacement replaces <em>macros</em>, not general text patterns.  Anyway, anywhere that a <code>(DemoUnion)</code> cast is valid, <code>(DemoUnion)(DemoUnion)</code> is also valid and equivalent.</p>\n\n<p>But note well that you have a serious misconception:</p>\n\n<blockquote>\n  <p>Also, C allows us to cast to union types pretty easily: (so long as\n  the input to the cast is one of the types included in the union)</p>\n</blockquote>\n\n<p>On the contrary, <strong>C <em>does not</em> allow casting to or from union types</strong>.  At all.  Some compilers will accept such casts as an extension, but it is non-standard.  The closest the (C2011) standard permits would involve using a compound literal:</p>\n\n<pre><code>DemoUnion u = (DemoUnion) { .c = c };\n</code></pre>\n\n<p>Note well that although part of the syntax for a compound literal resembles a cast operator, there is no cast there.  But really, why do that, when you can just use an ordinary initializer:</p>\n\n<pre><code>DemoUnion u = { .c = c };\n</code></pre>\n\n<p>... or ordinary member assignment:</p>\n\n<pre><code>DemoUnion u;\nu.c = c;\n</code></pre>\n\n<p>as the situation warrants.</p>\n\n<p>Going the other way, of course, you should just use member selection:</p>\n\n<pre><code>char c2 = u.c;\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 8827807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b09adbdf2c49943cf4546013acb73ad9?s=128&d=identicon&r=PG&f=1", "display_name": "IdleCustard", "link": "https://stackoverflow.com/users/8827807/idlecustard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516832855, "creation_date": 1516830503, "question_id": 48432180, "link": "https://stackoverflow.com/questions/48432180/how-would-we-write-a-c-macro-to-insert-casts-into-function-calls", "title": "How would we write a C macro to insert casts into function calls?", "body": "<p>How might we write a preprocessor macro to replace every instance of:<br>\n<code>func(</code><br>\nwith<br>\n<code>func((DemoUnion)</code>?  </p>\n\n<p>Also, maybe a macro to replace <code>func((DemoUnion)(DemoUnion)</code> with <code>func((DemoUnion)</code>?</p>\n\n<p>By the way, below is an example of how DemoUnion might be defined:</p>\n\n<pre><code>union DemoUnion {\n    char c;\n    short s;\n    int i;\n    float f;\n}; typedef union DemoUnion DemoUnion;\n\n\n// the typedef  allows us to declare instances by writing\n//     DemoUnion instanceName;  \n// instead of:\n//     union DemoUnion instanceName;  \n</code></pre>\n\n<p>Also, C allows us to cast to union types pretty easily:<br>\n(so long as the input to the cast is one of the types included in the union)</p>\n\n<pre><code>int main() {\n  DemoUnion big = 0;\n  char c  = 1;\n  big = (DemoUnion) c; // cast char to union type\n\n  func(big);\n  func((DemoUnion) c);\n}\n</code></pre>\n"}, {"tags": ["c", "tree", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516829808, "post_id": 48431894, "comment_id": 83855161, "body": "Building a binary tree without recursion? This exercise author has a twisted mind..."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "edited": false, "score": 0, "creation_date": 1516829917, "post_id": 48431894, "comment_id": 83855213, "body": "Use a stack data structure"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516829957, "post_id": 48431894, "comment_id": 83855230, "body": "BTW, as far as I know a single preorder traversal sequence is not sufficient to reconstruct the tree."}, {"owner": {"reputation": 7540, "user_id": 4474230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/713c7ce18010e541853962264a719d83?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4474230/jeffrey"}, "reply_to_user": {"reputation": 13016, "user_id": 8751754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7k6Li.png?s=128&g=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/8751754/ron"}, "edited": false, "score": 0, "creation_date": 1516829977, "post_id": 48431894, "comment_id": 83855242, "body": "@Ron, but, but, there&#39;s the new keyword :-)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1516830045, "post_id": 48431894, "comment_id": 83855278, "body": "To do this without recursion, you need a data structure to hold pointers to the nodes along the path to the current node.  Implementation details don&#39;t matter so much, but it would function basically as a stack.  If your Node structure had a parent pointer, then the tree itself would serve that purpose, but I&#39;m supposing that you are not permitted to make that modification."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516830360, "post_id": 48431894, "comment_id": 83855423, "body": "Note also that if the zeroes in your example input are supposed to represent the absence of nodes, then your example output does not appear to match that input."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516830524, "post_id": 48431894, "comment_id": 83855505, "body": "Why does code use <code>if ( !fscanf(file, &quot;%d &quot;, &amp;value)...</code>?  <code>fscanf()</code> here could return 0,1 or <code>EOF</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516830533, "post_id": 48431894, "comment_id": 83855513, "body": "@EugeneSh., I&#39;m looking at the zeroes in the example input, and thinking that they correspond to the absence of child nodes at corresponding positions in the tree.  With that included, I think the pre-order traversal <i>is</i> sufficient to reconstruct the tree, though the result is not what the OP presents."}], "answers": [{"tags": [], "owner": {"reputation": 368, "user_id": 2904562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77e6e82a71d9209170823146567abca2?s=128&d=identicon&r=PG&f=1", "display_name": "Michal Butterweck", "link": "https://stackoverflow.com/users/2904562/michal-butterweck"}, "is_accepted": false, "score": 1, "last_activity_date": 1516830690, "creation_date": 1516830690, "answer_id": 48432236, "question_id": 48431894, "link": "https://stackoverflow.com/questions/48431894/deserialize-a-binary-tree-without-recursion/48432236#48432236", "title": "Deserialize a binary tree without recursion", "body": "<p>As your example is type of breadth-first algorithm, it may be solved with queue (look at <a href=\"https://stackoverflow.com/questions/687731/breadth-first-vs-depth-first\">Breadth First Vs Depth First</a>). It is possible also without queue using iterative depth first approach (look at: <a href=\"https://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search</a>).</p>\n"}], "owner": {"reputation": 19, "user_id": 3927163, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f788d93b3fa7b31a8df46d27aaa624f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mirel", "link": "https://stackoverflow.com/users/3927163/mirel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517568587, "creation_date": 1516829332, "last_edit_date": 1517568587, "question_id": 48431894, "link": "https://stackoverflow.com/questions/48431894/deserialize-a-binary-tree-without-recursion", "title": "Deserialize a binary tree without recursion", "body": "<p>I wrote a code for Deserialization of a binary tree using recursion.Can someone help me tweak it in a way that i can eliminate recursion because i have found that i am not allowed to use recursion in my task</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define NO_CHILD 0\n//node\nstruct Node\n{\n    int key;\n    struct Node* left, *right;\n};\n//create a node\nNode* _NewNode(int key)\n{\n    Node* temp = new Node;\n    temp-&gt;key = key;\n    temp-&gt;left = temp-&gt;right = NULL;\n    return (temp);\n}\n//extract binary tree from text\nvoid _ReadBinaryTree(Node *&amp;root, FILE *file)\n{\n    //read element;if there are no more elements or the elemnt has NO_CHILD stop\n    int value;\n    if ( !fscanf(file, \"%d \", &amp;value) || value == NO_CHILD)\n       return;\n    //otherwise create the node and recursion for its children\n    root = _NewNode(value);\n    _ReadBinaryTree(root-&gt;left, file);\n    _ReadBinaryTree(root-&gt;right, file);\n}\n\n//preorder traversal\nvoid _Preorder(Node *root)\n{\n    if (root)\n    {\n        printf(\"%d \", root-&gt;key);\n        _Preorder(root-&gt;left);\n        _Preorder(root-&gt;right);\n    }\n}\nint main()\n{\n    FILE *file;\n    Node *root1 = NULL;\n    file = fopen(\"tree.txt\", \"r\");\n    _ReadBinaryTree(root1, file);\n    printf(\"Preorder traversal:\\n\");\n    _Preorder(root1);\n    return 0;\n}\n</code></pre>\n\n<p>Here is an example:\n    If i read 1 2 3 4 0 0 0 0 5 0 7 0 0\n    it will display a binary tree traversed in preorder like this</p>\n\n<pre><code>            1\n    2           5\n3       4           7\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 1, "creation_date": 1516829150, "post_id": 48431828, "comment_id": 83854807, "body": "Did you check the values of the strings in the array? Are they what they should be?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1516829305, "post_id": 48431828, "comment_id": 83854889, "body": "<a href=\"https://stackoverflow.com/help/mcve\">Please post a Minimum, Complete, Verifiable Example</a>.  You don&#39;t show how you fill in your array, for instance."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516829341, "post_id": 48431828, "comment_id": 83854912, "body": "learn to use your debugger"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516829384, "post_id": 48431828, "comment_id": 83854939, "body": "show the code that populates the array"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516829404, "post_id": 48431828, "comment_id": 83854955, "body": "The first example, as given, has undefined behavior on account of the array elements not having been initialized."}, {"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516829927, "post_id": 48431828, "comment_id": 83855216, "body": "I have added the full block of code that fills in the array, as requested.  I have verified that the array prints out the correct character string that is input by the user.  If I input &quot;test.txt something&quot;, than array[0] = test.txt."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516830823, "post_id": 48432070, "comment_id": 83855660, "body": "I am using strtok to input the values to input_array.  I added all of my code above."}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "reply_to_user": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516831178, "post_id": 48432070, "comment_id": 83855871, "body": "@Confused_Engineer: Ohk, Let me check that."}, {"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516832629, "post_id": 48432070, "comment_id": 83856559, "body": "I have part of it figured out.  If the second filepath is left empty (something that the user can do), than fopen fails.  I am not sure why this is though."}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "reply_to_user": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516832712, "post_id": 48432070, "comment_id": 83856604, "body": "Following code block is assigning 3 strings to input_array and goind out of bound (not correct) //Parse out the file streams     input_array[i] = strtok(user_input_full,&quot; &quot;);      while(input_array[i]!=NULL)     {         input_array[++i] = strtok(NULL,&quot; &quot;);     }"}, {"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516833731, "post_id": 48432070, "comment_id": 83857072, "body": "How is it doing that?  My understanding is the first strtok parses out the first filepath into input_array[0] and the second strtok should parse out the second into input_array[1] (if it exists).  Apparently this is incorrect?"}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "reply_to_user": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516833871, "post_id": 48432070, "comment_id": 83857138, "body": "@Confused_Engineer:  input_array[0] = firstfile , input_array[1] = second, input_array[2] = &lt;null&gt; which is out of bound. Put a &#39;printf&#39; inside while loop and you will figure it out."}, {"owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "reply_to_user": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516834207, "post_id": 48432070, "comment_id": 83857273, "body": "@Confused_Engineer - when user only puts one filename, the filename contains <code>\\n</code>. But if you remove/replace <code>&#39;\\n&#39;</code> with <code>&#39;\\0&#39;</code> or <code>&#39; &#39;</code>, it will work."}, {"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "reply_to_user": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "edited": false, "score": 1, "creation_date": 1516834929, "post_id": 48432070, "comment_id": 83857556, "body": "@alvits - Thanks.  That was the root of the issue."}, {"owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "edited": false, "score": 0, "creation_date": 1516835049, "post_id": 48432070, "comment_id": 83857595, "body": "@nitin - I see it now.  Thanks."}], "tags": [], "owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "is_accepted": false, "score": 0, "last_activity_date": 1516832927, "last_edit_date": 1516832927, "creation_date": 1516830105, "answer_id": 48432070, "question_id": 48431828, "link": "https://stackoverflow.com/questions/48431828/passing-a-filepath-to-fopen-from-an-array-fails-in-c/48432070#48432070", "title": "Passing a filepath to fopen from an Array Fails in C", "body": "<p>First mistake I note is in the following code block. it's inputing 3 three strings to <code>input_array</code> and going out of bound.</p>\n\n<pre><code>//Parse out the file streams\ninput_array[i] = strtok(user_input_full,\" \");\n\nwhile(input_array[i]!=NULL)\n{\n    input_array[++i] = strtok(NULL,\" \");\n}\n</code></pre>\n\n<p>Change this code block to something as shown here.</p>\n\n<pre><code>input_array[i] = strtok(user_input_full,\" \");\nfor(i=1;i&lt;2;i++)\n{\n    input_array[i] = strtok(NULL,\" \");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5768, "user_id": 3088572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769f723b0fd6eb8c99d5f65b39392b18?s=128&d=identicon&r=PG&f=1", "display_name": "alvits", "link": "https://stackoverflow.com/users/3088572/alvits"}, "is_accepted": true, "score": 0, "last_activity_date": 1516834579, "creation_date": 1516834579, "answer_id": 48433071, "question_id": 48431828, "link": "https://stackoverflow.com/questions/48431828/passing-a-filepath-to-fopen-from-an-array-fails-in-c/48433071#48433071", "title": "Passing a filepath to fopen from an Array Fails in C", "body": "<p>The real reason it is failing is due to trailing newline in the filename. All you need is to add newline as string token.</p>\n\n<p>Change this line:</p>\n\n<pre><code>input_array[i] = strtok(user_input_full,\" \");\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>input_array[i] = strtok(user_input_full,\" \\n\");\n</code></pre>\n\n<p>and this line:</p>\n\n<pre><code>input_array[++i] = strtok(NULL,\" \");\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>input_array[++i] = strtok(NULL,\" \\n\");\n</code></pre>\n\n<p>This will remove the trailing newlines.</p>\n"}], "owner": {"reputation": 15, "user_id": 9264323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5450f29d239f094b3710b66773670af1?s=128&d=identicon&r=PG&f=1", "display_name": "Confused_Engineer", "link": "https://stackoverflow.com/users/9264323/confused-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 48433071, "answer_count": 2, "score": 1, "last_activity_date": 1516834579, "creation_date": 1516829042, "last_edit_date": 1516831871, "question_id": 48431828, "link": "https://stackoverflow.com/questions/48431828/passing-a-filepath-to-fopen-from-an-array-fails-in-c", "title": "Passing a filepath to fopen from an Array Fails in C", "body": "<p>I have a two filepaths input by the user and stored in an array.  However, when I try to use one of these filepaths to open a file using fopen the code exits as if the file does not exist.  If I hard code the filepath into the fopen function eveything proceeds perfectly.</p>\n\n<p>For Example:</p>\n\n<pre><code>//Libraries\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\n//Global Functions\n\n//Main Function\nint main()\n{\n\n    //Local Variables\n    char * user_input_full = NULL;\n    char user_input = 'a';\n    size_t len = 0;         //Pointer for user_input_full\n    int size = 0;           //Length of the input_use_full array\n    char *input_array[2];       //This hold the filepaths\n    int i=0;            //A loop counter\n\n    //Carve out an initial array for the use input string (it is of unknown length)\n    user_input_full = calloc(16,sizeof(char));\n    size = 16;\n\n    //Take user input until a newline is encountered.\n    while(user_input != '\\n')\n    {\n        scanf(\"%c\", &amp;user_input);\n\n        user_input_full[len] = user_input;\n        len = len+1;\n        if(len==size)\n        {\n            #ifdef DEBUG_MODE\n            printf(\"The input stream is being reallocated\\n\");\n            #endif\n            user_input_full = realloc(user_input_full,sizeof(char)*(size+16));\n            if(user_input_full == NULL)\n            {\n                //realloc failed, return a fail status\n                printf(\"Realloc of the input stream failed.\\n\");\n                return EXIT_FAILURE;\n            }\n        }\n    }\n\n    user_input_full[len] = '\\0';\n\n    #ifdef DEBUG_MODE\n    printf(\"The user input was: %s \\n\", user_input_full);\n    #endif\n\n    //Parse out the file streams\n    input_array[i] = strtok(user_input_full,\" \");\n\n    while(input_array[i]!=NULL)\n    {\n        input_array[++i] = strtok(NULL,\" \");\n    }\n\n    #ifdef DEBUG_MODE\n    printf(\"Input array Values:\\n\");\n    for (i=0;i&lt;2;i++)\n    {\n        printf(\"%s \\n\",input_array[i]);\n    }\n    #endif\n\n    //open the file specified in input_array[0]\n    if(fopen(input_array[0],\"r\") == NULL)\n    {\n        printf(\"Open of the input file failed.\\n\");\n        printf(\"Tried to open: %s \", input_array[0]);\n        return EXIT_FAILURE;\n    }\n    else\n    {\n          printf(\"The file opened.\\n\");\n    }\n\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Would print the error block.  However:</p>\n\n<pre><code>//Open the file specified in array[0]\nif(fopen(\"test.txt\",\"r\") == NULL)\n{\n     printf(\"Failed to open the input file.\\n\");\n     return EXIT_FAILURE;\n}\nelse\n{\n     printf(\"The file opened.\\n\");\n}\n</code></pre>\n\n<p>Works perfectly fine.</p>\n\n<p>I also tried passing the value in input_array[0] to a const char*, but that did not work either.  I feel like I am missing some fundamental concept here.</p>\n\n<p>EDIT: Clarified one of the comments in the code block</p>\n"}, {"tags": ["c", "structure", "file-handling", "fwrite", "fread"], "comments": [{"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 1, "creation_date": 1516828456, "post_id": 48431667, "comment_id": 83854459, "body": "What is this: <code>G:printf(&quot;\\nWelcome To The ATM Services:\\n&quot;);</code>?"}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "reply_to_user": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1516828665, "post_id": 48431667, "comment_id": 83854548, "body": "i have used goto G in the code if user want to do another transaction."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516828674, "post_id": 48431667, "comment_id": 83854552, "body": "And <code>D:scanf</code> ... and more of those, what are they?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1516828707, "post_id": 48431667, "comment_id": 83854570, "body": "@AlexQuilliam it is a label, the target of a horrible <code>goto G;</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516828735, "post_id": 48431667, "comment_id": 83854590, "body": "@RajeshDubey Very bad!!! First of all, a label must be clearly a label <i>syntaxwise</i> and second and most importantly DO NOT USE <code>goto</code> for that, it makes the code impossible to understand. That&#39;s why they created structured programs."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "edited": false, "score": 0, "creation_date": 1516828736, "post_id": 48431667, "comment_id": 83854592, "body": "as i told i have used goto in the code to go back in the code"}, {"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 1, "creation_date": 1516828838, "post_id": 48431667, "comment_id": 83854639, "body": "@RajeshDubey Using <code>goto</code> is bad practice, and should only be used very rarely, in select situations (e.g. breaking out of a double-for loop). <a href=\"https://xkcd.com/292/\" rel=\"nofollow noreferrer\">xkcd</a>."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "edited": false, "score": 0, "creation_date": 1516828847, "post_id": 48431667, "comment_id": 83854641, "body": "so what can i use if i want to go back in the code to perform task again"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516828884, "post_id": 48431667, "comment_id": 83854657, "body": "You will end up with spaghetti / rat&#39;s nest that nobody can follow - least of all yourself in six month&#39;s time. You need to structure the code properly."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "edited": false, "score": 0, "creation_date": 1516828887, "post_id": 48431667, "comment_id": 83854658, "body": "should i use do while loop or any other method.please suggest me"}, {"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1516828977, "post_id": 48431667, "comment_id": 83854705, "body": "@RajeshDubey Break your code up into multiple methods that only perform a few tasks at a time, and call the method that you need whenever you want to repeat something."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "reply_to_user": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 0, "creation_date": 1516829014, "post_id": 48431667, "comment_id": 83854732, "body": "@Alex Quilliam ok i will do that"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516829360, "post_id": 48431667, "comment_id": 83854924, "body": "@RajeshDubey Adding to <a href=\"https://stackoverflow.com/questions/48431667/getting-error-while-reading-data-from-file-usinf-structure-in-c#comment83854705_48431667\">this comment</a>: use names that describe a single action, and then write a function that does exactly that action and nothing else. That way your code will be so easy to read, that bugs will appear very clear to you. Also, use comments where something is not immediately clear to the reader. Note, that when you write code you do so once, but you read it a lot, (<i>even your own code</i>)."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516829504, "post_id": 48431667, "comment_id": 83855006, "body": "@Iharob Al Asimi Yes you are right i have done coding like a maze."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516830101, "post_id": 48431667, "comment_id": 83855306, "body": "learn to use your debugger"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1516830124, "post_id": 48431667, "comment_id": 83855322, "body": "This is way too much code for us to deal with. Can you reduce the question to just the code that&#39;s related to the problem you&#39;re having? We don&#39;t need to see all the unrelated ATM functions."}, {"owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "edited": false, "score": 0, "creation_date": 1516830584, "post_id": 48431667, "comment_id": 83855532, "body": "Barmar: i think problem is in balance_enquiry and auth_id functions."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516831410, "post_id": 48431667, "comment_id": 83855986, "body": "Never use floats for currency, use an integer for that."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "is_accepted": false, "score": 0, "last_activity_date": 1516989789, "last_edit_date": 1516989789, "creation_date": 1516989477, "answer_id": 48466967, "question_id": 48431667, "link": "https://stackoverflow.com/questions/48431667/getting-error-while-reading-data-from-file-using-structure-in-c/48466967#48466967", "title": "Getting error while reading data from file using structure in C", "body": "<p>finally, my code is working properly..everything is fine now.\nhere is the my code for those who interested in this project or similar to this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nstruct user\n{\n    int id;\n    char name[20];\n    char lname[20];\n    int acct_num;\n    int pin;\n    int balance;\n};\nvoid balance_enquiry();\nvoid balance_withdraw();\nvoid balance_deposit();\nvoid account_creation();\nvoid account_modify();\nvoid account_del();\nvoid displayAll();\n\nchar fname[] = { \"atm.dat\" };\n\nint main()\n{\n    while (1)\n    {\n        int ch;\n        printf(\"\\n\\t\\tWelcome To The ATM Services:\\n\");\n        printf(\"\\n\\t\\t****************************\\n\");\n        printf(\"\\n\\t\\tPlease Choose Your Options:\\n\");\n        printf(\"\\n\");\n        printf(\"1. Balance Enquiry:\\t\\t4. Account creation:\\n\");\n        printf(\"2. Withdraw Money:\\t\\t5. Account Modification:\\n\");\n        printf(\"3. Deposit Money:\\t\\t6. Account Delete:\\n\\n\");\n        printf(\"\\t\\tPress 0 For Exit:\\n\");\n        scanf(\"%d\", &amp;ch);\n        switch (ch)\n        {\n        case 1:\n            balance_enquiry();\n            break;\n        case 2:\n            balance_withdraw();\n            break;\n        case 3:\n            balance_deposit();\n            break;\n        case 4:\n            account_creation();\n            break;\n        case 5:\n            account_modify();\n            break;\n        case 6:\n            account_del();\n            break;\n        case 0:\n            return 0;\n        case 11://to see all details of customer in database.\n            displayAll();\n            break;\n        default:\n            printf(\"Enter Valid Options:\\n\");\n        }\n    }\n    return 0;\n}\nvoid balance_enquiry()\n{\n    FILE *fp;\n    struct user t;\n    int id, tmpPin, found = 0;\n    fp = fopen(fname, \"rb\");\n    printf(\"\\nEnter Your Customer ID:\");\n    scanf(\"%d\", &amp;id);\n    printf(\"\\nEnter Your Secret PIN:\\n\");\n    scanf(\"%d\", &amp;tmpPin);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n\n        if (feof(fp))\n        {\n            break;\n        }\n        if (t.id == id &amp;&amp; t.pin == tmpPin)\n        {\n            found = 1;\n            printf(\"\\n============================================\\n\\n\");\n            printf(\"Welcome, Mr %s %s\\n\\n\", t.name, t.lname);\n            printf(\"Account Number\\t\\t Balance\\n\\n\");\n            printf(\"%d\\t\\t %d\\n\\n\", t.acct_num, t.balance);\n            printf(\"==============================================\\n\\n\");\n        }\n    }\n    if (found == 0)\n    {\n        printf(\"\\nSorry You Have Entered Wrong Details:\\n\");\n    }\n    fclose(fp);\n}\nvoid balance_withdraw()\n{\n    FILE *fp, *fp1;\n    struct user t;\n    int id, found = 0;\n    int withdraw, tmpPin;\n    fp = fopen(fname, \"rb\");\n    fp1 = fopen(\"temp.dat\", \"wb\");\n\n    printf(\"\\nEnter the Customer ID:\\n\");\n    scanf(\"%d\", &amp;id);\n    printf(\"Enter Your Secret PIN:\\n\");\n    scanf(\"%d\", &amp;tmpPin);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n        {\n            break;\n        }\n        if (t.id == id &amp;&amp; t.pin == tmpPin)\n        {\n            found = 1;\n            do\n            {\n                do\n                {\n                    printf(\"\\nEnter Amount To Withdraw:\\n\");\n                    scanf(\"%d\", &amp;withdraw);\n                    if (withdraw % 100 != 0)\n                    {\n                        printf(\"\\nAmount Should Be Multiple Of 100:\\n\");\n                    }\n                } while (withdraw % 100 != 0);\n                if (withdraw &gt; t.balance)\n                {\n                    printf(\"\\n Insufficient Balance:\\n\");\n                    printf(\"\\nTry With Lesser Amount\\n\");\n                }\n            } while (withdraw &gt; t.balance);\n            if (withdraw &lt;= t.balance)\n            {\n                t.balance = t.balance - withdraw;\n                printf(\"\\nPlease Collect Your Cash:\\n\\n\");\n                printf(\"\\nYour Current Balance Is: %d\", t.balance);\n                fflush(stdin);\n                fwrite(&amp;t, sizeof(t), 1, fp1);\n            }\n        }\n        else\n        {\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n    if (found == 0)\n    {\n        printf(\"Sorry Try Again! Technical Problem:\\n\\n\");\n    }\n    else\n    {\n        fp = fopen(fname, \"wb\");\n        fp1 = fopen(\"temp.dat\", \"rb\");\n        while (1)\n         {\n            fread(&amp;t, sizeof(t), 1, fp1);\n            if (feof(fp1))\n            {\n                break;\n            }\n            fwrite(&amp;t, sizeof(t), 1, fp);\n        }\n\n    }\n    fclose(fp);\n    fclose(fp1);\n}\nvoid balance_deposit()\n{\n    FILE *fp, *fp1;\n    struct user t;\n    int id, found = 0;\n    int deposit, tmpPin;\n    fp = fopen(fname, \"rb\");\n    fp1 = fopen(\"temp.dat\", \"wb\");\n\n    printf(\"\\nEnter the Customer ID:\\n\");\n    scanf(\"%d\", &amp;id);\n    printf(\"Enter Your Secret PIN:\\n\");\n    scanf(\"%d\", &amp;tmpPin);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n        {\n            break;\n        }\n        if (t.id == id &amp;&amp; t.pin == tmpPin)\n        {\n            found = 1;\n            do\n            {\n                printf(\"\\nEnter Amount To Deposit:\\n\");\n                scanf(\"%d\", &amp;deposit);\n                if (deposit % 100 != 0)\n                {\n                    printf(\"\\nPLEASE Enter The Amount In Multiples Of 100:\\n\");\n                }\n            } while (deposit % 100 != 0);\n            t.balance = t.balance + deposit;\n            printf(\"\\nYOUR CURRENT BALANCE IS: %d\", t.balance);\n            fflush(stdin);\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n        else\n        {\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n    if (found == 0)\n    {\n        printf(\"Sorry Try Again! Technical Problem:\\n\\n\");\n    }\n    else\n    {\n        fp = fopen(fname, \"wb\");\n        fp1 = fopen(\"temp.dat\", \"rb\");\n\n        while (1)\n        {\n            fread(&amp;t, sizeof(t), 1, fp1);\n            if (feof(fp1))\n            {\n                break;\n            }\n            fwrite(&amp;t, sizeof(t), 1, fp);\n        }\n\n    }\n    fclose(fp);\n    fclose(fp1);\n }\nvoid account_creation()\n{\n    FILE *fp;\n    struct user t;\n    fp = fopen(fname, \"ab\");\n    printf(\"\\t\\tWelcome,First Time User\\n\\nPlease Enter Your Personal Details:\\n\\n\");\n    printf(\"Enter Customer ID Number:\\n\");\n    scanf(\"%d\", &amp;t.id);\n    printf(\"Enter You First Name:\\n\");\n    scanf(\"%s\", t.name);\n    printf(\"Enter Your Last Name:\\n\");\n    scanf(\"%s\", t.lname);\n    printf(\"Enter Your New Account Number:\\n\");\n    scanf(\"%d\", &amp;t.acct_num);\n    printf(\"Enter Your Secret PIN:\\n\");\n    scanf(\"%d\", &amp;t.pin);\n    printf(\"Enter The Initial Amount:\\n\");\n    scanf(\"%d\", &amp;t.balance);\n    fwrite(&amp;t, sizeof(struct user), 1, fp);\n    fclose(fp);\n}\nvoid account_modify()\n{\n    FILE *fp, *fp1;\n    struct user t;\n    int id, found = 0;\n    int tmpPin, ch;\n    fp = fopen(fname, \"rb\");\n    fp1 = fopen(\"temp.dat\", \"wb\");\n    printf(\"\\nEnter the Customer ID you want to Modify:\");\n    scanf(\"%d\", &amp;id);\n    printf(\"\\nEnter the Secret PIN of Custmer ID = %d:\\n\", id);\n    scanf(\"%d\", &amp;tmpPin);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n\n        if (feof(fp))\n        {\n            break;\n        }\n        if (t.id == id &amp;&amp; t.pin == tmpPin)\n        {\n            found = 1;\n            printf(\"Which Data You Want To Modify:\\n\");\n            printf(\"\\t1. Custormer ID:\\n\");\n            printf(\"\\t2. First Name:\\n\");\n            printf(\"\\t3. Last Name:\\n\");\n            printf(\"\\t4. Secret PIN:\\n\");\n            printf(\"Others are Not Allowed:\\n\");\n            scanf(\"%d\", &amp;ch);\n            switch (ch)\n            {\n             case 1:\n                printf(\"Enter New customer ID:\");\n                scanf(\"%d\", &amp;t.id);\n                fflush(stdin);\n                break;\n            case 2:\n                printf(\"Enter New Customer First Name:\\n\");\n                scanf(\"%s\", t.name);\n                break;\n            case 3:\n                printf(\"Enter New Customer Last Name:\\n\");\n                scanf(\"%s\", t.lname);\n                break;\n            case 4:\n                printf(\"Enter Your New Secret PIN:\\n\");\n                scanf(\"%d\", &amp;t.pin);\n                break;\n            default:\n                printf(\"tEnter Valid Choice:\\n\");\n                break;\n            }\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n        else\n        {\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n    if (found == 0)\n    {\n        printf(\"Sorry No Record Found\\n\\n\");\n    }\n    else\n    {\n        fp = fopen(fname, \"wb\");\n        fp1 = fopen(\"temp.dat\", \"rb\");\n        while (1)\n        {\n            fread(&amp;t, sizeof(t), 1, fp1);\n            if (feof(fp1))\n            {\n                break;\n            }\n            fwrite(&amp;t, sizeof(t), 1, fp);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n}\n\nvoid account_del()\n{\n    FILE *fp, *fp1;\n    struct user t;\n    int id, found = 0;\n\n    fp = fopen(fname, \"rb\");\n    fp1 = fopen(\"temp.dat\", \"wb\");\n\n    printf(\"\\nEnter the Customer ID you want to Delete:\");\n    scanf(\"%d\", &amp;id);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n        {\n             break;\n        }\n        if (t.id == id)\n        {\n            found = 1;\n        }\n        else\n        {\n            fwrite(&amp;t, sizeof(t), 1, fp1);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n    if (found == 0)\n    {\n        printf(\"Sorry No Record Found\\n\\n\");\n    }\n    else\n    {\n        fp = fopen(fname, \"wb\");\n        fp1 = fopen(\"temp.dat\", \"rb\");\n        while (1)\n        {\n            fread(&amp;t, sizeof(t), 1, fp1);\n            if (feof(fp1))\n            {\n                break;\n            }\n            fwrite(&amp;t, sizeof(t), 1, fp);\n        }\n    }\n    fclose(fp);\n    fclose(fp1);\n}\nvoid displayAll()\n{\n    FILE *fp;\n    struct user t;\n    fp = fopen(fname, \"rb\");\n    printf(\"\\n========================================================\\n\\n\");\n    printf(\"\\t\\t All Customer Details\\n\\n\");\n    printf(\"=====================================================\\n\\n\");\n    printf(\"ID\\tFirst\\tLast\\tAccount Number\\tPIN\\tBalance\\n\\n\");\n    while (1)\n    {\n        fread(&amp;t, sizeof(struct user), 1, fp);\n        if (feof(fp))\n        {\n            break;\n        }\n        printf(\"%d\\t\", t.id);\n        printf(\"%s\\t\", t.name);\n        printf(\"%s\\t\", t.lname);\n        printf(\"%d\\t\", t.acct_num);\n        printf(\"%d\\t\", t.pin);\n        printf(\"%d\\t\\n\\n\", t.balance);\n    }\n    printf(\"=====================================================\\n\\n\");\n    fclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8339585, "user_type": "registered", "profile_image": "https://graph.facebook.com/1615953171768514/picture?type=large", "display_name": "Rajesh Dubey", "link": "https://stackoverflow.com/users/8339585/rajesh-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516989789, "creation_date": 1516828317, "last_edit_date": 1516829950, "question_id": 48431667, "link": "https://stackoverflow.com/questions/48431667/getting-error-while-reading-data-from-file-using-structure-in-c", "title": "Getting error while reading data from file using structure in C", "body": "<p>I am working on a mini project called ATM as winter assignment. I have done coding for ATM as shown in below code. but I am getting a problem as suppose I have created a database for user and store it in to file but for first user i.e first entry, I can read data easily but for second entry in the file, I can not read the data in the first attempt. In first attempt its shows wrong <code>Id</code> and <code>PIN</code> but while entering second time all works fine. Same thing happened with third entry in the list i.e third user. For first two attempts it shows wrong <code>ID</code> and <code>PIN</code> but in third attempts all works fine. As so on for all users i.e forth, fifth etc.</p>\n\n<p>Here is the my code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nstruct user\n{  \n    int id;\n    char fname[20],lname[20];\n    long unsigned int acct_num, mobile;\n    int pin;\n    float balance;\n};\n\nvoid balance_enquiry();\nvoid balance_withdraw();\nvoid balance_deposit();\nvoid account_creation();\nvoid account_modify();\nvoid account_auth_id();\nvoid account_auth_pin();\n\nchar data[] = {\"ATM.dat\"};\nint main()\n{\n    int option;\n    G:printf(\"\\nWelcome To The ATM Services:\\n\");\n    printf(\"\\n****************************\\n\");\n    printf(\"\\nPlease Choose Your Options:\\n\");\n    printf(\"\\n\");\n    printf(\"\\n1. Banking Services:\\n\");\n    printf(\"\\n2. Account Creation:\\n\");\n    printf(\"\\n3. Account Modification:\\n\");\n    scanf(\"%d\", &amp;option);\n    switch (option)\n    {\n        case 1:\n        {\n            system(\"clear\");\n            int choice;\n            account_auth_id();\n            account_auth_pin();\n            printf(\"\\n********Welcome to ATM Service**************\\n\");\n            printf(\"\\n1. Check Balance\\n\");\n            printf(\"\\n2. Withdraw Cash\\n\");\n            printf(\"\\n3. Deposit Cash\\n\");\n            printf(\"\\n4. Quit\\n\");\n            printf(\"\\n******************?**************************?*\\n\\n\");\n            printf(\"\\nEnter Your Choice: \\n\");\n            scanf(\"%d\", &amp;choice);\n            switch (choice)\n            {\n                case 1:\n                    balance_enquiry();\n                    break;\n                case 2:\n                    balance_withdraw();\n                    break;\n                case 3:\n                    balance_deposit();\n                case 4:\n                    printf(\"\\nTHANK U FOR USING ATM \\n\");\n                    break;\n                default:\n                    printf(\"\\nINVALID CHOICE:\\n\");\n                    break;\n            }\n            break;\n        }\n        case 2:\n            account_creation();\n            break;\n        case 3:\n            account_modify();\n            break;\n        case 4:\n            printf(\"\\nTHANK U FOR USING ATM \\n\");\n            break;\n        default:\n            printf(\"\\nEnter Valid Choice:\\n\");\n            break;\n    }\n    char transaction;\n    printf(\"\\nDO U WANT TO PERFORM ANOTHER TRANSCATION (y or n): \\n\");\n    scanf(\" %c\", &amp;transaction);\n    if (transaction == 'y')\n        goto G;\n    printf(\"\\nTHANKS FOR USING OUT ATM SERVICE:\\n\\n\");\n    getch();\n    return 0;\n}\n\nvoid balance_enquiry()\n{\n    FILE *fp;\n    struct user t;\n    int id, f = 0;\n    fp = fopen(data, \"rb\");\n    printf(\"\\nEnter Your ID Number:\\n\");\n    D:scanf(\"%d\", &amp;id);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n            break;\n        if (t.id == id)\n        {\n            f = 1;\n            printf(\"Your Current Balance Is: %f\\n\", t.balance);\n        }\n        if (f == 0)\n        {\n            printf(\"Please Enter valid ID:\\n\");\n            goto D;\n        }\n    }\n    fclose(fp);\n}\n\nvoid balance_withdraw()\n{\n    FILE *fp,*fp1;\n    struct user t1;\n    int withdraw,id, f = 0;\n    fp = fopen(\"ATM.dat\", \"rb\");\n    fp1 = fopen(\"temp.dat\", \"wb\");\n    printf(\"\\nEnter Your ID Number:\\n\");\n    scanf(\"%d\", &amp;id);\n    while (1)\n    {\n        fread(&amp;t1, sizeof(struct user), 1, fp);\n        if (feof(fp))\n            break;\n        if (t1.id == id)\n        {\n            f = 1;\n            printf(\"\\nENTER THE AMOUNT TO WITHDRAW: \\n\");\n            A:scanf(\"%d\", &amp;withdraw);\n            if (withdraw % 100 != 0)\n            {\n                printf(\"\\nPLEASE ENTER THE AMOUNT IN MULTIPLES OF 100:\\n\");\n                    goto A;\n            }\n            if (withdraw &gt; t1.balance)\n            {\n                printf(\"\\nINSUFFICENT BALANCE:\\n\");\n                printf(\"\\nTRY WITH LESSER AMOUNT\\n\");\n                goto A;\n                if (withdraw &lt;= t1.balance)\n                {\n                    t1.balance = t1.balance - withdraw;\n                    printf(\"\\nPLEASE COLLECT CASH:\\n\\n\");\n                    printf(\"\\nYOUR CURRENT BALANCE IS: %d\", t1.balance);\n                    fwrite(&amp;t1, sizeof(struct user), 1, fp1);\n                }\n                else\n                    fwrite(&amp;t1, sizeof(struct user), 1, fp1);\n\n            }\n        }\n        fclose(fp);\n        fclose(fp1);\n        if (f == 0)\n        {\n            printf(\"Sorry, There Is Some Technical Problem:\\n\\n\");\n        }\n        else\n        {\n            fp = fopen(\"ATM.dat\", \"wb\");\n            fp1 = fopen(\"temp.dat\", \"rb\");\n            while (1)\n            {\n                fread(&amp;t1, sizeof(struct user), 1, fp1);\n                if (feof(fp1))\n                    break;\n                fwrite(&amp;t1, sizeof(struct user), 1, fp);\n            }\n        }\n        fclose(fp);\n        fclose(fp1);\n    }\n}\n\nvoid balance_deposit()\n{\n\n}\n\nvoid account_auth_id()\n{\n    FILE *fp;\n    struct user t;\n    int id, f = 0,k =0;\n    fp = fopen(data, \"rb\");\n    fflush(stdin);\n    A:printf(\"\\nEnter Your ID Number:\\n\");\n    scanf(\"%d\", &amp;id);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n            break;\n        if (t.id == id) \n        {\n            f = 1;\n            printf(\"Welcome, Mr %s\\n\", t.fname);\n        }\n        if (f == 0) \n        {\n            k++;\n            if(k == 3)\n            {\n                printf(\"You Have Reached Max. Attempts:\\n\");\n                getch();\n                return 0;\n            }\n            printf(\"You Have Entered Wrong ID:\\n\");\n            printf(\"Please Enter Valid ID:\\n\");\n            goto A;\n        }\n    }\n\n}\n\nvoid account_auth_pin()\n{\n    FILE *fp;\n    struct user t;\n    int tmpPin,k = 0, f = 0;\n    fp = fopen(data, \"rb\");\n    fflush(stdin);\n    B:printf(\"Enter Your Secret Pin:\\n\");\n    scanf(\"%d\", &amp;tmpPin);\n    while (1)\n    {\n        fread(&amp;t, sizeof(t), 1, fp);\n        if (feof(fp))\n            break;\n        if (t.pin == tmpPin)\n        {\n            f = 1;\n            printf(\"Super!,Now You Can Enjoy Banking Services:\\n\");\n        }\n        if (f == 0)\n        {\n            k++;\n            if(k == 3)\n            {\n                printf(\"You Have Entered Three Times Wrong PIN:\\n\");\n                printf(\"Please,Try Again:\\n\");\n                getch();\n                return 0;\n            }\n            printf(\"You Have Entered Wrong PIN:\\n\");\n            printf(\"Please Enter Correct PIN:\\n\");\n            goto B;\n        }\n    }\n\n}\n\nvoid account_creation()\n{\n    FILE *fp;\n    struct user t;\n    fp = fopen(data, \"ab\");\n    printf(\"Enter Your ID Number:\\n\");\n    scanf(\"%d\", &amp;t.id);\n    printf(\"\\nEnter Your First Name:\\n\");\n    scanf(\"%s\", &amp;t.fname);\n    printf(\"\\nEnter Your Last Name:\\n\");\n    scanf(\"%s\", &amp;t.lname);\n    printf(\"Enter Your New Account number:\\n\");\n    scanf(\"%lu\", &amp;t.acct_num);\n    printf(\"Enter Your Mobile Number:\\n\");\n    scanf(\"%lu\", &amp;t.mobile);\n    printf(\"Enter Your Secret PIN:\\n\");\n    scanf(\"%d\", &amp;t.pin);\n    printf(\"Enter The initial Amount To Deposit:\\n\");\n    scanf(\"%f\", &amp;t.balance);\n    fwrite(&amp;t, sizeof(t), 1, fp);\n    fclose(fp);\n}\n\nvoid account_modify()\n{\n\n}\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516826866, "post_id": 48431325, "comment_id": 83853672, "body": "No. <i>&lt;space filler&gt;</i>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1516826900, "post_id": 48431325, "comment_id": 83853683, "body": "Why do you think you need to?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1516826934, "post_id": 48431325, "comment_id": 83853698, "body": "I mean literally &quot;No&quot;. And stop abusing macros, these considered to be a bad practice."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516827009, "post_id": 48431325, "comment_id": 83853732, "body": "What are you attempting with it?"}, {"owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "edited": false, "score": 4, "creation_date": 1516827067, "post_id": 48431325, "comment_id": 83853764, "body": "Think about it: the preprocessor can&#39;t possibly know what happens at runtime, so it is impossible to define a macro after the preprocessor is done."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516827199, "post_id": 48431325, "comment_id": 83853820, "body": "@EugeneSh. Everything has its uses."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516827326, "post_id": 48431325, "comment_id": 83853888, "body": "@machine_1 Sure. But the OP is clearly trying to <i>abuse</i> them (here and in his previous question)."}, {"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516830742, "post_id": 48431325, "comment_id": 83855619, "body": "@EugeneSh. I wouldn&#39;t call that an abuse, just a clever idea that shows the macro&#39;s limitations. What he asks is completely possible btw."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "edited": false, "score": 0, "creation_date": 1516830796, "post_id": 48431325, "comment_id": 83855644, "body": "@ft_error Really? 4 answers claim it is not possible. Including yours"}, {"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516831046, "post_id": 48431325, "comment_id": 83855775, "body": "@EugeneSh. I meant possible in the way that what he wants to do is achieveable in other ways, and i think it his concept would be a nice addition to the C preprocessor, it would cause some sort of recursive preprocessor passing after himself and eventually an infinite loop of recursion of a macro defining its own definition, that would be awesome!"}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516870425, "post_id": 48431325, "comment_id": 83868848, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32774678/preprocessor-fails-due-to-is-not-followed-by-a-macro-parameter\">Preprocessor fails due to - &#39;#&#39; is not followed by a macro parameter</a>"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 5, "last_activity_date": 1516859644, "last_edit_date": 1516859644, "creation_date": 1516827267, "answer_id": 48431415, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/48431415#48431415", "title": "Is it possible to define macro inside macro?", "body": "<p><strong>This is not possible.</strong> Read about the <a href=\"https://gcc.gnu.org/onlinedocs/cpp/\" rel=\"nofollow noreferrer\">GNU <code>cpp</code> preprocessor</a> and the C11 standard (i.e. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a>), and check <a href=\"http://en.cppreference.com/w/c\" rel=\"nofollow noreferrer\">here</a>. The <a href=\"https://en.wikipedia.org/wiki/C_preprocessor\" rel=\"nofollow noreferrer\">C preprocessor</a> is (conceptually at least) run before the rest of the compiler (which gets the <em>preprocessed</em> form of your <a href=\"https://en.wikipedia.org/wiki/Translation_unit_(programming)\" rel=\"nofollow noreferrer\">translation unit</a>). BTW, for a file <code>foo.c</code> you could use <code>gcc -C -E foo.c &gt; foo.i</code> (using <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>) to get inside <code>foo.i</code> its preprocessed form, and you can inspect that <code>foo.i</code> -since it is a textual file- with a pager or an editor.</p>\n\n<p>However, <strong>a <code>.c</code>  file can be generated</strong> (generating C code is a common practice, at least since the 1980s; for example with <a href=\"https://en.wikipedia.org/wiki/Yacc\" rel=\"nofollow noreferrer\">yacc</a>, <a href=\"https://www.gnu.org/software/bison/\" rel=\"nofollow noreferrer\">bison</a>, <a href=\"https://en.wikipedia.org/wiki/RPCGEN\" rel=\"nofollow noreferrer\">rpcgen</a>, <a href=\"http://swig.org/\" rel=\"nofollow noreferrer\">swig</a>, ....; many large software projects use specialized generators of C or C++ code...). You might consider using some other tool, perhaps the <a href=\"https://logological.org/gpp\" rel=\"nofollow noreferrer\">GPP</a> preprocessor (or <a href=\"https://www.gnu.org/software/m4/m4.html\" rel=\"nofollow noreferrer\">GNU m4</a>) or some other program or script, to generate your C file (from something else). Look also into <a href=\"https://en.wikipedia.org/wiki/Autoconf\" rel=\"nofollow noreferrer\">autoconf</a> (it might have goals similar to yours).</p>\n\n<p>You may want to configure your <a href=\"https://en.wikipedia.org/wiki/Build_automation\" rel=\"nofollow noreferrer\">build automation</a> tool for such purpose, e.g. edit your <a href=\"https://en.wikipedia.org/wiki/Makefile\" rel=\"nofollow noreferrer\"><code>Makefile</code></a> for <a href=\"https://www.gnu.org/software/make/manual/html_node/index.html\" rel=\"nofollow noreferrer\">GNU <code>make</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516834888, "post_id": 48431458, "comment_id": 83857543, "body": "This does not involve preprocessing after translation. The idea in the question is that the D macro would be expanded somewhere later in the source, and, after that expansion, the replacement text would then be rescanned for preprocessor directives. This would all occur during preprocessing."}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516871175, "post_id": 48431458, "comment_id": 83869312, "body": "@EricPostpischil: The interesting trick is to preprocess sources twice: <code>gcc -E source.c | gcc -xc -</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516894865, "post_id": 48431458, "comment_id": 83885352, "body": "@EugenKonkov: That does not work on the first code sequence in the question because <code>` followed by new-line is deleted during translation phase 2, before preprocessing, so the resulting </code>D` macro does not have new-line characters in its replacement text, so the expanded preprocessing directives are not on separate lines. It does not work on the first or the second code sequence because <code>#</code> is an operator in macro replacement (it stringifies) and must be followed by a macro parameter, so <code>#if</code> is illegal."}], "tags": [], "owner": {"reputation": 1101, "user_id": 7021836, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/299fc62810116e741333419b8e6cfd24?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Quilliam", "link": "https://stackoverflow.com/users/7021836/alex-quilliam"}, "is_accepted": false, "score": 2, "last_activity_date": 1516827413, "creation_date": 1516827413, "answer_id": 48431458, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/48431458#48431458", "title": "Is it possible to define macro inside macro?", "body": "<p>No, you cannot. The C preprocessor cannot know what is going to occur during runtime.</p>\n\n<p>The preprocessor goes through the program before it is even compiled and replaces every macro defined with its assigned value.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516834643, "post_id": 48431479, "comment_id": 83857448, "body": "If all preprocessing directives were executed before any macro expansion, <code>#if MyPreprocessorSymbol == 3</code> would not work. You have to expand the preprocessor symbol before evaluating the <code>#if</code>. You can even use preprocessor macros in a <code>#include</code> statement, per C 2011 [N1570] 6.10.2 4."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1516827534, "creation_date": 1516827534, "answer_id": 48431479, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/48431479#48431479", "title": "Is it possible to define macro inside macro?", "body": "<p>No, this is not possible.  </p>\n\n<p>During translation, all preprocessing directives (<code>#define</code>, <code>#include</code>, etc.) are executed <em>before</em> any macro expansion occurs, so if a macro expands into a preprocessing directive, it won't be interpreted as such - it will be interpreted as (invalid) source code.  </p>\n"}, {"comments": [{"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516871017, "post_id": 48431872, "comment_id": 83869213, "body": "Hi. I try your example, but it always generate <code>if(0){ ...</code> despite on first parameter to <code>D</code>: <code>D(1, &quot;some string&quot; )</code>. Also I find interesting trick: we can preprocess sources twice: <code>gcc -E source.c | gcc -xc -</code>"}, {"owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "reply_to_user": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516919912, "post_id": 48431872, "comment_id": 83899173, "body": "This is a really nice trick!  I edited my answer, i am sorry i did&#39;t understand you wanted to use cond as a literal, i thought it was a define condition...  Now this should work."}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516964901, "post_id": 48431872, "comment_id": 83913109, "body": "yes, it should be define condition. and when <code>cond</code> is 0 no code should be generated."}], "tags": [], "owner": {"reputation": 112, "user_id": 9109930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b561e82d21f514ae2ebbb4a0d8c4f7?s=128&d=identicon&r=PG&f=1", "display_name": "ft_error", "link": "https://stackoverflow.com/users/9109930/ft-error"}, "is_accepted": false, "score": 2, "last_activity_date": 1516919784, "last_edit_date": 1516919784, "creation_date": 1516829240, "answer_id": 48431872, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/48431872#48431872", "title": "Is it possible to define macro inside macro?", "body": "<p>As pointed out by others this is not possible but there is a work around:</p>\n\n<pre><code>int YYY;\n/* global scope variables are sometimes considered bad practice... */\n#define D(cond,...) do{         \\\n  if (cond) {                   \\\n  YYY = 1;                      \\ \n  }                             \\\n  else {                        \\\n  YYY = 0;                      \\\n  }                             \\\n} while(0)\n</code></pre>\n\n<p>Use an optimizing flag (ex: <code>gcc/clang -O3</code>) and it will replace the dead code as if it was a macro. Obviously you may want to change the type of YYY but you seem to use it like a boolean.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 4, "last_activity_date": 1516842331, "last_edit_date": 1516842331, "creation_date": 1516835046, "answer_id": 48433157, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/48433157#48433157", "title": "Is it possible to define macro inside macro?", "body": "<p>No, because <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.10.3.4p3\" rel=\"nofollow noreferrer\">C 2011 [N1570] 6.10.3.4 3</a> says, about macro replacement, \u201cThe resulting completely macro-replaced preprocessing token sequence is not processed as a preprocessing directive even if it resembles one,\u2026\u201d</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4069062, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003805359297/picture?type=large", "display_name": "really", "link": "https://stackoverflow.com/users/4069062/really"}, "is_accepted": false, "score": 0, "last_activity_date": 1610063914, "creation_date": 1610063914, "answer_id": 65621631, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro/65621631#65621631", "title": "Is it possible to define macro inside macro?", "body": "<p>This is some poor man's code generation, for when integrating another tool to the project is overkill.</p>\n<p>Define a macro like this, expanding for your needs:</p>\n<pre><code>#define NESTED              /* Comment out instead of backslash new lines.\n*/                          /*\n*/  UNDEF   REPLACED        /*\n*/                          /*\n*/  IFDEF   CONDITION       /*\n*/  DEFINE  REPLACED  1     /*\n*/  ELSE                    /*\n*/  DEFINE  REPLACED  0     /*\n*/  ENDIF\n</code></pre>\n<p>Your version of <code>NESTED</code> can be a function-like macro, and <code>REPLACED</code> can have a more elaborated body.</p>\n<p>Leave <code>CONDITION</code> and the directive named macros without a definition.</p>\n<p><code>DEFINE CONDITION</code> to control which value <code>NESTED</code> gets on compilation, similarly to normal <code>#ifdef</code> usage:</p>\n<pre><code>DEFINE  CONDITION\nNESTED\nint i = REPLACED;        //i == 1\n\nUNDEF  CONDITION\nNESTED\nint z = REPLACED;        //z == 0\n</code></pre>\n<p>Source code that uses <code>NESTED</code> and the other macros  will not compile. To generate a <code>.c</code> or <code>.cpp</code> file that you can compile with your chosen options, do this:</p>\n<pre><code>gcc   -E -CC   source.c  -o temporary.c\ngcc   -E                                                  \\\n   -DDEFINE=\\#define  -DUNDEF=\\#undef                     \\\n   -DIFDEF=\\#ifdef    -DELSE=\\#else    -DENDIF=\\#endif    \\\n   temporary.c  -o usableFile.c\n\nrm temporary.c     #remove the temporary file\n</code></pre>\n<p><code>-E</code> means preprocess only, not compile. The first <code>gcc</code> command expands <code>NESTED</code> and all normally defined macros from the source. As <code>DEFINE</code>, <code>IFDEF</code>, etc. are not defined, they and their future arguments remain as literal text in the <code>temporary.c</code> file.</p>\n<p><code>-CC</code> makes the comments be preserved in the output file. After the preprocessor replaces <code>NESTED</code> by its body, <code>temporary.c</code> contains the directive macros in separate lines, with the comments. When the comments are removed on the next gcc command, the line breaks remain by the standard.</p>\n<p><code>#</code> is accepted in the body of a macro that takes no arguments. However, unlike macros, directives are not rescaned and executed on expansion, so you need another preprocessor pass to make nested defines work. All preprocessing related to the delayed defines needs to be delayed too, and made available to the preprocessor at once. Otherwise, directives and arguments needed in a later pass are consumed and removed from the code in a previous one.</p>\n<p>The second <code>gcc</code> command replaces the <code>-D</code> macros by the delayed directives, making all of them available to the preprocessor starting on the next pass. The directives and their arguments are not rescaned in the same gcc command, and remain as literal text in <code>usableFile.c</code>.</p>\n<p>When you compile <code>usableFile.c</code>, the preprocessor executes the delayed directives.</p>\n"}], "owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4115, "favorite_count": 0, "answer_count": 6, "score": 4, "last_activity_date": 1610063914, "creation_date": 1516826846, "last_edit_date": 1516872410, "question_id": 48431325, "link": "https://stackoverflow.com/questions/48431325/is-it-possible-to-define-macro-inside-macro", "title": "Is it possible to define macro inside macro?", "body": "<p>I want to use macro parameter like this:</p>\n\n<pre><code>  #define D(cond,...) do{         \\\n    #if cond                      \\\n    #define YYY 1                 \\\n    #else                         \\\n    #define YYY 0                 \\\n  } while(0)\n</code></pre>\n\n<p>Is it possible?</p>\n\n<p><strong>UPD</strong><br>\nMaybe when sources will be preprocessed twice: <code>gcc -E source.c | gcc -xc -</code> next will work:</p>\n\n<pre><code>#define D(cond,...) #define YYY cond&amp;DEBUG\n#if YYY\n#define D(...) printf( __VA_ARGS__ )\n#else\n#define D(...)\n#endif\n</code></pre>\n"}, {"tags": ["c", "arrays", "linux", "segmentation-fault", "malloc"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1516825857, "post_id": 48431065, "comment_id": 83853144, "body": "Be consistent with your own coding style, and format your code so that it&#39;s readable. Specially, when you intend to show it to others. Oh, and usually <code>for (i=0;i&lt;=size-1;i++)</code> we right it like this <code>for (i = 0; i &lt; size; i++)</code>."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1516825902, "post_id": 48431065, "comment_id": 83853165, "body": "A Segfault means that you/your program probably try to acccess a memory location which does not deserve you. Think of that."}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516840679, "post_id": 48431065, "comment_id": 83859298, "body": "I see you&#39;ve already got an answer, but I am still not clear on the problem. Your error spew seems to indicate that you did compile and run your application, but you problem statement says it did not compile.  Which is it?"}, {"owner": {"reputation": 1, "user_id": 9264122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DnluqLS5tIc/AAAAAAAAAAI/AAAAAAAABHg/fb6oYzNnf-Q/photo.jpg?sz=128", "display_name": "Nikos Nik", "link": "https://stackoverflow.com/users/9264122/nikos-nik"}, "edited": false, "score": 0, "creation_date": 1516873892, "post_id": 48431065, "comment_id": 83871016, "body": "no,no,i did not manage to compile because i had not alloc&#39;d enough space for the array of pointers(aka dict). now i am set"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9264122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DnluqLS5tIc/AAAAAAAAAAI/AAAAAAAABHg/fb6oYzNnf-Q/photo.jpg?sz=128", "display_name": "Nikos Nik", "link": "https://stackoverflow.com/users/9264122/nikos-nik"}, "edited": false, "score": 0, "creation_date": 1516826469, "post_id": 48431124, "comment_id": 83853483, "body": "oh my god, i have been looking at my code for 2 days and it was this. i thought i was lacking much more significant knowledge. you relieved me a lot. really thanks for lending me a pair of eyes on this!"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 1, "user_id": 9264122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DnluqLS5tIc/AAAAAAAAAAI/AAAAAAAABHg/fb6oYzNnf-Q/photo.jpg?sz=128", "display_name": "Nikos Nik", "link": "https://stackoverflow.com/users/9264122/nikos-nik"}, "edited": false, "score": 0, "creation_date": 1516826841, "post_id": 48431124, "comment_id": 83853654, "body": "@NikosNik You&#39;re welcome. If you use a programmer friendly operating system that has <a href=\"http://www.valgrind.org\" rel=\"nofollow noreferrer\">valgrind</a> support, you can further check your code for more problems, some of which can be very hard to find. Also, use more whitespace, <code>dict=malloc ...</code> is horrible style. The compiler can immediatly see that there are 3 &quot;<i>tokens</i>&quot; in <code>dict=malloc</code>, but humans could need a little bit more attention to notice that."}, {"owner": {"reputation": 1, "user_id": 9264122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DnluqLS5tIc/AAAAAAAAAAI/AAAAAAAABHg/fb6oYzNnf-Q/photo.jpg?sz=128", "display_name": "Nikos Nik", "link": "https://stackoverflow.com/users/9264122/nikos-nik"}, "edited": false, "score": 0, "creation_date": 1516827306, "post_id": 48431124, "comment_id": 83853874, "body": "yeah,thanks for the info. i will try to improve code&#39;s appearance. used valgrind before asking but could not reach to the solution"}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 2, "last_activity_date": 1516825966, "creation_date": 1516825966, "answer_id": 48431124, "question_id": 48431065, "link": "https://stackoverflow.com/questions/48431065/c-segmentation-fault/48431124#48431124", "title": "C-Segmentation fault", "body": "<p>You are not allocating enough space, here</p>\n\n<pre><code>dict=malloc(sum);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>dict = malloc(sum * sizeof(*dict));\n</code></pre>\n\n<p>Because you need <code>sum</code> elements of size <code>void *</code>, but it's better to write <code>sizeof(*dict)</code>, because that way the code is independent on the type of <code>dict</code>, and if you change it you don't need to fixe your <code>malloc()</code>.</p>\n\n<p>This also looks suspicious,</p>\n\n<pre><code>num_words=malloc(sum);\n</code></pre>\n\n<p>how do you know that there are as many characters for every word as lines there were in the file?</p>\n"}], "owner": {"reputation": 1, "user_id": 9264122, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DnluqLS5tIc/AAAAAAAAAAI/AAAAAAAABHg/fb6oYzNnf-Q/photo.jpg?sz=128", "display_name": "Nikos Nik", "link": "https://stackoverflow.com/users/9264122/nikos-nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 48431124, "answer_count": 1, "score": -1, "last_activity_date": 1516825966, "creation_date": 1516825719, "last_edit_date": 1516825916, "question_id": 48431065, "link": "https://stackoverflow.com/questions/48431065/c-segmentation-fault", "title": "C-Segmentation fault", "body": "<p>I am new at coding so I know i may be messing up some things. I want to create an array of (number_of_text_words)x(number_of_letters_of each_word) dimensions, where i would save the words, character by character and putting '\\0' in the end, so as to be recognised as a string. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n\n\nint main(int argc, char **argv)\n{\n    FILE *myinput;\n    int i,k,sum,words_num,j;\n    char **dict=NULL;\n    char *num_words=NULL;\n    myinput = fopen(\"bug.txt\",\"r\");\n    if (myinput == NULL)\n    {\n        fprintf(stderr, \"ERROR:\\n\");\n        return;\n    }\n    fseek(myinput,0,SEEK_END);\n    int size = ftell(myinput);\n    fseek(myinput,0,SEEK_SET);\n    char *data = malloc(size);\n    if (data==NULL)\n    return -1;\n    fread(data,size,1,myinput);\n\n\n\n    fclose(myinput);\n\n\n    sum=0;\n    for (i=0;i&lt;=size-1;i++)\n    if (data[i]=='\\n')\n    sum++;//count the words by the spaces\n\n\n    /*for (i=0;i&lt;=size-1;i++)\nprintf(\"%c\\n\",data[i]);*/\n\n    /*printf(\"\\n%d\\n\",sum);*/\n\n    dict=malloc(sum);//for saving the words\n    if (dict==NULL)\n    return -1;\n    num_words=malloc(sum);//for saving the number of letters of each word\n    if (num_words==NULL)\n    return -1;\n    j=0;\n    for (i=0;i&lt;sum;i++){\n        words_num=0;\n        while ((data[j++]!='\\n'))\n        words_num++;//allocate the exact needed memory for each word\n\n\n\n        dict[i]=malloc(words_num+1);//FOR THE FINAL '\\0'\n        if (dict[i]==NULL)\n        return -1;\n        num_words[i]=words_num;\n\n    }\n\n    k=0;\n    for (i=0;i&lt;sum;i++){\n        for(j=0;j&lt;num_words[i];j++){\n            if ((data[k]=='\\n') || (data[k]==EOF))\n            k++;\n            if (k&lt;size)\n            dict[i][j]=data[k++];\n        }\n        if (k&lt;=size)\n        dict[i][j+1]='\\0';\n    }\n\n\n\n    for (i=0;i&lt;sum;i++)\n    free(dict[i]);\n\n    free(dict);\n\n    free(num_words);\n\n    free(data);\n    return 0;\n}\n</code></pre>\n\n<p>It cannot be compiled though,as it shows me a segmentation fault. More specific, -g compiling shows me the following:</p>\n\n<blockquote>\n  <blockquote>\n    <p><strong>* Error in `./crossword': free(): invalid next size (fast): 0x0000000000fdf010 *</strong>\n    ======= Backtrace: ========= /lib/x86_64-linux-gnu/libc.so.6(+0x777e5)[0x7f7b54dc87e5]\n    /lib/x86_64-linux-gnu/libc.so.6(+0x8037a)[0x7f7b54dd137a]\n    /lib/x86_64-linux-gnu/libc.so.6(cfree+0x4c)[0x7f7b54dd553c]\n    ./crossword[0x400a97]\n    /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf0)[0x7f7b54d71830]\n    ./crossword[0x400699]\n    ======= Memory map: ======== 00400000-00401000 r-xp 00000000 08:25 532064<br>\n    /home/nikos/Desktop/ergasies/ergasia_4/crossword 00600000-00601000\n    r--p 00000000 08:25 532064<br>\n    /home/nikos/Desktop/ergasies/ergasia_4/crossword 00601000-00602000\n    rw-p 00001000 08:25 532064<br>\n    /home/nikos/Desktop/ergasies/ergasia_4/crossword 00fdf000-01000000\n    rw-p 00000000 00:00 0                                  [heap]\n    7f7b50000000-7f7b50021000 rw-p 00000000 00:00 0 \n    7f7b50021000-7f7b54000000 ---p 00000000 00:00 0 \n    7f7b54b3b000-7f7b54b51000 r-xp 00000000 08:25 529319<br>\n    /lib/x86_64-linux-gnu/libgcc_s.so.1 7f7b54b51000-7f7b54d50000 ---p\n    00016000 08:25 529319<br>\n    /lib/x86_64-linux-gnu/libgcc_s.so.1 7f7b54d50000-7f7b54d51000 rw-p\n    00015000 08:25 529319<br>\n    /lib/x86_64-linux-gnu/libgcc_s.so.1 7f7b54d51000-7f7b54f11000 r-xp\n    00000000 08:25 542663<br>\n    /lib/x86_64-linux-gnu/libc-2.23.so 7f7b54f11000-7f7b55111000 ---p\n    001c0000 08:25 542663<br>\n    /lib/x86_64-linux-gnu/libc-2.23.so 7f7b55111000-7f7b55115000 r--p\n    001c0000 08:25 542663<br>\n    /lib/x86_64-linux-gnu/libc-2.23.so 7f7b55115000-7f7b55117000 rw-p\n    001c4000 08:25 542663<br>\n    /lib/x86_64-linux-gnu/libc-2.23.so 7f7b55117000-7f7b5511b000 rw-p\n    00000000 00:00 0  7f7b5511b000-7f7b55141000 r-xp 00000000 08:25 542656\n    /lib/x86_64-linux-gnu/ld-2.23.so 7f7b55323000-7f7b55326000 rw-p\n    00000000 00:00 0  7f7b5533f000-7f7b55340000 rw-p 00000000 00:00 0 \n    7f7b55340000-7f7b55341000 r--p 00025000 08:25 542656<br>\n    /lib/x86_64-linux-gnu/ld-2.23.so 7f7b55341000-7f7b55342000 rw-p\n    00026000 08:25 542656<br>\n    /lib/x86_64-linux-gnu/ld-2.23.so 7f7b55342000-7f7b55343000 rw-p\n    00000000 00:00 0  7fff2dca9000-7fff2dcca000 rw-p 00000000 00:00 0<br>\n    [stack] 7fff2dd02000-7fff2dd05000 r--p 00000000 00:00 0<br>\n    [vvar] 7fff2dd05000-7fff2dd07000 r-xp 00000000 00:00 0<br>\n    [vdso] ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0<br>\n    [vsyscall] Aborted (core dumped)</p>\n  </blockquote>\n</blockquote>\n\n<p>i also created an array for saving each words size. I did not double freed any pointer, nor can I find any \"out-of-array' writing. Can anyone point the things that are going wrong in my code?Would really appreciate it:)</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1516825072, "post_id": 48430891, "comment_id": 83852735, "body": "Necessary? In most cases no. But it is a good habit to clean after yourself."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 2, "creation_date": 1516825214, "post_id": 48430891, "comment_id": 83852806, "body": "To add to the previous comment, imagine you use different little programs like your example together to build another bigger program / application. Or turn it somehow into a daemon that keeps running and execute your function several times. If you have not put any <code>free</code>, you could easily forgot  to add it when combining the pieces together / make it run in a loop. And now your program has severe memory leak."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1516825253, "post_id": 48430891, "comment_id": 83852828, "body": "<a href=\"https://stackoverflow.com/questions/7543630/good-practice-to-free-mallocs-at-program-conclusion?rq=1\" title=\"good practice to free mallocs at program conclusion\">stackoverflow.com/questions/7543630/&hellip;</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1516825285, "post_id": 48430891, "comment_id": 83852845, "body": "<a href=\"https://stackoverflow.com/q/5612095/13422\">stackoverflow.com/q/5612095/13422</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1516825397, "post_id": 48430891, "comment_id": 83852890, "body": "<a href=\"https://stackoverflow.com/questions/654754/what-really-happens-when-you-dont-free-after-malloc\" title=\"what really happens when you dont free after malloc\">stackoverflow.com/questions/654754/&hellip;</a>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516825717, "post_id": 48430891, "comment_id": 83853073, "body": "also understand the program you&#39;ve demonstrated is a dixie cup program,, terribly simple. What is that, 20 lines? Real software is astronomically bigger, more complex, and can run for a very long time. Think of software programs the <i>never</i> exit.. the software running your router, internet servers, or monitoring the nuclear power plant. Memory leaks in these programs can eventually exhaust the system and cause big trouble. In your example, you don&#39;t <i>have</i> to cleanup, but whatever software you write for a semester in school is a far cry from real systems. Cleaning up builds good habits."}, {"owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516825852, "post_id": 48430891, "comment_id": 83853139, "body": "@yano, of course. This was a hypothetical question about a very specific edge case; namely, where memory is allocated at the start and used throughout the entire program."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516826265, "post_id": 48430891, "comment_id": 83853360, "body": "if you&#39;re guaranteed a fixed number of allocations and those are used throughout runtime of the program (as in your example), then no, the OS will (probably, as noted below) cleanup after you. But this isn&#39;t how real software works. More than likely you&#39;re going to allocate in a loop, in response to stimuli/inputs your program receives, in response to events. The whole point of allocating memory during runtime is that you don&#39;t know you need it until then. If you know at compile time, it&#39;s best to use automatic storage (with a few exceptions)."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516838183, "post_id": 48430891, "comment_id": 83858521, "body": "@yano &#39;But this isn&#39;t how real software works&#39; well, my software must be unreal.   Allocating strut/object pools at startup is not at all unusual, and since it&#39;s not possible to detemine at any instant which thread is reading/writing from any particualr instance, and user code cannot guarantee to stop all process threads in any state, it is essential to let the OS clean up.  Trying to free such memory is user code will result in shutdown segfaults.  Despite claims to the contrary, user cleanup becomes less and less safe as app complexity increases."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516838382, "post_id": 48430891, "comment_id": 83858597, "body": "@Samadi &#39; memory is allocated at the start and used throughout the entire program&#39; - it&#39;s fine.  Carry on.  many professional apps and libraries do exactly that - it&#39;s safer than trying to do unnecessary and avoidable &#39;manual&#39; user cleanup that needs continual debugging and testing."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516839432, "post_id": 48430891, "comment_id": 83858925, "body": "@MartinJames touche with initial allocation of pools,, but if the load becomes too much and pools become exhausted additional allocation is necessary (or you deny service), which is a response to stimuli. Not sure I follow the rest, thread synchronization allows for clean shutdown among multiple threads, if you are in fact shutting down."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516840768, "post_id": 48430891, "comment_id": 83859320, "body": "@MartinJames Additionally, if you do use a pool-of-resources approach, when you take something from the pool to use, return it when you&#39;re done,, or your pool resources become exhausted. This is tantamount to <code>free</code>ing in this case. I hardly think &quot;clean up after yourself&quot; is bad advice or a foolish thing to do."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1517048298, "post_id": 48430891, "comment_id": 83942866, "body": "@yano ..but often, it is.  What is totally wrong is blanket statements/laws like &#39;It&#39;s always a good plan to clean up everything you allocate&#39;, (from accepted, +4, 138k rep user below).  It&#39;s often a very bad plan indeed, and occasionally, actually not possible.  No, using a transparent user-managed pool of objects is not tantamount to freeing.  Pool leaks are much more easily detected and fixed."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1517049294, "post_id": 48430891, "comment_id": 83943118, "body": "@MartinJames I&#39;ll have to take your word for it. I see your rep with multithreading, so you know way more than me... I ack that. In my (limited) experience, I&#39;ve never seen where it&#39;s &quot;a very bad plan&quot; to clean up after yourself. I&#39;ve always joined on my threads and deallocated resources. Sure it&#39;s extra code (that I&#39;ve had to debug!), but coding isn&#39;t easy. Relying on the OS to cleanup doesn&#39;t sound robust to me. I&#39;d be willing to bet there are OS&#39;es out there that don&#39;t cleanup,,, but I don&#39;t know... VxWorks comes to mind."}], "answers": [{"comments": [{"owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "edited": false, "score": 1, "creation_date": 1516825673, "post_id": 48430951, "comment_id": 83853038, "body": "Good point about checking for errors from <code>fread</code>. That was just an example though, rather than actual code."}, {"owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "edited": false, "score": 0, "creation_date": 1516825709, "post_id": 48430951, "comment_id": 83853067, "body": "Which environments wouldn&#39;t clean up allocations after program exit?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1516825767, "post_id": 48430951, "comment_id": 83853102, "body": "take AmigaOS for instance. It doesn&#39;t have resource tracking. If you don&#39;t free the memory, you don&#39;t get it until you reboot (with ctrl+A+A :))"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516825788, "post_id": 48430951, "comment_id": 83853113, "body": "It depends on the operating system and the runtime context. If you&#39;re writing kernel code, for example, nothing is ever freed unless you do it explicitly. If your module gets unloaded without cleaning up those allocations stay around forever. Embedded systems also have this problem where there runtime can&#39;t spare resources for a proper memory manager so every process <i>must</i> clean up after itself."}, {"owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "edited": false, "score": 1, "creation_date": 1516825916, "post_id": 48430951, "comment_id": 83853170, "body": "Fantastic, thanks for the extra detail!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1516826013, "post_id": 48430951, "comment_id": 83853220, "body": "another reason: if one day you&#39;re turning your main into a service/endless loop, you&#39;ll be glad that you handled the frees properly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1516826134, "post_id": 48430951, "comment_id": 83853277, "body": "@Jean-Fran&#231;oisFabre That&#39;s a good point. Non-trivial programs don&#39;t do allocations in the <code>main</code> function, it&#39;s always in some other function, and unless that function cleans up properly it&#39;ll leak."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1516826202, "post_id": 48430951, "comment_id": 83853320, "body": "that&#39;s why I make a useless loop on my program. Run it 5000 times and see if memory increases."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1516826425, "post_id": 48430951, "comment_id": 83853454, "body": "@Jean-Fran&#231;oisFabre Or use valgrind <code>--leak-kinds=all</code> if your operating system supports it."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1516826661, "post_id": 48430951, "comment_id": 83853572, "body": "I&#39;m using windows. I have to guess the leaks. &quot;I don&#39;t use debuggers, I stare at the code until it confesses (Chuck Norris)&quot;"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1517048501, "post_id": 48430951, "comment_id": 83942901, "body": "You forgot to mention the downsides which, for non-trivial, (esp. multithreaded), apps, usually massively outweigh some irrational fear of &#39;outstanding allocations just prior to your exit you have a leak&#39;."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 4, "last_activity_date": 1516826378, "last_edit_date": 1516826378, "creation_date": 1516825257, "answer_id": 48430951, "question_id": 48430891, "link": "https://stackoverflow.com/questions/48430891/should-you-free-at-the-end-of-a-c-program/48430951#48430951", "title": "Should you free at the end of a C program", "body": "<p>Actually, as in absolutely? On a modern operating system, no. In <em>some</em> environments, yes.</p>\n\n<p>It's always a good plan to clean up everything you allocate as this makes it very easy to scan for memory leaks. If you have outstanding allocations just prior to your exit you have a leak. If you don't <code>free</code> things because the OS does it for you then you don't know if it's a mistake or intended behaviour.</p>\n\n<p>You're also <em>supposed</em> to check for errors from any function that might return them, like <code>fread</code>, but you don't, so you're already firmly in the danger zone here. Is this mission critical code where if it crashes Bad Things happen? If so you'll want to do everything absolutely by the book.</p>\n\n<p>As Jean-Fran\u00e7ois pointed out the way this trivial code is composed is  a bad example. Most programs will look more like this:</p>\n\n<pre><code>void do_stuff_with_buf(char* arg) {\n  long buflen = atol(arg);\n  char *buf = malloc(buflen);\n  fread(buf, 1, buflen, stdin);\n\n  // Do stuff with buf\n\n  free(buf);\n}\n\nint main(int argc, char *argv[]) {\n  if (argc &lt; 2)\n    return 1;\n\n  do_stuff_with_buf(argv[1])\n\n  return 0;\n}\n</code></pre>\n\n<p>Here it should be more obvious that the <code>do_stuff_with_buf</code> function should clean up for itself, it can't depend on the program exiting to release resources. If that function was called multiple times you shouldn't leak memory, that's just sloppy and can cause serious problems. A run-away allocation can cause things like the infamous Linux \"OOM killer\" to show up and go on a murder spree to free up some memory, something that usually leads to nothing but chaos and confusion.</p>\n"}], "owner": {"reputation": 1321, "user_id": 2422432, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d4d98d22353178cf1266cb450edb957?s=128&d=identicon&r=PG", "display_name": "vktec", "link": "https://stackoverflow.com/users/2422432/vktec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "closed_date": 1516834455, "accepted_answer_id": 48430951, "answer_count": 1, "score": 0, "last_activity_date": 1516826378, "creation_date": 1516824986, "question_id": 48430891, "link": "https://stackoverflow.com/questions/48430891/should-you-free-at-the-end-of-a-c-program", "closed_reason": "Duplicate", "title": "Should you free at the end of a C program", "body": "<p>Suppose I have a program like the following</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n  if (argc &lt; 2) return 1;\n  long buflen = atol(argv[1]);\n  char *buf = malloc(buflen);\n  fread(buf, 1, buflen, stdin);\n\n  // Do stuff with buf\n\n  free(buf);\n  return 0;\n}\n</code></pre>\n\n<p>Programs like these typically have more complex cleanup code, often including several calls to <code>free</code> and sometimes labels or even cleanup functions for error handling.</p>\n\n<p>My question is this: Is the <code>free(buf)</code> at the end <em>actually necessary</em>? My understanding is that the kernel will automatically clean up unfreed memory when the program exits, but if this is the case, why is putting free at the end of code such a common pattern?</p>\n\n<p>BusyBox provides a compilation option to disable calling free at the end of execution. If this isn't an issue, then why would anyone disable that option? Is it purely because programs like Valgrind detect memory leaks when allocated memory isn't freed?</p>\n"}, {"tags": ["c", "memory", "memory-management", "malloc"], "comments": [{"owner": {"reputation": 2287, "user_id": 3303064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3510c433a8fc7fdac2c042420f13ab01?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Himada", "link": "https://stackoverflow.com/users/3303064/omar-himada"}, "edited": false, "score": 0, "creation_date": 1516824458, "post_id": 48430740, "comment_id": 83852429, "body": "Why do you want to allocate that much memory, though? Also are you using a 64-bit compiler or 32-bit?"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516824506, "post_id": 48430740, "comment_id": 83852450, "body": "<code>if(!val) break;</code> Who taught you that?? You don&#39;t even have a loop!"}, {"owner": {"reputation": 324, "user_id": 1695548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41fc8005b8001b4a4940bbad76be0d09?s=128&d=identicon&r=PG&f=1", "display_name": "tom", "link": "https://stackoverflow.com/users/1695548/tom"}, "edited": false, "score": 0, "creation_date": 1516824549, "post_id": 48430740, "comment_id": 83852468, "body": "Well malloc() will give you the amount of memory you ask for (until you get a kernel panick or the OS refuses your request). Your question doesn&#39;t make much sense."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1516824557, "post_id": 48430740, "comment_id": 83852473, "body": "Can you show the code that actually fails?"}, {"owner": {"reputation": 43, "user_id": 8517575, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a8eb832fe17bd6efe16d660106febc99?s=128&d=identicon&r=PG&f=1", "display_name": "zDoes", "link": "https://stackoverflow.com/users/8517575/zdoes"}, "reply_to_user": {"reputation": 2287, "user_id": 3303064, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3510c433a8fc7fdac2c042420f13ab01?s=128&d=identicon&r=PG&f=1", "display_name": "Omar Himada", "link": "https://stackoverflow.com/users/3303064/omar-himada"}, "edited": false, "score": 0, "creation_date": 1516824774, "post_id": 48430740, "comment_id": 83852588, "body": "@Adosi i\u2019ve tried with a 32-but one, btw is just a test..."}, {"owner": {"reputation": 43, "user_id": 8517575, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a8eb832fe17bd6efe16d660106febc99?s=128&d=identicon&r=PG&f=1", "display_name": "zDoes", "link": "https://stackoverflow.com/users/8517575/zdoes"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516825144, "post_id": 48430740, "comment_id": 83852768, "body": "@hyde it doesn\u2019t actually fail...it\u2019s just stop at 1900mb (as the Task Manager said)."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1516826286, "post_id": 48430740, "comment_id": 83853374, "body": "Just because Task Manager says the process has 1900MB of memory doesn&#39;t necessarily mean it can&#39;t get more.  That&#39;s just what it currently has mapped to that process.  As the process actually writes to that memory, the usage will increase.  Try using <code>calloc</code> instead which zeros out memory when it&#39;s allocated."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516841819, "post_id": 48430740, "comment_id": 83859573, "body": "On 32-bit machines (with 4-byte pointers, or where you set <code>INTERNAL_SIZE_T</code> to 4-bytes on 64-bit machines), <code>malloc</code> is limited to <code>2^32</code> bytes. (more or less), see: <a href=\"http://code.metager.de/source/xref/gnu/glibc/malloc/malloc.c\" rel=\"nofollow noreferrer\">libc malloc source code</a>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516844098, "post_id": 48430740, "comment_id": 83860147, "body": "this is really a windows question"}], "answers": [{"comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 43, "user_id": 8517575, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a8eb832fe17bd6efe16d660106febc99?s=128&d=identicon&r=PG&f=1", "display_name": "zDoes", "link": "https://stackoverflow.com/users/8517575/zdoes"}, "edited": false, "score": 0, "creation_date": 1516825434, "post_id": 48430789, "comment_id": 83852903, "body": "@zDoes.: I am not sure how much you can mmanipulate. But this is hardly required."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 0, "last_activity_date": 1516825992, "last_edit_date": 1516825992, "creation_date": 1516824489, "answer_id": 48430789, "question_id": 48430740, "link": "https://stackoverflow.com/questions/48430740/why-does-a-malloc-of-2gb-or-larger-of-memory-in-the-heap-in-c-fail/48430789#48430789", "title": "Why does a malloc of 2GB or larger of memory in the Heap in C fail?", "body": "<p>The pages allocated to your process is doesn't constitute the whole RAM. What do you think? The whole user program will not be allowed to access full RAM. The OS decided how much virtual memory your process will be allocated and then the program starts.  That is why you didn't show using the full RAM of your machine.</p>\n\n<p>Long story short - your program is not given the whole RAM for use. If it did - then it would trigger a whole bigger problem than you think it is posing now. Also your idea of <code>malloc</code> use is not clear. When it is <code>NULL</code> which is returned by <code>malloc</code> it mostly calls for an error condition. Your code somehow abstracts those accept and introduce a redundant dummy <code>if</code> block which does nothing. </p>\n\n<p>As a user program you will request memory - and in case it fails then it will return <code>NULL</code> and handle the condition accordingly. </p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 0, "last_activity_date": 1516843041, "last_edit_date": 1516843041, "creation_date": 1516827418, "answer_id": 48431459, "question_id": 48430740, "link": "https://stackoverflow.com/questions/48430740/why-does-a-malloc-of-2gb-or-larger-of-memory-in-the-heap-in-c-fail/48431459#48431459", "title": "Why does a malloc of 2GB or larger of memory in the Heap in C fail?", "body": "<p><code>malloc()</code> is a C and C++ run time function that is part of the Standard Library. The memory addressing capabilities depends on what compiler is being used as well as the build settings for that compiler.</p>\n\n<p>I did the following test with Windows 7 x64 using Microsoft Visual 2013 with C++, when I am using the 32 bit build target settings (x86), then when I try to use <code>malloc()</code> to allocate a 4GB block of memory, <code>malloc()</code> returns a NULL pointer indicating the allocation failed.</p>\n\n<p>This is expected because with Windows 32 bit OS, the maximum amount of RAM that can be addressed is a 32 bit pointer but in reality less than 4GB, somewhere around 3.5 GB of usable RAM I think due to way that Windows 32 manages physical memory.</p>\n\n<p>Testing with two other sizes, 2GB (failed with a NULL pointer returned) and 1GB (succeeded with a valid pointer returned) indicates that the maximum that the 32 bit C++ run time allows is somewhere between 1GB and 2GB.</p>\n\n<p>Then I changed the build settings from x86 to x64 to generate a 64 bit executable with 64 bit pointers.</p>\n\n<p>With the change in build settings a call to <code>malloc()</code> with 4GB succeeded with a valid pointer returned.</p>\n\n<p>Task Manager shows the following:\n<a href=\"https://i.stack.imgur.com/z9nEF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z9nEF.png\" alt=\"screen shot of task manager showing memory usage\"></a></p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/15606429/how-can-i-allocate-all-the-availble-memory-in-visual-studio-for-my-application\">StackOverFlow How can I allocate all the availble memory in visual studio for my application?\n</a> with the accepted answer that mentions the following:</p>\n\n<blockquote>\n  <p>Getting a larger virtual memory address space requires a pretty\n  fundamental overhaul. Albeit that it is easy today, just target x64 as\n  the platform target. A 64-bit process has massive amounts of address\n  space available, limited only by the maximum size of the paging file.\n  You could limp along in 32-bit mode, as long as you can count on\n  actually running on a 64-bit operating system, by using the\n  /LARGEADDRESSAWARE linker option. Which increases the VM size from 2\n  GB to 4 GB on a 64-bit operating system.</p>\n</blockquote>\n"}], "owner": {"reputation": 43, "user_id": 8517575, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a8eb832fe17bd6efe16d660106febc99?s=128&d=identicon&r=PG&f=1", "display_name": "zDoes", "link": "https://stackoverflow.com/users/8517575/zdoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1254, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516843041, "creation_date": 1516824216, "last_edit_date": 1516832508, "question_id": 48430740, "link": "https://stackoverflow.com/questions/48430740/why-does-a-malloc-of-2gb-or-larger-of-memory-in-the-heap-in-c-fail", "title": "Why does a malloc of 2GB or larger of memory in the Heap in C fail?", "body": "<p>I want to allocate a specific size of memory on the C heap. As a test to do it I used the following piece of code (to check the maximum allowable value):</p>\n\n<pre><code>int main(void) {\n   int *val;\n   val=(int*)malloc(4096);\n   if(!val)\n      break;\n   return 0;\n}\n</code></pre>\n\n<p>The problem is that when trying a range of values with <code>malloc()</code>, at about a size of 1900MB it fails. Yet I have 16 GB of installed RAM with about 12GB free.</p>\n\n<p>So I can't even think to allocate a higher value of memory.<br>\nIs there something that I'm doing wrong?<br>\nIs there something that I should know about <code>malloc()</code>?  </p>\n\n<p>I see many programs(like Virtual Machines)that use big amount of memory so i already ruled out the idea that is a security features of the OS.</p>\n"}, {"tags": ["c", "pointers", "null", "malloc"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 2, "creation_date": 1516824239, "post_id": 48430717, "comment_id": 83852315, "body": "<code>while(!feof(fp))</code> is always wrong."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516824317, "post_id": 48430717, "comment_id": 83852366, "body": "Could you please create a minimal, complete and verifiable example?"}, {"owner": {"reputation": 1472, "user_id": 6942918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EzNAX.png?s=128&g=1", "display_name": "kyriakosSt", "link": "https://stackoverflow.com/users/6942918/kyriakosst"}, "edited": false, "score": 0, "creation_date": 1516824426, "post_id": 48430717, "comment_id": 83852418, "body": "please edit to also include in which line the error appears"}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 5590506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266444bfab93b6b67d9530fd84153c75?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Hunter", "link": "https://stackoverflow.com/users/5590506/logan-hunter"}, "reply_to_user": {"reputation": 19, "user_id": 9264063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0103e64622cb6da91e419aa0bcb87d79?s=128&d=identicon&r=PG&f=1", "display_name": "pepe", "link": "https://stackoverflow.com/users/9264063/pepe"}, "edited": false, "score": 0, "creation_date": 1516832595, "post_id": 48430809, "comment_id": 83856540, "body": "@pepe You&#39;re welcome, glad to help - feel free to accept my answer then :)"}], "tags": [], "owner": {"reputation": 377, "user_id": 5590506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/266444bfab93b6b67d9530fd84153c75?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Hunter", "link": "https://stackoverflow.com/users/5590506/logan-hunter"}, "is_accepted": true, "score": 0, "last_activity_date": 1516824602, "creation_date": 1516824602, "answer_id": 48430809, "question_id": 48430717, "link": "https://stackoverflow.com/questions/48430717/error-assignment-makes-integer-from-pointer-without-a-cast-array-null/48430809#48430809", "title": "Error &quot;assignment makes integer from pointer without a cast array = NULL&quot;", "body": "<p>The reason you are getting that error is the line <code>carray[m] = NULL</code>. NULL seems to be defined as <code>((void*)0)</code>, not just <code>0</code>, so the compiler has correctly recognized that you are assigning a pointer (<code>NULL</code>) to an integer value (<code>carray[m]</code>) which is a <code>char</code>. Change the line to <code>carray[m] = 0</code> instead and that particular error should go away.</p>\n"}], "owner": {"reputation": 19, "user_id": 9264063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0103e64622cb6da91e419aa0bcb87d79?s=128&d=identicon&r=PG&f=1", "display_name": "pepe", "link": "https://stackoverflow.com/users/9264063/pepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 48430809, "answer_count": 1, "score": 0, "last_activity_date": 1516824891, "creation_date": 1516824116, "last_edit_date": 1516824891, "question_id": 48430717, "link": "https://stackoverflow.com/questions/48430717/error-assignment-makes-integer-from-pointer-without-a-cast-array-null", "title": "Error &quot;assignment makes integer from pointer without a cast array = NULL&quot;", "body": "<p>When I compile my project I get the error (\"assignment makes integer from pointer without a cast array = NULL\"). I don't understand why it works in the if statement and not in the else statement. </p>\n\n<pre><code>    FILE *fp;\nint i,j,m,n;\nchar citemp;\n\nif (!(fp = fopen(trainingsInputFile, \"r\"))) {\n    perror(\"Datei konnte nicht gelesen werden\");\n}\nelse {\n    i = 0;\n    j = 0;\n    n = 0;\n    char *carray = (char*)malloc(sizeof(char) * 20);\n    while (!feof(fp)) {            \n        citemp = getc(fp);\n\n        if(citemp != ';'){                \n            if(citemp != ','){ \n                carray[j] = citemp;\n                j++;                       \n            }else{                    \n                trainingsInputArray[n][i] = atof(carray);\n                for(m = 0; m &lt; j; m++){\n                    carray[m] = NULL;\n                }\n                j = 0;\n                i++;\n            }\n        }else{\n            n++;\n            i = 0;\n        }\n    }\n}\nfclose(fp);\n</code></pre>\n\n<p>Error:\nenvironment.c:21: warning: assignment makes integer from pointer without a cast [-Wint-conversion]\n                         carray[m] = NULL;</p>\n"}, {"tags": ["c", "arrays", "recursion", "binary"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1516822121, "post_id": 48430096, "comment_id": 83851062, "body": "A segmentation fault means that you&#39;re trying to access an array with an index that is out of bounds. Check the value of <code>mid</code> in your debugger."}, {"owner": {"reputation": 7052, "user_id": 3854570, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d7bda3cab79b9bc5570667f8c0e24134?s=128&d=identicon&r=PG&f=1", "display_name": "Nelfeal", "link": "https://stackoverflow.com/users/3854570/nelfeal"}, "edited": false, "score": 0, "creation_date": 1516822123, "post_id": 48430096, "comment_id": 83851063, "body": "Is <code>end</code> the index of the last element or one past it?"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1516822780, "last_edit_date": 1516822780, "creation_date": 1516822124, "answer_id": 48430220, "question_id": 48430096, "link": "https://stackoverflow.com/questions/48430096/why-does-this-code-returns-segmentation-fault-when-i-try-to-use-binary-search-to/48430220#48430220", "title": "Why does this code returns segmentation fault when I try to use binary search to count the number of occurrences of a number in an array recursively?", "body": "<p>The strange part of this code is you never checked whether <code>start &lt;= end</code> or not. How will this program terminate? At some point your program will branch into calling the function with improper parameters. Add a check to it. Apparently this is a major flaw in the code. What happens when you access array indices out of bound? It is undefined behavior. This is what you faced.(In your case segmentation fault).</p>\n"}], "owner": {"reputation": 29, "user_id": 9183341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f92812324e9c8d92ee3ef57d5c84f26a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohanish Manker", "link": "https://stackoverflow.com/users/9183341/mohanish-manker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516822780, "creation_date": 1516821629, "question_id": 48430096, "link": "https://stackoverflow.com/questions/48430096/why-does-this-code-returns-segmentation-fault-when-i-try-to-use-binary-search-to", "title": "Why does this code returns segmentation fault when I try to use binary search to count the number of occurrences of a number in an array recursively?", "body": "<pre><code>  int countOccurences(int *array, int start, int end, int n)\n   {\n    int count=0,mid;\n    mid=(start+end)/2;\n    if(start==end &amp;&amp; array[mid]!=n)\n        return count;\n    if(array[mid]==n)\n        return count+countOccurences(array,mid+1,end,n)+countOccurences(array,start,mid-1,n);\n    else if(array[mid]&gt;n)\n        return countOccurences(array,start,mid-1,n);\n    else if(array[mid]&lt;n)\n        return countOccurences(array,mid+1,end,n);\n    return count;\n}\n</code></pre>\n\n<p>I'm getting correct results for the item that does not belong to the list but my code returns segmentation fault for the items that exists in my array. Where am I going wrong?</p>\n"}, {"tags": ["c", "command-line-arguments"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1516821564, "post_id": 48429761, "comment_id": 83850748, "body": "You&#39;re going to need an argument to <code>A</code> that indicates that the rest of arguments should be forwarded to <code>B</code>. According to the man page for <code>getopt</code>, a double dash <code>--</code> on the command line will cause <code>getopt</code> to signal the end of argument processing."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1516823033, "creation_date": 1516823033, "answer_id": 48430469, "question_id": 48429761, "link": "https://stackoverflow.com/questions/48429761/how-to-allow-getopt-and-get-long-opt-to-handle-arbitrary-arguments-too-without-e/48430469#48430469", "title": "How to allow getopt and get_long_opt to handle arbitrary arguments too without emitting error?", "body": "<p>In general, the problem is extremely tricky, even intractable unless you set some ground rules for how your program is to be used.</p>\n\n<p>You can suppress the automatic messages by setting <code>opterr = 0;</code> before you call your option parser.  That, unfortunately, is the easy part.</p>\n\n<p>Suppose you're given a command line:</p>\n\n<pre><code>wrapper_program -baxt cantaloupe -d designator\n</code></pre>\n\n<p>Further, suppose that neither <code>-b</code> nor <code>-d</code> is an option to the wrapper program.  The difficulty is now determining whether the <code>-b</code> option takes an argument (in which case the argument is <code>axt</code>) or it does not. If <code>-b</code> doesn't take an argument, there are extra options starting with <code>-a</code> \u2014 but does that take an argument (which would be <code>xt</code>) or is the <code>x</code> also an option? And if <code>x</code> is an option, does that take an argument (which would be the <code>t</code>) or is the <code>t</code> an option too \u2014 and does that take an argument (which would be <code>cantaloupe</code>).  If the first argument <code>-baxt</code> has an option with an argument attached, then do you want the <code>cantaloupe</code> option to end the argument parsing, or should the code do GNU-style argument permutation?  If it should do argument permutation, does the <code>-d</code> option take an argument (<code>designator</code>) or is that a non-option argument?</p>\n\n<p>You can set ground rules to sort this sort of thing out, but you have to think hard and code carefully \u2014 and test thoroughly.  It is probably easier if you know whether the wrapped program takes long or short arguments.</p>\n\n<p>You might find it better to demand that options for the wrapped program follow a double-dash:</p>\n\n<pre><code>wrapper_program -w wrapper-argument -- -b=axt -d designator cantaloupe\n</code></pre>\n\n<p>The idea is that the arguments to the wrapper program precede the <code>--</code> and the arguments to the wrapped program follow it.  This gives a clean, clear separation between the two sets of arguments.</p>\n\n<p>An alternative is to have a 'pass-through' option (the C compilers often support this with notations such as <code>-Wl,-arg-for-linker</code>).  For example, the <code>-p</code> option might take an argument which will be passed verbatim to the wrapped program:</p>\n\n<pre><code>wrapper_program -w wrapper-argument -p -b=axt -p -d -p designator cantaloupe\n</code></pre>\n\n<p>The <code>-p</code> options specify that the following argument should be passed to the wrapped program.</p>\n\n<p>Using the <code>-b=axt</code> notation implies the use of <code>getopt_long()</code> rather than <code>getopt()</code>, though if <code>-b</code> takes an argument then the <code>=axt</code> option will be treated as the argument by <code>getopt()</code> whereas <code>getopt_long()</code> would, AFAIK, treat <code>axt</code> as the argument.</p>\n\n<p>Be cautious about such designs.  They're neither easy to write nor necessarily easy to use.</p>\n"}], "owner": {"reputation": 4387, "user_id": 582782, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d59b4e0d3fc4d5036ff05c66218f6c7a?s=128&d=identicon&r=PG", "display_name": "sramij", "link": "https://stackoverflow.com/users/582782/sramij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 48430469, "answer_count": 1, "score": 1, "last_activity_date": 1516823157, "creation_date": 1516820292, "last_edit_date": 1516823157, "question_id": 48429761, "link": "https://stackoverflow.com/questions/48429761/how-to-allow-getopt-and-get-long-opt-to-handle-arbitrary-arguments-too-without-e", "title": "How to allow getopt and get_long_opt to handle arbitrary arguments too without emitting error?", "body": "<p>I am writing a program A which on it's turn invokes arbitrary program B.\nWhen invoking A, some arguments are required by A while some others should be redirected to B, but they are unknown for A.</p>\n\n<p>How can I get A collect those arguments passed to it, however unrecognized\n, into a dictionary maybe. So far, every time I use:</p>\n\n<pre><code>getopt_long_only(argc, argv, \"...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>getopt(argc, argv, \"...\n</code></pre>\n\n<p>I am getting errors emitted for \"unrecognized option\" or \"illegal option\". And those are indeed unrecognized for A, but I want A to ignore that, do you think this is doable?</p>\n"}, {"tags": ["c", "file", "loops"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1516818639, "post_id": 48429307, "comment_id": 83849236, "body": "possibly relevant: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 1057, "user_id": 4255698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e5e4d9d4b65eef49186ebc94f26c34?s=128&d=identicon&r=PG", "display_name": "Roberto Trani", "link": "https://stackoverflow.com/users/4255698/roberto-trani"}, "edited": false, "score": 1, "creation_date": 1516818767, "post_id": 48429307, "comment_id": 83849307, "body": "where do you check the null character &#39;\\0&#39; ? If your last line doesn&#39;t contain a &#39;\\n&#39; the while loop goes over.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 0, "creation_date": 1516818776, "post_id": 48429307, "comment_id": 83849310, "body": "ok so its wrong to use, but how do I use that with fgets?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "reply_to_user": {"reputation": 1057, "user_id": 4255698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20e5e4d9d4b65eef49186ebc94f26c34?s=128&d=identicon&r=PG", "display_name": "Roberto Trani", "link": "https://stackoverflow.com/users/4255698/roberto-trani"}, "edited": false, "score": 0, "creation_date": 1516818856, "post_id": 48429307, "comment_id": 83849348, "body": "@Roberto Trani I read from a file, I made a function that knows how to decipher the string, the problem is its doing 1 more loop then needed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516818911, "post_id": 48429307, "comment_id": 83849374, "body": "Why does code not check the return value of <code>fgets()</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516818987, "post_id": 48429307, "comment_id": 83849418, "body": "@chux how exactly? while(fgets()!=EOF)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516819106, "post_id": 48429307, "comment_id": 83849483, "body": "Who or what text suggested <code>while (fgets()!=EOF)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 0, "creation_date": 1516819178, "post_id": 48429307, "comment_id": 83849533, "body": "then how do you check the value of fgets ? because its a pointer , and impossible to check like the duplicated question you suggested."}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516819203, "post_id": 48429307, "comment_id": 83849550, "body": "Something like <code>if (!fgets()) break;</code>"}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516819432, "post_id": 48429307, "comment_id": 83849663, "body": "But actually <code>while (fgets()) { ... }</code> would indeed probably be better, see the currently 4th answer in the duplicate question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "reply_to_user": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516819472, "post_id": 48429307, "comment_id": 83849676, "body": "@Ove actualy no, now my first line is gone"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 0, "creation_date": 1516819684, "post_id": 48429307, "comment_id": 83849784, "body": "if I do while(fgets()) my first line is gone, instead of the extra one."}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516819829, "post_id": 48429307, "comment_id": 83849854, "body": "Maybe your rewrite isn&#39;t right and you&#39;re making two loops instead of the one you should? Show your revised code if you&#39;re still having issues."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "reply_to_user": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516820005, "post_id": 48429307, "comment_id": 83849932, "body": "@Ove I edited the post and added the rewritten code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "edited": false, "score": 1, "creation_date": 1516820048, "post_id": 48429307, "comment_id": 83849960, "body": "ohh I see the issue. I did 2 fgets.. thats why... stupid me"}], "owner": {"user_type": "does_not_exist", "display_name": "user7847469"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1516818792, "answer_count": 0, "score": 1, "last_activity_date": 1516819974, "creation_date": 1516818557, "last_edit_date": 1516819974, "question_id": 48429307, "link": "https://stackoverflow.com/questions/48429307/my-loop-is-executing-more-times-then-expected", "closed_reason": "Duplicate", "title": "My loop is executing more times then expected", "body": "<p>Hi I wrote a function that inputs a string from a file and then prints out the answer, now my loop is executing more then the file has lines:\nthis is my code :</p>\n\n<pre><code>    void CalculateAll()\n{\n    char str[SIZE];\n    int ans;\n\n    FILE* p = fopen(\"Expressions.txt\", \"r\");\n    if (p == NULL)\n    {\n        printf(\"FAIL\");\n        return;\n    }\n    while (!feof(p))\n    {\n        int i = 0;\n        fgets(str, SIZE - 1, p);\n        while (str[i] != '\\n')i++;\n        str[i] = 0;\n\n        ans = CalculateExpression(str);\n        printf(\"%d\\n\", ans);\n    }\n\n\n}\n</code></pre>\n\n<p>the file has</p>\n\n<pre><code>121 + 34 =\n562 + 45 =\n100 / 10 =\n</code></pre>\n\n<p>the output should be </p>\n\n<pre><code>155 \n607 \n10\n</code></pre>\n\n<p>but instead I get :</p>\n\n<pre><code>155\n607 \n10\n10\n</code></pre>\n\n<p>and my loop is running again even tho I reached the end of the file, does anyone have an idea?\nEDIT: its not the same question..</p>\n\n<p>When I changed my code to this my first line is gone :</p>\n\n<pre><code>void CalculateAll()\n{\n    char str[SIZE];\n    int ans;\n\n    FILE* p = fopen(\"Expressions.txt\", \"r\");\n    if (p == NULL)\n    {\n        printf(\"FAIL\");\n        return;\n    }\n    while ((fgets(str, SIZE - 1, p)))\n    {\n\n        int i = 0;\n        fgets(str, SIZE - 1, p);\n        while (str[i] != '\\n')i++;\n        str[i] = 0;\n\n        ans = CalculateExpression(str);\n        printf(\"%d\\n\", ans);\n    }\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516817541, "post_id": 48429022, "comment_id": 83848644, "body": "<i>Since xpt is an array pointers  (I assume)</i> - <code>xpt</code> is a pointer to array of 9 <code>int</code>s. Don&#39;t assume, but find the docs and verify."}, {"owner": {"reputation": 1079, "user_id": 3601445, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/166972946a381e8641b7dd4de8a874a9?s=128&d=identicon&r=PG&f=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/3601445/unhandled-exception"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516818089, "post_id": 48429022, "comment_id": 83848940, "body": "I have yet to find a single reference that does a very good job explaining pointers in various scenarios. Usually I have to find various links and piece together an explanation. If you have reference to a URL which does a good job, please post."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516818141, "post_id": 48429022, "comment_id": 83848968, "body": "For this specific issue you can use <a href=\"https://cdecl.org/?q=int+%28%2Axpt%29%5B9%5D\" rel=\"nofollow noreferrer\">cdecl</a>. It is reading the docs for you :) But there is so-called <a href=\"http://c-faq.com/decl/spiral.anderson.html\" rel=\"nofollow noreferrer\">Spiral Rule</a>"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516818341, "post_id": 48429056, "comment_id": 83849080, "body": "in fact your declaration of xpt was a clue - you did <code>int (*xpt)[9] = &amp;x;</code> for the same reason, except the compiler complained when you tried <code>int *xpt[9] = &amp;x;</code>"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516818409, "post_id": 48429056, "comment_id": 83849114, "body": "@pm100.: i am still editing - including this too...Please give me some time."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516818724, "post_id": 48429056, "comment_id": 83849281, "body": "@pm100.: check please"}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 5, "last_activity_date": 1516819812, "last_edit_date": 1516819812, "creation_date": 1516817628, "answer_id": 48429056, "question_id": 48429022, "link": "https://stackoverflow.com/questions/48429022/array-pointer-not-returned-the-expected-value/48429056#48429056", "title": "Array Pointer not returned the expected value", "body": "<p>It should be <code>(*xpt)[0]</code> to get the array elements. Otherwise you are having undefined behavior here. Because you are accessing some memory that will be out of the bound or that you shouldn't/ or you don't have permission to.</p>\n\n<p>Also don't be suprised by <code>xpt[0][0]</code> that is equivalently what I said above.</p>\n\n<p>The reason is - <code>*xpt[1]</code> is dereferencing a memory that is not even pointing to any elements of the array. This is undefined behavior.</p>\n\n<pre><code>123456789XXXXXXXXXX\n^        ^\n|        |\nxpt[0]   xpt[1]\n</code></pre>\n\n<p>Here <code>1234....</code> denotes the elements of the array and <code>xpt[1]</code> points to out of the array. </p>\n\n<p>Also array subscripts (<code>[]</code>) has higher precedence than dereference(<code>*</code>). As a result when you write <code>*xpt[1]</code> it will first calculate <code>xpt[1]</code> and then try to get it's value, which is causing undefined behavior in your program.</p>\n\n<p>Also to give you a better intuitive idea about how to understand this -\n Pointers operations are dictated by what it points to. Here when you declared </p>\n\n<pre><code>int (*xpt)[9] = &amp;x;\n</code></pre>\n\n<p>it is saying that <code>xpt</code> is a pointer to an <code>int</code> array of 9 elements. Now you initialize with the address of <code>x</code>. Now think what it points to ? It is the array object <code>x</code>. So what will it point to if we do this <code>xpt[1]</code>? Next array object (if any). So that's why we get to the address first and then dereference it to get to the array <code>(*xpt)</code> and now use array subscript to get the correct elements.</p>\n\n<pre><code>int* xpt = &amp;x\n</code></pre>\n\n<p>is something compiler will complain about. It is assigning type <code>int(*)[9]</code> to <code>int*</code> - this is wrong. The type matters for pointers - that's why compiler will complain.</p>\n\n<p>One more interesting thing you may ask why <code>*xpt[0]</code> is <code>11</code> not <code>22</code> or <code>33</code> etc?</p>\n\n<p>The thing is <code>xpt[0]</code> is the array to which <code>xpt</code> was pointing to. The array <code>xpt[0]</code> converts (decays) into pointer to <em>first</em> element (<code>xpt[0][0]</code>) of the array(<code>xpt[0]</code>), and then you dereferenced (<code>*xpt[0]</code>)it. That's why you got the first element of the array as the value.</p>\n"}], "owner": {"reputation": 1079, "user_id": 3601445, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/166972946a381e8641b7dd4de8a874a9?s=128&d=identicon&r=PG&f=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/3601445/unhandled-exception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 48429056, "answer_count": 1, "score": 3, "last_activity_date": 1516819812, "creation_date": 1516817469, "question_id": 48429022, "link": "https://stackoverflow.com/questions/48429022/array-pointer-not-returned-the-expected-value", "title": "Array Pointer not returned the expected value", "body": "<p>Per a different thread I learned that using '&amp;' with an array doesn't return a double pointer but rather a pointer array. </p>\n\n<pre><code>int x[9] = {11, 22,33,44,55,66,77,88,99};\nint (*xpt)[9] = &amp;x;    &lt;---This is the focus of this thread.\n</code></pre>\n\n<p>The following code compiles and executes. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main () \n{\n    int x[9] = {11, 22,33,44,55,66,77,88,99};\n    int (*xpt)[9] = &amp;x;\n\n    printf(\"xpt[0] = %d\\n\", xpt[0]);\n    printf(\"xpt[0][0] = %d\\n\", xpt[0][0]);\n    printf(\"xpt[0][1] = %d\\n\", xpt[0][1]);\n    printf(\"*xpt[0] = %d\\n\", *xpt[0]);\n    printf(\"*xpt[1] = %d\\n\", *xpt[1]);\n\n   return 0;\n}\n</code></pre>\n\n<p>Here is the output. </p>\n\n<pre><code>&gt; ./runThis\nxpt[0] = 155709776\nxpt[0][0] = 11\nxpt[0][1] = 22\n*xpt[0] = 11\n*xpt[1] = 32766\n</code></pre>\n\n<p>The questions pertain to the output.\nSince xpt is an array pointers (I assume) <strong>xpt[0]</strong> is simply displaying the address of the first value 11. </p>\n\n<p>I was a bit surprised that the following 2 lines worked. </p>\n\n<pre><code>  xpt[0][0] = 11\n  xpt[0][1] = 22\n</code></pre>\n\n<p>After thinking about it, it almost makes sense as I was thinking <strong>xpt[0]</strong> and <strong>*xpt</strong> could be used interchangeably until the following two lines disproved that :</p>\n\n<pre><code>  *xpt[0] = 11\n  *xpt[1] = 32766\n</code></pre>\n\n<p>Why does <strong>*xpt[0]</strong> return the expected value but not <strong>*xpt[1]</strong>?</p>\n"}, {"tags": ["c", "file", "extract", "store"], "comments": [{"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 1, "creation_date": 1516815029, "post_id": 48428395, "comment_id": 83847219, "body": "just because you want something &quot;not in C++&quot; doesnt make the C++ tag relevant"}], "answers": [{"comments": [{"owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "edited": false, "score": 3, "creation_date": 1516815828, "post_id": 48428593, "comment_id": 83847669, "body": "Create a structure that contains a tag and the union. The tag can be an enumeration that describes what is in the union."}, {"owner": {"reputation": 19, "user_id": 3927163, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f788d93b3fa7b31a8df46d27aaa624f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mirel", "link": "https://stackoverflow.com/users/3927163/mirel"}, "edited": false, "score": 0, "creation_date": 1516816673, "post_id": 48428593, "comment_id": 83848167, "body": "Thank you. But how exactly should i parse the content of .txt file with that format?  My idea was to have one big array of chars and store each element from file that is separated by space. And the using the ASCII code i would transform the characters to numbers and add it in a vector of doubles but i wasnt successful with this Can you post an actual example of parsing from this format of .txt file as you think?"}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 1, "last_activity_date": 1516815633, "creation_date": 1516815633, "answer_id": 48428593, "question_id": 48428395, "link": "https://stackoverflow.com/questions/48428395/store-multiple-types-of-data-from-file/48428593#48428593", "title": "Store multiple types of data from file", "body": "<blockquote>\n  <p>Is there any way to create a vector of multiple types(in C,not in C++)</p>\n</blockquote>\n\n<p>This seems like a good use of a union. You can define it as</p>\n\n<pre><code>union data {\n    float f;\n    int i;\n    char n;\n};\n</code></pre>\n\n<p>Now declare an array of unions:</p>\n\n<pre><code>union data V[20];\n</code></pre>\n\n<p>And populate it like so:</p>\n\n<pre><code> V[0].i=0\n V[1].f=0.3\n V[2].i=-1\n V[3].i=3\n V[4].i=12\n v[5].n='N'\n</code></pre>\n\n<p>In the parsing logic, you will need to decide which field of the union to use in order to ensure the correct value is stored as you intend.</p>\n"}, {"comments": [{"owner": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "edited": false, "score": 0, "creation_date": 1516816039, "post_id": 48428644, "comment_id": 83847779, "body": "If we combine your structure and Code-Apprentice&#39;s union, then that should be the optimal solution to this problem..right?"}, {"owner": {"reputation": 2735, "user_id": 446252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3fWRI.jpg?s=128&g=1", "display_name": "Adam Trhon", "link": "https://stackoverflow.com/users/446252/adam-trhon"}, "reply_to_user": {"reputation": 1458, "user_id": 3643303, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/sIpdl.jpg?s=128&g=1", "display_name": "Amber Beriwal", "link": "https://stackoverflow.com/users/3643303/amber-beriwal"}, "edited": false, "score": 1, "creation_date": 1516816277, "post_id": 48428644, "comment_id": 83847925, "body": "@AmberBeriwal yes; but this looks like a beginner question, and I advice against using unions by beginners (they bite)."}, {"owner": {"reputation": 19, "user_id": 3927163, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f788d93b3fa7b31a8df46d27aaa624f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mirel", "link": "https://stackoverflow.com/users/3927163/mirel"}, "edited": false, "score": 0, "creation_date": 1516816679, "post_id": 48428644, "comment_id": 83848175, "body": "Thank you. But how exactly should i parse the content of .txt file with that format?  My idea was to have one big array of chars and store each element from file that is separated by space. And the using the ASCII code i would transform the characters to numbers and add it in a vector of doubles but i wasnt successful with this Can you post an actual example of parsing from this format of .txt file as you think?"}], "tags": [], "owner": {"reputation": 2735, "user_id": 446252, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/3fWRI.jpg?s=128&g=1", "display_name": "Adam Trhon", "link": "https://stackoverflow.com/users/446252/adam-trhon"}, "is_accepted": false, "score": 2, "last_activity_date": 1516824688, "last_edit_date": 1516824688, "creation_date": 1516815844, "answer_id": 48428644, "question_id": 48428395, "link": "https://stackoverflow.com/questions/48428395/store-multiple-types-of-data-from-file/48428644#48428644", "title": "Store multiple types of data from file", "body": "<p>Rule #1: Avoid premature optimization.</p>\n\n<p>Define a type of your data:</p>\n\n<pre><code>enum data_type {\n    data_type_integer = 0,\n    data_type_float,\n    data_type_char,\n    ...\n};\n</code></pre>\n\n<p>Now define structure to contain these data:</p>\n\n<pre><code>struct data {\n    enum data_type data_type;\n    int data_integer;\n    float data_float;\n    char data_char;\n};\n</code></pre>\n\n<p>Of course this wastes some space, but unless you write a db engine or something, remember rule #1. If it really bothers you, pack the data (not <code>data_type</code>) into union. But if you make a mistake with union, it will bite you (as the compiler cannot check that, for example, you stored <code>char</code> and read <code>int</code>).</p>\n\n<p>Now you have a single type to store various data types.</p>\n\n<p>To parse it, there are various approaches. I suggest to read each item as a string and then parse the string using sscanf. The reason for this two-step approach is that you can check the string contents to determine the type: If it contains 'N', it's 'N'. If it contains 'e', 'E' or '.' it is float, etc.</p>\n"}], "owner": {"reputation": 19, "user_id": 3927163, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f788d93b3fa7b31a8df46d27aaa624f2?s=128&d=identicon&r=PG&f=1", "display_name": "Mirel", "link": "https://stackoverflow.com/users/3927163/mirel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516824688, "creation_date": 1516814962, "last_edit_date": 1516815815, "question_id": 48428395, "link": "https://stackoverflow.com/questions/48428395/store-multiple-types-of-data-from-file", "title": "Store multiple types of data from file", "body": "<p>Can someone help me with the following request:</p>\n\n<p>I have a file with only one line that contains the following groups separated by a space</p>\n\n<ul>\n<li>real numbers            </li>\n<li>integer numbers            </li>\n<li>hexadecimal numbers            </li>\n<li>the character 'N'</li>\n</ul>\n\n<p>Here are some examples:</p>\n\n<pre><code>    0 0.3 -1 +3 0xc 'N'\n\n    2.12211 1 -100 'N' 0xac 'N'\n</code></pre>\n\n<p>Basically the first line might contain real numbers,integer numbers,hexadecimal numbers, the character 'N' and each group is separated by a space</p>\n\n<p>Is there any way to create a vector of multiple types(in C,not in C++) that will contain the elements separated by spaces(also the hexadecimal numbers should be converted to decimal numbers?</p>\n\n<p>For the first example it shall be </p>\n\n<pre><code> V[0]=0\n V[1]=0.3\n V[2]=-1\n V[3]=3\n V[4]=12\n v[5]='N'\n</code></pre>\n\n<p>For the second example it shall be </p>\n\n<pre><code>V[0]=2.12211   \nV[1]=1\nV[2]=-100\nV[3]=3\nV[4]='N'\nv[5]=172\nV[6]='N'\n</code></pre>\n"}, {"tags": ["c", "arduino"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1516814286, "post_id": 48428144, "comment_id": 83846734, "body": "Looks like a homework dump.  I recommend trying this exercise yourself.  You might learn something."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1516814350, "post_id": 48428144, "comment_id": 83846783, "body": "By checking is most significant bit is 1?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1516814401, "post_id": 48428144, "comment_id": 83846823, "body": "Clarify: you say in the title that you can only use Boolean operators, but then you list bitwise operators as acceptable?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516814492, "post_id": 48428144, "comment_id": 83846863, "body": "@MarkBenningfield Logical and bitwise operations are not the same, right? The op might have misused the &quot;Boolean&quot; name."}, {"owner": {"reputation": 613, "user_id": 3112926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33809c5d0f78b110e8613c9e5972dd5?s=128&d=identicon&r=PG&f=1", "display_name": "JGroven", "link": "https://stackoverflow.com/users/3112926/jgroven"}, "edited": false, "score": 0, "creation_date": 1516814769, "post_id": 48428144, "comment_id": 83847040, "body": "does the &quot;less than&quot; operator count as a boolean operator here?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516814896, "post_id": 48428144, "comment_id": 83847128, "body": "@EugeneSh.: Yeah, I&#39;m trying to figure out if Boolean relational operators are allowed with Boolean logical operators, or what. Or, should we disregard the title, and just assume the list?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516824805, "post_id": 48428144, "comment_id": 83852599, "body": "In C, and with <code>int a</code>,  <code>a &gt;&gt; b</code>  is not `&quot;Right shift (c = a &gt;&gt; b), c is a, with each bit moved lower b places.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 3, "last_activity_date": 1516819893, "last_edit_date": 1516819893, "creation_date": 1516819575, "answer_id": 48429595, "question_id": 48428144, "link": "https://stackoverflow.com/questions/48428144/how-do-i-know-if-a-number-is-negative-in-binary-using-only-boolean-operators/48429595#48429595", "title": "How do I know if a number is negative in binary using only boolean operators?", "body": "<p>Given the assignment, I presume we are merely intended to test the high bit, perhaps assuming <code>int</code> is two\u2019s complement. I also assume we cannot use <code>INT_MIN</code> or similar information (such as <code>sizeof int</code>) to know where the sign bit of an <code>int</code> is.</p>\n\n<p>If we are allowed to use <code>unsigned</code>, then we can ascertain the high bit with <code>unsigned H = -1u ^ -1u &gt;&gt; 1;</code>. (This works because <code>-1u</code> is an <code>unsigned</code> value with all bits set, <code>-1u &gt;&gt; 1</code> has all but the high bit set, and XORing them leaves just the high bit set.)</p>\n\n<p>After that, <code>num &amp; H</code> is non-zero if and only if the high bit in <code>num</code> is set. So we can return <code>!!(num &amp; H)</code>.</p>\n\n<p>If we cannot use <code>unsigned</code> (perhaps the assignment is to write code that works for any signed integer type, not just <code>int</code>), then I expect the assignment is impossible using only the listed operators. To see this:</p>\n\n<ul>\n<li><p>All of the bitwise operators (<code>&amp;</code>, <code>|</code>, <code>^</code>, and <code>~</code>) operate on each bit independently, in parallel, and so they do not distinguish the high bit in any way and hence cannot be used to single out the high bit.</p></li>\n<li><p>The logical operators (<code>&amp;&amp;</code> and <code>||</code>) and <code>!</code> operate on all bits condensed to a single bit. Again, they do not distinguish the high bit in any way and hence cannot be used to single out the high bit.</p></li>\n<li><p>Thus, we are left with <code>&lt;&lt;</code> and <code>&gt;&gt;</code>. These do distinguish the high and low bits, as they are boundaries for shifting bits in or out. However, if a number is negative, shifting it left is undefined, and shifting it right is implementation-defined. So we cannot write strictly conforming C code that shifts a value that we do not know is negative or not.</p></li>\n<li><p>We could use the bitwise operators to clear various bits to produce a number we can safely shift, but, since those cannot distinguish the high bit, we cannot know when they have cleared the high bit to make the number safe for shifting. And we cannot generally know when they have <strong>not</strong> cleared the high bit (for example, we cannot write code that clears all bits but the high bit because, if we do not know where the high bit is, we do not know where the second highest is either).</p></li>\n</ul>\n\n<p>Therefore, from the operations listed, there is none we can perform on a negative number to test its high bit.</p>\n"}], "owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1516822212, "creation_date": 1516814098, "question_id": 48428144, "link": "https://stackoverflow.com/questions/48428144/how-do-i-know-if-a-number-is-negative-in-binary-using-only-boolean-operators", "title": "How do I know if a number is negative in binary using only boolean operators?", "body": "<p>I have to write code using only boolean operators such as follows to write code for a method that returns true or false if the number is negative or positive:</p>\n\n<pre><code>Bitwise AND (c = a &amp; b), c has 1s in the places where both of the \ncorresponding bits in a and b are 1.\nBitwise OR (c = a | b), c has 1s wherever at least one of the \ncorresponding bits in a and b is 1.\nBitwise XOR (c = a ^ b), c has 1s wherever one and only one of the \ncorresponding bits in a and b is 1.\nBitwise NOT (c = ~a), c is a with each bit inverted.\nRight shift (c = a &gt;&gt; b), c is a, with each bit moved lower b places.\nLeft shift (c = a &lt;&lt; b), c is a, with each bit moved higher b places.\nBoolean AND (c = a &amp;&amp; b), c is 1 if both a and b are non-zero.\nBoolean OR (c = a || b), c is 1 if either a and b are non-zero.\nBoolean NOT (c = !a), c is 1 only if a is 0.\n</code></pre>\n\n<p>I have to finish this:</p>\n\n<pre><code>int isNegativeInt(int num) {\n  // something goes here\n  return num;\n}\n</code></pre>\n\n<p>it should return 1 if true, that means num is a negative number\nit should return 0 if false, that means num is a positive number</p>\n\n<p>and I have to do the same thing for what's below:</p>\n\n<pre><code>int isNegativeLong(long num) {\n  // something goes here\n  return num;\n}\n\nint isNegativeChar(char num) {\n   // something goes here\n  return num;\n}\n</code></pre>\n\n<p>Any ideas? Anything would help, thanks!</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516813508, "post_id": 48427905, "comment_id": 83846250, "body": "Will that be literal &quot;1&quot; and literal &quot;2&quot; or any placeholders evaluating to 1 or 2?"}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516813634, "post_id": 48427905, "comment_id": 83846314, "body": "@Yunnosch: It maybe <code>3</code> which means <code>0b11</code> and print both messages"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516813941, "post_id": 48427905, "comment_id": 83846523, "body": "Still not clear. Will it be a literally <code>1</code> or <code>2</code> or <code>3</code> or it will be a variable/expression having this value?"}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516814379, "post_id": 48427905, "comment_id": 83846802, "body": "@EugeneSh.: We can provide flags: <code>D( DUMP_thing1 | DUMP_thing2 )</code>. where <code>DUMP_thing1 is 0b01</code> and <code>DUMP_thing2 is 0b10</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516814406, "post_id": 48427905, "comment_id": 83846828, "body": "@EugenKonkov Then it won&#39;t be possible in compile time."}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516814549, "post_id": 48427905, "comment_id": 83846892, "body": "@EugeneSh.: It&#39;s possible, but one has to write an exhaustive list of combinations, which is far beyond unwieldy. See clebanc&#39;s answer below for a start."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1516814617, "post_id": 48427905, "comment_id": 83846937, "body": "@Deduplicator I have written a similar answer to the one clebanc did and left it as a draft until the clarification above. Clearly this is not what the OP would really want."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1516814638, "post_id": 48427905, "comment_id": 83846950, "body": "I would recommend using incremental logging levels (info, warn, debug, error, ...) rather than <code>or&#39;ing</code> them together"}, {"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516815052, "post_id": 48427905, "comment_id": 83847234, "body": "@EugeneSh.: May you please post example for literal case?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516815084, "post_id": 48427905, "comment_id": 83847256, "body": "@EugenKonkov  cleblanc already did."}], "answers": [{"comments": [{"owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 0, "creation_date": 1516814486, "post_id": 48428169, "comment_id": 83846859, "body": "Interesting, but I do not want macros which expand to code"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "reply_to_user": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "edited": false, "score": 1, "creation_date": 1516814775, "post_id": 48428169, "comment_id": 83847046, "body": "@EugenKonkov: If you really insist on evaluating it at compile-time, then the first argument to <code>D()</code> <i>must</i> be a decimal literal, and you have to write code for every theretic combination of flags, in clebanc&#39;s style. That&#39;s ridiculously far beyond unwieldy, but it <i>can</i> be done. Consider writing a program to write those out for you to save your sanity."}], "tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": true, "score": 2, "last_activity_date": 1516814155, "creation_date": 1516814155, "answer_id": 48428169, "question_id": 48427905, "link": "https://stackoverflow.com/questions/48427905/how-to-define-macro-bases-on-macro-value/48428169#48428169", "title": "How to define macro bases on macro value?", "body": "<p>Well, it won't be truely evaluated at preprocessing time, but if the type is a compile-time-constant, still at compile-type.</p>\n\n<pre><code>#define D(type, ...) (void)((type &amp; DEBUG) &amp;&amp; fprintf(stderr, __VA_ARGS__))\n</code></pre>\n\n<p>The above needs at least C99 though.</p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516814998, "post_id": 48428202, "comment_id": 83847203, "body": "And if this approach is taken, there is no need in numbers at all. Just use some descriptive names."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 1, "last_activity_date": 1516814257, "creation_date": 1516814257, "answer_id": 48428202, "question_id": 48427905, "link": "https://stackoverflow.com/questions/48427905/how-to-define-macro-bases-on-macro-value/48428202#48428202", "title": "How to define macro bases on macro value?", "body": "<p>You can do it like this;</p>\n\n<pre><code>#if defined DEBUG  \n#  define P1(...) \n#  define P2(...) printf(__VA_ARGS__)\n#  define D(n, ...) P##n(__VA_ARGS__)\n#else\n#  define D(...)\n#endif\n\nmain()\n{\n    D(1, \"Test\");\n    D(2, \"Test2\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1516871717, "creation_date": 1516871717, "answer_id": 48439268, "question_id": 48427905, "link": "https://stackoverflow.com/questions/48427905/how-to-define-macro-bases-on-macro-value/48439268#48439268", "title": "How to define macro bases on macro value?", "body": "<p>This did not resolve the problem but take me closer. Maybe it will be useful for someone:</p>\n\n<pre><code>#define _CAT(a, ...) a ## __VA_ARGS__\n\n#define CHECK(...) SECOND(__VA_ARGS__, 0)\n#define SECOND(x, n, ...) n\n\n#define _NOT_0 _TRUE()\n#define _TRUE() ~, 1\n\n#define BOOL(x) NOT(NOT(x))\n#define NOT(x) CHECK(_CAT(_NOT_, x))\n\n#define IF(cond) _IF(BOOL(cond))\n#define _IF(cond) _CAT(_IF_, cond)\n#define _IF_1(...) __VA_ARGS__\n#define _IF_0(...)\n\nIF(1)(printf(\"YES\\n\");)\nIF(0)(printf(\"NO\\n\");)\n</code></pre>\n\n<p>Links to tricks: <a href=\"https://github.com/pfultz2/Cloak/wiki/C-Preprocessor-tricks,-tips,-and-idioms\" rel=\"nofollow noreferrer\">first</a> and <a href=\"http://jhnet.co.uk/articles/cpp_magic\" rel=\"nofollow noreferrer\">second</a>. Second link is more interesting because it describes what is coming on step-by-step</p>\n"}], "owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 48428169, "answer_count": 3, "score": 0, "last_activity_date": 1516871717, "creation_date": 1516813294, "last_edit_date": 1516813855, "question_id": 48427905, "link": "https://stackoverflow.com/questions/48427905/how-to-define-macro-bases-on-macro-value", "title": "How to define macro bases on macro value?", "body": "<p>I have macros:</p>\n\n<pre><code>#if defined DEBUG  &amp;&amp;  DEBUG\n#  define D(...) printf(__VA_ARGS__)\n#else\n#  define D(...)\n#endif\n</code></pre>\n\n<p>Which effectively do nothing when <code>DEBUG</code> has <code>TRUE</code> value.</p>\n\n<p>But now I want to provide the <code>TYPE</code> thing. Which will show the type of debugging:</p>\n\n<pre><code>D( 1, \"some string\" );\nD( 2, \"another thing\" );\n</code></pre>\n\n<p>Is there a way to define such macros which will do nothing for <code>D(1,..)</code> and print debug messages for <code>D(2,...)</code> when <code>DEBUG</code> is <code>2</code> and viceversa when <code>1</code>?</p>\n\n<p>I wanna something like this::</p>\n\n<pre><code>#if defined DEBUG  &amp;&amp;  DEBUG\n#  define D(type,...) if DEBUG&amp;type THEN printf(__VA_ARGS__) else do nothing\n#else\n#  define D(...)\n#endif\n</code></pre>\n"}, {"tags": ["c", "string", "file"], "comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1516813237, "post_id": 48427788, "comment_id": 83846068, "body": "this is a problem that needs to be solved with debugging first. Try to debug it and then come back if you are stuck."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 2, "creation_date": 1516813263, "post_id": 48427788, "comment_id": 83846089, "body": "and try and create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> next time"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1516813310, "post_id": 48427788, "comment_id": 83846119, "body": "also this code is crawling with compiler warnings, fix those first. ` test[j] == &#39;\\0&#39;;` for 1"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1516816973, "post_id": 48427788, "comment_id": 83848327, "body": "Please <a href=\"https://stackoverflow.com/posts/48427788/edit\">edit</a> your question to show us what kind of debugging you&#39;ve done.  I expect you to have run your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> within Valgrind or a similar checker, and to have investigated with a debugger such as GDB, for example.  Ensure you&#39;ve enabled a full set of compiler warnings, too.  What did the tools tell you, and what information are they missing?  And read Eric Lippert&#39;s <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a>."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8641595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527b3ac4de37b51fd160dcdc36aeb482?s=128&d=identicon&r=PG&f=1", "display_name": "Reddy90", "link": "https://stackoverflow.com/users/8641595/reddy90"}, "edited": false, "score": 0, "creation_date": 1516813550, "post_id": 48427936, "comment_id": 83846268, "body": "Wow, literally spent 30 min for that. Thank you and it didnt show up as a complier warning on Dev C++"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 79, "user_id": 8641595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527b3ac4de37b51fd160dcdc36aeb482?s=128&d=identicon&r=PG&f=1", "display_name": "Reddy90", "link": "https://stackoverflow.com/users/8641595/reddy90"}, "edited": false, "score": 0, "creation_date": 1516813616, "post_id": 48427936, "comment_id": 83846301, "body": "try cranking up the warning levels (or use a better compiler)"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 79, "user_id": 8641595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527b3ac4de37b51fd160dcdc36aeb482?s=128&d=identicon&r=PG&f=1", "display_name": "Reddy90", "link": "https://stackoverflow.com/users/8641595/reddy90"}, "edited": false, "score": 2, "creation_date": 1516813912, "post_id": 48427936, "comment_id": 83846499, "body": "@Reddy90 : Dev-C++ is not a compiler it is an IDE, and the warning shown will only be given with the warning options specified in the answer - though possibly not even then in the GCC version shipped with Dev-C++.  Even then the problem could be solved with better coding style and a debugger - not calling the function in the <code>if</code> and inspecting its return value in the debugger for example - you would then see that <code>strcmp()</code> worked, and the problem was with the if."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1516814877, "post_id": 48427936, "comment_id": 83847114, "body": "You should be using <b>Orwell Dev-C++</b> and not the (obsolete) older version. <a href=\"http://orwelldevcpp.blogspot.com/\" rel=\"nofollow noreferrer\">orwelldevcpp.blogspot.com</a>"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 1, "last_activity_date": 1516813561, "last_edit_date": 1516813561, "creation_date": 1516813381, "answer_id": 48427936, "question_id": 48427788, "link": "https://stackoverflow.com/questions/48427788/stuck-with-comparing-strings-in-c/48427936#48427936", "title": "Stuck with comparing Strings in C", "body": "<p>Take the <code>;</code> off. <strong>Don't ignore compiler warnings!</strong></p>\n\n<pre><code>prog.c:70:17: warning: this \u2018if\u2019 clause does not guard... [-Wmisleading-indentation]\n                     if(strcmp(soundex(s,test),soundex(b,str)) == 0);\n\n\nif(strcmp(soundex(s,test),soundex(b,str)) == 0)\n</code></pre>\n\n<p>also</p>\n\n<pre><code>prog.c: In function \u2018search\u2019:\nprog.c:68:25: warning: statement with no effect [-Wunused-value]\n                 test[j] == '\\0';\n</code></pre>\n\n<p>and</p>\n\n<pre><code>prog.c: In function \u2018main\u2019:\nprog.c:89:9: warning: implicit declaration of function \u2018gets\u2019 [-Wimplicit-function-declaration]\n         gets(a);\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8641595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/527b3ac4de37b51fd160dcdc36aeb482?s=128&d=identicon&r=PG&f=1", "display_name": "Reddy90", "link": "https://stackoverflow.com/users/8641595/reddy90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1516816992, "accepted_answer_id": 48427936, "answer_count": 1, "score": -3, "last_activity_date": 1516813561, "creation_date": 1516812921, "last_edit_date": 1516813371, "question_id": 48427788, "link": "https://stackoverflow.com/questions/48427788/stuck-with-comparing-strings-in-c", "closed_reason": "Not suitable for this site", "title": "Stuck with comparing Strings in C", "body": "<p>So im supposed to write a Soundex Converter code and print the lines from a file  if one of its words has the same Soundex code as the input. I successfully wrote a function for the Soundex conversion but im stuck at the comparing part. Sorry if this sounds trivial but when i compare the words line by line, strcmp seems to fail everytime. Here's the code... Sorry if its too long</p>\n\n<pre><code>    #include&lt;string.h&gt;\n    #include&lt;ctype.h&gt;\n    #include&lt;stdio.h&gt;\n    #include&lt;stdlib.h&gt;\n\n    char *soundex(char *s,char* name)\n    {\n        int si = 1;\n        char c;\n        //char *s = (char *)malloc(1000);\n        //                 ABCDEFGHIJKLMNOPQRSTUVWXYZ\n        char mappings[] = \"01230120022455012623010202\";\n\n        s[0] = toupper(name[0]);\n\n        for(int i = 1, l = strlen(name); i &lt; l; i++)\n        {\n            c = toupper(name[i]) - 65;\n\n            if(c &gt;= 0 &amp;&amp; c &lt;= 25)\n            {\n                if(mappings[c] != '0')\n                {\n                    if(mappings[c] != s[si-1])\n                    {\n                        s[si] = mappings[c];\n                        si++;\n                    }\n\n                    if(si &gt; 3)\n                    {\n                        break;\n                    }\n                }\n            }\n        }\n\n        if(si &lt;= 3)\n        {\n            while(si &lt;= 3)\n            {\n                s[si] = '0';\n                si++;\n            }\n        }\n\n        //printf(\"%s\\n\",s);\n        return s;\n\n    }\n\n    void search(char line[10000],char str[1000])\n    {   \n        int i,j=0;\n        char test[1000];\n        char s[1000];\n        char b[1000];\n        for(i=0;line[i] != '\\0';i++)\n        {   \n            if(line[i] == ' ')\n            continue;\n\n            test[j] = line[i];\n            j++;\n            if(line[i+1] == ' ' || line[i+1] == '\\0')\n            {\n                //soundex(test);\n                test[j] = '\\0';\n\n                if(strcmp(soundex(s,test),soundex(b,str)) == 0);\n                {\n                    printf(\"%s\\n\",soundex(s,test));\n                    printf(\"%s\\n\",soundex(b,str));\n                    printf(\"%s\",line);\n                    break;\n                }\n                j = 0;\n                memset(test,0,strlen(test));\n            }\n\n        }\n    }\n\n    int main()\n    {\n\n        char a[1000],f[1000];\n        char s[1000];\n        gets(a);\n        //soundex(s,a);\n        //printf(\"%s\",s);\n\n        scanf(\"%s\",f);\n        FILE *fp=fopen(f,\"r\");\n        if(fp==NULL)\n        {\n            printf(\"File doesnot exist bro\");\n        }\n        else\n        {\n            long long linenum=1;\n            char line[10000];\n            while(fgets(line,10000,fp)!=NULL) //Or fscanf\n            {\n                search(line,a);\n                //printf(\"%s\",line);\n                linenum++;\n            }\n        }\n\n        fclose(fp);\n     }\n</code></pre>\n\n<p>The Problem is arising with the strcmp command in the Search function as it prints the lines even after the results differ. I even print the results of the comparison afterwards to be sure. Any leads would be aprreciated. Again sorry for the long code.</p>\n"}, {"tags": ["c", "string", "shared-memory", "arrayofstring"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516811646, "post_id": 48427036, "comment_id": 83844984, "body": "<code>memset(&amp;((*d).msgs[i][0]), 0, strlen(d-&gt;msgs[i]));</code> - what would <code>strlen(d-&gt;msgs[i])</code> be here, given <code>d-&gt;msgs[i]</code> is uninitialized (or you don&#39;t show any initialization code here)?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516812488, "post_id": 48427036, "comment_id": 83845551, "body": "what is <code>bufsize</code>?  We cannot reproduce the problem from the posted code snippets.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813002, "post_id": 48427036, "comment_id": 83845914, "body": "regarding: <code>(*d).stat[i]=-1;         printf(&quot; message for me %d  %d %s\\n&quot;,mysocket,d-&gt;stat[i],d-&gt;msgs[i]);</code>  the field <code>(*d).stat[i]</code> is set to -1, so that is what is output for the third parameter of the call to <code>printf()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813133, "post_id": 48427036, "comment_id": 83846002, "body": "regarding: <code>printf(&quot; message for me %d  %d %s\\n&quot;,mysocket,d-&gt;stat[i],d-&gt;msgs[i]);         fflush(stdout);</code>  because the last item in the format string is <code>\\n</code>, which flushes <code>stdout</code>, the call to <code>fflush()</code> has no effect and can be removed."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813451, "post_id": 48427036, "comment_id": 83846208, "body": "one obvious problem is that the field <code>mysocket</code> contains -1.  when printing the info.  I.E. The source of the problem is NOT in the posted code.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3, "user_id": 4091650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Nyk-NYf2c/AAAAAAAAAAI/AAAAAAAAAN4/VHuXITftijA/photo.jpg?sz=128", "display_name": "Ashwin Bhoyar", "link": "https://stackoverflow.com/users/4091650/ashwin-bhoyar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516813554, "post_id": 48427036, "comment_id": 83846270, "body": "@EugeneSh.  thanks that was the issue. i hardcoded it now to its full value of 1024.  it maybe taking some garbage. You can post it as the answer i will accept."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813559, "post_id": 48427036, "comment_id": 83846273, "body": "in general, this: <code>d-&gt;stat[i]</code> is much easier to follow than <code>(*d).stat[i]</code>  Strongly suggest picking one format and sticking with it."}, {"owner": {"reputation": 3, "user_id": 4091650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Nyk-NYf2c/AAAAAAAAAAI/AAAAAAAAAN4/VHuXITftijA/photo.jpg?sz=128", "display_name": "Ashwin Bhoyar", "link": "https://stackoverflow.com/users/4091650/ashwin-bhoyar"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813601, "post_id": 48427036, "comment_id": 83846293, "body": "@user3629249 i will try to upload it on github or somewhere"}, {"owner": {"reputation": 3, "user_id": 4091650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Nyk-NYf2c/AAAAAAAAAAI/AAAAAAAAAN4/VHuXITftijA/photo.jpg?sz=128", "display_name": "Ashwin Bhoyar", "link": "https://stackoverflow.com/users/4091650/ashwin-bhoyar"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813629, "post_id": 48427036, "comment_id": 83846311, "body": "@user3629249 thanks for the feedbacks it would really improve the coding style and reduce my errors in future"}], "owner": {"reputation": 3, "user_id": 4091650, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-49Nyk-NYf2c/AAAAAAAAAAI/AAAAAAAAAN4/VHuXITftijA/photo.jpg?sz=128", "display_name": "Ashwin Bhoyar", "link": "https://stackoverflow.com/users/4091650/ashwin-bhoyar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516810608, "creation_date": 1516810608, "question_id": 48427036, "link": "https://stackoverflow.com/questions/48427036/string-in-shared-memory-becoming-blank", "title": "string in shared memory becoming blank", "body": "<p>I have created an array of strings in struct and it is shared.</p>\n\n<p>the struct is as following :</p>\n\n<pre><code>struct data{\n    int uids[5];\n    int sockids[5];\n    int stat[30];\n    char msgs[30][1024];\n};\n</code></pre>\n\n<p>this is the writing part and i can see the string on printf.</p>\n\n<pre><code>for (int i = 0; i &lt; bufSize; i++) {\n    if ((*d).stat[i] == -1) {\n        (*d).stat[i] = sockid;\n        memset(&amp;((*d).msgs[i][0]), 0, strlen(d-&gt;msgs[i]));\n        strncpy((*d).msgs[i], buf,1023);\n        printf(\"\\nwriting for me %d %s\\n\",sockid,d-&gt;msgs[i]);\n        return 1;\n    }\n}\n</code></pre>\n\n<p>for reading from the same area :</p>\n\n<pre><code>for(int i=0;i&lt;bufSize;i++){\n    if((*d).stat[i]==mysocket){\n        (*d).stat[i]=-1;\n        printf(\" message for me %d  %d %s\\n\",mysocket,d-&gt;stat[i],d-&gt;msgs[i]);\n        fflush(stdout);\n        send(mysocket,(*d).msgs[i],strlen((*d).msgs[i]),0);\n        memset(&amp;((*d).msgs[i][0]), 0, strlen(d-&gt;msgs[i]));\n    }\n}\n</code></pre>\n\n<p>in the reading part i get blank sometimes...</p>\n\n<p>sample output.. :</p>\n\n<p>writing for me 6 36753 : sending some message</p>\n\n<p>message for me 6  -1 </p>\n\n<p>sometimes the message comes and sometimes its blank.\nCan anyone please point out what is the error.</p>\n"}, {"tags": ["c", "function", "floating-point", "average"], "comments": [{"owner": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516810867, "post_id": 48426920, "comment_id": 83844427, "body": "Oh you know what this might be the solution. I can&#39;t do it at the moment but no I do not have that prototype."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 3, "creation_date": 1516811952, "post_id": 48426920, "comment_id": 83845181, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1267869/how-can-i-force-division-to-be-floating-point-division-keeps-rounding-down-to-0\">How can I force division to be floating point? Division keeps rounding down to 0</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1516813054, "post_id": 48426920, "comment_id": 83845941, "body": "Compiler warnings, enable them, look at them."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813751, "post_id": 48426920, "comment_id": 83846385, "body": "the signature for the function <code>main()</code> always has the return type <code>int</code>, (regardless of what visual studio allows)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516813821, "post_id": 48426920, "comment_id": 83846445, "body": "the posted code does not compile!  Amongst other things, the necessary header file(s) are not included."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516814298, "post_id": 48426920, "comment_id": 83846749, "body": "for ease of readability and understanding: 1) consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516814390, "post_id": 48426920, "comment_id": 83846814, "body": "When compiling, always enable the warnings, then fix those warnings.  (for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )"}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516810560, "post_id": 48426943, "comment_id": 83844194, "body": "I think <code>1f</code> would be a syntax error. At least on some compilers I used the <code>f</code> suffix is still requiring a decimal point."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516810607, "post_id": 48426943, "comment_id": 83844228, "body": "@EugeneSh: I wonder what the C standard says: let&#39;s wait for some downvotes."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516810661, "post_id": 48426943, "comment_id": 83844267, "body": "@EugeneSh.: Would be worth it if this answer is incorrect. I&#39;ll check for sure later."}, {"owner": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "edited": false, "score": 0, "creation_date": 1516810715, "post_id": 48426943, "comment_id": 83844305, "body": "So why does it give me the answer &quot;4.0000&quot; instead of stripping the answer of its decimal values?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "edited": false, "score": 0, "creation_date": 1516810749, "post_id": 48426943, "comment_id": 83844328, "body": "@BartoszKaraban: because it assigns that integral type to a <code>float</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516810852, "post_id": 48426943, "comment_id": 83844416, "body": "@Bathsheba <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.2\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.4.4.2</a> If I read the BNF properly, it is required as part of <code>floating-constant &lt;- decimal-floating-constant &lt;- fractional-constant &lt;- digit-sequence .</code>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516810923, "post_id": 48426943, "comment_id": 83844476, "body": "@EugeneSh.: Yes, I concur. Thank you."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1516819147, "post_id": 48426943, "comment_id": 83849514, "body": "I assume the not so obfuscated <code>(val1 + val2 + val3 + val4) &#47; 4.0f</code> would do too."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516819755, "post_id": 48426943, "comment_id": 83849810, "body": "@RudyVelthuis I dislike putting the float term at the end due to expressions being grouped from left to right. e.g. 3 / 5 * 3.0 is zero."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516820968, "post_id": 48426943, "comment_id": 83850394, "body": "@Bathsheba: but <code>int &#47; float</code>returns a <code>float</code>. The expression (plain addition) in parentheses is an <code>int</code>, indeed, but it is being divided by a <code>float</code>. So in this case, there is no problem."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516821345, "post_id": 48426943, "comment_id": 83850612, "body": "@RudyVelthuis: Indeed but it is vulnerable to errant refactoring or the introduction of extra coefficients on the left."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516822292, "post_id": 48426943, "comment_id": 83851158, "body": "@Bathsheba: Only if a division is entered. Not very vulnerable, IMO."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516822917, "post_id": 48426943, "comment_id": 83851516, "body": "@RudyVelthuis: My team have fallen for it. The remedy is simple: promote the first term, pretty please, with sugar on top?"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1516823157, "post_id": 48426943, "comment_id": 83851659, "body": "@Bathsheba: Whatever you like. But it would be less obfuscated and valid, right? Now, how you or your team handle such problems is up to you. I would not worry too much about it."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1516812197, "last_edit_date": 1592644375, "creation_date": 1516810358, "answer_id": 48426943, "question_id": 48426920, "link": "https://stackoverflow.com/questions/48426920/average-of-4-variables-function-printing-4-00000-divided-by-4-rather-than-th/48426943#48426943", "title": "Average of 4 variables function printing &quot;4.00000&quot; (divided by 4) rather than the actual average", "body": "<p>Two issues:</p>\n<ol>\n<li><p><code>(val1 + val2 + val3 + val4)/4;</code> is computed in <em>integer arithmetic</em>, as the terms are integral types. The remainder is discarded.</p>\n<p>One fix is to write <code>1.f * (val1 + val2 + val3 + val4) / 4;</code> or the slightly obfuscated <code>0.25f * (val1 + val2 + val3 + val4);</code></p>\n</li>\n<li><p>You're missing a prototype for <code>average4</code>. Formally the behaviour on doing that is <em>undefined</em> (since and including C99), you might be observing a conversion to <code>int</code> at the calling site.</p>\n</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "edited": false, "score": 0, "creation_date": 1516817304, "post_id": 48428377, "comment_id": 83848510, "body": "there must be something wrong with my compiler because I ran this and it gave me 0.0000000 as the average."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "edited": false, "score": 0, "creation_date": 1516818913, "post_id": 48428377, "comment_id": 83849376, "body": "@BartoszKaraban,  I added the output of a couple of executions of the proposed code.  They both worked correctly"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1516818772, "last_edit_date": 1516818772, "creation_date": 1516814868, "answer_id": 48428377, "question_id": 48426920, "link": "https://stackoverflow.com/questions/48426920/average-of-4-variables-function-printing-4-00000-divided-by-4-rather-than-th/48428377#48428377", "title": "Average of 4 variables function printing &quot;4.00000&quot; (divided by 4) rather than the actual average", "body": "<p>the following proposed code:</p>\n\n<ol>\n<li>doesn't quite compile because the three fields: <code>WDT_A</code> <code>WDT_A_CTL_HOLD</code> and <code>WDT_A_CTL_PW</code> are not declared.</li>\n</ol>\n\n<p>And now the proposed code, with commentary</p>\n\n<pre><code>#include &lt;stdio.h&gt;     // printf()\n#include &lt;stdlib.h&gt;    // rand(), srand()\n#include &lt;time.h&gt;      // time()\n\n// prototypes\nfloat average4(int val1, int val2, int val3, int val4);\n\n\nint main(void)                       // corrected signature\n{\n    WDT_A-&gt;CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;\n    // stop watchdog timer           // removed trailing line continuation 'slash'\n\n    srand( (unsigned int)time(NULL)); // cast to expected type\n    int val1 = (rand()%100);\n    int val2 = (rand()%100);\n    int val3 = (rand()%100);\n    int val4 = (rand()%100);\n    printf(\"%d\\n\",val1);\n    printf(\"%d\\n\",val2);\n    printf(\"%d\\n\",val3);\n    printf(\"%d\\n\",val4);\n\n    printf(\"%f\\n\",average4(val1, val2, val3, val4));\n}\n\n\nfloat average4(int val1, int val2, int val3, int val4)\n{\n    float result;\n    // cast the 'integer' sum to 'float',\n    // properly declared the '4' as a 'float' literal\n    // so division is 'float' rather than `'integer' division\n    result = (float)(val1 + val2 + val3 + val4)/4.0f;\n    return result;\n}\n</code></pre>\n\n<p>for testing, I commented out the line that tries to mess with the watchdog timer.</p>\n\n<p>I ran the above code using <code>gcc</code> to compile/link then opened a terminal on my ubuntu linux system and here is a couple typical executions.</p>\n\n<pre><code>32\n13\n74\n29\n37.000000\n</code></pre>\n\n<p>and </p>\n\n<pre><code>77\n53\n90\n49\n67.250000\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7359685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KO62bTWr_HU/AAAAAAAAAAI/AAAAAAAAD5E/l1p8xRDSiPk/photo.jpg?sz=128", "display_name": "Bartosz Karaban", "link": "https://stackoverflow.com/users/7359685/bartosz-karaban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516818772, "creation_date": 1516810296, "question_id": 48426920, "link": "https://stackoverflow.com/questions/48426920/average-of-4-variables-function-printing-4-00000-divided-by-4-rather-than-th", "title": "Average of 4 variables function printing &quot;4.00000&quot; (divided by 4) rather than the actual average", "body": "<p>I'm wondering if I'm using the correct variable types or not. I'm supposed to use only floats and ints as far as I'm aware. I know its printing the \"divide by 4\" part because in the function I switched it to divide by 5 and it printed \"5.0000\". If I make \"result\" an int, it obviously strips the answer of the decimal points, but it still gives me the correct average and not \"4\".\nWhy is it storing \"4.0000\" in the result variable instead of the answer? </p>\n\n<pre><code>void main(void)\n{\nWDT_A-&gt;CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;\n// stop watchdog timer\\\n\nsrand(time(NULL));\nint val1 = (rand()%100);\nint val2 = (rand()%100);\nint val3 = (rand()%100);\nint val4 = (rand()%100);\nprintf(\"%d\\n\",val1);\nprintf(\"%d\\n\",val2);\nprintf(\"%d\\n\",val3);\nprintf(\"%d\\n\",val4);\n\nprintf(\"%f\\n\",average4(val1, val2, val3, val4));\n}\n\n\nfloat average4(int val1, int val2, int val3, int val4){\nfloat result;\nresult = (val1 + val2 + val3 + val4)/4;\nreturn result;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "variadic-functions", "default-arguments"], "comments": [{"owner": {"reputation": 2967, "user_id": 8616205, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3o2ct.png?s=128&g=1", "display_name": "frslm", "link": "https://stackoverflow.com/users/8616205/frslm"}, "edited": false, "score": 2, "creation_date": 1516809748, "post_id": 48426677, "comment_id": 83843573, "body": "If you want to fix a function argument to some constant value, then perhaps it shouldn&#39;t be a parameter in the first place."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516810390, "post_id": 48426677, "comment_id": 83844057, "body": "Short answer -&gt; you can&#39;t. Long answer -&gt; you still can&#39;t."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1516815003, "post_id": 48426677, "comment_id": 83847206, "body": "Um, that is not valid C++ either."}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 2736641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5316d692cc603c3ad2df0f03869bb96b?s=128&d=identicon&r=PG", "display_name": "UziMonkey", "link": "https://stackoverflow.com/users/2736641/uzimonkey"}, "edited": false, "score": 0, "creation_date": 1555478639, "post_id": 48426894, "comment_id": 98120569, "body": "You don&#39;t need to define a macro with a different name. If a macro expands to itself then it stops expanding. If you call it func in your example then it will be transparent to the user of the function."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 6, "last_activity_date": 1516810823, "last_edit_date": 1516810823, "creation_date": 1516810219, "answer_id": 48426894, "question_id": 48426677, "link": "https://stackoverflow.com/questions/48426677/in-c-how-do-we-force-the-last-argument-in-a-varargs-function-to-be-a-terminatin/48426894#48426894", "title": "In C, how do we force the last argument in a varargs function to be a terminating null?", "body": "<p>You can't force a varargs function to have a specific \"last\" value in C.  </p>\n\n<p>There needs to be something within the argument list that tells the function how many arguments there are.  A few examples from the standard library:</p>\n\n<ul>\n<li><code>printf</code>: the format string tells the function how many arguments and what their types are.  </li>\n<li><code>execl</code>: takes a number of <code>const char *</code> arguments, the last of which must be <code>NULL</code>.</li>\n</ul>\n\n<p>So having a \"flag\" argument as the last when calling a varargs function is a known programming paradigm in C.  It's not something you need to cover up.</p>\n\n<hr>\n\n<p>That being said, you can use a macro to do what you want:</p>\n\n<pre><code>#define FUNC(...) func(__VA_ARGS__, 0)\n</code></pre>\n\n<p>The <code>...</code> in the macro argument list captures all arguments, and the <code>__VA_ARGS__</code> macro represents those arguments.</p>\n\n<p>Then you can define <code>func</code> like this:</p>\n\n<pre><code>void func(short first, ...)\n</code></pre>\n\n<p>And call it via the macro like this</p>\n\n<pre><code>FUNC(x, y);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7027, "user_id": 1735922, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a82aaa47327bba0f9657c32ce20c8914?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1735922/john"}, "is_accepted": false, "score": 3, "last_activity_date": 1516810326, "creation_date": 1516810326, "answer_id": 48426930, "question_id": 48426677, "link": "https://stackoverflow.com/questions/48426677/in-c-how-do-we-force-the-last-argument-in-a-varargs-function-to-be-a-terminatin/48426930#48426930", "title": "In C, how do we force the last argument in a varargs function to be a terminating null?", "body": "<p>That is not how C varargs are intended to be used, so it be hard to get them to work that way.  There is supposed to be a mandatory leading argument from which you can deduce the number and types of the following arguments.  The format string fills this role for the printf family of functions.  You could take an integer for the number of parameters and encode the type in the function name.</p>\n\n<pre><code>funcs(int num, ...); // s for short\n</code></pre>\n\n<p>That won't provide any type enforcement though.  The compiler will still allow non-shorts to be passed.  There is no way to enforce types through the vararg.  At this point you might as well use the classic array and count idiom.</p>\n\n<pre><code>funcs(int num, short const*);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 1, "creation_date": 1516810764, "post_id": 48426998, "comment_id": 83844347, "body": "The question is about the use of varargs."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516811056, "post_id": 48426998, "comment_id": 83844567, "body": "Then why can I read: &quot;Is it possible to write a macro that would convert text like [...]&quot;? The question seems to be more about polymorphism expression in C than about varargs."}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516811251, "post_id": 48426998, "comment_id": 83844707, "body": "See the title of the post"}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 0, "last_activity_date": 1516810496, "creation_date": 1516810496, "answer_id": 48426998, "question_id": 48426677, "link": "https://stackoverflow.com/questions/48426677/in-c-how-do-we-force-the-last-argument-in-a-varargs-function-to-be-a-terminatin/48426998#48426998", "title": "In C, how do we force the last argument in a varargs function to be a terminating null?", "body": "<p><code>#define func(x,y,z) func(x,y)</code> should work as a macro, however what you want (a different number of arguments with a same function name) is not possible in C.\nYou could also have a function where you pass an array containing the argument and the number of arguments as an integer, then you can do different things depending on how many arguments were given.</p>\n"}], "owner": {"reputation": 277, "user_id": 8827807, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b09adbdf2c49943cf4546013acb73ad9?s=128&d=identicon&r=PG&f=1", "display_name": "IdleCustard", "link": "https://stackoverflow.com/users/8827807/idlecustard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1516811999, "creation_date": 1516809632, "last_edit_date": 1516811999, "question_id": 48426677, "link": "https://stackoverflow.com/questions/48426677/in-c-how-do-we-force-the-last-argument-in-a-varargs-function-to-be-a-terminatin", "title": "In C, how do we force the last argument in a varargs function to be a terminating null?", "body": "<p>In C++, we might write something like this:</p>\n\n<pre><code>#include &lt;cassert.h&gt;\n#include &lt;cstdio.h&gt;\n#include &lt;cstdarg.h&gt;\n\nvoid func(..., short end = 0) {\n\n   // prevent caller from overriding default value with something other than null \n   assert(end == 0);\n\n   va_list args;  \n\n   short x;\n   x = va_arg(args, short); \n\n   while (x != 0) {\n       printf(\"%d\", va_arg(args, short));\n   }\n\n   va_end(list);\n\n   return;\n}\n</code></pre>\n\n<p>However, C does not support default function arguments. Is there someway that I can force <code>func</code> to have a trailing null character at the end of its argument list? Is there some way to do it without having the programmer explicitly pass the terminating null into to the function?</p>\n\n<p>We do not want to see calls like the following:</p>\n\n<pre><code>int   x = 5;\nfloat y = 6.4;\nfunc(x, y, 0);\n</code></pre>\n\n<p>We just want <code>func(x, y);</code>.</p>\n\n<p>Is it possible to write a macro that would convert text like</p>\n\n<p><code>func(x, y);</code></p>\n\n<p>into the call:</p>\n\n<p><code>func(x, y, 0);</code>?</p>\n\n<p>Is there some way to do this without a macro?</p>\n"}, {"tags": ["c", "pointers", "memory", "struct", "dynamic-memory-allocation"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1516809478, "post_id": 48426549, "comment_id": 83843382, "body": "The problem is not in the code posted."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1516809504, "post_id": 48426549, "comment_id": 83843401, "body": "Well, if first parameter has wrong value, then you need to fix it to have the right value, when calling the function... But you don&#39;t show that code, so we can&#39;t help... Please provide a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516809586, "post_id": 48426549, "comment_id": 83843454, "body": "@hyde forgot about that one. Just used it to see that ptr actually contained somethings which it does. But my start pointer doesn&#39;t seem to be pointed to that"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516809682, "post_id": 48426549, "comment_id": 83843515, "body": "<code>Song *start = &amp;(ptr[0]);</code> look fishy. Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516809683, "post_id": 48426549, "comment_id": 83843519, "body": "@Lundin okay. Then I actually have no idea where the problem lies but can put in all the code if it&#39;s needed."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516809871, "post_id": 48426549, "comment_id": 83843666, "body": "Single step through the code and watch the variable, to see where exactly it gets corrupted."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1516809978, "post_id": 48426549, "comment_id": 83843749, "body": "@anderssinho don&#39;t post all the code, but a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (yes this means some work for you)"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516810256, "post_id": 48426549, "comment_id": 83843957, "body": "Indeed, your code does not call <code>showList</code> anywhere, as far as I can see..."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516810339, "post_id": 48426549, "comment_id": 83844024, "body": "@MichaelWalz yeah I understand that. That&#39;s what I tried in the first example because I thought the problem lied there somewhere."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1516810384, "post_id": 48426549, "comment_id": 83844053, "body": "<code>addSong(&amp;ptr, &amp;nrOfSongs);</code> You are passing <code>Song **</code> for the first parameter but the function expects <code>Song *</code>. Your compiler should warn you of this."}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516810425, "post_id": 48426549, "comment_id": 83844090, "body": "@hyde correct, took to much away. Have edit it back to the code now"}, {"owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1516810583, "post_id": 48426549, "comment_id": 83844217, "body": "@JohnnyMopp hmm okay. I don&#39;t get the warnings there. Have to check that again"}], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 5768359, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10205553443942399/picture?type=large", "display_name": "Maksym Bodnar", "link": "https://stackoverflow.com/users/5768359/maksym-bodnar"}, "is_accepted": false, "score": -1, "last_activity_date": 1516811132, "creation_date": 1516811132, "answer_id": 48427209, "question_id": 48426549, "link": "https://stackoverflow.com/questions/48426549/point-struct-pointer-to-first-block-of-dynamic-allocated-memory-in-c/48427209#48427209", "title": "Point struct pointer to first block of dynamic allocated memory in C", "body": "<p>You can consider using a C linked list.</p>\n\n<p><a href=\"http://www.learn-c.org/en/Linked_lists\" rel=\"nofollow noreferrer\">Here</a> is a good example.</p>\n"}], "owner": {"reputation": 278, "user_id": 5470770, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e3348aa561631114656f1e7d0488bcac?s=128&d=identicon&r=PG&f=1", "display_name": "anderssinho", "link": "https://stackoverflow.com/users/5470770/anderssinho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516811132, "creation_date": 1516809272, "last_edit_date": 1516810388, "question_id": 48426549, "link": "https://stackoverflow.com/questions/48426549/point-struct-pointer-to-first-block-of-dynamic-allocated-memory-in-c", "title": "Point struct pointer to first block of dynamic allocated memory in C", "body": "<p>In my code I have allocated some memory with my struct Song pointer called ptr\n.\nWhat I'm now trying to do is to create a second pointer that always point to the first struct in the allocated memory and use that to loop through all when I want to print the information.</p>\n\n<p>It looks something like this in main:</p>\n\n<pre><code>#include \"FuncDek.h\"\n#include &lt;locale.h&gt;\n#include &lt;crtdbg.h&gt;\n\n\nint main() \n{\n    //For swedish and check memory leak\n    _CrtSetDbgFlag(_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);\n    setlocale(LC_ALL, \"swedish\");\n\n    //Create with starting size of 5\n    Song *ptr = (Song *)malloc(sizeof(Song) * 5);\n    Song *start = &amp;(ptr[0]);\n\n    int menuChoice = 0;\n    int nrOfSongs = 0;\ndo\n{\n    system(\"cls\");\n    menuChoice = menu();\n\n    switch (menuChoice)\n    {\n    case 1: \n        addSong(&amp;ptr, &amp;nrOfSongs);\n        break;\n    case 2:\n        showList(&amp;start, nrOfSongs, &amp;ptr);\n        break;\n    default:\n        printf(\"\\nFelaktigt val, f\u00f6rs\u00f6k igen\\n\");\n        system(\"pause\");\n        break;\n    }\n\n} while (menuChoice != 0);\n\n//TODO Free memory\n//free(ptr);\n\nsystem(\"pause\");\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>And I have to files that contains the function declarations/definitions which looks something like this:</p>\n\n<pre><code>#ifndef FUNCDEK\n#define FUNCDEK\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct {\n    char title[30];\n    char artist[30];\n    unsigned int year;\n\n} Song;\n\nint menu();\nvoid addSong(Song *ptr, int *nrOfSongs);\nvoid showList(Song *start, int nrOfSongs, Song *ptr);\n\n#endif\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>#include \"FuncDek.h\"\n#pragma warning(disable: 4996)\n\n//Show menu and save the users choice\nint menu()\n{\n    fflush(stdin);\n\n    int choice = 0;\n\n    printf(\"Menyval p\u00e5 l\u00e5tlista\\n\");\n    printf(\"-------------------------\\n\");\n    printf(\"1. L\u00e4gg till l\u00e5t \\n\");\n    printf(\"2. Visa l\u00e5tlista \\n\");\n    printf(\"3. Blanda l\u00e5tlistan \\n\");\n    printf(\"4. Spara till fil \\n\");\n    printf(\"0. Avsluta program \\n\");\n    scanf(\"%d\", &amp;choice);\n    getchar();\n\n    /*TODO FELHANTERING*/\n\n    return choice;\n}\n\n//Add song to list\nvoid addSong(Song *ptr, int *nrOfSongs)\n{\n    system(\"cls\");\n    Song temp;\n    printf(\"Ange l\u00e5tens namn:\\n\");\n    int sizeOfTitle = sizeof(temp.title) / sizeof(temp.title[0]);\n    fgets(temp.title, sizeOfTitle, stdin);\n    printf(\"Ange artistens namn:\\n\");\n    int sizeOfArt = sizeof(temp.artist) / sizeof(temp.artist[0]);\n    fgets(temp.artist, sizeOfArt, stdin);\n    printf(\"Ange \u00e5ret l\u00e5tens sl\u00e4pptes: \\n\");\n    scanf(\"%d\", &amp;temp.year);\n\n    for (int i = 0; i &lt; sizeOfTitle; i++)\n    {\n        ptr-&gt;artist[i] = temp.artist[i];\n        ptr-&gt;title[i] = temp.title[i];\n    }\n\n    ptr-&gt;year = temp.year;\n    *ptr++;\n    *nrOfSongs = *nrOfSongs + 1;\n\n}\n\n//Print all from list\nvoid showList(Song *start, int nrOfSongs, Song *ptr)\n{\n\n    system(\"cls\");\n    printf(\"Song list\\n\");\n    printf(\"-----------------------------\\n\");\n    for (int i = 0; i &lt; 1; i++)\n    {\n        printf(\"L\u00e5t: %s \\n\", start-&gt;title);\n        printf(\"Artist: %s \\n\", start-&gt;artist);\n        printf(\"\u00c5r: %d \\n\", start-&gt;year);\n        start++;\n    }\n    system(\"pause\");\n}\n</code></pre>\n\n<p>But when I run the showList function I get garbage values and I can also see that I don't read on the correct memory-location.\nSo my questions is how do I make my pointer called start to point to the first memory block in ptr?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 3, "creation_date": 1516808024, "post_id": 48426126, "comment_id": 83842242, "body": "algorithmically, it seem correct. Can we have a minimal compilable source code which reproduce your problem ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516808031, "post_id": 48426126, "comment_id": 83842246, "body": "So if I understand this correctly, you are basically trying to convert a raw binary number to <a href=\"https://en.wikipedia.org/wiki/Binary-coded_decimal\" rel=\"nofollow noreferrer\">BCD</a>."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1516808087, "post_id": 48426126, "comment_id": 83842284, "body": "No, he want to &quot;explode&quot; his integer into an array of digit."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1516808133, "post_id": 48426126, "comment_id": 83842328, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> as well as: 1. the output you get. 2. the output you want."}, {"owner": {"reputation": 4313, "user_id": 2706707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BoAxS.gif?s=128&g=1", "display_name": "D&#250;thomhas", "link": "https://stackoverflow.com/users/2706707/d%c3%bathomhas"}, "edited": false, "score": 0, "creation_date": 1516808427, "post_id": 48426126, "comment_id": 83842590, "body": "It is still unclear what you are trying to do. How does your number transform into an array, and how does that array transform into a single integer to be printf()ed?"}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 1, "creation_date": 1516809269, "post_id": 48426126, "comment_id": 83843228, "body": "You are passing a <code>NULL</code> pointer to <code>func</code> and there you access it. There is now way that this could end well...."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "edited": false, "score": 0, "creation_date": 1516808380, "post_id": 48426226, "comment_id": 83842550, "body": "int *array = malloc(count * sizeof(int)) ?"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "reply_to_user": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "edited": false, "score": 0, "creation_date": 1516808606, "post_id": 48426226, "comment_id": 83842723, "body": "Carrefull, it seem you declare again the variable &quot;array&quot;. You have to send the address of your pointer, in order to change your pointer from within &quot;fun&quot; function. Prototype = &quot;int fun(int num, int *(*array))&quot;, malloc = &quot;(*array) = malloc(count * sizeof(*(*array))) &quot;"}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1516809164, "post_id": 48426226, "comment_id": 83843151, "body": "<i>Since your integer array will change in your fun function,..</i> Could you please explain what you exactly mean??"}, {"owner": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "edited": false, "score": 0, "creation_date": 1516809248, "post_id": 48426226, "comment_id": 83843218, "body": "Alright, when i do *array = malloc(count *sizeof(*(*array))); i get error"}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "reply_to_user": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "edited": false, "score": 0, "creation_date": 1516809324, "post_id": 48426226, "comment_id": 83843268, "body": "@Prins <code>*array = malloc(count *sizeof(*(*array)));</code> --&gt; <code>*array = malloc(count *sizeof(int));</code>. Btw what do you think <code>sizeof(*(*array))</code> does exactly?"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1516809391, "post_id": 48426226, "comment_id": 83843311, "body": "I mean that since &quot;array&quot; will be allocated in the function, you need to have the address of the address. If not, only the &quot;array&quot; variable in the fun function will have the value of the memory bloc allocated, and the array int the main function will be inchanged."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1516809767, "post_id": 48426226, "comment_id": 83843583, "body": "sizeof (*(*array)) will get the sizeof of **array. Previously, I said that you need to give the address of the integer array. So you need to have &quot;int **array&quot; in the parameter of the fun function. So sizeof(**array) will be like sizeof(int), at the exception that if you want to have another type for the &quot;array&quot; variable, sizeof(**array) will be correct be sizeof(int) willbe not."}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1516810261, "post_id": 48426226, "comment_id": 83843961, "body": "?? You shouldn&#39;t, unless array&#39;s type is &quot;int *&quot;. It must be &quot;int **&quot;. Prototype = &quot;int fun(int num, int **array)&quot;, array = &quot;int *array = NULL;&quot;, usage = &quot;fun(12345, &amp;array);&quot;"}, {"owner": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "edited": false, "score": 0, "creation_date": 1516810341, "post_id": 48426226, "comment_id": 83844026, "body": "arrays type it int*"}, {"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 0, "creation_date": 1516810563, "post_id": 48426226, "comment_id": 83844201, "body": "Do you know how memory allocation with array througth function call work ? if you have &quot;int fun(int num, int *array)&quot;, this will NEVER work. Exactly the same as &quot;int fun2(int var)&quot; : the &quot;var&quot; variable will not be changed after a call to fun2 function."}], "tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 1, "last_activity_date": 1516809177, "last_edit_date": 1516809177, "creation_date": 1516808266, "answer_id": 48426226, "question_id": 48426126, "link": "https://stackoverflow.com/questions/48426126/digit-to-integer-in-same-order-c/48426226#48426226", "title": "digit to integer in same order C", "body": "<p>What this line is supposed to do ?</p>\n\n<pre><code>array[count];\n</code></pre>\n\n<p>Since your integer array will change in your fun function, you have to allocate the memory (by using malloc, realloc, ...).</p>\n\n<p>edit : plus, you already change the value hold by \"num\" when you count how many digit there are in \"num\".\nMake a copy of \"num\" !</p>\n\n<p>edit 2 : the more i look your function, the more it seem you will have problem using it.</p>\n\n<p>Fisrt, you want to explode your integer into an array of int.\nOkay, but integer have range, thus meaning integer have a maximum digit.\nFrom my memories, there are 20 digit in an 64bit integer.\nSo you can simply use \"int array[NB_DIGIT_INT_MAX];\" with \"#define NB_DIGIT_INT_MAX 21\".\nSo, allocating is not necessary AND add complexity in your code (the caller will have to free after the function call).</p>\n\n<p>Second, your fun function doesn't say how many case will hold your integer.\nLet's say num = 12, your array will have \"array[0] = 1, array[1] = 2\", but how do you know where to stop ?\nIf num = 2345, how do you know that only the 4 first case in your array is legit ?\nThere are 2 way : You have an another variable that hold the actual size of the array, or you have a special value in your array that say \"it's the end\" (like '\\0' for char array used as string).</p>\n\n<p>You can use \"-1\".</p>\n\n<p>Let's give a try, and don't hesitate to ask question if thing are unclear (english is not my motherlanguage)</p>\n"}, {"tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": false, "score": 0, "last_activity_date": 1516808649, "creation_date": 1516808649, "answer_id": 48426360, "question_id": 48426126, "link": "https://stackoverflow.com/questions/48426126/digit-to-integer-in-same-order-c/48426360#48426360", "title": "digit to integer in same order C", "body": "<p>Your array is not even allocated, this can not work as expected. You are even lucky not to have a segmentation fault. If you want to add an integer to an array making it grow, you need to allocate a larger array, copy the values and add the new one to the new array and delete the previous array, keeping <code>array</code> variable as a pointer to the new array. Moreover, you need to pass the size of the actual array as an argument of <code>fun</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812316, "last_edit_date": 1516812316, "creation_date": 1516809318, "answer_id": 48426561, "question_id": 48426126, "link": "https://stackoverflow.com/questions/48426126/digit-to-integer-in-same-order-c/48426561#48426561", "title": "digit to integer in same order C", "body": "<p>The <code>count</code> variable can be global, Initialize it outside all functions like this</p>\n\n<pre><code>short count;\n</code></pre>\n\n<p>The whole program could be modified like below</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nshort count;\nvoid fun(int num, int **ptr) {\n// You need a pointer to a pointer and return type can be void\n int num_copy=num;\n count=0; // Setting the count to zero\n while(num_copy&gt;0) {\n  num_copy/= 10; // Don't modify the original number\n  count++;\n }\n//Allocate enough memory to store the digits\n *ptr=malloc(count*sizeof **ptr);\n if(NULL==*ptr){\n  perror(\"Can't allocate memory\");\n  exit(1);\n }\n// Then do the loop part with original num\n for(int i=count -1; i&gt;=0; i--) {\n  (*ptr)[i] = num%10;\n  num /= 10;\n }\n// By now you have an array 'array' of integers which you could print in main.\n}\n\nint main()\n{\nint number = 123456789;\nint *array;\nfun(number,&amp;array); // &amp;array is of type pointer to a pointer to integers\n //Now print the individual digits\nprintf(\"Individual digits are : \\n\");\nfor(int i=count-1;i&gt;=0;i--)\n printf(\"%d\\n\",array[i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812429, "creation_date": 1516812429, "answer_id": 48427633, "question_id": 48426126, "link": "https://stackoverflow.com/questions/48426126/digit-to-integer-in-same-order-c/48427633#48427633", "title": "digit to integer in same order C", "body": "<p>Looks to me like you are converting from an integer to digits. But I don't see where your code writes anything to the array.</p>\n\n<p>If the array wasn't initialized before this, that would explain why it still contains random values.</p>\n"}], "owner": {"reputation": 17, "user_id": 8983820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1da384b746e615de38019dc296c0f94a?s=128&d=identicon&r=PG&f=1", "display_name": "Prins", "link": "https://stackoverflow.com/users/8983820/prins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1516817333, "answer_count": 4, "score": -3, "last_activity_date": 1516812429, "creation_date": 1516807898, "last_edit_date": 1516812278, "question_id": 48426126, "link": "https://stackoverflow.com/questions/48426126/digit-to-integer-in-same-order-c", "closed_reason": "Not suitable for this site", "title": "digit to integer in same order C", "body": "<p>I have a function called <code>fun(int num, int * array);</code> which takes an <code>int</code> and <code>int array</code> as its arugments. I'm trying to convert <code>int</code> to the array.</p>\n\n<p>When i run the program i don't get the array displayed properly</p>\n\n<pre><code>int fun(int num, int*array) {\n   int count =0;\n   while(num&gt;0) {\n      num/= 10;\n      count++;\n   }\n   array[count];\n   // for loop works\n }\n</code></pre>\n\n<p>When i print the array in the program i.e. everytime I run the program i get random digits.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1516807466, "post_id": 48425934, "comment_id": 83841804, "body": "Is this in Linux console, DOS Prompt, or other? What is the platform in other words."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516807882, "post_id": 48425934, "comment_id": 83842127, "body": "Basically there is no way to achieve this with standard C. You&#39;ll have to use Windows console API, ncurses etc."}, {"owner": {"reputation": 143, "user_id": 9262811, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bf9dab615559e933aff9ed82996463e2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9262811/j-doe"}, "edited": false, "score": 0, "creation_date": 1516808090, "post_id": 48425934, "comment_id": 83842287, "body": "I am using XCode"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516809777, "post_id": 48425934, "comment_id": 83843593, "body": "@J.Doe So you have a Mac. This random find with Google may be of help: <a href=\"https://rhardih.io/2010/04/using-ncurses-in-c-for-text-user-interfaces-featuring-xcode/\" rel=\"nofollow noreferrer\">rhardih.io/2010/04/&hellip;</a>"}], "owner": {"reputation": 143, "user_id": 9262811, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bf9dab615559e933aff9ed82996463e2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Doe", "link": "https://stackoverflow.com/users/9262811/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1516807841, "answer_count": 0, "score": 0, "last_activity_date": 1516809419, "creation_date": 1516807286, "last_edit_date": 1516809419, "question_id": 48425934, "link": "https://stackoverflow.com/questions/48425934/unwanted-new-line-in-console-c-programming", "closed_reason": "Duplicate", "title": "unwanted new line in console C programming", "body": "<p>I am writing this small program in C and I am getting an unwanted new line. This is basically the part of my program that writes output and handles input:</p>\n\n<pre><code>    printf(\"\\nGissning: \");\n    scanf(\"%f\",&amp;gissning);\n\n    if(gissning &lt; RandomTal) {\n        printf(\" Du gissade f\u00f6r l\u00e5gt, f\u00f6rs\u00f6k igen!\");\n    } else if(gissning &gt; RandomTal){\n        printf(\" Du gissade f\u00f6r h\u00f6gt, f\u00f6rs\u00f6k igen!\");\n    }\n</code></pre>\n\n<p>This is what the output look like:</p>\n\n<pre><code>Gissning: 56\n Du gissade f\u00f6r l\u00e5gt, f\u00f6rs\u00f6k igen!\nGissning: \n</code></pre>\n\n<p>This is what I want my output to look like:</p>\n\n<pre><code>Gissning: 56 Du gissade f\u00f6r l\u00e5gt, f\u00f6rs\u00f6k igen!\nGissning: \n</code></pre>\n\n<p>So basically when I enter a number in this case 56 I press enter to give the computer the number and in the same time create a new row. I do not want this to happen. How do I solve this?</p>\n\n<p>My teacher showed this command but I do not get it to work </p>\n\n<pre><code>while(getchar()!='\\n');\n</code></pre>\n"}, {"tags": ["c", "embedded", "iar"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516807331, "post_id": 48425861, "comment_id": 83841701, "body": "You already do one <code>memcpy</code> of some data, why not add another? All the information you need should be available to you, yes? The start and end of the <code>.data</code> segment in FLASH, as well as some location for it in RAM?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516808532, "post_id": 48425861, "comment_id": 83842670, "body": "<a href=\"https://stackoverflow.com/a/47940277/584518\">Some useful tips &amp; tricks for how to roll out the &quot;CRT&quot; yourself on a generic MCU</a>. Most notably your code seems to fail to setup the clock <i>before</i> you init .data and .bss. That would be very bad. Though of course not all from that link applies to Cortex M4, ARM sets the SP through hardware etc."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1516808534, "post_id": 48425861, "comment_id": 83842674, "body": "Yes, I assume this will be a simple copy but I do not know where this information is located. It&#39;s not in my linker script and nothing in the map file stands out."}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516808680, "post_id": 48425861, "comment_id": 83842790, "body": "If you want the variables to be initialized proberly calling main from __low_level_init is not a very good idea. __low_level_init is called before the initialization code."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516808902, "post_id": 48425861, "comment_id": 83842967, "body": "Anyway, I don&#39;t know what IAR names the various segments, but obviously you need a <code>memcpy</code> from wherever <code>.data</code> initializers are stored in flash, to the RAM block named <code>.data</code>. Check your linker file/map file/symbol browser to find out the name used. I don&#39;t believe LMA/VMA is an issue."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1516809013, "post_id": 48425861, "comment_id": 83843045, "body": "__low_level_init is my entry point by design. It is called after the bootloader has initialized everything. Watchdog is enabled, SP is setup, clocks configured, etc. The only thing left to do is clear the .bss and setup the .data section."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516809135, "post_id": 48425861, "comment_id": 83843132, "body": "If I remember correctly, IAR calls the linker script for <code>*.lcf</code>. Something in the flash section of that file will be the initializers for <code>.data</code>."}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516809247, "post_id": 48425861, "comment_id": 83843217, "body": "@lusher00 I realize that this is by design, I am just pointing out at least one reason why it is not a very good design."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516809355, "post_id": 48425861, "comment_id": 83843291, "body": "@Johan Why not? Looks fine to me, except we can&#39;t tell what the magic <code>__DI();</code> function does."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516809510, "post_id": 48425861, "comment_id": 83843405, "body": "@johan what init code am I missing that can&#39;t be handled by the bootloader? The bootloader used the standard IAR init sequence. The only thing left to do is copy the data. I&#39;m asking how to strip that portion out of the standard init sequence or write it my self. Either way, everything will be handled."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516809534, "post_id": 48425861, "comment_id": 83843417, "body": "@lundin sorry, that disabled interrupts"}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516809906, "post_id": 48425861, "comment_id": 83843684, "body": "@lusher00 You can of course handle the data initialization in the bootloader but the only thing that happens between __low_level_init and the call to main is that the data initialization is called. You should also note that when __low_level_init returns the program continues by calling data initialization and after that main."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516810217, "post_id": 48425861, "comment_id": 83843929, "body": "@johan no it doesn&#39;t, it returns to the bootloader. I already have it working with a basic blinking light but the data isn&#39;t right with larger programs. In order for the IAR startup sequence to occur you have to start from the reset vector. That function should be renamed startup() but when I do that it doesn&#39;t get forced to 0x20000000. I have a question into IAR as to how to force it to 0x20000000 without calling it __low_level_init but I can assure only the code I have written is all that is executed because I have single step through it."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1516810750, "post_id": 48425861, "comment_id": 83844332, "body": "I believe it doesn&#39;t work when I call it startup() is because that function is never called (the bootloader jumps to address 0x20000000 where startup() is located) and its getting thrown out during optimization (even though I have optimization turned off)"}, {"owner": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516811036, "post_id": 48425861, "comment_id": 83844558, "body": "@lusher00 You could try to tell the linker not to throw away the startup function even though it is not called. I don&#39;t remember how to do this but it should be described in the manual. There should also be a way to trigger variable initialization manually but for this I also have to refer you to the manual."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 3133, "user_id": 3668462, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d2Rj1.jpg?s=128&g=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/3668462/johan"}, "edited": false, "score": 0, "creation_date": 1516811413, "post_id": 48425861, "comment_id": 83844808, "body": "@johan, thank you. I&#39;m going to focus on renaming this function for now to avoid any confusion. It&#39;s not really the __low_level_init() that gets called during a startup sequence."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516828117, "post_id": 48425861, "comment_id": 83854314, "body": "So you are attempting to use C to bootstrap C am I understanding this correctly?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516828265, "post_id": 48425861, "comment_id": 83854394, "body": "You seem to be really over complicating this, if you are making a ram based program with data that is about as easy as it gets, a few lines of asm in flash copies the whole damn binary over in one pass, .text, .data, .bss, minimal/trivial linker script for the ram based code."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516830806, "post_id": 48425861, "comment_id": 83855651, "body": "You can also develop the project so that .bss doesnt need to be zeroed and there isnt any .data that needs to be initialized."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516832169, "post_id": 48425861, "comment_id": 83856324, "body": "@old_timer its not copied from flash, its loaded via USB at runtime."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516839876, "post_id": 48425861, "comment_id": 83859057, "body": "no real difference there then, build right and the toolchain sets up .bss and .data for you, or just dont use .bss and .data"}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516891279, "post_id": 48425861, "comment_id": 83882620, "body": "@old_timer I would love to see the solution you propose posted as an answer below."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516894495, "post_id": 48425861, "comment_id": 83885034, "body": "for clarification your issue is that you have a bootloader and that is not the problem the bootloader works?  it allows you to download a program to SRAM and run the program with its data in that SRAM?   And your issue is how to prep .bss and .data for that program in sram?"}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1516895081, "post_id": 48425861, "comment_id": 83885519, "body": "@old_timer the bootloader works. the ramcode also works with the solution I posted below. It sounds like you are suggesting I tell the linker to add the .data and .bss section to the binary but that causes unnecessary bloat. I need the image to be very small. The standard IAR startup code handles the copy so what you are suggesting is non-standard. If you included those sections in the binary you would have to rewrite the startup code to remove the copy."}], "answers": [{"comments": [{"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1516876126, "post_id": 48430175, "comment_id": 83872424, "body": "The vector table includes the initial stack-pointer value.  It seems in this solution you are using the bootloader&#39;s stack in <code>main()</code> which could conceivably overlap with the ram-resident code."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1516891498, "post_id": 48430175, "comment_id": 83882791, "body": "@Clifford I am sharing the stack. I&#39;m not sure how I feel about that but I&#39;m going to let it go for now. It wouldn&#39;t be that much work to update the stack poiner before calling main and restoring it after."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1516891814, "post_id": 48430175, "comment_id": 83883018, "body": "The standard startup will also initialise the standard library; as such some library call may fail if they rely on static data.  Heap management for example."}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1516894879, "post_id": 48430175, "comment_id": 83885365, "body": "@clifford the standard startup has been removed."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1516895158, "post_id": 48430175, "comment_id": 83885574, "body": "I am aware of that; my point is merely a caution that parts of the standard library may not then work."}, {"owner": {"reputation": 2316, "user_id": 469006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3855250cd4b053ce9204c773246196b?s=128&d=identicon&r=PG", "display_name": "D Krueger", "link": "https://stackoverflow.com/users/469006/d-krueger"}, "edited": false, "score": 0, "creation_date": 1516924323, "post_id": 48430175, "comment_id": 83900574, "body": "Are you sure that <code>__iar_data_init3</code> doesn&#39;t clear .bss as well?"}, {"owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "edited": false, "score": 0, "creation_date": 1517022458, "post_id": 48430175, "comment_id": 83938300, "body": "@D Kruger. Yes __iar_data_init3 handles it"}], "tags": [], "owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "is_accepted": false, "score": 1, "last_activity_date": 1516821927, "creation_date": 1516821927, "answer_id": 48430175, "question_id": 48425861, "link": "https://stackoverflow.com/questions/48425861/manually-copy-data-section-from-flash-to-ram-with-iar-ewarm/48430175#48430175", "title": "manually copy .data section from flash to ram with IAR EWARM", "body": "<p>The IAR function which handles the copy of the .data section is called __iar_data_init3(). I had considered calling this directly but couldn't believe it was that simple. IAR suggested this is the correct solution. I also used the keyword __root to prevent the compiler from removing my \"unused\" function. This allowed me to rename it something more appropriate like startup(). Calling it __low_level_init() was just a hack to prevent the compiler from removing it. __low_level_init() was not called as part of the startup sequence but rather the entry point I was loading the program counter with in the bootloader. This is my final solution</p>\n\n<pre><code>#pragma section=\".bss\"\n#pragma location=\".init\"\n__root void startup()\n{\n    char * from = __section_begin(\".bss\");\n    char * to = __section_end(\".bss\");\n\n    memset(from, 0x00 , (to - from));\n\n    __iar_data_init3();\n\n    memcpy(__vector_table, (unsigned char *)ROM_VECTOR_LOCATION, VECTOR_TABLE_SIZE);\n\n    __DI(); // Disable interrupts\n\n    SCB_VTOR = (unsigned int) &amp; __vector_table;\n\n    main();\n\n    SCB_VTOR = (uint32_t)ROM_VECTOR_LOCATION;\n\n}\n</code></pre>\n\n<p>Not there is also a function called __iar_zero_init3() which handles the zeroing of the .bss however on first try it caused my program to crash. I can't imagine it would take much work to get it working.</p>\n"}], "owner": {"reputation": 648, "user_id": 705183, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/f0971d0ec1deb9e0be7921d3c8fd0f6d?s=128&d=identicon&r=PG", "display_name": "lusher00", "link": "https://stackoverflow.com/users/705183/lusher00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1516821927, "creation_date": 1516807040, "last_edit_date": 1516809807, "question_id": 48425861, "link": "https://stackoverflow.com/questions/48425861/manually-copy-data-section-from-flash-to-ram-with-iar-ewarm", "title": "manually copy .data section from flash to ram with IAR EWARM", "body": "<p>I have written a bootloader for a Kinetis K24 Cortex M4. The bootloader loads additional functionality over USB into ram at runtime. This ramcode exists as its own EWARM project generating a binary. The entry point to this binary must always be 0x20000000 and the vector table must always live at 0x20007000 in order to play nicely with my .NET tool. The IAR startup code handles clearing of the .bss and the .data copy but it also does some other things I dont want. I can't figure out how to force the IAR entry point to a specific address so I have created my own entry point like so</p>\n\n<pre><code>#pragma section=\".bss\"\n\n#pragma location=\".init\"\n__interwork int __low_level_init(void)\n{\n    char * from = __section_begin(\".bss\");\n    char * to = __section_end(\".bss\");\n\n    __DI(); // Disable interrupts\n\n    memset(from, 0x00 , (to - from));\n\n    memcpy(__vector_table, (unsigned char *)ROM_VECTOR_LOCATION, VECTOR_TABLE_SIZE);\n\n    SCB_VTOR = (unsigned int) &amp; __vector_table;\n\n    main();\n\n    SCB_VTOR = (uint32_t)ROM_VECTOR_LOCATION;\n}\n</code></pre>\n\n<p>When I debug the code I can see that my global variables initialized to non-zero values take on random values. I believe this is because I am not copying the .data section from the LMA to the VMA.</p>\n\n<p>My question is how do I duplicate this copy of the .data section from LMA to VMA?</p>\n\n<p>I would also settle for using the IAR startup code if I could figure out how to break it up but the entry point can't be the reset vector. The entry point has to be 0x20000000 and the vector table has to live at 0x20007000  </p>\n"}, {"tags": ["python", "c", "gcc", "cython"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1516806519, "post_id": 48425658, "comment_id": 83841107, "body": "If you&#39;re putting <code>-lpykubectl.so</code> that means it&#39;s looking for libpykubectl.so.so - you just need <code>-lpykubectl</code>"}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516806693, "post_id": 48425658, "comment_id": 83841259, "body": "@ChrisTurner omg, I need more coffee :) Thanks1"}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516806419, "creation_date": 1516806419, "last_edit_date": 1592644375, "question_id": 48425658, "link": "https://stackoverflow.com/questions/48425658/what-can-be-wrong-with-shared-object-library-produced-by-go", "title": "What can be wrong with shared object (library) produced by Go?", "body": "<h3>Context</h3>\n<p>I'm trying to build bindings for Python 3 to a program originally written in Go.  Below is what I was able to do so far:</p>\n<ol>\n<li>Write Go code that exposes functionality to C code.</li>\n<li>Write glue C code that uses functions exposed by Go code.</li>\n<li>Write Cython code that calls into C code, which calls into Go code.</li>\n<li>I can compile my code by hand-crafting the GCC command.</li>\n</ol>\n<h1>Problem</h1>\n<p>The way <code>setuptools</code> wants to generate the command, <code>ld</code> isn't &quot;able&quot; to find the library.  No amount of hinting doesn't help, and <code>ld</code> doesn't produce any parseable output.</p>\n<p>The command generated by <code>setuptools</code> looks like this:</p>\n<pre><code>gcc -pthread -shared build/temp.linux-x86_64-3.6/pykubectl/lib/bindings.o \\\n    build/temp.linux-x86_64-3.6/pykubectl/wrapped.o \\\n    -lpykubectl.so \\\n    -o build/lib.linux-x86_64-3.6/pykubectl/wrapped.cpython-36m-x86_64-linux-gnu.so \\\n    -L/home/.../pykubectl/pykubectl/lib\n</code></pre>\n<p>This fails with: <code>/usr/bin/ld: cannot find -lpykubectl.so</code></p>\n<p>But, if I do it like this:</p>\n<pre><code>gcc -pthread -shared build/temp.linux-x86_64-3.6/pykubectl/lib/bindings.o \\\n    build/temp.linux-x86_64-3.6/pykubectl/wrapped.o \\\n    /home/.../pykubectl/pykubectl/lib/libpykubectl.so \\\n    -o build/lib.linux-x86_64-3.6/pykubectl/wrapped.cpython-36m-x86_64-linux-gnu.so\n</code></pre>\n<p>It does compile.</p>\n<p>Here's some info about <code>libpykubectl.so</code>:</p>\n<pre><code>ldd /home/.../pykubectl/pykubectl/lib/libpykubectl.so\n    linux-vdso.so.1 =&gt;  (0x00007ffd7cccd000)\n    libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f69662d2000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f6965f0b000)\n    /lib64/ld-linux-x86-64.so.2 (0x000055e410408000)\n\n\nfile /home/.../pykubectl/pykubectl/lib/libpykubectl.so \n    /home/.../pykubectl/pykubectl/lib/libpykubectl.so: \\\n    ELF 64-bit LSB shared object,\n    x86-64, version 1 (SYSV),\n    dynamically linked,\n    BuildID[sha1]=d4225259207743ceaecda8d90368c13732d0f310,\n    not stripped\n</code></pre>\n<p>(formatted for readability).</p>\n"}, {"tags": ["c", "floating-point", "numerical", "floating-point-exceptions"], "comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516804544, "post_id": 48424967, "comment_id": 83839592, "body": "What is an FPE?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1516804570, "post_id": 48424967, "comment_id": 83839613, "body": "@machine_1 I would guess &quot;floating point exception&quot;."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516804643, "post_id": 48424967, "comment_id": 83839687, "body": "Please post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "edited": false, "score": 2, "creation_date": 1516805699, "post_id": 48424967, "comment_id": 83840456, "body": "Are you sure your exception is due to this line? When I try at home your exact example I get 5.71612e-313. Can you give more details about the library you use for &quot;pow&quot;, the compiler you use, on what system, etc? Perhaps you should try to upgrade something. Floating-point exceptions are mostly due to divisions by 0."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516805748, "post_id": 48424967, "comment_id": 83840484, "body": "In addition to a minimal, complete, verifiable example, what platform are you running on\u2014hardware, compiler, operating system, including versions? <code>pow(.62, 1504)</code> is representable in the common 64-bit <code>double</code> format. It is subnormal, but even implementations that flush subnormals to zero ought to return a result for this, not trap."}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "edited": false, "score": 0, "creation_date": 1516805991, "post_id": 48424967, "comment_id": 83840682, "body": "Ok, I use Debian 9 64 bits and I compile with gcc 6.3. The library is c cmaes and here is the problematic line: <a href=\"https://github.com/CMA-ES/c-cmaes/blob/eda8268ee4c8c9fbe4d2489555ae08f8a8c949b5/src/cmaes.c#L893\" rel=\"nofollow noreferrer\">github.com/CMA-ES/c-cmaes/blob/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1516806087, "post_id": 48424967, "comment_id": 83840775, "body": "This &quot;problematic line&quot; is containing division. Which can give division by zero. I have no idea how you deduced the problem is in <code>pow</code>."}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "edited": false, "score": 0, "creation_date": 1516806212, "post_id": 48424967, "comment_id": 83840884, "body": "I have used gdb"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516806282, "post_id": 48424967, "comment_id": 83840933, "body": "If you take the lines you presented in the question, give it the values you presented in the question and compile it with the compiler you state in the question - does it give you the exception?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516806342, "post_id": 48424967, "comment_id": 83840968, "body": "About the edit:  there are <i>two</i> divisions. I don&#39;t understand how this question is getting so many upvotes as it is most likely completely misleading."}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "edited": false, "score": 0, "creation_date": 1516806949, "post_id": 48424967, "comment_id": 83841442, "body": "I know it is in the pow because of gdb."}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516807789, "post_id": 48424967, "comment_id": 83842056, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163808/discussion-between-antoinemazuyer-and-eugene-sh\">continue this discussion in chat</a>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1516808014, "post_id": 48424967, "comment_id": 83842232, "body": "Is the code you posted supposed to result in a floating point exception?"}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "edited": false, "score": 0, "creation_date": 1516808302, "post_id": 48424967, "comment_id": 83842487, "body": "No It works whereas it is the same values given by gdb when I run the library from which this line is taken. I have a FPE using the library, but it works like a charm using the code sample"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1516808513, "post_id": 48424967, "comment_id": 83842651, "body": "The snippet you posted is a bit different from the &quot;offending&quot; line in the linked code, which is basically <code>int hsign = &#47;*some calc with doubles*&#47; &lt; &#47;*some double value*&#47; </code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516825530, "post_id": 48424967, "comment_id": 83852949, "body": "i suspect FPE is overflow due to division by small number (maybe 0) and not anyhing to do with pow() troubles.  break the line of code into steps to see the true culprit."}], "answers": [{"comments": [{"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 1, "creation_date": 1516805438, "post_id": 48425026, "comment_id": 83840262, "body": "Don&#39;t you mean <code>ln</code> instead of <code>log</code>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1516805468, "post_id": 48425026, "comment_id": 83840287, "body": "@stackptr: Oops."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1516805896, "post_id": 48425026, "comment_id": 83840602, "body": "@Bathsheba: A <code>pow</code> implementation generally uses logarithms and exponents, but it is more likely to use base two (to match the base of the floating-point format) and specialized code to calculate the things it needs, rather than calling the actual <code>exp</code>, <code>exp2</code>, <code>ln</code>, or <code>log2</code>. Those routines would not provide the needed precision for a good <code>pow</code>."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516806082, "post_id": 48425026, "comment_id": 83840768, "body": "@EricPostpischil: A good point, as always. I wonder if it&#39;s feasible to still proceed as above, check c * i, and if that satisfies some criteria or other, call the standard pow function."}, {"owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "edited": false, "score": 0, "creation_date": 1516814348, "post_id": 48425026, "comment_id": 83846781, "body": "in c language, log is ln (and log10 is log) <a href=\"https://stackoverflow.com/questions/34205208/how-can-you-use-ln-function-in-c-programing\" title=\"how can you use ln function in c programing\">stackoverflow.com/questions/34205208/&hellip;</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516827863, "post_id": 48425026, "comment_id": 83854176, "body": "<code>pow()</code> as <code>exp(c * ln(b))</code> when 1) <code>b &lt;= 0</code> 2) is unnessisarially imprecise,"}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1516966157, "post_id": 48425026, "comment_id": 83913719, "body": "Do not implement pow in terms of exp and ln. It will introduce a loss of precision and will likely be slower."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1516966324, "post_id": 48425026, "comment_id": 83913800, "body": "@PaulFloyd: I might reword this."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1516966559, "post_id": 48425026, "comment_id": 83913923, "body": "@PaulFloyd: Dunnit. Obviously this invalidates some of the previous comments, but the edit history is always viewable."}, {"owner": {"reputation": 3760, "user_id": 6594576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448660dad9fcb2bf8b5f7a3ab8813037?s=128&d=identicon&r=PG", "display_name": "Paul Floyd", "link": "https://stackoverflow.com/users/6594576/paul-floyd"}, "edited": false, "score": 0, "creation_date": 1516966808, "post_id": 48425026, "comment_id": 83914048, "body": "I would suggest that before anyone tries to do better than their libc version of pow that they take a look at the source <a href=\"https://github.com/lattera/glibc/blob/master/sysdeps/ieee754/dbl-64/e_pow.c\" rel=\"nofollow noreferrer\">github.com/lattera/glibc/blob/master/sysdeps/ieee754/dbl-64/&zwnj;&#8203;&hellip;</a> and <a href=\"https://github.com/freebsd/freebsd/blob/master/lib/msun/src/e_powf.c\" rel=\"nofollow noreferrer\">github.com/freebsd/freebsd/blob/master/lib/msun/src/e_powf.c</a>&zwnj;&#8203;."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 1, "last_activity_date": 1516966301, "last_edit_date": 1516966301, "creation_date": 1516804652, "answer_id": 48425026, "question_id": 48424967, "link": "https://stackoverflow.com/questions/48424967/how-to-avoid-floating-point-exception-when-using-pow/48425026#48425026", "title": "How to avoid floating point exception when using pow?", "body": "<p>Conceptually at least, <code>pow(b, c)</code> can be considered as being implemented as <code>exp(c * ln(b))</code>.</p>\n\n<p>So one way of intercepting a potential numerical problem would be to compute the first part of this conceptual <code>pow</code> yourself, using</p>\n\n<pre><code>double i = ln(b);\n</code></pre>\n\n<p>If <code>c * i</code> is sufficiently small (the threshold value will be a function of the floating point scheme used on your platform), then you can proceed with the evaluation of <code>pow</code> using the C standard library function.</p>\n\n<p>It's probably unwise to finish the job yourself with <code>exp(c * i)</code>, since the standard <code>pow</code> function may well have various tricks up its sleeve to attain a result superior in accuracy to <code>exp(c * ln(b))</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 8020059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207819863874132/picture?type=large", "display_name": "AntoineMazuyer", "link": "https://stackoverflow.com/users/8020059/antoinemazuyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 1, "closed_date": 1516839369, "accepted_answer_id": 48425026, "answer_count": 1, "score": 1, "last_activity_date": 1516966301, "creation_date": 1516804458, "last_edit_date": 1516808186, "question_id": 48424967, "link": "https://stackoverflow.com/questions/48424967/how-to-avoid-floating-point-exception-when-using-pow", "closed_reason": "Not suitable for this site", "title": "How to avoid floating point exception when using pow?", "body": "<p>I use a C library which uses the <code>pow</code> function on two <code>double</code> values</p>\n\n<pre><code>double a = pow(b, c)\n</code></pre>\n\n<p>At the moment, I have <code>b = 0.62</code> and <code>c = 1504</code>, which means that <code>a</code> should be nearly 0 (3.6e-312).</p>\n\n<p>But I have a floating point exception. How to avoid it and directly return 0? Can we anticipate this case?</p>\n\n<p>I use Debian 9, 64-bit, and I compile with gcc 6.3. The library is <a href=\"https://github.com/CMA-ES/c-cmaes\" rel=\"nofollow noreferrer\">ccmaes</a> and here is the problematic line:</p>\n\n<p><a href=\"https://github.com/CMA-ES/c-cmaes/blob/eda8268ee4c8c9fbe4d2489555ae08f8a8c949b5/src/cmaes.c#L893\" rel=\"nofollow noreferrer\">https://github.com/CMA-ES/c-cmaes/blob/eda8268ee4c8c9fbe4d2489555ae08f8a8c949b5/src/cmaes.c#L893</a></p>\n\n<p>I have used gdb so the floating point exception does not come from the division (t->chiN = 2.74)</p>\n\n<p>If I try to reproduce it, with the values when the FPE occurs, I have no problem (compilation option : -fopenmp -O3 -DNDEBUG -fPIC   -Wall -Wextra -Wno-long-long -Wconversion -o, like the library)</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    double psxps = 5.6107247793270769;\n    double cs = 0.37564049253818982;\n    int gen = 752;\n    double chiN = 2.7421432615656891;\n    int N =8;\n    double foo =  sqrt(psxps) / sqrt(1. - pow(1.-cs, 2*gen)) / chiN \n      &lt; 1.4 + 2./(N+1);\n    printf(\"%lf\\n\",foo);\n}\n</code></pre>\n\n<p>Result: 1.00000000000</p>\n"}, {"tags": ["c", "gtk3", "timing", "cairo", "gdk"], "comments": [{"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1517047667, "post_id": 48424320, "comment_id": 83942734, "body": "Does any solution to this question have to work with GTK? Does it have to be portable to non-X11 (or are you even aiming for e.g. just windows)?"}, {"owner": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1517060080, "post_id": 48424320, "comment_id": 83945797, "body": "I am using Linux only, so it can be a Linux-specific solution. But, ideally it would work on any combination of window manager and compositor (we use both X11 and Wayland)."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "edited": false, "score": 0, "creation_date": 1517239317, "post_id": 48474663, "comment_id": 84002848, "body": "Hi Uli - Thanks for this! Any chance such an API is available within GTK/GDK so that it would be independent of the compositor (i.e. works for both X11 and Wayland)?"}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "reply_to_user": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "edited": false, "score": 0, "creation_date": 1517331655, "post_id": 48474663, "comment_id": 84048451, "body": "At least I don&#39;t know about anything like this within GTK/GDK, sorry. Also, I think that wayland provides some own protocol to achieve this, but I do not know the details. Sorry."}, {"owner": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "edited": false, "score": 1, "creation_date": 1517344707, "post_id": 48474663, "comment_id": 84055518, "body": "I similarly couldn&#39;t find anything in the GTK/GDK documentation (but I&#39;m certainly not an expert), glad to have some confirmation. Unless someone comes along with a better answer, I&#39;m gonna mark your answer as accepted."}], "tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": false, "score": 0, "last_activity_date": 1517331704, "last_edit_date": 1517331704, "creation_date": 1517047637, "answer_id": 48474663, "question_id": 48424320, "link": "https://stackoverflow.com/questions/48424320/precision-timing-of-gdk3-gtk3-window-update/48474663#48474663", "title": "Precision timing of GDK3/GTK3 window update", "body": "<p>Take a look at <a href=\"https://cgit.freedesktop.org/xorg/proto/presentproto/tree/presentproto.txt\" rel=\"nofollow noreferrer\">https://cgit.freedesktop.org/xorg/proto/presentproto/tree/presentproto.txt</a>. Specifically, you want <code>PresentCompleteNotify</code> events. Note that these can only tell you later when presentation actually happened, so (I think) you will not know ahead of time when this is (but you could perhaps guess based on recent notifies?).</p>\n\n<p>Note that this is</p>\n\n<ul>\n<li>a relatively new X11 extension, so might not actually be supported everywhere</li>\n<li>depends on the driver used (and likely lots of other factors) for the quality of data</li>\n<li>cannot be used from GTK since it requires a different way to display to the screen (you draw to a Pixmap and then use PresentPixmap to make it visible and ask for a notify)</li>\n</ul>\n\n<p>Also note that this extension provides lots of other things. You can for example say \"please display  at time \". Just read the protocol specification from start to end. :-)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9319280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4Z7iMQP_F3A/AAAAAAAAAAI/AAAAAAAAoHE/1d8kHWRCwv4/photo.jpg?sz=128", "display_name": "Daniel Stone", "link": "https://stackoverflow.com/users/9319280/daniel-stone"}, "is_accepted": false, "score": 1, "last_activity_date": 1517928816, "creation_date": 1517928816, "answer_id": 48645790, "question_id": 48424320, "link": "https://stackoverflow.com/questions/48424320/precision-timing-of-gdk3-gtk3-window-update/48645790#48645790", "title": "Precision timing of GDK3/GTK3 window update", "body": "<p>Similarly to Uli's answer of the Present extension and PresentCompleteNotify for X11, Wayland has a similar protocol called <code>wp_presentation_feedback</code>:</p>\n\n<p><a href=\"https://cgit.freedesktop.org/wayland/wayland-protocols/tree/stable/presentation-time/presentation-time.xml\" rel=\"nofollow noreferrer\">https://cgit.freedesktop.org/wayland/wayland-protocols/tree/stable/presentation-time/presentation-time.xml</a></p>\n\n<p>This protocol allows the Wayland compositor to inform clients when their content was actually displayed (turned to light). It is independent of the actual buffer mechanism used (EGL/SHM/etc). To use it, you call <code>wp_presentation_get_feedback</code> before <code>wl_surface_commit</code>; when the commit has completed, a <code>presented</code> event will be sent to the client from the new <code>wp_presentation_feedback</code> object, or <code>discarded</code> if it was never shown.</p>\n\n<p>Presentation feedback is currently implemented in Weston; it is not yet implemented in Mutter, and I don't believe it's implemented in KWin either. GTK+ plans to support it when it becomes available in Mutter, but I don't have any great insight as to how it would be exposed through the GTK+ API.</p>\n\n<p>That being said, if you can get access to the Wayland display, it's possible that you could use the interface directly yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "edited": false, "score": 0, "creation_date": 1518364799, "post_id": 48729913, "comment_id": 84465844, "body": "Wow! I don&#39;t know how I could have missed it! This is exactly what I have been looking for (assuming that it returns the time of the actual monitor Vsync, not just the time that the frame was handed off to X or Wayland)."}], "tags": [], "owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "is_accepted": true, "score": 0, "last_activity_date": 1518339697, "creation_date": 1518339697, "answer_id": 48729913, "question_id": 48424320, "link": "https://stackoverflow.com/questions/48424320/precision-timing-of-gdk3-gtk3-window-update/48729913#48729913", "title": "Precision timing of GDK3/GTK3 window update", "body": "<p>I just came across <a href=\"https://developer.gnome.org/gdk3/stable/gdk3-GdkFrameTimings.html#gdk-frame-timings-get-presentation-time\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gdk3/stable/gdk3-GdkFrameTimings.html#gdk-frame-timings-get-presentation-time</a> which seems to do just like what you want and is part of Gdk. I do not know how to use it nor have I seen some example of it, but <a href=\"https://developer.gnome.org/gdk3/stable/gdk3-GdkFrameTimings.html#gdk3-GdkFrameTimings.description\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gdk3/stable/gdk3-GdkFrameTimings.html#gdk3-GdkFrameTimings.description</a> says</p>\n\n<blockquote>\n  <p>The information in GdkFrameTimings is useful for precise synchronization of video with the event or audio streams, and for measuring quality metrics for the application\u2019s display, such as latency and jitter.</p>\n</blockquote>\n"}], "owner": {"reputation": 47, "user_id": 8741662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb07460d9bab38b04e4bdeefa05877b8?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/8741662/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 48729913, "answer_count": 3, "score": 2, "last_activity_date": 1518339697, "creation_date": 1516802504, "last_edit_date": 1517060364, "question_id": 48424320, "link": "https://stackoverflow.com/questions/48424320/precision-timing-of-gdk3-gtk3-window-update", "title": "Precision timing of GDK3/GTK3 window update", "body": "<p>I have an application written in C using GTK (although the language is probably unimportant for this question). </p>\n\n<p>This application has a fullscreen<code>gtk_window</code> with a single <code>gtk_drawing_area</code>. For the drawing area, I have registered a tick callback via <code>gtk_widget_add_tick_callback</code> which just calls <code>gtk_widget_queue_draw</code> every tick. Inside the drawing area <code>draw</code> callback, I change the color of the entire window at regular intervals (e.g., from black to white at 1Hz).</p>\n\n<p>Say that in this call to the draw callback I want to change the window from black to white. I would like to know the precise time (down to the nearest ms) that the change is actually drawn on the screen (ideally in the same units as <code>CLOCK_MONOTONIC</code>). I don't think this is the same thing as the <code>GdkFrameClock</code> available in the tick callback, which, as I understand it, is about the time of the frame, not the time when the frame is actually displayed on the screen. </p>\n\n<p>If I just measure the <code>CLOCK_MONOTONIC</code> time in the drawing callback, and then use a photo-diode to measure when the actual change is via an attached A2D, the actual change is the display is understandably delayed by a number of refresh intervals (in my case, 3 screen refreshes). </p>\n\n<p>Just as a summary: if I am in a GTK widget draw callback, is there any way to know the time when the display will actually be shown on the monitor in the units of <code>CLOCK_MONOTONIC</code>? Or alternatively, is there a way that I can block a separate thread until a specific redraw that I care about is actually displayed on the screen (a function I can write like <code>wait_for_screen_flip()</code>)?</p>\n\n<p>Update: Ideally, the same solution would work for any Linux compositor (X11 or Wayland), which is why I am hoping for a GTK/GDK solution, where the compositor is abstracted away.</p>\n"}, {"tags": ["python", "c", "numpy", "struct", "python-cffi"], "comments": [{"owner": {"reputation": 5121, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1516803434, "post_id": 48423725, "comment_id": 83838711, "body": "I found the line &quot;In general, a struct instance will have the alignment of its widest scalar member.&quot; (<a href=\"http://www.catb.org/esr/structure-packing/#_structure_reordering\" rel=\"nofollow noreferrer\">catb.org/esr/structure-packing/#_structure_reordering</a>) But later they mention it is possible to re-order a struct. But why does this work if every member takes the same space?"}, {"owner": {"reputation": 107, "user_id": 3996454, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5cd7803c0bf8c6b997a7dfe455b43953?s=128&d=identicon&r=PG", "display_name": "TacoVox", "link": "https://stackoverflow.com/users/3996454/tacovox"}, "edited": false, "score": 0, "creation_date": 1516803812, "post_id": 48423725, "comment_id": 83838994, "body": "Most-likely, as you mentioned yourself, the C struct is padded. For what this actually means, check out <a href=\"https://stackoverflow.com/a/4306269/3996454\">this post</a>. Therefore, when you define your dt as mentioned in your edit, you align to the padded struct by inserting a &quot;gap&quot; yourself. The programmer of the DLL would need to pack the struct in order for you to use your original dt definition."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516804809, "post_id": 48423725, "comment_id": 83839813, "body": "Your member <code>d</code> appears to be a 64-bit floating-point number (presumably a C <code>double</code>).  The layout you present in your edit ensures that that member is aligned on an 8-byte boundary whenever the whole structure is likewise aligned, and also ensures that adjacent array elements of that type can both be 8-byte aligned."}, {"owner": {"reputation": 5121, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "edited": false, "score": 0, "creation_date": 1516805033, "post_id": 48423725, "comment_id": 83839976, "body": "But if, as usually advised, the largest members are put first, there would still be a trailing padding. If I got the concept, then if the sorted order is <code>double, int, int, float</code>, there are still four bytes to fill the gap to a multiple of double. Is that correct?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516805316, "post_id": 48423725, "comment_id": 83840176, "body": "Yes, Joe, that is correct.  Reordering the elements <i>might</i> avoid padding between them, but if the compiler is laying out the structure to ensure that the <code>double</code> can be aligned on an 8-byte boundary then it must require that the whole structure have an 8-byte (at least) alignment requirement.  And the size of a type&#39;s representation must always be a multiple of its alignment requirement, else you could not form arrays of that type."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516805541, "post_id": 48423725, "comment_id": 83840338, "body": "Your compiler (MSVC++?) probably has an extension that allows you to request tighter packing, possibly without padding, sacrificing optimal alignment.  Some compilers spell that <code>#pragma pack</code> or similar, but do look up the details before trying to use such a thing.  How that might affect the rest of the stack is difficult for me to say."}], "answers": [{"tags": [], "owner": {"reputation": 10650, "user_id": 1556290, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5b37e6b4ac97453e4ba9dba37954cf79?s=128&d=identicon&r=PG", "display_name": "Armin Rigo", "link": "https://stackoverflow.com/users/1556290/armin-rigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1516827345, "creation_date": 1516827345, "answer_id": 48431442, "question_id": 48423725, "link": "https://stackoverflow.com/questions/48423725/how-to-handle-member-padding-in-c-struct-when-reading-cffi-buffer-with-numpy-fro/48431442#48431442", "title": "How to handle member padding in C struct when reading cffi.buffer with numpy.frombuffer?", "body": "<p>In addition to the other answers given in the comments, you can force cffi to pack its structs (i.e. not insert any padding, similar to what you can do using specific C compiler extensions):</p>\n\n<pre><code>ffi.cdef(\"typedef struct { char a; int b; } foo_t;\", packed=True)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5121, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "is_accepted": true, "score": 0, "last_activity_date": 1518098386, "creation_date": 1518098386, "answer_id": 48687284, "question_id": 48423725, "link": "https://stackoverflow.com/questions/48423725/how-to-handle-member-padding-in-c-struct-when-reading-cffi-buffer-with-numpy-fro/48687284#48687284", "title": "How to handle member padding in C struct when reading cffi.buffer with numpy.frombuffer?", "body": "<p>The probably most convenient way is to use the keyword <code>align=True</code> in the <a href=\"https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.dtype.html\" rel=\"nofollow noreferrer\">numpy dtype constructor</a>. That will do the padding automatically.</p>\n\n<pre><code>dt = [('a', 'i4'),\n      ('b', 'i4'),\n      ('c', 'f4'),\n      ('d', 'f8')]\n\ndt_obj = np.dtype(dt, align=True)\nx = np.frombuffer(buf, dtype=dt)\n</code></pre>\n\n<p>(see also <a href=\"https://docs.scipy.org/doc/numpy/user/basics.rec.html#offsets-and-alignment\" rel=\"nofollow noreferrer\">Numpy doc</a> on structured arrays)</p>\n"}], "owner": {"reputation": 5121, "user_id": 7919597, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/905688a3a3921c2f03f4914e943e1915?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/7919597/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 48687284, "answer_count": 2, "score": 1, "last_activity_date": 1518098434, "creation_date": 1516800706, "last_edit_date": 1518098434, "question_id": 48423725, "link": "https://stackoverflow.com/questions/48423725/how-to-handle-member-padding-in-c-struct-when-reading-cffi-buffer-with-numpy-fro", "title": "How to handle member padding in C struct when reading cffi.buffer with numpy.frombuffer?", "body": "<p>I have to read an array of C structs returned from a dll and convert it to a Numpy array. The code uses Python's cffi module.</p>\n\n<p>The code works so far but I don't know how to handle the member padding in the struct that <code>np.frombuffer</code> complains about:</p>\n\n<blockquote>\n  <p>ValueError: buffer size must be a multiple of element size</p>\n</blockquote>\n\n<p>This is my code:</p>\n\n<pre><code>from cffi import FFI\nimport numpy as np\n\ns = '''\n    typedef struct\n    {\n        int a;\n        int b;\n        float c;\n        double d;\n    } mystruct;\n    '''\n\nffi = FFI()\nffi.cdef(s)\n\nres = []\n\n#create array and fill with dummy data\nfor k in range(2):\n\n    m = ffi.new(\"mystruct *\")\n\n    m.a = k\n    m.b = k + 1\n    m.c = k + 2.0\n    m.d = k + 3.0\n\nres.append(m[0])\n\nm_arr = ffi.new(\"mystruct[]\", res)\n\nprint(m_arr)\n\n# dtype for structured array in Numpy\ndt = [('a', 'i4'),\n      ('b', 'i4'),\n      ('c', 'f4'),\n      ('d', 'f8')]\n\n# member size, 20 bytes\nprint('size, manually', 4 + 4 + 4 + 8)\n\n# total size of struct, 24 bytes\nprint('sizeof', ffi.sizeof(m_arr[0]))\n\n#reason is member padding in structs\n\nbuf = ffi.buffer(m_arr)\nprint(buf)\n\nx = np.frombuffer(buf, dtype=dt)\nprint(x)\n</code></pre>\n\n<p>Any ideas how to handle this in a clean way?</p>\n\n<hr>\n\n<h2>Edit:</h2>\n\n<p>It seems to work if I add an additional number to the dtype where the padding is supposed to happen:</p>\n\n<pre><code>dt = [('a', 'i4'),\n      ('b', 'i4'),\n      ('c', 'f4'),\n      ('pad', 'f4'),\n      ('d', 'f8')]\n</code></pre>\n\n<p>Why does the padding happen there? (Win7, 64-bit, Python 3.4 64-bit).</p>\n\n<p>But that can't be the best way. The real code is much more complicated and dynamic, so it should be possible to handle this somehow, right?</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1516798688, "post_id": 48422972, "comment_id": 83835501, "body": "You don&#39;t need to create the separate <code>p</code> variable, just passing <code>&amp;a</code> will do."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1516799233, "post_id": 48422972, "comment_id": 83835889, "body": "Add some ampersands here: <code>fscanf(&quot;%d%d%d&quot;,  &amp;x-&gt;dag.dag, &amp;x-&gt;dag.maand, &amp;x-&gt;dag.jaar);</code>   And, you dont need the atoi(), these variables <b>are</b> ints: <code>a = atoi(x-&gt;dag.dag);</code>"}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516799531, "post_id": 48422972, "comment_id": 83836092, "body": "@wildplasser argv returns strings. so i have to convert them into integers?"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516799632, "post_id": 48422972, "comment_id": 83836172, "body": "<code>printf(&quot;Het aantal argumenten die ingegeven is niet correct\\n&quot;);</code> And please correct your Dutch... (<b>het</b> aantal, <b>dat</b>, or <b>die</b> ingegeven <b>zijn</b>) . And: <code>x-&gt;dag.dag</code> is not <code>argv[xxx]</code>"}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516799787, "post_id": 48422972, "comment_id": 83836273, "body": "@wildplasser this is a code related issue and has nothing to do with my grammar. Apart from me and people who are able to read Dutch, nobody cares about it. But thank you for the input"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516800467, "post_id": 48422972, "comment_id": 83836703, "body": "Also, the message is non-informative. Instead, it should say how many arguments were expected, and how many were encountered. Same for: <code>printf(&quot;De file kon niet worden geopend\\n&quot;);</code> : <b>which</b> file? (and: diagnostic output should go to stderr)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516801646, "post_id": 48422972, "comment_id": 83837477, "body": "I get lots of warnings when I compile this code."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516799339, "post_id": 48423089, "comment_id": 83835967, "body": "this returns in error C4703: potentially uninitialized local pointer variable &#39;fp&#39; used"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516799469, "post_id": 48423089, "comment_id": 83836059, "body": "@michielreyntjens C4703 is a warning, not an error. I don&#39;t know what else you changed in your code, so it&#39;s hard to tell, but..."}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516799616, "post_id": 48423089, "comment_id": 83836160, "body": "C4703 is an error. i&#39;t stopped compiling caused to this error. I just did what you suggested, pass the filepointer to the function. the C4703 says my filepointer is probably not initialized. which it is clearly..."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516799690, "post_id": 48423089, "comment_id": 83836210, "body": "@michielreyntjens No, it&#39;s not an error. It&#39;s a warning; perhaps your IDE is configured to treat warnings as errors. And your code has other errors preventing the build anyway. <a href=\"http://coliru.stacked-crooked.com/a/09fb932d8045fa0b\" rel=\"nofollow noreferrer\">Here it is compiling with no warnings</a>."}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516800052, "post_id": 48423089, "comment_id": 83836453, "body": "The code you sen&#39;t me still gives an error on line 64. where you put the braces behind tijd. It asks for a semicolon. When i put the code back you commented out i juste have the same errors?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516801078, "post_id": 48423089, "comment_id": 83837110, "body": "@michielreyntjens yeah, but that&#39;s another function. The part you were asking about is done correctly."}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516802946, "post_id": 48423089, "comment_id": 83838394, "body": "What is the reason you added the brackers {} to the instance of tijd &quot;geboortedag tijd {};&quot;? i understand what you did but when i try to solve the calculate function it still gives the error about the file pointer?"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1516798621, "creation_date": 1516798621, "answer_id": 48423089, "question_id": 48422972, "link": "https://stackoverflow.com/questions/48422972/how-to-use-a-file-pointer-in-a-called-function-in-c/48423089#48423089", "title": "How to use a file pointer in a called function in C", "body": "<p>The easiest way is to simply pass the file pointer to the <code>read</code> function:</p>\n\n<pre><code>void readperson(FILE *fp, persoon *x);\n</code></pre>\n\n<p>Then in <code>main</code>:</p>\n\n<pre><code>readperson(fp, p);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516799101, "post_id": 48423101, "comment_id": 83835790, "body": "so why is this strange? When i run the program with cmd and give in al my arguments. cmd closes and i receive windows message telling the program stopped working. What could be the reason to this?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516801914, "post_id": 48423101, "comment_id": 83837659, "body": "Well, not exactly strange, let&#39;s say there were more code modifications than simply moving the pointer outside of main. BTW, how do you run it, as a command issued in console?"}, {"owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "edited": false, "score": 0, "creation_date": 1516803635, "post_id": 48423101, "comment_id": 83838858, "body": "I use cmd and go the the directory where my .exe is. Then I type in the program name and the necessary arguments to go with it."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 0, "last_activity_date": 1516834603, "last_edit_date": 1516834603, "creation_date": 1516798677, "answer_id": 48423101, "question_id": 48422972, "link": "https://stackoverflow.com/questions/48422972/how-to-use-a-file-pointer-in-a-called-function-in-c/48423101#48423101", "title": "How to use a file pointer in a called function in C", "body": "<p>It is quite strange that it crashes when you declare fp globally but since you gave no more details, let's leave it.</p>\n\n<p>Simply pass the file pointer to every procedure that needs it. So, their protos change into</p>\n\n<pre><code>void readperson(FILE *, persoon *);\n</code></pre>\n\n<p>and they are called as</p>\n\n<pre><code>readperson(fp, p);\n</code></pre>\n\n<p>from the main.</p>\n"}], "owner": {"reputation": 27, "user_id": 8830746, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8029d749977ec6fed5b40e0e40a9b1ac?s=128&d=identicon&r=PG&f=1", "display_name": "reyntjensm", "link": "https://stackoverflow.com/users/8830746/reyntjensm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 48423101, "answer_count": 2, "score": -1, "last_activity_date": 1516834603, "creation_date": 1516798326, "last_edit_date": 1516803571, "question_id": 48422972, "link": "https://stackoverflow.com/questions/48422972/how-to-use-a-file-pointer-in-a-called-function-in-c", "title": "How to use a file pointer in a called function in C", "body": "<p>I wrote some code as a school exercise.\nWe need to use structs and functions for this exercise.\nI want to read some date out a file with one function and save this data to a struct. Next i have another function to do an easy calculation on this data. \nI initialize my filepointer in the main function with fopen, the problem is i want to use the same pointer in a function called by the main.\nMy program compiles when i declare my FILE *fp outside the main function but it crashes while running. \nDoes anyone can help me with this? Thank you all.\nHere is the code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\ntypedef struct\n{\n    int dag;\n    int maand;\n    int jaar;\n}geboortedag;\n\ntypedef struct \n{\n    char name[BUFSIZ];\n    geboortedag dag;\n}persoon;\n\nvoid readperson(persoon *);\ngeboortedag calculate(p);\n\nint main(int argc, char *argv[])\n{\n    FILE *fp;\n    persoon a;\n    persoon *p;\n    p = &amp;a;\n    geboortedag leeftijd;\n\n    if (argc != 5)\n    {\n        printf(\"Het aantal argumenten die ingegeven is niet correct\\n\");\n        getchar();\n        exit(1);\n    }\n    else if (argc == 5)\n    {\n        if ((fp = fopen(argv[1], \"r\")) == NULL)\n        {\n            printf(\"De file kon niet worden geopend\\n\");\n            getchar();\n            exit(2);\n        }\n    }\n\n    readperson(p);\n    leeftijd = calculate(p);\n    printf(\"De leeftijd is %d %d %d\", leeftijd.dag, leeftijd.maand,   leeftijd.jaar);\n    fclose(fp);\n    printf(\"Het bestand is correct afegsloten\");\n    getchar();\n    return 0;\n}\n\nvoid readperson(persoon *x)\n{\n    char a[BUFSIZ];\n    fgets(a, BUFSIZ, fp);\n    strcpy(x-&gt;name, a);\n    fscanf(\"%d%d%d\", x-&gt;dag.dag, x-&gt;dag.maand, x-&gt;dag.jaar);\n}\n\ngeboortedag calculate(persoon *x)\n{\n    geboortedag tijd;\n    int a, b, c;\n    a = atoi(x-&gt;dag.dag);\n    b = atoi(x-&gt;dag.maand);\n    c = atoi(x-&gt;dag.jaar);\n    tijd.dag = x-&gt;dag.dag - a;\n    tijd.maand = x-&gt;dag.maand;\n    tijd.jaar = x-&gt;dag.jaar;\n    return tijd;\n}\n</code></pre>\n\n<p>EDIT:\nSo i tried what was suggested here. I'm still getting an error about the filepointer that might not be initialized... </p>\n\n<p>Error   C4703   potentially uninitialized local pointer variable 'fp' used  </p>\n\n<p>This is the updated code:</p>\n\n<pre><code>#define _CRT_SECURE_NO_WARNINGS\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\ntypedef struct\n{\n    int dag;\n    int maand;\n    int jaar;\n}geboortedag;\n\ntypedef struct\n{\n    char name[BUFSIZ];\n    geboortedag dag;\n}persoon;\n\nvoid readperson(FILE* fp, persoon *p);\ngeboortedag calculate(persoon *p);\n\nint main(int argc, char *argv[])\n{\n    FILE *fp;\n    persoon a;\n    persoon *p;\n    p = &amp;a;\n    geboortedag leeftijd;\n\n    if (argc != 5)\n    {\n        printf(\"Het aantal argumenten die ingegeven is niet correct\\n\");\n        getchar();\n        exit(1);\n    }\n    else if (argc == 5)\n    {\n        if ((fp = fopen(argv[1], \"r\")) == NULL)\n        {\n            printf(\"De file kon niet worden geopend\\n\");\n            getchar();\n            exit(2);\n        }\n    }\n\n    readperson(fp, p);\n    leeftijd = calculate(p);\n    printf(\"De leeftijd is %d %d %d\", leeftijd.dag, leeftijd.maand, leeftijd.jaar);\n    fclose(fp);\n    printf(\"Het bestand is correct afegsloten\");\n    getchar();\n    return 0;\n}\n\nvoid readperson(FILE* fp, persoon *x)\n{\n    char a[BUFSIZ];\n    fgets(a, BUFSIZ, fp);\n    strcpy(x-&gt;name, a);\n    fscanf(fp, \"%d%d%d\", &amp;x-&gt;dag.dag, &amp;x-&gt;dag.maand, &amp;x-&gt;dag.jaar);\n}\n\ngeboortedag calculate(persoon *x)\n{\n    geboortedag tijd = { 0, 0, 0 };\n    /*int a, b, c;\n    a = atoi(x-&gt;dag.dag);\n    b = atoi(x-&gt;dag.maand);\n    c = atoi(x-&gt;dag.jaar);\n    tijd.dag = x-&gt;dag.dag - a;\n    tijd.maand = x-&gt;dag.maand;\n    tijd.jaar = x-&gt;dag.jaar;*/\n    return tijd;\n}\n</code></pre>\n"}, {"tags": ["c", "hex", "converter"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1516798269, "post_id": 48422785, "comment_id": 83835218, "body": "Wrong format specifier for char."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1516798298, "post_id": 48422785, "comment_id": 83835239, "body": "You are using <a href=\"http://www.cplusplus.com/reference/cstdlib/atoi/\" rel=\"nofollow noreferrer\"><code>atoi</code></a> for converting a number in <b>hexadecimal</b> representation to an <code>int</code>, but <code>atoi</code> is designed for converting a number in <b>decimal</b> representation."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1516798388, "post_id": 48422785, "comment_id": 83835302, "body": "BTW what output do you expect? <i>I think the stray values are the null terminator</i>, no you think wrong."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1516798448, "post_id": 48422785, "comment_id": 83835351, "body": "@MartinJames I don&#39;t think that this is the problem here, see my first comment"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9262362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6b7d1c300209ddc264e501eaac1196e?s=128&d=identicon&r=PG&f=1", "display_name": "Anders Dellien", "link": "https://stackoverflow.com/users/9262362/anders-dellien"}, "is_accepted": false, "score": 0, "last_activity_date": 1516801569, "creation_date": 1516801569, "answer_id": 48424016, "question_id": 48422785, "link": "https://stackoverflow.com/questions/48422785/convert-decimal-to-hex-and-store-to-array-in-c/48424016#48424016", "title": "Convert Decimal to Hex and store to array in C", "body": "<p><code>atoi</code> assumes decimal representation, try <code>strtol(dump_holder, NULL, 16);</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1516807752, "last_edit_date": 1516807752, "creation_date": 1516807157, "answer_id": 48425895, "question_id": 48422785, "link": "https://stackoverflow.com/questions/48422785/convert-decimal-to-hex-and-store-to-array-in-c/48425895#48425895", "title": "Convert Decimal to Hex and store to array in C", "body": "<p>To understand the problem in your code, you first need to understand -<br>\nHow <code>atoi</code> works?  </p>\n\n<p>Read about <code>atoi</code> and go through the example demonstrating its behavior \n<a href=\"http://en.cppreference.com/w/c/string/byte/atoi\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>In your program output, after <code>09</code> you are getting six times <code>00</code> because the <code>atoi</code> is returning <code>0</code> for the hex values <code>0a</code>, <code>0b</code>, <code>0c</code>, <code>0d</code>, <code>0e</code> and <code>0f</code>.<br>\nAfter this the program output is:<br>\n<code>this: 0a\nthis: 0b\nthis: 0c\nthis: 0d\nthis: 0e\nthis: 0f</code></p>\n\n<p>Reason is -<br>\nThe hex value after <code>0f</code> is <code>10</code>. <code>10</code> is stored in <code>dump_holder</code> variable which is passed to <code>atoi</code>.<br>\n<code>atoi</code> returned integer value <code>10</code> which is stored in <code>hex_holder[i]</code>.<br>\nYour program is printing the value stored in <code>hex_holder[i]</code>, which is of type <code>char</code>, using <code>%x</code> format specifier. So, the value <code>10</code> is getting printed as <code>0a</code>.</p>\n\n<p>Using incorrect format specifier is undefined behavior which includes it may do exactly what the programmer intended or silently generating incorrect results or anything else.</p>\n\n<p>Just to convert decimal from 1 to 99 to hexadecimal and store them into an array, you can do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char hex_holder[100][3];\n    for (int i = 1; i &lt; 100; i++) {\n        snprintf (hex_holder[i], 3, \"%02x\", i);\n        printf(\"this: %s\\n\", hex_holder[i]);\n    }   \n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 610, "user_id": 8979940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DmzYf.jpg?s=128&g=1", "display_name": "Omer Dagan", "link": "https://stackoverflow.com/users/8979940/omer-dagan"}, "is_accepted": false, "score": 1, "last_activity_date": 1516807314, "creation_date": 1516807314, "answer_id": 48425940, "question_id": 48422785, "link": "https://stackoverflow.com/questions/48422785/convert-decimal-to-hex-and-store-to-array-in-c/48425940#48425940", "title": "Convert Decimal to Hex and store to array in C", "body": "<p>well, the basic thing is I cannot understand what you are actually trying to achive</p>\n\n<p>but I will try my best:</p>\n\n<pre><code>int main(){\nint i =1;\nchar dump_holder[3];\nchar hex_holder[100];\nfor (i=1;i&lt;100;i++){\n    /* convert numerical value to string */\n    sprintf(dump_holder, \"%02x\",i); \n\n    /* convert string value back to numerical value */\n    //hex_holder[i] = atoi(dump_holder); //won't work\n    hex_holder[i] = strtol(dump_holder, NULL, 16); // this will\n\n    /* print the numerical value in hex representation */\n    printf(\"this: %02x\\n\", hex_holder[i]);\n}\nreturn 0;}\n</code></pre>\n\n<ul>\n<li>are you trying to create a string representation of the values in hex format?\nif so, you are going about this the wrong way</li>\n<li>right now you are not doing much except wasting proccessing power</li>\n</ul>\n\n<p>even so i added a small code that will actuallt conver the code to a string representation of the values. Maybe that is what you actually intended to do</p>\n\n<pre><code>int main()\n{\n    int i = 1;\n    char dump_holder[3];\n\n    /* the array should be an array of strings (restricted here to 2chars) */\n    char hex_holder[100][2];\n\n    for (i=1;i&lt;100;i++){\n        /* convert numerical value to string representation */\n        sprintf(hex_holder[i], \"%02x\",i);\n        /* print the string produced */\n        printf(\"this: %s\\n\", hex_holder[i]);  \n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 249, "user_id": 4165025, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1609068875/picture?type=large", "display_name": "Enzo Vidal", "link": "https://stackoverflow.com/users/4165025/enzo-vidal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1487, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1516807752, "creation_date": 1516797734, "last_edit_date": 1516806908, "question_id": 48422785, "link": "https://stackoverflow.com/questions/48422785/convert-decimal-to-hex-and-store-to-array-in-c", "title": "Convert Decimal to Hex and store to array in C", "body": "<p>I've been trying to convert decimal from 1 to 99 to hexadecimal and store them into an array.</p>\n\n<p>What I have is something like this:</p>\n\n<pre><code>int main(){\nint i =1;\nchar dump_holder[3];\nchar hex_holder[100];\nfor (i=1;i&lt;100;i++){\n    sprintf(dump_holder, \"%02x\",i);\n    hex_holder[i] = atoi(dump_holder);\n    printf(\"this: %02x\\n\", hex_holder[i]);\n\n}\nreturn 0;}\n</code></pre>\n\n<p>I'm getting correct value a certain number. This code returns:</p>\n\n<pre><code>this: 01\nthis: 02\nthis: 03\nthis: 04\nthis: 05\nthis: 06\nthis: 07\nthis: 08\nthis: 09\nthis: 00\nthis: 00\nthis: 00\nthis: 00\nthis: 00\nthis: 00\nthis: 0a\nthis: 0b\nthis: 0c\nthis: 0d\nthis: 0e\nthis: 0f\nthis: 10\nthis: 11\nthis: 12\nthis: 13\nthis: 01\nthis: 01\nthis: 01\nthis: 01\nthis: 01\nthis: 01\nthis: 14\nthis: 15\nthis: 16\nthis: 17\nthis: 18\nthis: 19\nthis: 1a\nthis: 1b\nthis: 1c\nthis: 1d\n</code></pre>\n\n<p>I think the stray values are the null terminator, but I'm not sure.</p>\n"}, {"tags": ["c", "mongodb", "mongodb-.net-driver"], "comments": [{"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1516798035, "post_id": 48422637, "comment_id": 83835074, "body": "If you need a <b>single</b> document <b>displayed</b> with it&#39;s array items ordered in a fancy way it would be better to sort them client side really."}, {"owner": {"reputation": 452, "user_id": 4906477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2514da2661c6e56d4e5c1d41e6a6137?s=128&d=identicon&r=PG", "display_name": "Prince Odame", "link": "https://stackoverflow.com/users/4906477/prince-odame"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1516798435, "post_id": 48422637, "comment_id": 83835338, "body": "@AlexBlex is right. You will have to do that client side. Mongodb does not support such ordering; only ascending or descending."}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "reply_to_user": {"reputation": 452, "user_id": 4906477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2514da2661c6e56d4e5c1d41e6a6137?s=128&d=identicon&r=PG", "display_name": "Prince Odame", "link": "https://stackoverflow.com/users/4906477/prince-odame"}, "edited": false, "score": 1, "creation_date": 1516798783, "post_id": 48422637, "comment_id": 83835564, "body": "@OdamePrince, it is possible to do it with aggregation, but even if you can, it doesn&#39;t mean you should."}, {"owner": {"reputation": 462, "user_id": 2004251, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LlIit.jpg?s=128&g=1", "display_name": "gvk", "link": "https://stackoverflow.com/users/2004251/gvk"}, "reply_to_user": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1516800066, "post_id": 48422637, "comment_id": 83836466, "body": "@AlexBlex, there will be multiple documents like this"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 0, "creation_date": 1516800460, "post_id": 48422637, "comment_id": 83836698, "body": "Do you fetch/display all of them at once? You don&#39;t sort documents, only <code>Types</code> items within a document, unless I misunderstand the question."}, {"owner": {"reputation": 462, "user_id": 2004251, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LlIit.jpg?s=128&g=1", "display_name": "gvk", "link": "https://stackoverflow.com/users/2004251/gvk"}, "edited": false, "score": 0, "creation_date": 1516800768, "post_id": 48422637, "comment_id": 83836906, "body": "We do sort it by name also, and by the internal types. We will be showing 5 documents at a time"}, {"owner": {"reputation": 24603, "user_id": 1110423, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ed86330a464a2bc0069dfdfc35524f2e?s=128&d=identicon&r=PG", "display_name": "Alex Blex", "link": "https://stackoverflow.com/users/1110423/alex-blex"}, "edited": false, "score": 1, "creation_date": 1516802325, "post_id": 48422637, "comment_id": 83837948, "body": "So let mongodb to sort documents by name, and then sort the types in the representation layer. To make it crystal clear, sorting subdocuments on the database level is quite expensive. It is no cheaper than doing it on the client  anyway."}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 4308396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYxw3.png?s=128&g=1", "display_name": "Ramraj Patel", "link": "https://stackoverflow.com/users/4308396/ramraj-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1516803709, "creation_date": 1516803709, "answer_id": 48424719, "question_id": 48422637, "link": "https://stackoverflow.com/questions/48422637/sort-in-mongodb-using-a-specific-order/48424719#48424719", "title": "Sort in mongoDB using a specific order", "body": "<p>Custom ordering is not possible in MongoDB. You can either sort ascending or descending.</p>\n"}, {"tags": [], "owner": {"reputation": 502, "user_id": 748156, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/65c8d46d9164bf023aca27b03e45d86a?s=128&d=identicon&r=PG", "display_name": "Mahesh", "link": "https://stackoverflow.com/users/748156/mahesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1558521941, "creation_date": 1558521941, "answer_id": 56255061, "question_id": 48422637, "link": "https://stackoverflow.com/questions/48422637/sort-in-mongodb-using-a-specific-order/56255061#56255061", "title": "Sort in mongoDB using a specific order", "body": "<p>Custom ordering is possible via aggregation as specified <a href=\"https://koenaerts.ca/mongodb-aggregation-custom-sort/\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 462, "user_id": 2004251, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LlIit.jpg?s=128&g=1", "display_name": "gvk", "link": "https://stackoverflow.com/users/2004251/gvk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558521941, "creation_date": 1516797312, "question_id": 48422637, "link": "https://stackoverflow.com/questions/48422637/sort-in-mongodb-using-a-specific-order", "title": "Sort in mongoDB using a specific order", "body": "<p>I am currently looking to sort the sub document, <code>Clients</code>, in a particular order based on an array. </p>\n\n<p>The mongoDB structure is</p>\n\n<pre><code>{\n    \"_id\" : \"1033\",\n    \"Name\" : \"Test\",\n    \"Clients\" : [ \n        {\n            \"Id\" : 1033,\n            \"Types\" : [ \n                {\n                    \"Class\" : \"C\",\n                    \"Service\" : null\n                },\n                {\n                    \"Class\" : \"B\",\n                    \"Service\" : null\n                }\n            ]\n        }, \n        {\n            \"Id\" : 156136,\n            \"Types\" : [ \n                {\n                    \"Class\" : \"A\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"B\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"C\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"D\",\n                    \"Service\" : null\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>I need the above document displayed in the order based on a array like <code>[B, A, D, C]</code></p>\n\n<p>So that the output would be as below:</p>\n\n<pre><code>{\n    \"_id\" : \"1033\",\n    \"Name\" : \"Test\",\n    \"Clients\" : [ \n        {\n            \"Id\" : 1033,\n            \"Types\" : [ \n                {\n                    \"Class\" : \"B\",\n                    \"Service\" : null\n                },\n                {\n                    \"Class\" : \"C\",\n                    \"Service\" : null\n                }\n            ]\n        }, \n        {\n            \"Id\" : 156136,\n            \"Types\" : [ \n                {\n                    \"Class\" : \"B\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"A\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"D\",\n                    \"Service\" : null\n                }, \n                {\n                    \"Class\" : \"C\",\n                    \"Service\" : null\n                }\n            ]\n        }\n    ]\n}\n</code></pre>\n\n<p>Could you please help me on how to achieve this?</p>\n\n<p>I am currently using MongoDB Driver for .Net</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 1, "creation_date": 1516797224, "post_id": 48422573, "comment_id": 83834558, "body": "Check the length of what you&#39;re trying to write against the size of the buffer? There&#39;s no built-in function to do what you want, so you need to roll it manually or find a library that does it."}, {"owner": {"reputation": 657, "user_id": 7875117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f631a84cb74a039123c5e8c58f3c28db?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Johnson", "link": "https://stackoverflow.com/users/7875117/derek-johnson"}, "reply_to_user": {"reputation": 35327, "user_id": 27678, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7496124d499d578df1e3a6ff85e7ae03?s=128&d=identicon&r=PG", "display_name": "AndyG", "link": "https://stackoverflow.com/users/27678/andyg"}, "edited": false, "score": 0, "creation_date": 1516797416, "post_id": 48422573, "comment_id": 83834668, "body": "That would mean that I have to store input I want to put via sprintf and check it&#39;s length with BUFFER_LEN or is there a way to access length of the second argument of sprintf() funtion, which in this case would be &quot;Oh noes, it&#39;s too long! What can I do&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516798657, "post_id": 48422634, "comment_id": 83835478, "body": "@wildplasser Agree."}, {"owner": {"reputation": 657, "user_id": 7875117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f631a84cb74a039123c5e8c58f3c28db?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Johnson", "link": "https://stackoverflow.com/users/7875117/derek-johnson"}, "edited": false, "score": 0, "creation_date": 1516801361, "post_id": 48422634, "comment_id": 83837297, "body": "Thank you very much, that what I was looking for!"}, {"owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1516801443, "post_id": 48422634, "comment_id": 83837354, "body": "@wildplasser I guess you meant <code>strlen()</code> which I avoided on purpose."}], "tags": [], "owner": {"reputation": 29848, "user_id": 5958455, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lBWIE.png?s=128&g=1", "display_name": "iBug", "link": "https://stackoverflow.com/users/5958455/ibug"}, "is_accepted": true, "score": 6, "last_activity_date": 1516798420, "last_edit_date": 1516798420, "creation_date": 1516797303, "answer_id": 48422634, "question_id": 48422573, "link": "https://stackoverflow.com/questions/48422573/writing-to-file-if-sprintf-buffer-is-overflow/48422634#48422634", "title": "Writing to file if sprintf() buffer is overflow?", "body": "<p>Sure. Check the output length with <code>snprintf()</code> first:</p>\n\n<pre><code>int len = snprintf(NULL, 0, \"Oh noes, it's too long! What can I do?\");\n</code></pre>\n\n<p>And then you have <code>len</code> which you can do necessary evaluation and comparison.</p>\n\n<p>From <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">CppReference</a>:</p>\n\n<blockquote>\n  <h3>Return value</h3>\n  \n  <p><code>snprintf()</code>: number of characters (not including the terminating null character) which would have been written to buffer if bufsz was ignored, or a negative value if an encoding error (for string and character conversion specifiers) occurred</p>\n</blockquote>\n\n<p>So it will write a limited number of characters to the buffer (specified by the 2nd argument), and return <strong>the length of the full data that would have been written</strong>, which makes it a good function for string length evaluation.</p>\n"}], "owner": {"reputation": 657, "user_id": 7875117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f631a84cb74a039123c5e8c58f3c28db?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Johnson", "link": "https://stackoverflow.com/users/7875117/derek-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 48422634, "answer_count": 1, "score": 1, "last_activity_date": 1516798420, "creation_date": 1516797118, "question_id": 48422573, "link": "https://stackoverflow.com/questions/48422573/writing-to-file-if-sprintf-buffer-is-overflow", "title": "Writing to file if sprintf() buffer is overflow?", "body": "<p>let's say I have this simple code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define BUFFER_LEN 10\nint main()\n{\n    char buffer[BUFFER_LEN];\n    sprintf(buffer, \"Oh noes, it's too long! What can I do?\");\n\n    return 0; \n}\n</code></pre>\n\n<p>Obviously it won't work since the buffer is too small to contain string. I know that there are different functions that can be used, and different memory handling for buffer. \nHowever my question is: is it possible to somehow check if buffer is overflown, and if so open text file and write to it, instead of putting it inside of the buffer.</p>\n"}, {"tags": ["c", "sqlite"], "comments": [{"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516810114, "post_id": 48422033, "comment_id": 83843851, "body": "The information in the AppendVFS file is pretty straightforward. This is meant to be done at the C API level. If you&#39;re using a wrapper for SQLite, check with the provider to see if they implement this. Otherwise, you&#39;ll have to write the C code yourself."}], "answers": [{"tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": true, "score": 2, "last_activity_date": 1516822744, "last_edit_date": 1516822744, "creation_date": 1516821450, "answer_id": 48430050, "question_id": 48422033, "link": "https://stackoverflow.com/questions/48422033/how-to-append-a-database-to-an-excutable/48430050#48430050", "title": "How to append a database to an excutable", "body": "<p>Just load or link the extension into your application, and open the database with that VFS:</p>\n\n<pre><code>// append-test.c\n\n#include &lt;stdio.h&gt;\n#include &lt;sqlite3.h&gt;\n\nint main()\n{\n    extern int sqlite3_appendvfs_init(sqlite3 *, char **, const sqlite3_api_routines *);\n    sqlite3_appendvfs_init(NULL, NULL, NULL); // this works only if linked statically\n\n    sqlite3 *db;\n    sqlite3_open_v2(\"append-test\", &amp;db,\n                    SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE,\n                    \"apndvfs\");\n    // error handling is for wimps\n\n    sqlite3_exec(db, \"CREATE TABLE IF NOT EXISTS test(msg)\", NULL, NULL, NULL);\n\n    sqlite3_stmt *stmt;\n    sqlite3_prepare_v2(db, \"SELECT msg FROM test\", -1, &amp;stmt, NULL);\n\n    switch (sqlite3_step(stmt)) {\n\n    case SQLITE_DONE:\n        sqlite3_exec(db, \"INSERT INTO test VALUES('Hello, world!')\", NULL, NULL, NULL);\n        break;\n\n    case SQLITE_ROW:\n        puts(sqlite3_column_text(stmt, 0));\n        break;\n    }\n\n    sqlite3_finalize(stmt);\n    sqlite3_close(db);\n    return 0;\n}\n</code></pre>\n\n<p>When using static linking, <a href=\"http://www.sqlite.org/loadext.html#statically_linking_a_run_time_loadable_extension\" rel=\"nofollow noreferrer\">the extension must be compiled with <code>SQLITE_CORE</code></a>:</p>\n\n<pre>\n$ gcc -o append-test -D SQLITE_CORE append-test.c sqlite3.c appendvfs.c -lpthread -ldl\n</pre>\n\n<p>An executing executable cannot be written to, so run a copy:</p>\n\n<pre>\n$ ls -l\n-rwxr-xr-x 1 cl users 901336 Jan 24 20:09 append-test\n$ cp append-test append-test-2; append-test-2; rm append-test-2\n$ ls -l\n-rwxr-xr-x 1 cl users 913433 Jan 24 20:09 append-test\n$ append-test\nHello, world!\n</pre>\n\n<p>In the real world, you would instead load the <code>appendvfs.dll</code>/<code>appendvfs.so</code> file into the <code>sqlite3</code> command-line shell with <code>.load</code>, and create the database in your application's executable file from there, manually or with a script.</p>\n"}], "owner": {"reputation": 1983, "user_id": 939280, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/luAYh.jpg?s=128&g=1", "display_name": "Ka\u011fan Kayal", "link": "https://stackoverflow.com/users/939280/ka%c4%9fan-kayal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 48430050, "answer_count": 1, "score": 1, "last_activity_date": 1516822744, "creation_date": 1516795352, "last_edit_date": 1516822002, "question_id": 48422033, "link": "https://stackoverflow.com/questions/48422033/how-to-append-a-database-to-an-excutable", "title": "How to append a database to an excutable", "body": "<p>According to the <a href=\"https://sqlite.org/releaselog/3_22_0.html\" rel=\"nofollow noreferrer\">SQLite release notes</a>, it is possible to append a database to an executable:</p>\n\n<blockquote>\n  <p>The <a href=\"https://sqlite.org/src/file/ext/misc/appendvfs.c\" rel=\"nofollow noreferrer\">Append VFS</a> is a <a href=\"http://www.sqlite.org/vfs.html#shim\" rel=\"nofollow noreferrer\">VFS shim</a> that allows an SQLite database to be\n  appended to some other file. This allows (for example) a database to\n  be appended to an executable that then opens and reads the database.</p>\n</blockquote>\n\n<p>How can I do that?</p>\n"}, {"tags": ["c", "linux", "gcc", "makefile"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1516794749, "post_id": 48421816, "comment_id": 83833061, "body": "Make <code>$(CODE1_OBJECTS)</code> <i>depend</i> on <code>$(CODE1_HEADERS)</code>? And if that can be multiple object files and header files, you have to list the dependencies explicitly."}, {"owner": {"reputation": 1589, "user_id": 1221106, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/446a06be40a16b516e0b9dc03cecd984?s=128&d=identicon&r=PG", "display_name": "igagis", "link": "https://stackoverflow.com/users/1221106/igagis"}, "edited": false, "score": 1, "creation_date": 1516795159, "post_id": 48421816, "comment_id": 83833313, "body": "It is better to use <code>-MD -MF</code> keys to <code>gcc</code> to generate headers dependency files and then include those to your makefile. I have done that in my templates for non-recursive make, you can have a look and possiblu use my templates: <a href=\"https://github.com/igagis/prorab/blob/master/wiki/TutorialBasicConcepts.md\" rel=\"nofollow noreferrer\">github.com/igagis/prorab/blob/master/wiki/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516798313, "post_id": 48421936, "comment_id": 83835247, "body": "That <code>$(CPPFLAGS)</code> should be <code>$(CFLAGS)</code> since it&#39;s compiling C code not C++ code"}, {"owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1516804756, "post_id": 48421936, "comment_id": 83839765, "body": "@ChrisTurner: Fixed that! Thanks"}], "tags": [], "owner": {"reputation": 19779, "user_id": 878532, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/5fbebb625a289267abd098c0e676c760?s=128&d=identicon&r=PG", "display_name": "Klaus", "link": "https://stackoverflow.com/users/878532/klaus"}, "is_accepted": false, "score": 2, "last_activity_date": 1516799599, "last_edit_date": 1516799599, "creation_date": 1516795062, "answer_id": 48421936, "question_id": 48421816, "link": "https://stackoverflow.com/questions/48421816/makefile-to-rebuild-during-header-file-changes/48421936#48421936", "title": "Makefile to rebuild during header file changes", "body": "<p>What you do seems unusual to me.</p>\n\n<p>The typical way is to have a list of source files which can be written by hand or evaluated automatically e.g. by catching all c files from one or more directories. That is what you already do with: <code>CODE1_SOURCES := $(wildcard $(PATH_CODE1)/*.c)</code> </p>\n\n<p>But the dependencies for each file should be generated automatically. For example gcc provides the '-M' or '-MM' option to rebuild the so called dependency files, typically named '.d' or '.dep'</p>\n\n<p>A good document for the complete process can be found here:</p>\n\n<p><a href=\"http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/#basic\" rel=\"nofollow noreferrer\">http://make.mad-scientist.net/papers/advanced-auto-dependency-generation/#basic</a></p>\n\n<p>For the simple case this is an example taken from the above document:</p>\n\n<pre><code>SRCS = foo.c bar.c ...\n\n%.o : %.c\n    @$(MAKEDEPEND); \\\n      cp $*.Td $*.d; \\\n      sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n          -e '/^$$/ d' -e 's/$$/ :/' &lt; $*.Td &gt;&gt; $*.d; \\\n      rm -f $*.Td\n    $(COMPILE.c) -o $@ $&lt;\n\ninclude $(wildcard $(SRCS:.c=.d))\n</code></pre>\n\n<p>If using gcc MAKEDEPEND can be:</p>\n\n<pre><code>MAKEDEPEND = gcc -M $(CPPFLAGS) -o $*.Td $&lt;\n</code></pre>\n\n<p>A short explanation:</p>\n\n<p>In general you define the rule how a %.o file is generated from a %.o file with:</p>\n\n<pre><code>%.o : %.c\n</code></pre>\n\n<p>As the first step in that rule you build the depfile always if the source must be compiled, typically if the %.o file did not exist OR the dependencies are newer than the %.o file with:</p>\n\n<pre><code>gcc -M $(CFLAGS) -o $*.Td $&lt;\n</code></pre>\n\n<p>The last line given from the excerpt did include all these automatically generated dependency files by simply including them into the Makefile itself with: </p>\n\n<pre><code>include $(wildcard $(SRCS:.c=.d))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 874, "user_id": 2039127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DqUSC.jpg?s=128&g=1", "display_name": "Gomu", "link": "https://stackoverflow.com/users/2039127/gomu"}, "edited": false, "score": 0, "creation_date": 1517113849, "post_id": 48460827, "comment_id": 83959269, "body": "Thanks for providing a simpler solution!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5980164"}, "is_accepted": true, "score": 1, "last_activity_date": 1516967448, "creation_date": 1516967448, "answer_id": 48460827, "question_id": 48421816, "link": "https://stackoverflow.com/questions/48421816/makefile-to-rebuild-during-header-file-changes/48460827#48460827", "title": "Makefile to rebuild during header file changes", "body": "<p>The sed statements in the rule are not needed. Gcc supports the -MF option to control the dependency output file.</p>\n\n<pre><code>CC = gcc\nSRCS = foo.c bar.c ...\nOBJS = $(SRCS:%.c=%.o)\nDEPS = $(wildcard $(OBJS:%=%.d))\n\n%.o : %.c\n    $(CC) -MD -MP -MF \"$@.d\" -o $@ -c $&lt;\n\ninclude $(DEPS)\n</code></pre>\n"}], "owner": {"reputation": 874, "user_id": 2039127, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/DqUSC.jpg?s=128&g=1", "display_name": "Gomu", "link": "https://stackoverflow.com/users/2039127/gomu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 48460827, "answer_count": 2, "score": 0, "last_activity_date": 1516967448, "creation_date": 1516794576, "question_id": 48421816, "link": "https://stackoverflow.com/questions/48421816/makefile-to-rebuild-during-header-file-changes", "title": "Makefile to rebuild during header file changes", "body": "<p>I'm trying to write a Makefile for a project. With that, I was able to build the project whenever there is a change in any of the C files. But, it doesn't build when there is a change in a header file.</p>\n\n<p>So, I'm trying Makefile for a simpler directory structure and if it works I'm planning to do the same in the main project.</p>\n\n<p>The directory structure is,</p>\n\n<pre><code>src -&gt; code1 -&gt; file1.c\nsrc -&gt; code2 -&gt; file2.c\nsrc -&gt; code1inc -&gt; file1.h\nsrc -&gt; code2inc -&gt; file2.h\n</code></pre>\n\n<p>All the files together should build and give a single binary <code>FinalBin</code></p>\n\n<p>When there is a change in file1.h, it has to build only file1.c. \nHow do I impose this through the Makefile?</p>\n\n<p>This is my current Makefile.</p>\n\n<pre><code>CC = gcc\n\nCFLAGS = $(INCLUDES)\n\nTARGET = FinalBin\n\nSOURCES := $(wildcard *.c)\n\nPATH_CODE1 = src/code1\nPATH_CODE2 = src/code2\n\nCODE1_SOURCES := $(wildcard $(PATH_CODE1)/*.c)\nCODE1_OBJECTS := $(patsubst %.c,%.o,$(CODE1_SOURCES))\n\nCODE2_SOURCES := $(wildcard $(PATH_CODE2)/*.c)\nCODE2_OBJECTS := $(patsubst %.c,%.o,$(CODE2_SOURCES))\n\nPATH_CODE1INC = src/code1inc\nPATH_CODE2INC = src/code2inc\n\nINCLUDES = -I$(PATH_CODE1INC) \\\n                -I$(PATH_CODE2INC)\n\nCODE1_HEADERS := $(wildcard $(PATH_CODE1INC)/*.h)\nCODE2_HEADERS := $(wildcard $(PATH_CODE2INC)/*.h)\n\nall: $(TARGET)\n\nobj1 = $(CODE1_OBJECTS) $(CODE1_HEADERS)\nobj2 = $(CODE2_OBJECTS) $(CODE2_HEADERS)\n\n$(TARGET) : $(obj1) $(obj2)\n        $(CC) $^ -o $@\n\nclean:\n        rm $(TARGET) $(CODE1_OBJECTS) $(CODE2_OBJECTS)\n</code></pre>\n\n<p>Please guide me in this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1516796121, "post_id": 48421585, "comment_id": 83833922, "body": "Forgetting signedness for a second and considering only size, why not use <code>unsigned long long int</code> in all cases, instead of a union?"}, {"owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "reply_to_user": {"reputation": 32098, "user_id": 124319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lVhrR.jpg?s=128&g=1", "display_name": "coredump", "link": "https://stackoverflow.com/users/124319/coredump"}, "edited": false, "score": 0, "creation_date": 1516800219, "post_id": 48421585, "comment_id": 83836557, "body": "yep, i just hadn&#39;t thinked about that, i was thinking that unions were a pretty smart way to deal with my problem because even if you don&#39;t know your type of data before thanks to union i wasn&#39;t forced to declare all the variable  i&#39;ll probably need, but i will rethink my way of doing that with unsigned long long int, thanks for help !"}], "answers": [{"tags": [], "owner": {"reputation": 6463, "user_id": 6387170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d425edf9cc20e61c8cc3be162915f06?s=128&d=identicon&r=PG&f=1", "display_name": "UKMonkey", "link": "https://stackoverflow.com/users/6387170/ukmonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1516794356, "creation_date": 1516794356, "answer_id": 48421745, "question_id": 48421585, "link": "https://stackoverflow.com/questions/48421585/how-to-compare-two-different-union-in-c/48421745#48421745", "title": "how to compare two different union in C", "body": "<p>Yes - you're confused what a union is.</p>\n\n<p>The union takes up as much memory as the largest item in it; and when you attempt to compare the value of it with >; the compiler doesn't know what to do; since the representation of the int = 0 and the representation of long = 0 may be different (since the int may not have 0'ed the bytes after it).</p>\n\n<p>Using your union in a printf will be interesting too; as the %d tells printf to take the next sizeof(int) bytes that's in the arguments and assume it's an int.  As you've got extra data left over; it will be read for the next part of printf - leaving it very confused and printing likely some rubbish (but it won't crash, as you're reading valid memory).</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "edited": false, "score": 0, "creation_date": 1516796171, "post_id": 48421810, "comment_id": 83833946, "body": "my question is : i recup a data in a union because i can&#39;t know in advance what type it will be, maybe it&#39;ll be a long or a long long or something, so that&#39;s why i used a union, but afterthat i obviously need to manipulate my data with some &lt;= 9 or other comparason for print this data ( nb : i can&#39;t use printf because it&#39;s an exercise with some restrictions ), so how can i solve that, have i just to do a function for print my data for each type like one function for long one for long long one for unsigned int etc ... or there is an other way that i don&#39;t see to manipulate my union"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516798370, "post_id": 48421810, "comment_id": 83835288, "body": "Two unions that contain the same value in their last-stored members of the same type may have different bytes in them, so <code>memcpy</code> will report they are different. E.g., if two unions had 1234 and 5678 store in their <code>int</code> members, and then 90 is store in their <code>char</code> members, some of the old data from the <code>int</code> members may persist inside the union."}, {"owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516800193, "post_id": 48421810, "comment_id": 83836538, "body": "@Eric Postpischil: I&#39;m not sure and however I think this depend on the compiler."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516805270, "post_id": 48421810, "comment_id": 83840154, "body": "(Correction: my <code>memcpy</code> above should be <code>memcmp</code>, of course.) I am sure; this is bad code and should never be used. The C standard does not even guarantee that equal values of ordinary objects have the same underlying bits (as noted in footnote 52 of C 2011 [N1570]), let alone unions."}, {"owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "edited": false, "score": 0, "creation_date": 1516806968, "post_id": 48421810, "comment_id": 83841457, "body": "Ok. To prevent this one is sufficient fill to 0 all unions before to use it: <code>memset(&amp;union1,0,sizeof(all_integer));</code> and <code>memset(&amp;union2,0,sizeof(all_integer));</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516814900, "post_id": 48421810, "comment_id": 83847130, "body": "@LucaG: That is not a solution. Per C 2011 [N1570] 6.2.6.1 7: \u201cWhen a value is stored in a member of an object of union type, the bytes of the object representation that do not correspond to that member but do correspond to other members take unspecified values.\u201d (Among other things, this allows a compiler to optimize by using an efficient store instruction to store a \u201cword\u201d in the union when the source code only stores a <code>char</code>. This may be faster on some processors but puts \u201cgarbage\u201d in the union along with the <code>char</code>.)"}, {"owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "edited": false, "score": 0, "creation_date": 1516866667, "post_id": 48421810, "comment_id": 83866965, "body": "I think the correct solution has explained in this <a href=\"https://stackoverflow.com/questions/12195794/what-is-the-correct-way-to-check-equality-between-instances-of-a-union\">link</a>"}], "tags": [], "owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "is_accepted": false, "score": 0, "last_activity_date": 1516964221, "last_edit_date": 1516964221, "creation_date": 1516794560, "answer_id": 48421810, "question_id": 48421585, "link": "https://stackoverflow.com/questions/48421585/how-to-compare-two-different-union-in-c/48421810#48421810", "title": "how to compare two different union in C", "body": "<p>Your request isn't clear.</p>\n\n<p>However it's normal that compiler give you error in both case. For compare union you have to write some code like this one:</p>\n\n<pre><code>all_integer union1;\nall_integer union2;\n\n/*To ensure all the unused data of the unions are the same, it's\nnecessary to set unions, before to use it, at the same value (0 in this case).*/\nmemset(&amp;union1,0,sizeof(all_integer));\nmemset(&amp;union2,0,sizeof(all_integer));\n\n...\n\nif(!memcmp(&amp;union1,&amp;union2,sizeof(all_integer))\n{\n    //Unions are equal.\n    ...\n}\nelse\n{\n    //Unions aren't equal.\n    ...\n}\n</code></pre>\n\n<p>Edit: follow the suggestions in this <a href=\"https://stackoverflow.com/questions/12195794/what-is-the-correct-way-to-check-equality-between-instances-of-a-union\">link</a></p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "edited": false, "score": 0, "creation_date": 1516799640, "post_id": 48422090, "comment_id": 83836180, "body": "yes thanks, i think you&#39;ve answered to my question,  i was trying to do that with union because the definition of an union ( all the variable are the same and not take more place in memory than your current type of your union ) made sense in my mind for my problematic but yeah your solution is cool, i think i will rethink my way of doing my code"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "edited": false, "score": 0, "creation_date": 1516800424, "post_id": 48422090, "comment_id": 83836667, "body": "Unfortunately you don&#39;t have the choice since types must be resolved at compile time. Of course, the &quot;container&quot; variable will often be much larger than needed, but having only one display function for unsigned long long int represents much more memory saving (smaller code). Don&#39;t forget to upvote my reply if you think the solution is good."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516805509, "post_id": 48422090, "comment_id": 83840316, "body": "Using <code>unsigned long long int</code> as a container is problematic. The conversion of an <code>unsigned long long int</code> value to <code>long long int</code> is not defined by the C standard if the value is not representable in the new type. There is no guarantee it will wrap."}, {"owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "edited": false, "score": 0, "creation_date": 1516809508, "post_id": 48422090, "comment_id": 83843404, "body": "hmm ok so i can maybe just try to solve that by the fact that i can know in advance if i&#39;ll use an insigned or signed int because of %u and %i are signed and the rest unsigned, then do one more function for signed long long and it&#39;s will be ok, a little less class but functional in any case"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516810126, "post_id": 48422090, "comment_id": 83843865, "body": "@EricPostpischil Indeed the behaviour could be unexpected. In C++ you&#39;d use static_cast&lt;&gt; to solve it. In C it is different. However it is doable with my method, but with an extra-control when converting from unsigned to signed (carefully managing the MSB)."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516814600, "post_id": 48422090, "comment_id": 83846923, "body": "@BenjaminBarrois: <a href=\"https://stackoverflow.com/questions/16188263/is-signed-integer-overflow-still-undefined-behavior-in-c\">Signed integer overflow is undefined in C++.</a> <a href=\"https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviours-that-a-c-programmer-should-know-a/367662#367662\"><code>static_cast</code> does not fix it.</a>"}, {"owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516817866, "post_id": 48422090, "comment_id": 83848815, "body": "@EricPostpischil There is no notion of overflow while doing a <code>static_cast</code>. As both are the same wordlength, the binary value of the input is stored in the output, no matter what the bit vector represents. It is only if you try to read their interpreted values that they will be different (11111111111...11111) will be -1 for the signed version, and the maximum representable for the unsigned version."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516818339, "post_id": 48422090, "comment_id": 83849078, "body": "@BenjaminBarrois: Per C++ [expr.static.cast], \u201cThe result of the expression static_cast&lt;T&gt;(v) is the result of converting the expression v to type T.\u201d Per [conv.integral] \u201cIf the destination type is signed, the value is unchanged if it can be represented in the destination type (and bit-field width); otherwise, the value is implementation-defined.\u201d (So not completely undefined as the Stack Overflow link I cited before suggests, but not portable.) It is <b>not</b> specified merely to copy or reinterpret the bits."}], "tags": [], "owner": {"reputation": 1825, "user_id": 8118147, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/AeaWX.jpg?s=128&g=1", "display_name": "Benjamin Barrois", "link": "https://stackoverflow.com/users/8118147/benjamin-barrois"}, "is_accepted": true, "score": 0, "last_activity_date": 1516795506, "creation_date": 1516795506, "answer_id": 48422090, "question_id": 48421585, "link": "https://stackoverflow.com/questions/48421585/how-to-compare-two-different-union-in-c/48422090#48422090", "title": "how to compare two different union in C", "body": "<p>I think what you are trying to use \"union\" for is wrong. At compile time, all types must be resolved and so you can't compare unions with their active member being agnostic.</p>\n\n<p>For me, the easiest (yet quite clean) solution here is to parse the numbers you want to print in the largest possible integer number (unsigned long long int in your case), for instance for your \"%d\":</p>\n\n<pre><code>unsigned long long int mask = ~((unsigned long long int) 0);\nunsigned long long int container;\nbool signed = true;\n...\nint num1 = -548375;\ncontainer = (unsigned long long int) (((long long int) num1) &amp; mask); //\"long long int\" instead of \"unsigned long long int\" to propagate the bit of sign\n</code></pre>\n\n<p>Then you can pass your container as argument as well as the sign:</p>\n\n<pre><code>void my_print(unsigned long long int container, bool signed) {\n    if (signed) {\n        // Print as long long int\n    } else if (!signed) {\n        // Print as unsigned long long int\n    }\n}\n</code></pre>\n\n<p>This way, the function my_print can be generic, you only need to manage the conversion to \"unsigned long long int\" and the value of signed variable depending on the type.</p>\n"}], "owner": {"reputation": 53, "user_id": 9165191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a57473edcddc63e52ee89e77d79dd1?s=128&d=identicon&r=PG&f=1", "display_name": "abt jeremie", "link": "https://stackoverflow.com/users/9165191/abt-jeremie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 48422090, "answer_count": 3, "score": 0, "last_activity_date": 1516964221, "creation_date": 1516793835, "question_id": 48421585, "link": "https://stackoverflow.com/questions/48421585/how-to-compare-two-different-union-in-c", "title": "how to compare two different union in C", "body": "<p>i'm just wondering how can i compare a union with other integer, my purpose is to code a sort of printf like and i'm managing the simple case like %d/%u/%i considering the size conversion : ll/l/hh/h/j/z, so basically i've the following union : </p>\n\n<pre><code>union all_integer\n{\n    char                        c;\n    signed int                  nb;\n    short int                   snb;\n    long int                    lnb;\n    long long int               llnb;\n    size_t                      posnb;\n\n    unsigned char               uc;\n    unsigned int                unb;\n    unsigned short int          usnb;\n    unsigned long int           ulnb;\n    unsigned long long int      ullnb;\n};\n</code></pre>\n\n<p>because i can't know before which type i'll need to receive, and after that when i've something like that in case i use %d :</p>\n\n<pre><code>union all_integer u_allint;\nu_allint.nb = va_arg(ap, int);\n</code></pre>\n\n<p>i want to print my data wich's in my union u_allint so i give my union to a simple function for putmydata for exemple :</p>\n\n<pre><code>putdata(union all_integer u_allint)\n{\n     if (u_allint &lt; 0)\n     {\n          return (ft_numlen_neg(u_allint));\n     }\n     if (u_allint &gt; 9)\n         return (1 + ft_numlen(u_allint / 10));\n     if (u_allint &gt; 0 &amp;&amp; u_allint &lt; 10)\n          return (1);\n     if (u_allint == 0)\n        return (1);\n     return (0);\n}\n</code></pre>\n\n<p>just suppose that this function is capable to print correctly my data and the fact is i can't do that because i compare an union with an int and even if i try to do an other union in my function and give newunion.nb = 0 for have an union int compare with an union int, i can't compile with this message : invalid operands to binary expression ('union my_union' and 'union my_union').\nso i'm pretty sure that i misunderstand something about union, but i didn't find a  similar problem in other topic, so am i misunderstand something or maybe taking the problem by the wrong way ?\nthank for your rep !</p>\n"}, {"tags": ["c", "c-preprocessor", "naming-conventions"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1516791595, "post_id": 48420780, "comment_id": 83831076, "body": "It&#39;s just an uncommon character, added to make the symbol unique."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1516792088, "post_id": 48420780, "comment_id": 83831406, "body": "<code>str</code> would be used very frequently in source code by users, so my guess is they <code>#undef</code> it after this and use <code>xstr</code>. But no idea why the <code>x</code>."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1516792876, "post_id": 48420780, "comment_id": 83831917, "body": "Are you sure it&#39;s &quot;typically used&quot;? I&#39;ve seen many other variants too (<code>STRIGIFY</code>, <code>STRINGIZE</code>, <code>BOOST_PP_STRINGIZE</code>)."}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1516794139, "post_id": 48420780, "comment_id": 83832695, "body": "@Groo It&#39;s used in in the <a href=\"http://www.c-faq.com/ansi/stringize.html\" rel=\"nofollow noreferrer\">C FAQ</a>, in the <a href=\"http://gcc.gnu.org/onlinedocs/gcc-4.1.2/cpp/Stringification.html\" rel=\"nofollow noreferrer\">GCC docs</a>, and is referenced in <a href=\"https://stackoverflow.com/search?q=%5Bc%5D+xstr\">a number of StackOverflow questions</a>.  While there are certainly other names, I feel like I&#39;ve seen <code>xstr</code> (or some capitalized variant) more often than any of the others."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516799209, "post_id": 48420780, "comment_id": 83835873, "body": "Are you asking only out of curiosity or is there something more to it?"}, {"owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1516800888, "post_id": 48420780, "comment_id": 83836985, "body": "@machine_1 I&#39;m curious about the history behind it."}, {"owner": {"reputation": 1251, "user_id": 2298578, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saqnG.jpg?s=128&g=1", "display_name": "Matthias", "link": "https://stackoverflow.com/users/2298578/matthias"}, "edited": false, "score": 0, "creation_date": 1521617690, "post_id": 48420780, "comment_id": 85802292, "body": "The X seems to have a tradition in preprocessor magic, see for example this piece of beauty: <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/X_Macro</a>. You could certainly use any other identifier for the X macro technique, but the identifier and the resulting name sticks."}], "answers": [{"tags": [], "owner": {"reputation": 1173, "user_id": 380676, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7eb3c5698806b37924982969f6acedf7?s=128&d=identicon&r=PG", "display_name": "Chul-Woong Yang", "link": "https://stackoverflow.com/users/380676/chul-woong-yang"}, "is_accepted": false, "score": 0, "last_activity_date": 1517743697, "creation_date": 1517743697, "answer_id": 48607563, "question_id": 48420780, "link": "https://stackoverflow.com/questions/48420780/what-does-x-mean-in-the-typical-xstr-macro/48607563#48607563", "title": "What does &quot;x&quot; mean in the typical xstr macro?", "body": "<p>When I use <code>x</code> in front of a macro or function call name, I use it to mean <em>extended</em> usage, and I think I am not alone.</p>\n\n<p>For your example, one use <code>str</code> to stringify <code>token</code>, but should use <code>xstr</code> for extended usage, that is to expand macro argument and stringify that result.\nFor comparison, when just one of the macro should be used for most of the time and the other is for internal implementations, I would do like followings:</p>\n\n<pre><code>#define _str(token) #token\n#define str(token) _str(token)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 9871727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSNoF.png?s=128&g=1", "display_name": "Trevor Tracy", "link": "https://stackoverflow.com/users/9871727/trevor-tracy"}, "is_accepted": true, "score": 2, "last_activity_date": 1527701351, "creation_date": 1527701351, "answer_id": 50610454, "question_id": 48420780, "link": "https://stackoverflow.com/questions/48420780/what-does-x-mean-in-the-typical-xstr-macro/50610454#50610454", "title": "What does &quot;x&quot; mean in the typical xstr macro?", "body": "<p>As others have suggested, the <code>x</code> seems to be used for <strong>extended</strong> or I've also seen <strong>expanded</strong> used as well. An article on  <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Stringizing.html\" rel=\"nofollow noreferrer\">Stringizing</a> by GNU has a reference to this use.</p>\n\n<p>They phrase it as: </p>\n\n<blockquote>\n  <p>\"If you want to stringize the result [...],\n  you have to use two levels of macros.\"</p>\n</blockquote>\n\n<pre><code>#define xstr(s) str(s)\n#define str(s) #s\n#define foo 4\nstr (foo)\n     \u2192 \"foo\"\nxstr (foo)\n     \u2192 xstr (4)\n     \u2192 str (4)\n     \u2192 \"4\"\n</code></pre>\n\n<p>They continue to state: </p>\n\n<blockquote>\n  <p>\"s is stringized when it is used in str, so it is not <strong>macro-expanded</strong>\n  first. But s is an ordinary argument to xstr, so it is completely\n  macro-expanded before xstr itself is expanded (see Argument Prescan).\n  Therefore, by the time str gets to its argument, it has already been\n  macro-expanded.\"</p>\n</blockquote>\n\n<p>While none of this is concrete, I think you're safe to assume x is expanded/extended usage.</p>\n"}], "owner": {"reputation": 46708, "user_id": 179715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e240f1a5bb197450dfb8934dd55d9e3a?s=128&d=identicon&r=PG", "display_name": "jamesdlin", "link": "https://stackoverflow.com/users/179715/jamesdlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 50610454, "answer_count": 2, "score": 8, "last_activity_date": 1527701351, "creation_date": 1516791478, "last_edit_date": 1521622705, "question_id": 48420780, "link": "https://stackoverflow.com/questions/48420780/what-does-x-mean-in-the-typical-xstr-macro", "title": "What does &quot;x&quot; mean in the typical xstr macro?", "body": "<p>It's common practice to define stringizing macros like:</p>\n\n<pre><code>#define str(token) #token\n#define xstr(token) str(token)\n</code></pre>\n\n<p>Why is the <code>x</code> prefix typically used?  Is there any meaning to \"x\"?</p>\n\n<p>(My guess would be that maybe it stands for \"expanded\" (if anything), but I have no evidence to back that up.)</p>\n"}, {"tags": ["c", "pointers", "struct"], "answers": [{"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 2, "last_activity_date": 1516791592, "creation_date": 1516791592, "answer_id": 48420817, "question_id": 48420581, "link": "https://stackoverflow.com/questions/48420581/how-to-create-a-new-head-to-the-list-in-c/48420817#48420817", "title": "How to create a new head to the list in C?", "body": "<blockquote>\n  <p>How to write a \"add_first\" function that will change head and return the value of a new variable <strong>without any changes in \"main\" function</strong>?</p>\n</blockquote>\n\n<p>Not possible to do the bolded part because there is no way to return the head of the list without changing <code>main</code> and <code>add_first</code>. If you lift that restriction, there are two ways. The first way is to pass a pointer to the poointer to the head of the list. <code>add_first</code> becomes this:</p>\n\n<pre><code>int add_first(struct node_t **lista)\n{\n    newHead = (struct node_t*)malloc(sizeof(struct node_t));\n    srand(time(NULL)); \n    int val = (int)(rand() / (RAND_MAX + 1.0) * 100.0);\n    newHead-&gt;value = 10;\n    newHead-&gt;next = *lista;\n    *lista = newHead;\n    return val;\n}\n</code></pre>\n\n<p>In <code>main</code></p>\n\n<pre><code>int rand_val = add_first(&amp;head);\n</code></pre>\n\n<p>It creates a new list head, links the existing list to its <code>next</code> and sets the passed in list to the new head.</p>\n\n<p>The other way only works assuming that you <em>really</em> wanted to set the value in the new item to the value you are returning. In this case, you can return the new head of the list</p>\n\n<pre><code>(struct node_t *add_first(struct node_t *lista)\n{\n    newHead = (struct node_t*)malloc(sizeof(struct node_t));\n    srand(time(NULL)); \n    newHead-&gt;value = (int)(rand() / (RAND_MAX + 1.0) * 100.0);\n    newHead-&gt;next = lista;\n    return newHead;\n}\n</code></pre>\n\n<p>In <code>main</code></p>\n\n<pre><code>head = add_first(head);\nrand_val = head-&gt;value;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9016013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab6bc72c71884f52007ff52c311d8eb?s=128&d=identicon&r=PG&f=1", "display_name": "Krystian", "link": "https://stackoverflow.com/users/9016013/krystian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48420817, "answer_count": 1, "score": 0, "last_activity_date": 1516791887, "creation_date": 1516790900, "question_id": 48420581, "link": "https://stackoverflow.com/questions/48420581/how-to-create-a-new-head-to-the-list-in-c", "title": "How to create a new head to the list in C?", "body": "<p>How to write a \"add_first\" function that will change head and return the value of a new variable without any changes in \"main\" function? \nIs it possible to do this without pass a pointer to the pointer variable (a double pointer)?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nstruct node_t\n{\n    int value;\n    struct node_t *next;\n};\n\nint add_first(struct node_t *);\nvoid print_list(struct node_t *);\n\nint main(int argc, char **argv)\n{\n    struct node_t *head = NULL ;\n    int rand_val = add_first(head);\n    printf(\"Value =  %d\\n\", rand_val);\n    print_list(head);\n}\n\nint add_first(struct node_t *lista)\n{\n    lista = (struct node_t*)malloc(sizeof(struct node_t));\n    srand(time(NULL)); \n    int val = (int)(rand() / (RAND_MAX + 1.0) * 100.0);\n    lista-&gt;value = 10;\n    lista-&gt;next = NULL;\n    return val;\n}\n\nvoid print_list(struct node_t * head) {\n    struct node_t * current = head;\n\n    while (current != NULL) {\n        printf(\"%d\\n\", current-&gt;value);\n        current = current-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop", "command-line-interface", "fgets"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516791186, "post_id": 48420442, "comment_id": 83830812, "body": "@SteveSummit just extended my code to elaborate"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1516791567, "post_id": 48420442, "comment_id": 83831055, "body": "There&#39;s nothing wrong with your <code>fgets</code> call.  Get rid of the <code>char b = getchar()</code> and the <code>printf(&quot;%c&quot;, b)</code>; those are just confusing the issue.  Don&#39;t muck aroiund with <code>fseek</code> or <code>fflush(stdin)</code>; those will just confuse the issue more."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1516791623, "post_id": 48420442, "comment_id": 83831098, "body": "Your problem is probably in something we can&#39;t see.  The snippet you posted is fine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516791777, "post_id": 48420442, "comment_id": 83831207, "body": "@SteveSummit, Thanks Steve, I only added it in to try and capture what was causing the issue. Any idea what could be causing it to be skipped over?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1516792248, "post_id": 48420442, "comment_id": 83831504, "body": "Something that we can&#39;t see, because it is not visible in the snippet you posted, is causing your problem.  Beyond that it&#39;s hard to say. But  I doubt it&#39;s being &quot;skipped over&quot;; I suspect some other aspect of your larger program&#39;s behavior is confusing you."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516792617, "post_id": 48420442, "comment_id": 83831750, "body": "Come to think of it, I bet I know exactly what&#39;s causing your <code>fgets</code> call to be &quot;skipped&quot;.  In the code we can&#39;t see, up before you call <code>fgets</code>, you&#39;re calling <code>scanf</code>, aren&#39;t you?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516794646, "post_id": 48420442, "comment_id": 83833000, "body": "@SteveSummit, Nope, I read all the issue about using those two together"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516795045, "post_id": 48420442, "comment_id": 83833236, "body": "@SteveSummit,  I do call <code>sscanf</code> to extract some vars from a file though, before getting to the while loop"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516795485, "post_id": 48420442, "comment_id": 83833508, "body": "Okay, I&#39;m glad you know about <code>scanf</code> and <code>fgets</code>.  But if you&#39;re hitting the &quot;Error using fgets&quot; case, the problem is not that <code>fgets</code> is being &quot;skipped&quot;, the problem is that it&#39;s <i>failing</i>.  This may mean EOF, and that&#39;s somewhat confirmed by the fact that you got &#255; back from <code>getchar</code>, since &#255; is sort of equal to EOF (-1).  Are you entering control-D or control-Z?  Could <code>stdin</code> be getting closed somehow?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1516795685, "post_id": 48420442, "comment_id": 83833643, "body": "But, seriously, enough speculating.  You need to show us code that actually demonstrates your problem -- that is, what the pedants call an &quot;MVCE&quot;.  Not your whole program, but a stripped-down, but complete program that both compiles and demonstrates your problem.  We can&#39;t debug what we can&#39;t see."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516795860, "post_id": 48420442, "comment_id": 83833776, "body": "@SteveSummit, The first time I enter anything is when <code>fgets</code> is called. I&#39;m not control-* anything."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1516796245, "post_id": 48420442, "comment_id": 83833994, "body": "<code>fflush( stdin )</code> is, as far as the C standard is concerned, <i>undefind behaviour</i>. Yes, it is well-defined on Linux; don&#39;t do it anyway."}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1516796513, "post_id": 48420442, "comment_id": 83834141, "body": "@N3i1 No need to share your whole program; please don&#39;t put a link to the whole code base. Share a stripped-down, but complete program that both compiles and demonstrates your problem. Your current code lacks a <code>main</code> function, among other things. Read about <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you have doubts."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1516797012, "post_id": 48420442, "comment_id": 83834437, "body": "18 chars of effective buf size is not s lot... Perhaps your input line is simply too long, as your code does not handle this well."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516801394, "post_id": 48420442, "comment_id": 83837317, "body": "@SteveSummit, thanks for your help. Here&#39;s an MVCE"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1516802227, "post_id": 48420442, "comment_id": 83837891, "body": "What is this: <code>if (close(fd == -1))</code> ?  The <code>close(FILE *)</code> function just requires the file descriptor as an argument, not a Boolean expression. (which will probably not be the same as the file descriptor."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1516802378, "post_id": 48420442, "comment_id": 83837983, "body": "<code>#define LINE_BUFF 20</code> needs to be bigger."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1516802587, "post_id": 48420442, "comment_id": 83838126, "body": "@ryyker, <code>close()</code> was a typo in my code. One which I&#39;ve clearly overlooked. Thank you. I&#39;ve tried making LINE_BUFF bigger, but still the same problem"}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 1, "creation_date": 1516804617, "post_id": 48420442, "comment_id": 83839654, "body": "Note that your scanf format string contains %p, but the start/end aren&#39;t pointers. You&#39;re also not freeing the buffer returned by getline() after the loop. But what I&#39;m really curious about, is whether alloca() inside a while loop is such a good idea?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516805218, "post_id": 48420442, "comment_id": 83840117, "body": "@user3121023 thank you, I\u2019ll look to make that change"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516805361, "post_id": 48420442, "comment_id": 83840217, "body": "@Ove, do you mean I need to free <code>line</code> ?"}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516806410, "post_id": 48420442, "comment_id": 83841022, "body": "@N3i1 yep, what user3121023 said."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516806524, "post_id": 48420442, "comment_id": 83841112, "body": "@user3121023, I\u2019ve made all your recommendations, thanks again. But I\u2019m still hitting the same problem"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516806880, "post_id": 48420442, "comment_id": 83841390, "body": "@Ove, thanks. I wasn\u2019t aware I had to free"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516807117, "post_id": 48420442, "comment_id": 83841560, "body": "@user3121023 Removed"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1516807953, "post_id": 48420442, "comment_id": 83842178, "body": "@user3121023 sorry I don\u2019t understand your last comment?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1516810114, "post_id": 48420442, "comment_id": 83843852, "body": "@DevSolar -- I have never seen <code>fflush(stdin)</code> actually work for terminal input on a Linux system. I think that the language on <a href=\"https://linux.die.net/man/3/fflush\" rel=\"nofollow noreferrer\">some Linux man pages</a> is misleading; <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fflush.html\" rel=\"nofollow noreferrer\">POSIX specifies that <code>fflush(stdin)</code> is only defined for <i>seekable</i> streams</a>, and <a href=\"http://man7.org/linux/man-pages/man3/fflush.3.html\" rel=\"nofollow noreferrer\">better Linux man pages seem to concur.</a>"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1516810265, "post_id": 48420442, "comment_id": 83843967, "body": "@DavidBowling: I was contrasting the &quot;works for special cases&quot; as per Linux with the outright UB a per C99 / C11."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 1, "creation_date": 1516810798, "post_id": 48420442, "comment_id": 83844370, "body": "@DevSolar -- well, I think that you could argue that it is UB to do <code>scanf(&quot;%c&quot;, &amp;ch);  fflush(stdin);</code> even on Linux systems, since this is only defined for seekable streams. IAC, I know that you were not recommending this; I only commented because I frequently see it mentioned (in this context of clearing the input stream after user input) that this behavior is defined in Linux. But it doesn&#39;t work in this context, and Linux man pages may be less than helpful in understanding this."}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1587387398, "last_edit_date": 1587387398, "creation_date": 1516808241, "answer_id": 48426221, "question_id": 48420442, "link": "https://stackoverflow.com/questions/48420442/fgets-being-skipped-not-stopping-for-input/48426221#48426221", "title": "fgets being skipped/not stopping for input", "body": "<p><em>I'm trying to use fgets in a simple while loop. fgets just simply isn't being called.</em>...  </p>\n\n<p>When the problem you are trying to solve is is surrounded with distractions, it is likely you are spending all your efforts on the distractions and not the problem.  As shown, your code contains not only the problem(s) you describe, but a bunch of distractions.  </p>\n\n<p>The comments offer several suggestions to <em><a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">clean up your distractions</a></em>. The following is my take on no distractions:</p>\n\n<p>A very simple example of a working <em>fgets in a loop reading stdin</em> example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n        char temp[BUFSIZ];  //BUFSIZ defined as 512 in stdio on my system.\n\n        while((fgets(temp,BUFSIZ,stdin)) != NULL)\n                printf(\"%s\\n\",temp);\n\n        return 0;\n}\n</code></pre>\n\n<p>EOF will cause the loop to exit. (ctrl-C to stop on Windows)</p>\n\n<p>When you get this to work, slowly start to include other desired functionality around it, verifying each time that the added functionality does not break the code.  As you progress, you may run into an occasional bug,  When that happens use a <em><a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">step-wise, pragmatic approach to determining the problem</a></em>, then continue. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9251303"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 932, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1587387398, "creation_date": 1516790454, "last_edit_date": 1516808024, "question_id": 48420442, "link": "https://stackoverflow.com/questions/48420442/fgets-being-skipped-not-stopping-for-input", "title": "fgets being skipped/not stopping for input", "body": "<p>I'm trying to use fgets in a simple while loop. fgets just simply isn't being called.</p>\n\n<p>Full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define LINE_BUFF 20\n#define OSPID //Here is where I would put the ospid I was interested in\n\nint readContentsOfProcessMapsFile(int target);\n\n\nint main(int argc, char** argv) {\n\nchar lineprompt[LINE_BUFF];\nchar command1[LINE_BUFF], command2[LINE_BUFF];\nint flag;\n\n\nif( readContentsOfProcessMapsFile(OSPID) != 0)\n{\n    printf(\"Error reading file\");\n    exit(EXIT_FAILURE);\n}\n\nwhile(1) {\n\n    fflush(stdout);\n    printf(\"enter name:&gt;\");\n    if ( fgets(lineprompt, sizeof(lineprompt), stdin) == NULL)\n    {\n        printf(\"Error using fgets\\n\");\n        break;\n    }\n\n    sscanf(lineprompt, \"%s %s\", &amp;command1, &amp;command2);\n\n    if (strcmp(command1, \"show\") == 0)\n    {\n        if( (strcmp(command2, \"active\") == 0) )\n        {\n            flag = 1;\n        }\n        else if( (strcmp(command2, \"inactive\") == 0) )\n        {\n            flag = 2;\n        }\n        else\n        {\n           flag =0;\n        }\n        printf(\"run show function on ospid file\");\n    }\n    else if (strcmp(command1, \"exit\") == 0) \n    {\n        printf(\"run exit/cleanup\");\n        break;\n    } \n    else if (strcmp(command1, \"help\") == 0) \n    {\n        printf(\"run help function\");\n        continue;\n    } \n    else {\n    printf(\"Nothing entered, run help function\");\n    continue;\n  }\n}\n}\n\nint readContentsOfProcessMapsFile(int target) {\n  FILE *fd; // /proc/&lt;target&gt;/maps\n  char name[128], *line = NULL, *match = NULL;\n  size_t len = 0;\n  char* filename = NULL;\n\n  snprintf(name, sizeof (name), \"/proc/%u/maps\", target);\n\n  if ((fd = fopen(name, \"r\")) == NULL) {\n    printf(\"error\");\n    return (EXIT_FAILURE);\n  }\n\n  while (getline(&amp;line, &amp;len, fd) != -1) \n  {\n    unsigned long start, end;\n    char read, write, exec, cow;\n    int offset, dev_major, dev_minor, inode;\n\n    filename = realloca(filename, len);\n\n    sscanf(line, \"%p-%p %c%c%c%c %x %x:%x %u %[^\\n]\", &amp;start, &amp;end, &amp;read,\n            &amp;write, &amp;exec, &amp;cow, &amp;offset, &amp;dev_major, &amp;dev_minor, &amp;inode, filename);\n    match = strstr(filename, \"/ora_\");\n    if (match != NULL) \n    {\n        printf(\"##lowAddr:%p, highAddr:%p and filename:%s\\n\", start, end, name);\n    }\n  }\n  free(filename);\n  free(line);\n  if (fclose(fd) == -1)) \n  {\n    printf(\"Failed to close %s\", fd);\n    return (EXIT_FAILURE);\n  }\n  return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>I've tried adding <code>fseek(stdin,0,SEEK_END);</code> and <code>fflush(stdin);</code> just after the while loop, but <code>fgets()</code> is still being skipped over. I understand it's not good pratice to use <code>fflush(stdin)</code> anyway's.</p>\n\n<p>When this happens <code>getchar()</code> is printing either a square or a Y with two dots above it. So am I right in thinking the reason for <code>fgets()</code> being skipped over is that it's picking up these chars? Could anyone offer a way to stop/prevent this?</p>\n\n<p>Thanks for all the comments. I've narrowed it down to the above <code>readContentsOfProcessMapsFile</code> function. If I comment this out then <code>fgets</code> works as expected.</p>\n\n<p>Now that I fixed my typo regarding the <code>close(fd)</code> it doesn't seem to actually be closing the file! Just found my own error there! Changed to <code>fclose</code> but see getting the same problem</p>\n"}, {"tags": ["java", "c", "time-complexity", "factorial"], "comments": [{"owner": {"reputation": 837, "user_id": 4484081, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k8GZrl12cWI/AAAAAAAAAAI/AAAAAAAAAcU/Ld77dpYRsTA/photo.jpg?sz=128", "display_name": "akshaya pandey", "link": "https://stackoverflow.com/users/4484081/akshaya-pandey"}, "edited": false, "score": 2, "creation_date": 1516790476, "post_id": 48420368, "comment_id": 83830389, "body": "java code will take more execution time. because bytecode is compiled by jvm into machine level instructions. C code will be faster than java. Please read about java virtual machine and why java is platform independent, you will have your answer."}, {"owner": {"reputation": 1094, "user_id": 7629560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEnZy.jpg?s=128&g=1", "display_name": "samthegolden", "link": "https://stackoverflow.com/users/7629560/samthegolden"}, "edited": false, "score": 0, "creation_date": 1516790552, "post_id": 48420368, "comment_id": 83830440, "body": "java has a JVM below. it increases the time of compilation/interpretation/execution"}, {"owner": {"reputation": 3730, "user_id": 5235392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9cbc8664398c9a01be28d08579b86a?s=128&d=identicon&r=PG&f=1", "display_name": "shahaf", "link": "https://stackoverflow.com/users/5235392/shahaf"}, "edited": false, "score": 0, "creation_date": 1516792314, "post_id": 48420368, "comment_id": 83831557, "body": "The JVM although increases the time can do automatic optimisation, usually after each 10K cpu cycles, thus give it a &quot;warming time&quot; before you check execution time also you can disable the garbage collector if your code is simple and don&#39;t create/delete a lot of objects, this will increase performance"}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1516834979, "post_id": 48420368, "comment_id": 83857576, "body": "<code>@akshayapandey</code> has given the answer to your first question. For the second one you might want to make a post on [CodeReview](codereview.stackexchange.com); note that working code is mandatory there"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1520513963, "post_id": 48420368, "comment_id": 85352258, "body": "Your function is named misleadingly (you even accepted an answer to a different question). Use <code>leastSignificantDigitInFactorial()</code>, better yet, document it using <a href=\"http://www.stack.nl/~dimitri/doxygen/manual/docblocks.html\" rel=\"nofollow noreferrer\">doxygen</a> (or better)."}], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 9189768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hfDTC.png?s=128&g=1", "display_name": "BluEOS", "link": "https://stackoverflow.com/users/9189768/blueos"}, "is_accepted": false, "score": 0, "last_activity_date": 1516795304, "creation_date": 1516795304, "answer_id": 48422008, "question_id": 48420368, "link": "https://stackoverflow.com/questions/48420368/how-to-reduce-the-running-time-for-finding-the-last-non-zero-digit-of-factorial/48422008#48422008", "title": "How to reduce the running time for finding the last non-zero digit of factorial of a number?", "body": "<p>Please find the optimized version : </p>\n\n<pre><code>private static final int DIG[] = { 1, 1, 2, 6, 4, 2, 2, 4, 2, 8 };\n\nstatic int lastDigitDiffZero(long n) {\n        if (n &lt; 10)\n            return DIG[(int) n];\n        int t1 = (int) (n % 10);\n        int t2 = lastDigitDiffZero(n / 5) * DIG[t1];\n        if (((n / 10) % 10) % 2 == 0) {\n            return (6 * t2) % 10;\n        } else\n            return (4 * t2) % 10;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1520513710, "post_id": 48422826, "comment_id": 85352096, "body": "2! is 6, but this gives 2: how is this an alternative <code>to find the last non-zero digit of factorial of a number</code>?"}], "tags": [], "owner": {"reputation": 106, "user_id": 8543252, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/287f4b6da3153dd1762736c81a10bc03?s=128&d=identicon&r=PG&f=1", "display_name": "IDK", "link": "https://stackoverflow.com/users/8543252/idk"}, "is_accepted": true, "score": 0, "last_activity_date": 1516797850, "creation_date": 1516797850, "answer_id": 48422826, "question_id": 48420368, "link": "https://stackoverflow.com/questions/48420368/how-to-reduce-the-running-time-for-finding-the-last-non-zero-digit-of-factorial/48422826#48422826", "title": "How to reduce the running time for finding the last non-zero digit of factorial of a number?", "body": "<p>Can't you just:</p>\n\n<pre><code>private static int lastDigitDiffZero(long n)\n{\n   int temp = (int) n;\n   int mod = temp%10;\n\n  return (mod == 0 ? lastDigitDiffZero(temp/10) : mod);\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7195471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa01f305ef1ed4f70e03200d311552e?s=128&d=identicon&r=PG&f=1", "display_name": "Abhay Mohan Gupta", "link": "https://stackoverflow.com/users/7195471/abhay-mohan-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 48422826, "answer_count": 2, "score": 1, "last_activity_date": 1516797850, "creation_date": 1516790246, "last_edit_date": 1516791128, "question_id": 48420368, "link": "https://stackoverflow.com/questions/48420368/how-to-reduce-the-running-time-for-finding-the-last-non-zero-digit-of-factorial", "title": "How to reduce the running time for finding the last non-zero digit of factorial of a number?", "body": "<p>I got a question in which I have to find the last non-zero digit of factorial of a number.I used same code for java and C but it takes different time in both. </p>\n\n<pre><code>int lastDigitDiffZero(long n) {\n\n     int dig[] = {1, 1, 2, 6, 4, 2, 2, 4, 2, 8};\n     int i=(int) n;\n\n     if (n &lt; 10)\n       return dig[i]; \n\n     if (((n/10)%10)%2 == 0)\n       return (6*lastDigitDiffZero(n/5)*dig[(int)n%10]) % 10;\n     else\n       return (4*lastDigitDiffZero(n/5)*dig[(int)n%10]) % 10;\n}\n</code></pre>\n\n<p>I want to know why does it takes different time and what should I do to reduce the running time?</p>\n"}, {"tags": ["c", "windows", "device-driver", "cpu-speed"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 3, "creation_date": 1522955148, "post_id": 48420309, "comment_id": 86371103, "body": "If you were able to  implement your solution, and it did indeed work, you might consider posting what you did as an answer, then marking it as accepted."}], "owner": {"reputation": 151, "user_id": 4779612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9161be88f95c7e9192cae979faf5e2d5?s=128&d=identicon&r=PG", "display_name": "Svetoslav Ilkov Enchev", "link": "https://stackoverflow.com/users/4779612/svetoslav-ilkov-enchev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2704, "favorite_count": 3, "answer_count": 0, "score": 15, "last_activity_date": 1517582979, "creation_date": 1516790035, "last_edit_date": 1517582979, "question_id": 48420309, "link": "https://stackoverflow.com/questions/48420309/windows-disabling-cpu-idle-c-states-from-kernel-mode-driver", "title": "Windows: Disabling CPU idle C-states from kernel-mode driver", "body": "<p>I'm writing an audio device driver which needs to process device interrupts in real-time. When the CPU enters C3 state, interrupts are delayed, causing problems to the driver. Is there a way for the driver to tell the OS not to enter idle C-states?</p>\n\n<p>What I've found is that idle C-states can be disabled from user-space:</p>\n\n<pre><code>const DWORD DISABLED = 1;\nconst DWORD ENABLED = 0;\nGUID *scheme;\nPowerGetActiveScheme(NULL, &amp;scheme);\nPowerWriteACValueIndex(NULL, scheme, &amp;GUID_PROCESSOR_SETTINGS_SUBGROUP, &amp;GUID_PROCESSOR_IDLE_DISABLE, DISABLED);\nPowerSetActiveScheme(NULL, scheme);\n</code></pre>\n\n<p>However, it is a global setting, which can be overwritten by the user or another application (e.g. when the user changes the Power Plan).</p>\n\n<p>What I need is something like PoRegisterSystemState, but not for S- and P-states, but for C-states. (ref: <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/preventing-system-power-state-changes\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/preventing-system-power-state-changes</a>)</p>\n\n<p>Is there any way to achieve this?</p>\n\n<p>=====</p>\n\n<p>It turns out there isn't a supported way to disable idle C-states from kernel space, and there isn't a service in user space to provide common API to do this. \nThe way to control C-states is from \"Processor Power Management\" in \"Change advanced power settings\" dialog, through registry, or via C API PowerWriteACValueIndex / PowerWriteDCValueIndex. </p>\n\n<p>The original problem was delayed interrupts in all but C1 idle state, so I needed to disable both C2, C3 and deeper idle states. The problem with disabling all idle C-states, including C1 (as shown in the example code PowerWriteACValueIndex(NULL, scheme, &amp;GUID_PROCESSOR_SETTINGS_SUBGROUP, &amp;GUID_PROCESSOR_IDLE_DISABLE, DISABLED)) is that the CPU usage is reported as 100%, and some applications (DAWs) get confused. </p>\n\n<p>The solution for my problem is to disable all but C1 idle state, which can be done by setting the following values in the Processor Power Management:\n - Processor idle threshold scaling -> Disable scaling;\n - Processor idle promote threshold -> 100%;\n - Processor idle demote threshold -> 100%. </p>\n\n<p>Perhaps I'll create a service that does just that, that will use the PowerWriteACValueIndex / PowerWriteDCValueIndex API. </p>\n"}, {"tags": ["c", "linux", "linux-device-driver"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1516788880, "post_id": 48419482, "comment_id": 83829323, "body": "&quot;I thought to modify the write function&quot; Nope, it doesn&#39;t work this way. Your fumction must be of a certain predefined type and you don&#39;t have any freedom in choosing it. If you expect the user to call <code>write</code> and pass an <code>int*</code>, you have to use a cast to convert your function parameter to <code>int*</code>, or copy from user to an <code>int</code> buffer (and make sure you have at least <code>sizeof(int)</code> bytes)."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1516790373, "post_id": 48419482, "comment_id": 83830325, "body": "You receive characters through the driver. Whether you want to convert these characters to integers, floating point numbers, or mp3 songs doesn&#39;t have anything to do with the fact that you get this data character by character."}, {"owner": {"reputation": 1, "user_id": 9261298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e509e351d9f7a9ab90857bae19f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Loulou", "link": "https://stackoverflow.com/users/9261298/loulou"}, "edited": false, "score": 0, "creation_date": 1516812879, "post_id": 48419482, "comment_id": 83845823, "body": "So if I understood I don&#39;t have to modify the function parameters but only the function algorithm. So I receive from the user a char * buffer and I convert it into an integer . Instead of assigning &quot;msg&quot; which is a char array to a pointer I convert msg into an integer. I&#39;m correct?"}, {"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1516833963, "post_id": 48419482, "comment_id": 83857184, "body": "You seem fixated on the <i>&quot;char&quot;</i> aspect.  The salient issue is that a &quot;char&quot; device is not a block device, i.e. transfers involving a fixed transfer size.  That means that a &quot;char&quot; device can transfer a variable number of &quot;char&quot; or bytes.  In fact you could replace <i>&quot;char&quot;</i> with &quot;byte&quot;, and maybe things get clearer.  I.E. instead of read/write strings, the char driver handles (unsigned) byte arrays.  So you&#39;re not correct to <i>&quot;convert msg into an integer&quot;</i>."}, {"owner": {"reputation": 1, "user_id": 9261298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e509e351d9f7a9ab90857bae19f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Loulou", "link": "https://stackoverflow.com/users/9261298/loulou"}, "edited": false, "score": 0, "creation_date": 1516892827, "post_id": 48419482, "comment_id": 83883755, "body": "Okay perfect! I was confused but now evrything works! thanks"}], "owner": {"reputation": 1, "user_id": 9261298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e509e351d9f7a9ab90857bae19f4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Loulou", "link": "https://stackoverflow.com/users/9261298/loulou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516790183, "creation_date": 1516787783, "last_edit_date": 1516790183, "question_id": 48419482, "link": "https://stackoverflow.com/questions/48419482/trouble-with-character-device-driver", "title": "Trouble with character device driver", "body": "<p>I'm a little bit confused about character device driver. I wrote a simple character device driver and it works with strings and simple things. Now I have to implement it and modify the write function to receive an integer N.</p>\n\n<p>Since I have to receive an integer I thought to modify the write function and instead of a char* buffer receive an int* number but when I try to map file_operations with \"my_write\" terminal gives me an error saying \"incompatible array types\".</p>\n\n<p>My question is what I have to modify in order to receive an integer with the write function insted of a string</p>\n\n<p>These are my functions:</p>\n\n<pre><code>static ssize_t my_write \n      (struct file *filp, const char __user *buf, size_t length, loff_t *offset)\n{\n    int nc = 0;\n\n    if (length &gt; BUF_LEN)\n        return BUF_LEN-length;\n\n    nc = copy_from_user(msg,buf,length); \n    msg_ptr = msg;\n\n    return length - nc;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4593, "user_id": 105104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02b23920ac852e946b333d3f9d0d95c1?s=128&d=identicon&r=PG", "display_name": "dvhh", "link": "https://stackoverflow.com/users/105104/dvhh"}, "edited": false, "score": 1, "creation_date": 1516786584, "post_id": 48419032, "comment_id": 83827857, "body": "maybe you should <a href=\"https://linux.die.net/man/2/fsync\" rel=\"nofollow noreferrer\"><code>fsync</code></a>  ?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1516786620, "post_id": 48419032, "comment_id": 83827882, "body": "Your use of <code>^D</code> and the term <code>terminal</code> suggest you may want to add what OS you are using."}, {"owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "edited": false, "score": 0, "creation_date": 1516786629, "post_id": 48419032, "comment_id": 83827887, "body": "I have to use specific system calls. :\\"}, {"owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "edited": false, "score": 0, "creation_date": 1516786748, "post_id": 48419032, "comment_id": 83827974, "body": "I&#39;m not exactly sure what OS I&#39;m on but I think it&#39;s redhat. I&#39;m sshed into my school&#39;s linux server because they have the proper environment set up."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1516786761, "post_id": 48419032, "comment_id": 83827983, "body": "@usr2564301 The presence of <code>STDIN_FILENO</code> and <code>STDOUT_FILENO</code> indicates that <code>&lt;unistd.h&gt;</code> have been included, and it&#39;s a POSIX specific header file. So either macOS or Linux or one of the BSD variants."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1516786852, "post_id": 48419032, "comment_id": 83828032, "body": "Maybe you should post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1516789675, "post_id": 48419032, "comment_id": 83829880, "body": "I don&#39;t see anything that would cause this code not to print.  (It has several other problems, though.)  When I compile and run it (under MacOS), each key I type immediately prints twice.  So whatever&#39;s causing it not to print as you expect is due to something strange in your environment that we can&#39;t see.  Are you sure you&#39;re running the code exactly as posted?"}, {"owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516790274, "post_id": 48419032, "comment_id": 83830274, "body": "@SteveSummit That&#39;s exactly the problem. There are 2 write statements in the else part of readchar but there is only one output. If you comment out the second one there is no output even though there is a write inside the if condition. The immediate output is expected because nonCanonMode() sets the terminal to read without waiting for newlines."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1516790319, "post_id": 48419032, "comment_id": 83830293, "body": "Blowing away <code>c_iflag</code>, <code>c_oflag</code>, and <code>c_lflag</code> like that is unusual and may be causing you problems.  And you probably don&#39;t care about <code>c_iflag</code> and <code>c_oflag</code> at all.  I recommend leaving <code>c_iflag</code> and <code>c_oflag</code> alone, and turning off just the <code>ECHO</code> and <code>ICANON</code> bits in <code>c_lflag</code> like this: <code>modif.c_lflag &amp;= ~(ICANON | ECHO);</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1516790446, "post_id": 48419032, "comment_id": 83830368, "body": "Also, although its not causing your immediate problem, you should think of something better to do on error than to set <code>readBytes</code> to what it already is."}, {"owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516790482, "post_id": 48419032, "comment_id": 83830394, "body": "@SteveSummit I can&#39;t make those changes. It specified to do it that way in my project spec. I have an error handling function but it&#39;s not important to recreating the problem."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516790819, "post_id": 48419032, "comment_id": 83830593, "body": "It sounds to me as if your project spec is wrong.  But since your code works for me, and since you&#39;re not even willing to try my suggestions to make it work better for you, there&#39;s no way I can help you. Good luck."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1204, "user_id": 4070243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sVC5e.png?s=128&g=1", "display_name": "gj13", "link": "https://stackoverflow.com/users/4070243/gj13"}, "edited": false, "score": 0, "creation_date": 1516797588, "post_id": 48419032, "comment_id": 83834790, "body": "@gj13 he is not using any of the <code>f*</code> functions, so no, <code>fflush</code> won&#39;t help."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516818242, "post_id": 48419032, "comment_id": 83849021, "body": "I&#39;m on ubuntu linux.  I opened a terminal window and ran the posted code.  Then I modified the code to not have the second call to <code>write()</code>  It worked correctly in both conditions.  Suggest it has something to do with your server or the way your attaching to the server."}], "owner": {"reputation": 31, "user_id": 9158447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6c5900fb0f6d1dc608be401ca0e42639?s=128&d=identicon&r=PG&f=1", "display_name": "smmr", "link": "https://stackoverflow.com/users/9158447/smmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516788249, "creation_date": 1516786403, "last_edit_date": 1516788249, "question_id": 48419032, "link": "https://stackoverflow.com/questions/48419032/write2-doesnt-print-to-stdout", "title": "Write(2) doesn&#39;t print to stdout", "body": "<pre><code>#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;getopt.h&gt;\n#include &lt;poll.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n\n#define BUFSIZE 256\n\nchar buffer[BUFSIZE];\nint readBytes;\nstruct termios saved;\nstruct termios modif;\n\nvoid onExit(){\n  if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;saved) == -1)\n    readBytes = readBytes; //placeholder\n}\n\nvoid nonCanonMode(){\n  if(tcgetattr(STDIN_FILENO, &amp;saved) == -1)\n    readBytes = readBytes;\n  if(tcgetattr(STDIN_FILENO, &amp;modif) == -1)\n    readBytes = readBytes;\n  modif.c_iflag = ISTRIP;\n  modif.c_oflag = 0;\n  modif.c_lflag = 0;\n  if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;modif) == -1)\n    readBytes = readBytes;\n  atexit(onExit);\n}\nvoid readChar(){\n  int counter = 0;\n  readBytes = read(STDIN_FILENO, buffer, BUFSIZE);\n  if(readBytes == -1)\n    readBytes = readBytes;\n  while(counter &lt; readBytes){\n    if(buffer[counter] == '\\004'){\n      exit(0);\n    }\n    else{\n      if(write(STDOUT_FILENO, &amp;buffer[counter], sizeof(char)) == -1)\n        readBytes = readBytes;\n      write(STDOUT_FILENO, &amp;buffer[counter], sizeof(char));\n    }\n  counter++;\n  }\n}\nint main(){\n  nonCanonMode();\n  while(1)\n    readChar();\n exit(0);\n}\n</code></pre>\n\n<p>The <code>readChar()</code> function doesn't print out characters as they are typed in. I put my terminal into noncanonical mode and loop this function indefinitely to read a character at a time. However the function only writes to stdout once. If I comment out the second <code>write</code> then there's no output. </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1516786167, "post_id": 48418828, "comment_id": 83827578, "body": "Also, <code>atexit</code> functions are fired when you do an explicit call to <code>exit</code>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 7, "last_activity_date": 1516786199, "last_edit_date": 1516786199, "creation_date": 1516785769, "answer_id": 48418828, "question_id": 48418785, "link": "https://stackoverflow.com/questions/48418785/possible-to-call-code-upon-termination-in-a-c-program/48418828#48418828", "title": "Possible to call code upon termination in a C program?", "body": "<p>In C, you use the C standard library function <code>atexit</code>, which allows you to specify a <code>void</code> function taking no parameters to be called when the program terminates (conceptually, when the closing brace <code>}</code> of the first calling of <code>main</code> is reached).</p>\n\n<p>You can register up to 32 such functions in portable C and they are called in the reverse order in which they were registered.</p>\n\n<p>See <a href=\"http://en.cppreference.com/w/c/program/atexit\" rel=\"nofollow noreferrer\">http://en.cppreference.com/w/c/program/atexit</a></p>\n"}, {"comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1516786009, "post_id": 48418873, "comment_id": 83827464, "body": "I don&#39;t feel it answers the question, and you should also mention <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal(7)</a> and most importantly <b><a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">signal-safety(7)</a></b>"}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1516786051, "post_id": 48418873, "comment_id": 83827495, "body": "This answer and the one about <code>atexit</code> are complementary: <code>atexit</code> fires for normal terminations, signal handlers fire for (most) abnormal terminations."}, {"owner": {"reputation": 34086, "user_id": 787480, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/91cDR.png?s=128&g=1", "display_name": "Sneftel", "link": "https://stackoverflow.com/users/787480/sneftel"}, "edited": false, "score": 0, "creation_date": 1516786092, "post_id": 48418873, "comment_id": 83827517, "body": "With that said, it&#39;s a borderline link-only answer. It would be better to include the relevant information directly in the answer."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1516786113, "post_id": 48418873, "comment_id": 83827535, "body": "BTW, it also applies to C++, which was mentioned in the question as a solved thing"}, {"owner": {"reputation": 107, "user_id": 3996454, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5cd7803c0bf8c6b997a7dfe455b43953?s=128&d=identicon&r=PG", "display_name": "TacoVox", "link": "https://stackoverflow.com/users/3996454/tacovox"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1516786139, "post_id": 48418873, "comment_id": 83827561, "body": "Thx @BasileStarynkevitch Shoul&#39;ve mentioned those two as well."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1516795229, "post_id": 48418873, "comment_id": 83833358, "body": "<code>fprintf()</code> is not async-signal-safe and can not be safely called from within a signal handler.  See <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/9699919799/functions/&hellip;</a>"}, {"owner": {"reputation": 107, "user_id": 3996454, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5cd7803c0bf8c6b997a7dfe455b43953?s=128&d=identicon&r=PG", "display_name": "TacoVox", "link": "https://stackoverflow.com/users/3996454/tacovox"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1516801295, "post_id": 48418873, "comment_id": 83837255, "body": "@AndrewHenle did not know this! Good information to have. Thanks!"}], "tags": [], "owner": {"reputation": 107, "user_id": 3996454, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5cd7803c0bf8c6b997a7dfe455b43953?s=128&d=identicon&r=PG", "display_name": "TacoVox", "link": "https://stackoverflow.com/users/3996454/tacovox"}, "is_accepted": false, "score": 2, "last_activity_date": 1516786481, "last_edit_date": 1516786481, "creation_date": 1516785891, "answer_id": 48418873, "question_id": 48418785, "link": "https://stackoverflow.com/questions/48418785/possible-to-call-code-upon-termination-in-a-c-program/48418873#48418873", "title": "Possible to call code upon termination in a C program?", "body": "<p>If you want to call a specific routine on some specific behavior, you can try to handle signals: <a href=\"http://man7.org/linux/man-pages/man2/sigaction.2.html\" rel=\"nofollow noreferrer\">sigaction(2)</a></p>\n\n<p>Here is for example a case, where someone wants to handle a segmentation fault:\n<a href=\"https://stackoverflow.com/questions/10202941/segmentation-fault-handling\">Segmentation fault handling</a></p>\n\n<p>A simple example handling CTRL + c:</p>\n\n<pre><code>#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid handle_signal(int);\n\nint main(int argc, char* argv[])\n{\n    //Setup Signal handling\n    struct sigaction sa;\n    memset(&amp;sa, 0, sizeof(sa));\n    sa.sa_handler = handle_signal;\n    sigaction(SIGINT, &amp;sa, NULL);\n    ...\n}\n\nvoid handle_signal(int signal)\n{\n    switch (signal) {\n        case SIGINT:\n            your_cleanup_function();\n            break;\n        default:\n            fprintf(stderr, \"Caught wrong signal: %d\\n\", signal);\n            return;\n    }\n}\n</code></pre>\n\n<p>As later stated in the comments, there are a bunch of different <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\">signal(7)</a> that are available for use.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1516786237, "post_id": 48418960, "comment_id": 83827632, "body": "What are you saying exactly? This seems to be in contradiction with my answer."}, {"owner": {"reputation": 107, "user_id": 3996454, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/5cd7803c0bf8c6b997a7dfe455b43953?s=128&d=identicon&r=PG", "display_name": "TacoVox", "link": "https://stackoverflow.com/users/3996454/tacovox"}, "edited": false, "score": 1, "creation_date": 1516787040, "post_id": 48418960, "comment_id": 83828141, "body": "Goto statements are not that infamous! Please check e.g. the <a href=\"https://www.kernel.org/doc/html/v4.10/process/coding-style.html#centralized-exiting-of-functions\" rel=\"nofollow noreferrer\">Kernel Coding Style</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516789761, "post_id": 48418960, "comment_id": 83829939, "body": "Allthough OP introduces the question by mentioning destructors and try-catch, the actual question is \u201cIs there a similar technique in C, whereby if the program terminates unexpectedly I can call a particular routine (to clean-up resources)?\u201d This answer does not answer the question."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 3, "creation_date": 1516792112, "post_id": 48418960, "comment_id": 83831419, "body": "@EricPostpischil When OP&#39;s write ambiguous or self-contradictory questions, as here, it&#39;s pretty hard to answer them!  I liked how there were three almost almost completely different answers based on three different interpretations of what the OP might have wanted.  Why criticize this answer for &quot;not answering the question&quot;?  One could as easily have criticized Bathsheba&#39;s answer for not having anything to do with try/catch blocks."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1516797694, "post_id": 48418960, "comment_id": 83834865, "body": "@SteveSummit: There is nothing ambiguous or self-contradicting about the OP\u2019s post. The post contains exactly one interrogative sentence, that sentence is clear, it states the OP\u2019s goal of cleaning up upon program termination, and it is consistent with the title. The other sentence merely introduces the question and is not a question. And, even if you figure the OP wanted to know whether C had any sort of local try-catch blocks, it is clear they definitely did want to know about a method to clean up at exit, and this answer does not answer that."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1516787124, "last_edit_date": 1516787124, "creation_date": 1516786213, "answer_id": 48418960, "question_id": 48418785, "link": "https://stackoverflow.com/questions/48418785/possible-to-call-code-upon-termination-in-a-c-program/48418960#48418960", "title": "Possible to call code upon termination in a C program?", "body": "<p>No there is no feature like destructors or try-catch blocks in C. You just simply need to check the function return values and clean up resources.</p>\n\n<p>Often C programmers use <em>infamous</em> <code>goto</code> statement to jump to the cleanup code.</p>\n\n<pre><code>void foo()\n{\n    if (!doA())\n        goto exit;\n    if (!doB())\n        goto cleanupA;\n    if (!doC())\n        goto cleanupB;\n\n    /* everything has succeeded */\n    return;\n\ncleanupB:\n    undoB();\ncleanupA:\n    undoA();\nexit:\n    return;\n}\n</code></pre>\n\n<p>Example copied from <a href=\"https://stackoverflow.com/a/245761/450989\">https://stackoverflow.com/a/245761/450989</a></p>\n"}], "owner": {"reputation": 24928, "user_id": 997112, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7c52a3944cdd2eac9725e54fc548f368?s=128&d=identicon&r=PG", "display_name": "user997112", "link": "https://stackoverflow.com/users/997112/user997112"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1516787124, "creation_date": 1516785606, "question_id": 48418785, "link": "https://stackoverflow.com/questions/48418785/possible-to-call-code-upon-termination-in-a-c-program", "title": "Possible to call code upon termination in a C program?", "body": "<p>In C++ if I wish to have code called upon something bad happening I can place the code in the destructor, or a try-catch.</p>\n\n<p>Is there a similar technique in C, whereby if the program terminates unexpectedly I can call a particular routine (to clean-up resources)?</p>\n"}, {"tags": ["c", "compiler-errors", "compilation", "arm", "clang"], "comments": [{"owner": {"reputation": 123, "user_id": 8126045, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/54fae7ffa389e55fe81601ab0324ba77?s=128&d=identicon&r=PG&f=1", "display_name": "a2xia", "link": "https://stackoverflow.com/users/8126045/a2xia"}, "edited": false, "score": 0, "creation_date": 1516785462, "post_id": 48418605, "comment_id": 83827124, "body": "Also possibly related, what does the ARM 6 compiler &#39;define&#39; itself as? I can&#39;t imagine that it would still be <code>__CC_ARM</code> like ARM 5 simply due to the many incompatibilities between 5 and 6..."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 0, "last_activity_date": 1516786001, "creation_date": 1516786001, "answer_id": 48418901, "question_id": 48418605, "link": "https://stackoverflow.com/questions/48418605/migrating-from-arm-5-to-arm-6-compiler-use-of-undeclared-identifier-vectors/48418901#48418901", "title": "Migrating from ARM 5 to ARM 6 Compiler: Use of undeclared identifier &#39;__Vectors&#39;", "body": "<p>This seems to be a reference to the interrupt vector table.</p>\n\n<p>It's not trying to \"define a keyword\"; it's declaring an external variable. The variable generally comes from the linker script so you need to dig there.</p>\n\n<p>If the code doesn't <em>use</em> the variable, you can of course remove it, but perhaps it's manipulating the interrupt vector table in some manner and thus needs to access it.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 8126045, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/54fae7ffa389e55fe81601ab0324ba77?s=128&d=identicon&r=PG&f=1", "display_name": "a2xia", "link": "https://stackoverflow.com/users/8126045/a2xia"}, "is_accepted": false, "score": 1, "last_activity_date": 1516787593, "creation_date": 1516787593, "answer_id": 48419415, "question_id": 48418605, "link": "https://stackoverflow.com/questions/48418605/migrating-from-arm-5-to-arm-6-compiler-use-of-undeclared-identifier-vectors/48419415#48419415", "title": "Migrating from ARM 5 to ARM 6 Compiler: Use of undeclared identifier &#39;__Vectors&#39;", "body": "<p>The problem with the third-party file was that it did not have the necessary <code>#define</code> case for the ARM 6 compiler, which is not the same as ARM 5's <code>#elif (defined __CC_ARM)</code>.</p>\n\n<p>The missing lines were:</p>\n\n<pre><code>#elif defined (__ARMCC_VERSION) &amp;&amp; (__ARMCC_VERSION &gt;= 6010050)\n     extern unsigned char __Vectors;\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 8126045, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/54fae7ffa389e55fe81601ab0324ba77?s=128&d=identicon&r=PG&f=1", "display_name": "a2xia", "link": "https://stackoverflow.com/users/8126045/a2xia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516787593, "creation_date": 1516784967, "question_id": 48418605, "link": "https://stackoverflow.com/questions/48418605/migrating-from-arm-5-to-arm-6-compiler-use-of-undeclared-identifier-vectors", "title": "Migrating from ARM 5 to ARM 6 Compiler: Use of undeclared identifier &#39;__Vectors&#39;", "body": "<p>Currently migrating a large C-language project from ARM 5 to ARM 6 compiler within Keil uVision. One of the files is a third-party file. The one error that has me stumped is <code>error: use of undeclared identifier '__Vectors'</code>. In the same file, there are some <code>#define</code> directives for various compilers, and for the Keil case, it just has</p>\n\n<pre><code>#elif (defined __CC_ARM)\n  extern unsigned char __Vectors\n</code></pre>\n\n<p>which works fine for ARM 5. ARM 6 now is based on clang, so I'm wondering if that's the problem, and if so, what the new <code>__Vectors</code> keyword should be defined as.</p>\n\n<p>I am using the latest (Version 5.2.0) of CMSIS and the latest version of my particular STM device support.</p>\n"}, {"tags": ["c", "generics"], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516783023, "post_id": 48417956, "comment_id": 83825574, "body": "note: 1st char* cast not needed,  2:maybe type safe not type save"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1516785225, "post_id": 48417956, "comment_id": 83826979, "body": "@chux, in fact it is, unfortunately, at least if you want to plug this code into a macro that is valid for all the cases. All branches of a <code>_Generic</code> must be valid. So if the expression is met with an integer type, the call to <code>strcmp</code> must still be valid, otherwise the compiler will wine."}, {"owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "edited": false, "score": 0, "creation_date": 1516789378, "post_id": 48417956, "comment_id": 83829668, "body": "Yes, it&#39;s not type safe on the second argument.  I&#39;ve documented with a <code>FIXME:</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516817770, "post_id": 48417956, "comment_id": 83848771, "body": "My comment was not on the branch, but on the <i>cast</i>.  <code>strcmp(actual,..</code> is suffcient without the cast.  No need to cast <code>actual</code> as part of the <code>strcmp()</code> call.  The first cast is not needed,"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516876714, "post_id": 48417956, "comment_id": 83872783, "body": "@chux, mine was also on the cast. Try to compile the <code>_Generic</code> expression with <code>-Wall</code> by feeding in two integers as actual and expected. Without cast the compiler would still see the branch <code>strcmp(actual, expected) == 0</code> even if it is not evaluated. And it would complain about it."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1516890720, "post_id": 48417956, "comment_id": 83882203, "body": "Yes fair enoguh."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 5, "last_activity_date": 1516782738, "creation_date": 1516782738, "answer_id": 48417956, "question_id": 48417822, "link": "https://stackoverflow.com/questions/48417822/c-generic-and-char-arrays/48417956#48417956", "title": "C _Generic and char arrays", "body": "<p>This problem is due to an ambiguity that was in the C11 text that introduced <code>_Generic</code>. It is now resolved by the committee in that it is expected that array to pointer conversion is performed to determine the matching type.</p>\n\n<p>For the time being you can work around this by using your <code>actual</code> in an expression that does this conversion. I'd suggest</p>\n\n<pre><code>bool equal = _Generic(                                                                           \n        (actual)+0,                                                                               \n        default:  actual == expected,                                                     \n        char *:         strcmp((char *)actual, (char *)expected) == 0                           \n);\n</code></pre>\n\n<p>BTW, your code is not completely type save, because it doesn't check the type of <code>expected</code>. I'd try to have a second <code>_Generic</code> that ensures that.                                                                        </p>\n"}], "owner": {"reputation": 37702, "user_id": 129805, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/F1gxS.png?s=128&g=1", "display_name": "fadedbee", "link": "https://stackoverflow.com/users/129805/fadedbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 48417956, "answer_count": 1, "score": 2, "last_activity_date": 1516782738, "creation_date": 1516782279, "question_id": 48417822, "link": "https://stackoverflow.com/questions/48417822/c-generic-and-char-arrays", "title": "C _Generic and char arrays", "body": "<p>I have a generic expression (in a macro):</p>\n\n<pre><code>int equal = _Generic(                                                                           \n        (actual),                                                                               \n        unsigned long:  actual == expected,                                                     \n        int:            actual == expected,                                                     \n        unsigned char:  actual == expected,                                                     \n        char *:         strcmp((char *)actual, (char *)expected) == 0                           \n);                                                                                              \n</code></pre>\n\n<p>When I expand it with <code>actual</code> being a char[12] it works on some architectures/compilers, but on some I get the error:</p>\n\n<pre><code>error: controlling expression type 'char [12]' not compatible with any generic association type\n</code></pre>\n\n<p>How can I handle this without writing a line for every single length of char array?  i.e. <code>char[0]</code>, <code>char[1]</code>, <code>char[2]</code> ...</p>\n\n<p>Forcing the char array to decay into a pointer would do the trick, but I cannot change this macro into a function.  Is there a way to force decay?  I have tried <code>*&amp;actual</code>, but it does not result in a <code>char *</code>.</p>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1516782084, "post_id": 48417741, "comment_id": 83825110, "body": "Please edit your post to have proper capitalization and punctuation. It&#39;s hard to read in its current state."}, {"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1516782395, "post_id": 48417741, "comment_id": 83825274, "body": "@user694733 Hi, Is it OK now?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516819611, "post_id": 48417741, "comment_id": 83849747, "body": "<b>Never, never, never</b> use <code>gets()</code> it is so insecure and prone to buffer overrun it has been removed from the C11 library. Learn how to use <code>fgets</code> and trim the trailing <code>&#39;\\n&#39;</code> it includes. It takes no more than 5-lines of code. If your professor suggested <code>gets()</code>, stop - drop the class while there is still time -- and go find a competent professor to teach you C."}, {"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516823993, "post_id": 48417741, "comment_id": 83852181, "body": "@DavidC.Rankin Hi, actually I think I should do what you suggest. and I fix that and use <b>sscanf</b> instead. Thanks."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516825466, "post_id": 48417741, "comment_id": 83852919, "body": "That works too, but remember using <code>scanf</code> for user input is full of pitfalls for the unwary. If you are reading lines (generally what a user inputs) or lines from a file, a <i>line-oriented</i> input function (<code>fgets</code> or POSIX <code>getline</code>) is the proper choice. For numeric data, <code>scanf</code> provides a nice shortcut for <code>fgets&#47;sscanf</code>, but know it leaves the trailing <code>&#39;\\n&#39;</code> unread in <code>stdin</code> just waiting to torpedo your next attempt to read a character with <code>%c</code> or string with <code>%s</code> unless you account for it in your <i>format string</i>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1516825700, "post_id": 48417741, "comment_id": 83853056, "body": "<code>typedef Line *LinePtr;</code> You will want to review: <a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to <b>typedef</b> pointers?</a>. While not an error, the standard coding style for C avoids the use of <code>camelCase</code> or <code>MixedCase</code> variable names in favor of all <i>lower-case</i> while reserving <i>upper-case</i> names for use with macros and constants. example: <a href=\"http://homepages.inf.ed.ac.uk/dts/pm/Papers/nasa-c-style.pdf\" rel=\"nofollow noreferrer\"><b>NASA - C Style Guide, 1994</b></a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516785910, "post_id": 48418531, "comment_id": 83827393, "body": "Hi, as i found part of my problem is about &#39;gets(order);&#39;"}, {"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516786267, "post_id": 48418531, "comment_id": 83827655, "body": "Could you help me with my second problem ? what you said didn&#39;t fix it. thanks"}, {"owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "reply_to_user": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516793710, "post_id": 48418531, "comment_id": 83832442, "body": "Is <code>gets(order)</code> return a new line (which you are seeing as an empty string)?"}], "tags": [], "owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "is_accepted": false, "score": 0, "last_activity_date": 1516784733, "creation_date": 1516784733, "answer_id": 48418531, "question_id": 48417741, "link": "https://stackoverflow.com/questions/48417741/modeling-a-classroom-line-using-linked-list/48418531#48418531", "title": "Modeling a classroom line using linked-list", "body": "<p>I think all you need is this:</p>\n\n<pre><code>void place(LinePtr previousPtr, char array[100]) \n{\n    return add (previousPtr, array);\n}\n\n// If lPtr == null then this is an insertion at the end of the list\n// If lPtr != null then this is an insertion into the list after lPtr.\nvoid add(LinePtr *lPtr, char array[100]) \n{\n    LinePtr newPtr = malloc(sizeof(Line));\n    strcpy(newPtr-&gt;name, array);\n    newPtr-&gt;nextPtr = NULL;\n\n    LinePtr lastPtr = *lPtr;\n    if(*lPtr == NULL) \n    {\n       *lPtr = newPtr;\n       return;\n    }  \n    while(lastPtr-&gt;nextPtr != NULL) {\n        lastPtr = lastPtr-&gt;nextPtr;\n    }\n    lastPtr-&gt;nextPtr = newPtr;\n}\n</code></pre>\n\n<p>Your add function already does an add or insert.  </p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516823534, "post_id": 48429475, "comment_id": 83851902, "body": "Hi, it actually works. thanks. but there is a problem , I still need that specific condition that I explain. after user type <b>place jack john</b> <i>john</i> shouldn&#39;t be on the line unless user type <b>add john</b> then only after that <i>john</i> place on that specific position. could you tell me how to do that ? thanks."}], "tags": [], "owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "is_accepted": false, "score": 0, "last_activity_date": 1516819122, "creation_date": 1516819122, "answer_id": 48429475, "question_id": 48417741, "link": "https://stackoverflow.com/questions/48417741/modeling-a-classroom-line-using-linked-list/48429475#48429475", "title": "Modeling a classroom line using linked-list", "body": "<p>The <code>place</code> function has to know the old node. You can supply a new name as well as the old name.</p>\n\n<pre><code>//place before the other name\nvoid place(LinePtr *list, char *newName, char *otherName)\n{\n    if(list == NULL)\n    {\n        printf(\"the given previous node cannot be NULL\");\n        return;\n    }\n\n    Line *walk = *list;\n    Line *prev = NULL;\n    while(walk)\n    {\n        if(strcmp(walk-&gt;name, otherName) == 0)\n        {\n            //found\n            LinePtr newPtr = (LinePtr)malloc(sizeof(Line));\n            strcpy(newPtr-&gt;name, newName);\n            newPtr-&gt;nextPtr = walk;\n            if(prev)\n                prev-&gt;nextPtr = newPtr;\n            else\n                *list = newPtr;\n            break;\n        }\n        prev = walk;\n        walk = walk-&gt;nextPtr;\n    }\n}\n\nvoid place_after_otherName(LinePtr *list, char *newName, char *otherName)\n{\n    if(list == NULL)\n    {\n        printf(\"the given previous node cannot be NULL\");\n        return;\n    }\n\n    Line *walk = *list;\n    while(walk)\n    {\n        if(strcmp(walk-&gt;name, otherName) == 0)\n        {\n            //found\n            LinePtr newPtr = (LinePtr)malloc(sizeof(Line));\n            strcpy(newPtr-&gt;name, newName);\n            newPtr-&gt;nextPtr = walk-&gt;nextPtr;\n            walk-&gt;nextPtr = newPtr;\n            break;\n        }\n        walk = walk-&gt;nextPtr;\n    }\n}\n</code></pre>\n\n<p>The <code>add</code> function works as expected. Example:</p>\n\n<pre><code>int main(void) \n{\n    LinePtr startPtr = NULL;\n    add(&amp;startPtr, \"x\");\n    add(&amp;startPtr, \"y\");\n    add(&amp;startPtr, \"z\");\n\n    place(&amp;startPtr, \"A\", \"z\");\n    place_after_otherName(&amp;startPtr, \"B\", \"z\");\n\n    LinePtr p = startPtr;\n    while(p)\n    {\n        printf(p-&gt;name);\n        p = p-&gt;nextPtr;\n    }\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516865507, "post_id": 48433401, "comment_id": 83866415, "body": "Hi, Thank you so mush for your time and effort. I take your advice serious and change the code of the program entirely. But Can you fix my problem as I explained ? or Tip how to do that ? <code>place</code> should actually create a virtual node. <b>place john jack</b> should hold a place for <b>jack</b> behind <b>john</b> and then when user type <b>add jack</b> just after this <b>jack</b> join the line and placed after <b>john</b>."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516866906, "post_id": 48433401, "comment_id": 83867066, "body": "Sure, you can do that, but it will add a bit of code (more than you may think). You will add the placeholder node with a fixed name like <code>&quot;RESERVED_jack&quot;</code>. The reason it is needed is <code>place</code> only takes the name to add and the person to add it behind. That means the next loop of entering <code>order:</code> will start again and then on any subsequent <code>add</code> you will have to scan the entire list using <code>strncmp</code> to check for <code>&quot;RESERVED_&quot;</code> before each name. Are you <b>really sure</b> that&#39;s what you want? It doesn&#39;t make a whole lot of sense -- but it is doable."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516867262, "post_id": 48433401, "comment_id": 83867232, "body": "What happens if <code>jack</code> never joins the line? What do you do with the dummy node then? Do you modify every other function to check for and skip any name with <code>&quot;RESERVED_&quot;</code> prefixing the name? It gets quite cumbersome quick -- that is why I think it is unlikely that is really what you are supposed to do. It may even be better to add a &quot;placeholder&quot; member to your <code>struct</code> and set it to <code>1</code> for dummy nodes. That would make the checks easier than checking for prefixed strings."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "edited": false, "score": 0, "creation_date": 1516868002, "post_id": 48433401, "comment_id": 83867577, "body": "Or better yet, don&#39;t have <code>place</code> create any node, create a second list with a struct holding <code>name1</code> and <code>name2</code> and have <code>place</code> add that struct to a to that list. Have a second function <code>put_in_place</code> (that does what my <code>place</code> does now). Then in <code>add</code> compare the name to all <code>name1s</code> in the new list of names and if a match is found pass the <code>name1</code> and <code>name2</code> to <code>put_in_place</code> and remove that node from the new list. (see why I say I don&#39;t think that is really what your task intended...)"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1516841474, "last_edit_date": 1516841474, "creation_date": 1516836730, "answer_id": 48433401, "question_id": 48417741, "link": "https://stackoverflow.com/questions/48417741/modeling-a-classroom-line-using-linked-list/48433401#48433401", "title": "Modeling a classroom line using linked-list", "body": "<p>John, your code is quite awkward, the <code>place</code> and <code>out</code> commands do not work as intended and neither <code>out</code> or <code>back to classroom</code> <code>free</code> any of the memory you have allocated. Get in the habit now of tracking each allocation you make and then <code>free</code> each before the program ends. Yes, the memory is freed when your program exits, but when you begin writing functions (as here) where you allocate memory, you must <code>free</code> that memory or as your code grows, memory management will rapidly become unmanageable. (so do yourself a favor, learn to do it right from the beginning)</p>\n\n<p>Next, in any interface you write where you expect the user to enter input, <em>prompt the user</em> for the input. Otherwise, the user is left looking at a blinking cursor on the screen wondering if the program is stuck??</p>\n\n<p>Thinking though what data you need and logically providing prompts to the user will help you lay your code out in a less awkward fashion.</p>\n\n<p><a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\"><strong>Do not <code>typedef</code> pointers</strong></a>. (e.g. <code>typedef Line *LinePtr;</code>) That will only serve to confuse the heck out of you as to the actual level of pointer indirection, and it also makes your code almost impossible for someone else reading through your code. (this becomes a much bigger problem as you code is spread between 10 different header and source files) Especially while you are learning C <strong>do not <code>typedef</code> pointers</strong></p>\n\n<p>Let's turn to your main program loop. First, since you do not make use of <code>int argc, char *argv[]</code>, the proper invocation of <code>main</code> is <code>int main(void)</code> making it explicit that no arguments are expected. Applying the prompting discussed above, the style changes from my comment and reordering to make a bit more sense, your main could look like:</p>\n\n<pre><code>#define ORDC  25    /* if you need constants, define them or use an enum */\n#define NAMC 100    /*      (don't use magic numbers in your code!)     */\n...\nint main (void) {\n\n    char order[ORDC] = \"\",  /* initialize all strings to zeros */\n        name1[NAMC] = \"\",\n        name2[NAMC] = \"\";\n    line *startptr = NULL;\n\n    /* provide an initial prompt showing valid orders to place */\n    printf (\"orders [add, out, first, place, reverse, back to classroom]\\n\");\n\n    for (;;) {  /* loop until done or user cancels input */\n\n        printf (\"\\norder: \");               /* prompt for order: each iteration */\n        if (!fgets (order, sizeof order, stdin)) {  /* use fgets for user input */\n            fprintf (stderr, \"note: user canceled input.\\n\");\n            return 1;\n        }\n        rmcrlf (order);        /* trim the trailing '\\n' (returning the length) */\n\n        if (strcmp (order, \"back to classroom\") == 0) {         /* are we done? */\n            backtoclassroom (startptr);\n            break;\n        }\n\n        if (strcmp (order, \"reverse\") == 0) {          /* reverse takes no name */\n            reverse (&amp;startptr);\n            continue;\n        }\n\n        printf (\"name : \");        /* every other function takes a student name */\n        if (!fgets (name1, sizeof name1, stdin)) {\n            fprintf (stderr, \"note: user canceled input.\\n\");\n            return 1;\n        }\n        rmcrlf (name1);\n\n        if (strcmp (order, \"add\") == 0)          /* use if, else if, else logic */\n            add (&amp;startptr, name1);\n        else if (strcmp (order, \"out\") == 0)\n            out (&amp;startptr, name1);\n        else if (strcmp (order, \"first\") == 0)\n            first (&amp;startptr, name1);\n        else if (strcmp (order, \"place\") == 0) {      /* place takes two names */\n            printf (\"after: \");\n            if (!fgets (name2, sizeof name2, stdin)) {       /* get name2 here */\n                fprintf (stderr, \"note: user canceled input.\\n\");\n                return 1;\n            }\n            rmcrlf (name2);\n            place (startptr, name1, name2);\n        }\n        else    /* handle the Bad Input case */\n            fprintf (stderr, \"error: invalid order, try again.\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>When you pass an array to a function as a parameter, the first level of indirection (meaning the first <code>[..]</code> following the array name) is converted to a pointer (in fact for any access of an array, other than with <code>sizeof</code>, <code>_Alignof</code> or the unary <code>&amp;</code> operator, or is a string literal used to initialize an array, this conversion takes place, see: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Lvalues, arrays, and function designators (p3)</a>). So your functions need only take a pointer to the array as a parameter, e.g.</p>\n\n<pre><code>void first (line **lptr, char *name);\nvoid place (line *lptr, char *name1, char *name2);\n</code></pre>\n\n<p>(and use descriptive names for your variables, <code>name</code> instead of <code>array</code> makes a lot more sense)</p>\n\n<p>For your <code>out</code> function, you only have two cases you are dealing with, (1) am I deleting the first node? (if so, the list address will become that of the 2nd node), or (2) iterate until I find the node to delete and then <code>prev-&gt;nextptr = current-&gt;nextptr; free (current);</code>. You could do something like:</p>\n\n<pre><code>void out (line **lptr, char *name) \n{\n    line *iter = *lptr,\n        *prev  = *lptr;\n\n    if (strcmp ((*lptr)-&gt;name, name) == 0) {    /* name is first node */\n        iter = iter-&gt;nextptr;                   /* save pointer to next */\n        free (*lptr);                           /* free first */\n        *lptr = iter;                           /* set first = saved */\n        return;\n    }\n\n    while (iter &amp;&amp; strcmp (iter-&gt;name, name)) { /* find node with name */\n        prev = iter;                            /* save previousptr */\n        iter = iter-&gt;nextptr;\n    }\n    if (!iter) {    /* handle name not found */\n        fprintf (stderr, \"error: %s not in list - can't remove.\\n\", name);\n        return;\n    }\n\n    prev-&gt;nextptr = iter-&gt;nextptr;      /* previousptr = nextptr */\n    free (iter);                        /* free current */\n}\n</code></pre>\n\n<p>For your <code>place</code> function, you need 2 names, (1) <code>name1</code>, the name of the new student, and (2) <code>name2</code>, the name of the person to place them after. Adding the needed parameter to <code>place</code>, you could do something like the following:</p>\n\n<pre><code>void place (line *lptr, char *name1, char *name2) \n{\n    line *iter = lptr;\n    line *newptr = malloc (sizeof *newptr);\n    strcpy (newptr-&gt;name, name1);\n    newptr-&gt;nextptr = NULL;\n\n    while (iter &amp;&amp; strcmp (iter-&gt;name, name2))  /* locate after: name */\n        iter = iter-&gt;nextptr;\n\n    if (!iter) {    /* handle name2 not found */\n        fprintf (stderr, \"error: %s not in list - can't place %s.\\n\", \n                name2, name1);\n        return;\n    }\n\n    newptr-&gt;nextptr = iter-&gt;nextptr;\n    iter-&gt;nextptr = newptr;\n}\n</code></pre>\n\n<p>That solves your two pressing issues. There may be a corner-case or two you will need to tweak, but putting all the pieces together (and adding spaces between your function names and the <code>(</code> so older eyes can read your code better, you could do something like the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define ORDC  25    /* if you need constants, define them or use an enum */\n#define NAMC 100    /*      (don't use magic numbers in your code!)     */\n\ntypedef struct line {\n    char name[NAMC];\n    struct line *nextptr;\n} line;\n\nsize_t rmcrlf (char *s);\n\nvoid add (line **lptr, char *name);\nvoid out (line **lptr, char *name);\nint isempty (line *lptr);\nvoid backtoclassroom (line *currentptr);\nvoid first (line **lptr, char *name);\nvoid place (line *lptr, char *name1, char *name2);\nstatic void reverse (line **lptr);\n\nint main (void) {\n\n    char order[ORDC] = \"\",  /* initialize all strings to zeros */\n        name1[NAMC] = \"\",\n        name2[NAMC] = \"\";\n    line *startptr = NULL;\n\n    /* provide an initial prompt showing valid orders to place */\n    printf (\"orders [add, out, first, place, reverse, back to classroom]\\n\");\n\n    for (;;) {  /* loop until done or user cancels input */\n\n        printf (\"\\norder: \");               /* prompt for order: each iteration */\n        if (!fgets (order, sizeof order, stdin)) {  /* use fgets for user input */\n            fprintf (stderr, \"note: user canceled input.\\n\");\n            return 1;\n        }\n        rmcrlf (order);        /* trim the trailing '\\n' (returning the length) */\n\n        if (strcmp (order, \"back to classroom\") == 0) {         /* are we done? */\n            backtoclassroom (startptr);\n            break;\n        }\n\n        if (strcmp (order, \"reverse\") == 0) {          /* reverse takes no name */\n            reverse (&amp;startptr);\n            continue;\n        }\n\n        printf (\"name : \");        /* every other function takes a student name */\n        if (!fgets (name1, sizeof name1, stdin)) {\n            fprintf (stderr, \"note: user canceled input.\\n\");\n            return 1;\n        }\n        rmcrlf (name1);\n\n        if (strcmp (order, \"add\") == 0)          /* use if, else if, else logic */\n            add (&amp;startptr, name1);\n        else if (strcmp (order, \"out\") == 0)\n            out (&amp;startptr, name1);\n        else if (strcmp (order, \"first\") == 0)\n            first (&amp;startptr, name1);\n        else if (strcmp (order, \"place\") == 0) {      /* place takes two names */\n            printf (\"after: \");\n            if (!fgets (name2, sizeof name2, stdin)) {       /* get name2 here */\n                fprintf (stderr, \"note: user canceled input.\\n\");\n                return 1;\n            }\n            rmcrlf (name2);\n            place (startptr, name1, name2);\n        }\n        else    /* handle the Bad Input case */\n            fprintf (stderr, \"error: invalid order, try again.\\n\");\n    }\n\n    return 0;\n}\n\n/** remove newline or carriage-return from 's'.\n *  returns new length. 's' must not be NULL.\n */\nsize_t rmcrlf (char *s)\n{\n    char *p = s;\n\n    if (!*s)        /* s is empty-string */\n        return 0;\n\n    /* find eol or nul-terminating char */\n    for (; *p &amp;&amp; *p != '\\n' &amp;&amp; *p != '\\r'; p++) {}\n\n    if (*p == '\\n' || *p == '\\r')   /* validate eol &amp; overwrite */\n        *p = 0;\n    else                            /* warn - no end-of-line */\n        fprintf (stderr, \"rmcrlf() warning: no eol detected.\\n\");\n\n    return (size_t)(p - s);\n}\n\nint isempty (line *lptr) \n{\n    return (lptr == NULL);\n}\n\nvoid backtoclassroom (line *currentptr) \n{\n    printf (\"\\nline returning to classroom:\\n\\n\");\n    if (isempty (currentptr)) {\n        printf (\"line is empty.\\n\");\n    }\n    else {\n        while (currentptr != NULL) {\n            line *victim = currentptr;          /* ptr to node to free */\n            printf (\"  %s\\n\", currentptr-&gt;name);\n            currentptr = currentptr-&gt;nextptr;\n            free (victim);                      /* free your memory! */\n        }\n    }\n}\n\nstatic void reverse (line **lptr) \n{\n    line *previousptr = NULL,\n        *currentptr = *lptr,\n        *afterptr;\n\n    while (currentptr != NULL) {\n        afterptr  = currentptr-&gt;nextptr;  \n        currentptr-&gt;nextptr = previousptr;   \n        previousptr = currentptr;\n        currentptr = afterptr;\n    }\n    *lptr = previousptr;\n}\n\nvoid out (line **lptr, char *name) \n{\n    line *iter = *lptr,\n        *prev  = *lptr;\n\n    if (strcmp ((*lptr)-&gt;name, name) == 0) {    /* name is first node */\n        iter = iter-&gt;nextptr;                   /* save pointer to next */\n        free (*lptr);                           /* free first */\n        *lptr = iter;                           /* set first = saved */\n        return;\n    }\n\n    while (iter &amp;&amp; strcmp (iter-&gt;name, name)) { /* find node with name */\n        prev = iter;                            /* save previousptr */\n        iter = iter-&gt;nextptr;\n    }\n    if (!iter) {    /* handle name not found */\n        fprintf (stderr, \"error: %s not in list - can't remove.\\n\", name);\n        return;\n    }\n\n    prev-&gt;nextptr = iter-&gt;nextptr;      /* previousptr = nextptr */\n    free (iter);                        /* free current */\n}\n\nvoid first (line **lptr, char *name) \n{\n    line *newptr = malloc (sizeof *newptr);     /* set size on current *ptr */\n    strcpy (newptr-&gt;name, name);\n    newptr-&gt;nextptr = *lptr;\n    *lptr = newptr;\n}\n\nvoid place (line *lptr, char *name1, char *name2) \n{\n    line *iter = lptr;\n    line *newptr = malloc (sizeof *newptr);\n    strcpy (newptr-&gt;name, name1);\n    newptr-&gt;nextptr = NULL;\n\n    while (iter &amp;&amp; strcmp (iter-&gt;name, name2))  /* locate after: name */\n        iter = iter-&gt;nextptr;\n\n    if (!iter) {    /* handle name2 not found */\n        fprintf (stderr, \"error: %s not in list - can't place %s.\\n\", \n                name2, name1);\n        return;\n    }\n\n    newptr-&gt;nextptr = iter-&gt;nextptr;\n    iter-&gt;nextptr = newptr;\n}\n\nvoid add (line **lptr, char *name) \n{\n    line *newptr = malloc (sizeof *newptr);     /* set size on current *ptr */\n    line *lastptr = *lptr;\n    strcpy (newptr-&gt;name, name);\n    newptr-&gt;nextptr = NULL;\n    if (*lptr == NULL) {\n        *lptr = newptr;\n        return;\n    }  \n    while (lastptr-&gt;nextptr != NULL) {\n        lastptr = lastptr-&gt;nextptr;\n    }\n    lastptr-&gt;nextptr = newptr;    \n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/classline\norders [add, out, first, place, reverse, back to classroom]\n\norder: add\nname : john doe\n\norder: add\nname : mary smith\n\norder: first\nname : nancy first\n\norder: place\nname : sally second\nafter: nancy first\n\norder: out\nname : john doe\n\norder: back to classroom\n\nline returning to classroom:\n\n  nancy first\n  sally second\n  mary smith\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/classline\n==22574== Memcheck, a memory error detector\n==22574== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==22574== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info\n==22574== Command: ./bin/classline\n==22574==\norders [add, out, first, place, reverse, back to classroom]\n&lt;snip&gt;\nline returning to classroom:\n\n  nancy first\n  sally second\n  mary smith\n==22574==\n==22574== HEAP SUMMARY:\n==22574==     in use at exit: 0 bytes in 0 blocks\n==22574==   total heap usage: 4 allocs, 4 frees, 448 bytes allocated\n==22574==\n==22574== All heap blocks were freed -- no leaks are possible\n==22574==\n==22574== For counts of detected and suppressed errors, rerun with: -v\n==22574== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 3, "user_id": 9148356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d533e852acd3a7bc5cc380bac346e4?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/9148356/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48433401, "answer_count": 3, "score": -1, "last_activity_date": 1516841474, "creation_date": 1516781978, "last_edit_date": 1516794178, "question_id": 48417741, "link": "https://stackoverflow.com/questions/48417741/modeling-a-classroom-line-using-linked-list", "title": "Modeling a classroom line using linked-list", "body": "<p>I want to model a simple classroom line with my program.</p>\n\n<ul>\n<li><p>function <code>first</code>: Put the student <strong>x</strong> in front of the line.</p></li>\n<li><p>function <code>out</code>: Delete the student <strong>x</strong> from the line.</p></li>\n<li><p>function <code>backToClassroom</code>: Print the student in the line.</p></li>\n<li><p>function <code>reverse</code>: Reverse the students order in the line.</p></li>\n<li><p>function <code>place</code>: Student <strong>x</strong> takes a place for the student <strong>y</strong> behind him/herself then if student <strong>y</strong> want to join the line, he/she should come behind <strong>x</strong>.</p></li>\n<li><p>function <code>add</code>: Add student <strong>x</strong> at the end of the line, unless a student takes a place for him/herself.</p></li>\n</ul>\n\n<p>My problems is:</p>\n\n<p><b> I don't know how should I code function <code>add</code> and <code>place</code> correctly as I explain in top. </b></p>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct line {\n    char name[100];\n    struct line *nextPtr;\n};\n\ntypedef struct line Line;\ntypedef Line *LinePtr;\n\nvoid add(LinePtr *lPtr, char array[100]);\nvoid out(LinePtr *lPtr, char array[100]);\nint isEmpty(LinePtr lPtr);\nvoid backToClassroom(LinePtr currentPtr);\nvoid first(LinePtr* lPtr, char array[100]);\nvoid place(LinePtr previousPtr, char array[100]);\nstatic void reverse(LinePtr* lPtr);\n\nint main(int argc, char *argv[]) {\n\n    char order[25];\n    LinePtr startPtr = NULL;\n    char tempName1[100];\n    char tempName2[100];\n\n    gets(order);\n\n    while(strcmp(order, \"back to classroom\") != 0) {\n\n        if(strcmp(order, \"add\") == 0) {\n            scanf(\"%s\", tempName1);\n            add(&amp;startPtr, tempName1);\n        }\n\n        if(strcmp(order, \"out\") == 0) {\n            scanf(\"%s\", tempName1);\n            out(&amp;startPtr, tempName1);\n        }\n\n        if(strcmp(order, \"first\") == 0) {\n            scanf(\"%s\", tempName1);\n            first(&amp;startPtr, tempName1);\n        }\n\n        if(strcmp(order, \"place\") == 0) {\n            scanf(\"%s\", tempName1);\n            scanf(\"%s\", tempName2);\n            place(startPtr, tempName2);\n        }\n\n        if(strcmp(order, \"reverse\") == 0) {\n            reverse(&amp;startPtr);\n        }\n\n        gets(order);\n    }\n\n    if(strcmp(order, \"back to classroom\") == 0) {\n        backToClassroom(startPtr);\n    }\n\n    return 0;\n}\n\n\nint isEmpty(LinePtr lPtr) {\n    return (lPtr == NULL);\n}\n\nvoid backToClassroom(LinePtr currentPtr) {\n    if(isEmpty(currentPtr)) {\n        printf(\"line is empty.\\n\");\n    }\n    else {\n        while(currentPtr != NULL) {\n            printf(\"%s\\n\", currentPtr-&gt;name);\n            currentPtr = currentPtr-&gt;nextPtr;\n        }\n    }\n}\n\nstatic void reverse(LinePtr* lPtr) {\n    LinePtr previousPtr = NULL;\n    LinePtr currentPtr = *lPtr;\n    LinePtr afterPtr;\n    while(currentPtr != NULL) {\n        afterPtr  = currentPtr-&gt;nextPtr;  \n        currentPtr-&gt;nextPtr = previousPtr;   \n        previousPtr = currentPtr;\n        currentPtr = afterPtr;\n    }\n    *lPtr = previousPtr;\n}\n\nvoid out(LinePtr *lPtr, char array[100]) {\n    LinePtr tempPtr;\n    if(strcmp(array, (*lPtr)-&gt;name) == 0) {\n        tempPtr = *lPtr;\n        *lPtr = (*lPtr)-&gt;nextPtr;\n        free(tempPtr);\n    }\n    else {\n        LinePtr previousPtr = *lPtr;\n        LinePtr currentPtr = (*lPtr)-&gt;nextPtr;\n        while((currentPtr != NULL) &amp;&amp; ((strcmp(currentPtr-&gt;name, array)) != 0)) {\n            previousPtr = currentPtr;\n            currentPtr = currentPtr-&gt;nextPtr;\n        }\n        if(currentPtr != NULL) {\n            tempPtr = currentPtr;\n            previousPtr-&gt;nextPtr = currentPtr-&gt;nextPtr;\n            free(tempPtr);\n        }\n    }\n}\n\nvoid first(LinePtr* lPtr, char array[100]) {\n    LinePtr newPtr = malloc(sizeof(Line));\n    strcpy(newPtr-&gt;name, array);\n    newPtr-&gt;nextPtr = (*lPtr);\n    (*lPtr) = newPtr;\n}\n\nvoid place(LinePtr previousPtr, char array[100]) {\n    if(previousPtr == NULL) { \n       printf(\"the given previous node cannot be NULL\");\n       return;      \n    }  \n    LinePtr newPtr = (LinePtr) malloc(sizeof(Line));\n    strcpy(newPtr-&gt;name, array);\n    newPtr-&gt;nextPtr = previousPtr-&gt;nextPtr; \n    previousPtr-&gt;nextPtr = newPtr;\n}\n\nvoid add(LinePtr *lPtr, char array[100]) {\n    LinePtr newPtr = malloc(sizeof(Line));\n    LinePtr lastPtr = *lPtr;\n    strcpy(newPtr-&gt;name, array);\n    newPtr-&gt;nextPtr = NULL;\n    if(*lPtr == NULL) {\n       *lPtr = newPtr;\n       return;\n    }  \n    while(lastPtr-&gt;nextPtr != NULL) {\n        lastPtr = lastPtr-&gt;nextPtr;\n    }\n    lastPtr-&gt;nextPtr = newPtr;    \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516784485, "post_id": 48417442, "comment_id": 83826496, "body": "Welcome to Stack Overflow.  Please read the <a href=\"https://stackoverflow.com/tour\">About</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> pages soon.  I&#39;m not clear quite what you&#39;re asking in the body of the question.  The &#39;and with&#39; confuses me; it makes more sense if you drop the &#39;and&#39;, but I&#39;m not sure whether that&#39;s what you mean.  It isn&#39;t clear that you are asking about a programming question \u2014 nor where OpenCV fits into the problem.  You seem to be asking an abstract question that does not depend on OpenCV."}], "owner": {"reputation": 11, "user_id": 9260184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YUY_w1I6MxQ/AAAAAAAAAAI/AAAAAAAAAE0/OrWtHbcse48/photo.jpg?sz=128", "display_name": "qin song", "link": "https://stackoverflow.com/users/9260184/qin-song"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516849900, "creation_date": 1516780795, "last_edit_date": 1516849900, "question_id": 48417442, "link": "https://stackoverflow.com/questions/48417442/how-to-use-opencv-to-achieve-extended-kalman-filter-filter-for-rotation-quatern", "title": "How to use OpenCV to achieve Extended Kalman Filter\uff1f(Filter for rotation Quaternion)", "body": "<p>Is EKF just replacing the state transition matrix with the Jacobian matrix of rotation equations at this moment on the basis of Kalman?\nI do not know how to modify the opencv Kalman filter into EKF for quaternions, where should I start?</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1516779410, "post_id": 48417095, "comment_id": 83823800, "body": "<code>Does accessing an unallocated piece of memory necessary return NULL?</code>..Nope."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516779415, "post_id": 48417095, "comment_id": 83823803, "body": "Why are you creating two nodes straight away?"}, {"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516779479, "post_id": 48417095, "comment_id": 83823826, "body": "@EdHeal - Because I set them both to the very first value that gets passed into the appendList function. Is this not a good practice?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516779609, "post_id": 48417095, "comment_id": 83823896, "body": "No it is not good practice. It does not make any sense not being able to have an empty list - i.e. a list with no nodes"}, {"owner": {"reputation": 141, "user_id": 4940378, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/OCXd7.png?s=128&g=1", "display_name": "MSH", "link": "https://stackoverflow.com/users/4940378/msh"}, "edited": false, "score": 0, "creation_date": 1516779909, "post_id": 48417095, "comment_id": 83824050, "body": "Use of unallocated memory results in &quot;undefined behaviour&quot;, hence, you may not assume a NULL return."}, {"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1516780172, "post_id": 48417095, "comment_id": 83824159, "body": "@SouravGhosh - So, is a solution to explicitly set values for the next and value fields of each new node created?"}], "answers": [{"comments": [{"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1516781566, "post_id": 48417300, "comment_id": 83824830, "body": "Worked beautifully! Thanks for this! My only question is when I do the following, <code>Node *current = createNode(); current=list-&gt;head</code>, am I overwriting the values of <code>current</code> with the values of <code>list-&gt;head</code>, or am I forcing <code>current</code> to point to <code>list-&gt;head</code>, and thereby access those values?"}, {"owner": {"reputation": 5652, "user_id": 467968, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e81a0b12d4c3f0f3f93099e181660f?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/467968/neil"}, "reply_to_user": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1516781786, "post_id": 48417300, "comment_id": 83824949, "body": "@random_coder_101 Both.  You probably mean to do <code>current-&gt;next = createNode();</code> but only once you&#39;ve reached the end of your list to append a <code>Node</code> to the end.  If you do <code>Node *current = createNode(); current=list-&gt;head</code> you&#39;ve allocated a new Node and then discarded the pointer (creating a memory leak in the process)."}], "tags": [], "owner": {"reputation": 5652, "user_id": 467968, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/42e81a0b12d4c3f0f3f93099e181660f?s=128&d=identicon&r=PG", "display_name": "Neil", "link": "https://stackoverflow.com/users/467968/neil"}, "is_accepted": true, "score": 2, "last_activity_date": 1516780173, "creation_date": 1516780173, "answer_id": 48417300, "question_id": 48417095, "link": "https://stackoverflow.com/questions/48417095/getting-a-segfault-with-linked-list/48417300#48417300", "title": "Getting a segfault with linked list", "body": "<p>Hmm, well my thoughts are that you've created the initial head and tail <code>Node</code>s and you <em>didn't</em> set its value.  Later you use <code>value</code> to determine whether or not you need to add another node or set head and tail to the value passed:</p>\n\n<pre><code>void appendList(List *list, int num) {\n    if(list-&gt;head-&gt;value == 0) {\n        list-&gt;head-&gt;value = num;\n        list-&gt;tail-&gt;value = num;\n        return;\n    }\n    ...\n</code></pre>\n\n<p>The memory returned from <code>malloc</code> will <em>not</em> be necessarily zero, so your algorithm should ensure that all values are set before proceeding.  </p>\n\n<p>You then proceed to reach the end of your list:</p>\n\n<pre><code>Node *current = calloc(1, sizeof(Node));\ncurrent = list-&gt;head;\nwhile(current-&gt;next != NULL) {\n    current = current-&gt;next;\n}\n</code></pre>\n\n<p>However, again, while <code>list-&gt;head</code> exists, you never set the value of <code>list-&gt;head-&gt;next</code>!  Following an unassigned pointer is not going to end nicely for you in the best of cases.  </p>\n\n<p>Consider creating a method to create a new node:</p>\n\n<pre><code>Node* createNode() {\n    Node* node = malloc(sizeof(Node));\n    if(node == NULL) {\n        return NULL;\n    }\n    node-&gt;value = 0;\n    node-&gt;next = NULL;\n    return node;\n}\n</code></pre>\n\n<p>Also please note that there's a minor correction to the code here (unrelated to your segmentation fault, but could still create memory leak):</p>\n\n<pre><code>list-&gt;head = malloc(sizeof(Node));\nlist-&gt;tail = malloc(sizeof(Node));\nif(list-&gt;head == NULL || list-&gt;tail == NULL) {\n    free(list);\n    return NULL;\n}\n</code></pre>\n\n<p>Note that it <em>is</em> possible for <code>list-&gt;head</code> to correctly be assigned memory and <code>list-&gt;tail</code> to <em>not</em> be correctly assigned memory.  In that case, you risk having a memory leak for <code>list-&gt;head</code>.  Please take the necessary precautions.</p>\n"}, {"comments": [{"owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1516781371, "post_id": 48417536, "comment_id": 83824732, "body": "Do you mean to say that I should just change it to <code>Node *current = list-&gt;head</code>?  I was under the impression that this was a bad practice because I need to allocate memory for any pointer I am using before using it?"}, {"owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "reply_to_user": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1516781814, "post_id": 48417536, "comment_id": 83824961, "body": "Ok but if I have understood fine, you have already allocated memory for <code>list-&gt;head</code>, right?"}, {"owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "reply_to_user": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "edited": false, "score": 0, "creation_date": 1516782184, "post_id": 48417536, "comment_id": 83825172, "body": "Well. If first you allocate memory with <code>calloc</code> and then assign the <code>currect</code> pointer to another memory region, the previous allocated memory isn&#39;t used."}], "tags": [], "owner": {"reputation": 74, "user_id": 7006955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bc659c02316f973315797b41fda012?s=128&d=identicon&r=PG&f=1", "display_name": "LucaG", "link": "https://stackoverflow.com/users/7006955/lucag"}, "is_accepted": false, "score": 0, "last_activity_date": 1516781166, "creation_date": 1516781166, "answer_id": 48417536, "question_id": 48417095, "link": "https://stackoverflow.com/questions/48417095/getting-a-segfault-with-linked-list/48417536#48417536", "title": "Getting a segfault with linked list", "body": "<p>In addition to the previous post, in the following code:</p>\n\n<pre><code>Node *current = calloc(1, sizeof(Node));\ncurrent = list-&gt;head;\nwhile(current-&gt;next != NULL) {\n    current = current-&gt;next;\n}\n</code></pre>\n\n<p>you should to delete the line <code>Node *current = calloc(1, sizeof(Node));</code> because in this way you allocate memory and than don't use it (subsequently you assign <code>currect</code> pointer to another value).</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "is_accepted": false, "score": 1, "last_activity_date": 1516781412, "creation_date": 1516781412, "answer_id": 48417592, "question_id": 48417095, "link": "https://stackoverflow.com/questions/48417095/getting-a-segfault-with-linked-list/48417592#48417592", "title": "Getting a segfault with linked list", "body": "<p>Especially in embedded systems, the code compiled for debug mode and the one for release mode can differ. So, for me, there is no surprise that your code works in debug and won't in release. </p>\n\n<p>When creating linked lists using malloc, it is possible that the compiler sets the address of your \"struct node * next\" element, a non-accessible location in memory. So if you try to access it, you'll get a segfault. (or BAD_EXC in MacOS)</p>\n\n<p>If you suspect that malloc is your problem, try creating a small list with no malloc and see if you have segfault, i.e. use:</p>\n\n<pre><code>struct node myNode;\nstruct node* pmyNode = &amp;myNode;\n</code></pre>\n\n<p>In your while loop, I suppose, you are trying to go to the last element of your list. So, instead of:</p>\n\n<pre><code>while(current-&gt;next != NULL) {\n    current = current-&gt;next;\n}\n</code></pre>\n\n<p>Try to do this:</p>\n\n<pre><code>last_linked_list_element-&gt;next = last_linked_list_element;\n\ncurrent = first_linked_list_element;\n\nwhile(current != current-&gt;next) {\n    current = current-&gt;next;\n}\n</code></pre>\n\n<p>You will break out of the loop when you are at the last element of your list.</p>\n\n<p>Another solution would be to try:</p>\n\n<pre><code>last_linked_list_element-&gt;next = NULL;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>last_linked_list_element-&gt;next = &amp;random_identifier;\n</code></pre>\n\n<p>This will make sure that the pointer locates to an accesible location in memory. Does this solve your problem?</p>\n"}], "owner": {"reputation": 1360, "user_id": 6593789, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-nfq6l0wyldk/AAAAAAAAAAI/AAAAAAAABY0/mHRz3aBVoLU/photo.jpg?sz=128", "display_name": "random_coder_101", "link": "https://stackoverflow.com/users/6593789/random-coder-101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48417300, "answer_count": 3, "score": 0, "last_activity_date": 1516781412, "creation_date": 1516779312, "question_id": 48417095, "link": "https://stackoverflow.com/questions/48417095/getting-a-segfault-with-linked-list", "title": "Getting a segfault with linked list", "body": "<p>Apologies for the very basic question, but I can't figure this out. I am trying to build a simple linked list and append some values to it in C.</p>\n\n<p>Below is the list.c file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#include \"./list.h\"\n\nint main(int argc, char *argv[]) {\n    int arr[] = {1,2,3,4};\n    List *list = createList();\n    int i = 0;\n    for(i = 0; i &lt; 4; i++) {\n        appendList(list, arr[i]);\n    }\n    return 0;\n}\n\nList *createList() {\n    List *list = malloc(sizeof(List));\n    if(list == NULL) {\n        return NULL;\n    }\n\n    list-&gt;head = malloc(sizeof(Node));\n    list-&gt;tail = malloc(sizeof(Node));\n    if(list-&gt;head == NULL || list-&gt;tail == NULL) {\n        free(list);\n        return NULL;\n    }\n\n    list-&gt;size = 0;\n    return list;\n}\n\nvoid appendList(List *list, int num) {\n    if(list-&gt;head-&gt;value == 0) {\n        list-&gt;head-&gt;value = num;\n        list-&gt;tail-&gt;value = num;\n        return;\n    }\n    Node *current = calloc(1, sizeof(Node));\n    current = list-&gt;head;\n    while(current-&gt;next != NULL) {\n        current = current-&gt;next;\n    }\n    current-&gt;next = calloc(1, sizeof(Node));\n    if(current-&gt;next == NULL) {\n        free(current-&gt;next);\n        printf(\"Failed to allocate memory\");\n        exit(1);\n    }\n    current-&gt;next-&gt;value = num;\n    list-&gt;size += 1;\n    list-&gt;tail = current-&gt;next;\n}\n</code></pre>\n\n<p>And below is the header file</p>\n\n<pre><code>#ifndef List_h\n#define List_h\n\n#include &lt;stdlib.h&gt;\n\ntypedef struct node {\n    int value;\n    struct node *next;\n} Node;\n\ntypedef struct {\n    Node *head;\n    Node *tail;\n    int size;\n} List;\n\nList *createList();\nvoid appendList(List *, int num);\nNode *removeList(List *);\nvoid printList(List *);\n\n#endif\n</code></pre>\n\n<p>While running through a debugger, my code seems to be working fine, which makes even less sense. </p>\n\n<p>I assume my issue is in the <code>while</code> loop inside of <code>appendList</code>, where I am trying to access some unallocated piece of memory. Is the issue then with the check I am making, <code>current-&gt;next != NULL</code>? Does accessing an unallocated piece of memory necessary return <code>NULL</code>?</p>\n"}, {"tags": ["c", "floating-point", "division"], "comments": [{"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 0, "creation_date": 1516778305, "post_id": 48416819, "comment_id": 83823187, "body": "<code>1&#47; (i*(i+1))</code> is <b>integer arithmetic</b> i.e. as it takes integer operands, it will give <code>int</code> as output."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1516784549, "post_id": 48416819, "comment_id": 83826535, "body": "regarding: <code>float ans=0.0;</code>   This is assigning a <code>double</code> to a <code>float</code> value.  Suggest: <code>float ans=0.0f;</code>   Notice the trailing <code>f</code>."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1516778531, "creation_date": 1516778531, "answer_id": 48416900, "question_id": 48416819, "link": "https://stackoverflow.com/questions/48416819/telescopic-limit-output-is-different-from-expected-output/48416900#48416900", "title": "Telescopic limit output is different from expected output", "body": "<p>Have a look at the expression</p>\n\n<pre><code>  1/ (i*(i+1))\n</code></pre>\n\n<p><code>i</code> is of type int, and a <code>1</code> (digits) are by default of type <code>int</code> (integer constants of type <code>int</code>, to be pedantic).</p>\n\n<p>So, all the participating members are of type <code>int</code>  and the arithmetic will be integer arithmetic. It is not floating point arithmetic. Thus, for above expression, for any value of <code>i</code>, greater than <code>0</code>, you'll have a result of <code>0</code> as an outcome of integer division.</p>\n\n<p>You need to either </p>\n\n<ul>\n<li>use a <code>float</code> or <code>double</code> type operand</li>\n<li>cast one of the operands to <code>float</code> or <code>double</code></li>\n</ul>\n\n<p>to <em>enforce</em> a floating point arithmetic to get the desired result.</p>\n"}], "owner": {"reputation": 3, "user_id": 9260667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d93bfe4c6153b1ebeffe29f6bd212eb?s=128&d=identicon&r=PG&f=1", "display_name": "wood", "link": "https://stackoverflow.com/users/9260667/wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "closed_date": 1516789883, "accepted_answer_id": 48416900, "answer_count": 1, "score": 0, "last_activity_date": 1516778791, "creation_date": 1516778229, "last_edit_date": 1516778791, "question_id": 48416819, "link": "https://stackoverflow.com/questions/48416819/telescopic-limit-output-is-different-from-expected-output", "closed_reason": "Duplicate", "title": "Telescopic limit output is different from expected output", "body": "<p>For a school assignment we are supposed to write a short piece of code that calculates the telescopic limit up to 100. The expect answer should be <code>sum is: 0.99000</code>\nbut my output is always <code>sum is: 0.00000</code> no matter what I try.</p>\n\n<p>I hope it is a quick fix that I have been overlooking, but I can't, for the life of me, figure out what it is.</p>\n\n<p>here is my code below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n\n    float ans=0.0;\n\n    for(int i=1; i&lt;100; i++){\n        ans += 1/ (i*(i+1));\n    }\n\n    printf(\"sum is: %.5f\",ans);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1516772708, "post_id": 48415527, "comment_id": 83820709, "body": "Which OS are you using?"}, {"owner": {"reputation": 5358, "user_id": 3171657, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J3bKr.png?s=128&g=1", "display_name": "Turn", "link": "https://stackoverflow.com/users/3171657/turn"}, "edited": false, "score": 0, "creation_date": 1516772842, "post_id": 48415527, "comment_id": 83820747, "body": "What are you expecting it to do?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516772867, "post_id": 48415527, "comment_id": 83820761, "body": "Seems to work <a href=\"https://ideone.com/Qib4xU\" rel=\"nofollow noreferrer\">ideone.com/Qib4xU</a>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516772948, "post_id": 48415527, "comment_id": 83820784, "body": "PS: <code>&quot;%1d\\n&quot;</code> should be <code>&quot;%d\\n&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516772984, "post_id": 48415527, "comment_id": 83820794, "body": "I am using Mac OS. I am expecting it to return number of character in an input character."}, {"owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516773054, "post_id": 48415527, "comment_id": 83820823, "body": "For example, if I type a character C, then it should return 2."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1516773088, "post_id": 48415527, "comment_id": 83820837, "body": "Have you tried my change above"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 0, "creation_date": 1516773410, "post_id": 48415527, "comment_id": 83820958, "body": "@BillCao Number of characters in an input character? Do you mean number of characters in input string?"}, {"owner": {"reputation": 24506, "user_id": 8472377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MTIqJ.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/8472377/austin"}, "edited": false, "score": 0, "creation_date": 1516773650, "post_id": 48415527, "comment_id": 83821058, "body": "Type <code>C</code> and return <code>2</code>?"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 24506, "user_id": 8472377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MTIqJ.jpg?s=128&g=1", "display_name": "Austin", "link": "https://stackoverflow.com/users/8472377/austin"}, "edited": false, "score": 0, "creation_date": 1516773999, "post_id": 48415527, "comment_id": 83821185, "body": "@theausome The code does give that output. <code>nc</code>&#39;s value is incremented twice. Once for <code>2</code> and the other for typing enter key."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516773445, "post_id": 48415618, "comment_id": 83820974, "body": "I used Ctrl + Z in my Mac OS terminal console and it seems it only helped to terminate the while loop but it did not return any count value."}, {"owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516774207, "post_id": 48415618, "comment_id": 83821262, "body": "Yes, I just tried it. I inputed &quot;okay&quot;\\n &quot;y&quot;, it returns 6D, what does it mean?"}, {"owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516774284, "post_id": 48415618, "comment_id": 83821295, "body": "If I just input &quot;y&quot;, then it will return 1D. Does the program just count the the total of characters in an input string plus all the n\\?"}, {"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "reply_to_user": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516774335, "post_id": 48415618, "comment_id": 83821320, "body": "@BillCao Is it not what you wanted to do?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "edited": false, "score": 0, "creation_date": 1516776476, "post_id": 48415618, "comment_id": 83822287, "body": "@BillCao: Using control-Z on a Unix box suspends the process; it does not terminate the process.  It is still running, but in suspended animation until you type a magic incantation at the shell (<code>fg %1</code>, for example)."}], "tags": [], "owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1516772974, "creation_date": 1516772974, "answer_id": 48415618, "question_id": 48415527, "link": "https://stackoverflow.com/questions/48415527/character-count-in-c-wont-return-any-value-after-input-of-a-character/48415618#48415618", "title": "Character count in C won&#39;t return any value after input of a character", "body": "<p>You have to input <code>EOF</code> to get out of the loop.</p>\n\n<p>Windows: <kbd>Ctrl</kbd>+<kbd>Z</kbd></p>\n\n<p>Linux  : <kbd>Ctrl</kbd>+<kbd>D</kbd></p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/1118957/c-how-to-simulate-an-eof\">C : How to simulate an EOF?</a></p>\n\n<p>Only after <code>getchar()</code> returns <code>EOF</code> will the value of <code>nc</code> be printed.</p>\n\n<p>And <code>%1d</code> is effectively same as <code>%d</code> as a number has at least one digit.</p>\n\n<p>If you do <code>%10d</code> or something the number would be printed occupying the space that would've been occupied by a 10 digit number. Default alignment is right.\nYou can make it left aligned with <code>%-10d</code></p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 3110178, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b5de196d5ffdb4f3b13d0d5ef8d6e0b4?s=128&d=identicon&r=PG&f=1", "display_name": "Praful Jha", "link": "https://stackoverflow.com/users/3110178/praful-jha"}, "is_accepted": false, "score": 0, "last_activity_date": 1516774014, "last_edit_date": 1516774014, "creation_date": 1516773142, "answer_id": 48415641, "question_id": 48415527, "link": "https://stackoverflow.com/questions/48415527/character-count-in-c-wont-return-any-value-after-input-of-a-character/48415641#48415641", "title": "Character count in C won&#39;t return any value after input of a character", "body": "<p>I think you're missing the input when you run the code. You have to type in the console after compilation is done. Right now it's not getting any input character to count.</p>\n\n<p>The same code works for me. You can check the below ideone screenshot where same code is returning the correct output . \n<a href=\"https://i.stack.imgur.com/rDua3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rDua3.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "is_accepted": false, "score": 0, "last_activity_date": 1516773360, "creation_date": 1516773360, "answer_id": 48415686, "question_id": 48415527, "link": "https://stackoverflow.com/questions/48415527/character-count-in-c-wont-return-any-value-after-input-of-a-character/48415686#48415686", "title": "Character count in C won&#39;t return any value after input of a character", "body": "<p>It seems to me that <code>getchar()</code> will always wait for the user to press enter and input the next line if it is at the end of the stream instead of returning EOF. Therefore the loop statement is always true. You should compare the return value to '\\n' if you want to read one line.</p>\n"}], "owner": {"reputation": 1, "user_id": 9260231, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576780542638778/picture?type=large", "display_name": "Bill Cao", "link": "https://stackoverflow.com/users/9260231/bill-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 48415618, "answer_count": 3, "score": 0, "last_activity_date": 1516775343, "creation_date": 1516772509, "last_edit_date": 1516775343, "question_id": 48415527, "link": "https://stackoverflow.com/questions/48415527/character-count-in-c-wont-return-any-value-after-input-of-a-character", "title": "Character count in C won&#39;t return any value after input of a character", "body": "<p>My code does not return any value. Can anyone help me explain why it does not work?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int nc;\n    nc = 0;\n    while (getchar() != EOF)\n        ++nc;\n    printf(\"%1d\\n\", nc);\n}\n</code></pre>\n"}, {"tags": ["c", "opencv", "image-processing", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 211, "user_id": 5997808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80d184e1eb483a94d7cd0fe42cd58514?s=128&d=identicon&r=PG&f=1", "display_name": "NewTech", "link": "https://stackoverflow.com/users/5997808/newtech"}, "edited": false, "score": 1, "creation_date": 1516784438, "post_id": 48415044, "comment_id": 83826461, "body": "At the moment you change your input image before all values are calculated. Therefore your median filter is not implemented correctly. You should create a new image and assign the resulting values there."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1516816211, "post_id": 48415044, "comment_id": 83847891, "body": "Please provide specific performance observations and information about your system. Also include the image you used so that we can reproduce your results. You probably want to measaure the median loop separately from the pre/post-processing within the <code>medianFilter </code>functions."}, {"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 0, "creation_date": 1516816346, "post_id": 48415044, "comment_id": 83847972, "body": "Why are you using <code>dynamic</code> loop scheduling instead of the default? What&#39;s the performance of the default?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 1, "creation_date": 1516828129, "post_id": 48415044, "comment_id": 83854323, "body": "You are seeing the result of data races. Don&#39;t write into your input data (because it causes wrong filter results, but also because of the data races), and don&#39;t use <code>schedule(dynamic, CHUNK)</code>, let the compiler schedule for you. Also note that a partial sort is sufficient: you only need to find element #4, you don&#39;t need all the other elements sorted. Also, don&#39;t display your image in the code that does timing!"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "edited": false, "score": 1, "creation_date": 1516868836, "post_id": 48434068, "comment_id": 83868005, "body": "The code is still incorrect as per Cris Luengo&#39;s comment."}], "tags": [], "owner": {"reputation": 11, "user_id": 9260164, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156068330183236/picture?type=large", "display_name": "Julian Cuevas", "link": "https://stackoverflow.com/users/9260164/julian-cuevas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516842121, "creation_date": 1516842121, "answer_id": 48434068, "question_id": 48415044, "link": "https://stackoverflow.com/questions/48415044/how-to-optimize-median-filter-with-openmp-c/48434068#48434068", "title": "How to optimize Median Filter with OpenMP (C)?", "body": "<p><strong>Fixed</strong>:</p>\n\n<p>I did apply much of the advice given, and I did see performance improvemets, but the things mentioned weren't the problem.</p>\n\n<p>Turns out it was something pretty stupid. I was running this on a VM with Ubuntu 16.04, and I had accidentally forgotten to increase the number of cores, therefore it was only using 1, which might as well mean it wasn't parallelized at all. </p>\n"}], "owner": {"reputation": 11, "user_id": 9260164, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156068330183236/picture?type=large", "display_name": "Julian Cuevas", "link": "https://stackoverflow.com/users/9260164/julian-cuevas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516842121, "creation_date": 1516769588, "last_edit_date": 1516773590, "question_id": 48415044, "link": "https://stackoverflow.com/questions/48415044/how-to-optimize-median-filter-with-openmp-c", "title": "How to optimize Median Filter with OpenMP (C)?", "body": "<p>I wrote a program that has two versions of a median filter implemented using OpenCV in C, one is sequential and the other is parallelized with OpenMP. My problem lies in that the OpenMP version seems to be running slower than my sequential one, <strong>no matter the chunk size or the number of threads</strong>.</p>\n\n<p>Any ideas/advice is very much welcomed!</p>\n\n<p><strong>Here is my sequential code</strong>:</p>\n\n<pre><code>void medianFilter (const IplImage* img){\n  IplImage* output = cvCloneImage(img);\n  int rows, cols, step;\n  uchar *data;\n\n  rows = output-&gt;height;\n  cols = output-&gt;width;\n  step = output-&gt;widthStep;\n  data = (uchar *)output-&gt;imageData;\n\n  if(!data)\n  { return; }\n\n  //create a sliding window of size 9\n  int window[9];\n\n  for(int y = 1; y &lt; rows - 1; y++){\n      for(int x = 1; x &lt; cols - 1; x++){\n\n          // Pick up window element\n          window[0] = data[(y - 1) * step + (x - 1)];\n          window[1] = data[y * step + (x - 1)];\n          window[2] = data[(y + 1) * step + (x - 1)];\n          window[3] = data[(y - 1) * step + x];\n          window[4] = data[y * step + x];\n          window[5] = data[(y + 1) * step + x];\n          window[6] = data[(y - 1) * step + (x + 1)];\n          window[7] = data[y * step + (x + 1)];\n          window[8] = data[(y + 1) * step + (x + 1)];\n\n          // Sort the window to find median\n          insertionSort(window);\n\n          // Assign the median to centered element of the matrix\n          data[y * step + x] = window[4];\n      }\n  }\n\n  cvNamedWindow(\"Post-filter\", CV_WINDOW_AUTOSIZE);\n  cvShowImage(\"Post-filter\", output);\n  cvReleaseImage(&amp;output);\n  }\n</code></pre>\n\n<p><strong>Here is my parallelized code</strong>:</p>\n\n<pre><code>  void omp_medianFilter (const IplImage* img){\n  IplImage* output = cvCloneImage(img);\n  int rows, cols, step, nthreads;\n  uchar *data;\n\n  rows = output-&gt;height;\n  cols = output-&gt;width;\n  step = output-&gt;widthStep;\n  data = (uchar *)output-&gt;imageData;\n\n  if(!data)\n  { return; }\n\n  // Create a sliding window of size 9\n  int window[9], x, y;\n\n  // Set the number of threads to use\n  omp_set_num_threads(NUM_THREADS);\n\n  // Parallel code segment. Window, x and y are private variables for each thread\n  #pragma omp parallel private(window, x, y)\n  {\n    //if(omp_get_thread_num() == 0){\n      //nthreads = omp_get_num_threads();\n      //printf(\"Numer of threads running: %d \\n\", nthreads);\n    //}\n\n    // Parallel for loop with dynamic scheduling and collapsing nested loops\n    #pragma omp for schedule(dynamic, CHUNK) collapse(2)\n      for(y = 1; y &lt; rows - 1; y++){\n          for(x = 1; x &lt; cols - 1; x++){\n\n              // Pick up 3x3 window elements\n              window[0] = data[(y - 1) * step + (x - 1)];\n              window[1] = data[y * step + (x - 1)];\n              window[2] = data[(y + 1) * step + (x - 1)];\n              window[3] = data[(y - 1) * step + x];\n              window[4] = data[y * step + x];\n              window[5] = data[(y + 1) * step + x];\n              window[6] = data[(y - 1) * step + (x + 1)];\n              window[7] = data[y * step + (x + 1)];\n              window[8] = data[(y + 1) * step + (x + 1)];\n\n              // Sort the window to find median\n              insertionSort(window);\n\n              // Assign the median to centered element of the matrix\n              data[y * step + x] = window[4];\n          }\n      }\n    }\n\n  cvNamedWindow(\"Post-filter (OMP)\", CV_WINDOW_AUTOSIZE);\n  cvShowImage(\"Post-filter (OMP)\", output);\n  cvReleaseImage(&amp;output);\n  }\n</code></pre>\n\n<p><strong>Full Code</strong>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;opencv2/imgproc/imgproc_c.h&gt;\n#include &lt;opencv2/highgui/highgui_c.h&gt;\n#include &lt;opencv2/core/types_c.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;omp.h&gt;\n\n#define NUM_THREADS 8\n#define CHUNK 15000\n\n//Function to measure time\ndouble get_walltime() {   \n  struct timeval tp; gettimeofday(&amp;tp, NULL);\n  return (double) (tp.tv_sec + tp.tv_usec*1e-6);\n}\n\n//Sort the window elements using insertion sort\nvoid insertionSort(int window[])\n{\n    int temp, i , j;\n\n        for(i = 0; i &lt; 9; i++){\n            temp = window[i];\n            for(j = i-1; j &gt;= 0 &amp;&amp; temp &lt; window[j]; j--){\n            window[j+1] = window[j];\n        }\n        window[j+1] = temp;\n    }\n}\n\nvoid medianFilter (const IplImage* img){\n      IplImage* output = cvCloneImage(img);\n      int rows, cols, step;\n      uchar *data;\n\n      rows = output-&gt;height;\n      cols = output-&gt;width;\n      step = output-&gt;widthStep;\n      data = (uchar *)output-&gt;imageData;\n\n      if(!data)\n      { return; }\n\n      //create a sliding window of size 9\n      int window[9];\n\n      for(int y = 1; y &lt; rows - 1; y++){\n          for(int x = 1; x &lt; cols - 1; x++){\n\n              // Pick up window element\n              window[0] = data[(y - 1) * step + (x - 1)];\n              window[1] = data[y * step + (x - 1)];\n              window[2] = data[(y + 1) * step + (x - 1)];\n              window[3] = data[(y - 1) * step + x];\n              window[4] = data[y * step + x];\n              window[5] = data[(y + 1) * step + x];\n              window[6] = data[(y - 1) * step + (x + 1)];\n              window[7] = data[y * step + (x + 1)];\n              window[8] = data[(y + 1) * step + (x + 1)];\n\n              // Sort the window to find median\n              insertionSort(window);\n\n              // Assign the median to centered element of the matrix\n              data[y * step + x] = window[4];\n          }\n      }\n\n      cvNamedWindow(\"Post-filter\", CV_WINDOW_AUTOSIZE);\n      cvShowImage(\"Post-filter\", output);\n      cvReleaseImage(&amp;output);\n    }\n\n// Parallelized implementation of median filter\nvoid omp_medianFilter (const IplImage* img){\n      IplImage* output = cvCloneImage(img);\n      int rows, cols, step, nthreads;\n      uchar *data;\n\n      rows = output-&gt;height;\n      cols = output-&gt;width;\n      step = output-&gt;widthStep;\n      data = (uchar *)output-&gt;imageData;\n\n      if(!data)\n      { return; }\n\n      // Create a sliding window of size 9\n      int window[9], x, y, j, k, min;\n\n      // Set the number of threads to use\n      omp_set_num_threads(NUM_THREADS);\n\n      // Parallel code segment. Window, x and y are private variables for each thread\n      #pragma omp parallel private(window, x, y, j, k, min)\n      {\n        //if(omp_get_thread_num() == 0){\n          //nthreads = omp_get_num_threads();\n          //printf(\"Numer of threads running: %d \\n\", nthreads);\n        //}\n\n        // Parallel for loop with dynamic scheduling and collapsing nested loops\n        #pragma omp for schedule(dynamic, CHUNK) collapse(2)\n          for(y = 1; y &lt; rows - 1; y++){\n              for(x = 1; x &lt; cols - 1; x++){\n\n                  // Pick up 3x3 window elements\n                  window[0] = data[(y - 1) * step + (x - 1)];\n                  window[1] = data[y * step + (x - 1)];\n                  window[2] = data[(y + 1) * step + (x - 1)];\n                  window[3] = data[(y - 1) * step + x];\n                  window[4] = data[y * step + x];\n                  window[5] = data[(y + 1) * step + x];\n                  window[6] = data[(y - 1) * step + (x + 1)];\n                  window[7] = data[y * step + (x + 1)];\n                  window[8] = data[(y + 1) * step + (x + 1)];\n\n                  // Sort the window to find median\n                  //insertionSort(window);\n                  for (int j = 0; j &lt; 5; ++j)\n                  {\n                     //   Find position of minimum element\n                     int min = j;\n                     for (int l = j + 1; l &lt; 9; ++l)\n                       if (window[l] &lt; window[min])\n                          min = l;\n                     //   Put found minimum element in its place\n                     const int temp = window[j];\n                     window[j] = window[min];\n                     window[min] = temp;\n                  }\n\n\n                  // Assign the median to centered element of the matrix\n                  data[y * step + x] = window[4];\n              }\n          }\n        }\n\n      cvNamedWindow(\"Post-filter (OMP)\", CV_WINDOW_AUTOSIZE);\n      cvShowImage(\"Post-filter (OMP)\", output);\n      cvReleaseImage(&amp;output);\n      }\n\n  int main(int argc, char *argv[])\n  {\n  IplImage* src;\n  double time1, time2;\n\n  if(argc&lt;2){\n    printf(\"Usage: main &lt;image-file-name&gt;\\n\\7\");\n    exit(0);\n  }\n\n  // Load a source image\n  src = cvLoadImage(argv[1], CV_LOAD_IMAGE_GRAYSCALE);\n  cvNamedWindow(\"Original\", CV_WINDOW_AUTOSIZE);\n  cvShowImage(\"Original\", src);\n\n  /*time1 = get_walltime();\n  medianFilter(src);\n  time2 = get_walltime();\n  printf(\"Sequential Code Performance: %fs\\n\", time2 - time1);*/\n\n  time1 = get_walltime();\n  omp_medianFilter(src);\n  time2 = get_walltime();\n  printf(\"Parallel Code Performance: %fs\\n\", time2 - time1);\n\n  cvWaitKey(0);\n  cvReleaseImage(&amp;src);\n\n  return 0;\n  }\n</code></pre>\n"}, {"tags": ["c", "pointers", "memory"], "comments": [{"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 2, "creation_date": 1516769384, "post_id": 48414977, "comment_id": 83819756, "body": "Have you tried <code>printf(&quot;%zu\\n&quot;, sizeof(struct fp));</code>? <code>malloc</code> can overallocate (and often does, for alignment reasons), but the compiler will tell you how big it thinks the struct is without the <code>malloc</code> overhead. I highly doubt the <code>struct</code> is more than 4-8 bytes in size. Also, if this is actual C++ code, not C, you should be using <code>new</code>, not <code>malloc</code>; by the C++ standard, it would be illegal to store the result of <code>malloc</code> without casting it to anything but a <code>void*</code> (<code>new</code> returns a typed pointer directly, so no casting needed)."}, {"owner": {"reputation": 3720, "user_id": 5836921, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4461980798f0d7fda472db3e466b81a7?s=128&d=identicon&r=PG", "display_name": "kevguy", "link": "https://stackoverflow.com/users/5836921/kevguy"}, "reply_to_user": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516769944, "post_id": 48414977, "comment_id": 83819911, "body": "@ShadowRanger Sorry, it&#39;s C code, I added the wrong tag. The struct of fp is 4. So it&#39;s actually because of alignment??"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 1, "creation_date": 1516770242, "post_id": 48414977, "comment_id": 83819983, "body": "Alignment, and possibly allocator overhead (storing size associated with allocation or the like). Depends on implementation. Allowing excessive granularity can impose too much overhead (maintaining multiple special purpose heaps for very small allocations), and <code>malloc</code> is required to return memory &quot;that is suitably aligned for any object type.&quot;, which means aligning to a stricter standard than the smallest types you might wish to allocate."}, {"owner": {"reputation": 61, "user_id": 6372292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d4a3413fe12bc374d564814bef1b2e3?s=128&d=identicon&r=PG&f=1", "display_name": "William SY Wong", "link": "https://stackoverflow.com/users/6372292/william-sy-wong"}, "edited": false, "score": 0, "creation_date": 1516770545, "post_id": 48414977, "comment_id": 83820071, "body": "some gut guess: memory canary (buffer overflow protection added by compiler)?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1516775538, "post_id": 48414977, "comment_id": 83821855, "body": "@kevguy Is your machine really a 32-bit address model?"}, {"owner": {"reputation": 3720, "user_id": 5836921, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4461980798f0d7fda472db3e466b81a7?s=128&d=identicon&r=PG", "display_name": "kevguy", "link": "https://stackoverflow.com/users/5836921/kevguy"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1516776382, "post_id": 48414977, "comment_id": 83822233, "body": "@Jean-BaptisteYun&#232;s Yes, and it&#39;s a VM."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1516779525, "post_id": 48414977, "comment_id": 83823850, "body": "You don&#39;t allocate memory for <code>d-&gt;name</code> causing undefined behaviour when you do ` strcpy(d-&gt;name, argv[1]);`"}, {"owner": {"reputation": 3720, "user_id": 5836921, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4461980798f0d7fda472db3e466b81a7?s=128&d=identicon&r=PG", "display_name": "kevguy", "link": "https://stackoverflow.com/users/5836921/kevguy"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1516779709, "post_id": 48414977, "comment_id": 83823948, "body": "@Gerhardh This is part of some code trying to demo how to do a heap buffer overflow attack, so  <code>strcpy(d-&gt;name, argv[1]);</code> is placed there on purpose."}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 3, "last_activity_date": 1516780612, "creation_date": 1516780612, "answer_id": 48417398, "question_id": 48414977, "link": "https://stackoverflow.com/questions/48414977/why-is-function-pointer-12-bytes-long/48417398#48417398", "title": "Why is function pointer 12 bytes long?", "body": "<p>Your initial question can be answered very easily by printing <code>sizeof</code> of your pointer. You will not see a 12 here.</p>\n\n<p>The answer to your question \"Why is function pointer 12 bytes long?\" is simply: \"It's not!\"</p>\n\n<p>But your question describes a different underlying question:\n\"Why does allocating 4 bytes take 12 bytes on the heap?\"</p>\n\n<p>You are under the wrong impression that memory allocation only takes exactly what is needed to store the user data.\nThis is wrong.\nMemory management also needs to store some management data for each allocation. \nWhen you call <code>free</code> the runtime library needs to know the size of the allocated block.</p>\n\n<p>Therefore you can take it as granted that every allocation consumes more memory than the requested amount.</p>\n\n<p>Depending on the implementation of the heap this can be within the heap itself or in a separate area.\nYou can also not rely on taking the same amount of overhead for each allocation. There are weird implementation out there.</p>\n\n<p>Some implementations take the requested amount and add fixed length of management data.\nSome implementations use a buddy system and follow a sequence of fibonacci numbers to determine smallest suitable block size.</p>\n"}], "owner": {"reputation": 3720, "user_id": 5836921, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4461980798f0d7fda472db3e466b81a7?s=128&d=identicon&r=PG", "display_name": "kevguy", "link": "https://stackoverflow.com/users/5836921/kevguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516780612, "creation_date": 1516769138, "last_edit_date": 1516770069, "question_id": 48414977, "link": "https://stackoverflow.com/questions/48414977/why-is-function-pointer-12-bytes-long", "title": "Why is function pointer 12 bytes long?", "body": "<p>I've been inspecting the heap memory when executing the following code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/types.h&gt;\n\nstruct data {\n char name[64];\n};\n\nstruct fp {\n int (*fp)();\n};\n\nvoid winner()\n{\n printf(\"level passed\\n\");\n}\n\nvoid nowinner()\n{\n  printf(\"level has not been passed\\n\");\n}\n\nint main(int argc, char **argv)\n{\n struct data *d;\n struct fp *f;\n\n d = malloc(sizeof(struct data));\n f = malloc(sizeof(struct fp));\n f-&gt;fp = nowinner;\n\n printf(\"data is at %p, fp is at %p\\n\", d, f);\n\n strcpy(d-&gt;name, argv[1]);\n\n f-&gt;fp();\n\n}\n</code></pre>\n\n<p>The code is compiled like this:</p>\n\n<pre><code>gcc winner.c -w -g -fno-stack-protector -z norelro -z execstack -o winner\n</code></pre>\n\n<p>(More code will be added later on so tags like <code>fno-stack-protector</code> are there)</p>\n\n<p>I executed the project with argument \"HELLO\" and I set a break point on <code>f-&gt;fp()</code> and inspect the heap memory:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lwz3m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lwz3m.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everything after the first <code>malloc()</code> makes sense but I'm kinda puzzled about what happened after the second <code>malloc()</code>. The second chunk should only request 4 bytes of memory to store the function pointer but instead it took 12 bytes, which reflects on what is stored on the address <code>0x804a04c</code> (4 bytes of metadata + 12 bytes of requested memory + status bit 1 = 17 => 0x00000011).</p>\n\n<p>And as you can see, the function pointer did only take up four bytes on <code>0x804a050</code> with the address of <code>nowinner</code> (<code>0x080484a1</code>). </p>\n\n<p>I read up on this <a href=\"https://stackoverflow.com/questions/16062651/about-sizeof-of-a-class-member-function-pointer\">SO post</a> and this <a href=\"https://www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible\" rel=\"nofollow noreferrer\">article</a> but it seems it still can't explain why.</p>\n"}, {"tags": ["c", "linux", "multithreading", "global-variables"], "comments": [{"owner": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "edited": false, "score": 0, "creation_date": 1516767693, "post_id": 48414672, "comment_id": 83819333, "body": "Maybe it is because of out-of-order execution of the instructions that modifies the memory. Why don&#39;t you try to add a memory barrier  <code>asm volatile(&quot;&quot; ::: &quot;memory&quot;);</code> before assignment to the <code>g_test</code> in file <code>B.c</code>. Then try to see if the error persists even though you have removed the <code>printf</code> you have mentioned."}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "reply_to_user": {"reputation": 716, "user_id": 2031180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jkKlR.jpg?s=128&g=1", "display_name": "campescassiano", "link": "https://stackoverflow.com/users/2031180/campescassiano"}, "edited": false, "score": 0, "creation_date": 1516774441, "post_id": 48414672, "comment_id": 83821356, "body": "@phyloflash shouldn&#39;t be necessary, a function call like pthread_mutex_lock() should normally already act as such a memory barrier. After all, the compiler has to assume such calls could modify any memory."}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516774744, "post_id": 48414672, "comment_id": 83821485, "body": "It&#39;s possible that the problem is in some part of the code that&#39;s not shown here. Try to show more code. If possible, boil it down to a short but complete program that could be run and tested by others, otherwise people will just be guessing."}, {"owner": {"reputation": 221, "user_id": 7614702, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c31216efe98bbbf3ef06393973d7b24a?s=128&d=identicon&r=PG&f=1", "display_name": "Harlan Chen", "link": "https://stackoverflow.com/users/7614702/harlan-chen"}, "edited": false, "score": 0, "creation_date": 1516776901, "post_id": 48414672, "comment_id": 83822480, "body": "I want to know that should all the global variables be put into the mutex lock sentences.My codes,as you see,I put one out of the mutex lock:if(tmpval != g_test){. see my updates"}, {"owner": {"reputation": 710, "user_id": 3788270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83e3fed9f9ac097afe784d86ab44692d?s=128&d=identicon&r=PG&f=1", "display_name": "Ove", "link": "https://stackoverflow.com/users/3788270/ove"}, "edited": false, "score": 0, "creation_date": 1516782082, "post_id": 48414672, "comment_id": 83825109, "body": "If you want to be really portable, then yes, you probably should protect all variables that could be accessed simultaneously by more than one thread (if not by locks, then at least by atomics). But on certain platforms, such as x86, you can get away without locking simple reads or writes, if you&#39;re doing it right (variables are properly aligned, compiler can&#39;t move code around too much, etc). I think we&#39;d need to see more code to determine how that would work in this particular case."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 7614702, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c31216efe98bbbf3ef06393973d7b24a?s=128&d=identicon&r=PG&f=1", "display_name": "Harlan Chen", "link": "https://stackoverflow.com/users/7614702/harlan-chen"}, "edited": false, "score": 0, "creation_date": 1516769174, "post_id": 48414819, "comment_id": 83819694, "body": "The codes in B.c are in while loop and does not likely to be terminated.."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 0, "last_activity_date": 1516768155, "creation_date": 1516768155, "answer_id": 48414819, "question_id": 48414672, "link": "https://stackoverflow.com/questions/48414672/strange-problems-about-multi-thread-programming-when-using-global-variable/48414819#48414819", "title": "Strange problems about multi-thread programming when using global variable", "body": "<p>Does your program end soon after the <code>printf</code> call? Either by the code you've shown as B.c being [near] the end of <code>main</code>, or by calling <code>exit</code> or similar after the <code>printf</code>? If so, it's likely that your program is terminating before the code in A.c gets to run, and the call to <code>printf</code> simply delays exit long enough to give it time to run. If this is the case you need to add some exit synchronization - for example, a call to <code>pthread_join</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 221, "user_id": 7614702, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c31216efe98bbbf3ef06393973d7b24a?s=128&d=identicon&r=PG&f=1", "display_name": "Harlan Chen", "link": "https://stackoverflow.com/users/7614702/harlan-chen"}, "edited": false, "score": 0, "creation_date": 1516932238, "post_id": 48418487, "comment_id": 83902662, "body": "But another thread in file A.c only reads the global variable in this instance.And g_test = tmpval; is the only write operation for the g_test."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 221, "user_id": 7614702, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c31216efe98bbbf3ef06393973d7b24a?s=128&d=identicon&r=PG&f=1", "display_name": "Harlan Chen", "link": "https://stackoverflow.com/users/7614702/harlan-chen"}, "edited": false, "score": 0, "creation_date": 1516994967, "post_id": 48418487, "comment_id": 83930117, "body": "The value of g_test used in the if statement may change before you execute the pthread_mutex_lock(); so the program has a consistency error.  You need to view this as a transaction, so the if() and assignment appear atomic to an observer.   Similarly the printf might find a different value for g_test than was used in the if or the assignment."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 1, "last_activity_date": 1516853001, "last_edit_date": 1516853001, "creation_date": 1516784555, "answer_id": 48418487, "question_id": 48414672, "link": "https://stackoverflow.com/questions/48414672/strange-problems-about-multi-thread-programming-when-using-global-variable/48418487#48418487", "title": "Strange problems about multi-thread programming when using global variable", "body": "<p>B.c should not reference g_test without holding g_test_mutex; two threads could race over this code, and because you read g_test in the if, then update it later, another thread could have come in and updated g_test in the meantime.</p>\n\n<p>That means this original code is wrong:</p>\n\n<pre><code>if(tmpval != g_test){  // Access to g_test without mutex\n   pthread_mutex_lock(&amp; g_test_mutex);\n   g_test = tmpval;\n   pthread_mutex_unlock(&amp;g_test_mutex);\n}\n</code></pre>\n\n<p>You should keep a copy of g_test in a local variable which you assign when holding the lock; then after releasing the lock, use that local in the printf().</p>\n\n<p>When concurrent programs change behaviour by changing the timing outside of the communicating areas, look for race conditions.</p>\n"}], "owner": {"reputation": 221, "user_id": 7614702, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c31216efe98bbbf3ef06393973d7b24a?s=128&d=identicon&r=PG&f=1", "display_name": "Harlan Chen", "link": "https://stackoverflow.com/users/7614702/harlan-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 48418487, "answer_count": 2, "score": 0, "last_activity_date": 1516853001, "creation_date": 1516766948, "last_edit_date": 1516777388, "question_id": 48414672, "link": "https://stackoverflow.com/questions/48414672/strange-problems-about-multi-thread-programming-when-using-global-variable", "title": "Strange problems about multi-thread programming when using global variable", "body": "<p>It is a little strange.My scenarios are as follows:</p>\n\n<p>define two global variables in file A.c:</p>\n\n<pre><code>volatile bool g_test = true;\npthread_mutex_t g_test_mutex = PTHREAD_MUTEX_INITIALIZER;\n</code></pre>\n\n<p>In file A.c the global variable is read only.</p>\n\n<pre><code>...\npthread_mutex_lock(&amp; g_test_mutex); \nif(! g_test){\n     ret = -1;\n     pthread_mutex_unlock(&amp; g_test_mutex);\n     goto cleanup;\n }\npthread_mutex_unlock(&amp; g_test_mutex);\n...\n</code></pre>\n\n<p>and the global variable is written in another file B.c</p>\n\n<pre><code>...\nextern volatile bool g_test;\nextern pthread_mutex_t g_test_mutex;\n\nbool tmpval = func_to_getval();\n\nif(tmpval != g_test){\n   pthread_mutex_lock(&amp; g_test_mutex);\n   g_test = tmpval;\n   pthread_mutex_unlock(&amp;g_test_mutex);\n}\nprintf(\"g_test value:%s\\n\",g_test?\"yes\":\"no\");\n...\n</code></pre>\n\n<p>The above codes are all Okay.</p>\n\n<p>But it is strange when removing the last printf sentence,the value can not be synced successfully when the g_test is changed and file A.c cannot get the updated value.Why??</p>\n\n<p>Update:</p>\n\n<p>I change the codes:</p>\n\n<pre><code>bool tmpval = func_to_getval();\n\nif(tmpval != g_test){\n   pthread_mutex_lock(&amp; g_test_mutex);\n   g_test = tmpval;\n   pthread_mutex_unlock(&amp;g_test_mutex);\n}\nprintf(\"g_test value:%s\\n\",g_test?\"yes\":\"no\");\n</code></pre>\n\n<p>to </p>\n\n<pre><code>pthread_mutex_lock(&amp;g_can_encrypted_mutex);\ng_can_decrypted = func_to_getval(env); \npthread_mutex_unlock(&amp;g_can_encrypted_mutex);\n</code></pre>\n\n<p>It passed.But this will lock the mutex each time and how much cost will be added by using this method?</p>\n"}, {"tags": ["c", "webkit", "gtk", "webkitgtk"], "comments": [{"owner": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1516788068, "post_id": 48414449, "comment_id": 83828797, "body": "You want a <a href=\"https://developer.gnome.org/gtk3/stable/GtkBox.html\" rel=\"nofollow noreferrer\">GtkBox</a> And then put boxes within boxes. Try Glade until it makes sense."}, {"owner": {"reputation": 48, "user_id": 5830978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4edd2e93f1f174f74105fa973980646a?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Wong", "link": "https://stackoverflow.com/users/5830978/jonathan-wong"}, "reply_to_user": {"reputation": 3049, "user_id": 6150775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f16a0c1701c5debb928d96fa22ba0582?s=128&d=identicon&r=PG&f=1", "display_name": "theGtknerd", "link": "https://stackoverflow.com/users/6150775/thegtknerd"}, "edited": false, "score": 0, "creation_date": 1516834381, "post_id": 48414449, "comment_id": 83857353, "body": "As far as I can tell, as soon as I put the webkitgtk webview inside a gtkbox or gtkgrid, it won&#39;t display."}, {"owner": {"reputation": 324, "user_id": 4489948, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/64be8803c5824e2a6e1dfc72be43f2dd?s=128&d=identicon&r=PG&f=1", "display_name": "nintyfan", "link": "https://stackoverflow.com/users/4489948/nintyfan"}, "edited": false, "score": 0, "creation_date": 1582815476, "post_id": 48414449, "comment_id": 106913986, "body": "I wrote two simple programs using GTK+ webkit2 and in one of them I have similar problem. I could push sources of one of them, but comment isn&#39;t addressed to inserting code."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2220505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a82bfab51ad13a89bf66f1ab514510?s=128&d=identicon&r=PG", "display_name": "user2220505", "link": "https://stackoverflow.com/users/2220505/user2220505"}, "is_accepted": false, "score": 0, "last_activity_date": 1521141483, "creation_date": 1521141483, "answer_id": 49307610, "question_id": 48414449, "link": "https://stackoverflow.com/questions/48414449/webkitgtk-webview-inside-a-gtk-grid-layout-does-not-display-correctly/49307610#49307610", "title": "Webkitgtk webview inside a gtk grid layout does not display correctly", "body": "<p>add</p>\n\n<p>gtk_widget_set_vexpand(GTK_WIDGET(webView), true);</p>\n"}], "owner": {"reputation": 48, "user_id": 5830978, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4edd2e93f1f174f74105fa973980646a?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan Wong", "link": "https://stackoverflow.com/users/5830978/jonathan-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 650, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521141483, "creation_date": 1516765045, "question_id": 48414449, "link": "https://stackoverflow.com/questions/48414449/webkitgtk-webview-inside-a-gtk-grid-layout-does-not-display-correctly", "title": "Webkitgtk webview inside a gtk grid layout does not display correctly", "body": "<p>I'm attempting to build a really simple browser using gtk+ and webkitgtk. This necessitates what a typical browser would need: a uri bar, a back button, home button, and actual webpage display area. The problem is that GTKWindow can only have at most one child widget. After looking at the documentation, it recommended packing, particularly using grids. I created the grid layout, but when running the code, I get just the text box in the top left corner (what'll be the URL bar) with no webkitwebview. If I set the row and column #s to be the same as the textbox, however, and hover over it, will display a really pinched version of the webkitwebview. How do I go about making the webkitwebview display fully, while at the same time, have multiple widgets in the window?</p>\n\n<pre><code>gtk_init(&amp;argc, &amp;argv);\n\n// Create an 800x600 window that will contain the browser instance\nGtkWidget *main_window = gtk_window_new(GTK_WINDOW_TOPLEVEL);\ngtk_window_set_default_size(GTK_WINDOW(main_window), 800, 600);\n\n// create the gtk grid that'll set the layout and put grid in window\nGtkWidget *grid = gtk_grid_new();\ngtk_container_add(GTK_CONTAINER(main_window), GTK_WIDGET(grid));\n\n// create url_bar and add to grid\nGtkWidget *url_bar = gtk_entry_new();\ngtk_grid_attach(GTK_GRID (grid), url_bar, 0, 0, 1, 1);\n\n// Create a browser instance and put in main window\nWebKitWebView *webView = WEBKIT_WEB_VIEW(webkit_web_view_new());\ngtk_grid_attach(GTK_GRID (grid), GTK_WIDGET (webView), 1, 1, 4, 4);\n\n// Set up callbacks so that if either the main window or the browser instance is\n// closed, the program will exit\ng_signal_connect(main_window, \"destroy\", G_CALLBACK(destroyWindowCb), NULL);\ng_signal_connect(webView, \"close\", G_CALLBACK(closeWebViewCb), main_window);\n\n// Load a web page into the browser instance\nwebkit_web_view_load_uri(webView, \"http://webkitgtk.org\");\n\n// Make sure that when the browser area becomes visible, it will get mouse\n// and keyboard events\ngtk_widget_grab_focus(GTK_WIDGET(webView));\n\n// Make sure the main window and all its contents are visible\ngtk_widget_show_all(main_window);\n\n// Run the main GTK+ event loop\ngtk_main();enter code here\n</code></pre>\n"}, {"tags": ["c", "printing", "output"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 1, "creation_date": 1516764228, "post_id": 48414331, "comment_id": 83818487, "body": "<code>size = strlen(sign2);</code>?"}, {"owner": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "reply_to_user": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 0, "creation_date": 1516764351, "post_id": 48414331, "comment_id": 83818512, "body": "Can be strlen(sign), doesn&#39;t seem to make a difference."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "edited": false, "score": 0, "creation_date": 1516765801, "post_id": 48414366, "comment_id": 83818880, "body": "Thank you! Lots to be learned from this. Was mainly looking if there was something quick I was missing that was causing it not to print the whole string."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "edited": false, "score": 0, "creation_date": 1516765869, "post_id": 48414366, "comment_id": 83818892, "body": "@Jaakkath.: The thing is it didn&#39;t print other characters becasuse your logic was wrong. But now it should work."}, {"owner": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "edited": false, "score": 0, "creation_date": 1516766009, "post_id": 48414366, "comment_id": 83818924, "body": "Did you remove the whole switch/cases? Or where are these all supposed to go?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "edited": false, "score": 0, "creation_date": 1516766069, "post_id": 48414366, "comment_id": 83818934, "body": "@Jaakkath.: No..just in the <code>case 1</code> where you are inserting <code>char</code> though <code>char sign2[200]={0}</code> should be where you declared <code>sign2</code>."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1516766009, "last_edit_date": 1516766009, "creation_date": 1516764491, "answer_id": 48414366, "question_id": 48414331, "link": "https://stackoverflow.com/questions/48414331/c-not-printing-whole-string/48414366#48414366", "title": "C not printing whole string", "body": "<p>Lots of problem - but yes we can discuss one by one</p>\n\n<ul>\n<li><p><code>strlen</code> returns the length of the nul terminated <code>char</code> array. The content of the array in your case is indeterminate at the time you are applying <code>strlen</code> on it. This is undefined behavior. You may wanted to initialize the char array <code>char sign2[200]={0}</code> so that you can use <code>strlen</code> on it. (By the way - if you want to get the size of the char array use <code>sizeof(sign2)</code> )</p></li>\n<li><p><code>scanf(\"%s\",&amp;sign2);</code> will be <code>scanf(\"%s\",sign2);</code> because <code>char</code> array converted (\"decays\") into pointer to the first element - which is a pointer to the <code>sign2[0]</code>. That is what you are supposed to pass to <code>scanf</code>. Your compiler complained about it.</p></li>\n<li><p><code>sign2[size]=sign2;</code> is not doing what you are thinking it is doing - this is trying to assign a <code>char*</code> to a <code>char</code> variable which is wrong.</p></li>\n<li><p>Also every time you are overwriting what is there in <code>sign2</code>. Ideally you want to get a <code>char</code> input and that will be <code>scanf(\" %c\",&amp;somecharvar);</code>.</p></li>\n<li><p>After you get the input in <code>somecharvar</code> then adding it would be easy. You can simply get the length of the string and then add the character and also the nul terminating <code>char</code>. In case you are thinking - what will be the case the very first time then you will have do one thing - initialized <code>sign2</code> with <code>\\0</code> initially. That way even if you call <code>strlen</code> over it the very first time - it will give you the result of <code>0</code>.</p>\n\n<pre><code>char somevar;\nif( scanf(\" %c\",&amp;somevar)!= 1){\n    fprintf(stderr,\"Error in input\\n\");\n    exit(1);\n}\nsize_t sz = strlen(sign2);\nif(sz+1 &lt; sizeof(sign2)){\n    sign2[sz]=somevar;\n    sign2[sz+1]=0;\n} else {\n    fprintf(stderr,\"Noe enough space\\n\");\n    exit(1);\n}\n</code></pre></li>\n<li><p>As you have already seen, <code>strlen</code> returns the length of the string which of type <code>size_t</code>. <code>size_t</code> is guaranteed to hold the size of any object in <code>C</code>.</p></li>\n<li><p>For <code>scanf</code> always check it's return value, in case it fails you will know it and terminate the program or handle it accordingly( most plausible being - eating out the wrong inputs from <code>stdin</code> that would still be there because <code>scanf</code> couldn't parse it).</p></li>\n<li><p>This is a good practice you can say - instead of using hard-coded value (magic numbers) like <code>200</code> or similar use a <code>macro</code> or constant to incorporate them. </p></li>\n</ul>\n"}], "owner": {"reputation": 65, "user_id": 8968059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/575c781c882fe65d6053d86b771d335e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaakkath", "link": "https://stackoverflow.com/users/8968059/jaakkath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 1, "accepted_answer_id": 48414366, "answer_count": 1, "score": 0, "last_activity_date": 1516775589, "creation_date": 1516764199, "last_edit_date": 1516775589, "question_id": 48414331, "link": "https://stackoverflow.com/questions/48414331/c-not-printing-whole-string", "title": "C not printing whole string", "body": "<p>My problem is that it's only printing out 1 letter, when it's supposed to print the whole string. I would really appreciate your help! Thank you once again for helping me.</p>\n\n<pre><code>#include &lt; stdio.h &gt;\n\nint main(void) {\n\n    int val;\n\n    val=1;\n\n    while (val!=0) {\n\n        printf(\"\\n\");\n\n        printf(\"Choose\\n\");\n\n        printf(\"1) Add new letter\\n\");\n\n        printf(\"2) Empty string\\n\");\n\n        printf(\"3) Print string\\n\");\n\n        printf(\"0) Stop\\n\");\n\n        printf(\"Choice: \");\n\n        scanf(\"%d\",&amp;val);\n\n        printf(\"\\n\");\n\n        char sign[200];\n\n        char sign2[200];\n\n        int size;\n\n        size = strlen(sign2);\n\n        switch (val) {\n\n            case 1:\n\n                printf(\"Give some letter: \");\n\n                scanf(\"%s\",&amp;sign2);\n\n                strcpy(sign, \"\");\n\n                strcat(sign,sign2);\n\n                sign2[size]=sign2;\n\n                sign2[size+1]='\\0';\n\n                break;\n\n            case 2:\n\n                if (val==2) {\n\n                    printf(\"Emptied string.\\n\");\n\n                    sign2[0] = '\\0';\n\n                }\n                break;\n\n            case 3:\n\n                if (size == 0) {\n\n                    printf(\"Is empty\\n\");\n\n\n                } else {\n\n                    printf(\"String: %s\\n\",sign);\n\n                }\n\n                break;\n\n            case 0:\n\n                printf(\"Stopping.\\n\");\n\n                break;\n\n            default:\n\n                printf(\"Unknown.\\n\");\n\n                break;\n\n        }\n\n    }\n\n        return 0;\n}\n</code></pre>\n\n<p>My problem is that it's only printing out 1 letter, when it's supposed to print the whole string. I would really appreciate your help! Thank you once again for helping me. </p>\n"}, {"tags": ["c", "terminal", "scanf", "fopen"], "comments": [{"owner": {"reputation": 2364, "user_id": 4206629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ea9a378d5409478f2717aae6354396?s=128&d=identicon&r=PG", "display_name": "YongHao Hu", "link": "https://stackoverflow.com/users/4206629/yonghao-hu"}, "edited": false, "score": 0, "creation_date": 1516761495, "post_id": 48413895, "comment_id": 83817874, "body": "Read <code>input.txt&#39; line by line and use </code>fprintf` write to `output.txt&#39;."}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "edited": false, "score": 0, "creation_date": 1516761901, "post_id": 48413895, "comment_id": 83817966, "body": "This question has been asked in far less broad &quot;write my code for me&quot; ways <a href=\"https://stackoverflow.com/search?q=read+file+line+by+line+%5BC%5D\">many, many, times</a>. I suggest reading some of them for inspiration."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516764328, "post_id": 48413895, "comment_id": 83818501, "body": "Short answer is <code>#define BUFSZ 1024 ... char buf[BUFSZ] = &quot;&quot;; while (fgets (buf, BUFSZ, stdin)) fputs (buf, stdout);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516763727, "post_id": 48414004, "comment_id": 83818378, "body": "You need to review this code.  Your sprints attempts to overwrite <code>line[0]</code> with each character.  However, <code>c</code> isn\u2019t defined, but you treat it as an <code>int</code> (correct) or <code>char</code> (incorrect); it isn\u2019t a string so <code>%s</code> is the wrong format."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516763878, "post_id": 48414004, "comment_id": 83818409, "body": "If you fix those mechanics, you\u2019ve not taken any steps to process lines, nor to prevent overflow of your <code>line</code> buffer.  Files are often megabytes if not gigabytes in size, or larger."}, {"owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516860264, "post_id": 48414004, "comment_id": 83864421, "body": "@JonathanLeffler Sorry for my code, I just wrote some snippets of code to remind the author of the problem, forget some basic grammar definitions, thanks for you your reminder"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516861034, "post_id": 48414004, "comment_id": 83864675, "body": "Much better \u2014 but\u2026  Remember that <code>getchar()</code> returns an <code>int</code>, not a <code>char</code>, so you need <code>int c;</code>.  You also still can&#39;t use <code>sprintf(line, &quot;%s&quot;, c)</code> because <code>c</code> is not a pointer to a null terminated string.  You could use <code>%c</code>.  You then need to ensure you write to a new position each time \u2014 you&#39;re still overwriting <code>line[0]</code> on each iteration.  Also, you copy the newline to the start of each line \u2014 or would if the <code>sprintf()</code> was working properly."}, {"owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516861762, "post_id": 48414004, "comment_id": 83864966, "body": "@JonathanLeffler Yes, I changed the code, thank you for your teaching"}, {"owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516862724, "post_id": 48414004, "comment_id": 83865335, "body": "@JonathanLeffler Ok, I set a count to make sure the line variable will not overflow and then change the sprintf to make sure I do not overwrite line, I learned a lot with you"}], "tags": [], "owner": {"reputation": 219, "user_id": 7125206, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-khRuSoovh3U/AAAAAAAAAAI/AAAAAAAAAEM/S8yyc-eW90A/photo.jpg?sz=128", "display_name": "Hatsune", "link": "https://stackoverflow.com/users/7125206/hatsune"}, "is_accepted": false, "score": 0, "last_activity_date": 1516866383, "last_edit_date": 1516866383, "creation_date": 1516761582, "answer_id": 48414004, "question_id": 48413895, "link": "https://stackoverflow.com/questions/48413895/how-do-i-read-a-file-line-by-line-in-c-from-the-terminal/48414004#48414004", "title": "How do I read a file line by line in C from the terminal?", "body": "<pre><code>    #include &lt;stdio.h&gt;\n\n    #define BUFSIZE 1024\n\n    int main(int argc, char *argv[])    \n    {\n        char *line = (char *)malloc(BUFSIZE);\n        if (!line)\n        {\n            printf(\"malloc buffer failed...\\n\");\n            return 1;\n        }\n        memset(line, 0, sizeof(line));\n        FILE *fp;\n        FILE *writefp;\n        int c;\n        int count = 0;\n        int count_buf = BUFSIZE;\n        char scanf_answer;\n\n        if (argc != 3)\n        {\n            printf(\"./myprogram &lt;input.txt&gt; output.txt\\n\");\n            return 1;\n        }\n        fp = fopen(argv[1], \"r\");\n\n        for (;;)\n        {\n            c = getc(fp);\n            if (c == '\\n')\n            {\n                printf(\"%s\\n\", line);\n                printf(\"&lt;Did you want to write this line to [%s]?&gt;\", argv[2]);\n                scanf(\"%c\", &amp;scanf_answer);\n                if (scanf_answer == 'Y' || scanf_answer == 'y')\n                {\n                    writefp = fopen(argv[2], \"a+\");\n                    fprintf(writefp, \"%s\\n\", line);\n                    fclose(writefp);\n                }\n                memset(line, 0, sizeof(line));\n            }\n            else if (c == EOF)\n            {\n                printf(\"%s\\n\", line);\n                printf(\"&lt;Did you want to write this line to [%s]?&gt;\", argv[2]);\n                scanf(\"%c\", &amp;scanf_answer);\n                if (scanf_answer == 'Y' || scanf_answer == 'y')\n                {\n                    writefp = fopen(argv[2], \"a+\");\n                    fprintf(writefp, \"%s\\n\", line);\n                    fclose(writefp);\n                }\n                printf(\"End of file\\n\");\n                break;\n            }\n            if (count &gt;= count_buf)\n            {\n                line = realloc(line, BUFSIZE);\n                count_buf += BUFSIZE;\n                if (!line)\n                {\n                   printf(\"realloc buffer failed...\\s\");\n                   return 1;\n                }\n                count = 0;\n            }\n            sprintf(line,\"%c%c\", line, c);\n            ++count;\n        }\n        fclose(fp);\n        return 0;\n    }\n</code></pre>\n\n<p>This code will print each line, you decide each line to write to the output.txt, and in the file end, it will print <code>End of file</code></p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1516863329, "last_edit_date": 1516863329, "creation_date": 1516764893, "answer_id": 48414428, "question_id": 48413895, "link": "https://stackoverflow.com/questions/48413895/how-do-i-read-a-file-line-by-line-in-c-from-the-terminal/48414428#48414428", "title": "How do I read a file line by line in C from the terminal?", "body": "<p>Here, if you think about what you are doing, you are simply reading continually from <code>stdin</code> and writing the same bytes to <code>stdout</code> until you receive an <code>EOF</code>. While you can use a character oriented approach (e.g. <code>getchar</code>), a read with a fixed length buffer will dramatically cut down the number of reads and writes you have.</p>\n\n<p>Simply declare a buffer of comfortable size, <code>1024</code> (or use the default <code>BUFSIZ</code> provided, generally <code>8192</code> on Linux and <code>512</code> on windoze). Then repeatedly call <code>fgets</code> reading a buffers worth of characters at a time and writing them back to <code>stdout</code> with <code>fputs</code>. That's about as simple as it gets.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BUFSZ 1024\n\nint main (void) {\n\n    char buf[BUFSZ] = \"\";\n\n    while (fgets (buf, BUFSZ, stdin))\n        fputs (buf, stdout);\n\n    return 0;\n}\n</code></pre>\n\n<p>Ideally, you would want a buffer size just longer than the longest line, although it really doesn't matter what size it is. You can read each line all at once, or in multiple calls to <code>fgets</code>. The only difference is the number of function calls made.</p>\n"}, {"tags": [], "owner": {"reputation": 28085, "user_id": 1025391, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/76a088ae59745a0c4a377f362fec0fc4?s=128&d=identicon&r=PG", "display_name": "moooeeeep", "link": "https://stackoverflow.com/users/1025391/moooeeeep"}, "is_accepted": false, "score": 0, "last_activity_date": 1516868880, "last_edit_date": 1516868880, "creation_date": 1516867068, "answer_id": 48438099, "question_id": 48413895, "link": "https://stackoverflow.com/questions/48413895/how-do-i-read-a-file-line-by-line-in-c-from-the-terminal/48438099#48438099", "title": "How do I read a file line by line in C from the terminal?", "body": "<blockquote>\n  <p><code>$ ./myprogram &lt; input.txt &gt; output.txt</code></p>\n</blockquote>\n\n<p>The command you posted uses a shell feature called IO redirection to produce input on stdin from one file and redirect output to stdout to the other file. </p>\n\n<p>To take lines as input to your program is super easy even for lines of arbitrary length if you can use POSIX <code>getline()</code>. Please consult the manpage (linked below) for details.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    // this is the buffer data is read to (including trailing newline)\n    char *buffer = 0;\n    // this will be set to the size of the buffer\n    size_t buffer_size = 0;\n    // this will be set to the number of bytes read\n    ssize_t bytes_read;\n    while ((bytes_read = getline(&amp;buffer, &amp;buffer_size, stdin)) != -1) {\n        // do something with line\n        printf(\"%s\", buffer);\n        // the same buffer will be reused in the next loop iteration\n    }\n    // free buffer eventually\n    free(buffer);\n    return 0;\n}\n</code></pre>\n\n<p>Possible output:</p>\n\n<pre><code>$ gcc test.c &amp;&amp; ./a.out &lt; test.c\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n[...]\n</code></pre>\n\n<p>Note that <code>scanf()</code> is for taking <em>formatted input</em>, which reading lines is not. I suggest you get to learn more about the different approaches to IO (on streams) here:</p>\n\n<ul>\n<li><a href=\"https://www.gnu.org/software/libc/manual/html_node/I_002fO-on-Streams.html#I_002fO-on-Streams\" rel=\"nofollow noreferrer\">https://www.gnu.org/software/libc/manual/html_node/I_002fO-on-Streams.html#I_002fO-on-Streams</a></li>\n</ul>\n\n<p>For reference:</p>\n\n<ul>\n<li><a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/getline.3.html</a></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7687853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca8ddd0385acf8b86b5134d06241848?s=128&d=identicon&r=PG&f=1", "display_name": "code-n00b", "link": "https://stackoverflow.com/users/7687853/code-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1516868880, "creation_date": 1516760760, "last_edit_date": 1516761701, "question_id": 48413895, "link": "https://stackoverflow.com/questions/48413895/how-do-i-read-a-file-line-by-line-in-c-from-the-terminal", "title": "How do I read a file line by line in C from the terminal?", "body": "<p>I have read that I can use fopen to read a file line by line, but I want to access the file from the terminal as such.\nThis is what I have tried:</p>\n\n<p><code>$ ./myprogram &lt; input.txt &gt; output.txt</code></p>\n\n<p>I'm not sure if there's a way to do it with scanf or another way?</p>\n"}, {"tags": ["c", "compression", "gzip", "httpserver", "content-encoding"], "comments": [{"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 3, "creation_date": 1516758534, "post_id": 48413633, "comment_id": 83817203, "body": "Can you use other libraries which are similar to zlib, like zstd? Or are all libraries out of the question? And if so, what kind of answer do you expect, beyond &quot;write it yourself&quot;?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516758869, "post_id": 48413633, "comment_id": 83817275, "body": "Sorry, this is unclear. What, precisely, are your requirements? And based upon those requirements, what have you tried?"}, {"owner": {"reputation": 39, "user_id": 9217106, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcb934526a3a004858178a6fe9640247?s=128&d=identicon&r=PG&f=1", "display_name": "bingzy", "link": "https://stackoverflow.com/users/9217106/bingzy"}, "reply_to_user": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1516759133, "post_id": 48413633, "comment_id": 83817341, "body": "@duskwuff I don&#39;t wanna use any libraries. Isn&#39;t there anything by default In C standard library that let&#39;s us do encode strings and send via HTTP Response."}, {"owner": {"reputation": 39, "user_id": 9217106, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcb934526a3a004858178a6fe9640247?s=128&d=identicon&r=PG&f=1", "display_name": "bingzy", "link": "https://stackoverflow.com/users/9217106/bingzy"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516759280, "post_id": 48413633, "comment_id": 83817384, "body": "@lurker  I am supposed to encode a strip in gzip format and send it via HTTP Response. I wanna implement the encoding without using any external libraries. I have changed the Content-Encoding header to gzip,  the browser says content-encoding error."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516759802, "post_id": 48413633, "comment_id": 83817528, "body": "@Amaresh the standard C library has not a gzip function. If you don&#39;t want to use a library for that, then I&#39;m afraid you will have to write it yourself."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516796315, "post_id": 48413633, "comment_id": 83834035, "body": "@Amaresh just setting the content type in the header doesn&#39;t convert the content. The header field just indicates the format you intend to provide for the content. You have to convert the content yourself. If you can&#39;t use an external library to do so, then you&#39;ll have to write the conversion code yourself, for example, using the method described in the article linked in the answer that duskwuff gave."}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": false, "score": 3, "last_activity_date": 1516760014, "creation_date": 1516760014, "answer_id": 48413811, "question_id": 48413633, "link": "https://stackoverflow.com/questions/48413633/how-to-use-gzip-encoding-in-c-programming-without-using-zlib-library/48413811#48413811", "title": "How to use gzip encoding in C programming without using zlib library", "body": "<p>If you can't (or refuse to) use libraries which implement gzip, the only remaining option will be to implement <a href=\"https://www.ietf.org/rfc/rfc1951.txt\" rel=\"nofollow noreferrer\">the DEFLATE algorithm</a> (and a <a href=\"https://www.ietf.org/rfc/rfc1950.txt\" rel=\"nofollow noreferrer\">gzip wrapper</a> around that) yourself. This is why zlib exists, after all -- the standard C library does not contain an implementation of this algorithm.</p>\n"}, {"comments": [{"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "reply_to_user": {"reputation": 39, "user_id": 9217106, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcb934526a3a004858178a6fe9640247?s=128&d=identicon&r=PG&f=1", "display_name": "bingzy", "link": "https://stackoverflow.com/users/9217106/bingzy"}, "edited": false, "score": 0, "creation_date": 1517000507, "post_id": 48432529, "comment_id": 83932660, "body": "No, I mean using the <code>pipe()</code> and <code>fork()</code> functions to run gzip from your program, or equivalent."}], "tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": false, "score": 1, "last_activity_date": 1516831820, "creation_date": 1516831820, "answer_id": 48432529, "question_id": 48413633, "link": "https://stackoverflow.com/questions/48413633/how-to-use-gzip-encoding-in-c-programming-without-using-zlib-library/48432529#48432529", "title": "How to use gzip encoding in C programming without using zlib library", "body": "<p>You could instead run the gzip utility to compress your data. However it would be more efficient to use the zlib library in your code directly that it would be to fork a job every time you want to respond to an http request.</p>\n\n<p>Or you could write your own gzip-format compression code. Since it is not clear from your question why you would want to avoid using zlib, it is not clear that writing your own compressor would satisfy your needs. In any case, it would take <em>far</em> less time on your part to just use the zlib code, which is freely available for use in any code, commercial or not, without requiring even attribution.</p>\n"}], "owner": {"reputation": 39, "user_id": 9217106, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcb934526a3a004858178a6fe9640247?s=128&d=identicon&r=PG&f=1", "display_name": "bingzy", "link": "https://stackoverflow.com/users/9217106/bingzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516831820, "creation_date": 1516758464, "question_id": 48413633, "link": "https://stackoverflow.com/questions/48413633/how-to-use-gzip-encoding-in-c-programming-without-using-zlib-library", "title": "How to use gzip encoding in C programming without using zlib library", "body": "<p>I would like use gzip encoding in a simple http server built on C. \nBut I don't want to use zlib library. Please suggest how can I do this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1516757790, "post_id": 48413430, "comment_id": 83817029, "body": "If you have working code and are just looking for ways to improve it, you should be asking on <a href=\"https://codereview.stackexchange.com\">Code Review</a> instead. This site is for questions about problems with code or a programming tool. <a href=\"https://codereview.stackexchange.com\">Code Review</a> was created specifically for those asking for peer review for advice related to working code."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1516763805, "post_id": 48413430, "comment_id": 83818396, "body": "Is this for parsing an <code>ssh</code> config file? In <code>parse_line</code>, why not just check the first word as <code>host</code> or <code>port</code> with <code>strncmp</code> and then locate the <code>=</code> with <code>strchr</code> and find the first char following the pointer returned that isn&#39;t <code>isspace</code>? That seems a more systematic way or finding <code>host&#47;port</code> and the values that follow. For the <code>port</code> line, an option is to just call <code>strtol</code> on one past the pointer returned by <code>strchr</code> and <code>=</code>."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1516757941, "post_id": 48413503, "comment_id": 83817065, "body": "And all this comes to not because you end of waiting on File IO.  Please profile a release build before even thinking about performance."}, {"owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 1, "creation_date": 1516758242, "post_id": 48413503, "comment_id": 83817130, "body": "@MichaelDorgan Even though the performance gains are negligible in relation to the cost of io, this isn&#39;t hard to implement and the loop was made more readable."}], "tags": [], "owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "is_accepted": false, "score": 1, "last_activity_date": 1516758977, "last_edit_date": 1516758977, "creation_date": 1516757327, "answer_id": 48413503, "question_id": 48413430, "link": "https://stackoverflow.com/questions/48413430/c-code-to-read-config-file-and-parse-directives/48413503#48413503", "title": "C code to read config file and parse directives", "body": "<p>There are a few ways that you can improve performance:</p>\n\n<ol>\n<li><p>Calling strstr() in this scenario is inefficient, because the presence of the \"host\" part of buf can be checked once instead of multiple times every time strstr() is called. Instead, make an if statement that checks if buf begins with \"host\", then check if buf contains the other elements. The same thing applies to the portion of code checking for the presence of \"port\".</p></li>\n<li><p>In the loop in main, instead of doing this:</p>\n\n<pre><code>for(i = 0; i &lt; strlen(buffer); i++) { // iterate through the chars in a line\nif(buffer[i] == '#') { // if char is a #, stop processing chars on this line\n    break;\n} else if(buffer[i] == ' ') { // if char is whitespace, continue until something is found\n    continue;\n} else {\n    parse_line(buffer); // if char is not a # and not whitespace, it is a config directive, parse it\n    break;\n}\n</code></pre></li>\n</ol>\n\n<p>do this:</p>\n\n<pre><code>for(i = 0; i &lt; strlen(buffer); i++) { // iterate through the chars in a line\n    char temp = buffer[i];\n    if(temp == '#') { // if char is a #, stop processing chars on this line\n        break;\n    } else if (temp != ' ') {\n        parse_line(buffer); // if char is not a # and not whitespace, it is a config directive, parse it\n        break;\n    }\n</code></pre>\n\n<p>Checking to see if something is not equal to another is likely to be just as fast as checking if they are equal (at least on Intel, the je (jump equal) and jne (jump not equal) instructions exhibit the same latency of 1 cycle each), so the statement with the continue in it is not necessary. The temp variable is so that buffer[i] does not need to be calculated in the second if again in case the first if is false. Also, do what user3121023 stated below (same reason for performance as creating the temp variable).</p>\n\n<ol start=\"3\">\n<li><p>You can use operating-system-specific functions (such as thos from the library WINAPI/WIN32/WIN64 (synonyms) on windows) instead of C standard library functions. Microsoft has very good documentation about their functions in the MSDN (Microsoft Developer Network) web site.</p></li>\n<li><p>Use <code>uint_fast8_t</code> (defined in stdint.h, this typedef is set to the fastest integer type greater than or equal to the size in bits specified in the typedef) when performing operations on the host and port (but use chars when storing the variables on the disk, in order to make read i/o operations faster).</p></li>\n<li><p>This isn't related to performance , but use <code>return EXIT_SUCCESS;</code> in main instead of <code>return 0;</code>, since using EXIT_SUCCESS is more readable and exhibits the same performance.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516758477, "creation_date": 1516758477, "answer_id": 48413634, "question_id": 48413430, "link": "https://stackoverflow.com/questions/48413430/c-code-to-read-config-file-and-parse-directives/48413634#48413634", "title": "C code to read config file and parse directives", "body": "<p>I think <code>parse_line</code> is a little bit rigid for my taste, I would use <code>strtok</code>\ninstead. Then you don't have to worry too much about spaces, like you do if you\nhave a space before the <code>=</code> sign.</p>\n\n<p>Your <code>struct</code> is also wrong, <code>host</code> and <code>port</code> would only hold a character.\nBesides <code>port</code> should be an integer. And you need a semicolon <code>;</code> after the\nstruct definition.</p>\n\n<pre><code>struct config\n{\n  char host[100];\n  int port;\n};\n\nint parse_line(struct config *config, char *buf)\n{\n    if(config == NULL || buf == NULL)\n        return 0;\n\n    char varname[100];\n    char value[100];\n    const char* sep = \"=\\n\"; // get also rid of newlines\n    char *token;\n\n    token = strtok(buf, sep);\n\n    strncpy(varname, token, sizeof varname);\n    varname[sizeof(varname) - 1] = 0; // making sure that varname is C-String\n\n    trim(varname);\n\n    token = strtok(NULL, sep);\n\n    if(token == NULL)\n    {\n        // line not in format var=val\n        return 0;\n    }\n\n    strncpy(value, token, sizeof value);\n    value[sizeof(varname) - 1] = 0\n\n    trim(value);\n\n    if(strcmp(varname, \"port\") == 0)\n    {\n        config-&gt;port = atoi(value);\n        return 1;\n    }\n\n\n    if(strcmp(varname, \"host\") == 0)\n    {\n        strncpy(config-&gt;host, value, siezof config-&gt;host);\n        config-&gt;host[(sizeof config-&gt;host) - 1] = 0;\n        return 1;\n    }\n\n\n    // var=val not recognized\n    return 0;\n}\n</code></pre>\n\n<p>Note that I used a function called <code>trim</code>. This function is not part of the\nstandard library. Below I posted a possible implementation of such a function.</p>\n\n<p>I like using <code>trim</code> because it gets rid of white spaces. Now you can do this in\n<code>main</code>:</p>\n\n<pre><code>struct config config;\n// initializing\nconfig.port = 0;\nconfig.host[0] = 0;\n\nint linecnt = 0;\n\nwhile(fgets(buffer, sizeof(buffer), file) != NULL) {\n    linecnt++;\n    trim(buffer);\n    if(buffer[0] == '#')\n        continue;\n\n    if(!parse_line(&amp;config, buffer))\n    {\n        fprintf(stderr, \"Error on line %d, ignoring.\\n\", linecnt);\n        continue;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>A possible implementation of <code>trim</code></p>\n\n<pre><code>void rtrim(char *src)\n{\n    size_t i, len;\n    volatile int isblank = 1;\n\n    if(src == NULL) return;\n\n    len = strlen(src);\n    if(len == 0) return;\n    for(i = len - 1; i &gt; 0; i--)\n    {   \n        isblank = isspace(src[i]);\n        if(isblank)\n            src[i] = 0;\n        else\n            break;\n    }   \n    if(isspace(src[i]))\n        src[i] = 0;\n}\n\nvoid ltrim(char *src)\n{\n    size_t i, len;\n\n    if(src == NULL) return;\n\n    i = 0;\n    len = strlen(src);\n    if(len == 0) return;\n    while(src[i] &amp;&amp; isspace(src[i]))\n                i++;\n\n    memmove(src, src + i, len - i + 1); \n    return;\n}\n\nvoid trim(char *src)\n{\n    rtrim(src);\n    ltrim(src);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1516762953, "last_edit_date": 1516762953, "creation_date": 1516762543, "answer_id": 48414126, "question_id": 48413430, "link": "https://stackoverflow.com/questions/48413430/c-code-to-read-config-file-and-parse-directives/48414126#48414126", "title": "C code to read config file and parse directives", "body": "<p>Honestly, I can't help but wonder if rolling your own parser is so great.</p>\n\n<p>Why not use an existing JSON or YAML parser and test for keys in the parsed data?</p>\n\n<p>This will be easily extendible by allowing for new keys to be added with very little effort and the common format of the configuration file makes it very easy for developers to edit.</p>\n\n<p>If you are going to roll out your own parser, than some of the previously mentioned advice makes a lot of sense.</p>\n\n<p>The biggest ones are: <strong>don't seek the whole buffer</strong>, read the single line that's in front of you and <strong>report any errors</strong>. Also, <strong>advance as you go</strong>.</p>\n\n<p>Your parser should work correctly if someone would dump a GigaByte of garbage into the configuration file, so make no assumptions about the data.</p>\n"}, {"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": false, "score": 1, "last_activity_date": 1516843351, "last_edit_date": 1516843351, "creation_date": 1516767292, "answer_id": 48414714, "question_id": 48413430, "link": "https://stackoverflow.com/questions/48413430/c-code-to-read-config-file-and-parse-directives/48414714#48414714", "title": "C code to read config file and parse directives", "body": "<p>Your implementation is pretty fragile. Parsers really ought to verify syntax and return errors when they see something unexpected. For example, yours should detect missing fields and multiply defined ones. </p>\n\n<p>Fortunately this parsing problem is simple enough for <code>sscanf</code> to handle everything:</p>\n\n<ul>\n<li>skip blank lines, </li>\n<li>skip comments</li>\n<li>ignore any amount of whitespace</li>\n<li>extract the key/value pairs</li>\n</ul>\n\n<p>Here's code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define CONFIG_SIZE (256)\n#define HOST_SET (1)\n#define PORT_SET (2)\n\ntypedef struct config {\n  unsigned set;\n  char host[CONFIG_SIZE];\n  unsigned long port;\n} CONFIG;\n\n// Parse the buffer for config info. Return an error code or 0 for no error.\nint parse_config(char *buf, CONFIG *config) {\n  char dummy[CONFIG_SIZE];\n  if (sscanf(buf, \" %s\", dummy) == EOF) return 0; // blank line\n  if (sscanf(buf, \" %[#]\", dummy) == 1) return 0; // comment\n  if (sscanf(buf, \" host = %s\", config-&gt;host) == 1) {\n    if (config-&gt;set &amp; HOST_SET) return HOST_SET; // error; host already set\n    config-&gt;set |= HOST_SET;\n    return 0;\n  }\n  if (sscanf(buf, \" port = %lu\", &amp;config-&gt;port) == 1) {\n    if (config-&gt;set &amp; PORT_SET) return PORT_SET; // error; port already set\n    config-&gt;set |= PORT_SET;\n    return 0;\n  }\n  return 3; // syntax error\n}\n\nvoid init_config(CONFIG *config) {\n  config-&gt;set = 0u;\n}\n\nvoid print_config(CONFIG *config) {\n  printf(\"[host=%s,port=\", config-&gt;set &amp; HOST_SET ? config-&gt;host : \"&lt;unset&gt;\");\n  if (config-&gt;set &amp; PORT_SET) printf(\"%lu]\", config-&gt;port); else printf(\"&lt;unset&gt;]\");\n}\n\nint main(int argc, char *argv[]) {\n  if (argc != 2) {\n    fprintf(stderr, \"Usage: %s CONFIG_FILE\\n\", argv[0]);\n    return 1;\n  }\n  FILE *f = fopen(argv[1], \"r\");\n  char buf[CONFIG_SIZE];\n  CONFIG config[1];\n  init_config(config);\n  int line_number = 0;\n  while (fgets(buf, sizeof buf, f)) {\n    ++line_number;\n    int err = parse_config(buf, config);\n    if (err) fprintf(stderr, \"error line %d: %d\\n\", line_number, err);\n  }\n  print_config(config);\n  return 0;\n}\n</code></pre>\n\n<p>With this input:</p>\n\n<pre><code># This is a comment\n\nThis isn't\n   # Non-leading comment\nhost = 123.456.789.10\n\n ###\nport =42\n\nport=    1\nhost=fruit.foo.bar\n</code></pre>\n\n<p>the output is</p>\n\n<pre><code>error line 3: 3\nerror line 10: 2\nerror line 11: 1\n[host=fruit.foo.bar,port=1]\n</code></pre>\n\n<p>Note that when the parser discovers a field has already been set, it still uses the latest value in the config. It's easy enough to keep the original instead. I'll let you have that fun.</p>\n"}], "owner": {"reputation": 109, "user_id": 7111581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0662e13b16ded01e6394b8c4615cda6e?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7111581/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4826, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1516843351, "creation_date": 1516756728, "last_edit_date": 1516789255, "question_id": 48413430, "link": "https://stackoverflow.com/questions/48413430/c-code-to-read-config-file-and-parse-directives", "title": "C code to read config file and parse directives", "body": "<p>I'm trying to read a config file and parse the config directives. So far I have the following code, I need advice on how to improve this or change it. Is this efficient? Thanks!</p>\n\n<pre><code>struct config\n{\n    char host;\n    char port;\n}\n\nvoid parse_line(char *buf) {\n    char *line;\n    if(strstr(buf, \"host=\") || strstr(buf, \"host = \") || strstr(buf, \"host= \") || strstr(buf, \"host =\")) {\n        line = strstr(buf, \"=\");\n        printf(\"Host: %s\", &amp;line[2]);\n    } else if(strstr(buf, \"port=\") || strstr(buf, \"port = \") || strstr(buf, \"port= \") || strstr(buf, \"port =\")) {\n        line = strstr(buf, \"=\");\n        printf(\"Port: %s\", &amp;line[2]);\n    }\n}\n\nint main(int argc, char *argv[])\n{\n    char *file_name;\n    FILE *file;\n    file_name = argv[1];\n    file = fopen(file_name, \"r\");\n\n    // check if file is NULL, etc..\n\n    char buffer[BUFSIZ];\n    char *line;\n    int i;\n    while(fgets(buffer, sizeof(buffer), file) != NULL) {\n        for(i = 0; i &lt; strlen(buffer); i++) { // iterate through the chars in a line\n            if(buffer[i] == '#') { // if char is a #, stop processing chars on this line\n                break;\n            } else if(buffer[i] == ' ') { // if char is whitespace, continue until something is found\n                continue;\n            } else {\n                parse_line(buffer); // if char is not a # and not whitespace, it is a config directive, parse it\n                break;\n            }\n        }\n    }\n\n    fclose(file);\n    return 0;\n}\n</code></pre>\n\n<p>I am looking for a way to ignore <code>#</code> if it is a first character on a line, and also lines that are white spaces. I think my code does that, but is that efficient?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks everyone for all the suggestions, I have managed to do this simple code to trim the white spaces, so that I wouldn't need all the <code>strstr()</code> calls.</p>\n\n<pre><code>void trim(char *src)\n{\n    int i, len;\n    len = strlen(src);\n\n    for(i = 0; i &lt; len; i++) {\n        if(src[i] == ' ') {\n            continue;\n        }\n        if(src[i] == '\\n' || src[i] == '#') {\n            break;\n        }\n        printf(\"%c\", src[i]); // prints: host=1.2.3.4\n    }\n}\n\nint main(void)\n{\n    char *str = \"host =  1.2.3.4 # this is a comment\\n\";\n    trim(str);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>It prints correctly: <code>host=1.2.3.4</code> but now I need this in a variable to be further parsed. I think I will try to use <code>strcpy</code>.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I do not think that <code>strcpy</code> is the right choice. Those chars are printed out in a loop, so every time I use <code>strcpy</code>, the previous char is overwritten. I have tried this, but it does not work because only the <code>host=</code> part is placed into arr. The IP part is not placed into <code>arr</code>.. how can this be fixed..</p>\n\n<pre><code>char arr[sizeof(src)];\n\nfor(i = 0; i &lt; len; i++) {\n    if(src[i] == ' ') {\n        continue;\n    }\n    if(src[i] == '\\n' || src[i] == '#') {\n        break;\n    }\n    printf(\"%c\", src[i]); // prints: host=1.2.3.4\n    arr[i] = src[i];\n}\n\nint j;\nfor(j = 0; j &lt; sizeof(arr); j++) {\n    printf(\"%c\", arr[j]); //prints: host=\n}\n</code></pre>\n\n<p><strong>EDIT 3:</strong></p>\n\n<p>I found the correct way of placing chars into <code>arr</code>:</p>\n\n<pre><code>int i, count = 0;\nfor(i = 0; i &lt; len; i++) {\n    if(src[i] == ' ') {\n        continue;\n    }\n    if(src[i] == '\\n' || src[i] == '#') {\n        break;\n    }\n    arr[count] = src[i];\n    count++;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "linker", "constants", "incomplete-type"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1516755850, "post_id": 48413313, "comment_id": 83816551, "body": "Why aren&#39;t <code>data[]</code> and <code>DATA_SIZE</code> defined in the <i>same file</i> (namely public_data.c, seemingly an appropriate place as the name suggests)?"}, {"owner": {"reputation": 133, "user_id": 1342750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154cada41a28177dea2559297929fcba?s=128&d=identicon&r=PG", "display_name": "aong152", "link": "https://stackoverflow.com/users/1342750/aong152"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1516756077, "post_id": 48413313, "comment_id": 83816608, "body": "It would require every person who defines public_data to define DATA_SIZE which is <i>cumbersome</i>, considering it&#39;s literally the same line no matter what their data is.  I know that it is a solution and will work, but wondering if there is a better way around it where the user just has to define their data and the library takes care of the rest."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1516756361, "post_id": 48413313, "comment_id": 83816680, "body": "The &quot;better&quot; way would be avoiding globals in the first place and passing the data, and it&#39;s magnitude, as arguments to the various APIs being exposed. As a hideous and vile work-around, you could require users defined their <code>data</code> via a macro you provide that, hidden to them, also lays down the magnitude constant. I strongly advise against such cruel punishment to future maintainers of the code, however."}, {"owner": {"reputation": 2312, "user_id": 1732607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5842343fa9db2450e380fcf3e1a92587?s=128&d=identicon&r=PG", "display_name": "Uzer", "link": "https://stackoverflow.com/users/1732607/uzer"}, "edited": false, "score": 1, "creation_date": 1516756520, "post_id": 48413313, "comment_id": 83816720, "body": "Why don&#39;t you just make DATA_SIZE a function? Or what about making a class to hold the abstraction you need."}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "reply_to_user": {"reputation": 2312, "user_id": 1732607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5842343fa9db2450e380fcf3e1a92587?s=128&d=identicon&r=PG", "display_name": "Uzer", "link": "https://stackoverflow.com/users/1732607/uzer"}, "edited": false, "score": 0, "creation_date": 1516757170, "post_id": 48413313, "comment_id": 83816896, "body": "@JonathanKelsey It&#39;s not clear what you mean here by &quot;class&quot;."}, {"owner": {"reputation": 133, "user_id": 1342750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154cada41a28177dea2559297929fcba?s=128&d=identicon&r=PG", "display_name": "aong152", "link": "https://stackoverflow.com/users/1342750/aong152"}, "edited": false, "score": 0, "creation_date": 1516775778, "post_id": 48413313, "comment_id": 83821952, "body": "This problem is actually a sub-problem of a bigger problem.   Users define data (up to 32 elements), and we have functionality that lets you select/unselect items. It is implemented via a bitmask (this is in an embedded situation). In an ideal world, we ultimately want to <code>typedef uint8&#47;uint16&#47;uint32 data_chosen_mask</code>. However on doing more research, it isn&#39;t possible to do a typedef without statically knowing the array size, which can&#39;t even be calculated using <code>sizeof(data)&#47;sizeof(data[0]).</code>  In the end the solution was to just force users to <code>#define data_size.</code>"}, {"owner": {"reputation": 2312, "user_id": 1732607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5842343fa9db2450e380fcf3e1a92587?s=128&d=identicon&r=PG", "display_name": "Uzer", "link": "https://stackoverflow.com/users/1732607/uzer"}, "edited": false, "score": 0, "creation_date": 1516805159, "post_id": 48413313, "comment_id": 83840068, "body": "I mean it seems you want features best served in OOP. I know C does not have native classes (depends on your compiler really). But you can simulate one. <a href=\"https://stackoverflow.com/questions/1403890/how-do-you-implement-a-class-in-c\" title=\"how do you implement a class in c\">stackoverflow.com/questions/1403890/&hellip;</a>"}, {"owner": {"reputation": 2312, "user_id": 1732607, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5842343fa9db2450e380fcf3e1a92587?s=128&d=identicon&r=PG", "display_name": "Uzer", "link": "https://stackoverflow.com/users/1732607/uzer"}, "edited": false, "score": 0, "creation_date": 1516805263, "post_id": 48413313, "comment_id": 83840148, "body": "So build a &#39;class&#39; which has a method which takes the array. Calculates the size, and then stores the array and the length of the array in the instantiated class. The class exposes an API to get a pointer to the data and the length of the array. Defo try to get rid of the globals if possible."}, {"owner": {"reputation": 133, "user_id": 1342750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154cada41a28177dea2559297929fcba?s=128&d=identicon&r=PG", "display_name": "aong152", "link": "https://stackoverflow.com/users/1342750/aong152"}, "edited": false, "score": 0, "creation_date": 1516940593, "post_id": 48413313, "comment_id": 83904375, "body": "That works for determining the data_size at run-time, but doesn&#39;t allow us to do typedef&#39;s based on data_size. Hence why the question says &quot;at compile time&quot;. If there weren&#39;t types that relied on the size of the array, then calculating/caching at run-time (whether with class or a global) is very easily implemented."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1342750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154cada41a28177dea2559297929fcba?s=128&d=identicon&r=PG", "display_name": "aong152", "link": "https://stackoverflow.com/users/1342750/aong152"}, "edited": false, "score": 0, "creation_date": 1516761999, "post_id": 48413411, "comment_id": 83817993, "body": "Thanks - the 3 solutions were what I came up with, but unfortunately all require the user on the other end to do something. Maybe extern int arraysz is the best solution."}], "tags": [], "owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "is_accepted": true, "score": 2, "last_activity_date": 1516773923, "last_edit_date": 1516773923, "creation_date": 1516756506, "answer_id": 48413411, "question_id": 48413313, "link": "https://stackoverflow.com/questions/48413313/c-accessing-incomplete-types-in-linked-files/48413411#48413411", "title": "C - Accessing incomplete types in linked files", "body": "<p>You can't use <code>sizeof</code> on an <code>extern</code> array of unspecified size (e.g. <code>extern const int data[];</code>)</p>\n\n<p>From <a href=\"http://c-faq.com/decl/extarraysize.html\" rel=\"nofollow noreferrer\">http://c-faq.com/decl/extarraysize.html</a>:</p>\n\n<blockquote>\n  <p>An extern array of unspecified size is an incomplete type; you cannot\n  apply sizeof to it. sizeof operates at compile time, and there is no\n  way for it to learn the size of an array which is defined in another\n  file.</p>\n  \n  <p>You have three options:</p>\n  \n  <ol>\n  <li><p>Declare a companion variable, containing the size of the array, defined and initialized (with sizeof) in the same source file where\n  the array is defined:</p>\n  \n  <p><code>file1.c:                          file2.c:</code></p>\n  \n  <p><code>int array[] = {1, 2, 3};          extern int array[];</code><br>\n  <code>int arraysz = sizeof(array);      extern int arraysz;</code></p>\n  \n  <p>(See also question 6.23.)</p></li>\n  <li><p>#define a manifest constant for the size so that it can be used consistently in the definition and the extern declaration:</p>\n  \n  <p><code>file1.h:</code></p>\n  \n  <p><code>#define ARRAYSZ 3</code><br>\n  <code>extern int array[ARRAYSZ];</code></p>\n  \n  <p><code>file1.c:                           file2.c:</code></p>\n  \n  <p><code>#include \"file1.h\"                 #include \"file1.h\"</code><br>\n  <code>int array[ARRAYSZ];</code></p></li>\n  <li><p>Use some sentinel value (typically 0, -1, or NULL) in the array's last element, so that code can determine the end without an explicit\n  size indication:</p>\n  \n  <p><code>file1.c:                           file2.c:</code></p>\n  \n  <p><code>int array[] = {1, 2, 3, -1};       extern int array[];</code></p></li>\n  </ol>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 9226973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d158f1042e2c264f6ce9327dadbedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Snohdo", "link": "https://stackoverflow.com/users/9226973/snohdo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516758169, "creation_date": 1516758169, "answer_id": 48413600, "question_id": 48413313, "link": "https://stackoverflow.com/questions/48413313/c-accessing-incomplete-types-in-linked-files/48413600#48413600", "title": "C - Accessing incomplete types in linked files", "body": "<p>One solution might be to add an initialization function to data.c, and then you'll have to make sure that when any programs are built the function is called to prepare the data size.</p>\n\n<pre><code>int initupdate_datasize() {\n\n  DATA_SIZE = sizeof(data) / sizeof(data[0]);\n\n  return 0;\n\n}\n</code></pre>\n\n<p>You'll have to remove the const from the data.h, and library_data.c</p>\n\n<p>Another way would be to pass a compiler define such as -DDATASZ=96 that you would get to all source files that need it. For any given platform you could update it manually if it rarely changes, or you could even create a test-datasize program, that would output the data size from the initupdate_datasize function (or a similar C macro instead.) Depending on your build system it should be possible to pass that parameter as a compiler define.</p>\n\n<p>For example in a Makefile if you're using GNU make this might help:</p>\n\n<pre><code>DATA_SIZE = $(shell ./test-datasize)\n\nCFLAGS = -O3 -Wall -DDATASZ=$(DATA_SIZE)\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 1342750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/154cada41a28177dea2559297929fcba?s=128&d=identicon&r=PG", "display_name": "aong152", "link": "https://stackoverflow.com/users/1342750/aong152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 48413411, "answer_count": 2, "score": 1, "last_activity_date": 1516773923, "creation_date": 1516755704, "question_id": 48413313, "link": "https://stackoverflow.com/questions/48413313/c-accessing-incomplete-types-in-linked-files", "title": "C - Accessing incomplete types in linked files", "body": "<p>I have a problem where i am linking multiple files in C. I want to define a constant representing array length at compile time, but save the user having to implement this in their file every time.</p>\n\n<p>Here's the gist:</p>\n\n<p>data.h - defines some constants </p>\n\n<pre><code>extern const int data[];\nextern const int DATA_SIZE;\n//other functions, not relevant\nint get_second_item(void);\n</code></pre>\n\n<p>library_data.c - implements some of the functions in data.h</p>\n\n<pre><code>#include \"data.h\"\nconst int DATA_SIZE = sizeof(data) / sizeof(data[0]); \n//can't compile because data is an incomplete type and hasn't been defined yet\n\nint get_second_item(void) \n{\n    return data[1];\n}\n</code></pre>\n\n<p>public_data.c - user changes this with their data.</p>\n\n<pre><code>#include \"data.h\"\nconst int data[] = {1, 2, 3};\n</code></pre>\n\n<p><em>library_data.c</em> and <em>data.h</em> are compiled first as .o files, amongst other library files that #include data.h and need to therefore use DATA_SIZE. Moving </p>\n\n<pre><code>const int DATA_SIZE = sizeof(data) / sizeof(data[0]) \n</code></pre>\n\n<p>to <em>public_data.c</em> will of course work, but isn't a neat solution.</p>\n"}, {"tags": ["c", "unit-testing", "cmocka"], "comments": [{"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516763924, "post_id": 48412862, "comment_id": 83818418, "body": "Where&#39;s the make file for your unit test code?  What exactly are you having trouble with?"}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "reply_to_user": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1516766395, "post_id": 48412862, "comment_id": 83819017, "body": "i don&#39;t have one, but thanks for the tip, can you help me with that as well please"}, {"owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "edited": false, "score": 0, "creation_date": 1516866841, "post_id": 48412862, "comment_id": 83867040, "body": "You can simplify the test rules to <code>%_test: %_test.o %.o</code> + <code>$(CC) -o $@ $^</code> and delete each explicit rule. Then just add each new test to the <code>test</code> target."}], "answers": [{"comments": [{"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1516845816, "post_id": 48416794, "comment_id": 83860589, "body": "Hi @Clearer, first of all thanks for get me up and running with Make files, I was able to progress a lot with last two answers and I&#39;m getting there. I&#39;ve edited my question with my current setup based on your answer, right now with 3 source files and each one with it&#39;s own test file. This lib will be comprised of 10 or more files, so please have a look. I like it so far and don&#39;t mind adding more targets as i progress, but just in case for any articulation necessary? Thanks again."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1516848052, "post_id": 48416794, "comment_id": 83861054, "body": "please take my new Make file and edit it in your answer"}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1516867724, "post_id": 48416794, "comment_id": 83867452, "body": "some error <code>.&#47;@&lt; &#47;bin&#47;sh: -c: line 0: syntax error near unexpected token </code>newline&#39; /bin/sh: -c: line 0: <code>.&#47;@&lt;&#39; </code>"}, {"owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "reply_to_user": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1516867883, "post_id": 48416794, "comment_id": 83867521, "body": "A bit too early in the morning. Try again."}, {"owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "edited": false, "score": 0, "creation_date": 1516868147, "post_id": 48416794, "comment_id": 83867656, "body": "no problem. I think i&#39;ve to revert to old way, because in my actual implementation one test has two prequisite .o files, so i guess i&#39;ve to treat each one separately."}], "tags": [], "owner": {"reputation": 1827, "user_id": 187998, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/003aa224fb6ca93a53bd2973a98e242e?s=128&d=identicon&r=PG", "display_name": "Clearer", "link": "https://stackoverflow.com/users/187998/clearer"}, "is_accepted": true, "score": 2, "last_activity_date": 1516867775, "last_edit_date": 1516867775, "creation_date": 1516778125, "answer_id": 48416794, "question_id": 48412862, "link": "https://stackoverflow.com/questions/48412862/unit-test-run-configuration/48416794#48416794", "title": "Unit test run configuration", "body": "<p>I would add a <code>test</code> target. That target would depend on all your test programs and should then execute the programs; you may want to add individual targets to execute the programs and just keep one master test target to make sure all of them are executed. Each test program would depend on the object files that are required for the test; if you're doing an addition test, let the addition test depend on the addition.o and add_test.o. Link them as you would always do and then execute them.</p>\n\n<p>Example:</p>\n\n<pre><code>test: addition_test\n   ./addition_test\n\naddition_test: add_test.o add.o\n    $(CC) -o $@ $^\n</code></pre>\n\n<h1>Scaling tests</h1>\n\n<p>You can scale your tests by adding two rules and deleting most of the other rules, related to testing:</p>\n\n<pre><code>test: add_test_run sub_test_run\n\n%_run: %\n    ./$&lt;\n\n %_test: %.o %_test.o\n    $(CC) -o $@ $^\n</code></pre>\n\n<p>Should do everything you want. This allows running tests in parallel; you can avoid running tests that doesn't need to be run by creating a file at the end of each run, say: a log file that tells you the result of the test run.</p>\n\n<p>This should do the trick:</p>\n\n<pre><code>test: add_test.log sub_test.log\n\n%.log: %\n    ./$^ &gt; $@\n\n %_test: %.o %_test.o\n    $(CC) -o $@ $^\n</code></pre>\n\n<p>You should use <code>$(RM)</code> instead of <code>rm -rf</code> in your clean target. <code>$(RM)</code> is platform independent while <code>rm -rf</code> only works on UNIXy platforms.</p>\n"}], "owner": {"reputation": 734, "user_id": 7716619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/016882d3e25cfd932efa5c8b7c82d3eb?s=128&d=identicon&r=PG&f=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/7716619/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 48416794, "answer_count": 1, "score": 0, "last_activity_date": 1564930963, "creation_date": 1516752365, "last_edit_date": 1564930963, "question_id": 48412862, "link": "https://stackoverflow.com/questions/48412862/unit-test-run-configuration", "title": "Unit test run configuration", "body": "<p>I need to get up and running with Cmocka unit testing framework. My setup is:</p>\n\n<p><strong>src/math/addition/add.c (+add.h)</strong></p>\n\n<pre><code>int add(int a, int b) {return a + b;}\n</code></pre>\n\n<p><strong>src/math/subtraction/sub.c (+sub.h)</strong></p>\n\n<pre><code>int sub(int a, int b) {return a - b;}\n</code></pre>\n\n<p><strong>Makefile</strong></p>\n\n<pre><code>VPATH := src src/math src/math/addition\nCFLAGS += -Isrc -Isrc/math -Isrc/math/addition\nall: libMath clean\n\nlibMath: add.o sub.o\n    ar rcs bin/libMath add.o sub.o\n\nclean:\n    rm -rf *.o\n\n%.o: %.c %.h\n</code></pre>\n\n<p><strong>Unit Tests</strong></p>\n\n<p><strong>test/math/addition/add_test.c</strong></p>\n\n<pre><code>#include \"../src/math/addition/add.h\"\n\nvoid test_add() {\n     assert(add(4, 5), 9);\n}\n</code></pre>\n\n<p><strong>test/math/subtraction/sub_test.c</strong></p>\n\n<pre><code>#include \"../src/math/subtraction/sub.h\"\n\nvoid test_sub() {\n    assert(sub(9, 5), 4);\n}\n</code></pre>\n\n<p><strong>test/math/addition/add_test.c</strong> (from <a href=\"https://api.cmocka.org/#main-test\" rel=\"nofollow noreferrer\">cmocka.org</a>)</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;setjmp.h&gt;\n#include &lt;cmocka.h&gt;\n\n/* A test case that does nothing and succeeds. */\nstatic void null_test_success(void **state) {\n    (void) state; /* unused */\n}\n\nint main(void) {\n    const struct CMUnitTest tests[] = {\n        cmocka_unit_test(null_test_success),\n    };\n    return cmocka_run_group_tests(tests, NULL, NULL);\n}\n</code></pre>\n\n<p>I'm new to unit testing in C and basically can't get my head around to setup the unit tests including linking the Cmocka library etc.</p>\n\n<p>My idea is to have several unit test files instead of putting all unit tests in one file. </p>\n\n<h2>Edit based on Clearer's answer</h2>\n\n<p><em>Scaling up</em></p>\n\n<p>Going from 1 test file to 2 and 3 and it will be at least 10+ files. Looking for some optimizations and articulations to scale up nicely and for easy management. Here's what I've so far.</p>\n\n<pre><code>VPATH := src/math/add  src/math/sub  src/math/mul # split src/test path\nVPATH += test/math/add test/math/sub test/math/mul\n\nall: libMath clean\n\nlibMath: add.o sub.o mul.o\n    ar rcs bin/libMath add.o sub.o mul.o # suggestion? $^\n\ntest: add_test sub_test mul_test clean\n    ./add_test\n    ./sub_test\n    ./mul_test\n\nadd_test: add_test.o add.o\n    $(CC) -o $@ $^\n\nsub_test: sub_test.o sub.o\n    $(CC) -o $@ $^\n\nmul_test: mul_test.o mul.o\n    $(CC) -o $@ $^\n\nclean:\n    $(RM) *.o\n\n%.o: %.c %.h\n</code></pre>\n\n<p>Here's the observation so far.</p>\n\n<ol>\n<li>The pattern seems to be like adding a new target for each couple of\ntest and src files.</li>\n<li>Adding the .o object to the libMath both in the prerequisites and the command</li>\n<li>adding the test executable under <code>test:</code> target in the prerequisites and the command</li>\n</ol>\n\n<p>While scaling up, Is it better this way or there could be better approaches?</p>\n\n<p><strong>P.S.</strong> I've removed CFLAGS line, it's working fine without it, helped me to clean up and reduce some clutter. is it ok? My IDE (clion) shows red wiggly lines if the path isn't right to .h files so I'm using full paths in the test files to include src files.</p>\n\n<p><strong>P.P.S</strong> It creates test executables on the root of the project, how to have all the binaries created in the bin folder and then delete all at the end of the project.</p>\n"}, {"tags": ["c", "debugging", "gdb", "gtk"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1516747595, "post_id": 48412060, "comment_id": 83814020, "body": "I think what you need is called a profiler."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516748802, "post_id": 48412060, "comment_id": 83814472, "body": "by &quot;too slow&quot; do you mean increments of time that are still mostly imperceptible? If there&#39;s a line that takes 1/2 a second or something you could simply cascade a breakpoint from function start to finish until you find it."}], "answers": [{"tags": [], "owner": {"reputation": 4114, "user_id": 99127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c156b9398c5745163fbfc1839d272126?s=128&d=identicon&r=PG", "display_name": "evadeflow", "link": "https://stackoverflow.com/users/99127/evadeflow"}, "is_accepted": false, "score": 4, "last_activity_date": 1516748988, "creation_date": 1516748988, "answer_id": 48412363, "question_id": 48412060, "link": "https://stackoverflow.com/questions/48412060/can-you-time-a-step-taken-in-gdb/48412363#48412363", "title": "Can you time a &#39;step&#39; taken in gdb?", "body": "<p>For quick-and-dirty profiling, you can put this snippet in your <code>~/.gdbinit</code> file:</p>\n\n<pre><code>define timeit                                                                                                                                                                             \n    python import time\n    python start_time = time.time()\n    step\n    python print(\"Call took {:.4f} ms\".format(time.time() - start_time))\nend\ndocument timeit\n    Time execution of next function\n    Usage: timeit (or ti)\nend\n</code></pre>\n\n<p>Here's an example of the <code>timeit</code> function in use:</p>\n\n<pre><code>$ gdb --quiet --args ./can-daemon --config=../scripts/handlers.lua vcan0\nReading symbols from ./can-daemon...done.\n(gdb) b main.cpp:548\nBreakpoint 1 at 0x4c5bd4: file /home/evadeflow/projects/info4/can-daemon/src/main.cpp, line 548.\n(gdb) run\nStarting program: /home/evadeflow/projects/info4/can-daemon/_build/can-daemon --config=../scripts/handlers.lua vcan0\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nProcessing messages from: vcan0 \n\nBreakpoint 1, main (argc=3, argv=0x7fffffffdbd8) at /home/evadeflow/projects/info4/can-daemon/src/main.cpp:548\n548             auto L = ::InitializeLuaInterpreter(vm, lua_can_handler_map, lua_mqtt_handler_map);\n(gdb) ti\n(anonymous namespace)::InitializeLuaInterpreter (vm=..., lua_can_handler_map=std::unordered_map with 0 elements, lua_mqtt_handler_map=std::unordered_map with 0 elements)\n    at /home/evadeflow/projects/info4/can-daemon/src/main.cpp:469\n469 {\nCall took 0.0643 ms\n(gdb) ti\n470     L = luaL_newstate();\nCall took 0.0011 ms\n(gdb) ti\nluaL_newstate () at /home/evadeflow/projects/info4/can-daemon/_build/lua-src/src/lauxlib.c:648                                                                                            \nt648      lua_State *L = lua_newstate(l_alloc, NULL);\nCall took 0.4028 ms\n(gdb) ti\nlua_newstate (f=0x7ffff773dbdf &lt;l_alloc&gt;, ud=0x0) at /home/evadeflow/projects/info4/can-daemon/_build/lua-src/src/lstate.c:147\n147   void *l = (*f)(ud, NULL, 0, state_size(LG));\nCall took: 0.1777 ms\n(gdb) ti\nl_alloc (ud=0x0, ptr=0x0, osize=0, nsize=616) at /home/evadeflow/projects/info4/can-daemon/_build/lua-src/src/lauxlib.c:630\n630   if (nsize == 0) { \nCall took 0.0028 ms\n(gdb) ti\n635     return realloc(ptr, nsize);\nCall took 0.0011 ms\n(gdb)\n</code></pre>\n\n<p>Not as accurate as <a href=\"https://ftp.gnu.org/old-gnu/Manuals/gprof-2.9.1/html_mono/gprof.html\" rel=\"nofollow noreferrer\">gprof</a>, but <em>much</em> easier if you just want to get a rough idea of how long each step is taking relative to others.</p>\n"}, {"tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": false, "score": 0, "last_activity_date": 1516791203, "creation_date": 1516791203, "answer_id": 48420689, "question_id": 48412060, "link": "https://stackoverflow.com/questions/48412060/can-you-time-a-step-taken-in-gdb/48420689#48420689", "title": "Can you time a &#39;step&#39; taken in gdb?", "body": "<p>Just use the right tool for the right job. Use a profiling tool like <a href=\"https://wiki.gnome.org/Apps/Sysprof\" rel=\"nofollow noreferrer\">sysprof</a>.</p>\n\n<p>It has seen some <a href=\"https://blogs.gnome.org/chergert/2016/08/23/sysprof-builder/\" rel=\"nofollow noreferrer\">improvements in the version >= 3.20</a>.</p>\n"}], "owner": {"reputation": 4600, "user_id": 1852033, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/89b9541e85fd0534e3871ad790e651f1?s=128&d=identicon&r=PG", "display_name": "Leo Ufimtsev", "link": "https://stackoverflow.com/users/1852033/leo-ufimtsev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1516791203, "creation_date": 1516747365, "question_id": 48412060, "link": "https://stackoverflow.com/questions/48412060/can-you-time-a-step-taken-in-gdb", "title": "Can you time a &#39;step&#39; taken in gdb?", "body": "<p>I'm debugging a C library with gdb (gtk).</p>\n\n<p>There is a function which is too slow. I'm trying to figure out which part of the function is causing the delay.</p>\n\n<p>I understand that one option may be to insert manual code / recompile to benchmark segments of code, but is there a way to get the time it took to execute a single step 's' in gdb?</p>\n"}, {"tags": ["c", "pointers", "struct", "realloc"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1516747211, "post_id": 48411935, "comment_id": 83813870, "body": "You never initialize the <code>ptr</code> field."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1516747292, "post_id": 48411935, "comment_id": 83813906, "body": "@DevSolar: Well, actually he DOES allocate memory for <code>ptr</code> (that is what the <code>+ 2 * sizeof(int*)</code> is for), he just doesn&#39;t assign <code>ptr</code> to point at that memory"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1516747298, "post_id": 48411935, "comment_id": 83813910, "body": "both versions are wrong, the first one exhibited a particularly bad form of Undefined Behaviour - it appeared to work fine"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516747712, "post_id": 48411935, "comment_id": 83814062, "body": "what exactly are you trying to do? Do you want a single continuous block of memory for that struct, including the array of ints. Or do you just want that struct pointing to the array"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516747853, "post_id": 48411935, "comment_id": 83814123, "body": "I wonder why newbies post their questions and then don&#39;t stick around to answer any questions that come up by people trying to help them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516790400, "post_id": 48411935, "comment_id": 83830344, "body": "@Jonathan Wood It&#39;s been less than a day since I posted this so not sure why you would say that... unless that was more of a general statement not directed towards me."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516790687, "post_id": 48411935, "comment_id": 83830520, "body": "@pm100 I want a struct with an array of pointers to int as well as a variable indicating to how many int the array points to. If I understand correctly, my ptr variable needs to be declared like this : int **ptr and not like this : int *ptr[] otherwise I wouldn&#39;t be able to do dynamic memory allocation. I completely understand my mistake now about not initializing the ptr field. Thanks"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516795793, "post_id": 48411935, "comment_id": 83833729, "body": "@SparklingFire: Welcome to Stackoverflow. For best results, you&#39;ll want to stick around immediately after posting a question because it will never get as much attention as it will at that time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516798001, "post_id": 48411935, "comment_id": 83835054, "body": "@Jonathan Wood I see, thanks for the advice, I wasn&#39;t expecting to get answers that quickly to be honest, I guess this is a really active place :)"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516748100, "post_id": 48411995, "comment_id": 83814222, "body": "you should note that his code is storing the address of a not the value of a."}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516748155, "post_id": 48411995, "comment_id": 83814239, "body": "@pm100: Right you are."}], "tags": [], "owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "is_accepted": false, "score": 5, "last_activity_date": 1516748125, "last_edit_date": 1516748125, "creation_date": 1516747077, "answer_id": 48411995, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct/48411995#48411995", "title": "Realloc with an array of pointers in a struct", "body": "<p>I think your declarations are wrong. The following line assumes that <code>ptr</code> points to some memory when in fact it has not been initialized at all!</p>\n\n<pre><code>var-&gt;ptr[0] = &amp;a;\n</code></pre>\n\n<p>If your compiler supports it, shouldn't it be more like this instead:</p>\n\n<pre><code>typedef struct{\n    int size;\n    int* ptr[0];\n}foo;\n</code></pre>\n\n<p>Otherwise, change <code>ptr[0]</code> to <code>ptr[1]</code>, and adjust your calculations based on the fact that the structure already includes one element.</p>\n\n<p><em>Note: Once you write to a wrong address, the result is undefined. You have a problem there but it only happens to show up in one case. The problem is still there in both cases.</em></p>\n"}, {"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516747612, "post_id": 48412066, "comment_id": 83814027, "body": "because he doesnt know what he&#39;s doing - we should ask him :-)"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "edited": false, "score": 0, "creation_date": 1516747907, "post_id": 48412066, "comment_id": 83814148, "body": "i doubt you did that , he is storing the address of local variables in that struct. I asked - lets see what he says"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 0, "last_activity_date": 1516748103, "last_edit_date": 1516748103, "creation_date": 1516747401, "answer_id": 48412066, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct/48412066#48412066", "title": "Realloc with an array of pointers in a struct", "body": "<p>You need to fix the struct:</p>\n\n<pre><code>typedef struct{\n    int size;\n    int *ptr;\n}foo;\n</code></pre>\n\n<p>And the code:</p>\n\n<pre><code> var = malloc(sizeof(foo));\n var-&gt;ptr = malloc(2 * sizeof(int));\n\n int a = 3, b = 6;\n // store a and b in array, not their addresses\n var-&gt;ptr[0] = a;\n var-&gt;ptr[1] = b;\n</code></pre>\n\n<p>Assuming you want 2 entries in the array. And of course, ignoring the fact that I am not testing the result of <code>malloc()</code>.</p>\n\n<p>If you want to resize the array, just realloc <code>var-&gt;ptr</code> instead of <code>var</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "edited": false, "score": 0, "creation_date": 1516790267, "post_id": 48412121, "comment_id": 83830267, "body": "Thanks, very clear answer. For some reason, I thought I couldn&#39;t directly use malloc on a variable inside a struct but I was obviously mistaken. Thanks to everyone who answered, many answers were also useful although some didn&#39;t seem to realize that I wanted to store the adresses of a and b and not their values."}], "tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": true, "score": 2, "last_activity_date": 1516829233, "last_edit_date": 1516829233, "creation_date": 1516747737, "answer_id": 48412121, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct/48412121#48412121", "title": "Realloc with an array of pointers in a struct", "body": "<p>I would say this is also wrong in C89.</p>\n\n<pre><code>malloc(sizeof(foo) + 2 * sizeof(int*));\n</code></pre>\n\n<p>is allocating more than you need it, but not in the way you expect.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+-------+------------+---------+--------+\n|  size | ptr        |  int*   | int*   |\n+-------+------------+---------+--------+\n\n|  sizeof foo        | 2 * sizeof(int*) |\n</code></pre>\n\n<p>As you see, <code>var-&gt;foo</code> is still uninitialized, no matter how many extra bytes\nyou've allocated, so</p>\n\n<pre><code>var-&gt;ptr[0] = &amp;a;\nvar-&gt;ptr[1] = &amp;b;\n</code></pre>\n\n<p>is going to fail.</p>\n\n<p>What you should have done is:</p>\n\n<pre><code>var = malloc(sizeof *var);\n\nvar-&gt;ptr = malloc(2 * sizeof *var-&gt;ptr);\n\nvar-&gt;ptr[0] = &amp;a;\nvar-&gt;ptr[1] = &amp;b;\n</code></pre>\n\n<p>Then it would look like this</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>                                     | int |     | int |\n\n                                     +-----+     +-----+\n                                     |  a  |     |  b  |\n                                     +-----+     +-----+\n                                         ^         ^\n                                         |         |\n                                         |         |\n+-------+------------+  points to     +---------+--------+\n|  size | ptr        | ------------&gt;  | int*    | int*   |\n+-------+------------+                +---------+--------+\n\n|  sizeof foo        |                | 2 * sizeof(int*) |\n</code></pre>\n\n<p>Don't forget to check for the return value of <code>malloc</code> and to free the memory\nafterwards.</p>\n\n<p><strong>edit</strong></p>\n\n<p>what would work is:</p>\n\n<pre><code>var = malloc(sizeof(foo) + 2 * sizeof(int*));\nvar-&gt;ptr = (int**) ( ((char*) var) + sizeof *var );\n</code></pre>\n\n<p>where you set <code>var-&gt;pointer</code> to point past the memory for the <code>struct</code>. While\nthis might work, I think it's pretty ugly, I would reject a commit of a\nco-worker with something like this.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1516749016, "last_edit_date": 1516749016, "creation_date": 1516747755, "answer_id": 48412126, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct/48412126#48412126", "title": "Realloc with an array of pointers in a struct", "body": "<p>The problem is that you are not assigning <code>ptr</code> to point at anything, so it points to random memory, and any access of <code>ptr[index]</code> is <strong>undefined behavior</strong>.</p>\n\n<p>Changing the declaration of <code>ptr</code> like Jonathan's answer suggested is the safest option, eg:</p>\n\n<pre><code>typedef struct{\n    int size;\n    int* ptr[1]; // or 0 if your compiler supports it\n}foo;\n\nint main()\n{\n    foo *var;\n\n    var = malloc(offsetof(foo, ptr));\n    if (var) {\n        var-&gt;size = 0;\n        ...\n    }\n\n    foo *newvar = realloc(var, offsetof(foo, ptr) + (2 * sizeof(int*)));\n    if (newvar) {\n        var = newvar;\n        var-&gt;size = 2;\n\n        int a = 3, b = 6;\n\n        var-&gt;ptr[0] = &amp;a; // &lt;-- OK!\n        var-&gt;ptr[1] = &amp;b; // &lt;-- OK!\n\n        printf(\"%d %d\\n\", *(var-&gt;ptr[0]), *(var-&gt;ptr[1]));\n    }\n\n    free(var);\n    return 0;\n}\n</code></pre>\n\n<p>But, if for whatever reason, you can't change the declaration of <code>ptr</code> (<code>foo</code> is used with an existing API, for instance), then you can do this instead:</p>\n\n<pre><code>typedef struct{\n    int size;\n    int **ptr;\n}foo;\n\nint main()\n{\n    foo *var = malloc(sizeof(foo));\n    if (var) {\n        var-&gt;size = 0;\n        var-&gt;ptr = NULL; // &lt;-- add this!\n        ...\n    }\n\n    foo *newvar = realloc(var, sizeof(foo) + (2 * sizeof(int*)));\n    if (newvar) {\n        var = newvar;\n        var-&gt;size = 2;\n        var-&gt;ptr = (int**)(var + 1); // &lt;-- add this!\n\n        int a = 3, b = 6;\n\n        var-&gt;ptr[0] = &amp;a; // &lt;-- OK!\n        var-&gt;ptr[1] = &amp;b; // &lt;-- OK!\n\n        printf(\"%d %d\\n\", *(var-&gt;ptr[0]), *(var-&gt;ptr[1]));\n    }\n\n    free(var);\n    return 0;\n}\n</code></pre>\n\n<p>In this latter case, make sure you do the same <code>ptr</code> assignment every time you want to (re)allocate <code>var</code>.  I would wrap that logic in a set of helper functions, eg:</p>\n\n<pre><code>typedef struct{\n    int size;\n    int **ptr;\n}foo;\n\nfoo* createFoo(int size)\n{\n    foo *var = malloc(sizeof(foo) + (size * sizeof(int*)));\n    if (var) {\n        var-&gt;size = size;\n        var-&gt;ptr = (int**)(var + 1);\n    }\n    return var;\n}\n\nfoo* resizeFoo(foo **var, int newSize)\n{\n    foo *newvar = realloc(*var, sizeof(foo) + (newSize * sizeof(int*)));\n    if (newvar) {\n        newvar-&gt;size = newSize;\n        newvar-&gt;ptr = (int**)(newvar + 1);\n        *var = newvar;\n    }\n    return newvar;\n}\n\nint main()\n{\n    foo *var = createFoo(0);\n    ...\n\n    if (resizeFoo(&amp;var, 2)) {\n        int a = 3, b = 6;\n\n        var-&gt;ptr[0] = &amp;a; // &lt;-- OK!\n        var-&gt;ptr[1] = &amp;b; // &lt;-- OK!\n\n        printf(\"%d %d\\n\", *(var-&gt;ptr[0]), *(var-&gt;ptr[1]));\n    }\n\n    free(var);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "is_accepted": false, "score": 0, "last_activity_date": 1516777957, "creation_date": 1516777957, "answer_id": 48416758, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct/48416758#48416758", "title": "Realloc with an array of pointers in a struct", "body": "<p>In Visual Studio, Windows 10, both of your examples doesn't work. This is because the struct is uninitialized in both situations.</p>\n\n<p>The arrow operation:</p>\n\n<pre><code>foo-&gt;bar\n</code></pre>\n\n<p>is a shorthand write for:</p>\n\n<pre><code>(*foo).bar\n</code></pre>\n\n<p>Therefore, if \"foo\" struct variable is uninitialized, depending on the compiler, the pointer inside your struct will point to a random location in memory.</p>\n\n<p>So, when you used the arrow operator as such:</p>\n\n<pre><code>var-&gt;ptr[0] = &amp;a;\n</code></pre>\n\n<p>What you did was:</p>\n\n<pre><code>(*var).ptr[0] = &amp;a;\n</code></pre>\n\n<p>So, basically, you tried to write the address of \"a\", into a location in memory, that you shouldn't have accessed. This is why you are getting a segmentation fault.</p>\n\n<p>However, if you instead have initialized it:</p>\n\n<pre><code>int goodmemorylocation = 0;\nvar-&gt;ptr = &amp;goodmemorylocation; // You change the location of your pointer to an accessible location in memory\n</code></pre>\n\n<p>Then your code works for both cases, in my system.</p>\n\n<p>Perhaps, in your system, the first example that you used malloc, somehow points to a correct address in your memory. This is why it works.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9259108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1113, "favorite_count": 0, "accepted_answer_id": 48412121, "answer_count": 5, "score": 2, "last_activity_date": 1516829233, "creation_date": 1516746800, "question_id": 48411935, "link": "https://stackoverflow.com/questions/48411935/realloc-with-an-array-of-pointers-in-a-struct", "title": "Realloc with an array of pointers in a struct", "body": "<p>In C89, the following code works fine :</p>\n\n<pre><code>typedef struct{\n    int size;\n    int **ptr;\n}foo;\n\nint main()\n{\n    foo *var;\n\n    var = malloc(sizeof(foo) + 2 * sizeof(int*));\n\n    int a = 3, b = 6;\n\n    var-&gt;ptr[0] = &amp;a;\n    var-&gt;ptr[1] = &amp;b;\n\n    printf(\"%d %d\\n\", (*var-&gt;ptr[0]), (*var-&gt;ptr[1]));\n\n    return 0;\n}\n</code></pre>\n\n<p>When executed it shows : 3 6</p>\n\n<p>But if I replace</p>\n\n<pre><code>var = malloc(sizeof(foo) + 2 * sizeof(int*));\n</code></pre>\n\n<p>with</p>\n\n<pre><code>var = malloc(sizeof(foo));\nvar = realloc(var, sizeof(foo) + 2 * sizeof(int*));\n</code></pre>\n\n<p>It compiles without any warning but I get a segmentation fault at the following line :</p>\n\n<pre><code>var-&gt;ptr[0] = &amp;a;\n</code></pre>\n\n<p>I really have no idea what I am doing wrong so I would appreciate any input. I'm a beginner so I apologize if my mistake is obvious.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516746487, "post_id": 48411840, "comment_id": 83813553, "body": "you mean you want to read the variable names from the file too?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516746488, "post_id": 48411840, "comment_id": 83813554, "body": "What is the question? How to read a file? How to assign a variable?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 6, "creation_date": 1516746521, "post_id": 48411840, "comment_id": 83813570, "body": "you have to do it the hard way, c does not have any reflection capabilities"}, {"owner": {"reputation": 8202, "user_id": 58074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297b31165c5ef426c8fa89c3375b0d2a?s=128&d=identicon&r=PG", "display_name": "dsolimano", "link": "https://stackoverflow.com/users/58074/dsolimano"}, "edited": false, "score": 2, "creation_date": 1516746588, "post_id": 48411840, "comment_id": 83813597, "body": "I think you&#39;re looking for a dictionary - <a href=\"https://stackoverflow.com/questions/4384359/quick-way-to-implement-dictionary-in-c\" title=\"quick way to implement dictionary in c\">stackoverflow.com/questions/4384359/&hellip;</a>, does that look right?"}, {"owner": {"reputation": 19, "user_id": 8802582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a227b86778630913ba76ff94f022c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "zach adams", "link": "https://stackoverflow.com/users/8802582/zach-adams"}, "edited": false, "score": 0, "creation_date": 1516746679, "post_id": 48411840, "comment_id": 83813639, "body": "yes i was just trying to figure out if it was possible to read the name then read the int value and assign the int value to the correspoding name i read in so for example i read x and 3 then will set and int x=3"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 8202, "user_id": 58074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297b31165c5ef426c8fa89c3375b0d2a?s=128&d=identicon&r=PG", "display_name": "dsolimano", "link": "https://stackoverflow.com/users/58074/dsolimano"}, "edited": false, "score": 0, "creation_date": 1516746685, "post_id": 48411840, "comment_id": 83813641, "body": "if you really need this type of capability you can use a dictionary as per @dsolimano - or you could have an array of variables and have <code>vn 42</code> in your file and fill out the nth value in the array."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1516747137, "post_id": 48411840, "comment_id": 83813832, "body": "no &quot;easy&quot; way to do this. If you know the variable names ahead of time simply declare <code>int x, y, z;</code> in your code and assign the appropriate one when you parse the file. A linked list with <code>struct node{ char* varName; int varValue; };</code> is also an option, but that is overkill."}, {"owner": {"reputation": 815, "user_id": 1636656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5330d12dfb66219d3a4d377ad7e69316?s=128&d=identicon&r=PG", "display_name": "Ask About Monica", "link": "https://stackoverflow.com/users/1636656/ask-about-monica"}, "reply_to_user": {"reputation": 8202, "user_id": 58074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297b31165c5ef426c8fa89c3375b0d2a?s=128&d=identicon&r=PG", "display_name": "dsolimano", "link": "https://stackoverflow.com/users/58074/dsolimano"}, "edited": false, "score": 0, "creation_date": 1516747157, "post_id": 48411840, "comment_id": 83813842, "body": "The simple, bad, but maybe good enough way to do it would be to read each line, parse the elements, and use a big switch() to assign values:  case &#39;x&#39;: x=data;  It would be better to rewrite your program so that the data is held in a more structured way, like with a dictionary, as @dsolimano said."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1516747379, "post_id": 48411840, "comment_id": 83813943, "body": "Either do it the hard way, or use <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"nofollow noreferrer\">x-macro</a>."}, {"owner": {"reputation": 19, "user_id": 8802582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a227b86778630913ba76ff94f022c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "zach adams", "link": "https://stackoverflow.com/users/8802582/zach-adams"}, "edited": false, "score": 0, "creation_date": 1516748113, "post_id": 48411840, "comment_id": 83814227, "body": "I just made my values another c file and just defined them as global variables and linked them to my main file."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1516748528, "post_id": 48411840, "comment_id": 83814356, "body": "Sounds like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY Problem</a>. What problem are you <i>actually</i> trying to resolve?"}, {"owner": {"reputation": 19, "user_id": 8802582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a227b86778630913ba76ff94f022c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "zach adams", "link": "https://stackoverflow.com/users/8802582/zach-adams"}, "edited": false, "score": 0, "creation_date": 1516751122, "post_id": 48411840, "comment_id": 83815226, "body": "<a href=\"https://imgur.com/78K5qDF\" rel=\"nofollow noreferrer\">imgur.com/78K5qDF</a>"}, {"owner": {"reputation": 19, "user_id": 8802582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a227b86778630913ba76ff94f022c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "zach adams", "link": "https://stackoverflow.com/users/8802582/zach-adams"}, "edited": false, "score": 0, "creation_date": 1516751134, "post_id": 48411840, "comment_id": 83815232, "body": "this was what was on my assignment and was a little confused"}], "answers": [{"tags": [], "owner": {"reputation": 1319, "user_id": 511209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae6b25434aee590d1acee954558528aa?s=128&d=identicon&r=PG", "display_name": "Shadow Radiance", "link": "https://stackoverflow.com/users/511209/shadow-radiance"}, "is_accepted": false, "score": 2, "last_activity_date": 1516747945, "last_edit_date": 1516747945, "creation_date": 1516747148, "answer_id": 48412014, "question_id": 48411840, "link": "https://stackoverflow.com/questions/48411840/how-to-read-in-variable-names-and-their-corresponding-values-in-c/48412014#48412014", "title": "How to read in variable names and their corresponding values in C", "body": "<p>There are a couple of methods you could use to get the data into the program associated with a name, depending on how your program is structured.</p>\n\n<p>If your program doesn't contain <em>variables</em> with those names already, then there's not a way to generate variables from a file. You could create a dictionary mapping the names to the values and use that as your \"variable\".</p>\n\n<p>I suppose you could also have a dictionary mapping the names to the addresses of existing variables... so that you look up the name and then deref the variable to set if its in the dictionary.</p>\n\n<p>As a really far-out solution... if you can recompile each time there is a new file (ie. the file is really compile-time input, not run-time input) then you might be able to use some kind of preprocessing to <code>#include</code> the  (possibly itself preprocessed into c-code) file of data.</p>\n"}, {"tags": [], "owner": {"reputation": 1374, "user_id": 6385870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WcPaBJ4dA7E/AAAAAAAAAAI/AAAAAAAAACU/GqGqqqVbT9E/photo.jpg?sz=128", "display_name": "the kamilz", "link": "https://stackoverflow.com/users/6385870/the-kamilz"}, "is_accepted": false, "score": 0, "last_activity_date": 1516782808, "creation_date": 1516782808, "answer_id": 48417977, "question_id": 48411840, "link": "https://stackoverflow.com/questions/48411840/how-to-read-in-variable-names-and-their-corresponding-values-in-c/48417977#48417977", "title": "How to read in variable names and their corresponding values in C", "body": "<p>I think you are asking for dynamic code generator those I used for different purpose back then (generating long byte arrays with certain values). The generator will generate a <code>.c</code> file with variable names read from another file. This problem is, it's hard to do this for runtime, if you asking for runtime solution, other dudes are already given the answer.</p>\n"}], "owner": {"reputation": 19, "user_id": 8802582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a227b86778630913ba76ff94f022c4fa?s=128&d=identicon&r=PG&f=1", "display_name": "zach adams", "link": "https://stackoverflow.com/users/8802582/zach-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516782808, "creation_date": 1516746302, "last_edit_date": 1516746554, "question_id": 48411840, "link": "https://stackoverflow.com/questions/48411840/how-to-read-in-variable-names-and-their-corresponding-values-in-c", "title": "How to read in variable names and their corresponding values in C", "body": "<p>I've been searching all over and cannot figure out how to do this.\nI am trying to read in a text file with contents like</p>\n\n<pre><code>x 4\ny 6\nz 9\n</code></pre>\n\n<p>and set the int values to the corresponding variable name before it;\nis there anyway to do this or do I have to assign the names in the program after reading in the values.</p>\n"}, {"tags": ["c", "java-native-interface", "jnienv"], "comments": [{"owner": {"reputation": 2620, "user_id": 944017, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/1fBsW.png?s=128&g=1", "display_name": "yakobom", "link": "https://stackoverflow.com/users/944017/yakobom"}, "edited": false, "score": 0, "creation_date": 1516772056, "post_id": 48411718, "comment_id": 83820520, "body": "The logs should be written to the console, exactly as you see the status log. So the question is - what is the code that tries to write to the log inside getSensorMeasurement? Something is probably wrong there, more details are required here."}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1516798663, "post_id": 48411718, "comment_id": 83835482, "body": "Can you share the code that generates logs inside getSensorMeasurement function?"}], "owner": {"reputation": 141, "user_id": 4541963, "user_type": "registered", "accept_rate": 10, "profile_image": "https://lh4.googleusercontent.com/-1wk65mJy150/AAAAAAAAAAI/AAAAAAAAHIY/HVdoL7Blzqk/photo.jpg?sz=128", "display_name": "kaniska Mandal", "link": "https://stackoverflow.com/users/4541963/kaniska-mandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535003094, "creation_date": 1516745679, "last_edit_date": 1535003094, "question_id": 48411718, "link": "https://stackoverflow.com/questions/48411718/how-to-print-native-c-log-inside-jni-c-code", "title": "How to print native C log inside JNI-C code?", "body": "<p>I have the following JNI C code </p>\n\n<pre><code>JNIEXPORT jint JNICALL\nJava_XYZ_addData\n  (JNIEnv * env, jobject callingObject, jlong sensorId)\n{\n\n  int status =\n    getSensorMeasurement ((void *) sensorId);\n    printf (\"status_code %d  \\n\", status);\n}\n</code></pre>\n\n<p>I have bunch of log messages inside getSensorMeasurement(..) C code</p>\n\n<p>When I invoke the JNI-C code from Java code;</p>\n\n<ul>\n<li>it only prints status_code </li>\n<li>but the log messages inside getSensorMeasurement(..) are not printed in console.</li>\n</ul>\n\n<p>How can I get hold of the console logs from internal C code ?</p>\n\n<p>Thanks\nKaniska</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1516745530, "post_id": 48411648, "comment_id": 83813111, "body": "The &quot;conversion&quot; process would involve fixing bugs leading to undefined behaviors you have in your program."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1516745898, "post_id": 48411648, "comment_id": 83813288, "body": "To start, turn on <code>-Wmost</code>, carefully consider all the warnings you get, and then turn on <code>-Wall</code>. After that, you are in a good debugging situation: You have both a working version of the program (the version compiled with 7.2.0) and a non-working version. Find some input that reproducibly causes the non-working one to fail. Then you can instrument the program to show its internal state as it proceeds, after which you look for differences between them."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1516745954, "post_id": 48411648, "comment_id": 83813315, "body": "certainly sounds like UB to me. What does &quot;isn&#39;t exiting as it should&quot; mean? Seg faulting? If so, run it under gdb, and when it crashes you can at least look at the call stack and examine variables."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1516746096, "post_id": 48411648, "comment_id": 83813372, "body": "&quot;My program doesn&#39;t work as expected! Must be an issue with the compiler.&quot; No, it&#39;s far more likely to be a bug in your code."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516746099, "post_id": 48411648, "comment_id": 83813374, "body": "@EugeneSh.: gcc 7.2.0 attempts to conform to the C11 standard; I don&#39;t think 4.9.2 did.  Further, I suspect that 7.2.0 has likely fixed some bugs from earlier versions that caused them to behave in non-conforming fashion.  I don&#39;t see why you assume the fault is with the program rather than the compiler."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 4, "creation_date": 1516746200, "post_id": 48411648, "comment_id": 83813418, "body": "@supercat First of all it&#39;s the golden rule - always assume fault with the code rather than with a compiler. Second - there is no compilation errors. Third - the OP used <code>std=gnuc99</code>."}, {"owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516746941, "post_id": 48411648, "comment_id": 83813751, "body": "@EugeneSh. I enforced that gnuc99 standard in the hopes, that maybe the two systems were defaulting to different standards and that would fix it. Is there something weird about it? I admit, I&#39;m dreadfully ignorant about the differences in versions of compilers."}, {"owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516747031, "post_id": 48411648, "comment_id": 83813785, "body": "@yano It essentially kept running forever, thus I&#39;m assuming something was failing every check throughout the entire program."}, {"owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516747120, "post_id": 48411648, "comment_id": 83813821, "body": "@melpomene I do often assume I did something wrong. But I&#39;m using the SAME EXACT code between two versions of GCC and getting different behaviour."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516747226, "post_id": 48411648, "comment_id": 83813879, "body": "@neutralboolean you couldn&#39;t describe a symptom of UB better than what you just said. If you have a lot of code, UB can be tough to track down, especially if it&#39;s not crashing. Examine the extreme cases on the loops where it runs forever. Tough to say, you haven&#39;t provided much to go on. Changing up your compiler flags for gcc 7.2.0 could very well change the behavior also."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1516747347, "post_id": 48411648, "comment_id": 83813927, "body": "@neutralboolean Yes, that&#39;s how bugs work in C. Undefined behavior is undefined."}, {"owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "edited": false, "score": 0, "creation_date": 1516747730, "post_id": 48411648, "comment_id": 83814071, "body": "So this is ultimately a case of slowly changing things until it works?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1516747921, "post_id": 48411648, "comment_id": 83814152, "body": "Sounds like a standard debugging issue to me: The code doesn&#39;t work as expected, so you need to figure out where your mental model diverges from reality. Possible tools include: staring at the code, adding logging, running it in a debugger, etc."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1516748005, "post_id": 48411648, "comment_id": 83814184, "body": "Basically. You say it loops forever. First place I&#39;d start is the loop condition. Is that part of an array? Allocated memory? Is it an <code>int</code> that could possibly be overflowing? Stack Overflow used to have a wonderful collection of undefined behavior in <code>c</code> in their documentation section and then they inexplicably removed it."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1516748737, "post_id": 48411648, "comment_id": 83814444, "body": "Given that gcc&#39;s efforts at optimization have generally gone in the direction of becoming more aggressive except in cases where they can be clearly and unambiguously demonstrated to violate the Standard, failure of code to work on newer versions may point to UB, but failure of code to work on older versions could just as easily be a result of illegitimate &quot;optimizations&quot; which have since been fixed."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1516766123, "post_id": 48411648, "comment_id": 83818947, "body": "Without the code for an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>), there\u2019s not a lot we can do to help you"}, {"owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "edited": false, "score": 0, "creation_date": 1517020126, "post_id": 48411648, "comment_id": 83937974, "body": "Thank you, everyone, for your help. But I&#39;m not entirely sure how to close this. The &quot;answer&quot; to my question was a matter of just working my way through the program again. Would that be acceptable as an answer, or should I flag a mod to close this for me?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1535003586, "post_id": 48411648, "comment_id": 90907916, "body": "Please either make an answer or delete the question yourself. The actual solution is, as several comments have noted, to remove/avoid undefined behaviour. Going through the code, cleaning up anything weird, fixing all warnings, including those which occur when using strict warnings, ... All that. Consider using a file-diff tool to help you remember all the changes."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1535003591, "post_id": 48411648, "comment_id": 90907919, "body": "@neutralboolean: You can simply delete the question."}], "owner": {"reputation": 25, "user_id": 4524657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d7ec20d9048a558a97c278859762da?s=128&d=identicon&r=PG&f=1", "display_name": "neutralboolean", "link": "https://stackoverflow.com/users/4524657/neutralboolean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535003353, "creation_date": 1516745417, "last_edit_date": 1535003353, "question_id": 48411648, "link": "https://stackoverflow.com/questions/48411648/converting-program-between-gcc-version-7-2-0-and-gcc-version-4-9-2", "title": "Converting program between GCC version 7.2.0 and GCC version 4.9.2?", "body": "<p>I wrote a pretty extensive C program on my personal laptop which is running Ubuntu with GCC version 7.2.0 and it worked well enough. However, when I passed those same .c and .h files to a different computer running Debian with GCC version 4.9.2 to compile, I ran into runtime errors where it isn't exiting as it should.</p>\n\n<p>I thought at first, it might have been an issue with the <code>-std</code> flag, so I set them both to <code>make</code> with <code>-std=gnuc99</code> but that didn't solve anything. I know I didn't change anything in any files, so it couldn't be any issue of inadvertently changing program logic. Unless bundling the project folder into a .tar can change something.</p>\n\n<p>The compiler throws no errors and only a couple of warnings about unused variables that I've already known about.</p>\n\n<p>All of that was a lead-up to ask this:<br>\nWhat are/where can I find the differences between those two versions of GCC and is there any tool I can use to convert code so that it will work in 4.9.2 like it does with 7.2.0?</p>\n\n<p>I'm fine with rewriting code, if need be, but I don't even know where to start?<br>\nRight now I'm just throwing trace statements in order to pinpoint where exactly it's making a mess of itself and I'll edit if pertinent information makes itself available.</p>\n"}, {"tags": ["c", "linux", "unix", "terminal"], "comments": [{"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516744302, "post_id": 48411391, "comment_id": 83812543, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10573906/osx-linux-slow-down-the-output-from-terminal\">OSX/Linux, slow down the output from terminal</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1516744331, "post_id": 48411391, "comment_id": 83812558, "body": "Why not redirect the stream to/from file?"}, {"owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "edited": false, "score": 0, "creation_date": 1516744461, "post_id": 48411391, "comment_id": 83812627, "body": "I suppose that depends on exactly what you mean by &quot;run slower&quot;, and how much older and less capable you&#39;re talking about. In the extreme case, you could mount a DosBox session and run it from there, but that is <i>seriously</i> older/less capable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516744525, "post_id": 48411391, "comment_id": 83812659, "body": "@Pablo Ah, no, I don&#39;t want slower printing. I&#39;d like the program to execute slower."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 2, "creation_date": 1516744579, "post_id": 48411391, "comment_id": 83812688, "body": "Connecting with a debugger and single-stepping through the code is the conventional way to see what&#39;s going on in slow motion. (If you want the debugger to be on a different terminal than the one where the output goes, that&#39;s easily done -- see gdb&#39;s <code>attach</code> support)."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516744596, "post_id": 48411391, "comment_id": 83812703, "body": "@Maximus in that case, a debugger would be better suited."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516744668, "post_id": 48411391, "comment_id": 83812739, "body": "...though of course some strategically-placed <code>sleep()</code>s may be an option as well."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516744714, "post_id": 48411391, "comment_id": 83812767, "body": "That said, if this is emitting output <b>to a terminal</b>, any &quot;flicker effect&quot; is a consequence of how the terminal does rendering (and what exactly you&#39;re sending to it -- if your program sends CR sequences to go back to the beginning of a line and rewrite that line&#39;s contents, for example), more than it is a consequence of the program itself. Someone with a reasonable understanding of how the terminal you&#39;re using renders text could presumably read through the output of your program being run in <code>script</code> and tell you if there would be flickering if running more slowly just by that output."}, {"owner": {"reputation": 1699, "user_id": 2849202, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cf49da480acd25c4142a35d8adc73dd5?s=128&d=identicon&r=PG&f=1", "display_name": "Roadowl", "link": "https://stackoverflow.com/users/2849202/roadowl"}, "edited": false, "score": 0, "creation_date": 1516744773, "post_id": 48411391, "comment_id": 83812793, "body": "Since you say it&#39;s written in C, I assume you have code. If that is the case: compile as an MSDOS program and run on a VM running MSDOS ;-)"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516744851, "post_id": 48411391, "comment_id": 83812814, "body": "...so, the exact same program rendering to a terminal that does double-buffered rendering is going to behave differently (wrt. &quot;flickering&quot;) than one that renders characters individually as soon as they&#39;re received. Similarly, the techniques used for scrolling &amp;c. <i>by the terminal</i> (not by your program) will have impact, so there&#39;s no reason to believe that a test result you get with one terminal will reflect what happens with your same program running somewhere else."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1516744955, "post_id": 48411391, "comment_id": 83812871, "body": "...bottom line: If what you care about is &quot;flickering&quot;, analysis by someone who understands the problem space (and the specific hardware/software/terminals/etc. you&#39;re proposing deployment to) is liable to provide better results than a naively-performed experiment... unless of course you actually have samples of the target hardware and a high-speed camera on hand, in which case you can generate 100% perfect results experimentally."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1516745334, "post_id": 48411391, "comment_id": 83813028, "body": "There are lots of ways of making the computer run slower: All the links later in this comment are taken from <a href=\"https://www.google.co.nz/search?q=slowing+down+old+games\" rel=\"nofollow noreferrer\">google.co.nz/search?q=slowing+down+old+games</a>  These sites have multiple suggestions: <a href=\"http://www.gamepatchplanet.com/articles/slowing_down_older_pc_games_on_fast_modern_computers.php\" rel=\"nofollow noreferrer\">gamepatchplanet.com/articles/&hellip;</a> and <a href=\"http://www.sierrahelp.com/Utilities/SlowdownUtilities.html\" rel=\"nofollow noreferrer\">sierrahelp.com/Utilities/SlowdownUtilities.html</a>  If DOSBox is an option this site tells how: <a href=\"https://www.gog.com/forum/theme_park/slowing_down_the_game_possible\" rel=\"nofollow noreferrer\">gog.com/forum/theme_park/slowing_down_the_game_possible</a>  Here is another program I found that I remember using: <a href=\"http://www.hpaa.com/moslo/\" rel=\"nofollow noreferrer\">hpaa.com/moslo</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516745731, "post_id": 48411391, "comment_id": 83813204, "body": "Not for only slowing down, for going all the way to debugging, this might be helpful: <a href=\"https://stackoverflow.com/questions/2069367/how-to-debug-using-gdb\" title=\"how to debug using gdb\">stackoverflow.com/questions/2069367/how-to-debug-using-gdb</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "edited": false, "score": 0, "creation_date": 1516745771, "post_id": 48411391, "comment_id": 83813231, "body": "Redirecting stdout to file and debugging can solve almost all of my problems. i.e. if the program was moving the cursor up and rewriting some lines. However, on slower systems, sending a write buffer to stdout byte by byte vs sending them in a whole buffer sometimes renders differently. I&#39;m not quite sure if this is a terminal rendering problem or another process gains priority and hangs the application for an observable amount of time. It just makes the program seem like it&#39;s having a hard time loading. Not really important in the end but it would be nice if I could forsee it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "edited": false, "score": 0, "creation_date": 1516745998, "post_id": 48411391, "comment_id": 83813331, "body": "I will look into the solutions you all provided. Thanks. I&#39;ll report back as soon as possible."}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1516751206, "post_id": 48411391, "comment_id": 83815258, "body": "Voting to close as <b>Too broad</b> : &quot;Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer. Avoid asking multiple distinct questions at once. See the <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask page</a> for help clarifying this question.&quot;  And please read <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> ,    <a href=\"https://stackoverflow.com/help/dont-ask\">stackoverflow.com/help/dont-ask</a> ,  <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>  and take the <a href=\"https://stackoverflow.com/tour\">tour</a> before posting more Qs here. Good luck."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 9258857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9a0bb32efa15750bc4d51056b6627c4?s=128&d=identicon&r=PG&f=1", "display_name": "M.Bris", "link": "https://stackoverflow.com/users/9258857/m-bris"}, "is_accepted": false, "score": 0, "last_activity_date": 1516756217, "creation_date": 1516756217, "answer_id": 48413367, "question_id": 48411391, "link": "https://stackoverflow.com/questions/48411391/is-it-possible-to-run-a-command-line-program-slower-on-the-terminal/48413367#48413367", "title": "Is it possible to run a command line program slower, on the terminal?", "body": "<p>You can use the <code>sleep</code> function</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n//your code\nsleep(1); // pauses for 1 second\n</code></pre>\n\n<p>by including many of those you get time to see what is happening with your program</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7340499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516756217, "creation_date": 1516744201, "question_id": 48411391, "link": "https://stackoverflow.com/questions/48411391/is-it-possible-to-run-a-command-line-program-slower-on-the-terminal", "title": "Is it possible to run a command line program slower, on the terminal?", "body": "<p>I'm trying to debug a command line program I wrote. Specifically, the parts of it that prints to the terminal. It occurred to me that it could help if I somehow ran it slowly on the terminal.</p>\n\n<p>I'd like to be able to see how to terminal would print in older/less capable systems or whether there is flicker effect or not.</p>\n\n<p>Is there a way to run it slower? i.e. not insta-load it. </p>\n\n<p>Program: Written in \"C\", prints almost instantly.</p>\n\n<p>OS: MacOSX/Windows/Linux, Any would work for me.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "linux", "shared-memory"], "comments": [{"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1516742308, "post_id": 48410966, "comment_id": 83811658, "body": "Well the problem is probably in your makefile, not in your code."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 0, "creation_date": 1516742322, "post_id": 48410966, "comment_id": 83811665, "body": "What platform are you trying to compile this application for?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1516742346, "post_id": 48410966, "comment_id": 83811670, "body": "If you&#39;re on linux, you probably forgot the <code>-lrt</code> on your link command (which should have been included in your question). <a href=\"https://stackoverflow.com/questions/31147129/undefined-reference-to-shm-open-using-cmake\">Closely related question here</a>."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1516742372, "post_id": 48410966, "comment_id": 83811680, "body": "You have to use the <code>-lrt</code> link option."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516742540, "post_id": 48410966, "comment_id": 83811759, "body": "says so right there in the man page <a href=\"http://man7.org/linux/man-pages/man3/shm_open.3.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man3/shm_open.3.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8326, "user_id": 53089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525dac0c4812e8e8753935590b40ddb6?s=128&d=identicon&r=PG", "display_name": "Rob K", "link": "https://stackoverflow.com/users/53089/rob-k"}, "is_accepted": true, "score": 8, "last_activity_date": 1516742488, "creation_date": 1516742488, "answer_id": 48411023, "question_id": 48410966, "link": "https://stackoverflow.com/questions/48410966/undefined-reference-to-shm-open/48411023#48411023", "title": "undefined reference to &#39;shm_open&#39;", "body": "<p>You aren't linking the library where it's defined in your link stage. </p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man3/shm_open.3.html\" rel=\"noreferrer\">http://man7.org/linux/man-pages/man3/shm_open.3.html</a></p>\n\n<p>Link with <code>-lrt</code></p>\n\n<p><b>ETA</b> Generally, if you see an \"undefined reference to X\" error from the compiler, you've forgotten to link in the library where it's defined.</p>\n"}], "owner": {"reputation": 77, "user_id": 9195483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9813c288061f2f4be8783fe9958ecee9?s=128&d=identicon&r=PG&f=1", "display_name": "appendix", "link": "https://stackoverflow.com/users/9195483/appendix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7933, "favorite_count": 0, "accepted_answer_id": 48411023, "answer_count": 1, "score": 3, "last_activity_date": 1535003782, "creation_date": 1516742207, "last_edit_date": 1535003782, "question_id": 48410966, "link": "https://stackoverflow.com/questions/48410966/undefined-reference-to-shm-open", "title": "undefined reference to &#39;shm_open&#39;", "body": "<p>I'm trying to make a simple communicator, using shared memory.</p>\n\n<p>It should be able to write some text and save it in shared memory.</p>\n\n<p>Could someone explain to me why I get error:  </p>\n\n<blockquote>\n  <p>undefined reference to `shm_open'<br>\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>I was trying to create Makefile for both programs to compile, but I still get errors.</p>\n\n<p>This is the code I'm working with right now:</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;errno.h&gt;\n\n#define TEXT_SIZE 512\n\nint i;\n\nstruct shared_data\n{\n  int data;\n  char some_text[TEXT_SIZE];\n};\n\n\nint main()\n{\n  struct shared_data *ptr;\n  const char *shm_name = \"comunicator\";\n  int shm_fd;\n  shm_fd = shm_open(shm_name, O_CREAT | O_RDWR, 0666);\n\n  ftruncate(shm_fd, sizeof(struct shared_data));\n\n  ptr = mmap(0, sizeof(struct shared_data), PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n  if (ptr == MAP_FAILED) {\n    printf(\"mmap - failed.\\n\");\n    return -1;\n  }\n\nptr-&gt;data = 0;\n\nfor(i=0; i&lt;10; i++)\n{\n        while(ptr-&gt;data == 1) sleep(1);\n        scanf(\"%s\", ptr-&gt;some_text);\n        ptr-&gt;data = 1;\n}\n\n\n\n  ptr-&gt;data = 0;\n  sleep(10);\nsprintf(ptr-&gt;some_text,\"Jakis tekst\");\n ptr-&gt;data = 1;\n\n sleep(10);\n\n  if (munmap(ptr, sizeof(struct shared_data)) == -1) {\n   printf(\"unmap failed: %s\\n\", strerror(errno));\n   exit(1);\n }\n\n if (close(shm_fd)) {\n   printf(\"close failed: %s\", strerror(errno));\n    exit(1);\n  }\n\n  return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "floating-point", "double", "ieee-754"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516740558, "post_id": 48410474, "comment_id": 83810772, "body": "Why would you believe 53 binary bits of precision to approach 21 decimal digits of precision?"}, {"owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516740747, "post_id": 48410474, "comment_id": 83810862, "body": "Do you mean that with a 53 bits of mantissa i can&#39;t get this?"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516740816, "post_id": 48410474, "comment_id": 83810896, "body": "Round numbers, log-10 of 2^53 is ~15.9. So 15-16 digits of precision decimal. That seems to align with what you&#39;re observing."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1516740817, "post_id": 48410474, "comment_id": 83810897, "body": "<code>log10(pow(2, 53))</code> is not <code>21</code>."}, {"owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "edited": false, "score": 0, "creation_date": 1516741003, "post_id": 48410474, "comment_id": 83811003, "body": "then how can printf get those 54 digits from a double 64 bits?"}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1516741287, "post_id": 48410474, "comment_id": 83811163, "body": "From a 64 bits <code>double</code> only 15-16 digits are true. If you ask <code>prinff()</code> (or whatever algorithm) for more digits then you get undefined, garbage digits."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516741357, "post_id": 48410474, "comment_id": 83811195, "body": "@latiagertrutis Becuase <code>10 == 5 * 2</code>, so base-10 only has a single factor of two."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 2, "creation_date": 1516741421, "post_id": 48410474, "comment_id": 83811225, "body": "@Ripi2 No, you do <i>not</i>  get garbage. You get the base-10 representation of the <i>exact</i> value as it was in base-2."}, {"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516741630, "post_id": 48410474, "comment_id": 83811318, "body": "@EOF No, because the value in RAM comes from an also size-limited CPU register. OTH, it&#39;s true what you say if the value in RAM (base-2) is valid and exact."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516742150, "post_id": 48410474, "comment_id": 83811591, "body": "@EOF: I&#39;m not sure what the standard actually guarantees. Some implementation do so the exact decimal value (if you specify enough digits). Others might only show enough decimal digits to unambiguously represent the stored value."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1516742796, "post_id": 48410474, "comment_id": 83811883, "body": "@KeithThompson: Standard of what? C? IEEE 754?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516743146, "post_id": 48410474, "comment_id": 83812055, "body": "@EricPostpischil: C (which defines the behavior of <code>printf</code>). The C standard says &quot;The value is rounded to the appropriate number of digits.&quot;, which could be ambiguous."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516743448, "post_id": 48410474, "comment_id": 83812176, "body": "<i>What is logic because the max precision you can get with double is 21</i>. You&#39;re misinterpreting the paper you cited. In section 5.3, the author is not referring to standard IEEE 754 floating point format when they mention 21 digits."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1516743473, "post_id": 48410474, "comment_id": 83812189, "body": "@KeithThompson: C 2011 [N1570] 5.2.4.2.2 6: \u201cThe accuracy of the floating-point operations (+, -, *, /) and of the library functions in &lt;math.h&gt; and &lt;complex.h&gt; that return floating-point results is implementation- defined, as is the accuracy of the conversion between floating-point internal representations and string representations performed by the library functions in &lt;stdio.h&gt;, &lt;stdlib.h&gt;, and &lt;wchar.h&gt;. The implementation may state that the accuracy is unknown.\u201d"}, {"owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516743622, "post_id": 48410474, "comment_id": 83812254, "body": "@lurker I was thinking on that, so the max precision i can get here is 16?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516744309, "post_id": 48410474, "comment_id": 83812547, "body": "@lurker: The maximum number of decimal digits that can be converted, for any possible digits and exponent, from decimal floating-point to IEEE 754 basic 64-bit binary floating-point and back without change is 15. The number of decimal digits required to convert any number from binary floating-point to decimal and back without change is 17."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516755725, "post_id": 48410474, "comment_id": 83816512, "body": "@EricPostpischil thanks. I did hedge my bets with 15-16 initially (since the log-10 of 2^53 came in at 15.9...). So I thought perhaps there may be some cases where one could squeeze 16 digits out of it. So max 15 digits."}], "answers": [{"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1516742568, "post_id": 48410594, "comment_id": 83811770, "body": "(a) The precision is not false; IEEE 754 is clear that a floating-point datum represents exactly one specific number (unless it is a NaN), and <code>printf</code> has correctly shown that number. (b) There is nothing about 1 or 3 or \u2153 that is particularly decimal; these would be the same in base 4, 7, 16, or 233. And \u2153 is not representable in decimal floating-point, so assuming values ought to be decimal in some regard is incorrect. The principles of IEEE 754 are good: Preserve values as much as possible. This means showing all digits when asked, not truncating arbitrarily for decimal."}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": -2, "last_activity_date": 1516800534, "last_edit_date": 1516800534, "creation_date": 1516740678, "answer_id": 48410594, "question_id": 48410474, "link": "https://stackoverflow.com/questions/48410474/printing-double-precision-floating-point-numbers/48410594#48410594", "title": "printing double precision floating point numbers", "body": "<p>The output from [that] printf is a false precision, in the sense that it is telling you the precise value of the binary number when rendered in decimal as if that binary number had an infinite number of 0 bits on the end, when we know the number probably started as decimal in the first place.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516742034, "post_id": 48410731, "comment_id": 83811537, "body": "@latiagertrutis: Why do you think <code>co</code> contains \u2153? It contains the result of dividing 1 by 3 <b>as a floating-point operation</b>. Since binary floating-point cannot represent \u2153, the result is not \u2153. Instead, it is the nearest representable value."}, {"owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "edited": false, "score": 0, "creation_date": 1516742048, "post_id": 48410731, "comment_id": 83811547, "body": "But my variable &#39;co&#39; is a double number that contains the value 1/3 and his mantissa is: 10101010101010101010101010101010101010101010101010101, so with this how printf does for obtain this aproximation?"}, {"owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "edited": false, "score": 0, "creation_date": 1516742564, "post_id": 48410731, "comment_id": 83811768, "body": "To avoid miss understanding, i know that some numbers can&#39;t be represented with the finite size of a double, what i&#39;m trying to find is witch method is printf using."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "edited": false, "score": 0, "creation_date": 1516742722, "post_id": 48410731, "comment_id": 83811845, "body": "@latiagertrutis: The value printed by <code>printf</code> is not an approximation; it is <b>exactly</b> the value in <code>co</code>. I do not know which algorithm <code>printf</code> is using (I do not even know which <code>printf</code> you are using\u2014Apple\u2019s? One that came with GCC?). If you want an algorithm for doing this conversion, search for Gay\u2019s paper. There appears to be a copy <a href=\"https://ampl.com/REFS/rounding.pdf\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1516748171, "post_id": 48410731, "comment_id": 83814245, "body": "You should read Loitsch&#39;s article, and also Marc Andrysco, Ranjit Jhala, Sorin Lerner&#39;s \u201cPrinting Floating-Point Numbers: A Faster, Always Correct Method\u201d. First, it would be better than guessing about them, and second, they provide exactly the sort of conversion, for better and for worse, at the core of some programming languages&#39; conversion-to-decimal functions. <a href=\"https://ideone.com/Mw09aj\" rel=\"nofollow noreferrer\">ideone.com/Mw09aj</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1516753572, "post_id": 48410731, "comment_id": 83815915, "body": "@PascalCuoq: Thanks, I\u2019ve printed Loitsch\u2019s paper and made a note of the other."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 3, "last_activity_date": 1517929217, "last_edit_date": 1517929217, "creation_date": 1516741298, "answer_id": 48410731, "question_id": 48410474, "link": "https://stackoverflow.com/questions/48410474/printing-double-precision-floating-point-numbers/48410731#48410731", "title": "printing double precision floating point numbers", "body": "<p>A fundamental principle of floating-point arithmetic, particularly as specified in the IEEE 754 standard, is that a floating-point datum represents <strong>exactly</strong> one specific number.</p>\n\n<p>When performing an operation on floating-point numbers, the exact mathematical result might not be representable in the floating-point format. In this case, the operation returns the nearest representable number according to some rule (often round to nearest with ties to even digit, but sometimes round toward +infinity, round toward -infinity, round toward zero, or round to odd digit). Thus, <strong>operations</strong> in floating-point arithmetic may return approximate results, but <strong>numbers</strong> are exact.</p>\n\n<p>In your example, dividing one by three results in a floating-point number that is exactly 0.333333333333333314829616256247390992939472198486328125. This is because the mathematical result is exactly \u2153, but that is not representable in binary floating-point, and the number shown above is the closest value that is representable, so that is the result.</p>\n\n<p>The call to <code>printf</code> with the conversion specifier <code>%.100f</code> requests that this binary floating-point value be converted to decimal. That is a mathematical operation, and the mathematical result of converting the binary floating-point value to decimal would be \u201c0.333333333333333314829616256247390992939472198486328125\u201d. Since you told <code>printf</code> to use 100 digits, it has enough digits to produce the exact result, so it does.</p>\n\n<p>(This suggests that you are using a good-quality <code>printf</code> implementation. Some implementations do not perform this operation correctly.)</p>\n\n<p>The paper by Florian Loitsch you cite provides algorithms for converting binary floating-point values to enough decimal digits that the value is distinguished from neighboring floating-point values. It does not usually generate enough decimal digits to show the exact value. For example, in base-3 floating-point with two digits, we could represent the numbers 0, 1/9, 2/9, 3/9, 4/9, and so on. In this case, if the value is 4/9 (.4444\u2026), then printing \u201c.4\u201d would be enough to distinguish the value from .3333\u2026 and .5555\u2026, but it would not exactly represent the value. Loitsch\u2019s algorithms only produce enough digits to distinguish values, not usually enough to show the exact mathematical value.</p>\n\n<p>(Loitsch\u2019s paper also discusses how often the algorithms produce the shortest result that distinguishes the value\u2014just enough digits to do the job and no more.)</p>\n\n<p>The classic paper on converting between bases is <em>Correctly Rounded Binary-Decimal and Decimal-Binary Conversions</em> by David M. Gay.</p>\n"}], "owner": {"reputation": 105, "user_id": 8930037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aZNAz.jpg?s=128&g=1", "display_name": "latiagertrutis", "link": "https://stackoverflow.com/users/8930037/latiagertrutis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 48410731, "answer_count": 2, "score": 0, "last_activity_date": 1517929217, "creation_date": 1516740234, "question_id": 48410474, "link": "https://stackoverflow.com/questions/48410474/printing-double-precision-floating-point-numbers", "title": "printing double precision floating point numbers", "body": "<p>I'm trying to represent a double in a string, for this purpose i'm using grisu's algorithm, you can check it out here: <a href=\"https://www.cs.tufts.edu/~nr/cs257/archive/florian-loitsch/printf.pdf\" rel=\"nofollow noreferrer\">https://www.cs.tufts.edu/~nr/cs257/archive/florian-loitsch/printf.pdf</a></p>\n\n<p>i'm done with it, and apparently is working, my question comes when comparing with printf output with big precision, something like that:</p>\n\n<pre><code>double u = 1, t = 3;\ndouble co = u/t;\nprintf(\"%.100f\", co);\n</code></pre>\n\n<p>Outputs</p>\n\n<pre><code>0.3333333333333333148296162562473909929394721984863281250000000000000000000000000000000000000000000000\n</code></pre>\n\n<p>With grisu's algorithm i can obtain the following:</p>\n\n<pre><code>3333333333333333e-16\n</code></pre>\n\n<p>What is logic because the max precision you can get with double is 21 digits as you can read in the PDF at \"5.3 C Implementation\" (page 6). Then how can i obtain the rest if my max precision is this, or which algorithm is using printf to get this amount of precision?</p>\n"}, {"tags": ["c", "compiler-errors", "cs50", "mingw32", "crypt"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1517843507, "post_id": 48410282, "comment_id": 84248011, "body": "MinGW is a &#39;Minimal GNU on Windows&#39; system.  It doesn&#39;t necessarily provide all the libraries that GNU generally provides.  Check whether you can find a <code>libcrypt</code> for MinGW, or consider whether you want Cygwin instead \u2014 that does provide better Unix (Linux) compatibility and has libraries such as <code>libcrypt</code> available."}], "answers": [{"tags": [], "owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1516746592, "last_edit_date": 1516746592, "creation_date": 1516742650, "answer_id": 48411063, "question_id": 48410282, "link": "https://stackoverflow.com/questions/48410282/mingw32-compiler-giving-error-with-lcrypt/48411063#48411063", "title": "mingw32 compiler giving error with -lcrypt", "body": "<p>MinGW doesn't generally come with libcrypt. You'll have to either find a Windows version of the static library (I don't know of one), or alternatively, you can include the source code for <code>crypt(3)</code>in your project.</p>\n\n<p>This version of <a href=\"http://michael.dipperstein.com/crypt/crypt3.c\" rel=\"nofollow noreferrer\">crypt.c</a> has worked for me in the past. (Code is in the public domain). It's a fairly old version, but it suffices.</p>\n\n<p>In the event the link rots away, a simple web search should yield several examples, as the source is widely available, with varying levels of licensing.</p>\n"}], "owner": {"reputation": 193, "user_id": 7657660, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/4e2855e44b516156787745876ece0b49?s=128&d=identicon&r=PG&f=1", "display_name": "Said Akbar", "link": "https://stackoverflow.com/users/7657660/said-akbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517843297, "creation_date": 1516739406, "last_edit_date": 1517843297, "question_id": 48410282, "link": "https://stackoverflow.com/questions/48410282/mingw32-compiler-giving-error-with-lcrypt", "title": "mingw32 compiler giving error with -lcrypt", "body": "<p>I have been trying to make my <code>crack.c</code> code work on my Windows 10 laptop. The code runs on CS50 IDE (online IDE) without any errors. However, when I try to compile the code on my laptop using mingw32 on command line, the compiler is giving me an error:</p>\n\n<pre><code> c:/mingw/bin/../lib/gcc/mingw32/5.3.0/../../../../mingw32/bin/ld.exe: cannot \n find -lcrypt collect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p>The code uses <a href=\"http://man7.org/linux/man-pages/man3/crypt.3.html\" rel=\"nofollow noreferrer\"><code>crypt()</code></a> from the Linux C library. I tried to link the compiler to this by <code>-lcrypt</code> but apparently it does not exist.</p>\n\n<p>How to solve this issue?</p>\n"}, {"tags": ["c", "linux", "unix", "signals"], "comments": [{"owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "edited": false, "score": 0, "creation_date": 1516734844, "post_id": 48409070, "comment_id": 83807681, "body": "I remember finding a good wikipedia article that had information on the types of signals."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "edited": false, "score": 0, "creation_date": 1516737053, "post_id": 48409633, "comment_id": 83808949, "body": "I believe sigset_t is an &#39;unsigned long&#39;     /usr/include/x86_64-linux-gnu/asm/signal.h:typedef unsigned long sigset_t  And, thank you very much for this explanation. Very detailed and thorough."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "edited": false, "score": 0, "creation_date": 1516739190, "post_id": 48409633, "comment_id": 83810076, "body": "@Zub: Thanks for pointing out the formatting errors. I applied those I made, but kept the one by OP (marked [sic]). The one I skipped was not an error: it indeed should be <i>&quot;a long&quot;</i> and not <i>&quot;along&quot;</i>, since <code>long</code> is the name of the type implied by OP."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "edited": false, "score": 0, "creation_date": 1516739329, "post_id": 48409633, "comment_id": 83810141, "body": "@seanlum: On x86_64. Linux runs on a large number of architectures. Making an assumption that <code>sigset_t</code> is of <code>unsigned long</code> type would make your code strictly limited to x86-64 and x86-64-like architectures. This is to say, the type is <code>sigset_t</code>, and you must treat it as an opaque bit set type, and not as an integer type. My point is, claiming it is a long is incorrect, even though <i>it happens to be <code>long</code></i> on some architectures."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "edited": false, "score": 0, "creation_date": 1516740306, "post_id": 48409633, "comment_id": 83810644, "body": "@seanlum: Your example program had other issues -- especially using <code>printf()</code> in a signal handler, which is a no-no: it simply may not work in some cases, while it might work just fine on most cases, as <code>printf()</code> is not an async-signal safe function as listed in <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"nofollow noreferrer\"><code>man 7 signal</code></a> -- so I added an example program that uses safe and sound approaches, for you to experiment upon. Happy investigations!"}, {"owner": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "edited": false, "score": 0, "creation_date": 1516741011, "post_id": 48409633, "comment_id": 83811012, "body": "Thank you for the clarification, that has changed the way I see variables now."}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 8, "last_activity_date": 1516740180, "last_edit_date": 1516740180, "creation_date": 1516736675, "answer_id": 48409633, "question_id": 48409070, "link": "https://stackoverflow.com/questions/48409070/difference-between-a-process-signal-mask-blocked-signal-set-and-a-blocked-sign/48409633#48409633", "title": "Difference between a process signal mask, blocked signal set, and a blocked signal?", "body": "<blockquote>\n  <p>Each process has it's [sic] own signal mask (a long which contains the signals being blocked)</p>\n</blockquote>\n\n<p>Well, no. The signal mask is actually thread-specific. (In a multithreaded program, you must use <a href=\"http://man7.org/linux/man-pages/man3/pthread_sigmask.3.html\" rel=\"noreferrer\"><code>pthread_sigmask()</code></a> to manipulate the signal mask for the current thread; in a single-threaded program, you can use <a href=\"http://man7.org/linux/man-pages/man2/sigprocmask.2.html\" rel=\"noreferrer\"><code>sigprocmask()</code></a>.)</p>\n\n<p>Also, it's not \"a long\". It is of type <code>sigset_t</code>, which might be an array, structure, or union type. In any case, one should consider it simply as an unordered bit set, one bit per signal.</p>\n\n<blockquote>\n  <p>So now there is a signal handler for SIGABRT, but SIGABRT will not be in the process signal mask.</p>\n</blockquote>\n\n<p>Correct. Whether or not you have assigned a signal handler or not, does not affect the signal mask at all.</p>\n\n<blockquote>\n  <p>If I block SIGABRT with sigaddset(3), will the signal handler sig_abrt not receive the call when the SIGABRT is delivered? Does it mean that the signal mask affects which signals are delivered? What is the difference?</p>\n</blockquote>\n\n<p>If all your threads block SIGABRT, it will not be delivered until either the signal is unblocked (removed from the signal mask). If the signal is consumed using <a href=\"http://man7.org/linux/man-pages/man3/sigwait.3.html\" rel=\"noreferrer\"><code>sigwait()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/sigwaitinfo.2.html\" rel=\"noreferrer\"><code>sigwaitinfo()</code></a>, or <a href=\"http://man7.org/linux/man-pages/man2/sigtimedwait.2.html\" rel=\"noreferrer\"><code>sigtimedwait()</code></a>, the signal handler will not be invoked at all.</p>\n\n<p>A short summary:</p>\n\n<ul>\n<li><p>Signals can be directed to a process group (<a href=\"http://man7.org/linux/man-pages/man2/kill.2.html\" rel=\"noreferrer\"><code>kill()</code></a> with <code>pid == 0</code> or <code>pid == -pgid</code>), a specific process (<code>pid</code>), or a specific thread in a specific process (<a href=\"http://man7.org/linux/man-pages/man3/pthread_kill.3.html\" rel=\"noreferrer\"><code>pthread_kill()</code></a> within the same process, <a href=\"http://man7.org/linux/man-pages/man2/tgkill.2.html\" rel=\"noreferrer\"><code>tgkill</code></a> system call in Linux in general).</p></li>\n<li><p>If a signal is directed to a process group, each process in that group receives \"a copy\" of the signal.</p></li>\n<li><p>The signal mask defines whether signals are blocked, or delivered immediately.</p></li>\n<li><p>In each process, each signal</p>\n\n<ul>\n<li><p>can have a signal handler, or</p></li>\n<li><p>be ignored (<code>SIG_IGN</code> \"handler\"), or</p></li>\n<li><p>have the default <em>disposition</em> (ignored (<em>Ign</em>), terminates the process with (<em>Core</em>) or without (<em>Term</em>) a core dump; or it can stop (<em>Stop</em>) or continue (<em>Cont</em>) the execution of the target thread or process). See <a href=\"http://man7.org/linux/man-pages/man7/signal.7.html\" rel=\"noreferrer\"><code>man 7 signal</code></a> for details.</p></li>\n</ul></li>\n<li><p>If some, but not all threads, block a signal, and the signal is not targeted to a specific thread, the kernel directs the signal to one of the threads that are not blocking the signal (at random).</p></li>\n<li><p>There are two ways of catching a signal:</p>\n\n<ol>\n<li><p>Using a signal handler. The signal gets delivered to a signal handler only when the signal is <em>not</em> blocked. If the signal is blocked, the delivery of the signal is <em>pending</em> until not blocked (or caught by the other option below).</p></li>\n<li><p><a href=\"http://man7.org/linux/man-pages/man3/sigwait.3.html\" rel=\"noreferrer\"><code>sigwait()</code></a>, <a href=\"http://man7.org/linux/man-pages/man2/sigwaitinfo.2.html\" rel=\"noreferrer\"><code>sigwaitinfo()</code></a>, or <a href=\"http://man7.org/linux/man-pages/man2/sigtimedwait.2.html\" rel=\"noreferrer\"><code>sigtimedwait()</code></a>. These functions check if any signals are pending, and if so, \"catch\" it. The set of signals they check is defined by a function parameter of <code>sigset_t</code> type.</p></li>\n</ol></li>\n</ul>\n\n<p>When the kernel sends/forwards a signal to a process, it first checks if the process has a thread that is not blocking that signal. If there is such a thread, it delivers it via that thread. (If the signal has a signal handler, that signal handler gets invoked in that thread; otherwise, the effect is dictated by the signal <em>disposition</em>.)</p>\n\n<p>If the signal is blocked, the kernel leaves it <em>pending</em> for the process.</p>\n\n<p>If the process calls <code>sigwait()</code>, <code>sigwaitinfo()</code>, or <code>sigtimedwait()</code> with the pending signal in the specified signals set, it receives the information on that signal, and the signal is caught. (It will no longer be pending, and it will not cause a signal handler to be invoked; it is \"consumed\".)</p>\n\n<p>If the process changes its signal mask, so that the pending signal becomes unblocked, it is delivered by the kernel (just as if it was sent at that point in time).</p>\n\n<blockquote>\n  <p>Also, is there a way to block a signal in a process without using the sigsetops(3) and sigprocmask(2) functions?</p>\n</blockquote>\n\n<p>No. (You can implement your own <code>sigsetops()</code> and a syscall wrapper for <code>sigprocmask()</code>, but that's about it.)</p>\n\n<hr>\n\n<p>Here is an example program, <strong>example.c</strong>, you can use for exploring signal handlers, catching signals, and the signal mask, in a single-threaded process:</p>\n\n<pre><code>#define  _POSIX_C_SOURCE 200809L\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\n/* Async-signal safe write-to-standard error function.\n   Keeps errno unchanged. Do not use stderr otherwise!\n*/\nstatic int wrerrpp(const char *ptr, const char *end)\n{\n    const int  saved_errno = errno;\n    ssize_t    chars;\n\n    while (ptr &lt; end) {\n        chars = write(STDERR_FILENO, ptr, (size_t)(end - ptr));\n        if (chars &gt; 0)\n            ptr += chars;\n        else\n        if (chars != -1) {\n            errno = saved_errno;\n            return EIO;\n        } else\n        if (errno != EINTR) {\n            const int  retval = errno;\n            errno = saved_errno;\n            return retval;\n        }\n    }\n\n    errno = saved_errno;\n    return 0;\n}\n\n/* Write the supplied string to standard error.\n   Async-signal safe. Keeps errno unchanged.\n   Do not mix with stderr!\n*/\nstatic int wrerr(const char *ptr)\n{\n    if (!ptr)\n        return 0;\n    else {\n        const char *end = ptr;\n        /* strlen() is not async-signal safe, so\n           find the end of the string the hard way. */\n        while (*end)\n            end++;\n        return wrerrpp(ptr, end);\n    }\n}\n\n/* Write the supplied long to standard error.\n   Async-signal safe. Keeps errno unchanged.\n   Do not mix with stderr!\n*/\nstatic int wrerrnum(const long  value)\n{\n    unsigned long  u = (value &lt; 0) ? (unsigned long)-value : (unsigned long)value;\n    char           buf[40];\n    char          *ptr = buf + sizeof buf;\n    char *const    end = buf + sizeof buf;\n\n    do {\n        *(--ptr) = '0' + (u % 10uL);\n        u /= 10uL;\n    } while (u &gt; 0uL);\n\n    if (value &lt; 0)\n        *(--ptr) = '-';\n\n    return wrerrpp(ptr, end);\n}\n\n/* Async-signal safe variant of strsignal().\n   Only covers a small subset of all signals.\n   Returns NULL if the signal name is not known. */\nstatic const char *signal_name(const int signum)\n{\n    switch (signum) {\n    case SIGHUP:    return \"HUP\";\n    case SIGINT:    return \"INT\";\n    case SIGQUIT:   return \"QUIT\";\n    case SIGKILL:   return \"KILL\";\n    case SIGSEGV:   return \"SEGV\";\n    case SIGTERM:   return \"TERM\";\n    case SIGUSR1:   return \"USR1\";\n    case SIGUSR2:   return \"USR2\";\n    case SIGCHLD:   return \"CHLD\";\n    case SIGCONT:   return \"CONT\";\n    case SIGSTOP:   return \"STOP\";\n    default:        return NULL;\n    }\n}\n\n/* Signal handler that reports its delivery immediately,\n   but does nothing else.\n*/\nstatic void report_signal(int signum, siginfo_t *info, void *ctx)\n{\n    const char *sname = signal_name(signum);\n\n    wrerr(\"report_signal(): Received signal \");\n    if (sname)\n        wrerr(sname);\n    else\n        wrerrnum(signum);\n\n    if (info-&gt;si_pid) {\n        wrerr(\" from process \");\n        wrerrnum(info-&gt;si_pid);\n        wrerr(\".\\n\");\n    } else\n        wrerr(\" from kernel or terminal.\\n\");\n\n}\n\n/* Install report_signal() handler.\n*/\nstatic int install_report_signal(const int signum)\n{\n    struct sigaction  act;\n\n    memset(&amp;act, 0, sizeof act);\n\n    sigemptyset(&amp;act.sa_mask);\n\n    act.sa_sigaction = report_signal;\n    act.sa_flags = SA_SIGINFO;\n\n    if (sigaction(signum, &amp;act, NULL) == -1)\n        return errno;\n\n    return 0;\n}\n\n\nint main(void)\n{\n    sigset_t    mask;\n    siginfo_t   info;\n    const char *name;\n    int         signum;\n\n    if (install_report_signal(SIGINT) ||\n        install_report_signal(SIGCONT)) {\n        const char *errmsg = strerror(errno);\n        wrerr(\"Cannot install signal handlers: \");\n        wrerr(errmsg);\n        wrerr(\".\\n\");\n        return EXIT_FAILURE;\n    }\n\n    sigemptyset(&amp;mask);\n    sigaddset(&amp;mask, SIGUSR1);\n    sigaddset(&amp;mask, SIGUSR2);\n    sigaddset(&amp;mask, SIGHUP);\n    sigaddset(&amp;mask, SIGTERM);\n    sigprocmask(SIG_SETMASK, &amp;mask, NULL);\n\n    printf(\"Process %ld is ready to receive signals! Run\\n\", (long)getpid());\n    printf(\"\\tkill -USR1 %ld\\n\", (long)getpid());\n    printf(\"\\tkill -USR2 %ld\\n\", (long)getpid());\n    printf(\"\\tkill -HUP  %ld\\n\", (long)getpid());\n    printf(\"\\tkill -TERM %ld\\n\", (long)getpid());\n    printf(\"in another terminal; press Ctrl+C in this terminal; or press Ctrl+Z and run\\n\");\n    printf(\"\\tfg\\n\");\n    printf(\"in this terminal.\\n\");\n    fflush(stdout);\n\n    /* Almost same as blocked mask, just without SIGUSR1 and SIGUSR2. */\n    sigemptyset(&amp;mask);\n    sigaddset(&amp;mask, SIGHUP);\n    sigaddset(&amp;mask, SIGTERM);\n\n    do {\n        do {\n            signum = sigwaitinfo(&amp;mask, &amp;info);\n        } while (signum == -1 &amp;&amp; errno == EINTR);\n        if (signum == -1) {\n            const char *errmsg = strerror(errno);\n            wrerr(\"sigwaitinfo(): \");\n            wrerr(errmsg);\n            wrerr(\".\\n\");\n            return EXIT_FAILURE;\n        }\n\n        name = signal_name(signum);\n        if (name)\n            printf(\"main(): Received signal %s from \", name);\n        else\n            printf(\"main(): Received signal %d from \", signum);\n\n        if (info.si_pid == 0)\n            printf(\"kernel or terminal.\\n\");\n        else\n            printf(\"process %ld.\\n\", (long)info.si_pid);\n        fflush(stdout);\n\n    } while (signum != SIGTERM);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Compile it using for example</p>\n\n<pre><code>gcc -Wall -O2 example.c -o example\n</code></pre>\n\n<p>I suggest you prepare two terminals. In one terminal, run the compiled program, using</p>\n\n<pre><code>./example\n</code></pre>\n\n<p>and observe its output. It will be something like</p>\n\n<blockquote>\n  <p>Process 843 is ready to receive signals! Run\n  <br> &nbsp; &nbsp; kill -USR1 843\n  <br> &nbsp; &nbsp; kill -USR2 843\n  <br> &nbsp; &nbsp; kill -HUP  843\n  <br> &nbsp; &nbsp; kill -TERM 843\n  <br> in another terminal; press Ctrl+C in this terminal; or press Ctrl+Z and run\n  <br> &nbsp; &nbsp; fg\n  <br> in this terminal.</p>\n</blockquote>\n\n<p>The KILL and STOP signals cannot be caught. KILL will always kill the process, and STOP will always stop (\"pause\") the process.</p>\n\n<p>If you press <kbd>Ctrl</kbd>+<kbd>C</kbd> in that terminal, the kernel will send an INT signal to the process. (This will be delivered via the <code>report_signal()</code> signal handler.)</p>\n\n<p>If you press <kbd>Ctrl</kbd>+<kbd>Z</kbd> in that terminal, the kernel will send a STOP signal to the process. The shell detects this, pushing <code>./example</code> under job control, and lets you input new shell commands. The <code>fg</code> command brings <code>./example</code> back to foreground, with the shell sending it the CONT signal, so that <code>./example</code> will continue execution.</p>\n\n<p>USR1 and USR2 signals are blocked, so they are never delivered to the <code>report_signal()</code> signal handler.</p>\n\n<p>HUP and TERM signals are also blocked, but they are received by the main thread via <code>sigwaitinfo()</code>.</p>\n\n<p>The program exits, when it receives a TERM signal.</p>\n"}], "owner": {"reputation": 63, "user_id": 8578048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f95dcf608bc1efa4e678748f6dbe81?s=128&d=identicon&r=PG", "display_name": "seanlum", "link": "https://stackoverflow.com/users/8578048/seanlum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4681, "favorite_count": 1, "accepted_answer_id": 48409633, "answer_count": 1, "score": 5, "last_activity_date": 1516740180, "creation_date": 1516734451, "question_id": 48409070, "link": "https://stackoverflow.com/questions/48409070/difference-between-a-process-signal-mask-blocked-signal-set-and-a-blocked-sign", "title": "Difference between a process signal mask, blocked signal set, and a blocked signal?", "body": "<p>Learning about signals, and I was wondering about the subtle differences between the process signal mask, a blocked signal set, a signal handler, and a blocked signal. </p>\n\n<p>The questions involve (on Debian):</p>\n\n<ul>\n<li>sigprocmask(2)</li>\n<li>sigsetops(3) related functions</li>\n</ul>\n\n<p>Each process has it's own signal mask (a long which contains the signals being blocked). And a signal set can be obtained by calling sigprocmask(2) with a NULL argument for the *set variable, will result in the old process mask to be put into *oldset, unchanged:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n\nvoid show_signals(const sigset_t exmask)\n{\n\n    int exsignals[43];\n\n    exsignals[0] = SIGABRT;\n    exsignals[1] = SIGALRM;\n    exsignals[2] = SIGBUS;\n    exsignals[3] = SIGCHLD;\n    exsignals[4] = SIGCONT;\n#ifdef SIGEMT\n    exsignals[5] = SIGEMT;\n#else\n    exsignals[5] = -1;\n#endif\n\n    exsignals[6] = SIGFPE;\n\n#ifdef SIGFREEZE\n    exsignals[7] = SIGFREEZE;\n#else\n    exsignals[7] = -1;\n#endif\n\n    exsignals[8] = SIGHUP;\n    exsignals[9] = SIGILL;\n#ifdef SIGINFO\n    exsignals[10] = SIGINFO;\n#else\n    exsignals[10] = -1;\n#endif\n\n    exsignals[11] = SIGINT;\n    exsignals[12] = SIGIO;\n    exsignals[13] = SIGIOT;\n\n#ifdef SIGJVM1\n    exsignals[14] = SIGJVM1;\n#else\n    exsignals[14] = -1;\n#endif\n#ifdef SIGJVM2\n    exsignals[15] = SIGJVM2;\n#else\n    exsignals[15] = -1;\n#endif\n\n    exsignals[16] = SIGKILL;\n#ifdef SIGLOST\n    exsignals[17] = SIGLOST;\n#else\n    exsignals[17] = -1;\n#endif\n\n#ifdef SIGLWP\n    exsignals[18] = SIGLWP;\n#else\n    exsignals[18] = -1;\n#endif\n\n    exsignals[19] = SIGPIPE;\n    exsignals[20] = SIGPOLL;\n    exsignals[21] = SIGPROF;\n    exsignals[22] = SIGPWR;\n    exsignals[23] = SIGQUIT;\n    exsignals[24] = SIGSEGV;\n    exsignals[25] = SIGSTKFLT;\n    exsignals[26] = SIGSTOP;\n    exsignals[27] = SIGSYS;\n    exsignals[28] = SIGTERM;\n#ifdef SIGTHAW\n    exsignals[29] = SIGTHAW;\n#else\n    exsignals[29] = -1;\n#endif\n#ifdef SIGTHR\n    exsignals[30] = SIGTHR;\n#else\n    exsignals[30] = -1;\n#endif\n    exsignals[31] = SIGTRAP;\n    exsignals[32] = SIGTSTP;\n    exsignals[33] = SIGTTIN;\n    exsignals[34] = SIGTTOU;\n    exsignals[35] = SIGURG;\n    exsignals[36] = SIGUSR1;\n    exsignals[37] = SIGUSR2;\n    exsignals[38] = SIGVTALRM;\n#ifdef SIGWAITING\n    exsignals[39] = SIGWAITING;\n#else\n    exsignals[39] = -1;\n#endif\n\n    exsignals[40] = SIGWINCH;\n    exsignals[41] = SIGXCPU;\n    exsignals[42] = SIGXFSZ;\n#ifdef SIGXRES\n    exsignals[43] = SIGXRES;\n#else\n    exsignals[43] = -1;\n#endif\n\n    int exsignals_n = 0;\n\n    for (;exsignals_n &lt; 43; exsignals_n++) {\n        if (exsignals[exsignals_n] == -1) continue;\n        static char *exsignal_name;\n        exsignal_name = strsignal(exsignals[exsignals_n]);\n        switch(sigismember(&amp;exmask, exsignals[exsignals_n]))\n        {\n        case 0: break;\n        case 1: printf(\"YES %s\\n\", exsignal_name); break;\n        case -1: printf(\"could not obtain signal\\n\"); break;\n        default: printf(\"UNEXPECTED for %s return\\n\", exsignal_name); break;\n        }\n    }\n}\nconst sigset_t getmask(void)\n{\n        static sigset_t retmask;\n        if ((sigprocmask(SIG_SETMASK, NULL, &amp;retmask)) == -1)\n                printf(\"could not obtain process signal mask\\n\");\n\n        return retmask;\n}\n</code></pre>\n\n<p>At the beginning of my program, I realize that the process signal mask, has not blocked any signals. I then place a signal handler into the program.</p>\n\n<pre><code>static void sig_abrt(int signo)\n{\n    printf(\"Caught SIGABRT\\n\");\n}\n\nint main(void)\n{\n    show_signals(getmask());\n\n    signal(SIGABRT, sig_abrt);\n\n    show_signals(getmask());\n\n    return 0;\n}\n</code></pre>\n\n<p>So now there is a signal handler for SIGABRT, but if I were to call sigprocmask(2) again, as above, SIGABRT will not be in the process signal mask. I tried checking with sigismember(3), but the process signal mask will only be modified once I have called sigaddset(3) or another function which modifies the signal mask.</p>\n\n<p>If I block SIGABRT with sigaddset(3), will the signal handler sig_abrt not receive the call when the SIGABRT is delivered? Does it mean that the signal mask affects which signals are delivered? What is the difference?</p>\n\n<p>Also, is there a way to block a signal in a process without using the sigsetops(3) and sigprocmask(2) functions?</p>\n"}, {"tags": ["c", "types", "unsigned", "unsigned-integer", "unsigned-long-long-int"], "comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "edited": false, "score": 3, "creation_date": 1516734216, "post_id": 48408988, "comment_id": 83807302, "body": "Maybe you are printing it with wrong format specifier?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1516734311, "post_id": 48408988, "comment_id": 83807352, "body": "UINT_MAX is the same bit-wise as -1 in two&#39;s complement notation.  You&#39;re probably printing it out as a signed integer."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1516736018, "post_id": 48409377, "comment_id": 83808359, "body": "<code>printf(&quot;%d&quot;, UINT_MAX); &#47;&#47; This will print -1</code> This is also system dependent as not every system is two&#39;s complement."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1516736539, "post_id": 48409377, "comment_id": 83808638, "body": "@ChristianGibbons: While in theory non-twos-complement machines can exist, you won&#39;t find one outside a museum."}, {"owner": {"reputation": 688, "user_id": 7545632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42e4908a66e18fdd2ed137938de01e44?s=128&d=identicon&r=PG", "display_name": "sameer chaudhari", "link": "https://stackoverflow.com/users/7545632/sameer-chaudhari"}, "edited": false, "score": 1, "creation_date": 1516736593, "post_id": 48409377, "comment_id": 83808670, "body": "I agree with both of your comment"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1516751172, "post_id": 48409377, "comment_id": 83815246, "body": "the <code>%d</code> ver is undefined behaviour so could print anything , or format your hard drive"}, {"owner": {"reputation": 479, "user_id": 2163460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/x2Pk2.png?s=128&g=1", "display_name": "eLg", "link": "https://stackoverflow.com/users/2163460/elg"}, "edited": false, "score": 0, "creation_date": 1516751299, "post_id": 48409377, "comment_id": 83815291, "body": "My classmates are also getting -1"}], "tags": [], "owner": {"reputation": 688, "user_id": 7545632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42e4908a66e18fdd2ed137938de01e44?s=128&d=identicon&r=PG", "display_name": "sameer chaudhari", "link": "https://stackoverflow.com/users/7545632/sameer-chaudhari"}, "is_accepted": true, "score": 6, "last_activity_date": 1516735944, "last_edit_date": 1516735944, "creation_date": 1516735602, "answer_id": 48409377, "question_id": 48408988, "link": "https://stackoverflow.com/questions/48408988/maximum-value-for-unsigned-int-is-it-1/48409377#48409377", "title": "Maximum Value for Unsigned Int is it -1", "body": "<p>Whats the format specifier are you using to print those values ?\nThese kind of error mostly occur due to wrong format specifier.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main()\n{  \n    printf(\"%u\", UINT_MAX); // This will print 4294967295 (system dependent)\n    printf(\"%d\", UINT_MAX); // This will print -1\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 479, "user_id": 2163460, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/x2Pk2.png?s=128&g=1", "display_name": "eLg", "link": "https://stackoverflow.com/users/2163460/elg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2995, "favorite_count": 0, "closed_date": 1516740976, "accepted_answer_id": 48409377, "answer_count": 1, "score": -1, "last_activity_date": 1516750554, "creation_date": 1516734143, "last_edit_date": 1516750554, "question_id": 48408988, "link": "https://stackoverflow.com/questions/48408988/maximum-value-for-unsigned-int-is-it-1", "closed_reason": "Duplicate", "title": "Maximum Value for Unsigned Int is it -1", "body": "<p>I was trying to figure out the minimum and maximum value for an unsigned data type. I know that the minimum unsigned value is 0 and the maximum value is (2^n)-1. However, when I tried to run my program (<em>I cannot post my code, but you can refer to <a href=\"https://stackoverflow.com/questions/2053843/min-and-max-value-of-data-type-in-c\">this</a></em>), I keep getting -1 as the maximum value. Can someone explain to me why? Also, UINT_MAX is giving me 4294967295 while ULLONG_MAX is 4294967295. However, the maximum value of unsigned int is supposed to be 65535 while unsigned long long int is supposed to be +18,446,744,073,709,551,615.Why is it the output is different?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1516732266, "post_id": 48408488, "comment_id": 83806192, "body": "A double pointer wouldn&#39;t have resolved the warning because <code>&amp;numbers</code> is of type <code>int (*)[3]</code>, which is not the same as <code>int **</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1516732711, "post_id": 48408488, "comment_id": 83806446, "body": "Also, to print a pointer value (of pointer to object type, not function type), use the <code>%p</code> format specifier and cast the pointer to type <code>void *</code> (or a qualified version of <code>void *</code>), e.g. <code>printf(&quot;p = %p\\n&quot;, (void *)p);</code>. (Your implementation of C might also allow you to cast function pointers to <code>void *</code> and might also work with the <code>%p</code> format specifier without casting at all, but all that is non-standard.)"}], "answers": [{"tags": [], "owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "is_accepted": false, "score": 1, "last_activity_date": 1516733252, "last_edit_date": 1516733252, "creation_date": 1516732283, "answer_id": 48408532, "question_id": 48408488, "link": "https://stackoverflow.com/questions/48408488/array-pointer-compile-time-warning-warning-initialization-from-incompatible-p/48408532#48408532", "title": "Array Pointer compile time warning : warning: initialization from incompatible pointer type", "body": "<p>It should have been</p>\n\n<pre><code>int numbers[3] = { 101, 202, 303};\n</code></pre>\n\n<p>and</p>\n\n<pre><code>int (*p2)[3] = &amp;numbers; // Here p2 is a pointer to an array of 3 members\n</code></pre>\n\n<p>The members should be accessed like</p>\n\n<pre><code>(*p2)[0],(*p2)[1] and (*p2)[2]\n</code></pre>\n\n<p>which is eqivalent to</p>\n\n<pre><code>*(*(p2)+0),*(*(p2)+1) and *(*(p2)+2)\n</code></pre>\n\n<p>and also to</p>\n\n<pre><code>p2[0][0],p2[0][1] and p2[0][2] // Since array notation can be used to dereference pointers.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 3, "last_activity_date": 1516734136, "last_edit_date": 1516734136, "creation_date": 1516732640, "answer_id": 48408636, "question_id": 48408488, "link": "https://stackoverflow.com/questions/48408488/array-pointer-compile-time-warning-warning-initialization-from-incompatible-p/48408636#48408636", "title": "Array Pointer compile time warning : warning: initialization from incompatible pointer type", "body": "<p>I get the point which causes you this confusion. You first saw </p>\n\n<pre><code> int *p = numbers;\n</code></pre>\n\n<p>Well don't think that <code>numbers</code> is of type pointer. It is simply an array object (<code>int[3]</code>) which is converted into pointer to first element of it - that is <code>int*</code>. This is known as array decaying.</p>\n\n<p>Now you think in <code>int **p3 = &amp;numbers;</code>- <code>&amp;numbers</code> will be of type <code>int**</code>.</p>\n\n<p>Well this is where the trick is - array decaying doesn't occure in some cases - when array is used as an operand to <code>&amp;</code> operator - then it is one case like this - so it won't decay. It will be an array object whose pointer is considered which is <code>int(*)[3]</code> in this case.</p>\n\n<p>With this logic <code>int *p2=&amp;numbers</code> will also be something of which compiler will complain. The correct would be what is said here <code>int (*pp)[3] = &amp;numbers</code>. Note that print the pointers(not a function pointer) use <code>%p</code> format specifier with the argument cast to <code>void*</code>.</p>\n\n<p>The compiler tried to warn you about the pointer type mismatch. (For pointers the type to which it points to is of importance because of the pointer arithmetic is dictated by that).</p>\n\n<p>From  \u00a7<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">6.3.2.1p3</a></p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the unary <code>&amp;</code> operator, or is a string literal used to initialize an array, <em>an expression that has type \"array of type\" is converted to an expression with type \"pointer to type\" that points to the initial element of the array object and is not an lvalue.</em></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1516735089, "creation_date": 1516735089, "answer_id": 48409225, "question_id": 48408488, "link": "https://stackoverflow.com/questions/48408488/array-pointer-compile-time-warning-warning-initialization-from-incompatible-p/48409225#48409225", "title": "Array Pointer compile time warning : warning: initialization from incompatible pointer type", "body": "<p>First, always use <code>%p</code> to print pointer values:</p>\n\n<pre><code>printf( \"%p\\n\", (void *) p );\nprintf( \"%p\\n\", (void *) p1 );\n</code></pre>\n\n<p>Given the declaration</p>\n\n<pre><code>int numbers[3];\n</code></pre>\n\n<p>then the following are true:</p>\n\n<pre><code>Expression        Type        \"Decays\" to         Value\n----------        ----        -----------         -----\n   numbers        int [3]     int *               Address of first element of array\n  &amp;numbers        int (*)[3]  n/a                 Address of array (which is the same as above)\n  *numbers        int         n/a                 Value of numbers[0]\n</code></pre>\n\n<p>Except when it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operators, or is a string literal used to initialize a character array in a declaration, an <em>expression</em> of type \"array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array.  Thus, under most circumstances (such as when it's the RHS of an assignment, or a parameter to a function), the expression <code>numbers</code> will have type <code>int *</code>.  </p>\n\n<p>So how do you properly initialize <code>p2</code> and <code>p3</code>?  That depends on what you want to happen when you write <code>p2 + 1</code> or <code>p2[1]</code> and <code>p3 + 1</code> or <code>p3[1]</code>.  If you want <code>p2 + 1</code> to point to the second element in <code>numbers</code>, or if you want <code>p2[1]</code> to be equal to <code>numbers[1]</code>, then you'd write</p>\n\n<pre><code>int *p2 = numbers;\n</code></pre>\n\n<p>If you want <code>p2 + 1</code> to point to the <em>next 3-element array of <code>int</code></em> following the end of the <code>numbers</code> array, then you'd write</p>\n\n<pre><code>int (*p2)[3] = &amp;numbers;\n</code></pre>\n\n<p>Then you'd initialize <code>p3</code> as</p>\n\n<pre><code>int **p3 = &amp;p2;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int (**p3)[3] = &amp;p2;\n</code></pre>\n\n<p>based on how <code>p2</code> was declared.  </p>\n\n<p>A picture might help.  Assume the following declarations:</p>\n\n<pre><code>int numbers[3] = { 0, 1, 2 };\nint *p0 = numbers;\nint (*p1)[3] = &amp;numbers;\n</code></pre>\n\n<p>then things look something like this:</p>\n\n<pre><code>         +---+                    \nnumbers: | 0 | numbers[0] &lt;------ p0, p1\n         +---+                    \n         | 1 | numbers[1] &lt;------ p0 + 1\n         +---+\n         | 2 | numbers[2]\n         +---+\n          ...             &lt;------ p1 + 1\n</code></pre>\n\n<p>Remember that with pointer arithmetic, <code>p + 1</code> points to the next object of the pointed-to type; if <code>p</code> points to an object that's 4 bytes wide, then <code>p + 1</code> points to the object starting 4 bytes after <code>p</code>.  If <code>p</code> points to an object that's 32 bytes wide (such as a small array), then <code>p + 1</code> points to the object starting 32 bytes after <code>p</code>.  </p>\n"}], "owner": {"reputation": 1079, "user_id": 3601445, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/166972946a381e8641b7dd4de8a874a9?s=128&d=identicon&r=PG&f=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/3601445/unhandled-exception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 48408636, "answer_count": 3, "score": 1, "last_activity_date": 1516735089, "creation_date": 1516732082, "question_id": 48408488, "link": "https://stackoverflow.com/questions/48408488/array-pointer-compile-time-warning-warning-initialization-from-incompatible-p", "title": "Array Pointer compile time warning : warning: initialization from incompatible pointer type", "body": "<p>Using a simple sample that involves an array point generates the following warnings. The code codes compile and execute which also leads to questions. </p>\n\n<p>This is the int Array. \n        int numbers[3] = { 101, 202, 303};</p>\n\n<p>These 2 calls generate the warnings. </p>\n\n<pre><code>    int *p2 = &amp;numbers;\n    int **p3 = &amp;numbers;\n</code></pre>\n\n<p>The following are the Warning generated. </p>\n\n<pre><code> &gt; cc -o myApp test.c\n test.c: In function 'main':\n test.c:9:12: warning: initialization from incompatible pointer type [enabled by default]\n int *p2 = &amp;numbers;\n        ^\n test.c:10:13: warning: initialization from incompatible pointer type [enabled by default]\n int **p3 = &amp;numbers;\n         ^\n</code></pre>\n\n<p>The code used is the following :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int numbers[3] = { 101, 202, 303};\n    int size = sizeof(numbers) / sizeof (numbers[0]);\n\n    int *p = numbers;\n    int *p2 = &amp;numbers;\n    int **p3 = &amp;numbers;\n    int *p4 = &amp;numbers[0];\n\n    int *end = p + size;\n\n    printf(\"p           = 0x%d\\n\", p);\n    printf(\"p2          = 0x%d\\n\", p2);\n    printf(\"p3          = 0x%d\\n\", p3);\n    printf(\"numbers     = 0x%d\\n\", numbers);\n    printf(\"&amp;numbers    = 0x%d\\n\", &amp;numbers);\n    printf(\"numbers[0]  = 0x%d\\n\", numbers[0]);\n    printf(\"&amp;numbers[0] = 0x%d\\n\", &amp;numbers[0]);\n\n    for (; p != end; p++)\n    {\n            printf (\"0x%d\\n\", p);\n    }\n}\n</code></pre>\n\n<p>When executed, here is the output. </p>\n\n<pre><code>&gt; ./runTest\np           = 0x-207214704\np2          = 0x-207214704\np3          = 0x-207214704\nnumbers     = 0x-207214704\n&amp;numbers    = 0x-207214704\nnumbers[0]  = 0x101\n&amp;numbers[0] = 0x-207214704\n0x-207214704\n0x-207214700\n0x-207214696\n</code></pre>\n\n<p>Both p2 and p3 as well as p all point to the same address. \nI really thought using p3 as a double pointer would have resolved the Warning, but it appears not. \nWhy does p2 and p3 generate the Warnings and what is it trying to say?</p>\n"}, {"tags": ["c", "sockets", "networking", "tcp"], "comments": [{"owner": {"reputation": 4989, "user_id": 3745413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jQsNL.png?s=128&g=1", "display_name": "Ron Maupin", "link": "https://stackoverflow.com/users/3745413/ron-maupin"}, "edited": false, "score": 1, "creation_date": 1516732156, "post_id": 48408471, "comment_id": 83806139, "body": "The SYN/ACK will come back via IP, which will then send the segment to TCP based on the Protocol number in the IP header. TCP knows nothing of this, so it properly sends RST."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1516776106, "post_id": 48409131, "comment_id": 83822098, "body": "Nope, you don&#39;t need to deactivate the whole IP stack, but just the TCP part, and connect yourself to the TCP protocol access point.  But probably your approach gives you more freedom."}, {"owner": {"reputation": 1907, "user_id": 7988287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43klG.jpg?s=128&g=1", "display_name": "Zac67", "link": "https://stackoverflow.com/users/7988287/zac67"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1516778534, "post_id": 48409131, "comment_id": 83823329, "body": "Yes, becoming protocol handler is a third option - but probably the hardest one."}, {"owner": {"reputation": 33, "user_id": 9239345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a270cc7c19258a3d1d7994356a46206?s=128&d=identicon&r=PG&f=1", "display_name": "IwontDoIt", "link": "https://stackoverflow.com/users/9239345/iwontdoit"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1516780228, "post_id": 48409131, "comment_id": 83824191, "body": "@Luiscolorado Much much appreciations for your reply, Can please also tell me how to deactivate from TCP stack, Im using Linux specifically Backbox linux."}, {"owner": {"reputation": 33, "user_id": 9239345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a270cc7c19258a3d1d7994356a46206?s=128&d=identicon&r=PG&f=1", "display_name": "IwontDoIt", "link": "https://stackoverflow.com/users/9239345/iwontdoit"}, "edited": false, "score": 0, "creation_date": 1516780252, "post_id": 48409131, "comment_id": 83824207, "body": "@Zac67 Much much appreciations for your reply, Can please also tell me how to deactivate from TCP stack, Im using Linux specifically Backbox linux"}, {"owner": {"reputation": 1907, "user_id": 7988287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43klG.jpg?s=128&g=1", "display_name": "Zac67", "link": "https://stackoverflow.com/users/7988287/zac67"}, "reply_to_user": {"reputation": 33, "user_id": 9239345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a270cc7c19258a3d1d7994356a46206?s=128&d=identicon&r=PG&f=1", "display_name": "IwontDoIt", "link": "https://stackoverflow.com/users/9239345/iwontdoit"}, "edited": false, "score": 0, "creation_date": 1516794924, "post_id": 48409131, "comment_id": 83833156, "body": "@IwontDoIt Check <a href=\"https://superuser.com/questions/153559/how-can-i-clear-the-ip-address-of-ethernet-interface-without-cycling-the-interfa\" title=\"how can i clear the ip address of ethernet interface without cycling the interfa\">superuser.com/questions/153559/&hellip;</a> : <code>ip addr del 10.22.30.44&#47;16 dev eth0</code>"}, {"owner": {"reputation": 33, "user_id": 9239345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a270cc7c19258a3d1d7994356a46206?s=128&d=identicon&r=PG&f=1", "display_name": "IwontDoIt", "link": "https://stackoverflow.com/users/9239345/iwontdoit"}, "edited": false, "score": 0, "creation_date": 1516816237, "post_id": 48409131, "comment_id": 83847907, "body": "@Zac67 Well if you remove IP stack then how do you reach the destination machine?"}, {"owner": {"reputation": 1907, "user_id": 7988287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43klG.jpg?s=128&g=1", "display_name": "Zac67", "link": "https://stackoverflow.com/users/7988287/zac67"}, "edited": false, "score": 0, "creation_date": 1516817340, "post_id": 48409131, "comment_id": 83848530, "body": "You craft an entire IP packet and send it via raw Ethernet."}], "tags": [], "owner": {"reputation": 1907, "user_id": 7988287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/43klG.jpg?s=128&g=1", "display_name": "Zac67", "link": "https://stackoverflow.com/users/7988287/zac67"}, "is_accepted": false, "score": 2, "last_activity_date": 1516877456, "last_edit_date": 1592644375, "creation_date": 1516734700, "answer_id": 48409131, "question_id": 48408471, "link": "https://stackoverflow.com/questions/48408471/manually-complete-3-way-handshake/48409131#48409131", "title": "Manually Complete 3 way handshake?", "body": "<p>As Ron Maupin has pointed out, the returning SYN/ACK is processed by the local IP stack because it belongs to TCP. Since there's no half-open socket a RST is sent back.</p>\n<p>If you really do want to take over low-level TCP you'll need to either</p>\n<ol>\n<li>prevent the SYN/ACK from reaching the local IP stack (by a combination of packet capturing and filtering with pcap or similar - easiest approach)</li>\n<li>deactivate the IP stack altogether by unbinding the IP protocol from the NIC (hard - you need to emulate the full stack)</li>\n<li>or register as protocol handler for TCP (hard - you need to blend into the stack; thx Luis).</li>\n</ol>\n<h1>EDIT</h1>\n<p>To be able to unconfigure the IP stack there are two approaches (one of them is practically unfeasible, as the system, lacking tcp/ip protocols, gets to a practically unusable state):</p>\n<ul>\n<li><p>deactivate globally tcp by reconfiguring the kernel and disable completely the tcp module.  As I said before, this is normally unfeasible.</p>\n</li>\n<li><p>deactivate IP on the network card.  You can follow this procedure by not configuring any ip address on the network card, so it processes protocols by discarding packets and you can only get access to the packets by attaching to the protocol with a RAW socket.  Almost all these techniques require root access, so are hidden to normal user processes.  When you configure an ip address for a network card, you connect it to IP.  Unfortunately, it is very difficult to unconnect just TCP, as many of the original NetBSD callbacks for packet dispatching were hardcoded and much functionality and efficiency of the network code comes from being hardwired.  Only recompiling a kernel without TCP support would be a way to do this.</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 9239345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a270cc7c19258a3d1d7994356a46206?s=128&d=identicon&r=PG&f=1", "display_name": "IwontDoIt", "link": "https://stackoverflow.com/users/9239345/iwontdoit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1530, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1516877456, "creation_date": 1516732020, "question_id": 48408471, "link": "https://stackoverflow.com/questions/48408471/manually-complete-3-way-handshake", "title": "Manually Complete 3 way handshake?", "body": "<p>To be precise, I have a simple program which crafts a TCP syn packet and send it to a remote host.</p>\n\n<p>Code TCP.c: </p>\n\n<pre><code>//Data part\ndata = datagram + sizeof(struct iphdr) + sizeof(struct tcphdr);\nstrcpy(data, datagram);\n//some address resolution\nstrcpy(source_ip , sourceip);\nsin.sin_family = AF_INET;\nsin.sin_port = htons(80);\nsin.sin_addr.s_addr = inet_addr (destinationip);\n\n//Fill in the IP Header\niph-&gt;ihl = 5;\niph-&gt;version = 4;\niph-&gt;tos = 0;\niph-&gt;tot_len = sizeof (struct iphdr) + sizeof (struct tcphdr) + strlen(data);\niph-&gt;id = htonl (54321); //Id of this packet\niph-&gt;frag_off = 0;\niph-&gt;ttl = 255;\niph-&gt;protocol = IPPROTO_TCP;\niph-&gt;check = 0;      //Set to 0 before calculating checksum\niph-&gt;saddr = inet_addr ( source_ip );    //Spoof the source ip address\niph-&gt;daddr = sin.sin_addr.s_addr;\n\n//Ip checksum\niph-&gt;check = csum ((unsigned short *) datagram, iph-&gt;tot_len);\n\n//TCP Header\ntcph-&gt;source  = htons (sourceport);\ntcph-&gt;dest    = htons (destinationport);\ntcph-&gt;seq     = htonl (seqn);\ntcph-&gt;ack_seq = htonl (ackn);\ntcph-&gt;doff    = 5;  //tcp header size\ntcph-&gt;fin     = fin;\ntcph-&gt;syn     = syn;\ntcph-&gt;rst     = rst;\ntcph-&gt;psh     = push;\ntcph-&gt;ack     = ack;\ntcph-&gt;urg     = urg;\ntcph-&gt;window  = htons (win); /* maximum allowed window size */\ntcph-&gt;check   = 0; //leave checksum 0 now, filled later by pseudo header\ntcph-&gt;urg_ptr = 0;\n\n//Now the TCP checksum\npsh.source_address = inet_addr( source_ip );\npsh.dest_address = sin.sin_addr.s_addr;\npsh.placeholder = 0;\npsh.protocol = IPPROTO_TCP;\npsh.tcp_length = htons(sizeof(struct tcphdr) + strlen(data) );\n\nint psize = sizeof(struct pseudo_header) + sizeof(struct tcphdr) + strlen(data);\npseudogram = malloc(psize);\n\nmemcpy(pseudogram , (char*) &amp;psh , sizeof (struct pseudo_header));\nmemcpy(pseudogram + sizeof(struct pseudo_header) , tcph , sizeof(struct tcphdr) + strlen(data));\n\ntcph-&gt;check = csum( (unsigned short*) pseudogram , psize);\n\n//IP_HDRINCL to tell the kernel that headers are included in the packet\nint one = 1;\nconst int *val = &amp;one;\n\nif (setsockopt (s, IPPROTO_IP, IP_HDRINCL, val, sizeof (one)) &lt; 0)\n{\n    perror(\"Error setting IP_HDRINCL\");\n    exit(0);\n}\nwhile (1)\n{\n    //Send the packet\n    if (sendto (s, datagram, iph-&gt;tot_len ,  0, (struct sockaddr *) &amp;sin, sizeof (sin)) &lt; 0)\n    {\n        perror(\"sendto failed\");\n    }\n    //Data send successfully\n    else\n    {\n        printf (\"  Packet Send. Length : %d \\n\" , iph-&gt;tot_len);\n    }\nsleep(2);\n}\n</code></pre>\n\n<p>So far it work just fine, I can see wireshark in my source machine generating a syn packet and sending it to my destination machine.</p>\n\n<p>In my Destination host I have a simple server which listens on port 8000.</p>\n\n<p>What I basically Do is using this TCP packet generator I am sending a syn packet to my server and then the server responds with syn, ack, but then the source machine(above program) sends back rst. which does not complete the 3-way-handshake.</p>\n\n<p>What I want to do is to complete the 3-way-handshake with my TCP.c program.</p>\n\n<p>I would really Appreciate if you could tell me how do I do that? Do I use recv() to receive back the syn/ack and then craft a new packet as ack and responds with it or what?</p>\n\n<p>Regards :)</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "reply_to_user": {"reputation": 14006, "user_id": 2204926, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/FDbXT.png?s=128&g=1", "display_name": "Idos", "link": "https://stackoverflow.com/users/2204926/idos"}, "edited": false, "score": 0, "creation_date": 1516731260, "post_id": 48408235, "comment_id": 83805646, "body": "idos please suggest one"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516731264, "post_id": 48408235, "comment_id": 83805651, "body": "In C you don&#39;t copy a string like that - use <code>strcpy</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1516731307, "post_id": 48408235, "comment_id": 83805675, "body": "<code>char s[][6]</code> is a two-dimensional array of type <code>char</code>.  You are trying to treat it as an array of <code>char *</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1516731351, "post_id": 48408235, "comment_id": 83805698, "body": "<code>s[1]=&quot;lucky&quot;;</code> will fail with a compiler error. It attempts to place a pointer in <code>s[1]</code>, which is not a pointer variable."}, {"owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 2, "creation_date": 1516732022, "post_id": 48408235, "comment_id": 83806057, "body": "Assignment != Initialization"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516731585, "post_id": 48408280, "comment_id": 83805805, "body": "@AshishDogra the C syntax can be misleading. <code>char message[] = &quot;Hallo World!&quot;</code> is used to initialise the variable as a part of its definition. However <code>char message[20]; message = &quot;Hallo World!&quot;</code> is illegal."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516732047, "post_id": 48408280, "comment_id": 83806073, "body": "Rather than saying that intialization is a special case, I much prefer to say that <i>initialization is not assignment</i>, which indeed is consistent with what the standard has to say about it."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "edited": false, "score": 0, "creation_date": 1516732749, "post_id": 48408280, "comment_id": 83806476, "body": "@Nitin.: 2d array is an array of array...now think if I am wrong in what I said...<code>s[0]</code> is an array."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516733488, "post_id": 48408280, "comment_id": 83806905, "body": "So yes, @coderredoc.  It would be more correct to say the left-hand side of an assignment expression is among those few contexts where expressions of array type do not decay to pointers, and that expressions of array type furthermore are not modifiable lvalues.  (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1\" rel=\"nofollow noreferrer\">C2011 6.3.2.1/1-2</a>)  Thus <code>s[1]</code> appearing on the LHS of an assignment expression is <i>not</i> a modifiable lvalue.  It&#39;s not about whether the expression is a bare identifier."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516733640, "post_id": 48408280, "comment_id": 83806981, "body": "@JohnBollinger.: Regarding this - nice point but even if it decayed it would not be an <code>lvalue</code> so we can&#39;t keep it in left hand of <code>=</code>. Confirm. (6.3.2.1p3)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516733900, "post_id": 48408280, "comment_id": 83807119, "body": "@coderredoc, the fact that it does not decay and that it is not an lvalue are not really separable.  They are two related facets of the way C handles arrays.  They also go together with the fact that an object of array type appearing on the LHS of an assignment violates a constraint in the definition of assignment."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516733979, "post_id": 48408280, "comment_id": 83807158, "body": "@JohnBollinger.: Yep that&#39;s true - it is really so nice how standard is supporting each part - Do you mind if I add your initial comment? (With proper reference)"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516734665, "post_id": 48408280, "comment_id": 83807575, "body": "@JohnBollinger.: Is it alright? to put it with proper reference that you did comment it? Is it ok?"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516735079, "post_id": 48408280, "comment_id": 83807813, "body": "@JohnBollinger.: I have added it in my answer. If there is any issue regarding that please comment - I will rollback. Thanks for the interesting discussion."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516735528, "post_id": 48408280, "comment_id": 83808081, "body": "@JohnBollinger.: Also I guess my content is much more closer to the standard explanation. Hope it gives DVer a reason to retract the DV."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516739285, "post_id": 48408280, "comment_id": 83810128, "body": "@coderredoc, sorry to be slow to respond.  I have no objection to you incorporating text from these comments into your answer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565405249, "post_id": 48408280, "comment_id": 101355025, "body": "&quot;left-hand side of an assignment expression is among those few contexts where expressions of array type do not decay to pointers,&quot; is incorrect. That IS a decay context. See C11 6.3.2.1/3.  You mention 6.3.2.1/1-2 but those paragraphs do not apply to this situation."}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565410644, "post_id": 48408280, "comment_id": 101355597, "body": "@M.M. Hey long time...Hope you are doing well. Thanks for the reply. Yes I have mentioned that but I guess I can remove the whole footer paragraph which is lacking the context in this case. What do you say? Feel free to suggest."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565414156, "post_id": 48408280, "comment_id": 101355934, "body": "@user2736738 removing that whole paragraph seems fine to me since it&#39;s wrong"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1565449373, "post_id": 48408280, "comment_id": 101362508, "body": "@M.M.: Sounds good. Done. Thanks for your time."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": true, "score": 11, "last_activity_date": 1565449351, "last_edit_date": 1565449351, "creation_date": 1516731258, "answer_id": 48408280, "question_id": 48408235, "link": "https://stackoverflow.com/questions/48408235/why-is-this-c-string-assignment-illegal/48408280#48408280", "title": "Why is this C-string assignment illegal?", "body": "<pre><code>s[1]=\"lucky\"; //is illegal\n</code></pre>\n\n<p>because array names are not a modifiable lvalue. As a result they can't appear on the left of the assignment.</p>\n\n<p>Initialization is not assignment. It is during that initialization, when string literals don't decay into pointers, and rather the value of the literal is copied into memory which allow us to modify the content of it. (The first one you showed is an example of this).</p>\n\n<p>From standard: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p14\" rel=\"nofollow noreferrer\">6.7.9.p14</a></p>\n\n<blockquote>\n  <p>An array of character type may be initialized by a character string literal or UTF-8 string literal, optionally enclosed in braces. Successive bytes of the string literal (including the terminating null character if there is room or if the array is of unknown size) initialize the elements of the array.</p>\n</blockquote>\n\n<p>If you need to copy strings then you will have to use <code>strcpy</code>,<code>memcpy</code> etc.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516732215, "post_id": 48408349, "comment_id": 83806167, "body": "No, this is just wrong.  C allows objects of structure types, union types, and enum types to appear on the left-hand side of an assignment operator.  None of these are built-in types.  It&#39;s actually quite specific: C explicitly and specifically forbids objects of array types from appearing on the left-hand side of an assignment."}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516732467, "post_id": 48408349, "comment_id": 83806312, "body": "@JohnBllinger: Thanks for your comment, I modified my answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1516733127, "post_id": 48408349, "comment_id": 83806704, "body": "No, you&#39;re still missing the point.  It is not that only specific types are allowed to be used with the assignment operator.  It is that objects of array types -- exclusively those, among all the type families supported by C -- cannot under any circumstances appear on the LHS of an assignment.  Additionally, characterizing it in terms of &quot;luxury&quot; or absence thereof is unwelcome, especially when set up as a contrast with other languages.  Let&#39;s not engage in language wars, please."}, {"owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516733765, "post_id": 48408349, "comment_id": 83807054, "body": "@JohnBillinger: I welcome your comments :-)"}], "tags": [], "owner": {"reputation": 135, "user_id": 5038027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHzGO.jpg?s=128&g=1", "display_name": "Nitin", "link": "https://stackoverflow.com/users/5038027/nitin"}, "is_accepted": false, "score": -4, "last_activity_date": 1516732443, "last_edit_date": 1516732443, "creation_date": 1516731469, "answer_id": 48408349, "question_id": 48408235, "link": "https://stackoverflow.com/questions/48408235/why-is-this-c-string-assignment-illegal/48408349#48408349", "title": "Why is this C-string assignment illegal?", "body": "<p>The simple answer is that 'C' doesn't provide that much luxury to programmers. Assignment operator in C only copies specific types from from right hand side to left hand side, e.g. <code>int</code>, <code>char</code>, <code>struct</code> etc. so thus you can use <code>=</code> operator for <code>char</code> but not for <code>char*</code> or <code>char[][6]</code> etc.</p>\n\n<p>Other programming languages e.g. C++ can provide such luxury because you can overload the <code>=</code>-operator. There are some programming languages which support such operations by default e.g. JavaScript. I hope it clarifies your doubt.</p>\n"}], "owner": {"reputation": 583, "user_id": 9090981, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8edd1343a0d8e8997f6f62599b02e83?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish Dogra", "link": "https://stackoverflow.com/users/9090981/ashish-dogra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 1, "closed_date": 1518257336, "accepted_answer_id": 48408280, "answer_count": 2, "score": 2, "last_activity_date": 1565449351, "creation_date": 1516731096, "last_edit_date": 1516731619, "question_id": 48408235, "link": "https://stackoverflow.com/questions/48408235/why-is-this-c-string-assignment-illegal", "closed_reason": "Duplicate", "title": "Why is this C-string assignment illegal?", "body": "<p>CASE 1: <code>char s[][6]={\"Hello\",\"world\"};</code> \nin this case, a static array is allocated in read-only memory and from there the elements are copied to the array.\nand in case 2.</p>\n\n<p>CASE 2: <code>char* s= \"hello world\";</code> will place it in read-only memory.</p>\n\n<p>so my question is why </p>\n\n<pre><code>char s[][6]={\"Hello\",\"world\"};\ns[1]=\"lucky\"; //is illegal\n</code></pre>\n\n<p>because if elements are being copied from read-only memory then why this statement <code>s[1]=\"lucky\";</code> can't be copied from read-only memory to array because an array is also allocated for this string literal and from there, elements are copied to s[1].\nI have read many answers, and all are telling what's the difference but no one tells why? please explain as I am a beginner.</p>\n"}, {"tags": ["c", "linux", "shared"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516731205, "post_id": 48407858, "comment_id": 83805618, "body": "The &quot;U&quot; at the beginning of those lines of <code>nm</code>&#39;s output says that the symbols are <i>undefined</i> in that library, though they are referenced by it, else they would not be listed at all."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516731370, "post_id": 48407858, "comment_id": 83805707, "body": "Note also that although those symbol names are unusual, they are <i>not</i> numeric, not even in a C-style hexadecimal constant sense.  The first character of each is a capital Latin letter &quot;O&quot;, not a zero (0)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516731706, "post_id": 48407858, "comment_id": 83805874, "body": "Evidently, the library that actually defines the symbols in question is not listed as a NEEDED library of libMylibrary.so.  I can&#39;t speak to how that might have happened, because you&#39;ve not presented any build information.  You <i>do</i> say that the lib is dependent on &quot;other FlexNet Publisher Libraries&quot;, however, so a good guess would be that one or more of those defines the symbols.  One solution would be to specify the appropriate one in the link options for the executable."}, {"owner": {"reputation": 75, "user_id": 1472972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7b5ce040242923532450b5b7b97b5d90?s=128&d=identicon&r=PG", "display_name": "user1472972", "link": "https://stackoverflow.com/users/1472972/user1472972"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516740483, "post_id": 48407858, "comment_id": 83810729, "body": "It is infact 0x (zero). The text didn&#39;t quite copy right here. I compiled the same code  to be used from Java. I added JNI declarations to do so. That library compiled fine. I could also load that library from eclipse and run it successfully. Exact same linking options to the FlexNet libraries were used. So wondering why is the pure &#39;C&#39; library is throwing runtime errors."}, {"owner": {"reputation": 75, "user_id": 1472972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7b5ce040242923532450b5b7b97b5d90?s=128&d=identicon&r=PG", "display_name": "user1472972", "link": "https://stackoverflow.com/users/1472972/user1472972"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516740505, "post_id": 48407858, "comment_id": 83810742, "body": "Missing symbol &#39;Ox410ef0495302ac72&#39; required by &#39;/home/user/workspaceforC/libMylibrary.so&#39;   just does not give enough information about what I need to fix."}, {"owner": {"reputation": 75, "user_id": 1472972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7b5ce040242923532450b5b7b97b5d90?s=128&d=identicon&r=PG", "display_name": "user1472972", "link": "https://stackoverflow.com/users/1472972/user1472972"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516743876, "post_id": 48407858, "comment_id": 83812363, "body": "Are these really symbols or just memory addresses Ox410ef0495302ac72"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516803481, "post_id": 48407858, "comment_id": 83838749, "body": "I&#39;m having trouble believing that your mysterious symbols start with the digit zero, because such a symbol is not a valid identifier in C.  Moreover, &quot;The text didn&#39;t quite copy right&quot; seems unlikely if you used copy&amp;paste as you ought to have done, nor even if you unwisely transcribed by hand.  But none of that alters anything else I already said.  Your library does not provide definitions of the symbols, whatever they are, so link in the one that does."}], "owner": {"reputation": 75, "user_id": 1472972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7b5ce040242923532450b5b7b97b5d90?s=128&d=identicon&r=PG", "display_name": "user1472972", "link": "https://stackoverflow.com/users/1472972/user1472972"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516729558, "creation_date": 1516729558, "question_id": 48407858, "link": "https://stackoverflow.com/questions/48407858/shared-library-missing-symbol", "title": "shared library Missing symbol", "body": "<p>I have C code for which I want to compile a shared library. This shared library is dependent on other FlexNet Publisher Libraries. I do not get any errors while compiling the library but during runtime I get </p>\n\n<p>Missing symbol 'Ox410ef03750728897' required by '/home/user/workspaceforC/libMylibrary.so'</p>\n\n<pre><code>Missing symbol 'Ox410ef0495302ac72' required by '/home/user/workspaceforC/libMylibrary.so'\n</code></pre>\n\n<p>When I run nm libMylibrary.so I can see both the symbols:</p>\n\n<p>U Ox410ef03750728897</p>\n\n<p>U Ox410ef0495302ac72</p>\n\n<p>It does not show me which library they are missing from.</p>\n\n<p>I am clueless as to what is missing while compiling/linking.</p>\n\n<p>I have the same code which I made JNI compatible and compiled to the shared library using the same makefile. I can successfully load it and run it in eclipse for Java.</p>\n\n<p>Please advice. What could U with just a memory address mean and how can I resolve it?\nI did a readelf and it shows:</p>\n\n<p>0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]</p>\n\n<p>0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]</p>\n\n<p>0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]</p>\n\n<p>LD_LIBRARY_PATH is set to /lib64 where all these 3 libraries are located.</p>\n\n<p>Please advice.</p>\n"}, {"tags": ["c", "pointers", "scanf"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1516729312, "post_id": 48407719, "comment_id": 83804588, "body": "Apart from removing the <code>const</code> qualifier to satisfy the compiler, <code>line</code> and <code>info</code> are both <i>uninitialised variables</i>. They don&#39;t point to anything specific. So <code>sscanf(line, &quot;%s&quot;, info);</code> will not be able to do anything sensible, it is <i>undefined behaviour</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1516729564, "post_id": 48407719, "comment_id": 83804718, "body": "<i>Why</i> do you &quot;need <code>*info</code> to be a const char&quot;?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1516729564, "post_id": 48407719, "comment_id": 83804719, "body": "&quot;<i>I need <code>*info</code> to be a const char</i>&quot; - no, you need it to be a suitably-long <b>array</b> of  <b>non-<code>const</code></b> char, or a pointer to a suitably-large,  dynamically-allocated, <b>non-<code>const</code></b> space.  Whether dynamically allocated or not, the contents of the space cannot be <code>const</code> because you need to modify them (via <code>sscanf</code>)."}, {"owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516730123, "post_id": 48407719, "comment_id": 83805007, "body": "@WeatherVane <code>*info</code> should be a const char because the function insert() needs a const char parameter"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516730136, "post_id": 48407719, "comment_id": 83805014, "body": "After the question edit, <code>info</code> still needs to point to allocated memory. When <code>sscanf</code> derefences the <code>NULL</code> pointer it will crash."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1516730364, "post_id": 48407719, "comment_id": 83805146, "body": "It is acceptable to supply a non-const argument to a <code>const</code> parameter, but not the other way round."}, {"owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1516730477, "post_id": 48407719, "comment_id": 83805221, "body": "@WeatherVane Okay! How should I allocate memory without knowing how big <code>info</code> is?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1516730978, "post_id": 48407719, "comment_id": 83805504, "body": "The question is getting too broad - this is not a tutorial service! You could use a fixed length array longer than any input you expect, such as <code>char info[1000];</code> and restrict the input with <code>sscanf(line, &quot;%999s&quot;, info);</code> or you could follow up the many similar questions on SO such as <a href=\"https://stackoverflow.com/questions/16870485/how-can-i-read-an-input-string-of-unknown-length\">How can I read an input string of unknown length?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1516734394, "creation_date": 1516734394, "answer_id": 48409051, "question_id": 48407719, "link": "https://stackoverflow.com/questions/48407719/c-reading-const-char-into-a-variable-in-sscanf/48409051#48409051", "title": "c: reading const char* into a variable in sscanf?", "body": "<p>You have some problems with your code and with what you want.</p>\n\n<p>A <code>const char* string;</code> declares a pointer to <code>char</code>. You can change the location of\nwhere your pointer is pointing, you cannot change the contents of the memory\npointed to by the pointer.</p>\n\n<pre><code>const char *string = \"Hello\";\nchar line[] = \"a b c\";\n\nstring = \"World\"; // legal\nstring[0] = 'w';  // illegal\n\nstring = line;    // legal\nstring[0] = 'A';  // illegal\n</code></pre>\n\n<p>So using a <code>const char*</code> for reading input with <code>scanf</code> &amp; Co is pointless.</p>\n\n<blockquote>\n  <p>When I change to <code>char *info</code> instead of <code>const char</code>, I get the error:</p>\n</blockquote>\n\n<p>Did you mean change from <code>char *info</code> to <code>const char</code>? That is even worse,\n<code>info</code> could hold <strong>one character only</strong>.</p>\n\n<p>Please don't ignore the compiler warnings and don't silence them. The compiler\nis telling</p>\n\n<blockquote>\n  <p>warning: variable 'info' is uninitialized when used here</p>\n</blockquote>\n\n<hr>\n\n<p>You also are doing</p>\n\n<pre><code>const char *info;\n...\nsscanf(line, \"%s\", info);\n</code></pre>\n\n<p>Let's forget about the <code>const</code> for a moment, let's pretend it's not there.\n<code>info</code> is an uninitialzed pointer, that means it points to nowhere in\nparticular. Passing it to <code>sscanf</code> yields undefined behaviour, because <code>sscanf</code>\nis trying to write into a memory location where you may or may not have access\nto.</p>\n\n<p>How to fix it:</p>\n\n<pre><code>char info[100];\n...\nsscanf(line, \"%s\", info);\n</code></pre>\n\n<p><code>info</code> is now an array of <code>char</code> that can hold strings with maximal length of 99\ncharacters.</p>\n\n<p>Note that having a <code>const</code> pointer where you want to save input from the user,\nmakes no sense, it cannot be constant by design, because the user input <strong>will</strong>\nmodify it.</p>\n\n<p>It is perfectly fine to do the other way round: to use a <code>const char*</code> for a\nnon-cost <code>char*</code>, useful when you need to call a function that takes a <code>const char*</code> for an argument:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid foo(const char *txt)\n{\n    if(txt == NULL)\n        return;\n\n    printf(\"The text passed is: \\\"%s\\\"\\n\", txt);\n}\n\nint main(void)\n{\n    char line[] = \"Hello world\";\n    foo(line);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9174523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d50839cf0362cfb81fffa4aedcefdf1?s=128&d=identicon&r=PG&f=1", "display_name": "novel", "link": "https://stackoverflow.com/users/9174523/novel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516734394, "creation_date": 1516729050, "last_edit_date": 1516729895, "question_id": 48407719, "link": "https://stackoverflow.com/questions/48407719/c-reading-const-char-into-a-variable-in-sscanf", "title": "c: reading const char* into a variable in sscanf?", "body": "<p>I'm trying to scan a string/*char into a variable and pass it into a function, but I get the error \"<code>format specifies type 'char *' but the argument has type 'const char *'</code>\". I need <code>*info</code> to be a const char, but if I change that, I get other errors. </p>\n\n<p>How would I scan in the <code>const char *info</code> correctly into <code>sscanf()</code>? </p>\n\n<pre><code>int main(int argc, char** argv) {\n    blk *block;\n    char *line;\n    const char *info;\n\n    block = block_new();\n\n    printf(\"insert info\");\n\n    while ( (line = readline()) != NULL) {\n        sscanf(line, \"%s\", info);\n        insert(block, info);\n        free(line);   \n    }     \n}\n</code></pre>\n\n<p>insert: <code>insert(blk *block, const char *info)</code></p>\n\n<p>When I change to <code>char *info</code> instead of <code>const char</code>, I get the error: </p>\n\n<pre><code>warning: variable 'info' is uninitialized when used here\nsscanf(line, \"%s\", info);\n\nnote: initialize the variable 'info' to silence this warning\n    char *info; = NULL\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1819, "user_id": 6537157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bc49ba8e3aa95732b23486388b79110?s=128&d=identicon&r=PG&f=1", "display_name": "akop", "link": "https://stackoverflow.com/users/6537157/akop"}, "edited": false, "score": 0, "creation_date": 1516728715, "post_id": 48407597, "comment_id": 83804259, "body": "Coloring is for the keyword <code>int</code>."}, {"owner": {"reputation": 787, "user_id": 7714006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bf23fe02b176b9ec4b72f65570e0b5?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Rawat", "link": "https://stackoverflow.com/users/7714006/aditi-rawat"}, "edited": false, "score": 1, "creation_date": 1516728723, "post_id": 48407597, "comment_id": 83804268, "body": "What according to you <code>printf(&quot;%d&quot;, minus);</code> does???"}, {"owner": {"reputation": 1819, "user_id": 6537157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bc49ba8e3aa95732b23486388b79110?s=128&d=identicon&r=PG&f=1", "display_name": "akop", "link": "https://stackoverflow.com/users/6537157/akop"}, "edited": false, "score": 2, "creation_date": 1516728870, "post_id": 48407597, "comment_id": 83804351, "body": "You priting the adress of <code>minus</code>. And you have to write <code>printf(..., minus(a, b))</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1516729115, "post_id": 48407597, "comment_id": 83804476, "body": "What you really need is a tutorial in C. Or at least read whatever material you have for whatever kind of class/course/lecture you are taking. There should have been a chapter on calling functions recently. You seem to have skipped that."}], "answers": [{"comments": [{"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1516729789, "post_id": 48407629, "comment_id": 83804838, "body": "@EOF.: Nope you can&#39;t do that. I edited. There is a way to print fucntion pointer which is supposedly to using a <code>unsigned char*</code> and print byte by byte. I guess I would take the day off...."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1516729895, "post_id": 48407629, "comment_id": 83804890, "body": "@EOF: Technically, that is in C 2011 clause 4, paragraph 6: \u201cA conforming implementation may have extensions (including additional library functions), provided they do not alter the behavior of any strictly conforming program.\u201d :-) Which would make this a conforming program by paragraph 7. So it is \u201callowed,\u201d just not \u201cdefined.\u201d"}, {"owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1516730178, "post_id": 48407629, "comment_id": 83805032, "body": "@EricPostpischil.: Thanks for the explanation reference."}], "tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 1, "last_activity_date": 1516729772, "last_edit_date": 1516729772, "creation_date": 1516728726, "answer_id": 48407629, "question_id": 48407597, "link": "https://stackoverflow.com/questions/48407597/write-a-function-receives-two-arguments-and-returns-the-difference/48407629#48407629", "title": "Write a function receives two arguments and returns the difference", "body": "<p>You have undefined behavior here printing the function pointer using <code>%d</code> format specifier. (You have used the wrong format specifier that's why the Undefined behavior).</p>\n\n<p>And the most probable way you would like is to <code>printf(\"%d\", minus(a,b));</code>. You wanted to print the result of the subtraction not the function pointer itself.</p>\n"}, {"comments": [{"owner": {"reputation": 647, "user_id": 8962612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dc56ccabc395489868fc9ebb49f46a?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir", "link": "https://stackoverflow.com/users/8962612/yasir"}, "edited": false, "score": 0, "creation_date": 1516730988, "post_id": 48407766, "comment_id": 83805507, "body": "Sorry for the typeo in the variable declaration, made the correction"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516731036, "post_id": 48407766, "comment_id": 83805526, "body": "I considered <code>d</code> better, in order to minimise possible confusion."}, {"owner": {"reputation": 647, "user_id": 8962612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dc56ccabc395489868fc9ebb49f46a?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir", "link": "https://stackoverflow.com/users/8962612/yasir"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516731191, "post_id": 48407766, "comment_id": 83805610, "body": "Make sense, updated accordingly"}], "tags": [], "owner": {"reputation": 647, "user_id": 8962612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47dc56ccabc395489868fc9ebb49f46a?s=128&d=identicon&r=PG&f=1", "display_name": "Yasir", "link": "https://stackoverflow.com/users/8962612/yasir"}, "is_accepted": true, "score": 0, "last_activity_date": 1516731150, "last_edit_date": 1516731150, "creation_date": 1516729241, "answer_id": 48407766, "question_id": 48407597, "link": "https://stackoverflow.com/questions/48407597/write-a-function-receives-two-arguments-and-returns-the-difference/48407766#48407766", "title": "Write a function receives two arguments and returns the difference", "body": "<p>You are missing an assignment</p>\n\n<pre><code>int minus(int a,int b)\n{\n    int c = a - b;\n    return c;\n}\nint main()\n{\n    int a = 4; int b = 5;\n    int d = minus(a,b);\n    printf(\"%d\", d);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1516733117, "post_id": 48407848, "comment_id": 83806699, "body": "&quot;int&quot; is blue but a and b are grey&quot; \u2013 OP doesn&#39;t seem to know the difference between types and variables. I find the fact that <code>a</code> and <code>b</code> are grey but <code>c</code> is <i>black</i> much more interesting. As you say, it is designed to help the (not-totally n00b) programmer. Now that <i>is</i> a pretty useful function!"}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1516729653, "last_edit_date": 1516729653, "creation_date": 1516729527, "answer_id": 48407848, "question_id": 48407597, "link": "https://stackoverflow.com/questions/48407597/write-a-function-receives-two-arguments-and-returns-the-difference/48407848#48407848", "title": "Write a function receives two arguments and returns the difference", "body": "<ol>\n<li><p><code>a</code> and <code>b</code> are grey because the editor is automatically coloring the code to help illustrate the program syntax. This may look funny at first, but, over time, your brain will become accustomed to it, and things that are the wrong colors will stand out. This will help you find mistakes in your program\u2014when you make a mistake typing, something that should be a keyword will be colored like a parameter name, and you may notice it is the wrong color and take a closer look at what you typed.</p></li>\n<li><p>In <code>printf(\"%d\", minus);</code>, the <code>minus</code> is just the function. It is not the value returned by the function. To print the value returned by the function, use <code>printf(\"%d\", minus(a, b));</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8857712, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bJSBxkw-WVE/AAAAAAAAAAI/AAAAAAAAADk/3EEqhfaSlF4/photo.jpg?sz=128", "display_name": "ANAND TUNDELKAR", "link": "https://stackoverflow.com/users/8857712/anand-tundelkar"}, "is_accepted": false, "score": -2, "last_activity_date": 1516736309, "creation_date": 1516736309, "answer_id": 48409551, "question_id": 48407597, "link": "https://stackoverflow.com/questions/48407597/write-a-function-receives-two-arguments-and-returns-the-difference/48409551#48409551", "title": "Write a function receives two arguments and returns the difference", "body": "<p>you called the function minus() but you did not take the value returned by function in any variable so when you try to print minus then it will return the pointer value of function. so to get the correct answer hold the return value in variable and then print it         <code>int c = minus(a,b);\n    printf(\"%d\", c);</code> or you can call the minus function inside the print function like this <code>printf(\"%d\", minus());</code> as a beginner i will suggest you to implement the first suggestion it will increase the capacity to use statements in c.</p>\n"}], "owner": {"reputation": 27, "user_id": 9249261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b546e9a3ab4b763c75a5b6d58fad89b3?s=128&d=identicon&r=PG&f=1", "display_name": "Yifan", "link": "https://stackoverflow.com/users/9249261/yifan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "closed_date": 1516743270, "accepted_answer_id": 48407766, "answer_count": 4, "score": -5, "last_activity_date": 1516736309, "creation_date": 1516728620, "last_edit_date": 1516728838, "question_id": 48407597, "link": "https://stackoverflow.com/questions/48407597/write-a-function-receives-two-arguments-and-returns-the-difference", "closed_reason": "Needs details or clarity", "title": "Write a function receives two arguments and returns the difference", "body": "<p>Write a C-program that calls a function minus(). This function receives two arguments and returns the difference (regular subtraction, not absolute). This difference should be printed on screen. </p>\n\n<p>My code is:</p>\n\n<pre><code>int minus(int a,int b)\n{\n    int c = a - b;\n    return c;\n}\nint main()\n{\n    int a = 4; int b = 5;\n    minus(a,b);\n    printf(\"%d\", minus);\n    return 0;\n}\n</code></pre>\n\n<p>I have two questions:</p>\n\n<p>1.why a and b in </p>\n\n<pre><code>int minus(int a,int b)\n</code></pre>\n\n<p>are grey in Visual Studio? \"int\" is blue but a and b are grey.\n<a href=\"https://i.stack.imgur.com/p0lWH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p0lWH.png\" alt=\"enter image description here\"></a>\n2. I got this result but it should be -1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uDGHy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uDGHy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Could someone help me please</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 3, "creation_date": 1516726926, "post_id": 48407104, "comment_id": 83803141, "body": "Old C had no boolean type, so all boolean arithmetic was done with <code>int</code>. Is that what&#39;s putting you off?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1516727179, "post_id": 48407104, "comment_id": 83803316, "body": "i doubt <code>foo-&gt;delay</code> is int"}], "answers": [{"tags": [], "owner": {"reputation": 28550, "user_id": 3796113, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/960488e3bdc769466c183faaf102f2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user2736738", "link": "https://stackoverflow.com/users/3796113/user2736738"}, "is_accepted": false, "score": 4, "last_activity_date": 1516728034, "last_edit_date": 1516728034, "creation_date": 1516726920, "answer_id": 48407150, "question_id": 48407104, "link": "https://stackoverflow.com/questions/48407104/explanation-of-shortcuts-in-c/48407150#48407150", "title": "Explanation of shortcuts in C", "body": "<p>You will set the variable <code>enabled</code> to <code>1</code> if <code>val</code> is equal to <code>0</code> and <code>0</code> otherwise. </p>\n\n<p><code>sync</code> will be equal to <code>1</code> if <code>param</code> is non-zero and in case it is <code>0</code> then it will be <code>1</code> if <code>foo-&gt;delay</code> is <code>NULL</code> else it will be <code>0</code>.</p>\n\n<p>From <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.9p3\" rel=\"nofollow noreferrer\">standard</a>  \u00a76.5.9p3 backing up what I said:</p>\n\n<blockquote>\n  <p>The <code>==</code> (equal to) and <code>!=</code> (not equal to) operators are analogous to the relational operators except for their lower precedence.108) <em>Each of the operators yields 1 if the specified relation is true and 0 if it is false. The result has type int.</em> For any pair of operands, exactly one of the relations is true.</p>\n</blockquote>\n\n<p>Also in case <code>||</code> there is standard saying the evaluation logic: from  \u00a76.5.14</p>\n\n<blockquote>\n  <p>Unlike the bitwise | operator, the <code>||</code> operator guarantees left-to-right evaluation; if the second operand is evaluated, there is a sequence point between the evaluations of the first and second operands. <em>If the first operand compares unequal to 0, the second operand is not evaluated.</em></p>\n</blockquote>\n\n<p>Also in the same section the rule which dictates what will be the result if <code>param</code> is non-zero.</p>\n\n<blockquote>\n  <p>The <code>||</code> operator shall yield <code>1</code> if either of its operands compare unequal to <code>0</code>; otherwise, it yields <code>0</code>. The result has type <code>int</code>.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 6, "last_activity_date": 1516727462, "last_edit_date": 1516727462, "creation_date": 1516727050, "answer_id": 48407185, "question_id": 48407104, "link": "https://stackoverflow.com/questions/48407104/explanation-of-shortcuts-in-c/48407185#48407185", "title": "Explanation of shortcuts in C", "body": "<pre><code>int enabled = val == 0;\n</code></pre>\n\n<p>read as </p>\n\n<pre><code>int enabled = (val == 0);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>(val == 0)\n</code></pre>\n\n<p>will be either 0 or non zero if val is 0 or not. <code>enabled</code> will then be initialized with that value</p>\n\n<p>Equivalent to:</p>\n\n<pre><code>int enabled;\nif(val == 0)\n{\n    enabled = 1;\n}\nelse\n{\n    enabled = 0;\n}\n</code></pre>\n\n<p>now you do that same analysis on the second one</p>\n"}, {"tags": [], "owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "is_accepted": false, "score": 2, "last_activity_date": 1516727460, "creation_date": 1516727460, "answer_id": 48407286, "question_id": 48407104, "link": "https://stackoverflow.com/questions/48407104/explanation-of-shortcuts-in-c/48407286#48407286", "title": "Explanation of shortcuts in C", "body": "<p>C only adopted a true boolean type from C++ with C99, though it named it <code>_Bool</code> so it wouldn't conflict with pre-existing code and provided the header <code>&lt;stdbool.h&gt;</code> to make it nicer.<br>\nThe prior convention that only <code>0</code> is considered falsey (a literal zero, which in a pointer-context is a null-pointer), and anything else truthy was not changed. (That's the reverse to how command shells do it by the way.)</p>\n\n<p>All boolean operators and conversion from <code>_Bool</code> use canonical values of <code>0</code> and <code>1</code>.</p>\n\n<p>That should be enough history and details to understand the code.</p>\n"}], "owner": {"reputation": 312, "user_id": 7712908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc8ff5e444c5ef577c7c14adf34dd362?s=128&d=identicon&r=PG&f=1", "display_name": "blackbeard", "link": "https://stackoverflow.com/users/7712908/blackbeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 48407185, "answer_count": 3, "score": -2, "last_activity_date": 1517559263, "creation_date": 1516726787, "last_edit_date": 1517559263, "question_id": 48407104, "link": "https://stackoverflow.com/questions/48407104/explanation-of-shortcuts-in-c", "title": "Explanation of shortcuts in C", "body": "<p>Can someone explain what exactly is happening in these two statements listed below:</p>\n\n<pre><code>1) int enabled = val == 0; //val is an int\n\n2) int sync = param || (foo-&gt;delay == NULL); //param and delay is both int\n</code></pre>\n"}, {"tags": ["c", "fileparsing"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1516726717, "post_id": 48407064, "comment_id": 83803003, "body": "Don&#39;t say &quot;Doesn&#39;t work&quot;, it&#39;s really, <i>really</i> irritating. Instead say what it <i>does</i> do that you don&#39;t want it to, or more specifically, what it isn&#39;t doing that you <i>do</i> want it to."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1516727246, "post_id": 48407064, "comment_id": 83803353, "body": "Using <code>float</code> rather than <code>double</code> will throw away half the digits shown.  You get 6-7 decimal digits with <code>float</code>; you get 15+ digits with <code>double</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 5, "creation_date": 1516727338, "post_id": 48407064, "comment_id": 83803416, "body": "As to your main question: use <code>fgets()</code> to read lines and then <code>sscanf()</code> to parse the line that is read.  This will avoid confusion.  When the input is line-based but not regular enough, don&#39;t use <code>fscanf()</code> and family to read the data \u2014 they file-reading <code>scanf()</code> functions don&#39;t care about newlines, even when you do.  (Note that <code>sscanf()</code> will return either 3 or 4, indicating whether there was a string at the end of a line or not.  Always test the return value from <code>scanf()</code> and friends \u2014 but do so carefully.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1516728305, "post_id": 48407064, "comment_id": 83804023, "body": "Me, I would not use any of the *scanf family to solve this sort of problem.  I would read whole lines using <code>fgets</code>, then split each line up into tab-separated fields.  Splitting up a line into fields (based on delimiter(s)) is straightforward -- you can use <code>strtok</code> or <code>strsep</code> for this.  (Or see <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx10h.html\" rel=\"nofollow noreferrer\">eskimo.com/~scs/cclass/notes/sx10h.html</a> .)"}, {"owner": {"reputation": 1435, "user_id": 2606411, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/28ZBU.jpg?s=128&g=1", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/2606411/swapnil"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1516769982, "post_id": 48407064, "comment_id": 83819921, "body": "@tadman Sorry for the wrong choice of words. Edited the question! Thanks for pointing out :)"}, {"owner": {"reputation": 1435, "user_id": 2606411, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/28ZBU.jpg?s=128&g=1", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/2606411/swapnil"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516774423, "post_id": 48407064, "comment_id": 83821347, "body": "@JonathanLeffler Thank you for the help. It worked for me. If you can put it as an answer, I can mark it as correct. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1435, "user_id": 2606411, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/28ZBU.jpg?s=128&g=1", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/2606411/swapnil"}, "edited": false, "score": 0, "creation_date": 1516777340, "post_id": 48416116, "comment_id": 83822674, "body": "Very well explained.. Thank you!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1516775354, "creation_date": 1516775354, "answer_id": 48416116, "question_id": 48407064, "link": "https://stackoverflow.com/questions/48407064/read-tab-separated-content-line-by-line-with-last-column-empty-string/48416116#48416116", "title": "Read tab separated content line by line with last column empty string", "body": "<p>Using <code>float</code> rather than <code>double</code> will throw away about half the digits shown. You get 6-7 decimal digits with <code>float</code>; you get 15+ digits with <code>double</code>.</p>\n\n<p>As to your main question: use <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/fgets.html\" rel=\"nofollow noreferrer\"><code>fgets()</code></a> (or POSIX \n<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a>) to read lines and then <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/sscanf.html\" rel=\"nofollow noreferrer\"><code>sscanf()</code></a> to parse the line that is read. This will avoid confusion.  When the input is line-based but not regular enough, don't use <code>fscanf()</code> and family to read the data \u2014 the file-reading <code>scanf()</code> functions don't care about newlines, even when you do.</p>\n\n<p>Note that <code>sscanf()</code> will return either 3 or 4, indicating whether there was a string at the end of a line or not (or <code>EOF</code>, <code>0</code>, <code>1</code> or <code>2</code> if it is given an empty string, or a string which doesn't start with a number, or a string which only contains one or two numbers). Always test the return value from <code>scanf()</code> and friends \u2014 but do so carefully.  Look for the number of values that you expect (3 or 4 in this example), rather than 'not EOF'.</p>\n\n<p>This leads to roughly:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    double d[3];\n    char text[20];\n    char line[4096];\n\n    while (fgets(line, sizeof(line), stdin) != 0)\n    {\n        int rc = sscanf(line, \"%lf %lf %lf %19s\", &amp;d[0], &amp;d[1], &amp;d[2], &amp;text[0]);\n        if (rc == 4)\n            printf(\"%13.6f  %13.6f  %13.6f  [%s]\\n\", d[0], d[1], d[2], text);\n        else if (rc == 3)\n            printf(\"%13.6f  %13.6f  %13.6f  -NA-\\n\", d[0], d[1], d[2]);\n        else\n            printf(\"Format error: return code %d\\n\", rc);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>If given this file as standard input:</p>\n\n<pre><code>1.9969199999999998  2.4613199999999997  130.81278270000001  AA\n2.4613199999999997  2.5541999999999998  138.59131554109211  BB\n2.5541999999999998  2.9953799999999995  146.83238401449094  CC\n19.20212223242525  29.3031323334353637 3940.41424344454647\n19.20212223242525  29.3031323334353637 3940.41424344454647  PolyVinyl-PolySaccharide\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code> 1.996920       2.461320     130.812783  [AA]\n 2.461320       2.554200     138.591316  [BB]\n 2.554200       2.995380     146.832384  [CC]\n19.202122      29.303132    3940.414243  -NA-\n19.202122      29.303132    3940.414243  [PolyVinyl-PolySacch]\n</code></pre>\n\n<p>You can tweak the output format to suit yourself.  Note that the <code>%19s</code> avoids buffer overflow even when the text is longer than 19 characters.</p>\n"}], "owner": {"reputation": 1435, "user_id": 2606411, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/28ZBU.jpg?s=128&g=1", "display_name": "Swapnil", "link": "https://stackoverflow.com/users/2606411/swapnil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 48416116, "answer_count": 1, "score": 1, "last_activity_date": 1516804166, "creation_date": 1516726642, "last_edit_date": 1516804166, "question_id": 48407064, "link": "https://stackoverflow.com/questions/48407064/read-tab-separated-content-line-by-line-with-last-column-empty-string", "title": "Read tab separated content line by line with last column empty string", "body": "<p>I have a file format like this</p>\n\n<pre><code>1.9969199999999998  2.4613199999999997  130.81278270000001  AA\n2.4613199999999997  2.5541999999999998  138.59131554109211  BB\n2.5541999999999998  2.9953799999999995  146.83238401449094  CC\n...........................\n</code></pre>\n\n<p>I have to read first three columns as <code>float</code> and the last column as <code>char</code> array in <code>C</code>. All the columns are tab separated and the there is an new line character at the end of each line. Everything works fine with <code>fscanf(fp1, \"%f\\t%f\\t%f\\t%s\\n\", ...)</code> till I have a some text at the end of each line (the char string part).</p>\n\n<p>There are cases where instead of AA/BB/CC, I have an empty string in the file. How to handle that case. I have tried <code>fscanf(fp1, \"%f\\t%f\\t%f\\t%s[^\\n]\\n\", ...)</code> and many other things, but I am unable to figure out the right way. Can you please help me out here?</p>\n"}, {"tags": ["c", "arrays", "dynamic"], "comments": [{"owner": {"reputation": 951, "user_id": 3000316, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/50f634b39f1f85144ab67f2848de290c?s=128&d=identicon&r=PG&f=1", "display_name": "Monkey Supersonic", "link": "https://stackoverflow.com/users/3000316/monkey-supersonic"}, "edited": false, "score": 1, "creation_date": 1516725392, "post_id": 48406690, "comment_id": 83802112, "body": "Did you have a question?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 1, "creation_date": 1516725482, "post_id": 48406690, "comment_id": 83802167, "body": "yes - &quot;why should I make my post readable?&quot;"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1516725994, "post_id": 48406690, "comment_id": 83802497, "body": "<i>...two dimensional pointer arrays in C like <code>int* x[][4]</code> can be declared</i>. What C compiler and options are you using that doesn&#39;t flag this as an error (array size missing)? Or are you referring to an argument to a function?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516726154, "post_id": 48406690, "comment_id": 83802612, "body": "Remember the C axiom: <i>Just because you can doesn&#39;t mean you should.</i>"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516726555, "post_id": 48406690, "comment_id": 83802899, "body": "@tadman Works equally well for Jurassic Park."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1516726573, "post_id": 48406690, "comment_id": 83802913, "body": "<code>int *[][1]</code> is still a two-dimensional array. The one-dimensional version is <code>int *[]</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1516726643, "post_id": 48406690, "comment_id": 83802952, "body": "@ChristianGibbons It would have been a really boring movie if they didn&#39;t, though! &quot;Here we have an island with no dinosaurs. Scientists were too busy arguing about if they should, so they didn&#39;t.&quot; Roll credits."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1516726658, "post_id": 48406690, "comment_id": 83802962, "body": "<code>int *[][][1]</code> is illegal. Only the first dimension can be dynamic."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8181083"}, "edited": false, "score": 0, "creation_date": 1516726815, "post_id": 48406690, "comment_id": 83803068, "body": "you mean that these declarations will generate errors/ warnings and an invalid and impossible??"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8181083"}, "edited": false, "score": 0, "creation_date": 1516726863, "post_id": 48406690, "comment_id": 83803095, "body": "and will not serve my desired usage purpose??"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1516726881, "post_id": 48406690, "comment_id": 83803108, "body": "@tadman Mr. Smith Goes To Washington or 12 Angry Men were pretty decent movies about people arguing."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1516727101, "post_id": 48406690, "comment_id": 83803254, "body": "<code>calloc()</code> and <code>malloc()</code> just allocate blocks of dynamically-allocated memory of the specified size, with the blocks aligned for any object type (except for object types that specify extended alignment), so that the returned pointer can be converted to a pointer to the desired object type."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1516727254, "post_id": 48406690, "comment_id": 83803359, "body": "@ChristianGibbons Both movies needed more T-Rex."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1516727521, "post_id": 48406690, "comment_id": 83803522, "body": "&quot;you mean that these declarations will generate errors/warnings and an invalid and impossible??&quot; Yes, only the first dimension can be left blank, and only if there is an initializer, or if the &quot;array&quot; is actually a parameter declaration, where it will be automatically changed into a pointer."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1516727735, "post_id": 48406690, "comment_id": 83803654, "body": "@stacklooker ... <i>you mean that these declarations will generate errors/ warnings</i>. You mean you didn&#39;t even apply the effort to try these out to see this for yourself? <i>...and will not serve my desired usage purpose??</i> Since we don&#39;t know what that higher purpose is, we can&#39;t answer that one. Maybe you should really state your purpose and ask how you can achieve it."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1516727778, "post_id": 48406690, "comment_id": 83803685, "body": "Inside a function, you can use variable expressions for the array dimensions, as long as the array does not have static storage duration. I don&#39;t know if that will serve your desired usage purpose."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8181083"}, "edited": false, "score": 0, "creation_date": 1516728865, "post_id": 48406690, "comment_id": 83804348, "body": "so can i  have  function add that has as argument the dimensions of two multiplication compatible matrices  and inside the function perform matrix multiplaction please bother to give an example code of this example that i just mentioned or any other that you find suitable"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1516728767, "creation_date": 1516728767, "answer_id": 48407642, "question_id": 48406690, "link": "https://stackoverflow.com/questions/48406690/c-array-of-pointer/48407642#48407642", "title": "C array of pointer", "body": "<blockquote>\n  <p>For illustration,two dimensional pointer arrays in C like <code>int* x[][4]</code>\n  can be declared</p>\n</blockquote>\n\n<p>Only in two cases:</p>\n\n<ol>\n<li><p>when an initializer for <code>x</code> implicitly conveys the value of the first dimension,</p>\n\n<pre><code>int* x[][4] = { {NULL, NULL, NULL, NULL}, {NULL, NULL, NULL, NULL} };\n</code></pre></li>\n<li><p>as the type of a function parameter.  In that case, it is exactly equivalent to declaring the parameter to have type <code>int *(*)[4]</code>: pointer to array of four pointers to <code>int</code>.  <em>And that would also be the case if the first dimension were actually given.</em></p>\n\n<pre><code>void foo(int* x[][4]);\n</code></pre></li>\n</ol>\n\n<blockquote>\n  <p>,where first index can be fixed at run time</p>\n</blockquote>\n\n<p>In case (1) above, no, the first dimension is determined at compile time.</p>\n\n<p>In case (2) above, not exactly.  It is then the declaration of a pointer to a 1D array.  Such a pointer can point to the first element of a 2D array of <code>int *</code>, and it can be indexed as if it in fact designated such a 2D array. The size of the first dimension is not <em>conveyed</em>, but if the pointer in fact points to an object then that dimension is <em>fixed</em> for the function's purposes, whether the pointed-to object is dynamically allocated or not.</p>\n\n<blockquote>\n  <p>that it is\n  dynamic then can i say that dynamic declaration of dynamic\n  one-dimensional array can be achieved in someway by replacing the\n  second index to value 1 like int*[][1]</p>\n</blockquote>\n\n<p>That change produces a <em>statically</em> different type (in those contexts where it is valid at all).  In case (2), but not case (1), both this type and the one we were discussing previously can point to a dynamically-allocated object, but they can also point to an automatic- or static-duration object of appropriate type.  There's nothing inherently dynamic there.</p>\n\n<blockquote>\n  <p>and for two dimensional array\n  dynamic two-dimensional array by int*[][][1]</p>\n</blockquote>\n\n<p>No.  Not even for the type of a function parameter.  At most the (one) leading dimension can be omitted.</p>\n\n<blockquote>\n  <p>Does calloc() malloc()\n  internally use them</p>\n</blockquote>\n\n<p>Not at all.  How could they?  The allocation functions do not see this datatype at all.  You tell them only how much space to allocate, either as a single composite value (<code>malloc</code>) or as an (element count, element size) pair (<code>calloc</code>).  Thus the caller needs to know how much memory is needed.  And this in any event applies only in case (2).  Case (1) inherently produces static or automatic allocation, not dynamic.</p>\n\n<blockquote>\n  <p>is my logic correct at all</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>and this applied that\n  is in a simplistic case of dynamic array declaration use inside a\n  function in C language program</p>\n</blockquote>\n\n<p>Neither as a local variable of a function (case 1) nor as a function parameter (case 2).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8181083"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 48407642, "answer_count": 1, "score": 0, "last_activity_date": 1516728767, "creation_date": 1516725339, "last_edit_date": 1516725700, "question_id": 48406690, "link": "https://stackoverflow.com/questions/48406690/c-array-of-pointer", "title": "C array of pointer", "body": "<p>For illustration,two dimensional pointer arrays in C like <code>int* x[][4]</code> can be declared ,where first index can be fixed at run time that it is dynamic then can i say that dynamic declaration of  dynamic one-dimensional array can be achieved in someway by replacing the second index to value 1 like <code>int*[][1]</code> and for two dimensional array dynamic two-dimensional array by <code>int*[][][1]</code> Does <code>calloc()</code> <code>malloc()</code> internally use them is my logic correct at all and  this  applied that is in a simplistic case of dynamic array declaration use inside a function in C language program</p>\n"}, {"tags": ["c", "visual-studio", "build-process", "mingw"], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 1757253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640a94f5ccc4dc325d6c14125eab5f41?s=128&d=identicon&r=PG", "display_name": "jesta", "link": "https://stackoverflow.com/users/1757253/jesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1516728625, "creation_date": 1516728625, "answer_id": 48407600, "question_id": 48407391, "link": "https://stackoverflow.com/questions/48407391/vs-2017-cmake-ninja-mingw/48407600#48407600", "title": "VS 2017 + cmake + ninja + mingw", "body": "<p>Turns out I had to restart VS... Everything works as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 28057, "user_id": 221061, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/1ea77ac140410a95304e234165e40b05?s=128&d=identicon&r=PG", "display_name": "Chris Laplante", "link": "https://stackoverflow.com/users/221061/chris-laplante"}, "is_accepted": false, "score": 0, "last_activity_date": 1566084800, "creation_date": 1566084800, "answer_id": 57540636, "question_id": 48407391, "link": "https://stackoverflow.com/questions/48407391/vs-2017-cmake-ninja-mingw/57540636#57540636", "title": "VS 2017 + cmake + ninja + mingw", "body": "<p>I had the same error, compiling in a completely different environment (Yocto &amp; Linux), but I suspect the root cause is the same. Maybe this will help someone out there.</p>\n\n<p>It turned out CMake was getting invoked like this:</p>\n\n<pre><code>cmake -G 'Unix Makefiles' -DCMAKE_MAKE_PROGRAM=make -G 'Ninja' ...\n</code></pre>\n\n<p>The Ninja generator was getting selected, but the wrong 'MAKE_PROGRAM' was getting set. </p>\n\n<p>Should be:</p>\n\n<pre><code>cmake -DCMAKE_MAKE_PROGRAM=ninja -G 'Ninja' ...\n</code></pre>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1287695708, "open_beta_date": 1279738800, "closed_beta_date": 1279134000, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/gamedev/Img/apple-touch-icon@2.png", "twitter_account": "StackGameDev", "favicon_url": "https://cdn.sstatic.net/Sites/gamedev/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/gamedev/Img/apple-touch-icon.png", "audience": "professional and independent game developers", "site_url": "https://gamedev.stackexchange.com", "api_site_parameter": "gamedev", "logo_url": "https://cdn.sstatic.net/Sites/gamedev/Img/logo.png", "name": "Game Development", "site_type": "main_site"}, "on_date": 1516727812, "question_id": 153503}, "owner": {"reputation": 115, "user_id": 1757253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640a94f5ccc4dc325d6c14125eab5f41?s=128&d=identicon&r=PG", "display_name": "jesta", "link": "https://stackoverflow.com/users/1757253/jesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1566084800, "creation_date": 1516724959, "question_id": 48407391, "link": "https://stackoverflow.com/questions/48407391/vs-2017-cmake-ninja-mingw", "title": "VS 2017 + cmake + ninja + mingw", "body": "<p>I'm using VS 2017's new \"open folder\" feature with automatic cmake builds via CmakeSettings.json.</p>\n\n<p>The code is written in C11, so I need to compile it with gcc (from mingw-64). I created a new cmake configuration that looks like this:</p>\n\n<pre><code>{\n  \"name\": \"GNU-Debug\",\n  \"generator\": \"Ninja\",\n  \"configurationType\": \"Debug\",\n  \"inheritEnvironments\": [ \"msvc_x64_x64\" ],\n  \"buildRoot\": \"${env.USERPROFILE}\\\\CMakeBuilds\\\\${workspaceHash}\\\\build\\\\${name}\",\n  \"installRoot\": \"${env.USERPROFILE}\\\\CMakeBuilds\\\\${workspaceHash}\\\\install\\\\${name}\",\n  \"variables\": [\n    {\n      \"name\": \"CMAKE_MAKE_PROGRAM\",\n      \"value\": \"C:\\\\msys64\\\\mingw64\\\\bin\\\\mingw32-make.exe\"\n    },\n    {\n      \"name\": \"CMAKE_C_COMPILER\",\n      \"value\": \"C:\\\\msys64\\\\mingw64\\\\bin\\\\gcc.exe\"\n    },\n    {\n      \"name\": \"CMAKE_CXX_COMPILER\",\n      \"value\": \"C:\\\\msys64\\\\mingw64\\\\bin\\\\g++.exe\"\n    }\n  ]\n}\n</code></pre>\n\n<p>The output looks like this:</p>\n\n<blockquote>\n  <p>The detected version of Ninja (GNU Make 4.2.1 Built for x86_64-w64-mingw32  Copyright (C) 1988-2016 Free Software Foundation, Inc.  License GPLv3+: GNU GPL version 3 or later  <a href=\"http://gnu.org/licenses/gpl.html\" rel=\"nofollow noreferrer\">http://gnu.org/licenses/gpl.html</a>  This is free software: you are free to change and redistribute it.  There is NO WARRANTY, to the extent permitted by law.) is less than the  version of Ninja required by CMake (1.3).</p>\n</blockquote>\n\n<p>Which is very weird, considering the detected version of ninja is supposed to be a number. Both VS' ninja and MinGW ninja are up to date (1.8.2).</p>\n\n<p>Is there any other way to have MinGW + CMake working inside VS 2017?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 1, "creation_date": 1516724886, "post_id": 48406490, "comment_id": 83801755, "body": "What is the exact error message? What is the exact folder structure? Where are the functions from <code>le_helper_stub_local.h</code> implemented? Do you compile that C file too and link it in?"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1516724892, "post_id": 48406490, "comment_id": 83801760, "body": "&#39;undefined reference&#39; is a linker error. So show your code and the commands used to compile and link"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1516724892, "post_id": 48406490, "comment_id": 83801761, "body": "Undefined reference is meaning that the problem is not with inclusion but with linking."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "edited": false, "score": 0, "creation_date": 1516724932, "post_id": 48406490, "comment_id": 83801790, "body": "Backwards relative paths should work."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1516725146, "post_id": 48406490, "comment_id": 83801943, "body": "I&#39;m going to assume a <code>-L</code> path needs to be passed into the linker"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1516727605, "post_id": 48406490, "comment_id": 83803580, "body": "Your problem is not with the header. You fail to define whatever is missed. See <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix\" title=\"what is an undefined reference unresolved external symbol error and how do i fix\">stackoverflow.com/questions/12573816/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1516727768, "post_id": 48406490, "comment_id": 83803675, "body": "Note that <a href=\"https://stackoverflow.com/questions/597318/\">relative include paths with <code>..</code> in the names</a> are usually not a good idea.  You locate headers by specifying on the command line where they&#39;re found, with an option such as <code>-I..&#47;..&#47;ficoStub</code> while the code includes <code>#include &quot;le_helper_stub_local.h&quot;</code>.  Sometimes, you might prefer <code>#include &quot;ficoStub&#47;le_helper_stub_local.h&quot;</code> in which case you&#39;d use <code>-I..&#47;..</code> on the command line.  You problem, though, is with the linker.  You need to specify where the object files, or the library (or libraries) containing the object files are found."}, {"owner": {"reputation": 509, "user_id": 8857328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a43855efb44db02b57d0f7253394882?s=128&d=identicon&r=PG&f=1", "display_name": "VladP", "link": "https://stackoverflow.com/users/8857328/vladp"}, "edited": false, "score": 0, "creation_date": 1516748382, "post_id": 48406490, "comment_id": 83814309, "body": "Relative include path is a common method in code development, and this is a common problem that happens very often. Search stackoverflow, or try to resolve it with you means: Find the real root folder of your project, check if the file that you have really exist, by referencing to it by writing the full path in your code. The full path step is used only to debug the issue. After that, you may try to set properly your path. Read this to orient you about the reason for this error message: <a href=\"https://latedev.wordpress.com/2014/04/22/common-c-error-messages-2-unresolved-reference/\" rel=\"nofollow noreferrer\">latedev.wordpress.com/2014/04/22/&hellip;</a>"}], "owner": {"reputation": 109, "user_id": 7774387, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8798f77cb3c4eae6d5f5f1a0c6e4a668?s=128&d=identicon&r=PG&f=1", "display_name": "H.A.", "link": "https://stackoverflow.com/users/7774387/h-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "closed_date": 1516997041, "answer_count": 0, "score": 1, "last_activity_date": 1516786665, "creation_date": 1516724738, "last_edit_date": 1516786665, "question_id": 48406490, "link": "https://stackoverflow.com/questions/48406490/include-file-from-different-folder-c", "closed_reason": "Duplicate", "title": "Include file from different folder C", "body": "<p>I have a folder components in my project which has another folder fico in which there is a file I want to use le_helper_stub_local.h (components -> fico -> file I want to use).\nThen I have another folder positioning which has two folders: platform and posDaemon. I am working with a file inside posDaemon and I want to include in this file le_helper_stub_local.h.</p>\n\n<p>I used the following:</p>\n\n<pre><code>#include \"../../ficoStub/le_helper_stub_local.h\"\n</code></pre>\n\n<p>but when I compile I have an error of undefined reference to the functions I am using from inside le_helper_stub_local.h\nWhat am I doing wrong? sorry if it sounds like a beginner question but I don\u00b4t really use C.</p>\n\n<p>the code for le_helper_stub_local.h:</p>\n\n<pre><code>#ifndef LEGATO_STUB_LOCAL_INCLUDE_GUARD\n#define LEGATO_STUB_LOCAL_INCLUDE_GUARD\n\n#include \"legato.h\"\n\nFILE * Stub_openStream(char *pathIn);\nvoid Stub_writeHeader(FILE* fp, char *functionName);\nvoid Stub_writeParam (FILE* fp, int nParam, char *paramName, char* \nparamContent);\nvoid Stub_writeTail(FILE* fp);\nbool Stub_lookForCall(FILE* fp, int *remains);\nvoid Stub_updateRemains(FILE *fp, int remains);\n\nle_result_t le_helper_stub_Init\n(\n    void\n);\n\n#endif // LEGATO_STUB_LOCAL_INCLUDE_GUARD\n</code></pre>\n\n<p>this is a part of the code where I\u00b4ve included the above file:\n     le_result_t le_gnss_GetDate\n(\n    le_gnss_SampleRef_t positionSampleRef,\n        ///&lt; [IN]\n        ///&lt; Position sample's reference.</p>\n\n<pre><code>uint16_t* yearPtr,\n    ///&lt; [OUT]\n    ///&lt; UTC Year A.D. [e.g. 2014].\n\nuint16_t* monthPtr,\n    ///&lt; [OUT]\n    ///&lt; UTC Month into the year [range 1...12].\n\nuint16_t* dayPtr\n    ///&lt; [OUT]\n    ///&lt; UTC Days into the month [range 1...31].\n)\n{\n\nle_result_t result = LE_FAULT;\n\n// 1. Open the output file and add/save information related to the execution.\nchar pathOut[] = \"/stub/positioning_le_gnss_GetDate.out\";\nchar functionName[] = \"le_gnss_GetDate\";\n\nFILE * fp = Stub_openStream(pathOut);\nStub_writeHeader(fp, functionName);\nStub_writeTail(fp);\nresult = le_atomFile_CloseStream(fp);  \n\nreturn result;\n</code></pre>\n\n<p>for compiling I have a script which compiles my entire project which is python and C. It\u00b4s too long to write it here. This is the error I get during complilation:</p>\n\n<p>posDaemon.so: undefined reference to <code>Stub_writeHeader'\nbuild/qemuarm/system/component/6c05f6c53a95e6505773ec507f339d0a/obj/libComponent_posDaemon.so: undefined reference to</code>Stub_writeTail'\nbuild/qemuarm/system/component/6c05f6c53a95e6505773ec507f339d0a/obj/libComponent_posDaemon.so: undefined reference to `Stub_openStream'\ncollect2: error: ld returned 1 exit status\n[390/601] Linking C executable</p>\n\n<p>I\u00b4ve used the le_helper_stub_local.h before in other files but I\u00b4ve never had this problem before. I also don\u00b4t think now that it\u00b4s an inclusion problem.</p>\n"}, {"tags": ["c", "signals"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516721588, "post_id": 48405202, "comment_id": 83799371, "body": "Do you mean you want to discover the function&#39;s return address?  Because the PC is stored in a register; it has no address, and all you need to do to increment it is to evaluate substantially any expression."}, {"owner": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516722172, "post_id": 48405202, "comment_id": 83799825, "body": "@JohnBollinger I meant to increment the pointer to where the program counter is stored to advance PC manually so that when the handler return, the code will run after the instruction that caused segfault"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 2, "creation_date": 1516722881, "post_id": 48405202, "comment_id": 83800357, "body": "Because instructions have variable length, it is not posible to &quot;advance&quot; the PC to any next instruction: you don&#39;t know how many bytes to skip (unless you analyze the instruction(s))."}, {"owner": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1516723068, "post_id": 48405202, "comment_id": 83800483, "body": "@PaulOgilvie It&#39;s just a exercise for better understanding. I will be able to find the length of instruction this particular machine by viewing the assembly code. But my problem is to find the instruction pointer or PC to advance the pc manually"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1516723525, "post_id": 48405202, "comment_id": 83800815, "body": "Then you must inspect the call frame (assembler) the compiler generates for a function call. It will tell you how many bytes to add or subtract from the (first) parameter&#39;s address. That number of bytes will always be the same (depending on platform and compiler)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516723582, "post_id": 48405202, "comment_id": 83800848, "body": "Again, @ghosttang, the PC is stored <i>in a register</i>.  Registers are part of the CPU, not of system memory.  Therefore they have no addresses, and you cannot obtain a pointer to one in any way.  Moreover, when you&#39;re executing the code of the signal handler, the PC has already changed from the location of the instruction that caused the segfault.  That&#39;s why I asked whether you meant the <i>return address</i>, which would be a valid value for the PC to take."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1516723637, "post_id": 48405202, "comment_id": 83800903, "body": "Note further that the machine may have invoked first its own segfault handler, which calls the user segfault handler. There is no guarantee you find the address of the faulting instruction."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1516723826, "post_id": 48405202, "comment_id": 83801033, "body": "(On the other hand, if a debugger can put me at the place of a faulting instruction, then it must be possible to get its address...)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516723840, "post_id": 48405202, "comment_id": 83801043, "body": "In fact, if you want the program to resume where it was after a segfault, then it is likely that all you need to do is set the disposition for <code>SIGSEGV</code> to <code>SIG_IGN</code>, or, alternatively, to install a signal handler that returns without terminating the program.  Signal handling is <i>asynchronous</i>: resuming where the main code left off is standard behavior."}, {"owner": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516724090, "post_id": 48405202, "comment_id": 83801229, "body": "@JohnBollinger Sorry I think I understood how the program counter works wrong. The purpose of this exercise is to recover from segfult and keep the codes alive by advance PC pass the offending instruction. If the PC will read from the return address, does it mean that I only need to increment the value in the return address by the length of bad instruction to have the PC advance?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516724407, "post_id": 48405202, "comment_id": 83801425, "body": "@ghosttang, your focus on the PC or even on a return address is probably misplaced.  C does not define any mechanism for manipulating these; they are not even part of the abstract machine model that serves as the basis for the language specifications.  If you&#39;re looking for a <b><i>C</i></b> solution for recovering from a segfault, then see my comments about signal disposition and signal handler implementation."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1516725008, "post_id": 48405202, "comment_id": 83801843, "body": "@JohnBollinger You&#39;re badly mistaken - just for starters, setting <code>SIGSEGV</code> to <code>SIG_IGN</code> and then doing anything that would trigger delivery of <code>SIGSEGV</code> provokes undefined behavior; same for returning normally from a SIGSEGV handler without having taken any action to clear the fault (in the latter case, the most likely outcome is an infinite loop between the faulting instruction and the handler).  It&#39;s true that the functionality OP is asking for is not included in the C standard, but it is possible using POSIX + one piece of completely unportable code - see my answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1516726278, "post_id": 48405202, "comment_id": 83802703, "body": "@zwol, I accept that my suggestion might not work, but program behavior is <i>already</i> undefined (by C) when the program performs an action that results in a segfault being raised, other than calling <code>raise()</code>.  From there on, we&#39;re in Wonderland.  Moreover, modifying the <code>mcontext_t</code> obtained from a <code>ucontext_t</code>, as you suggest, itself necessarily exhibits undefined (by C or POSIX) behavior.  That&#39;s more or less equivalent to your description of it as &quot;completely unportable&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "edited": false, "score": 0, "creation_date": 1516725995, "post_id": 48406393, "comment_id": 83802498, "body": "since the exercise is only limited to specific machine, is it possible to find the address where PC stored using debugger or read through assembly code?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "edited": false, "score": 0, "creation_date": 1516727052, "post_id": 48406393, "comment_id": 83803225, "body": "@ghosttang What you should do is read through <code>ucontext.h</code> and the headers it includes.  If you still have no clue, ask a new question specifically about the contents of <code>ucontext_t</code> on your CPU and OS, and you&#39;ll have to tell us which ones they are."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 1, "last_activity_date": 1516724828, "last_edit_date": 1516724828, "creation_date": 1516724493, "answer_id": 48406393, "question_id": 48405202, "link": "https://stackoverflow.com/questions/48405202/c-programming-manually-increment-signal-handlers-pc/48406393#48406393", "title": "C programming manually increment signal handler&#39;s PC", "body": "<p>In order to gain access to the location of the saved PC, you must use <a href=\"https://linux.die.net/man/2/sigaction\" rel=\"nofollow noreferrer\"><code>sigaction</code></a> and a three-argument signal handler:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;ucontext.h&gt;\n\nvoid segf_handler(int sig, siginfo_t *info, void *cx_)\n{\n    ucontext_t *cx = cx_;\n\n    /* Extremely OS- and architecture-specific manipulation\n       of the data pointed to by `cx` goes here */\n}\n\nint *volatile cause_crash = 0;\n\nint main(void)\n{\n    struct sigaction sa;\n    sigfillset(&amp;sa.sa_mask);\n    sa.sa_sigaction = segf_handler;\n    sa.sa_flags = SA_RESTART | SA_SIGINFO;\n    if (sigaction(SIGSEGV, &amp;sa, 0)) {\n        perror(\"sigaction\");\n        return 1;\n    }\n    *cause_crash = 0;\n    puts(\"recovered from segfault\");\n    return 0;\n}\n</code></pre>\n\n<p>The saved PC will be <em>somewhere</em> within the data pointed to by <code>cx</code>, and you can manipulate it to change where normal control will resume.  The data pointed to by <code>info</code> will also include useful details for programs trying to do this sort of thing, such as (for SIGSEGV) the bad address that the faulting instruction tried to access.</p>\n\n<p>Unfortunately, I can't tell you where to find the PC, because the contents of a <code>ucontext_t</code> are not standardized <em>at all</em>, and vary radically with both the CPU and the operating system, and you have not told us either one.</p>\n\n<p>Note that <code>sigaction</code> is not part of any version of the C standard.  Everything used by the above code, except for the contents of <code>ucontext_t</code>, is part of POSIX.1-1996, so you can count on its working on anything you're likely to be using <em>except</em> for certain embedded operating systems and Windows.  In particular, on Windows you need to do something <em>completely different</em> that I don't understand well enough to describe.</p>\n\n<p>Note also that if your instructor told you it was possible to access the saved PC using <code>signal</code> and/or a one-argument signal handler, then they were wrong, and if they <em>required</em> you to do that as part of an exercise, then that is an improper requirement, and in both cases you may tell them I said so.</p>\n"}], "owner": {"reputation": 33, "user_id": 9257518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b24d5049b4aba2bd1ac5c878914a0bf?s=128&d=identicon&r=PG&f=1", "display_name": "ghost  tang", "link": "https://stackoverflow.com/users/9257518/ghost-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1516724828, "creation_date": 1516721014, "last_edit_date": 1516723181, "question_id": 48405202, "link": "https://stackoverflow.com/questions/48405202/c-programming-manually-increment-signal-handlers-pc", "title": "C programming manually increment signal handler&#39;s PC", "body": "<p>I am new to C programming and run into a problem when doing an exercise to increment the PC of a segmentation fault signal handler using only flag's address. By referencing the flag signum, I already got the address of the flag within the code's stack , but how do I know by how much should I increment it to the where the PC stored instruction pointer to advance the program counter manually?</p>\n\n<pre><code>void segf_handler(int signum)\n{\nint address=&amp;signum;\n\n}\nint main()\n{\nint n = 0;\n\nsignal(SIGSEGV, segment_fault_handler);\n\nn = *( (int *) 0 );\n\nprintf(\"recover from segfault\\n\");\n\nreturn 0;\n}\n</code></pre>\n\n<p>Thank You!</p>\n"}, {"tags": ["c", "arrays", "visual-studio", "sorting", "struct"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1516720855, "post_id": 48405126, "comment_id": 83798820, "body": "I don&#39;t see anything which looks like sorting."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516721300, "post_id": 48405126, "comment_id": 83799159, "body": "What aspect of the problem has you stuck?"}, {"owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "edited": false, "score": 0, "creation_date": 1516721437, "post_id": 48405126, "comment_id": 83799243, "body": "no, i had to delete that part. it was all wrong. I&#180;m looking for a alternative, from the begginning if you have the time"}, {"owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "edited": false, "score": 0, "creation_date": 1516721538, "post_id": 48405126, "comment_id": 83799328, "body": "I guess insertion sort will do? but how do i apply it nicely?"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 2, "creation_date": 1516721610, "post_id": 48405126, "comment_id": 83799394, "body": "Why not use <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.5.2\" rel=\"nofollow noreferrer\">qsort()</a>?"}, {"owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "edited": false, "score": 0, "creation_date": 1516722613, "post_id": 48405126, "comment_id": 83800151, "body": "David, i will take a look at it!"}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 0, "creation_date": 1516724265, "post_id": 48405126, "comment_id": 83801335, "body": "Welcome to Stack Overflow! Try making this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please! &lt;3"}, {"owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "edited": false, "score": 0, "creation_date": 1516734024, "post_id": 48405126, "comment_id": 83807185, "body": "I&#180;ve tried to work it out with qsort, but im getting nowhere."}, {"owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "edited": false, "score": 0, "creation_date": 1516734060, "post_id": 48405126, "comment_id": 83807207, "body": "can someone give me at least a start"}], "answers": [{"comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 2, "creation_date": 1516749639, "post_id": 48412366, "comment_id": 83814747, "body": "curiosity - why the cast to long?"}, {"owner": {"reputation": 95405, "user_id": 12725, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/98df3c7cc17f088af555c5accbdb2509?s=128&d=identicon&r=PG", "display_name": "James Curran", "link": "https://stackoverflow.com/users/12725/james-curran"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516807025, "post_id": 48412366, "comment_id": 83841502, "body": "@pm100 If the ints were close to INT_MIN and INT_MAX, the difference could wrap around, give the inverse of what we want.  Assuming longs are bigger than ints (not guaranteed), casting to long should prevent that."}], "tags": [], "owner": {"reputation": 95405, "user_id": 12725, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/98df3c7cc17f088af555c5accbdb2509?s=128&d=identicon&r=PG", "display_name": "James Curran", "link": "https://stackoverflow.com/users/12725/james-curran"}, "is_accepted": false, "score": 1, "last_activity_date": 1516749012, "creation_date": 1516749012, "answer_id": 48412366, "question_id": 48405126, "link": "https://stackoverflow.com/questions/48405126/sorting-a-struct-array-based-on-int/48412366#48412366", "title": "Sorting a struct array based on int", "body": "<pre><code>int cmpVara(const struct vara *left, const struct vara *right)\n{\n      // quick &amp; dirty way to compare two ints.\n      return (long) left.nummer - (long) right.nummer;\n}\n\n// :\n// :\n\n       qsort(items, i, sizeof(vara), cmpVara);\n</code></pre>\n\n<p><code>i</code> is the number of elements in <code>items</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9245860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1507772fb3cdb86528b91856e625c6cb?s=128&d=identicon&r=PG&f=1", "display_name": "emano12", "link": "https://stackoverflow.com/users/9245860/emano12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570209739, "creation_date": 1516720798, "last_edit_date": 1570209739, "question_id": 48405126, "link": "https://stackoverflow.com/questions/48405126/sorting-a-struct-array-based-on-int", "title": "Sorting a struct array based on int", "body": "<p>I'm kinda stuck when trying to sort <code>int</code> number. I'm trying to display the items based on its number (nummer). The <code>int main</code> and <code>#includes</code> are in the program, just couldn't copy them. Is there a preferred why to handle this issue and can someone explain it, I been trying for a while now haha. Thanks</p>\n\n<pre><code>char *oneline, *tok;\nchar envara[512];\nchar delim[] = \",\";\nFILE *fp;\nint i;\n\nstruct vara\n{\n    int nummer;\n    char namn[100];\n    float pris;\n    float volym;\n    char typ[100];\n    char stil[100];\n    char forpackning[20];\n    char land[20];\n    char producent[50];\n    float alkoholhalt;\n\n} items[100];\n\n\nif ((fp = fopen(\"varor.csv\", \"r\")) == NULL)\n{\n    fprintf(stderr, \"Filen varor.csv gick inte att \u00f6ppna\\n\");\n    exit(-1);\n}\n\nfor (i = 0; i &lt; 100 &amp;&amp; fgets(envara, 512, fp); i++)\n{\n    envara[strlen(envara) - 1] = '\\0';\n    oneline = strdup(envara);\n\n    tok = strtok(oneline, delim);\n    items[i].nummer = atoi(tok);\n    tok = strtok(NULL, delim);\n    strncpy(items[i].namn, tok, (max(strlen(tok), sizeof(items[0].namn))));\n    tok = strtok(NULL, delim);\n    items[i].pris = atof(tok);\n    tok = strtok(NULL, delim);\n    items[i].volym = atof(tok);\n    tok = strtok(NULL, delim);\n    strncpy(items[i].typ, tok, strlen(tok));\n    tok = strtok(NULL, delim);\n    strncpy(items[i].stil, tok, strlen(tok));\n    tok = strtok(NULL, delim);\n    strncpy(items[i].forpackning, tok, strlen(tok));\n    tok = strtok(NULL, delim);\n    strncpy(items[i].land, tok, min(strlen(tok), sizeof(items-&gt;land)));\n    tok = strtok(NULL, delim);\n    strncpy(items[i].producent, tok, strlen(tok));\n    tok = strtok(NULL, delim);\n    items[i].alkoholhalt = atof(tok);\n\n    printf(\"nummer: %d\\n\"\n        \"namn: %s\\n\"\n        \"pris: %f\\n\"\n        \"volym: %f\\n\"\n        \"typ: %s\\n\"\n        \"stil: %s\\n\"\n        \"forpackning: %s\\n\"\n        \"land: %s\\n\"\n        \"producent: %s\\n\"\n        \"alkoholhalt: %f\\n\\n\",\n        items[i].nummer,\n        items[i].namn,\n        items[i].pris,\n        items[i].volym,\n        items[i].typ,\n        items[i].stil,\n        items[i].forpackning,\n        items[i].land,\n        items[i].producent,\n        items[i].alkoholhalt\n    );\n\n    free(oneline);\n}\n\nfclose(fp);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char", "int"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1516720660, "post_id": 48405040, "comment_id": 83798678, "body": "<code>while(ok=true);</code> is sure to be wrong."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1516720660, "post_id": 48405040, "comment_id": 83798680, "body": "Please <b><i>properly</i></b> indent your code. Machine (Compiler) can read and compile anything, but for humans, it needs to make a little <i>sense</i> while reading a block of text as <i>code</i>. When asking question, there was a big orange <b>How to Format</b> box to the right of the text area. There was also an entire toolbar of formatting aids. And a <b>[?]</b> button giving formatting help. And a preview area  showing what your post would look like when posted. Making your post clear, and demonstrating that you took the time to do so, improves your chances of getting good answers."}, {"owner": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1516720672, "post_id": 48405040, "comment_id": 83798689, "body": "Try <code>while(ok==true);</code> (note the <code>==</code> operator)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1516720714, "post_id": 48405040, "comment_id": 83798715, "body": "<code>fflush(stdin);</code> invokes undefined behavior."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 5673, "user_id": 2376156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/2s2R4.jpg?s=128&g=1", "display_name": "edtheprogrammerguy", "link": "https://stackoverflow.com/users/2376156/edtheprogrammerguy"}, "edited": false, "score": 0, "creation_date": 1516720803, "post_id": 48405040, "comment_id": 83798789, "body": "@edtheprogrammerguy: why not <code>while(ok!=true);</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516720973, "post_id": 48405040, "comment_id": 83798937, "body": "In particular, <code>fflush(stdin)</code> is not guaranteed to have any effect whatever.  If you want to clear pending input then read and discard it."}, {"owner": {"reputation": 1, "user_id": 9257353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-plA6t6uWp6w/AAAAAAAAAAI/AAAAAAAABQ4/2Zi2rqXOlrs/photo.jpg?sz=128", "display_name": "Pi7on", "link": "https://stackoverflow.com/users/9257353/pi7on"}, "edited": false, "score": 0, "creation_date": 1516721916, "post_id": 48405040, "comment_id": 83799644, "body": "Corrected array sizes and while argument, now the program works 100% of the times. I know, really stupid errors..  Also sorry for bad indentation.. I&#39;ll keep it in mind for next time. Thank you all for your help and quick responses!"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1516723825, "post_id": 48405040, "comment_id": 83801032, "body": "Welcome to Stack Overflow! Please <a href=\"https://stackoverflow.com/posts/48405040/edit\">edit</a> your code to reduce it to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of your problem.  Your current code includes much that is peripheral to your problem - a minimal sample normally looks similar to a good unit test: only performing one task, with input values specified for reproducibility."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516725270, "post_id": 48405040, "comment_id": 83802034, "body": "learn to use your debugger. Dont ignore compiler warnings."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9257353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-plA6t6uWp6w/AAAAAAAAAAI/AAAAAAAABQ4/2Zi2rqXOlrs/photo.jpg?sz=128", "display_name": "Pi7on", "link": "https://stackoverflow.com/users/9257353/pi7on"}, "edited": false, "score": 0, "creation_date": 1516880293, "post_id": 48405828, "comment_id": 83875017, "body": "Thank you very much, I really appreciate your help and time, as I said I nearly just started learning C, so your, and all of the comments, are really precious!"}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1516722863, "creation_date": 1516722863, "answer_id": 48405828, "question_id": 48405040, "link": "https://stackoverflow.com/questions/48405040/compare-string-to-integer-in-c/48405828#48405828", "title": "Compare string to integer in C", "body": "<p>Some problems here:</p>\n\n<pre><code>scanf(\"%s\",&amp;tempo); \nfflush(stdin);\n//split array tempo into ora and min to separate h from mins\nora[0]=tempo[0];\nora[1]=tempo[1];\nmin[0]=tempo[3];\nmin[1]=tempo[4];\n//cast guess form string to int\nint oraint=atoi(ora); //creat integer hour from string\nint minint=atoi(min); //integer mins\n</code></pre>\n\n<p>Going line by line:</p>\n\n<pre><code>scanf(\"%s\",&amp;tempo);\n</code></pre>\n\n<p>Do not use the <code>&amp;</code> operator when passing an array expression like <code>tempo</code> to <code>scanf</code> - array expressions are automatically converted to pointer expressions under most circumstances.  That line should simply be</p>\n\n<pre><code>scanf(\"%s\", tempo);\n</code></pre>\n\n<p>Secondly, <code>tempo</code> isn't large enough to store the <em>string</em> \"hh:mm\" - remember that a string always has a terminating 0.  You need to allocate an array that's at least 1 element larger than the longest string you intend to store in it, so <code>tempo</code> should be declared as <code>char[6]</code>. </p>\n\n<p>Third,</p>\n\n<pre><code>fflush(stdin);\n</code></pre>\n\n<p>is not defined in general; \"flushing\" an input stream simply doesn't make much sense.  It's true that Microsoft defined it to clear out the input stream in their particular implementations, but in general the line is nonsensical.  Don't expect it to work anywhere outside of a MSVC implementation.</p>\n\n<p>Next, </p>\n\n<pre><code>ora[0]=tempo[0];\nora[1]=tempo[1];\nmin[0]=tempo[3];\nmin[1]=tempo[4];\n</code></pre>\n\n<p>Like <code>tempo</code>, <code>ora</code> and <code>min</code> are not <em>strings</em> - you haven't set aside any space for a string terminator.  <code>atoi</code> will not convert them properly.  </p>\n\n<p>You'll have to declare both <code>ora</code> and <code>min</code> as <code>char[3]</code>, and make sure that <code>ora[2]</code> and <code>min[2]</code> are set to 0:</p>\n\n<pre><code>ora[0] = tempo[0];\nora[1] = tempo[1];\nora[2] = 0;\nmin[0] = tempo[3];\nmin[1] = tempo[4];\nmin[2] = 0;\n</code></pre>\n\n<p>Of course, you can avoid <em>all</em> of this by using the following:</p>\n\n<pre><code>int ora;\nint min;\n\nif ( scanf( \"%d:%d\", &amp;ora, &amp;min ) == 2 )\n{\n  // read ora and min properly\n} \nelse\n{\n  // bad input or error\n}\n</code></pre>\n\n<p>Finally,</p>\n\n<pre><code>while(ok=true);\n</code></pre>\n\n<p>needs to be either </p>\n\n<pre><code>while ( ok == true ); // == for comparison, = for assignment\n</code></pre>\n\n<p>or</p>\n\n<pre><code>while ( ok ); // my personal preference\n</code></pre>\n\n<p><code>ok=true</code> <em>assigns</em> the value <code>true</code> to <code>ok</code> - to perform a comparison, use <code>ok == true</code>.  </p>\n"}], "owner": {"reputation": 1, "user_id": 9257353, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-plA6t6uWp6w/AAAAAAAAAAI/AAAAAAAABQ4/2Zi2rqXOlrs/photo.jpg?sz=128", "display_name": "Pi7on", "link": "https://stackoverflow.com/users/9257353/pi7on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516724956, "creation_date": 1516720534, "last_edit_date": 1516724956, "question_id": 48405040, "link": "https://stackoverflow.com/questions/48405040/compare-string-to-integer-in-c", "title": "Compare string to integer in C", "body": "<p>beginner student here.\nI'm trying to make a game where the user is asked a riddle.\nthe correct answer is the current time written like this: hh:mm</p>\n\n<p>The program works fine until the user inputs to many different wrong guesses (like random letters).\nAfter that it gives error even if the answer is right.</p>\n\n<p>Here is the code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(){\n    //check\n    bool ok=false; //true when guess==real time\n    int tent=0; //tryes\n    //guesses\n    char tempo[5]; //input string from user\n    char ora[2];   //houres\n    char min[2];   //mins\n    //get time\n    time_t my_time;\n    struct tm * timeinfo; \n    time (&amp;my_time);\n    timeinfo = localtime (&amp;my_time);\n    //random\n    srand(time(NULL));\n\n    //guessing game, user shound input a string that conains current time to win:   hh:mm\n    printf(\"In principio era uno, e il nulla.\\n\\n\");\n    printf(\"Poi l'uomo lo duplico', e tra essi traccio' la via...\\n\");\n    printf(\"Lo fece ancora... e gli sembro' perfetto.\\n\");\n    printf(\"Ma non era abbastanza... \");\n    printf(\"Cosi' si spinse piu' in profondita', e sbirciando poco oltre trovo'...  \");\n\n    do{\n        //get guessed time (could also get words and non relevant numbers, if input is not hh:mm (current hour:current mins) user gets error)\n        scanf(\"%s\",&amp;tempo);\n        fflush(stdin);\n        //split array tempo into ora and min to separate h from mins\n        ora[0]=tempo[0];\n        ora[1]=tempo[1];\n        min[0]=tempo[3];\n        min[1]=tempo[4];\n        //cast guess form string to int\n        int oraint=atoi(ora); //creat integer hour from string\n        int minint=atoi(min); //integer mins\n\n        //check guess == real time\n        if(oraint==timeinfo-&gt;tm_hour &amp;&amp; minint==timeinfo-&gt;tm_min){\n            //win\n            printf(\"\\nCOMPLIMENTI! Hai trovato la risposta!\\n\");\n            printf(\"\\n\\nEcco le tue prossime istruzioni!\\n\\n\");\n            printf(\"TURFeE1UQXdNREF3TVRFd01EQXdNVEF4TVRFd01ERXhNREV4TVRBd01URXdNVEV4TURFeE1UQXhNVEF4TVRFeE1ERXhNVEF3TVRBd01URXdNREV3TURBd01URXhNREV3TURBeE1EQXdNREF3TVRBd01ERXhNREF4TVRBeE1URXhNREV4TVRBeE1ERXdNVEV4TURBeE1EQXhNVEV3TVRBd01ERXhNREV3TURBd01UQXdNREV3TURBeE1UQXhNREF4TURFeE1ERXhNREV3TVRFd01ERXdNVEF4TVRBeE1URXdNREV4TVRBd01URXdNVEV3TVRBd01UQXhNVEF4TVRFeE1ERXhNREV4TVRBPQ==\\n\\n\");\n            printf(\"Che c'e'? devo anche dirti come decifrarle?\\n\");\n            printf(\"...e va bene...ti do un'indizio\\n\");\n            printf(\"Ricorda che, a volte, un colpo non basta.\");\n            ok=true;\n        } else {\n            tent++;\n            int val=rand()%6; //random error pharases\n            switch(val){\n                case 0:\n                    printf(\"Non ci siamo...\\n\\n\");\n                    break;\n                case 1:\n                    printf(\"Pare di no...\\n\\n\");\n                    break;\n                case 2:\n                    printf(\"Riprova.\\n\\n\");\n                    break;\n                case 3:\n                    printf(\"Pensaci meglio...\\n\\n\");\n                    break;\n                case 4:\n                    printf(\"Nah, prova ancora.\\n\\n\");\n                    break;\n                case 5:\n                    printf(\"Ti ho mai detto quante risposte hai gia' provato?\\n\");\n                    printf(\"Beh... sono ben \");\n                    printf(\"%d\\n\\n\",tent);\n                    break;\n            }\n        }\n    }while(ok=true);\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p>I'm experimenting with thing I didn't study, so please forgive stupid errors or bad code.. Thanks in advance</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1516717573, "post_id": 48403980, "comment_id": 83796391, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1516718011, "post_id": 48403980, "comment_id": 83796703, "body": "Using <code>while (!feof(go))</code> is wrong.  You should probably not use nested loops. You should have one loop that reads the dictionary into memory and then a second loop that reads and translates the text file."}, {"owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 1, "creation_date": 1516719075, "post_id": 48403980, "comment_id": 83797484, "body": "And please code in english if you want other people to look at your code. Having variable names one can&#39;t figure out the meaning doesn&#39;t help in the review."}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 1, "creation_date": 1516724309, "post_id": 48403980, "comment_id": 83801367, "body": "Welcome to Stack Overflow! Try making this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please! &lt;3"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "edited": false, "score": 0, "creation_date": 1516733246, "post_id": 48403980, "comment_id": 83806764, "body": "@liberforce: that could be a useful function for this program (if it can be got to work)."}, {"owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "edited": false, "score": 0, "creation_date": 1516794062, "post_id": 48403980, "comment_id": 83832660, "body": "@P.Manek, Can you please confirm whether my below solution working for you or still you are facing problem."}, {"owner": {"reputation": 11, "user_id": 9057257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccac09711002f8943563efbad800cab6?s=128&d=identicon&r=PG&f=1", "display_name": "P.Manek", "link": "https://stackoverflow.com/users/9057257/p-manek"}, "edited": false, "score": 0, "creation_date": 1516804008, "post_id": 48403980, "comment_id": 83839164, "body": "It don<code>t work. Program crashed. The error is &quot;Access violation&quot; so I think this is problem with memory but I don</code>t know how to fix your code :/"}, {"owner": {"reputation": 11, "user_id": 9057257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccac09711002f8943563efbad800cab6?s=128&d=identicon&r=PG&f=1", "display_name": "P.Manek", "link": "https://stackoverflow.com/users/9057257/p-manek"}, "edited": false, "score": 0, "creation_date": 1516878871, "post_id": 48403980, "comment_id": 83874140, "body": "When I changed strcat() function to strcpy() the last word in the file is changing but rest is not changed."}], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 8405835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sN3eq.png?s=128&g=1", "display_name": "Abhijit Pritam Dutta", "link": "https://stackoverflow.com/users/8405835/abhijit-pritam-dutta"}, "is_accepted": false, "score": 0, "last_activity_date": 1516726490, "creation_date": 1516726490, "answer_id": 48407029, "question_id": 48403980, "link": "https://stackoverflow.com/questions/48403980/c-loop-and-text-files/48407029#48407029", "title": "C - loop and text files", "body": "<p>Working with string is not a very easy work in c language for newcomer. For good programming first write down your requirement and then generate an algorithm from it. Once your algorithm is ready start coding based on that algorithm. If I look into your code you are most of the time just doing hit and try to fix your problem. This will not only creating more trouble for you but also raise  frustrating as well. See my program below and compare with your code and find out you mistakes. Hope you will following my advice in future.</p>\n\n<pre><code>   void main()\n   {\n            FILE *fpointer_s, *fpointer_d;\n            fpointer_s = fopen(\"test.txt\",\"r\");\n            fpointer_d = fopen(\"slownik.txt\",\"r\");\n            if(fpointer_s != NULL &amp;&amp; fpointer_d != NULL)\n            {\n                    printf(\"Dictionary job starting....\\n\");\n            }\n            else\n            {\n                    printf(\"File does not exist....\\n\");\n                    return;\n            }\n            //FILEs are OPENED\n            char line[255];\n            char dictionary[1025];//for dictionary file\n            char text[1025];//for text file\n            char delim[2]=\" \";\n            memset(text,0,sizeof(text));\n            while(!feof(fpointer_d) &amp;&amp; fgets(line,sizeof line,fpointer_d))\n            {\n                    strcat(dictionary,line);//we are loading the dictionary here\n            }\n            memset(line,0,sizeof(line));//clear line to read next file\n            //now read the next file line by line\n            while(!feof(fpointer_s) &amp;&amp; fgets(line,sizeof line,fpointer_s))\n            {\n                char *word = strtok(line,delim);\n                do\n                {\n                  char *found = strstr(dictionary,word);//check if the word available in dictionary\n                  char tword[20];//variable to store translated word\n                  int i = 0;\n                  if (found)//if the word found in dictionary use the translated word i.e. tword\n                  {\n                    found = found + strlen(word)+1;//pointing to the English equivalent\n                    memset(tword,0,sizeof(tword));//clear previous value\n                    while(*found !=',' &amp;&amp; *found !='\\n' &amp;&amp; *found !=NULL )//copy character by character till end of English word\n                      tword[i++] = *found++;\n                    tword[i]=0;//assign end of string character\n                     if(strlen(text)&gt; 0)\n                        strcat(text,\" \");\n                     strcat(text,tword);\n                   }//end if\n                   else//if word not found in dictionary just add the original word\n                   {\n                     if(strlen(text)&gt; 0)\n                      strcat(text,\" \");\n                     strcat(text,word);\n                   }\n                  word = strtok(NULL,delim);\n                }while(word);\n            }\n             //finally we translated the text into english\n             printf(\"%s\\n\",text);\n    }\n</code></pre>\n\n<p>Also use below header files as well</p>\n\n<blockquote>\n  <p>stdio.h,stdlib.h,string.h</p>\n</blockquote>\n"}], "owner": {"reputation": 11, "user_id": 9057257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccac09711002f8943563efbad800cab6?s=128&d=identicon&r=PG&f=1", "display_name": "P.Manek", "link": "https://stackoverflow.com/users/9057257/p-manek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516726490, "creation_date": 1516717285, "question_id": 48403980, "link": "https://stackoverflow.com/questions/48403980/c-loop-and-text-files", "title": "C - loop and text files", "body": "<p>I must write a program which will be changing a words from one text file basic on dictionary from another text file. For example in \"test.txt\" i have:</p>\n\n<p>\"mama poszla z tata na zakupy\"</p>\n\n<p>and in \"slownik.txt\" i have:</p>\n\n<p>\"mama:mother,\ntata:father,\nbabcia:grandma,\nna:on,\"</p>\n\n<p>I expected to my program disply \"mother poszla z father on zakupy\", but only first word is changed. Below my code fragment in C:</p>\n\n<pre><code>char *token; \nint k = 0;\n\nwhile (!feof(slownik)) //\n{\n    k = 0;\n    fscanf(slownik,\"%s\",&amp;liniatekstu);\n    token = strtok(liniatekstu,\" ,.:\");\n\n    while(token != NULL)\n    {\n       tab[k] = token;\n     //  printf(\"%s\\n\", tab[k]);\n       token = strtok(NULL,\" ,.:\");\n       k = k + 1;\n    }\n    char c;\n    char slowo[1000];\n    int idx = 0;\n\n    while(!feof(fp))\n    {\n        c = fgetc(fp); // get sign\n        if( ! isspace(c) )\n        { // full sign - add to word\n            slowo[idx++] = c;\n            if(idx&gt;=1000)\n            {\n                printf(\"Error - word has &gt; 1000 signs\\n\");\n            }\n        }\n        else \n        { // blank sign - end of word\n        //  if(idx == 0) // idx=0 word is empty\n            //  continue;\n                // we have final word \n                // - add zero to end of word and display to screen \n            slowo[idx] = 0;\n             // printf(\"%s\\n\", slowo);\n            // TU MAM SLOWO\n            const char* x = tab[0]; // polish version of word\n            const char* y = tab[1]; // english version of word\n\n            if ( strcmp(slowo,x)  == 0) // comparation word from \"test.txt\" and \"slownik.txt\" if its the same display english version of word\n            {\n                printf(\"%s \",y);\n            }\n            else\n            {\n                printf(\"%s \",slowo); // display polish version\n            }\n            idx = 0;\n         }\n    }\n}\n</code></pre>\n\n<p>Please help.</p>\n"}, {"tags": ["c", "arrays", "string", "char", "strlen"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1516716695, "post_id": 48403626, "comment_id": 83795749, "body": "<code>char t[10]</code> declares an array of exactly 10 <code>char</code>.  <i>There is no 11th spot</i>, and if that array has automatic storage duration, as it appears yours does, then its initial contents are indeterminate.  If you want to use that array as storage for a C string, then you need to explicitly provide sufficient capacity to accommodate a string terminator."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1516718295, "post_id": 48403626, "comment_id": 83796911, "body": "Your question seems to distinguish the <code>char</code> values <code>0</code> and <code>&#39;\\0&#39;</code>. However, they are the same. In particular, <i>if</i> the array were zero-initialized (but it isn\u2019t), then the characters beyond <code>t[4]</code> would be zero (i.e. <code>0</code> or <code>&#39;\\0&#39;</code>), not <code>&#39;0&#39;</code> (i.e. the character corresponding to the digit 0, which usually has the integer value 48, not 0)."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 0, "creation_date": 1516716597, "post_id": 48403647, "comment_id": 83795699, "body": "OK, that does explain some part of the question. But why does my code return 3 in the <code>strlen(&amp;t[5])</code> example? I do understand that <code>&amp;</code> is used in connection to pointers, but does it perhaps perform some other task here?"}, {"owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 1, "creation_date": 1516717025, "post_id": 48403647, "comment_id": 83795959, "body": "I understand it now. Thank you for your time and energy! As it goes to everyone else, your answer did help a lot, thank you."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1516718270, "last_edit_date": 1516718270, "creation_date": 1516716294, "answer_id": 48403647, "question_id": 48403626, "link": "https://stackoverflow.com/questions/48403626/how-does-strlenstring-work/48403647#48403647", "title": "How does strlen(&amp;string[]) work?", "body": "<p>First let me tell you, your \"assumption\"</p>\n\n<pre><code>String:   a | b | c | d | 0 | 0 | 0 | 0 | 0 | \\0\nPosition: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 \n</code></pre>\n\n<p>is not correct. Based on your code, The values are only <strong>\"guaranteed\"</strong> up to index 4, not beyond that.</p>\n\n<p><strong>For the first case</strong>, in your code</p>\n\n<pre><code>  printf(\"%d\\n\", strlen(&amp;t[5]));\n</code></pre>\n\n<p>is wrong for various reasons,</p>\n\n<ul>\n<li>you ought to use <code>%zu</code> for a <code>size_t</code> type. </li>\n<li><code>&amp;t[5]</code> does not point to a valid <em>string</em>.</li>\n</ul>\n\n<p><strong><em>Any (or both) of the above causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> and any output cannot be justified.</em></strong></p>\n\n<p>To elaborate, with a defintion like</p>\n\n<pre><code>char t[10];\nstrcpy(t, \"abcd\");\n</code></pre>\n\n<p>you have index 0 to 3 populated for <code>t</code>, and index 4 holds the null-terminator. The content of <code>t[5]</code> onward, is indeterminate. </p>\n\n<p>Thus, <code>&amp;t[5]</code> is not a pointer to the first element of a string, so cannot be used argument to <code>strlen()</code>. </p>\n\n<ul>\n<li>It may run out of bound in search of the null-terminator and experience invalid memory access and, as a side-effect, produce a segmentation fault, </li>\n<li>It may find a null-terminator (just another garbage value) within the bound and report a \"seemingly\" valid length.</li>\n</ul>\n\n<p>Both are equally likely and unlikely, really. UB is UB, there's not justifying it.</p>\n\n<p><strong>Then, for the second case,</strong> where you say</p>\n\n<pre><code>char t[10];\nstrcpy(t, \"abcdefghij\");\n</code></pre>\n\n<p>is once again, accessing memory out of bound. </p>\n\n<p>You have all together 10 array elements to store a string, so you can have 9 other <code>char</code> elements, plus one null-terminator (to qualify the char array as a string).</p>\n\n<p>However, you're attempting to put 10 <code>char</code> elements, plus a null character (in <code>strcpy()</code>), so you're off-by-one, accessing out of bound memory, invoking UB.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 1, "creation_date": 1516716755, "post_id": 48403745, "comment_id": 83795787, "body": "So 3 is essentially somewhat unpredictable result?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 0, "creation_date": 1516716884, "post_id": 48403745, "comment_id": 83795858, "body": "Yes, @PeroAlex. That&#39;s more or less what &quot;undefined behavior&quot; means: the language does not define the results of executing such behavior."}, {"owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 0, "creation_date": 1516716967, "post_id": 48403745, "comment_id": 83795918, "body": "Now I get it. Thank you for your time and energy! It helped me a lot."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1516718480, "post_id": 48403745, "comment_id": 83797015, "body": "What does two\u2019s complement have got to do with anything here?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1516720270, "post_id": 48403745, "comment_id": 83798379, "body": "@KonradRudolph See the linked reference. If a variable with indeterminate value (that has its address taken) is accessed on a system without trap representations, then the result takes unspecified values. On a system with trap representations, accessing the variable may result in a trap. And 2&#39;s complement systems do not have trap representations for plain integers."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1516716576, "creation_date": 1516716576, "answer_id": 48403745, "question_id": 48403626, "link": "https://stackoverflow.com/questions/48403626/how-does-strlenstring-work/48403745#48403745", "title": "How does strlen(&amp;string[]) work?", "body": "<p><code>char t[10];</code> is not initialized so it just contains garbage values <sup>1)</sup>. <code>strcpy(t, \"abcd\");</code> overwrites the first 5 characters with the string \"abcd\" and a null terminator. </p>\n\n<p>However, <code>&amp;t[5]</code> points at the first character after the null termination, which remains garbage. If you invoke <code>strlen</code> from there, anything can happen, since the pointer passed is not likely pointing at a null terminated string.</p>\n\n<hr>\n\n<p><sup>1)</sup> Garbage = indeterminate values. Assuming a sane 2's complement system, the address of the buffer <code>t</code> is taken, so the code does not invoke undefined behavior until the point where <code>strlen</code> starts reading outside the bounds of the array <code>t</code>. <a href=\"https://stackoverflow.com/a/40674888/584518\">Reference</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 0, "creation_date": 1516716937, "post_id": 48403789, "comment_id": 83795893, "body": "<code>0</code> come from me testing what the undefined contents of my array were. I saw that they seem to be 0 all the time, thus I concluded that they must be zero. Your answer is actually very helpful, did clarify much. Thanks!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "edited": false, "score": 0, "creation_date": 1516718708, "post_id": 48403789, "comment_id": 83797186, "body": "Well, you didn&#39;t provide enough context to be precise. If <code>t[]</code> is defined on file scope it will be initialized to 0. If it is defined locally within a function, it is not. From your finding that <code>strlen(&amp;t[5])</code>is not 0 I assumed that it must be a local one."}], "tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 1, "last_activity_date": 1516716716, "creation_date": 1516716716, "answer_id": 48403789, "question_id": 48403626, "link": "https://stackoverflow.com/questions/48403626/how-does-strlenstring-work/48403789#48403789", "title": "How does strlen(&amp;string[]) work?", "body": "<p>Problem 1:</p>\n\n<blockquote>\n  <p>My guess is that</p>\n\n<pre><code>String:   a | b | c | d | 0 | 0 | 0 | 0 | 0 | \\0\nPosition: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 \n</code></pre>\n</blockquote>\n\n<p>This assumption is wrong.\nThe array is not initialized to hold 0 values but contains some \"random\" garbage.\nAfter copying <code>\"abcd\"</code> the upper half of the array (<code>t[5]</code> etc.) is still untouched resulting in a \"random\" length of the string due to undefined behaviour.</p>\n\n<p>Problem 2:</p>\n\n<blockquote>\n  <p>If I understand character arrays correctly, the state should now be</p>\n\n<pre><code>String:   a | b | c | d | e | f | g | h | i | j | '\\0'\nPosition: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10\n</code></pre>\n</blockquote>\n\n<p>Again wrong.\nYour array only holds 10 characters. Theyare at index 0..9. Index 10 is out of bounds.\nYour copy operation might result in this layout or it might as well just crash while writing out of bounds.</p>\n\n<p>But this is not checked by the compiler. If you run into problems then it will be during runtime.</p>\n"}], "owner": {"reputation": 43, "user_id": 9228479, "user_type": "registered", "profile_image": "https://graph.facebook.com/127347671369646/picture?type=large", "display_name": "Pero Alex", "link": "https://stackoverflow.com/users/9228479/pero-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 48403647, "answer_count": 3, "score": 1, "last_activity_date": 1516718270, "creation_date": 1516716205, "last_edit_date": 1516716311, "question_id": 48403626, "link": "https://stackoverflow.com/questions/48403626/how-does-strlenstring-work", "title": "How does strlen(&amp;string[]) work?", "body": "<p>This might be a bit long question. I was testing some character arrays in C and so came along this code.</p>\n\n<pre><code>char t[10];\nstrcpy(t, \"abcd\");\nprintf(\"%d\\n\", strlen(&amp;t[5]));\nprintf(\"Length: %d\\n\", strlen(t));\n</code></pre>\n\n<p>Now apparently <code>strlen(&amp;t[5])</code> yields 3 while <code>strlen(t)</code> returns 4.</p>\n\n<p>I know that string length is 4, this is obvious from inserting four characters. But why does <code>strlen(&amp;t[5])</code> return 3?</p>\n\n<p>My guess is that</p>\n\n<pre><code>String:   a | b | c | d | 0 | 0 | 0 | 0 | 0 | \\0\nPosition: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 \n</code></pre>\n\n<p><code>strlen(&amp;t[5])</code> looks at the length of a string composed of positions 6, 7 and 8 (because the 10th character is a NULL terminating character, right)?</p>\n\n<p>OK, then I did some experimentation and modified a code a bit.</p>\n\n<pre><code>char t[10];\nstrcpy(t, \"abcdefghij\");\nprintf(\"%d\\n\", strlen(&amp;t[5]));\nprintf(\"Length: %d\\n\", strlen(t));\n</code></pre>\n\n<p>Now this time <code>strlen(&amp;t[5])</code> yields 5 while <code>strlen(t)</code> is 10, as expected. If I understand character arrays correctly, the state should now be</p>\n\n<pre><code>String:   a | b | c | d | e | f | g | h | i | j | '\\0'\nPosition: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10\n</code></pre>\n\n<p>so why does <code>strlen(&amp;t[5])</code> return 5 this time? I've declared a character array of length 10, should then, by the same logic applied above, the result be 4?</p>\n\n<p>Also shouldn't I be running into some compiler errors since the NULL terminating character is actually in the 11th spot? I'm new into C and would very much appreciate anyone's help.</p>\n"}, {"tags": ["c", "matrix", "openssl", "bignum"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1516715302, "post_id": 48403289, "comment_id": 83794811, "body": "What does &quot;it doesn&#39;t work&quot; mean?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1516715604, "post_id": 48403289, "comment_id": 83795029, "body": "This declaration  BIGNUM *p [2][2] = NULL; does not make sense."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1516823092, "post_id": 48403289, "comment_id": 83851614, "body": "what you ahve here is an 2d array of pointers to bignums. But you say you want a 2d array of bignums. So do <code>BIGNUM p[2][2]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 9226973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d158f1042e2c264f6ce9327dadbedf26?s=128&d=identicon&r=PG&f=1", "display_name": "Snohdo", "link": "https://stackoverflow.com/users/9226973/snohdo"}, "is_accepted": false, "score": 0, "last_activity_date": 1516717684, "last_edit_date": 1516717684, "creation_date": 1516716695, "answer_id": 48403784, "question_id": 48403289, "link": "https://stackoverflow.com/questions/48403289/c-create-a-matrix-of-bignum/48403784#48403784", "title": "C create a matrix of Bignum", "body": "<p>By putting the pointer dereferencing in *p[2][2] you are referencing an address too far. (The asterisk)</p>\n\n<p>You should be able to use something like this:</p>\n\n<pre><code>BIGNUM p[2][2];\n\nint i; int j;\nfor(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n        p[i][j] = BN_new();\n    }\n}\n</code></pre>\n\n<p>There is another approach you could use where you say width=2 and height=2</p>\n\n<pre><code>BIGNUM *p = calloc(width * height, sizeof(BIGNUM));\n</code></pre>\n\n<p>Then you reference it with something like this (variables from your example):</p>\n\n<pre><code>p[i*width+j] = BN_new();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 2, "last_activity_date": 1516822916, "last_edit_date": 1516822916, "creation_date": 1516737613, "answer_id": 48409878, "question_id": 48403289, "link": "https://stackoverflow.com/questions/48403289/c-create-a-matrix-of-bignum/48409878#48409878", "title": "C create a matrix of Bignum", "body": "<p>I assume that the return type of <code>BN_new()</code> is <code>BIGNUM *</code>.</p>\n\n<p>Since <code>BIGNUM *p[2][2]</code> is a 2*2 array and the data type of the elements is  <code>BIGNUM*</code>, the assignment to an element of the array <code>p</code>, would look like this:</p>\n\n<pre><code>p[i][j] = BN_new();    \n</code></pre>\n\n<p>This means your code should look like this:</p>\n\n<pre><code>BIGNUM *p[2][2] = {NULL, NULL, NULL, NULL};\n\nfor( int i=0; i&lt;2; ++i ) {\n    for( int j=0; j&lt;2; ++j ) {\n        p[i][j] = BN_new();\n    }\n}\n</code></pre>\n\n<p>The expression <code>*p[i][j]</code> would access a <code>BIGNUM</code> value indirectly, through the pointer <code>p[i][j]</code>. This works, because the index operator <code>[]</code> takes precedence over the indirection operator <code>*</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 5763054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e8e0c189886abee0b14b5e221aa46f2?s=128&d=identicon&r=PG", "display_name": "user171635", "link": "https://stackoverflow.com/users/5763054/user171635"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516822916, "creation_date": 1516715206, "last_edit_date": 1516716266, "question_id": 48403289, "link": "https://stackoverflow.com/questions/48403289/c-create-a-matrix-of-bignum", "title": "C create a matrix of Bignum", "body": "<p>I'm trying to create a matrix in C where each element is a Bignum (from the Openssl librairy).\nI was thinking it would be something like this but it doesn't work.</p>\n\n<pre><code>BIGNUM *p [2][2] = NULL;\n  int i; int j;\n  for(i=0;i&lt;2;i++){\n    for(j=0;j&lt;2;j++){\n      *p[i][j] = BN_new();\n    }\n\n  }\n</code></pre>\n\n<p>I would appreciate any help.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 1, "creation_date": 1516715257, "post_id": 48402867, "comment_id": 83794765, "body": "Can you successfully run test.exe outside of your program? Have you considered adding some error checking so you can know why it isn&#39;t working?"}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1516715472, "post_id": 48402867, "comment_id": 83794935, "body": "Yes, from a command prompt I can run test.exe and it will drop be into another command prompt."}, {"owner": {"reputation": 305, "user_id": 1118367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1c5a15a9c878311a33a52fad0a9f84?s=128&d=identicon&r=PG", "display_name": "amasmiller", "link": "https://stackoverflow.com/users/1118367/amasmiller"}, "edited": false, "score": 0, "creation_date": 1516716420, "post_id": 48402867, "comment_id": 83795576, "body": "How are you compiling?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1516716585, "post_id": 48402867, "comment_id": 83795690, "body": "Well, <code>CreateProcess</code> returns a value to tell you if it was successful or not, and <code>GetLastError</code> will tell you why it failed. I suggest you look into that."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "reply_to_user": {"reputation": 305, "user_id": 1118367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1c5a15a9c878311a33a52fad0a9f84?s=128&d=identicon&r=PG", "display_name": "amasmiller", "link": "https://stackoverflow.com/users/1118367/amasmiller"}, "edited": false, "score": 0, "creation_date": 1516716794, "post_id": 48402867, "comment_id": 83795811, "body": "@amasmiller I don&#39;t see why that matters. If it runs fine with cmd.exe and not with test.exe which is a copy... Something related to CreateProcess is not liking it. But I am using CodeBlocks and compiling as a Win32 GUI."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1516722130, "post_id": 48402867, "comment_id": 83799793, "body": "<i>does not properly call</i> - what does that mean? How do you know it is not connecting to the socket?  What happens?  As @RetiredNinja says, get the return code and error message."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1516722647, "post_id": 48402867, "comment_id": 83800178, "body": "I am not sure how to get the error message. I have tried a few examples and nothing is happening. I am still learning C. By call I mean it does not open the cmd.exe."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1516724028, "post_id": 48402867, "comment_id": 83801181, "body": "If you actually try to copy the file to the System32 directory, or some other protected place, <a href=\"https://stackoverflow.com/questions/17953426/how-to-get-programatically-the-location-of-a-windows-uac-virtualized-file?noredirect=1&amp;lq=1\">it might end up somewhere else</a>. Depending on how you try to access the file, this &quot;somewhere else&quot; might be automatically located, or not."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "edited": false, "score": 0, "creation_date": 1516728779, "post_id": 48402867, "comment_id": 83804306, "body": "I manually copied cmd.exe from System32 and pasted the copy in System32. I then renamed it to test.exe. I did this through the file explorer."}, {"owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "reply_to_user": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1516729332, "post_id": 48402867, "comment_id": 83804599, "body": "@Bo Persson I moved the test.exe to another location (C:\\Test\\test.exe) and that works. I supposed System32 doesn&#39;t like to have a copy of cmd.exe in the same spot."}], "owner": {"reputation": 59, "user_id": 9196098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/783348de250ef470abd09d9fd2d85ced?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Jarcus", "link": "https://stackoverflow.com/users/9196098/brian-jarcus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516715054, "creation_date": 1516713951, "last_edit_date": 1516715054, "question_id": 48402867, "link": "https://stackoverflow.com/questions/48402867/createprocess-function-not-running-copy-of-cmd-exe", "title": "Createprocess function not running copy of cmd.exe", "body": "<p>I have a program that uses create process to run cmd.exe. When it runs, the program goes into the Task Manager as cmd.exe *32. I don't want it to be called that so I was going to take a copy of the cmd.exe and cmd.exe.mui and rename it to something like test.exe. When I try to run the program it does not properly call that copy of cmd.exe. The program is just supposed to connect to a socket. If I leave it as cmd.exe it opens up fine. If I change it to test.exe, nothing happens.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;winsock2.h&gt;\n\nvoid RunSocket(char *a, char *b);\nint WINAPI WinMain(HINSTANCE hinst, HINSTANCE hprev, LPSTR cmdline, int show);\n\n\nint main(int argc, char *argv[]) {\n    char *socket = argv[1];\n    printf(\"%s\", argv[0]);\n    WinMain(0,0,socket,0);\n    return 0;\n}\n\nint WINAPI WinMain(HINSTANCE hinst, HINSTANCE hprev, LPSTR cmdline, int show) {\n    char test[50];\n    strncpy(test, cmdline, 49);\n    char *ip = strtok(test, \":\");\n    char *port = strtok(NULL, \":\");\n\n    printf(\"IP: %s\\n\", ip);\n    printf(\"PORT: %s\", port);\n    RunSocket(ip, port);\n    return 0;\n}\n\nvoid RunSocket(char *a, char *b) {\n    WSADATA wsaData;\n    SOCKET Winsock;\n    struct sockaddr_in hax;\n    char ip_addr[16];\n    STARTUPINFO ini_processo;\n    PROCESS_INFORMATION processo_info;\n\n    WSAStartup(MAKEWORD(2,2), &amp;wsaData);\n    Winsock=WSASocket(AF_INET,SOCK_STREAM,IPPROTO_TCP,NULL,(unsigned int)NULL,(unsigned int)NULL);\n\n    struct hostent *host;\n    host = gethostbyname(a);\n    strcpy(ip_addr, inet_ntoa(*((struct in_addr *)host-&gt;h_addr)));\n\n    hax.sin_family = AF_INET;\n    hax.sin_port = htons(atoi(b));\n    hax.sin_addr.s_addr =inet_addr(ip_addr);\n\n    WSAConnect(Winsock,(SOCKADDR*)&amp;hax, sizeof(hax),NULL,NULL,NULL,NULL);\n\n    memset(&amp;ini_processo, 0, sizeof(ini_processo));\n    ini_processo.cb=sizeof(ini_processo);\n    ini_processo.dwFlags=STARTF_USESTDHANDLES;\n    ini_processo.hStdInput = ini_processo.hStdOutput = ini_processo.hStdError = (HANDLE)Winsock;\n\n    char com[] = \"C:\\\\Windows\\\\System32\\\\test.exe\";\n    CreateProcess(NULL, com, NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &amp;ini_processo, &amp;processo_info);\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "zeromq"], "comments": [{"owner": {"reputation": 2880, "user_id": 2672165, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/92556a84fe9a5abab9cf35ffc367366e?s=128&d=identicon&r=PG", "display_name": "user2672165", "link": "https://stackoverflow.com/users/2672165/user2672165"}, "edited": false, "score": 0, "creation_date": 1516714353, "post_id": 48402683, "comment_id": 83794114, "body": "It could be that the socket is destroyed before zmq_poller."}, {"owner": {"reputation": 9070, "user_id": 79591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rFGtY.jpg?s=128&g=1", "display_name": "GrahamS", "link": "https://stackoverflow.com/users/79591/grahams"}, "edited": false, "score": 0, "creation_date": 1516790957, "post_id": 48402683, "comment_id": 83830671, "body": "Very difficult to diagnose this without some of your code.  Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 667, "user_id": 2373682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5899dd869074f2792bbf9c20149633?s=128&d=identicon&r=PG", "display_name": "typhon", "link": "https://stackoverflow.com/users/2373682/typhon"}, "is_accepted": true, "score": 2, "last_activity_date": 1517027855, "last_edit_date": 1517027855, "creation_date": 1517027533, "answer_id": 48472627, "question_id": 48402683, "link": "https://stackoverflow.com/questions/48402683/how-calling-zmq-poll-leads-to-calling-zmq-abort/48472627#48472627", "title": "How calling zmq_poll() leads to calling zmq_abort()?", "body": "<p><code>zmq_abort()</code> was called from an assertation macro in <code>signaler_t</code>'s destructor:\n<a href=\"https://github.com/zeromq/libzmq/blob/v4.2.2/src/signaler.cpp#L143\" rel=\"nofollow noreferrer\">https://github.com/zeromq/libzmq/blob/v4.2.2/src/signaler.cpp#L143</a>. The <code>signaler_t</code> object is a member of <code>socket_poller_t</code>. I don't know for sure why the call to the destructor is not shown in the stack trace.</p>\n\n<p>I was trying not to ask (directly) what was wrong with my code because it was infeasible to provide a code sample, but I'll mention that it turned out to be that a file descriptor was erroneously closed twice in another thread. Between the two close operations, zmq_poll() created a <code>socket_poller_t</code> object. <code>signaler_t</code>'s constructor opened an <code>eventfd</code>, which was the same fd (number) that had been closed earlier. Then, the other thread closed the same fd again, leading the destructor to get EBADF on close() and call<code>zmq_abort()</code>.</p>\n"}], "owner": {"reputation": 667, "user_id": 2373682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b5899dd869074f2792bbf9c20149633?s=128&d=identicon&r=PG", "display_name": "typhon", "link": "https://stackoverflow.com/users/2373682/typhon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "accepted_answer_id": 48472627, "answer_count": 1, "score": 1, "last_activity_date": 1517027855, "creation_date": 1516713357, "question_id": 48402683, "link": "https://stackoverflow.com/questions/48402683/how-calling-zmq-poll-leads-to-calling-zmq-abort", "title": "How calling zmq_poll() leads to calling zmq_abort()?", "body": "<p>I'm using zmq version 4.2.2. My program crashes because of a call to <code>zmq_abort()</code> which calls <code>abort()</code>. According to stack trace, if I understand correctly, <code>zmq_abort()</code> is called from <code>src/socket_poller.cpp:54</code>. However, that line is the beginning of the function definition:</p>\n\n<p><code>zmq::socket_poller_t::~socket_poller_t ()</code></p>\n\n<p>The function does not have direct calls to <code>zmq_abort()</code> or any assert macros that would call it. There are not many asserts or any direct calls to <code>zmq_abort()</code> in the whole file either. However, other lines in the stack trace seem to match the source code in github:</p>\n\n<p><a href=\"https://github.com/zeromq/libzmq/blob/v4.2.2/src/socket_poller.cpp#L54\" rel=\"nofollow noreferrer\">https://github.com/zeromq/libzmq/blob/v4.2.2/src/socket_poller.cpp#L54</a></p>\n\n<p>How does execution end up in <code>zmq_abort()</code>?</p>\n\n<p>Beginning of stack trace:</p>\n\n<pre><code>Program terminated with signal SIGABRT, Aborted.\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51  ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n[Current thread is 1 (Thread 0x7f12cc9d4700 (LWP 23680))]\n(gdb) where\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007f12ce123415 in __GI_abort () at abort.c:90\n#2  0x00007f12ce8db9c9 in zmq::zmq_abort (errmsg_=&lt;optimized out&gt;) at ../zeromq-4.2.2/src/err.cpp:87\n#3  0x00007f12ce918cbe in zmq::socket_poller_t::~socket_poller_t (this=0x7f12c8004150, \n    __in_chrg=&lt;optimized out&gt;) at ../zeromq-4.2.2/src/socket_poller.cpp:54\n#4  0x00007f12ce91793a in zmq_poller_destroy (poller_p_=0x7f12cc9d2af8)\n    at ../zeromq-4.2.2/src/zmq.cpp:1236\n#5  0x00007f12ce917e14 in zmq_poller_poll (timeout_=&lt;optimized out&gt;, nitems_=2, items_=0x1)\n    at ../zeromq-4.2.2/src/zmq.cpp:854\n#6  zmq_poll (items_=items_@entry=0x7f12cc9d2c20, nitems_=nitems_@entry=2, timeout_=timeout_@entry=5000)\n    at ../zeromq-4.2.2/src/zmq.cpp:866\n</code></pre>\n"}, {"tags": ["c", "file-handling", "uint8t"], "comments": [{"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1516712688, "post_id": 48402351, "comment_id": 83792961, "body": "There is a lot that is wrong (probably half a dozen things or so) with the code you have written Sam.  Perhaps it would be better to show us an example of what is in the file and what you would like your output to be and then we can work from there."}, {"owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "reply_to_user": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1516713850, "post_id": 48402351, "comment_id": 83793743, "body": "the file contains hex characters"}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1516714149, "post_id": 48402351, "comment_id": 83793973, "body": "That doesn&#39;t really answer the question.  Are you just trying to read data from a file and print it to the screen?  Are you trying to manipulate the data in some way?  If you simply want to print the character rather than the decimal value of it, use <code>%c</code> instead of <code>%s</code> (which, btw, was wrong to begin with because of a host of other issues some of which are pointed out by Some programmer dude)."}, {"owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "reply_to_user": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1516714362, "post_id": 48402351, "comment_id": 83794120, "body": "@jszakmeister the file contains just characters ,  i want to read them and put it into uint8_t *output as hex values ,first thing i don&#39;t know how to print uint8_t,secondly unint8_t will contain 1 byte of hex characters that is two char , so i am tring to read two characters from the file at a time ."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516714409, "post_id": 48402351, "comment_id": 83794154, "body": "&quot;but i want to put &quot;we&quot; which i suppose is a hex&quot;  What is &quot;a hex&quot;? It is a two letter string. If you want to convert from ASCII to integer, then consult your beginner-level C programming book."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516714498, "post_id": 48402351, "comment_id": 83794216, "body": "The line <code>output=file_handling() ;</code> will not even compile on a C compiler."}, {"owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516714549, "post_id": 48402351, "comment_id": 83794247, "body": "@Lundin How to read characters from file and put it uint8_t ?"}, {"owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516714602, "post_id": 48402351, "comment_id": 83794288, "body": "@Lundin I am using gcc on ubuntu and its getting compiled"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1516714744, "post_id": 48402351, "comment_id": 83794380, "body": "You need to tell gcc to be a C compiler instead of a Gnu crapiler. This is done by <code>gcc -std=c11 -pedantic-errors -Wextra -Wall</code>. As for how to convert from ASCII to integer, do some research and check the hundreds of SO threads already present on that topic."}, {"owner": {"reputation": 957, "user_id": 2729876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tTIEO.png?s=128&g=1", "display_name": "SIGSTACKFAULT", "link": "https://stackoverflow.com/users/2729876/sigstackfault"}, "edited": false, "score": 0, "creation_date": 1516724465, "post_id": 48402351, "comment_id": 83801469, "body": "Try making this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please! &lt;3"}, {"owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "edited": false, "score": 0, "creation_date": 1516782945, "post_id": 48402351, "comment_id": 83825542, "body": "I got answer on following page first solution :) <a href=\"https://stackoverflow.com/questions/18693841/read-contents-of-a-file-as-hex-in-c\">https://stackoverflow.com/questions/18693841/read-contents-o&zwnj;&#8203;f-a-file-as-hex-in-c</a>"}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1516720038, "last_edit_date": 1516720038, "creation_date": 1516712547, "answer_id": 48402444, "question_id": 48402351, "link": "https://stackoverflow.com/questions/48402351/issue-in-file-handling-in-c/48402444#48402444", "title": "issue in file handling in c", "body": "<p>You have plenty of problems, here's three of them:</p>\n\n<ul>\n<li><p>You define <code>str</code> to be an array of two characters, which means it can only contain a single-character string. You then call <code>fgets</code> telling it that <code>str</code> it <em>three</em> characters, which means it can and will write out of bounds of your array.</p></li>\n<li><p>You have declared <code>file_handling</code> to return an <code>int</code> value. You return the first character in the array <code>string</code>, and assign that to the <em>pointer</em> variable <code>output</code> in the <code>main</code> function. You then treat this <em>pointer</em> as a single <code>int</code> value.</p></li>\n<li><p>In the <code>main</code> function you pass the <em>pointer</em> <code>output</code> but print it as an <code>int</code> value. There's a mismatch between the format specifier and the argument.</p></li>\n</ul>\n\n<p>The first and third issues lead to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n"}], "owner": {"reputation": 59, "user_id": 9031724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a89c6af53071c174191ead1beda2fe?s=128&d=identicon&r=PG&f=1", "display_name": "Sam A", "link": "https://stackoverflow.com/users/9031724/sam-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "closed_date": 1517569484, "answer_count": 1, "score": -5, "last_activity_date": 1516720038, "creation_date": 1516712216, "last_edit_date": 1516717050, "question_id": 48402351, "link": "https://stackoverflow.com/questions/48402351/issue-in-file-handling-in-c", "closed_reason": "Needs details or clarity", "title": "issue in file handling in c", "body": "<p>Hi i am trying to read two characters from a file and want to send it to uint8_t* as hexadecimal .\nCode:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nint file_handling();\n\nint main() \n{\n   uint8_t *output ;\n\n   output=file_handling() ;\n\n   printf(\"\\noutput_main --&gt;  %02x\",output);\n\n}\n\nint file_handling()\n{ \n    uint8_t *output_hand ;\n\n    char c;\n\n    FILE *f_gets = fopen(\"filename\", \"r\");\n    if(f_gets==NULL)\n    {\n       printf(\"Please point to a valid key file!\\n\");\n       fclose(f_gets);  \n       return 0;\n    }\n    char str[3];\n\n    if( fgets (str, 3, f_gets)!=NULL ) \n    {\n     /* writing content to stdout */\n      puts(str);\n      output_hand = (uint8_t *)(str); \n      puts(output_hand);    \n      printf(\"\\noutput %s --- %02x --&gt; size --&gt; %lu\",str,*output_hand,sizeof(*output_hand));\n    }\n    fclose(f_gets);\n\n    return *output_hand;\n}\n</code></pre>\n\n<p>following is output</p>\n\n<pre><code>we we\n\noutput we --- 77 --&gt; size --&gt; 1 output_main --&gt;  65\n</code></pre>\n\n<p>what i can understand is 77 is ascii for w and 65 is ascii for e</p>\n\n<p>but i want to put \"we\" which i suppose is a hex in uint8_t *output \nwhere is the problem\nin main ,if i use pointer \"*output=file_handling()\" instead of just output i get segmentation fault.</p>\n\n<p>How to read value from a file and put it into  uint8_t , where file is having hex characters,how fget identifies it as hex or char.</p>\n\n<p>Thanks</p>\n\n<p>file is a text file </p>\n\n<pre><code>ab\nfe\nea\nce\n1d\n</code></pre>\n\n<p>Basically \nuint8_t *output;\n*output = 0xFA ;\nit works \nbut i want to read from above file and put it into output variable</p>\n"}, {"tags": ["c", "bgi"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1516717753, "post_id": 48402046, "comment_id": 83796534, "body": "Which BGI implementation are you using?  <a href=\"http://libxbgi.sourceforge.net/\" rel=\"nofollow noreferrer\">SDL_bgi</a>?  Why are you trying to mix BGI calls with raw X11 calls?"}, {"owner": {"reputation": 73, "user_id": 8209637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93fb9ffefcfea3823866fe52a0cf1774?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kuvalekar", "link": "https://stackoverflow.com/users/8209637/abhishek-kuvalekar"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1516719354, "post_id": 48402046, "comment_id": 83797692, "body": "Yes. I am using SDL_bgi. I searched for solution and one of the solutions suggested to call XInitThreads() to solve this problem."}, {"owner": {"reputation": 73, "user_id": 8209637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93fb9ffefcfea3823866fe52a0cf1774?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kuvalekar", "link": "https://stackoverflow.com/users/8209637/abhishek-kuvalekar"}, "reply_to_user": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1516719488, "post_id": 48402046, "comment_id": 83797796, "body": "And when I take input from terminal (i.e. when I call initgraph in drawLine) the execution goes well but in the code given above it gets aborted most of the times."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1516721078, "post_id": 48402046, "comment_id": 83799010, "body": "Hrm, works fine (can enter line endpoints, line animates drawing) on my Debian Stretch amd64 system over VNC after removing the X11 stuff."}], "owner": {"reputation": 73, "user_id": 8209637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93fb9ffefcfea3823866fe52a0cf1774?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Kuvalekar", "link": "https://stackoverflow.com/users/8209637/abhishek-kuvalekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516717638, "creation_date": 1516711320, "last_edit_date": 1516717638, "question_id": 48402046, "link": "https://stackoverflow.com/questions/48402046/bgi-program-aborts-even-after-calling-xinitthreads", "title": "BGI program aborts even after calling XInitThreads()?", "body": "<p>I want to perform DDA line drawing algorithm using the <a href=\"https://en.wikipedia.org/wiki/Borland_Graphics_Interface\" rel=\"nofollow noreferrer\">BGI</a>. Sometimes when I run my program it works fine and sometimes it gets aborted with following error:</p>\n\n<blockquote>\n  <p>[xcb] Unknown sequence number while processing queue\n  [xcb] Most likely this is a multi-threaded client and XInitThreads has not been called\n  [xcb] Aborting, sorry about that.\n  a.out: ../../src/xcb_io.c:274: poll_for_event: Assertion `!xcb_xlib_threads_sequence_lost' failed.\n  Aborted (core dumped)</p>\n</blockquote>\n\n<p>I tried calling XInitThreads and some other solutions suggested previously for this question. But still it crashes most of the times.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;graphics.h&gt;\n#include &lt;math.h&gt;\n#include &lt;X11/Xlib.h&gt;\n\nvoid drawLine(int startX, int startY, int endX, int endY) {\n    XInitThreads();\n    //DDA Line Drawing Algorithm\n    float deltaX, deltaY, step;\n    int x = startX, y = endY;\n    deltaX = (float)(endX - startX);\n    deltaY = (float)(endY - startY);\n    if(abs(deltaX) &gt; abs(deltaY)) {\n        step = deltaX;\n    }\n    else {\n        step = deltaY;\n    }\n    putpixel(x, y,15);\n    for(int i = 0; i &lt; abs(step); i++) {\n        x = (int)(x + deltaX/step + 0.5);\n        y = (int)(y + deltaY/step + 0.5);\n        putpixel(x, y,15);\n        delay(100);\n    }\n}\n\nint main() {\n    XInitThreads();\n    //Graphics Initialization.\n    int gd = DETECT,gm;\n    initgraph(&amp;gd, &amp;gm, NULL);\n    //Actual Code.\n    int startX, startY, endX, endY, in = 0;\n    printf(\"Starting point:\\nX = \");\n    scanf(\"%d\", &amp;startX);\n    printf(\"\\nY = \");\n    scanf(\"%d\", &amp;startY);\n    printf(\"Ending point:\\nX = \");\n    scanf(\"%d\", &amp;endX);\n    printf(\"\\nY = \");\n    scanf(\"%d\", &amp;endY);\n    delay(1000);\n    drawLine(startX, startY, endX, endY);\n    //solution provided for same question asked previously.\n    while(in == 0) {\n        in = getchar();\n    }\n    closegraph();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "bpf", "ebpf", "bcc-bpf"], "comments": [{"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 1, "creation_date": 1516715998, "post_id": 48401989, "comment_id": 83795301, "body": "Starting Linux 4.8, you can use the <code>bpf_get_current_task</code> helper to retrieve <code>struct task_struct</code>. <a href=\"http://elixir.free-electrons.com/linux/v4.14.14/source/include/linux/sched.h#L778\" rel=\"nofollow noreferrer\"><code>bpf_get_current_task()-&gt;nsproxy</code></a> gives you the <a href=\"http://elixir.free-electrons.com/linux/v4.14.14/source/include/linux/nsproxy.h#L31\" rel=\"nofollow noreferrer\">namespaces</a> of the current process. What are you looking for exactly? The PID inside the container?"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 1, "creation_date": 1516716240, "post_id": 48401989, "comment_id": 83795464, "body": "Awesome, I&#39;ll check that out - well I want to be able to determine/guess within an eBPF program whether a process is running inside a container or not and if so I want to stream any interactive shell sessions back to some central place for audit purposes. This could allow administrators play back any potentially malicious sessions"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "reply_to_user": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1516716283, "post_id": 48401989, "comment_id": 83795486, "body": "It&#39;s very much a work in progress but I&#39;m trying to understand what is possible with eBPF as it seems like such a powerful tool"}, {"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "edited": false, "score": 0, "creation_date": 1516718840, "post_id": 48401989, "comment_id": 83797292, "body": "I&#39;ll write a proper answer."}], "answers": [{"comments": [{"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "edited": false, "score": 0, "creation_date": 1516728818, "post_id": 48404561, "comment_id": 83804321, "body": "That&#39;s really cool, thanks - I tried adapting this to mount namespaces but I&#39;m not getting the expected result. I&#39;m printing the following value: <code>t-&gt;nsproxy-&gt;mnt_ns-&gt;ns.inum</code> but I always get the value 0, regardless of whether I&#39;m execing in a container or not"}, {"owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "reply_to_user": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "edited": false, "score": 0, "creation_date": 1516818188, "post_id": 48404561, "comment_id": 83848991, "body": "This is probably due to the randomized <code>task_struct</code> in kernel 4.13 as answered in your GitHub issue. I posted a comment in your previous question (<a href=\"https://stackoverflow.com/questions/48392152/how-can-i-use-ebpf-to-trace-container-exec-sessions\" title=\"how can i use ebpf to trace container exec sessions\">stackoverflow.com/questions/48392152/&hellip;</a>); did you get a chance to look into it?"}, {"owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "edited": false, "score": 0, "creation_date": 1516821601, "post_id": 48404561, "comment_id": 83850766, "body": "Thank you, yeah I switched to 4.11 and everything is working nicely :) I replied with a few details of what I&#39;ve got working"}], "tags": [], "owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "is_accepted": true, "score": 4, "last_activity_date": 1516719173, "creation_date": 1516719173, "answer_id": 48404561, "question_id": 48401989, "link": "https://stackoverflow.com/questions/48401989/how-can-i-determine-which-namespaces-a-pid-is-in-from-kernel-space/48404561#48404561", "title": "How can I determine which namespaces a PID is in from kernel space?", "body": "<p>You can use the (Linux 4.8+ only) <code>bpf_get_current_task</code> helper to retrieve the <code>struct task_struct</code> of the current process. Then the PID as seen by processes inside the container is in <code>t-&gt;nsproxy-&gt;pid_ns_for_children-&gt;last_pid</code>.</p>\n\n<p>The following shows this in action when tracing <code>execve</code> syscalls (you can use <code>top</code> inside the container to check that the upid is correct):</p>\n\n<pre class=\"lang-python prettyprint-override\"><code>from bcc import BPF\nBPF(text=\"\"\"\n#include &lt;linux/pid_namespace.h&gt;\nint kprobe__sys_execve(void *ctx) {\n    u32 pid = bpf_get_current_pid_tgid();\n    struct task_struct *t = (struct task_struct *)bpf_get_current_task();\n    u32 upid = t-&gt;nsproxy-&gt;pid_ns_for_children-&gt;last_pid;\n    bpf_trace_printk(\"pid=%d; upid=%d!\\\\n\", pid, upid);\n    return 0;\n}\n\"\"\").trace_print()\n</code></pre>\n\n<hr>\n\n<p>The following diff (based of <a href=\"https://github.com/iovisor/bcc/blob/a44d26ed3e5e40eaad8e69d630562fb389266bee/tools/execsnoop.py\" rel=\"nofollow noreferrer\">a44d26ed3</a>) extends bcc's <code>execsnoop.py</code> to retrieve the upid:</p>\n\n<pre><code>diff --git a/tools/execsnoop.py b/tools/execsnoop.py\nindex 5711fd1..2134f69 100755\n--- a/tools/execsnoop.py\n+++ b/tools/execsnoop.py\n@@ -53,6 +53,7 @@ bpf_text = \"\"\"\n #include &lt;uapi/linux/ptrace.h&gt;\n #include &lt;linux/sched.h&gt;\n #include &lt;linux/fs.h&gt;\n+#include &lt;linux/pid_namespace.h&gt;\n\n #define ARGSIZE  128\n\n@@ -63,6 +64,7 @@ enum event_type {\n\n struct data_t {\n     u32 pid;  // PID as in the userspace term (i.e. task-&gt;tgid in kernel)\n+    u32 upid;\n     char comm[TASK_COMM_LEN];\n     enum event_type type;\n     char argv[ARGSIZE];\n@@ -119,6 +121,8 @@ int kretprobe__sys_execve(struct pt_regs *ctx)\n {\n     struct data_t data = {};\n     data.pid = bpf_get_current_pid_tgid() &gt;&gt; 32;\n+    struct task_struct *t = (struct task_struct *)bpf_get_current_task();\n+    data.upid = t-&gt;nsproxy-&gt;pid_ns_for_children-&gt;last_pid;\n     bpf_get_current_comm(&amp;data.comm, sizeof(data.comm));\n     data.type = EVENT_RET;\n     data.retval = PT_REGS_RC(ctx);\n@@ -134,7 +138,7 @@ b = BPF(text=bpf_text.replace(\"MAXARG\", args.max_args))\n # header\n if args.timestamp:\n     print(\"%-8s\" % (\"TIME(s)\"), end=\"\")\n-print(\"%-16s %-6s %-6s %3s %s\" % (\"PCOMM\", \"PID\", \"PPID\", \"RET\", \"ARGS\"))\n+print(\"%-16s %-6s %-6s %-6s %3s %s\" % (\"PCOMM\", \"PID\", \"UPID\", \"PPID\", \"RET\", \"ARGS\"))\n\n TASK_COMM_LEN = 16      # linux/sched.h\n ARGSIZE = 128           # should match #define in C above\n@@ -142,6 +146,7 @@ ARGSIZE = 128           # should match #define in C above\n class Data(ct.Structure):\n     _fields_ = [\n         (\"pid\", ct.c_uint),\n+        (\"upid\", ct.c_uint),\n         (\"comm\", ct.c_char * TASK_COMM_LEN),\n         (\"type\", ct.c_int),\n         (\"argv\", ct.c_char * ARGSIZE),\n@@ -189,8 +194,8 @@ def print_event(cpu, data, size):\n             if args.timestamp:\n                 print(\"%-8.3f\" % (time.time() - start_ts), end=\"\")\n             ppid = get_ppid(event.pid)\n-            print(\"%-16s %-6s %-6s %3s %s\" % (event.comm.decode(), event.pid,\n-                    ppid if ppid &gt; 0 else \"?\", event.retval,\n+            print(\"%-16s %-6s %-6s %-6s %3s %s\" % (event.comm.decode(), event.pid,\n+                    event.upid, ppid if ppid &gt; 0 else \"?\", event.retval,\n                     b' '.join(argv[event.pid]).decode()))\n         try:\n             del(argv[event.pid])\n</code></pre>\n"}], "owner": {"reputation": 2018, "user_id": 6180803, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/x8pJW.jpg?s=128&g=1", "display_name": "dippynark", "link": "https://stackoverflow.com/users/6180803/dippynark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 1, "accepted_answer_id": 48404561, "answer_count": 1, "score": 0, "last_activity_date": 1576144017, "creation_date": 1516711160, "last_edit_date": 1576144017, "question_id": 48401989, "link": "https://stackoverflow.com/questions/48401989/how-can-i-determine-which-namespaces-a-pid-is-in-from-kernel-space", "title": "How can I determine which namespaces a PID is in from kernel space?", "body": "<p>I am trying to write an eBPF program to log every call of a particular syscall from containers running on the system. I am using <a href=\"https://github.com/iovisor/bcc\" rel=\"nofollow noreferrer\">bcc</a> and can retrieve the PID using <code>bpf_get_current_pid_tgid()</code>. </p>\n\n<p>From userspace I could examine the proc filesystem to determine if the process's namespaces differ from the root namespaces to guess whether it's a container process or not, but I do not know how do you do this from kernel space?</p>\n"}]